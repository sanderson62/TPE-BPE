* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    31* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    32* 071613    2013071200001  PEMA  REMOVE INC & RPT DATE EDITS.
    33* 080613    2013071600001  PEMA  ALLOW INC DTE CHANGE
    34* 082013    2013040900001  AJRA  ADD PF15 BENEFICIARY MAINT
    35* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    36* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    37* 040814    2014030500002  AJRA  ADD ICD CODES
    38* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    39* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    40* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    41* 031715  CR2015022700002  PEMA  CHECK CHG IN DIAGNOSIS
    42* 031815    2015021700001  TANA  BENE EDIT IF A PAYMENT PENDING
    43* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    44* 040617  CR2017022200003  TANA  INCREASE CHG INC DT TO 180 DAYS
    45* 062217  CR2017050300002  TANA  ADD AUTH RCVD FIELD
    46* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
    47* 101917  CR2017083000003  TANA  ADD CONTRACT CONTESTABLE MSG
    48******************************************************************
    49
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page   3
* EL131.cbl
    51 ENVIRONMENT DIVISION.
    52
    53 DATA DIVISION.
    54
    55 WORKING-STORAGE SECTION.
    56 01  DFH-START PIC X(04).
    57
    58 77  FILLER  PIC X(32)  VALUE '********************************'.
    59 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    60 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    61 77  s1                          pic s999 comp-3 value+0.
    62 77  s2                          pic s999 comp-3 value+0.
    63 77  a1                          pic s999 comp-3 value+0.
    64 77  WS-CRITICAL-PERIOD          PIC 99    VALUE ZEROS.
    65 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    66 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    67 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    68 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    69 77  ws-max-extension            pic s999 comp-3 value +0.
    70 77  ws-max-moben                pic s9(7)v99 comp-3 value +0.
    71 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    72 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    73     88  ERPDEF-FOUND                 VALUE 'Y'.
    74 77  WS-TRLR-FILE-EOF            PIC X     VALUE ' '.
    75     88  TRLR-FILE-EOF                VALUE 'Y'.
    76 77  WS-PAYMENT-PENDING          PIC X     VALUE ' '.
    77     88  PAYMENT-PENDING              VALUE 'Y'.
    78 77  WS-AUTH-RCVD                PIC X     VALUE ' '.
    79     88  AUTH-RCVD                    VALUE 'Y'.
    80     88  NO-AUTH-RCVD                 VALUE 'N'.
    81 77  ws-eracct-sw                pic x  value ' '.
    82     88  acct-found                value 'Y'.
    83 77  ws-benper-sw                pic x   value ' '.
    84     88  good-benper               value 'Y'.
    85 77  ws-claim-type               pic x value ' '.
    86 77  ws-ben-per                  pic 99 value 00.
    87 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    88 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    89 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    90 77  ws-max-bens                 pic s9(5) comp-3 value +0.
    91
    92 01  LCP-TIME-OF-DAY-XX.
    93     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    94     05  FILLER                    PIC 99.
    95 01  LCP-CICS-TIME                 PIC 9(15).
    96*                            COPY ELCSCTM.
    97******************************************************************
    98*                                                                *
    99*                                                                *
   100*                            ELCSCTM                             *
   101*                            VMOD=2.001                          *
   102*                                                                *
   103*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   104*                                                                *
   105******************************************************************
   106 01  SECURITY-MESSAGE.
   107     12  FILLER                          PIC X(30)
   108            VALUE '** LOGIC SECURITY VIOLATION -'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page   4
* EL131.cbl
   109     12  SM-READ                         PIC X(6).
   110     12  FILLER                          PIC X(5)
   111            VALUE ' PGM='.
   112     12  SM-PGM                          PIC X(6).
   113     12  FILLER                          PIC X(5)
   114            VALUE ' OPR='.
   115     12  SM-PROCESSOR-ID                 PIC X(4).
   116     12  FILLER                          PIC X(6)
   117            VALUE ' TERM='.
   118     12  SM-TERMID                       PIC X(4).
   119     12  FILLER                          PIC XX   VALUE SPACE.
   120     12  SM-JUL-DATE                     PIC 9(5).
   121     12  FILLER                          PIC X    VALUE SPACE.
   122     12  SM-TIME                         PIC 99.99.
   123
   124
   125*                            COPY ELCSCRTY.
   126******************************************************************
   127*                                                                *
   128*                                                                *
   129*                            ELCSCRTY                            *
   130*                            VMOD=2.001                          *
   131*                                                                *
   132*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   133*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   134*        SAVED IN PI-SECURITY-ADDRESS.                           *
   135*                                                                *
   136******************************************************************
   137 01  SECURITY-CONTROL.
   138     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   139     12  FILLER                       PIC XX    VALUE 'SC'.
   140     12  SC-CREDIT-CODES.
   141         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   142             20  SC-CREDIT-DISPLAY    PIC X.
   143             20  SC-CREDIT-UPDATE     PIC X.
   144     12  SC-CLAIMS-CODES.
   145         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   146             20  SC-CLAIMS-DISPLAY    PIC X.
   147             20  SC-CLAIMS-UPDATE     PIC X.
   148
   149*                            COPY ELCNWA.
   150*****************************************************************
   151*                                                               *
   152*                                                               *
   153*                            ELCNWA.                            *
   154*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   155*                            VMOD=2.003                         *
   156*                                                               *
   157*            M O V E   N A M E   W O R K   A R E A.             *
   158*                                                               *
   159*****************************************************************.
   160
   161 01  WS-NAME-WORK-AREA.
   162     05  WS-INSURED-LAST-NAME        PIC X(15).
   163     05  WS-INSURED-1ST-NAME         PIC X(12).
   164     05  WS-INSURED-MID-INIT         PIC X.
   165
   166     05  WS-NAME-WORK.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page   5
* EL131.cbl
   167         10  WS-NW                   PIC X
   168             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   169
   170     05  WS-NAME-WORK2.
   171         10  WS-NW2                  PIC X
   172             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   173                                        NWA-INDEX0.
   174
   175     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   176                                     COMP-3.
   177
   178
   179 01  ws-dcc-error-line.
   180     05  filler occurs 15.
   181         10  ws-error-no        pic x(4).
   182 01  WS-DATE-AREA.
   183     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   184     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
   185     12  SAVE-DATE-CCYYMMDD.
   186         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   187         16  SAVE-DATE-YMD.
   188             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   189             20  FILLER         PIC X(4)    VALUE SPACES.
   190
   191 01  WS-BLANK                   PIC X       VALUE ' '.
   192
   193 01  CSO-WORK-FIELDS.
   194     05  WS-HOLD-CLAIM-STATUS    PIC X.
   195     05  WS-CRIT-PER-RECURRENT   PIC 99    VALUE 00.
   196     05  WS-CRIT-PER-ALPHA REDEFINES WS-CRIT-PER-RECURRENT.
   197         10  WS-RECURRENT-YN     PIC X.
   198         10  FILLER              PIC X.
   199
   200 01  LITERALS-NUMBERS.
   201     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   202     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   203     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
   204     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   205     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   206     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   207     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   208     12  MAP-LENGTH              PIC S9(4)   VALUE +1060  COMP.
   209
   210     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   211     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   212     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   213     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   214     12  XCTL-EL114              PIC X(8)    VALUE 'EL114'.
   215     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   216     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   217     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   218     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   219     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   220
   221     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   222
   223     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   224
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page   6
* EL131.cbl
   225     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   226     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   227     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   228     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   229     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   230     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   231     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   232     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   233     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   234     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   235     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   236     12  WS-CONTEST-NOTE      PIC X(44)
   237         VALUE 'CONTRACT NOW CONTESTABLE - INC/RPT DT CHGD'.
   238
   239     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   240     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   241     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   242     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   243         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   244     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   245     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   246     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   247     12  WS-ICD-CODE-1           PIC X(8).
   248     12  WS-ICD-CODE-2           PIC X(8).
   249     12  WS-CLAIM-SEQU.
   250         16  FILLER              PIC X VALUE '('.
   251         16  WS-CURRENT-SEQU     PIC Z9.
   252         16  FILLER              PIC X(04) VALUE ' OF '.
   253         16  WS-OF-SEQU          PIC Z9.
   254         16  FILLER              PIC X VALUE ')'.
   255     12  WS-EDIT-BEN-CODE        PIC XX.
   256         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   257                                          '90' THRU '99'.
   258
   259     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   260     12  WS-EDIT-NUMBER          PIC ZZZ9.
   261
   262     12  WS-RESPONSE             PIC S9(8)   COMP.
   263         88  WS-RESP-NORMAL              VALUE +00.
   264         88  WS-RESP-ERROR               VALUE +01.
   265         88  WS-RESP-NOTFND              VALUE +13.
   266         88  WS-RESP-DUPKEY              VALUE +15.
   267         88  WS-RESP-NOTOPEN             VALUE +19.
   268         88  WS-RESP-ENDFILE             VALUE +20.
   269
   270     12  WS-MOS-PAID             PIC 999.
   271     12  WS-ODD-DAYS             PIC 99.
   272     12  WS-REM-MOS              PIC 999.
   273     12  WS-REM-DAYS             PIC 99.
   274     12  WS-TERM-IN-DAYS         PIC 9(4).
   275     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   276
   277     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
   278     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   279     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   280     12  WS-RESET-SW             PIC X       VALUE 'N'.
   281     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   282     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page   7
* EL131.cbl
   283     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   284
   285 01  DMD-DATE-YYYYMMDD.
   286     12  DMD-DECADE          PIC XX      VALUE SPACES.
   287     12  DMD-YYMMDD.
   288         16  DMD-YY          PIC XX      VALUE SPACES.
   289         16  DMD-MM          PIC XX      VALUE SPACES.
   290         16  DMD-DD          PIC XX      VALUE SPACES.
   291
   292 01  DMD-DATE-MMDDYYYY.
   293     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   294     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   295     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   296     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   297     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   298     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   299
   300 01  WS-MAIL-CODE.
   301     12  FILLER              PIC X.
   302     12  DMD-MAIL-CODE.
   303         16  WS-MAIL-4       PIC X(4).
   304         16  WS-MAIL-5       PIC X.
   305     12  FILLER              PIC X(4).
   306
   307     12  W-NAME-LAST             PIC  X(15).
   308     12  W-NAME-FIRST            PIC  X(15).
   309     12  W-NAME-MIDDLE.
   310         16  FILLER              PIC  X.
   311         16  W-NAME-MIDDLE-2     PIC  X.
   312         16  FILLER              PIC  X(13).
   313
   314*    COPY ELCDCTB.
   315******************************************************************
   316*                                                                *
   317*                                                                *
   318*                            ELCDCTB.                            *
   319*                            VMOD=2.002                          *
   320*                                                                *
   321*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   322*       COMMUNICATIONS AREA                                      *
   323*                                                                *
   324******************************************************************
   325 01  DCT-COMMUNICATION-AREA.
   326     12  DCT-BILLING-BANK-ID      PIC  X(05).
   327     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   328     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   329     12  DCT-PRODUCT-CODE         PIC  X(02).
   330     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   331     12  DCT-RETURN-CODE          PIC  X(02).
   332     12  DCT-MAIL-CODE            PIC  X(05).
   333     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   334     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page   8
* EL131.cbl
   336 01  ERROR-SWITCHES.
   337     12  ERROR-SWITCH            PIC X.
   338         88  SCREEN-ERROR                    VALUE 'X'.
   339     12  MSTR-KEY-SWITCH         PIC X.
   340         88  MSTR-KEY-CHANGED                VALUE 'X'.
   341     12  CERT-KEY-SWITCH         PIC X.
   342*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   343         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   344*********SET TO Y IF PRIMARY KEY WILL CHANGE
   345         88  CERT-KEY-CHANGED                VALUE 'Y'.
   346     12  MSTR-SWITCH             PIC X.
   347         88  MSTR-UPDATES                    VALUE 'X'.
   348     12  crtt-switch             pic x value spaces.
   349         88  crtt-update             value 'X'.
   350     12  CERT-SWITCH             PIC X.
   351         88  CERT-UPDATES                    VALUE 'X'.
   352     12  UPDATE-SWITCH           PIC X.
   353         88  UPDATES-PRESENT                 VALUE 'X'.
   354     12  TRLR-SWITCH             PIC X.
   355         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   356         88  UPDATE-MADE                     VALUE 'Y'.
   357     12  NINETY-TRLR-SWITCH      PIC X.
   358         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   359     12  NINETY5-TRLR-SWITCH      PIC X  VALUE ' '.
   360         88  NINETY5-TRLR-UPDATED             VALUE 'X'.
   361     12  EARNINGS-CALC-SWITCH    PIC X.
   362         88  TEX-REG                         VALUE '4'.
   363         88  NET-PAY                         VALUE '5'.
   364     12  DLYACTV-SW              PIC X       VALUE 'N'.
   365         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page   9
* EL131.cbl
   367 01  EDIT-WORK-AREA.
   368     12  COUNT-2                 PIC 9.
   369     12  CALL-PGM                PIC X(8).
   370     12  TRANS-ID                PIC X(4).
   371     12  CHECK-PFKEYS            PIC 99.
   372     12  CHECK-MAINT             PIC X.
   373         88  ADD-ALPHA-RECORD                VALUE 'A'.
   374         88  CHANGE-CLAIM                    VALUE 'C'.
   375         88  DELETE-CLAIM                    VALUE 'D'.
   376         88  CHANGE-NAME                     VALUE 'N'.
   377         88  VALID-OPTIONS                   VALUE 'A' 'C'
   378                                                   'D' 'N'.
   379
   380     12  HOLD-BENEFIT            PIC XX.
   381     12  HOLD-FREQ               PIC XX.
   382     12  HOLD-REPORTED           PIC XX  VALUE LOW-VALUES.
   383     12  HOLD-INCUR              PIC XX  VALUE LOW-VALUES.
   384     12  HOLD-PDTHRU             PIC XX.
   385     12  HOLD-ADDON              PIC XX.
   386     12  HOLD-NODAYS             PIC 9(4).
   387     12  HOLD-NOPMTS             PIC 9(3).
   388     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   389     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   390     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   391     12  HOLD-BIRTH              PIC XX.
   392     12  HOLD-END                PIC XX.
   393     12  HOLD-EFF                PIC XX.
   394     12  HOLD-ENTRY              PIC XX.
   395     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   396     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   397     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   398     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   399     12  HOLD-LF-CV-CAN          PIC XX.
   400     12  HOLD-AH-CV-CAN          PIC XX.
   401     12  DIVIDE-QUOT             PIC 9(3).
   402     12  DIVIDE-REM              PIC 9(3).
   403
   404     12  WS-ALPHA-DATE.
   405         16  WS-ALPHA-YEAR.
   406             20  WS-ALPHA-YY-1   PIC 99.
   407             20  WS-ALPHA-YY-2   PIC 99.
   408         16  WS-ALPHA-MM         PIC 99.
   409         16  WS-ALPHA-DD         PIC 99.
   410
   411     12  BUILD-VALID-DATE.
   412         16  BUILD-MONTH         PIC 99.
   413         16  BUILD-DAY           PIC 99.
   414         16  BUILD-YEAR          PIC 99.
   415     12  DEEDIT-MMYY-INPUT.
   416         16  FILLER              PIC X.
   417         16  DEEDIT-MONTH        PIC XX.
   418         16  DEEDIT-YEAR         PIC XX.
   419     12  DEEDIT-BEN              PIC 9(9)V99.
   420     12  DEEDIT-DATE-INPUT.
   421         16  FILLER              PIC XX.
   422         16  DEEDIT-DATE         PIC X(6).
   423     12  WORK-DATE-MDY.
   424         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  10
* EL131.cbl
   425         16  FILLER              PIC X(4).
   426         16  YEAR-WORK           PIC XX.
   427     12  WORK-DATE-MY.
   428         16  WORK-MONTH          PIC XX.
   429         16  WORK-SLASH          PIC X       VALUE '/'.
   430         16  WORK-YEAR           PIC XX.
   431     12  HOLD-DATE.
   432         16  HOLD-MONTH          PIC 99.
   433         16  FILLER              PIC X(4).
   434         16  HOLD-YEAR           PIC 99.
   435     12  SPLIT-INFO-LINE-1.
   436         16  SPLIT-INFO-DESC     PIC X(15).
   437         16  FILLER              PIC X(5)    VALUE ' OLD='.
   438         16  SPLIT-INFO-OLD      PIC X(40).
   439     12  EFF-TERM-MO             PIC 9(4).
   440     12  CURR-MO                 PIC 9(4).
   441     12  WS-BIN-CURRENT-DT       PIC XX.
   442     12  WS-CALC-METHOD          PIC X.
   443     12  WS-INITIALS.
   444         16  WS-INIT-1           PIC X.
   445         16  WS-INIT-2           PIC X.
   446     12  WS-REIN-TABLE.
   447         16  WS-REIN-1           PIC X.
   448         16  WS-REIN-2           PIC X.
   449         16  WS-REIN-3           PIC X.
   450     12  PI-KEY.
   451         16  PI-TERM             PIC X(4).
   452         16  PI-QUAL             PIC X(4).
   453     12  CHECK-KEY               PIC X(20).
   454     12  SAVE-ACCT-KEY           PIC X(20).
   455     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   456     12  WS-SOC-SEC-NUMBER.
   457         16  WS-SOC-SEC-NO       PIC 9(9).
   458         16  WS-SOC-SEC-BLANK    PIC X(2).
   459     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   460         16  WS-SSN-1-3          PIC 9(3).
   461         16  WS-SSN-DASH1        PIC X(1).
   462         16  WS-SSN-4-5          PIC 9(2).
   463         16  WS-SSN-DASH2        PIC X(1).
   464         16  WS-SSN-6-9          PIC 9(4).
   465     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   466     12  WS-RETURNED-FROM        PIC X(8)  VALUE SPACES.
   467
   468 01  WS-SAVE-FIELDS.
   469     12  WS-SAVE-BENEFICIARY     PIC X(10) VALUE LOW-VALUES.
   470     12  WS-SAVE-MAINTI          PIC X(1) VALUE LOW-VALUES.
   471     12  WS-SAVE-MAINTL          PIC S9(4) COMP VALUE +0.
   472     12  WS-SAVE-STATUSI         PIC X(6) VALUE LOW-VALUES.
   473     12  WS-SAVE-STATUSL         PIC S9(4) COMP VALUE +0.
   474     12  WS-SAVE-REPI            PIC X(8) VALUE LOW-VALUES.
   475     12  WS-SAVE-REPL            PIC S9(4) COMP VALUE +0.
   476     12  WS-SAVE-CAUSEI          PIC X(6) VALUE LOW-VALUES.
   477     12  WS-SAVE-CAUSEL          PIC S9(4) COMP VALUE +0.
   478     12  WS-SAVE-ENDI            PIC X(8) VALUE LOW-VALUES.
   479     12  WS-SAVE-ENDL            PIC S9(4) COMP VALUE +0.
   480     12  WS-SAVE-DIAGI           PIC X(60) VALUE LOW-VALUES.
   481     12  WS-SAVE-DIAGL           PIC S9(4) COMP VALUE +0.
   482     12  WS-SAVE-ICD1I           PIC X(8)  VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  11
* EL131.cbl
   483     12  WS-SAVE-ICD1L           PIC S9(4) COMP VALUE +0.
   484     12  WS-SAVE-ICD2I           PIC X(8)  VALUE LOW-VALUES.
   485     12  WS-SAVE-ICD2L           PIC S9(4) COMP VALUE +0.
   486     12  WS-SAVE-BENEI           PIC X(10) VALUE LOW-VALUES.
   487     12  WS-SAVE-BENEL           PIC S9(4) COMP VALUE +0.
   488     12  WS-SAVE-BIRTHI          PIC X(8) VALUE LOW-VALUES.
   489     12  WS-SAVE-BIRTHL          PIC S9(4) COMP VALUE +0.
   490     12  WS-SAVE-SOCIALI         PIC X(11) VALUE LOW-VALUES.
   491     12  WS-SAVE-SOCIALL         PIC S9(4) COMP VALUE +0.
   492     12  WS-SAVE-SEXI            PIC X(1) VALUE LOW-VALUES.
   493     12  WS-SAVE-SEXL            PIC S9(4) COMP VALUE +0.
   494     12  WS-SAVE-MLNAMEI         PIC X(15) VALUE LOW-VALUES.
   495     12  WS-SAVE-MLNAMEL         PIC S9(4) COMP VALUE +0.
   496     12  WS-SAVE-MFNAMEI         PIC X(12) VALUE LOW-VALUES.
   497     12  WS-SAVE-MFNAMEL         PIC S9(4) COMP VALUE +0.
   498     12  WS-SAVE-MMINITI         PIC X(1) VALUE LOW-VALUES.
   499     12  WS-SAVE-MMINITL         PIC S9(4) COMP VALUE +0.
   500     12  WS-SAVE-LOANNOI         PIC X(8) VALUE LOW-VALUES.
   501     12  WS-SAVE-LOANNOL         PIC S9(4) COMP VALUE +0.
   502     12  WS-SAVE-LOANBALI        PIC 9(7)V99 VALUE ZEROS.
   503     12  WS-SAVE-LOANBALL        PIC S9(4) COMP VALUE +0.
   504     12  WS-SAVE-PROCI           PIC X(4) VALUE LOW-VALUES.
   505     12  WS-SAVE-PROCL           PIC S9(4) COMP VALUE +0.
   506     12  WS-SAVE-SUPVI           PIC X(1) VALUE LOW-VALUES.
   507     12  WS-SAVE-SUPVL           PIC S9(4) COMP VALUE +0.
   508     12  WS-SAVE-PRICDI          PIC X(1) VALUE LOW-VALUES.
   509     12  WS-SAVE-PRICDL          PIC S9(4) COMP VALUE +0.
   510     12  WS-SAVE-FILETOI         PIC X(4) VALUE LOW-VALUES.
   511     12  WS-SAVE-FILETOL         PIC S9(4) COMP VALUE +0.
   512     12  WS-SAVE-PDTHRUI         PIC X(8) VALUE LOW-VALUES.
   513     12  WS-SAVE-PDTHRUL         PIC S9(4) COMP VALUE +0.
   514     12  WS-SAVE-PDAMTI          PIC 9(7)V99 VALUE ZEROS.
   515     12  WS-SAVE-PDAMTL          PIC S9(4) COMP VALUE +0.
   516     12  WS-SAVE-NODAYSI         PIC 9(5) VALUE ZEROS.
   517     12  WS-SAVE-NODAYSL         PIC S9(4) COMP VALUE +0.
   518     12  WS-SAVE-NOPMTSI         PIC 9(4) VALUE ZEROS.
   519     12  WS-SAVE-NOPMTSL         PIC S9(4) COMP VALUE +0.
   520     12  WS-SAVE-FORMTYPI        PIC X(1) VALUE LOW-VALUES.
   521     12  WS-SAVE-FORMTYPL        PIC S9(4) COMP VALUE +0.
   522     12  WS-SAVE-OCCI            PIC X(6) VALUE LOW-VALUES.
   523     12  WS-SAVE-OCCL            PIC S9(4) COMP VALUE +0.
   524
   525 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   526     12  M                   PIC S9(7)V99           VALUE ZEROS.
   527     12  L                   PIC S9(7)V99           VALUE ZEROS.
   528     12  N                   PIC S9(3)              VALUE ZEROS.
   529     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   530     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   531     12  I                   PIC S99V9(5)           VALUE ZEROS.
   532     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   533     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   534     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   535     12  R                   PIC S9(3)              VALUE ZEROS.
   536     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   537     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   538     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   539     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   540     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  12
* EL131.cbl
   541     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   542     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   543     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   544     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   545
   546 01  TERM-CALC-WORK-AREA.
   547     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   548     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   549     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   550     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   551     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   552     12  V-EXPONENTS.
   553        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   554     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   555
   556 01  TIME-IN.
   557     12  UN-HOURS                PIC XX.
   558     12  UN-MINUTES              PIC XX.
   559     12  FILLER                  PIC XX.
   560
   561 01  TIME-OUT.
   562     12  FOR-HOURS               PIC XX.
   563     12  FILLER                  PIC X       VALUE '.'.
   564     12  FOR-MINUTES             PIC XX.
   565
   566 01  ERROR-NUMBERS.
   567     12  ER-0000                 PIC X(4)    VALUE '0000'.
   568     12  ER-0004                 PIC X(4)    VALUE '0004'.
   569     12  ER-0008                 PIC X(4)    VALUE '0008'.
   570     12  ER-0023                 PIC X(4)    VALUE '0023'.
   571     12  ER-0029                 PIC X(4)    VALUE '0029'.
   572     12  ER-0068                 PIC X(4)    VALUE '0068'.
   573     12  ER-0070                 PIC X(4)    VALUE '0070'.
   574     12  ER-0149                 PIC X(4)    VALUE '0149'.
   575     12  ER-0154                 PIC X(4)    VALUE '0154'.
   576     12  ER-0169                 PIC X(4)    VALUE '0169'.
   577     12  ER-0192                 PIC X(4)    VALUE '0192'.
   578     12  ER-0199                 PIC X(4)    VALUE '0199'.
   579     12  ER-0203                 PIC X(4)    VALUE '0203'.
   580     12  ER-0204                 PIC X(4)    VALUE '0204'.
   581     12  ER-0205                 PIC X(4)    VALUE '0205'.
   582     12  ER-0206                 PIC X(4)    VALUE '0206'.
   583     12  ER-0208                 PIC X(4)    VALUE '0208'.
   584     12  ER-0210                 PIC X(4)    VALUE '0210'.
   585     12  ER-0215                 PIC X(4)    VALUE '0215'.
   586     12  ER-0219                 PIC X(4)    VALUE '0219'.
   587     12  ER-0220                 PIC X(4)    VALUE '0220'.
   588     12  ER-0222                 PIC X(4)    VALUE '0222'.
   589     12  ER-0223                 PIC X(4)    VALUE '0223'.
   590     12  ER-0224                 PIC X(4)    VALUE '0224'.
   591     12  ER-0227                 PIC X(4)    VALUE '0227'.
   592     12  ER-0230                 PIC X(4)    VALUE '0230'.
   593     12  ER-0232                 PIC X(4)    VALUE '0232'.
   594     12  ER-0233                 PIC X(4)    VALUE '0233'.
   595     12  ER-0236                 PIC X(4)    VALUE '0236'.
   596     12  ER-0237                 PIC X(4)    VALUE '0237'.
   597     12  ER-0238                 PIC X(4)    VALUE '0238'.
   598     12  ER-0240                 PIC X(4)    VALUE '0240'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  13
* EL131.cbl
   599     12  ER-0241                 PIC X(4)    VALUE '0241'.
   600     12  ER-0243                 PIC X(4)    VALUE '0243'.
   601     12  ER-0244                 PIC X(4)    VALUE '0244'.
   602     12  ER-0246                 PIC X(4)    VALUE '0246'.
   603     12  ER-0247                 PIC X(4)    VALUE '0247'.
   604     12  ER-0248                 PIC X(4)    VALUE '0248'.
   605     12  ER-0250                 PIC X(4)    VALUE '0250'.
   606     12  ER-0251                 PIC X(4)    VALUE '0251'.
   607     12  ER-0253                 PIC X(4)    VALUE '0253'.
   608     12  ER-0256                 PIC X(4)    VALUE '0256'.
   609     12  ER-0257                 PIC X(4)    VALUE '0257'.
   610     12  ER-0258                 PIC X(4)    VALUE '0258'.
   611     12  ER-0259                 PIC X(4)    VALUE '0259'.
   612     12  ER-0260                 PIC X(4)    VALUE '0260'.
   613     12  ER-0261                 PIC X(4)    VALUE '0261'.
   614     12  ER-0262                 PIC X(4)    VALUE '0262'.
   615     12  ER-0263                 PIC X(4)    VALUE '0263'.
   616     12  ER-0273                 PIC X(4)    VALUE '0273'.
   617     12  ER-0274                 PIC X(4)    VALUE '0274'.
   618     12  ER-0276                 PIC X(4)    VALUE '0276'.
   619     12  ER-0282                 PIC X(4)    VALUE '0282'.
   620     12  ER-0283                 PIC X(4)    VALUE '0283'.
   621     12  ER-0309                 PIC X(4)    VALUE '0309'.
   622     12  ER-0310                 PIC X(4)    VALUE '0310'.
   623     12  ER-0311                 PIC X(4)    VALUE '0311'.
   624     12  ER-0333                 PIC X(4)    VALUE '0333'.
   625     12  ER-0360                 PIC X(4)    VALUE '0360'.
   626     12  ER-0377                 PIC X(4)    VALUE '0377'.
   627     12  ER-0402                 PIC X(4)    VALUE '0402'.
   628     12  ER-0416                 PIC X(4)    VALUE '0416'.
   629     12  ER-0426                 PIC X(4)    VALUE '0426'.
   630     12  ER-0427                 PIC X(4)    VALUE '0427'.
   631     12  ER-0428                 PIC X(4)    VALUE '0428'.
   632     12  ER-0429                 PIC X(4)    VALUE '0429'.
   633     12  ER-0430                 PIC X(4)    VALUE '0430'.
   634     12  ER-0458                 PIC X(4)    VALUE '0458'.
   635     12  ER-0475                 PIC X(4)    VALUE '0475'.
   636     12  ER-0491                 PIC X(4)    VALUE '0491'.
   637     12  ER-0509                 PIC X(4)    VALUE '0509'.
   638     12  ER-0510                 PIC X(4)    VALUE '0510'.
   639     12  ER-0511                 PIC X(4)    VALUE '0511'.
   640     12  ER-0512                 PIC X(4)    VALUE '0512'.
   641     12  ER-0519                 PIC X(4)    VALUE '0519'.
   642     12  ER-0520                 PIC X(4)    VALUE '0520'.
   643     12  ER-0521                 PIC X(4)    VALUE '0521'.
   644     12  ER-0547                 PIC X(4)    VALUE '0547'.
   645     12  ER-0548                 PIC X(4)    VALUE '0548'.
   646     12  ER-0549                 PIC X(4)    VALUE '0549'.
   647     12  ER-0565                 PIC X(4)    VALUE '0565'.
   648     12  ER-0598                 PIC X(4)    VALUE '0598'.
   649     12  ER-0639                 PIC X(4)    VALUE '0639'.
   650     12  ER-0797                 PIC X(4)    VALUE '0797'.
   651     12  ER-0802                 PIC X(4)    VALUE '0802'.
   652     12  ER-0803                 PIC X(4)    VALUE '0803'.
   653     12  ER-0849                 PIC X(4)    VALUE '0849'.
   654     12  ER-0885                 PIC X(4)    VALUE '0885'.
   655     12  ER-0887                 PIC X(4)    VALUE '0887'.
   656     12  ER-0919                 PIC X(4)    VALUE '0919'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  14
* EL131.cbl
   657     12  ER-0921                 PIC X(4)    VALUE '0921'.
   658     12  ER-0938                 PIC X(4)    VALUE '0938'.
   659     12  ER-0946                 PIC X(4)    VALUE '0946'.
   660     12  ER-0947                 PIC X(4)    VALUE '0947'.
   661     12  ER-0948                 PIC X(4)    VALUE '0948'.
   662     12  ER-0949                 PIC X(4)    VALUE '0949'.
   663     12  ER-0950                 PIC X(4)    VALUE '0950'.
   664     12  ER-0951                 PIC X(4)    VALUE '0951'.
   665     12  ER-0954                 PIC X(4)    VALUE '0954'.
   666     12  ER-0974                 PIC X(4)    VALUE '0974'.
   667     12  ER-0975                 PIC X(4)    VALUE '0975'.
   668     12  ER-0992                 PIC X(4)    VALUE '0992'.
   669     12  er-1581                 pic x(4)    value '1581'.
   670     12  ER-1651                 PIC X(4)    VALUE '1651'.
   671     12  ER-1652                 PIC X(4)    VALUE '1652'.
   672     12  ER-1653                 PIC X(4)    VALUE '1653'.
   673     12  ER-1654                 PIC X(4)    VALUE '1654'.
   674     12  ER-1655                 PIC X(4)    VALUE '1655'.
   675     12  er-1656                 pic x(4)    value '1656'.
   676     12  ER-1661                 PIC X(4)    VALUE '1661'.
   677     12  ER-1662                 PIC X(4)    VALUE '1662'.
   678     12  ER-1663                 PIC X(4)    VALUE '1663'.
   679     12  er-1664                 pic x(4)    value '1664'.
   680     12  er-1665                 pic x(4)    value '1665'.
   681     12  er-1666                 pic x(4)    value '1666'.
   682     12  er-1668                 pic x(4)    value '1668'.
   683     12  er-1669                 pic x(4)    value '1669'.
   684     12  er-1676                 pic x(4)    value '1676'.
   685     12  ER-1678                 PIC X(4)    VALUE '1678'.
   686     12  ER-1679                 PIC X(4)    VALUE '1679'.
   687     12  ER-1772                 PIC X(4)    VALUE '1772'.
   688     12  ER-1773                 PIC X(4)    VALUE '1773'.
   689     12  ER-1778                 PIC X(4)    VALUE '1778'.
   690     12  ER-2280                 PIC X(4)    VALUE '2280'.
   691     12  ER-2878                 PIC X(4)    VALUE '2878'.
   692     12  ER-7641                 PIC X(4)    VALUE '7641'.
   693     12  ER-7642                 PIC X(4)    VALUE '7642'.
   694     12  ER-7650                 PIC X(4)    VALUE '7650'.
   695     12  ER-7651                 PIC X(4)    VALUE '7651'.
   696     12  ER-7687                 PIC X(4)    VALUE '7687'.
   697     12  ER-7689                 PIC X(4)    VALUE '7689'.
   698     12  ER-7690                 PIC X(4)    VALUE '7690'.
   699     12  ER-7691                 PIC X(4)    VALUE '7691'.
   700     12  ER-8003                 PIC X(4)    VALUE '8003'.
   701     12  ER-8051                 PIC X(4)    VALUE '8051'.
   702     12  ER-8052                 PIC X(4)    VALUE '8052'.
   703     12  ER-8053                 PIC X(4)    VALUE '8053'.
   704     12  ER-8054                 PIC X(4)    VALUE '8054'.
   705     12  ER-8055                 PIC X(4)    VALUE '8055'.
   706     12  ER-8056                 PIC X(4)    VALUE '8056'.
   707     12  ER-8057                 PIC X(4)    VALUE '8057'.
   708     12  ER-8058                 PIC X(4)    VALUE '8058'.
   709     12  ER-8059                 PIC X(4)    VALUE '8059'.
   710     12  ER-8060                 PIC X(4)    VALUE '8060'.
   711     12  ER-8061                 PIC X(4)    VALUE '8061'.
   712     12  ER-8062                 PIC X(4)    VALUE '8062'.
   713     12  ER-8063                 PIC X(4)    VALUE '8063'.
   714     12  ER-8064                 PIC X(4)    VALUE '8064'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  15
* EL131.cbl
   715     12  ER-8065                 PIC X(4)    VALUE '8065'.
   716     12  ER-8066                 PIC X(4)    VALUE '8066'.
   717     12  ER-8152                 PIC X(4)    VALUE '8152'.
   718     12  ER-8153                 PIC X(4)    VALUE '8153'.
   719     12  ER-8154                 PIC X(4)    VALUE '8154'.
   720     12  ER-8155                 PIC X(4)    VALUE '8155'.
   721 01  ERPDEF-KEY-SAVE             PIC X(18).
   722 01  ERPDEF-KEY.
   723     12  ERPDEF-COMPANY-CD       PIC X.
   724     12  ERPDEF-STATE            PIC XX.
   725     12  ERPDEF-PROD-CD          PIC XXX.
   726     12  F                       PIC X(7).
   727     12  ERPDEF-BEN-TYPE         PIC X.
   728     12  ERPDEF-BEN-CODE         PIC XX.
   729     12  ERPDEF-EXP-DT           PIC XX.
   730 01  MSTR-KEY.
   731     12  COMPANY-CODE            PIC X.
   732     12  CARRIER-CODE            PIC X.
   733     12  CLAIM-NO                PIC X(7).
   734     12  CERT-NO.
   735         16  CERT-NO-PRIME       PIC X(10).
   736         16  CERT-NO-SUFX        PIC X.
   737
   738 01  WS-SAVE-CLAIM-KEY.
   739     12  WS-SAVE-COMPANY-CD      PIC X.
   740     12  WS-SAVE-CARRIER         PIC X.
   741     12  WS-SAVE-CLAIM-NO        PIC X(7).
   742     12  WS-SAVE-CERT-NO.
   743         16  WS-CERT-NO-PRIME    PIC X(10).
   744         16  WS-CERT-NO-SUFX     PIC X.
   745
   746 01  CERT-KEY.
   747     12  CERT-COMPANY-CODE       PIC X.
   748     12  CERT-CARRIER            PIC X.
   749     12  CERT-GROUP              PIC X(6).
   750     12  CERT-STATE              PIC XX.
   751     12  CERT-ACCOUNT            PIC X(10).
   752     12  CERT-DATE               PIC XX.
   753     12  CERT-CERT.
   754         16  CERT-CERT-PRIME     PIC X(10).
   755         16  CERT-CERT-SUFX      PIC X.
   756
   757 01  ELCRTT-KEY.
   758     05  CTRLR-COMP-CD       PIC X.
   759     05  CTRLR-CARRIER       PIC X.
   760     05  CTRLR-GROUPING      PIC X(6).
   761     05  CTRLR-STATE         PIC X(2).
   762     05  CTRLR-ACCOUNT       PIC X(10).
   763     05  CTRLR-EFF-DT        PIC XX.
   764     05  CTRLR-CERT-NO       PIC X(11).
   765     05  CTRLR-REC-TYPE      PIC X.
   766 01  NOTE-KEY.
   767     12  NOTE-COMP-CD            PIC X.
   768     12  NOTE-CERT-KEY.
   769         16  NOTE-CARRIER        PIC X.
   770         16  NOTE-GROUP          PIC X(6).
   771         16  NOTE-STATE          PIC XX.
   772         16  NOTE-ACCOUNT        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  16
* EL131.cbl
   773         16  NOTE-DATE           PIC XX.
   774         16  NOTE-CERT-NO        PIC X(11).
   775
   776 01  TRLR-KEY.
   777     12  TRLR-MAIN-KEY.
   778         16  TRLR-COMPANY-CD     PIC X.
   779         16  TRLR-CARRIER        PIC X.
   780         16  TRLR-CLAIM-NO       PIC X(07).
   781         16  TRLR-CERT-NO        PIC X(11).
   782     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   783
   784 01  BENEFIT-KEY.
   785     12  BEN-CO-ID               PIC X(3).
   786     12  BEN-REC-TYPE            PIC X.
   787     12  FILLER                  PIC XX.
   788     12  BEN-ACC-CD              PIC XX.
   789     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   790
   791 01  CNTL-KEY.
   792     12  CNTL-CO-ID              PIC X(3).
   793     12  CNTL-REC-TYPE           PIC X.
   794     12  CNTL-PROC-ID            PIC X(4).
   795     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   796         16  CNTL-STATE-NUMBER   PIC XX.
   797         16  FILLER              PIC XX.
   798     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   799         16  FILLER              PIC X(3).
   800         16  CNTL-CARRIER        PIC X.
   801     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   802
   803 01  ACTQ-KEY                    PIC X(20).
   804
   805 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   806
   807 01  CHKQ-KEY.
   808     12  CHKQ-COMPANY-CODE       PIC X.
   809     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   810     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   811
   812 01  ARCH-KEY.
   813     12  ARCH-COMPANY-CODE       PIC X.
   814     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   815     12  ARCH-RECORD-TYPE        PIC X.
   816     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   817
   818 01  ACCT-KEY.
   819     05  ACCT-PARTIAL-KEY.
   820         12  ACCT-COMPANY-CODE   PIC X.
   821         12  ACCT-CARRIER        PIC X.
   822         12  ACCT-GROUP          PIC X(6).
   823         12  ACCT-STATE          PIC XX.
   824         12  ACCT-ACCOUNT        PIC X(10).
   825     05  ACCT-DATE               PIC XX.
   826
   827 01  WS-ELBENE-KEY.
   828     12  WS-ELBENE-COMPANY-CD    PIC X.
   829     12  WS-ELBENE-RECORD-TYPE   PIC X.
   830     12  WS-ELBENE-ID            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  17
* EL131.cbl
   831
   832 01  ELALPH-KEY.
   833     12  ELALPH-COMPANY-CD       PIC X.
   834     12  ELALPH-SOURCE           PIC X.
   835     12  ELALPH-NAME.
   836         16  ELALPH-LAST-NAME    PIC X(15).
   837         16  ELALPH-FIRST-NAME.
   838             20  ELALPH-FIRST-INIT   PIC X.
   839             20  FILLER              PIC X(11).
   840         16  ELALPH-MIDDLE-INIT  PIC X.
   841     12  ELALPH-DATE             PIC X(08).
   842     12  ELALPH-TIME             PIC S9(04)    COMP.
   843
   844 01  COMP-LENGTHS.
   845     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   846     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   847     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   848     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   849     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   850     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   851     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   852     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   853     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   854     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   855     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   856     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   857     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   858     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  18
* EL131.cbl
   860*                                COPY ELCLNKLT.
   861******************************************************************
   862*                                                                *
   863*                                                                *
   864*                           ELCLNKLT                             *
   865*                            VMOD=2.003                          *
   866*                                                                *
   867*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   868*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   869*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   870*                                                                *
   871*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   872*   COMPLETING THE REQUIRED FIELDS.                              *
   873*                                                                *
   874*   THE CALLING PROGRAM SHOULD CHECK:                            *
   875*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   876*                              9999 INDICATES AN UNKNOWN ABEND   *
   877*                                   WAS DETECTED.                *
   878*                              ALL OTHER VALUES ARE NORMAL ERROR *
   879*                              CODES FOUND IN THE ERROR FILE.    *
   880******************************************************************
   881 01  W-1523-LINKDATA.
   882     12  W-1523-COMMON-PI-DATA.
   883         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   884         16  FILLER              PIC  X(67).
   885         16  W-1523-COMPANY-CD   PIC  X(01).
   886         16  FILLER              PIC  X(10).
   887         16  W-1523-CONTROL-IN-PROGRESS.
   888             20  W-1523-CARRIER  PIC  X(01).
   889             20  W-1523-GROUPING PIC  X(06).
   890             20  W-1523-STATE    PIC  X(02).
   891             20  W-1523-ACCOUNT  PIC  X(10).
   892             20  W-1523-CLAIM-CERT-GRP.
   893                 24  W-1523-CLAIM-NO
   894                                 PIC  X(07).
   895                 24  W-1523-CERT-NO.
   896                     28  W-1523-CERT-PRIME
   897                                 PIC  X(10).
   898                     28  W-1523-CERT-SFX
   899                                 PIC  X(01).
   900                 24  W-1523-CERT-EFF-DT
   901                                 PIC  X(02).
   902         16  FILLER              PIC X(265).
   903
   904     12  W-1523-WORK-AREA.
   905         16  W-1523-FORM-NUMBER  PIC  X(04).
   906         16  W-1523-NUMBER-COPIES
   907                                 PIC  9(01).
   908         16  W-1523-ADDR-TYPE    PIC  X(02).
   909         16  W-1523-FOLLOW-UP-DATE
   910                                 PIC  X(02).
   911         16  W-1523-RESEND-DATE  PIC  X(02).
   912         16  W-1523-ERROR-CODE   PIC  9(04).
   913             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   914             88  W-1523-FATAL-ERROR
   915                                    VALUES  0006 0013 0042
   916                                            0154 0168 0169
   917                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  19
* EL131.cbl
   918                                            0179 0186 0281
   919                                            0332 2055 3697
   920                                            3698 3699 3770
   921                                            3771 3772 7675
   922                                            9106 9808 9883
   923                                            9887.
   924             88  W-1523-STOP-ERRORS
   925                                    VALUES  0013 0042 0154
   926                                            0168 0169 0172
   927                                            0281 0332 2055
   928                                            3698 3699 7675
   929                                            9106 9808 9883
   930                                            9999.
   931         16  W-1523-REASON       PIC  X(70).
   932         16  W-1523-ARCHIVE-NUMBER
   933                                 PIC  9(08).
   934     12  W-1523-POINTER-AREA.
   935         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   936         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   937         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   938         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   939         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  20
* EL131.cbl
   941*                                COPY ELCINTF.
   942******************************************************************
   943*                                                                *
   944*                                                                *
   945*                            ELCINTF.                            *
   946*                            VMOD=2.017                          *
   947*                                                                *
   948*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   949*                                                                *
   950*       LENGTH = 1024                                            *
   951*                                                                *
   952******************************************************************
   953*                   C H A N G E   L O G
   954*
   955* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   956*-----------------------------------------------------------------
   957*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   958* EFFECTIVE    NUMBER
   959*-----------------------------------------------------------------
   960* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   961******************************************************************
   962 01  PROGRAM-INTERFACE-BLOCK.
   963     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   964     12  PI-CALLING-PROGRAM              PIC X(8).
   965     12  PI-SAVED-PROGRAM-1              PIC X(8).
   966     12  PI-SAVED-PROGRAM-2              PIC X(8).
   967     12  PI-SAVED-PROGRAM-3              PIC X(8).
   968     12  PI-SAVED-PROGRAM-4              PIC X(8).
   969     12  PI-SAVED-PROGRAM-5              PIC X(8).
   970     12  PI-SAVED-PROGRAM-6              PIC X(8).
   971     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   972     12  PI-COMPANY-ID                   PIC XXX.
   973     12  PI-COMPANY-CD                   PIC X.
   974
   975     12  PI-COMPANY-PASSWORD             PIC X(8).
   976
   977     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   978
   979     12  PI-CONTROL-IN-PROGRESS.
   980         16  PI-CARRIER                  PIC X.
   981         16  PI-GROUPING                 PIC X(6).
   982         16  PI-STATE                    PIC XX.
   983         16  PI-ACCOUNT                  PIC X(10).
   984         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   985                                         PIC X(10).
   986         16  PI-CLAIM-CERT-GRP.
   987             20  PI-CLAIM-NO             PIC X(7).
   988             20  PI-CERT-NO.
   989                 25  PI-CERT-PRIME       PIC X(10).
   990                 25  PI-CERT-SFX         PIC X.
   991             20  PI-CERT-EFF-DT          PIC XX.
   992         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   993             20  PI-PLAN-CODE            PIC X(2).
   994             20  PI-REVISION-NUMBER      PIC X(3).
   995             20  PI-PLAN-EFF-DT          PIC X(2).
   996             20  PI-PLAN-EXP-DT          PIC X(2).
   997             20  FILLER                  PIC X(11).
   998         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  21
* EL131.cbl
   999             20  PI-OE-REFERENCE-1.
  1000                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1001                 25  PI-OE-REF-1-SUFF    PIC XX.
  1002
  1003     12  PI-SESSION-IN-PROGRESS          PIC X.
  1004         88  CLAIM-SESSION                   VALUE '1'.
  1005         88  CREDIT-SESSION                  VALUE '2'.
  1006         88  WARRANTY-SESSION                VALUE '3'.
  1007         88  MORTGAGE-SESSION                VALUE '4'.
  1008         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1009
  1010
  1011*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1012
  1013     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1014     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1015
  1016     12  PI-CREDIT-USER                  PIC X.
  1017         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1018         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1019
  1020     12  PI-CLAIM-USER                   PIC X.
  1021         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1022         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1023
  1024     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1025         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1026         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1027         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1028         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1029         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1030
  1031     12  PI-PROCESSOR-ID                 PIC X(4).
  1032
  1033     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1034
  1035     12  PI-MEMBER-CAPTION               PIC X(10).
  1036
  1037     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1038         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1039
  1040     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1041     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1042     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1043     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1044
  1045     12  PI-AH-OVERRIDE-L1               PIC X.
  1046     12  PI-AH-OVERRIDE-L2               PIC XX.
  1047     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1048     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1049
  1050     12  PI-NEW-SYSTEM                   PIC X(2).
  1051
  1052     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1053     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1054         88  PI-USES-PAID-TO                 VALUE '1'.
  1055     12  PI-CRDTCRD-SYSTEM.
  1056         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  22
* EL131.cbl
  1057             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1058             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1059         16  PI-CC-MONTH-END-DT          PIC XX.
  1060     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1061
  1062     12  PI-OE-REFERENCE-2.
  1063         16  PI-OE-REF-2-PRIME           PIC X(10).
  1064         16  PI-OE-REF-2-SUFF            PIC X.
  1065
  1066     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1067
  1068     12  PI-LANGUAGE-TYPE                PIC X.
  1069             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1070             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1071             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1072
  1073     12  PI-POLICY-LINKAGE-IND           PIC X.
  1074         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1075         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1076                                                   LOW-VALUES.
  1077
  1078     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1079     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1080         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1081         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1082
  1083     12  PI-PROCESSOR-CSR-IND            PIC X.
  1084         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1085         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1086
  1087     12  FILLER                          PIC X(3).
  1088
  1089     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1090
  1091     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1092         PI-SYSTEM-LEVEL.
  1093
  1094         16  PI-ENTRY-CODES.
  1095             20  PI-ENTRY-CD-1           PIC X.
  1096             20  PI-ENTRY-CD-2           PIC X.
  1097
  1098         16  PI-RETURN-CODES.
  1099             20  PI-RETURN-CD-1          PIC X.
  1100             20  PI-RETURN-CD-2          PIC X.
  1101
  1102         16  PI-UPDATE-STATUS-SAVE.
  1103             20  PI-UPDATE-BY            PIC X(4).
  1104             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1105
  1106         16  PI-LOWER-CASE-LETTERS       PIC X.
  1107             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1108
  1109*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1110*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1111*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1112
  1113         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1114             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  23
* EL131.cbl
  1115             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1116             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1117             88  ACCNT-CNTL                  VALUE '3'.
  1118             88  CARR-ACCNT-CNTL             VALUE '4'.
  1119
  1120         16  PI-PROCESSOR-CAP-LIST.
  1121             20  PI-SYSTEM-CONTROLS.
  1122                24 PI-SYSTEM-DISPLAY     PIC X.
  1123                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1124                24 PI-SYSTEM-MODIFY      PIC X.
  1125                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1126             20  FILLER                  PIC XX.
  1127             20  PI-DISPLAY-CAP          PIC X.
  1128                 88  DISPLAY-CAP             VALUE 'Y'.
  1129             20  PI-MODIFY-CAP           PIC X.
  1130                 88  MODIFY-CAP              VALUE 'Y'.
  1131             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1132                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1133             20  PI-FORCE-CAP            PIC X.
  1134                 88  FORCE-CAP               VALUE 'Y'.
  1135
  1136         16  PI-PROGRAM-CONTROLS.
  1137             20  PI-PGM-PRINT-OPT        PIC X.
  1138             20  PI-PGM-FORMAT-OPT       PIC X.
  1139             20  PI-PGM-PROCESS-OPT      PIC X.
  1140             20  PI-PGM-TOTALS-OPT       PIC X.
  1141
  1142         16  PI-HELP-INTERFACE.
  1143             20  PI-LAST-ERROR-NO        PIC X(4).
  1144             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1145
  1146         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1147             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1148
  1149         16  PI-CR-CONTROL-IN-PROGRESS.
  1150             20  PI-CR-CARRIER           PIC X.
  1151             20  PI-CR-GROUPING          PIC X(6).
  1152             20  PI-CR-STATE             PIC XX.
  1153             20  PI-CR-ACCOUNT           PIC X(10).
  1154             20  PI-CR-FIN-RESP          PIC X(10).
  1155             20  PI-CR-TYPE              PIC X.
  1156
  1157         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1158
  1159         16  PI-CR-MONTH-END-DT          PIC XX.
  1160
  1161         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1162             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1163             88  PI-ZERO-CARRIER             VALUE '1'.
  1164             88  PI-ZERO-GROUPING            VALUE '2'.
  1165             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1166
  1167         16  PI-CARRIER-SECURITY         PIC X.
  1168             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1169
  1170         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1171             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1172             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  24
* EL131.cbl
  1173
  1174         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1175             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1176                                         INDEXED BY PI-ACCESS-NDX
  1177                                         PIC X.
  1178
  1179         16  PI-GA-BILLING-CONTROL       PIC X.
  1180             88  PI-GA-BILLING               VALUE '1'.
  1181
  1182         16  PI-MAIL-PROCESSING          PIC X.
  1183             88  PI-MAIL-YES                 VALUE 'Y'.
  1184
  1185         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1186
  1187         16  PI-AR-SYSTEM.
  1188             20  PI-AR-PROCESSING-CNTL   PIC X.
  1189                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1190             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1191             20  PI-AR-MONTH-END-DT      PIC XX.
  1192
  1193         16  PI-MP-SYSTEM.
  1194             20  PI-MORTGAGE-USER            PIC X.
  1195                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1196                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1197             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1198                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1199                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1200                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1201                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1202                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1203             20  PI-MP-MONTH-END-DT          PIC XX.
  1204             20  PI-MP-REFERENCE-NO.
  1205                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1206                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1207
  1208         16  PI-LABEL-CONTROL            PIC X(01).
  1209             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1210             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1211
  1212         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1213             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1214
  1215         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1216             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1217             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1218
  1219         16  FILLER                      PIC X(14).
  1220
  1221     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1222******************************************************************
  1223     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1224         16  PI-NO-PMTS                    PIC 9(4).
  1225         16  PI-CERT-SWITCH                PIC X.
  1226             88  CREATED-CERT              VALUE '2'.
  1227         16  PI-PREM-TYPE                  PIC X.
  1228         16  PI-SAVE-CERT-NO.
  1229             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1230             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  25
* EL131.cbl
  1231         16  FILLER                        PIC X(46).
  1232         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1233         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1234         16  PI-REC-FOUND-SW               PIC X.
  1235         16  PI-LETTER-SW                  PIC X.
  1236         16  PI-PREV-TRLR-KEY              PIC X(22).
  1237         16  pi-claim-type                 pic x.
  1238         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1239         16  pi-approval-level             pic x.
  1240         16  FILLER                        PIC X(543).
  1241
  1242 01  SAVE-RECORD                 PIC X(450).
  1243
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  26
* EL131.cbl
  1245*                                COPY ELCLOGOF SUPPRESS.
  1246******************************************************************
  1247*                                                                *
  1248*                                                                *
  1249*                            ELCLOGOF.                           *
  1250*                            VMOD=2.001                          *
  1251*                                                                *
  1252*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1253*                                                                *
  1254******************************************************************
  1255 01  CLASIC-LOGOFF.
  1256     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1257     12  LOGOFF-TEXT.
  1258         16  FILLER          PIC X(5)    VALUE SPACES.
  1259         16  LOGOFF-MSG.
  1260             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1261             20  FILLER      PIC X       VALUE SPACES.
  1262             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1263         16  FILLER          PIC X(80)
  1264           VALUE '* YOU ARE NOW LOGGED OFF'.
  1265         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1266         16  FILLER          PIC X       VALUE QUOTE.
  1267         16  LOGOFF-SYS-MSG  PIC X(17)
  1268           VALUE 'S CLAS-IC SYSTEM '.
  1269     12  TEXT-MESSAGES.
  1270         16  UNACCESS-MSG    PIC X(29)
  1271             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1272         16  PGMIDERR-MSG    PIC X(17)
  1273             VALUE 'PROGRAM NOT FOUND'.
  1274
  1275*                                COPY ELCATTR SUPPRESS.
  1276******************************************************************
  1277*                                                                *
  1278*                            ELCATTR.                            *
  1279*                            VMOD=2.001                          *
  1280*                                                                *
  1281*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1282*                                                                *
  1283*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1284*                                                                *
  1285*                   POS 1   P=PROTECTED                          *
  1286*                           U=UNPROTECTED                        *
  1287*                           S=ASKIP                              *
  1288*                   POS 2   A=ALPHA/NUMERIC                      *
  1289*                           N=NUMERIC                            *
  1290*                   POS 3   N=NORMAL                             *
  1291*                           B=BRIGHT                             *
  1292*                           D=DARK                               *
  1293*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1294*                           OF=MODIFIED DATA TAG OFF             *
  1295*                                                                *
  1296*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1297******************************************************************
  1298 01  ATTRIBUTE-LIST.
  1299     12  AL-PABOF            PIC X       VALUE 'Y'.
  1300     12  AL-PABON            PIC X       VALUE 'Z'.
  1301     12  AL-PADOF            PIC X       VALUE '%'.
  1302     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  27
* EL131.cbl
  1303     12  AL-PANOF            PIC X       VALUE '-'.
  1304     12  AL-PANON            PIC X       VALUE '/'.
  1305     12  AL-SABOF            PIC X       VALUE '8'.
  1306     12  AL-SABON            PIC X       VALUE '9'.
  1307     12  AL-SADOF            PIC X       VALUE '@'.
  1308     12  AL-SADON            PIC X       VALUE QUOTE.
  1309     12  AL-SANOF            PIC X       VALUE '0'.
  1310     12  AL-SANON            PIC X       VALUE '1'.
  1311     12  AL-UABOF            PIC X       VALUE 'H'.
  1312     12  AL-UABON            PIC X       VALUE 'I'.
  1313     12  AL-UADOF            PIC X       VALUE '<'.
  1314     12  AL-UADON            PIC X       VALUE '('.
  1315     12  AL-UANOF            PIC X       VALUE ' '.
  1316     12  AL-UANON            PIC X       VALUE 'A'.
  1317     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1318     12  AL-UNBON            PIC X       VALUE 'R'.
  1319     12  AL-UNDOF            PIC X       VALUE '*'.
  1320     12  AL-UNDON            PIC X       VALUE ')'.
  1321     12  AL-UNNOF            PIC X       VALUE '&'.
  1322     12  AL-UNNON            PIC X       VALUE 'J'.
  1323
  1324*                                COPY ELCAID SUPPRESS.
  1325******************************************************************
  1326*                                                                *
  1327*                            ELCAID.                             *
  1328*                            VMOD=2.001                          *
  1329*                                                                *
  1330*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1331*                                                                *
  1332*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1333*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1334******************************************************************
  1335
  1336 01  DFHAID.
  1337   02  DFHNULL   PIC  X  VALUE  ' '.
  1338   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1339   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1340   02  DFHPEN    PIC  X  VALUE  '='.
  1341   02  DFHOPID   PIC  X  VALUE  'W'.
  1342   02  DFHPA1    PIC  X  VALUE  '%'.
  1343   02  DFHPA2    PIC  X  VALUE  '>'.
  1344   02  DFHPA3    PIC  X  VALUE  ','.
  1345   02  DFHPF1    PIC  X  VALUE  '1'.
  1346   02  DFHPF2    PIC  X  VALUE  '2'.
  1347   02  DFHPF3    PIC  X  VALUE  '3'.
  1348   02  DFHPF4    PIC  X  VALUE  '4'.
  1349   02  DFHPF5    PIC  X  VALUE  '5'.
  1350   02  DFHPF6    PIC  X  VALUE  '6'.
  1351   02  DFHPF7    PIC  X  VALUE  '7'.
  1352   02  DFHPF8    PIC  X  VALUE  '8'.
  1353   02  DFHPF9    PIC  X  VALUE  '9'.
  1354   02  DFHPF10   PIC  X  VALUE  ':'.
  1355   02  DFHPF11   PIC  X  VALUE  '#'.
  1356   02  DFHPF12   PIC  X  VALUE  '@'.
  1357   02  DFHPF13   PIC  X  VALUE  'A'.
  1358   02  DFHPF14   PIC  X  VALUE  'B'.
  1359   02  DFHPF15   PIC  X  VALUE  'C'.
  1360   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  28
* EL131.cbl
  1361   02  DFHPF17   PIC  X  VALUE  'E'.
  1362   02  DFHPF18   PIC  X  VALUE  'F'.
  1363   02  DFHPF19   PIC  X  VALUE  'G'.
  1364   02  DFHPF20   PIC  X  VALUE  'H'.
  1365   02  DFHPF21   PIC  X  VALUE  'I'.
  1366*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1367   02  DFHPF22   PIC  X  VALUE  '['.
  1368   02  DFHPF23   PIC  X  VALUE  '.'.
  1369   02  DFHPF24   PIC  X  VALUE  '<'.
  1370   02  DFHMSRE   PIC  X  VALUE  'X'.
  1371   02  DFHSTRF   PIC  X  VALUE  'h'.
  1372   02  DFHTRIG   PIC  X  VALUE  '"'.
  1373 01  FILLER REDEFINES DFHAID.
  1374     12  FILLER                  PIC X(8).
  1375     12  AID-KEYS OCCURS 24 TIMES.
  1376         16  FILLER              PIC X.
  1377
  1378*                                COPY EL131S.
  1379 01  EL131AI.
  1380     05  FILLER            PIC  X(0012).
  1381*    -------------------------------
  1382     05  DATEL PIC S9(0004) COMP.
  1383     05  DATEF PIC  X(0001).
  1384     05  FILLER REDEFINES DATEF.
  1385         10  DATEA PIC  X(0001).
  1386     05  DATEI PIC  X(0008).
  1387*    -------------------------------
  1388     05  TIMEL PIC S9(0004) COMP.
  1389     05  TIMEF PIC  X(0001).
  1390     05  FILLER REDEFINES TIMEF.
  1391         10  TIMEA PIC  X(0001).
  1392     05  TIMEI PIC  X(0005).
  1393*    -------------------------------
  1394     05  SEQUL PIC S9(0004) COMP.
  1395     05  SEQUF PIC  X(0001).
  1396     05  FILLER REDEFINES SEQUF.
  1397         10  SEQUA PIC  X(0001).
  1398     05  SEQUI PIC  X(0010).
  1399*    -------------------------------
  1400     05  COMPL PIC S9(0004) COMP.
  1401     05  COMPF PIC  X(0001).
  1402     05  FILLER REDEFINES COMPF.
  1403         10  COMPA PIC  X(0001).
  1404     05  COMPI PIC  X(0003).
  1405*    -------------------------------
  1406     05  USERIDL PIC S9(0004) COMP.
  1407     05  USERIDF PIC  X(0001).
  1408     05  FILLER REDEFINES USERIDF.
  1409         10  USERIDA PIC  X(0001).
  1410     05  USERIDI PIC  X(0004).
  1411*    -------------------------------
  1412     05  LABEL1L PIC S9(0004) COMP.
  1413     05  LABEL1F PIC  X(0001).
  1414     05  FILLER REDEFINES LABEL1F.
  1415         10  LABEL1A PIC  X(0001).
  1416     05  LABEL1I PIC  X(0011).
  1417*    -------------------------------
  1418     05  PCERTNOL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  29
* EL131.cbl
  1419     05  PCERTNOF PIC  X(0001).
  1420     05  FILLER REDEFINES PCERTNOF.
  1421         10  PCERTNOA PIC  X(0001).
  1422     05  PCERTNOI PIC  X(0010).
  1423*    -------------------------------
  1424     05  PSUFXL PIC S9(0004) COMP.
  1425     05  PSUFXF PIC  X(0001).
  1426     05  FILLER REDEFINES PSUFXF.
  1427         10  PSUFXA PIC  X(0001).
  1428     05  PSUFXI PIC  X(0001).
  1429*    -------------------------------
  1430     05  CCNOL PIC S9(0004) COMP.
  1431     05  CCNOF PIC  X(0001).
  1432     05  FILLER REDEFINES CCNOF.
  1433         10  CCNOA PIC  X(0001).
  1434     05  CCNOI PIC  X(0016).
  1435*    -------------------------------
  1436     05  MAINTL PIC S9(0004) COMP.
  1437     05  MAINTF PIC  X(0001).
  1438     05  FILLER REDEFINES MAINTF.
  1439         10  MAINTA PIC  X(0001).
  1440     05  MAINTI PIC  X(0001).
  1441*    -------------------------------
  1442     05  CLAIML PIC S9(0004) COMP.
  1443     05  CLAIMF PIC  X(0001).
  1444     05  FILLER REDEFINES CLAIMF.
  1445         10  CLAIMA PIC  X(0001).
  1446     05  CLAIMI PIC  X(0007).
  1447*    -------------------------------
  1448     05  CARRL PIC S9(0004) COMP.
  1449     05  CARRF PIC  X(0001).
  1450     05  FILLER REDEFINES CARRF.
  1451         10  CARRA PIC  X(0001).
  1452     05  CARRI PIC  X(0001).
  1453*    -------------------------------
  1454     05  CERTL PIC S9(0004) COMP.
  1455     05  CERTF PIC  X(0001).
  1456     05  FILLER REDEFINES CERTF.
  1457         10  CERTA PIC  X(0001).
  1458     05  CERTI PIC  X(0010).
  1459*    -------------------------------
  1460     05  SUFXL PIC S9(0004) COMP.
  1461     05  SUFXF PIC  X(0001).
  1462     05  FILLER REDEFINES SUFXF.
  1463         10  SUFXA PIC  X(0001).
  1464     05  SUFXI PIC  X(0001).
  1465*    -------------------------------
  1466     05  TYPEL PIC S9(0004) COMP.
  1467     05  TYPEF PIC  X(0001).
  1468     05  FILLER REDEFINES TYPEF.
  1469         10  TYPEA PIC  X(0001).
  1470     05  TYPEI PIC  X(0001).
  1471*    -------------------------------
  1472     05  BENPERL PIC S9(0004) COMP.
  1473     05  BENPERF PIC  X(0001).
  1474     05  FILLER REDEFINES BENPERF.
  1475         10  BENPERA PIC  X(0001).
  1476     05  BENPERI PIC  99.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  30
* EL131.cbl
  1477*    -------------------------------
  1478     05  INSTYPEL PIC S9(0004) COMP.
  1479     05  INSTYPEF PIC  X(0001).
  1480     05  FILLER REDEFINES INSTYPEF.
  1481         10  INSTYPEA PIC  X(0001).
  1482     05  INSTYPEI PIC  X(0001).
  1483*    -------------------------------
  1484     05  STATUSL PIC S9(0004) COMP.
  1485     05  STATUSF PIC  X(0001).
  1486     05  FILLER REDEFINES STATUSF.
  1487         10  STATUSA PIC  X(0001).
  1488     05  STATUSI PIC  X(0006).
  1489*    -------------------------------
  1490     05  INCL PIC S9(0004) COMP.
  1491     05  INCF PIC  X(0001).
  1492     05  FILLER REDEFINES INCF.
  1493         10  INCA PIC  X(0001).
  1494     05  INCI PIC  X(0008).
  1495*    -------------------------------
  1496     05  REPL PIC S9(0004) COMP.
  1497     05  REPF PIC  X(0001).
  1498     05  FILLER REDEFINES REPF.
  1499         10  REPA PIC  X(0001).
  1500     05  REPI PIC  X(0008).
  1501*    -------------------------------
  1502     05  ICD1L PIC S9(0004) COMP.
  1503     05  ICD1F PIC  X(0001).
  1504     05  FILLER REDEFINES ICD1F.
  1505         10  ICD1A PIC  X(0001).
  1506     05  ICD1I PIC  X(0008).
  1507*    -------------------------------
  1508     05  ICD2L PIC S9(0004) COMP.
  1509     05  ICD2F PIC  X(0001).
  1510     05  FILLER REDEFINES ICD2F.
  1511         10  ICD2A PIC  X(0001).
  1512     05  ICD2I PIC  X(0008).
  1513*    -------------------------------
  1514     05  DIAGL PIC S9(0004) COMP.
  1515     05  DIAGF PIC  X(0001).
  1516     05  FILLER REDEFINES DIAGF.
  1517         10  DIAGA PIC  X(0001).
  1518     05  DIAGI PIC  X(0060).
  1519*    -------------------------------
  1520     05  ACCSWL PIC S9(0004) COMP.
  1521     05  ACCSWF PIC  X(0001).
  1522     05  FILLER REDEFINES ACCSWF.
  1523         10  ACCSWA PIC  X(0001).
  1524     05  ACCSWI PIC  X(0001).
  1525*    -------------------------------
  1526     05  BENEL PIC S9(0004) COMP.
  1527     05  BENEF PIC  X(0001).
  1528     05  FILLER REDEFINES BENEF.
  1529         10  BENEA PIC  X(0001).
  1530     05  BENEI PIC  X(0010).
  1531*    -------------------------------
  1532     05  BIRTHL PIC S9(0004) COMP.
  1533     05  BIRTHF PIC  X(0001).
  1534     05  FILLER REDEFINES BIRTHF.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  31
* EL131.cbl
  1535         10  BIRTHA PIC  X(0001).
  1536     05  BIRTHI PIC  X(0008).
  1537*    -------------------------------
  1538     05  SOCIALL PIC S9(0004) COMP.
  1539     05  SOCIALF PIC  X(0001).
  1540     05  FILLER REDEFINES SOCIALF.
  1541         10  SOCIALA PIC  X(0001).
  1542     05  SOCIALI PIC  X(0011).
  1543*    -------------------------------
  1544     05  SEXL PIC S9(0004) COMP.
  1545     05  SEXF PIC  X(0001).
  1546     05  FILLER REDEFINES SEXF.
  1547         10  SEXA PIC  X(0001).
  1548     05  SEXI PIC  X(0001).
  1549*    -------------------------------
  1550     05  MLNAMEL PIC S9(0004) COMP.
  1551     05  MLNAMEF PIC  X(0001).
  1552     05  FILLER REDEFINES MLNAMEF.
  1553         10  MLNAMEA PIC  X(0001).
  1554     05  MLNAMEI PIC  X(0015).
  1555*    -------------------------------
  1556     05  MFNAMEL PIC S9(0004) COMP.
  1557     05  MFNAMEF PIC  X(0001).
  1558     05  FILLER REDEFINES MFNAMEF.
  1559         10  MFNAMEA PIC  X(0001).
  1560     05  MFNAMEI PIC  X(0012).
  1561*    -------------------------------
  1562     05  MMINITL PIC S9(0004) COMP.
  1563     05  MMINITF PIC  X(0001).
  1564     05  FILLER REDEFINES MMINITF.
  1565         10  MMINITA PIC  X(0001).
  1566     05  MMINITI PIC  X(0001).
  1567*    -------------------------------
  1568     05  AUTHRCVL PIC S9(0004) COMP.
  1569     05  AUTHRCVF PIC  X(0001).
  1570     05  FILLER REDEFINES AUTHRCVF.
  1571         10  AUTHRCVA PIC  X(0001).
  1572     05  AUTHRCVI PIC  X(0001).
  1573*    -------------------------------
  1574     05  CRTLNMEL PIC S9(0004) COMP.
  1575     05  CRTLNMEF PIC  X(0001).
  1576     05  FILLER REDEFINES CRTLNMEF.
  1577         10  CRTLNMEA PIC  X(0001).
  1578     05  CRTLNMEI PIC  X(0015).
  1579*    -------------------------------
  1580     05  CRTFNMEL PIC S9(0004) COMP.
  1581     05  CRTFNMEF PIC  X(0001).
  1582     05  FILLER REDEFINES CRTFNMEF.
  1583         10  CRTFNMEA PIC  X(0001).
  1584     05  CRTFNMEI PIC  X(0012).
  1585*    -------------------------------
  1586     05  CRTINITL PIC S9(0004) COMP.
  1587     05  CRTINITF PIC  X(0001).
  1588     05  FILLER REDEFINES CRTINITF.
  1589         10  CRTINITA PIC  X(0001).
  1590     05  CRTINITI PIC  X(0001).
  1591*    -------------------------------
  1592     05  LOANBALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  32
* EL131.cbl
  1593     05  LOANBALF PIC  X(0001).
  1594     05  FILLER REDEFINES LOANBALF.
  1595         10  LOANBALA PIC  X(0001).
  1596     05  LOANBALI PIC  9(7)V99.
  1597*    -------------------------------
  1598     05  PROCL PIC S9(0004) COMP.
  1599     05  PROCF PIC  X(0001).
  1600     05  FILLER REDEFINES PROCF.
  1601         10  PROCA PIC  X(0001).
  1602     05  PROCI PIC  X(0004).
  1603*    -------------------------------
  1604     05  SUPVL PIC S9(0004) COMP.
  1605     05  SUPVF PIC  X(0001).
  1606     05  FILLER REDEFINES SUPVF.
  1607         10  SUPVA PIC  X(0001).
  1608     05  SUPVI PIC  X(0001).
  1609*    -------------------------------
  1610     05  PRICDL PIC S9(0004) COMP.
  1611     05  PRICDF PIC  X(0001).
  1612     05  FILLER REDEFINES PRICDF.
  1613         10  PRICDA PIC  X(0001).
  1614     05  PRICDI PIC  X(0001).
  1615*    -------------------------------
  1616     05  CRITPL PIC S9(0004) COMP.
  1617     05  CRITPF PIC  X(0001).
  1618     05  FILLER REDEFINES CRITPF.
  1619         10  CRITPA PIC  X(0001).
  1620     05  CRITPI PIC  X(0002).
  1621*    -------------------------------
  1622     05  EXTENSL PIC S9(0004) COMP.
  1623     05  EXTENSF PIC  X(0001).
  1624     05  FILLER REDEFINES EXTENSF.
  1625         10  EXTENSA PIC  X(0001).
  1626     05  EXTENSI PIC  99.
  1627*    -------------------------------
  1628     05  FILETOL PIC S9(0004) COMP.
  1629     05  FILETOF PIC  X(0001).
  1630     05  FILLER REDEFINES FILETOF.
  1631         10  FILETOA PIC  X(0001).
  1632     05  FILETOI PIC  X(0004).
  1633*    -------------------------------
  1634     05  PTHRHDGL PIC S9(0004) COMP.
  1635     05  PTHRHDGF PIC  X(0001).
  1636     05  FILLER REDEFINES PTHRHDGF.
  1637         10  PTHRHDGA PIC  X(0001).
  1638     05  PTHRHDGI PIC  X(0010).
  1639*    -------------------------------
  1640     05  PDTHRUL PIC S9(0004) COMP.
  1641     05  PDTHRUF PIC  X(0001).
  1642     05  FILLER REDEFINES PDTHRUF.
  1643         10  PDTHRUA PIC  X(0001).
  1644     05  PDTHRUI PIC  X(0008).
  1645*    -------------------------------
  1646     05  PDAMTL PIC S9(0004) COMP.
  1647     05  PDAMTF PIC  X(0001).
  1648     05  FILLER REDEFINES PDAMTF.
  1649         10  PDAMTA PIC  X(0001).
  1650     05  PDAMTI PIC  9(7)V99.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  33
* EL131.cbl
  1651*    -------------------------------
  1652     05  NODAYSL PIC S9(0004) COMP.
  1653     05  NODAYSF PIC  X(0001).
  1654     05  FILLER REDEFINES NODAYSF.
  1655         10  NODAYSA PIC  X(0001).
  1656     05  NODAYSI PIC  9(5).
  1657*    -------------------------------
  1658     05  NOPMTSL PIC S9(0004) COMP.
  1659     05  NOPMTSF PIC  X(0001).
  1660     05  FILLER REDEFINES NOPMTSF.
  1661         10  NOPMTSA PIC  X(0001).
  1662     05  NOPMTSI PIC  9(4).
  1663*    -------------------------------
  1664     05  FORMTYPL PIC S9(0004) COMP.
  1665     05  FORMTYPF PIC  X(0001).
  1666     05  FILLER REDEFINES FORMTYPF.
  1667         10  FORMTYPA PIC  X(0001).
  1668     05  FORMTYPI PIC  X(0001).
  1669*    -------------------------------
  1670     05  ESTL PIC S9(0004) COMP.
  1671     05  ESTF PIC  X(0001).
  1672     05  FILLER REDEFINES ESTF.
  1673         10  ESTA PIC  X(0001).
  1674     05  ESTI PIC  X(0008).
  1675*    -------------------------------
  1676     05  AUIDL PIC S9(0004) COMP.
  1677     05  AUIDF PIC  X(0001).
  1678     05  FILLER REDEFINES AUIDF.
  1679         10  AUIDA PIC  X(0001).
  1680     05  AUIDI PIC  X(0004).
  1681*    -------------------------------
  1682     05  OCCL PIC S9(0004) COMP.
  1683     05  OCCF PIC  X(0001).
  1684     05  FILLER REDEFINES OCCF.
  1685         10  OCCA PIC  X(0001).
  1686     05  OCCI PIC  X(0006).
  1687*    -------------------------------
  1688     05  MNTDTL PIC S9(0004) COMP.
  1689     05  MNTDTF PIC  X(0001).
  1690     05  FILLER REDEFINES MNTDTF.
  1691         10  MNTDTA PIC  X(0001).
  1692     05  MNTDTI PIC  X(0008).
  1693*    -------------------------------
  1694     05  MNTTYPEL PIC S9(0004) COMP.
  1695     05  MNTTYPEF PIC  X(0001).
  1696     05  FILLER REDEFINES MNTTYPEF.
  1697         10  MNTTYPEA PIC  X(0001).
  1698     05  MNTTYPEI PIC  X(0006).
  1699*    -------------------------------
  1700     05  CERTCARL PIC S9(0004) COMP.
  1701     05  CERTCARF PIC  X(0001).
  1702     05  FILLER REDEFINES CERTCARF.
  1703         10  CERTCARA PIC  X(0001).
  1704     05  CERTCARI PIC  X(0001).
  1705*    -------------------------------
  1706     05  CERTGRPL PIC S9(0004) COMP.
  1707     05  CERTGRPF PIC  X(0001).
  1708     05  FILLER REDEFINES CERTGRPF.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  34
* EL131.cbl
  1709         10  CERTGRPA PIC  X(0001).
  1710     05  CERTGRPI PIC  X(0006).
  1711*    -------------------------------
  1712     05  CERTSTL PIC S9(0004) COMP.
  1713     05  CERTSTF PIC  X(0001).
  1714     05  FILLER REDEFINES CERTSTF.
  1715         10  CERTSTA PIC  X(0001).
  1716     05  CERTSTI PIC  X(0002).
  1717*    -------------------------------
  1718     05  CERTACTL PIC S9(0004) COMP.
  1719     05  CERTACTF PIC  X(0001).
  1720     05  FILLER REDEFINES CERTACTF.
  1721         10  CERTACTA PIC  X(0001).
  1722     05  CERTACTI PIC  X(0010).
  1723*    -------------------------------
  1724     05  CERTEFFL PIC S9(0004) COMP.
  1725     05  CERTEFFF PIC  X(0001).
  1726     05  FILLER REDEFINES CERTEFFF.
  1727         10  CERTEFFA PIC  X(0001).
  1728     05  CERTEFFI PIC  X(0008).
  1729*    -------------------------------
  1730     05  ISSAGEL PIC S9(0004) COMP.
  1731     05  ISSAGEF PIC  X(0001).
  1732     05  FILLER REDEFINES ISSAGEF.
  1733         10  ISSAGEA PIC  X(0001).
  1734     05  ISSAGEI PIC  X(0002).
  1735*    -------------------------------
  1736     05  APRL PIC S9(0004) COMP.
  1737     05  APRF PIC  X(0001).
  1738     05  FILLER REDEFINES APRF.
  1739         10  APRA PIC  X(0001).
  1740     05  APRI PIC  9(4)V9(4).
  1741*    -------------------------------
  1742     05  PMTFREQL PIC S9(0004) COMP.
  1743     05  PMTFREQF PIC  X(0001).
  1744     05  FILLER REDEFINES PMTFREQF.
  1745         10  PMTFREQA PIC  X(0001).
  1746     05  PMTFREQI PIC  99.
  1747*    -------------------------------
  1748     05  INDGRPL PIC S9(0004) COMP.
  1749     05  INDGRPF PIC  X(0001).
  1750     05  FILLER REDEFINES INDGRPF.
  1751         10  INDGRPA PIC  X(0001).
  1752     05  INDGRPI PIC  X(0001).
  1753*    -------------------------------
  1754     05  PREMTYPL PIC S9(0004) COMP.
  1755     05  PREMTYPF PIC  X(0001).
  1756     05  FILLER REDEFINES PREMTYPF.
  1757         10  PREMTYPA PIC  X(0001).
  1758     05  PREMTYPI PIC  X(0001).
  1759*    -------------------------------
  1760     05  REINCDL PIC S9(0004) COMP.
  1761     05  REINCDF PIC  X(0001).
  1762     05  FILLER REDEFINES REINCDF.
  1763         10  REINCDA PIC  X(0001).
  1764     05  REINCDI PIC  X(0001).
  1765*    -------------------------------
  1766     05  JNTLNMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  35
* EL131.cbl
  1767     05  JNTLNMEF PIC  X(0001).
  1768     05  FILLER REDEFINES JNTLNMEF.
  1769         10  JNTLNMEA PIC  X(0001).
  1770     05  JNTLNMEI PIC  X(0015).
  1771*    -------------------------------
  1772     05  JNTFNMEL PIC S9(0004) COMP.
  1773     05  JNTFNMEF PIC  X(0001).
  1774     05  FILLER REDEFINES JNTFNMEF.
  1775         10  JNTFNMEA PIC  X(0001).
  1776     05  JNTFNMEI PIC  X(0012).
  1777*    -------------------------------
  1778     05  JNTINITL PIC S9(0004) COMP.
  1779     05  JNTINITF PIC  X(0001).
  1780     05  FILLER REDEFINES JNTINITF.
  1781         10  JNTINITA PIC  X(0001).
  1782     05  JNTINITI PIC  X(0001).
  1783*    -------------------------------
  1784     05  JNTAGEL PIC S9(0004) COMP.
  1785     05  JNTAGEF PIC  X(0001).
  1786     05  FILLER REDEFINES JNTAGEF.
  1787         10  JNTAGEA PIC  X(0001).
  1788     05  JNTAGEI PIC  X(0002).
  1789*    -------------------------------
  1790     05  ADDONDTL PIC S9(0004) COMP.
  1791     05  ADDONDTF PIC  X(0001).
  1792     05  FILLER REDEFINES ADDONDTF.
  1793         10  ADDONDTA PIC  X(0001).
  1794     05  ADDONDTI PIC  X(0008).
  1795*    -------------------------------
  1796     05  LCVDSCRL PIC S9(0004) COMP.
  1797     05  LCVDSCRF PIC  X(0001).
  1798     05  FILLER REDEFINES LCVDSCRF.
  1799         10  LCVDSCRA PIC  X(0001).
  1800     05  LCVDSCRI PIC  X(0006).
  1801*    -------------------------------
  1802     05  LCVKINDL PIC S9(0004) COMP.
  1803     05  LCVKINDF PIC  X(0001).
  1804     05  FILLER REDEFINES LCVKINDF.
  1805         10  LCVKINDA PIC  X(0001).
  1806     05  LCVKINDI PIC  X(0003).
  1807*    -------------------------------
  1808     05  LCVCDL PIC S9(0004) COMP.
  1809     05  LCVCDF PIC  X(0001).
  1810     05  FILLER REDEFINES LCVCDF.
  1811         10  LCVCDA PIC  X(0001).
  1812     05  LCVCDI PIC  X(0002).
  1813*    -------------------------------
  1814     05  LCVOTRML PIC S9(0004) COMP.
  1815     05  LCVOTRMF PIC  X(0001).
  1816     05  FILLER REDEFINES LCVOTRMF.
  1817         10  LCVOTRMA PIC  X(0001).
  1818     05  LCVOTRMI PIC  999.
  1819*    -------------------------------
  1820     05  LCVRTRML PIC S9(0004) COMP.
  1821     05  LCVRTRMF PIC  X(0001).
  1822     05  FILLER REDEFINES LCVRTRMF.
  1823         10  LCVRTRMA PIC  X(0001).
  1824     05  LCVRTRMI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  36
* EL131.cbl
  1825*    -------------------------------
  1826     05  LCVRATEL PIC S9(0004) COMP.
  1827     05  LCVRATEF PIC  X(0001).
  1828     05  FILLER REDEFINES LCVRATEF.
  1829         10  LCVRATEA PIC  X(0001).
  1830     05  LCVRATEI PIC  9999V99.
  1831*    -------------------------------
  1832     05  LCVBENEL PIC S9(0004) COMP.
  1833     05  LCVBENEF PIC  X(0001).
  1834     05  FILLER REDEFINES LCVBENEF.
  1835         10  LCVBENEA PIC  X(0001).
  1836     05  LCVBENEI PIC  9(9)V99.
  1837*    -------------------------------
  1838     05  LCVFORML PIC S9(0004) COMP.
  1839     05  LCVFORMF PIC  X(0001).
  1840     05  FILLER REDEFINES LCVFORMF.
  1841         10  LCVFORMA PIC  X(0001).
  1842     05  LCVFORMI PIC  X(0012).
  1843*    -------------------------------
  1844     05  LCVCNDTL PIC S9(0004) COMP.
  1845     05  LCVCNDTF PIC  X(0001).
  1846     05  FILLER REDEFINES LCVCNDTF.
  1847         10  LCVCNDTA PIC  X(0001).
  1848     05  LCVCNDTI PIC  X(0008).
  1849*    -------------------------------
  1850     05  LCVEXITL PIC S9(0004) COMP.
  1851     05  LCVEXITF PIC  X(0001).
  1852     05  FILLER REDEFINES LCVEXITF.
  1853         10  LCVEXITA PIC  X(0001).
  1854     05  LCVEXITI PIC  X(0008).
  1855*    -------------------------------
  1856     05  LCVSTATL PIC S9(0004) COMP.
  1857     05  LCVSTATF PIC  X(0001).
  1858     05  FILLER REDEFINES LCVSTATF.
  1859         10  LCVSTATA PIC  X(0001).
  1860     05  LCVSTATI PIC  X(0006).
  1861*    -------------------------------
  1862     05  ACVDSCRL PIC S9(0004) COMP.
  1863     05  ACVDSCRF PIC  X(0001).
  1864     05  FILLER REDEFINES ACVDSCRF.
  1865         10  ACVDSCRA PIC  X(0001).
  1866     05  ACVDSCRI PIC  X(0006).
  1867*    -------------------------------
  1868     05  ACVKINDL PIC S9(0004) COMP.
  1869     05  ACVKINDF PIC  X(0001).
  1870     05  FILLER REDEFINES ACVKINDF.
  1871         10  ACVKINDA PIC  X(0001).
  1872     05  ACVKINDI PIC  X(0003).
  1873*    -------------------------------
  1874     05  ACVCDL PIC S9(0004) COMP.
  1875     05  ACVCDF PIC  X(0001).
  1876     05  FILLER REDEFINES ACVCDF.
  1877         10  ACVCDA PIC  X(0001).
  1878     05  ACVCDI PIC  X(0002).
  1879*    -------------------------------
  1880     05  ACVOTRML PIC S9(0004) COMP.
  1881     05  ACVOTRMF PIC  X(0001).
  1882     05  FILLER REDEFINES ACVOTRMF.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  37
* EL131.cbl
  1883         10  ACVOTRMA PIC  X(0001).
  1884     05  ACVOTRMI PIC  999.
  1885*    -------------------------------
  1886     05  ACVRTRML PIC S9(0004) COMP.
  1887     05  ACVRTRMF PIC  X(0001).
  1888     05  FILLER REDEFINES ACVRTRMF.
  1889         10  ACVRTRMA PIC  X(0001).
  1890     05  ACVRTRMI PIC  X(0003).
  1891*    -------------------------------
  1892     05  ACVRATEL PIC S9(0004) COMP.
  1893     05  ACVRATEF PIC  X(0001).
  1894     05  FILLER REDEFINES ACVRATEF.
  1895         10  ACVRATEA PIC  X(0001).
  1896     05  ACVRATEI PIC  9999V99.
  1897*    -------------------------------
  1898     05  ACVBENEL PIC S9(0004) COMP.
  1899     05  ACVBENEF PIC  X(0001).
  1900     05  FILLER REDEFINES ACVBENEF.
  1901         10  ACVBENEA PIC  X(0001).
  1902     05  ACVBENEI PIC  9(9)V99.
  1903*    -------------------------------
  1904     05  ACVFORML PIC S9(0004) COMP.
  1905     05  ACVFORMF PIC  X(0001).
  1906     05  FILLER REDEFINES ACVFORMF.
  1907         10  ACVFORMA PIC  X(0001).
  1908     05  ACVFORMI PIC  X(0012).
  1909*    -------------------------------
  1910     05  ACVCNDTL PIC S9(0004) COMP.
  1911     05  ACVCNDTF PIC  X(0001).
  1912     05  FILLER REDEFINES ACVCNDTF.
  1913         10  ACVCNDTA PIC  X(0001).
  1914     05  ACVCNDTI PIC  X(0008).
  1915*    -------------------------------
  1916     05  ACVEXITL PIC S9(0004) COMP.
  1917     05  ACVEXITF PIC  X(0001).
  1918     05  FILLER REDEFINES ACVEXITF.
  1919         10  ACVEXITA PIC  X(0001).
  1920     05  ACVEXITI PIC  X(0008).
  1921*    -------------------------------
  1922     05  ACVSTATL PIC S9(0004) COMP.
  1923     05  ACVSTATF PIC  X(0001).
  1924     05  FILLER REDEFINES ACVSTATF.
  1925         10  ACVSTATA PIC  X(0001).
  1926     05  ACVSTATI PIC  X(0006).
  1927*    -------------------------------
  1928     05  LABEL2L PIC S9(0004) COMP.
  1929     05  LABEL2F PIC  X(0001).
  1930     05  FILLER REDEFINES LABEL2F.
  1931         10  LABEL2A PIC  X(0001).
  1932     05  LABEL2I PIC  X(0014).
  1933*    -------------------------------
  1934     05  BCERT1L PIC S9(0004) COMP.
  1935     05  BCERT1F PIC  X(0001).
  1936     05  FILLER REDEFINES BCERT1F.
  1937         10  BCERT1A PIC  X(0001).
  1938     05  BCERT1I PIC  X(0010).
  1939*    -------------------------------
  1940     05  BSUFX1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  38
* EL131.cbl
  1941     05  BSUFX1F PIC  X(0001).
  1942     05  FILLER REDEFINES BSUFX1F.
  1943         10  BSUFX1A PIC  X(0001).
  1944     05  BSUFX1I PIC  X(0001).
  1945*    -------------------------------
  1946     05  BCERT2L PIC S9(0004) COMP.
  1947     05  BCERT2F PIC  X(0001).
  1948     05  FILLER REDEFINES BCERT2F.
  1949         10  BCERT2A PIC  X(0001).
  1950     05  BCERT2I PIC  X(0010).
  1951*    -------------------------------
  1952     05  BSUFX2L PIC S9(0004) COMP.
  1953     05  BSUFX2F PIC  X(0001).
  1954     05  FILLER REDEFINES BSUFX2F.
  1955         10  BSUFX2A PIC  X(0001).
  1956     05  BSUFX2I PIC  X(0001).
  1957*    -------------------------------
  1958     05  BCERT3L PIC S9(0004) COMP.
  1959     05  BCERT3F PIC  X(0001).
  1960     05  FILLER REDEFINES BCERT3F.
  1961         10  BCERT3A PIC  X(0001).
  1962     05  BCERT3I PIC  X(0010).
  1963*    -------------------------------
  1964     05  BSUFX3L PIC S9(0004) COMP.
  1965     05  BSUFX3F PIC  X(0001).
  1966     05  FILLER REDEFINES BSUFX3F.
  1967         10  BSUFX3A PIC  X(0001).
  1968     05  BSUFX3I PIC  X(0001).
  1969*    -------------------------------
  1970     05  BCERT4L PIC S9(0004) COMP.
  1971     05  BCERT4F PIC  X(0001).
  1972     05  FILLER REDEFINES BCERT4F.
  1973         10  BCERT4A PIC  X(0001).
  1974     05  BCERT4I PIC  X(0010).
  1975*    -------------------------------
  1976     05  BSUFX4L PIC S9(0004) COMP.
  1977     05  BSUFX4F PIC  X(0001).
  1978     05  FILLER REDEFINES BSUFX4F.
  1979         10  BSUFX4A PIC  X(0001).
  1980     05  BSUFX4I PIC  X(0001).
  1981*    -------------------------------
  1982     05  BCERT5L PIC S9(0004) COMP.
  1983     05  BCERT5F PIC  X(0001).
  1984     05  FILLER REDEFINES BCERT5F.
  1985         10  BCERT5A PIC  X(0001).
  1986     05  BCERT5I PIC  X(0010).
  1987*    -------------------------------
  1988     05  BSUFX5L PIC S9(0004) COMP.
  1989     05  BSUFX5F PIC  X(0001).
  1990     05  FILLER REDEFINES BSUFX5F.
  1991         10  BSUFX5A PIC  X(0001).
  1992     05  BSUFX5I PIC  X(0001).
  1993*    -------------------------------
  1994     05  MSG1L PIC S9(0004) COMP.
  1995     05  MSG1F PIC  X(0001).
  1996     05  FILLER REDEFINES MSG1F.
  1997         10  MSG1A PIC  X(0001).
  1998     05  MSG1I PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  39
* EL131.cbl
  1999*    -------------------------------
  2000     05  MSG2L PIC S9(0004) COMP.
  2001     05  MSG2F PIC  X(0001).
  2002     05  FILLER REDEFINES MSG2F.
  2003         10  MSG2A PIC  X(0001).
  2004     05  MSG2I PIC  X(0072).
  2005*    -------------------------------
  2006     05  PFKEYL PIC S9(0004) COMP.
  2007     05  PFKEYF PIC  X(0001).
  2008     05  FILLER REDEFINES PFKEYF.
  2009         10  PFKEYA PIC  X(0001).
  2010     05  PFKEYI PIC  99.
  2011*    -------------------------------
  2012     05  PFKEY6L PIC S9(0004) COMP.
  2013     05  PFKEY6F PIC  X(0001).
  2014     05  FILLER REDEFINES PFKEY6F.
  2015         10  PFKEY6A PIC  X(0001).
  2016     05  PFKEY6I PIC  X(0016).
  2017 01  EL131AO REDEFINES EL131AI.
  2018     05  FILLER            PIC  X(0012).
  2019*    -------------------------------
  2020     05  FILLER            PIC  X(0003).
  2021     05  DATEO PIC  X(0008).
  2022*    -------------------------------
  2023     05  FILLER            PIC  X(0003).
  2024     05  TIMEO PIC  99.99.
  2025*    -------------------------------
  2026     05  FILLER            PIC  X(0003).
  2027     05  SEQUO PIC  X(0010).
  2028*    -------------------------------
  2029     05  FILLER            PIC  X(0003).
  2030     05  COMPO PIC  X(0003).
  2031*    -------------------------------
  2032     05  FILLER            PIC  X(0003).
  2033     05  USERIDO PIC  X(0004).
  2034*    -------------------------------
  2035     05  FILLER            PIC  X(0003).
  2036     05  LABEL1O PIC  X(0011).
  2037*    -------------------------------
  2038     05  FILLER            PIC  X(0003).
  2039     05  PCERTNOO PIC  X(0010).
  2040*    -------------------------------
  2041     05  FILLER            PIC  X(0003).
  2042     05  PSUFXO PIC  X(0001).
  2043*    -------------------------------
  2044     05  FILLER            PIC  X(0003).
  2045     05  CCNOO PIC  X(0016).
  2046*    -------------------------------
  2047     05  FILLER            PIC  X(0003).
  2048     05  MAINTO PIC  X(0001).
  2049*    -------------------------------
  2050     05  FILLER            PIC  X(0003).
  2051     05  CLAIMO PIC  X(0007).
  2052*    -------------------------------
  2053     05  FILLER            PIC  X(0003).
  2054     05  CARRO PIC  X(0001).
  2055*    -------------------------------
  2056     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  40
* EL131.cbl
  2057     05  CERTO PIC  X(0010).
  2058*    -------------------------------
  2059     05  FILLER            PIC  X(0003).
  2060     05  SUFXO PIC  X(0001).
  2061*    -------------------------------
  2062     05  FILLER            PIC  X(0003).
  2063     05  TYPEO PIC  X(0001).
  2064*    -------------------------------
  2065     05  FILLER            PIC  X(0003).
  2066     05  BENPERO PIC  X(0002).
  2067*    -------------------------------
  2068     05  FILLER            PIC  X(0003).
  2069     05  INSTYPEO PIC  X(0001).
  2070*    -------------------------------
  2071     05  FILLER            PIC  X(0003).
  2072     05  STATUSO PIC  X(0006).
  2073*    -------------------------------
  2074     05  FILLER            PIC  X(0003).
  2075     05  INCO PIC  X(0008).
  2076*    -------------------------------
  2077     05  FILLER            PIC  X(0003).
  2078     05  REPO PIC  X(0008).
  2079*    -------------------------------
  2080     05  FILLER            PIC  X(0003).
  2081     05  ICD1O PIC  X(0008).
  2082*    -------------------------------
  2083     05  FILLER            PIC  X(0003).
  2084     05  ICD2O PIC  X(0008).
  2085*    -------------------------------
  2086     05  FILLER            PIC  X(0003).
  2087     05  DIAGO PIC  X(0060).
  2088*    -------------------------------
  2089     05  FILLER            PIC  X(0003).
  2090     05  ACCSWO PIC  X(0001).
  2091*    -------------------------------
  2092     05  FILLER            PIC  X(0003).
  2093     05  BENEO PIC  X(0010).
  2094*    -------------------------------
  2095     05  FILLER            PIC  X(0003).
  2096     05  BIRTHO PIC  X(0008).
  2097*    -------------------------------
  2098     05  FILLER            PIC  X(0003).
  2099     05  SOCIALO PIC  X(0011).
  2100*    -------------------------------
  2101     05  FILLER            PIC  X(0003).
  2102     05  SEXO PIC  X(0001).
  2103*    -------------------------------
  2104     05  FILLER            PIC  X(0003).
  2105     05  MLNAMEO PIC  X(0015).
  2106*    -------------------------------
  2107     05  FILLER            PIC  X(0003).
  2108     05  MFNAMEO PIC  X(0012).
  2109*    -------------------------------
  2110     05  FILLER            PIC  X(0003).
  2111     05  MMINITO PIC  X(0001).
  2112*    -------------------------------
  2113     05  FILLER            PIC  X(0003).
  2114     05  AUTHRCVO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  41
* EL131.cbl
  2115*    -------------------------------
  2116     05  FILLER            PIC  X(0003).
  2117     05  CRTLNMEO PIC  X(0015).
  2118*    -------------------------------
  2119     05  FILLER            PIC  X(0003).
  2120     05  CRTFNMEO PIC  X(0012).
  2121*    -------------------------------
  2122     05  FILLER            PIC  X(0003).
  2123     05  CRTINITO PIC  X(0001).
  2124*    -------------------------------
  2125     05  FILLER            PIC  X(0003).
  2126     05  LOANBALO PIC  ZZZZZ9.99.
  2127*    -------------------------------
  2128     05  FILLER            PIC  X(0003).
  2129     05  PROCO PIC  X(0004).
  2130*    -------------------------------
  2131     05  FILLER            PIC  X(0003).
  2132     05  SUPVO PIC  X(0001).
  2133*    -------------------------------
  2134     05  FILLER            PIC  X(0003).
  2135     05  PRICDO PIC  X(0001).
  2136*    -------------------------------
  2137     05  FILLER            PIC  X(0003).
  2138     05  CRITPO PIC  X(0002).
  2139*    -------------------------------
  2140     05  FILLER            PIC  X(0003).
  2141     05  EXTENSO PIC  X(0002).
  2142*    -------------------------------
  2143     05  FILLER            PIC  X(0003).
  2144     05  FILETOO PIC  X(0004).
  2145*    -------------------------------
  2146     05  FILLER            PIC  X(0003).
  2147     05  PTHRHDGO PIC  X(0010).
  2148*    -------------------------------
  2149     05  FILLER            PIC  X(0003).
  2150     05  PDTHRUO PIC  X(0008).
  2151*    -------------------------------
  2152     05  FILLER            PIC  X(0003).
  2153     05  PDAMTO PIC  Z(06).99.
  2154*    -------------------------------
  2155     05  FILLER            PIC  X(0003).
  2156     05  NODAYSO PIC  ZZZ99.
  2157*    -------------------------------
  2158     05  FILLER            PIC  X(0003).
  2159     05  NOPMTSO PIC  ZZ99.
  2160*    -------------------------------
  2161     05  FILLER            PIC  X(0003).
  2162     05  FORMTYPO PIC  X(0001).
  2163*    -------------------------------
  2164     05  FILLER            PIC  X(0003).
  2165     05  ESTO PIC  X(0008).
  2166*    -------------------------------
  2167     05  FILLER            PIC  X(0003).
  2168     05  AUIDO PIC  X(0004).
  2169*    -------------------------------
  2170     05  FILLER            PIC  X(0003).
  2171     05  OCCO PIC  X(0006).
  2172*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  42
* EL131.cbl
  2173     05  FILLER            PIC  X(0003).
  2174     05  MNTDTO PIC  X(0008).
  2175*    -------------------------------
  2176     05  FILLER            PIC  X(0003).
  2177     05  MNTTYPEO PIC  X(0006).
  2178*    -------------------------------
  2179     05  FILLER            PIC  X(0003).
  2180     05  CERTCARO PIC  X(0001).
  2181*    -------------------------------
  2182     05  FILLER            PIC  X(0003).
  2183     05  CERTGRPO PIC  X(0006).
  2184*    -------------------------------
  2185     05  FILLER            PIC  X(0003).
  2186     05  CERTSTO PIC  X(0002).
  2187*    -------------------------------
  2188     05  FILLER            PIC  X(0003).
  2189     05  CERTACTO PIC  X(0010).
  2190*    -------------------------------
  2191     05  FILLER            PIC  X(0003).
  2192     05  CERTEFFO PIC  X(0008).
  2193*    -------------------------------
  2194     05  FILLER            PIC  X(0003).
  2195     05  ISSAGEO PIC  X(0002).
  2196*    -------------------------------
  2197     05  FILLER            PIC  X(0003).
  2198     05  APRO PIC  9(3).9(4).
  2199*    -------------------------------
  2200     05  FILLER            PIC  X(0003).
  2201     05  PMTFREQO PIC  99.
  2202*    -------------------------------
  2203     05  FILLER            PIC  X(0003).
  2204     05  INDGRPO PIC  X(0001).
  2205*    -------------------------------
  2206     05  FILLER            PIC  X(0003).
  2207     05  PREMTYPO PIC  X(0001).
  2208*    -------------------------------
  2209     05  FILLER            PIC  X(0003).
  2210     05  REINCDO PIC  X(0001).
  2211*    -------------------------------
  2212     05  FILLER            PIC  X(0003).
  2213     05  JNTLNMEO PIC  X(0015).
  2214*    -------------------------------
  2215     05  FILLER            PIC  X(0003).
  2216     05  JNTFNMEO PIC  X(0012).
  2217*    -------------------------------
  2218     05  FILLER            PIC  X(0003).
  2219     05  JNTINITO PIC  X(0001).
  2220*    -------------------------------
  2221     05  FILLER            PIC  X(0003).
  2222     05  JNTAGEO PIC  X(0002).
  2223*    -------------------------------
  2224     05  FILLER            PIC  X(0003).
  2225     05  ADDONDTO PIC  X(0008).
  2226*    -------------------------------
  2227     05  FILLER            PIC  X(0003).
  2228     05  LCVDSCRO PIC  X(0006).
  2229*    -------------------------------
  2230     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  43
* EL131.cbl
  2231     05  LCVKINDO PIC  X(0003).
  2232*    -------------------------------
  2233     05  FILLER            PIC  X(0003).
  2234     05  LCVCDO PIC  X(0002).
  2235*    -------------------------------
  2236     05  FILLER            PIC  X(0003).
  2237     05  LCVOTRMO PIC  999.
  2238*    -------------------------------
  2239     05  FILLER            PIC  X(0003).
  2240     05  LCVRTRMO PIC  999.
  2241*    -------------------------------
  2242     05  FILLER            PIC  X(0003).
  2243     05  LCVRATEO PIC  ZZZ.ZZ.
  2244*    -------------------------------
  2245     05  FILLER            PIC  X(0003).
  2246     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2247*    -------------------------------
  2248     05  FILLER            PIC  X(0003).
  2249     05  LCVFORMO PIC  X(0012).
  2250*    -------------------------------
  2251     05  FILLER            PIC  X(0003).
  2252     05  LCVCNDTO PIC  X(0008).
  2253*    -------------------------------
  2254     05  FILLER            PIC  X(0003).
  2255     05  LCVEXITO PIC  X(0008).
  2256*    -------------------------------
  2257     05  FILLER            PIC  X(0003).
  2258     05  LCVSTATO PIC  X(0006).
  2259*    -------------------------------
  2260     05  FILLER            PIC  X(0003).
  2261     05  ACVDSCRO PIC  X(0006).
  2262*    -------------------------------
  2263     05  FILLER            PIC  X(0003).
  2264     05  ACVKINDO PIC  X(0003).
  2265*    -------------------------------
  2266     05  FILLER            PIC  X(0003).
  2267     05  ACVCDO PIC  X(0002).
  2268*    -------------------------------
  2269     05  FILLER            PIC  X(0003).
  2270     05  ACVOTRMO PIC  999.
  2271*    -------------------------------
  2272     05  FILLER            PIC  X(0003).
  2273     05  ACVRTRMO PIC  999.
  2274*    -------------------------------
  2275     05  FILLER            PIC  X(0003).
  2276     05  ACVRATEO PIC  ZZZ.ZZ.
  2277*    -------------------------------
  2278     05  FILLER            PIC  X(0003).
  2279     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2280*    -------------------------------
  2281     05  FILLER            PIC  X(0003).
  2282     05  ACVFORMO PIC  X(0012).
  2283*    -------------------------------
  2284     05  FILLER            PIC  X(0003).
  2285     05  ACVCNDTO PIC  X(0008).
  2286*    -------------------------------
  2287     05  FILLER            PIC  X(0003).
  2288     05  ACVEXITO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  44
* EL131.cbl
  2289*    -------------------------------
  2290     05  FILLER            PIC  X(0003).
  2291     05  ACVSTATO PIC  X(0006).
  2292*    -------------------------------
  2293     05  FILLER            PIC  X(0003).
  2294     05  LABEL2O PIC  X(0014).
  2295*    -------------------------------
  2296     05  FILLER            PIC  X(0003).
  2297     05  BCERT1O PIC  X(0010).
  2298*    -------------------------------
  2299     05  FILLER            PIC  X(0003).
  2300     05  BSUFX1O PIC  X(0001).
  2301*    -------------------------------
  2302     05  FILLER            PIC  X(0003).
  2303     05  BCERT2O PIC  X(0010).
  2304*    -------------------------------
  2305     05  FILLER            PIC  X(0003).
  2306     05  BSUFX2O PIC  X(0001).
  2307*    -------------------------------
  2308     05  FILLER            PIC  X(0003).
  2309     05  BCERT3O PIC  X(0010).
  2310*    -------------------------------
  2311     05  FILLER            PIC  X(0003).
  2312     05  BSUFX3O PIC  X(0001).
  2313*    -------------------------------
  2314     05  FILLER            PIC  X(0003).
  2315     05  BCERT4O PIC  X(0010).
  2316*    -------------------------------
  2317     05  FILLER            PIC  X(0003).
  2318     05  BSUFX4O PIC  X(0001).
  2319*    -------------------------------
  2320     05  FILLER            PIC  X(0003).
  2321     05  BCERT5O PIC  X(0010).
  2322*    -------------------------------
  2323     05  FILLER            PIC  X(0003).
  2324     05  BSUFX5O PIC  X(0001).
  2325*    -------------------------------
  2326     05  FILLER            PIC  X(0003).
  2327     05  MSG1O PIC  X(0072).
  2328*    -------------------------------
  2329     05  FILLER            PIC  X(0003).
  2330     05  MSG2O PIC  X(0072).
  2331*    -------------------------------
  2332     05  FILLER            PIC  X(0003).
  2333     05  PFKEYO PIC  X(0002).
  2334*    -------------------------------
  2335     05  FILLER            PIC  X(0003).
  2336     05  PFKEY6O PIC  X(0016).
  2337*    -------------------------------
  2338
  2339*                                COPY ELCEMIB SUPPRESS.
  2340******************************************************************
  2341*                                                                *
  2342*                                                                *
  2343*                            ELCEMIB.                            *
  2344*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2345*                            VMOD=2.005                          *
  2346*                                                                *
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  45
* EL131.cbl
  2347*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2348*                                                                *
  2349******************************************************************
  2350 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2351     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2352     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2353     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2354     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2355     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2356     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2357     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2358     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2359     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2360         88  EMI-NO-ERRORS                    VALUE '1'.
  2361         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2362         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2363     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2364         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2365     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2366         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2367         88  EMI-AREA1-FULL                   VALUE '2'.
  2368     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2369         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2370         88  EMI-AREA2-FULL                   VALUE '2'.
  2371     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2372         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2373         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2374         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2375         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2376         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2377     12  EMI-ERROR-LINES.
  2378         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2379         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2380         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2381         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2382             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2383                 24  EMI-ERR-NUM         PIC X(4).
  2384                 24  EMI-FILLER          PIC X.
  2385                 24  EMI-SEV             PIC X.
  2386                 24  FILLER              PIC X.
  2387             20  FILLER                  PIC X(02).
  2388     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2389         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2390             20  EMI-ERROR-NUMBER    PIC X(4).
  2391             20  EMI-FILL            PIC X.
  2392             20  EMI-SEVERITY        PIC X.
  2393             20  FILLER              PIC X.
  2394             20  EMI-ERROR-TEXT.
  2395                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2396                 24  FILLER          PIC X(55).
  2397     12  EMI-SEVERITY-SAVE           PIC X.
  2398         88  EMI-NOTE                    VALUE 'N'.
  2399         88  EMI-WARNING                 VALUE 'W'.
  2400         88  EMI-FORCABLE                VALUE 'F'.
  2401         88  EMI-FATAL                   VALUE 'X'.
  2402     12  EMI-MESSAGE-FLAG            PIC X.
  2403         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2404         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  46
* EL131.cbl
  2405     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2406     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2407         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2408         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2409         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2410     12  emi-claim-no                pic x(7).
  2411     12  emi-claim-type              pic x(6).
  2412     12  FILLER                      PIC X(124)  VALUE SPACES.
  2413     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2414     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2415     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2416     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2417
  2418*                                COPY ELCJPFX SUPPRESS.
  2419******************************************************************
  2420*                                                                *
  2421*                                                                *
  2422*                            ELCJPFX.                            *
  2423*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2424*                            VMOD=2.002                          *
  2425*                                                                *
  2426*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2427*                                                                *
  2428*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2429*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2430*        ELCNTL - CONTROL FILE                                   *
  2431*        ELMSTR - CLAIM MASTERS                                  *
  2432*        ELTRLR - ACTIVITY TRAILERS                              *
  2433*        ELCHKQ - CHECK QUE                                      *
  2434******************************************************************
  2435 01  JOURNAL-RECORD.
  2436     12  jp-date                     pic s9(5) comp-3.
  2437     12  jp-time                     pic s9(7) comp-3.
  2438     12  JP-USER-ID                  PIC X(4).
  2439     12  JP-FILE-ID                  PIC X(8).
  2440     12  JP-PROGRAM-ID               PIC X(8).
  2441     12  JP-RECORD-TYPE              PIC X.
  2442         88 JP-ADD              VALUE 'A'.
  2443         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2444         88 JP-AFTER-CHANGE     VALUE 'C'.
  2445         88 JP-DELETE           VALUE 'D'.
  2446         88 JP-GENERIC-DELETE   VALUE 'G'.
  2447         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2448         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2449     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2450     12  JP-RECORD-AREA
  2451
  2452
  2453                                 PIC X(750).
  2454
  2455*                                COPY ELCCALC.
  2456******************************************************************
  2457*                                                                *
  2458*                           ELCCALC.                            *
  2459*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2460*                            VMOD=2.025                          *
  2461*                                                                *
  2462*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  47
* EL131.cbl
  2463*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2464*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2465*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2466*                                                                *
  2467*  PASSED TO ELRTRM                                              *
  2468*  -----------------                                             *
  2469*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2470*  ORIGINAL TERM                                                 *
  2471*  BEGINNING DATE                                                *
  2472*  ENDING DATE                                                   *
  2473*  COMPANY I.D.                                                  *
  2474*  ACCOUNT MASTER USER FIELD                                     *
  2475*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2476*  FREE LOOK DAYS                                                *
  2477*                                                                *
  2478*  RETURNED FROM ELRTRM                                          *
  2479*  ---------------------                                         *
  2480*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2481*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2482*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2483*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2484*----------------------------------------------------------------*
  2485*  PASSED TO ELRAMT                                              *
  2486*  ----------------                                              *
  2487*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2488*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2489*  ORIGINAL AMOUNT                                               *
  2490*  ALTERNATE BENEFIT (BALLON)                                    *
  2491*  A.P.R. - NET PAY ONLY                                         *
  2492*  METHOD
  2493*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2494*  COMPANY I.D.                                                  *
  2495*  BENEFIT TYPE                                                  *
  2496*                                                                *
  2497*  RETURNED FROM ELRAMT                                          *
  2498*  --------------------                                          *
  2499*  REMAINING AMOUNT 1 - CURRENT                                  *
  2500*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2501*  REMAINING AMOUNT FACTOR
  2502*----------------------------------------------------------------*
  2503*  PASSED TO ELRESV                                              *
  2504*  -----------------                                             *
  2505*  CERTIFICATE EFFECTIVE DATE                                    *
  2506*  VALUATION DATE                                                *
  2507*  PAID THRU DATE                                                *
  2508*  BENEFIT                                                       *
  2509*  INCURRED DATE                                                 *
  2510*  REPORTED DATE                                                 *
  2511*  ISSUE AGE                                                     *
  2512*  TERM                                                          *
  2513*  CDT PERCENT                                                   *
  2514*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2515* *CLAIM TYPE (LIFE, A/H)                                        *
  2516* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2517* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2518*                                                                *
  2519*  RETURNED FROM ELRESV                                          *
  2520*  --------------------                                          *
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  48
* EL131.cbl
  2521*  CDT TABLE USED                                                *
  2522*  CDT FACTOR USED                                               *
  2523*  PAY TO CURRENT RESERVE                                        *
  2524*  I.B.N.R. - A/H ONLY                                           *
  2525*  FUTURE (ACCRUED) AH ONLY                                      *
  2526*----------------------------------------------------------------*
  2527*  PASSED TO ELRATE                                              *
  2528*  ----------------                                              *
  2529*  CERT ISSUE DATE                                               *
  2530*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2531*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2532*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2533*  STATE CODE (CLIENT DEFINED)                                   *
  2534*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2535*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2536*  DEVIATION CODE                                                *
  2537*  ISSUE AGE                                                     *
  2538*  ORIGINAL BENEFIT AMOUNT                                       *
  2539*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2540*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2541*  BENEFIT KIND (LIFE OR A/H)                                    *
  2542*  A.P.R.                                                        *
  2543*  METHOD
  2544*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2545*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2546*  COMPANY I.D. (3 CHARACTER)                                    *
  2547*  BENEFIT CODE                                                  *
  2548*  BENEFIT OVERRIDE CODE                                         *
  2549*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2550*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2551*  JOINT INDICATOR (CSL ONLY)                                    *
  2552*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2553*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2554*                                                                *
  2555*  RETURNED FROM ELRATE                                          *
  2556*  --------------------                                          *
  2557*  CALCULATED PREMIUM                                            *
  2558*  PREMIUM RATE                                                  *
  2559*  MORTALITY CODE                                                *
  2560*  MAX ATTAINED AGE                                              *
  2561*  MAX AGE                                                       *
  2562*  MAX TERM                                                      *
  2563*  MAX MONTHLY BENEFIT                                           *
  2564*  MAX TOTAL BENIFIT                                             *
  2565*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2566*----------------------------------------------------------------*
  2567*  PASSED TO ELRFND                                              *
  2568*  ----------------                                              *
  2569*  CERT ISSUE DATE                                               *
  2570*  REFUND DATE                                                   *
  2571*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2572*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2573*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2574*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2575*  STATE CODE (CLIENT DEFINED)                                   *
  2576*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2577*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2578*  DEVIATION CODE                                                *
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  49
* EL131.cbl
  2579*  ISSUE AGE                                                     *
  2580*  ORIGINAL BENEFIT AMOUNT                                       *
  2581*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2582*  PROCESS TYPE (CANCEL)                                         *
  2583*  BENEFIT KIND (LIFE OR A/H)                                    *
  2584*  A.P.R.                                                        *
  2585*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2586*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2587*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2588*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2589*  COMPANY I.D. (3 CHARACTER)                                    *
  2590*  BENEFIT CODE                                                  *
  2591*  BENEFIT OVERRIDE CODE                                         *
  2592*                                                                *
  2593*  RETURNED FROM ELRFND                                          *
  2594*  --------------------                                          *
  2595*  CALCULATED REFUND                                             *
  2596*----------------------------------------------------------------*
  2597*  PASSED TO ELEARN                                              *
  2598*  ----------------                                              *
  2599*  CERT ISSUE DATE                                               *
  2600*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2601*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2602*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2603*  STATE CODE (CLIENT DEFINED)                                   *
  2604*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2605*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2606*  DEVIATION CODE                                                *
  2607*  ISSUE AGE                                                     *
  2608*  ORIGINAL BENEFIT AMOUNT                                       *
  2609*  BENEFIT KIND (LIFE OR A/H)                                    *
  2610*  A.P.R.                                                        *
  2611*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2612*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2613*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2614*  COMPANY I.D. (3 CHARACTER)                                    *
  2615*  BENEFIT CODE                                                  *
  2616*  BENEFIT OVERRIDE CODE                                         *
  2617*                                                                *
  2618*  RETURNED FROM ELEARN                                          *
  2619*  --------------------                                          *
  2620*  INDICATED  EARNINGS                                           *
  2621*----------------------------------------------------------------*
  2622*                 LENGTH = 450                                   *
  2623*                                                                *
  2624******************************************************************
  2625******************************************************************
  2626*                   C H A N G E   L O G
  2627*
  2628* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2629*-----------------------------------------------------------------
  2630*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2631* EFFECTIVE    NUMBER
  2632*-----------------------------------------------------------------
  2633* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2634* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2635* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2636* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  50
* EL131.cbl
  2637* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2638* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2639* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2640* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2641* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2642* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2643* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2644******************************************************************
  2645
  2646 01  CALCULATION-PASS-AREA.
  2647     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2648                                     COMP.
  2649
  2650     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2651       88  NO-CP-ERROR                             VALUE ZERO.
  2652       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2653                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2654       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2655       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2656       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2657       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2658       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2659       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2660       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2661       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2662       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2663       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2664       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2665       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2666       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2667       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2668       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2669       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2670       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2671
  2672     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2673       88  NO-CP-ERROR-2                           VALUE ZERO.
  2674***********************  INPUT AREAS ****************************
  2675
  2676     12  CP-CALCULATION-AREA.
  2677         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2678         16  CP-CERT-EFF-DT        PIC XX.
  2679         16  CP-VALUATION-DT       PIC XX.
  2680         16  CP-PAID-THRU-DT       PIC XX.
  2681         16  CP-BENEFIT-TYPE       PIC X.
  2682           88  CP-AH                               VALUE 'A' 'D'
  2683                                                   'I' 'U'.
  2684           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2685           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2686         16  CP-INCURRED-DT        PIC XX.
  2687         16  CP-REPORTED-DT        PIC XX.
  2688         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2689         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2690         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2691                                     COMP-3.
  2692         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2693                                     COMP-3.
  2694         16  CP-CDT-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  51
* EL131.cbl
  2695           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2696           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2697           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2698         16  CP-CLAIM-TYPE         PIC X.
  2699           88  CP-AH-CLAIM                         VALUE 'A'.
  2700           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2701         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2702                                     COMP-3.
  2703         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2704                                     COMP-3.
  2705         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2706                                     COMP-3.
  2707         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2708                                     COMP-3.
  2709         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2710                                     COMP-3.
  2711         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2712                                     COMP-3.
  2713         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2714                                     COMP-3.
  2715         16  CP-REM-TERM-METHOD    PIC X.
  2716           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2717           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2718           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2719           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2720           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2721           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2722           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2723         16  CP-EARNING-METHOD     PIC X.
  2724           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2725           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2726           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2727           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2728           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2729           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2730           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2731           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2732           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2733           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2734           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2735           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2736           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2737           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2738         16  CP-PROCESS-TYPE       PIC X.
  2739           88  CP-CLAIM                            VALUE '1'.
  2740           88  CP-CANCEL                           VALUE '2'.
  2741           88  CP-ISSUE                            VALUE '3'.
  2742         16  CP-SPECIAL-CALC-CD    PIC X.
  2743           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2744           88  CP-1-MTH-INTEREST               VALUE ' '.
  2745           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2746           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2747           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2748           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2749           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2750           88  CP-FARM-PLAN                    VALUE 'F'.
  2751           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2752           88  CP-2-MTH-INTEREST               VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  52
* EL131.cbl
  2753           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2754           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2755           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2756           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2757           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2758           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2759           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2760           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2761                                                     'W' 'X'.
  2762           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2763           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2764           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2765           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2766           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2767           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2768           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2769           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2770           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2771           88  CP-CSL-METH-1                   VALUE '5'.
  2772           88  CP-CSL-METH-2                   VALUE '6'.
  2773           88  CP-CSL-METH-3                   VALUE '7'.
  2774           88  CP-CSL-METH-4                   VALUE '8'.
  2775
  2776         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2777                                     COMP-3.
  2778         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2779         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2780         16  CP-STATE              PIC XX          VALUE SPACE.
  2781         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2782         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2783           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2784               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2785         16  CP-R78-OPTION         PIC X.
  2786           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2787           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2788
  2789         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2790         16  CP-IBNR-RESERVE-SW    PIC X.
  2791         16  CP-CLAIM-STATUS       PIC X.
  2792         16  CP-RATE-FILE          PIC X.
  2793         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2794                                     COMP-3.
  2795
  2796         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2797         16  CP-AH-OVERRIDE-CODE   PIC X.
  2798
  2799         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2800                                     COMP-3.
  2801         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2802                                   PIC S9(5)V99 COMP-3.
  2803         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2804                                     COMP-3.
  2805         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2806                                     COMP-3.
  2807         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2808                                     COMP-3.
  2809         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2810                                  PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  53
* EL131.cbl
  2811
  2812         16  CP-PAID-FROM-DATE     PIC X(02).
  2813         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2814         16  CP-EXT-DAYS-CALC      PIC X.
  2815           88  CP-EXT-NO-CHG                   VALUE ' '.
  2816           88  CP-EXT-CHG-LF                   VALUE '1'.
  2817           88  CP-EXT-CHG-AH                   VALUE '2'.
  2818           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2819         16  CP-DOMICILE-STATE     PIC XX.
  2820         16  CP-CARRIER            PIC X.
  2821         16  CP-REIN-FLAG          PIC X.
  2822         16  CP-REM-TRM-CALC-OPTION PIC X.
  2823           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2824                      '2' '3' '4' '5'.
  2825           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2826           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2827           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2828           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2829           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2830           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2831           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2832           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2833         16  CP-SIG-SWITCH         PIC X.
  2834         16  CP-RATING-METHOD      PIC X.
  2835           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2836           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2837           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2838           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2839           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2840           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2841           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2842           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2843           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2844         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2845                                     COMP-3.
  2846         16  CP-BEN-CATEGORY       PIC X.
  2847         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2848         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2849                                   PIC S99V9(5) COMP-3.
  2850         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2851         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2852                                   PIC S99V9(5) COMP-3.
  2853         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2854         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2855         16  CP-EXPIRE-DT          PIC XX.
  2856         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2857         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2858         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2859         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2860         16  CP-DDF-SPEC-CALC      PIC X.
  2861             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2862             88  CP-CALC-CLP              VALUE 'C'.
  2863         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2864         16  CP-CANCEL-REASON      PIC X.
  2865         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2866         16  CP-PMT-MODE           PIC X.
  2867         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2868         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  54
* EL131.cbl
  2869         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2870         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2871         16  FILLER                PIC X.
  2872
  2873***************    OUTPUT FROM ELRESV   ************************
  2874
  2875         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2876
  2877         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2878                                     COMP-3.
  2879         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2880                                     COMP-3.
  2881         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2882                                     COMP-3.
  2883         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2884                                     COMP-3.
  2885         16  FILLER                PIC X(09).
  2886***************    OUTPUT FROM ELRTRM   *************************
  2887
  2888         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2889                                     COMP-3.
  2890         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2891                                     COMP-3.
  2892         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2893                                     COMP-3.
  2894         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2895                                     COMP-3.
  2896         16  FILLER                PIC X(12).
  2897
  2898***************    OUTPUT FROM ELRAMT   *************************
  2899
  2900         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2901                                     COMP-3.
  2902         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2903                                     COMP-3.
  2904         16  FILLER                PIC X(12).
  2905
  2906***************    OUTPUT FROM ELRATE   *************************
  2907
  2908         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2909                                     COMP-3.
  2910         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2911                                     COMP-3.
  2912         16  CP-MORTALITY-CODE     PIC X(4).
  2913         16  CP-RATE-EDIT-FLAG     PIC X.
  2914             88  CP-RATES-NEED-APR                  VALUE '1'.
  2915         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2916                                     COMP-3.
  2917         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2918         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2919         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2920                                   PIC S9(7)V99 COMP-3.
  2921         16  FILLER                PIC X(07).
  2922
  2923***************    OUTPUT FROM ELRFND   *************************
  2924
  2925         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2926                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  55
* EL131.cbl
  2927         16  CP-REFUND-TYPE-USED   PIC X.
  2928           88  CP-R-AS-R78                         VALUE '1'.
  2929           88  CP-R-AS-PRORATA                     VALUE '2'.
  2930           88  CP-R-AS-CALIF                       VALUE '3'.
  2931           88  CP-R-AS-TEXAS                       VALUE '4'.
  2932           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2933           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2934           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2935           88  CP-R-AS-MEAN                        VALUE '8'.
  2936           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2937           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2938           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2939           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2940           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2941           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2942         16  FILLER                PIC X(12).
  2943
  2944***************    OUTPUT FROM ELEARN   *************************
  2945
  2946         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2947                                     COMP-3.
  2948         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2949                                     COMP-3.
  2950         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2951                                     COMP-3.
  2952         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2953                                     COMP-3.
  2954         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2955                                     COMP-3.
  2956         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2957                                     COMP-3.
  2958         16  CP-EARNING-TYPE-USED  PIC X.
  2959           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2960           88  CP-E-AS-R78                         VALUE '1'.
  2961           88  CP-E-AS-PRORATA                     VALUE '2'.
  2962           88  CP-E-AS-TEXAS                       VALUE '4'.
  2963           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2964           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2965           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2966           88  CP-E-AS-MEAN                        VALUE '8'.
  2967           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2968         16  FILLER                PIC X(12).
  2969
  2970***************    OUTPUT FROM ELPMNT   *************************
  2971
  2972         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2973                                     COMP-3.
  2974         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2975                                     COMP-3.
  2976         16  FILLER                PIC X(12).
  2977
  2978***************   MISC WORK AREAS    *****************************
  2979         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2980                                     COMP-3.
  2981         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2982                                     COMP-3.
  2983         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2984                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  56
* EL131.cbl
  2985         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2986                                     COMP-3.
  2987         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2988                                     COMP-3.
  2989         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2990                                     COMP-3.
  2991         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2992             88  OPEN-RATE-FILE                   VALUE 'O'.
  2993             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2994             88  IO-ERROR                         VALUE 'E'.
  2995
  2996         16  CP-FIRST-PAY-DATE     PIC XX.
  2997
  2998         16  CP-JOINT-INDICATOR    PIC X.
  2999
  3000         16  CP-RESERVE-REMAINING-TERM
  3001                                   PIC S9(4)V9    VALUE ZERO
  3002                                     COMP-3.
  3003
  3004         16  CP-INSURED-BIRTH-DT   PIC XX.
  3005
  3006         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3007                                     COMP-3.
  3008
  3009         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3010                                     COMP-3.
  3011
  3012         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3013                                     COMP-3.
  3014
  3015         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3016                                     COMP-3.
  3017
  3018         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3019                                     COMP-3.
  3020
  3021         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3022                                     COMP-3.
  3023
  3024         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3025                                     COMP-3.
  3026
  3027         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3028             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3029
  3030         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3031                                     COMP-3.
  3032         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3033                                     COMP-3.
  3034         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3035         16  cp-extra-periods      pic 9 value zeros.
  3036         16  cp-net-only-state     pic x value spaces.
  3037         16  FILLER                PIC X(13).
  3038******************************************************************
  3039
  3040*                                COPY ELCDATE.
  3041******************************************************************
  3042*                                                                *
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  57
* EL131.cbl
  3043*                                                                *
  3044*                            ELCDATE.                            *
  3045*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3046*                            VMOD=2.003
  3047*                                                                *
  3048*                                                                *
  3049*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3050*                 LENGTH = 200                                   *
  3051******************************************************************
  3052
  3053 01  DATE-CONVERSION-DATA.
  3054     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3055     12  DC-OPTION-CODE                PIC X.
  3056         88  BIN-TO-GREG                VALUE ' '.
  3057         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3058         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3059         88  YMD-GREG-TO-BIN            VALUE '3'.
  3060         88  MDY-GREG-TO-BIN            VALUE '4'.
  3061         88  JULIAN-TO-BIN              VALUE '5'.
  3062         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3063         88  FIND-CENTURY               VALUE '7'.
  3064         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3065         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3066         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3067         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3068         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3069         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3070         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3071         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3072         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3073         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3074         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3075         88  BIN-3-TO-GREG              VALUE 'I'.
  3076         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3077         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3078         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3079         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3080         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3081         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3082         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3083         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3084         88  THREE-CHARACTER-BIN
  3085                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3086         88  GREGORIAN-TO-BIN
  3087                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3088         88  BIN-TO-GREGORIAN
  3089                  VALUES ' ' '1' 'I' '8' 'G'.
  3090         88  JULIAN-TO-BINARY
  3091                  VALUES '5' 'C' 'E' 'F'.
  3092     12  DC-ERROR-CODE                 PIC X.
  3093         88  NO-CONVERSION-ERROR        VALUE ' '.
  3094         88  DATE-CONVERSION-ERROR
  3095                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3096         88  DATE-IS-ZERO               VALUE '1'.
  3097         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3098         88  DATE-IS-INVALID            VALUE '3'.
  3099         88  DATE1-GREATER-DATE2        VALUE '4'.
  3100         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  58
* EL131.cbl
  3101         88  DATE-INVALID-OPTION        VALUE '9'.
  3102         88  INVALID-CENTURY            VALUE 'A'.
  3103         88  ONLY-CENTURY               VALUE 'B'.
  3104         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3105         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3106     12  DC-END-OF-MONTH               PIC X.
  3107         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3108     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3109         88  USE-NORMAL-PROCESS         VALUE ' '.
  3110         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3111         88  ADJUST-UP-100-YRS          VALUE '2'.
  3112     12  FILLER                        PIC X.
  3113     12  DC-CONVERSION-DATES.
  3114         16  DC-BIN-DATE-1             PIC XX.
  3115         16  DC-BIN-DATE-2             PIC XX.
  3116         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3117         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3118                       DC-GREG-DATE-1-EDIT.
  3119             20  DC-EDIT1-MONTH        PIC 99.
  3120             20  SLASH1-1              PIC X.
  3121             20  DC-EDIT1-DAY          PIC 99.
  3122             20  SLASH1-2              PIC X.
  3123             20  DC-EDIT1-YEAR         PIC 99.
  3124         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3125         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3126                     DC-GREG-DATE-2-EDIT.
  3127             20  DC-EDIT2-MONTH        PIC 99.
  3128             20  SLASH2-1              PIC X.
  3129             20  DC-EDIT2-DAY          PIC 99.
  3130             20  SLASH2-2              PIC X.
  3131             20  DC-EDIT2-YEAR         PIC 99.
  3132         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3133         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3134                     DC-GREG-DATE-1-YMD.
  3135             20  DC-YMD-YEAR           PIC 99.
  3136             20  DC-YMD-MONTH          PIC 99.
  3137             20  DC-YMD-DAY            PIC 99.
  3138         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3139         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3140                      DC-GREG-DATE-1-MDY.
  3141             20  DC-MDY-MONTH          PIC 99.
  3142             20  DC-MDY-DAY            PIC 99.
  3143             20  DC-MDY-YEAR           PIC 99.
  3144         16  DC-GREG-DATE-1-ALPHA.
  3145             20  DC-ALPHA-MONTH        PIC X(10).
  3146             20  DC-ALPHA-DAY          PIC 99.
  3147             20  FILLER                PIC XX.
  3148             20  DC-ALPHA-CENTURY.
  3149                 24 DC-ALPHA-CEN-N     PIC 99.
  3150             20  DC-ALPHA-YEAR         PIC 99.
  3151         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3152         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3153         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3154         16  DC-JULIAN-DATE            PIC 9(05).
  3155         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3156                                       PIC 9(05).
  3157         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3158             20  DC-JULIAN-YEAR        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  59
* EL131.cbl
  3159             20  DC-JULIAN-DAYS        PIC 999.
  3160         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3161         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3162         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3163     12  DATE-CONVERSION-VARIBLES.
  3164         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3165         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3166             20  FILLER                PIC 9(3).
  3167             20  HOLD-CEN-1-CCYY.
  3168                 24  HOLD-CEN-1-CC     PIC 99.
  3169                 24  HOLD-CEN-1-YY     PIC 99.
  3170             20  HOLD-CEN-1-MO         PIC 99.
  3171             20  HOLD-CEN-1-DA         PIC 99.
  3172         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3173             20  HOLD-CEN-1-R-MO       PIC 99.
  3174             20  HOLD-CEN-1-R-DA       PIC 99.
  3175             20  HOLD-CEN-1-R-CCYY.
  3176                 24  HOLD-CEN-1-R-CC   PIC 99.
  3177                 24  HOLD-CEN-1-R-YY   PIC 99.
  3178             20  FILLER                PIC 9(3).
  3179         16  HOLD-CENTURY-1-X.
  3180             20  FILLER                PIC X(3)  VALUE SPACES.
  3181             20  HOLD-CEN-1-X-CCYY.
  3182                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3183                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3184             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3185             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3186         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3187             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3188             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3189             20  HOLD-CEN-1-R-X-CCYY.
  3190                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3191                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3192             20  FILLER                PIC XXX.
  3193         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3194         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3195         16  DC-JULIAN-DATE-1          PIC 9(07).
  3196         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3197             20  DC-JULIAN-1-CCYY.
  3198                 24  DC-JULIAN-1-CC    PIC 99.
  3199                 24  DC-JULIAN-1-YR    PIC 99.
  3200             20  DC-JULIAN-DA-1        PIC 999.
  3201         16  DC-JULIAN-DATE-2          PIC 9(07).
  3202         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3203             20  DC-JULIAN-2-CCYY.
  3204                 24  DC-JULIAN-2-CC    PIC 99.
  3205                 24  DC-JULIAN-2-YR    PIC 99.
  3206             20  DC-JULIAN-DA-2        PIC 999.
  3207         16  DC-GREG-DATE-A-EDIT.
  3208             20  DC-EDITA-MONTH        PIC 99.
  3209             20  SLASHA-1              PIC X VALUE '/'.
  3210             20  DC-EDITA-DAY          PIC 99.
  3211             20  SLASHA-2              PIC X VALUE '/'.
  3212             20  DC-EDITA-CCYY.
  3213                 24  DC-EDITA-CENT     PIC 99.
  3214                 24  DC-EDITA-YEAR     PIC 99.
  3215         16  DC-GREG-DATE-B-EDIT.
  3216             20  DC-EDITB-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  60
* EL131.cbl
  3217             20  SLASHB-1              PIC X VALUE '/'.
  3218             20  DC-EDITB-DAY          PIC 99.
  3219             20  SLASHB-2              PIC X VALUE '/'.
  3220             20  DC-EDITB-CCYY.
  3221                 24  DC-EDITB-CENT     PIC 99.
  3222                 24  DC-EDITB-YEAR     PIC 99.
  3223         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3224         16  DC-GREG-DATE-CYMD-R REDEFINES
  3225                              DC-GREG-DATE-CYMD.
  3226             20  DC-CYMD-CEN           PIC 99.
  3227             20  DC-CYMD-YEAR          PIC 99.
  3228             20  DC-CYMD-MONTH         PIC 99.
  3229             20  DC-CYMD-DAY           PIC 99.
  3230         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3231         16  DC-GREG-DATE-MDCY-R REDEFINES
  3232                              DC-GREG-DATE-MDCY.
  3233             20  DC-MDCY-MONTH         PIC 99.
  3234             20  DC-MDCY-DAY           PIC 99.
  3235             20  DC-MDCY-CEN           PIC 99.
  3236             20  DC-MDCY-YEAR          PIC 99.
  3237    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3238        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3239    12  DC-EL310-DATE                  PIC X(21).
  3240    12  FILLER                         PIC X(28).
  3241
  3242*                                COPY ELCDMO.
  3243******************************************************************
  3244*                                                                *
  3245*                                                                *
  3246*                            ELCDMO.                             *
  3247*                            VMOD=2.004                          *
  3248*                                                                *
  3249*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3250*        COMMUNICATION AREA                                      *
  3251*   FILE TYPE = NA                                               *
  3252*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3253*                                                                *
  3254******************************************************************
  3255 01  DMO-COMMUNICATION-AREA.
  3256     12  DM-RECORD-TYPE                  PIC  X(02).
  3257             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3258             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3259             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3260     12  DM-DIST-CODE                    PIC  X(04).
  3261     12  DM-MAIL-CODE                    PIC  X(05).
  3262     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3263     12  DM-INSURED-NAME                 PIC  X(30).
  3264     12  DM-CLAIM-NO                     PIC  X(07).
  3265     12  DM-CLAIM-TYPE                   PIC  X.
  3266
  3267     12  DM-STATUS-DATA-AREA.
  3268         16  DM-CLAIM-STATUS             PIC  X.
  3269             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  3270             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3271             88  DM-CLOSED                        VALUE '3'.
  3272             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3273             88  DM-DEFAULT                       VALUE '9'.
  3274         16  DM-STATUS-DATE              PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  61
* EL131.cbl
  3275******YYYYMMDD
  3276         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3277             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3278             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3279             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3280             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3281             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3282             88  DM-RE-OPENED                     VALUE 'R'.
  3283             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3284             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3285             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3286         16  DM-STAT-CARRIER             PIC X.
  3287
  3288     12  DM-DRAFT-DATA-AREA.
  3289         16  DM-PAYMENT-TYPE             PIC  X.
  3290             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3291         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3292         16  DM-PAYMENT-DATE             PIC  X(08).
  3293******YYYYMMDD
  3294         16  DM-CERT-NO                  PIC  X(11).
  3295         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3296         16  DM-CARRIER                  PIC  X.
  3297
  3298     12  DM-RETURN-CODE                  PIC  XX.
  3299*                                COPY ERCPDEF.
  3300******************************************************************
  3301*                                                                *
  3302*                                                                *
  3303*                            ERCPDEF.                            *
  3304*                                                                *
  3305*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3306*                                                                *
  3307*    FILE TYPE = VSAM,KSDS                                       *
  3308*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3309*                                                                *
  3310*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3311*                                                                *
  3312*    LOG = YES                                                   *
  3313*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3314******************************************************************
  3315*                   C H A N G E   L O G
  3316*
  3317* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3318*-----------------------------------------------------------------
  3319*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3320* EFFECTIVE    NUMBER
  3321*-----------------------------------------------------------------
  3322* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3323* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3324* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  3325******************************************************************
  3326 01  PRODUCT-MASTER.
  3327    12  PD-RECORD-ID                 PIC X(02).
  3328        88  VALID-PD-ID                  VALUE 'PD'.
  3329    12  PD-CONTROL-PRIMARY.
  3330        16  PD-COMPANY-CD            PIC X.
  3331        16  PD-STATE                 PIC XX.
  3332        16  PD-PRODUCT-CD            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  62
* EL131.cbl
  3333        16  PD-FILLER                PIC X(7).
  3334        16  PD-BEN-TYPE              PIC X.
  3335        16  PD-BEN-CODE              PIC XX.
  3336        16  PD-PROD-EXP-DT           PIC XX.
  3337    12  FILLER                       PIC X(50).
  3338    12  PD-PRODUCT-DATA OCCURS 8.
  3339        16  PD-PROD-CODE             PIC X.
  3340            88  PD-PROD-LIFE           VALUE 'L'.
  3341            88  PD-PROD-PROP           VALUE 'P'.
  3342            88  PD-PROD-AH             VALUE 'A'.
  3343            88  PD-PROD-IU             VALUE 'I'.
  3344            88  PD-PROD-GAP            VALUE 'G'.
  3345            88  PD-PROD-FAML           VALUE 'F'.
  3346        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3347        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3348        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3349        16  PD-MAX-TERM              PIC S999        COMP-3.
  3350        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3351        16  FILLER                   PIC X.
  3352        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3353        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3354        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3355        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3356        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3357        16  PD-REC-CRIT-PERIOD       PIC 99.
  3358        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  3359            20  PD-RECURRING-YN      PIC X.
  3360            20  FILLER               PIC X.
  3361        16  PD-RTW-MOS               PIC 99.
  3362        16  PD-MAX-EXTENSION         PIC 99.
  3363        16  pd-ben-pct               pic sv999 comp-3.
  3364*       16  FILLER                   PIC XX.
  3365    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3366    12  PD-TERM-LIMITS OCCURS 15.
  3367        16  PD-LOW-TERM              PIC S999        COMP-3.
  3368        16  PD-HI-TERM               PIC S999        COMP-3.
  3369*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3370    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3371        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3372        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3373    12  PD-EARN-FACTORS.
  3374        16  FILLER OCCURS 15.
  3375            20  FILLER OCCURS 15.
  3376                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3377    12  PD-PRODUCT-DESC              PIC X(80).
  3378    12  PD-TRUNCATED                 PIC X.
  3379    12  FILLER                       PIC X(59).
  3380    12  PD-MAINT-INFORMATION.
  3381        16  PD-LAST-MAINT-DT         PIC X(02).
  3382        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3383        16  PD-LAST-MAINT-BY         PIC X(04).
  3384*                                COPY ELCCRTT.
  3385******************************************************************
  3386*                                                                *
  3387*                            ELCCRTT.                            *
  3388*                                                                *
  3389*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3390*                                                                *
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  63
* EL131.cbl
  3391*   FILE TYPE = VSAM,KSDS                                        *
  3392*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3393*                                                                *
  3394*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3395*                                                                *
  3396*   LOG = YES                                                    *
  3397*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3398******************************************************************
  3399*                   C H A N G E   L O G
  3400*
  3401* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3402*-----------------------------------------------------------------
  3403*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3404* EFFECTIVE    NUMBER
  3405*-----------------------------------------------------------------
  3406* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3407* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3408* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3409* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3410* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3411* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3412* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3413* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3414* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3415******************************************************************
  3416
  3417 01  CERTIFICATE-TRAILERS.
  3418     12  CS-RECORD-ID                      PIC XX.
  3419         88  VALID-CS-ID                      VALUE 'CS'.
  3420
  3421     12  CS-CONTROL-PRIMARY.
  3422         16  CS-COMPANY-CD                 PIC X.
  3423         16  CS-CARRIER                    PIC X.
  3424         16  CS-GROUPING                   PIC X(6).
  3425         16  CS-STATE                      PIC XX.
  3426         16  CS-ACCOUNT                    PIC X(10).
  3427         16  CS-CERT-EFF-DT                PIC XX.
  3428         16  CS-CERT-NO.
  3429             20  CS-CERT-PRIME             PIC X(10).
  3430             20  CS-CERT-SFX               PIC X.
  3431         16  CS-TRAILER-TYPE               PIC X.
  3432             88  COMM-TRLR           VALUE 'A'.
  3433             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3434             88  CERT-DATA-TRLR      VALUE 'C'.
  3435
  3436     12  CS-DATA-AREA                      PIC X(516).
  3437
  3438     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3439         16  CS-BANK-COMMISSION-AREA.
  3440             20  CS-BANK-COMMS       OCCURS 10.
  3441                 24  CS-AGT                PIC X(10).
  3442                 24  CS-COM-TYP            PIC X.
  3443                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3444                 24  CS-RECALC-LV-INDIC    PIC X.
  3445                 24  FILLER                PIC X(10).
  3446         16  FILLER                        PIC X(256).
  3447
  3448     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  64
* EL131.cbl
  3449****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3450         16  CS-MB-CLAIM-DATA OCCURS 24.
  3451             20  CS-CLAIM-NO               PIC X(7).
  3452             20  CS-CLAIM-TYPE             PIC X.
  3453                 88  CS-AH-CLM               VALUE 'A'.
  3454                 88  CS-IU-CLM               VALUE 'I'.
  3455                 88  CS-GP-CLM               VALUE 'G'.
  3456                 88  CS-LF-CLM               VALUE 'L'.
  3457                 88  CS-PR-CLM               VALUE 'P'.
  3458                 88  CS-FL-CLM               VALUE 'F'.
  3459             20  CS-INSURED-TYPE           PIC X.
  3460                 88  CS-PRIM-INSURED          VALUE 'P'.
  3461                 88  CS-CO-BORROWER           VALUE 'C'.
  3462             20  CS-BENEFIT-PERIOD         PIC 99.
  3463             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3464             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3465             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3466         16  FILLER                        PIC X(12).
  3467     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3468         16  CS-VIN-NUMBER                 PIC X(17).
  3469         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3470         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3471         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3472         16  cs-agent-name.
  3473             20  cs-agent-fname            pic x(20).
  3474             20  cs-agent-mi               pic x.
  3475             20  cs-agent-lname            pic x(25).
  3476         16  cs-license-no                 pic x(15).
  3477         16  cs-npn-number                 pic x(10).
  3478         16  cs-agent-edit-status          pic x.
  3479             88  cs-ae-refer-to-manager      value 'M'.
  3480             88  cs-ae-cover-sheet           value 'C'.
  3481             88  cs-ae-sig-form              value 'S'.
  3482             88  cs-ae-verified              value 'V'.
  3483             88  cs-unidentified-signature   value 'U'.
  3484             88  cs-cert-returned            value 'R'.
  3485             88  cs-accept-no-commission     value 'N'.
  3486         16  cs-year                       pic 9999.
  3487         16  cs-make                       pic x(20).
  3488         16  cs-model                      pic x(20).
  3489         16  cs-future                     pic x(20).
  3490         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3491         16  FILLER                        PIC X(356). *> was 420
  3492*        16  FILLER                        PIC X(496).
  3493
  3494****************************************************************
  3495*
  3496* Copyright (c) 2007-2013 Dell Inc.
  3497* All rights reserved.
  3498*
  3499****************************************************************
  3500 01  DFHEIV.
  3501   02  DFHEIV0               PIC X(35).
  3502   02  DFHEIV1               PIC X(08).
  3503   02  DFHEIV2               PIC X(08).
  3504   02  DFHEIV3               PIC X(08).
  3505   02  DFHEIV4               PIC X(06).
  3506   02  DFHEIV5               PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  65
* EL131.cbl
  3507   02  DFHEIV6               PIC X(04).
  3508   02  DFHEIV7               PIC X(02).
  3509   02  DFHEIV8               PIC X(02).
  3510   02  DFHEIV9               PIC X(01).
  3511   02  DFHEIV10              PIC S9(7) COMP-3.
  3512   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3513   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3514   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3515   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3516   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3517   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3518   02  DFHEIV17              PIC X(04).
  3519   02  DFHEIV18              PIC X(04).
  3520   02  DFHEIV19              PIC X(04).
  3521   02  DFHEIV20              USAGE IS POINTER.
  3522   02  DFHEIV21              USAGE IS POINTER.
  3523   02  DFHEIV22              USAGE IS POINTER.
  3524   02  DFHEIV23              USAGE IS POINTER.
  3525   02  DFHEIV24              USAGE IS POINTER.
  3526   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3527   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3528   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3529   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3530   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3531   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3532   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3533   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3534   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3535   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3536   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3537   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3538   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3539   02  FILLER                PIC X(02).
  3540   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3541   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3542   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3543   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3544   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3545   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3546   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3547 LINKAGE  SECTION.
  3548*****************************************************************
  3549*                                                               *
  3550* Copyright (c) 2007-2013 Dell Inc.                             *
  3551* All rights reserved.                                          *
  3552*                                                               *
  3553*****************************************************************
  3554 01  dfheiblk.
  3555     02  eibtime          pic s9(7) comp-3.
  3556     02  eibdate          pic s9(7) comp-3.
  3557     02  eibtrnid         pic x(4).
  3558     02  eibtaskn         pic s9(7) comp-3.
  3559     02  eibtrmid         pic x(4).
  3560     02  dfheigdi         pic s9(4) comp.
  3561     02  eibcposn         pic s9(4) comp.
  3562     02  eibcalen         pic s9(4) comp.
  3563     02  eibaid           pic x(1).
  3564     02  eibfiller1       pic x(1).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  66
* EL131.cbl
  3565     02  eibfn            pic x(2).
  3566     02  eibfiller2       pic x(2).
  3567     02  eibrcode         pic x(6).
  3568     02  eibfiller3       pic x(2).
  3569     02  eibds            pic x(8).
  3570     02  eibreqid         pic x(8).
  3571     02  eibrsrce         pic x(8).
  3572     02  eibsync          pic x(1).
  3573     02  eibfree          pic x(1).
  3574     02  eibrecv          pic x(1).
  3575     02  eibsend          pic x(1).
  3576     02  eibatt           pic x(1).
  3577     02  eibeoc           pic x(1).
  3578     02  eibfmh           pic x(1).
  3579     02  eibcompl         pic x(1).
  3580     02  eibsig           pic x(1).
  3581     02  eibconf          pic x(1).
  3582     02  eiberr           pic x(1).
  3583     02  eibrldbk         pic x(1).
  3584     02  eiberrcd         pic x(4).
  3585     02  eibsynrb         pic x(1).
  3586     02  eibnodat         pic x(1).
  3587     02  eibfiller5       pic x(2).
  3588     02  eibresp          pic s9(8) comp.
  3589     02  eibresp2         pic s9(8) comp.
  3590     02  dfheigdj         pic s9(4) comp.
  3591     02  dfheigdk         pic s9(4) comp.
  3592 01  DFHCOMMAREA                 PIC X(1024).
  3593
  3594*                                COPY ELCMSTR.
  3595******************************************************************
  3596*                                                                *
  3597*                            ELCMSTR.                            *
  3598*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3599*                            VMOD=2.012                          *
  3600*                                                                *
  3601*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3602*                                                                *
  3603*   FILE TYPE = VSAM,KSDS                                        *
  3604*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3605*                                                                *
  3606*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3607*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3608*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3609*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3610*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3611*                                                 RKP=75,LEN=21  *
  3612*                                                                *
  3613*   **** NOTE ****                                               *
  3614*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3615*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3616*                                                                *
  3617*   LOG = YES                                                    *
  3618*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3619******************************************************************
  3620*                   C H A N G E   L O G
  3621*
  3622* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  67
* EL131.cbl
  3623*-----------------------------------------------------------------
  3624*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3625* EFFECTIVE    NUMBER
  3626*-----------------------------------------------------------------
  3627* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3628* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3629* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3630* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3631* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3632* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3633******************************************************************
  3634 01  CLAIM-MASTER.
  3635     12  CL-RECORD-ID                PIC XX.
  3636         88  VALID-CL-ID         VALUE 'CL'.
  3637
  3638     12  CL-CONTROL-PRIMARY.
  3639         16  CL-COMPANY-CD           PIC X.
  3640         16  CL-CARRIER              PIC X.
  3641         16  CL-CLAIM-NO             PIC X(7).
  3642         16  CL-CERT-NO.
  3643             20  CL-CERT-PRIME       PIC X(10).
  3644             20  CL-CERT-SFX         PIC X.
  3645
  3646     12  CL-CONTROL-BY-NAME.
  3647         16  CL-COMPANY-CD-A1        PIC X.
  3648         16  CL-INSURED-LAST-NAME    PIC X(15).
  3649         16  CL-INSURED-NAME.
  3650             20  CL-INSURED-1ST-NAME PIC X(12).
  3651             20  CL-INSURED-MID-INIT PIC X.
  3652
  3653     12  CL-CONTROL-BY-SSN.
  3654         16  CL-COMPANY-CD-A2        PIC X.
  3655         16  CL-SOC-SEC-NO.
  3656             20  CL-SSN-STATE        PIC XX.
  3657             20  CL-SSN-ACCOUNT      PIC X(6).
  3658             20  CL-SSN-LN3          PIC X(3).
  3659
  3660     12  CL-CONTROL-BY-CERT-NO.
  3661         16  CL-COMPANY-CD-A4        PIC X.
  3662         16  CL-CERT-NO-A4.
  3663             20  CL-CERT-A4-PRIME    PIC X(10).
  3664             20  CL-CERT-A4-SFX      PIC X.
  3665
  3666     12  CL-CONTROL-BY-CCN.
  3667         16  CL-COMPANY-CD-A5        PIC X.
  3668         16  CL-CCN-A5.
  3669             20  CL-CCN.
  3670                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3671                 24  CL-CCN-PRIME-A5 PIC X(12).
  3672             20  CL-CCN-FILLER-A5    PIC X(4).
  3673
  3674     12  CL-INSURED-PROFILE-DATA.
  3675         16  CL-INSURED-BIRTH-DT     PIC XX.
  3676         16  CL-INSURED-SEX-CD       PIC X.
  3677             88  INSURED-IS-MALE        VALUE 'M'.
  3678             88  INSURED-IS-FEMALE      VALUE 'F'.
  3679             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3680         16  CL-INSURED-OCC-CD       PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  68
* EL131.cbl
  3681         16  FILLER                  PIC X(5).
  3682
  3683     12  CL-PROCESSING-INFO.
  3684         16  CL-PROCESSOR-ID         PIC X(4).
  3685         16  CL-CLAIM-STATUS         PIC X.
  3686             88  CLAIM-IS-OPEN          VALUE 'O'.
  3687             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3688         16  CL-CLAIM-TYPE           PIC X.
  3689*            88  AH-CLAIM               VALUE 'A'.
  3690*            88  LIFE-CLAIM             VALUE 'L'.
  3691*            88  PROPERTY-CLAIM         VALUE 'P'.
  3692*            88  IUI-CLAIM              VALUE 'I'.
  3693*            88  GAP-CLAIM              VALUE 'G'.
  3694*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3695         16  CL-CLAIM-PREM-TYPE      PIC X.
  3696             88  SINGLE-PREMIUM         VALUE '1'.
  3697             88  O-B-COVERAGE           VALUE '2'.
  3698             88  OPEN-END-COVERAGE      VALUE '3'.
  3699         16  CL-INCURRED-DT          PIC XX.
  3700         16  CL-REPORTED-DT          PIC XX.
  3701         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3702         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3703         16  CL-LAST-PMT-DT          PIC XX.
  3704         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3705         16  CL-PAID-THRU-DT         PIC XX.
  3706         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3707         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3708         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3709         16  CL-PMT-CALC-METHOD      PIC X.
  3710             88  CL-360-DAY-YR          VALUE '1'.
  3711             88  CL-365-DAY-YR          VALUE '2'.
  3712             88  CL-FULL-MONTHS         VALUE '3'.
  3713         16  CL-CAUSE-CD             PIC X(6).
  3714
  3715         16  CL-PRIME-CERT-NO.
  3716             20  CL-PRIME-CERT-PRIME PIC X(10).
  3717             20  CL-PRIME-CERT-SFX   PIC X.
  3718
  3719         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3720             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3721             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3722
  3723         16  CL-MICROFILM-NO         PIC X(10).
  3724         16  FILLER REDEFINES CL-MICROFILM-NO.
  3725             20  CL-BENEFIT-PERIOD   PIC 99.
  3726             20  FILLER              PIC X(8).
  3727         16  CL-PROG-FORM-TYPE       PIC X.
  3728         16  CL-LAST-ADD-ON-DT       PIC XX.
  3729
  3730         16  CL-LAST-REOPEN-DT       PIC XX.
  3731         16  CL-LAST-CLOSE-DT        PIC XX.
  3732         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3733             88  FINAL-PAID             VALUE '1'.
  3734             88  CLAIM-DENIED           VALUE '2'.
  3735             88  AUTO-CLOSE             VALUE '3'.
  3736             88  MANUAL-CLOSE           VALUE '4'.
  3737             88  BENEFITS-CHANGED       VALUE 'C'.
  3738             88  SETUP-ERRORS           VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  69
* EL131.cbl
  3739         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3740         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3741         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3742             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3743         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3744         16  FILLER                  PIC X.
  3745
  3746     12  CL-CERTIFICATE-DATA.
  3747         16  CL-CERT-ORIGIN          PIC X.
  3748             88  CERT-WAS-ONLINE        VALUE '1'.
  3749             88  CERT-WAS-CREATED       VALUE '2'.
  3750             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3751         16  CL-CERT-KEY-DATA.
  3752             20  CL-CERT-CARRIER     PIC X.
  3753             20  CL-CERT-GROUPING    PIC X(6).
  3754             20  CL-CERT-STATE       PIC XX.
  3755             20  CL-CERT-ACCOUNT.
  3756                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3757                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3758             20  CL-CERT-EFF-DT      PIC XX.
  3759
  3760     12  CL-STATUS-CONTROLS.
  3761         16  CL-PRIORITY-CD          PIC X.
  3762             88  CONFIDENTIAL-DATA      VALUE '8'.
  3763             88  HIGHEST-PRIORITY       VALUE '9'.
  3764         16  CL-SUPV-ATTN-CD         PIC X.
  3765             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3766             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3767         16  CL-PURGED-DT            PIC XX.
  3768         16  CL-RESTORED-DT          PIC XX.
  3769         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3770         16  CL-NEXT-RESEND-DT       PIC XX.
  3771         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3772         16  CL-CRITICAL-PERIOD      PIC 99.
  3773*        16  FILLER                  PIC XX.
  3774         16  CL-LAST-MAINT-DT        PIC XX.
  3775         16  CL-LAST-MAINT-USER      PIC X(4).
  3776         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3777         16  CL-LAST-MAINT-TYPE      PIC X.
  3778             88  CLAIM-SET-UP           VALUE ' '.
  3779             88  PAYMENT-MADE           VALUE '1'.
  3780             88  LETTER-SENT            VALUE '2'.
  3781             88  MASTER-WAS-ALTERED     VALUE '3'.
  3782             88  MASTER-WAS-RESTORED    VALUE '4'.
  3783             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3784             88  FILE-CONVERTED         VALUE '6'.
  3785             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3786             88  ERROR-CORRECTION       VALUE 'E'.
  3787         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3788         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3789         16  CL-BENEFICIARY          PIC X(10).
  3790         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3791         16  CL-DENIAL-TYPE          PIC X.
  3792             88  CL-TYPE-DENIAL          VALUE '1'.
  3793             88  CL-TYPE-RESCISSION      VALUE '2'.
  3794             88  CL-TYPE-REFORMATION     VALUE '3'.
  3795             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3796             88  CL-TYPE-RECONSIDERED    VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  70
* EL131.cbl
  3797         16  CL-NO-OF-EXTENSIONS     PIC 99.
  3798         16  filler                  pic x(3).
  3799*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3800*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3801*        16  CL-RTW-DT               PIC XX.
  3802
  3803     12  CL-TRAILER-CONTROLS.
  3804         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3805             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3806             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3807             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3808         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3809         16  FILLER                  PIC XX.
  3810         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3811         16  CL-ADDRESS-TRAILER-CNT.
  3812             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3813                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3814             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3815                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3816             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3817                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3818             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3819                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3820             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3821                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3822             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3823                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3824             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3825                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3826
  3827     12  CL-CV-REFERENCE-NO.
  3828         16  CL-CV-REFNO-PRIME       PIC X(18).
  3829         16  CL-CV-REFNO-SFX         PIC XX.
  3830
  3831     12  CL-FILE-LOCATION            PIC X(4).
  3832
  3833     12  CL-PROCESS-ERRORS.
  3834         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3835             88  NO-FATAL-ERRORS        VALUE ZERO.
  3836         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3837             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3838
  3839     12  CL-PRODUCT-CD               PIC X.
  3840
  3841     12  CL-CURRENT-KEY-DATA.
  3842         16  CL-CURRENT-CARRIER      PIC X.
  3843         16  CL-CURRENT-GROUPING     PIC X(6).
  3844         16  CL-CURRENT-STATE        PIC XX.
  3845         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3846
  3847     12  CL-ASSOCIATES               PIC X.
  3848         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3849         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3850         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3851         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3852
  3853     12  CL-ACTIVITY-CODE            PIC 99.
  3854     12  CL-ACTIVITY-MAINT-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  71
* EL131.cbl
  3855     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3856
  3857     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3858     12  CL-LAG-REPORT-CODE          PIC 9.
  3859     12  CL-LOAN-TYPE                PIC XX.
  3860     12  CL-LEGAL-STATE              PIC XX.
  3861
  3862     12  CL-YESNOSW                  PIC X.
  3863     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3864         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3865         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3866         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3867     12  cl-insured-type             pic x.
  3868         88  cl-claim-on-primary         value 'P'.
  3869         88  cl-claim-on-co-borrower     value 'C'.
  3870     12  cl-benefit-expiration-dt    PIC XX.
  3871
  3872*                                COPY ELCCERT.
  3873******************************************************************
  3874*                                                                *
  3875*                            ELCCERT.                            *
  3876*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3877*                            VMOD=2.013                          *
  3878*                                                                *
  3879*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3880*                                                                *
  3881*   FILE TYPE = VSAM,KSDS                                        *
  3882*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3883*                                                                *
  3884*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3885*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3886*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3887*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3888*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3889*                                                                *
  3890*   LOG = YES                                                    *
  3891*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3892******************************************************************
  3893*                   C H A N G E   L O G
  3894*
  3895* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3896*-----------------------------------------------------------------
  3897*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3898* EFFECTIVE    NUMBER
  3899*-----------------------------------------------------------------
  3900* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3901* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3902* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3903* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3904* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3905* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3906* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3907* 032612  CR2011110200001  PEMA  AHL CHANGES
  3908* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  3909* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3910******************************************************************
  3911
  3912 01  CERTIFICATE-MASTER.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  72
* EL131.cbl
  3913     12  CM-RECORD-ID                      PIC XX.
  3914         88  VALID-CM-ID                      VALUE 'CM'.
  3915
  3916     12  CM-CONTROL-PRIMARY.
  3917         16  CM-COMPANY-CD                 PIC X.
  3918         16  CM-CARRIER                    PIC X.
  3919         16  CM-GROUPING.
  3920             20  CM-GROUPING-PREFIX        PIC X(3).
  3921             20  CM-GROUPING-PRIME         PIC X(3).
  3922         16  CM-STATE                      PIC XX.
  3923         16  CM-ACCOUNT.
  3924             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3925             20  CM-ACCOUNT-PRIME          PIC X(6).
  3926         16  CM-CERT-EFF-DT                PIC XX.
  3927         16  CM-CERT-NO.
  3928             20  CM-CERT-PRIME             PIC X(10).
  3929             20  CM-CERT-SFX               PIC X.
  3930
  3931     12  CM-CONTROL-BY-NAME.
  3932         16  CM-COMPANY-CD-A1              PIC X.
  3933         16  CM-INSURED-LAST-NAME          PIC X(15).
  3934         16  CM-INSURED-INITIALS.
  3935             20  CM-INSURED-INITIAL1       PIC X.
  3936             20  CM-INSURED-INITIAL2       PIC X.
  3937
  3938     12  CM-CONTROL-BY-SSN.
  3939         16  CM-COMPANY-CD-A2              PIC X.
  3940         16  CM-SOC-SEC-NO.
  3941             20  CM-SSN-STATE              PIC XX.
  3942             20  CM-SSN-ACCOUNT            PIC X(6).
  3943             20  CM-SSN-LN3.
  3944                 25  CM-INSURED-INITIALS-A2.
  3945                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3946                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3947                 25 CM-PART-LAST-NAME-A2         PIC X.
  3948
  3949     12  CM-CONTROL-BY-CERT-NO.
  3950         16  CM-COMPANY-CD-A4              PIC X.
  3951         16  CM-CERT-NO-A4                 PIC X(11).
  3952
  3953     12  CM-CONTROL-BY-MEMB.
  3954         16  CM-COMPANY-CD-A5              PIC X.
  3955         16  CM-MEMBER-NO.
  3956             20  CM-MEMB-STATE             PIC XX.
  3957             20  CM-MEMB-ACCOUNT           PIC X(6).
  3958             20  CM-MEMB-LN4.
  3959                 25  CM-INSURED-INITIALS-A5.
  3960                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3961                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3962                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3963
  3964     12  CM-INSURED-PROFILE-DATA.
  3965         16  CM-INSURED-FIRST-NAME.
  3966             20  CM-INSURED-1ST-INIT       PIC X.
  3967             20  FILLER                    PIC X(9).
  3968         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3969         16  CM-INSURED-SEX                PIC X.
  3970             88  CM-SEX-MALE                  VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  73
* EL131.cbl
  3971             88  CM-SEX-FEMAL                 VALUE 'F'.
  3972         16  CM-INSURED-JOINT-AGE          PIC 99.
  3973         16  CM-JOINT-INSURED-NAME.
  3974             20  CM-JT-LAST-NAME           PIC X(15).
  3975             20  CM-JT-FIRST-NAME.
  3976                 24  CM-JT-1ST-INIT        PIC X.
  3977                 24  FILLER                PIC X(9).
  3978             20  CM-JT-INITIAL             PIC X.
  3979
  3980     12  CM-LIFE-DATA.
  3981         16  CM-LF-BENEFIT-CD              PIC XX.
  3982         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3983         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3984         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3985         16  CM-LF-DEV-CODE                PIC XXX.
  3986         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3987         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3988         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3989         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3990         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3991         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3992         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3993         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3994         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3995         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3996         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3997         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3998         16  cm-temp-epiq                  pic xx.
  3999             88  EPIQ-CLASS                  value 'EQ'.
  4000*        16  FILLER                        PIC XX.
  4001
  4002     12  CM-AH-DATA.
  4003         16  CM-AH-BENEFIT-CD              PIC XX.
  4004         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4005         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4006         16  CM-AH-DEV-CODE                PIC XXX.
  4007         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4008         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4009         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4010         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4011         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4012         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4013         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4014         16  CM-AH-PAID-THRU-DT            PIC XX.
  4015             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4016         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4017         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4018         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4019         16  FILLER                        PIC X.
  4020
  4021     12  CM-LOAN-INFORMATION.
  4022         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4023         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4024                                           PIC S9(5)V99  COMP-3.
  4025         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4026         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4027         16  CM-PAY-FREQUENCY              PIC S99.
  4028         16  CM-LOAN-TERM                  PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  74
* EL131.cbl
  4029         16  CM-RATE-CLASS                 PIC XX.
  4030         16  CM-BENEFICIARY                PIC X(25).
  4031         16  CM-POLICY-FORM-NO             PIC X(12).
  4032         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4033         16  CM-LAST-ADD-ON-DT             PIC XX.
  4034         16  CM-DEDUCTIBLE-AMOUNTS.
  4035             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4036             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4037         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4038             20  CM-RESIDENT-STATE         PIC XX.
  4039             20  CM-RATE-CODE              PIC X(4).
  4040             20  FILLER                    PIC XX.
  4041         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4042             20  CM-LOAN-OFFICER           PIC X(5).
  4043             20  FILLER                    PIC XXX.
  4044         16  CM-CSR-CODE                   PIC XXX.
  4045         16  CM-UNDERWRITING-CODE          PIC X.
  4046             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4047         16  CM-POST-CARD-IND              PIC X.
  4048         16  CM-NH-INTERFACE-SW            PIC X.
  4049         16  CM-PREMIUM-TYPE               PIC X.
  4050             88  CM-SING-PRM                  VALUE '1'.
  4051             88  CM-O-B-COVERAGE              VALUE '2'.
  4052             88  CM-OPEN-END                  VALUE '3'.
  4053         16  CM-IND-GRP-TYPE               PIC X.
  4054             88  CM-INDIVIDUAL                VALUE 'I'.
  4055             88  CM-GROUP                     VALUE 'G'.
  4056         16  CM-SKIP-CODE                  PIC X.
  4057             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4058             88  SKIP-JULY                    VALUE '1'.
  4059             88  SKIP-AUGUST                  VALUE '2'.
  4060             88  SKIP-SEPTEMBER               VALUE '3'.
  4061             88  SKIP-JULY-AUG                VALUE '4'.
  4062             88  SKIP-AUG-SEPT                VALUE '5'.
  4063             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4064             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4065             88  SKIP-JUNE                    VALUE '8'.
  4066             88  SKIP-JUNE-JULY               VALUE '9'.
  4067             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4068             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4069         16  CM-PAYMENT-MODE               PIC X.
  4070             88  PAY-MONTHLY                  VALUE SPACE.
  4071             88  PAY-WEEKLY                   VALUE '1'.
  4072             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4073             88  PAY-BI-WEEKLY                VALUE '3'.
  4074             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4075         16  CM-LOAN-NUMBER                PIC X(8).
  4076         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4077         16  CM-OLD-LOF                    PIC XXX.
  4078*        16  CM-LOAN-OFFICER               PIC XXX.
  4079         16  CM-REIN-TABLE                 PIC XXX.
  4080         16  CM-SPECIAL-REIN-CODE          PIC X.
  4081         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4082         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4083         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4084
  4085     12  CM-STATUS-DATA.
  4086         16  CM-ENTRY-STATUS               PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  75
* EL131.cbl
  4087         16  CM-ENTRY-DT                   PIC XX.
  4088
  4089         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4090         16  CM-LF-CANCEL-DT               PIC XX.
  4091         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4092
  4093         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4094         16  CM-LF-DEATH-DT                PIC XX.
  4095         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4096
  4097         16  CM-LF-CURRENT-STATUS          PIC X.
  4098             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4099                                                'M' '4' '5' '9'.
  4100             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4101             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4102             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4103             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4104             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4105             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4106             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4107             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4108             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4109             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4110             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4111             88  CM-LF-DECLINED               VALUE 'D'.
  4112             88  CM-LF-VOIDED                 VALUE 'V'.
  4113
  4114         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4115         16  CM-AH-CANCEL-DT               PIC XX.
  4116         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4117
  4118         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4119         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4120         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4121
  4122         16  CM-AH-CURRENT-STATUS          PIC X.
  4123             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4124                                                'M' '4' '5' '9'.
  4125             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4126             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4127             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4128             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4129             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4130             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4131             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4132             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4133             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4134             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4135             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4136             88  CM-AH-DECLINED               VALUE 'D'.
  4137             88  CM-AH-VOIDED                 VALUE 'V'.
  4138
  4139         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4140             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4141             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4142             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4143         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4144
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  76
* EL131.cbl
  4145         16  CM-ENTRY-BATCH                PIC X(6).
  4146         16  CM-LF-EXIT-BATCH              PIC X(6).
  4147         16  CM-AH-EXIT-BATCH              PIC X(6).
  4148         16  CM-LAST-MONTH-END             PIC XX.
  4149
  4150     12  CM-NOTE-SW                        PIC X.
  4151         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4152         88  CERT-NOTES-PRESENT               VALUE '1'.
  4153         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4154         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4155         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4156         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4157         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4158         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4159     12  CM-COMP-EXCP-SW                   PIC X.
  4160         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4161         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4162     12  CM-INSURED-ADDRESS-SW             PIC X.
  4163         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4164         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4165
  4166*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4167     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4168     12  FILLER                            PIC X.
  4169
  4170*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4171     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4172     12  FILLER                            PIC X.
  4173*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4174     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4175
  4176     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4177         88  CERT-ADDED-BATCH                 VALUE ' '.
  4178         88  CERT-ADDED-ONLINE                VALUE '1'.
  4179         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4180         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4181         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4182     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4183         88  CERT-AS-LOADED                   VALUE ' '.
  4184         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4185         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4186         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4187         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4188         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4189         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4190         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4191
  4192     12  CM-ACCOUNT-COMM-PCTS.
  4193         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4194         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4195
  4196     12  CM-USER-FIELD                     PIC X.
  4197     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4198     12  CM-CLP-STATE                      PIC XX.
  4199     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4200     12  CM-USER-RESERVED                  PIC XXX.
  4201     12  FILLER REDEFINES CM-USER-RESERVED.
  4202         16  CM-AH-CLASS-CD                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  77
* EL131.cbl
  4203         16  F                             PIC X.
  4204******************************************************************
  4205
  4206*                                COPY ELCTRLR.
  4207******************************************************************
  4208*                                                                *
  4209*                            ELCTRLR.                            *
  4210*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4211*                            VMOD=2.014                          *
  4212*                                                                *
  4213*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4214*                                                                *
  4215*   FILE TYPE = VSAM,KSDS                                        *
  4216*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4217*                                                                *
  4218*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4219*       ALTERNATE INDEX = NONE                                   *
  4220*                                                                *
  4221*   LOG = YES                                                    *
  4222*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4223******************************************************************
  4224*                   C H A N G E   L O G
  4225*
  4226* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4227*-----------------------------------------------------------------
  4228*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4229* EFFECTIVE    NUMBER
  4230*-----------------------------------------------------------------
  4231* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4232* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4233* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4234* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4235* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4236* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4237* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4238* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4239* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4240* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4241* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4242* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4243* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4244* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4245* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4246* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4247* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  4248* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  4249* 040814    2014030500002  AJRA  ADD ICD CODES
  4250* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4251* 013017  CR2016053100001  PEMA  ACH PROCESSING
  4252* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  4253******************************************************************
  4254 01  ACTIVITY-TRAILERS.
  4255     12  AT-RECORD-ID                    PIC XX.
  4256         88  VALID-AT-ID                       VALUE 'AT'.
  4257
  4258     12  AT-CONTROL-PRIMARY.
  4259         16  AT-COMPANY-CD               PIC X.
  4260         16  AT-CARRIER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  78
* EL131.cbl
  4261         16  AT-CLAIM-NO                 PIC X(7).
  4262         16  AT-CERT-NO.
  4263             20  AT-CERT-PRIME           PIC X(10).
  4264             20  AT-CERT-SFX             PIC X.
  4265         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4266             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4267             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4268             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4269             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4270             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4271             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4272             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4273             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4274             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4275             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4276             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4277             88  AT-BENEFICIARY-TRL           VALUE +91.
  4278             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4279             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4280             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4281             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4282
  4283     12  AT-TRAILER-TYPE                 PIC X.
  4284         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4285         88  PAYMENT-TR                       VALUE '2'.
  4286         88  AUTO-PAY-TR                      VALUE '3'.
  4287         88  CORRESPONDENCE-TR                VALUE '4'.
  4288         88  ADDRESS-TR                       VALUE '5'.
  4289         88  GENERAL-INFO-TR                  VALUE '6'.
  4290         88  AUTO-PROMPT-TR                   VALUE '7'.
  4291         88  DENIAL-TR                        VALUE '8'.
  4292         88  INCURRED-CHG-TR                  VALUE '9'.
  4293         88  FORM-CONTROL-TR                  VALUE 'A'.
  4294
  4295     12  AT-RECORDED-DT                  PIC XX.
  4296     12  AT-RECORDED-BY                  PIC X(4).
  4297     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4298
  4299     12  AT-TRAILER-BODY                 PIC X(165).
  4300
  4301     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4302         16  AT-RESERVE-CONTROLS.
  4303             20  AT-MANUAL-SW            PIC X.
  4304                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4305             20  AT-FUTURE-SW            PIC X.
  4306                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4307             20  AT-PTC-SW               PIC X.
  4308                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4309             20  AT-IBNR-SW              PIC X.
  4310                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4311             20  AT-PTC-LF-SW            PIC X.
  4312                 88  AT-LF-PTC-USED          VALUE '1'.
  4313             20  AT-CDT-ACCESS-METHOD    PIC X.
  4314                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4315                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4316                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4317             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4318         16  AT-LAST-COMPUTED-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  79
* EL131.cbl
  4319         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4320         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4321         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4322         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4323         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4324         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4325         16  AT-EXPENSE-CONTROLS.
  4326             20  AT-EXPENSE-METHOD       PIC X.
  4327                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4328                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4329                 88  PERCENT-OF-PMT           VALUE '3'.
  4330                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4331             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4332             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4333         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4334         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4335
  4336         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4337         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4338
  4339*        16  FILLER                      PIC X(53).
  4340         16  FILLER                      PIC X(47).
  4341
  4342         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4343         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4344
  4345         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4346             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4347             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4348*                    C = CLOSED
  4349*                    O = OPEN
  4350             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4351*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4352
  4353     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4354         16  AT-PAYMENT-TYPE             PIC X.
  4355             88  PARTIAL-PAYMENT                VALUE '1'.
  4356             88  FINAL-PAYMENT                  VALUE '2'.
  4357             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4358             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4359             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4360             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4361             88  VOIDED-PAYMENT                 VALUE '9'.
  4362             88  TRANSFER                       VALUE 'T'.
  4363             88  LIFE-INTEREST                  VALUE 'I'.
  4364
  4365         16  AT-CLAIM-TYPE               PIC X.
  4366             88  PAID-FOR-AH                    VALUE 'A'.
  4367             88  PAID-FOR-LIFE                  VALUE 'L'.
  4368             88  PAID-FOR-IUI                   VALUE 'I'.
  4369             88  PAID-FOR-GAP                   VALUE 'G'.
  4370             88  PAID-FOR-FAM                   VALUE 'F'.
  4371         16  AT-CLAIM-PREM-TYPE          PIC X.
  4372             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4373             88  AT-O-B-COVERAGE                VALUE '2'.
  4374             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4375         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4376         16  AT-CHECK-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  80
* EL131.cbl
  4377         16  AT-PAID-FROM-DT             PIC XX.
  4378         16  AT-PAID-THRU-DT             PIC XX.
  4379         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4380         16  AT-ACH-PAYMENT              PIC X.
  4381*        16  FILLER                      PIC X.
  4382         16  AT-PAYEES-NAME              PIC X(30).
  4383         16  AT-PAYMENT-ORIGIN           PIC X.
  4384             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4385             88  ONLINE-AUTO-PMT                VALUE '2'.
  4386             88  OFFLINE-PMT                    VALUE '3'.
  4387         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4388         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4389         16  AT-VOID-DATA.
  4390             20  AT-VOID-DT              PIC XX.
  4391*00144       20  AT-VOID-REASON          PIC X(30).
  4392             20  AT-VOID-REASON          PIC X(26).
  4393         16  AT-PMT-APPROVED-BY          PIC X(04).
  4394         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4395         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4396         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4397                                         PIC S99V9(5)  COMP-3.
  4398         16  AT-CREDIT-INTERFACE.
  4399             20  AT-PMT-SELECT-DT        PIC XX.
  4400                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4401             20  AT-PMT-ACCEPT-DT        PIC XX.
  4402                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4403             20  AT-VOID-SELECT-DT       PIC XX.
  4404                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4405             20  AT-VOID-ACCEPT-DT       PIC XX.
  4406                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4407
  4408         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4409                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4410                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4411         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4412
  4413         16  AT-FORCE-CONTROL            PIC X.
  4414             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4415         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4416         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4417         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4418         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4419         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4420         16  AT-BENEFIT-TYPE             PIC X.
  4421
  4422         16  AT-EXPENSE-TYPE             PIC X.
  4423         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4424
  4425         16  AT-PAYEE-TYPE-CD.
  4426             20  AT-PAYEE-TYPE           PIC X.
  4427                 88  INSURED-PAID           VALUE 'I'.
  4428                 88  BENEFICIARY-PAID       VALUE 'B'.
  4429                 88  ACCOUNT-PAID           VALUE 'A'.
  4430                 88  OTHER-1-PAID           VALUE 'O'.
  4431                 88  OTHER-2-PAID           VALUE 'Q'.
  4432                 88  DOCTOR-PAID            VALUE 'P'.
  4433                 88  EMPLOYER-PAID          VALUE 'E'.
  4434             20  AT-PAYEE-SEQ            PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  81
* EL131.cbl
  4435
  4436         16  AT-CASH-PAYMENT             PIC X.
  4437         16  AT-GROUPED-PAYMENT          PIC X.
  4438         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4439         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4440         16  AT-APPROVED-LEVEL           PIC X.
  4441         16  AT-VOID-TYPE                PIC X.
  4442             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4443             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4444         16  AT-AIG-UNEMP-IND            PIC X.
  4445             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4446         16  AT-ASSOCIATES               PIC X.
  4447             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4448             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4449
  4450         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4451         16  AT-CV-PMT-CODE              PIC X.
  4452             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4453             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4454             88  FULL-ADD-PAYMENT           VALUE '3'.
  4455             88  HALF-ADD-PAYMENT           VALUE '4'.
  4456             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4457             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4458             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4459             88  ADDL-PAYMENT               VALUE '8'.
  4460
  4461         16  AT-EOB-CODE1                PIC XXX.
  4462         16  AT-EOB-CODE2                PIC XXX.
  4463         16  AT-EOB-CODE3                PIC XXX.
  4464         16  FILLER REDEFINES AT-EOB-CODE3.
  4465             20  AT-PRINT-CLM-FORM       PIC X.
  4466             20  AT-PRINT-SURVEY         PIC X.
  4467             20  AT-SPECIAL-RELEASE      PIC X.
  4468         16  AT-EOB-CODE4                PIC XXX.
  4469         16  FILLER REDEFINES AT-EOB-CODE4.
  4470             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4471             20  FILLER                  PIC X.
  4472         16  AT-EOB-CODE5                PIC XXX.
  4473         16  FILLER REDEFINES AT-EOB-CODE5.
  4474             20  AT-PMT-PROOF-DT         PIC XX.
  4475             20  FILLER                  PIC X.
  4476
  4477         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4478             88  AT-PRINT-EOB            VALUE 'Y'.
  4479
  4480         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4481         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4482
  4483     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4484         16  AT-SCHEDULE-START-DT        PIC XX.
  4485         16  AT-SCHEDULE-END-DT          PIC XX.
  4486         16  AT-TERMINATED-DT            PIC XX.
  4487         16  AT-LAST-PMT-TYPE            PIC X.
  4488             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4489             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4490         16  AT-FIRST-PMT-DATA.
  4491             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4492             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  82
* EL131.cbl
  4493             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4494         16  AT-REGULAR-PMT-DATA.
  4495             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4496             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4497             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4498         16  AT-AUTO-PAYEE-CD.
  4499             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4500                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4501                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4502                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4503                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4504                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4505             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4506         16  AT-AUTO-PAY-DAY             PIC 99.
  4507         16  AT-AUTO-CASH                PIC X.
  4508             88  AT-CASH                      VALUE 'Y'.
  4509             88  AT-NON-CASH                  VALUE 'N'.
  4510*        16  FILLER                      PIC X(129).
  4511         16  AT-AUTO-END-LETTER          PIC X(4).
  4512         16  FILLER                      PIC X(125).
  4513
  4514         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4515         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4516
  4517     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4518         16  AT-LETTER-SENT-DT           PIC XX.
  4519         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4520         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4521         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4522         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4523         16  AT-LETTER-ORIGIN            PIC X.
  4524             88  ONLINE-CREATION              VALUE '1' '3'.
  4525             88  OFFLINE-CREATION             VALUE '2' '4'.
  4526             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4527             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4528         16  AT-STD-LETTER-FORM          PIC X(4).
  4529         16  AT-REASON-TEXT              PIC X(70).
  4530         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4531         16  AT-ADDRESEE-TYPE            PIC X.
  4532              88  INSURED-ADDRESEE            VALUE 'I'.
  4533              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4534              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4535              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4536              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4537              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4538              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4539         16  AT-ADDRESSEE-NAME           PIC X(30).
  4540         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4541         16  AT-RESEND-PRINT-DATE        PIC XX.
  4542         16  AT-CORR-SOL-UNSOL           PIC X.
  4543         16  AT-LETTER-PURGED-DT         PIC XX.
  4544*
  4545*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4546*
  4547         16  AT-CSO-REDEFINITION.
  4548             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4549             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4550             20  AT-LETTER-TO-BENE       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  83
* EL131.cbl
  4551             20  AT-STOP-LETTER-DT       PIC X(2).
  4552             20  AT-AUTH-RCVD            PIC X(1).
  4553             20  FILLER                  PIC X(18).
  4554*             20  FILLER                  PIC X(27).
  4555             20  AT-CSO-LETTER-STATUS    PIC X.
  4556                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4557                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4558                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4559             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4560             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4561*
  4562*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4563*
  4564*        16  FILLER                      PIC X(26).
  4565*
  4566*        16  AT-DMD-BSR-CODE             PIC X.
  4567*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4568*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4569*
  4570*        16  AT-DMD-LETTER-STATUS        PIC X.
  4571*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4572*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4573*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4574*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4575*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4576
  4577         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4578         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4579
  4580     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4581         16  AT-ADDRESS-TYPE             PIC X.
  4582             88  INSURED-ADDRESS               VALUE 'I'.
  4583             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4584             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4585             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4586             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4587             88  OTHER-ADDRESS-1               VALUE 'O'.
  4588             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4589         16  AT-MAIL-TO-NAME             PIC X(30).
  4590         16  AT-ADDRESS-LINE-1           PIC X(30).
  4591         16  AT-ADDRESS-LINE-2           PIC X(30).
  4592         16  AT-CITY-STATE.
  4593             20  AT-CITY                 PIC X(28).
  4594             20  AT-STATE                PIC XX.
  4595         16  AT-ZIP.
  4596             20  AT-ZIP-CODE.
  4597                 24  AT-ZIP-1ST          PIC X.
  4598                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4599                 24  FILLER              PIC X(4).
  4600             20  AT-ZIP-PLUS4            PIC X(4).
  4601         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4602             20  AT-CAN-POSTAL-1         PIC XXX.
  4603             20  AT-CAN-POSTAL-2         PIC XXX.
  4604             20  FILLER                  PIC XXX.
  4605         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4606*         16  FILLER                      PIC X(23).
  4607         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4608         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  84
* EL131.cbl
  4609         16  FILLER                      PIC X(13).
  4610         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4611         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4612
  4613     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4614         16  AT-INFO-LINE-1              PIC X(60).
  4615         16  FILLER REDEFINES AT-INFO-LINE-1.
  4616             20  AT-NOTE-ERROR-NO OCCURS 15
  4617                                         PIC X(4).
  4618         16  AT-INFO-LINE-2              PIC X(60).
  4619         16  FILLER REDEFINES AT-INFO-LINE-2.
  4620             20  AT-ICD-CODE-1           PIC X(8).
  4621             20  AT-ICD-CODE-2           PIC X(8).
  4622             20  FILLER                  PIC X(44).
  4623         16  AT-INFO-TRAILER-TYPE        PIC X.
  4624             88  AT-ERRORS-NOTE          VALUE 'E'.
  4625             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4626             88  AT-CALL-NOTE            VALUE 'C'.
  4627             88  AT-MAINT-NOTE           VALUE 'M'.
  4628             88  AT-CERT-CHANGE          VALUE 'X'.
  4629             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4630             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4631             88  AT-CERT-CANCELLED       VALUE 'T'.
  4632         16  AT-CALL-TYPE                PIC X.
  4633             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4634             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4635         16  AT-NOTE-CONTINUATION        PIC X.
  4636             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4637         16  AT-EOB-CODES-EXIST          PIC X.
  4638             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4639         16  FILLER                      PIC X(35).
  4640         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4641         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4642
  4643     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4644         16  AT-PROMPT-LINE-1            PIC X(60).
  4645         16  AT-PROMPT-LINE-2            PIC X(60).
  4646         16  AT-PROMPT-START-DT          PIC XX.
  4647         16  AT-PROMPT-END-DT            PIC XX.
  4648         16  FILLER                      PIC X(35).
  4649         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4650         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4651
  4652     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4653         16  AT-DENIAL-INFO-1            PIC X(60).
  4654         16  AT-DENIAL-INFO-2            PIC X(60).
  4655         16  AT-DENIAL-DT                PIC XX.
  4656         16  AT-RETRACTION-DT            PIC XX.
  4657         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4658*         16  FILLER                      PIC X(31).
  4659         16  AT-DENIAL-PROOF-DT          PIC XX.
  4660         16  FILLER                      PIC X(29).
  4661         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4662         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4663
  4664     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4665         16  AT-OLD-INCURRED-DT          PIC XX.
  4666         16  AT-OLD-REPORTED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  85
* EL131.cbl
  4667         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4668         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4669         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4670         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4671         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4672         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4673         16  FILLER                      PIC X(26).
  4674         16  AT-OLD-DIAG-CODE            PIC X(6).
  4675         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4676         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4677         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4678         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4679         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4680         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4681         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4682         16  AT-OLD-ICD-CODE-1           PIC X(8).
  4683         16  AT-OLD-ICD-CODE-2           PIC X(8).
  4684         16  FILLER                      PIC X(9).
  4685         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4686
  4687     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4688         16  AT-FORM-SEND-ON-DT          PIC XX.
  4689         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4690         16  AT-FORM-RE-SEND-DT          PIC XX.
  4691         16  AT-FORM-ANSWERED-DT         PIC XX.
  4692         16  AT-FORM-PRINTED-DT          PIC XX.
  4693         16  AT-FORM-REPRINT-DT          PIC XX.
  4694         16  AT-FORM-TYPE                PIC X.
  4695             88  INITIAL-FORM                  VALUE '1'.
  4696             88  PROGRESS-FORM                 VALUE '2'.
  4697         16  AT-INSTRUCT-LN-1            PIC X(28).
  4698         16  AT-INSTRUCT-LN-2            PIC X(28).
  4699         16  AT-INSTRUCT-LN-3            PIC X(28).
  4700         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4701         16  AT-FORM-ADDRESS             PIC X.
  4702             88  FORM-TO-INSURED              VALUE 'I'.
  4703             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4704             88  FORM-TO-OTHER-1              VALUE 'O'.
  4705             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4706         16  AT-RELATED-1.
  4707             20 AT-REL-CARR-1            PIC X.
  4708             20 AT-REL-CLAIM-1           PIC X(7).
  4709             20 AT-REL-CERT-1            PIC X(11).
  4710         16  AT-RELATED-2.
  4711             20 AT-REL-CARR-2            PIC X.
  4712             20 AT-REL-CLAIM-2           PIC X(7).
  4713             20 AT-REL-CERT-2            PIC X(11).
  4714         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4715         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4716         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4717         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4718         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4719         16  AT-STOP-FORM-DT             PIC X(2).
  4720
  4721         16  FILLER                      PIC X(09).
  4722         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4723         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4724******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  86
* EL131.cbl
  4725
  4726*                                COPY ELCCNTL.
  4727******************************************************************
  4728*                                                                *
  4729*                                                                *
  4730*                            ELCCNTL.                            *
  4731*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4732*                            VMOD=2.059                          *
  4733*                                                                *
  4734*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4735*                                                                *
  4736*   FILE TYPE = VSAM,KSDS                                        *
  4737*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4738*                                                                *
  4739*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4740*       ALTERNATE INDEX = NONE                                   *
  4741*                                                                *
  4742*   LOG = YES                                                    *
  4743*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4744******************************************************************
  4745*                   C H A N G E   L O G
  4746*
  4747* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4748*-----------------------------------------------------------------
  4749*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4750* EFFECTIVE    NUMBER
  4751*-----------------------------------------------------------------
  4752* 082503                   PEMA  ADD BENEFIT GROUP
  4753* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4754* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4755* 092705    2005050300006  PEMA  ADD SPP LEASES
  4756* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4757* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4758* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4759* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4760* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4761* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4762* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4763* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4764* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4765* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4766******************************************************************
  4767*
  4768 01  CONTROL-FILE.
  4769     12  CF-RECORD-ID                       PIC XX.
  4770         88  VALID-CF-ID                        VALUE 'CF'.
  4771
  4772     12  CF-CONTROL-PRIMARY.
  4773         16  CF-COMPANY-ID                  PIC XXX.
  4774         16  CF-RECORD-TYPE                 PIC X.
  4775             88  CF-COMPANY-MASTER              VALUE '1'.
  4776             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4777             88  CF-STATE-MASTER                VALUE '3'.
  4778             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4779             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4780             88  CF-CARRIER-MASTER              VALUE '6'.
  4781             88  CF-MORTALITY-MASTER            VALUE '7'.
  4782             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  87
* EL131.cbl
  4783             88  CF-TERMINAL-MASTER             VALUE '9'.
  4784             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4785             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4786             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4787             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4788             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4789             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4790             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4791             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4792             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4793         16  CF-ACCESS-CD-GENL              PIC X(4).
  4794         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4795             20  CF-PROCESSOR               PIC X(4).
  4796         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4797             20  CF-STATE-CODE              PIC XX.
  4798             20  FILLER                     PIC XX.
  4799         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4800             20  FILLER                     PIC XX.
  4801             20  CF-HI-BEN-IN-REC           PIC XX.
  4802         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4803             20  FILLER                     PIC XXX.
  4804             20  CF-CARRIER-CNTL            PIC X.
  4805         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4806             20  FILLER                     PIC XX.
  4807             20  CF-HI-TYPE-IN-REC          PIC 99.
  4808         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4809             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4810                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4811             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4812             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4813         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4814             20  FILLER                     PIC X.
  4815             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4816         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4817             20  FILLER                     PIC XX.
  4818             20  CF-MORTGAGE-PLAN           PIC XX.
  4819         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4820
  4821     12  CF-LAST-MAINT-DT                   PIC XX.
  4822     12  CF-LAST-MAINT-BY                   PIC X(4).
  4823     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4824
  4825     12  CF-RECORD-BODY                     PIC X(728).
  4826
  4827
  4828****************************************************************
  4829*             COMPANY MASTER RECORD                            *
  4830****************************************************************
  4831
  4832     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4833         16  CF-COMPANY-ADDRESS.
  4834             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4835             20  CF-CL-IN-CARE-OF           PIC X(30).
  4836             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4837             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4838             20  CF-CL-CITY-STATE           PIC X(30).
  4839             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4840             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  88
* EL131.cbl
  4841         16  CF-COMPANY-CD                  PIC X.
  4842         16  CF-COMPANY-PASSWORD            PIC X(8).
  4843         16  CF-SECURITY-OPTION             PIC X.
  4844             88  ALL-SECURITY                   VALUE '1'.
  4845             88  COMPANY-VERIFY                 VALUE '2'.
  4846             88  PROCESSOR-VERIFY               VALUE '3'.
  4847             88  NO-SECURITY                    VALUE '4'.
  4848             88  ALL-BUT-TERM                   VALUE '5'.
  4849         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4850             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4851         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4852             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4853         16  CF-INFORCE-LOCATION            PIC X.
  4854             88  CERTS-ARE-ONLINE               VALUE '1'.
  4855             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4856             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4857         16  CF-LOWER-CASE-LETTERS          PIC X.
  4858         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4859             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4860             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4861             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4862             88  CF-ACCNT-CNTL                  VALUE '3'.
  4863             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4864
  4865         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4866         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4867
  4868         16  CF-LGX-CREDIT-USER             PIC X.
  4869             88  CO-IS-NOT-USER                 VALUE 'N'.
  4870             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4871
  4872         16 CF-CREDIT-CALC-CODES.
  4873             20  CF-CR-REM-TERM-CALC PIC X.
  4874               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4875               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4876               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4877               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4878               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4879               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4880               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4881             20  CF-CR-R78-METHOD           PIC X.
  4882               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4883               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4884
  4885         16  CF-CLAIM-CONTROL-COUNTS.
  4886             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4887                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4888
  4889             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4890                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4891
  4892             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4893                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4894
  4895             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4896                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4897
  4898         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  89
* EL131.cbl
  4899
  4900         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4901             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4902             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4903             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4904             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4905                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4906                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4907             20  CF-CO-PREM-REJECT-SW       PIC X.
  4908                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4909                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4910             20  CF-CO-REF-REJECT-SW        PIC X.
  4911                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4912                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4913
  4914         16  CF-CO-REPORTING-DT             PIC XX.
  4915         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4916         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4917           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4918           88  CF-CO-MONTH-END                  VALUE '1'.
  4919
  4920         16  CF-LGX-CLAIM-USER              PIC X.
  4921             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4922             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4923
  4924         16  CF-CREDIT-EDIT-CONTROLS.
  4925             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4926             20  CF-MIN-AGE                 PIC 99.
  4927             20  CF-DEFAULT-AGE             PIC 99.
  4928             20  CF-MIN-TERM                PIC S999      COMP-3.
  4929             20  CF-MAX-TERM                PIC S999      COMP-3.
  4930             20  CF-DEFAULT-SEX             PIC X.
  4931             20  CF-JOINT-AGE-INPUT         PIC X.
  4932                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4933             20  CF-BIRTH-DATE-INPUT        PIC X.
  4934                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4935             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4936                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4937                 88  CF-ZERO-CARRIER            VALUE '1'.
  4938                 88  CF-ZERO-GROUPING           VALUE '2'.
  4939                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4940             20  CF-EDIT-SW                 PIC X.
  4941                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4942             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4943             20  CF-CR-PR-METHOD            PIC X.
  4944               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4945               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4946             20  FILLER                     PIC X.
  4947
  4948         16  CF-CREDIT-MISC-CONTROLS.
  4949             20  CF-REIN-TABLE-SW           PIC X.
  4950                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4951             20  CF-COMP-TABLE-SW           PIC X.
  4952                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4953             20  CF-EXPERIENCE-RETENTION-AGE
  4954                                            PIC S9        COMP-3.
  4955             20  CF-CONVERSION-DT           PIC XX.
  4956             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  90
* EL131.cbl
  4957             20  CF-RUN-FREQUENCY-SW        PIC X.
  4958                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4959                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4960
  4961             20  CF-CR-CHECK-NO-CONTROL.
  4962                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4963                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4964                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4965                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4966                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4967                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4968
  4969                 24  CF-CR-CHECK-COUNT       REDEFINES
  4970                     CF-CR-CHECK-COUNTER      PIC X(4).
  4971
  4972                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4973                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4974
  4975                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4976                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4977                 24  CF-MAIL-PROCESSING       PIC X.
  4978                     88  MAIL-PROCESSING          VALUE 'Y'.
  4979
  4980         16  CF-MISC-SYSTEM-CONTROL.
  4981             20  CF-SYSTEM-C                 PIC X.
  4982                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4983             20  CF-SYSTEM-D                 PIC X.
  4984                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4985             20  CF-SOC-SEC-NO-SW            PIC X.
  4986                 88  SOC-SEC-NO-USED             VALUE '1'.
  4987             20  CF-MEMBER-NO-SW             PIC X.
  4988                 88  MEMBER-NO-USED              VALUE '1'.
  4989             20  CF-TAX-ID-NUMBER            PIC X(11).
  4990             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4991             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4992                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4993                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4994                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4995                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4996             20  CF-SYSTEM-E                 PIC X.
  4997                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4998
  4999         16  CF-LGX-LIFE-USER               PIC X.
  5000             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5001             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5002
  5003         16  CF-CR-MONTH-END-DT             PIC XX.
  5004
  5005         16  CF-FILE-MAINT-DATES.
  5006             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5007                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5008             20  CF-LAST-BATCH       REDEFINES
  5009                 CF-LAST-BATCH-NO               PIC X(4).
  5010             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5011             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5012             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5013             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5014             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  91
* EL131.cbl
  5015             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5016             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5017             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5018             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5019             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5020
  5021         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5022         16  FILLER                         PIC X.
  5023
  5024         16  CF-ALT-MORT-CODE               PIC X(4).
  5025         16  CF-MEMBER-CAPTION              PIC X(10).
  5026
  5027         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5028             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5029             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5030             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5031             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5032             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5033
  5034         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5035
  5036         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5037         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5038         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5039         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5040
  5041         16  CF-AH-OVERRIDE-L1              PIC X.
  5042         16  CF-AH-OVERRIDE-L2              PIC XX.
  5043         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5044         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5045
  5046         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5047         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5048
  5049         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5050         16  CF-AR-LAST-EL860-DT            PIC XX.
  5051         16  CF-MP-MONTH-END-DT             PIC XX.
  5052
  5053         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5054         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5055             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5056
  5057         16  CF-AR-MONTH-END-DT             PIC XX.
  5058
  5059         16  CF-CRDTCRD-USER                PIC X.
  5060             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5061             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5062
  5063         16  CF-CC-MONTH-END-DT             PIC XX.
  5064
  5065         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5066
  5067         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5068             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5069             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5070             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5071         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5072         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  92
* EL131.cbl
  5073         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5074         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5075             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5076             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5077         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5078         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5079         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5080             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5081         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5082
  5083         16  CF-CL-ZIP-CODE.
  5084             20  CF-CL-ZIP-PRIME.
  5085                 24  CF-CL-ZIP-1ST          PIC X.
  5086                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5087                 24  FILLER                 PIC X(4).
  5088             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5089         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5090             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5091             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5092             20  FILLER                     PIC XXX.
  5093
  5094         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5095         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5096         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5097         16  CF-CO-OPTION-START-DATE        PIC XX.
  5098         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5099           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5100                                                      '3' '4'.
  5101           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5102           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5103           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5104           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5105           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5106           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5107
  5108         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5109
  5110         16  CF-PAYMENT-APPROVAL-LEVELS.
  5111             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5112             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5113             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5114             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5115             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5116             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5117
  5118         16  CF-END-USER-REPORTING-USER     PIC X.
  5119             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5120             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5121
  5122         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5123             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5124             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5125
  5126         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5127
  5128         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5129         16  FILLER                         PIC X.
  5130
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  93
* EL131.cbl
  5131         16  CF-CREDIT-ARCHIVE-CNTL.
  5132             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5133             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5134             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5135
  5136         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5137
  5138         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5139             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5140             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5141
  5142         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5143             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5144             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5145
  5146         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5147
  5148         16  CF-CO-ACH-ID-CODE              PIC  X.
  5149             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5150             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5151             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5152         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5153         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5154         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5155         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5156         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5157         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5158         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5159         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5160         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5161                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5162         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5163                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5164
  5165         16  CF-CO-OVER-SHORT.
  5166             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5167             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5168
  5169*         16  FILLER                         PIC X(102).
  5170         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5171             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5172             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5173
  5174         16  CF-AH-APPROVAL-DAYS.
  5175             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5176             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5177             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5178             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5179
  5180         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5181
  5182         16  CF-APPROV-LEV-5.
  5183             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5184             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5185             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5186
  5187         16  FILLER                         PIC X(68).
  5188****************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  94
* EL131.cbl
  5189*             PROCESSOR/USER RECORD                            *
  5190****************************************************************
  5191
  5192     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5193         16  CF-PROCESSOR-NAME              PIC X(30).
  5194         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5195         16  CF-PROCESSOR-TITLE             PIC X(26).
  5196         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5197                 88  MESSAGE-YES                VALUE 'Y'.
  5198                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5199
  5200*****************************************************
  5201****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5202****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5203****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5204****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5205*****************************************************
  5206
  5207         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5208             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5209             20  CF-APPLICATION-FORCE       PIC X.
  5210             20  CF-INDIVIDUAL-APP.
  5211                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5212                     28  CF-BROWSE-APP      PIC X.
  5213                     28  CF-UPDATE-APP      PIC X.
  5214
  5215         16  CF-CURRENT-TERM-ON             PIC X(4).
  5216         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5217             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5218             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5219             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5220             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5221             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5222             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5223             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5224         16  CF-PROCESSOR-CARRIER           PIC X.
  5225             88  NO-CARRIER-SECURITY            VALUE ' '.
  5226         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5227             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5228         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5229             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5230         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5231             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5232
  5233         16  CF-PROC-SYS-ACCESS-SW.
  5234             20  CF-PROC-CREDIT-CLAIMS-SW.
  5235                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5236                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5237                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5238                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5239             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5240                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5241                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5242             20  CF-PROC-LIFE-GNRLDGR-SW.
  5243                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5244                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5245                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5246                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  95
* EL131.cbl
  5247             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5248                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5249                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5250         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5251             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5252             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5253         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5254
  5255         16  CF-APPROVAL-LEVEL                  PIC X.
  5256             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5257             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5258             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5259             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5260             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5261
  5262         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5263
  5264         16  CF-LANGUAGE-TYPE                   PIC X.
  5265             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5266             88  CF-LANG-IS-FR                      VALUE 'F'.
  5267
  5268         16  CF-CSR-IND                         PIC X.
  5269         16  FILLER                             PIC X(239).
  5270
  5271****************************************************************
  5272*             PROCESSOR/REMINDERS RECORD                       *
  5273****************************************************************
  5274
  5275     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5276         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5277             20  CF-START-REMIND-DT         PIC XX.
  5278             20  CF-END-REMIND-DT           PIC XX.
  5279             20  CF-REMINDER-TEXT           PIC X(50).
  5280         16  FILLER                         PIC X(296).
  5281
  5282
  5283****************************************************************
  5284*             STATE MASTER RECORD                              *
  5285****************************************************************
  5286
  5287     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5288         16  CF-STATE-ABBREVIATION          PIC XX.
  5289         16  CF-STATE-NAME                  PIC X(25).
  5290         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5291         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5292             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5293             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5294             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5295             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5296                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5297                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5298             20  CF-ST-PREM-REJECT-SW       PIC X.
  5299                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5300                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5301             20  CF-ST-REF-REJECT-SW        PIC X.
  5302                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5303                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5304         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  96
* EL131.cbl
  5305         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5306         16  CF-ST-REFUND-RULES.
  5307             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5308             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5309             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5310         16  CF-ST-FST-PMT-EXTENSION.
  5311             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5312             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5313                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5314                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5315                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5316                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5317         16  CF-ST-STATE-CALL.
  5318             20  CF-ST-CALL-UNEARNED        PIC X.
  5319             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5320             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5321         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5322             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5323             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5324         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5325         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5326         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5327         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5328         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5329         16  FILLER                         PIC X.
  5330         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5331             20  CF-ST-BENEFIT-CD           PIC XX.
  5332             20  CF-ST-BENEFIT-KIND         PIC X.
  5333                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5334                 88  CF-ST-AH-KIND              VALUE 'A'.
  5335             20  CF-ST-REM-TERM-CALC        PIC X.
  5336                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5337                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5338                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5339                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5340                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5341                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5342                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5343                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5344
  5345             20  CF-ST-REFUND-CALC          PIC X.
  5346                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5347                 88  ST-REFD-BY-R78             VALUE '1'.
  5348                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5349                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5350                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5351                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5352                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5353                 88  ST-REFD-UTAH               VALUE '7'.
  5354                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5355                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5356                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5357
  5358             20  CF-ST-EARNING-CALC         PIC X.
  5359                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5360                 88  ST-EARN-BY-R78             VALUE '1'.
  5361                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5362                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  97
* EL131.cbl
  5363                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5364                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5365                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5366                 88  ST-EARN-MEAN               VALUE '8'.
  5367                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5368
  5369             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5370                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5371                 88  ST-OVRD-BY-R78             VALUE '1'.
  5372                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5373                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5374                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5375                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5376                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5377                 88  ST-OVRD-MEAN               VALUE '8'.
  5378                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5379             20  cf-st-extra-periods        pic 9.
  5380*            20  FILLER                     PIC X.
  5381
  5382         16  CF-ST-COMMISSION-CAPS.
  5383             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5384             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5385             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5386             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5387         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5388                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5389
  5390         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5391
  5392         16  CF-ST-STATUTORY-INTEREST.
  5393             20  CF-ST-STAT-DATE-FROM       PIC X.
  5394                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5395                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5396             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5397             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5398             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5399             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5400             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5401
  5402         16  CF-ST-OVER-SHORT.
  5403             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5404             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5405
  5406         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5407
  5408         16  CF-ST-RT-CALC                  PIC X.
  5409
  5410         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5411         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5412         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5413         16  CF-ST-RF-LR-CALC               PIC X.
  5414         16  CF-ST-RF-LL-CALC               PIC X.
  5415         16  CF-ST-RF-LN-CALC               PIC X.
  5416         16  CF-ST-RF-AH-CALC               PIC X.
  5417         16  CF-ST-RF-CP-CALC               PIC X.
  5418*        16  FILLER                         PIC X(206).
  5419*CIDMOD         16  FILLER                         PIC X(192).
  5420         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  98
* EL131.cbl
  5421             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5422         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5423         16  CF-ST-VFY-2ND-BENE             PIC X.
  5424         16  CF-ST-CAUSAL-STATE             PIC X.
  5425         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5426         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5427         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5428             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5429         16  CF-ST-NET-ONLY-STATE           PIC X.
  5430             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5431         16  FILLER                         PIC X(181).
  5432
  5433****************************************************************
  5434*             BENEFIT MASTER RECORD                            *
  5435****************************************************************
  5436
  5437     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5438         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5439             20  CF-BENEFIT-CODE            PIC XX.
  5440             20  CF-BENEFIT-NUMERIC  REDEFINES
  5441                 CF-BENEFIT-CODE            PIC XX.
  5442             20  CF-BENEFIT-ALPHA           PIC XXX.
  5443             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5444             20  CF-BENEFIT-COMMENT         PIC X(10).
  5445
  5446             20  CF-LF-COVERAGE-TYPE        PIC X.
  5447                 88  CF-REDUCING                VALUE 'R'.
  5448                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5449
  5450             20  CF-SPECIAL-CALC-CD         PIC X.
  5451                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5452                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5453                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5454                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5455                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5456                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5457                 88  CF-FARM-PLAN               VALUE 'F'.
  5458                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5459                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5460                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5461                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5462                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5463                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5464                 88  CF-PRUDENTIAL              VALUE 'P'.
  5465                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5466                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5467                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5468                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5469                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5470                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5471
  5472             20  CF-JOINT-INDICATOR         PIC X.
  5473                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5474
  5475*            20  FILLER                     PIC X(12).
  5476             20  cf-maximum-benefits        pic s999 comp-3.
  5477             20  FILLER                     PIC X(09).
  5478             20  CF-BENEFIT-CATEGORY        PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page  99
* EL131.cbl
  5479             20  CF-LOAN-TYPE               PIC X(8).
  5480
  5481             20  CF-CO-REM-TERM-CALC        PIC X.
  5482                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5483                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5484                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5485                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5486                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5487
  5488             20  CF-CO-EARNINGS-CALC        PIC X.
  5489                 88  CO-EARN-BY-R78             VALUE '1'.
  5490                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5491                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5492                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5493                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5494                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5495                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5496                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5497
  5498             20  CF-CO-REFUND-CALC          PIC X.
  5499                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5500                 88  CO-REFD-BY-R78             VALUE '1'.
  5501                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5502                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5503                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5504                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5505                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5506                 88  CO-REFD-MEAN               VALUE '8'.
  5507                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5508                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5509                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5510
  5511             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5512                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5513                 88  CO-OVRD-BY-R78             VALUE '1'.
  5514                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5515                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5516                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5517                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5518                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5519                 88  CO-OVRD-MEAN               VALUE '8'.
  5520                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5521
  5522             20  CF-CO-BEN-I-G-CD           PIC X.
  5523                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5524                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5525                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5526
  5527         16  FILLER                         PIC X(304).
  5528
  5529
  5530****************************************************************
  5531*             CARRIER MASTER RECORD                            *
  5532****************************************************************
  5533
  5534     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5535         16  CF-ADDRESS-DATA.
  5536             20  CF-MAIL-TO-NAME            PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 100
* EL131.cbl
  5537             20  CF-IN-CARE-OF              PIC X(30).
  5538             20  CF-ADDRESS-LINE-1          PIC X(30).
  5539             20  CF-ADDRESS-LINE-2          PIC X(30).
  5540             20  CF-CITY-STATE              PIC X(30).
  5541             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5542             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5543
  5544         16  CF-CLAIM-NO-CONTROL.
  5545             20  CF-CLAIM-NO-METHOD         PIC X.
  5546                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5547                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5548                 88  CLAIM-NO-SEQ               VALUE '3'.
  5549                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5550             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5551                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5552                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5553                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5554
  5555         16  CF-CHECK-NO-CONTROL.
  5556             20  CF-CHECK-NO-METHOD         PIC X.
  5557                 88  CHECK-NO-MANUAL            VALUE '1'.
  5558                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5559                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5560                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5561             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5562                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5563
  5564         16  CF-DOMICILE-STATE              PIC XX.
  5565
  5566         16  CF-EXPENSE-CONTROLS.
  5567             20  CF-EXPENSE-METHOD          PIC X.
  5568                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5569                 88  DOLLARS-PER-PMT            VALUE '2'.
  5570                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5571                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5572             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5573             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5574
  5575         16  CF-CORRESPONDENCE-CONTROL.
  5576             20  CF-LETTER-RESEND-OPT       PIC X.
  5577                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5578                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5579             20  FILLER                     PIC X(4).
  5580
  5581         16  CF-RESERVE-CONTROLS.
  5582             20  CF-MANUAL-SW               PIC X.
  5583                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5584             20  CF-FUTURE-SW               PIC X.
  5585                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5586             20  CF-PTC-SW                  PIC X.
  5587                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5588             20  CF-IBNR-SW                 PIC X.
  5589                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5590             20  CF-PTC-LF-SW               PIC X.
  5591                 88  CF-LF-PTC-USED             VALUE '1'.
  5592             20  CF-CDT-ACCESS-METHOD       PIC X.
  5593                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5594                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 101
* EL131.cbl
  5595                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5596             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5597
  5598         16  CF-CLAIM-CALC-METHOD           PIC X.
  5599             88  360-PLUS-MONTHS                VALUE '1'.
  5600             88  365-PLUS-MONTHS                VALUE '2'.
  5601             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5602             88  360-DAILY                      VALUE '4'.
  5603             88  365-DAILY                      VALUE '5'.
  5604
  5605         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5606         16  FILLER                         PIC X(11).
  5607
  5608         16  CF-LIMIT-AMOUNTS.
  5609             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5610             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5611             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5612             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5613             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5614             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5615             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5616             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5617             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5618             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5619
  5620         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5621         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5622         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5623
  5624         16  CF-ZIP-CODE.
  5625             20  CF-ZIP-PRIME.
  5626                 24  CF-ZIP-1ST             PIC X.
  5627                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5628                 24  FILLER                 PIC X(4).
  5629             20  CF-ZIP-PLUS4               PIC X(4).
  5630         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5631             20  CF-CAN-POSTAL-1            PIC XXX.
  5632             20  CF-CAN-POSTAL-2            PIC XXX.
  5633             20  FILLER                     PIC XXX.
  5634
  5635         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5636         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5637         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5638
  5639         16  CF-RATING-SWITCH               PIC X.
  5640             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5641             88  CF-NO-RATING                   VALUE 'N'.
  5642
  5643         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5644
  5645         16  CF-CARRIER-OVER-SHORT.
  5646             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5647             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5648
  5649         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5650         16  CF-SECPAY-SWITCH               PIC X.
  5651             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5652             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 102
* EL131.cbl
  5653         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5654         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5655         16  FILLER                         PIC X(444).
  5656*        16  FILLER                         PIC X(452).
  5657
  5658
  5659****************************************************************
  5660*             MORTALITY MASTER RECORD                          *
  5661****************************************************************
  5662
  5663     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5664         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5665                                INDEXED BY CF-MORT-NDX.
  5666             20  CF-MORT-TABLE              PIC X(5).
  5667             20  CF-MORT-TABLE-TYPE         PIC X.
  5668                 88  CF-MORT-JOINT              VALUE 'J'.
  5669                 88  CF-MORT-SINGLE             VALUE 'S'.
  5670                 88  CF-MORT-COMBINED           VALUE 'C'.
  5671                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5672                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5673             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5674             20  CF-MORT-AGE-METHOD         PIC XX.
  5675                 88  CF-AGE-LAST                VALUE 'AL'.
  5676                 88  CF-AGE-NEAR                VALUE 'AN'.
  5677             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5678             20  CF-MORT-ADJUSTMENT-DIRECTION
  5679                                            PIC X.
  5680                 88  CF-MINUS                   VALUE '-'.
  5681                 88  CF-PLUS                    VALUE '+'.
  5682             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5683             20  CF-MORT-JOINT-CODE         PIC X.
  5684                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5685             20  CF-MORT-PC-Q               PIC X.
  5686                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5687             20  CF-MORT-TABLE-CODE         PIC X(4).
  5688             20  CF-MORT-COMMENTS           PIC X(15).
  5689             20  FILLER                     PIC X(14).
  5690
  5691         16  FILLER                         PIC X(251).
  5692
  5693
  5694****************************************************************
  5695*             BUSSINESS TYPE MASTER RECORD                     *
  5696****************************************************************
  5697
  5698     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5699* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5700* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5701* AND RECORD 05 IS TYPES 81-99
  5702         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5703             20  CF-BUSINESS-TITLE          PIC  X(19).
  5704             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5705                                            PIC S9V9(4) COMP-3.
  5706             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5707             20  FILLER                     PIC  X.
  5708         16  FILLER                         PIC  X(248).
  5709
  5710
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 103
* EL131.cbl
  5711****************************************************************
  5712*             TERMINAL MASTER RECORD                           *
  5713****************************************************************
  5714
  5715     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5716
  5717         16  CF-COMPANY-TERMINALS.
  5718             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5719                                  PIC X(4).
  5720         16  FILLER               PIC X(248).
  5721
  5722
  5723****************************************************************
  5724*             LIFE EDIT MASTER RECORD                          *
  5725****************************************************************
  5726
  5727     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5728         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5729             20  CF-LIFE-CODE-IN            PIC XX.
  5730             20  CF-LIFE-CODE-OUT           PIC XX.
  5731         16  FILLER                         PIC X(248).
  5732
  5733
  5734****************************************************************
  5735*             AH EDIT MASTER RECORD                            *
  5736****************************************************************
  5737
  5738     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5739         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5740             20  CF-AH-CODE-IN              PIC XXX.
  5741             20  CF-AH-CODE-OUT             PIC XX.
  5742         16  FILLER                         PIC X(248).
  5743
  5744
  5745****************************************************************
  5746*             CREDIBILITY TABLES                               *
  5747****************************************************************
  5748
  5749     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5750         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5751                             INDEXED BY CF-CRDB-NDX.
  5752             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5753             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5754             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5755         16  FILLER                         PIC  X(332).
  5756
  5757
  5758****************************************************************
  5759*             REPORT CUSTOMIZATION RECORD                      *
  5760****************************************************************
  5761
  5762     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5763         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5764             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5765             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5766             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5767**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5768****       A T-TRANSFER.                                   ****
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 104
* EL131.cbl
  5769             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5770
  5771         16  FILLER                         PIC XX.
  5772
  5773         16  CF-CARRIER-CNTL-OPT.
  5774             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5775                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5776                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5777             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5778                                            PIC X.
  5779         16  CF-GROUP-CNTL-OPT.
  5780             20  CF-GROUP-OPT-SEQ           PIC 9.
  5781                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5782                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5783             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5784                                            PIC X(6).
  5785         16  CF-STATE-CNTL-OPT.
  5786             20  CF-STATE-OPT-SEQ           PIC 9.
  5787                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5788                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5789             20  CF-STATE-SELECT OCCURS 3 TIMES
  5790                                            PIC XX.
  5791         16  CF-ACCOUNT-CNTL-OPT.
  5792             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5793                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5794                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5795             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5796                                            PIC X(10).
  5797         16  CF-BUS-TYP-CNTL-OPT.
  5798             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5799                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5800                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5801             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5802                                            PIC XX.
  5803         16  CF-LF-TYP-CNTL-OPT.
  5804             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5805                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5806                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5807             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5808                                            PIC XX.
  5809         16  CF-AH-TYP-CNTL-OPT.
  5810             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5811                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5812                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5813             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5814                                            PIC XX.
  5815         16  CF-REPTCD1-CNTL-OPT.
  5816             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5817                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5818                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5819             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5820                                            PIC X(10).
  5821         16  CF-REPTCD2-CNTL-OPT.
  5822             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5823                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5824                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5825             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5826                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 105
* EL131.cbl
  5827         16  CF-USER1-CNTL-OPT.
  5828             20  CF-USER1-OPT-SEQ           PIC 9.
  5829                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5830                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5831             20  CF-USER1-SELECT OCCURS 3 TIMES
  5832                                            PIC X(10).
  5833         16  CF-USER2-CNTL-OPT.
  5834             20  CF-USER2-OPT-SEQ           PIC 9.
  5835                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5836                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5837             20  CF-USER2-SELECT OCCURS 3 TIMES
  5838                                            PIC X(10).
  5839         16  CF-USER3-CNTL-OPT.
  5840             20  CF-USER3-OPT-SEQ           PIC 9.
  5841                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5842                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5843             20  CF-USER3-SELECT OCCURS 3 TIMES
  5844                                            PIC X(10).
  5845         16  CF-USER4-CNTL-OPT.
  5846             20  CF-USER4-OPT-SEQ           PIC 9.
  5847                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5848                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5849             20  CF-USER4-SELECT OCCURS 3 TIMES
  5850                                            PIC X(10).
  5851         16  CF-USER5-CNTL-OPT.
  5852             20  CF-USER5-OPT-SEQ           PIC 9.
  5853                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5854                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5855             20  CF-USER5-SELECT OCCURS 3 TIMES
  5856                                            PIC X(10).
  5857         16  CF-REINS-CNTL-OPT.
  5858             20  CF-REINS-OPT-SEQ           PIC 9.
  5859                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5860                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5861             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5862                 24  CF-REINS-PRIME         PIC XXX.
  5863                 24  CF-REINS-SUB           PIC XXX.
  5864
  5865         16  CF-AGENT-CNTL-OPT.
  5866             20  CF-AGENT-OPT-SEQ           PIC 9.
  5867                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5868                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5869             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5870                                            PIC X(10).
  5871
  5872         16  FILLER                         PIC X(43).
  5873
  5874         16  CF-LOSS-RATIO-SELECT.
  5875             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5876             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5877         16  CF-ENTRY-DATE-SELECT.
  5878             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5879             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5880         16  CF-EFFECTIVE-DATE-SELECT.
  5881             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5882             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5883
  5884         16  CF-EXCEPTION-LIST-IND          PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 106
* EL131.cbl
  5885             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5886
  5887         16  FILLER                         PIC X(318).
  5888
  5889****************************************************************
  5890*                  EXCEPTION REPORTING RECORD                  *
  5891****************************************************************
  5892
  5893     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5894         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5895             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5896
  5897         16  CF-COMBINED-LIFE-AH-OPT.
  5898             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5899             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5900             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5901             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5902
  5903         16  CF-LIFE-OPT.
  5904             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5905             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5906             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5907             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5908             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5909             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5910             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5911             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5912             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5913             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5914
  5915         16  CF-AH-OPT.
  5916             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5917             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5918             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5919             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5920             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5921             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5922             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5923             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5924             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5925             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5926
  5927         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5928             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5929             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5930             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5931
  5932         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5933
  5934         16  FILLER                         PIC X(673).
  5935
  5936
  5937****************************************************************
  5938*             MORTGAGE SYSTEM PLAN RECORD                      *
  5939****************************************************************
  5940
  5941     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5942         16  CF-PLAN-TYPE                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 107
* EL131.cbl
  5943             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5944             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5945             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5946         16  CF-PLAN-ABBREV                 PIC XXX.
  5947         16  CF-PLAN-DESCRIPT               PIC X(10).
  5948         16  CF-PLAN-NOTES                  PIC X(20).
  5949         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5950         16  CF-PLAN-UNDERWRITING.
  5951             20  CF-PLAN-TERM-DATA.
  5952                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5953                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5954             20  CF-PLAN-AGE-DATA.
  5955                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5956                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5957                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5958             20  CF-PLAN-BENEFIT-DATA.
  5959                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5960                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5961                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5962                                            PIC S9(7)V99  COMP-3.
  5963         16  CF-PLAN-POLICY-FORMS.
  5964             20  CF-POLICY-FORM             PIC X(12).
  5965             20  CF-MASTER-APPLICATION      PIC X(12).
  5966             20  CF-MASTER-POLICY           PIC X(12).
  5967         16  CF-PLAN-RATING.
  5968             20  CF-RATE-CODE               PIC X(5).
  5969             20  CF-SEX-RATING              PIC X.
  5970                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5971                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5972             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5973             20  CF-SUB-STD-TYPE            PIC X.
  5974                 88  CF-PCT-OF-PREM            VALUE '1'.
  5975                 88  CF-PCT-OF-BENE            VALUE '2'.
  5976         16  CF-PLAN-PREM-TOLERANCES.
  5977             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5978             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5979         16  CF-PLAN-PYMT-TOLERANCES.
  5980             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5981             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5982         16  CF-PLAN-MISC-DATA.
  5983             20  FILLER                     PIC X.
  5984             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5985             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5986         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5987         16  CF-PLAN-IND-GRP                PIC X.
  5988             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5989                                                     '1'.
  5990             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5991                                                     '2'.
  5992         16  CF-MIB-SEARCH-SW               PIC X.
  5993             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5994             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5995             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5996             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5997         16  CF-ALPHA-SEARCH-SW             PIC X.
  5998             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5999             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6000             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 108
* EL131.cbl
  6001             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6002             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6003             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6004             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6005             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6006             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6007             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6008                                                     'A' 'B' 'C'
  6009                                                     'X' 'Y' 'Z'.
  6010         16  CF-EFF-DT-RULE-SW              PIC X.
  6011             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6012             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6013             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6014             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6015             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6016         16  FILLER                         PIC X(4).
  6017         16  CF-HEALTH-QUESTIONS            PIC X.
  6018             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6019         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6020         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6021         16  CF-PLAN-SNGL-JNT               PIC X.
  6022             88  CF-COMBINED-PLAN              VALUE 'C'.
  6023             88  CF-JNT-PLAN                   VALUE 'J'.
  6024             88  CF-SNGL-PLAN                  VALUE 'S'.
  6025         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6026         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6027         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6028         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6029         16  CF-RERATE-CNTL                 PIC  X.
  6030             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6031             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6032             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6033             88  CF-AUTO-RECALC                 VALUE '4'.
  6034         16  CF-BENEFIT-TYPE                PIC  X.
  6035             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6036             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6037         16  CF-POLICY-FEE                  PIC S999V99
  6038                                                    COMP-3.
  6039         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6040         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6041         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6042         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6043         16  FILLER                         PIC  X(32).
  6044         16  CF-TERMINATION-FORM            PIC  X(04).
  6045         16  FILLER                         PIC  X(08).
  6046         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6047                                                       COMP-3.
  6048         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6049         16  CF-ISSUE-LETTER                PIC  X(4).
  6050         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6051         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6052             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6053             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6054         16  CF-MP-REFUND-CALC              PIC X.
  6055             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6056             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6057             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6058             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 109
* EL131.cbl
  6059             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6060             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6061             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6062             88  CF-MP-REFD-MEAN                VALUE '8'.
  6063         16  CF-ALT-RATE-CODE               PIC  X(5).
  6064
  6065
  6066         16  FILLER                         PIC X(498).
  6067****************************************************************
  6068*             MORTGAGE COMPANY MASTER RECORD                   *
  6069****************************************************************
  6070
  6071     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6072         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6073         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6074             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6075             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6076             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6077             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6078             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6079
  6080         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6081         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6082         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6083         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6084         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6085
  6086         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6087             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6088         16  CF-MP-RECON-USE-IND            PIC X(1).
  6089             88  CF-MP-USE-RECON             VALUE 'Y'.
  6090         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6091             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6092         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6093             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6094             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6095         16  FILLER                         PIC X(1).
  6096         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6097             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6098         16  CF-MORTG-MIB-VERSION           PIC X.
  6099             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6100             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6101             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6102         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6103             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6104                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6105             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6106                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6107             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6108                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6109             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6110                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6111             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6112                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6113             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6114                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6115         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6116         16  FILLER                         PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 110
* EL131.cbl
  6117         16  CF-MORTG-DESTINATION-SYMBOL.
  6118             20  CF-MORTG-MIB-COMM          PIC X(5).
  6119             20  CF-MORTG-MIB-TERM          PIC X(5).
  6120         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6121             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6122         16  FILLER                         PIC X(03).
  6123         16  CF-MP-CHECK-NO-CONTROL.
  6124             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6125                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6126                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6127                                                ' ' LOW-VALUES.
  6128                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6129                                               VALUE '3'.
  6130         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6131         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6132         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6133             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6134                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6135             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6136                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6137             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6138                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6139             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6140                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6141             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6142                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6143             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6144                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6145         16  CF-MORTG-BILLING-AREA.
  6146             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6147                                            PIC X.
  6148         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6149         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6150         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6151         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6152             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6153             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6154         16  FILLER                         PIC X.
  6155         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6156             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6157             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6158         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6159         16  FILLER                         PIC X(8).
  6160         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6161         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6162         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6163         16  CF-ACH-COMPANY-ID.
  6164             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6165                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6166                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6167                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6168             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6169         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6170             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6171         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6172             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6173             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6174         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 111
* EL131.cbl
  6175         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6176         16  FILLER                         PIC X(536).
  6177
  6178****************************************************************
  6179*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6180****************************************************************
  6181
  6182     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6183         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6184             20  CF-FEMALE-HEIGHT.
  6185                 24  CF-FEMALE-FT           PIC 99.
  6186                 24  CF-FEMALE-IN           PIC 99.
  6187             20  CF-FEMALE-MIN-WT           PIC 999.
  6188             20  CF-FEMALE-MAX-WT           PIC 999.
  6189         16  FILLER                         PIC X(428).
  6190
  6191     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6192         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6193             20  CF-MALE-HEIGHT.
  6194                 24  CF-MALE-FT             PIC 99.
  6195                 24  CF-MALE-IN             PIC 99.
  6196             20  CF-MALE-MIN-WT             PIC 999.
  6197             20  CF-MALE-MAX-WT             PIC 999.
  6198         16  FILLER                         PIC X(428).
  6199******************************************************************
  6200*             AUTOMATIC ACTIVITY RECORD                          *
  6201******************************************************************
  6202     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6203         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6204             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6205             20  CF-SYS-LETTER-ID           PIC X(04).
  6206             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6207             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6208             20  CF-SYS-RESET-SW            PIC X(01).
  6209             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6210             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6211
  6212         16  FILLER                         PIC X(50).
  6213
  6214         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6215             20  CF-USER-ACTIVE-SW          PIC X(01).
  6216             20  CF-USER-LETTER-ID          PIC X(04).
  6217             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6218             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6219             20  CF-USER-RESET-SW           PIC X(01).
  6220             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6221             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6222             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6223
  6224         16  FILLER                         PIC X(246).
  6225
  6226*                                COPY ELCACTQ.
  6227******************************************************************
  6228*                                                                *
  6229*                            ELCACTQ.                            *
  6230*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6231*                            VMOD=2.004                          *
  6232*                                                                *
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 112
* EL131.cbl
  6233*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6234*                                                                *
  6235*   FILE TYPE = VSAM,KSDS                                        *
  6236*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6237*                                                                *
  6238*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6239*       ALTERNATE INDEX = NONE                                   *
  6240*                                                                *
  6241*   LOG = YES                                                    *
  6242*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6243*                                                                *
  6244*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6245******************************************************************
  6246
  6247 01  ACTIVITY-QUE.
  6248     12  AQ-RECORD-ID                PIC XX.
  6249         88  VALID-AQ-ID                VALUE 'AQ'.
  6250
  6251     12  AQ-CONTROL-PRIMARY.
  6252         16  AQ-COMPANY-CD           PIC X.
  6253         16  AQ-CARRIER              PIC X.
  6254         16  AQ-CLAIM-NO             PIC X(7).
  6255         16  AQ-CERT-NO.
  6256             20  AQ-CERT-PRIME       PIC X(10).
  6257             20  AQ-CERT-SFX         PIC X.
  6258
  6259     12  AQ-PENDING-ACTIVITY-FLAGS.
  6260         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6261         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6262             88  PENDING-PAYMENTS       VALUE '1'.
  6263         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6264             88  PENDING-FULL-PRINT     VALUE '1'.
  6265             88  PENDING-PART-PRINT     VALUE '2'.
  6266         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6267             88  PENDING-LETTERS        VALUE '1'.
  6268         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6269             88  PENDING-RESTORE        VALUE 'C'.
  6270             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6271
  6272     12  FILLER                      PIC X(20).
  6273
  6274     12  AQ-RESEND-DATE              PIC XX.
  6275     12  AQ-FOLLOWUP-DATE            PIC XX.
  6276     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6277     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6278     12  AQ-AUTO-LETTER              PIC X(4).
  6279     12  FILLER                      PIC XX.
  6280     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6281*****************************************************************
  6282
  6283*                                COPY ERCACCT.
  6284******************************************************************
  6285*                                                                *
  6286*                                                                *
  6287*                            ERCACCT                             *
  6288*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6289*                            VMOD=2.031                          *
  6290*                                                                *
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 113
* EL131.cbl
  6291*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6292*                                                                *
  6293*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6294*   VSAM ACCOUNT MASTER FILES.                                   *
  6295*                                                                *
  6296*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6297*                                                                *
  6298*   FILE TYPE = VSAM,KSDS                                        *
  6299*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6300*                                                                *
  6301*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6302*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6303*                                                                *
  6304*   LOG = NO                                                     *
  6305*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6306*                                                                *
  6307*                                                                *
  6308******************************************************************
  6309*                   C H A N G E   L O G
  6310*
  6311* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6312*-----------------------------------------------------------------
  6313*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6314* EFFECTIVE    NUMBER
  6315*-----------------------------------------------------------------
  6316* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6317* 092705    2005050300006  PEMA  ADD SPP LEASES
  6318* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6319* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6320* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6321* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6322* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6323* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6324******************************************************************
  6325
  6326 01  ACCOUNT-MASTER.
  6327     12  AM-RECORD-ID                      PIC XX.
  6328         88  VALID-AM-ID                      VALUE 'AM'.
  6329
  6330     12  AM-CONTROL-PRIMARY.
  6331         16  AM-COMPANY-CD                 PIC X.
  6332         16  AM-MSTR-CNTRL.
  6333             20  AM-CONTROL-A.
  6334                 24  AM-CARRIER            PIC X.
  6335                 24  AM-GROUPING.
  6336                     28 AM-GROUPING-PREFIX PIC XXX.
  6337                     28 AM-GROUPING-PRIME  PIC XXX.
  6338                 24  AM-STATE              PIC XX.
  6339                 24  AM-ACCOUNT.
  6340                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6341                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6342             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6343                                           PIC X(19).
  6344             20  AM-CNTRL-B.
  6345                 24  AM-EXPIRATION-DT      PIC XX.
  6346                 24  FILLER                PIC X(4).
  6347             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6348                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 114
* EL131.cbl
  6349
  6350     12  AM-CONTROL-BY-VAR-GRP.
  6351         16  AM-COMPANY-CD-A1              PIC X.
  6352         16  AM-VG-CARRIER                 PIC X.
  6353         16  AM-VG-GROUPING                PIC X(6).
  6354         16  AM-VG-STATE                   PIC XX.
  6355         16  AM-VG-ACCOUNT                 PIC X(10).
  6356         16  AM-VG-DATE.
  6357             20  AM-VG-EXPIRATION-DT       PIC XX.
  6358             20  FILLER                    PIC X(4).
  6359         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6360                                           PIC 9(11)      COMP-3.
  6361     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6362         16  FILLER                        PIC X(10).
  6363         16  AM-VG-KEY3.
  6364             20  AM-VG3-ACCOUNT            PIC X(10).
  6365             20  AM-VG3-EXP-DT             PIC XX.
  6366         16  FILLER                        PIC X(4).
  6367     12  AM-MAINT-INFORMATION.
  6368         16  AM-LAST-MAINT-DT              PIC XX.
  6369         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6370         16  AM-LAST-MAINT-USER            PIC X(4).
  6371         16  FILLER                        PIC XX.
  6372
  6373     12  AM-EFFECTIVE-DT                   PIC XX.
  6374     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6375
  6376     12  AM-PREV-DATES  COMP-3.
  6377         16  AM-PREV-EXP-DT                PIC 9(11).
  6378         16  AM-PREV-EFF-DT                PIC 9(11).
  6379
  6380     12  AM-REPORT-CODE-1                  PIC X(10).
  6381     12  AM-REPORT-CODE-2                  PIC X(10).
  6382
  6383     12  AM-CITY-CODE                      PIC X(4).
  6384     12  AM-COUNTY-PARISH                  PIC X(6).
  6385
  6386     12  AM-NAME                           PIC X(30).
  6387     12  AM-PERSON                         PIC X(30).
  6388     12  AM-ADDRS                          PIC X(30).
  6389     12  AM-CITY.
  6390         16  AM-ADDR-CITY                  PIC X(28).
  6391         16  AM-ADDR-STATE                 PIC XX.
  6392     12  AM-ZIP.
  6393         16  AM-ZIP-PRIME.
  6394             20  AM-ZIP-PRI-1ST            PIC X.
  6395                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6396             20  FILLER                    PIC X(4).
  6397         16  AM-ZIP-PLUS4                  PIC X(4).
  6398     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6399         16  AM-CAN-POSTAL-1               PIC XXX.
  6400         16  AM-CAN-POSTAL-2               PIC XXX.
  6401         16  FILLER                        PIC XXX.
  6402     12  AM-TEL-NO.
  6403         16  AM-AREA-CODE                  PIC 999.
  6404         16  AM-TEL-PRE                    PIC 999.
  6405         16  AM-TEL-NBR                    PIC 9(4).
  6406     12  AM-TEL-LOC                        PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 115
* EL131.cbl
  6407         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6408         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6409
  6410     12  AM-COMM-STRUCTURE.
  6411         16  AM-DEFN-1.
  6412             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6413                 24  AM-AGT.
  6414                     28  AM-AGT-PREFIX     PIC X(4).
  6415                     28  AM-AGT-PRIME      PIC X(6).
  6416                 24  AM-COM-TYP            PIC X.
  6417                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6418                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6419                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6420                 24  AM-RECALC-LV-INDIC    PIC X.
  6421                 24  AM-RETRO-LV-INDIC     PIC X.
  6422                 24  AM-GL-CODES           PIC X.
  6423                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6424                 24  FILLER                PIC X(01).
  6425         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6426             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6427                 24  FILLER                PIC X(11).
  6428                 24  AM-L-COMA             PIC XXX.
  6429                 24  AM-J-COMA             PIC XXX.
  6430                 24  AM-A-COMA             PIC XXX.
  6431                 24  FILLER                PIC X(6).
  6432
  6433     12  AM-COMM-CHANGE-STATUS             PIC X.
  6434         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6435
  6436     12  AM-CSR-CODE                       PIC X(4).
  6437
  6438     12  AM-BILLING-STATUS                 PIC X.
  6439         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6440         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6441     12  AM-AUTO-REFUND-SW                 PIC X.
  6442         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6443         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6444     12  AM-GPCD                           PIC 99.
  6445     12  AM-IG                             PIC X.
  6446         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6447         88  AM-HAS-GROUP                     VALUE '2'.
  6448     12  AM-STATUS                         PIC X.
  6449         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6450         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6451         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6452         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6453         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6454         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6455         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6456         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  6457         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6458         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6459     12  AM-REMIT-TO                       PIC 99.
  6460     12  AM-ID-NO                          PIC X(11).
  6461
  6462     12  AM-CAL-TABLE                      PIC XX.
  6463     12  AM-LF-DEVIATION                   PIC XXX.
  6464     12  AM-AH-DEVIATION                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 116
* EL131.cbl
  6465     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6466     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6467     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6468     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6469     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6470     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6471
  6472     12  AM-USER-FIELDS.
  6473         16  AM-FLD-1                      PIC XX.
  6474         16  AM-FLD-2                      PIC XX.
  6475         16  AM-FLD-3                      PIC XX.
  6476         16  AM-FLD-4                      PIC XX.
  6477         16  AM-FLD-5                      PIC XX.
  6478
  6479     12  AM-1ST-PROD-DATE.
  6480         16  AM-1ST-PROD-YR                PIC XX.
  6481         16  AM-1ST-PROD-MO                PIC XX.
  6482         16  AM-1ST-PROD-DA                PIC XX.
  6483     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6484     12  AM-CERTS-PURGED-DATE.
  6485         16  AM-PUR-YR                     PIC XX.
  6486         16  AM-PUR-MO                     PIC XX.
  6487         16  AM-PUR-DA                     PIC XX.
  6488     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6489     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6490     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6491     12  AM-INACTIVE-DATE.
  6492         16  AM-INA-MO                     PIC 99.
  6493         16  AM-INA-DA                     PIC 99.
  6494         16  AM-INA-YR                     PIC 99.
  6495     12  AM-AR-HI-CERT-DATE                PIC XX.
  6496
  6497     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6498     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6499
  6500     12  AM-OB-PAYMENT-MODE                PIC X.
  6501         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6502         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6503         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6504         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6505
  6506     12  AM-AH-ONLY-INDICATOR              PIC X.
  6507         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6508         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6509
  6510     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6511
  6512     12  AM-OVER-SHORT.
  6513         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6514         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6515
  6516     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6517     12  AM-DCC-CLP-STATE                  PIC XX.
  6518
  6519     12  AM-RECALC-COMM                    PIC X.
  6520     12  AM-RECALC-REIN                    PIC X.
  6521
  6522     12  AM-REI-TABLE                      PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 117
* EL131.cbl
  6523     12  AM-REI-ET-LF                      PIC X.
  6524     12  AM-REI-ET-AH                      PIC X.
  6525     12  AM-REI-PE-LF                      PIC X.
  6526     12  AM-REI-PE-AH                      PIC X.
  6527     12  AM-REI-PRT-ST                     PIC X.
  6528     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6529     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6530     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6531     12  AM-REI-GROUP-A                    PIC X(6).
  6532     12  AM-REI-MORT                       PIC X(4).
  6533     12  AM-REI-PRT-OW                     PIC X.
  6534     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6535     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6536     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6537     12  AM-REI-GROUP-B                    PIC X(6).
  6538
  6539     12  AM-TRUST-TYPE                     PIC X(2).
  6540
  6541     12  AM-EMPLOYER-STMT-USED             PIC X.
  6542     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6543
  6544     12  AM-STD-AH-TYPE                    PIC XX.
  6545     12  AM-EARN-METHODS.
  6546         16  AM-EARN-METHOD-R              PIC X.
  6547             88 AM-REF-RL-R78                 VALUE 'R'.
  6548             88 AM-REF-RL-PR                  VALUE 'P'.
  6549             88 AM-REF-RL-MEAN                VALUE 'M'.
  6550             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6551         16  AM-EARN-METHOD-L              PIC X.
  6552             88 AM-REF-LL-R78                 VALUE 'R'.
  6553             88 AM-REF-LL-PR                  VALUE 'P'.
  6554             88 AM-REF-LL-MEAN                VALUE 'M'.
  6555             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6556         16  AM-EARN-METHOD-A              PIC X.
  6557             88 AM-REF-AH-R78                 VALUE 'R'.
  6558             88 AM-REF-AH-PR                  VALUE 'P'.
  6559             88 AM-REF-AH-MEAN                VALUE 'M'.
  6560             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6561             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6562             88 AM-REF-AH-NET                 VALUE 'N'.
  6563
  6564     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6565     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6566     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6567
  6568     12  AM-RET-Y-N                        PIC X.
  6569     12  AM-RET-P-E                        PIC X.
  6570     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6571     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6572     12  AM-RET-GRP                        PIC X(6).
  6573     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6574         16  AM-POOL-PRIME                 PIC XXX.
  6575         16  AM-POOL-SUB                   PIC XXX.
  6576     12  AM-RETRO-EARNINGS.
  6577         16  AM-RET-EARN-R                 PIC X.
  6578         16  AM-RET-EARN-L                 PIC X.
  6579         16  AM-RET-EARN-A                 PIC X.
  6580     12  AM-RET-ST-TAX-USE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 118
* EL131.cbl
  6581         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6582         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6583     12  AM-RETRO-BEG-EARNINGS.
  6584         16  AM-RET-BEG-EARN-R             PIC X.
  6585         16  AM-RET-BEG-EARN-L             PIC X.
  6586         16  AM-RET-BEG-EARN-A             PIC X.
  6587     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6588     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6589
  6590     12  AM-USER-SELECT-OPTIONS.
  6591         16  AM-USER-SELECT-1              PIC X(10).
  6592         16  AM-USER-SELECT-2              PIC X(10).
  6593         16  AM-USER-SELECT-3              PIC X(10).
  6594         16  AM-USER-SELECT-4              PIC X(10).
  6595         16  AM-USER-SELECT-5              PIC X(10).
  6596
  6597     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6598
  6599     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6600
  6601     12  AM-RPT045A-SWITCH                 PIC X.
  6602         88  RPT045A-OFF                   VALUE 'N'.
  6603
  6604     12  AM-INSURANCE-LIMITS.
  6605         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6606         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6607
  6608     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6609         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6610
  6611     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6612         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6613         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6614
  6615     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6616
  6617     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6618     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6619     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6620     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6621     12  AM-DCC-UEF-STATE                  PIC XX.
  6622     12  FILLER                            PIC XXX.
  6623     12  AM-REPORT-CODE-3                  PIC X(10).
  6624*    12  FILLER                            PIC X(22).
  6625
  6626     12  AM-RESERVE-DATE.
  6627         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6628         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6629         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6630
  6631     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6632     12  AM-NOTIFICATION-TYPES.
  6633         16  AM-NOTIF-OF-LETTERS           PIC X.
  6634         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6635         16  AM-NOTIF-OF-REPORTS           PIC X.
  6636         16  AM-NOTIF-OF-STATUS            PIC X.
  6637
  6638     12  AM-BENEFIT-TABLE-USAGE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 119
* EL131.cbl
  6639         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6640         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6641         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6642         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6643
  6644     12  AM-BENEFIT-CONTROLS.
  6645         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6646             20  AM-BENEFIT-CODE           PIC XX.
  6647             20  AM-BENEFIT-TYPE           PIC X.
  6648             20  AM-BENEFIT-REVISION       PIC XXX.
  6649             20  AM-BENEFIT-REM-TERM       PIC X.
  6650             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6651             20  FILLER                    PIC XX.
  6652         16  FILLER                        PIC X(80).
  6653
  6654     12  AM-TRANSFER-DATA.
  6655         16  AM-TRANSFERRED-FROM.
  6656             20  AM-TRNFROM-CARRIER        PIC X.
  6657             20  AM-TRNFROM-GROUPING.
  6658                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6659                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6660             20  AM-TRNFROM-STATE          PIC XX.
  6661             20  AM-TRNFROM-ACCOUNT.
  6662                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6663                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6664             20  AM-TRNFROM-DTE            PIC XX.
  6665         16  AM-TRANSFERRED-TO.
  6666             20  AM-TRNTO-CARRIER          PIC X.
  6667             20  AM-TRNTO-GROUPING.
  6668                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6669                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6670             20  AM-TRNTO-STATE            PIC XX.
  6671             20  AM-TRNTO-ACCOUNT.
  6672                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6673                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6674             20  AM-TRNTO-DTE              PIC XX.
  6675         16  FILLER                        PIC X(10).
  6676
  6677     12  AM-SAVED-REMIT-TO                 PIC 99.
  6678
  6679     12  AM-COMM-STRUCTURE-SAVED.
  6680         16  AM-DEFN-1-SAVED.
  6681             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6682                 24  AM-AGT-SV             PIC X(10).
  6683                 24  AM-COM-TYP-SV         PIC X.
  6684                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6685                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6686                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6687                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6688                 24  FILLER                PIC X.
  6689                 24  AM-GL-CODES-SV        PIC X.
  6690                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6691                 24  FILLER                PIC X.
  6692         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6693             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6694                 24  FILLER                PIC X(11).
  6695                 24  AM-L-COMA-SV          PIC XXX.
  6696                 24  AM-J-COMA-SV          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 120
* EL131.cbl
  6697                 24  AM-A-COMA-SV          PIC XXX.
  6698                 24  FILLER                PIC X(6).
  6699
  6700     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6701         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6702            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6703            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6704            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6705
  6706     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6707     12  FILLER                            PIC X(120).
  6708
  6709     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6710         16  AM-CONTROL-NAME               PIC X(30).
  6711         16  AM-EXECUTIVE-ONE.
  6712             20  AM-EXEC1-NAME             PIC X(15).
  6713             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6714                                                          COMP-3.
  6715             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6716                                                          COMP-3.
  6717         16  AM-EXECUTIVE-TWO.
  6718             20  AM-EXEC2-NAME             PIC X(15).
  6719             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6720                                                          COMP-3.
  6721             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6722                                                          COMP-3.
  6723
  6724     12  AM-RETRO-ADDITIONAL-DATA.
  6725         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6726         16  AM-RETRO-PREM-P-E             PIC X.
  6727         16  AM-RETRO-CLMS-P-I             PIC X.
  6728         16  AM-RETRO-RET-BRACKET-LF.
  6729             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6730                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6731                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6732             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6733                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6734                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6735             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6736                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6737                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6738         16  AM-RETRO-RET-BRACKET-AH.
  6739             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6740                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6741                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6742                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6743             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6744                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6745                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6746             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6747                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6748                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6749
  6750     12  AM-COMMENTS.
  6751         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6752
  6753     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6754         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 121
* EL131.cbl
  6755         16  AM-FLI-BILLING-CODE           PIC X.
  6756         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6757         16  AM-FLI-UNITED-IDENT           PIC X.
  6758         16  AM-FLI-INTEREST-LOST-DATA.
  6759             20  AM-FLI-BANK-NO            PIC X(5).
  6760             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6761             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6762             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6763         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6764             20  AM-FLI-AGT                PIC X(9).
  6765             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6766             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6767         16  FILLER                        PIC X(102).
  6768
  6769     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6770         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6771             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6772             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6773             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6774             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6775             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6776         16  FILLER                          PIC X(10).
  6777******************************************************************
  6778
  6779*                                COPY ELCCHKQ.
  6780******************************************************************
  6781*                                                                *
  6782*                                                                *
  6783*                            ELCCHKQ.                            *
  6784*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6785*                            VMOD=2.007                          *
  6786*                                                                *
  6787*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6788*                                                                *
  6789*   FILE TYPE = VSAM,KSDS                                        *
  6790*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6791*                                                                *
  6792*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6793*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6794*                                                                *
  6795*   LOG = YES                                                    *
  6796*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6797******************************************************************
  6798 01  CHECK-QUE.
  6799     12  CQ-RECORD-ID                PIC XX.
  6800         88  VALID-CQ-ID         VALUE 'CQ'.
  6801
  6802     12  CQ-CONTROL-PRIMARY.
  6803         16  CQ-COMPANY-CD           PIC X.
  6804         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6805         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6806
  6807     12  CQ-CONTROL-BY-PAYEE.
  6808         16  CQ-CONTROL-BY-NUMBER.
  6809             20  CQ-COMPANY-CD-A1     PIC X.
  6810             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6811         16  CQ-PAYEE-CARRIER        PIC X.
  6812         16  CQ-PAYEE-GROUPING       PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 122
* EL131.cbl
  6813         16  CQ-PAYEE-STATE          PIC XX.
  6814         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6815         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6816
  6817     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6818         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6819         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6820         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6821         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6822         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6823         16  FILLER                  PIC X(3).
  6824
  6825     12  CQ-ENTRY-TYPE               PIC X.
  6826             88  CHECK-ON-QUE           VALUE 'Q'.
  6827             88  ALIGNMENT-CHECK        VALUE 'A'.
  6828             88  SPOILED-CHECK          VALUE 'S'.
  6829             88  PAYMENT-ABORTED        VALUE 'X'.
  6830
  6831     12  CQ-CLAIM-MAST-CNTL.
  6832         16  CQ-CARRIER              PIC X.
  6833         16  CQ-CLAIM-NO             PIC X(7).
  6834         16  CQ-CERT-NO.
  6835             20  CQ-CERT-PRIME       PIC X(10).
  6836             20  CQ-CERT-SFX         PIC X.
  6837         16  CQ-CLAIM-TYPE           PIC X.
  6838             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6839             88  CQ-AH-CLAIM            VALUE 'A'.
  6840         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6841             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6842             88  CQ-O-B-COVERAGE        VALUE '2'.
  6843             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6844
  6845     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6846     12  CQ-CHECK-NUMBER             PIC X(7).
  6847     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6848     12  CQ-PAYMENT-TYPE             PIC X.
  6849             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6850             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6851             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6852             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6853             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6854             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6855             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6856             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6857     12  CQ-VOID-INDICATOR           PIC X.
  6858             88  CHECK-IS-STOPPED          VALUE 'S'.
  6859             88  CHECK-IS-VOID             VALUE 'V'.
  6860     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6861     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6862     12  CQ-CHECK-BY-USER            PIC X(4).
  6863     12  CQ-PRE-NUMBERING-SW         PIC X.
  6864       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6865       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6866
  6867     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6868     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6869     12  CQ-LEDGER-FLAG              PIC X(01).
  6870     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 123
* EL131.cbl
  6871     12  CQ-LAST-UPDATED-DT          PIC XX.
  6872     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6873     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6874
  6875     12  FILLER                      PIC X(04).
  6876
  6877******************************************************************
  6878
  6879*                                COPY ELCARCH.
  6880******************************************************************
  6881*                                                                *
  6882*                            ELCARCH.                            *
  6883*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6884*                            VMOD=2.007                          *
  6885*                                                                *
  6886*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6887*                                                                *
  6888*   FILE TYPE = VSAM,KSDS                                        *
  6889*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6890*                                                                *
  6891*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6892*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6893*                                                                *
  6894*   LOG = NO                                                     *
  6895*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6896*                                                                *
  6897*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6898******************************************************************
  6899 01  LETTER-ARCHIVE.
  6900     12  LA-RECORD-ID                PIC XX.
  6901         88  VALID-LA-ID                VALUE 'LA'.
  6902
  6903     12  LA-CONTROL-PRIMARY.
  6904         16  LA-COMPANY-CD           PIC X.
  6905         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6906         16  LA-RECORD-TYPE          PIC X.
  6907             88  LA-HEADER-DATA         VALUE '1'.
  6908             88  LA-ADDRESS-DATA        VALUE '2'.
  6909             88  LA-TEXT-DATA           VALUE '3'.
  6910             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6911         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6912
  6913     12  LA-CONTROL-BY-TYPE.
  6914         16  LA-COMPANY-CD-A1        PIC X.
  6915         16  LA-RECORD-TYPE-A1       PIC X.
  6916         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6917         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6918
  6919     12  LA-TEXT-RECORD.
  6920         16  LA-SKIP-CONTROL         PIC XX.
  6921             88  NO-LINES-SKIPPED       VALUE SPACES.
  6922             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6923         16  LA-TEXT-LINE            PIC X(70).
  6924
  6925     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6926         16  FILLER                  PIC XX.
  6927         16  LA-ADDRESS-LINE         PIC X(30).
  6928         16  FILLER                  PIC X(40).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 124
* EL131.cbl
  6929
  6930     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6931         16  FILLER                  PIC XX.
  6932         16  LA-CARRIER              PIC X.
  6933         16  LA-CLAIM-NO             PIC X(7).
  6934         16  LA-CERT-NO.
  6935             20  LA-CERT-PRIME       PIC X(10).
  6936             20  LA-CERT-SFX         PIC X.
  6937         16  LA-NO-OF-COPIES         PIC S9.
  6938         16  LA-RESEND-DATE          PIC XX.
  6939         16  LA-PROCESSOR-CD         PIC X(4).
  6940         16  LA-CREATION-DT          PIC XX.
  6941         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6942         16  LA-RESEND-PRINT-DATE    PIC XX.
  6943         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6944         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6945*
  6946* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6947*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6948*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6949*   I        20  LA-DMD-RES-ST           PIC XX.
  6950*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6951*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6952*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6953*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6954*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6955*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6956*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6957*   I        20  LA-DMD-UND-CODE         PIC XX.
  6958*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6959*   V    16  FILLER                  PIC X(15).
  6960* -----
  6961*
  6962* REINSERTED  CSO  MODS
  6963*
  6964         16  FILLER.
  6965             20  FILLER                  PIC X(29).
  6966             20  LA-CSO-LETTER-STATUS    PIC X.
  6967                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6968                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6969                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6970             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6971             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6972*
  6973
  6974     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6975         16  FILLER                  PIC XX.
  6976         16  LA4-CARRIER             PIC X.
  6977         16  LA4-CLAIM-NO            PIC X(7).
  6978         16  LA4-CERT-NO.
  6979             20  LA4-CERT-PRIME      PIC X(10).
  6980             20  LA4-CERT-SFX        PIC X.
  6981         16  LA4-NO-OF-COPIES        PIC S9.
  6982         16  LA4-RESEND-DATE         PIC XX.
  6983         16  LA4-PROCESSOR-CD        PIC X(4).
  6984         16  LA4-CREATION-DT         PIC XX.
  6985         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6986         16  LA4-RESEND-PRINT-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 125
* EL131.cbl
  6987         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6988         16  LA4-FORM-TYPE           PIC X.
  6989             88  LA4-INITIAL-FORM    VALUE '1'.
  6990             88  LA4-PROGRESS-FORM   VALUE '2'.
  6991         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6992         16  LA4-STATE               PIC X(02).
  6993         16  FILLER                  PIC X(31).
  6994******************************************************************
  6995
  6996*                                COPY ELCBENE.
  6997******************************************************************
  6998*                                                                *
  6999*                            ELCBENE.                            *
  7000*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7001*                            VMOD=2.006                          *
  7002*                                                                *
  7003*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7004*                                                                *
  7005*   FILE TYPE = VSAM,KSDS                                        *
  7006*   RECORD SIZE = 500   RECFORM = FIX                            *
  7007*                                                                *
  7008*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7009*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7010*                                                                *
  7011*   LOG = YES                                                    *
  7012*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7013*                                                                *
  7014*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7015******************************************************************
  7016*                   C H A N G E   L O G
  7017*
  7018* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7019*-----------------------------------------------------------------
  7020*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7021* EFFECTIVE    NUMBER
  7022*-----------------------------------------------------------------
  7023* 013017  CR2016053100001  PEMA  ACH PROCESSING
  7024* 082317  CR2017082100003  PEMA  Add sub type
  7025******************************************************************
  7026
  7027 01  BENEFICIARY-MASTER.
  7028     12  BE-RECORD-ID                PIC XX.
  7029         88  VALID-BE-ID                VALUE 'BE'.
  7030
  7031     12  BE-CONTROL-PRIMARY.
  7032         16  BE-COMPANY-CD           PIC X.
  7033         16  BE-RECORD-TYPE          PIC X.
  7034             88  BENEFICIARY-RECORD  VALUE 'B'.
  7035             88  ADJUSTOR-RECORD     VALUE 'A'.
  7036         16  BE-BENEFICIARY          PIC X(10).
  7037     12  BE-CONTROL-BY-NAME.
  7038         16  BE-COMPANY-CD-A1        PIC X.
  7039         16  BE-RECORD-TYPE-A1       PIC X.
  7040         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7041         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7042
  7043     12  BE-LAST-MAINT-DT            PIC XX.
  7044     12  BE-LAST-MAINT-BY            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 126
* EL131.cbl
  7045     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7046
  7047     12  BE-ADDRESS-DATA.
  7048         16  BE-MAIL-TO-NAME         PIC X(30).
  7049         16  BE-ADDRESS-LINE-1       PIC X(30).
  7050         16  BE-ADDRESS-LINE-2       PIC X(30).
  7051         16  BE-ADDRESS-LINE-3       PIC X(30).
  7052         16  BE-CITY-STATE.
  7053             20  BE-CITY             PIC X(28).
  7054             20  BE-STATE            PIC XX.
  7055         16  BE-ZIP-CODE.
  7056             20  BE-ZIP-PRIME.
  7057                 24  BE-ZIP-1ST      PIC X.
  7058                     88  BE-CANADIAN-POST-CODE
  7059                                         VALUE 'A' THRU 'Z'.
  7060                 24  FILLER          PIC X(4).
  7061             20  BE-ZIP-PLUS4        PIC X(4).
  7062         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7063             20  BE-CAN-POSTAL-1     PIC XXX.
  7064             20  BE-CAN-POSTAL-2     PIC XXX.
  7065             20  FILLER              PIC XXX.
  7066         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7067         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7068
  7069******************************************************************
  7070*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7071*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7072******************************************************************
  7073     12  BE-CARRIER                  PIC X.
  7074
  7075     12  BE-ADDRESS-DATA2.
  7076         16  BE-MAIL-TO-NAME2        PIC X(30).
  7077         16  BE-ADDRESS-LINE-12      PIC X(30).
  7078         16  BE-ADDRESS-LINE-22      PIC X(30).
  7079         16  BE-ADDRESS-LINE-32      PIC X(30).
  7080         16  BE-CITY-STATE2.
  7081             20  BE-CITY2            PIC X(28).
  7082             20  BE-STATE2           PIC XX.
  7083         16  BE-ZIP-CODE2.
  7084             20  BE-ZIP-PRIME2.
  7085                 24  BE-ZIP-1ST2     PIC X.
  7086                     88  BE-CANADIAN-POST-CODE2
  7087                                         VALUE 'A' THRU 'Z'.
  7088                 24  FILLER          PIC X(4).
  7089             20  BE-ZIP-PLUS42       PIC X(4).
  7090         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7091             20  BE-CAN-POSTAL-12    PIC XXX.
  7092             20  BE-CAN-POSTAL-22    PIC XXX.
  7093             20  FILLER              PIC XXX.
  7094         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7095         16  BE-ACH-DATA.
  7096             20  BE-ACH-YES-OR-NO    PIC X.
  7097                 88  BE-ON-ACH       VALUE 'Y'.
  7098                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  7099             20  BE-ACH-ABA-ROUTING-NUMBER
  7100                                     PIC X(15).
  7101             20  BE-ACH-BANK-ACCOUNT-NUMBER
  7102                                     PIC X(20).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 127
* EL131.cbl
  7103             20  BE-ACH-SUB-TYPE     PIC XX.
  7104             20  FILLER              PIC X(23).
  7105         16  BE-BILLING-STMT-DATA.
  7106*            20  BE-BSR              PIC X.
  7107*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  7108*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7109*            20  BE-BSR-FROM         PIC X(30).
  7110*            20  BE-BSR-DEPT         PIC X(30).
  7111             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7112             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7113             20  BE-OUTPUT-TYPE      PIC X.
  7114                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7115                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7116
  7117     12  FILLER                      PIC X(28).
  7118******************************************************************
  7119
  7120*                                COPY ELCDAR.
  7121******************************************************************
  7122*                                                                *
  7123*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7124*   FILE TYPE = VSAM,KSDS                                        *
  7125*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7126*   BASE CLUSTER = DLYACTV                                       *
  7127*   LOG = YES                                                    *
  7128*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7129*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7130*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7131*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7132*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7133*               BY PROGRAM "LGINFCE".                            *
  7134*                                                                *
  7135******************************************************************
  7136 01  DAILY-ACTIVITY-RECORD.
  7137     05  DA-KEY.
  7138         10  DA-COMP-CD          PIC X.
  7139         10  DA-CARRIER          PIC X.
  7140         10  DA-CLAIM-NO         PIC X(7).
  7141         10  DA-CERT-NO.
  7142             15  DA-CERT-PRIME   PIC X(10).
  7143             15  DA-CERT-SFX     PIC X.
  7144     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7145     05  DA-RECORD-TYPE          PIC X.
  7146     05  FILLER                  PIC X(2).
  7147******************************************************************
  7148
  7149*                                COPY ELCALPH.
  7150******************************************************************
  7151*                                                                *
  7152*                            ELCALPH.                            *
  7153*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7154*                            VMOD=2.003                          *
  7155*                                                                *
  7156*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  7157*                                                                *
  7158*   FILE TYPE = VSAM,KSDS                                        *
  7159*   RECORD SIZE = 128  RECFORM = FIXED                           *
  7160*                                                                *
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 128
* EL131.cbl
  7161*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  7162*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  7163*                                                                *
  7164*   LOG = YES                                                    *
  7165*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7166*                                                                *
  7167*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  7168******************************************************************
  7169
  7170 01  ALPHA-INDEX.
  7171     12  AI-RECORD-ID                         PIC XX.
  7172         88  VALID-AI-ID                  VALUE 'AI'.
  7173     12  AI-CONTROL-PRIMARY.
  7174         16  AI-COMPANY-CD                     PIC X.
  7175         16  AI-SOURCE                         PIC X.
  7176             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  7177             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  7178         16  AI-NAME.
  7179             20  AI-LAST-NAME                  PIC X(15).
  7180             20  AI-FIRST-NAME.
  7181                 24  AI-FIRST-INITIAL          PIC X.
  7182                 24  FILLER                    PIC X(11).
  7183             20  AI-MIDDLE-INIT                PIC X.
  7184         16  AI-DATE                           PIC X(8).
  7185         16  AI-TIME                           PIC S9(07) COMP-3.
  7186
  7187     12  AI-CONTROL-BY-ADMIN-KEY.
  7188         16  AI-CM-COMPANY-CD                  PIC X.
  7189         16  AI-CM-SOURCE                      PIC X.
  7190         16  AI-CM-CARRIER                     PIC X.
  7191         16  AI-CM-GROUPING.
  7192             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  7193             20  AI-CM-GROUPING-PRIME          PIC X(3).
  7194         16  AI-CM-STATE                       PIC XX.
  7195         16  AI-CM-PRODUCER.
  7196             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  7197             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  7198         16  AI-CM-CERT-EFF-DT                 PIC XX.
  7199         16  AI-CM-CERTIFICATE-NUMBER.
  7200             20  AI-CM-CERT-PRIME              PIC X(10).
  7201             20  AI-CM-CERT-SFX                PIC X.
  7202         16  AI-CM-DATE                        PIC X(8).
  7203         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  7204         16  FILLER                            PIC X(11).
  7205
  7206     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  7207         AI-CONTROL-BY-ADMIN-KEY.
  7208         16  AI-CL-COMPANY-CD                  PIC X.
  7209         16  AI-CL-SOURCE                      PIC X.
  7210         16  AI-CL-CARRIER                     PIC X.
  7211         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  7212         16  AI-CL-CERTIFICATE-NUMBER.
  7213             20  AI-CL-CERT-PRIME              PIC X(10).
  7214             20  AI-CL-CERT-SFX                PIC X.
  7215         16  AI-CL-DATE                        PIC X(8).
  7216         16  AI-CL-INCURRED-DATE               PIC XX.
  7217         16  AI-CL-CLOSE-DATE                  PIC XX.
  7218         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 129
* EL131.cbl
  7219         16  AI-CREDIT-CARD-NUMBER.
  7220             20  AI-CCN.
  7221                 24  AI-CCN-PREFIX             PIC X(4).
  7222                 24  AI-CCN-PRIME              PIC X(12).
  7223             20  AI-CCN-FILLER                 PIC X(4).
  7224
  7225     12  AI-MAINT-INFO.
  7226         16  AI-LAST-MAINT-BY                  PIC X(4).
  7227         16  AI-LAST-MAINT-DT                  PIC XX.
  7228         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7229
  7230     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  7231
  7232     12  FILLER                                PIC X(15).
  7233
  7234
  7235*                                COPY ERCDMDNT.
  7236******************************************************************
  7237*                                                                *
  7238*                            ERCDMDNT                            *
  7239*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7240*                            VMOD=2.005                          *
  7241*                                                                *
  7242*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7243*                                                                *
  7244*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7245*                                                                *
  7246*        FILE TYPE= VSAM,KSDS                                    *
  7247*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7248*                                                                *
  7249*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7250*                                                                *
  7251*        LOG = YES                                               *
  7252*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7253*                                                                *
  7254******************************************************************
  7255
  7256 01  CERTIFICATE-NOTE.
  7257     12  CN-RECORD-ID                     PIC  XX.
  7258         88  VALID-CN-ID                      VALUE 'CN'.
  7259
  7260     12  CN-CONTROL-PRIMARY.
  7261         16  CN-COMPANY-CD                PIC X.
  7262         16  CN-CERT-KEY.
  7263             20  CN-CARRIER               PIC X.
  7264             20  CN-GROUPING.
  7265                 24  CN-GROUPING-PREFIX   PIC XXX.
  7266                 24  CN-GROUPING-PRIME    PIC XXX.
  7267             20  CN-STATE                 PIC XX.
  7268             20  CN-ACCOUNT.
  7269                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7270                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7271             20  CN-CERT-EFF-DT           PIC XX.
  7272             20  CN-CERT-NO.
  7273                 24  CN-CERT-PRIME        PIC X(10).
  7274                 24  CN-CERT-SFX          PIC X.
  7275
  7276     12  CN-BILLING-START-LINE-NO         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 130
* EL131.cbl
  7277     12  CN-BILLING-END-LINE-NO           PIC 99.
  7278
  7279     12  CN-LINES.
  7280         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7281
  7282     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7283         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7284         16  CN-CSI-GENERAL-DATA-AREA.
  7285             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7286
  7287         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7288             CN-CSI-GENERAL-DATA-AREA.
  7289             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7290             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7291             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7292             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  7293             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7294             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7295             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7296             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7297             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7298             20  FILLER                       PIC XX.
  7299             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7300             20  FILLER                       PIC X(38).
  7301
  7302         16  CN-CSI-PRODUCT-DATA-AREA.
  7303             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7304
  7305         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7306             CN-CSI-PRODUCT-DATA-AREA.
  7307             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7308             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7309             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7310             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7311             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7312             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7313             20  FILLER                   PIC XX.
  7314             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7315             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7316             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7317             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7318             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7319             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7320             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7321             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7322             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7323             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7324             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7325             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7326             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7327             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7328             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7329             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7330             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7331             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7332             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7333             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7334             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 131
* EL131.cbl
  7335             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7336             20  FILLER                   PIC X(25).
  7337
  7338         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7339             CN-CSI-CREDIT-CARD-DATA.
  7340             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7341             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7342             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7343             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7344             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7345             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7346             20  FILLER                   PIC XX.
  7347             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7348             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7349             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7350             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  7351             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7352             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7353             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7354             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7355             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7356             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7357             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7358             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7359             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7360             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7361             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7362             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7363             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7364             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7365             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7366             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7367             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7368             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7369             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7370             20  FILLER                   PIC X(17).
  7371
  7372         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7373             CN-CSI-FAMILY-LEAVE-DATA.
  7374             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7375             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7376             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7377             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7378             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7379             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7380             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7381             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7382             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7383             20  CN-CSI-SL-INT-ON-PROCEEDS
  7384                                          PIC S9(5)V99  COMP-3.
  7385             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7386             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7387             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7388             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7389             20  CN-CSI-SL-POLICY-BENEFITS
  7390                                          PIC S9(5)V99  COMP-3.
  7391             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7392             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 132
* EL131.cbl
  7393             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7394             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7395             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7396             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7397             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7398             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7399             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7400             20  CN-CSI-SL-STATE-NOT      PIC X.
  7401             20  FILLER                   PIC XX.
  7402
  7403         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7404             CN-CSI-SENIOR-LIFE-DATA.
  7405             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7406             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7407             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7408                                          PIC S9(5)V99  COMP-3.
  7409             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7410             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7411             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7412             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7413             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7414             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7415             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7416             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7417             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7418             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7419             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7420             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7421             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7422             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7423             20  CN-CSI-PP-REPAIR         PIC X.
  7424             20  CN-CSI-PP-REPLACE        PIC X.
  7425             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7426             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7427             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7428             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7429             20  FILLER                   PIC X(5).
  7430
  7431         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7432             CN-CSI-PURCH-PROP-DATA.
  7433             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7434             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7435             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7436             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7437             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7438             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7439             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7440             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7441             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7442             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7443             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7444             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7445             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7446             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7447             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7448             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7449             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7450             20  CN-CSI-EW-REPLACE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 133
* EL131.cbl
  7451             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7452             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7453             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7454             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7455             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7456             20  FILLER                   PIC X(4).
  7457
  7458     12  CN-LAST-MAINT-DT                 PIC XX.
  7459     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7460     12  CN-LAST-MAINT-USER               PIC X(4).
  7461     12  FILLER                           PIC X(6).
  7462
  7463******************************************************************
  7464
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 134
* EL131.cbl
  7466 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7467                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  7468                          CONTROL-FILE ACTIVITY-QUE
  7469                          ACCOUNT-MASTER CHECK-QUE
  7470                          LETTER-ARCHIVE BENEFICIARY-MASTER
  7471                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  7472                          CERTIFICATE-NOTE.
  7473 0000-DFHEXIT SECTION.
  7474     MOVE '9#                    $   ' TO DFHEIV0.
  7475     MOVE 'EL131' TO DFHEIV1.
  7476     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7477
  7478     IF EIBCALEN = ZERO
  7479         GO TO 8800-UNAUTHORIZED-ACCESS.
  7480
  7481     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7482     MOVE '5'                    TO DC-OPTION-CODE.
  7483     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7484     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7485     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  7486     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7487
  7488     IF SAVE-DATE-YY GREATER 70
  7489         MOVE 19                 TO SAVE-DATE-CC
  7490      ELSE
  7491         MOVE 20                 TO SAVE-DATE-CC.
  7492
  7493
  7494* EXEC CICS HANDLE CONDITION
  7495*        PGMIDERR (8820-XCTL-ERROR)
  7496*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  7497*        ERROR    (9990-ABEND)
  7498*    END-EXEC.
  7499*    MOVE '"$LI.                 ! " #00007489' TO DFHEIV0
  7500     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  7501     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7502     MOVE X'2220233030303037343839' TO DFHEIV0(25:11)
  7503     CALL 'kxdfhei1' USING DFHEIV0
  7504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7505
  7506
  7507     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7508     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7509     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7510
  7511     INITIALIZE    EDIT-WORK-AREA.
  7512     MOVE '/'                    TO WORK-SLASH.
  7513     MOVE SPACES                 TO ERROR-SWITCHES.
  7514
  7515     MOVE TRAN-ID                TO TRANS-ID.
  7516     MOVE EIBTRMID               TO PI-TERM.
  7517     MOVE MAP-ID                 TO PI-QUAL.
  7518
  7519     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7520
  7521     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7522         MOVE LOW-VALUES         TO EL131AO
  7523         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 135
* EL131.cbl
  7524         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7525         MOVE -1                 TO MAINTL
  7526         GO TO 8110-SEND-DATA.
  7527
  7528     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7529         MOVE LOW-VALUES         TO EL131AO
  7530         MOVE PI-CALLING-PROGRAM TO WS-RETURNED-FROM
  7531         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7532         MOVE 'X'                TO PI-RETURN-CD-1
  7533         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7534         MOVE -1                 TO MAINTL
  7535         IF WS-RETURNED-FROM = XCTL-EL114
  7536             PERFORM 4200-LOAD-CHANGES THRU 4200-EXIT
  7537         END-IF
  7538         GO TO 8100-SEND-MAP.
  7539
  7540     IF EIBAID = DFHCLEAR
  7541         GO TO 8200-RETURN-PRIOR.
  7542
  7543     IF PI-PROCESSOR-ID = 'LGXX'
  7544         NEXT SENTENCE
  7545     ELSE
  7546
  7547* EXEC CICS READQ TS
  7548*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7549*            INTO    (SECURITY-CONTROL)
  7550*            LENGTH  (SC-COMM-LENGTH)
  7551*            ITEM    (SC-ITEM)
  7552*        END-EXEC
  7553*    MOVE '*$II   L              ''   #00007534' TO DFHEIV0
  7554     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7555     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7556     MOVE X'2020233030303037353334' TO DFHEIV0(25:11)
  7557     CALL 'kxdfhei1' USING DFHEIV0,
  7558           PI-SECURITY-TEMP-STORE-ID,
  7559           SECURITY-CONTROL,
  7560           SC-COMM-LENGTH,
  7561           SC-ITEM,
  7562           DFHEIV99,
  7563           DFHEIV99
  7564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7565         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7566         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7567         IF NOT DISPLAY-CAP
  7568             MOVE 'READ'               TO  SM-READ
  7569             PERFORM 9995-SECURITY-VIOLATION
  7570             MOVE ER-0070              TO  EMI-ERROR
  7571             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7572             GO TO 8100-SEND-MAP.
  7573
  7574
  7575* EXEC CICS RECEIVE
  7576*        MAP    ('EL131A')
  7577*        MAPSET ('EL131S')
  7578*    END-EXEC.
  7579     MOVE 'EL131A' TO DFHEIV1
  7580     MOVE 'EL131S' TO DFHEIV2
  7581*    MOVE '8"T                   ''   #00007549' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 136
* EL131.cbl
  7582     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7583     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7584     MOVE X'2020233030303037353439' TO DFHEIV0(25:11)
  7585     CALL 'kxdfhei1' USING DFHEIV0,
  7586           DFHEIV1,
  7587           EL131AI,
  7588           DFHEIV99,
  7589           DFHEIV2,
  7590           DFHEIV99,
  7591           DFHEIV99
  7592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7593
  7594
  7595     IF PFKEYL GREATER THAN ZERO
  7596         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7597
  7598     IF SCREEN-ERROR
  7599         MOVE ER-0004 TO EMI-ERROR
  7600         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7601         MOVE -1 TO MAINTL
  7602         GO TO 8110-SEND-DATA.
  7603
  7604     IF EIBAID = DFHPF3
  7605         GO TO 8500-TRLR-MNT.
  7606
  7607     IF EIBAID = DFHPF4
  7608         GO TO 8600-ADDR-MNT.
  7609
  7610     IF EIBAID = DFHPF5
  7611         GO TO 8700-CERT-MNT.
  7612
  7613     IF PI-COMPANY-ID = 'DMD'
  7614       IF EIBAID = DFHPF6
  7615         GO TO 8750-DMD-CLM-FIX.
  7616
  7617     IF EIBAID = DFHPF7
  7618         GO TO 4000-FORCE-ERRORS.
  7619
  7620     IF EIBAID = DFHPF12
  7621         GO TO 8300-GET-HELP.
  7622
  7623     IF EIBAID = DFHPF15
  7624         GO TO 8725-BENEFICIARY-MNT
  7625     END-IF.
  7626
  7627     IF EIBAID = DFHPF23
  7628         GO TO 8810-PF23-ENTERED.
  7629
  7630     IF EIBAID = DFHPF24
  7631         GO TO 8400-RETURN-MASTER.
  7632
  7633     IF EIBAID NOT = DFHENTER
  7634         MOVE ER-0029            TO EMI-ERROR
  7635         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7636         MOVE -1                 TO MAINTL
  7637         GO TO 8110-SEND-DATA.
  7638
  7639     IF PI-RETURN-CD-1 =  'X'
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 137
* EL131.cbl
  7640         MOVE ER-0311            TO EMI-ERROR
  7641         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7642         MOVE -1                 TO MAINTL
  7643         GO TO 8110-SEND-DATA.
  7644
  7645     IF MAINTI = 'A'
  7646         GO TO 0500-ADD-ALPHA-ONLY.
  7647
  7648     IF MAINTI = 'N'
  7649         GO TO 0600-CHANGE-NAME.
  7650
  7651     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7652
  7653     IF SCREEN-ERROR
  7654         GO TO 8110-SEND-DATA.
  7655
  7656     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7657         MOVE ER-0276            TO EMI-ERROR
  7658         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7659         MOVE -1                 TO MAINTL
  7660         GO TO 8110-SEND-DATA.
  7661
  7662     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7663
  7664     IF SCREEN-ERROR
  7665         GO TO 8110-SEND-DATA.
  7666
  7667     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7668
  7669     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7670
  7671     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7672         GO TO 8110-SEND-DATA.
  7673
  7674     IF EMI-FATAL-CTR GREATER THAN ZERO
  7675         GO TO 8110-SEND-DATA.
  7676
  7677     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7678
  7679     IF WS-OPEN-CLOSE-SW = 'Y'
  7680         IF PI-LETTER-SW = 'Y'
  7681             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7682             MOVE 'T'            TO  CNTL-REC-TYPE
  7683             MOVE SPACES         TO  CNTL-PROC-ID
  7684             MOVE +0             TO  CNTL-SEQ-NO
  7685
  7686* EXEC CICS READ
  7687*                DATASET   (CNTL-FILE-ID)
  7688*                RIDFLD    (CNTL-KEY)
  7689*                SET       (ADDRESS OF CONTROL-FILE)
  7690*            END-EXEC
  7691*    MOVE '&"S        E          (   #00007644' TO DFHEIV0
  7692     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7693     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7694     MOVE X'2020233030303037363434' TO DFHEIV0(25:11)
  7695     CALL 'kxdfhei1' USING DFHEIV0,
  7696           CNTL-FILE-ID,
  7697           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 138
* EL131.cbl
  7698           DFHEIV99,
  7699           CNTL-KEY,
  7700           DFHEIV99,
  7701           DFHEIV99,
  7702           DFHEIV99
  7703     SET ADDRESS OF CONTROL-FILE TO
  7704         DFHEIV20
  7705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7706             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7707
  7708     MOVE ER-0000                TO EMI-ERROR.
  7709     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7710
  7711     MOVE SPACE                  TO MAINTO.
  7712     MOVE -1                     TO MAINTL.
  7713     GO TO 8100-SEND-MAP.
  7714
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 139
* EL131.cbl
  7716 0100-UPDATE-PI.
  7717
  7718     MOVE LOW-VALUES             TO WS-SAVE-BENEFICIARY.
  7719     IF WS-RETURNED-FROM = XCTL-EL114
  7720***sometimes there is crap in positions 7-10 when no code was sele
  7721        IF PI-PROGRAM-WORK-AREA (1:5) > SPACES
  7722          MOVE PI-PROGRAM-WORK-AREA (1:10) TO WS-SAVE-BENEFICIARY
  7723        END-IF
  7724     END-IF.
  7725
  7726     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7727         GO TO 0110-UPDATE-UP.
  7728
  7729     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7730     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7731     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7732     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7733     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7734     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7735     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7736     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7737     GO TO 0120-UPDATE-PI-EXIT.
  7738
  7739 0110-UPDATE-UP.
  7740     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7741     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7742     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7743     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7744     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7745     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7746     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7747     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7748
  7749
  7750* EXEC CICS HANDLE CONDITION
  7751*         QIDERR    (0130-TS-ERROR)
  7752*         ITEMERR   (0130-TS-ERROR)
  7753*    END-EXEC.
  7754*    MOVE '"$N<                  ! # #00007692' TO DFHEIV0
  7755     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7756     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7757     MOVE X'2320233030303037363932' TO DFHEIV0(25:11)
  7758     CALL 'kxdfhei1' USING DFHEIV0
  7759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7760
  7761
  7762     IF WS-RETURNED-FROM = XCTL-EL114
  7763
  7764* EXEC CICS READQ TS
  7765*            QUEUE    (PI-KEY)
  7766*            INTO     (EL131AI)
  7767*            LENGTH   (MAP-LENGTH)
  7768*       END-EXEC
  7769*    MOVE '*$I    L              ''   #00007698' TO DFHEIV0
  7770     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7771     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7772     MOVE X'2020233030303037363938' TO DFHEIV0(25:11)
  7773     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 140
* EL131.cbl
  7774           PI-KEY,
  7775           EL131AI,
  7776           MAP-LENGTH,
  7777           DFHEIV99,
  7778           DFHEIV99,
  7779           DFHEIV99
  7780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7781
  7782        IF WS-SAVE-BENEFICIARY > SPACES
  7783            MOVE WS-SAVE-BENEFICIARY TO BENEI
  7784            MOVE +10            TO BENEL
  7785            MOVE LOW-VALUES TO WS-SAVE-BENEFICIARY
  7786        END-IF
  7787        PERFORM 4100-SAVE-CHANGES THRU 4100-EXIT
  7788     END-IF.
  7789
  7790
  7791* EXEC CICS READQ TS
  7792*         QUEUE    (PI-KEY)
  7793*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7794*         LENGTH   (PI-COMM-LENGTH)
  7795*    END-EXEC.
  7796*    MOVE '*$I    L              ''   #00007712' TO DFHEIV0
  7797     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7798     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7799     MOVE X'2020233030303037373132' TO DFHEIV0(25:11)
  7800     CALL 'kxdfhei1' USING DFHEIV0,
  7801           PI-KEY,
  7802           PROGRAM-INTERFACE-BLOCK,
  7803           PI-COMM-LENGTH,
  7804           DFHEIV99,
  7805           DFHEIV99,
  7806           DFHEIV99
  7807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7808
  7809
  7810
  7811* EXEC CICS DELETEQ TS
  7812*         QUEUE    (PI-KEY)
  7813*    END-EXEC.
  7814*    MOVE '*&                    #   #00007718' TO DFHEIV0
  7815     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7816     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7817     MOVE X'2020233030303037373138' TO DFHEIV0(25:11)
  7818     CALL 'kxdfhei1' USING DFHEIV0,
  7819           PI-KEY,
  7820           DFHEIV99
  7821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7822
  7823
  7824 0120-UPDATE-PI-EXIT.
  7825     EXIT.
  7826
  7827 0130-TS-ERROR.
  7828     MOVE LOW-VALUES             TO EL131AO.
  7829     MOVE ER-0192                TO EMI-ERROR.
  7830
  7831     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 141
* EL131.cbl
  7832
  7833     GO TO 8100-SEND-MAP.
  7834
  7835 0200-TRANS-PF.
  7836     IF EIBAID NOT = DFHENTER
  7837         MOVE 'X'                TO ERROR-SWITCH
  7838         GO TO 0210-EXIT.
  7839
  7840     IF PFKEYI NOT NUMERIC
  7841         MOVE 'X'                TO ERROR-SWITCH
  7842         GO TO 0210-EXIT.
  7843
  7844     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7845
  7846     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7847         MOVE 'X' TO ERROR-SWITCH
  7848         GO TO 0210-EXIT.
  7849
  7850     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7851
  7852 0210-EXIT.
  7853     EXIT.
  7854
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 142
* EL131.cbl
  7856 0500-ADD-ALPHA-ONLY.
  7857******************************************************************
  7858*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7859*    RECORD.                                                     *
  7860******************************************************************
  7861
  7862     IF MLNAMEL = +0 AND
  7863        MFNAMEL = +0 AND
  7864        MMINITL = +0
  7865         MOVE ER-0797                TO  EMI-ERROR
  7866         MOVE -1                     TO  MAINTL
  7867         MOVE AL-UABON               TO  MAINTA
  7868         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7869         GO TO 8110-SEND-DATA.
  7870
  7871     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7872     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7873     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7874     MOVE PI-CERT-NO                 TO  CERT-NO.
  7875
  7876
  7877* EXEC CICS READ
  7878*        DATASET   (CLMS-FILE-ID)
  7879*        RIDFLD    (MSTR-KEY)
  7880*        SET       (ADDRESS OF CLAIM-MASTER)
  7881*    END-EXEC.
  7882*    MOVE '&"S        E          (   #00007774' TO DFHEIV0
  7883     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7884     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7885     MOVE X'2020233030303037373734' TO DFHEIV0(25:11)
  7886     CALL 'kxdfhei1' USING DFHEIV0,
  7887           CLMS-FILE-ID,
  7888           DFHEIV20,
  7889           DFHEIV99,
  7890           MSTR-KEY,
  7891           DFHEIV99,
  7892           DFHEIV99,
  7893           DFHEIV99
  7894     SET ADDRESS OF CLAIM-MASTER TO
  7895         DFHEIV20
  7896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7897
  7898
  7899
  7900* EXEC CICS GETMAIN
  7901*        SET       (ADDRESS OF ALPHA-INDEX)
  7902*        LENGTH    (ALPH-LENGTH)
  7903*        INITIMG   (GETMAIN-SPACE)
  7904*    END-EXEC.
  7905*    MOVE ',"IL                  $   #00007780' TO DFHEIV0
  7906     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7907     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7908     MOVE X'2020233030303037373830' TO DFHEIV0(25:11)
  7909     CALL 'kxdfhei1' USING DFHEIV0,
  7910           DFHEIV20,
  7911           ALPH-LENGTH,
  7912           GETMAIN-SPACE
  7913     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 143
* EL131.cbl
  7914         DFHEIV20
  7915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7916
  7917
  7918     MOVE 'AI'                       TO  AI-RECORD-ID.
  7919     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7920                                         AI-CL-COMPANY-CD.
  7921     MOVE 'C'                        TO  AI-SOURCE
  7922                                         AI-CL-SOURCE.
  7923
  7924     IF MLNAMEL IS GREATER THAN +0
  7925         MOVE MLNAMEI                TO  AI-LAST-NAME
  7926     ELSE
  7927         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7928
  7929     IF MFNAMEL IS GREATER THAN +0
  7930         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7931     ELSE
  7932         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7933
  7934     IF MMINITL IS GREATER THAN +0
  7935         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7936     ELSE
  7937         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7938
  7939     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7940     MOVE '5'                        TO  DC-OPTION-CODE.
  7941     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7942     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7943     IF BUILD-YEAR IS GREATER THAN 50
  7944         MOVE '19'                   TO  WS-ALPHA-YY-1
  7945         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7946         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7947         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7948     ELSE
  7949         MOVE '20'                   TO  WS-ALPHA-YY-1
  7950         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7951         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7952         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7953
  7954     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7955                                         AI-CL-DATE.
  7956
  7957     MOVE EIBTIME                    TO  AI-TIME
  7958                                         AI-CL-TIME.
  7959
  7960     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7961     MOVE 'C'                        TO  AI-CL-SOURCE.
  7962     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7963     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7964     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7965     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7966     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7967
  7968     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7969     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7970     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7971
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 144
* EL131.cbl
  7972
  7973* EXEC CICS WRITE
  7974*        DATASET   (ALPH-FILE-ID)
  7975*        RIDFLD    (AI-CONTROL-PRIMARY)
  7976*        FROM      (ALPHA-INDEX)
  7977*    END-EXEC.
  7978     MOVE LENGTH OF
  7979      ALPHA-INDEX
  7980       TO DFHEIV11
  7981*    MOVE '&$ L                  ''   #00007840' TO DFHEIV0
  7982     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7983     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7984     MOVE X'2020233030303037383430' TO DFHEIV0(25:11)
  7985     CALL 'kxdfhei1' USING DFHEIV0,
  7986           ALPH-FILE-ID,
  7987           ALPHA-INDEX,
  7988           DFHEIV11,
  7989           AI-CONTROL-PRIMARY,
  7990           DFHEIV99,
  7991           DFHEIV99
  7992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7993
  7994
  7995     MOVE LOW-VALUES                 TO  EL131AO.
  7996     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7997     MOVE ER-0000                    TO  EMI-ERROR.
  7998     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7999     MOVE -1                         TO  MAINTL.
  8000     GO TO 8100-SEND-MAP.
  8001
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 145
* EL131.cbl
  8003 0600-CHANGE-NAME.
  8004******************************************************************
  8005*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  8006*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  8007******************************************************************
  8008
  8009     IF MLNAMEL = +0 AND
  8010        MFNAMEL = +0 AND
  8011        MMINITL = +0
  8012         MOVE ER-0276                TO  EMI-ERROR
  8013         MOVE -1                     TO  MAINTL
  8014         MOVE AL-UABON               TO  MAINTA
  8015         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8016         GO TO 8110-SEND-DATA.
  8017
  8018     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  8019     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  8020     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  8021     MOVE PI-CERT-NO                 TO  CERT-NO.
  8022
  8023
  8024* EXEC CICS READ
  8025*        DATASET   (CLMS-FILE-ID)
  8026*        RIDFLD    (MSTR-KEY)
  8027*        SET       (ADDRESS OF CLAIM-MASTER)
  8028*    END-EXEC.
  8029*    MOVE '&"S        E          (   #00007874' TO DFHEIV0
  8030     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8031     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8032     MOVE X'2020233030303037383734' TO DFHEIV0(25:11)
  8033     CALL 'kxdfhei1' USING DFHEIV0,
  8034           CLMS-FILE-ID,
  8035           DFHEIV20,
  8036           DFHEIV99,
  8037           MSTR-KEY,
  8038           DFHEIV99,
  8039           DFHEIV99,
  8040           DFHEIV99
  8041     SET ADDRESS OF CLAIM-MASTER TO
  8042         DFHEIV20
  8043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8044
  8045
  8046
  8047* EXEC CICS GETMAIN
  8048*        SET       (ADDRESS OF ALPHA-INDEX)
  8049*        LENGTH    (ALPH-LENGTH)
  8050*        INITIMG   (GETMAIN-SPACE)
  8051*    END-EXEC.
  8052*    MOVE ',"IL                  $   #00007880' TO DFHEIV0
  8053     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8054     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8055     MOVE X'2020233030303037383830' TO DFHEIV0(25:11)
  8056     CALL 'kxdfhei1' USING DFHEIV0,
  8057           DFHEIV20,
  8058           ALPH-LENGTH,
  8059           GETMAIN-SPACE
  8060     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 146
* EL131.cbl
  8061         DFHEIV20
  8062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8063
  8064
  8065     MOVE 'AI'                       TO  AI-RECORD-ID.
  8066     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  8067                                         AI-CL-COMPANY-CD.
  8068     MOVE 'C'                        TO  AI-SOURCE
  8069                                         AI-CL-SOURCE.
  8070
  8071     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  8072     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  8073     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  8074
  8075     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  8076     MOVE '5'                        TO  DC-OPTION-CODE.
  8077     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8078     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  8079     IF BUILD-YEAR IS GREATER THAN 50
  8080         MOVE '19'                   TO  WS-ALPHA-YY-1
  8081         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8082         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8083         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  8084     ELSE
  8085         MOVE '20'                   TO  WS-ALPHA-YY-1
  8086         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8087         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8088         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  8089
  8090     MOVE WS-ALPHA-DATE              TO  AI-DATE
  8091                                         AI-CL-DATE.
  8092
  8093     MOVE EIBTIME                    TO  AI-TIME
  8094                                         AI-CL-TIME.
  8095
  8096     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  8097     MOVE 'C'                        TO  AI-CL-SOURCE.
  8098     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  8099     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  8100     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  8101     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  8102     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  8103
  8104     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  8105     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  8106     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  8107
  8108     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8109         MOVE 'Y'                TO CL-YESNOSW
  8110     END-IF.
  8111
  8112
  8113* EXEC CICS WRITE
  8114*        DATASET   (ALPH-FILE-ID)
  8115*        RIDFLD    (AI-CONTROL-PRIMARY)
  8116*        FROM      (ALPHA-INDEX)
  8117*    END-EXEC.
  8118     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 147
* EL131.cbl
  8119      ALPHA-INDEX
  8120       TO DFHEIV11
  8121*    MOVE '&$ L                  ''   #00007933' TO DFHEIV0
  8122     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8123     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8124     MOVE X'2020233030303037393333' TO DFHEIV0(25:11)
  8125     CALL 'kxdfhei1' USING DFHEIV0,
  8126           ALPH-FILE-ID,
  8127           ALPHA-INDEX,
  8128           DFHEIV11,
  8129           AI-CONTROL-PRIMARY,
  8130           DFHEIV99,
  8131           DFHEIV99
  8132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8133
  8134
  8135
  8136* EXEC CICS READ
  8137*        DATASET   (CLMS-FILE-ID)
  8138*        RIDFLD    (MSTR-KEY)
  8139*        SET       (ADDRESS OF CLAIM-MASTER)
  8140*        UPDATE
  8141*    END-EXEC.
  8142*    MOVE '&"S        EU         (   #00007939' TO DFHEIV0
  8143     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8144     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8145     MOVE X'2020233030303037393339' TO DFHEIV0(25:11)
  8146     CALL 'kxdfhei1' USING DFHEIV0,
  8147           CLMS-FILE-ID,
  8148           DFHEIV20,
  8149           DFHEIV99,
  8150           MSTR-KEY,
  8151           DFHEIV99,
  8152           DFHEIV99,
  8153           DFHEIV99
  8154     SET ADDRESS OF CLAIM-MASTER TO
  8155         DFHEIV20
  8156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8157
  8158
  8159     if (cl-priority-cd = '8')
  8160        and (pi-processor-id not = 'PEMA'and 'JMS '
  8161             AND 'AMWA' AND 'KMSB')
  8162        MOVE ER-8003             TO EMI-ERROR
  8163        PERFORM 9900-ERROR-FORMAT
  8164                                 THRU 9900-EXIT
  8165        MOVE -1                  TO MAINTL
  8166        GO TO 8110-SEND-DATA
  8167     end-if
  8168
  8169     IF MLNAMEL IS GREATER THAN +0
  8170         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  8171
  8172     IF MFNAMEL IS GREATER THAN +0
  8173         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  8174
  8175     IF MMINITL IS GREATER THAN +0
  8176         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 148
* EL131.cbl
  8177
  8178     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  8179     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
  8180     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  8181     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  8182
  8183     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8184         MOVE 'Y'                TO CL-YESNOSW
  8185     END-IF.
  8186
  8187
  8188* EXEC CICS HANDLE CONDITION
  8189*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  8190*    END-EXEC.
  8191*    MOVE '"$$                   ! $ #00007974' TO DFHEIV0
  8192     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8193     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8194     MOVE X'2420233030303037393734' TO DFHEIV0(25:11)
  8195     CALL 'kxdfhei1' USING DFHEIV0
  8196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8197
  8198
  8199
  8200* EXEC CICS REWRITE
  8201*        DATASET   (CLMS-FILE-ID)
  8202*        FROM      (CLAIM-MASTER)
  8203*    END-EXEC.
  8204     MOVE LENGTH OF
  8205      CLAIM-MASTER
  8206       TO DFHEIV11
  8207*    MOVE '&& L                  %   #00007978' TO DFHEIV0
  8208     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8209     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8210     MOVE X'2020233030303037393738' TO DFHEIV0(25:11)
  8211     CALL 'kxdfhei1' USING DFHEIV0,
  8212           CLMS-FILE-ID,
  8213           CLAIM-MASTER,
  8214           DFHEIV11,
  8215           DFHEIV99
  8216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8217
  8218
  8219 0600-CONTINUE-NAME-UPDATE.
  8220
  8221     MOVE LOW-VALUES                 TO  EL131AO.
  8222     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8223     MOVE ER-0000                    TO  EMI-ERROR.
  8224     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8225     MOVE -1                         TO  MAINTL.
  8226     GO TO 8100-SEND-MAP.
  8227
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 149
* EL131.cbl
  8229 1000-EDIT-SCREEN.
  8230
  8231     MOVE MAINTI                 TO CHECK-MAINT.
  8232
  8233     IF NOT VALID-OPTIONS
  8234         MOVE 'X'                TO ERROR-SWITCH
  8235         MOVE -1                 TO MAINTL
  8236         MOVE AL-UABON           TO MAINTA
  8237         MOVE ER-0023            TO EMI-ERROR
  8238         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8239         GO TO 1010-EXIT.
  8240
  8241     IF NOT MODIFY-CAP
  8242         MOVE 'UPDATE'           TO  SM-READ
  8243         PERFORM 9995-SECURITY-VIOLATION
  8244         MOVE ER-0070               TO  EMI-ERROR
  8245         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8246         GO TO 8100-SEND-MAP.
  8247
  8248     IF DELETE-CLAIM
  8249         MOVE AL-UANON TO MAINTA
  8250         GO TO 1010-EXIT.
  8251
  8252     MOVE AL-UANON               TO MAINTA.
  8253
  8254     IF CCNOI GREATER THAN LOW-VALUES
  8255         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8256
  8257     IF PI-COMPANY-ID = 'CSL'
  8258        CONTINUE
  8259     ELSE
  8260        IF TYPEL > ZERO
  8261           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  8262              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8263                    PI-LIFE-OVERRIDE-L1))
  8264                       OR
  8265              ((PI-COMPANY-ID = 'DCC' OR 'VPP')
  8266              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8267                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
  8268              MOVE AL-UANON      TO TYPEA
  8269              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  8270           ELSE
  8271              MOVE ER-0199       TO EMI-ERROR
  8272              PERFORM 9900-ERROR-FORMAT
  8273                                 THRU 9900-EXIT
  8274              MOVE AL-UABON      TO TYPEA
  8275              MOVE -1            TO TYPEL
  8276              MOVE 'X'           TO ERROR-SWITCH
  8277           END-IF
  8278        ELSE
  8279           MOVE AL-UANOF         TO TYPEA
  8280        END-IF
  8281     END-IF
  8282     IF STATUSI GREATER THAN LOW-VALUES
  8283         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  8284             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  8285             MOVE AL-UANON       TO STATUSA
  8286             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 150
* EL131.cbl
  8287             MOVE 'Y'            TO DLYACTV-SW
  8288         ELSE
  8289             MOVE ER-0333        TO EMI-ERROR
  8290             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8291             MOVE AL-UABON       TO STATUSA
  8292             MOVE -1             TO STATUSL
  8293             MOVE 'X'            TO ERROR-SWITCH
  8294         END-IF
  8295     ELSE
  8296         MOVE SPACE              TO TRLR-SWITCH
  8297         MOVE 'N'                TO DLYACTV-SW
  8298         MOVE AL-UANOF           TO STATUSA.
  8299
  8300     IF PROCI GREATER THAN LOW-VALUES
  8301         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  8302     ELSE
  8303         MOVE AL-UANOF TO PROCA.
  8304
  8305     IF SEXI GREATER THAN LOW-VALUES
  8306         IF SEXI = 'F' OR 'M'
  8307             MOVE AL-UANON       TO SEXA
  8308             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8309           ELSE
  8310             MOVE ER-0219        TO EMI-ERROR
  8311             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8312             MOVE AL-UABON       TO SEXA
  8313             MOVE -1             TO SEXL
  8314             MOVE 'X'            TO ERROR-SWITCH
  8315       ELSE
  8316         MOVE AL-UANOF           TO SEXA.
  8317
  8318     IF BIRTHL = +0
  8319         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8320         MOVE AL-UANOF           TO  BIRTHA
  8321         GO TO 1000-CONTINUE-EDITS.
  8322
  8323     IF BIRTHI = SPACES
  8324         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8325         MOVE 'X'                TO  UPDATE-SWITCH
  8326                                     MSTR-SWITCH
  8327         GO TO 1000-CONTINUE-EDITS.
  8328
  8329     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  8330     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  8331     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  8332     MOVE '4'                    TO  DC-OPTION-CODE.
  8333     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8334     IF DATE-CONVERSION-ERROR
  8335         MOVE ER-0220            TO  EMI-ERROR
  8336         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8337         MOVE AL-UABON           TO  BIRTHA
  8338         MOVE -1                 TO  BIRTHL
  8339         MOVE 'X'                TO  ERROR-SWITCH
  8340         GO TO 1000-CONTINUE-EDITS.
  8341
  8342******************************************************************
  8343**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  8344**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 151
* EL131.cbl
  8345**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  8346******************************************************************
  8347     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  8348         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  8349         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8350         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  8351         MOVE '4'                TO  DC-OPTION-CODE
  8352         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  8353         MOVE +0                 TO  DC-ELAPSED-MONTHS
  8354                                     DC-ELAPSED-DAYS
  8355         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8356         IF DATE-CONVERSION-ERROR
  8357             MOVE ER-0220        TO  EMI-ERROR
  8358             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8359             MOVE AL-UABON       TO  BIRTHA
  8360             MOVE -1             TO  BIRTHL
  8361             MOVE 'X'            TO  ERROR-SWITCH
  8362             GO TO 1000-CONTINUE-EDITS.
  8363
  8364     MOVE AL-UANON               TO  BIRTHA.
  8365     MOVE 'X'                    TO  UPDATE-SWITCH
  8366                                     MSTR-SWITCH.
  8367     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  8368     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  8369     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  8370
  8371 1000-CONTINUE-EDITS.
  8372
  8373     IF SOCIALI GREATER THAN LOW-VALUES
  8374         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  8375         IF WS-SOC-SEC-NO NUMERIC AND
  8376           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  8377             NEXT SENTENCE
  8378         ELSE
  8379            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  8380               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  8381               WS-SSN-DASH2 = '-'
  8382                 NEXT SENTENCE
  8383            ELSE
  8384                 MOVE ER-0887        TO  EMI-ERROR
  8385                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8386                 MOVE AL-UABON       TO  SOCIALA
  8387                 MOVE -1             TO  SOCIALL
  8388                 MOVE 'X'            TO  ERROR-SWITCH
  8389            END-IF
  8390        END-IF
  8391     END-IF.
  8392     if critpl > zeros
  8393        and critpi numeric
  8394        move al-uanon            to critpa
  8395        move 'X'                 to update-switch
  8396     end-if
  8397     IF SOCIALI GREATER THAN LOW-VALUES
  8398         MOVE AL-UANON           TO SOCIALA
  8399         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  8400     ELSE
  8401         MOVE AL-UANOF           TO SOCIALA.
  8402
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 152
* EL131.cbl
  8403     IF OCCI GREATER THAN LOW-VALUES
  8404         MOVE AL-UANON           TO OCCA
  8405         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8406     ELSE
  8407         MOVE AL-UANOF           TO OCCA.
  8408
  8409     IF BENEL NOT GREATER THAN ZERO
  8410            GO TO 1005-CONTINUE-EDITS.
  8411
  8412     IF BENEI = SPACES
  8413        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  8414           MOVE 'N'             TO AUTO-PAY-TO-BENE
  8415           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  8416           IF AUTO-PAY-TO-BENE = 'Y'
  8417               MOVE ER-1773      TO  EMI-ERROR
  8418               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8419               MOVE 'X'          TO ERROR-SWITCH
  8420               MOVE AL-UABON     TO BENEA
  8421               MOVE -1           TO BENEL
  8422           ELSE
  8423               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  8424           END-IF
  8425        ELSE
  8426           PERFORM 1050-EDIT-BENE THRU 1050-EXIT
  8427           IF PAYMENT-PENDING
  8428               MOVE ER-1772      TO  EMI-ERROR
  8429               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8430               MOVE 'X'          TO ERROR-SWITCH
  8431               MOVE AL-UABON     TO BENEA
  8432               MOVE -1           TO BENEL
  8433           END-IF
  8434           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8435        END-IF
  8436        GO TO 1005-CONTINUE-EDITS.
  8437
  8438
  8439* EXEC CICS HANDLE CONDITION
  8440*        NOTFND (1004-BENE-NOT-FOUND)
  8441*    END-EXEC.
  8442*    MOVE '"$I                   ! % #00008202' TO DFHEIV0
  8443     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8444     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8445     MOVE X'2520233030303038323032' TO DFHEIV0(25:11)
  8446     CALL 'kxdfhei1' USING DFHEIV0
  8447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8448
  8449
  8450     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  8451     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  8452     MOVE BENEI                  TO  WS-ELBENE-ID.
  8453
  8454
  8455* EXEC CICS READ
  8456*        DATASET ('ELBENE')
  8457*        RIDFLD  (WS-ELBENE-KEY)
  8458*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  8459*    END-EXEC.
  8460     MOVE 'ELBENE' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 153
* EL131.cbl
  8461*    MOVE '&"S        E          (   #00008210' TO DFHEIV0
  8462     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8463     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8464     MOVE X'2020233030303038323130' TO DFHEIV0(25:11)
  8465     CALL 'kxdfhei1' USING DFHEIV0,
  8466           DFHEIV1,
  8467           DFHEIV20,
  8468           DFHEIV99,
  8469           WS-ELBENE-KEY,
  8470           DFHEIV99,
  8471           DFHEIV99,
  8472           DFHEIV99
  8473     SET ADDRESS OF BENEFICIARY-MASTER TO
  8474         DFHEIV20
  8475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8476
  8477
  8478     MOVE AL-UANON               TO  BENEA.
  8479     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8480
  8481     GO TO 1005-CONTINUE-EDITS.
  8482
  8483 1004-BENE-NOT-FOUND.
  8484     MOVE ER-0565                TO  EMI-ERROR.
  8485
  8486     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8487     MOVE 'X'                    TO ERROR-SWITCH.
  8488     MOVE AL-UABON               TO BENEA.
  8489     MOVE -1                     TO BENEL.
  8490
  8491 1005-CONTINUE-EDITS.
  8492
  8493     IF DIAGI GREATER THAN LOW-VALUES
  8494         MOVE AL-UANON           TO DIAGA
  8495         MOVE 'X'                TO UPDATE-SWITCH
  8496                                    NINETY-TRLR-SWITCH
  8497     ELSE
  8498         MOVE AL-UANOF           TO DIAGA.
  8499
  8500     IF ICD1I GREATER THAN LOW-VALUES
  8501         IF (ICD1I GREATER THAN SPACES) AND
  8502            (ICD1I(4:1) NOT = '.')
  8503             IF ICD1I(4:1) = ' '
  8504                 MOVE '.' TO ICD1I(4:1)
  8505             ELSE
  8506                 IF ICD1I(8:1) = ' '
  8507                     MOVE ICD1I(7:1) TO ICD1I(8:1)
  8508                     MOVE ICD1I(6:1) TO ICD1I(7:1)
  8509                     MOVE ICD1I(5:1) TO ICD1I(6:1)
  8510                     MOVE ICD1I(4:1) TO ICD1I(5:1)
  8511                     MOVE '.'        TO ICD1I(4:1)
  8512                 END-IF
  8513             END-IF
  8514         END-IF
  8515         IF (ICD1I GREATER THAN SPACES) AND
  8516            (ICD1I(1:1) NOT > ' ' OR
  8517             ICD1I(2:1) NOT > ' ' OR
  8518             ICD1I(3:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 154
* EL131.cbl
  8519             ICD1I(4:1) NOT = '.')
  8520              MOVE ER-0992        TO  EMI-ERROR
  8521              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8522              MOVE 'X'            TO ERROR-SWITCH
  8523              MOVE AL-UABON       TO ICD1A
  8524              MOVE -1             TO ICD1L
  8525         ELSE
  8526             MOVE AL-UANON       TO ICD1A
  8527             MOVE 'X'            TO UPDATE-SWITCH
  8528                                    NINETY-TRLR-SWITCH
  8529         END-IF
  8530     ELSE
  8531         MOVE AL-UANOF           TO ICD1A
  8532     END-IF.
  8533
  8534     IF ICD2I GREATER THAN LOW-VALUES
  8535         IF (ICD2I GREATER THAN SPACES) AND
  8536            (ICD2I(4:1) NOT = '.')
  8537             IF ICD2I(4:1) = ' '
  8538                 MOVE '.' TO ICD2I(4:1)
  8539             ELSE
  8540                 IF ICD2I(8:1) = ' '
  8541                     MOVE ICD2I(7:1) TO ICD2I(8:1)
  8542                     MOVE ICD2I(6:1) TO ICD2I(7:1)
  8543                     MOVE ICD2I(5:1) TO ICD2I(6:1)
  8544                     MOVE ICD2I(4:1) TO ICD2I(5:1)
  8545                     MOVE '.'        TO ICD2I(4:1)
  8546                 END-IF
  8547             END-IF
  8548         END-IF
  8549         IF (ICD2I GREATER THAN SPACES) AND
  8550            (ICD2I(1:1) NOT > ' ' OR
  8551             ICD2I(2:1) NOT > ' ' OR
  8552             ICD2I(3:1) NOT > ' ' OR
  8553             ICD2I(4:1) NOT = '.')
  8554              MOVE ER-0992        TO EMI-ERROR
  8555              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8556              MOVE 'X'            TO ERROR-SWITCH
  8557              MOVE AL-UABON       TO ICD2A
  8558              MOVE -1             TO ICD2L
  8559         ELSE
  8560             MOVE AL-UANON       TO ICD2A
  8561             MOVE 'X'            TO UPDATE-SWITCH
  8562                                    NINETY-TRLR-SWITCH
  8563         END-IF
  8564     ELSE
  8565         MOVE AL-UANOF           TO ICD2A
  8566     END-IF.
  8567
  8568*    IF CAUSEI GREATER THAN LOW-VALUES
  8569*        MOVE AL-UANON           TO CAUSEA
  8570*        MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8571*    ELSE
  8572*        MOVE AL-UANOF           TO CAUSEA.
  8573
  8574*    IF ENDL GREATER THAN ZERO
  8575*        MOVE LOW-VALUES         TO HOLD-END
  8576*        IF ENDI = SPACES
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 155
* EL131.cbl
  8577*            MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8578*        ELSE
  8579*            MOVE ENDI           TO DEEDIT-DATE-INPUT
  8580*            EXEC CICS BIF DEEDIT
  8581*                FIELD    (DEEDIT-DATE-INPUT)
  8582*                LENGTH   (DATE-LENGTH)
  8583*            END-EXEC
  8584*            MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8585*            MOVE '4'            TO DC-OPTION-CODE
  8586*            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8587*            IF NOT DATE-CONVERSION-ERROR
  8588*                MOVE DC-BIN-DATE-1      TO HOLD-END
  8589*                MOVE AL-UANON   TO ENDA
  8590*                MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8591*                MOVE DC-GREG-DATE-1-EDIT TO ENDO
  8592*            ELSE
  8593*                MOVE ER-0224    TO EMI-ERROR
  8594*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8595*                MOVE AL-UABON   TO ENDA
  8596*                MOVE -1         TO ENDL
  8597*                MOVE 'X'        TO ERROR-SWITCH
  8598*      ELSE
  8599*          MOVE AL-UANOF         TO ENDA.
  8600
  8601     IF INCL GREATER THAN ZERO
  8602         MOVE LOW-VALUES         TO HOLD-INCUR
  8603         IF INCI = SPACES
  8604             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8605         ELSE
  8606             MOVE INCI           TO DEEDIT-DATE-INPUT
  8607
  8608* EXEC CICS BIF DEEDIT
  8609*                FIELD    (DEEDIT-DATE-INPUT)
  8610*                LENGTH   (DATE-LENGTH)
  8611*            END-EXEC
  8612*    MOVE '@"L                   #   #00008345' TO DFHEIV0
  8613     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8614     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8615     MOVE X'2020233030303038333435' TO DFHEIV0(25:11)
  8616     CALL 'kxdfhei1' USING DFHEIV0,
  8617           DEEDIT-DATE-INPUT,
  8618           DATE-LENGTH
  8619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8620             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8621             MOVE '4'            TO DC-OPTION-CODE
  8622             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8623             IF NOT DATE-CONVERSION-ERROR
  8624                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  8625                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8626                 MOVE AL-UANON           TO INCA
  8627                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  8628             ELSE
  8629                 MOVE ER-0222    TO EMI-ERROR
  8630                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8631                 MOVE AL-UABON   TO INCA
  8632                 MOVE -1         TO INCL
  8633                 MOVE 'X'        TO ERROR-SWITCH
  8634       ELSE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 156
* EL131.cbl
  8635           IF PI-NO-PMTS = ZEROS
  8636               MOVE AL-UANOF     TO INCA.
  8637
  8638     IF REPL GREATER THAN ZERO
  8639         MOVE LOW-VALUES         TO HOLD-REPORTED
  8640         IF REPI = SPACES
  8641             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8642         ELSE
  8643             MOVE REPI           TO DEEDIT-DATE-INPUT
  8644
  8645* EXEC CICS BIF DEEDIT
  8646*                FIELD    (DEEDIT-DATE-INPUT)
  8647*                LENGTH   (DATE-LENGTH)
  8648*            END-EXEC
  8649*    MOVE '@"L                   #   #00008373' TO DFHEIV0
  8650     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8651     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8652     MOVE X'2020233030303038333733' TO DFHEIV0(25:11)
  8653     CALL 'kxdfhei1' USING DFHEIV0,
  8654           DEEDIT-DATE-INPUT,
  8655           DATE-LENGTH
  8656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8657             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8658             MOVE '4'            TO DC-OPTION-CODE
  8659             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8660             IF NOT DATE-CONVERSION-ERROR
  8661                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8662                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8663                 MOVE AL-UANON   TO REPA
  8664                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8665             ELSE
  8666                 MOVE ER-0223    TO EMI-ERROR
  8667                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8668                 MOVE AL-UABON   TO REPA
  8669                 MOVE -1         TO REPL
  8670                 MOVE 'X'        TO ERROR-SWITCH
  8671       ELSE
  8672         MOVE AL-UANOF TO REPA.
  8673
  8674     IF PDTHRUI GREATER THAN LOW-VALUES
  8675        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8676        IF PDTHRUI = SPACES
  8677           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8678        ELSE
  8679           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8680
  8681* EXEC CICS BIF DEEDIT
  8682*               FIELD    (DEEDIT-DATE-INPUT)
  8683*               LENGTH   (DATE-LENGTH)
  8684*          END-EXEC
  8685*    MOVE '@"L                   #   #00008400' TO DFHEIV0
  8686     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8687     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8688     MOVE X'2020233030303038343030' TO DFHEIV0(25:11)
  8689     CALL 'kxdfhei1' USING DFHEIV0,
  8690           DEEDIT-DATE-INPUT,
  8691           DATE-LENGTH
  8692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 157
* EL131.cbl
  8693           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8694           MOVE '4'            TO DC-OPTION-CODE
  8695           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8696           IF NOT DATE-CONVERSION-ERROR
  8697              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8698              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8699              MOVE AL-UANON   TO PDTHRUA
  8700              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8701              IF PI-USES-PAID-TO
  8702                 MOVE '6'            TO DC-OPTION-CODE
  8703                 MOVE -1             TO DC-ELAPSED-DAYS
  8704                 MOVE +0             TO DC-ELAPSED-MONTHS
  8705                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8706                 IF NO-CONVERSION-ERROR
  8707                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8708                 ELSE
  8709                    NEXT SENTENCE
  8710              ELSE
  8711                 NEXT SENTENCE
  8712           ELSE
  8713              MOVE ER-0475    TO EMI-ERROR
  8714              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8715              MOVE AL-UABON   TO PDTHRUA
  8716              MOVE -1         TO PDTHRUL
  8717              MOVE 'X'        TO ERROR-SWITCH
  8718     ELSE
  8719        IF MODIFY-CAP
  8720           MOVE AL-UANOF        TO PDTHRUA.
  8721
  8722     IF PDAMTL GREATER THAN +0
  8723         MOVE ZEROS              TO HOLD-PDAMT
  8724
  8725* EXEC CICS BIF DEEDIT
  8726*            FIELD    (PDAMTI)
  8727*            LENGTH   (9)
  8728*        END-EXEC
  8729     MOVE 9
  8730       TO DFHEIV11
  8731*    MOVE '@"L                   #   #00008435' TO DFHEIV0
  8732     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8733     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8734     MOVE X'2020233030303038343335' TO DFHEIV0(25:11)
  8735     CALL 'kxdfhei1' USING DFHEIV0,
  8736           PDAMTI,
  8737           DFHEIV11
  8738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8739         IF PDAMTI NUMERIC
  8740             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8741             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8742             MOVE AL-UNNON       TO PDAMTA
  8743         ELSE
  8744             MOVE ER-0547        TO EMI-ERROR
  8745             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8746             MOVE AL-UNBON       TO PDAMTA
  8747             MOVE -1             TO PDAMTL
  8748             MOVE 'X'            TO ERROR-SWITCH
  8749     ELSE
  8750         IF MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 158
* EL131.cbl
  8751            MOVE AL-UNNOF        TO PDAMTA.
  8752
  8753     IF NODAYSI GREATER THAN LOW-VALUES
  8754         MOVE ZEROS              TO HOLD-NODAYS
  8755
  8756* EXEC CICS BIF DEEDIT
  8757*            FIELD (NODAYSI)
  8758*            LENGTH (5)
  8759*        END-EXEC
  8760     MOVE 5
  8761       TO DFHEIV11
  8762*    MOVE '@"L                   #   #00008455' TO DFHEIV0
  8763     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8764     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8765     MOVE X'2020233030303038343535' TO DFHEIV0(25:11)
  8766     CALL 'kxdfhei1' USING DFHEIV0,
  8767           NODAYSI,
  8768           DFHEIV11
  8769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8770         IF NODAYSI NUMERIC
  8771             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8772             MOVE AL-UNNON       TO NODAYSA
  8773             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8774         ELSE
  8775             MOVE ER-0491        TO EMI-ERROR
  8776             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8777             MOVE AL-UNBON       TO NODAYSA
  8778             MOVE -1             TO NODAYSL
  8779             MOVE 'X'            TO ERROR-SWITCH
  8780     ELSE
  8781         IF MODIFY-CAP
  8782            MOVE AL-UNNOF        TO NODAYSA.
  8783
  8784     IF NOPMTSI GREATER THAN LOW-VALUES
  8785         MOVE ZEROS              TO HOLD-NOPMTS
  8786
  8787* EXEC CICS BIF DEEDIT
  8788*            FIELD (NOPMTSI)
  8789*            LENGTH (4)
  8790*        END-EXEC
  8791     MOVE 4
  8792       TO DFHEIV11
  8793*    MOVE '@"L                   #   #00008475' TO DFHEIV0
  8794     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8795     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8796     MOVE X'2020233030303038343735' TO DFHEIV0(25:11)
  8797     CALL 'kxdfhei1' USING DFHEIV0,
  8798           NOPMTSI,
  8799           DFHEIV11
  8800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8801         IF NOPMTSI NUMERIC
  8802             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8803             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8804             MOVE AL-UNNON       TO NOPMTSA
  8805           ELSE
  8806             MOVE ER-0548        TO EMI-ERROR
  8807             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8808             MOVE AL-UNBON       TO NOPMTSA
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 159
* EL131.cbl
  8809             MOVE -1             TO NOPMTSL
  8810             MOVE 'X'            TO ERROR-SWITCH
  8811       ELSE
  8812         IF MODIFY-CAP
  8813            MOVE AL-UNNOF        TO NOPMTSA.
  8814
  8815     IF FORMTYPI GREATER THAN LOW-VALUES
  8816         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8817             MOVE AL-UANON       TO FORMTYPA
  8818             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8819           ELSE
  8820             MOVE ER-7650        TO EMI-ERROR
  8821             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8822             MOVE AL-UABON       TO FORMTYPA
  8823             MOVE -1             TO FORMTYPL
  8824             MOVE 'X'            TO ERROR-SWITCH
  8825       ELSE
  8826         MOVE AL-UANOF           TO FORMTYPA.
  8827
  8828     IF PRICDL GREATER THAN ZERO
  8829         IF (PRICDI = ' ') OR
  8830            (PRICDI GREATER THAN ZERO   AND
  8831             PRICDI NOT GREATER THAN '9')
  8832             MOVE AL-UANON       TO PRICDA
  8833             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8834         ELSE
  8835             MOVE ER-0274        TO EMI-ERROR
  8836             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8837             MOVE AL-UABON       TO PRICDA
  8838             MOVE -1             TO PRICDL
  8839             MOVE 'X'            TO ERROR-SWITCH
  8840     ELSE
  8841         MOVE AL-UANOF TO PRICDA.
  8842
  8843     IF PI-COMPANY-ID = 'DMD'
  8844     IF PRICDL GREATER THAN ZERO
  8845       IF SYSTEM-MODIFY-CAP  OR
  8846          PI-PROCESSOR-ID = 'LGXX'
  8847             NEXT SENTENCE
  8848           ELSE
  8849            IF CL-PRIORITY-CD = '9'  OR
  8850               PRICDI         = '9'
  8851                  MOVE ER-0938        TO EMI-ERROR
  8852                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8853                  MOVE AL-UABON       TO PRICDA
  8854                  MOVE -1             TO PRICDL
  8855                  MOVE 'X'            TO ERROR-SWITCH.
  8856
  8857     IF FILETOL GREATER THAN ZERO
  8858         MOVE AL-UANON           TO FILETOA
  8859         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8860     ELSE
  8861         MOVE AL-UANOF TO FILETOA.
  8862
  8863     IF SUPVL GREATER THAN ZERO
  8864         IF SUPVI = 'Y' OR 'N' OR SPACE
  8865             MOVE AL-UANON       TO SUPVA
  8866             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 160
* EL131.cbl
  8867         ELSE
  8868             MOVE ER-0230        TO EMI-ERROR
  8869             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8870             MOVE AL-UABON       TO SUPVA
  8871             MOVE -1             TO SUPVL
  8872             MOVE 'X'            TO ERROR-SWITCH
  8873     ELSE
  8874         MOVE AL-UANOF           TO SUPVA.
  8875
  8876     IF MLNAMEL GREATER THAN ZERO
  8877         IF MLNAMEI GREATER THAN SPACES
  8878            MOVE AL-UANON        TO MLNAMEA
  8879            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
  8880                                     MSTR-KEY-SWITCH
  8881         ELSE
  8882            MOVE ER-0236         TO EMI-ERROR
  8883            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8884            MOVE AL-UABON        TO MLNAMEA
  8885            MOVE -1              TO MLNAMEL
  8886            MOVE 'X'             TO ERROR-SWITCH
  8887     ELSE
  8888         MOVE AL-UANOF           TO MLNAMEA.
  8889
  8890     IF MFNAMEI GREATER THAN LOW-VALUES
  8891         MOVE AL-UANON           TO MFNAMEA
  8892         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8893     ELSE
  8894         MOVE AL-UANOF           TO MFNAMEA.
  8895
  8896     IF MMINITI GREATER THAN LOW-VALUES
  8897         MOVE AL-UANON           TO MMINITA
  8898         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8899     ELSE
  8900         MOVE AL-UANOF           TO MMINITA.
  8901
  8902     IF CRTLNMEI GREATER THAN LOW-VALUES
  8903         IF CRTLNMEI NOT = SPACES
  8904            MOVE AL-UANON        TO CRTLNMEA
  8905            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8906                                     CERT-KEY-SWITCH
  8907        ELSE
  8908            MOVE ER-0236         TO EMI-ERROR
  8909            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8910            MOVE AL-UABON        TO CRTLNMEA
  8911            MOVE -1              TO CRTLNMEL
  8912            MOVE 'X'             TO ERROR-SWITCH
  8913     ELSE
  8914         MOVE AL-UANOF           TO CRTLNMEA.
  8915
  8916     IF CRTFNMEI GREATER THAN LOW-VALUES
  8917         MOVE AL-UANON           TO CRTFNMEA
  8918         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8919     ELSE
  8920         MOVE AL-UANOF           TO CRTFNMEA.
  8921
  8922     IF CRTINITI GREATER THAN LOW-VALUES
  8923         MOVE AL-UANON           TO CRTINITA
  8924         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 161
* EL131.cbl
  8925     ELSE
  8926         MOVE AL-UANOF           TO CRTINITA.
  8927
  8928     IF ISSAGEL GREATER THAN ZERO
  8929         IF ISSAGEI NUMERIC
  8930            MOVE AL-UANON        TO ISSAGEA
  8931            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8932         ELSE
  8933            MOVE ER-0237         TO EMI-ERROR
  8934            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8935            MOVE AL-UABON        TO ISSAGEA
  8936            MOVE -1              TO ISSAGEL
  8937            MOVE 'X'             TO ERROR-SWITCH
  8938     ELSE
  8939         MOVE AL-UANOF           TO ISSAGEA.
  8940
  8941     IF JNTFNMEI GREATER THAN LOW-VALUES
  8942         MOVE AL-UANON           TO JNTFNMEA
  8943         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8944     ELSE
  8945         MOVE AL-UANOF           TO JNTFNMEA.
  8946
  8947     IF JNTLNMEI GREATER THAN LOW-VALUES
  8948         MOVE AL-UANON           TO JNTLNMEA
  8949         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8950     ELSE
  8951         MOVE AL-UANOF           TO JNTLNMEA.
  8952
  8953     IF JNTINITI GREATER THAN LOW-VALUES
  8954         MOVE AL-UANON           TO JNTINITA
  8955         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8956     ELSE
  8957         MOVE AL-UANOF           TO JNTINITA.
  8958
  8959     IF JNTAGEL GREATER THAN ZERO
  8960         IF JNTAGEI NUMERIC
  8961            MOVE AL-UANON        TO JNTAGEA
  8962            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8963         ELSE
  8964            MOVE ER-0238         TO EMI-ERROR
  8965            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8966            MOVE AL-UABON        TO JNTAGEA
  8967            MOVE -1              TO JNTAGEL
  8968            MOVE 'X'             TO ERROR-SWITCH
  8969     ELSE
  8970         MOVE AL-UANOF           TO JNTAGEA.
  8971
  8972     IF ADDONDTI GREATER THAN LOW-VALUES
  8973         MOVE LOW-VALUES         TO HOLD-ADDON
  8974         IF ADDONDTI = SPACES
  8975             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  8976         ELSE
  8977             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  8978
  8979* EXEC CICS BIF DEEDIT
  8980*                FIELD    (DEEDIT-DATE-INPUT)
  8981*                LENGTH   (DATE-LENGTH)
  8982*            END-EXEC
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 162
* EL131.cbl
  8983*    MOVE '@"L                   #   #00008656' TO DFHEIV0
  8984     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8985     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8986     MOVE X'2020233030303038363536' TO DFHEIV0(25:11)
  8987     CALL 'kxdfhei1' USING DFHEIV0,
  8988           DEEDIT-DATE-INPUT,
  8989           DATE-LENGTH
  8990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8991             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8992             MOVE '4'            TO DC-OPTION-CODE
  8993             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8994             IF NOT DATE-CONVERSION-ERROR
  8995                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
  8996                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8997                                                  CERT-SWITCH
  8998                 MOVE AL-UANON   TO ADDONDTA
  8999                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  9000             ELSE
  9001                 MOVE ER-7651    TO EMI-ERROR
  9002                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9003                 MOVE AL-UABON   TO ADDONDTA
  9004                 MOVE -1         TO ADDONDTL
  9005                 MOVE 'X'        TO ERROR-SWITCH
  9006       ELSE
  9007         MOVE AL-UANOF TO ADDONDTA.
  9008
  9009     IF LCVCDI GREATER THAN LOW-VALUES
  9010         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  9011         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  9012     ELSE
  9013         MOVE AL-UANOF           TO LCVCDA.
  9014
  9015     IF ACVCDI GREATER THAN LOW-VALUES
  9016         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  9017         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  9018     ELSE
  9019         MOVE AL-UANOF           TO ACVCDA.
  9020
  9021     IF LCVOTRMI GREATER THAN LOW-VALUES
  9022
  9023* EXEC CICS BIF DEEDIT
  9024*            FIELD (LCVOTRMI)
  9025*            LENGTH(3)
  9026*        END-EXEC
  9027     MOVE 3
  9028       TO DFHEIV11
  9029*    MOVE '@"L                   #   #00008691' TO DFHEIV0
  9030     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9031     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9032     MOVE X'2020233030303038363931' TO DFHEIV0(25:11)
  9033     CALL 'kxdfhei1' USING DFHEIV0,
  9034           LCVOTRMI,
  9035           DFHEIV11
  9036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9037         IF LCVOTRMI IS NUMERIC
  9038             MOVE LCVOTRMI       TO LCVOTRMO
  9039             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9040             MOVE AL-UANON       TO LCVOTRMA
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 163
* EL131.cbl
  9041         ELSE
  9042             MOVE ER-0241        TO EMI-ERROR
  9043             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9044             MOVE AL-UNBON       TO LCVOTRMA
  9045             MOVE 'X'            TO ERROR-SWITCH
  9046             MOVE -1             TO LCVOTRML
  9047     ELSE
  9048         MOVE AL-UANOF           TO LCVOTRMA.
  9049
  9050     IF ACVOTRMI GREATER THAN LOW-VALUES
  9051
  9052* EXEC CICS BIF DEEDIT
  9053*            FIELD (ACVOTRMI)
  9054*            LENGTH(3)
  9055*        END-EXEC
  9056     MOVE 3
  9057       TO DFHEIV11
  9058*    MOVE '@"L                   #   #00008709' TO DFHEIV0
  9059     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9060     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9061     MOVE X'2020233030303038373039' TO DFHEIV0(25:11)
  9062     CALL 'kxdfhei1' USING DFHEIV0,
  9063           ACVOTRMI,
  9064           DFHEIV11
  9065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9066         IF ACVOTRMI IS NUMERIC
  9067             MOVE ACVOTRMI       TO ACVOTRMO
  9068             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9069             MOVE AL-UANON       TO ACVOTRMA
  9070         ELSE
  9071             MOVE ER-0241        TO EMI-ERROR
  9072             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9073             MOVE AL-UNBON       TO ACVOTRMA
  9074             MOVE 'X'            TO ERROR-SWITCH
  9075             MOVE -1             TO ACVOTRML
  9076     ELSE
  9077         MOVE AL-UANOF           TO ACVOTRMA.
  9078
  9079     IF LCVRATEL GREATER THAN +0
  9080
  9081* EXEC CICS BIF DEEDIT
  9082*            FIELD (LCVRATEI)
  9083*            LENGTH(6)
  9084*        END-EXEC
  9085     MOVE 6
  9086       TO DFHEIV11
  9087*    MOVE '@"L                   #   #00008727' TO DFHEIV0
  9088     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9089     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9090     MOVE X'2020233030303038373237' TO DFHEIV0(25:11)
  9091     CALL 'kxdfhei1' USING DFHEIV0,
  9092           LCVRATEI,
  9093           DFHEIV11
  9094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9095         IF LCVRATEI IS NUMERIC
  9096             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  9097             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9098             MOVE AL-UNNON       TO LCVRATEA
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 164
* EL131.cbl
  9099         ELSE
  9100             MOVE ER-2280        TO EMI-ERROR
  9101             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9102             MOVE AL-UNBON       TO LCVRATEA
  9103             MOVE 'X'            TO ERROR-SWITCH
  9104             MOVE -1             TO LCVRATEL
  9105     ELSE
  9106         MOVE AL-UNNOF           TO LCVRATEA.
  9107
  9108     IF ACVRATEL GREATER THAN +0
  9109
  9110* EXEC CICS BIF DEEDIT
  9111*            FIELD (ACVRATEI)
  9112*            LENGTH(6)
  9113*        END-EXEC
  9114     MOVE 6
  9115       TO DFHEIV11
  9116*    MOVE '@"L                   #   #00008745' TO DFHEIV0
  9117     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9118     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9119     MOVE X'2020233030303038373435' TO DFHEIV0(25:11)
  9120     CALL 'kxdfhei1' USING DFHEIV0,
  9121           ACVRATEI,
  9122           DFHEIV11
  9123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9124         IF ACVRATEI IS NUMERIC
  9125             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  9126             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9127             MOVE AL-UNNON       TO ACVRATEA
  9128         ELSE
  9129             MOVE ER-2280        TO EMI-ERROR
  9130             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9131             MOVE AL-UNBON       TO ACVRATEA
  9132             MOVE 'X'            TO ERROR-SWITCH
  9133             MOVE -1             TO ACVRATEL
  9134     ELSE
  9135         MOVE AL-UNNOF           TO ACVRATEA.
  9136
  9137     IF LCVBENEL GREATER THAN ZERO
  9138
  9139* EXEC CICS BIF DEEDIT
  9140*            FIELD (LCVBENEI)
  9141*            LENGTH (11)
  9142*        END-EXEC
  9143     MOVE 11
  9144       TO DFHEIV11
  9145*    MOVE '@"L                   #   #00008763' TO DFHEIV0
  9146     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9147     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9148     MOVE X'2020233030303038373633' TO DFHEIV0(25:11)
  9149     CALL 'kxdfhei1' USING DFHEIV0,
  9150           LCVBENEI,
  9151           DFHEIV11
  9152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9153         IF LCVBENEI IS NUMERIC
  9154            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  9155            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9156            MOVE AL-UNNON        TO LCVBENEA
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 165
* EL131.cbl
  9157         ELSE
  9158            MOVE ER-0243         TO EMI-ERROR
  9159            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9160            MOVE AL-UNBON        TO LCVBENEA
  9161            MOVE -1              TO LCVBENEL
  9162            MOVE 'X'             TO ERROR-SWITCH
  9163     ELSE
  9164         MOVE AL-UANOF           TO LCVBENEA.
  9165
  9166     IF ACVBENEL GREATER THAN ZERO
  9167
  9168* EXEC CICS BIF DEEDIT
  9169*            FIELD (ACVBENEI)
  9170*            LENGTH (11)
  9171*        END-EXEC
  9172     MOVE 11
  9173       TO DFHEIV11
  9174*    MOVE '@"L                   #   #00008781' TO DFHEIV0
  9175     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9176     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9177     MOVE X'2020233030303038373831' TO DFHEIV0(25:11)
  9178     CALL 'kxdfhei1' USING DFHEIV0,
  9179           ACVBENEI,
  9180           DFHEIV11
  9181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9182         IF ACVBENEI IS NUMERIC
  9183            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  9184            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9185            MOVE AL-UNNON        TO ACVBENEA
  9186         ELSE
  9187            MOVE ER-0243         TO EMI-ERROR
  9188            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9189            MOVE AL-UNBON        TO ACVBENEA
  9190            MOVE -1              TO ACVBENEL
  9191            MOVE 'X'             TO ERROR-SWITCH
  9192     ELSE
  9193         MOVE AL-UANOF           TO ACVBENEA.
  9194
  9195     IF LCVFORMI GREATER THAN LOW-VALUES
  9196        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9197        MOVE AL-UANON            TO LCVFORMA
  9198     ELSE
  9199        MOVE AL-UANOF            TO LCVFORMA.
  9200
  9201     IF ACVFORMI GREATER THAN LOW-VALUES
  9202        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9203        MOVE AL-UANON            TO ACVFORMA
  9204     ELSE
  9205        MOVE AL-UANOF            TO ACVFORMA.
  9206
  9207     IF LCVCNDTL GREATER THAN ZERO
  9208         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9209         IF LCVCNDTI = SPACES
  9210             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9211         ELSE
  9212             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  9213             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9214             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 166
* EL131.cbl
  9215             MOVE '4'            TO DC-OPTION-CODE
  9216             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9217             IF NOT DATE-CONVERSION-ERROR
  9218                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  9219                 MOVE AL-UANON   TO LCVCNDTA
  9220                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9221                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  9222             ELSE
  9223                 MOVE ER-0246    TO EMI-ERROR
  9224                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9225                 MOVE AL-UABON   TO LCVCNDTA
  9226                 MOVE -1         TO LCVCNDTL
  9227                 MOVE 'X'        TO ERROR-SWITCH
  9228     ELSE
  9229         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9230         MOVE AL-UANOF           TO LCVCNDTA.
  9231
  9232     IF ACVCNDTL GREATER THAN ZERO
  9233         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9234         IF ACVCNDTI = SPACES
  9235             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9236         ELSE
  9237             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  9238             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9239             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9240             MOVE '4'            TO DC-OPTION-CODE
  9241             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9242             IF NOT DATE-CONVERSION-ERROR
  9243                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  9244                 MOVE AL-UANON   TO ACVCNDTA
  9245                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9246                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  9247             ELSE
  9248                 MOVE ER-0246    TO EMI-ERROR
  9249                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9250                 MOVE AL-UABON   TO ACVCNDTA
  9251                 MOVE -1         TO ACVCNDTL
  9252                 MOVE 'X'        TO ERROR-SWITCH
  9253     ELSE
  9254         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9255         MOVE AL-UANOF           TO ACVCNDTA.
  9256
  9257     IF APRL GREATER THAN +0
  9258
  9259* EXEC CICS BIF DEEDIT
  9260*            FIELD    (APRI)
  9261*            LENGTH   (8)
  9262*        END-EXEC
  9263     MOVE 8
  9264       TO DFHEIV11
  9265*    MOVE '@"L                   #   #00008861' TO DFHEIV0
  9266     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9267     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9268     MOVE X'2020233030303038383631' TO DFHEIV0(25:11)
  9269     CALL 'kxdfhei1' USING DFHEIV0,
  9270           APRI,
  9271           DFHEIV11
  9272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 167
* EL131.cbl
  9273         IF APRI NUMERIC
  9274            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9275            MOVE APRI            TO HOLD-APR APRO
  9276            MOVE AL-UANON        TO APRA
  9277          ELSE
  9278            MOVE ER-0259         TO EMI-ERROR
  9279            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9280            MOVE AL-UABON        TO APRA
  9281            MOVE -1              TO APRL
  9282            MOVE 'X'             TO ERROR-SWITCH
  9283     ELSE
  9284         MOVE AL-UANOF           TO APRA.
  9285
  9286     IF PMTFREQL GREATER THAN ZERO
  9287
  9288* EXEC CICS BIF DEEDIT
  9289*            FIELD    (PMTFREQI)
  9290*            LENGTH   (2)
  9291*        END-EXEC
  9292     MOVE 2
  9293       TO DFHEIV11
  9294*    MOVE '@"L                   #   #00008879' TO DFHEIV0
  9295     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9296     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9297     MOVE X'2020233030303038383739' TO DFHEIV0(25:11)
  9298     CALL 'kxdfhei1' USING DFHEIV0,
  9299           PMTFREQI,
  9300           DFHEIV11
  9301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9302         IF PMTFREQI NUMERIC
  9303            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  9304            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9305            MOVE AL-UANON        TO PMTFREQA
  9306          ELSE
  9307            MOVE ER-0427         TO EMI-ERROR
  9308            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9309            MOVE AL-UABON        TO PMTFREQA
  9310            MOVE -1              TO PMTFREQL
  9311            MOVE 'X'             TO ERROR-SWITCH
  9312     ELSE
  9313         MOVE AL-UANOF           TO PMTFREQA.
  9314
  9315     IF INDGRPL GREATER THAN ZERO
  9316         IF INDGRPI = 'I' OR 'G' OR SPACE
  9317             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9318             MOVE AL-UANON       TO INDGRPA
  9319          ELSE
  9320             MOVE ER-0260        TO EMI-ERROR
  9321             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9322             MOVE AL-UABON       TO INDGRPA
  9323             MOVE -1             TO INDGRPL
  9324             MOVE 'X'            TO ERROR-SWITCH
  9325     ELSE
  9326         MOVE AL-UANOF           TO INDGRPA.
  9327
  9328     IF PREMTYPL GREATER THAN ZERO
  9329         IF PREMTYPI = '1' OR '2' OR '3'
  9330            MOVE PREMTYPI        TO PI-PREM-TYPE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 168
* EL131.cbl
  9331            MOVE AL-UNNON        TO PREMTYPA
  9332            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9333          ELSE
  9334            MOVE ER-0227         TO EMI-ERROR
  9335            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9336            MOVE AL-UNBON        TO PREMTYPA
  9337            MOVE -1              TO PREMTYPL
  9338            MOVE 'X'             TO ERROR-SWITCH
  9339     ELSE
  9340         MOVE AL-UANOF           TO PREMTYPA.
  9341
  9342     IF LOANBALL GREATER THAN ZERO
  9343
  9344* EXEC CICS BIF DEEDIT
  9345*             FIELD    (LOANBALI)
  9346*             LENGTH   (9)
  9347*        END-EXEC
  9348     MOVE 9
  9349       TO DFHEIV11
  9350*    MOVE '@"L                   #   #00008924' TO DFHEIV0
  9351     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9352     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9353     MOVE X'2020233030303038393234' TO DFHEIV0(25:11)
  9354     CALL 'kxdfhei1' USING DFHEIV0,
  9355           LOANBALI,
  9356           DFHEIV11
  9357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9358         IF LOANBALI NUMERIC
  9359             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  9360             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  9361             MOVE AL-UNNON TO LOANBALA
  9362         ELSE
  9363             MOVE ER-0639        TO EMI-ERROR
  9364             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9365             MOVE AL-UNBON       TO LOANBALA
  9366             MOVE -1             TO LOANBALL
  9367             MOVE 'X'            TO ERROR-SWITCH
  9368     ELSE
  9369         MOVE AL-UNNOF           TO LOANBALA.
  9370
  9371*    IF LOANNOL GREATER THAN ZERO
  9372*          MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9373*          MOVE AL-UANON            TO LOANNOA
  9374*       ELSE
  9375*          MOVE AL-UANOF            TO LOANNOA.
  9376
  9377     IF REINCDI GREATER THAN LOW-VALUES
  9378        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9379        MOVE AL-UANON            TO REINCDA
  9380     ELSE
  9381        MOVE AL-UANOF            TO REINCDA.
  9382
  9383     IF CERTI GREATER THAN LOW-VALUES
  9384         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  9385     ELSE
  9386         MOVE AL-UANOF           TO CERTA.
  9387
  9388     IF CERTEFFI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 169
* EL131.cbl
  9389         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  9390     ELSE
  9391         MOVE AL-UANOF           TO CERTEFFA.
  9392
  9393     IF CERTACTI GREATER THAN LOW-VALUES
  9394         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  9395     ELSE
  9396         MOVE AL-UANOF           TO CERTACTA.
  9397
  9398     IF CERTSTI GREATER THAN LOW-VALUES
  9399         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  9400     ELSE
  9401         MOVE AL-UANOF           TO CERTSTA.
  9402
  9403     IF CERTCARI GREATER THAN LOW-VALUES
  9404         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  9405     ELSE
  9406         MOVE AL-UANOF           TO CERTCARA.
  9407
  9408     IF DLYACTV-RECORD-NEEDED
  9409         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  9410                 1150-EXIT
  9411     END-IF.
  9412
  9413     IF CERTEFFI GREATER LOW-VALUES OR
  9414        CERTACTI GREATER LOW-VALUES OR
  9415        CERTSTI  GREATER LOW-VALUES OR
  9416        CERTCARI GREATER LOW-VALUES OR
  9417        CERTGRPI GREATER LOW-VALUES
  9418        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9419
  9420*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  9421*      IF PI-PREM-TYPE NOT = '1'  AND
  9422*         PI-NO-PMTS = ZEROS
  9423*          IF LOANBALL GREATER +0 OR
  9424*             ACVBENEL GREATER +0
  9425*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9426     if not acct-found
  9427        perform 1620-VERIFY-ACCT THRU 1620-EXIT
  9428     end-if
  9429     MOVE PI-COMPANY-CD          TO COMPANY-CODE
  9430     MOVE PI-CARRIER             TO CARRIER-CODE
  9431     MOVE PI-CLAIM-NO            TO CLAIM-NO
  9432     MOVE PI-CERT-NO             TO CERT-NO
  9433
  9434* EXEC CICS READ
  9435*        DATASET   (CLMS-FILE-ID)
  9436*        RIDFLD    (MSTR-KEY)
  9437*        SET       (ADDRESS OF CLAIM-MASTER)
  9438*        RESP      (WS-RESPONSE)
  9439*    END-EXEC
  9440*    MOVE '&"S        E          (  N#00009003' TO DFHEIV0
  9441     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9442     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9443     MOVE X'204E233030303039303033' TO DFHEIV0(25:11)
  9444     CALL 'kxdfhei1' USING DFHEIV0,
  9445           CLMS-FILE-ID,
  9446           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 170
* EL131.cbl
  9447           DFHEIV99,
  9448           MSTR-KEY,
  9449           DFHEIV99,
  9450           DFHEIV99,
  9451           DFHEIV99
  9452     SET ADDRESS OF CLAIM-MASTER TO
  9453         DFHEIV20
  9454     MOVE EIBRESP  TO WS-RESPONSE
  9455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9456     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE
  9457     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  9458     MOVE CL-CERT-GROUPING       TO CERT-GROUP
  9459     MOVE CL-CERT-STATE          TO CERT-STATE
  9460     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  9461     MOVE CL-CERT-EFF-DT         TO CERT-DATE
  9462     MOVE CL-CERT-NO             TO CERT-CERT
  9463
  9464* EXEC CICS READ
  9465*       DATASET   (CERT-FILE-ID)
  9466*       RIDFLD    (CERT-KEY)
  9467*       SET       (ADDRESS OF CERTIFICATE-MASTER)
  9468*       RESP      (WS-RESPONSE)
  9469*    END-EXEC
  9470*    MOVE '&"S        E          (  N#00009016' TO DFHEIV0
  9471     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9472     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9473     MOVE X'204E233030303039303136' TO DFHEIV0(25:11)
  9474     CALL 'kxdfhei1' USING DFHEIV0,
  9475           CERT-FILE-ID,
  9476           DFHEIV20,
  9477           DFHEIV99,
  9478           CERT-KEY,
  9479           DFHEIV99,
  9480           DFHEIV99,
  9481           DFHEIV99
  9482     SET ADDRESS OF CERTIFICATE-MASTER TO
  9483         DFHEIV20
  9484     MOVE EIBRESP  TO WS-RESPONSE
  9485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9486     if mfnamei > low-values
  9487        move mfnamei to w-name-first
  9488     else
  9489        move cl-insured-1st-name to w-name-first
  9490     end-if
  9491     if mlnamei > low-values
  9492        move mlnamei to w-name-last
  9493     else
  9494        move cl-insured-last-name to w-name-last
  9495     end-if
  9496     if instypel > zeros
  9497        evaluate true
  9498           when cl-no-of-days-paid > zeros
  9499              move er-1668       to emi-error
  9500              perform 9900-error-format
  9501                                 thru 9900-exit
  9502              move al-uabon      to instypea
  9503              move -1            to instypel
  9504              move 'X'           to error-switch
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 171
* EL131.cbl
  9505           when instypei = 'C'
  9506              if w-name-first (1:10) = cm-insured-first-name
  9507                 move er-1666    to emi-error
  9508                 PERFORM 9900-ERROR-FORMAT
  9509                                 THRU 9900-EXIT
  9510                 move al-uabon   to instypea
  9511                 move -1         to instypel
  9512                 move 'X'        to error-switch
  9513              end-if
  9514           when instypei = 'P'
  9515              if (w-name-first (1:10) <> cm-insured-first-name)
  9516                 or (w-name-last <> cm-insured-last-name)
  9517                 move er-1676    to emi-error
  9518                 PERFORM 9900-ERROR-FORMAT
  9519                                 THRU 9900-EXIT
  9520                 move al-uabon   to instypea
  9521                 move -1         to instypel
  9522                 move 'X'        to error-switch
  9523              end-if
  9524        end-evaluate
  9525     end-if
  9526*    if (instypel > zeros)
  9527*       and (cl-no-of-days-paid > zero)
  9528*       move er-1668             to emi-error
  9529*       perform 9900-error-format thru 9900-exit
  9530*       move al-uabon            to instypea
  9531*       move -1                  to instypel
  9532*       move 'X'                 to error-switch
  9533*    end-if
  9534*
  9535*    if instypel > zero
  9536*       if instypei = 'C'
  9537*          if w-name-first (1:10) = cm-insured-first-name
  9538*             move er-1666          to emi-error
  9539*             PERFORM 9900-ERROR-FORMAT
  9540*                                   THRU 9900-EXIT
  9541*             move al-uabon         to instypea
  9542*             move -1               to instypel
  9543*             move 'X'              to error-switch
  9544*          end-if
  9545*       end-if
  9546*    end-if
  9547     if (pi-company-id = 'DCC' OR 'VPP')
  9548        and (acct-found)
  9549        perform 2120-check-pdef  thru 2120-exit
  9550        IF EXTENSL > ZERO
  9551           IF EXTENSI NUMERIC
  9552              IF EXTENSI >  WS-MAX-EXTENSION
  9553                AND ERPDEF-FOUND
  9554                 MOVE ER-1678          TO EMI-ERROR
  9555                 PERFORM 9900-ERROR-FORMAT
  9556                                       THRU 9900-EXIT
  9557                 MOVE AL-UABON         TO EXTENSA
  9558                 MOVE -1               TO EXTENSL
  9559                 MOVE 'X'              TO ERROR-SWITCH
  9560              ELSE
  9561                 MOVE 'X'              TO UPDATE-SWITCH
  9562              END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 172
* EL131.cbl
  9563           ELSE
  9564              MOVE ER-1778          TO EMI-ERROR
  9565              PERFORM 9900-ERROR-FORMAT
  9566                                    THRU 9900-EXIT
  9567              MOVE AL-UABON         TO EXTENSA
  9568              MOVE -1               TO EXTENSL
  9569              MOVE 'X'              TO ERROR-SWITCH
  9570           END-IF
  9571        END-IF
  9572     end-if
  9573     if benperl > zeros
  9574        move al-uanon            to benpera
  9575     end-if
  9576     if benperl > zeros
  9577        if benperi numeric
  9578           perform 1015-edit-benefit-period
  9579                                 thru 1015-exit
  9580        else
  9581           move er-1669          to emi-error
  9582           PERFORM 9900-ERROR-FORMAT
  9583                                 THRU 9900-EXIT
  9584           move al-uabon         to benpera
  9585           move -1               to benperl
  9586           move 'X'              to error-switch
  9587        end-if
  9588    end-if
  9589     if instypel > zeros
  9590        if instypei = 'P' OR 'C'
  9591           move 'X'              to update-switch
  9592                                    mstr-switch
  9593           move al-uanon         to instypea
  9594        else
  9595            move er-1654          to emi-error
  9596           PERFORM 9900-ERROR-FORMAT
  9597                                 THRU 9900-EXIT
  9598           move al-uabon         to instypea
  9599           move -1               to instypel
  9600           move 'X'              to error-switch
  9601        end-if
  9602    end-if
  9603     if accswl > zeros
  9604        if accswi = 'Y' OR 'N'
  9605           MOVE 'X'              TO UPDATE-SWITCH
  9606                                    MSTR-SWITCH
  9607           MOVE AL-UANON         TO accswa
  9608*       else
  9609*          move er-1656          to emi-error
  9610*          PERFORM 9900-ERROR-FORMAT
  9611*                                THRU 9900-EXIT
  9612*          move al-uabon         to accswa
  9613*          move -1               to accswl
  9614*          move 'X'              to error-switch
  9615*          move al-uanof         to accswa
  9616        end-if
  9617     end-if
  9618     IF CERTL = ZEROS AND
  9619        SUFXL = ZEROS
  9620          GO TO 1010-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 173
* EL131.cbl
  9621
  9622     IF CERTL GREATER THAN ZEROS
  9623         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  9624             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  9625             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9626             MOVE 'X'            TO ERROR-SWITCH
  9627             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9628
  9629     IF SUFXL GREATER THAN ZEROS
  9630         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  9631             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  9632             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9633             MOVE 'X'            TO ERROR-SWITCH
  9634             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9635
  9636 1010-EXIT.
  9637     EXIT.
  9638
  9639 1015-edit-benefit-period.
  9640     move ' '                    to ws-benper-sw
  9641     evaluate true
  9642        when not erpdef-found
  9643           set good-benper       to true
  9644        when pd-recurring-yn (a1) = 'Y'
  9645           set good-benper       to true
  9646        when pd-recurring-yn (a1) = 'N'
  9647           if benperi < 02
  9648              set good-benper    to true
  9649           end-if
  9650        when pd-rec-crit-period (a1) numeric
  9651           if benperi <= pd-rec-crit-period (a1)
  9652              set good-benper    to true
  9653           end-if
  9654     end-evaluate
  9655     MOVE CERT-KEY               TO ELCRTT-KEY
  9656     MOVE 'B'                    TO CTRLR-REC-TYPE
  9657
  9658* EXEC CICS READ
  9659*       DATASET   ('ELCRTT')
  9660*       RIDFLD    (ELCRTT-KEY)
  9661*       INTO      (CERTIFICATE-TRAILERS)
  9662*       RESP      (WS-RESPONSE)
  9663*    END-EXEC
  9664     MOVE LENGTH OF
  9665      CERTIFICATE-TRAILERS
  9666       TO DFHEIV11
  9667     MOVE 'ELCRTT' TO DFHEIV1
  9668*    MOVE '&"IL       E          (  N#00009193' TO DFHEIV0
  9669     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9670     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9671     MOVE X'204E233030303039313933' TO DFHEIV0(25:11)
  9672     CALL 'kxdfhei1' USING DFHEIV0,
  9673           DFHEIV1,
  9674           CERTIFICATE-TRAILERS,
  9675           DFHEIV11,
  9676           ELCRTT-KEY,
  9677           DFHEIV99,
  9678           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 174
* EL131.cbl
  9679           DFHEIV99
  9680     MOVE EIBRESP  TO WS-RESPONSE
  9681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9682     IF WS-RESP-NORMAL
  9683        perform varying s1 from +1 by +1 until
  9684           (s1 > +24)
  9685           or ((cs-claim-type (s1) = cl-claim-type)
  9686           and (cs-insured-type (s1) = cl-insured-type)
  9687           and (cs-benefit-period (s1) > benperi))
  9688        end-perform
  9689        if s1 < +25
  9690           move er-1665          to emi-error
  9691           PERFORM 9900-ERROR-FORMAT
  9692                                 THRU 9900-EXIT
  9693           move al-uabon         to benpera
  9694           move -1               to benperl
  9695           move 'X'              to error-switch
  9696           go to 1015-exit
  9697*       else
  9698*          set good-benper       to true
  9699        end-if
  9700     end-if
  9701     if good-benper
  9702        move 'X'                 to update-switch
  9703                                    mstr-switch
  9704        move al-uanon            to benpera
  9705     else
  9706        move er-1669             to emi-error
  9707        PERFORM 9900-ERROR-FORMAT
  9708                                 THRU 9900-EXIT
  9709        move al-uabon            to benpera
  9710        move -1                  to benperl
  9711        move 'X'                 to error-switch
  9712     end-if
  9713     .
  9714 1015-exit.
  9715     exit.
  9716 1050-EDIT-BENE.
  9717     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
  9718     MOVE PI-CARRIER         TO TRLR-CARRIER.
  9719     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
  9720     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
  9721     MOVE 1000               TO TRLR-SEQ-NO.
  9722
  9723
  9724* EXEC CICS HANDLE CONDITION
  9725*         NOTFND    (1052-DONE)
  9726*         ENDFILE   (1052-DONE)
  9727*    END-EXEC.
  9728*    MOVE '"$I''                  ! & #00009240' TO DFHEIV0
  9729     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9730     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9731     MOVE X'2620233030303039323430' TO DFHEIV0(25:11)
  9732     CALL 'kxdfhei1' USING DFHEIV0
  9733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9734
  9735
  9736
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 175
* EL131.cbl
  9737* EXEC CICS STARTBR
  9738*        DATASET (TRLR-FILE-ID)
  9739*        RIDFLD  (TRLR-KEY)
  9740*    END-EXEC
  9741     MOVE 0
  9742       TO DFHEIV11
  9743*    MOVE '&,         G          &   #00009245' TO DFHEIV0
  9744     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9745     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9746     MOVE X'2020233030303039323435' TO DFHEIV0(25:11)
  9747     CALL 'kxdfhei1' USING DFHEIV0,
  9748           TRLR-FILE-ID,
  9749           TRLR-KEY,
  9750           DFHEIV99,
  9751           DFHEIV11,
  9752           DFHEIV99
  9753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9754
  9755
  9756     MOVE SPACES TO WS-TRLR-FILE-EOF
  9757                    WS-PAYMENT-PENDING
  9758     PERFORM 1052-READ-TRLR THRU 1052-EXIT
  9759       UNTIL  TRLR-FILE-EOF
  9760         OR PAYMENT-PENDING
  9761
  9762
  9763* EXEC CICS ENDBR
  9764*        DATASET (TRLR-FILE-ID)
  9765*    END-EXEC.
  9766     MOVE 0
  9767       TO DFHEIV11
  9768*    MOVE '&2                    $   #00009257' TO DFHEIV0
  9769     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9770     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9771     MOVE X'2020233030303039323537' TO DFHEIV0(25:11)
  9772     CALL 'kxdfhei1' USING DFHEIV0,
  9773           TRLR-FILE-ID,
  9774           DFHEIV11,
  9775           DFHEIV99
  9776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9777
  9778 1050-EXIT.
  9779     EXIT.
  9780
  9781 1052-READ-TRLR.
  9782
  9783* EXEC CICS READNEXT
  9784*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9785*         DATASET  (TRLR-FILE-ID)
  9786*         RIDFLD   (TRLR-KEY)
  9787*    END-EXEC.
  9788     MOVE 0
  9789       TO DFHEIV11
  9790*    MOVE '&.S                   )   #00009264' TO DFHEIV0
  9791     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9792     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9793     MOVE X'2020233030303039323634' TO DFHEIV0(25:11)
  9794     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 176
* EL131.cbl
  9795           TRLR-FILE-ID,
  9796           DFHEIV20,
  9797           DFHEIV99,
  9798           TRLR-KEY,
  9799           DFHEIV99,
  9800           DFHEIV11,
  9801           DFHEIV99,
  9802           DFHEIV99
  9803     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9804         DFHEIV20
  9805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9806
  9807
  9808     IF PI-COMPANY-CD   = TRLR-COMPANY-CD
  9809       AND PI-CARRIER  = TRLR-CARRIER
  9810       AND PI-CLAIM-NO = TRLR-CLAIM-NO
  9811       AND PI-CERT-NO  = TRLR-CERT-NO
  9812        CONTINUE
  9813     ELSE
  9814        GO TO 1052-DONE
  9815     END-IF.
  9816
  9817     IF PAYMENT-TR
  9818       AND BENEFICIARY-PAID
  9819       AND AT-VOID-DT = LOW-VALUES
  9820       AND AT-CHECK-WRITTEN-DT NOT > SPACES
  9821         SET PAYMENT-PENDING TO TRUE
  9822     END-IF.
  9823
  9824     IF CORRESPONDENCE-TR
  9825        IF AT-AUTH-RCVD = 'Y'
  9826           SET AUTH-RCVD TO TRUE
  9827        ELSE
  9828        IF AT-AUTH-RCVD = 'N'
  9829           SET NO-AUTH-RCVD TO TRUE
  9830        END-IF
  9831        END-IF
  9832     END-IF.
  9833
  9834     GO TO 1052-EXIT.
  9835
  9836 1052-DONE.
  9837     SET TRLR-FILE-EOF TO TRUE.
  9838 1052-EXIT.
  9839     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 177
* EL131.cbl
  9841 1120-EDIT-PROC.
  9842     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9843     MOVE '2'                    TO CNTL-REC-TYPE.
  9844     MOVE PROCI                  TO CNTL-PROC-ID.
  9845     MOVE ZERO                   TO CNTL-SEQ-NO.
  9846
  9847
  9848* EXEC CICS HANDLE CONDITION
  9849*         NOTFND    (1120-CNTL-NOTFND)
  9850*    END-EXEC.
  9851*    MOVE '"$I                   ! '' #00009309' TO DFHEIV0
  9852     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9853     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9854     MOVE X'2720233030303039333039' TO DFHEIV0(25:11)
  9855     CALL 'kxdfhei1' USING DFHEIV0
  9856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9857
  9858
  9859
  9860* EXEC CICS READ
  9861*         SET      (ADDRESS OF CONTROL-FILE)
  9862*         DATASET  (CNTL-FILE-ID)
  9863*         RIDFLD   (CNTL-KEY)
  9864*    END-EXEC.
  9865*    MOVE '&"S        E          (   #00009313' TO DFHEIV0
  9866     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9867     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9868     MOVE X'2020233030303039333133' TO DFHEIV0(25:11)
  9869     CALL 'kxdfhei1' USING DFHEIV0,
  9870           CNTL-FILE-ID,
  9871           DFHEIV20,
  9872           DFHEIV99,
  9873           CNTL-KEY,
  9874           DFHEIV99,
  9875           DFHEIV99,
  9876           DFHEIV99
  9877     SET ADDRESS OF CONTROL-FILE TO
  9878         DFHEIV20
  9879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9880
  9881
  9882     MOVE AL-UANON               TO PROCA.
  9883     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  9884     GO TO 1120-EXIT.
  9885
  9886 1120-CNTL-NOTFND.
  9887     MOVE ER-0273                TO EMI-ERROR.
  9888     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9889     MOVE AL-UABON               TO PROCA.
  9890     MOVE -1                     TO PROCL.
  9891     MOVE 'X'                    TO ERROR-SWITCH.
  9892
  9893 1120-EXIT.
  9894     EXIT.
  9895
  9896*************************************************************
  9897*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
  9898*************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 178
* EL131.cbl
  9899
  9900 1150-OUTPUT-ACTIVITY-RECORD.
  9901
  9902
  9903* EXEC CICS GETMAIN
  9904*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  9905*        LENGTH (25)
  9906*        INITIMG (WS-BLANK)
  9907*    END-EXEC.
  9908     MOVE 25
  9909       TO DFHEIV11
  9910*    MOVE ',"IL                  $   #00009339' TO DFHEIV0
  9911     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9912     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9913     MOVE X'2020233030303039333339' TO DFHEIV0(25:11)
  9914     CALL 'kxdfhei1' USING DFHEIV0,
  9915           DFHEIV20,
  9916           DFHEIV11,
  9917           WS-BLANK
  9918     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  9919         DFHEIV20
  9920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9921
  9922
  9923     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  9924     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
  9925     MOVE PI-CARRIER             TO DA-CARRIER.
  9926     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
  9927     MOVE PI-CERT-NO             TO DA-CERT-NO.
  9928     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
  9929     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
  9930
  9931
  9932* EXEC CICS HANDLE CONDITION
  9933*        NOTOPEN (1150-NOTOPEN-ERROR)
  9934*        DUPREC (1150-EXIT)
  9935*    END-EXEC.
  9936*    MOVE '"$J%                  ! ( #00009353' TO DFHEIV0
  9937     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  9938     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9939     MOVE X'2820233030303039333533' TO DFHEIV0(25:11)
  9940     CALL 'kxdfhei1' USING DFHEIV0
  9941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9942
  9943     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
  9944     MOVE 'DLYACTV'              TO JP-FILE-ID.
  9945     MOVE 'A'                    TO JP-RECORD-TYPE.
  9946     MOVE +48                    TO JOURNAL-LENGTH.
  9947
  9948
  9949* EXEC CICS WRITE
  9950*        DATASET ('DLYACTV')
  9951*        RIDFLD (DA-KEY)
  9952*        FROM (DAILY-ACTIVITY-RECORD)
  9953*        LENGTH (25)
  9954*    END-EXEC.
  9955     MOVE 'DLYACTV' TO DFHEIV1
  9956     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 179
* EL131.cbl
  9957       TO DFHEIV11
  9958*    MOVE '&$ L                  ''   #00009362' TO DFHEIV0
  9959     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9960     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9961     MOVE X'2020233030303039333632' TO DFHEIV0(25:11)
  9962     CALL 'kxdfhei1' USING DFHEIV0,
  9963           DFHEIV1,
  9964           DAILY-ACTIVITY-RECORD,
  9965           DFHEIV11,
  9966           DA-KEY,
  9967           DFHEIV99,
  9968           DFHEIV99
  9969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9970
  9971
  9972     GO TO 1150-EXIT.
  9973
  9974 1150-NOTOPEN-ERROR.
  9975
  9976     MOVE '2955'                 TO EMI-ERROR.
  9977     MOVE -1                     TO MAINTL.
  9978     MOVE AL-UANON               TO MAINTA.
  9979     MOVE 'X'                    TO ERROR-SWITCH.
  9980     PERFORM 9900-ERROR-FORMAT THRU
  9981             9900-EXIT.
  9982
  9983 1150-EXIT.
  9984     EXIT.
  9985
  9986*************************************************************
  9987*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
  9988*************************************************************
  9989
  9990 1240-EDIT-LIFE-CODE.
  9991
  9992     IF INVALID-BENEFIT-CODE
  9993         GO TO 1240-SET-ERROR.
  9994
  9995     MOVE SPACES                 TO BENEFIT-KEY.
  9996     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9997     MOVE '4'                    TO BEN-REC-TYPE.
  9998     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9999     MOVE ZERO                   TO BEN-SEQ-NO.
 10000
 10001
 10002* EXEC CICS READ GTEQ
 10003*         DATASET  (CNTL-FILE-ID)
 10004*         RIDFLD   (BENEFIT-KEY)
 10005*         SET      (ADDRESS OF CONTROL-FILE)
 10006*    END-EXEC.
 10007*    MOVE '&"S        G          (   #00009398' TO DFHEIV0
 10008     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10009     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10010     MOVE X'2020233030303039333938' TO DFHEIV0(25:11)
 10011     CALL 'kxdfhei1' USING DFHEIV0,
 10012           CNTL-FILE-ID,
 10013           DFHEIV20,
 10014           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 180
* EL131.cbl
 10015           BENEFIT-KEY,
 10016           DFHEIV99,
 10017           DFHEIV99,
 10018           DFHEIV99
 10019     SET ADDRESS OF CONTROL-FILE TO
 10020         DFHEIV20
 10021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10022
 10023
 10024     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
 10025        CF-RECORD-TYPE NOT = '4'
 10026         GO TO 1240-SET-ERROR.
 10027
 10028     MOVE ZERO                   TO COUNT-2.
 10029     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 10030
 10031     IF SCREEN-ERROR
 10032         GO TO 1240-SET-ERROR.
 10033
 10034 1240-SET-CODE-SWITCHES.
 10035     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
 10036     MOVE AL-UANON               TO LCVCDA.
 10037     GO TO 1240-EXIT.
 10038
 10039 1240-SET-ERROR.
 10040     MOVE ER-0240                TO EMI-ERROR.
 10041     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10042     MOVE 'X'                    TO ERROR-SWITCH.
 10043     MOVE AL-UABON               TO LCVCDA.
 10044     MOVE -1                     TO LCVCDL.
 10045
 10046 1240-EXIT.
 10047     EXIT.
 10048
 10049 1310-EDIT-AH-CODE.
 10050     IF INVALID-BENEFIT-CODE
 10051         GO TO 1310-SET-ERROR.
 10052
 10053     MOVE SPACES                 TO BENEFIT-KEY.
 10054     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 10055     MOVE '5'                    TO BEN-REC-TYPE.
 10056     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
 10057     MOVE ZERO                   TO BEN-SEQ-NO.
 10058
 10059
 10060* EXEC CICS READ GTEQ
 10061*         DATASET  (CNTL-FILE-ID)
 10062*         RIDFLD   (BENEFIT-KEY)
 10063*         SET      (ADDRESS OF CONTROL-FILE)
 10064*    END-EXEC.
 10065*    MOVE '&"S        G          (   #00009439' TO DFHEIV0
 10066     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10067     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10068     MOVE X'2020233030303039343339' TO DFHEIV0(25:11)
 10069     CALL 'kxdfhei1' USING DFHEIV0,
 10070           CNTL-FILE-ID,
 10071           DFHEIV20,
 10072           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 181
* EL131.cbl
 10073           BENEFIT-KEY,
 10074           DFHEIV99,
 10075           DFHEIV99,
 10076           DFHEIV99
 10077     SET ADDRESS OF CONTROL-FILE TO
 10078         DFHEIV20
 10079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10080
 10081
 10082     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
 10083        CF-RECORD-TYPE NOT = '5'
 10084         GO TO 1310-SET-ERROR.
 10085
 10086     MOVE ZERO                   TO COUNT-2.
 10087     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 10088     IF SCREEN-ERROR
 10089         GO TO 1310-SET-ERROR.
 10090
 10091 1310-SET-CODE-SWITCHES.
 10092     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
 10093     MOVE AL-UANON               TO ACVCDA.
 10094     GO TO 1310-EXIT.
 10095
 10096 1310-SET-ERROR.
 10097     MOVE ER-0250                TO EMI-ERROR.
 10098     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10099     MOVE AL-UABON               TO ACVCDA.
 10100     MOVE 'X'                    TO ERROR-SWITCH.
 10101     MOVE -1                     TO ACVCDL.
 10102
 10103 1310-EXIT.
 10104     EXIT.
 10105
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 182
* EL131.cbl
 10107 1460-EDIT-CERT-NO.
 10108     MOVE CERTI                  TO WS-CERT-NO-PRIME.
 10109     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
 10110
 10111     IF WS-SAVE-CERT-NO = SPACES
 10112         MOVE ER-0203            TO EMI-ERROR
 10113         GO TO 1460-CERT-NO-ERROR.
 10114
 10115     IF WS-CERT-NO-PRIME = SPACES AND
 10116        WS-CERT-NO-SUFX GREATER THAN SPACE
 10117            MOVE ER-0210         TO EMI-ERROR
 10118            GO TO 1460-CERT-NO-ERROR.
 10119
 10120     MOVE 'X'                    TO UPDATE-SWITCH.
 10121     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10122     MOVE AL-UANON               TO CERTA.
 10123
 10124     IF SUFXL IS GREATER THAN 0
 10125         MOVE AL-UANON           TO SUFXA.
 10126
 10127     GO TO 1460-EXIT.
 10128
 10129 1460-CERT-NO-ERROR.
 10130     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10131     MOVE AL-UABON               TO SUFXA.
 10132     MOVE AL-UABON               TO CERTA.
 10133     MOVE -1                     TO CERTL.
 10134     MOVE 'X'                    TO ERROR-SWITCH.
 10135
 10136 1460-EXIT.
 10137     EXIT.
 10138
 10139 1470-EDIT-EFF.
 10140     IF CERTEFFI = SPACES
 10141         GO TO 1470-DATE-ERROR.
 10142
 10143     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
 10144     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
 10145     IF DEEDIT-DATE = ZERO
 10146         GO TO 1470-DATE-ERROR.
 10147
 10148     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
 10149     MOVE '4'                    TO DC-OPTION-CODE.
 10150     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 10151     IF NOT DATE-CONVERSION-ERROR
 10152         MOVE DC-BIN-DATE-1      TO HOLD-EFF
 10153         MOVE AL-UANON           TO CERTEFFA
 10154         MOVE 'X'                TO UPDATE-SWITCH
 10155         MOVE 'Y'                TO CERT-KEY-SWITCH
 10156         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
 10157         GO TO 1470-EXIT.
 10158
 10159 1470-DATE-ERROR.
 10160     MOVE ER-0215                TO EMI-ERROR.
 10161     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10162     MOVE AL-UABON               TO CERTEFFA.
 10163     MOVE -1                     TO CERTEFFL.
 10164     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 183
* EL131.cbl
 10165
 10166 1470-EXIT.
 10167     EXIT.
 10168
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 184
* EL131.cbl
 10170 1480-EDIT-ACCT.
 10171     IF CERTACTI = SPACES
 10172         MOVE ER-0232            TO EMI-ERROR
 10173         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10174         MOVE AL-UABON           TO CERTACTA
 10175         MOVE -1                 TO CERTACTL
 10176         MOVE 'X'                TO ERROR-SWITCH
 10177     ELSE
 10178         MOVE 'X'                TO UPDATE-SWITCH
 10179         MOVE 'Y'                TO CERT-KEY-SWITCH.
 10180
 10181 1480-EXIT.
 10182     EXIT.
 10183
 10184 1490-EDIT-STATE.
 10185     IF CERTSTI = SPACES
 10186         MOVE ER-0233            TO EMI-ERROR
 10187         GO TO 1490-STATE-ERROR.
 10188
 10189     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10190     MOVE '3'                    TO CNTL-REC-TYPE.
 10191     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 10192     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
 10193     MOVE ZERO                   TO CNTL-SEQ-NO.
 10194
 10195
 10196* EXEC CICS HANDLE CONDITION
 10197*         NOTFND (1490-STATE-NOTFND)
 10198*    END-EXEC.
 10199*    MOVE '"$I                   ! ) #00009558' TO DFHEIV0
 10200     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10201     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10202     MOVE X'2920233030303039353538' TO DFHEIV0(25:11)
 10203     CALL 'kxdfhei1' USING DFHEIV0
 10204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10205
 10206
 10207
 10208* EXEC CICS READ
 10209*         SET        (ADDRESS OF CONTROL-FILE)
 10210*         DATASET    ('ELCNTL')
 10211*         RIDFLD     (CNTL-KEY)
 10212*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10213*         GENERIC
 10214*    END-EXEC.
 10215     MOVE 'ELCNTL' TO DFHEIV1
 10216*    MOVE '&"S  KG    E          (   #00009562' TO DFHEIV0
 10217     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10218     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10219     MOVE X'2020233030303039353632' TO DFHEIV0(25:11)
 10220     CALL 'kxdfhei1' USING DFHEIV0,
 10221           DFHEIV1,
 10222           DFHEIV20,
 10223           DFHEIV99,
 10224           CNTL-KEY,
 10225           CNTL-GENERIC-LENGTH,
 10226           DFHEIV99,
 10227           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 185
* EL131.cbl
 10228     SET ADDRESS OF CONTROL-FILE TO
 10229         DFHEIV20
 10230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10231
 10232
 10233     MOVE AL-UANON               TO CERTSTA.
 10234     MOVE 'X'                    TO UPDATE-SWITCH.
 10235     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10236     GO TO 1490-EXIT.
 10237
 10238 1490-STATE-NOTFND.
 10239     MOVE ER-0149                TO EMI-ERROR.
 10240
 10241 1490-STATE-ERROR.
 10242     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10243     MOVE AL-UABON               TO CERTSTA.
 10244     MOVE -1                     TO CERTSTL.
 10245     MOVE 'X'                    TO ERROR-SWITCH.
 10246
 10247 1490-EXIT.
 10248     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 186
* EL131.cbl
 10250 1500-EDIT-CARR.
 10251     IF CERTCARI = SPACES
 10252         GO TO 1500-CARR-NOTFND.
 10253
 10254     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10255     MOVE '6'                    TO CNTL-REC-TYPE.
 10256     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
 10257     MOVE CERTCARI               TO CNTL-CARRIER.
 10258     MOVE ZERO                   TO CNTL-SEQ-NO.
 10259
 10260
 10261* EXEC CICS HANDLE CONDITION
 10262*         NOTFND   (1500-CARR-NOTFND)
 10263*    END-EXEC.
 10264*    MOVE '"$I                   ! * #00009597' TO DFHEIV0
 10265     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10266     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10267     MOVE X'2A20233030303039353937' TO DFHEIV0(25:11)
 10268     CALL 'kxdfhei1' USING DFHEIV0
 10269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10270
 10271
 10272
 10273* EXEC CICS READ
 10274*         SET        (ADDRESS OF CONTROL-FILE)
 10275*         DATASET    ('ELCNTL')
 10276*         RIDFLD     (CNTL-KEY)
 10277*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10278*         GENERIC
 10279*    END-EXEC.
 10280     MOVE 'ELCNTL' TO DFHEIV1
 10281*    MOVE '&"S  KG    E          (   #00009601' TO DFHEIV0
 10282     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10283     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10284     MOVE X'2020233030303039363031' TO DFHEIV0(25:11)
 10285     CALL 'kxdfhei1' USING DFHEIV0,
 10286           DFHEIV1,
 10287           DFHEIV20,
 10288           DFHEIV99,
 10289           CNTL-KEY,
 10290           CNTL-GENERIC-LENGTH,
 10291           DFHEIV99,
 10292           DFHEIV99
 10293     SET ADDRESS OF CONTROL-FILE TO
 10294         DFHEIV20
 10295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10296
 10297
 10298     MOVE AL-UANON               TO CERTCARA.
 10299     MOVE 'X'                    TO UPDATE-SWITCH.
 10300     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10301     GO TO 1500-EXIT.
 10302
 10303 1500-CARR-NOTFND.
 10304     MOVE ER-0360                TO EMI-ERROR.
 10305     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10306     MOVE AL-UABON               TO CERTCARA.
 10307     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 187
* EL131.cbl
 10308     MOVE 'X'                    TO ERROR-SWITCH.
 10309
 10310 1500-EXIT.
 10311     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 188
* EL131.cbl
 10313 1510-DEEDIT-DATE.
 10314
 10315* EXEC CICS BIF DEEDIT
 10316*         FIELD    (DEEDIT-DATE-INPUT)
 10317*         LENGTH   (DATE-LENGTH)
 10318*    END-EXEC.
 10319*    MOVE '@"L                   #   #00009625' TO DFHEIV0
 10320     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10321     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10322     MOVE X'2020233030303039363235' TO DFHEIV0(25:11)
 10323     CALL 'kxdfhei1' USING DFHEIV0,
 10324           DEEDIT-DATE-INPUT,
 10325           DATE-LENGTH
 10326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10327
 10328
 10329 1510-EXIT.
 10330     EXIT.
 10331
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 189
* EL131.cbl
 10333 1620-VERIFY-ACCT.
 10334
 10335     move ' '                    to ws-eracct-sw
 10336     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
 10337     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10338     MOVE PI-GROUPING            TO ACCT-GROUP.
 10339     MOVE PI-STATE               TO ACCT-STATE.
 10340     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10341
 10342     IF CERTEFFI GREATER THAN LOW-VALUES
 10343         MOVE HOLD-EFF           TO ACCT-DATE
 10344     ELSE
 10345         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
 10346
 10347     IF CERTACTI GREATER THAN LOW-VALUES
 10348         MOVE CERTACTI           TO  ACCT-ACCOUNT.
 10349     IF CERTSTI GREATER THAN LOW-VALUES
 10350         MOVE CERTSTI            TO  ACCT-STATE.
 10351     IF CERTCARI GREATER THAN LOW-VALUES
 10352         MOVE CERTCARI           TO  ACCT-CARRIER.
 10353     IF CERTGRPI GREATER THAN LOW-VALUES
 10354         MOVE CERTGRPI           TO ACCT-GROUP.
 10355
 10356     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
 10357
 10358
 10359* EXEC CICS HANDLE CONDITION
 10360*         NOTFND  (1620-ACCT-NOTFND)
 10361*    END-EXEC.
 10362*    MOVE '"$I                   ! + #00009659' TO DFHEIV0
 10363     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10364     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10365     MOVE X'2B20233030303039363539' TO DFHEIV0(25:11)
 10366     CALL 'kxdfhei1' USING DFHEIV0
 10367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10368
 10369
 10370
 10371* EXEC CICS STARTBR
 10372*         DATASET   (ACCT-FILE-ID)
 10373*         RIDFLD    (ACCT-KEY)
 10374*    END-EXEC.
 10375     MOVE 0
 10376       TO DFHEIV11
 10377*    MOVE '&,         G          &   #00009663' TO DFHEIV0
 10378     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10379     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10380     MOVE X'2020233030303039363633' TO DFHEIV0(25:11)
 10381     CALL 'kxdfhei1' USING DFHEIV0,
 10382           ACCT-FILE-ID,
 10383           ACCT-KEY,
 10384           DFHEIV99,
 10385           DFHEIV11,
 10386           DFHEIV99
 10387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10388
 10389
 10390 1620-ACCT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 190
* EL131.cbl
 10391
 10392
 10393* EXEC CICS READNEXT
 10394*         DATASET  (ACCT-FILE-ID)
 10395*         RIDFLD   (ACCT-KEY)
 10396*         SET      (ADDRESS OF ACCOUNT-MASTER)
 10397*    END-EXEC.
 10398     MOVE 0
 10399       TO DFHEIV11
 10400*    MOVE '&.S                   )   #00009670' TO DFHEIV0
 10401     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10402     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10403     MOVE X'2020233030303039363730' TO DFHEIV0(25:11)
 10404     CALL 'kxdfhei1' USING DFHEIV0,
 10405           ACCT-FILE-ID,
 10406           DFHEIV20,
 10407           DFHEIV99,
 10408           ACCT-KEY,
 10409           DFHEIV99,
 10410           DFHEIV11,
 10411           DFHEIV99,
 10412           DFHEIV99
 10413     SET ADDRESS OF ACCOUNT-MASTER TO
 10414         DFHEIV20
 10415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10416
 10417
 10418     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
 10419         GO TO 1620-ACCT-NOTFND.
 10420
 10421     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
 10422        HOLD-EFF     LESS AM-EXPIRATION-DT
 10423         NEXT SENTENCE
 10424     ELSE
 10425         GO TO 1620-ACCT-LOOP.
 10426
 10427     set acct-found to true
 10428     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 10429         GO TO 1620-ACCT-END-BROWSE.
 10430
 10431     IF LOANBALL GREATER THAN +0
 10432         IF AM-MAX-TOT-BEN NUMERIC  AND
 10433            AM-MAX-TOT-BEN GREATER THAN ZERO
 10434             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
 10435                 MOVE AL-UNBON     TO LOANBALA
 10436                 MOVE -1           TO LOANBALL
 10437                 MOVE 'X'          TO ERROR-SWITCH
 10438                 MOVE ER-7641      TO EMI-ERROR
 10439                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10440
 10441     IF ACVBENEL GREATER THAN +0
 10442         IF AM-MAX-MON-BEN NUMERIC  AND
 10443            AM-MAX-MON-BEN GREATER THAN ZERO
 10444             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
 10445                 MOVE AL-UNBON     TO ACVBENEA
 10446                 MOVE -1           TO ACVBENEL
 10447                 MOVE 'X'          TO ERROR-SWITCH
 10448                 MOVE ER-7642      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 191
* EL131.cbl
 10449                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10450
 10451 1620-ACCT-END-BROWSE.
 10452
 10453
 10454* EXEC CICS ENDBR
 10455*         DATASET (ACCT-FILE-ID)
 10456*    END-EXEC.
 10457     MOVE 0
 10458       TO DFHEIV11
 10459*    MOVE '&2                    $   #00009711' TO DFHEIV0
 10460     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10461     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10462     MOVE X'2020233030303039373131' TO DFHEIV0(25:11)
 10463     CALL 'kxdfhei1' USING DFHEIV0,
 10464           ACCT-FILE-ID,
 10465           DFHEIV11,
 10466           DFHEIV99
 10467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10468
 10469
 10470     GO TO 1620-EXIT.
 10471
 10472 1620-ACCT-NOTFND.
 10473
 10474     MOVE -1                     TO MAINTL.
 10475     MOVE 'X'                    TO ERROR-SWITCH.
 10476     MOVE ER-0426                TO EMI-ERROR.
 10477     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10478
 10479 1620-EXIT.
 10480     EXIT.
 10481
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 192
* EL131.cbl
 10483 2000-UPDATE-CLAIM.
 10484
 10485     MOVE SPACES                 TO ERROR-SWITCH.
 10486     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 10487     MOVE PI-CARRIER             TO CARRIER-CODE.
 10488     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 10489     MOVE PI-CERT-NO             TO CERT-NO.
 10490
 10491     IF DELETE-CLAIM
 10492         GO TO 3000-DELETE-CLAIM.
 10493
 10494     IF  NOT MODIFY-CAP
 10495         MOVE ER-0070            TO EMI-ERROR
 10496         MOVE 'X'                TO ERROR-SWITCH
 10497         MOVE -1                 TO MAINTL
 10498         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10499         GO TO 2000-EXIT.
 10500
 10501     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 10502     MOVE ZERO                   TO TRLR-SEQ-NO.
 10503
 10504
 10505* EXEC CICS READ UPDATE
 10506*         SET       (ADDRESS OF CLAIM-MASTER)
 10507*         DATASET   (CLMS-FILE-ID)
 10508*         RIDFLD    (MSTR-KEY)
 10509*    END-EXEC.
 10510*    MOVE '&"S        EU         (   #00009749' TO DFHEIV0
 10511     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10512     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10513     MOVE X'2020233030303039373439' TO DFHEIV0(25:11)
 10514     CALL 'kxdfhei1' USING DFHEIV0,
 10515           CLMS-FILE-ID,
 10516           DFHEIV20,
 10517           DFHEIV99,
 10518           MSTR-KEY,
 10519           DFHEIV99,
 10520           DFHEIV99,
 10521           DFHEIV99
 10522     SET ADDRESS OF CLAIM-MASTER TO
 10523         DFHEIV20
 10524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10525
 10526
 10527     if (incl > zeros)
 10528        and (cl-no-of-pmts-made > 0)
 10529        and (hold-incur > low-values)
 10530        and (hold-incur not = cl-incurred-dt)
 10531        if hold-incur > cl-incurred-dt
 10532           move cl-incurred-dt   to dc-bin-date-1
 10533           move hold-incur       to dc-bin-date-2
 10534        else
 10535           move hold-incur       to dc-bin-date-1
 10536           move cl-incurred-dt   to dc-bin-date-2
 10537        end-if
 10538        move '1'                 to dc-option-code
 10539        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10540        if dc-elapsed-days > +180
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 193
* EL131.cbl
 10541           MOVE ER-1663             TO EMI-ERROR
 10542           PERFORM 9900-ERROR-FORMAT
 10543                                 THRU 9900-EXIT
 10544           MOVE -1                  TO MAINTL
 10545           GO TO 8110-SEND-DATA
 10546        end-if
 10547     end-if
 10548     IF (CL-PRIORITY-CD = '8')
 10549        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
 10550             AND 'AMWA' AND 'KMSB')
 10551        MOVE ER-8003             TO EMI-ERROR
 10552        PERFORM 9900-ERROR-FORMAT
 10553                                 THRU 9900-EXIT
 10554        MOVE -1                  TO MAINTL
 10555        GO TO 8110-SEND-DATA
 10556     END-IF
 10557
 10558     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
 10559         MOVE ER-0068            TO EMI-ERROR
 10560         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10561         GO TO 2000-EXIT.
 10562
 10563     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
 10564         MOVE ER-0068            TO EMI-ERROR
 10565         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10566         GO TO 2000-EXIT.
 10567
 10568     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
 10569         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
 10570
 10571     IF CL-PURGED-DT NOT = LOW-VALUES
 10572         MOVE ER-7691            TO EMI-ERROR
 10573         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10574         GO TO 2000-EXIT.
 10575
 10576     IF CERT-KEY-CHANGED
 10577         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
 10578
 10579     IF SCREEN-ERROR
 10580         MOVE ER-0068            TO EMI-ERROR
 10581         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10582         GO TO 2000-EXIT.
 10583
 10584     IF NINETY-TRLR-UPDATED
 10585         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
 10586
 10587     IF MSTR-KEY-CHANGED
 10588         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
 10589        ELSE
 10590         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
 10591
 10592     IF TRLR-UPDATE-REQUIRED
 10593         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
 10594
 10595 2000-CHECK-CERT.
 10596     IF NOT CERT-UPDATES
 10597         GO TO 2000-EXIT.
 10598
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 194
* EL131.cbl
 10599     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10600     MOVE PI-CARRIER             TO CERT-CARRIER.
 10601     MOVE PI-GROUPING            TO CERT-GROUP.
 10602     MOVE PI-STATE               TO CERT-STATE.
 10603     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10604     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10605     MOVE PI-CERT-NO             TO CERT-CERT.
 10606
 10607     IF CERT-ALT-KEY-CHANGED
 10608         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
 10609     ELSE
 10610         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
 10611
 10612 2000-EXIT.
 10613     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 195
* EL131.cbl
 10615 2010-RELEASE-REC.
 10616
 10617* EXEC CICS UNLOCK
 10618*         DATASET  (CLMS-FILE-ID)
 10619*    END-EXEC
 10620*    MOVE '&*                    #   #00009844' TO DFHEIV0
 10621     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10622     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10623     MOVE X'2020233030303039383434' TO DFHEIV0(25:11)
 10624     CALL 'kxdfhei1' USING DFHEIV0,
 10625           CLMS-FILE-ID,
 10626           DFHEIV99
 10627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10628
 10629     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10630     MOVE 'X'                    TO ERROR-SWITCH.
 10631
 10632 2010-EXIT.
 10633     EXIT.
 10634
 10635 2020-NORMAL-UPDATE.
 10636     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10637
 10638     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10639
 10640     IF WS-OPEN-CLOSE-SW = 'Y'
 10641       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10642       IF PI-REC-FOUND-SW = 'Y'
 10643         IF CL-ACTIVITY-CODE = 09
 10644           NEXT SENTENCE
 10645         ELSE
 10646           IF WS-RESET-SW = 'Y'
 10647             IF CL-CLAIM-STATUS = 'C'
 10648               MOVE 07               TO  CL-ACTIVITY-CODE
 10649               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10650               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
 10651             ELSE
 10652               MOVE 08               TO  CL-ACTIVITY-CODE
 10653               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10654               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
 10655
 10656     IF PI-COMPANY-ID = 'CID' or 'AHL'
 10657         MOVE 'Y'                TO CL-YESNOSW
 10658     END-IF.
 10659
 10660     if pi-company-id = 'DCC' OR 'VPP'
 10661        perform 1620-VERIFY-ACCT THRU 1620-EXIT
 10662        perform 2120-check-pdef  thru 2120-exit
 10663     end-if
 10664     if ((benperl <> zeros)
 10665        and (benperi numeric))
 10666                  or
 10667            (instypel <> zeros)
 10668        perform 2140-update-elcrtt thru 2140-exit
 10669     end-if
 10670
 10671* EXEC CICS HANDLE CONDITION
 10672*         DUPKEY   (2020-EXIT)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 196
* EL131.cbl
 10673*    END-EXEC.
 10674*    MOVE '"$$                   ! , #00009889' TO DFHEIV0
 10675     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10676     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10677     MOVE X'2C20233030303039383839' TO DFHEIV0(25:11)
 10678     CALL 'kxdfhei1' USING DFHEIV0
 10679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10680
 10681
 10682
 10683* EXEC CICS REWRITE
 10684*         DATASET   (CLMS-FILE-ID)
 10685*         FROM      (CLAIM-MASTER)
 10686*    END-EXEC.
 10687     MOVE LENGTH OF
 10688      CLAIM-MASTER
 10689       TO DFHEIV11
 10690*    MOVE '&& L                  %   #00009893' TO DFHEIV0
 10691     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10692     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10693     MOVE X'2020233030303039383933' TO DFHEIV0(25:11)
 10694     CALL 'kxdfhei1' USING DFHEIV0,
 10695           CLMS-FILE-ID,
 10696           CLAIM-MASTER,
 10697           DFHEIV11,
 10698           DFHEIV99
 10699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10700
 10701
 10702 2020-EXIT.
 10703     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 197
* EL131.cbl
 10705 2030-KEY-UPDATE.
 10706     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
 10707
 10708
 10709* EXEC CICS DELETE
 10710*        DATASET  (CLMS-FILE-ID)
 10711*    END-EXEC.
 10712*    MOVE '&(                    &   #00009904' TO DFHEIV0
 10713     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10714     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10715     MOVE X'2020233030303039393034' TO DFHEIV0(25:11)
 10716     CALL 'kxdfhei1' USING DFHEIV0,
 10717           CLMS-FILE-ID,
 10718           DFHEIV99,
 10719           DFHEIV99,
 10720           DFHEIV99,
 10721           DFHEIV99
 10722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10723
 10724
 10725
 10726* EXEC CICS GETMAIN
 10727*         SET      (ADDRESS OF CLAIM-MASTER)
 10728*         LENGTH   (MSTR-LENGTH)
 10729*         INITIMG  (GETMAIN-SPACE)
 10730*    END-EXEC.
 10731*    MOVE ',"IL                  $   #00009908' TO DFHEIV0
 10732     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10733     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10734     MOVE X'2020233030303039393038' TO DFHEIV0(25:11)
 10735     CALL 'kxdfhei1' USING DFHEIV0,
 10736           DFHEIV20,
 10737           MSTR-LENGTH,
 10738           GETMAIN-SPACE
 10739     SET ADDRESS OF CLAIM-MASTER TO
 10740         DFHEIV20
 10741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10742
 10743
 10744     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
 10745
 10746     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10747
 10748     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10749
 10750     IF WS-OPEN-CLOSE-SW = 'Y'
 10751       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10752         IF PI-REC-FOUND-SW = 'Y'
 10753           IF CL-ACTIVITY-CODE = 09
 10754             NEXT SENTENCE
 10755           ELSE
 10756             IF WS-RESET-SW = 'Y'
 10757               IF CL-CLAIM-STATUS = 'C'
 10758                 MOVE 07             TO  CL-ACTIVITY-CODE
 10759                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10760                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
 10761               ELSE
 10762                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 198
* EL131.cbl
 10763                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10764                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
 10765
 10766
 10767* EXEC CICS HANDLE CONDITION
 10768*         DUPKEY    (2030-EXIT)
 10769*    END-EXEC.
 10770*    MOVE '"$$                   ! - #00009936' TO DFHEIV0
 10771     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10772     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10773     MOVE X'2D20233030303039393336' TO DFHEIV0(25:11)
 10774     CALL 'kxdfhei1' USING DFHEIV0
 10775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10776
 10777
 10778** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10779*    MOVE CL-CERT-NO             TO CL-CCN-A5.
 10780
 10781     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 10782         MOVE 'Y'                TO CL-YESNOSW
 10783     END-IF.
 10784
 10785
 10786* EXEC CICS WRITE
 10787*         DATASET   (CLMS-FILE-ID)
 10788*         RIDFLD    (MSTR-KEY)
 10789*         FROM      (CLAIM-MASTER)
 10790*    END-EXEC.
 10791     MOVE LENGTH OF
 10792      CLAIM-MASTER
 10793       TO DFHEIV11
 10794*    MOVE '&$ L                  ''   #00009947' TO DFHEIV0
 10795     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10796     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10797     MOVE X'2020233030303039393437' TO DFHEIV0(25:11)
 10798     CALL 'kxdfhei1' USING DFHEIV0,
 10799           CLMS-FILE-ID,
 10800           CLAIM-MASTER,
 10801           DFHEIV11,
 10802           MSTR-KEY,
 10803           DFHEIV99,
 10804           DFHEIV99
 10805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10806
 10807
 10808 2030-EXIT.
 10809     EXIT.
 10810
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 199
* EL131.cbl
 10812 2040-NORMAL-UPDATE.
 10813
 10814* EXEC CICS READ UPDATE
 10815*         DATASET  (CERT-FILE-ID)
 10816*         RIDFLD   (CERT-KEY)
 10817*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10818*    END-EXEC.
 10819*    MOVE '&"S        EU         (   #00009958' TO DFHEIV0
 10820     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10821     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10822     MOVE X'2020233030303039393538' TO DFHEIV0(25:11)
 10823     CALL 'kxdfhei1' USING DFHEIV0,
 10824           CERT-FILE-ID,
 10825           DFHEIV20,
 10826           DFHEIV99,
 10827           CERT-KEY,
 10828           DFHEIV99,
 10829           DFHEIV99,
 10830           DFHEIV99
 10831     SET ADDRESS OF CERTIFICATE-MASTER TO
 10832         DFHEIV20
 10833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10834
 10835
 10836     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10837
 10838
 10839* EXEC CICS HANDLE CONDITION
 10840*         DUPKEY   (2040-EXIT)
 10841*    END-EXEC.
 10842*    MOVE '"$$                   ! . #00009966' TO DFHEIV0
 10843     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10844     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10845     MOVE X'2E20233030303039393636' TO DFHEIV0(25:11)
 10846     CALL 'kxdfhei1' USING DFHEIV0
 10847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10848
 10849
 10850
 10851* EXEC CICS REWRITE
 10852*         DATASET  (CERT-FILE-ID)
 10853*         FROM     (CERTIFICATE-MASTER)
 10854*    END-EXEC.
 10855     MOVE LENGTH OF
 10856      CERTIFICATE-MASTER
 10857       TO DFHEIV11
 10858*    MOVE '&& L                  %   #00009970' TO DFHEIV0
 10859     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10860     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10861     MOVE X'2020233030303039393730' TO DFHEIV0(25:11)
 10862     CALL 'kxdfhei1' USING DFHEIV0,
 10863           CERT-FILE-ID,
 10864           CERTIFICATE-MASTER,
 10865           DFHEIV11,
 10866           DFHEIV99
 10867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10868
 10869
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 200
* EL131.cbl
 10870 2040-EXIT.
 10871     EXIT.
 10872
 10873 2050-KEY-UPDATE.
 10874
 10875* EXEC CICS READ UPDATE
 10876*         DATASET  (CERT-FILE-ID)
 10877*         RIDFLD   (CERT-KEY)
 10878*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10879*    END-EXEC.
 10880*    MOVE '&"S        EU         (   #00009979' TO DFHEIV0
 10881     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10882     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10883     MOVE X'2020233030303039393739' TO DFHEIV0(25:11)
 10884     CALL 'kxdfhei1' USING DFHEIV0,
 10885           CERT-FILE-ID,
 10886           DFHEIV20,
 10887           DFHEIV99,
 10888           CERT-KEY,
 10889           DFHEIV99,
 10890           DFHEIV99,
 10891           DFHEIV99
 10892     SET ADDRESS OF CERTIFICATE-MASTER TO
 10893         DFHEIV20
 10894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10895
 10896
 10897     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 10898
 10899
 10900* EXEC CICS DELETE
 10901*         DATASET   (CERT-FILE-ID)
 10902*    END-EXEC.
 10903*    MOVE '&(                    &   #00009987' TO DFHEIV0
 10904     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10905     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10906     MOVE X'2020233030303039393837' TO DFHEIV0(25:11)
 10907     CALL 'kxdfhei1' USING DFHEIV0,
 10908           CERT-FILE-ID,
 10909           DFHEIV99,
 10910           DFHEIV99,
 10911           DFHEIV99,
 10912           DFHEIV99
 10913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10914
 10915
 10916
 10917* EXEC CICS GETMAIN
 10918*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10919*         LENGTH    (CERT-LENGTH)
 10920*         INITIMG   (GETMAIN-SPACE)
 10921*    END-EXEC.
 10922*    MOVE ',"IL                  $   #00009991' TO DFHEIV0
 10923     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10924     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10925     MOVE X'2020233030303039393931' TO DFHEIV0(25:11)
 10926     CALL 'kxdfhei1' USING DFHEIV0,
 10927           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 201
* EL131.cbl
 10928           CERT-LENGTH,
 10929           GETMAIN-SPACE
 10930     SET ADDRESS OF CERTIFICATE-MASTER TO
 10931         DFHEIV20
 10932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10933
 10934
 10935     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
 10936
 10937     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10938
 10939
 10940* EXEC CICS HANDLE CONDITION
 10941*         DUPKEY (2050-EXIT)
 10942*    END-EXEC.
 10943*    MOVE '"$$                   ! / #00010001' TO DFHEIV0
 10944     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10945     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10946     MOVE X'2F20233030303130303031' TO DFHEIV0(25:11)
 10947     CALL 'kxdfhei1' USING DFHEIV0
 10948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10949
 10950
 10951
 10952* EXEC CICS WRITE
 10953*         DATASET  (CERT-FILE-ID)
 10954*         RIDFLD   (CERT-KEY)
 10955*         FROM     (CERTIFICATE-MASTER)
 10956*    END-EXEC.
 10957     MOVE LENGTH OF
 10958      CERTIFICATE-MASTER
 10959       TO DFHEIV11
 10960*    MOVE '&$ L                  ''   #00010005' TO DFHEIV0
 10961     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10962     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10963     MOVE X'2020233030303130303035' TO DFHEIV0(25:11)
 10964     CALL 'kxdfhei1' USING DFHEIV0,
 10965           CERT-FILE-ID,
 10966           CERTIFICATE-MASTER,
 10967           DFHEIV11,
 10968           CERT-KEY,
 10969           DFHEIV99,
 10970           DFHEIV99
 10971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10972
 10973
 10974 2050-EXIT.
 10975     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 202
* EL131.cbl
 10977 2060-CHANGE-CERT.
 10978     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10979     MOVE PI-CARRIER             TO CERT-CARRIER.
 10980     MOVE PI-GROUPING            TO CERT-GROUP.
 10981     MOVE PI-STATE               TO CERT-STATE.
 10982     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10983     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10984     MOVE PI-CERT-NO             TO CERT-CERT.
 10985     IF CERTEFFI GREATER THAN LOW-VALUES
 10986         MOVE HOLD-EFF           TO CERT-DATE.
 10987     IF CERTACTI GREATER THAN LOW-VALUES
 10988         MOVE CERTACTI           TO CERT-ACCOUNT.
 10989     IF CERTSTI GREATER THAN LOW-VALUES
 10990         MOVE CERTSTI            TO CERT-STATE.
 10991     IF CERTCARI GREATER THAN LOW-VALUES
 10992         MOVE CERTCARI           TO CERT-CARRIER.
 10993     IF CERTGRPI GREATER THAN LOW-VALUES
 10994         MOVE CERTGRPI           TO CERT-GROUP.
 10995     IF CERTI GREATER THAN LOW-VALUES
 10996         MOVE CERTI              TO CERT-CERT-PRIME.
 10997     IF SUFXI GREATER THAN LOW-VALUES
 10998         MOVE SUFXI              TO CERT-CERT-SUFX.
 10999
 11000
 11001* EXEC CICS HANDLE CONDITION
 11002*         NOTFND   (2060-CERT-NOTFND)
 11003*    END-EXEC.
 11004*    MOVE '"$I                   ! 0 #00010037' TO DFHEIV0
 11005     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11006     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11007     MOVE X'3020233030303130303337' TO DFHEIV0(25:11)
 11008     CALL 'kxdfhei1' USING DFHEIV0
 11009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11010
 11011
 11012
 11013* EXEC CICS READ UPDATE
 11014*         DATASET  (CERT-FILE-ID)
 11015*         RIDFLD   (CERT-KEY)
 11016*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11017*    END-EXEC.
 11018*    MOVE '&"S        EU         (   #00010041' TO DFHEIV0
 11019     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11020     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11021     MOVE X'2020233030303130303431' TO DFHEIV0(25:11)
 11022     CALL 'kxdfhei1' USING DFHEIV0,
 11023           CERT-FILE-ID,
 11024           DFHEIV20,
 11025           DFHEIV99,
 11026           CERT-KEY,
 11027           DFHEIV99,
 11028           DFHEIV99,
 11029           DFHEIV99
 11030     SET ADDRESS OF CERTIFICATE-MASTER TO
 11031         DFHEIV20
 11032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11033
 11034
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 203
* EL131.cbl
 11035     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
 11036
 11037     IF CM-CLAIM-INTERFACE-SW = SPACES
 11038        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 11039
 11040
 11041* EXEC CICS HANDLE CONDITION
 11042*         DUPKEY   (2060-DUPKEY)
 11043*    END-EXEC.
 11044*    MOVE '"$$                   ! 1 #00010052' TO DFHEIV0
 11045     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11046     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11047     MOVE X'3120233030303130303532' TO DFHEIV0(25:11)
 11048     CALL 'kxdfhei1' USING DFHEIV0
 11049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11050
 11051
 11052
 11053* EXEC CICS REWRITE
 11054*         DATASET  (CERT-FILE-ID)
 11055*         FROM     (CERTIFICATE-MASTER)
 11056*    END-EXEC.
 11057     MOVE LENGTH OF
 11058      CERTIFICATE-MASTER
 11059       TO DFHEIV11
 11060*    MOVE '&& L                  %   #00010056' TO DFHEIV0
 11061     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11062     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11063     MOVE X'2020233030303130303536' TO DFHEIV0(25:11)
 11064     CALL 'kxdfhei1' USING DFHEIV0,
 11065           CERT-FILE-ID,
 11066           CERTIFICATE-MASTER,
 11067           DFHEIV11,
 11068           DFHEIV99
 11069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11070
 11071
 11072 2060-DUPKEY.
 11073
 11074     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11075
 11076 2060-CHANGE-TRLR-ACTQ.
 11077     IF SCREEN-ERROR
 11078         GO TO 2060-EXIT.
 11079
 11080     IF CERTI    GREATER LOW-VALUES OR
 11081        SUFXI    GREATER LOW-VALUES OR
 11082        CERTCARI GREATER LOW-VALUES
 11083         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 11084         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 11085
 11086     MOVE SPACES                 TO CERT-KEY-SWITCH
 11087                                    CERT-SWITCH
 11088                                    TRLR-SWITCH
 11089                                    NINETY-TRLR-SWITCH.
 11090     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 11091     GO TO 2060-EXIT.
 11092
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 204
* EL131.cbl
 11093 2060-CERT-NOTFND.
 11094     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11095
 11096     IF WS-REC-FOUND-SW = 'N'
 11097         MOVE ER-0206            TO  EMI-ERROR
 11098         MOVE -1                 TO  MAINTL
 11099         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11100
 11101* EXEC CICS UNLOCK
 11102*            DATASET   (CLMS-FILE-ID)
 11103*        END-EXEC
 11104*    MOVE '&*                    #   #00010089' TO DFHEIV0
 11105     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11106     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11107     MOVE X'2020233030303130303839' TO DFHEIV0(25:11)
 11108     CALL 'kxdfhei1' USING DFHEIV0,
 11109           CLMS-FILE-ID,
 11110           DFHEIV99
 11111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11112         GO TO 8110-SEND-DATA.
 11113
 11114     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 11115
 11116     GO TO 2060-CHANGE-TRLR-ACTQ.
 11117
 11118 2060-EXIT.
 11119     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 205
* EL131.cbl
 11121 2070-CHECK-OLD.
 11122
 11123
 11124* EXEC CICS HANDLE CONDITION
 11125*        NOTFND   (2070-NOT-FOUND)
 11126*    END-EXEC.
 11127*    MOVE '"$I                   ! 2 #00010103' TO DFHEIV0
 11128     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11129     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11130     MOVE X'3220233030303130313033' TO DFHEIV0(25:11)
 11131     CALL 'kxdfhei1' USING DFHEIV0
 11132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11133
 11134
 11135     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 11136     MOVE PI-CARRIER             TO CERT-CARRIER.
 11137     MOVE PI-GROUPING            TO CERT-GROUP.
 11138     MOVE PI-STATE               TO CERT-STATE.
 11139     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 11140     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 11141     MOVE PI-CERT-NO             TO CERT-CERT.
 11142
 11143
 11144* EXEC CICS READ UPDATE
 11145*         DATASET  (CERT-FILE-ID)
 11146*         RIDFLD   (CERT-KEY)
 11147*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11148*    END-EXEC.
 11149*    MOVE '&"S        EU         (   #00010115' TO DFHEIV0
 11150     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11151     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11152     MOVE X'2020233030303130313135' TO DFHEIV0(25:11)
 11153     CALL 'kxdfhei1' USING DFHEIV0,
 11154           CERT-FILE-ID,
 11155           DFHEIV20,
 11156           DFHEIV99,
 11157           CERT-KEY,
 11158           DFHEIV99,
 11159           DFHEIV99,
 11160           DFHEIV99
 11161     SET ADDRESS OF CERTIFICATE-MASTER TO
 11162         DFHEIV20
 11163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11164
 11165
 11166     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 11167     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 11168     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 11169
 11170     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 11171         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 11172
 11173     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11174       AND
 11175        CERT-WAS-CREATED-FOR-CLAIM
 11176         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 11177
 11178* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 206
* EL131.cbl
 11179*             DATASET   (CERT-FILE-ID)
 11180*        END-EXEC
 11181*    MOVE '&(                    &   #00010132' TO DFHEIV0
 11182     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11183     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11184     MOVE X'2020233030303130313332' TO DFHEIV0(25:11)
 11185     CALL 'kxdfhei1' USING DFHEIV0,
 11186           CERT-FILE-ID,
 11187           DFHEIV99,
 11188           DFHEIV99,
 11189           DFHEIV99,
 11190           DFHEIV99
 11191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11192         GO TO 2070-EXIT.
 11193
 11194     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11195         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 11196
 11197
 11198* EXEC CICS HANDLE CONDITION
 11199*         DUPKEY   (2070-EXIT)
 11200*    END-EXEC.
 11201*    MOVE '"$$                   ! 3 #00010140' TO DFHEIV0
 11202     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11203     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11204     MOVE X'3320233030303130313430' TO DFHEIV0(25:11)
 11205     CALL 'kxdfhei1' USING DFHEIV0
 11206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11207
 11208
 11209
 11210* EXEC CICS REWRITE
 11211*         DATASET  (CERT-FILE-ID)
 11212*         FROM     (CERTIFICATE-MASTER)
 11213*    END-EXEC.
 11214     MOVE LENGTH OF
 11215      CERTIFICATE-MASTER
 11216       TO DFHEIV11
 11217*    MOVE '&& L                  %   #00010144' TO DFHEIV0
 11218     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11219     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11220     MOVE X'2020233030303130313434' TO DFHEIV0(25:11)
 11221     CALL 'kxdfhei1' USING DFHEIV0,
 11222           CERT-FILE-ID,
 11223           CERTIFICATE-MASTER,
 11224           DFHEIV11,
 11225           DFHEIV99
 11226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11227
 11228
 11229     GO TO 2070-EXIT.
 11230
 11231 2070-NOT-FOUND.
 11232     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 11233
 11234 2070-EXIT.
 11235     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 207
* EL131.cbl
 11237 2080-CREATE-CERT.
 11238
 11239* EXEC CICS GETMAIN
 11240*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 11241*         LENGTH    (CERT-LENGTH)
 11242*         INITIMG   (GETMAIN-SPACE)
 11243*    END-EXEC.
 11244*    MOVE ',"IL                  $   #00010158' TO DFHEIV0
 11245     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11246     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11247     MOVE X'2020233030303130313538' TO DFHEIV0(25:11)
 11248     CALL 'kxdfhei1' USING DFHEIV0,
 11249           DFHEIV20,
 11250           CERT-LENGTH,
 11251           GETMAIN-SPACE
 11252     SET ADDRESS OF CERTIFICATE-MASTER TO
 11253         DFHEIV20
 11254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11255
 11256
 11257     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 11258
 11259     IF CERTEFFI GREATER THAN LOW-VALUES
 11260         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 11261                                    DC-BIN-DATE-1
 11262         MOVE '6'                TO DC-OPTION-CODE
 11263         MOVE +1                 TO DC-ELAPSED-MONTHS
 11264         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11265         IF NO-CONVERSION-ERROR
 11266             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 11267
 11268     IF CERTACTI GREATER THAN LOW-VALUES
 11269         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 11270     IF CERTSTI GREATER THAN LOW-VALUES
 11271         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 11272     IF CERTCARI GREATER THAN LOW-VALUES
 11273         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 11274     IF CERTGRPI GREATER THAN LOW-VALUES
 11275         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 11276     IF CERTI GREATER THAN LOW-VALUES
 11277         MOVE CERTI              TO CERT-CERT-PRIME
 11278                                    CM-CERT-PRIME
 11279         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11280
 11281     IF SUFXI GREATER THAN LOW-VALUES
 11282         MOVE SUFXI              TO CERT-CERT-SUFX
 11283                                    CM-CERT-SFX
 11284         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11285
 11286     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 11287
 11288     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 11289
 11290     MOVE SPACES                 TO CM-ENTRY-BATCH
 11291                                    CM-LF-EXIT-BATCH
 11292                                    CM-AH-EXIT-BATCH
 11293                                    CM-CREDIT-INTERFACE-SW-1
 11294                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 208
* EL131.cbl
 11295
 11296     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11297                               '9' OR 'D' OR 'V'
 11298         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11299
 11300     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11301                               '9' OR 'D' OR 'V'
 11302         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11303
 11304     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 11305                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 11306     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 11307
 11308
 11309* EXEC CICS HANDLE CONDITION
 11310*         DUPKEY (2080-EXIT)
 11311*    END-EXEC.
 11312*    MOVE '"$$                   ! 4 #00010215' TO DFHEIV0
 11313     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11314     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11315     MOVE X'3420233030303130323135' TO DFHEIV0(25:11)
 11316     CALL 'kxdfhei1' USING DFHEIV0
 11317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11318
 11319
 11320
 11321* EXEC CICS WRITE
 11322*         DATASET  (CERT-FILE-ID)
 11323*         RIDFLD   (CERT-KEY)
 11324*         FROM     (CERTIFICATE-MASTER)
 11325*    END-EXEC.
 11326     MOVE LENGTH OF
 11327      CERTIFICATE-MASTER
 11328       TO DFHEIV11
 11329*    MOVE '&$ L                  ''   #00010219' TO DFHEIV0
 11330     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11331     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11332     MOVE X'2020233030303130323139' TO DFHEIV0(25:11)
 11333     CALL 'kxdfhei1' USING DFHEIV0,
 11334           CERT-FILE-ID,
 11335           CERTIFICATE-MASTER,
 11336           DFHEIV11,
 11337           CERT-KEY,
 11338           DFHEIV99,
 11339           DFHEIV99
 11340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11341
 11342
 11343 2080-EXIT.
 11344     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 209
* EL131.cbl
 11346 2100-MOVE-MSTR.
 11347     IF TYPEI GREATER THAN LOW-VALUES
 11348         MOVE TYPEI              TO CL-CLAIM-TYPE.
 11349
 11350     IF STATUSI = LOW-VALUES
 11351         GO TO 2100-NO-STATUS-CHANGE.
 11352
 11353     IF STATUSI = 'OPEN' OR 'O'
 11354         IF CL-CLAIM-STATUS = 'O'
 11355             MOVE SPACES         TO TRLR-SWITCH
 11356                 GO TO 2100-NO-STATUS-CHANGE.
 11357
 11358     IF STATUSI = 'CLOSED' OR 'C'
 11359         IF CL-CLAIM-STATUS = 'C'
 11360             MOVE SPACES         TO TRLR-SWITCH
 11361                 GO TO 2100-NO-STATUS-CHANGE.
 11362
 11363     IF PI-COMPANY-ID = 'DMD'
 11364        IF STATUSI = 'OPEN' OR 'O'
 11365           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 11366              MOVE ZERO       TO STATUSL
 11367              MOVE LOW-VALUES TO STATUSI
 11368              GO TO 2100-NO-STATUS-CHANGE.
 11369
 11370     IF PI-COMPANY-ID = 'DMD'
 11371         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 11372
 11373     MOVE STATUSI                TO CL-CLAIM-STATUS.
 11374
 11375 2100-NO-STATUS-CHANGE.
 11376
 11377     IF CCNOI GREATER THAN LOW-VALUES
 11378         MOVE CCNOI              TO CL-CCN.
 11379
 11380     IF PROCI GREATER THAN LOW-VALUES
 11381         MOVE PROCI              TO CL-PROCESSOR-ID.
 11382
 11383     if (accswi > low-values)
 11384        and (accswi = 'Y' OR 'N')
 11385        move accswi              to cl-accident-claim-sw
 11386     end-if
 11387     if benperi > low-values
 11388        and benperi numeric
 11389        move benperi             to cl-benefit-period
 11390     end-if
 11391     if instypei > low-values
 11392        move instypei            to cl-insured-type
 11393     end-if
 11394     IF SEXI GREATER THAN LOW-VALUES
 11395         MOVE SEXI               TO CL-INSURED-SEX-CD.
 11396
 11397     IF BIRTHI GREATER THAN LOW-VALUES
 11398         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 11399
 11400     IF SOCIALI GREATER THAN LOW-VALUES
 11401       AND
 11402        SOCIALI = SPACES
 11403         MOVE CL-CERT-STATE      TO CL-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 210
* EL131.cbl
 11404         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 11405         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 11406     ELSE
 11407         IF SOCIALI GREATER THAN LOW-VALUES
 11408             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 11409
 11410     IF OCCI GREATER THAN LOW-VALUES
 11411         MOVE OCCI               TO CL-INSURED-OCC-CD.
 11412
 11413     IF BENEL GREATER THAN ZERO
 11414         MOVE BENEI              TO CL-BENEFICIARY.
 11415
 11416     IF DIAGI GREATER THAN LOW-VALUES
 11417         MOVE DIAGI              TO WS-DIAGNOSIS.
 11418
 11419     IF ICD1I GREATER THAN LOW-VALUES
 11420         MOVE ICD1I              TO WS-ICD-CODE-1
 11421     END-IF.
 11422
 11423     IF ICD2I GREATER THAN LOW-VALUES
 11424         MOVE ICD2I              TO WS-ICD-CODE-2
 11425     END-IF.
 11426
 11427     IF PREMTYPI GREATER THAN LOW-VALUES
 11428         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 11429
 11430*    IF CAUSEI GREATER THAN LOW-VALUES
 11431*        MOVE CAUSEI             TO CL-CAUSE-CD.
 11432
 11433*    IF ENDI GREATER THAN LOW-VALUES
 11434*        MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 11435
 11436     IF PDTHRUI GREATER THAN LOW-VALUES
 11437        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 11438
 11439     IF PDAMTL GREATER THAN +0
 11440        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 11441
 11442     IF NODAYSI GREATER THAN LOW-VALUES
 11443        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 11444
 11445     IF NOPMTSI GREATER THAN LOW-VALUES
 11446        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 11447
 11448     IF FORMTYPI GREATER THAN LOW-VALUES
 11449        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 11450
 11451     IF INCI GREATER THAN LOW-VALUES
 11452        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 11453
 11454     IF REPI GREATER THAN LOW-VALUES
 11455        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 11456
 11457     IF ADDONDTI GREATER THAN LOW-VALUES
 11458        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 11459
 11460     IF PRICDI GREATER THAN LOW-VALUES
 11461         MOVE PRICDI             TO CL-PRIORITY-CD.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 211
* EL131.cbl
 11462
 11463     IF CRITPL  > ZEROS
 11464        MOVE CRITPI              TO CL-CRITICAL-PERIOD
 11465     END-IF
 11466
 11467     IF EXTENSL  > ZEROS
 11468        MOVE EXTENSI             TO CL-NO-OF-EXTENSIONS
 11469     END-IF
 11470*    IF CRITPTL > ZEROS
 11471*       MOVE CRITPTI             TO CL-CRIT-PER-RECURRENT
 11472*    END-IF
 11473
 11474*    IF RTWMOSL > ZEROS
 11475*       MOVE RTWMOSI             TO CL-CRIT-PER-RTW-MOS
 11476*    END-IF
 11477     IF FILETOI GREATER THAN LOW-VALUES
 11478         MOVE FILETOI            TO CL-FILE-LOCATION.
 11479
 11480     IF SUPVI GREATER THAN LOW-VALUES
 11481         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 11482
 11483     IF MLNAMEI GREATER THAN LOW-VALUES
 11484         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 11485
 11486     IF MFNAMEI GREATER THAN LOW-VALUES
 11487         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 11488
 11489     IF MMINITI GREATER THAN LOW-VALUES
 11490         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 11491
 11492     IF CERTEFFI GREATER THAN LOW-VALUES
 11493         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 11494
 11495     IF CERTACTI GREATER THAN LOW-VALUES
 11496         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 11497
 11498     IF CERTSTI GREATER THAN LOW-VALUES
 11499         MOVE CERTSTI            TO CL-CERT-STATE.
 11500
 11501     IF CERTCARI GREATER THAN LOW-VALUES
 11502         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 11503                                    CL-CARRIER.
 11504
 11505     IF CERTGRPI GREATER THAN LOW-VALUES
 11506         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 11507
 11508     IF CERTI GREATER THAN LOW-VALUES
 11509         MOVE CERTI              TO CERT-NO-PRIME.
 11510
 11511     IF SUFXI GREATER THAN LOW-VALUES
 11512         MOVE SUFXI              TO CERT-NO-SUFX.
 11513
 11514     MOVE CERT-NO                TO CL-CERT-NO
 11515                                    CL-CERT-NO-A4.
 11516
 11517     IF PI-COMPANY-ID = 'FLA'
 11518          NEXT SENTENCE
 11519     ELSE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 212
* EL131.cbl
 11520         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 11521         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 11522         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
 11523         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 11524
 11525     IF TRLR-UPDATE-REQUIRED
 11526        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 11527        MOVE ZEROS              TO TRLR-SEQ-NO
 11528
 11529* EXEC CICS READ
 11530*            DATASET   (TRLR-FILE-ID)
 11531*            RIDFLD    (TRLR-KEY)
 11532*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11533*       END-EXEC
 11534*    MOVE '&"S        E          (   #00010410' TO DFHEIV0
 11535     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11536     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11537     MOVE X'2020233030303130343130' TO DFHEIV0(25:11)
 11538     CALL 'kxdfhei1' USING DFHEIV0,
 11539           TRLR-FILE-ID,
 11540           DFHEIV20,
 11541           DFHEIV99,
 11542           TRLR-KEY,
 11543           DFHEIV99,
 11544           DFHEIV99,
 11545           DFHEIV99
 11546     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11547         DFHEIV20
 11548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11549        IF AT-TRAILER-TYPE = '1'
 11550           MOVE +1 TO MISC-SUB
 11551           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 11552           MISC-SUB GREATER THAN +6 OR
 11553           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 11554           IF MISC-SUB GREATER THAN +1
 11555              SUBTRACT +1 FROM MISC-SUB
 11556              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11557                 GO TO 2100-BYPASS-LAST-UPDATE.
 11558
 11559     IF TRLR-UPDATE-REQUIRED AND
 11560        CLAIM-IS-OPEN
 11561         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 11562     ELSE
 11563         IF TRLR-UPDATE-REQUIRED AND
 11564            CLAIM-IS-CLOSED
 11565             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 11566             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 11567
 11568 2100-BYPASS-LAST-UPDATE.
 11569     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 11570     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 11571
 11572     GO TO 2100-EXIT.
 11573
 11574 2100-BUMP-OPEN-CLOSE-HIST.
 11575     ADD +1                      TO MISC-SUB.
 11576
 11577 2100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 213
* EL131.cbl
 11578     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 214
* EL131.cbl
 11580 2120-check-pdef.
 11581     move +0                     to s1
 11582     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
 11583     move spaces                 to ws-dcc-error-line
 11584     PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
 11585     IF ERPDEF-FOUND
 11586        perform 2130-check-trlr  thru 2130-exit
 11587        move +1                  to s1
 11588*       if cl-accident-claim-sw = ' '
 11589*          move er-1655             to ws-error-no (s1)
 11590*          add +1 to s1
 11591*       end-if
 11592        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
 11593        MOVE cl-incurred-dt      TO DC-BIN-DATE-2
 11594        if (hold-incur > low-values)
 11595           and (incl > zeros)
 11596           and (hold-incur not = cl-incurred-dt)
 11597           move hold-incur       to dc-bin-date-2
 11598        end-if
 11599        MOVE '1'                 TO DC-OPTION-CODE
 11600        MOVE +0                  TO DC-ELAPSED-MONTHS
 11601                                    DC-ELAPSED-DAYS
 11602        PERFORM 9800-CONVERT-DATE
 11603                                 THRU 9800-EXIT
 11604        IF NO-CONVERSION-ERROR
 11605           MOVE DC-ELAPSED-MONTHS
 11606                                 TO WS-MONTHS-BETWEEN
 11607           IF DC-ELAPSED-DAYS > 1
 11608              ADD 1 TO WS-MONTHS-BETWEEN
 11609           END-IF
 11610        ELSE
 11611           display ' dte conv error ' dc-error-code
 11612           MOVE ZEROS            TO WS-MONTHS-BETWEEN
 11613        END-IF
 11614        IF (WS-EXCL-PERIOD = ZEROS)
 11615           OR (WS-MONTHS-BETWEEN = ZEROS)
 11616           CONTINUE
 11617        ELSE
 11618           IF WS-MONTHS-BETWEEN  <= WS-EXCL-PERIOD
 11619              MOVE ER-1651       TO ws-error-no (s1)
 11620              add +1             to s1
 11621           END-IF
 11622        END-IF
 11623        IF (WS-COV-ENDS = ZEROS)
 11624           OR (WS-MONTHS-BETWEEN = ZEROS)
 11625           CONTINUE
 11626        ELSE
 11627           IF WS-MONTHS-BETWEEN > WS-COV-ENDS
 11628              MOVE -1            TO MAINTL
 11629              MOVE ER-1653       TO ws-error-no (s1)
 11630              add +1 to s1
 11631           END-IF
 11632        END-IF
 11633        IF (WS-ACC-PERIOD = ZEROS)
 11634           OR (WS-MONTHS-BETWEEN = ZEROS)
 11635           CONTINUE
 11636        ELSE
 11637           IF (WS-MONTHS-BETWEEN <= WS-ACC-PERIOD)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 215
* EL131.cbl
 11638              and (accswi = spaces or low-values)
 11639*             and (cl-accident-claim-sw = ' ')
 11640              move er-1655       to ws-error-no (s1)
 11641              add +1             to s1
 11642           end-if
 11643           IF WS-MONTHS-BETWEEN <= WS-ACC-PERIOD
 11644*             if (cl-accident-claim-sw not = 'Y')
 11645              if (accswi not = 'Y')
 11646                 MOVE ER-1652    TO ws-error-no (s1)
 11647              else
 11648                 move er-1662    to ws-error-no (s1)
 11649              end-if
 11650              MOVE -1            TO MAINTL
 11651              add +1             to s1
 11652           END-IF
 11653        END-IF
 11654        if cl-claim-type  = 'I'
 11655           move er-1661          to ws-error-no (s1)
 11656           add +1                to s1
 11657        end-if
 11658        perform 2130-check-trlr  thru 2130-exit
 11659     END-IF
 11660
 11661     .
 11662 2120-exit.
 11663     exit.
 11664
 11665 2130-check-trlr.
 11666
 11667     evaluate true
 11668        when s1 = +0
 11669           move cl-control-primary
 11670                                 to trlr-key
 11671           MOVE +95              TO TRLR-SEQ-NO
 11672
 11673* EXEC CICS READ
 11674*             update
 11675*             DATASET  ('ELTRLR')
 11676*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11677*             RIDFLD   (TRLR-KEY)
 11678*             RESP     (WS-RESPONSE)
 11679*          END-EXEC
 11680     MOVE 'ELTRLR' TO DFHEIV1
 11681*    MOVE '&"S        EU         (  N#00010538' TO DFHEIV0
 11682     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11683     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11684     MOVE X'204E233030303130353338' TO DFHEIV0(25:11)
 11685     CALL 'kxdfhei1' USING DFHEIV0,
 11686           DFHEIV1,
 11687           DFHEIV20,
 11688           DFHEIV99,
 11689           TRLR-KEY,
 11690           DFHEIV99,
 11691           DFHEIV99,
 11692           DFHEIV99
 11693     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11694         DFHEIV20
 11695     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 216
* EL131.cbl
 11696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11697           if ws-resp-normal
 11698              move spaces        to at-info-line-1
 11699           end-if
 11700        when s1 = +1
 11701           if ws-resp-normal
 11702
 11703* exec cics rewrite
 11704*                dataset   ('ELTRLR')
 11705*                from      (activity-trailers)
 11706*             end-exec
 11707     MOVE LENGTH OF
 11708      activity-trailers
 11709       TO DFHEIV11
 11710     MOVE 'ELTRLR' TO DFHEIV1
 11711*    MOVE '&& L                  %   #00010550' TO DFHEIV0
 11712     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11713     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11714     MOVE X'2020233030303130353530' TO DFHEIV0(25:11)
 11715     CALL 'kxdfhei1' USING DFHEIV0,
 11716           DFHEIV1,
 11717           activity-trailers,
 11718           DFHEIV11,
 11719           DFHEIV99
 11720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11721           end-if
 11722        when s1 > +1
 11723           if ws-resp-normal
 11724              move ws-dcc-error-line
 11725                                 to at-info-line-1
 11726
 11727* exec cics rewrite
 11728*                dataset   ('ELTRLR')
 11729*                from      (activity-trailers)
 11730*             end-exec
 11731     MOVE LENGTH OF
 11732      activity-trailers
 11733       TO DFHEIV11
 11734     MOVE 'ELTRLR' TO DFHEIV1
 11735*    MOVE '&& L                  %   #00010559' TO DFHEIV0
 11736     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11737     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11738     MOVE X'2020233030303130353539' TO DFHEIV0(25:11)
 11739     CALL 'kxdfhei1' USING DFHEIV0,
 11740           DFHEIV1,
 11741           activity-trailers,
 11742           DFHEIV11,
 11743           DFHEIV99
 11744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11745           else
 11746
 11747* EXEC CICS GETMAIN
 11748*                SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11749*                LENGTH   (TRLR-LENGTH)
 11750*                INITIMG  (GETMAIN-SPACE)
 11751*             END-EXEC
 11752*    MOVE ',"IL                  $   #00010564' TO DFHEIV0
 11753     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 217
* EL131.cbl
 11754     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11755     MOVE X'2020233030303130353634' TO DFHEIV0(25:11)
 11756     CALL 'kxdfhei1' USING DFHEIV0,
 11757           DFHEIV20,
 11758           TRLR-LENGTH,
 11759           GETMAIN-SPACE
 11760     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11761         DFHEIV20
 11762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11763              move 'AT'          to at-record-id
 11764              move cl-control-primary
 11765                                 to at-control-primary
 11766              move +95           to at-sequence-no
 11767              move '6'           to at-trailer-type
 11768              move ws-dcc-error-line
 11769                                 to at-info-line-1
 11770              move 'E'           to at-info-trailer-type
 11771              move save-bin-date to at-recorded-dt
 11772                                    at-gen-info-last-maint-dt
 11773              move pi-processor-id
 11774                                 to at-recorded-by
 11775                                    at-gen-info-last-updated-by
 11776              move eibtime       to at-last-maint-hhmmss
 11777
 11778* exec cics write
 11779*                dataset   ('ELTRLR')
 11780*                from      (activity-trailers)
 11781*                ridfld    (trlr-key)
 11782*             end-exec
 11783     MOVE LENGTH OF
 11784      activity-trailers
 11785       TO DFHEIV11
 11786     MOVE 'ELTRLR' TO DFHEIV1
 11787*    MOVE '&$ L                  ''   #00010583' TO DFHEIV0
 11788     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11789     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11790     MOVE X'2020233030303130353833' TO DFHEIV0(25:11)
 11791     CALL 'kxdfhei1' USING DFHEIV0,
 11792           DFHEIV1,
 11793           activity-trailers,
 11794           DFHEIV11,
 11795           trlr-key,
 11796           DFHEIV99,
 11797           DFHEIV99
 11798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11799              perform varying s1 from +1 by +1 until
 11800                 ws-error-no (s1) = spaces
 11801                 move ws-error-no (s1)
 11802                                 to emi-error
 11803                 PERFORM 9900-ERROR-FORMAT
 11804                                 THRU 9900-EXIT
 11805              end-perform
 11806           end-if
 11807     end-evaluate
 11808
 11809     .
 11810 2130-exit.
 11811     exit.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 218
* EL131.cbl
 11812 2140-update-elcrtt.
 11813     move ' '                    to crtt-switch
 11814     MOVE CERT-KEY               TO ELCRTT-KEY
 11815     MOVE 'B'                    TO CTRLR-REC-TYPE
 11816
 11817* EXEC CICS READ
 11818*       UPDATE
 11819*       DATASET   ('ELCRTT')
 11820*       RIDFLD    (ELCRTT-KEY)
 11821*       INTO      (CERTIFICATE-TRAILERS)
 11822*       RESP      (WS-RESPONSE)
 11823*    END-EXEC
 11824     MOVE LENGTH OF
 11825      CERTIFICATE-TRAILERS
 11826       TO DFHEIV11
 11827     MOVE 'ELCRTT' TO DFHEIV1
 11828*    MOVE '&"IL       EU         (  N#00010605' TO DFHEIV0
 11829     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11830     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11831     MOVE X'204E233030303130363035' TO DFHEIV0(25:11)
 11832     CALL 'kxdfhei1' USING DFHEIV0,
 11833           DFHEIV1,
 11834           CERTIFICATE-TRAILERS,
 11835           DFHEIV11,
 11836           ELCRTT-KEY,
 11837           DFHEIV99,
 11838           DFHEIV99,
 11839           DFHEIV99
 11840     MOVE EIBRESP  TO WS-RESPONSE
 11841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11842     IF WS-RESP-NORMAL
 11843        perform varying s1 from +1 by +1 until
 11844           (s1 > +24)
 11845           or (cs-claim-no (s1) = cl-claim-no)
 11846        end-perform
 11847        if (s1 < +25)
 11848           if (benperl <> zeros)
 11849              and (cs-benefit-period (s1) not = benperi)
 11850              move benperi       to cs-benefit-period (s1)
 11851              set crtt-update    to true
 11852          end-if
 11853          if (instypel <> zeros)
 11854             and (instypei not = cs-insured-type (s1))
 11855             move instypei      to cs-insured-type (s1)
 11856             set crtt-update    to true
 11857          end-if
 11858          move cs-claim-type (s1) to ws-claim-type
 11859          move cs-benefit-period (s1) to ws-ben-per
 11860        end-if
 11861        if crtt-update
 11862           perform 2150-accum    thru 2150-exit
 11863
 11864* EXEC CICS REWRITE
 11865*             DATASET   ('ELCRTT')
 11866*             FROM      (CERTIFICATE-TRAILERS)
 11867*          END-EXEC
 11868     MOVE LENGTH OF
 11869      CERTIFICATE-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 219
* EL131.cbl
 11870       TO DFHEIV11
 11871     MOVE 'ELCRTT' TO DFHEIV1
 11872*    MOVE '&& L                  %   #00010633' TO DFHEIV0
 11873     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11874     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11875     MOVE X'2020233030303130363333' TO DFHEIV0(25:11)
 11876     CALL 'kxdfhei1' USING DFHEIV0,
 11877           DFHEIV1,
 11878           CERTIFICATE-TRAILERS,
 11879           DFHEIV11,
 11880           DFHEIV99
 11881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11882        else
 11883
 11884* exec cics unlock
 11885*             dataset   ('ELCRTT')
 11886*          end-exec
 11887     MOVE 'ELCRTT' TO DFHEIV1
 11888*    MOVE '&*                    #   #00010638' TO DFHEIV0
 11889     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11890     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11891     MOVE X'2020233030303130363338' TO DFHEIV0(25:11)
 11892     CALL 'kxdfhei1' USING DFHEIV0,
 11893           DFHEIV1,
 11894           DFHEIV99
 11895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11896        end-if
 11897     end-if
 11898     .
 11899 2140-exit.
 11900     exit.
 11901 2150-accum.
 11902     if not erpdef-found
 11903        perform 3997-get-erpdef  thru 3997-exit
 11904     end-if
 11905     if (erpdef-found)
 11906        and (ws-max-moben not = zeros)
 11907        and (ws-max-moben < cm-ah-benefit-amt)
 11908        continue
 11909     else
 11910        move cm-ah-benefit-amt   to ws-max-moben
 11911     end-if
 11912     move cm-ah-orig-term        to ws-max-bens
 11913     if cl-critical-period not = zeros and spaces
 11914        move cl-critical-period  to ws-max-bens
 11915     end-if
 11916     move zeros to ws-tot-days-paid ws-tot-amt-paid
 11917     perform varying s2 from +1 by +1 until
 11918        (s2 > +24)
 11919        or (cs-claim-no (s2) = spaces)
 11920        if (cs-benefit-period (s2) = ws-ben-per)
 11921           and (cs-claim-type (s2) = ws-claim-type)
 11922           and (cs-insured-type (s2) = cl-insured-type)
 11923*          compute ws-tot-days-paid =
 11924*             ws-tot-days-paid + cs-days-paid (s2)
 11925           compute ws-tot-amt-paid =
 11926              ws-tot-amt-paid + cs-total-paid (s2)
 11927        end-if
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 220
* EL131.cbl
 11928     end-perform
 11929     if s2 < +25
 11930        compute ws-pd-bens rounded =
 11931           ws-tot-amt-paid / ws-max-moben
 11932        compute cs-remaining-bens (s1) =
 11933           ws-max-bens - ws-pd-bens
 11934        if cs-remaining-bens (s1) < zeros
 11935           move zeros            to cs-remaining-bens (s1)
 11936        end-if
 11937     end-if
 11938     .
 11939 2150-exit.
 11940     exit.
 11941 2200-MOVE-CERT.
 11942     IF CRTLNMEI GREATER THAN LOW-VALUES
 11943         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 11944
 11945     IF CRTFNMEI GREATER THAN LOW-VALUES
 11946         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
 11947         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 11948
 11949     IF CRTINITI GREATER THAN LOW-VALUES
 11950         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 11951
 11952     IF CM-INSURED-INITIALS = SPACES
 11953         MOVE '**'               TO CM-INSURED-INITIALS.
 11954
 11955     IF ISSAGEI GREATER THAN LOW-VALUES
 11956         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 11957
 11958     IF JNTFNMEI GREATER THAN LOW-VALUES
 11959         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 11960
 11961     IF JNTLNMEI GREATER THAN LOW-VALUES
 11962         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 11963
 11964     IF JNTINITI GREATER THAN LOW-VALUES
 11965         MOVE JNTINITI           TO CM-JT-INITIAL.
 11966
 11967     IF JNTAGEI GREATER THAN LOW-VALUES
 11968         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 11969
 11970     IF ADDONDTI GREATER THAN LOW-VALUES
 11971        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 11972
 11973     IF LCVCDI GREATER THAN LOW-VALUES
 11974        IF LCVCDI = SPACES OR ZEROS
 11975           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 11976        ELSE
 11977           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 11978
 11979     IF LCVOTRMI GREATER THAN LOW-VALUES
 11980         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 11981
 11982     IF LCVRATEL GREATER THAN +0
 11983         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 11984
 11985     IF LCVBENEL GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 221
* EL131.cbl
 11986         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 11987
 11988     IF LCVFORMI GREATER THAN LOW-VALUES
 11989         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 11990
 11991     IF LCVCNDTI = LOW-VALUES
 11992        GO TO 2210-SET-STATUS.
 11993
 11994     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 11995        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 11996        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 11997        GO TO 2210-SET-STATUS.
 11998
 11999     IF CM-LF-CURRENT-STATUS = '7'
 12000        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 12001        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 12002        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 12003                                    CM-LF-DEATH-DT
 12004        GO TO 2210-SET-STATUS.
 12005
 12006     IF CM-LF-CURRENT-STATUS = '8'
 12007        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 12008        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 12009                                    CM-LF-CANCEL-DT.
 12010
 12011 2210-SET-STATUS.
 12012
 12013     IF CM-LF-CURRENT-STATUS = SPACES
 12014         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 12015
 12016     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 12017         MOVE '6'                TO DC-OPTION-CODE
 12018         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 12019         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12020         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12021         IF NO-CONVERSION-ERROR
 12022             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 12023         ELSE
 12024             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 12025     ELSE
 12026         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 12027
 12028 2215-PROCESS-AH-SIDE.
 12029
 12030     IF ACVCDI GREATER THAN LOW-VALUES
 12031        IF ACVCDI = SPACES OR ZEROS
 12032           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 12033        ELSE
 12034           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 12035
 12036     IF ACVOTRMI GREATER THAN LOW-VALUES
 12037         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 12038
 12039     IF ACVRATEL GREATER THAN +0
 12040         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 12041
 12042     IF ACVBENEL GREATER THAN +0
 12043         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 222
* EL131.cbl
 12044                                    PI-PAYMENT-AMT.
 12045
 12046     IF ACVFORMI GREATER THAN LOW-VALUES
 12047         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 12048
 12049     IF ACVCNDTI = LOW-VALUES
 12050        GO TO 2220-SET-STATUS.
 12051
 12052     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 12053        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 12054        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 12055        GO TO 2220-SET-STATUS.
 12056
 12057     IF CM-AH-CURRENT-STATUS = '6'
 12058        MOVE CM-AH-STATUS-AT-SETTLEMENT
 12059                                 TO CM-AH-CURRENT-STATUS
 12060        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 12061        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 12062                                    CM-AH-SETTLEMENT-DT
 12063        GO TO 2220-SET-STATUS.
 12064
 12065     IF CM-AH-CURRENT-STATUS = '8'
 12066        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 12067        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 12068                                    CM-AH-CANCEL-DT.
 12069
 12070 2220-SET-STATUS.
 12071     IF CM-AH-CURRENT-STATUS = SPACES
 12072         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 12073
 12074     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 12075         MOVE '6'                TO DC-OPTION-CODE
 12076         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 12077         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12078         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12079         IF NO-CONVERSION-ERROR
 12080             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 12081         ELSE
 12082             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 12083     ELSE
 12084         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 12085
 12086 2225-FINISH-CERT.
 12087     IF APRL GREATER THAN +0
 12088         MOVE HOLD-APR           TO CM-LOAN-APR.
 12089
 12090     IF PMTFREQI GREATER THAN LOW-VALUES
 12091         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 12092
 12093     IF INDGRPI GREATER THAN LOW-VALUES
 12094         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 12095
 12096*    IF LOANNOI GREATER THAN LOW-VALUES
 12097*       MOVE LOANNOI             TO CM-LOAN-NUMBER.
 12098
 12099     IF LOANBALL GREATER THAN +0
 12100        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 12101
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 223
* EL131.cbl
 12102     IF PREMTYPI GREATER THAN LOW-VALUES
 12103         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 12104
 12105     IF REINCDI GREATER THAN LOW-VALUES
 12106         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 12107                                    WS-REIN-1
 12108                                    WS-REIN-2
 12109                                    WS-REIN-3
 12110         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 12111
 12112     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 12113
 12114     MOVE ZEROS                  TO CM-LOAN-TERM
 12115                                    CM-LIFE-COMM-PCT
 12116                                    CM-AH-COMM-PCT.
 12117
 12118*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 12119*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 12120*         PI-NO-PMTS = ZEROS
 12121*          IF LOANBALL GREATER THAN +0          OR
 12122*             ACVBENEL GREATER THAN +0          OR
 12123*             APRL     GREATER THAN +0          OR
 12124*             LCVRATEL GREATER THAN +0          OR
 12125*             ACVRATEL GREATER THAN +0
 12126*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 12127
 12128 2200-EXIT.
 12129     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 224
* EL131.cbl
 12131 2300-UPDATE-TRLR.
 12132     MOVE ZERO                   TO TRLR-SEQ-NO.
 12133
 12134* EXEC CICS READ UPDATE
 12135*         DATASET  (TRLR-FILE-ID)
 12136*         RIDFLD   (TRLR-KEY)
 12137*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12138*    END-EXEC.
 12139*    MOVE '&"S        EU         (   #00010878' TO DFHEIV0
 12140     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12141     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12142     MOVE X'2020233030303130383738' TO DFHEIV0(25:11)
 12143     CALL 'kxdfhei1' USING DFHEIV0,
 12144           TRLR-FILE-ID,
 12145           DFHEIV20,
 12146           DFHEIV99,
 12147           TRLR-KEY,
 12148           DFHEIV99,
 12149           DFHEIV99,
 12150           DFHEIV99
 12151     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12152         DFHEIV20
 12153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12154
 12155
 12156     MOVE ZERO                   TO COUNT-2.
 12157
 12158     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12159         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12160
 12161     IF NOT UPDATE-MADE
 12162         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12163
 12164
 12165* EXEC CICS REWRITE
 12166*         DATASET  (TRLR-FILE-ID)
 12167*         FROM     (ACTIVITY-TRAILERS)
 12168*    END-EXEC.
 12169     MOVE LENGTH OF
 12170      ACTIVITY-TRAILERS
 12171       TO DFHEIV11
 12172*    MOVE '&& L                  %   #00010892' TO DFHEIV0
 12173     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12174     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12175     MOVE X'2020233030303130383932' TO DFHEIV0(25:11)
 12176     CALL 'kxdfhei1' USING DFHEIV0,
 12177           TRLR-FILE-ID,
 12178           ACTIVITY-TRAILERS,
 12179           DFHEIV11,
 12180           DFHEIV99
 12181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12182
 12183
 12184 2300-EXIT.
 12185     EXIT.
 12186
 12187 2310-INS-STATUS.
 12188     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 225
* EL131.cbl
 12189     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 12190         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 12191         MOVE 'Y'                TO TRLR-SWITCH.
 12192
 12193 2310-EXIT.
 12194     EXIT.
 12195
 12196 2320-SHIFT-STATUS.
 12197     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 12198        MOVE 6                   TO COUNT-2
 12199        GO TO 2320-EXIT.
 12200
 12201     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 12202     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 12203     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 12204     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 12205     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 12206     MOVE 6       TO COUNT-2.
 12207     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 12208
 12209 2320-EXIT.
 12210     EXIT.
 12211
 12212 2330-ADD-UPDATE.
 12213
 12214     IF COUNT-2 GREATER THAN 1
 12215        COMPUTE MISC-SUB = (COUNT-2 - 1)
 12216        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 12217           GO TO 2330-EXIT.
 12218
 12219     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 12220                                   AT-RESERVES-LAST-MAINT-DT
 12221
 12222     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 12223     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 12224     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 12225     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 12226
 12227 2330-EXIT.
 12228     EXIT.
 12229
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 226
* EL131.cbl
 12231 2400-UPDATE-TRLR.
 12232
 12233* EXEC CICS HANDLE CONDITION
 12234*         NOTFND    (2400-TRLR-NOTFND)
 12235*         ENDFILE   (2410-EXIT)
 12236*    END-EXEC.
 12237*    MOVE '"$I''                  ! 5 #00010945' TO DFHEIV0
 12238     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12239     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12240     MOVE X'3520233030303130393435' TO DFHEIV0(25:11)
 12241     CALL 'kxdfhei1' USING DFHEIV0
 12242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12243
 12244
 12245
 12246* EXEC CICS STARTBR
 12247*        DATASET (TRLR-FILE-ID)
 12248*        RIDFLD  (TRLR-KEY)
 12249*    END-EXEC.
 12250     MOVE 0
 12251       TO DFHEIV11
 12252*    MOVE '&,         G          &   #00010950' TO DFHEIV0
 12253     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12254     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12255     MOVE X'2020233030303130393530' TO DFHEIV0(25:11)
 12256     CALL 'kxdfhei1' USING DFHEIV0,
 12257           TRLR-FILE-ID,
 12258           TRLR-KEY,
 12259           DFHEIV99,
 12260           DFHEIV11,
 12261           DFHEIV99
 12262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12263
 12264
 12265
 12266* EXEC CICS GETMAIN
 12267*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12268*         LENGTH    (TRLR-LENGTH)
 12269*         INITIMG   (GETMAIN-SPACE)
 12270*    END-EXEC.
 12271*    MOVE ',"IL                  $   #00010955' TO DFHEIV0
 12272     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12273     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12274     MOVE X'2020233030303130393535' TO DFHEIV0(25:11)
 12275     CALL 'kxdfhei1' USING DFHEIV0,
 12276           DFHEIV20,
 12277           TRLR-LENGTH,
 12278           GETMAIN-SPACE
 12279     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12280         DFHEIV20
 12281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12282
 12283
 12284     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 12285
 12286
 12287* EXEC CICS ENDBR
 12288*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 227
* EL131.cbl
 12289*    END-EXEC.
 12290     MOVE 0
 12291       TO DFHEIV11
 12292*    MOVE '&2                    $   #00010963' TO DFHEIV0
 12293     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12294     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12295     MOVE X'2020233030303130393633' TO DFHEIV0(25:11)
 12296     CALL 'kxdfhei1' USING DFHEIV0,
 12297           TRLR-FILE-ID,
 12298           DFHEIV11,
 12299           DFHEIV99
 12300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12301
 12302
 12303     GO TO 2400-EXIT.
 12304
 12305 2400-TRLR-NOTFND.
 12306     MOVE ER-0205                TO EMI-ERROR.
 12307     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12308     MOVE 'X'                    TO ERROR-SWITCH.
 12309
 12310 2400-EXIT.
 12311     EXIT.
 12312
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 228
* EL131.cbl
 12314 2410-CHANGE-TRLR.
 12315
 12316* EXEC CICS READNEXT
 12317*        DATASET (TRLR-FILE-ID)
 12318*        RIDFLD  (TRLR-KEY)
 12319*        INTO    (ACTIVITY-TRAILERS)
 12320*    END-EXEC.
 12321     MOVE LENGTH OF
 12322      ACTIVITY-TRAILERS
 12323       TO DFHEIV12
 12324     MOVE 0
 12325       TO DFHEIV11
 12326*    MOVE '&.IL                  )   #00010979' TO DFHEIV0
 12327     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12328     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12329     MOVE X'2020233030303130393739' TO DFHEIV0(25:11)
 12330     CALL 'kxdfhei1' USING DFHEIV0,
 12331           TRLR-FILE-ID,
 12332           ACTIVITY-TRAILERS,
 12333           DFHEIV12,
 12334           TRLR-KEY,
 12335           DFHEIV99,
 12336           DFHEIV11,
 12337           DFHEIV99,
 12338           DFHEIV99
 12339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12340
 12341
 12342     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 12343        GO TO 2410-CHANGE-TRLR.
 12344
 12345     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 12346                                    CHECK-KEY.
 12347
 12348     IF CHECK-KEY NOT = MSTR-KEY
 12349         GO TO 2410-EXIT.
 12350
 12351
 12352* EXEC CICS ENDBR
 12353*        DATASET (TRLR-FILE-ID)
 12354*    END-EXEC.
 12355     MOVE 0
 12356       TO DFHEIV11
 12357*    MOVE '&2                    $   #00010994' TO DFHEIV0
 12358     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12359     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12360     MOVE X'2020233030303130393934' TO DFHEIV0(25:11)
 12361     CALL 'kxdfhei1' USING DFHEIV0,
 12362           TRLR-FILE-ID,
 12363           DFHEIV11,
 12364           DFHEIV99
 12365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12366
 12367
 12368
 12369* EXEC CICS READ UPDATE
 12370*        DATASET (TRLR-FILE-ID)
 12371*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 229
* EL131.cbl
 12372*        INTO    (ACTIVITY-TRAILERS)
 12373*    END-EXEC.
 12374     MOVE LENGTH OF
 12375      ACTIVITY-TRAILERS
 12376       TO DFHEIV11
 12377*    MOVE '&"IL       EU         (   #00010998' TO DFHEIV0
 12378     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12379     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12380     MOVE X'2020233030303130393938' TO DFHEIV0(25:11)
 12381     CALL 'kxdfhei1' USING DFHEIV0,
 12382           TRLR-FILE-ID,
 12383           ACTIVITY-TRAILERS,
 12384           DFHEIV11,
 12385           TRLR-KEY,
 12386           DFHEIV99,
 12387           DFHEIV99,
 12388           DFHEIV99
 12389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12390
 12391
 12392
 12393* EXEC CICS DELETE
 12394*        DATASET (TRLR-FILE-ID)
 12395*    END-EXEC.
 12396*    MOVE '&(                    &   #00011004' TO DFHEIV0
 12397     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12398     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12399     MOVE X'2020233030303131303034' TO DFHEIV0(25:11)
 12400     CALL 'kxdfhei1' USING DFHEIV0,
 12401           TRLR-FILE-ID,
 12402           DFHEIV99,
 12403           DFHEIV99,
 12404           DFHEIV99,
 12405           DFHEIV99
 12406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12407
 12408
 12409     IF AT-SEQUENCE-NO = ZERO AND
 12410        TRLR-UPDATE-REQUIRED
 12411         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 12412
 12413     IF CERTI GREATER THAN LOW-VALUES
 12414        MOVE CERTI               TO AT-CERT-PRIME.
 12415
 12416     IF SUFXI GREATER THAN LOW-VALUES
 12417        MOVE SUFXI               TO AT-CERT-SFX.
 12418
 12419     IF CERTCARI GREATER THAN LOW-VALUES
 12420        MOVE CERTCARI            TO AT-CARRIER.
 12421
 12422     IF PAYMENT-TR
 12423        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 12424           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 12425              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 12426
 12427     IF CORRESPONDENCE-TR
 12428        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 12429           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 230
* EL131.cbl
 12430
 12431
 12432* EXEC CICS WRITE
 12433*         DATASET  (TRLR-FILE-ID)
 12434*         RIDFLD   (AT-CONTROL-PRIMARY)
 12435*         FROM     (ACTIVITY-TRAILERS)
 12436*    END-EXEC.
 12437     MOVE LENGTH OF
 12438      ACTIVITY-TRAILERS
 12439       TO DFHEIV11
 12440*    MOVE '&$ L                  ''   #00011030' TO DFHEIV0
 12441     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12442     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12443     MOVE X'2020233030303131303330' TO DFHEIV0(25:11)
 12444     CALL 'kxdfhei1' USING DFHEIV0,
 12445           TRLR-FILE-ID,
 12446           ACTIVITY-TRAILERS,
 12447           DFHEIV11,
 12448           AT-CONTROL-PRIMARY,
 12449           DFHEIV99,
 12450           DFHEIV99
 12451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12452
 12453
 12454
 12455* EXEC CICS STARTBR
 12456*         DATASET  (TRLR-FILE-ID)
 12457*         RIDFLD   (TRLR-KEY)
 12458*    END-EXEC.
 12459     MOVE 0
 12460       TO DFHEIV11
 12461*    MOVE '&,         G          &   #00011036' TO DFHEIV0
 12462     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12463     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12464     MOVE X'2020233030303131303336' TO DFHEIV0(25:11)
 12465     CALL 'kxdfhei1' USING DFHEIV0,
 12466           TRLR-FILE-ID,
 12467           TRLR-KEY,
 12468           DFHEIV99,
 12469           DFHEIV11,
 12470           DFHEIV99
 12471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12472
 12473
 12474     GO TO 2410-CHANGE-TRLR.
 12475
 12476 2410-EXIT.
 12477     EXIT.
 12478
 12479 2420-UPDATE-TRLR.
 12480     MOVE ZERO TO COUNT-2.
 12481     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12482         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12483
 12484     IF NOT UPDATE-MADE
 12485         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12486
 12487 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 231
* EL131.cbl
 12488     EXIT.
 12489
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 232
* EL131.cbl
 12491 2425-UPDATE-NINETY-TRLR.
 12492
 12493     MOVE +90                    TO TRLR-SEQ-NO.
 12494
 12495
 12496* EXEC CICS HANDLE CONDITION
 12497*         NOTFND    (2425-NINETY-NOTFND)
 12498*         ENDFILE   (2425-NINETY-NOTFND)
 12499*    END-EXEC.
 12500*    MOVE '"$I''                  ! 6 #00011062' TO DFHEIV0
 12501     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12502     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12503     MOVE X'3620233030303131303632' TO DFHEIV0(25:11)
 12504     CALL 'kxdfhei1' USING DFHEIV0
 12505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12506
 12507
 12508
 12509* EXEC CICS READ UPDATE
 12510*        DATASET (TRLR-FILE-ID)
 12511*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 12512*        RIDFLD  (TRLR-KEY)
 12513*    END-EXEC.
 12514*    MOVE '&"S        EU         (   #00011067' TO DFHEIV0
 12515     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12516     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12517     MOVE X'2020233030303131303637' TO DFHEIV0(25:11)
 12518     CALL 'kxdfhei1' USING DFHEIV0,
 12519           TRLR-FILE-ID,
 12520           DFHEIV20,
 12521           DFHEIV99,
 12522           TRLR-KEY,
 12523           DFHEIV99,
 12524           DFHEIV99,
 12525           DFHEIV99
 12526     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12527         DFHEIV20
 12528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12529
 12530     if (diagi > low-values)
 12531        and (diagi not = at-info-line-1)
 12532        and (cl-total-paid-amt > zeros)
 12533        move cl-cert-eff-dt      to dc-bin-date-1
 12534        move cl-paid-thru-dt     to dc-bin-date-2
 12535        move '1'                 to dc-option-code
 12536        perform 9800-convert-date
 12537                                 thru 9800-exit
 12538        if no-conversion-error
 12539           and dc-elapsed-months < +24
 12540           and (not emi-bypass-forcables)
 12541           move er-1581          to emi-error
 12542           perform 9900-error-format
 12543                                thru 9900-exit
 12544           move -1              to diagl
 12545           go to 8110-send-data
 12546        end-if
 12547     end-if
 12548     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 233
* EL131.cbl
 12549     MOVE AT-ICD-CODE-1         TO WS-ICD-CODE-1.
 12550     MOVE AT-ICD-CODE-2         TO WS-ICD-CODE-2.
 12551
 12552     IF DIAGI GREATER THAN LOW-VALUES
 12553         MOVE DIAGI             TO AT-INFO-LINE-1
 12554     END-IF.
 12555
 12556     IF ICD1I GREATER THAN LOW-VALUES
 12557         MOVE ICD1I             TO AT-ICD-CODE-1
 12558     END-IF.
 12559
 12560     IF ICD2I GREATER THAN LOW-VALUES
 12561         MOVE ICD2I             TO AT-ICD-CODE-2
 12562     END-IF.
 12563
 12564
 12565* EXEC CICS REWRITE
 12566*        DATASET (TRLR-FILE-ID)
 12567*        FROM    (ACTIVITY-TRAILERS)
 12568*    END-EXEC.
 12569     MOVE LENGTH OF
 12570      ACTIVITY-TRAILERS
 12571       TO DFHEIV11
 12572*    MOVE '&& L                  %   #00011106' TO DFHEIV0
 12573     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12574     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12575     MOVE X'2020233030303131313036' TO DFHEIV0(25:11)
 12576     CALL 'kxdfhei1' USING DFHEIV0,
 12577           TRLR-FILE-ID,
 12578           ACTIVITY-TRAILERS,
 12579           DFHEIV11,
 12580           DFHEIV99
 12581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12582
 12583
 12584     IF DIAGI GREATER THAN LOW-VALUES
 12585       AND DIAGI NOT = WS-DIAGNOSIS
 12586         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 12587         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 12588         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12589
 12590     IF ICD1I GREATER THAN LOW-VALUES
 12591       AND ICD1I NOT = WS-ICD-CODE-1
 12592         MOVE 'ICD CODE 1'         TO SPLIT-INFO-DESC
 12593         MOVE WS-ICD-CODE-1        TO SPLIT-INFO-OLD
 12594         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12595     END-IF.
 12596
 12597     IF ICD2I GREATER THAN LOW-VALUES
 12598       AND ICD2I NOT = WS-ICD-CODE-2
 12599         MOVE 'ICD CODE 2'         TO SPLIT-INFO-DESC
 12600         MOVE WS-ICD-CODE-2        TO SPLIT-INFO-OLD
 12601         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12602     END-IF.
 12603
 12604     GO TO 2425-EXIT.
 12605
 12606 2425-NINETY-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 234
* EL131.cbl
 12607
 12608
 12609* EXEC CICS GETMAIN
 12610*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12611*         LENGTH    (TRLR-LENGTH)
 12612*         INITIMG   (GETMAIN-SPACE)
 12613*    END-EXEC.
 12614*    MOVE ',"IL                  $   #00011135' TO DFHEIV0
 12615     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12616     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12617     MOVE X'2020233030303131313335' TO DFHEIV0(25:11)
 12618     CALL 'kxdfhei1' USING DFHEIV0,
 12619           DFHEIV20,
 12620           TRLR-LENGTH,
 12621           GETMAIN-SPACE
 12622     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12623         DFHEIV20
 12624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12625
 12626
 12627     MOVE +90                  TO TRLR-SEQ-NO.
 12628     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 12629
 12630     MOVE 'AT'                 TO AT-RECORD-ID
 12631     MOVE '6'                  TO AT-TRAILER-TYPE
 12632     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 12633                                  AT-GEN-INFO-LAST-MAINT-DT
 12634     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 12635                                  AT-GEN-INFO-LAST-UPDATED-BY
 12636     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 12637     MOVE DIAGI                TO AT-INFO-LINE-1.
 12638     MOVE ICD1I                TO AT-ICD-CODE-1.
 12639     MOVE ICD2I                TO AT-ICD-CODE-2.
 12640
 12641
 12642* EXEC CICS WRITE
 12643*        DATASET (TRLR-FILE-ID)
 12644*        FROM    (ACTIVITY-TRAILERS)
 12645*        RIDFLD  (TRLR-KEY)
 12646*    END-EXEC.
 12647     MOVE LENGTH OF
 12648      ACTIVITY-TRAILERS
 12649       TO DFHEIV11
 12650*    MOVE '&$ L                  ''   #00011155' TO DFHEIV0
 12651     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12652     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12653     MOVE X'2020233030303131313535' TO DFHEIV0(25:11)
 12654     CALL 'kxdfhei1' USING DFHEIV0,
 12655           TRLR-FILE-ID,
 12656           ACTIVITY-TRAILERS,
 12657           DFHEIV11,
 12658           TRLR-KEY,
 12659           DFHEIV99,
 12660           DFHEIV99
 12661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12662
 12663
 12664 2425-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 235
* EL131.cbl
 12665     EXIT.
 12666
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 236
* EL131.cbl
 12668 2430-UPDATE-ACTQ.
 12669
 12670* EXEC CICS HANDLE CONDITION
 12671*         NOTFND    (2430-EXIT)
 12672*         ENDFILE   (2440-EXIT)
 12673*    END-EXEC.
 12674*    MOVE '"$I''                  ! 7 #00011166' TO DFHEIV0
 12675     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12676     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12677     MOVE X'3720233030303131313636' TO DFHEIV0(25:11)
 12678     CALL 'kxdfhei1' USING DFHEIV0
 12679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12680
 12681
 12682
 12683* EXEC CICS STARTBR
 12684*         DATASET  (ACTQ-FILE-ID)
 12685*         RIDFLD   (ACTQ-KEY)
 12686*    END-EXEC.
 12687     MOVE 0
 12688       TO DFHEIV11
 12689*    MOVE '&,         G          &   #00011171' TO DFHEIV0
 12690     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12691     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12692     MOVE X'2020233030303131313731' TO DFHEIV0(25:11)
 12693     CALL 'kxdfhei1' USING DFHEIV0,
 12694           ACTQ-FILE-ID,
 12695           ACTQ-KEY,
 12696           DFHEIV99,
 12697           DFHEIV11,
 12698           DFHEIV99
 12699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12700
 12701
 12702
 12703* EXEC CICS GETMAIN
 12704*         SET      (ADDRESS OF ACTIVITY-QUE)
 12705*         LENGTH   (ACTQ-LENGTH)
 12706*         INITIMG  (GETMAIN-SPACE)
 12707*    END-EXEC.
 12708*    MOVE ',"IL                  $   #00011176' TO DFHEIV0
 12709     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12710     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12711     MOVE X'2020233030303131313736' TO DFHEIV0(25:11)
 12712     CALL 'kxdfhei1' USING DFHEIV0,
 12713           DFHEIV20,
 12714           ACTQ-LENGTH,
 12715           GETMAIN-SPACE
 12716     SET ADDRESS OF ACTIVITY-QUE TO
 12717         DFHEIV20
 12718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12719
 12720
 12721     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 12722
 12723 2430-EXIT.
 12724     EXIT.
 12725
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 237
* EL131.cbl
 12726 2440-CHANGE-ACTQ.
 12727
 12728
 12729* EXEC CICS READNEXT
 12730*         DATASET  (ACTQ-FILE-ID)
 12731*         RIDFLD   (ACTQ-KEY)
 12732*         INTO     (ACTIVITY-QUE)
 12733*    END-EXEC.
 12734     MOVE LENGTH OF
 12735      ACTIVITY-QUE
 12736       TO DFHEIV12
 12737     MOVE 0
 12738       TO DFHEIV11
 12739*    MOVE '&.IL                  )   #00011189' TO DFHEIV0
 12740     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12741     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12742     MOVE X'2020233030303131313839' TO DFHEIV0(25:11)
 12743     CALL 'kxdfhei1' USING DFHEIV0,
 12744           ACTQ-FILE-ID,
 12745           ACTIVITY-QUE,
 12746           DFHEIV12,
 12747           ACTQ-KEY,
 12748           DFHEIV99,
 12749           DFHEIV11,
 12750           DFHEIV99,
 12751           DFHEIV99
 12752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12753
 12754
 12755
 12756* EXEC CICS ENDBR
 12757*         DATASET (ACTQ-FILE-ID)
 12758*    END-EXEC.
 12759     MOVE 0
 12760       TO DFHEIV11
 12761*    MOVE '&2                    $   #00011195' TO DFHEIV0
 12762     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12763     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12764     MOVE X'2020233030303131313935' TO DFHEIV0(25:11)
 12765     CALL 'kxdfhei1' USING DFHEIV0,
 12766           ACTQ-FILE-ID,
 12767           DFHEIV11,
 12768           DFHEIV99
 12769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12770
 12771
 12772     IF ACTQ-KEY NOT = MSTR-KEY
 12773         GO TO 2440-EXIT.
 12774
 12775
 12776* EXEC CICS READ UPDATE
 12777*         DATASET  (ACTQ-FILE-ID)
 12778*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12779*         SET      (ADDRESS OF ACTIVITY-QUE)
 12780*    END-EXEC.
 12781*    MOVE '&"S        EU         (   #00011202' TO DFHEIV0
 12782     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12783     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 238
* EL131.cbl
 12784     MOVE X'2020233030303131323032' TO DFHEIV0(25:11)
 12785     CALL 'kxdfhei1' USING DFHEIV0,
 12786           ACTQ-FILE-ID,
 12787           DFHEIV20,
 12788           DFHEIV99,
 12789           AQ-CONTROL-PRIMARY,
 12790           DFHEIV99,
 12791           DFHEIV99,
 12792           DFHEIV99
 12793     SET ADDRESS OF ACTIVITY-QUE TO
 12794         DFHEIV20
 12795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12796
 12797
 12798     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 12799
 12800
 12801* EXEC CICS DELETE
 12802*         DATASET (ACTQ-FILE-ID)
 12803*    END-EXEC.
 12804*    MOVE '&(                    &   #00011210' TO DFHEIV0
 12805     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12806     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12807     MOVE X'2020233030303131323130' TO DFHEIV0(25:11)
 12808     CALL 'kxdfhei1' USING DFHEIV0,
 12809           ACTQ-FILE-ID,
 12810           DFHEIV99,
 12811           DFHEIV99,
 12812           DFHEIV99,
 12813           DFHEIV99
 12814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12815
 12816
 12817     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 12818     IF CERTI GREATER THAN LOW-VALUES
 12819        MOVE CERTI               TO AQ-CERT-PRIME.
 12820     IF SUFXI GREATER THAN LOW-VALUES
 12821        MOVE SUFXI               TO AQ-CERT-SFX.
 12822     IF CERTCARI GREATER THAN LOW-VALUES
 12823        MOVE CERTCARI            TO AQ-CARRIER.
 12824
 12825
 12826* EXEC CICS HANDLE CONDITION
 12827*         DUPREC   (2440-EXIT)
 12828*    END-EXEC.
 12829*    MOVE '"$%                   ! 8 #00011222' TO DFHEIV0
 12830     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12831     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12832     MOVE X'3820233030303131323232' TO DFHEIV0(25:11)
 12833     CALL 'kxdfhei1' USING DFHEIV0
 12834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12835
 12836
 12837
 12838* EXEC CICS WRITE
 12839*         DATASET  (ACTQ-FILE-ID)
 12840*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12841*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 239
* EL131.cbl
 12842*    END-EXEC.
 12843     MOVE LENGTH OF
 12844      ACTIVITY-QUE
 12845       TO DFHEIV11
 12846*    MOVE '&$ L                  ''   #00011226' TO DFHEIV0
 12847     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12848     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12849     MOVE X'2020233030303131323236' TO DFHEIV0(25:11)
 12850     CALL 'kxdfhei1' USING DFHEIV0,
 12851           ACTQ-FILE-ID,
 12852           ACTIVITY-QUE,
 12853           DFHEIV11,
 12854           AQ-CONTROL-PRIMARY,
 12855           DFHEIV99,
 12856           DFHEIV99
 12857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12858
 12859
 12860 2440-EXIT.
 12861     EXIT.
 12862
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 240
* EL131.cbl
 12864 2460-UPDATE-CHECKQ.
 12865
 12866* EXEC CICS HANDLE CONDITION
 12867*         NOTFND   (2460-EXIT)
 12868*    END-EXEC.
 12869*    MOVE '"$I                   ! 9 #00011237' TO DFHEIV0
 12870     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12871     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12872     MOVE X'3920233030303131323337' TO DFHEIV0(25:11)
 12873     CALL 'kxdfhei1' USING DFHEIV0
 12874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12875
 12876
 12877     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 12878     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 12879     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 12880
 12881
 12882* EXEC CICS READ UPDATE
 12883*         DATASET   (CHKQ-FILE-ID)
 12884*         RIDFLD    (CHKQ-KEY)
 12885*         SET       (ADDRESS OF CHECK-QUE)
 12886*    END-EXEC.
 12887*    MOVE '&"S        EU         (   #00011245' TO DFHEIV0
 12888     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12889     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12890     MOVE X'2020233030303131323435' TO DFHEIV0(25:11)
 12891     CALL 'kxdfhei1' USING DFHEIV0,
 12892           CHKQ-FILE-ID,
 12893           DFHEIV20,
 12894           DFHEIV99,
 12895           CHKQ-KEY,
 12896           DFHEIV99,
 12897           DFHEIV99,
 12898           DFHEIV99
 12899     SET ADDRESS OF CHECK-QUE TO
 12900         DFHEIV20
 12901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12902
 12903
 12904     IF CERTI GREATER THAN LOW-VALUES
 12905        MOVE CERTI               TO CQ-CERT-PRIME.
 12906     IF SUFXI GREATER THAN LOW-VALUES
 12907        MOVE SUFXI               TO CQ-CERT-SFX.
 12908     IF CERTCARI GREATER THAN LOW-VALUES
 12909        MOVE CERTCARI            TO CQ-CARRIER.
 12910
 12911
 12912* EXEC CICS REWRITE
 12913*         DATASET  (CHKQ-FILE-ID)
 12914*         FROM     (CHECK-QUE)
 12915*    END-EXEC.
 12916     MOVE LENGTH OF
 12917      CHECK-QUE
 12918       TO DFHEIV11
 12919*    MOVE '&& L                  %   #00011258' TO DFHEIV0
 12920     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12921     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 241
* EL131.cbl
 12922     MOVE X'2020233030303131323538' TO DFHEIV0(25:11)
 12923     CALL 'kxdfhei1' USING DFHEIV0,
 12924           CHKQ-FILE-ID,
 12925           CHECK-QUE,
 12926           DFHEIV11,
 12927           DFHEIV99
 12928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12929
 12930
 12931 2460-EXIT.
 12932     EXIT.
 12933
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 242
* EL131.cbl
 12935 2475-UPDATE-LETTER.
 12936
 12937* EXEC CICS HANDLE CONDITION
 12938*         NOTFND   (2475-EXIT)
 12939*    END-EXEC.
 12940*    MOVE '"$I                   ! : #00011268' TO DFHEIV0
 12941     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12942     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12943     MOVE X'3A20233030303131323638' TO DFHEIV0(25:11)
 12944     CALL 'kxdfhei1' USING DFHEIV0
 12945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12946
 12947
 12948     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 12949     MOVE '1'                    TO ARCH-RECORD-TYPE.
 12950     MOVE ZEROS                  TO ARCH-SEQ-NO.
 12951     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 12952
 12953
 12954* EXEC CICS READ UPDATE
 12955*         DATASET   (ARCH-FILE-ID)
 12956*         RIDFLD    (ARCH-KEY)
 12957*         SET       (ADDRESS OF LETTER-ARCHIVE)
 12958*    END-EXEC.
 12959*    MOVE '&"S        EU         (   #00011277' TO DFHEIV0
 12960     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12961     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12962     MOVE X'2020233030303131323737' TO DFHEIV0(25:11)
 12963     CALL 'kxdfhei1' USING DFHEIV0,
 12964           ARCH-FILE-ID,
 12965           DFHEIV20,
 12966           DFHEIV99,
 12967           ARCH-KEY,
 12968           DFHEIV99,
 12969           DFHEIV99,
 12970           DFHEIV99
 12971     SET ADDRESS OF LETTER-ARCHIVE TO
 12972         DFHEIV20
 12973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12974
 12975
 12976* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 12977* TO THIS MASTER-KEY INFORMATION.
 12978
 12979     IF LA-CARRIER  = CARRIER-CODE AND
 12980        LA-CLAIM-NO = CLAIM-NO     AND
 12981        LA-CERT-NO  = CERT-NO
 12982        NEXT SENTENCE
 12983     ELSE
 12984        GO TO 2475-UNLOCK.
 12985
 12986     IF CERTI GREATER THAN LOW-VALUES
 12987        MOVE CERTI               TO LA-CERT-PRIME.
 12988     IF SUFXI GREATER THAN LOW-VALUES
 12989        MOVE SUFXI               TO LA-CERT-SFX.
 12990     IF CERTCARI GREATER THAN LOW-VALUES
 12991        MOVE CERTCARI            TO LA-CARRIER.
 12992
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 243
* EL131.cbl
 12993
 12994* EXEC CICS REWRITE
 12995*         DATASET  (ARCH-FILE-ID)
 12996*         FROM     (LETTER-ARCHIVE)
 12997*    END-EXEC.
 12998     MOVE LENGTH OF
 12999      LETTER-ARCHIVE
 13000       TO DFHEIV11
 13001*    MOVE '&& L                  %   #00011300' TO DFHEIV0
 13002     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13003     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13004     MOVE X'2020233030303131333030' TO DFHEIV0(25:11)
 13005     CALL 'kxdfhei1' USING DFHEIV0,
 13006           ARCH-FILE-ID,
 13007           LETTER-ARCHIVE,
 13008           DFHEIV11,
 13009           DFHEIV99
 13010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13011
 13012
 13013     GO TO 2475-EXIT.
 13014
 13015 2475-UNLOCK.
 13016
 13017* EXEC CICS UNLOCK
 13018*         DATASET  (ARCH-FILE-ID)
 13019*    END-EXEC.
 13020*    MOVE '&*                    #   #00011308' TO DFHEIV0
 13021     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13022     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13023     MOVE X'2020233030303131333038' TO DFHEIV0(25:11)
 13024     CALL 'kxdfhei1' USING DFHEIV0,
 13025           ARCH-FILE-ID,
 13026           DFHEIV99
 13027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13028
 13029
 13030 2475-EXIT.
 13031     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 244
* EL131.cbl
 13033 2600-CREATE-MAINT-NOTE.
 13034     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 13035     MOVE '1'                    TO CNTL-REC-TYPE.
 13036     MOVE SPACES                 TO CNTL-PROC-ID.
 13037     MOVE ZERO                   TO CNTL-SEQ-NO.
 13038
 13039
 13040* EXEC CICS READ
 13041*         SET        (ADDRESS OF CONTROL-FILE)
 13042*         DATASET    ('ELCNTL')
 13043*         RIDFLD     (CNTL-KEY)
 13044*    END-EXEC.
 13045     MOVE 'ELCNTL' TO DFHEIV1
 13046*    MOVE '&"S        E          (   #00011321' TO DFHEIV0
 13047     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13048     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13049     MOVE X'2020233030303131333231' TO DFHEIV0(25:11)
 13050     CALL 'kxdfhei1' USING DFHEIV0,
 13051           DFHEIV1,
 13052           DFHEIV20,
 13053           DFHEIV99,
 13054           CNTL-KEY,
 13055           DFHEIV99,
 13056           DFHEIV99,
 13057           DFHEIV99
 13058     SET ADDRESS OF CONTROL-FILE TO
 13059         DFHEIV20
 13060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13061
 13062
 13063     IF CO-NO-USE-AUDIT-CHANGES
 13064         GO TO 2600-EXIT.
 13065
 13066     IF PROCL GREATER ZERO
 13067     IF PROCI NOT = LOW-VALUES
 13068     IF PROCI NOT = CL-PROCESSOR-ID
 13069         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 13070         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 13071         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13072
 13073     IF SEXL GREATER ZERO
 13074     IF SEXI NOT = LOW-VALUES
 13075     IF SEXI NOT = CL-INSURED-SEX-CD
 13076         MOVE 'SEX'                TO SPLIT-INFO-DESC
 13077         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 13078         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13079
 13080     IF BIRTHL GREATER ZERO
 13081     IF HOLD-BIRTH NOT = LOW-VALUES
 13082     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 13083         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 13084         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 13085         MOVE SPACES               TO DC-OPTION-CODE
 13086         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13087         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13088         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13089
 13090     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 245
* EL131.cbl
 13091     IF SOCIALI NOT = LOW-VALUES
 13092     IF SOCIALI NOT = CL-SOC-SEC-NO
 13093         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 13094         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 13095         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13096
 13097     IF OCCL GREATER ZERO
 13098     IF OCCI NOT = LOW-VALUES
 13099     IF OCCI NOT = CL-INSURED-OCC-CD
 13100         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 13101         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 13102         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13103
 13104     IF BENEL GREATER ZERO
 13105     IF BENEI NOT = LOW-VALUES
 13106     IF BENEI NOT = CL-BENEFICIARY
 13107         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 13108         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 13109         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13110
 13111     IF PREMTYPL GREATER ZERO
 13112     IF PREMTYPI NOT = LOW-VALUES
 13113     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 13114         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 13115         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 13116         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13117
 13118*    IF CAUSEL GREATER ZERO
 13119*    IF CAUSEI NOT = LOW-VALUES
 13120*    IF CAUSEI NOT = CL-CAUSE-CD
 13121*        MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 13122*        MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 13123*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13124
 13125*    IF ENDL GREATER ZERO
 13126*    IF HOLD-END NOT = LOW-VALUES
 13127*    IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 13128*        MOVE 'END DT'             TO SPLIT-INFO-DESC
 13129*        MOVE CL-EST-END-OF-DISAB-DT
 13130*                                  TO DC-BIN-DATE-1
 13131*        MOVE SPACES               TO DC-OPTION-CODE
 13132*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13133*        MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13134*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13135
 13136     IF PDTHRUL GREATER ZERO
 13137     IF HOLD-PDTHRU NOT = LOW-VALUES
 13138     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 13139         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 13140         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 13141         MOVE SPACES               TO DC-OPTION-CODE
 13142         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13143         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13144         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13145
 13146     IF PDAMTL GREATER ZERO
 13147     IF HOLD-PDAMT NOT = ZEROS
 13148     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 246
* EL131.cbl
 13149         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 13150         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 13151         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 13152         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13153
 13154     IF NODAYSL GREATER ZERO
 13155     IF HOLD-NODAYS NOT = ZEROS
 13156     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 13157         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 13158         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 13159         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13160         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13161
 13162     IF NOPMTSL GREATER ZERO
 13163     IF HOLD-NOPMTS NOT = ZEROS
 13164     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 13165         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 13166         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 13167         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13168         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13169
 13170     IF FORMTYPL GREATER ZERO
 13171     IF FORMTYPI NOT = LOW-VALUES
 13172     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 13173         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 13174         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 13175         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13176
 13177     IF REPL GREATER ZERO
 13178     IF HOLD-REPORTED NOT = LOW-VALUES
 13179     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 13180         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 13181         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 13182         MOVE SPACES               TO DC-OPTION-CODE
 13183         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13184         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13185         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13186
 13187     IF ADDONDTL GREATER ZERO
 13188     IF HOLD-ADDON NOT = LOW-VALUES
 13189     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 13190         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 13191         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 13192         MOVE SPACES               TO DC-OPTION-CODE
 13193         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13194         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13195         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13196
 13197     IF PRICDL GREATER ZERO
 13198     IF PRICDI NOT = LOW-VALUES
 13199     IF PRICDI NOT = CL-PRIORITY-CD
 13200         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 13201         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 13202         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13203
 13204     IF FILETOL GREATER ZERO
 13205     IF FILETOI NOT = LOW-VALUES
 13206     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 247
* EL131.cbl
 13207         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 13208         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 13209         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13210
 13211     IF SUPVL GREATER ZERO
 13212     IF SUPVI NOT = LOW-VALUES
 13213     IF SUPVI NOT = CL-SUPV-ATTN-CD
 13214         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 13215         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 13216         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13217*    IF (CRITPTL > ZERO)
 13218*       AND (CRITPTI NOT = LOW-VALUES)
 13219*       AND (CRITPTI NOT = CL-CRIT-PER-RECURRENT)
 13220*       MOVE 'CRIT PER RECURR'   TO SPLIT-INFO-DESC
 13221*       MOVE CL-CRIT-PER-RECURRENT
 13222*                                TO SPLIT-INFO-OLD
 13223*       PERFORM 2650-WRITE-MAINT-NOTE
 13224*                                THRU 2650-EXIT
 13225*    END-IF
 13226
 13227*    IF (RTWMOSL > ZERO)
 13228*       AND (RTWMOSI NOT = LOW-VALUES)
 13229*       AND (RTWMOSI NOT = CL-CRIT-PER-RTW-MOS)
 13230*       MOVE 'CRIT PER RTW MO'   TO SPLIT-INFO-DESC
 13231*       MOVE CL-CRIT-PER-RTW-MOS TO SPLIT-INFO-OLD
 13232*       PERFORM 2650-WRITE-MAINT-NOTE
 13233*                                THRU 2650-EXIT
 13234*    END-IF
 13235     IF MLNAMEL GREATER ZERO
 13236     IF MLNAMEI NOT = LOW-VALUES
 13237     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 13238         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 13239         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 13240         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13241
 13242     IF MFNAMEL GREATER ZERO
 13243     IF MFNAMEI NOT = LOW-VALUES
 13244     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 13245         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 13246         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 13247         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13248
 13249     IF MMINITL GREATER ZERO
 13250     IF MMINITI NOT = LOW-VALUES
 13251     IF MMINITI NOT = CL-INSURED-MID-INIT
 13252         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 13253         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 13254         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13255
 13256     IF CERTEFFL GREATER ZERO
 13257     IF HOLD-EFF NOT = LOW-VALUES
 13258     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 13259         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 13260         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 13261         MOVE SPACES               TO DC-OPTION-CODE
 13262         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13263         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13264         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 248
* EL131.cbl
 13265
 13266     IF CERTACTL GREATER ZERO
 13267     IF CERTACTI NOT = LOW-VALUES
 13268     IF CERTACTI NOT = CL-CERT-ACCOUNT
 13269         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 13270         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 13271         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13272
 13273     IF CERTSTL GREATER ZERO
 13274     IF CERTSTI NOT = LOW-VALUES
 13275     IF CERTSTI NOT = CL-CERT-STATE
 13276         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 13277         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 13278         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13279
 13280     IF CERTCARL GREATER ZERO
 13281     IF CERTCARI NOT = LOW-VALUES
 13282     IF CERTCARI NOT = CL-CERT-CARRIER
 13283         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 13284         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 13285         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13286
 13287     IF CERTGRPL GREATER ZERO
 13288     IF CERTGRPI NOT = LOW-VALUES
 13289     IF CERTGRPI NOT = CL-CERT-GROUPING
 13290         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 13291         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 13292         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13293
 13294     IF CERTL GREATER ZERO OR
 13295        SUFXL GREATER ZERO
 13296     IF (CERTI NOT = LOW-VALUES AND
 13297                     CL-CERT-PRIME)
 13298                OR
 13299        (SUFXI NOT = LOW-VALUES AND
 13300                     CL-CERT-SFX)
 13301         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 13302         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 13303         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13304     IF incl > zeros
 13305        IF (HOLD-INCUR NOT = LOW-VALUES)
 13306           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 13307           MOVE 'INC DTE'        TO SPLIT-INFO-DESC
 13308           MOVE CL-INCURRED-DT   TO DC-BIN-DATE-1
 13309           MOVE SPACES           TO DC-OPTION-CODE
 13310           PERFORM 9800-CONVERT-DATE
 13311                                 THRU 9800-EXIT
 13312           MOVE DC-GREG-DATE-1-EDIT
 13313                                 TO SPLIT-INFO-OLD
 13314           PERFORM 2650-WRITE-MAINT-NOTE
 13315                                 THRU 2650-EXIT
 13316        END-IF
 13317     END-IF
 13318     IF PI-STATE = 'VA' OR 'PA' OR 'GA'
 13319       IF (REPL GREATER ZERO
 13320         AND HOLD-REPORTED NOT = LOW-VALUES
 13321         AND HOLD-REPORTED NOT = CL-REPORTED-DT)
 13322        OR (incl > zeros
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 249
* EL131.cbl
 13323          AND (HOLD-INCUR NOT = LOW-VALUES)
 13324             AND (HOLD-INCUR NOT = CL-INCURRED-DT))
 13325          PERFORM 2610-CHECK-2-YEAR-CONTESTABLE THRU 2610-EXIT
 13326       END-IF
 13327     END-IF
 13328     .
 13329 2600-EXIT.
 13330      EXIT.
 13331 2610-CHECK-2-YEAR-CONTESTABLE.
 13332     SET ELAPSED-BETWEEN-BIN TO TRUE
 13333     MOVE ZERO               TO DC-ELAPSED-MONTHS
 13334                                DC-ELAPSED-DAYS
 13335
 13336     MOVE HOLD-EFF TO DC-BIN-DATE-1.
 13337     IF HOLD-INCUR > SPACES
 13338        MOVE HOLD-INCUR TO DC-BIN-DATE-2
 13339     ELSE
 13340        MOVE CL-INCURRED-DT TO DC-BIN-DATE-2
 13341     END-IF
 13342     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 13343     IF DC-ODD-DAYS-OVER > ZERO
 13344        ADD 1 TO DC-ELAPSED-MONTHS
 13345     END-IF
 13346
 13347     IF DC-ELAPSED-MONTHS <= 24
 13348        IF HOLD-REPORTED > SPACES
 13349           MOVE HOLD-REPORTED TO DC-BIN-DATE-2
 13350        ELSE
 13351           MOVE CL-REPORTED-DT TO DC-BIN-DATE-2
 13352        END-IF
 13353        MOVE ZERO           TO DC-ELAPSED-MONTHS
 13354                               DC-ELAPSED-DAYS
 13355        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13356        IF DC-ODD-DAYS-OVER > ZERO
 13357           ADD 1 TO DC-ELAPSED-MONTHS
 13358        END-IF
 13359        IF DC-ELAPSED-MONTHS > 24
 13360           MOVE ER-1679            TO EMI-ERROR
 13361           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13362        END-IF
 13363     END-IF.
 13364
 13365     PERFORM 2615-CHECK-TRLR THRU 2615-EXIT.
 13366
 13367 2610-EXIT.
 13368     EXIT.
 13369 2615-CHECK-TRLR.
 13370
 13371     MOVE CL-CONTROL-PRIMARY   TO TRLR-KEY
 13372     MOVE +96              TO TRLR-SEQ-NO
 13373
 13374* EXEC CICS READ
 13375*       UPDATE
 13376*       DATASET  ('ELTRLR')
 13377*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13378*       RIDFLD   (TRLR-KEY)
 13379*       RESP     (WS-RESPONSE)
 13380*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 250
* EL131.cbl
 13381     MOVE 'ELTRLR' TO DFHEIV1
 13382*    MOVE '&"S        EU         (  N#00011637' TO DFHEIV0
 13383     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13384     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13385     MOVE X'204E233030303131363337' TO DFHEIV0(25:11)
 13386     CALL 'kxdfhei1' USING DFHEIV0,
 13387           DFHEIV1,
 13388           DFHEIV20,
 13389           DFHEIV99,
 13390           TRLR-KEY,
 13391           DFHEIV99,
 13392           DFHEIV99,
 13393           DFHEIV99
 13394     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13395         DFHEIV20
 13396     MOVE EIBRESP  TO WS-RESPONSE
 13397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13398     IF WS-RESP-NORMAL
 13399        IF EMI-ERROR =  ER-1679
 13400           IF EMI-ERROR-NUMBER(1) = ER-1679
 13401              MOVE EMI-LINE1 TO AT-INFO-LINE-1
 13402           ELSE
 13403           IF EMI-ERROR-NUMBER(2) = ER-1679
 13404              MOVE EMI-LINE2 TO AT-INFO-LINE-1
 13405           ELSE
 13406           IF EMI-ERROR-NUMBER(3) = ER-1679
 13407              MOVE EMI-LINE3 TO AT-INFO-LINE-1
 13408           END-IF
 13409           END-IF
 13410           END-IF
 13411
 13412* EXEC CICS REWRITE
 13413*             DATASET   ('ELTRLR')
 13414*             FROM      (ACTIVITY-TRAILERS)
 13415*          END-EXEC
 13416     MOVE LENGTH OF
 13417      ACTIVITY-TRAILERS
 13418       TO DFHEIV11
 13419     MOVE 'ELTRLR' TO DFHEIV1
 13420*    MOVE '&& L                  %   #00011657' TO DFHEIV0
 13421     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13422     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13423     MOVE X'2020233030303131363537' TO DFHEIV0(25:11)
 13424     CALL 'kxdfhei1' USING DFHEIV0,
 13425           DFHEIV1,
 13426           ACTIVITY-TRAILERS,
 13427           DFHEIV11,
 13428           DFHEIV99
 13429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13430        ELSE
 13431           MOVE WS-CONTEST-NOTE TO AT-INFO-LINE-1
 13432
 13433* EXEC CICS REWRITE
 13434*                DATASET   ('ELTRLR')
 13435*                FROM      (ACTIVITY-TRAILERS)
 13436*             END-EXEC
 13437     MOVE LENGTH OF
 13438      ACTIVITY-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 251
* EL131.cbl
 13439       TO DFHEIV11
 13440     MOVE 'ELTRLR' TO DFHEIV1
 13441*    MOVE '&& L                  %   #00011663' TO DFHEIV0
 13442     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13443     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13444     MOVE X'2020233030303131363633' TO DFHEIV0(25:11)
 13445     CALL 'kxdfhei1' USING DFHEIV0,
 13446           DFHEIV1,
 13447           ACTIVITY-TRAILERS,
 13448           DFHEIV11,
 13449           DFHEIV99
 13450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13451        END-IF
 13452     ELSE
 13453
 13454* EXEC CICS GETMAIN
 13455*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13456*          LENGTH   (TRLR-LENGTH)
 13457*          INITIMG  (GETMAIN-SPACE)
 13458*       END-EXEC
 13459*    MOVE ',"IL                  $   #00011669' TO DFHEIV0
 13460     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13461     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13462     MOVE X'2020233030303131363639' TO DFHEIV0(25:11)
 13463     CALL 'kxdfhei1' USING DFHEIV0,
 13464           DFHEIV20,
 13465           TRLR-LENGTH,
 13466           GETMAIN-SPACE
 13467     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13468         DFHEIV20
 13469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13470        MOVE 'AT'          TO AT-RECORD-ID
 13471        MOVE CL-CONTROL-PRIMARY
 13472                           TO AT-CONTROL-PRIMARY
 13473        MOVE +96           TO AT-SEQUENCE-NO
 13474        MOVE '6'           TO AT-TRAILER-TYPE
 13475        MOVE SPACES             TO AT-GENERAL-INFO-TR
 13476        INITIALIZE AT-GENERAL-INFO-TR
 13477        IF EMI-ERROR-NUMBER(1) = ER-1679
 13478           MOVE EMI-LINE1 TO AT-INFO-LINE-1
 13479        ELSE
 13480        IF EMI-ERROR-NUMBER(2) = ER-1679
 13481           MOVE EMI-LINE2 TO AT-INFO-LINE-1
 13482        ELSE
 13483        IF EMI-ERROR-NUMBER(3) = ER-1679
 13484           MOVE EMI-LINE3 TO AT-INFO-LINE-1
 13485        END-IF
 13486        END-IF
 13487        END-IF
 13488        MOVE SPACE           TO AT-INFO-TRAILER-TYPE
 13489        MOVE SAVE-BIN-DATE TO AT-RECORDED-DT
 13490                              AT-GEN-INFO-LAST-MAINT-DT
 13491        MOVE PI-PROCESSOR-ID
 13492                           TO AT-RECORDED-BY
 13493                              AT-GEN-INFO-LAST-UPDATED-BY
 13494        MOVE EIBTIME       TO AT-LAST-MAINT-HHMMSS
 13495
 13496* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 252
* EL131.cbl
 13497*          DATASET   ('ELTRLR')
 13498*          FROM      (ACTIVITY-TRAILERS)
 13499*          RIDFLD    (TRLR-KEY)
 13500*       END-EXEC
 13501     MOVE LENGTH OF
 13502      ACTIVITY-TRAILERS
 13503       TO DFHEIV11
 13504     MOVE 'ELTRLR' TO DFHEIV1
 13505*    MOVE '&$ L                  ''   #00011699' TO DFHEIV0
 13506     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13507     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13508     MOVE X'2020233030303131363939' TO DFHEIV0(25:11)
 13509     CALL 'kxdfhei1' USING DFHEIV0,
 13510           DFHEIV1,
 13511           ACTIVITY-TRAILERS,
 13512           DFHEIV11,
 13513           TRLR-KEY,
 13514           DFHEIV99,
 13515           DFHEIV99
 13516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13517     END-IF
 13518     .
 13519 2615-EXIT.
 13520     EXIT.
 13521
 13522
 13523 2650-WRITE-MAINT-NOTE.
 13524
 13525* EXEC CICS GETMAIN
 13526*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13527*         LENGTH   (TRLR-LENGTH)
 13528*         INITIMG  (GETMAIN-SPACE)
 13529*    END-EXEC.
 13530*    MOVE ',"IL                  $   #00011711' TO DFHEIV0
 13531     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13532     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13533     MOVE X'2020233030303131373131' TO DFHEIV0(25:11)
 13534     CALL 'kxdfhei1' USING DFHEIV0,
 13535           DFHEIV20,
 13536           TRLR-LENGTH,
 13537           GETMAIN-SPACE
 13538     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13539         DFHEIV20
 13540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13541
 13542
 13543
 13544* EXEC CICS HANDLE CONDITION
 13545*         DUPREC   (2650-EXIT)
 13546*    END-EXEC.
 13547*    MOVE '"$%                   ! ; #00011717' TO DFHEIV0
 13548     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 13549     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13550     MOVE X'3B20233030303131373137' TO DFHEIV0(25:11)
 13551     CALL 'kxdfhei1' USING DFHEIV0
 13552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13553
 13554
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 253
* EL131.cbl
 13555     MOVE SPACES             TO ACTIVITY-TRAILERS.
 13556
 13557     IF CERTL GREATER ZERO
 13558         MOVE CERTI          TO CL-CERT-PRIME.
 13559
 13560     IF SUFXL GREATER ZERO
 13561         MOVE SUFXI          TO CL-CERT-SFX.
 13562
 13563     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 13564
 13565     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 13566     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 13567
 13568     MOVE 'AT'               TO AT-RECORD-ID.
 13569
 13570     MOVE '6'                TO AT-TRAILER-TYPE.
 13571     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 13572                                AT-GEN-INFO-LAST-MAINT-DT.
 13573     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 13574                                AT-GEN-INFO-LAST-UPDATED-BY.
 13575     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 13576     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 13577     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 13578
 13579
 13580* EXEC CICS WRITE
 13581*         DATASET  (TRLR-FILE-ID)
 13582*         RIDFLD   (AT-CONTROL-PRIMARY)
 13583*         FROM     (ACTIVITY-TRAILERS)
 13584*    END-EXEC.
 13585     MOVE LENGTH OF
 13586      ACTIVITY-TRAILERS
 13587       TO DFHEIV11
 13588*    MOVE '&$ L                  ''   #00011745' TO DFHEIV0
 13589     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13590     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13591     MOVE X'2020233030303131373435' TO DFHEIV0(25:11)
 13592     CALL 'kxdfhei1' USING DFHEIV0,
 13593           TRLR-FILE-ID,
 13594           ACTIVITY-TRAILERS,
 13595           DFHEIV11,
 13596           AT-CONTROL-PRIMARY,
 13597           DFHEIV99,
 13598           DFHEIV99
 13599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13600
 13601
 13602 2650-EXIT.
 13603      EXIT.
 13604
 13605 2800-CHECK-AUTO-PAY.
 13606
 13607     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 13608     MOVE PI-CARRIER         TO TRLR-CARRIER.
 13609     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 13610     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 13611     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 13612
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 254
* EL131.cbl
 13613
 13614* EXEC CICS HANDLE CONDITION
 13615*         NOTFND    (2800-EXIT)
 13616*         ENDFILE   (2800-EXIT)
 13617*    END-EXEC.
 13618*    MOVE '"$I''                  ! < #00011762' TO DFHEIV0
 13619     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13620     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13621     MOVE X'3C20233030303131373632' TO DFHEIV0(25:11)
 13622     CALL 'kxdfhei1' USING DFHEIV0
 13623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13624
 13625
 13626
 13627* EXEC CICS READ
 13628*        DATASET (TRLR-FILE-ID)
 13629*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 13630*        RIDFLD  (TRLR-KEY)
 13631*    END-EXEC.
 13632*    MOVE '&"S        E          (   #00011767' TO DFHEIV0
 13633     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13634     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13635     MOVE X'2020233030303131373637' TO DFHEIV0(25:11)
 13636     CALL 'kxdfhei1' USING DFHEIV0,
 13637           TRLR-FILE-ID,
 13638           DFHEIV20,
 13639           DFHEIV99,
 13640           TRLR-KEY,
 13641           DFHEIV99,
 13642           DFHEIV99,
 13643           DFHEIV99
 13644     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13645         DFHEIV20
 13646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13647
 13648
 13649     IF BENEFICIARY-PAID-AUTO
 13650         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 13651     END-IF.
 13652
 13653 2800-EXIT.
 13654      EXIT.
 13655
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 255
* EL131.cbl
 13657 3000-DELETE-CLAIM.
 13658     IF  NOT MODIFY-CAP
 13659         MOVE ER-0070            TO EMI-ERROR
 13660         MOVE -1                 TO MAINTL
 13661         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13662         GO TO 8110-SEND-DATA.
 13663
 13664
 13665* EXEC CICS READ
 13666*         SET      (ADDRESS OF CLAIM-MASTER)
 13667*         DATASET  (CLMS-FILE-ID)
 13668*         RIDFLD   (MSTR-KEY)
 13669*    END-EXEC.
 13670*    MOVE '&"S        E          (   #00011788' TO DFHEIV0
 13671     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13672     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13673     MOVE X'2020233030303131373838' TO DFHEIV0(25:11)
 13674     CALL 'kxdfhei1' USING DFHEIV0,
 13675           CLMS-FILE-ID,
 13676           DFHEIV20,
 13677           DFHEIV99,
 13678           MSTR-KEY,
 13679           DFHEIV99,
 13680           DFHEIV99,
 13681           DFHEIV99
 13682     SET ADDRESS OF CLAIM-MASTER TO
 13683         DFHEIV20
 13684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13685
 13686
 13687     IF CL-1ST-TRL-AVAIL
 13688         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 13689     ELSE
 13690        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 13691        MOVE 0                   TO TRLR-SEQ-NO
 13692
 13693* EXEC CICS STARTBR
 13694*            DATASET (TRLR-FILE-ID)
 13695*            RIDFLD  (TRLR-KEY)
 13696*        END-EXEC
 13697     MOVE 0
 13698       TO DFHEIV11
 13699*    MOVE '&,         G          &   #00011799' TO DFHEIV0
 13700     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13701     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13702     MOVE X'2020233030303131373939' TO DFHEIV0(25:11)
 13703     CALL 'kxdfhei1' USING DFHEIV0,
 13704           TRLR-FILE-ID,
 13705           TRLR-KEY,
 13706           DFHEIV99,
 13707           DFHEIV11,
 13708           DFHEIV99
 13709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13710         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 13711
 13712* EXEC CICS ENDBR
 13713*            DATASET (TRLR-FILE-ID)
 13714*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 256
* EL131.cbl
 13715     MOVE 0
 13716       TO DFHEIV11
 13717*    MOVE '&2                    $   #00011804' TO DFHEIV0
 13718     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13719     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13720     MOVE X'2020233030303131383034' TO DFHEIV0(25:11)
 13721     CALL 'kxdfhei1' USING DFHEIV0,
 13722           TRLR-FILE-ID,
 13723           DFHEIV11,
 13724           DFHEIV99
 13725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13726        IF SCREEN-ERROR
 13727            MOVE ER-0208         TO EMI-ERROR
 13728            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13729            MOVE -1              TO MAINTL
 13730            GO TO 8110-SEND-DATA
 13731        ELSE
 13732            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 13733
 13734     IF SCREEN-ERROR
 13735         MOVE -1                 TO MAINTL
 13736         GO TO 8110-SEND-DATA.
 13737
 13738     MOVE -1                     TO ONE-OR-MIN1.
 13739     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 13740
 13741     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 13742         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 13743                                    WS-SAVE-CLAIM-KEY
 13744         MOVE +1                 TO ONE-OR-MIN1
 13745         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 13746
 13747     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 13748
 13749     MOVE LOW-VALUES             TO EL131AO.
 13750     MOVE ER-0000                TO EMI-ERROR.
 13751     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13752     MOVE 'X'                    TO PI-RETURN-CD-1.
 13753     MOVE -1                     TO MAINTL.
 13754     GO TO 8100-SEND-MAP.
 13755
 13756 3010-DEL-MSTR-TRLR.
 13757
 13758* EXEC CICS READ UPDATE
 13759*         SET       (ADDRESS OF CLAIM-MASTER)
 13760*         DATASET   (CLMS-FILE-ID)
 13761*         RIDFLD    (MSTR-KEY)
 13762*    END-EXEC.
 13763*    MOVE '&"S        EU         (   #00011838' TO DFHEIV0
 13764     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13765     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13766     MOVE X'2020233030303131383338' TO DFHEIV0(25:11)
 13767     CALL 'kxdfhei1' USING DFHEIV0,
 13768           CLMS-FILE-ID,
 13769           DFHEIV20,
 13770           DFHEIV99,
 13771           MSTR-KEY,
 13772           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 257
* EL131.cbl
 13773           DFHEIV99,
 13774           DFHEIV99
 13775     SET ADDRESS OF CLAIM-MASTER TO
 13776         DFHEIV20
 13777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13778
 13779
 13780     if (cl-priority-cd = '8')
 13781        and (pi-processor-id not = 'PEMA' and 'JMS '
 13782             AND 'AMWA')
 13783        MOVE ER-8003             TO EMI-ERROR
 13784        PERFORM 9900-ERROR-FORMAT
 13785                                 THRU 9900-EXIT
 13786        MOVE -1                  TO MAINTL
 13787        GO TO 8110-SEND-DATA
 13788     end-if
 13789
 13790     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 13791     MOVE ZERO                   TO TRLR-SEQ-NO.
 13792
 13793
 13794* EXEC CICS HANDLE CONDITION
 13795*         NOTFND    (3010-DEL-ACTQ)
 13796*         ENDFILE   (3040-EXIT)
 13797*    END-EXEC.
 13798*    MOVE '"$I''                  ! = #00011857' TO DFHEIV0
 13799     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13800     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13801     MOVE X'3D20233030303131383537' TO DFHEIV0(25:11)
 13802     CALL 'kxdfhei1' USING DFHEIV0
 13803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13804
 13805
 13806     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 13807
 13808 3010-DEL-ACTQ.
 13809
 13810
 13811* EXEC CICS HANDLE CONDITION
 13812*         NOTFND    (3010-NO-ACTIVITY)
 13813*         ENDFILE   (3050-EXIT)
 13814*    END-EXEC.
 13815*    MOVE '"$I''                  ! > #00011866' TO DFHEIV0
 13816     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13817     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13818     MOVE X'3E20233030303131383636' TO DFHEIV0(25:11)
 13819     CALL 'kxdfhei1' USING DFHEIV0
 13820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13821
 13822
 13823
 13824* EXEC CICS STARTBR
 13825*         DATASET  (ACTQ-FILE-ID)
 13826*         RIDFLD   (ACTQ-KEY)
 13827*    END-EXEC.
 13828     MOVE 0
 13829       TO DFHEIV11
 13830*    MOVE '&,         G          &   #00011871' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 258
* EL131.cbl
 13831     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13832     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13833     MOVE X'2020233030303131383731' TO DFHEIV0(25:11)
 13834     CALL 'kxdfhei1' USING DFHEIV0,
 13835           ACTQ-FILE-ID,
 13836           ACTQ-KEY,
 13837           DFHEIV99,
 13838           DFHEIV11,
 13839           DFHEIV99
 13840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13841
 13842
 13843
 13844* EXEC CICS GETMAIN
 13845*         SET      (ADDRESS OF ACTIVITY-QUE)
 13846*         LENGTH   (ACTQ-LENGTH)
 13847*         INITIMG  (GETMAIN-SPACE)
 13848*    END-EXEC.
 13849*    MOVE ',"IL                  $   #00011876' TO DFHEIV0
 13850     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13851     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13852     MOVE X'2020233030303131383736' TO DFHEIV0(25:11)
 13853     CALL 'kxdfhei1' USING DFHEIV0,
 13854           DFHEIV20,
 13855           ACTQ-LENGTH,
 13856           GETMAIN-SPACE
 13857     SET ADDRESS OF ACTIVITY-QUE TO
 13858         DFHEIV20
 13859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13860
 13861
 13862     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 13863
 13864
 13865* EXEC CICS ENDBR
 13866*         DATASET (ACTQ-FILE-ID)
 13867*    END-EXEC.
 13868     MOVE 0
 13869       TO DFHEIV11
 13870*    MOVE '&2                    $   #00011884' TO DFHEIV0
 13871     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13872     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13873     MOVE X'2020233030303131383834' TO DFHEIV0(25:11)
 13874     CALL 'kxdfhei1' USING DFHEIV0,
 13875           ACTQ-FILE-ID,
 13876           DFHEIV11,
 13877           DFHEIV99
 13878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13879
 13880
 13881 3010-NO-ACTIVITY.
 13882
 13883
 13884* EXEC CICS HANDLE CONDITION
 13885*        NOTFND   (3010-CERT-NOT-FOUND)
 13886*    END-EXEC.
 13887*    MOVE '"$I                   ! ? #00011890' TO DFHEIV0
 13888     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 259
* EL131.cbl
 13889     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13890     MOVE X'3F20233030303131383930' TO DFHEIV0(25:11)
 13891     CALL 'kxdfhei1' USING DFHEIV0
 13892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13893
 13894
 13895     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 13896     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 13897     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 13898     MOVE CL-CERT-STATE          TO CERT-STATE.
 13899     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 13900     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 13901     MOVE CL-CERT-NO             TO CERT-CERT.
 13902
 13903
 13904* EXEC CICS READ
 13905*        DATASET   (CERT-FILE-ID)
 13906*        RIDFLD    (CERT-KEY)
 13907*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 13908*    END-EXEC.
 13909*    MOVE '&"S        E          (   #00011902' TO DFHEIV0
 13910     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13911     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13912     MOVE X'2020233030303131393032' TO DFHEIV0(25:11)
 13913     CALL 'kxdfhei1' USING DFHEIV0,
 13914           CERT-FILE-ID,
 13915           DFHEIV20,
 13916           DFHEIV99,
 13917           CERT-KEY,
 13918           DFHEIV99,
 13919           DFHEIV99,
 13920           DFHEIV99
 13921     SET ADDRESS OF CERTIFICATE-MASTER TO
 13922         DFHEIV20
 13923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13924
 13925
 13926     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 13927       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 13928         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 13929     ELSE
 13930         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 13931
 13932 3010-UPDATE-CERT-TRLR.
 13933
 13934     MOVE CERT-KEY               TO ELCRTT-KEY
 13935     MOVE 'B'                    TO CTRLR-REC-TYPE
 13936
 13937* EXEC CICS READ
 13938*       UPDATE
 13939*       DATASET   ('ELCRTT')
 13940*       RIDFLD    (ELCRTT-KEY)
 13941*       INTO      (CERTIFICATE-TRAILERS)
 13942*       RESP      (WS-RESPONSE)
 13943*    END-EXEC
 13944     MOVE LENGTH OF
 13945      CERTIFICATE-TRAILERS
 13946       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 260
* EL131.cbl
 13947     MOVE 'ELCRTT' TO DFHEIV1
 13948*    MOVE '&"IL       EU         (  N#00011918' TO DFHEIV0
 13949     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13950     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13951     MOVE X'204E233030303131393138' TO DFHEIV0(25:11)
 13952     CALL 'kxdfhei1' USING DFHEIV0,
 13953           DFHEIV1,
 13954           CERTIFICATE-TRAILERS,
 13955           DFHEIV11,
 13956           ELCRTT-KEY,
 13957           DFHEIV99,
 13958           DFHEIV99,
 13959           DFHEIV99
 13960     MOVE EIBRESP  TO WS-RESPONSE
 13961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13962     IF WS-RESP-NORMAL
 13963        perform varying s1 from +1 by +1 until
 13964           (s1 > +24)
 13965           or (cs-claim-no (s1) = cl-claim-no)
 13966        end-perform
 13967        if s1 < +25
 13968           move spaces           to cs-claim-no (s1)
 13969                                    cs-claim-type (s1)
 13970                                    cs-insured-type (s1)
 13971           move zeros            to cs-days-paid (s1)
 13972                                    cs-total-paid (s1)
 13973                                    cs-benefit-period (s1)
 13974           if s1 not = +24
 13975              compute s2 = s1 + +1
 13976              perform 3015-bump  thru 3015-exit
 13977           end-if
 13978
 13979* EXEC CICS REWRITE
 13980*             DATASET   ('ELCRTT')
 13981*             FROM      (CERTIFICATE-TRAILERS)
 13982*          END-EXEC
 13983     MOVE LENGTH OF
 13984      CERTIFICATE-TRAILERS
 13985       TO DFHEIV11
 13986     MOVE 'ELCRTT' TO DFHEIV1
 13987*    MOVE '&& L                  %   #00011941' TO DFHEIV0
 13988     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13989     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13990     MOVE X'2020233030303131393431' TO DFHEIV0(25:11)
 13991     CALL 'kxdfhei1' USING DFHEIV0,
 13992           DFHEIV1,
 13993           CERTIFICATE-TRAILERS,
 13994           DFHEIV11,
 13995           DFHEIV99
 13996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13997        end-if
 13998     end-if
 13999     .
 14000 3010-CERT-NOT-FOUND.
 14001
 14002
 14003* EXEC CICS DELETE
 14004*        DATASET  (CLMS-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 261
* EL131.cbl
 14005*    END-EXEC.
 14006*    MOVE '&(                    &   #00011950' TO DFHEIV0
 14007     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14008     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14009     MOVE X'2020233030303131393530' TO DFHEIV0(25:11)
 14010     CALL 'kxdfhei1' USING DFHEIV0,
 14011           CLMS-FILE-ID,
 14012           DFHEIV99,
 14013           DFHEIV99,
 14014           DFHEIV99,
 14015           DFHEIV99
 14016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14017
 14018
 14019 3010-EXIT.
 14020      EXIT.
 14021
 14022 3015-bump.
 14023     perform varying s2 from s2 by +1 until s2 > +24
 14024        move cs-mb-claim-data (s2)
 14025                                 to cs-mb-claim-data (s1)
 14026        move spaces              to cs-mb-claim-data (s2)
 14027        add +1 to s1
 14028     end-perform
 14029     .
 14030 3015-exit.
 14031     exit.
 14032 3020-UPDATE-CERT.
 14033
 14034* EXEC CICS READ UPDATE
 14035*         DATASET  (CERT-FILE-ID)
 14036*         RIDFLD   (CERT-KEY)
 14037*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14038*    END-EXEC.
 14039*    MOVE '&"S        EU         (   #00011968' TO DFHEIV0
 14040     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14041     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14042     MOVE X'2020233030303131393638' TO DFHEIV0(25:11)
 14043     CALL 'kxdfhei1' USING DFHEIV0,
 14044           CERT-FILE-ID,
 14045           DFHEIV20,
 14046           DFHEIV99,
 14047           CERT-KEY,
 14048           DFHEIV99,
 14049           DFHEIV99,
 14050           DFHEIV99
 14051     SET ADDRESS OF CERTIFICATE-MASTER TO
 14052         DFHEIV20
 14053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14054
 14055
 14056     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 14057
 14058
 14059* EXEC CICS HANDLE CONDITION
 14060*         DUPKEY   (3020-EXIT)
 14061*    END-EXEC.
 14062*    MOVE '"$$                   ! @ #00011976' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 262
* EL131.cbl
 14063     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 14064     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14065     MOVE X'4020233030303131393736' TO DFHEIV0(25:11)
 14066     CALL 'kxdfhei1' USING DFHEIV0
 14067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14068
 14069
 14070
 14071* EXEC CICS REWRITE
 14072*         DATASET  (CERT-FILE-ID)
 14073*         FROM     (CERTIFICATE-MASTER)
 14074*    END-EXEC.
 14075     MOVE LENGTH OF
 14076      CERTIFICATE-MASTER
 14077       TO DFHEIV11
 14078*    MOVE '&& L                  %   #00011980' TO DFHEIV0
 14079     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14080     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14081     MOVE X'2020233030303131393830' TO DFHEIV0(25:11)
 14082     CALL 'kxdfhei1' USING DFHEIV0,
 14083           CERT-FILE-ID,
 14084           CERTIFICATE-MASTER,
 14085           DFHEIV11,
 14086           DFHEIV99
 14087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14088
 14089
 14090 3020-EXIT.
 14091     EXIT.
 14092
 14093 3030-DELETE-CERT.
 14094
 14095* EXEC CICS READ UPDATE
 14096*         DATASET  (CERT-FILE-ID)
 14097*         RIDFLD   (CERT-KEY)
 14098*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14099*    END-EXEC.
 14100*    MOVE '&"S        EU         (   #00011989' TO DFHEIV0
 14101     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14102     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14103     MOVE X'2020233030303131393839' TO DFHEIV0(25:11)
 14104     CALL 'kxdfhei1' USING DFHEIV0,
 14105           CERT-FILE-ID,
 14106           DFHEIV20,
 14107           DFHEIV99,
 14108           CERT-KEY,
 14109           DFHEIV99,
 14110           DFHEIV99,
 14111           DFHEIV99
 14112     SET ADDRESS OF CERTIFICATE-MASTER TO
 14113         DFHEIV20
 14114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14115
 14116
 14117
 14118* EXEC CICS DELETE
 14119*         DATASET   (CERT-FILE-ID)
 14120*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 263
* EL131.cbl
 14121*    MOVE '&(                    &   #00011995' TO DFHEIV0
 14122     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14123     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14124     MOVE X'2020233030303131393935' TO DFHEIV0(25:11)
 14125     CALL 'kxdfhei1' USING DFHEIV0,
 14126           CERT-FILE-ID,
 14127           DFHEIV99,
 14128           DFHEIV99,
 14129           DFHEIV99,
 14130           DFHEIV99
 14131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14132
 14133
 14134 3030-EXIT.
 14135     EXIT.
 14136
 14137 3040-DELETE-TRLR.
 14138
 14139* EXEC CICS READ
 14140*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14141*         DATASET  (TRLR-FILE-ID)
 14142*         RIDFLD   (TRLR-KEY)
 14143*         GTEQ
 14144*    END-EXEC.
 14145*    MOVE '&"S        G          (   #00012003' TO DFHEIV0
 14146     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14147     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14148     MOVE X'2020233030303132303033' TO DFHEIV0(25:11)
 14149     CALL 'kxdfhei1' USING DFHEIV0,
 14150           TRLR-FILE-ID,
 14151           DFHEIV20,
 14152           DFHEIV99,
 14153           TRLR-KEY,
 14154           DFHEIV99,
 14155           DFHEIV99,
 14156           DFHEIV99
 14157     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14158         DFHEIV20
 14159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14160
 14161
 14162     IF PI-COMPANY-CD = AT-COMPANY-CD
 14163        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 14164        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 14165           GO TO 3040-EXIT
 14166        ELSE
 14167           NEXT SENTENCE
 14168     ELSE
 14169        GO TO 3040-EXIT.
 14170
 14171
 14172* EXEC CICS DELETE
 14173*         DATASET  (TRLR-FILE-ID)
 14174*         RIDFLD   (TRLR-KEY)
 14175*    END-EXEC.
 14176*    MOVE '&(  R                 &   #00012019' TO DFHEIV0
 14177     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 14178     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 264
* EL131.cbl
 14179     MOVE X'2020233030303132303139' TO DFHEIV0(25:11)
 14180     CALL 'kxdfhei1' USING DFHEIV0,
 14181           TRLR-FILE-ID,
 14182           TRLR-KEY,
 14183           DFHEIV99,
 14184           DFHEIV99,
 14185           DFHEIV99
 14186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14187
 14188
 14189     GO TO 3040-DELETE-TRLR.
 14190
 14191 3040-EXIT.
 14192     EXIT.
 14193
 14194 3050-DELETE-ACTQ.
 14195
 14196* EXEC CICS READNEXT
 14197*         DATASET  (ACTQ-FILE-ID)
 14198*         RIDFLD   (ACTQ-KEY)
 14199*         INTO     (ACTIVITY-QUE)
 14200*    END-EXEC.
 14201     MOVE LENGTH OF
 14202      ACTIVITY-QUE
 14203       TO DFHEIV12
 14204     MOVE 0
 14205       TO DFHEIV11
 14206*    MOVE '&.IL                  )   #00012030' TO DFHEIV0
 14207     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 14208     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14209     MOVE X'2020233030303132303330' TO DFHEIV0(25:11)
 14210     CALL 'kxdfhei1' USING DFHEIV0,
 14211           ACTQ-FILE-ID,
 14212           ACTIVITY-QUE,
 14213           DFHEIV12,
 14214           ACTQ-KEY,
 14215           DFHEIV99,
 14216           DFHEIV11,
 14217           DFHEIV99,
 14218           DFHEIV99
 14219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14220
 14221
 14222     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 14223         GO TO 3050-EXIT.
 14224
 14225
 14226* EXEC CICS ENDBR
 14227*         DATASET  (ACTQ-FILE-ID)
 14228*    END-EXEC.
 14229     MOVE 0
 14230       TO DFHEIV11
 14231*    MOVE '&2                    $   #00012039' TO DFHEIV0
 14232     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14233     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14234     MOVE X'2020233030303132303339' TO DFHEIV0(25:11)
 14235     CALL 'kxdfhei1' USING DFHEIV0,
 14236           ACTQ-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 265
* EL131.cbl
 14237           DFHEIV11,
 14238           DFHEIV99
 14239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14240
 14241
 14242
 14243* EXEC CICS DELETE
 14244*         DATASET   (ACTQ-FILE-ID)
 14245*         RIDFLD    (ACTQ-KEY)
 14246*    END-EXEC.
 14247*    MOVE '&(  R                 &   #00012043' TO DFHEIV0
 14248     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 14249     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14250     MOVE X'2020233030303132303433' TO DFHEIV0(25:11)
 14251     CALL 'kxdfhei1' USING DFHEIV0,
 14252           ACTQ-FILE-ID,
 14253           ACTQ-KEY,
 14254           DFHEIV99,
 14255           DFHEIV99,
 14256           DFHEIV99
 14257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14258
 14259
 14260
 14261* EXEC CICS STARTBR
 14262*         DATASET   (ACTQ-FILE-ID)
 14263*         RIDFLD    (ACTQ-KEY)
 14264*    END-EXEC.
 14265     MOVE 0
 14266       TO DFHEIV11
 14267*    MOVE '&,         G          &   #00012048' TO DFHEIV0
 14268     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14269     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14270     MOVE X'2020233030303132303438' TO DFHEIV0(25:11)
 14271     CALL 'kxdfhei1' USING DFHEIV0,
 14272           ACTQ-FILE-ID,
 14273           ACTQ-KEY,
 14274           DFHEIV99,
 14275           DFHEIV11,
 14276           DFHEIV99
 14277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14278
 14279
 14280     GO TO 3050-DELETE-ACTQ.
 14281
 14282 3050-EXIT.
 14283     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 266
* EL131.cbl
 14285 3060-READ-TRLR.
 14286
 14287* EXEC CICS HANDLE CONDITION
 14288*         NOTFND    (3060-EXIT)
 14289*         ENDFILE   (3060-EXIT)
 14290*    END-EXEC.
 14291*    MOVE '"$I''                  ! A #00012059' TO DFHEIV0
 14292     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14293     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14294     MOVE X'4120233030303132303539' TO DFHEIV0(25:11)
 14295     CALL 'kxdfhei1' USING DFHEIV0
 14296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14297
 14298
 14299 3060-LOOP.
 14300
 14301* EXEC CICS READNEXT
 14302*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14303*         DATASET  (TRLR-FILE-ID)
 14304*         RIDFLD   (TRLR-KEY)
 14305*    END-EXEC.
 14306     MOVE 0
 14307       TO DFHEIV11
 14308*    MOVE '&.S                   )   #00012065' TO DFHEIV0
 14309     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14310     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14311     MOVE X'2020233030303132303635' TO DFHEIV0(25:11)
 14312     CALL 'kxdfhei1' USING DFHEIV0,
 14313           TRLR-FILE-ID,
 14314           DFHEIV20,
 14315           DFHEIV99,
 14316           TRLR-KEY,
 14317           DFHEIV99,
 14318           DFHEIV11,
 14319           DFHEIV99,
 14320           DFHEIV99
 14321     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14322         DFHEIV20
 14323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14324
 14325
 14326     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 14327         GO TO 3060-EXIT.
 14328
 14329     IF FORM-CONTROL-TR
 14330         IF AT-RECORDED-DT = SAVE-BIN-DATE
 14331             NEXT SENTENCE
 14332         ELSE
 14333             MOVE 'X'            TO ERROR-SWITCH
 14334             GO TO 3060-EXIT
 14335     ELSE
 14336         IF PAYMENT-TR OR CORRESPONDENCE-TR
 14337            MOVE 'X'                 TO ERROR-SWITCH
 14338            GO TO 3060-EXIT.
 14339
 14340     GO TO 3060-LOOP.
 14341
 14342 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 267
* EL131.cbl
 14343     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 268
* EL131.cbl
 14345 3997-GET-ERPDEF.
 14346
 14347     move cl-company-cd          to cert-company-code
 14348     move cl-cert-key-data       to cert-key (2:21)
 14349     move cl-cert-no             to cert-cert
 14350
 14351
 14352* EXEC CICS READ
 14353*        DATASET   (CERT-FILE-ID)
 14354*        RIDFLD    (CERT-KEY)
 14355*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 14356*        resp      (ws-response)
 14357*    END-EXEC
 14358*    MOVE '&"S        E          (  N#00012096' TO DFHEIV0
 14359     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14360     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14361     MOVE X'204E233030303132303936' TO DFHEIV0(25:11)
 14362     CALL 'kxdfhei1' USING DFHEIV0,
 14363           CERT-FILE-ID,
 14364           DFHEIV20,
 14365           DFHEIV99,
 14366           CERT-KEY,
 14367           DFHEIV99,
 14368           DFHEIV99,
 14369           DFHEIV99
 14370     SET ADDRESS OF CERTIFICATE-MASTER TO
 14371         DFHEIV20
 14372     MOVE EIBRESP  TO ws-response
 14373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14374
 14375     MOVE SPACES                 TO WS-CRIT-PER-ALPHA
 14376                                    WS-ERPDEF-SW
 14377     MOVE ZEROS                  TO WS-CRITICAL-PERIOD
 14378                                    WS-CRIT-PER-RTW-MOS
 14379
 14380     if cm-clp-state = spaces or low-values or zeros
 14381        move cm-state            to cm-clp-state
 14382     end-if
 14383     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 14384     MOVE CM-clp-state           TO ERPDEF-STATE
 14385     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 14386     evaluate true
 14387        when (cl-claim-type = 'L' or 'P')
 14388           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14389             and 'CU')
 14390           move 'L'              to erpdef-ben-type
 14391           move cm-lf-benefit-cd to erpdef-ben-code
 14392        when (cl-claim-type not = 'L' and 'P')
 14393           and (cm-ah-benefit-cd not = '00' and '  ')
 14394           move 'A'              to erpdef-ben-type
 14395           move cm-ah-benefit-cd to erpdef-ben-code
 14396        when (cl-claim-type not = 'L' and 'P')
 14397           and (cm-ah-benefit-cd = '00' or '  ')
 14398           move 'L'              to erpdef-ben-type
 14399           move cm-lf-benefit-cd to erpdef-ben-code
 14400        when (cl-claim-type = 'L' or 'P')
 14401           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 14402           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 269
* EL131.cbl
 14403           move cm-ah-benefit-cd to erpdef-ben-code
 14404        when other
 14405           move 'A'              to erpdef-ben-type
 14406           move cm-ah-benefit-cd to erpdef-ben-code
 14407     end-evaluate
 14408
 14409*    if (cl-claim-type = 'L' or 'P')
 14410*       and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14411*          and 'CU')
 14412*       move 'L'                 to erpdef-ben-type
 14413*       move cm-lf-benefit-cd    to erpdef-ben-code
 14414*    else
 14415*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
 14416*       MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 14417*    end-if
 14418     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 14419     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 14420
 14421
 14422* EXEC CICS STARTBR
 14423*        DATASET  ('ERPDEF')
 14424*        RIDFLD   (ERPDEF-KEY)
 14425*        GTEQ
 14426*        RESP     (WS-RESPONSE)
 14427*    END-EXEC
 14428     MOVE 'ERPDEF' TO DFHEIV1
 14429     MOVE 0
 14430       TO DFHEIV11
 14431*    MOVE '&,         G          &  N#00012149' TO DFHEIV0
 14432     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14433     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14434     MOVE X'204E233030303132313439' TO DFHEIV0(25:11)
 14435     CALL 'kxdfhei1' USING DFHEIV0,
 14436           DFHEIV1,
 14437           ERPDEF-KEY,
 14438           DFHEIV99,
 14439           DFHEIV11,
 14440           DFHEIV99
 14441     MOVE EIBRESP  TO WS-RESPONSE
 14442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14443
 14444     IF WS-RESP-NORMAL
 14445
 14446* EXEC CICS READNEXT
 14447*          DATASET  ('ERPDEF')
 14448*          INTO     (PRODUCT-MASTER)
 14449*          RIDFLD   (ERPDEF-KEY)
 14450*          RESP     (WS-RESPONSE)
 14451*       END-EXEC
 14452     MOVE LENGTH OF
 14453      PRODUCT-MASTER
 14454       TO DFHEIV12
 14455     MOVE 'ERPDEF' TO DFHEIV1
 14456     MOVE 0
 14457       TO DFHEIV11
 14458*    MOVE '&.IL                  )  N#00012157' TO DFHEIV0
 14459     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 14460     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 270
* EL131.cbl
 14461     MOVE X'204E233030303132313537' TO DFHEIV0(25:11)
 14462     CALL 'kxdfhei1' USING DFHEIV0,
 14463           DFHEIV1,
 14464           PRODUCT-MASTER,
 14465           DFHEIV12,
 14466           ERPDEF-KEY,
 14467           DFHEIV99,
 14468           DFHEIV11,
 14469           DFHEIV99,
 14470           DFHEIV99
 14471     MOVE EIBRESP  TO WS-RESPONSE
 14472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14473        IF WS-RESP-NORMAL
 14474           IF (ERPDEF-KEY-SAVE (1:16) =
 14475              PD-CONTROL-PRIMARY (1:16))
 14476              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 14477              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 14478                 (A1 > +8)
 14479                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 14480              END-PERFORM
 14481              IF A1 < +9
 14482                 SET ERPDEF-FOUND TO TRUE
 14483                 MOVE PD-CRIT-PERIOD (A1)
 14484                              TO WS-CRITICAL-PERIOD
 14485                 MOVE PD-REC-CRIT-PERIOD (A1)
 14486                              TO WS-CRIT-PER-RECURRENT
 14487                 IF PD-RTW-MOS (A1) NUMERIC
 14488                    MOVE PD-RTW-MOS (A1)
 14489                              TO WS-CRIT-PER-RTW-MOS
 14490                 ELSE
 14491                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 14492                 END-IF
 14493                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 14494                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 14495                                 TO WS-EXCL-PERIOD
 14496                 END-IF
 14497                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 14498                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 14499                                 TO WS-COV-ENDS
 14500                 END-IF
 14501                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 14502                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 14503                                 TO WS-ACC-PERIOD
 14504                 END-IF
 14505                 if pd-max-extension (a1) numeric
 14506                    move pd-max-extension (a1)
 14507                                 to ws-max-extension
 14508                 end-if
 14509                 if pd-max-amt (a1) numeric
 14510                    move pd-max-amt (a1)
 14511                                 to ws-max-moben
 14512                 end-if
 14513              END-IF
 14514           END-IF
 14515        END-IF
 14516     END-IF
 14517
 14518     .
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 271
* EL131.cbl
 14519 3997-EXIT.
 14520     EXIT.
 14521 4000-FORCE-ERRORS.
 14522     IF PI-RETURN-CD-1 = 'X'
 14523         MOVE ER-0311            TO EMI-ERROR
 14524         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14525         MOVE -1                 TO MAINTL
 14526         GO TO 8110-SEND-DATA.
 14527
 14528     IF NOT FORCE-CAP
 14529         MOVE ER-0416            TO EMI-ERROR
 14530         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14531         MOVE -1                 TO MAINTL
 14532         GO TO 8110-SEND-DATA.
 14533
 14534     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 14535     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 14536     IF EMI-FATAL-CTR GREATER THAN ZERO
 14537         GO TO 4000-FATAL-ERRORS.
 14538
 14539     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 14540
 14541     IF EMI-FATAL-CTR GREATER THAN ZERO
 14542         GO TO 4000-FATAL-ERRORS.
 14543
 14544     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 14545
 14546     IF EMI-FATAL-CTR GREATER THAN ZERO
 14547         GO TO 4000-FATAL-ERRORS.
 14548
 14549     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 14550     MOVE AL-UANOF               TO CERTA.
 14551     MOVE ER-0000 TO EMI-ERROR.
 14552     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14553
 14554 4000-FATAL-ERRORS.
 14555     MOVE -1                     TO MAINTL.
 14556     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 272
* EL131.cbl
 14558
 14559 4100-SAVE-CHANGES.
 14560     IF MAINTL > 0
 14561         MOVE MAINTI  TO WS-SAVE-MAINTI
 14562         MOVE MAINTL  TO WS-SAVE-MAINTL
 14563     END-IF
 14564     IF STATUSL > 0
 14565         MOVE STATUSI  TO WS-SAVE-STATUSI
 14566         MOVE STATUSL  TO WS-SAVE-STATUSL
 14567     END-IF
 14568     IF REPL > 0
 14569         MOVE REPI  TO WS-SAVE-REPI
 14570         MOVE REPL  TO WS-SAVE-REPL
 14571     END-IF
 14572*    IF CAUSEL > 0
 14573*        MOVE CAUSEI  TO WS-SAVE-CAUSEI
 14574*        MOVE CAUSEL  TO WS-SAVE-CAUSEL
 14575*    END-IF
 14576*    IF ENDL > 0
 14577*        MOVE ENDI  TO WS-SAVE-ENDI
 14578*        MOVE ENDL  TO WS-SAVE-ENDL
 14579*    END-IF
 14580     IF DIAGL > 0
 14581         MOVE DIAGI  TO WS-SAVE-DIAGI
 14582         MOVE DIAGL  TO WS-SAVE-DIAGL
 14583     END-IF
 14584     IF ICD1L > 0
 14585         MOVE ICD1I  TO WS-SAVE-ICD1I
 14586         MOVE ICD1L  TO WS-SAVE-ICD1L
 14587     END-IF
 14588     IF ICD2L > 0
 14589         MOVE ICD2I  TO WS-SAVE-ICD2I
 14590         MOVE ICD2L  TO WS-SAVE-ICD2L
 14591     END-IF
 14592     IF BENEL > 0
 14593         MOVE BENEI  TO WS-SAVE-BENEI
 14594         MOVE BENEL  TO WS-SAVE-BENEL
 14595     END-IF
 14596     IF BIRTHL > 0
 14597         MOVE BIRTHI  TO WS-SAVE-BIRTHI
 14598         MOVE BIRTHL  TO WS-SAVE-BIRTHL
 14599     END-IF
 14600     IF SOCIALL > 0
 14601         MOVE SOCIALI  TO WS-SAVE-SOCIALI
 14602         MOVE SOCIALL  TO WS-SAVE-SOCIALL
 14603     END-IF
 14604     IF SEXL > 0
 14605         MOVE SEXI  TO WS-SAVE-SEXI
 14606         MOVE SEXL  TO WS-SAVE-SEXL
 14607     END-IF
 14608     IF MLNAMEL > 0
 14609         MOVE MLNAMEI  TO WS-SAVE-MLNAMEI
 14610         MOVE MLNAMEL  TO WS-SAVE-MLNAMEL
 14611     END-IF
 14612     IF MFNAMEL > 0
 14613         MOVE MFNAMEI  TO WS-SAVE-MFNAMEI
 14614         MOVE MFNAMEL  TO WS-SAVE-MFNAMEL
 14615     END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 273
* EL131.cbl
 14616     IF MMINITL > 0
 14617         MOVE MMINITI  TO WS-SAVE-MMINITI
 14618         MOVE MMINITL  TO WS-SAVE-MMINITL
 14619     END-IF
 14620*    IF LOANNOL > 0
 14621*        MOVE LOANNOI  TO WS-SAVE-LOANNOI
 14622*        MOVE LOANNOL  TO WS-SAVE-LOANNOL
 14623*    END-IF
 14624     IF LOANBALL > 0
 14625         MOVE LOANBALI  TO WS-SAVE-LOANBALI
 14626         MOVE LOANBALL  TO WS-SAVE-LOANBALL
 14627     END-IF
 14628     IF PROCL > 0
 14629         MOVE PROCI  TO WS-SAVE-PROCI
 14630         MOVE PROCL  TO WS-SAVE-PROCL
 14631     END-IF
 14632     IF SUPVL > 0
 14633         MOVE SUPVI  TO WS-SAVE-SUPVI
 14634         MOVE SUPVL  TO WS-SAVE-SUPVL
 14635     END-IF
 14636     IF PRICDL > 0
 14637         MOVE PRICDI  TO WS-SAVE-PRICDI
 14638         MOVE PRICDL  TO WS-SAVE-PRICDL
 14639     END-IF
 14640     IF FILETOL > 0
 14641         MOVE FILETOI  TO WS-SAVE-FILETOI
 14642         MOVE FILETOL  TO WS-SAVE-FILETOL
 14643     END-IF
 14644     IF PDTHRUL > 0
 14645         MOVE PDTHRUI  TO WS-SAVE-PDTHRUI
 14646         MOVE PDTHRUL  TO WS-SAVE-PDTHRUL
 14647     END-IF
 14648     IF PDAMTL > 0
 14649         MOVE PDAMTI  TO WS-SAVE-PDAMTI
 14650         MOVE PDAMTL  TO WS-SAVE-PDAMTL
 14651     END-IF
 14652     IF NODAYSL > 0
 14653         MOVE NODAYSI  TO WS-SAVE-NODAYSI
 14654         MOVE NODAYSL  TO WS-SAVE-NODAYSL
 14655     END-IF
 14656     IF NOPMTSL > 0
 14657         MOVE NOPMTSI  TO WS-SAVE-NOPMTSI
 14658         MOVE NOPMTSL  TO WS-SAVE-NOPMTSL
 14659     END-IF
 14660     IF FORMTYPL > 0
 14661         MOVE FORMTYPI  TO WS-SAVE-FORMTYPI
 14662         MOVE FORMTYPL  TO WS-SAVE-FORMTYPL
 14663     END-IF
 14664     IF OCCL > 0
 14665         MOVE OCCI  TO WS-SAVE-OCCI
 14666         MOVE OCCL  TO WS-SAVE-OCCL
 14667     END-IF.
 14668 4100-EXIT.
 14669      EXIT.
 14670
 14671 4200-LOAD-CHANGES.
 14672     IF WS-SAVE-MAINTL > 0
 14673         MOVE WS-SAVE-MAINTI  TO MAINTI
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 274
* EL131.cbl
 14674         MOVE WS-SAVE-MAINTL  TO MAINTL
 14675         MOVE AL-UANON        TO MAINTA
 14676     END-IF
 14677     IF WS-SAVE-STATUSL > 0
 14678         MOVE WS-SAVE-STATUSI  TO STATUSI
 14679         MOVE WS-SAVE-STATUSL  TO STATUSL
 14680         MOVE AL-UANON         TO STATUSA
 14681     END-IF
 14682     IF WS-SAVE-REPL > 0
 14683         MOVE WS-SAVE-REPI  TO REPI
 14684         MOVE WS-SAVE-REPL  TO REPL
 14685         MOVE AL-UANON      TO REPA
 14686     END-IF
 14687*    IF WS-SAVE-CAUSEL > 0
 14688*        MOVE WS-SAVE-CAUSEI  TO CAUSEI
 14689*        MOVE WS-SAVE-CAUSEL  TO CAUSEL
 14690*        MOVE AL-UANON        TO CAUSEA
 14691*    END-IF
 14692*    IF WS-SAVE-ENDL > 0
 14693*        MOVE WS-SAVE-ENDI  TO ENDI
 14694*        MOVE WS-SAVE-ENDL  TO ENDL
 14695*        MOVE AL-UANON      TO ENDA
 14696*    END-IF
 14697     IF WS-SAVE-DIAGL > 0
 14698         MOVE WS-SAVE-DIAGI  TO DIAGI
 14699         MOVE WS-SAVE-DIAGL  TO DIAGL
 14700         MOVE AL-UANON       TO DIAGA
 14701     END-IF
 14702     IF WS-SAVE-ICD1L > 0
 14703         MOVE WS-SAVE-ICD1I  TO ICD1I
 14704         MOVE WS-SAVE-ICD1L  TO ICD1L
 14705         MOVE AL-UANON       TO ICD1A
 14706     END-IF
 14707     IF WS-SAVE-ICD2L > 0
 14708         MOVE WS-SAVE-ICD2I  TO ICD2I
 14709         MOVE WS-SAVE-ICD2L  TO ICD2L
 14710         MOVE AL-UANON       TO ICD2A
 14711     END-IF
 14712     IF WS-SAVE-BENEL > 0
 14713         MOVE WS-SAVE-BENEI  TO BENEI
 14714         MOVE WS-SAVE-BENEL  TO BENEL
 14715         MOVE AL-UANON       TO BENEA
 14716     END-IF
 14717     IF WS-SAVE-BIRTHL > 0
 14718         MOVE WS-SAVE-BIRTHI  TO BIRTHI
 14719         MOVE WS-SAVE-BIRTHL  TO BIRTHL
 14720         MOVE AL-UANON        TO BIRTHA
 14721     END-IF
 14722     IF WS-SAVE-SOCIALL > 0
 14723         MOVE WS-SAVE-SOCIALI  TO SOCIALI
 14724         MOVE WS-SAVE-SOCIALL  TO SOCIALL
 14725         MOVE AL-UANON         TO SOCIALA
 14726     END-IF
 14727     IF WS-SAVE-SEXL > 0
 14728         MOVE WS-SAVE-SEXI  TO SEXI
 14729         MOVE WS-SAVE-SEXL  TO SEXL
 14730         MOVE AL-UANON      TO SEXA
 14731     END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 275
* EL131.cbl
 14732     IF WS-SAVE-MLNAMEL > 0
 14733         MOVE WS-SAVE-MLNAMEI  TO MLNAMEI
 14734         MOVE WS-SAVE-MLNAMEL  TO MLNAMEL
 14735         MOVE AL-UANON         TO MLNAMEA
 14736     END-IF
 14737     IF WS-SAVE-MFNAMEL > 0
 14738         MOVE WS-SAVE-MFNAMEI  TO MFNAMEI
 14739         MOVE WS-SAVE-MFNAMEL  TO MFNAMEL
 14740         MOVE AL-UANON         TO MFNAMEA
 14741     END-IF
 14742     IF WS-SAVE-MMINITL > 0
 14743         MOVE WS-SAVE-MMINITI  TO MMINITI
 14744         MOVE WS-SAVE-MMINITL  TO MMINITL
 14745         MOVE AL-UANON         TO MMINITA
 14746     END-IF
 14747*    IF WS-SAVE-LOANNOL > 0
 14748*        MOVE WS-SAVE-LOANNOI  TO LOANNOI
 14749*        MOVE WS-SAVE-LOANNOL  TO LOANNOL
 14750*        MOVE AL-UANON         TO LOANNOA
 14751*    END-IF
 14752     IF WS-SAVE-LOANBALL > 0
 14753         MOVE WS-SAVE-LOANBALI  TO LOANBALI
 14754         MOVE WS-SAVE-LOANBALL  TO LOANBALL
 14755         MOVE AL-UANON          TO LOANBALA
 14756     END-IF
 14757     IF WS-SAVE-PROCL > 0
 14758         MOVE WS-SAVE-PROCI  TO PROCI
 14759         MOVE WS-SAVE-PROCL  TO PROCL
 14760         MOVE AL-UANON       TO PROCA
 14761     END-IF
 14762     IF WS-SAVE-SUPVL > 0
 14763         MOVE WS-SAVE-SUPVI  TO SUPVI
 14764         MOVE WS-SAVE-SUPVL  TO SUPVL
 14765         MOVE AL-UANON       TO SUPVA
 14766     END-IF
 14767     IF WS-SAVE-PRICDL > 0
 14768         MOVE WS-SAVE-PRICDI  TO PRICDI
 14769         MOVE WS-SAVE-PRICDL  TO PRICDL
 14770         MOVE AL-UANON        TO PRICDA
 14771     END-IF
 14772     IF WS-SAVE-FILETOL > 0
 14773         MOVE WS-SAVE-FILETOI  TO FILETOI
 14774         MOVE WS-SAVE-FILETOL  TO FILETOL
 14775         MOVE AL-UANON         TO FILETOA
 14776     END-IF
 14777     IF WS-SAVE-PDTHRUL > 0
 14778         MOVE WS-SAVE-PDTHRUI  TO PDTHRUI
 14779         MOVE WS-SAVE-PDTHRUL  TO PDTHRUL
 14780         MOVE AL-UANON         TO PDTHRUA
 14781     END-IF
 14782     IF WS-SAVE-PDAMTL > 0
 14783         MOVE WS-SAVE-PDAMTI  TO PDAMTI
 14784         MOVE WS-SAVE-PDAMTL  TO PDAMTL
 14785         MOVE AL-UANON        TO PDAMTA
 14786     END-IF
 14787     IF WS-SAVE-NODAYSL > 0
 14788         MOVE WS-SAVE-NODAYSI  TO NODAYSI
 14789         MOVE WS-SAVE-NODAYSL  TO NODAYSL
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 276
* EL131.cbl
 14790         MOVE AL-UANON         TO NODAYSA
 14791     END-IF
 14792     IF WS-SAVE-NOPMTSL > 0
 14793         MOVE WS-SAVE-NOPMTSI  TO NOPMTSI
 14794         MOVE WS-SAVE-NOPMTSL  TO NOPMTSL
 14795         MOVE AL-UANON         TO NOPMTSA
 14796     END-IF
 14797     IF WS-SAVE-FORMTYPL > 0
 14798         MOVE WS-SAVE-FORMTYPI  TO FORMTYPI
 14799         MOVE WS-SAVE-FORMTYPL  TO FORMTYPL
 14800         MOVE AL-UANON          TO FORMTYPA
 14801     END-IF
 14802     IF WS-SAVE-OCCL > 0
 14803         MOVE WS-SAVE-OCCI  TO OCCI
 14804         MOVE WS-SAVE-OCCL  TO OCCL
 14805         MOVE AL-UANON      TO OCCA
 14806     END-IF.
 14807 4200-EXIT.
 14808      EXIT.
 14809
 14810 5000-BUILD-MAP.
 14811     IF PI-RETURN-CD-1 = SPACE
 14812         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 14813
 14814     MOVE SPACE                  TO PI-RETURN-CD-1.
 14815
 14816     MOVE LOW-VALUES             TO EL131AI.
 14817
 14818     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 14819     MOVE PI-CARRIER             TO CARRIER-CODE.
 14820     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 14821     MOVE PI-CERT-NO             TO CERT-NO.
 14822
 14823 5000-READ-CLAIM-MASTER.
 14824
 14825
 14826* EXEC CICS READ
 14827*         SET      (ADDRESS OF CLAIM-MASTER)
 14828*         DATASET  (CLMS-FILE-ID)
 14829*         RIDFLD   (MSTR-KEY)
 14830*    END-EXEC.
 14831*    MOVE '&"S        E          (   #00012515' TO DFHEIV0
 14832     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14833     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14834     MOVE X'2020233030303132353135' TO DFHEIV0(25:11)
 14835     CALL 'kxdfhei1' USING DFHEIV0,
 14836           CLMS-FILE-ID,
 14837           DFHEIV20,
 14838           DFHEIV99,
 14839           MSTR-KEY,
 14840           DFHEIV99,
 14841           DFHEIV99,
 14842           DFHEIV99
 14843     SET ADDRESS OF CLAIM-MASTER TO
 14844         DFHEIV20
 14845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14846
 14847
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 277
* EL131.cbl
 14848     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 14849
 14850 5000-READ-DIAGNOSIS-TRAILER.
 14851
 14852
 14853* EXEC CICS HANDLE CONDITION
 14854*         NOTFND (5000-TRLR-NOT-FOUND)
 14855*    END-EXEC.
 14856*    MOVE '"$I                   ! B #00012525' TO DFHEIV0
 14857     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14858     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14859     MOVE X'4220233030303132353235' TO DFHEIV0(25:11)
 14860     CALL 'kxdfhei1' USING DFHEIV0
 14861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14862
 14863
 14864     MOVE MSTR-KEY               TO TRLR-KEY.
 14865     MOVE NINETY                 TO TRLR-SEQ-NO.
 14866
 14867
 14868* EXEC CICS READ
 14869*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14870*         DATASET  (TRLR-FILE-ID)
 14871*         RIDFLD   (TRLR-KEY)
 14872*    END-EXEC.
 14873*    MOVE '&"S        E          (   #00012532' TO DFHEIV0
 14874     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14875     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14876     MOVE X'2020233030303132353332' TO DFHEIV0(25:11)
 14877     CALL 'kxdfhei1' USING DFHEIV0,
 14878           TRLR-FILE-ID,
 14879           DFHEIV20,
 14880           DFHEIV99,
 14881           TRLR-KEY,
 14882           DFHEIV99,
 14883           DFHEIV99,
 14884           DFHEIV99
 14885     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14886         DFHEIV20
 14887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14888
 14889
 14890     MOVE AT-INFO-LINE-1         TO DIAGO.
 14891     MOVE AT-ICD-CODE-1          TO ICD1O.
 14892     MOVE AT-ICD-CODE-2          TO ICD2O.
 14893
 14894 5000-READ-CERTIFICATE-MASTER.
 14895
 14896     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 14897     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 14898     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 14899     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 14900     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 14901     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 14902     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 14903
 14904
 14905* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 278
* EL131.cbl
 14906*         NOTFND (5000-CERT-NOT-FOUND)
 14907*    END-EXEC.
 14908*    MOVE '"$I                   ! C #00012552' TO DFHEIV0
 14909     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14910     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14911     MOVE X'4320233030303132353532' TO DFHEIV0(25:11)
 14912     CALL 'kxdfhei1' USING DFHEIV0
 14913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14914
 14915
 14916
 14917* EXEC CICS READ
 14918*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14919*         DATASET  (CERT-FILE-ID)
 14920*         RIDFLD   (CERT-KEY)
 14921*    END-EXEC.
 14922*    MOVE '&"S        E          (   #00012556' TO DFHEIV0
 14923     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14924     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14925     MOVE X'2020233030303132353536' TO DFHEIV0(25:11)
 14926     CALL 'kxdfhei1' USING DFHEIV0,
 14927           CERT-FILE-ID,
 14928           DFHEIV20,
 14929           DFHEIV99,
 14930           CERT-KEY,
 14931           DFHEIV99,
 14932           DFHEIV99,
 14933           DFHEIV99
 14934     SET ADDRESS OF CERTIFICATE-MASTER TO
 14935         DFHEIV20
 14936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14937
 14938
 14939     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 14940     PERFORM 5100-LOAD-CORR-TRLR THRU 5100-EXIT.
 14941     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 14942
 14943     GO TO 5000-EXIT.
 14944
 14945 5000-TRLR-NOT-FOUND.
 14946     MOVE ER-7687                TO EMI-ERROR.
 14947     MOVE -1                     TO DIAGL.
 14948     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14949     GO TO 5000-EXIT.
 14950
 14951 5000-CERT-NOT-FOUND.
 14952     MOVE ER-0206                TO EMI-ERROR.
 14953     MOVE -1                     TO CERTL.
 14954     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14955
 14956 5000-EXIT.
 14957     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 279
* EL131.cbl
 14959 5010-RESET-PI-AREA.
 14960     IF CERTI GREATER THAN LOW-VALUES
 14961         MOVE CERTI              TO PI-CERT-PRIME.
 14962
 14963     IF SUFXI GREATER THAN LOW-VALUES
 14964         MOVE SUFXI              TO PI-CERT-SFX.
 14965
 14966     IF CERTEFFI GREATER THAN LOW-VALUES
 14967         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 14968
 14969     IF CERTACTI GREATER THAN LOW-VALUES
 14970         MOVE CERTACTI           TO PI-ACCOUNT.
 14971
 14972     IF CERTSTI GREATER THAN LOW-VALUES
 14973         MOVE CERTSTI            TO PI-STATE.
 14974
 14975     IF CERTCARI GREATER THAN LOW-VALUES
 14976         MOVE CERTCARI           TO PI-CARRIER.
 14977
 14978     IF CERTGRPI GREATER THAN LOW-VALUES
 14979         MOVE CERTGRPI           TO PI-GROUPING.
 14980
 14981 5010-EXIT.
 14982     EXIT.
 14983
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 280
* EL131.cbl
 14985 5020-MOVE-MSTR.
 14986
 14987     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 14988     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 14989     MOVE WS-CLAIM-SEQU          TO SEQUO.
 14990     MOVE AL-SABON               TO SEQUA.
 14991     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 14992     MOVE CL-CLAIM-TYPE          TO TYPEO
 14993                                    pi-claim-type
 14994
 14995     IF CL-TOTAL-PAID-AMT  = +0 AND
 14996        CL-LAST-PMT-AMT    = +0 AND
 14997        CL-NO-OF-PMTS-MADE = +0
 14998          MOVE AL-UANON          TO TYPEA.
 14999
 15000     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 15001     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 15002     MOVE CL-CERT-PRIME          TO CERTO.
 15003     MOVE CL-CERT-SFX            TO SUFXO.
 15004     MOVE CL-CERT-CARRIER        TO CARRO.
 15005
 15006     IF CL-CLAIM-STATUS = 'C'
 15007         MOVE 'CLOSED'           TO STATUSO
 15008     ELSE
 15009         MOVE 'OPEN  '           TO STATUSO.
 15010
 15011     move cl-accident-claim-sw   to accswo
 15012     if cl-benefit-period not numeric
 15013        move zeros               to cl-benefit-period
 15014     end-if
 15015     move cl-benefit-period      to benpero
 15016     move cl-insured-type        to instypeo
 15017     MOVE CL-PROCESSOR-ID        TO PROCO.
 15018
 15019     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 15020     MOVE CL-CCN                 TO CCNOO.
 15021
 15022     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 15023     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 15024     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 15025     MOVE CL-INSURED-SEX-CD      TO SEXO.
 15026
 15027     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 15028         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 15029         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15030         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15031         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 15032     ELSE
 15033         MOVE SPACES             TO BIRTHO.
 15034
 15035     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 15036        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 15037         NEXT SENTENCE
 15038       ELSE
 15039         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 15040
 15041     IF PI-COMPANY-ID = 'DMD'
 15042       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 281
* EL131.cbl
 15043          IF SOCIALO = SPACES OR LOW-VALUES
 15044            MOVE ER-0885         TO EMI-ERROR
 15045            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15046
 15047     MOVE CL-INSURED-OCC-CD      TO OCCO.
 15048*    MOVE CL-CAUSE-CD            TO CAUSEO.
 15049
 15050*    IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 15051*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 15052*        MOVE SPACES                 TO DC-OPTION-CODE
 15053*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15054*        MOVE DC-GREG-DATE-1-EDIT TO ENDO
 15055*    ELSE
 15056*        MOVE SPACES             TO ENDO.
 15057
 15058     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 15059        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 15060        MOVE SPACES             TO DC-OPTION-CODE
 15061        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15062        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 15063        IF PI-USES-PAID-TO
 15064           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 15065           MOVE '6'                TO DC-OPTION-CODE
 15066           MOVE +1                 TO DC-ELAPSED-DAYS
 15067           MOVE +0                 TO DC-ELAPSED-MONTHS
 15068           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15069           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 15070        ELSE
 15071           NEXT SENTENCE
 15072     ELSE
 15073        MOVE SPACES             TO PDTHRUO.
 15074
 15075     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 15076     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 15077     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 15078     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 15079
 15080     IF MODIFY-CAP
 15081        MOVE AL-UNNOF            TO PDAMTA
 15082                                    NODAYSA
 15083                                    NOPMTSA
 15084        MOVE AL-UANOF            TO PDTHRUA.
 15085     MOVE PI-COMPANY-ID          TO CNTL-CO-ID
 15086     MOVE '2'                    TO CNTL-REC-TYPE
 15087     MOVE +0                     TO CNTL-SEQ-NO
 15088     MOVE PI-PROCESSOR-ID        TO CNTL-PROC-ID
 15089
 15090
 15091* EXEC CICS READ
 15092*         DATASET  (CNTL-FILE-ID)
 15093*         SET      (ADDRESS OF CONTROL-FILE)
 15094*         RIDFLD   (CNTL-KEY)
 15095*         RESP     (WS-RESPONSE)
 15096*    END-EXEC
 15097*    MOVE '&"S        E          (  N#00012713' TO DFHEIV0
 15098     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15099     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15100     MOVE X'204E233030303132373133' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 282
* EL131.cbl
 15101     CALL 'kxdfhei1' USING DFHEIV0,
 15102           CNTL-FILE-ID,
 15103           DFHEIV20,
 15104           DFHEIV99,
 15105           CNTL-KEY,
 15106           DFHEIV99,
 15107           DFHEIV99,
 15108           DFHEIV99
 15109     SET ADDRESS OF CONTROL-FILE TO
 15110         DFHEIV20
 15111     MOVE EIBRESP  TO WS-RESPONSE
 15112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15113
 15114     IF WS-RESP-NORMAL
 15115        MOVE CF-APPROVAL-LEVEL   TO PI-APPROVAL-LEVEL
 15116     end-if
 15117     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 15118         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 15119         MOVE SPACES             TO DC-OPTION-CODE
 15120         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15121         MOVE DC-GREG-DATE-1-EDIT TO INCO
 15122     ELSE
 15123         MOVE SPACES             TO INCO.
 15124
 15125     IF (CL-NO-OF-PMTS-MADE = ZEROS)
 15126        OR (PI-APPROVAL-LEVEL = '4' OR '5')
 15127        MOVE AL-UANOF            TO INCA
 15128     end-if
 15129     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 15130
 15131     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 15132         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 15133         MOVE SPACES             TO DC-OPTION-CODE
 15134         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15135         MOVE DC-GREG-DATE-1-EDIT TO REPO
 15136     ELSE
 15137         MOVE SPACES             TO REPO.
 15138
 15139     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
 15140         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 15141         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15142         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15143         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 15144     ELSE
 15145         MOVE SPACES             TO ESTO.
 15146
 15147     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 15148         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 15149         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15150         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15151         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 15152     ELSE
 15153         MOVE SPACES             TO MNTDTO.
 15154
 15155
 15156     IF CL-LAST-MAINT-TYPE = SPACE
 15157         MOVE 'SET-UP'           TO MNTTYPEO
 15158     ELSE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 283
* EL131.cbl
 15159     IF CL-LAST-MAINT-TYPE = '1'
 15160         MOVE 'PAYMNT'           TO MNTTYPEO
 15161     ELSE
 15162     IF CL-LAST-MAINT-TYPE = '2'
 15163         MOVE 'LETTER'           TO MNTTYPEO
 15164     ELSE
 15165     IF CL-LAST-MAINT-TYPE = '3'
 15166         MOVE 'UPDATE'           TO MNTTYPEO
 15167     ELSE
 15168     IF CL-LAST-MAINT-TYPE = '4'
 15169         MOVE 'RESTOR'           TO MNTTYPEO
 15170     ELSE
 15171     IF CL-LAST-MAINT-TYPE = '5'
 15172         MOVE 'INC DT'           TO MNTTYPEO
 15173     ELSE
 15174     IF CL-LAST-MAINT-TYPE = '6'
 15175         MOVE ' CONV'            TO MNTTYPEO
 15176     ELSE
 15177     IF CL-LAST-MAINT-TYPE = 'C'
 15178         MOVE 'CHGBEN'           TO MNTTYPEO
 15179     ELSE
 15180     IF CL-LAST-MAINT-TYPE = 'E'
 15181         MOVE 'ERRCOR'           TO MNTTYPEO
 15182     ELSE
 15183         MOVE SPACES             TO MNTTYPEO.
 15184
 15185     MOVE CL-BENEFICIARY         TO BENEO.
 15186     MOVE CL-FILE-LOCATION       TO FILETOO.
 15187     IF CL-CRITICAL-PERIOD NOT NUMERIC
 15188        MOVE ZEROS               TO CL-CRITICAL-PERIOD
 15189     END-IF
 15190     MOVE CL-CRITICAL-PERIOD     TO CRITPO
 15191     IF CL-NO-OF-EXTENSIONS NOT NUMERIC
 15192        MOVE ZEROS               TO CL-NO-OF-EXTENSIONS
 15193     END-IF
 15194     MOVE CL-NO-OF-EXTENSIONS    TO EXTENSO
 15195*    MOVE CL-CRIT-PER-RECURRENT
 15196*                                TO CRITPTO
 15197*    IF CL-CRIT-PER-RTW-MOS NOT NUMERIC
 15198*       MOVE ZEROS               TO CL-CRIT-PER-RTW-MOS
 15199*    END-IF
 15200*    MOVE CL-CRIT-PER-RTW-MOS    TO RTWMOSO
 15201     MOVE CL-PRIORITY-CD         TO PRICDO.
 15202     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 15203     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 15204     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 15205     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 15206
 15207 5020-EXIT.
 15208     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 284
* EL131.cbl
 15210 5030-MOVE-CERT.
 15211
 15212     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 15213         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 15214         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15215         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15216         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 15217       ELSE
 15218         MOVE SPACES             TO CERTEFFO
 15219         MOVE ZERO               TO HOLD-DATE.
 15220
 15221     MOVE CM-ACCOUNT             TO CERTACTO.
 15222     MOVE CM-STATE               TO CERTSTO PI-STATE.
 15223     MOVE CM-GROUPING            TO CERTGRPO.
 15224     MOVE CM-CARRIER             TO CERTCARO.
 15225     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 15226     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 15227     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 15228     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 15229     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 15230     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 15231     MOVE CM-JT-INITIAL          TO JNTINITO.
 15232     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 15233
 15234*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 15235     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 15236     MOVE '3'                    TO CNTL-REC-TYPE.
 15237     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 15238     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 15239     MOVE ZERO                   TO CNTL-SEQ-NO.
 15240
 15241
 15242* EXEC CICS READ
 15243*         SET        (ADDRESS OF CONTROL-FILE)
 15244*         DATASET    ('ELCNTL')
 15245*         RIDFLD     (CNTL-KEY)
 15246*         RESP       (WS-RESPONSE)
 15247*    END-EXEC.
 15248     MOVE 'ELCNTL' TO DFHEIV1
 15249*    MOVE '&"S        E          (  N#00012847' TO DFHEIV0
 15250     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15251     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15252     MOVE X'204E233030303132383437' TO DFHEIV0(25:11)
 15253     CALL 'kxdfhei1' USING DFHEIV0,
 15254           DFHEIV1,
 15255           DFHEIV20,
 15256           DFHEIV99,
 15257           CNTL-KEY,
 15258           DFHEIV99,
 15259           DFHEIV99,
 15260           DFHEIV99
 15261     SET ADDRESS OF CONTROL-FILE TO
 15262         DFHEIV20
 15263     MOVE EIBRESP  TO WS-RESPONSE
 15264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15265
 15266
 15267     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 285
* EL131.cbl
 15268        MOVE ZERO                TO CP-FREE-LOOK
 15269     ELSE
 15270        MOVE CF-ST-FREE-LOOK-PERIOD
 15271                                 TO CP-FREE-LOOK.
 15272
 15273     IF CM-LF-BENEFIT-CD = '00'
 15274        GO TO 5030-MOVE-CERT-AH.
 15275
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 286
* EL131.cbl
 15277     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 15278     MOVE '5'                    TO DC-OPTION-CODE
 15279     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15280     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 15281     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15282     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 15283     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 15284     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15285     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15286     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 15287     MOVE '4'                    TO CP-REM-TERM-METHOD
 15288     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 15289     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15290     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15291
 15292     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 15293     IF CM-LF-PREMIUM-RATE NUMERIC
 15294         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 15295     ELSE
 15296         MOVE ZEROS              TO LCVRATEO.
 15297
 15298     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 15299         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 15300
 15301     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 15302
 15303     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 15304
 15305     IF CM-LF-CURRENT-STATUS = '8'
 15306        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 15307            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 15308            MOVE ' '             TO DC-OPTION-CODE
 15309            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15310            IF NOT DATE-CONVERSION-ERROR
 15311                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15312
 15313     IF CM-LF-CURRENT-STATUS = '7'
 15314        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 15315            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 15316            MOVE ' '             TO DC-OPTION-CODE
 15317            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15318            IF NOT DATE-CONVERSION-ERROR
 15319                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15320
 15321     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 15322         MOVE ' '                TO DC-OPTION-CODE
 15323         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 15324         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15325         IF NOT DATE-CONVERSION-ERROR
 15326             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 15327             MOVE HOLD-MONTH     TO WORK-MONTH
 15328             MOVE HOLD-YEAR      TO WORK-YEAR
 15329             MOVE WORK-DATE-MY   TO LCVEXITO.
 15330
 15331     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 15332        IF CP-REMAINING-TERM-3 = ZEROS
 15333           MOVE 'EXPIRED'        TO LCVSTATO
 15334        ELSE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 287
* EL131.cbl
 15335           MOVE 'ACTIVE'         TO LCVSTATO.
 15336
 15337     IF CM-LF-CURRENT-STATUS = '2'
 15338        MOVE 'PEND   '           TO LCVSTATO.
 15339     IF CM-LF-CURRENT-STATUS = '3'
 15340        MOVE 'RESTORE'           TO LCVSTATO.
 15341     IF CM-LF-CURRENT-STATUS = '5'
 15342        MOVE 'REISSUE'           TO LCVSTATO.
 15343     IF CM-LF-CURRENT-STATUS = '6'
 15344        MOVE 'LMP DIS'           TO LCVSTATO.
 15345     IF CM-LF-CURRENT-STATUS = '7'
 15346        MOVE 'DEATH  '           TO LCVSTATO.
 15347     IF CM-LF-CURRENT-STATUS = '8'
 15348        MOVE 'CANCEL '           TO LCVSTATO.
 15349     IF CM-LF-CURRENT-STATUS = '9'
 15350        MOVE 'RE-ONLY'           TO LCVSTATO.
 15351     IF CM-LF-CURRENT-STATUS = 'V'
 15352        MOVE 'VOID   '           TO LCVSTATO.
 15353     IF CM-LF-CURRENT-STATUS = 'D'
 15354        MOVE 'DECLINE'           TO LCVSTATO.
 15355
 15356     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15357     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15358     MOVE '4'                    TO BEN-REC-TYPE.
 15359     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 15360     MOVE ZERO                   TO BEN-SEQ-NO.
 15361
 15362
 15363* EXEC CICS READ GTEQ
 15364*         DATASET  (CNTL-FILE-ID)
 15365*         RIDFLD   (BENEFIT-KEY)
 15366*         SET      (ADDRESS OF CONTROL-FILE)
 15367*    END-EXEC.
 15368*    MOVE '&"S        G          (   #00012949' TO DFHEIV0
 15369     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15370     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15371     MOVE X'2020233030303132393439' TO DFHEIV0(25:11)
 15372     CALL 'kxdfhei1' USING DFHEIV0,
 15373           CNTL-FILE-ID,
 15374           DFHEIV20,
 15375           DFHEIV99,
 15376           BENEFIT-KEY,
 15377           DFHEIV99,
 15378           DFHEIV99,
 15379           DFHEIV99
 15380     SET ADDRESS OF CONTROL-FILE TO
 15381         DFHEIV20
 15382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15383
 15384
 15385     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15386        CF-RECORD-TYPE NOT = '4'
 15387         MOVE ER-0240            TO EMI-ERROR
 15388         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15389         GO TO 5030-MOVE-CERT-FINISH.
 15390
 15391     MOVE ZERO                   TO COUNT-2.
 15392     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 288
* EL131.cbl
 15393
 15394     IF SCREEN-ERROR
 15395         MOVE ER-0282            TO EMI-ERROR
 15396         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15397        ELSE
 15398         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 15399
 15400 5030-MOVE-CERT-AH.
 15401
 15402     IF CM-LF-BENEFIT-CD = '00'
 15403         IF CM-AH-BENEFIT-CD = '00'
 15404             GO TO 5030-MOVE-CERT-FINISH.
 15405
 15406     IF CM-AH-BENEFIT-CD = '00'
 15407        MOVE SPACES             TO ACVKINDO
 15408        COMPUTE PI-PAYMENT-AMT =
 15409                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 15410        GO TO 5030-MOVE-CERT-FINISH.
 15411
 15412     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15413     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 15414     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 15415     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 15416     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15417     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15418     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 15419     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 15420
 15421**DMD **********************************************
 15422     IF PI-COMPANY-ID = 'DMD'
 15423         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 15424                                   CM-PMT-EXTENSION-DAYS
 15425         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 15426                                      CL-NO-OF-DAYS-PAID
 15427         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 15428             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 15429         MOVE WS-REM-MOS         TO ACVRTRMO
 15430                                    CP-REMAINING-TERM-3
 15431*        MOVE WS-REM-DAYS        TO DAYSPO
 15432         GO TO 5030-SKIP-RTRM.
 15433**DMD **********************************************
 15434
 15435     MOVE '4'                    TO CP-REM-TERM-METHOD.
 15436     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15437     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15438     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 15439
 15440 5030-SKIP-RTRM.
 15441     IF CM-AH-PREMIUM-RATE NUMERIC
 15442         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 15443     ELSE
 15444         MOVE ZEROS              TO ACVRATEO.
 15445
 15446     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 15447     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 15448
 15449     IF CM-AH-CURRENT-STATUS = '8'
 15450        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 289
* EL131.cbl
 15451            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 15452            MOVE ' '             TO DC-OPTION-CODE
 15453            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15454            IF NOT DATE-CONVERSION-ERROR
 15455                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15456
 15457     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 15458        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 15459            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 15460            MOVE ' '             TO DC-OPTION-CODE
 15461            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15462            IF NOT DATE-CONVERSION-ERROR
 15463                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15464
 15465     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 15466        IF CP-REMAINING-TERM-3 = ZEROS
 15467           MOVE 'EXPIRED'        TO ACVSTATO
 15468        ELSE
 15469           MOVE 'ACTIVE'         TO ACVSTATO.
 15470
 15471     IF CM-AH-CURRENT-STATUS = '2'
 15472        MOVE 'PEND   '           TO ACVSTATO.
 15473     IF CM-AH-CURRENT-STATUS = '3'
 15474        MOVE 'RESTORE'           TO ACVSTATO.
 15475     IF CM-AH-CURRENT-STATUS = '5'
 15476        MOVE 'REISSUE'           TO ACVSTATO.
 15477     IF CM-AH-CURRENT-STATUS = '6'
 15478        MOVE 'LMP DIS'           TO ACVSTATO.
 15479     IF CM-AH-CURRENT-STATUS = '7'
 15480        MOVE 'DEATH  '           TO ACVSTATO.
 15481     IF CM-AH-CURRENT-STATUS = '8'
 15482        MOVE 'CANCEL '           TO ACVSTATO.
 15483     IF CM-AH-CURRENT-STATUS = '9'
 15484        MOVE 'RE-ONLY'           TO ACVSTATO.
 15485     IF CM-AH-CURRENT-STATUS = 'V'
 15486        MOVE 'VOID   '           TO ACVSTATO.
 15487     IF CM-AH-CURRENT-STATUS = '9'
 15488        MOVE 'DECLINE'           TO ACVSTATO.
 15489
 15490     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 15491         MOVE ' '                TO DC-OPTION-CODE
 15492         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 15493         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15494         IF NOT DATE-CONVERSION-ERROR
 15495             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 15496             MOVE HOLD-MONTH     TO WORK-MONTH
 15497             MOVE HOLD-YEAR      TO WORK-YEAR
 15498             MOVE WORK-DATE-MY   TO ACVEXITO.
 15499
 15500     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15501
 15502     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15503     MOVE '5'                    TO BEN-REC-TYPE.
 15504     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 15505     MOVE ZERO                   TO BEN-SEQ-NO.
 15506
 15507
 15508* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 290
* EL131.cbl
 15509*         DATASET  (CNTL-FILE-ID)
 15510*         RIDFLD   (BENEFIT-KEY)
 15511*         SET      (ADDRESS OF CONTROL-FILE)
 15512*    END-EXEC.
 15513*    MOVE '&"S        G          (   #00013077' TO DFHEIV0
 15514     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15515     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15516     MOVE X'2020233030303133303737' TO DFHEIV0(25:11)
 15517     CALL 'kxdfhei1' USING DFHEIV0,
 15518           CNTL-FILE-ID,
 15519           DFHEIV20,
 15520           DFHEIV99,
 15521           BENEFIT-KEY,
 15522           DFHEIV99,
 15523           DFHEIV99,
 15524           DFHEIV99
 15525     SET ADDRESS OF CONTROL-FILE TO
 15526         DFHEIV20
 15527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15528
 15529
 15530     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15531        CF-RECORD-TYPE NOT = '5'
 15532         MOVE ER-0250            TO EMI-ERROR
 15533         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15534         GO TO 5030-MOVE-CERT-FINISH.
 15535
 15536     MOVE ZERO                   TO COUNT-2.
 15537     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 15538
 15539     IF SCREEN-ERROR
 15540         MOVE ER-0283            TO EMI-ERROR
 15541         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15542       ELSE
 15543         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 15544
 15545 5030-MOVE-CERT-FINISH.
 15546
 15547     MOVE CM-LOAN-APR            TO APRO.
 15548     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15549     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15550     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 15551*    MOVE CM-LOAN-NUMBER         TO LOANNOO
 15552     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 15553     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 15554
 15555     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 15556         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15557         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15558         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15559         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 15560     ELSE
 15561         MOVE SPACES               TO ADDONDTO.
 15562
 15563     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 15564
 15565 5030-EXIT.
 15566     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 291
* EL131.cbl
 15568 5040-FIND-BENEFIT.
 15569     ADD 1                       TO COUNT-2.
 15570     IF COUNT-2 GREATER THAN 8
 15571         GO TO 5050-BENEFIT-NOTFND.
 15572
 15573     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 15574         GO TO 5060-EXIT.
 15575
 15576     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 15577         GO TO 5050-BENEFIT-NOTFND.
 15578
 15579     GO TO 5040-FIND-BENEFIT.
 15580
 15581 5050-BENEFIT-NOTFND.
 15582     MOVE 'X'                    TO ERROR-SWITCH.
 15583
 15584 5060-EXIT.
 15585     EXIT.
 15586 5100-LOAD-CORR-TRLR.
 15587     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 15588     MOVE PI-CARRIER         TO TRLR-CARRIER.
 15589     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 15590     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 15591     MOVE 1000               TO TRLR-SEQ-NO.
 15592
 15593
 15594* EXEC CICS HANDLE CONDITION
 15595*         NOTFND    (1052-DONE)
 15596*         ENDFILE   (1052-DONE)
 15597*    END-EXEC.
 15598*    MOVE '"$I''                  ! D #00013146' TO DFHEIV0
 15599     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 15600     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15601     MOVE X'4420233030303133313436' TO DFHEIV0(25:11)
 15602     CALL 'kxdfhei1' USING DFHEIV0
 15603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15604
 15605
 15606
 15607* EXEC CICS STARTBR
 15608*        DATASET (TRLR-FILE-ID)
 15609*        RIDFLD  (TRLR-KEY)
 15610*    END-EXEC
 15611     MOVE 0
 15612       TO DFHEIV11
 15613*    MOVE '&,         G          &   #00013151' TO DFHEIV0
 15614     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15615     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15616     MOVE X'2020233030303133313531' TO DFHEIV0(25:11)
 15617     CALL 'kxdfhei1' USING DFHEIV0,
 15618           TRLR-FILE-ID,
 15619           TRLR-KEY,
 15620           DFHEIV99,
 15621           DFHEIV11,
 15622           DFHEIV99
 15623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15624
 15625
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 292
* EL131.cbl
 15626     MOVE SPACES TO WS-TRLR-FILE-EOF
 15627                    WS-AUTH-RCVD
 15628     PERFORM 1052-READ-TRLR THRU 1052-EXIT
 15629       UNTIL  TRLR-FILE-EOF
 15630         OR WS-AUTH-RCVD > SPACES.
 15631
 15632
 15633* EXEC CICS ENDBR
 15634*        DATASET (TRLR-FILE-ID)
 15635*    END-EXEC.
 15636     MOVE 0
 15637       TO DFHEIV11
 15638*    MOVE '&2                    $   #00013163' TO DFHEIV0
 15639     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15640     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15641     MOVE X'2020233030303133313633' TO DFHEIV0(25:11)
 15642     CALL 'kxdfhei1' USING DFHEIV0,
 15643           TRLR-FILE-ID,
 15644           DFHEIV11,
 15645           DFHEIV99
 15646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15647
 15648
 15649     IF AUTH-RCVD
 15650        MOVE 'Y' TO AUTHRCVO
 15651     ELSE
 15652        MOVE 'N' TO AUTHRCVO
 15653     END-IF.
 15654
 15655
 15656 5100-EXIT.
 15657     EXIT.
 15658
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 293
* EL131.cbl
 15660 6000-CALCULATE-CERT-TERM.
 15661
 15662     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 15663         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 15664     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 15665         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 15666     IF CM-LOAN-APR NOT NUMERIC
 15667         MOVE ZEROS              TO CM-LOAN-APR.
 15668
 15669*    IF WS-CALC-METHOD  = 'G'
 15670         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 15671*     ELSE
 15672*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 15673
 15674     IF N GREATER 120
 15675         MOVE 120                TO N.
 15676
 15677     MOVE '6'                    TO DC-OPTION-CODE.
 15678     MOVE N                      TO DC-ELAPSED-MONTHS.
 15679     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 15680     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 15681
 15682     IF CM-LF-BENEFIT-CD NOT = ZERO
 15683         MOVE N                  TO CM-LF-ORIG-TERM
 15684         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 15685         IF NO-CONVERSION-ERROR
 15686             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 15687
 15688     IF CM-AH-BENEFIT-CD NOT = ZERO
 15689         MOVE N                  TO CM-AH-ORIG-TERM
 15690         IF NO-CONVERSION-ERROR
 15691             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 15692
 15693 6000-EXIT.
 15694      EXIT.
 15695
 15696 6100-CALC-GROSS-TERM.
 15697     MOVE CM-LOAN-BALANCE         TO L.
 15698     MOVE PI-PAYMENT-AMT          TO M.
 15699
 15700     COMPUTE N = L / M.
 15701     IF N LESS 1
 15702         MOVE 1  TO N.
 15703
 15704     IF CM-LF-BENEFIT-CD NOT = ZERO
 15705         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 15706     ELSE
 15707         MOVE ZEROS               TO WS-LF-RATE.
 15708
 15709     IF CM-AH-BENEFIT-CD NOT = ZERO
 15710         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 15711     ELSE
 15712         MOVE ZEROS               TO WS-AH-RATE.
 15713
 15714     COMPUTE I = CM-LOAN-APR / +1200.
 15715
 15716 6105-LOOP.
 15717     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 294
* EL131.cbl
 15718         GO TO 6200-EXIT.
 15719     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 15720     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 15721         ADD 1 TO N
 15722         GO TO 6105-LOOP.
 15723
 15724 6200-EXIT.
 15725      EXIT.
 15726
 15727 6210-CALC-LEFT-RIGHTONE.
 15728      MOVE L         TO LEFT-TOT-1.
 15729      SUBTRACT 1 FROM N.
 15730      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 15731      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 15732      ADD 1 TO N.
 15733 6211-CALC-TERM1.
 15734      MOVE N         TO TERM1.
 15735      MULTIPLY M BY TERM1.
 15736 6212-LOOP.
 15737      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 15738      ADD 1 TO A-N.
 15739      MULTIPLY A-N BY TERM1.
 15740      SUBTRACT 1 FROM A-N.
 15741      ADD TERM1 TO LEFT-TOT-1.
 15742 6213-CALC-TERM2.
 15743      MOVE M         TO TERM2.
 15744      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 15745      MULTIPLY IA-N BY TERM2.
 15746      SUBTRACT TERM2 FROM LEFT-TOT-1.
 15747 6215-CALC-RIGHTONE.
 15748      MOVE M         TO RIGHT-TOT-1.
 15749      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 15750      MULTIPLY A-N BY RIGHT-TOT-1.
 15751 6220-EXIT.
 15752      EXIT.
 15753
 15754 6300-CALC-A-N.
 15755     IF N LESS 1
 15756         MOVE 0     TO A-N
 15757         GO TO 6300-EXIT.
 15758     IF I = 0
 15759         MOVE .00001 TO I.
 15760     ADD 1 TO I.
 15761     DIVIDE I INTO 1 GIVING V.
 15762     SUBTRACT 1 FROM I.
 15763     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 15764     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 15765     DIVIDE I INTO TERM3 GIVING A-N.
 15766 6300-EXIT.
 15767      EXIT.
 15768
 15769 6350-CALC-IA-N.
 15770     IF N LESS 1
 15771         MOVE 0      TO IA-N
 15772         GO TO 6400-EXIT.
 15773     ADD 1 TO N.
 15774     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 15775     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 295
* EL131.cbl
 15776     MULTIPLY N BY V-EX-N GIVING TERM3.
 15777     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 15778     SUBTRACT V FROM 1 GIVING TERM4.
 15779     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 15780 6400-EXIT.
 15781      EXIT.
 15782
 15783 6450-CALC-V-EX-N.
 15784     IF N LESS 1
 15785         MOVE 1    TO V-EX-N
 15786         GO TO 6490-EXIT.
 15787     MOVE N        TO NV-STORE.
 15788     IF V-EX-ONETIME = 1  OR
 15789        V NOT = V-EXPONENT (1)
 15790          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 15791 6460-LOOP.
 15792     IF N GREATER 248
 15793         MOVE 248 TO N.
 15794     IF N = 1
 15795         MOVE V               TO V-EX-N
 15796      ELSE
 15797         MOVE V-EXPONENT (N)  TO V-EX-N.
 15798     GO TO 6490-EXIT.
 15799
 15800 6470-BUILD-V-EX-TABLE.
 15801     MOVE 2      TO N.
 15802     MOVE V      TO V-EXPONENT (1)
 15803                    V-EX-N.
 15804 6471-LOOP.
 15805     MULTIPLY V BY V-EX-N.
 15806     MOVE V-EX-N   TO V-EXPONENT (N).
 15807     ADD 1 TO N.
 15808     IF N LESS 248
 15809         GO TO 6471-LOOP.
 15810     MOVE NV-STORE     TO N.
 15811     MOVE 0            TO V-EX-ONETIME.
 15812 6480-EXIT.
 15813      EXIT.
 15814
 15815 6490-EXIT.
 15816      EXIT.
 15817
 15818 6500-CALC-NET-TERM.
 15819     MOVE CM-LOAN-BALANCE         TO L.
 15820     MOVE PI-PAYMENT-AMT          TO M.
 15821
 15822     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 15823     IF WS-REMAIN GREATER ZERO
 15824         ADD 1 TO N.
 15825     IF N = 0
 15826         MOVE 1 TO N.
 15827
 15828 6700-EXIT.
 15829      EXIT.
 15830
 15831 6999-CALC-TERM-EXIT.
 15832     EXIT.
 15833
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 296
* EL131.cbl
 15835 7000-RESET-ATTRIBUTE.
 15836
 15837     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 15838                                    CERTSTA   CERTCARA
 15839                                    CERTGRPA.
 15840     MOVE -1                     TO CERTCARL.
 15841
 15842 7000-EXIT.
 15843     EXIT.
 15844
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 297
* EL131.cbl
 15846 7600-BROWSE-CLAIM.
 15847
 15848
 15849* EXEC CICS READ
 15850*        DATASET(CLMS-FILE-ID)
 15851*        SET    (ADDRESS OF CLAIM-MASTER)
 15852*        RIDFLD (MSTR-KEY)
 15853*        GENERIC
 15854*        EQUAL
 15855*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15856*    END-EXEC.
 15857*    MOVE '&"S  KG    E          (   #00013366' TO DFHEIV0
 15858     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15859     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15860     MOVE X'2020233030303133333636' TO DFHEIV0(25:11)
 15861     CALL 'kxdfhei1' USING DFHEIV0,
 15862           CLMS-FILE-ID,
 15863           DFHEIV20,
 15864           DFHEIV99,
 15865           MSTR-KEY,
 15866           ELMSTR-GENERIC-LENGTH,
 15867           DFHEIV99,
 15868           DFHEIV99
 15869     SET ADDRESS OF CLAIM-MASTER TO
 15870         DFHEIV20
 15871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15872
 15873
 15874     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 15875
 15876     if cl-assoc-cert-total = 0
 15877        move 1 to cl-assoc-cert-total
 15878     end-if
 15879     IF CL-ASSOC-CERT-SEQU = 0
 15880        MOVE 1 TO CL-ASSOC-CERT-SEQU
 15881     END-IF
 15882
 15883     IF CL-ASSOC-CERT-TOTAL = 1
 15884         MOVE AL-SADOF           TO BCERT1A
 15885                                    BSUFX1A
 15886                                    BCERT2A
 15887                                    BSUFX2A
 15888                                    BCERT3A
 15889                                    BSUFX3A
 15890                                    BCERT4A
 15891                                    BSUFX4A
 15892                                    BCERT5A
 15893                                    BSUFX5A
 15894                                    PCERTNOA
 15895                                    PSUFXA
 15896                                    LABEL1A
 15897                                    LABEL2A
 15898         GO TO 7699-EXIT.
 15899
 15900 7610-BROWSE-CLAIM-LOOP.
 15901
 15902     MOVE LOW-VALUES             TO BCERT1O
 15903                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 298
* EL131.cbl
 15904                                    BCERT2O
 15905                                    BSUFX2O
 15906                                    BCERT3O
 15907                                    BSUFX3O
 15908                                    BCERT4O
 15909                                    BSUFX4O
 15910                                    BCERT5O
 15911                                    BSUFX5O.
 15912
 15913
 15914* EXEC CICS HANDLE CONDITION
 15915*        ENDFILE  (7630-END-BROWSE)
 15916*    END-EXEC.
 15917*    MOVE '"$''                   ! E #00013414' TO DFHEIV0
 15918     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15919     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15920     MOVE X'4520233030303133343134' TO DFHEIV0(25:11)
 15921     CALL 'kxdfhei1' USING DFHEIV0
 15922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15923
 15924
 15925
 15926* EXEC CICS STARTBR
 15927*        DATASET    (CLMS-FILE-ID)
 15928*        RIDFLD     (MSTR-KEY)
 15929*    END-EXEC.
 15930     MOVE 0
 15931       TO DFHEIV11
 15932*    MOVE '&,         G          &   #00013418' TO DFHEIV0
 15933     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15934     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15935     MOVE X'2020233030303133343138' TO DFHEIV0(25:11)
 15936     CALL 'kxdfhei1' USING DFHEIV0,
 15937           CLMS-FILE-ID,
 15938           MSTR-KEY,
 15939           DFHEIV99,
 15940           DFHEIV11,
 15941           DFHEIV99
 15942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15943
 15944
 15945     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15946
 15947 7620-READ-CLAIM-LOOP.
 15948
 15949
 15950* EXEC CICS READNEXT
 15951*        DATASET   (CLMS-FILE-ID)
 15952*        SET       (ADDRESS OF CLAIM-MASTER)
 15953*        RIDFLD    (MSTR-KEY)
 15954*    END-EXEC.
 15955     MOVE 0
 15956       TO DFHEIV11
 15957*    MOVE '&.S                   )   #00013427' TO DFHEIV0
 15958     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15959     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15960     MOVE X'2020233030303133343237' TO DFHEIV0(25:11)
 15961     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 299
* EL131.cbl
 15962           CLMS-FILE-ID,
 15963           DFHEIV20,
 15964           DFHEIV99,
 15965           MSTR-KEY,
 15966           DFHEIV99,
 15967           DFHEIV11,
 15968           DFHEIV99,
 15969           DFHEIV99
 15970     SET ADDRESS OF CLAIM-MASTER TO
 15971         DFHEIV20
 15972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15973
 15974
 15975     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 15976        CL-CARRIER     NOT = CARRI           OR
 15977        CL-CLAIM-NO    NOT = CLAIMI
 15978        GO TO 7630-END-BROWSE.
 15979
 15980     IF WS-ASSOCIATED-CERTS = 1
 15981         MOVE CL-CERT-PRIME      TO BCERT1O
 15982         MOVE CL-CERT-SFX        TO BSUFX1O.
 15983
 15984     IF WS-ASSOCIATED-CERTS = 2
 15985         MOVE CL-CERT-PRIME      TO BCERT2O
 15986         MOVE CL-CERT-SFX        TO BSUFX2O.
 15987
 15988     IF WS-ASSOCIATED-CERTS = 3
 15989         MOVE CL-CERT-PRIME      TO BCERT3O
 15990         MOVE CL-CERT-SFX        TO BSUFX3O.
 15991
 15992     IF WS-ASSOCIATED-CERTS = 4
 15993         MOVE CL-CERT-PRIME      TO BCERT4O
 15994         MOVE CL-CERT-SFX        TO BSUFX4O.
 15995
 15996     IF WS-ASSOCIATED-CERTS = 5
 15997         MOVE CL-CERT-PRIME      TO BCERT5O
 15998         MOVE CL-CERT-SFX        TO BSUFX5O
 15999     ELSE
 16000         ADD +1                  TO WS-ASSOCIATED-CERTS
 16001         GO TO 7620-READ-CLAIM-LOOP.
 16002
 16003 7630-END-BROWSE.
 16004
 16005
 16006* EXEC CICS ENDBR
 16007*        DATASET   (CLMS-FILE-ID)
 16008*    END-EXEC.
 16009     MOVE 0
 16010       TO DFHEIV11
 16011*    MOVE '&2                    $   #00013463' TO DFHEIV0
 16012     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16013     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16014     MOVE X'2020233030303133343633' TO DFHEIV0(25:11)
 16015     CALL 'kxdfhei1' USING DFHEIV0,
 16016           CLMS-FILE-ID,
 16017           DFHEIV11,
 16018           DFHEIV99
 16019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 300
* EL131.cbl
 16020
 16021
 16022 7640-HIGHLIGHT-CERT-DISPLAYED.
 16023
 16024     MOVE AL-SANON               TO BCERT1A
 16025                                    BSUFX1A
 16026                                    BCERT2A
 16027                                    BSUFX2A
 16028                                    BCERT3A
 16029                                    BSUFX3A
 16030                                    BCERT4A
 16031                                    BSUFX4A
 16032                                    BCERT5A
 16033                                    BSUFX5A.
 16034
 16035     IF BCERT1O = CERTI AND
 16036        BSUFX1O = SUFXI
 16037            MOVE AL-SABON        TO BCERT1A
 16038                                    BSUFX1A.
 16039
 16040     IF BCERT2O = CERTI AND
 16041        BSUFX2O = SUFXI
 16042            MOVE AL-SABON        TO BCERT2A
 16043                                    BSUFX2A.
 16044
 16045     IF BCERT3O = CERTI AND
 16046        BSUFX3O = SUFXI
 16047            MOVE AL-SABON        TO BCERT3A
 16048                                    BSUFX3A.
 16049
 16050     IF BCERT4O = CERTI AND
 16051        BSUFX4O = SUFXI
 16052            MOVE AL-SABON        TO BCERT4A
 16053                                    BSUFX4A.
 16054
 16055     IF BCERT5O = CERTI AND
 16056        BSUFX5O = SUFXI
 16057            MOVE AL-SABON        TO BCERT5A
 16058                                    BSUFX5A.
 16059
 16060 7699-EXIT.
 16061     EXIT.
 16062
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 301
* EL131.cbl
 16064 7700-CHECK-SEQUENCE.
 16065
 16066
 16067* EXEC CICS HANDLE CONDITION
 16068*        ENDFILE  (7799-EXIT)
 16069*        NOTFND   (7799-EXIT)
 16070*    END-EXEC.
 16071*    MOVE '"$''I                  ! F #00013511' TO DFHEIV0
 16072     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 16073     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16074     MOVE X'4620233030303133353131' TO DFHEIV0(25:11)
 16075     CALL 'kxdfhei1' USING DFHEIV0
 16076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16077
 16078
 16079
 16080* EXEC CICS READ
 16081*        DATASET(CLMS-FILE-ID)
 16082*        SET    (ADDRESS OF CLAIM-MASTER)
 16083*        RIDFLD (MSTR-KEY)
 16084*        GENERIC
 16085*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 16086*    END-EXEC.
 16087*    MOVE '&"S  KG    E          (   #00013516' TO DFHEIV0
 16088     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 16089     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16090     MOVE X'2020233030303133353136' TO DFHEIV0(25:11)
 16091     CALL 'kxdfhei1' USING DFHEIV0,
 16092           CLMS-FILE-ID,
 16093           DFHEIV20,
 16094           DFHEIV99,
 16095           MSTR-KEY,
 16096           ELMSTR-GENERIC-LENGTH,
 16097           DFHEIV99,
 16098           DFHEIV99
 16099     SET ADDRESS OF CLAIM-MASTER TO
 16100         DFHEIV20
 16101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16102
 16103
 16104     COMPUTE WS-ASSOC-CERT-TOTAL =
 16105             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 16106
 16107     GO TO 7799-EXIT.
 16108
 16109 7710-RESEQUENCE-CLAIMS.
 16110
 16111
 16112* EXEC CICS HANDLE CONDITION
 16113*        ENDFILE  (7799-EXIT)
 16114*    END-EXEC.
 16115*    MOVE '"$''                   ! G #00013531' TO DFHEIV0
 16116     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 16117     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16118     MOVE X'4720233030303133353331' TO DFHEIV0(25:11)
 16119     CALL 'kxdfhei1' USING DFHEIV0
 16120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16121
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 302
* EL131.cbl
 16122
 16123
 16124* EXEC CICS STARTBR
 16125*        DATASET(CLMS-FILE-ID)
 16126*        RIDFLD (MSTR-KEY)
 16127*    END-EXEC.
 16128     MOVE 0
 16129       TO DFHEIV11
 16130*    MOVE '&,         G          &   #00013535' TO DFHEIV0
 16131     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16132     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16133     MOVE X'2020233030303133353335' TO DFHEIV0(25:11)
 16134     CALL 'kxdfhei1' USING DFHEIV0,
 16135           CLMS-FILE-ID,
 16136           MSTR-KEY,
 16137           DFHEIV99,
 16138           DFHEIV11,
 16139           DFHEIV99
 16140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16141
 16142
 16143     COMPUTE WS-ASSOC-CERT-SEQU =
 16144             WS-ASSOC-CERT-SEQU + 1.
 16145
 16146     COMPUTE WS-READNEXT-SWITCH =
 16147             WS-READNEXT-SWITCH + 1.
 16148
 16149 7720-READ-CLAIM-LOOP.
 16150
 16151
 16152* EXEC CICS READNEXT
 16153*        DATASET(CLMS-FILE-ID)
 16154*        SET    (ADDRESS OF CLAIM-MASTER)
 16155*        RIDFLD (MSTR-KEY)
 16156*    END-EXEC.
 16157     MOVE 0
 16158       TO DFHEIV11
 16159*    MOVE '&.S                   )   #00013548' TO DFHEIV0
 16160     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16161     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16162     MOVE X'2020233030303133353438' TO DFHEIV0(25:11)
 16163     CALL 'kxdfhei1' USING DFHEIV0,
 16164           CLMS-FILE-ID,
 16165           DFHEIV20,
 16166           DFHEIV99,
 16167           MSTR-KEY,
 16168           DFHEIV99,
 16169           DFHEIV11,
 16170           DFHEIV99,
 16171           DFHEIV99
 16172     SET ADDRESS OF CLAIM-MASTER TO
 16173         DFHEIV20
 16174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16175
 16176
 16177     IF WS-READNEXT-SWITCH = 1
 16178         ADD 1                   TO WS-READNEXT-SWITCH
 16179         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 303
* EL131.cbl
 16180
 16181 7730-END-BROWSE.
 16182
 16183
 16184* EXEC CICS ENDBR
 16185*        DATASET(CLMS-FILE-ID)
 16186*    END-EXEC.
 16187     MOVE 0
 16188       TO DFHEIV11
 16189*    MOVE '&2                    $   #00013560' TO DFHEIV0
 16190     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16191     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16192     MOVE X'2020233030303133353630' TO DFHEIV0(25:11)
 16193     CALL 'kxdfhei1' USING DFHEIV0,
 16194           CLMS-FILE-ID,
 16195           DFHEIV11,
 16196           DFHEIV99
 16197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16198
 16199
 16200 7740-READ-CLAIM-UPDATE.
 16201
 16202     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 16203        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 16204        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 16205        GO TO 7799-EXIT
 16206     ELSE
 16207        MOVE ZERO                TO WS-READNEXT-SWITCH.
 16208
 16209
 16210* EXEC CICS READ
 16211*        DATASET(CLMS-FILE-ID)
 16212*        SET    (ADDRESS OF CLAIM-MASTER)
 16213*        RIDFLD (MSTR-KEY)
 16214*        UPDATE
 16215*    END-EXEC.
 16216*    MOVE '&"S        EU         (   #00013573' TO DFHEIV0
 16217     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16218     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16219     MOVE X'2020233030303133353733' TO DFHEIV0(25:11)
 16220     CALL 'kxdfhei1' USING DFHEIV0,
 16221           CLMS-FILE-ID,
 16222           DFHEIV20,
 16223           DFHEIV99,
 16224           MSTR-KEY,
 16225           DFHEIV99,
 16226           DFHEIV99,
 16227           DFHEIV99
 16228     SET ADDRESS OF CLAIM-MASTER TO
 16229         DFHEIV20
 16230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16231
 16232
 16233     if (cl-priority-cd = '8')
 16234        and (pi-processor-id not = 'PEMA' and 'JMS '
 16235             AND 'AMWA')
 16236        MOVE ER-8003             TO EMI-ERROR
 16237        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 304
* EL131.cbl
 16238                                 THRU 9900-EXIT
 16239        MOVE -1                  TO MAINTL
 16240        GO TO 8110-SEND-DATA
 16241     end-if
 16242
 16243     IF PI-COMPANY-ID = 'CID' or 'AHL'
 16244         MOVE 'Y'                TO CL-YESNOSW
 16245     END-IF.
 16246
 16247     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 16248     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 16249
 16250
 16251* EXEC CICS REWRITE
 16252*         DATASET(CLMS-FILE-ID)
 16253*         FROM   (CLAIM-MASTER)
 16254*    END-EXEC.
 16255     MOVE LENGTH OF
 16256      CLAIM-MASTER
 16257       TO DFHEIV11
 16258*    MOVE '&& L                  %   #00013597' TO DFHEIV0
 16259     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16260     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16261     MOVE X'2020233030303133353937' TO DFHEIV0(25:11)
 16262     CALL 'kxdfhei1' USING DFHEIV0,
 16263           CLMS-FILE-ID,
 16264           CLAIM-MASTER,
 16265           DFHEIV11,
 16266           DFHEIV99
 16267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16268
 16269
 16270     GO TO 7710-RESEQUENCE-CLAIMS.
 16271
 16272 7799-EXIT.
 16273     EXIT.
 16274
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 305
* EL131.cbl
 16276 7800-CHECK-AUTO-ACTIVITY.
 16277
 16278
 16279* EXEC CICS HANDLE CONDITION
 16280*        NOTFND   (7800-NOT-FOUND)
 16281*    END-EXEC.
 16282*    MOVE '"$I                   ! H #00013610' TO DFHEIV0
 16283     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16284     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16285     MOVE X'4820233030303133363130' TO DFHEIV0(25:11)
 16286     CALL 'kxdfhei1' USING DFHEIV0
 16287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16288
 16289
 16290     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 16291     MOVE 'T'                        TO  CNTL-REC-TYPE.
 16292     MOVE SPACES                     TO  CNTL-PROC-ID.
 16293     MOVE +0                         TO  CNTL-SEQ-NO.
 16294
 16295
 16296* EXEC CICS READ
 16297*        DATASET   (CNTL-FILE-ID)
 16298*        RIDFLD    (CNTL-KEY)
 16299*        SET       (ADDRESS OF CONTROL-FILE)
 16300*    END-EXEC.
 16301*    MOVE '&"S        E          (   #00013619' TO DFHEIV0
 16302     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16303     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16304     MOVE X'2020233030303133363139' TO DFHEIV0(25:11)
 16305     CALL 'kxdfhei1' USING DFHEIV0,
 16306           CNTL-FILE-ID,
 16307           DFHEIV20,
 16308           DFHEIV99,
 16309           CNTL-KEY,
 16310           DFHEIV99,
 16311           DFHEIV99,
 16312           DFHEIV99
 16313     SET ADDRESS OF CONTROL-FILE TO
 16314         DFHEIV20
 16315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16316
 16317
 16318     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 16319         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 16320
 16321     IF CL-ACTIVITY-CODE NOT = ZEROS
 16322         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 16323         IF MISC-SUB IS GREATER THAN +9
 16324             SUBTRACT +9 FROM MISC-SUB
 16325             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 16326         ELSE
 16327             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 16328     ELSE
 16329         MOVE 'Y'                              TO  WS-RESET-SW.
 16330
 16331     IF STATUSI = 'C' OR 'CLOSED'
 16332         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 16333             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 306
* EL131.cbl
 16334                                         PI-LETTER-SW
 16335             GO TO 7800-EXIT.
 16336
 16337     IF STATUSI = 'C' OR 'CLOSED'
 16338         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 16339             MOVE 'N'                TO  PI-LETTER-SW
 16340         ELSE
 16341             MOVE 'Y'                TO  PI-LETTER-SW.
 16342
 16343     IF STATUSI = 'O' OR 'OPEN'
 16344         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 16345             MOVE 'N'                TO  PI-REC-FOUND-SW
 16346                                         PI-LETTER-SW
 16347             GO TO 7800-EXIT.
 16348
 16349     IF STATUSI = 'O' OR 'OPEN'
 16350         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 16351             MOVE 'N'                TO  PI-LETTER-SW
 16352         ELSE
 16353             MOVE 'Y'                TO  PI-LETTER-SW.
 16354
 16355     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 16356     GO TO 7800-EXIT.
 16357
 16358 7800-NOT-FOUND.
 16359
 16360     MOVE 'N'                        TO  PI-REC-FOUND-SW
 16361                                         PI-LETTER-SW.
 16362
 16363 7800-EXIT.
 16364     EXIT.
 16365
 16366 7850-AUTO-LETTER-WRITER.
 16367
 16368     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 16369     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 16370
 16371     IF STATUSI = 'C' OR 'CLOSED'
 16372         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 16373     ELSE
 16374         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 16375
 16376     IF STATUSI = 'C' OR 'CLOSED'
 16377         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 16378             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16379             MOVE '6'                TO  DC-OPTION-CODE
 16380             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 16381             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16382             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16383             IF NO-CONVERSION-ERROR
 16384                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16385             ELSE
 16386                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16387
 16388     IF STATUSI = 'C' OR 'CLOSED'
 16389         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 16390             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16391             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 307
* EL131.cbl
 16392             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 16393             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16394             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16395             IF NO-CONVERSION-ERROR
 16396                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16397             ELSE
 16398                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16399
 16400     IF STATUSI = 'O' OR 'OPEN'
 16401         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 16402             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16403             MOVE '6'                TO  DC-OPTION-CODE
 16404             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 16405             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16406             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16407             IF NO-CONVERSION-ERROR
 16408                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16409             ELSE
 16410                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16411
 16412     IF STATUSI = 'O' OR 'OPEN'
 16413         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 16414             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16415             MOVE '6'                TO  DC-OPTION-CODE
 16416             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 16417             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16418             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16419             IF NO-CONVERSION-ERROR
 16420                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16421             ELSE
 16422                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16423
 16424
 16425* EXEC CICS LINK
 16426*        PROGRAM    (LINK-1523)
 16427*        COMMAREA   (W-1523-LINKDATA)
 16428*        LENGTH     (W-1523-COMM-LENGTH)
 16429*    END-EXEC.
 16430*    MOVE '."C                   (   #00013731' TO DFHEIV0
 16431     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16432     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16433     MOVE X'2020233030303133373331' TO DFHEIV0(25:11)
 16434     CALL 'kxdfhei1' USING DFHEIV0,
 16435           LINK-1523,
 16436           W-1523-LINKDATA,
 16437           W-1523-COMM-LENGTH,
 16438           DFHEIV99,
 16439           DFHEIV99,
 16440           DFHEIV99,
 16441           DFHEIV99
 16442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16443
 16444
 16445     IF W-1523-ERROR-CODE = ZEROS
 16446         GO TO 7850-EXIT.
 16447
 16448     IF W-1523-FATAL-ERROR
 16449         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 308
* EL131.cbl
 16450         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16451
 16452     IF W-1523-ERROR-CODE = 0191
 16453         MOVE ER-0803                TO  EMI-ERROR
 16454         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16455
 16456 7850-EXIT.
 16457     EXIT.
 16458
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 309
* EL131.cbl
 16460 8000-CREATE-DMO-REC.
 16461     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 16462     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 16463     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 16464
 16465
 16466* EXEC CICS HANDLE CONDITION
 16467*         NOTFND   (8000-NOTE-NOT-FOUND)
 16468*    END-EXEC.
 16469*    MOVE '"$I                   ! I #00013757' TO DFHEIV0
 16470     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16471     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16472     MOVE X'4920233030303133373537' TO DFHEIV0(25:11)
 16473     CALL 'kxdfhei1' USING DFHEIV0
 16474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16475
 16476
 16477
 16478* EXEC CICS READ
 16479*         DATASET(NOTE-FILE-ID)
 16480*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 16481*         RIDFLD (NOTE-KEY)
 16482*    END-EXEC.
 16483*    MOVE '&"S        E          (   #00013761' TO DFHEIV0
 16484     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16485     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16486     MOVE X'2020233030303133373631' TO DFHEIV0(25:11)
 16487     CALL 'kxdfhei1' USING DFHEIV0,
 16488           NOTE-FILE-ID,
 16489           DFHEIV20,
 16490           DFHEIV99,
 16491           NOTE-KEY,
 16492           DFHEIV99,
 16493           DFHEIV99,
 16494           DFHEIV99
 16495     SET ADDRESS OF CERTIFICATE-NOTE TO
 16496         DFHEIV20
 16497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16498
 16499
 16500     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 16501     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 16502     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 16503
 16504     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 16505         MOVE 'CC'               TO DCT-PRODUCT-CODE
 16506     ELSE
 16507         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 16508
 16509     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 16510     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 16511
 16512
 16513* EXEC CICS LINK
 16514*        PROGRAM    ('DLO006')
 16515*        COMMAREA   (DCT-COMMUNICATION-AREA)
 16516*        LENGTH     (WS-DCT-LENGTH)
 16517*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 310
* EL131.cbl
 16518     MOVE 'DLO006' TO DFHEIV1
 16519*    MOVE '."C                   (   #00013779' TO DFHEIV0
 16520     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16521     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16522     MOVE X'2020233030303133373739' TO DFHEIV0(25:11)
 16523     CALL 'kxdfhei1' USING DFHEIV0,
 16524           DFHEIV1,
 16525           DCT-COMMUNICATION-AREA,
 16526           WS-DCT-LENGTH,
 16527           DFHEIV99,
 16528           DFHEIV99,
 16529           DFHEIV99,
 16530           DFHEIV99
 16531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16532
 16533
 16534     IF  DCT-RETURN-CODE = 'OK'
 16535         GO TO 8000-CONT.
 16536
 16537     IF DCT-RETURN-CODE = '01' OR '02'
 16538         GO TO 8000-EXIT.
 16539
 16540     IF DCT-RETURN-CODE = '03'
 16541         MOVE ER-0951            TO EMI-ERROR
 16542         MOVE -1                 TO MAINTL
 16543         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16544         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16545         GO TO 8110-SEND-DATA.
 16546
 16547     IF DCT-RETURN-CODE = '04'
 16548         MOVE ER-0946            TO EMI-ERROR
 16549         MOVE -1                 TO MAINTL
 16550         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16551         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16552         GO TO 8110-SEND-DATA.
 16553
 16554     IF DCT-RETURN-CODE = '05'
 16555         MOVE ER-0947            TO EMI-ERROR
 16556         MOVE -1                 TO MAINTL
 16557         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16558         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16559         GO TO 8110-SEND-DATA.
 16560
 16561     IF DCT-RETURN-CODE = '06'
 16562         MOVE ER-0921            TO EMI-ERROR
 16563         MOVE -1                 TO MAINTL
 16564         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16565         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16566         GO TO 8110-SEND-DATA.
 16567
 16568     IF DCT-RETURN-CODE = '07'
 16569         MOVE ER-0919            TO EMI-ERROR
 16570         MOVE -1                 TO MAINTL
 16571         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16572         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16573         GO TO 8110-SEND-DATA.
 16574
 16575     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 311
* EL131.cbl
 16576         MOVE ER-0948            TO EMI-ERROR
 16577         MOVE -1                 TO MAINTL
 16578         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16579         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16580         GO TO 8110-SEND-DATA.
 16581
 16582     IF DCT-RETURN-CODE = 'N1'
 16583         MOVE ER-0950            TO EMI-ERROR
 16584         MOVE -1                 TO MAINTL
 16585         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16586         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16587         GO TO 8110-SEND-DATA.
 16588
 16589     IF DCT-RETURN-CODE = 'E1'
 16590         MOVE ER-0974            TO EMI-ERROR
 16591         MOVE -1                 TO MAINTL
 16592         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16593         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16594         GO TO 8110-SEND-DATA.
 16595
 16596     IF DCT-RETURN-CODE = 'E2'
 16597         MOVE ER-0975            TO EMI-ERROR
 16598         MOVE -1                 TO MAINTL
 16599         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16600         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16601         GO TO 8110-SEND-DATA.
 16602
 16603     IF DCT-RETURN-CODE NOT = 'OK'
 16604         MOVE ER-0949            TO EMI-ERROR
 16605         MOVE -1                 TO MAINTL
 16606         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16607         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16608         GO TO 8110-SEND-DATA.
 16609
 16610 8000-CONT.
 16611
 16612     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 16613     MOVE 'CS'                   TO DM-RECORD-TYPE.
 16614     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 16615     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 16616     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 16617     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 16618     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 16619     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 16620
 16621     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 16622     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 16623     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 16624     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 16625     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 16626
 16627     IF STATUSI = 'OPEN' OR 'O'
 16628         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 16629      ELSE
 16630         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 16631
 16632     IF STATUSI = 'OPEN' OR 'O'
 16633        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 312
* EL131.cbl
 16634         MOVE '1'                TO DM-CLAIM-STATUS
 16635      ELSE
 16636         MOVE '2'                TO DM-CLAIM-STATUS.
 16637
 16638     IF STATUSI = 'CLOSED' OR 'C'
 16639        IF NOT FINAL-PAID
 16640         MOVE '3'                TO DM-CLAIM-STATUS
 16641      ELSE
 16642         MOVE '4'                TO DM-CLAIM-STATUS.
 16643
 16644     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 16645
 16646
 16647* EXEC CICS LINK
 16648*        PROGRAM    ('DLO025')
 16649*        COMMAREA   (DMO-COMMUNICATION-AREA)
 16650*        LENGTH     (WS-DMO-LENGTH)
 16651*    END-EXEC.
 16652     MOVE 'DLO025' TO DFHEIV1
 16653*    MOVE '."C                   (   #00013897' TO DFHEIV0
 16654     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16655     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16656     MOVE X'2020233030303133383937' TO DFHEIV0(25:11)
 16657     CALL 'kxdfhei1' USING DFHEIV0,
 16658           DFHEIV1,
 16659           DMO-COMMUNICATION-AREA,
 16660           WS-DMO-LENGTH,
 16661           DFHEIV99,
 16662           DFHEIV99,
 16663           DFHEIV99,
 16664           DFHEIV99
 16665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16666
 16667
 16668     IF  DM-RETURN-CODE = 'OK'
 16669         GO TO 8000-EXIT.
 16670
 16671     IF DM-RETURN-CODE = '01'
 16672         MOVE ER-8051            TO EMI-ERROR
 16673         MOVE -1                 TO MAINTL
 16674         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16675         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16676         GO TO 8110-SEND-DATA.
 16677
 16678     IF DM-RETURN-CODE = '02'
 16679         MOVE ER-8052            TO EMI-ERROR
 16680         MOVE -1                 TO MAINTL
 16681         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16682         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16683         GO TO 8110-SEND-DATA.
 16684
 16685     IF DM-RETURN-CODE = '03'
 16686         MOVE ER-8053            TO EMI-ERROR
 16687         MOVE -1                 TO MAINTL
 16688         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16689         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16690         GO TO 8110-SEND-DATA.
 16691
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 313
* EL131.cbl
 16692     IF DM-RETURN-CODE = '04'
 16693         MOVE ER-8054            TO EMI-ERROR
 16694         MOVE -1                 TO MAINTL
 16695         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16696         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16697         GO TO 8110-SEND-DATA.
 16698
 16699     IF DM-RETURN-CODE = '05'
 16700         MOVE ER-8055            TO EMI-ERROR
 16701         MOVE -1                 TO MAINTL
 16702         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16703         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16704         GO TO 8110-SEND-DATA.
 16705
 16706     IF DM-RETURN-CODE = '06'
 16707         MOVE ER-8056            TO EMI-ERROR
 16708         MOVE -1                 TO MAINTL
 16709         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16710         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16711         GO TO 8110-SEND-DATA.
 16712
 16713     IF DM-RETURN-CODE = '07'
 16714         MOVE ER-8057            TO EMI-ERROR
 16715         MOVE -1                 TO MAINTL
 16716         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16717         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16718         GO TO 8110-SEND-DATA.
 16719
 16720     IF DM-RETURN-CODE = '08'
 16721         MOVE ER-8058            TO EMI-ERROR
 16722         MOVE -1                 TO MAINTL
 16723         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16724         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16725         GO TO 8110-SEND-DATA.
 16726
 16727     IF DM-RETURN-CODE = '09'
 16728         MOVE ER-8059            TO EMI-ERROR
 16729         MOVE -1                 TO MAINTL
 16730         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16731         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16732         GO TO 8110-SEND-DATA.
 16733
 16734     IF DM-RETURN-CODE = '10'
 16735         MOVE ER-8060            TO EMI-ERROR
 16736         MOVE -1                 TO MAINTL
 16737         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16738         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16739         GO TO 8110-SEND-DATA.
 16740
 16741     IF DM-RETURN-CODE = '11'
 16742         MOVE ER-8061            TO EMI-ERROR
 16743         MOVE -1                 TO MAINTL
 16744         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16745         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16746         GO TO 8110-SEND-DATA.
 16747
 16748     IF DM-RETURN-CODE = '12'
 16749         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 314
* EL131.cbl
 16750         MOVE -1                 TO MAINTL
 16751         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16752         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16753         GO TO 8110-SEND-DATA.
 16754
 16755     IF DM-RETURN-CODE = '13'
 16756         MOVE ER-8063            TO EMI-ERROR
 16757         MOVE -1                 TO MAINTL
 16758         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16759         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16760         GO TO 8110-SEND-DATA.
 16761
 16762     IF DM-RETURN-CODE = '14'
 16763         MOVE ER-8064            TO EMI-ERROR
 16764         MOVE -1                 TO MAINTL
 16765         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16766         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16767         GO TO 8110-SEND-DATA.
 16768
 16769     IF DM-RETURN-CODE = '15'
 16770         MOVE ER-8065            TO EMI-ERROR
 16771         MOVE -1                 TO MAINTL
 16772         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16773         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16774         GO TO 8110-SEND-DATA.
 16775
 16776     IF DM-RETURN-CODE = '16'
 16777         MOVE ER-8154            TO EMI-ERROR
 16778         MOVE -1                 TO MAINTL
 16779         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16780         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16781         GO TO 8110-SEND-DATA.
 16782
 16783     IF DM-RETURN-CODE = '17'
 16784         MOVE ER-8155            TO EMI-ERROR
 16785         MOVE -1                 TO MAINTL
 16786         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16787         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16788         GO TO 8110-SEND-DATA.
 16789
 16790     IF DM-RETURN-CODE = 'N1'
 16791         MOVE ER-8152            TO EMI-ERROR
 16792         MOVE -1                 TO MAINTL
 16793         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16794         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16795         GO TO 8110-SEND-DATA.
 16796
 16797     IF DM-RETURN-CODE = 'E1'
 16798         MOVE ER-8153            TO EMI-ERROR
 16799         MOVE -1                 TO MAINTL
 16800         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16801         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16802         GO TO 8110-SEND-DATA.
 16803
 16804     MOVE ER-8066                TO EMI-ERROR.
 16805     MOVE -1                     TO MAINTL.
 16806     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16807     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 315
* EL131.cbl
 16808     GO TO 8110-SEND-DATA.
 16809
 16810 8000-NOTE-NOT-FOUND.
 16811
 16812* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16813*    MOVE '6"R                   !   #00014046' TO DFHEIV0
 16814     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16815     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16816     MOVE X'2020233030303134303436' TO DFHEIV0(25:11)
 16817     CALL 'kxdfhei1' USING DFHEIV0
 16818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16819
 16820     MOVE ER-0954                TO EMI-ERROR.
 16821     MOVE -1                     TO MAINTL.
 16822     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16823     GO TO 8110-SEND-DATA.
 16824
 16825 8000-EXIT.
 16826     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 316
* EL131.cbl
 16828 8050-FORMAT-LAST-NAME-1ST.
 16829*****************************************************************
 16830*             M O V E   N A M E   R O U T I N E                 *
 16831*                                                               *
 16832*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 16833*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 16834*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 16835*                                                               *
 16836*                  FIELD               VALUE                    *
 16837*                  -----               -----                    *
 16838*           W-NAME-LAST    (CL15)      SMITH                    *
 16839*           W-NAME-FIRST   (CL15)      JOHN                     *
 16840*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 16841*                                                               *
 16842*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 16843*                SMITH, JOHN ALLEN                              *
 16844*                     OR                                        *
 16845*                SMITH, JOHN A.                                 *
 16846*                                                               *
 16847*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 16848*     COPYBOOK, ELCNWA.                                         *
 16849*****************************************************************.
 16850
 16851     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 16852     MOVE ZERO                   TO WS-NAME-SW.
 16853     SET NWA-INDEX               TO +1.
 16854
 16855     IF W-NAME-LAST   = SPACES  AND
 16856        W-NAME-MIDDLE = SPACES
 16857          MOVE +1                TO WS-NAME-SW.
 16858
 16859     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 16860     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16861
 16862     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 16863     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16864
 16865     SET NWA-INDEX UP BY +1.
 16866
 16867     IF W-NAME-MIDDLE NOT = SPACES
 16868         IF W-NAME-MIDDLE-2 = SPACES
 16869             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 16870             SET NWA-INDEX UP BY +1
 16871             MOVE '.'            TO WS-NW (NWA-INDEX)
 16872             SET NWA-INDEX UP BY +2
 16873         ELSE
 16874             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 16875             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16876
 16877 8050-EXIT.
 16878     EXIT.
 16879
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 317
* EL131.cbl
 16881 8060-MOVE-NAME.
 16882     IF WS-NAME-SW GREATER THAN +1
 16883         GO TO 8060-EXIT.
 16884
 16885     IF WS-NAME-WORK2 = SPACES
 16886         GO TO 8060-EXIT.
 16887
 16888     SET NWA-INDEX2            TO +1.
 16889     SET NWA-INDEX3            TO +2.
 16890
 16891 8060-MOVE-NAME-CYCLE.
 16892     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 16893
 16894     IF NWA-INDEX LESS THAN +30
 16895         SET NWA-INDEX UP BY +1
 16896     ELSE
 16897         ADD +2 TO  WS-NAME-SW
 16898         GO TO 8060-EXIT.
 16899
 16900     IF NWA-INDEX2 LESS THAN +20
 16901         SET NWA-INDEX3 UP BY +1
 16902         SET NWA-INDEX2 UP BY +1.
 16903
 16904     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 16905        WS-NW2 (NWA-INDEX3) = SPACES
 16906         IF WS-NAME-SW = ZERO
 16907             MOVE ','            TO WS-NW (NWA-INDEX)
 16908             SET NWA-INDEX UP BY +2
 16909             MOVE +1             TO WS-NAME-SW
 16910             GO TO 8060-EXIT
 16911         ELSE
 16912             GO TO 8060-EXIT.
 16913
 16914     GO TO 8060-MOVE-NAME-CYCLE.
 16915
 16916 8060-EXIT.
 16917     EXIT.
 16918
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 318
* EL131.cbl
 16920
 16921 8070-UNLOCK-CLAIM-MSTR.
 16922
 16923* EXEC CICS UNLOCK
 16924*        DATASET   (CLMS-FILE-ID)
 16925*    END-EXEC.
 16926*    MOVE '&*                    #   #00014149' TO DFHEIV0
 16927     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16928     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16929     MOVE X'2020233030303134313439' TO DFHEIV0(25:11)
 16930     CALL 'kxdfhei1' USING DFHEIV0,
 16931           CLMS-FILE-ID,
 16932           DFHEIV99
 16933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16934
 16935
 16936 8070-EXIT.
 16937      EXIT.
 16938
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 319
* EL131.cbl
 16940 8100-SEND-MAP.
 16941     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 16942
 16943     move al-uanon               to accswa
 16944     IF NOT PI-NO-CARRIER-SECURITY
 16945        MOVE AL-SANOF            TO CERTCARA.
 16946     IF NOT PI-NO-ACCOUNT-SECURITY
 16947        MOVE AL-SANOF            TO CERTACTA.
 16948
 16949     IF PI-PROCESSOR-ID = 'LGXX'
 16950        MOVE AL-UANON            TO CCNOA.
 16951
 16952     IF PI-COMPANY-ID = 'DMD'
 16953        NEXT SENTENCE
 16954     ELSE
 16955        MOVE AL-SADOF            TO PFKEY6A.
 16956     IF NOT (PI-COMPANY-ID = 'DCC' OR 'VPP')
 16957        MOVE AL-SANOF TO EXTENSA
 16958     END-IF
 16959
 16960     IF PI-USES-PAID-TO
 16961        MOVE 'PAID TO  :' TO PTHRHDGO.
 16962
 16963
 16964* EXEC CICS SEND
 16965*         MAP     ('EL131A')
 16966*         MAPSET  ('EL131S')
 16967*         ERASE
 16968*         FREEKB
 16969*         CURSOR
 16970*    END-EXEC.
 16971     MOVE 'EL131A' TO DFHEIV1
 16972     MOVE -1
 16973       TO DFHEIV11
 16974     MOVE 'EL131S' TO DFHEIV2
 16975*    MOVE '8$     CT  E F  H     ,   #00014180' TO DFHEIV0
 16976     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16977     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 16978     MOVE X'2020233030303134313830' TO DFHEIV0(25:11)
 16979     CALL 'kxdfhei1' USING DFHEIV0,
 16980           DFHEIV1,
 16981           EL131AO,
 16982           DFHEIV99,
 16983           DFHEIV2,
 16984           DFHEIV99,
 16985           DFHEIV99,
 16986           DFHEIV99,
 16987           DFHEIV11,
 16988           DFHEIV99,
 16989           DFHEIV99,
 16990           DFHEIV99
 16991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16992
 16993
 16994     GO TO 9000-RETURN-TRANS.
 16995
 16996 8110-SEND-DATA.
 16997     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 320
* EL131.cbl
 16998
 16999     IF PI-USES-PAID-TO
 17000        MOVE 'PAID TO  :' TO PTHRHDGO.
 17001
 17002     IF PI-PROCESSOR-ID = 'LGXX'
 17003        MOVE AL-UANON            TO CCNOA.
 17004
 17005     IF PI-COMPANY-ID = 'DMD'
 17006        NEXT SENTENCE
 17007     ELSE
 17008        MOVE AL-SADOF            TO PFKEY6A.
 17009
 17010
 17011* EXEC CICS SEND
 17012*         MAP      ('EL131A')
 17013*         MAPSET   ('EL131S')
 17014*         DATAONLY
 17015*         FREEKB
 17016*         CURSOR
 17017*    END-EXEC.
 17018     MOVE 'EL131A' TO DFHEIV1
 17019     MOVE -1
 17020       TO DFHEIV11
 17021     MOVE 'EL131S' TO DFHEIV2
 17022*    MOVE '8$D    CT    F  H     ,   #00014204' TO DFHEIV0
 17023     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 17024     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 17025     MOVE X'2020233030303134323034' TO DFHEIV0(25:11)
 17026     CALL 'kxdfhei1' USING DFHEIV0,
 17027           DFHEIV1,
 17028           EL131AO,
 17029           DFHEIV99,
 17030           DFHEIV2,
 17031           DFHEIV99,
 17032           DFHEIV99,
 17033           DFHEIV99,
 17034           DFHEIV11,
 17035           DFHEIV99,
 17036           DFHEIV99,
 17037           DFHEIV99
 17038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17039
 17040
 17041     GO TO 9000-RETURN-TRANS.
 17042
 17043 8120-FORMAT-TIME-DATE.
 17044     perform 8140-check-for-prev-errors
 17045                                 thru 8140-exit
 17046     IF SKIP-ATTRIBUTE = 'Y'
 17047        MOVE SPACES              TO SKIP-ATTRIBUTE
 17048        MOVE ER-0598             TO EMI-ERROR
 17049        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17050        GO TO 8125-SKIP-ATTRIBUTE.
 17051
 17052*     IF PI-COMPANY-ID = 'DMD'
 17053      IF PI-PROCESSOR-ID <> 'EMER'
 17054         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 17055                                    CERTCARA  CERTGRPA CERTA SUFXA
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 321
* EL131.cbl
 17056
 17057     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 17058                                    ISSAGEA   JNTLNMEA  JNTFNMEA
 17059                                    JNTINITA  JNTAGEA   APRA
 17060                                    LCVCDA    LCVOTRMA  LCVRTRMA
 17061                                    LCVBENEA  LCVFORMA  LCVCNDTA
 17062                                    LCVEXITA  LCVSTATA  LCVKINDA
 17063                                    ACVCDA    ACVOTRMA  ACVRTRMA
 17064                                    ACVBENEA  ACVFORMA  ACVCNDTA
 17065                                    ACVEXITA  ACVSTATA  ACVKINDA
 17066                                    PMTFREQA  INDGRPA   PREMTYPA
 17067                                    REINCDA   LCVRATEA  ACVRATEA
 17068                                    ADDONDTA.
 17069
 17070*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 17071*       IF PI-COMPANY-ID = 'DMD'
 17072*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 17073*                                   SUFXA
 17074*                                   PDAMTA    NODAYSA   NOPMTSA
 17075*                                   INCA      OCCA
 17076*          IF NOT SYSTEM-MODIFY-CAP
 17077*              MOVE AL-SANOF         TO PDTHRUA.
 17078
 17079     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 17080         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 17081
 17082 8125-SKIP-ATTRIBUTE.
 17083
 17084     MOVE SAVE-DATE              TO DATEO.
 17085
 17086* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 17087*    END-EXEC
 17088*    MOVE '0"A                   "   #00014256' TO DFHEIV0
 17089     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 17090     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 17091     MOVE X'2020233030303134323536' TO DFHEIV0(25:11)
 17092     CALL 'kxdfhei1' USING DFHEIV0,
 17093           LCP-CICS-TIME
 17094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17095
 17096* EXEC CICS FORMATTIME
 17097*              ABSTIME(LCP-CICS-TIME)
 17098*              TIME(LCP-TIME-OF-DAY-XX)
 17099*    END-EXEC
 17100*    MOVE 'j$(     (             #   #00014258' TO DFHEIV0
 17101     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 17102     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17103     MOVE X'2020233030303134323538' TO DFHEIV0(25:11)
 17104     CALL 'kxdfhei1' USING DFHEIV0,
 17105           LCP-CICS-TIME,
 17106           LCP-TIME-OF-DAY-XX
 17107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17108     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 17109     MOVE UN-HOURS               TO FOR-HOURS.
 17110     MOVE UN-MINUTES             TO FOR-MINUTES.
 17111     MOVE TIME-OUT               TO TIMEO.
 17112     MOVE PI-COMPANY-ID          TO COMPO.
 17113     MOVE PI-PROCESSOR-ID        TO USERIDO.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 322
* EL131.cbl
 17114     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 17115     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 17116     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
 17117     MOVE EMI-MESSAGE-AREA (2)   TO MSG2O.
 17118
 17119 8130-EXIT.
 17120     EXIT.
 17121
 17122 8140-check-for-prev-errors.
 17123
 17124     MOVE PI-COMPANY-CD          TO trlr-company-cd
 17125     MOVE PI-CARRIER             TO trlr-carrier
 17126     MOVE PI-CLAIM-NO            TO trlr-claim-no
 17127     MOVE PI-CERT-NO             TO trlr-cert-no
 17128     MOVE +95                    TO TRLR-SEQ-NO
 17129
 17130
 17131* EXEC CICS READ
 17132*       DATASET  ('ELTRLR')
 17133*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17134*       RIDFLD   (TRLR-KEY)
 17135*       RESP     (WS-RESPONSE)
 17136*    END-EXEC
 17137     MOVE 'ELTRLR' TO DFHEIV1
 17138*    MOVE '&"S        E          (  N#00014284' TO DFHEIV0
 17139     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17140     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17141     MOVE X'204E233030303134323834' TO DFHEIV0(25:11)
 17142     CALL 'kxdfhei1' USING DFHEIV0,
 17143           DFHEIV1,
 17144           DFHEIV20,
 17145           DFHEIV99,
 17146           TRLR-KEY,
 17147           DFHEIV99,
 17148           DFHEIV99,
 17149           DFHEIV99
 17150     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17151         DFHEIV20
 17152     MOVE EIBRESP  TO WS-RESPONSE
 17153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17154
 17155     if ws-resp-normal
 17156        perform varying s1 from +1 by +1 until
 17157           at-note-error-no (s1) = spaces
 17158           if at-note-error-no (s1) = '1652'
 17159              continue
 17160           else
 17161              move at-note-error-no (s1)
 17162                                 to emi-error
 17163              move -1 to maintl
 17164              if at-note-error-no (s1) = '1653'
 17165                 evaluate true
 17166                    when pi-claim-type = 'L'
 17167                       move '  LF  '
 17168                        to emi-claim-type
 17169                    when pi-claim-type = 'I'
 17170                       move '  IU  '
 17171                        to emi-claim-type
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 323
* EL131.cbl
 17172                    WHEN PI-CLAIM-TYPE = 'F'
 17173                       MOVE '  FL  '
 17174                        TO EMI-CLAIM-TYPE
 17175                    when other
 17176                       move '  AH  '
 17177                        to emi-claim-type
 17178                 end-evaluate
 17179              end-if
 17180              PERFORM 9900-ERROR-FORMAT
 17181                                 THRU 9900-EXIT
 17182           end-if
 17183*          if at-note-error-no (s1) = '1653'
 17184*             perform varying emi-sub from 1 by 1 until
 17185*                emi-sub > 3
 17186*                if emi-error-number (emi-sub) = '1653'
 17187*                   evaluate true
 17188*                      when pi-claim-type = 'L'
 17189*                         move '  LF  '
 17190*                          to emi-claim-type
 17191*                      when pi-claim-type = 'I'
 17192*                         move '  IU  '
 17193*                          to emi-claim-type
 17194*                      when other
 17195*                         move '  AH  '
 17196*                          to emi-claim-type
 17197*                   end-evaluate
 17198*                end-if
 17199*             end-perform
 17200*          end-if
 17201        end-perform
 17202     else
 17203        display ' resp not normal ' ws-response ' '
 17204        trlr-key (2:19)
 17205     end-if
 17206
 17207     .
 17208 8140-exit.
 17209     exit.
 17210 8150-ENTERED-CLAIM-NOTFOUND.
 17211
 17212     MOVE ER-0204                TO EMI-ERROR.
 17213     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17214     MOVE -1                     TO MAINTL.
 17215     GO TO 8100-SEND-MAP.
 17216
 17217 8200-RETURN-PRIOR.
 17218     MOVE SPACE                  TO PI-RETURN-CD-1.
 17219     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 17220     GO TO 9200-XCTL.
 17221
 17222 8300-GET-HELP.
 17223     MOVE XCTL-EL010             TO CALL-PGM.
 17224     GO TO 9200-XCTL.
 17225
 17226 8400-RETURN-MASTER.
 17227     MOVE SPACE                  TO PI-RETURN-CD-1.
 17228     MOVE XCTL-EL126             TO CALL-PGM.
 17229     GO TO 9200-XCTL.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 324
* EL131.cbl
 17230
 17231 8500-TRLR-MNT.
 17232     IF PI-RETURN-CD-1 = 'X'
 17233         MOVE ER-0311            TO EMI-ERROR
 17234         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17235         MOVE -1                 TO MAINTL
 17236         GO TO 8110-SEND-DATA.
 17237
 17238
 17239* EXEC CICS WRITEQ TS
 17240*         QUEUE     (PI-KEY)
 17241*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17242*         LENGTH    (PI-COMM-LENGTH)
 17243*    END-EXEC.
 17244*    MOVE '*"     L              ''   #00014374' TO DFHEIV0
 17245     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17246     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17247     MOVE X'2020233030303134333734' TO DFHEIV0(25:11)
 17248     CALL 'kxdfhei1' USING DFHEIV0,
 17249           PI-KEY,
 17250           PROGRAM-INTERFACE-BLOCK,
 17251           PI-COMM-LENGTH,
 17252           DFHEIV99,
 17253           DFHEIV99,
 17254           DFHEIV99
 17255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17256
 17257
 17258     MOVE XCTL-EL142             TO CALL-PGM.
 17259     GO TO 9200-XCTL.
 17260
 17261 8600-ADDR-MNT.
 17262     IF PI-RETURN-CD-1 = 'X'
 17263         MOVE ER-0311            TO EMI-ERROR
 17264         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17265         MOVE -1                 TO MAINTL
 17266         GO TO 8110-SEND-DATA.
 17267
 17268
 17269* EXEC CICS WRITEQ TS
 17270*         QUEUE     (PI-KEY)
 17271*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17272*         LENGTH    (PI-COMM-LENGTH)
 17273*    END-EXEC.
 17274*    MOVE '*"     L              ''   #00014390' TO DFHEIV0
 17275     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17276     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17277     MOVE X'2020233030303134333930' TO DFHEIV0(25:11)
 17278     CALL 'kxdfhei1' USING DFHEIV0,
 17279           PI-KEY,
 17280           PROGRAM-INTERFACE-BLOCK,
 17281           PI-COMM-LENGTH,
 17282           DFHEIV99,
 17283           DFHEIV99,
 17284           DFHEIV99
 17285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17286
 17287
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 325
* EL131.cbl
 17288     MOVE XCTL-EL141             TO CALL-PGM.
 17289     GO TO 9200-XCTL.
 17290
 17291 8700-CERT-MNT.
 17292     IF PI-RETURN-CD-1 = 'X'
 17293         MOVE ER-7690            TO EMI-ERROR
 17294         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17295         MOVE -1                 TO MAINTL
 17296         GO TO 8110-SEND-DATA.
 17297
 17298
 17299* EXEC CICS WRITEQ TS
 17300*         QUEUE     (PI-KEY)
 17301*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17302*         LENGTH    (PI-COMM-LENGTH)
 17303*    END-EXEC.
 17304*    MOVE '*"     L              ''   #00014406' TO DFHEIV0
 17305     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17306     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17307     MOVE X'2020233030303134343036' TO DFHEIV0(25:11)
 17308     CALL 'kxdfhei1' USING DFHEIV0,
 17309           PI-KEY,
 17310           PROGRAM-INTERFACE-BLOCK,
 17311           PI-COMM-LENGTH,
 17312           DFHEIV99,
 17313           DFHEIV99,
 17314           DFHEIV99
 17315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17316
 17317
 17318     MOVE XCTL-EL1273            TO CALL-PGM.
 17319     GO TO 9200-XCTL.
 17320
 17321 8725-BENEFICIARY-MNT.
 17322     IF PI-RETURN-CD-1 = 'X'
 17323         MOVE ER-0311            TO EMI-ERROR
 17324         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17325         MOVE -1                 TO MAINTL
 17326         GO TO 8110-SEND-DATA.
 17327
 17328
 17329* EXEC CICS WRITEQ TS
 17330*         QUEUE     (PI-KEY)
 17331*         FROM      (EL131AI)
 17332*         LENGTH    (MAP-LENGTH)
 17333*    END-EXEC.
 17334*    MOVE '*"     L              ''   #00014422' TO DFHEIV0
 17335     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17336     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17337     MOVE X'2020233030303134343232' TO DFHEIV0(25:11)
 17338     CALL 'kxdfhei1' USING DFHEIV0,
 17339           PI-KEY,
 17340           EL131AI,
 17341           MAP-LENGTH,
 17342           DFHEIV99,
 17343           DFHEIV99,
 17344           DFHEIV99
 17345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 326
* EL131.cbl
 17346
 17347
 17348
 17349* EXEC CICS WRITEQ TS
 17350*         QUEUE     (PI-KEY)
 17351*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17352*         LENGTH    (PI-COMM-LENGTH)
 17353*    END-EXEC.
 17354*    MOVE '*"     L              ''   #00014428' TO DFHEIV0
 17355     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17356     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17357     MOVE X'2020233030303134343238' TO DFHEIV0(25:11)
 17358     CALL 'kxdfhei1' USING DFHEIV0,
 17359           PI-KEY,
 17360           PROGRAM-INTERFACE-BLOCK,
 17361           PI-COMM-LENGTH,
 17362           DFHEIV99,
 17363           DFHEIV99,
 17364           DFHEIV99
 17365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17366
 17367
 17368     MOVE XCTL-EL114             TO CALL-PGM.
 17369     GO TO 9200-XCTL.
 17370
 17371 8750-DMD-CLM-FIX.
 17372
 17373* EXEC CICS WRITEQ TS
 17374*         QUEUE     (PI-KEY)
 17375*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17376*         LENGTH    (PI-COMM-LENGTH)
 17377*    END-EXEC.
 17378*    MOVE '*"     L              ''   #00014438' TO DFHEIV0
 17379     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17380     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17381     MOVE X'2020233030303134343338' TO DFHEIV0(25:11)
 17382     CALL 'kxdfhei1' USING DFHEIV0,
 17383           PI-KEY,
 17384           PROGRAM-INTERFACE-BLOCK,
 17385           PI-COMM-LENGTH,
 17386           DFHEIV99,
 17387           DFHEIV99,
 17388           DFHEIV99
 17389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17390
 17391
 17392     MOVE XCTL-EL400DMD          TO CALL-PGM.
 17393     GO TO 9200-XCTL.
 17394
 17395 8800-UNAUTHORIZED-ACCESS.
 17396     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 17397     GO TO 8990-SEND-TEXT.
 17398
 17399 8810-PF23-ENTERED.
 17400     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 17401     MOVE XCTL-EL005             TO CALL-PGM.
 17402     GO TO 9200-XCTL.
 17403
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 327
* EL131.cbl
 17404 8820-XCTL-ERROR.
 17405
 17406* EXEC CICS HANDLE CONDITION
 17407*        PGMIDERR (8990-SEND-TEXT)
 17408*    END-EXEC.
 17409*    MOVE '"$L                   ! J #00014457' TO DFHEIV0
 17410     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 17411     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17412     MOVE X'4A20233030303134343537' TO DFHEIV0(25:11)
 17413     CALL 'kxdfhei1' USING DFHEIV0
 17414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17415
 17416
 17417     MOVE SPACE                 TO PI-ENTRY-CD-1.
 17418     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 17419     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 17420     MOVE XCTL-EL005            TO CALL-PGM.
 17421     GO TO 9200-XCTL.
 17422
 17423 8990-SEND-TEXT.
 17424
 17425* EXEC CICS SEND TEXT
 17426*         FROM      (LOGOFF-TEXT)
 17427*         LENGTH    (LOGOFF-LENGTH)
 17428*         ERASE
 17429*         FREEKB
 17430*    END-EXEC.
 17431*    MOVE '8&      T  E F  H   F -   #00014468' TO DFHEIV0
 17432     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 17433     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 17434     MOVE X'2020233030303134343638' TO DFHEIV0(25:11)
 17435     CALL 'kxdfhei1' USING DFHEIV0,
 17436           LOGOFF-TEXT,
 17437           LOGOFF-LENGTH,
 17438           DFHEIV99,
 17439           DFHEIV99,
 17440           DFHEIV99,
 17441           DFHEIV99,
 17442           DFHEIV99,
 17443           DFHEIV99,
 17444           DFHEIV99,
 17445           DFHEIV99,
 17446           DFHEIV99,
 17447           DFHEIV99
 17448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17449
 17450
 17451     GO TO 9100-RETURN-CICS.
 17452
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 328
* EL131.cbl
 17454 9000-RETURN-TRANS.
 17455
 17456* EXEC CICS RETURN
 17457*         TRANSID   (TRANS-ID)
 17458*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 17459*         LENGTH    (PI-COMM-LENGTH)
 17460*    END-EXEC.
 17461*    MOVE '.(CT                  ''   #00014479' TO DFHEIV0
 17462     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 17463     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17464     MOVE X'2020233030303134343739' TO DFHEIV0(25:11)
 17465     CALL 'kxdfhei1' USING DFHEIV0,
 17466           TRANS-ID,
 17467           PROGRAM-INTERFACE-BLOCK,
 17468           PI-COMM-LENGTH,
 17469           DFHEIV99,
 17470           DFHEIV99,
 17471           DFHEIV99
 17472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17473
 17474
 17475
 17476* GOBACK.
 17477     MOVE '9%                    "   ' TO DFHEIV0
 17478     MOVE 'EL131' TO DFHEIV1
 17479     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17480     GOBACK.
 17481
 17482 9100-RETURN-CICS.
 17483
 17484* EXEC CICS RETURN
 17485*    END-EXEC.
 17486*    MOVE '.(                    ''   #00014488' TO DFHEIV0
 17487     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 17488     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17489     MOVE X'2020233030303134343838' TO DFHEIV0(25:11)
 17490     CALL 'kxdfhei1' USING DFHEIV0,
 17491           DFHEIV99,
 17492           DFHEIV99,
 17493           DFHEIV99,
 17494           DFHEIV99,
 17495           DFHEIV99,
 17496           DFHEIV99
 17497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17498
 17499
 17500
 17501* GOBACK.
 17502     MOVE '9%                    "   ' TO DFHEIV0
 17503     MOVE 'EL131' TO DFHEIV1
 17504     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17505     GOBACK.
 17506
 17507 9200-XCTL.
 17508
 17509* EXEC CICS XCTL
 17510*         PROGRAM    (CALL-PGM)
 17511*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 329
* EL131.cbl
 17512*         LENGTH     (PI-COMM-LENGTH)
 17513*    END-EXEC.
 17514*    MOVE '.$C                   %   #00014494' TO DFHEIV0
 17515     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 17516     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17517     MOVE X'2020233030303134343934' TO DFHEIV0(25:11)
 17518     CALL 'kxdfhei1' USING DFHEIV0,
 17519           CALL-PGM,
 17520           PROGRAM-INTERFACE-BLOCK,
 17521           PI-COMM-LENGTH,
 17522           DFHEIV99
 17523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17524
 17525
 17526 9700-LINK-RTRM-FILE-ID.
 17527
 17528* EXEC CICS LINK
 17529*        PROGRAM  (RTRM-FILE-ID)
 17530*        COMMAREA (CALCULATION-PASS-AREA)
 17531*        LENGTH   (CP-COMM-LENGTH)
 17532*    END-EXEC.
 17533*    MOVE '."C                   (   #00014501' TO DFHEIV0
 17534     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17535     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17536     MOVE X'2020233030303134353031' TO DFHEIV0(25:11)
 17537     CALL 'kxdfhei1' USING DFHEIV0,
 17538           RTRM-FILE-ID,
 17539           CALCULATION-PASS-AREA,
 17540           CP-COMM-LENGTH,
 17541           DFHEIV99,
 17542           DFHEIV99,
 17543           DFHEIV99,
 17544           DFHEIV99
 17545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17546
 17547
 17548 9700-EXIT.
 17549      EXIT.
 17550
 17551 9800-CONVERT-DATE.
 17552     MOVE SPACES TO DC-ERROR-CODE.
 17553
 17554* EXEC CICS LINK
 17555*         PROGRAM    (DATE-CONV)
 17556*         COMMAREA   (DATE-CONVERSION-DATA)
 17557*         LENGTH     (DC-COMM-LENGTH)
 17558*    END-EXEC.
 17559*    MOVE '."C                   (   #00014512' TO DFHEIV0
 17560     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17561     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17562     MOVE X'2020233030303134353132' TO DFHEIV0(25:11)
 17563     CALL 'kxdfhei1' USING DFHEIV0,
 17564           DATE-CONV,
 17565           DATE-CONVERSION-DATA,
 17566           DC-COMM-LENGTH,
 17567           DFHEIV99,
 17568           DFHEIV99,
 17569           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 330
* EL131.cbl
 17570           DFHEIV99
 17571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17572
 17573
 17574 9800-EXIT.
 17575     EXIT.
 17576
 17577 9900-ERROR-FORMAT.
 17578
 17579* EXEC CICS LINK
 17580*         PROGRAM    (XCTL-EL001)
 17581*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 17582*         LENGTH     (EMI-COMM-LENGTH)
 17583*    END-EXEC.
 17584*    MOVE '."C                   (   #00014522' TO DFHEIV0
 17585     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17586     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17587     MOVE X'2020233030303134353232' TO DFHEIV0(25:11)
 17588     CALL 'kxdfhei1' USING DFHEIV0,
 17589           XCTL-EL001,
 17590           ERROR-MESSAGE-INTERFACE-BLOCK,
 17591           EMI-COMM-LENGTH,
 17592           DFHEIV99,
 17593           DFHEIV99,
 17594           DFHEIV99,
 17595           DFHEIV99
 17596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17597
 17598
 17599 9900-EXIT.
 17600     EXIT.
 17601
 17602 9990-ABEND.
 17603     MOVE DFHEIBLK               TO EMI-LINE1.
 17604
 17605* EXEC CICS LINK
 17606*         PROGRAM   (XCTL-EL004)
 17607*         COMMAREA  (EMI-LINE1)
 17608*         LENGTH    (72)
 17609*     END-EXEC.
 17610     MOVE 72
 17611       TO DFHEIV11
 17612*    MOVE '."C                   (   #00014533' TO DFHEIV0
 17613     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17614     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17615     MOVE X'2020233030303134353333' TO DFHEIV0(25:11)
 17616     CALL 'kxdfhei1' USING DFHEIV0,
 17617           XCTL-EL004,
 17618           EMI-LINE1,
 17619           DFHEIV11,
 17620           DFHEIV99,
 17621           DFHEIV99,
 17622           DFHEIV99,
 17623           DFHEIV99
 17624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17625
 17626
 17627     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 331
* EL131.cbl
 17628
 17629     GO TO 8110-SEND-DATA.
 17630
 17631 9995-SECURITY-VIOLATION.
 17632*           COPY ELCSCTP.
 17633******************************************************************
 17634*                                                                *
 17635*                            ELCSCTP                             *
 17636*                            VMOD=2.001                          *
 17637*                                                                *
 17638*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17639******************************************************************
 17640
 17641
 17642     MOVE EIBDATE          TO SM-JUL-DATE.
 17643     MOVE EIBTRMID         TO SM-TERMID.
 17644     MOVE THIS-PGM         TO SM-PGM.
 17645     MOVE EIBTIME          TO TIME-IN.
 17646     MOVE TIME-OUT         TO SM-TIME.
 17647     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17648
 17649
 17650* EXEC CICS LINK
 17651*         PROGRAM  ('EL003')
 17652*         COMMAREA (SECURITY-MESSAGE)
 17653*         LENGTH   (80)
 17654*    END-EXEC.
 17655     MOVE 'EL003' TO DFHEIV1
 17656     MOVE 80
 17657       TO DFHEIV11
 17658*    MOVE '."C                   (   #00014561' TO DFHEIV0
 17659     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17660     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17661     MOVE X'2020233030303134353631' TO DFHEIV0(25:11)
 17662     CALL 'kxdfhei1' USING DFHEIV0,
 17663           DFHEIV1,
 17664           SECURITY-MESSAGE,
 17665           DFHEIV11,
 17666           DFHEIV99,
 17667           DFHEIV99,
 17668           DFHEIV99,
 17669           DFHEIV99
 17670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17671
 17672
 17673******************************************************************
 17674
 17675
 17676
 17677 9999-DFHBACK SECTION.
 17678     MOVE '9%                    "   ' TO DFHEIV0
 17679     MOVE 'EL131' TO DFHEIV1
 17680     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17681     GOBACK.
 17682 9999-DFHEXIT.
 17683     IF DFHEIGDJ EQUAL 0001
 17684         NEXT SENTENCE
 17685     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 332
* EL131.cbl
 17686         GO TO 8820-XCTL-ERROR,
 17687               8150-ENTERED-CLAIM-NOTFOUND,
 17688               9990-ABEND
 17689         DEPENDING ON DFHEIGDI
 17690     ELSE IF DFHEIGDJ EQUAL 3
 17691         GO TO 0130-TS-ERROR,
 17692               0130-TS-ERROR
 17693         DEPENDING ON DFHEIGDI
 17694     ELSE IF DFHEIGDJ EQUAL 4
 17695         GO TO 0600-CONTINUE-NAME-UPDATE
 17696         DEPENDING ON DFHEIGDI
 17697     ELSE IF DFHEIGDJ EQUAL 5
 17698         GO TO 1004-BENE-NOT-FOUND
 17699         DEPENDING ON DFHEIGDI
 17700     ELSE IF DFHEIGDJ EQUAL 6
 17701         GO TO 1052-DONE,
 17702               1052-DONE
 17703         DEPENDING ON DFHEIGDI
 17704     ELSE IF DFHEIGDJ EQUAL 7
 17705         GO TO 1120-CNTL-NOTFND
 17706         DEPENDING ON DFHEIGDI
 17707     ELSE IF DFHEIGDJ EQUAL 8
 17708         GO TO 1150-NOTOPEN-ERROR,
 17709               1150-EXIT
 17710         DEPENDING ON DFHEIGDI
 17711     ELSE IF DFHEIGDJ EQUAL 9
 17712         GO TO 1490-STATE-NOTFND
 17713         DEPENDING ON DFHEIGDI
 17714     ELSE IF DFHEIGDJ EQUAL 10
 17715         GO TO 1500-CARR-NOTFND
 17716         DEPENDING ON DFHEIGDI
 17717     ELSE IF DFHEIGDJ EQUAL 11
 17718         GO TO 1620-ACCT-NOTFND
 17719         DEPENDING ON DFHEIGDI
 17720     ELSE IF DFHEIGDJ EQUAL 12
 17721         GO TO 2020-EXIT
 17722         DEPENDING ON DFHEIGDI
 17723     ELSE IF DFHEIGDJ EQUAL 13
 17724         GO TO 2030-EXIT
 17725         DEPENDING ON DFHEIGDI
 17726     ELSE IF DFHEIGDJ EQUAL 14
 17727         GO TO 2040-EXIT
 17728         DEPENDING ON DFHEIGDI
 17729     ELSE IF DFHEIGDJ EQUAL 15
 17730         GO TO 2050-EXIT
 17731         DEPENDING ON DFHEIGDI
 17732     ELSE IF DFHEIGDJ EQUAL 16
 17733         GO TO 2060-CERT-NOTFND
 17734         DEPENDING ON DFHEIGDI
 17735     ELSE IF DFHEIGDJ EQUAL 17
 17736         GO TO 2060-DUPKEY
 17737         DEPENDING ON DFHEIGDI
 17738     ELSE IF DFHEIGDJ EQUAL 18
 17739         GO TO 2070-NOT-FOUND
 17740         DEPENDING ON DFHEIGDI
 17741     ELSE IF DFHEIGDJ EQUAL 19
 17742         GO TO 2070-EXIT
 17743         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 333
* EL131.cbl
 17744     ELSE IF DFHEIGDJ EQUAL 20
 17745         GO TO 2080-EXIT
 17746         DEPENDING ON DFHEIGDI
 17747     ELSE IF DFHEIGDJ EQUAL 21
 17748         GO TO 2400-TRLR-NOTFND,
 17749               2410-EXIT
 17750         DEPENDING ON DFHEIGDI
 17751     ELSE IF DFHEIGDJ EQUAL 22
 17752         GO TO 2425-NINETY-NOTFND,
 17753               2425-NINETY-NOTFND
 17754         DEPENDING ON DFHEIGDI
 17755     ELSE IF DFHEIGDJ EQUAL 23
 17756         GO TO 2430-EXIT,
 17757               2440-EXIT
 17758         DEPENDING ON DFHEIGDI
 17759     ELSE IF DFHEIGDJ EQUAL 24
 17760         GO TO 2440-EXIT
 17761         DEPENDING ON DFHEIGDI
 17762     ELSE IF DFHEIGDJ EQUAL 25
 17763         GO TO 2460-EXIT
 17764         DEPENDING ON DFHEIGDI
 17765     ELSE IF DFHEIGDJ EQUAL 26
 17766         GO TO 2475-EXIT
 17767         DEPENDING ON DFHEIGDI
 17768     ELSE IF DFHEIGDJ EQUAL 27
 17769         GO TO 2650-EXIT
 17770         DEPENDING ON DFHEIGDI
 17771     ELSE IF DFHEIGDJ EQUAL 28
 17772         GO TO 2800-EXIT,
 17773               2800-EXIT
 17774         DEPENDING ON DFHEIGDI
 17775     ELSE IF DFHEIGDJ EQUAL 29
 17776         GO TO 3010-DEL-ACTQ,
 17777               3040-EXIT
 17778         DEPENDING ON DFHEIGDI
 17779     ELSE IF DFHEIGDJ EQUAL 30
 17780         GO TO 3010-NO-ACTIVITY,
 17781               3050-EXIT
 17782         DEPENDING ON DFHEIGDI
 17783     ELSE IF DFHEIGDJ EQUAL 31
 17784         GO TO 3010-CERT-NOT-FOUND
 17785         DEPENDING ON DFHEIGDI
 17786     ELSE IF DFHEIGDJ EQUAL 32
 17787         GO TO 3020-EXIT
 17788         DEPENDING ON DFHEIGDI
 17789     ELSE IF DFHEIGDJ EQUAL 33
 17790         GO TO 3060-EXIT,
 17791               3060-EXIT
 17792         DEPENDING ON DFHEIGDI
 17793     ELSE IF DFHEIGDJ EQUAL 34
 17794         GO TO 5000-TRLR-NOT-FOUND
 17795         DEPENDING ON DFHEIGDI
 17796     ELSE IF DFHEIGDJ EQUAL 35
 17797         GO TO 5000-CERT-NOT-FOUND
 17798         DEPENDING ON DFHEIGDI
 17799     ELSE IF DFHEIGDJ EQUAL 36
 17800         GO TO 1052-DONE,
 17801               1052-DONE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:35 Page 334
* EL131.cbl
 17802         DEPENDING ON DFHEIGDI
 17803     ELSE IF DFHEIGDJ EQUAL 37
 17804         GO TO 7630-END-BROWSE
 17805         DEPENDING ON DFHEIGDI
 17806     ELSE IF DFHEIGDJ EQUAL 38
 17807         GO TO 7799-EXIT,
 17808               7799-EXIT
 17809         DEPENDING ON DFHEIGDI
 17810     ELSE IF DFHEIGDJ EQUAL 39
 17811         GO TO 7799-EXIT
 17812         DEPENDING ON DFHEIGDI
 17813     ELSE IF DFHEIGDJ EQUAL 40
 17814         GO TO 7800-NOT-FOUND
 17815         DEPENDING ON DFHEIGDI
 17816     ELSE IF DFHEIGDJ EQUAL 41
 17817         GO TO 8000-NOTE-NOT-FOUND
 17818         DEPENDING ON DFHEIGDI
 17819     ELSE IF DFHEIGDJ EQUAL 42
 17820         GO TO 8990-SEND-TEXT
 17821         DEPENDING ON DFHEIGDI.
 17822     MOVE '9%                    "   ' TO DFHEIV0
 17823     MOVE 'EL131' TO DFHEIV1
 17824     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17825     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14188     Code:       62395
