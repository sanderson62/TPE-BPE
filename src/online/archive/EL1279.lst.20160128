* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL1279.cbl
* Options: int("EL1279.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1279.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1279.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1279.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL1279.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/06/95 08:37:08.
     7*                            VMOD=2.005.
     8*
     9*AUTHOR.           LOGIC,INC.
    10*                  DALLAS,TEXAS.
    11
    12*DATE-COMPILED.
    13*SECURITY.   *****************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL1279.cbl
    14*            *                                                   *
    15*            * THIS PROGRAM IS THE PROPERTY OF LOCIC, INC. *
    16*            *                                                   *
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    19*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    20*            *                                                   *
    21*            *****************************************************
    22*
    23*REMARKS.     TRANSACTION - EXXF - CERTIFICATE NOTE MAINTENANCE.
    24*
    25******************************************************************
    26*                   C H A N G E   L O G
    27*
    28* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    29*-----------------------------------------------------------------
    30*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    31* EFFECTIVE    NUMBER
    32*-----------------------------------------------------------------
    33* 100109   2008101400003   AJRA  NEW CERT NOTE SCREEN
    34******************************************************************
    35*
    36 ENVIRONMENT DIVISION.
    37
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL1279.cbl
    39 DATA DIVISION.
    40 WORKING-STORAGE SECTION.
    41 01  DFH-START PIC X(04).
    42 77  FILLER  PIC X(32)  VALUE '********************************'.
    43 77  FILLER  PIC X(32)  VALUE '*     EL1279 WORKING STORAGE   *'.
    44 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.005 ***********'.
    45
    46*    COPY ELCSCTM.
    47******************************************************************
    48*                                                                *
    49*                                                                *
    50*                            ELCSCTM                             *
    51*                            VMOD=2.001                          *
    52*                                                                *
    53*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    54*                                                                *
    55******************************************************************
    56 01  SECURITY-MESSAGE.
    57     12  FILLER                          PIC X(30)
    58            VALUE '** LOGIC SECURITY VIOLATION -'.
    59     12  SM-READ                         PIC X(6).
    60     12  FILLER                          PIC X(5)
    61            VALUE ' PGM='.
    62     12  SM-PGM                          PIC X(6).
    63     12  FILLER                          PIC X(5)
    64            VALUE ' OPR='.
    65     12  SM-PROCESSOR-ID                 PIC X(4).
    66     12  FILLER                          PIC X(6)
    67            VALUE ' TERM='.
    68     12  SM-TERMID                       PIC X(4).
    69     12  FILLER                          PIC XX   VALUE SPACE.
    70     12  SM-JUL-DATE                     PIC 9(5).
    71     12  FILLER                          PIC X    VALUE SPACE.
    72     12  SM-TIME                         PIC 99.99.
    73
    74*    COPY ELCSCRTY.
    75******************************************************************
    76*                                                                *
    77*                                                                *
    78*                            ELCSCRTY                            *
    79*                            VMOD=2.001                          *
    80*                                                                *
    81*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    82*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    83*        SAVED IN PI-SECURITY-ADDRESS.                           *
    84*                                                                *
    85******************************************************************
    86 01  SECURITY-CONTROL.
    87     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    88     12  FILLER                       PIC XX    VALUE 'SC'.
    89     12  SC-CREDIT-CODES.
    90         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    91             20  SC-CREDIT-DISPLAY    PIC X.
    92             20  SC-CREDIT-UPDATE     PIC X.
    93     12  SC-CLAIMS-CODES.
    94         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    95             20  SC-CLAIMS-DISPLAY    PIC X.
    96             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL1279.cbl
    97
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL1279.cbl
    99 01  STANDARD-AREAS.
   100     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   101     12  MAP-NAME                PIC X(8)    VALUE 'EL1279A'.
   102     12  MAPSET-NAME             PIC X(8)    VALUE 'EL1279S '.
   103     12  SCRN-NUMBER             PIC X(4)    VALUE '127I'.
   104     12  TRANS-ID                PIC X(4)    VALUE 'EXXF'.
   105     12  THIS-PGM                PIC X(8)    VALUE 'EL1279'.
   106     12  PGM-NAME                PIC X(8).
   107     12  PGM-EL1276              PIC X(8)    VALUE 'EL1276'.
   108
   109     12  ERCNOT-FILE-ID          PIC X(8)    VALUE 'ERCNOT'.
   110     12  ELCERT-FILE-ID          PIC X(8)    VALUE 'ELCERT'.
   111     12  QID.
   112         16  QID-TERM            PIC X(4).
   113         16  FILLER              PIC X(4)    VALUE '127I'.
   114     12  QID-ITEM                PIC S9(4)   COMP VALUE +0.
   115     12  SC-ITEM                 PIC S9(4)   COMP VALUE +1.
   116     12  WS-LINE                 PIC 9(3)    VALUE 0.
   117     12  WS-BLANK-LINES          PIC S9(4)   COMP VALUE +0.
   118
   119 01  WORK-AREA.
   120     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   121     12  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   122
   123     12  ERCNOT-LENGTH           PIC S9(4)   COMP VALUE +150.
   124     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   125     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   126     12  ERCNOT-KEY.
   127         16  ERCNOT-PARTIAL-KEY.
   128             20 ERCNOT-COMPANY-CD    PIC X.
   129             20 ERCNOT-CARRIER       PIC X.
   130             20 ERCNOT-GROUPING      PIC X(06).
   131             20 ERCNOT-STATE         PIC XX.
   132             20 ERCNOT-ACCOUNT       PIC X(10).
   133             20 ERCNOT-EFF-DT        PIC XX.
   134             20 ERCNOT-CERT-NO.
   135                25 ERCNOT-CERT-PRIME PIC X(10).
   136                25 ERCNOT-CERT-SFX   PIC X.
   137             20 ERCNOT-REC-TYP       PIC X.
   138         16 ERCNOT-SEQ           PIC S9(4) COMP.
   139     12  SV-PRIOR-KEY.
   140         20 SV-COMPANY-CD            PIC X.
   141         20 SV-CARRIER               PIC X.
   142         20 SV-GROUPING              PIC X(06).
   143         20 SV-STATE                 PIC XX.
   144         20 SV-ACCOUNT               PIC X(10).
   145         20 SV-EFF-DT                PIC XX.
   146         20 SV-CERT-NO.
   147            25 SV-CERT-PRIME         PIC X(10).
   148            25 SV-CERT-SFX           PIC X(1).
   149         20 SV-REC-TYP               PIC X.
   150     12  ELCERT-KEY.
   151         16  ELCERT-COMPANY-CD        PIC X.
   152         16  ELCERT-CARRIER           PIC X.
   153         16  ELCERT-GROUPING          PIC X(6).
   154         16  ELCERT-STATE             PIC XX.
   155         16  ELCERT-ACCOUNT           PIC X(10).
   156         16  ELCERT-EFF-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL1279.cbl
   157         16  ELCERT-CERT-NO.
   158             20  ELCERT-CERT-PRIME    PIC X(10).
   159             20  ELCERT-CERT-SFX      PIC X.
   160
   161     12  TIME-IN                 PIC S9(7).
   162     12  TIME-SPLIT REDEFINES TIME-IN.
   163         16  FILLER              PIC X.
   164         16  TIME-OUT            PIC 99V99.
   165         16  FILLER              PIC X(2).
   166     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   167     12  XCTL-126                PIC X(8)    VALUE 'EL126'.
   168     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   169     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   170     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   171     12  MAX-LINES               PIC 999     VALUE 300.
   172     12  NUM-LINES-PER-SCREEN    PIC 99      VALUE 10.
   173     12  TS-NUM-REC-IN-GROUP     PIC 99      VALUE 50.
   174     12  TS-GROUP-WORK           PIC 9(5)    VALUE 0  COMP-3.
   175     12  TS-LENGTH               PIC S9(4)   VALUE +3650 COMP.
   176     12  ROLL-COUNTER            PIC S999    VALUE +0 COMP-3.
   177     12  TEMP-CURR-LINE          PIC S9(3)   COMP-3.
   178     12  WS-SUB                  PIC S9(3)   COMP-3.
   179     12  WS-SUB1                 PIC S9(3)   COMP-3.
   180     12  WS-SCREEN-LINE          PIC X       VALUE 'N'.
   181         88 SCREEN-LINE-FOUND                VALUE 'Y'.
   182
   183     12  SCR-CLAIM-NOTE-TYPE.
   184         16  FILLER              PIC X(50)   VALUE
   185         '***********    C L A I M   C E R T   N O T E S    '.
   186         16  FILLER              PIC X(13)   VALUE
   187         '*************'.
   188     12  SCR-CERT-NOTE-TYPE.
   189         16  FILLER              PIC X(50)   VALUE
   190         '***********  C E R T I F I C A T E     N O T E S  '.
   191         16  FILLER              PIC X(13)   VALUE
   192         '*************'.
   193     12  SCR-PF6-CLAIM           PIC X(15)   VALUE
   194         'PF6=CLAIM NOTES'.
   195     12  SCR-PF6-CERT            PIC X(15)   VALUE
   196         'PF6=CERT NOTES'.
   197     12  SCR-CLAIM-YN            PIC X(12)   VALUE
   198         'CLAIM NOTES:'.
   199     12  SCR-CERT-YN             PIC X(12)   VALUE
   200         ' CERT NOTES:'.
   201
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL1279.cbl
   203 01  ERROR-MESSAGES.
   204     12  ER-0000             PIC X(04)       VALUE '0000'.
   205     12  ER-0004             PIC X(04)       VALUE '0004'.
   206     12  ER-0006             PIC X(04)       VALUE '0006'.
   207     12  ER-0008             PIC X(04)       VALUE '0008'.
   208     12  ER-0023             PIC X(04)       VALUE '0023'.
   209     12  ER-0029             PIC X(04)       VALUE '0029'.
   210     12  ER-0030             PIC X(04)       VALUE '0030'.
   211     12  ER-0031             PIC X(04)       VALUE '0031'.
   212     12  ER-0032             PIC X(04)       VALUE '0032'.
   213     12  ER-0033             PIC X(04)       VALUE '0033'.
   214     12  ER-0041             PIC X(04)       VALUE '0041'.
   215     12  ER-0044             PIC X(04)       VALUE '0044'.
   216     12  ER-0045             PIC X(04)       VALUE '0045'.
   217     12  ER-0047             PIC X(04)       VALUE '0047'.
   218     12  ER-0048             PIC X(04)       VALUE '0048'.
   219     12  ER-0049             PIC X(04)       VALUE '0049'.
   220     12  ER-0050             PIC X(04)       VALUE '0050'.
   221     12  ER-0051             PIC X(04)       VALUE '0051'.
   222     12  ER-0066             PIC X(04)       VALUE '0066'.
   223     12  ER-0067             PIC X(04)       VALUE '0067'.
   224     12  ER-0069             PIC X(04)       VALUE '0069'.
   225     12  ER-0070             PIC X(04)       VALUE '0070'.
   226     12  ER-0140             PIC X(04)       VALUE '0140'.
   227     12  ER-2954             PIC X(04)       VALUE '2954'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL1279.cbl
   229*                       COPY ELCLOGOF.
   230******************************************************************
   231*                                                                *
   232*                                                                *
   233*                            ELCLOGOF.                           *
   234*                            VMOD=2.001                          *
   235*                                                                *
   236*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   237*                                                                *
   238******************************************************************
   239 01  CLASIC-LOGOFF.
   240     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   241     12  LOGOFF-TEXT.
   242         16  FILLER          PIC X(5)    VALUE SPACES.
   243         16  LOGOFF-MSG.
   244             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   245             20  FILLER      PIC X       VALUE SPACES.
   246             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   247         16  FILLER          PIC X(80)
   248           VALUE '* YOU ARE NOW LOGGED OFF'.
   249         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   250         16  FILLER          PIC X       VALUE QUOTE.
   251         16  LOGOFF-SYS-MSG  PIC X(17)
   252           VALUE 'S CLAS-IC SYSTEM '.
   253     12  TEXT-MESSAGES.
   254         16  UNACCESS-MSG    PIC X(29)
   255             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   256         16  PGMIDERR-MSG    PIC X(17)
   257             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL1279.cbl
   259*                       COPY ELCAID.
   260******************************************************************
   261*                                                                *
   262*                            ELCAID.                             *
   263*                            VMOD=2.001                          *
   264*                                                                *
   265*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   266*                                                                *
   267*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   268*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   269******************************************************************
   270
   271 01  DFHAID.
   272   02  DFHNULL   PIC  X  VALUE  ' '.
   273   02  DFHENTER  PIC  X  VALUE  QUOTE.
   274   02  DFHCLEAR  PIC  X  VALUE  '_'.
   275   02  DFHPEN    PIC  X  VALUE  '='.
   276   02  DFHOPID   PIC  X  VALUE  'W'.
   277   02  DFHPA1    PIC  X  VALUE  '%'.
   278   02  DFHPA2    PIC  X  VALUE  '>'.
   279   02  DFHPA3    PIC  X  VALUE  ','.
   280   02  DFHPF1    PIC  X  VALUE  '1'.
   281   02  DFHPF2    PIC  X  VALUE  '2'.
   282   02  DFHPF3    PIC  X  VALUE  '3'.
   283   02  DFHPF4    PIC  X  VALUE  '4'.
   284   02  DFHPF5    PIC  X  VALUE  '5'.
   285   02  DFHPF6    PIC  X  VALUE  '6'.
   286   02  DFHPF7    PIC  X  VALUE  '7'.
   287   02  DFHPF8    PIC  X  VALUE  '8'.
   288   02  DFHPF9    PIC  X  VALUE  '9'.
   289   02  DFHPF10   PIC  X  VALUE  ':'.
   290   02  DFHPF11   PIC  X  VALUE  '#'.
   291   02  DFHPF12   PIC  X  VALUE  '@'.
   292   02  DFHPF13   PIC  X  VALUE  'A'.
   293   02  DFHPF14   PIC  X  VALUE  'B'.
   294   02  DFHPF15   PIC  X  VALUE  'C'.
   295   02  DFHPF16   PIC  X  VALUE  'D'.
   296   02  DFHPF17   PIC  X  VALUE  'E'.
   297   02  DFHPF18   PIC  X  VALUE  'F'.
   298   02  DFHPF19   PIC  X  VALUE  'G'.
   299   02  DFHPF20   PIC  X  VALUE  'H'.
   300   02  DFHPF21   PIC  X  VALUE  'I'.
   301*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   302   02  DFHPF22   PIC  X  VALUE  '['.
   303   02  DFHPF23   PIC  X  VALUE  '.'.
   304   02  DFHPF24   PIC  X  VALUE  '<'.
   305   02  DFHMSRE   PIC  X  VALUE  'X'.
   306   02  DFHSTRF   PIC  X  VALUE  'h'.
   307   02  DFHTRIG   PIC  X  VALUE  '"'.
   308 01  FILLER  REDEFINES DFHAID.
   309     12  FILLER                  PIC X(8).
   310     12  PF-VALUES OCCURS 24 TIMES       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL1279.cbl
   312*                       COPY ELCEMIB.
   313******************************************************************
   314*                                                                *
   315*                                                                *
   316*                            ELCEMIB.                            *
   317*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   318*                            VMOD=2.005                          *
   319*                                                                *
   320*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   321*                                                                *
   322******************************************************************
   323 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   324     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   325     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   326     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   327     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   328     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   329     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   330     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   331     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   332     12  EMI-SWITCH1             PIC X        VALUE '1'.
   333         88  EMI-NO-ERRORS                    VALUE '1'.
   334         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   335         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   336     12  EMI-SWITCH2             PIC X        VALUE '1'.
   337         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   338     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   339         88  EMI-AREA1-EMPTY                  VALUE '1'.
   340         88  EMI-AREA1-FULL                   VALUE '2'.
   341     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   342         88  EMI-AREA2-EMPTY                  VALUE '1'.
   343         88  EMI-AREA2-FULL                   VALUE '2'.
   344     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   345         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   346         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   347         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   348         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   349         88  EMI-BYPASS-FATALS                VALUE 'X'.
   350     12  EMI-ERROR-LINES.
   351         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   352         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   353         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   354         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   355             20  EMI-ERR-CODES OCCURS 10 TIMES.
   356                 24  EMI-ERR-NUM         PIC X(4).
   357                 24  EMI-FILLER          PIC X.
   358                 24  EMI-SEV             PIC X.
   359                 24  FILLER              PIC X.
   360             20  FILLER                  PIC X(02).
   361     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   362         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   363             20  EMI-ERROR-NUMBER    PIC X(4).
   364             20  EMI-FILL            PIC X.
   365             20  EMI-SEVERITY        PIC X.
   366             20  FILLER              PIC X.
   367             20  EMI-ERROR-TEXT.
   368                 24  EMI-TEXT-VARIABLE   PIC X(10).
   369                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL1279.cbl
   370     12  EMI-SEVERITY-SAVE           PIC X.
   371         88  EMI-NOTE                    VALUE 'N'.
   372         88  EMI-WARNING                 VALUE 'W'.
   373         88  EMI-FORCABLE                VALUE 'F'.
   374         88  EMI-FATAL                   VALUE 'X'.
   375     12  EMI-MESSAGE-FLAG            PIC X.
   376         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   377         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   378     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   379     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   380         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   381         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   382         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   383     12  FILLER                      PIC X(137)  VALUE SPACES.
   384     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   385     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   386     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   387     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL1279.cbl
   389*                       COPY ELCINTF.
   390******************************************************************
   391*                                                                *
   392*                                                                *
   393*                            ELCINTF.                            *
   394*                            VMOD=2.017                          *
   395*                                                                *
   396*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   397*                                                                *
   398*       LENGTH = 1024                                            *
   399*                                                                *
   400******************************************************************
   401 01  PROGRAM-INTERFACE-BLOCK.
   402     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   403     12  PI-CALLING-PROGRAM              PIC X(8).
   404     12  PI-SAVED-PROGRAM-1              PIC X(8).
   405     12  PI-SAVED-PROGRAM-2              PIC X(8).
   406     12  PI-SAVED-PROGRAM-3              PIC X(8).
   407     12  PI-SAVED-PROGRAM-4              PIC X(8).
   408     12  PI-SAVED-PROGRAM-5              PIC X(8).
   409     12  PI-SAVED-PROGRAM-6              PIC X(8).
   410     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   411     12  PI-COMPANY-ID                   PIC XXX.
   412     12  PI-COMPANY-CD                   PIC X.
   413
   414     12  PI-COMPANY-PASSWORD             PIC X(8).
   415
   416     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   417
   418     12  PI-CONTROL-IN-PROGRESS.
   419         16  PI-CARRIER                  PIC X.
   420         16  PI-GROUPING                 PIC X(6).
   421         16  PI-STATE                    PIC XX.
   422         16  PI-ACCOUNT                  PIC X(10).
   423         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   424                                         PIC X(10).
   425         16  PI-CLAIM-CERT-GRP.
   426             20  PI-CLAIM-NO             PIC X(7).
   427             20  PI-CERT-NO.
   428                 25  PI-CERT-PRIME       PIC X(10).
   429                 25  PI-CERT-SFX         PIC X.
   430             20  PI-CERT-EFF-DT          PIC XX.
   431         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   432             20  PI-PLAN-CODE            PIC X(2).
   433             20  PI-REVISION-NUMBER      PIC X(3).
   434             20  PI-PLAN-EFF-DT          PIC X(2).
   435             20  PI-PLAN-EXP-DT          PIC X(2).
   436             20  FILLER                  PIC X(11).
   437         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   438             20  PI-OE-REFERENCE-1.
   439                 25  PI-OE-REF-1-PRIME   PIC X(18).
   440                 25  PI-OE-REF-1-SUFF    PIC XX.
   441
   442     12  PI-SESSION-IN-PROGRESS          PIC X.
   443         88  CLAIM-SESSION                   VALUE '1'.
   444         88  CREDIT-SESSION                  VALUE '2'.
   445         88  WARRANTY-SESSION                VALUE '3'.
   446         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL1279.cbl
   447         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   448
   449
   450*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   451
   452     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   453     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   454
   455     12  PI-CREDIT-USER                  PIC X.
   456         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   457         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   458
   459     12  PI-CLAIM-USER                   PIC X.
   460         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   461         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   462
   463     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   464         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   465         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   466         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   467         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   468         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   469
   470     12  PI-PROCESSOR-ID                 PIC X(4).
   471
   472     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   473
   474     12  PI-MEMBER-CAPTION               PIC X(10).
   475
   476     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   477         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   478
   479     12  PI-LIFE-OVERRIDE-L1             PIC X.
   480     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   481     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   482     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   483
   484     12  PI-AH-OVERRIDE-L1               PIC X.
   485     12  PI-AH-OVERRIDE-L2               PIC XX.
   486     12  PI-AH-OVERRIDE-L6               PIC X(6).
   487     12  PI-AH-OVERRIDE-L12              PIC X(12).
   488
   489     12  PI-NEW-SYSTEM                   PIC X(2).
   490
   491     12  PI-PRIMARY-CERT-NO              PIC X(11).
   492     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   493         88  PI-USES-PAID-TO                 VALUE '1'.
   494     12  PI-CRDTCRD-SYSTEM.
   495         16  PI-CRDTCRD-USER             PIC X.
   496             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   497             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   498         16  PI-CC-MONTH-END-DT          PIC XX.
   499     12  PI-PROCESSOR-PRINTER            PIC X(4).
   500
   501     12  PI-OE-REFERENCE-2.
   502         16  PI-OE-REF-2-PRIME           PIC X(10).
   503         16  PI-OE-REF-2-SUFF            PIC X.
   504
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL1279.cbl
   505     12  PI-REM-TRM-CALC-OPTION          PIC X.
   506
   507     12  PI-LANGUAGE-TYPE                PIC X.
   508             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   509             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   510             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   511
   512     12  PI-POLICY-LINKAGE-IND           PIC X.
   513         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   514         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   515                                                   LOW-VALUES.
   516
   517     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   518     12  PI-CLAIM-PW-SESSION             PIC X(1).
   519         88  PI-CLAIM-CREDIT                 VALUE '1'.
   520         88  PI-CLAIM-CONVEN                 VALUE '2'.
   521     12  FILLER                          PIC X(4).
   522
   523     12  PI-SYSTEM-LEVEL                 PIC X(145).
   524
   525     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   526         PI-SYSTEM-LEVEL.
   527
   528         16  PI-ENTRY-CODES.
   529             20  PI-ENTRY-CD-1           PIC X.
   530             20  PI-ENTRY-CD-2           PIC X.
   531
   532         16  PI-RETURN-CODES.
   533             20  PI-RETURN-CD-1          PIC X.
   534             20  PI-RETURN-CD-2          PIC X.
   535
   536         16  PI-UPDATE-STATUS-SAVE.
   537             20  PI-UPDATE-BY            PIC X(4).
   538             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   539
   540         16  PI-LOWER-CASE-LETTERS       PIC X.
   541             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   542
   543*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   544*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   545*            88  CARRIER-CLM-CNTL            VALUE '2'.
   546
   547         16  PI-CERT-ACCESS-CONTROL      PIC X.
   548             88  ST-ACCNT-CNTL               VALUE ' '.
   549             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   550             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   551             88  ACCNT-CNTL                  VALUE '3'.
   552             88  CARR-ACCNT-CNTL             VALUE '4'.
   553
   554         16  PI-PROCESSOR-CAP-LIST.
   555             20  PI-SYSTEM-CONTROLS.
   556                24 PI-SYSTEM-DISPLAY     PIC X.
   557                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   558                24 PI-SYSTEM-MODIFY      PIC X.
   559                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   560             20  FILLER                  PIC XX.
   561             20  PI-DISPLAY-CAP          PIC X.
   562                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL1279.cbl
   563             20  PI-MODIFY-CAP           PIC X.
   564                 88  MODIFY-CAP              VALUE 'Y'.
   565             20  PI-MSG-AT-LOGON-CAP     PIC X.
   566                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   567             20  PI-FORCE-CAP            PIC X.
   568                 88  FORCE-CAP               VALUE 'Y'.
   569
   570         16  PI-PROGRAM-CONTROLS.
   571             20  PI-PGM-PRINT-OPT        PIC X.
   572             20  PI-PGM-FORMAT-OPT       PIC X.
   573             20  PI-PGM-PROCESS-OPT      PIC X.
   574             20  PI-PGM-TOTALS-OPT       PIC X.
   575
   576         16  PI-HELP-INTERFACE.
   577             20  PI-LAST-ERROR-NO        PIC X(4).
   578             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   579
   580         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   581             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   582
   583         16  PI-CR-CONTROL-IN-PROGRESS.
   584             20  PI-CR-CARRIER           PIC X.
   585             20  PI-CR-GROUPING          PIC X(6).
   586             20  PI-CR-STATE             PIC XX.
   587             20  PI-CR-ACCOUNT           PIC X(10).
   588             20  PI-CR-FIN-RESP          PIC X(10).
   589             20  PI-CR-TYPE              PIC X.
   590
   591         16  PI-CR-BATCH-NUMBER          PIC X(6).
   592
   593         16  PI-CR-MONTH-END-DT          PIC XX.
   594
   595         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   596             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   597             88  PI-ZERO-CARRIER             VALUE '1'.
   598             88  PI-ZERO-GROUPING            VALUE '2'.
   599             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   600
   601         16  PI-CARRIER-SECURITY         PIC X.
   602             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   603
   604         16  PI-ACCOUNT-SECURITY         PIC X(10).
   605             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   606             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   607
   608         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   609             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   610                                         INDEXED BY PI-ACCESS-NDX
   611                                         PIC X.
   612
   613         16  PI-GA-BILLING-CONTROL       PIC X.
   614             88  PI-GA-BILLING               VALUE '1'.
   615
   616         16  PI-MAIL-PROCESSING          PIC X.
   617             88  PI-MAIL-YES                 VALUE 'Y'.
   618
   619         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   620
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL1279.cbl
   621         16  PI-AR-SYSTEM.
   622             20  PI-AR-PROCESSING-CNTL   PIC X.
   623                 88  PI-AR-PROCESSING        VALUE 'Y'.
   624             20  PI-AR-SUMMARY-CODE      PIC X(6).
   625             20  PI-AR-MONTH-END-DT      PIC XX.
   626
   627         16  PI-MP-SYSTEM.
   628             20  PI-MORTGAGE-USER            PIC X.
   629                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   630                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   631             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   632                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   633                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   634                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   635                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   636                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   637             20  PI-MP-MONTH-END-DT          PIC XX.
   638             20  PI-MP-REFERENCE-NO.
   639                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   640                 24  PI-MP-REFERENCE-SFX     PIC XX.
   641
   642         16  PI-LABEL-CONTROL            PIC X(01).
   643             88  PI-CREATE-LABELS                    VALUE 'Y'.
   644             88  PI-BYPASS-LABELS                    VALUE 'N'.
   645
   646         16  PI-BILL-GROUPING-CODE       PIC X(01).
   647             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   648
   649         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   650             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   651             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   652
   653         16  FILLER                      PIC X(14).
   654
   655     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   656******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL1279.cbl
   658     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   659         16  FILLER              PIC X(318).
   660         16  PI-TOTAL-LINES      PIC S9(3).
   661         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
   662         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
   663         16  PI-UPDATE-SW        PIC X.
   664             88  PI-CHANGES-MADE             VALUE '1'.
   665         16  PI-PF5-PRESSED      PIC X.
   666             88 PF5-PRESSED                  VALUE 'Y'.
   667         16  PI-PF6-PRESSED      PIC X.
   668             88 PF6-PRESSED                  VALUE 'Y'.
   669         16  PI-CURR-NOTE-REC-TYPE PIC X.
   670             88 PI-CERT-NOTE                 VALUE '1'.
   671             88 PI-CLAIM-NOTE                VALUE '2'.
   672         16  PI-BILLING-NOTES-EXIST PIC X.
   673         16  PI-CERT-NOTES-EXIST    PIC X.
   674         16  PI-CLAIM-NOTES-EXIST   PIC X.
   675         16  PI-SET-NOTE-CHANGE  PIC X.
   676             88 PI-CHANGE-IN-NOTE-TYPE       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL1279.cbl
   678*                          COPY ELCATTR.
   679******************************************************************
   680*                                                                *
   681*                            ELCATTR.                            *
   682*                            VMOD=2.001                          *
   683*                                                                *
   684*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   685*                                                                *
   686*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   687*                                                                *
   688*                   POS 1   P=PROTECTED                          *
   689*                           U=UNPROTECTED                        *
   690*                           S=ASKIP                              *
   691*                   POS 2   A=ALPHA/NUMERIC                      *
   692*                           N=NUMERIC                            *
   693*                   POS 3   N=NORMAL                             *
   694*                           B=BRIGHT                             *
   695*                           D=DARK                               *
   696*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   697*                           OF=MODIFIED DATA TAG OFF             *
   698*                                                                *
   699*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   700******************************************************************
   701 01  ATTRIBUTE-LIST.
   702     12  AL-PABOF            PIC X       VALUE 'Y'.
   703     12  AL-PABON            PIC X       VALUE 'Z'.
   704     12  AL-PADOF            PIC X       VALUE '%'.
   705     12  AL-PADON            PIC X       VALUE '_'.
   706     12  AL-PANOF            PIC X       VALUE '-'.
   707     12  AL-PANON            PIC X       VALUE '/'.
   708     12  AL-SABOF            PIC X       VALUE '8'.
   709     12  AL-SABON            PIC X       VALUE '9'.
   710     12  AL-SADOF            PIC X       VALUE '@'.
   711     12  AL-SADON            PIC X       VALUE QUOTE.
   712     12  AL-SANOF            PIC X       VALUE '0'.
   713     12  AL-SANON            PIC X       VALUE '1'.
   714     12  AL-UABOF            PIC X       VALUE 'H'.
   715     12  AL-UABON            PIC X       VALUE 'I'.
   716     12  AL-UADOF            PIC X       VALUE '<'.
   717     12  AL-UADON            PIC X       VALUE '('.
   718     12  AL-UANOF            PIC X       VALUE ' '.
   719     12  AL-UANON            PIC X       VALUE 'A'.
   720     12  AL-UNBOF            PIC X       VALUE 'Q'.
   721     12  AL-UNBON            PIC X       VALUE 'R'.
   722     12  AL-UNDOF            PIC X       VALUE '*'.
   723     12  AL-UNDON            PIC X       VALUE ')'.
   724     12  AL-UNNOF            PIC X       VALUE '&'.
   725     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL1279.cbl
   727*                          COPY ELCDATE.
   728******************************************************************
   729*                                                                *
   730*                                                                *
   731*                            ELCDATE.                            *
   732*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   733*                            VMOD=2.003
   734*                                                                *
   735*                                                                *
   736*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   737*                 LENGTH = 200                                   *
   738******************************************************************
   739
   740 01  DATE-CONVERSION-DATA.
   741     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   742     12  DC-OPTION-CODE                PIC X.
   743         88  BIN-TO-GREG                VALUE ' '.
   744         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   745         88  EDIT-GREG-TO-BIN           VALUE '2'.
   746         88  YMD-GREG-TO-BIN            VALUE '3'.
   747         88  MDY-GREG-TO-BIN            VALUE '4'.
   748         88  JULIAN-TO-BIN              VALUE '5'.
   749         88  BIN-PLUS-ELAPSED           VALUE '6'.
   750         88  FIND-CENTURY               VALUE '7'.
   751         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   752         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   753         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   754         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   755         88  JULIAN-TO-BIN-3            VALUE 'C'.
   756         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   757         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   758         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   759         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   760         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   761         88  CHECK-LEAP-YEAR            VALUE 'H'.
   762         88  BIN-3-TO-GREG              VALUE 'I'.
   763         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   764         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   765         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   766         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   767         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   768         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   769         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   770         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   771         88  THREE-CHARACTER-BIN
   772                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   773         88  GREGORIAN-TO-BIN
   774                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   775         88  BIN-TO-GREGORIAN
   776                  VALUES ' ' '1' 'I' '8' 'G'.
   777         88  JULIAN-TO-BINARY
   778                  VALUES '5' 'C' 'E' 'F'.
   779     12  DC-ERROR-CODE                 PIC X.
   780         88  NO-CONVERSION-ERROR        VALUE ' '.
   781         88  DATE-CONVERSION-ERROR
   782                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   783         88  DATE-IS-ZERO               VALUE '1'.
   784         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL1279.cbl
   785         88  DATE-IS-INVALID            VALUE '3'.
   786         88  DATE1-GREATER-DATE2        VALUE '4'.
   787         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   788         88  DATE-INVALID-OPTION        VALUE '9'.
   789         88  INVALID-CENTURY            VALUE 'A'.
   790         88  ONLY-CENTURY               VALUE 'B'.
   791         88  ONLY-LEAP-YEAR             VALUE 'C'.
   792         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   793     12  DC-END-OF-MONTH               PIC X.
   794         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   795     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   796         88  USE-NORMAL-PROCESS         VALUE ' '.
   797         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   798         88  ADJUST-UP-100-YRS          VALUE '2'.
   799     12  FILLER                        PIC X.
   800     12  DC-CONVERSION-DATES.
   801         16  DC-BIN-DATE-1             PIC XX.
   802         16  DC-BIN-DATE-2             PIC XX.
   803         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   804         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   805                       DC-GREG-DATE-1-EDIT.
   806             20  DC-EDIT1-MONTH        PIC 99.
   807             20  SLASH1-1              PIC X.
   808             20  DC-EDIT1-DAY          PIC 99.
   809             20  SLASH1-2              PIC X.
   810             20  DC-EDIT1-YEAR         PIC 99.
   811         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   812         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   813                     DC-GREG-DATE-2-EDIT.
   814             20  DC-EDIT2-MONTH        PIC 99.
   815             20  SLASH2-1              PIC X.
   816             20  DC-EDIT2-DAY          PIC 99.
   817             20  SLASH2-2              PIC X.
   818             20  DC-EDIT2-YEAR         PIC 99.
   819         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   820         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   821                     DC-GREG-DATE-1-YMD.
   822             20  DC-YMD-YEAR           PIC 99.
   823             20  DC-YMD-MONTH          PIC 99.
   824             20  DC-YMD-DAY            PIC 99.
   825         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   826         16  DC-GREG-DATE-1-MDY-R REDEFINES
   827                      DC-GREG-DATE-1-MDY.
   828             20  DC-MDY-MONTH          PIC 99.
   829             20  DC-MDY-DAY            PIC 99.
   830             20  DC-MDY-YEAR           PIC 99.
   831         16  DC-GREG-DATE-1-ALPHA.
   832             20  DC-ALPHA-MONTH        PIC X(10).
   833             20  DC-ALPHA-DAY          PIC 99.
   834             20  FILLER                PIC XX.
   835             20  DC-ALPHA-CENTURY.
   836                 24 DC-ALPHA-CEN-N     PIC 99.
   837             20  DC-ALPHA-YEAR         PIC 99.
   838         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   839         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   840         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   841         16  DC-JULIAN-DATE            PIC 9(05).
   842         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL1279.cbl
   843                                       PIC 9(05).
   844         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   845             20  DC-JULIAN-YEAR        PIC 99.
   846             20  DC-JULIAN-DAYS        PIC 999.
   847         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   848         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   849         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   850     12  DATE-CONVERSION-VARIBLES.
   851         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   852         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   853             20  FILLER                PIC 9(3).
   854             20  HOLD-CEN-1-CCYY.
   855                 24  HOLD-CEN-1-CC     PIC 99.
   856                 24  HOLD-CEN-1-YY     PIC 99.
   857             20  HOLD-CEN-1-MO         PIC 99.
   858             20  HOLD-CEN-1-DA         PIC 99.
   859         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   860             20  HOLD-CEN-1-R-MO       PIC 99.
   861             20  HOLD-CEN-1-R-DA       PIC 99.
   862             20  HOLD-CEN-1-R-CCYY.
   863                 24  HOLD-CEN-1-R-CC   PIC 99.
   864                 24  HOLD-CEN-1-R-YY   PIC 99.
   865             20  FILLER                PIC 9(3).
   866         16  HOLD-CENTURY-1-X.
   867             20  FILLER                PIC X(3)  VALUE SPACES.
   868             20  HOLD-CEN-1-X-CCYY.
   869                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   870                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   871             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   872             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   873         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   874             20  HOLD-CEN-1-R-X-MO     PIC XX.
   875             20  HOLD-CEN-1-R-X-DA     PIC XX.
   876             20  HOLD-CEN-1-R-X-CCYY.
   877                 24  HOLD-CEN-1-R-X-CC PIC XX.
   878                 24  HOLD-CEN-1-R-X-YY PIC XX.
   879             20  FILLER                PIC XXX.
   880         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   881         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   882         16  DC-JULIAN-DATE-1          PIC 9(07).
   883         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   884             20  DC-JULIAN-1-CCYY.
   885                 24  DC-JULIAN-1-CC    PIC 99.
   886                 24  DC-JULIAN-1-YR    PIC 99.
   887             20  DC-JULIAN-DA-1        PIC 999.
   888         16  DC-JULIAN-DATE-2          PIC 9(07).
   889         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   890             20  DC-JULIAN-2-CCYY.
   891                 24  DC-JULIAN-2-CC    PIC 99.
   892                 24  DC-JULIAN-2-YR    PIC 99.
   893             20  DC-JULIAN-DA-2        PIC 999.
   894         16  DC-GREG-DATE-A-EDIT.
   895             20  DC-EDITA-MONTH        PIC 99.
   896             20  SLASHA-1              PIC X VALUE '/'.
   897             20  DC-EDITA-DAY          PIC 99.
   898             20  SLASHA-2              PIC X VALUE '/'.
   899             20  DC-EDITA-CCYY.
   900                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL1279.cbl
   901                 24  DC-EDITA-YEAR     PIC 99.
   902         16  DC-GREG-DATE-B-EDIT.
   903             20  DC-EDITB-MONTH        PIC 99.
   904             20  SLASHB-1              PIC X VALUE '/'.
   905             20  DC-EDITB-DAY          PIC 99.
   906             20  SLASHB-2              PIC X VALUE '/'.
   907             20  DC-EDITB-CCYY.
   908                 24  DC-EDITB-CENT     PIC 99.
   909                 24  DC-EDITB-YEAR     PIC 99.
   910         16  DC-GREG-DATE-CYMD         PIC 9(08).
   911         16  DC-GREG-DATE-CYMD-R REDEFINES
   912                              DC-GREG-DATE-CYMD.
   913             20  DC-CYMD-CEN           PIC 99.
   914             20  DC-CYMD-YEAR          PIC 99.
   915             20  DC-CYMD-MONTH         PIC 99.
   916             20  DC-CYMD-DAY           PIC 99.
   917         16  DC-GREG-DATE-MDCY         PIC 9(08).
   918         16  DC-GREG-DATE-MDCY-R REDEFINES
   919                              DC-GREG-DATE-MDCY.
   920             20  DC-MDCY-MONTH         PIC 99.
   921             20  DC-MDCY-DAY           PIC 99.
   922             20  DC-MDCY-CEN           PIC 99.
   923             20  DC-MDCY-YEAR          PIC 99.
   924    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   925        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   926    12  DC-EL310-DATE                  PIC X(21).
   927    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL1279.cbl
   929*                          COPY EL1279S.
   930 01  EL1279AI.
   931     05  FILLER            PIC  X(0012).
   932*    -------------------------------
   933     05  DATEL PIC S9(0004) COMP.
   934     05  DATEF PIC  X(0001).
   935     05  FILLER REDEFINES DATEF.
   936         10  DATEA PIC  X(0001).
   937     05  DATEI PIC  X(0008).
   938*    -------------------------------
   939     05  TIMEL PIC S9(0004) COMP.
   940     05  TIMEF PIC  X(0001).
   941     05  FILLER REDEFINES TIMEF.
   942         10  TIMEA PIC  X(0001).
   943     05  TIMEI PIC  X(0005).
   944*    -------------------------------
   945     05  CMPNYIDL PIC S9(0004) COMP.
   946     05  CMPNYIDF PIC  X(0001).
   947     05  FILLER REDEFINES CMPNYIDF.
   948         10  CMPNYIDA PIC  X(0001).
   949     05  CMPNYIDI PIC  X(0003).
   950*    -------------------------------
   951     05  USERIDL PIC S9(0004) COMP.
   952     05  USERIDF PIC  X(0001).
   953     05  FILLER REDEFINES USERIDF.
   954         10  USERIDA PIC  X(0001).
   955     05  USERIDI PIC  X(0004).
   956*    -------------------------------
   957     05  FCERTL PIC S9(0004) COMP.
   958     05  FCERTF PIC  X(0001).
   959     05  FILLER REDEFINES FCERTF.
   960         10  FCERTA PIC  X(0001).
   961     05  FCERTI PIC  X(0010).
   962*    -------------------------------
   963     05  FCRTSFXL PIC S9(0004) COMP.
   964     05  FCRTSFXF PIC  X(0001).
   965     05  FILLER REDEFINES FCRTSFXF.
   966         10  FCRTSFXA PIC  X(0001).
   967     05  FCRTSFXI PIC  X(0001).
   968*    -------------------------------
   969     05  FACOUNTL PIC S9(0004) COMP.
   970     05  FACOUNTF PIC  X(0001).
   971     05  FILLER REDEFINES FACOUNTF.
   972         10  FACOUNTA PIC  X(0001).
   973     05  FACOUNTI PIC  X(0010).
   974*    -------------------------------
   975     05  FSTL PIC S9(0004) COMP.
   976     05  FSTF PIC  X(0001).
   977     05  FILLER REDEFINES FSTF.
   978         10  FSTA PIC  X(0001).
   979     05  FSTI PIC  X(0002).
   980*    -------------------------------
   981     05  FCARRIRL PIC S9(0004) COMP.
   982     05  FCARRIRF PIC  X(0001).
   983     05  FILLER REDEFINES FCARRIRF.
   984         10  FCARRIRA PIC  X(0001).
   985     05  FCARRIRI PIC  X(0001).
   986*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL1279.cbl
   987     05  FGROUPL PIC S9(0004) COMP.
   988     05  FGROUPF PIC  X(0001).
   989     05  FILLER REDEFINES FGROUPF.
   990         10  FGROUPA PIC  X(0001).
   991     05  FGROUPI PIC  X(0006).
   992*    -------------------------------
   993     05  FEFFDTL PIC S9(0004) COMP.
   994     05  FEFFDTF PIC  X(0001).
   995     05  FILLER REDEFINES FEFFDTF.
   996         10  FEFFDTA PIC  X(0001).
   997     05  FEFFDTI PIC  X(0008).
   998*    -------------------------------
   999     05  TOTL PIC S9(0004) COMP.
  1000     05  TOTF PIC  X(0001).
  1001     05  FILLER REDEFINES TOTF.
  1002         10  TOTA PIC  X(0001).
  1003     05  TOTI PIC  X(0003).
  1004*    -------------------------------
  1005     05  FBILLYNL PIC S9(0004) COMP.
  1006     05  FBILLYNF PIC  X(0001).
  1007     05  FILLER REDEFINES FBILLYNF.
  1008         10  FBILLYNA PIC  X(0001).
  1009     05  FBILLYNI PIC  X(0003).
  1010*    -------------------------------
  1011     05  FTYPEYNL PIC S9(0004) COMP.
  1012     05  FTYPEYNF PIC  X(0001).
  1013     05  FILLER REDEFINES FTYPEYNF.
  1014         10  FTYPEYNA PIC  X(0001).
  1015     05  FTYPEYNI PIC  X(0012).
  1016*    -------------------------------
  1017     05  FCERTYNL PIC S9(0004) COMP.
  1018     05  FCERTYNF PIC  X(0001).
  1019     05  FILLER REDEFINES FCERTYNF.
  1020         10  FCERTYNA PIC  X(0001).
  1021     05  FCERTYNI PIC  X(0003).
  1022*    -------------------------------
  1023     05  FTYPEL PIC S9(0004) COMP.
  1024     05  FTYPEF PIC  X(0001).
  1025     05  FILLER REDEFINES FTYPEF.
  1026         10  FTYPEA PIC  X(0001).
  1027     05  FTYPEI PIC  X(0063).
  1028*    -------------------------------
  1029     05  LN1L PIC S9(0004) COMP.
  1030     05  LN1F PIC  X(0001).
  1031     05  FILLER REDEFINES LN1F.
  1032         10  LN1A PIC  X(0001).
  1033     05  LN1I PIC  X(0003).
  1034*    -------------------------------
  1035     05  FNLINE1L PIC S9(0004) COMP.
  1036     05  FNLINE1F PIC  X(0001).
  1037     05  FILLER REDEFINES FNLINE1F.
  1038         10  FNLINE1A PIC  X(0001).
  1039     05  FNLINE1I PIC  X(0063).
  1040*    -------------------------------
  1041     05  MTBY1L PIC S9(0004) COMP.
  1042     05  MTBY1F PIC  X(0001).
  1043     05  FILLER REDEFINES MTBY1F.
  1044         10  MTBY1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL1279.cbl
  1045     05  MTBY1I PIC  X(0004).
  1046*    -------------------------------
  1047     05  MTDT1L PIC S9(0004) COMP.
  1048     05  MTDT1F PIC  X(0001).
  1049     05  FILLER REDEFINES MTDT1F.
  1050         10  MTDT1A PIC  X(0001).
  1051     05  MTDT1I PIC  X(0006).
  1052*    -------------------------------
  1053     05  LN2L PIC S9(0004) COMP.
  1054     05  LN2F PIC  X(0001).
  1055     05  FILLER REDEFINES LN2F.
  1056         10  LN2A PIC  X(0001).
  1057     05  LN2I PIC  X(0003).
  1058*    -------------------------------
  1059     05  FNLINE2L PIC S9(0004) COMP.
  1060     05  FNLINE2F PIC  X(0001).
  1061     05  FILLER REDEFINES FNLINE2F.
  1062         10  FNLINE2A PIC  X(0001).
  1063     05  FNLINE2I PIC  X(0063).
  1064*    -------------------------------
  1065     05  MTBY2L PIC S9(0004) COMP.
  1066     05  MTBY2F PIC  X(0001).
  1067     05  FILLER REDEFINES MTBY2F.
  1068         10  MTBY2A PIC  X(0001).
  1069     05  MTBY2I PIC  X(0004).
  1070*    -------------------------------
  1071     05  MTDT2L PIC S9(0004) COMP.
  1072     05  MTDT2F PIC  X(0001).
  1073     05  FILLER REDEFINES MTDT2F.
  1074         10  MTDT2A PIC  X(0001).
  1075     05  MTDT2I PIC  X(0006).
  1076*    -------------------------------
  1077     05  LN3L PIC S9(0004) COMP.
  1078     05  LN3F PIC  X(0001).
  1079     05  FILLER REDEFINES LN3F.
  1080         10  LN3A PIC  X(0001).
  1081     05  LN3I PIC  X(0003).
  1082*    -------------------------------
  1083     05  FNLINE3L PIC S9(0004) COMP.
  1084     05  FNLINE3F PIC  X(0001).
  1085     05  FILLER REDEFINES FNLINE3F.
  1086         10  FNLINE3A PIC  X(0001).
  1087     05  FNLINE3I PIC  X(0063).
  1088*    -------------------------------
  1089     05  MTBY3L PIC S9(0004) COMP.
  1090     05  MTBY3F PIC  X(0001).
  1091     05  FILLER REDEFINES MTBY3F.
  1092         10  MTBY3A PIC  X(0001).
  1093     05  MTBY3I PIC  X(0004).
  1094*    -------------------------------
  1095     05  MTDT3L PIC S9(0004) COMP.
  1096     05  MTDT3F PIC  X(0001).
  1097     05  FILLER REDEFINES MTDT3F.
  1098         10  MTDT3A PIC  X(0001).
  1099     05  MTDT3I PIC  X(0006).
  1100*    -------------------------------
  1101     05  LN4L PIC S9(0004) COMP.
  1102     05  LN4F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL1279.cbl
  1103     05  FILLER REDEFINES LN4F.
  1104         10  LN4A PIC  X(0001).
  1105     05  LN4I PIC  X(0003).
  1106*    -------------------------------
  1107     05  FNLINE4L PIC S9(0004) COMP.
  1108     05  FNLINE4F PIC  X(0001).
  1109     05  FILLER REDEFINES FNLINE4F.
  1110         10  FNLINE4A PIC  X(0001).
  1111     05  FNLINE4I PIC  X(0063).
  1112*    -------------------------------
  1113     05  MTBY4L PIC S9(0004) COMP.
  1114     05  MTBY4F PIC  X(0001).
  1115     05  FILLER REDEFINES MTBY4F.
  1116         10  MTBY4A PIC  X(0001).
  1117     05  MTBY4I PIC  X(0004).
  1118*    -------------------------------
  1119     05  MTDT4L PIC S9(0004) COMP.
  1120     05  MTDT4F PIC  X(0001).
  1121     05  FILLER REDEFINES MTDT4F.
  1122         10  MTDT4A PIC  X(0001).
  1123     05  MTDT4I PIC  X(0006).
  1124*    -------------------------------
  1125     05  LN5L PIC S9(0004) COMP.
  1126     05  LN5F PIC  X(0001).
  1127     05  FILLER REDEFINES LN5F.
  1128         10  LN5A PIC  X(0001).
  1129     05  LN5I PIC  X(0003).
  1130*    -------------------------------
  1131     05  FNLINE5L PIC S9(0004) COMP.
  1132     05  FNLINE5F PIC  X(0001).
  1133     05  FILLER REDEFINES FNLINE5F.
  1134         10  FNLINE5A PIC  X(0001).
  1135     05  FNLINE5I PIC  X(0063).
  1136*    -------------------------------
  1137     05  MTBY5L PIC S9(0004) COMP.
  1138     05  MTBY5F PIC  X(0001).
  1139     05  FILLER REDEFINES MTBY5F.
  1140         10  MTBY5A PIC  X(0001).
  1141     05  MTBY5I PIC  X(0004).
  1142*    -------------------------------
  1143     05  MTDT5L PIC S9(0004) COMP.
  1144     05  MTDT5F PIC  X(0001).
  1145     05  FILLER REDEFINES MTDT5F.
  1146         10  MTDT5A PIC  X(0001).
  1147     05  MTDT5I PIC  X(0006).
  1148*    -------------------------------
  1149     05  LN6L PIC S9(0004) COMP.
  1150     05  LN6F PIC  X(0001).
  1151     05  FILLER REDEFINES LN6F.
  1152         10  LN6A PIC  X(0001).
  1153     05  LN6I PIC  X(0003).
  1154*    -------------------------------
  1155     05  FNLINE6L PIC S9(0004) COMP.
  1156     05  FNLINE6F PIC  X(0001).
  1157     05  FILLER REDEFINES FNLINE6F.
  1158         10  FNLINE6A PIC  X(0001).
  1159     05  FNLINE6I PIC  X(0063).
  1160*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL1279.cbl
  1161     05  MTBY6L PIC S9(0004) COMP.
  1162     05  MTBY6F PIC  X(0001).
  1163     05  FILLER REDEFINES MTBY6F.
  1164         10  MTBY6A PIC  X(0001).
  1165     05  MTBY6I PIC  X(0004).
  1166*    -------------------------------
  1167     05  MTDT6L PIC S9(0004) COMP.
  1168     05  MTDT6F PIC  X(0001).
  1169     05  FILLER REDEFINES MTDT6F.
  1170         10  MTDT6A PIC  X(0001).
  1171     05  MTDT6I PIC  X(0006).
  1172*    -------------------------------
  1173     05  LN7L PIC S9(0004) COMP.
  1174     05  LN7F PIC  X(0001).
  1175     05  FILLER REDEFINES LN7F.
  1176         10  LN7A PIC  X(0001).
  1177     05  LN7I PIC  X(0003).
  1178*    -------------------------------
  1179     05  FNLINE7L PIC S9(0004) COMP.
  1180     05  FNLINE7F PIC  X(0001).
  1181     05  FILLER REDEFINES FNLINE7F.
  1182         10  FNLINE7A PIC  X(0001).
  1183     05  FNLINE7I PIC  X(0063).
  1184*    -------------------------------
  1185     05  MTBY7L PIC S9(0004) COMP.
  1186     05  MTBY7F PIC  X(0001).
  1187     05  FILLER REDEFINES MTBY7F.
  1188         10  MTBY7A PIC  X(0001).
  1189     05  MTBY7I PIC  X(0004).
  1190*    -------------------------------
  1191     05  MTDT7L PIC S9(0004) COMP.
  1192     05  MTDT7F PIC  X(0001).
  1193     05  FILLER REDEFINES MTDT7F.
  1194         10  MTDT7A PIC  X(0001).
  1195     05  MTDT7I PIC  X(0006).
  1196*    -------------------------------
  1197     05  LN8L PIC S9(0004) COMP.
  1198     05  LN8F PIC  X(0001).
  1199     05  FILLER REDEFINES LN8F.
  1200         10  LN8A PIC  X(0001).
  1201     05  LN8I PIC  X(0003).
  1202*    -------------------------------
  1203     05  FNLINE8L PIC S9(0004) COMP.
  1204     05  FNLINE8F PIC  X(0001).
  1205     05  FILLER REDEFINES FNLINE8F.
  1206         10  FNLINE8A PIC  X(0001).
  1207     05  FNLINE8I PIC  X(0063).
  1208*    -------------------------------
  1209     05  MTBY8L PIC S9(0004) COMP.
  1210     05  MTBY8F PIC  X(0001).
  1211     05  FILLER REDEFINES MTBY8F.
  1212         10  MTBY8A PIC  X(0001).
  1213     05  MTBY8I PIC  X(0004).
  1214*    -------------------------------
  1215     05  MTDT8L PIC S9(0004) COMP.
  1216     05  MTDT8F PIC  X(0001).
  1217     05  FILLER REDEFINES MTDT8F.
  1218         10  MTDT8A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL1279.cbl
  1219     05  MTDT8I PIC  X(0006).
  1220*    -------------------------------
  1221     05  LN9L PIC S9(0004) COMP.
  1222     05  LN9F PIC  X(0001).
  1223     05  FILLER REDEFINES LN9F.
  1224         10  LN9A PIC  X(0001).
  1225     05  LN9I PIC  X(0003).
  1226*    -------------------------------
  1227     05  FNLINE9L PIC S9(0004) COMP.
  1228     05  FNLINE9F PIC  X(0001).
  1229     05  FILLER REDEFINES FNLINE9F.
  1230         10  FNLINE9A PIC  X(0001).
  1231     05  FNLINE9I PIC  X(0063).
  1232*    -------------------------------
  1233     05  MTBY9L PIC S9(0004) COMP.
  1234     05  MTBY9F PIC  X(0001).
  1235     05  FILLER REDEFINES MTBY9F.
  1236         10  MTBY9A PIC  X(0001).
  1237     05  MTBY9I PIC  X(0004).
  1238*    -------------------------------
  1239     05  MTDT9L PIC S9(0004) COMP.
  1240     05  MTDT9F PIC  X(0001).
  1241     05  FILLER REDEFINES MTDT9F.
  1242         10  MTDT9A PIC  X(0001).
  1243     05  MTDT9I PIC  X(0006).
  1244*    -------------------------------
  1245     05  LN10L PIC S9(0004) COMP.
  1246     05  LN10F PIC  X(0001).
  1247     05  FILLER REDEFINES LN10F.
  1248         10  LN10A PIC  X(0001).
  1249     05  LN10I PIC  X(0003).
  1250*    -------------------------------
  1251     05  FNLIN10L PIC S9(0004) COMP.
  1252     05  FNLIN10F PIC  X(0001).
  1253     05  FILLER REDEFINES FNLIN10F.
  1254         10  FNLIN10A PIC  X(0001).
  1255     05  FNLIN10I PIC  X(0063).
  1256*    -------------------------------
  1257     05  MTBY10L PIC S9(0004) COMP.
  1258     05  MTBY10F PIC  X(0001).
  1259     05  FILLER REDEFINES MTBY10F.
  1260         10  MTBY10A PIC  X(0001).
  1261     05  MTBY10I PIC  X(0004).
  1262*    -------------------------------
  1263     05  MTDT10L PIC S9(0004) COMP.
  1264     05  MTDT10F PIC  X(0001).
  1265     05  FILLER REDEFINES MTDT10F.
  1266         10  MTDT10A PIC  X(0001).
  1267     05  MTDT10I PIC  X(0006).
  1268*    -------------------------------
  1269     05  ERRMSGBL PIC S9(0004) COMP.
  1270     05  ERRMSGBF PIC  X(0001).
  1271     05  FILLER REDEFINES ERRMSGBF.
  1272         10  ERRMSGBA PIC  X(0001).
  1273     05  ERRMSGBI PIC  X(0072).
  1274*    -------------------------------
  1275     05  FUNCTL PIC S9(0004) COMP.
  1276     05  FUNCTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL1279.cbl
  1277     05  FILLER REDEFINES FUNCTF.
  1278         10  FUNCTA PIC  X(0001).
  1279     05  FUNCTI PIC  X(0001).
  1280*    -------------------------------
  1281     05  LINE1L PIC S9(0004) COMP.
  1282     05  LINE1F PIC  X(0001).
  1283     05  FILLER REDEFINES LINE1F.
  1284         10  LINE1A PIC  X(0001).
  1285     05  LINE1I PIC  999.
  1286*    -------------------------------
  1287     05  LINE2L PIC S9(0004) COMP.
  1288     05  LINE2F PIC  X(0001).
  1289     05  FILLER REDEFINES LINE2F.
  1290         10  LINE2A PIC  X(0001).
  1291     05  LINE2I PIC  999.
  1292*    -------------------------------
  1293     05  PFENTERL PIC S9(0004) COMP.
  1294     05  PFENTERF PIC  X(0001).
  1295     05  FILLER REDEFINES PFENTERF.
  1296         10  PFENTERA PIC  X(0001).
  1297     05  PFENTERI PIC  99.
  1298*    -------------------------------
  1299     05  PF6NOTEL PIC S9(0004) COMP.
  1300     05  PF6NOTEF PIC  X(0001).
  1301     05  FILLER REDEFINES PF6NOTEF.
  1302         10  PF6NOTEA PIC  X(0001).
  1303     05  PF6NOTEI PIC  X(0017).
  1304 01  EL1279AO REDEFINES EL1279AI.
  1305     05  FILLER            PIC  X(0012).
  1306*    -------------------------------
  1307     05  FILLER            PIC  X(0003).
  1308     05  DATEO PIC  X(0008).
  1309*    -------------------------------
  1310     05  FILLER            PIC  X(0003).
  1311     05  TIMEO PIC  99.99.
  1312*    -------------------------------
  1313     05  FILLER            PIC  X(0003).
  1314     05  CMPNYIDO PIC  X(0003).
  1315*    -------------------------------
  1316     05  FILLER            PIC  X(0003).
  1317     05  USERIDO PIC  X(0004).
  1318*    -------------------------------
  1319     05  FILLER            PIC  X(0003).
  1320     05  FCERTO PIC  X(0010).
  1321*    -------------------------------
  1322     05  FILLER            PIC  X(0003).
  1323     05  FCRTSFXO PIC  X(0001).
  1324*    -------------------------------
  1325     05  FILLER            PIC  X(0003).
  1326     05  FACOUNTO PIC  X(0010).
  1327*    -------------------------------
  1328     05  FILLER            PIC  X(0003).
  1329     05  FSTO PIC  X(0002).
  1330*    -------------------------------
  1331     05  FILLER            PIC  X(0003).
  1332     05  FCARRIRO PIC  X(0001).
  1333*    -------------------------------
  1334     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL1279.cbl
  1335     05  FGROUPO PIC  X(0006).
  1336*    -------------------------------
  1337     05  FILLER            PIC  X(0003).
  1338     05  FEFFDTO PIC  X(0008).
  1339*    -------------------------------
  1340     05  FILLER            PIC  X(0003).
  1341     05  TOTO PIC  ZZ9.
  1342*    -------------------------------
  1343     05  FILLER            PIC  X(0003).
  1344     05  FBILLYNO PIC  X(0003).
  1345*    -------------------------------
  1346     05  FILLER            PIC  X(0003).
  1347     05  FTYPEYNO PIC  X(0012).
  1348*    -------------------------------
  1349     05  FILLER            PIC  X(0003).
  1350     05  FCERTYNO PIC  X(0003).
  1351*    -------------------------------
  1352     05  FILLER            PIC  X(0003).
  1353     05  FTYPEO PIC  X(0063).
  1354*    -------------------------------
  1355     05  FILLER            PIC  X(0003).
  1356     05  LN1O PIC  ZZ9.
  1357*    -------------------------------
  1358     05  FILLER            PIC  X(0003).
  1359     05  FNLINE1O PIC  X(0063).
  1360*    -------------------------------
  1361     05  FILLER            PIC  X(0003).
  1362     05  MTBY1O PIC  X(0004).
  1363*    -------------------------------
  1364     05  FILLER            PIC  X(0003).
  1365     05  MTDT1O PIC  X(0006).
  1366*    -------------------------------
  1367     05  FILLER            PIC  X(0003).
  1368     05  LN2O PIC  ZZ9.
  1369*    -------------------------------
  1370     05  FILLER            PIC  X(0003).
  1371     05  FNLINE2O PIC  X(0063).
  1372*    -------------------------------
  1373     05  FILLER            PIC  X(0003).
  1374     05  MTBY2O PIC  X(0004).
  1375*    -------------------------------
  1376     05  FILLER            PIC  X(0003).
  1377     05  MTDT2O PIC  X(0006).
  1378*    -------------------------------
  1379     05  FILLER            PIC  X(0003).
  1380     05  LN3O PIC  ZZ9.
  1381*    -------------------------------
  1382     05  FILLER            PIC  X(0003).
  1383     05  FNLINE3O PIC  X(0063).
  1384*    -------------------------------
  1385     05  FILLER            PIC  X(0003).
  1386     05  MTBY3O PIC  X(0004).
  1387*    -------------------------------
  1388     05  FILLER            PIC  X(0003).
  1389     05  MTDT3O PIC  X(0006).
  1390*    -------------------------------
  1391     05  FILLER            PIC  X(0003).
  1392     05  LN4O PIC  ZZ9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL1279.cbl
  1393*    -------------------------------
  1394     05  FILLER            PIC  X(0003).
  1395     05  FNLINE4O PIC  X(0063).
  1396*    -------------------------------
  1397     05  FILLER            PIC  X(0003).
  1398     05  MTBY4O PIC  X(0004).
  1399*    -------------------------------
  1400     05  FILLER            PIC  X(0003).
  1401     05  MTDT4O PIC  X(0006).
  1402*    -------------------------------
  1403     05  FILLER            PIC  X(0003).
  1404     05  LN5O PIC  ZZ9.
  1405*    -------------------------------
  1406     05  FILLER            PIC  X(0003).
  1407     05  FNLINE5O PIC  X(0063).
  1408*    -------------------------------
  1409     05  FILLER            PIC  X(0003).
  1410     05  MTBY5O PIC  X(0004).
  1411*    -------------------------------
  1412     05  FILLER            PIC  X(0003).
  1413     05  MTDT5O PIC  X(0006).
  1414*    -------------------------------
  1415     05  FILLER            PIC  X(0003).
  1416     05  LN6O PIC  ZZ9.
  1417*    -------------------------------
  1418     05  FILLER            PIC  X(0003).
  1419     05  FNLINE6O PIC  X(0063).
  1420*    -------------------------------
  1421     05  FILLER            PIC  X(0003).
  1422     05  MTBY6O PIC  X(0004).
  1423*    -------------------------------
  1424     05  FILLER            PIC  X(0003).
  1425     05  MTDT6O PIC  X(0006).
  1426*    -------------------------------
  1427     05  FILLER            PIC  X(0003).
  1428     05  LN7O PIC  ZZ9.
  1429*    -------------------------------
  1430     05  FILLER            PIC  X(0003).
  1431     05  FNLINE7O PIC  X(0063).
  1432*    -------------------------------
  1433     05  FILLER            PIC  X(0003).
  1434     05  MTBY7O PIC  X(0004).
  1435*    -------------------------------
  1436     05  FILLER            PIC  X(0003).
  1437     05  MTDT7O PIC  X(0006).
  1438*    -------------------------------
  1439     05  FILLER            PIC  X(0003).
  1440     05  LN8O PIC  ZZ9.
  1441*    -------------------------------
  1442     05  FILLER            PIC  X(0003).
  1443     05  FNLINE8O PIC  X(0063).
  1444*    -------------------------------
  1445     05  FILLER            PIC  X(0003).
  1446     05  MTBY8O PIC  X(0004).
  1447*    -------------------------------
  1448     05  FILLER            PIC  X(0003).
  1449     05  MTDT8O PIC  X(0006).
  1450*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL1279.cbl
  1451     05  FILLER            PIC  X(0003).
  1452     05  LN9O PIC  ZZ9.
  1453*    -------------------------------
  1454     05  FILLER            PIC  X(0003).
  1455     05  FNLINE9O PIC  X(0063).
  1456*    -------------------------------
  1457     05  FILLER            PIC  X(0003).
  1458     05  MTBY9O PIC  X(0004).
  1459*    -------------------------------
  1460     05  FILLER            PIC  X(0003).
  1461     05  MTDT9O PIC  X(0006).
  1462*    -------------------------------
  1463     05  FILLER            PIC  X(0003).
  1464     05  LN10O PIC  ZZ9.
  1465*    -------------------------------
  1466     05  FILLER            PIC  X(0003).
  1467     05  FNLIN10O PIC  X(0063).
  1468*    -------------------------------
  1469     05  FILLER            PIC  X(0003).
  1470     05  MTBY10O PIC  X(0004).
  1471*    -------------------------------
  1472     05  FILLER            PIC  X(0003).
  1473     05  MTDT10O PIC  X(0006).
  1474*    -------------------------------
  1475     05  FILLER            PIC  X(0003).
  1476     05  ERRMSGBO PIC  X(0072).
  1477*    -------------------------------
  1478     05  FILLER            PIC  X(0003).
  1479     05  FUNCTO PIC  X(0001).
  1480*    -------------------------------
  1481     05  FILLER            PIC  X(0003).
  1482     05  LINE1O PIC  X(0003).
  1483*    -------------------------------
  1484     05  FILLER            PIC  X(0003).
  1485     05  LINE2O PIC  X(0003).
  1486*    -------------------------------
  1487     05  FILLER            PIC  X(0003).
  1488     05  PFENTERO PIC  X(0002).
  1489*    -------------------------------
  1490     05  FILLER            PIC  X(0003).
  1491     05  PF6NOTEO PIC  X(0017).
  1492*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL1279.cbl
  1494 01  EL1279R REDEFINES EL1279AI.
  1495     12  FILLER                  PIC X(202).
  1496     12  SC-ALL-LINES.
  1497      14 SC-LINES OCCURS 10 TIMES INDEXED BY SC-INDX.
  1498         16  SC-LINL             PIC S9(4)   COMP.
  1499         16  SC-LINA             PIC X.
  1500         16  SC-LIN              PIC ZZ9.
  1501         16  SC-TEXTL            PIC S9(4)   COMP.
  1502         16  SC-TEXTA            PIC X.
  1503         16  SC-TEXT             PIC X(63).
  1504         16  SC-MTBYL            PIC S9(4)   COMP.
  1505         16  SC-MTBYA            PIC X.
  1506         16  SC-MTBY             PIC X(4).
  1507         16  SC-MTDTL            PIC S9(4)   COMP.
  1508         16  SC-MTDTA            PIC X.
  1509         16  SC-MTDT             PIC X(6).
  1510     12  FILLER                  PIC X(116).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL1279.cbl
  1512 01  RECORD-TABLE                PIC X(21900) VALUE SPACES.
  1513 01  REC-TABLE  REDEFINES RECORD-TABLE.
  1514     12  TS-GROUP OCCURS 6 TIMES INDEXED BY TS-INDX PIC X(3650).
  1515 01  REC-ENTRIES REDEFINES RECORD-TABLE.
  1516     12  REC-ENT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
  1517         16  REC-TEXT                    PIC X(63).
  1518         16  REC-LAST-MAINT-BY           PIC XXXX.
  1519         16  REC-LAST-MAINT-DT           PIC XX.
  1520         16  REC-LAST-MAINT-HHMMSS       PIC S9(7) COMP-3.
  1521
  1522 01  TS-WORK-AREA                        PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL1279.cbl
  1524
  1525****************************************************************
  1526*
  1527* Copyright (c) 2007 by Clerity Solutions, Inc.
  1528* All rights reserved.
  1529*
  1530****************************************************************
  1531 01  DFHEIV.
  1532   02  DFHEIV0               PIC X(35).
  1533   02  DFHEIV1               PIC X(08).
  1534   02  DFHEIV2               PIC X(08).
  1535   02  DFHEIV3               PIC X(08).
  1536   02  DFHEIV4               PIC X(06).
  1537   02  DFHEIV5               PIC X(04).
  1538   02  DFHEIV6               PIC X(04).
  1539   02  DFHEIV7               PIC X(02).
  1540   02  DFHEIV8               PIC X(02).
  1541   02  DFHEIV9               PIC X(01).
  1542   02  DFHEIV10              PIC S9(7) COMP-3.
  1543   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1544   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1545   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1546   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1547   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1548   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1549   02  DFHEIV17              PIC X(04).
  1550   02  DFHEIV18              PIC X(04).
  1551   02  DFHEIV19              PIC X(04).
  1552   02  DFHEIV20              USAGE IS POINTER.
  1553   02  DFHEIV21              USAGE IS POINTER.
  1554   02  DFHEIV22              USAGE IS POINTER.
  1555   02  DFHEIV23              USAGE IS POINTER.
  1556   02  DFHEIV24              USAGE IS POINTER.
  1557   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1558   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1559   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1560   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1561   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1562   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1563   02  FILLER                PIC X(02).
  1564   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1565   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1566   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1567   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1568   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1569 LINKAGE  SECTION.
  1570*****************************************************************
  1571*                                                               *
  1572* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1573* All rights reserved.                                          *
  1574*                                                               *
  1575*****************************************************************
  1576 01  dfheiblk.
  1577     02  eibtime          pic s9(7) comp-3.
  1578     02  eibdate          pic s9(7) comp-3.
  1579     02  eibtrnid         pic x(4).
  1580     02  eibtaskn         pic s9(7) comp-3.
  1581     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL1279.cbl
  1582     02  dfheigdi         pic s9(4) comp.
  1583     02  eibcposn         pic s9(4) comp.
  1584     02  eibcalen         pic s9(4) comp.
  1585     02  eibaid           pic x(1).
  1586     02  eibfiller1       pic x(1).
  1587     02  eibfn            pic x(2).
  1588     02  eibfiller2       pic x(2).
  1589     02  eibrcode         pic x(6).
  1590     02  eibfiller3       pic x(2).
  1591     02  eibds            pic x(8).
  1592     02  eibreqid         pic x(8).
  1593     02  eibrsrce         pic x(8).
  1594     02  eibsync          pic x(1).
  1595     02  eibfree          pic x(1).
  1596     02  eibrecv          pic x(1).
  1597     02  eibsend          pic x(1).
  1598     02  eibatt           pic x(1).
  1599     02  eibeoc           pic x(1).
  1600     02  eibfmh           pic x(1).
  1601     02  eibcompl         pic x(1).
  1602     02  eibsig           pic x(1).
  1603     02  eibconf          pic x(1).
  1604     02  eiberr           pic x(1).
  1605     02  eibrldbk         pic x(1).
  1606     02  eiberrcd         pic x(4).
  1607     02  eibsynrb         pic x(1).
  1608     02  eibnodat         pic x(1).
  1609     02  eibfiller5       pic x(2).
  1610     02  eibresp          pic 9(09) comp.
  1611     02  eibresp2         pic 9(09) comp.
  1612     02  dfheigdj         pic s9(4) comp.
  1613     02  dfheigdk         pic s9(4) comp.
  1614 01  DFHCOMMAREA                 PIC X(1500).
  1615
  1616*         COPY ERCCNOT.
  1617******************************************************************
  1618*                                                                *
  1619*                            ERCCNOT                             *
  1620*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1621*                            VMOD=2.003                          *
  1622*                                                                *
  1623*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  1624*                                                                *
  1625*        FILE TYPE= VSAM,KSDS                                    *
  1626*        RECORD SIZE = 150    RECFORM = FIXED                    *
  1627*                                                                *
  1628*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  1629*                                                                *
  1630*        LOG = YES                                               *
  1631*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1632*                                                                *
  1633******************************************************************
  1634*                   C H A N G E   L O G
  1635*
  1636* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1637*-----------------------------------------------------------------
  1638*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1639* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL1279.cbl
  1640*-----------------------------------------------------------------
  1641* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  1642******************************************************************
  1643
  1644 01  CERT-NOTE-FILE.
  1645     12  CZ-RECORD-ID                PIC  XX.
  1646         88  VALID-CZ-ID                  VALUE 'CZ'.
  1647
  1648     12  CZ-CONTROL-PRIMARY.
  1649         16  CZ-COMPANY-CD           PIC X.
  1650         16  CZ-CARRIER              PIC X.
  1651         16  CZ-GROUPING.
  1652             20 CZ-GROUPING-PREFIX   PIC XXX.
  1653             20 CZ-GROUPING-PRIME    PIC XXX.
  1654         16  CZ-STATE                PIC XX.
  1655         16  CZ-ACCOUNT.
  1656             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  1657             20 CZ-ACCOUNT-PRIME     PIC X(6).
  1658         16  CZ-CERT-EFF-DT          PIC XX.
  1659         16  CZ-CERT-NO.
  1660             20  CZ-CERT-PRIME       PIC X(10).
  1661             20  CZ-CERT-SFX         PIC X.
  1662         16  CZ-RECORD-TYPE          PIC X.
  1663             88  CERT-NOTE           VALUE '1'.
  1664             88  CLAIM-CERT-NOTE     VALUE '2'.
  1665         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  1666
  1667     12  CZ-LAST-MAINT-DT            PIC XX.
  1668     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  1669     12  CZ-LAST-MAINT-USER          PIC X(4).
  1670
  1671     12  CZ-NOTE-INFORMATION.
  1672         16  CZ-NOTE                 PIC X(63).
  1673         16  FILLER                  PIC X(39).
  1674******************************************************************
  1675
  1676*         COPY ELCCERT.
  1677******************************************************************
  1678*                                                                *
  1679*                            ELCCERT.                            *
  1680*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1681*                            VMOD=2.013                          *
  1682*                                                                *
  1683*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1684*                                                                *
  1685*   FILE TYPE = VSAM,KSDS                                        *
  1686*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1687*                                                                *
  1688*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1689*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1690*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1691*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1692*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1693*                                                                *
  1694*   LOG = YES                                                    *
  1695*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1696******************************************************************
  1697*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL1279.cbl
  1698*
  1699* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1700*-----------------------------------------------------------------
  1701*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1702* EFFECTIVE    NUMBER
  1703*-----------------------------------------------------------------
  1704* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1705* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1706* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1707* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1708* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1709* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1710* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1711******************************************************************
  1712
  1713 01  CERTIFICATE-MASTER.
  1714     12  CM-RECORD-ID                      PIC XX.
  1715         88  VALID-CM-ID                      VALUE 'CM'.
  1716
  1717     12  CM-CONTROL-PRIMARY.
  1718         16  CM-COMPANY-CD                 PIC X.
  1719         16  CM-CARRIER                    PIC X.
  1720         16  CM-GROUPING.
  1721             20  CM-GROUPING-PREFIX        PIC X(3).
  1722             20  CM-GROUPING-PRIME         PIC X(3).
  1723         16  CM-STATE                      PIC XX.
  1724         16  CM-ACCOUNT.
  1725             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1726             20  CM-ACCOUNT-PRIME          PIC X(6).
  1727         16  CM-CERT-EFF-DT                PIC XX.
  1728         16  CM-CERT-NO.
  1729             20  CM-CERT-PRIME             PIC X(10).
  1730             20  CM-CERT-SFX               PIC X.
  1731
  1732     12  CM-CONTROL-BY-NAME.
  1733         16  CM-COMPANY-CD-A1              PIC X.
  1734         16  CM-INSURED-LAST-NAME          PIC X(15).
  1735         16  CM-INSURED-INITIALS.
  1736             20  CM-INSURED-INITIAL1       PIC X.
  1737             20  CM-INSURED-INITIAL2       PIC X.
  1738
  1739     12  CM-CONTROL-BY-SSN.
  1740         16  CM-COMPANY-CD-A2              PIC X.
  1741         16  CM-SOC-SEC-NO.
  1742             20  CM-SSN-STATE              PIC XX.
  1743             20  CM-SSN-ACCOUNT            PIC X(6).
  1744             20  CM-SSN-LN3.
  1745                 25  CM-INSURED-INITIALS-A2.
  1746                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1747                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1748                 25 CM-PART-LAST-NAME-A2         PIC X.
  1749
  1750     12  CM-CONTROL-BY-CERT-NO.
  1751         16  CM-COMPANY-CD-A4              PIC X.
  1752         16  CM-CERT-NO-A4                 PIC X(11).
  1753
  1754     12  CM-CONTROL-BY-MEMB.
  1755         16  CM-COMPANY-CD-A5              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL1279.cbl
  1756         16  CM-MEMBER-NO.
  1757             20  CM-MEMB-STATE             PIC XX.
  1758             20  CM-MEMB-ACCOUNT           PIC X(6).
  1759             20  CM-MEMB-LN4.
  1760                 25  CM-INSURED-INITIALS-A5.
  1761                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1762                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1763                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1764
  1765     12  CM-INSURED-PROFILE-DATA.
  1766         16  CM-INSURED-FIRST-NAME.
  1767             20  CM-INSURED-1ST-INIT       PIC X.
  1768             20  FILLER                    PIC X(9).
  1769         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1770         16  CM-INSURED-SEX                PIC X.
  1771             88  CM-SEX-MALE                  VALUE 'M'.
  1772             88  CM-SEX-FEMAL                 VALUE 'F'.
  1773         16  CM-INSURED-JOINT-AGE          PIC 99.
  1774         16  CM-JOINT-INSURED-NAME.
  1775             20  CM-JT-LAST-NAME           PIC X(15).
  1776             20  CM-JT-FIRST-NAME.
  1777                 24  CM-JT-1ST-INIT        PIC X.
  1778                 24  FILLER                PIC X(9).
  1779             20  CM-JT-INITIAL             PIC X.
  1780
  1781     12  CM-LIFE-DATA.
  1782         16  CM-LF-BENEFIT-CD              PIC XX.
  1783         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1784         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1785         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1786         16  CM-LF-DEV-CODE                PIC XXX.
  1787         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1788         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1789         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1790         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1791         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1792         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1793         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1794         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1795         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  1796         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1797         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1798         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1799         16  FILLER                        PIC XX.
  1800
  1801     12  CM-AH-DATA.
  1802         16  CM-AH-BENEFIT-CD              PIC XX.
  1803         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1804         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1805         16  CM-AH-DEV-CODE                PIC XXX.
  1806         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1807         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1808         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1809         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1810         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1811         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1812         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1813         16  CM-AH-PAID-THRU-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL1279.cbl
  1814             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1815         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1816         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1817         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1818         16  FILLER                        PIC X.
  1819
  1820     12  CM-LOAN-INFORMATION.
  1821         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1822         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1823         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1824         16  CM-PAY-FREQUENCY              PIC S99.
  1825         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1826         16  CM-RATE-CLASS                 PIC XX.
  1827         16  CM-BENEFICIARY                PIC X(25).
  1828         16  CM-POLICY-FORM-NO             PIC X(12).
  1829         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1830         16  CM-LAST-ADD-ON-DT             PIC XX.
  1831         16  CM-DEDUCTIBLE-AMOUNTS.
  1832             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1833             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1834         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1835             20  CM-RESIDENT-STATE         PIC XX.
  1836             20  CM-RATE-CODE              PIC X(4).
  1837             20  FILLER                    PIC XX.
  1838         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1839             20  CM-LOAN-OFFICER           PIC X(5).
  1840             20  FILLER                    PIC XXX.
  1841         16  CM-CSR-CODE                   PIC XXX.
  1842         16  CM-UNDERWRITING-CODE          PIC X.
  1843             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1844         16  CM-POST-CARD-IND              PIC X.
  1845         16  CM-NH-INTERFACE-SW            PIC X.
  1846         16  CM-PREMIUM-TYPE               PIC X.
  1847             88  CM-SING-PRM                  VALUE '1'.
  1848             88  CM-O-B-COVERAGE              VALUE '2'.
  1849             88  CM-OPEN-END                  VALUE '3'.
  1850         16  CM-IND-GRP-TYPE               PIC X.
  1851             88  CM-INDIVIDUAL                VALUE 'I'.
  1852             88  CM-GROUP                     VALUE 'G'.
  1853         16  CM-SKIP-CODE                  PIC X.
  1854             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  1855             88  SKIP-JULY                    VALUE '1'.
  1856             88  SKIP-AUGUST                  VALUE '2'.
  1857             88  SKIP-SEPTEMBER               VALUE '3'.
  1858             88  SKIP-JULY-AUG                VALUE '4'.
  1859             88  SKIP-AUG-SEPT                VALUE '5'.
  1860             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1861             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1862             88  SKIP-JUNE                    VALUE '8'.
  1863             88  SKIP-JUNE-JULY               VALUE '9'.
  1864             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  1865             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  1866         16  CM-PAYMENT-MODE               PIC X.
  1867             88  PAY-MONTHLY                  VALUE SPACE.
  1868             88  PAY-WEEKLY                   VALUE '1'.
  1869             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1870             88  PAY-BI-WEEKLY                VALUE '3'.
  1871             88  PAY-SEMI-ANUALLY             VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL1279.cbl
  1872         16  CM-LOAN-NUMBER                PIC X(8).
  1873         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1874         16  CM-OLD-LOF                    PIC XXX.
  1875*        16  CM-LOAN-OFFICER               PIC XXX.
  1876         16  CM-REIN-TABLE                 PIC XXX.
  1877         16  CM-SPECIAL-REIN-CODE          PIC X.
  1878         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1879         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1880         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1881
  1882     12  CM-STATUS-DATA.
  1883         16  CM-ENTRY-STATUS               PIC X.
  1884         16  CM-ENTRY-DT                   PIC XX.
  1885
  1886         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1887         16  CM-LF-CANCEL-DT               PIC XX.
  1888         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  1889
  1890         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1891         16  CM-LF-DEATH-DT                PIC XX.
  1892         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1893
  1894         16  CM-LF-CURRENT-STATUS          PIC X.
  1895             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1896                                                'M' '4' '5' '9'.
  1897             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1898             88  CM-LF-POLICY-PENDING         VALUE '2'.
  1899             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  1900             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  1901             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1902             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1903             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1904             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1905             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  1906             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  1907             88  CM-LF-DECLINED               VALUE 'D'.
  1908             88  CM-LF-VOIDED                 VALUE 'V'.
  1909
  1910         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1911         16  CM-AH-CANCEL-DT               PIC XX.
  1912         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1913
  1914         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1915         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1916         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1917
  1918         16  CM-AH-CURRENT-STATUS          PIC X.
  1919             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1920                                                'M' '4' '5' '9'.
  1921             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  1922             88  CM-AH-POLICY-PENDING         VALUE '2'.
  1923             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  1924             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  1925             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1926             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1927             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1928             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1929             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL1279.cbl
  1930             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1931             88  CM-AH-DECLINED               VALUE 'D'.
  1932             88  CM-AH-VOIDED                 VALUE 'V'.
  1933
  1934         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1935             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1936             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1937             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1938         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1939
  1940         16  CM-ENTRY-BATCH                PIC X(6).
  1941         16  CM-LF-EXIT-BATCH              PIC X(6).
  1942         16  CM-AH-EXIT-BATCH              PIC X(6).
  1943         16  CM-LAST-MONTH-END             PIC XX.
  1944
  1945     12  CM-NOTE-SW                        PIC X.
  1946         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1947         88  CERT-NOTES-PRESENT               VALUE '1'.
  1948         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1949         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1950         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1951         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1952         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1953         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1954     12  CM-COMP-EXCP-SW                   PIC X.
  1955         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  1956         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  1957     12  CM-INSURED-ADDRESS-SW             PIC X.
  1958         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  1959         88  INSURED-ADDR-PRESENT             VALUE '1'.
  1960
  1961*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  1962     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  1963     12  FILLER                            PIC X.
  1964
  1965*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  1966     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  1967     12  FILLER                            PIC X.
  1968*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  1969     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  1970
  1971     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  1972         88  CERT-ADDED-BATCH                 VALUE ' '.
  1973         88  CERT-ADDED-ONLINE                VALUE '1'.
  1974         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  1975         88  CERT-PURGED-OFFLINE              VALUE '3'.
  1976         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  1977     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  1978         88  CERT-AS-LOADED                   VALUE ' '.
  1979         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  1980         88  CERT-CLAIM-ONLINE                VALUE '2'.
  1981         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  1982         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  1983         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  1984         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  1985         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  1986
  1987     12  CM-ACCOUNT-COMM-PCTS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL1279.cbl
  1988         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  1989         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1990
  1991     12  CM-USER-FIELD                     PIC X.
  1992     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  1993     12  CM-CLP-STATE                      PIC XX.
  1994     12  CM-USER-RESERVED                  PIC XXX.
  1995******************************************************************
  1996
  1997 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CERT-NOTE-FILE
  1998                          CERTIFICATE-MASTER.
  1999 0000-DFHEXIT SECTION.
  2000     MOVE '9#                    $   ' TO DFHEIV0.
  2001     MOVE 'EL1279' TO DFHEIV1.
  2002     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2003
  2004     MOVE EIBTRMID               TO QID-TERM.
  2005     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  2006     MOVE '5'                    TO DC-OPTION-CODE.
  2007     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2008     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  2009     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  2010
  2011     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK
  2012     IF EIBCALEN = ZEROS
  2013         GO TO 8800-UNAUTHORIZED-ACCESS
  2014     END-IF.
  2015
  2016     IF PI-CALLING-PROGRAM NOT = THIS-PGM AND PGM-EL1276
  2017         PERFORM 4900-SET-NOTES-FLAG THRU 4900-EXIT
  2018         IF CLAIM-SESSION
  2019             SET PI-CLAIM-NOTE TO TRUE
  2020         ELSE
  2021             SET PI-CERT-NOTE TO TRUE
  2022         END-IF
  2023     END-IF.
  2024
  2025     IF PI-CALLING-PROGRAM = PGM-EL1276
  2026         MOVE THIS-PGM           TO PI-CALLING-PROGRAM
  2027         MOVE 'N'                TO PI-PF5-PRESSED
  2028         MOVE 'N'                TO PI-PF6-PRESSED
  2029     END-IF.
  2030
  2031     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  2032        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  2033           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  2034           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  2035           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  2036           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  2037           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  2038           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  2039           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  2040           MOVE THIS-PGM TO PI-CALLING-PROGRAM
  2041        ELSE
  2042           MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  2043           MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  2044           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  2045           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL1279.cbl
  2046           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  2047           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  2048           MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  2049           MOVE SPACES               TO PI-SAVED-PROGRAM-6
  2050        END-IF
  2051     END-IF.
  2052
  2053 1000-START.
  2054
  2055     MOVE LOW-VALUES TO EL1279AI.
  2056     MOVE SPACES                 TO  ERCNOT-KEY
  2057                                     ELCERT-KEY.
  2058
  2059     MOVE PI-COMPANY-CD          TO  ERCNOT-COMPANY-CD
  2060                                     ELCERT-COMPANY-CD.
  2061     MOVE PI-CARRIER             TO  ERCNOT-CARRIER
  2062                                     ELCERT-CARRIER.
  2063     MOVE PI-GROUPING            TO  ERCNOT-GROUPING
  2064                                     ELCERT-GROUPING.
  2065     MOVE PI-STATE               TO  ERCNOT-STATE
  2066                                     ELCERT-STATE.
  2067     MOVE PI-ACCOUNT             TO  ERCNOT-ACCOUNT
  2068                                     ELCERT-ACCOUNT.
  2069     MOVE PI-CERT-EFF-DT         TO  ERCNOT-EFF-DT
  2070                                     ELCERT-EFF-DT.
  2071     MOVE PI-CERT-PRIME          TO  ERCNOT-CERT-PRIME
  2072                                     ELCERT-CERT-PRIME.
  2073     MOVE PI-CERT-SFX            TO  ERCNOT-CERT-SFX
  2074                                     ELCERT-CERT-SFX.
  2075     MOVE PI-CURR-NOTE-REC-TYPE  TO  ERCNOT-REC-TYP
  2076     MOVE ZEROS                  TO  ERCNOT-SEQ.
  2077     MOVE ERCNOT-PARTIAL-KEY     TO  SV-PRIOR-KEY.
  2078
  2079     IF EIBTRNID NOT = TRANS-ID
  2080        MOVE '0'                 TO  PI-UPDATE-SW
  2081        IF PI-PROCESSOR-ID NOT = 'LGXX'
  2082
  2083* EXEC CICS READQ TS
  2084*                    QUEUE (PI-SECURITY-TEMP-STORE-ID)
  2085*                    INTO (SECURITY-CONTROL)
  2086*                    LENGTH (SC-COMM-LENGTH)
  2087*                    ITEM  (SC-ITEM)
  2088*           END-EXEC
  2089*    MOVE '*$II   L              ''   #00002078' TO DFHEIV0
  2090     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  2091     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2092     MOVE X'2020233030303032303738' TO DFHEIV0(25:11)
  2093     CALL 'kxdfhei1' USING DFHEIV0,
  2094           PI-SECURITY-TEMP-STORE-ID,
  2095           SECURITY-CONTROL,
  2096           SC-COMM-LENGTH,
  2097           SC-ITEM,
  2098           DFHEIV99,
  2099           DFHEIV99
  2100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2101          MOVE SC-CREDIT-DISPLAY (32) TO PI-DISPLAY-CAP
  2102          MOVE SC-CREDIT-UPDATE (32)  TO PI-MODIFY-CAP
  2103        END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL1279.cbl
  2104     END-IF.
  2105
  2106     IF NOT DISPLAY-CAP
  2107         MOVE 'READ'             TO  SM-READ
  2108         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2109         MOVE ER-0070            TO  EMI-ERROR
  2110         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2111         GO TO 8100-SEND-INITIAL-MAP
  2112     END-IF.
  2113
  2114
  2115* EXEC CICS HANDLE AID
  2116*         CLEAR(9400-CLEAR)
  2117*    END-EXEC.
  2118*    MOVE '"&=                  V! " #00002097' TO DFHEIV0
  2119     MOVE X'22263D202020202020202020' TO DFHEIV0(1:12)
  2120     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  2121     MOVE X'2220233030303032303937' TO DFHEIV0(25:11)
  2122     CALL 'kxdfhei1' USING DFHEIV0
  2123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2124
  2125
  2126
  2127* EXEC CICS HANDLE CONDITION
  2128*         ERROR(9990-ABEND)
  2129*         PGMIDERR(9600-PGMID-ERROR)
  2130*    END-EXEC.
  2131*    MOVE '"$.L                  ! # #00002101' TO DFHEIV0
  2132     MOVE X'22242E4C2020202020202020' TO DFHEIV0(1:12)
  2133     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2134     MOVE X'2320233030303032313031' TO DFHEIV0(25:11)
  2135     CALL 'kxdfhei1' USING DFHEIV0
  2136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2137
  2138
  2139     IF EIBTRNID NOT = TRANS-ID
  2140         GO TO 7000-BUILD-TABLE
  2141     END-IF.
  2142
  2143     IF PI-CHANGE-IN-NOTE-TYPE
  2144         GO TO 7000-BUILD-TABLE
  2145     END-IF.
  2146
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL1279.cbl
  2148 2000-RECEIVE.
  2149     IF EIBAID = DFHPA1 OR
  2150        EIBAID = DFHPA2 OR
  2151        EIBAID = DFHPA3
  2152           MOVE ER-0008 TO EMI-ERROR
  2153           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2154           GO TO 8200-SEND-DATAONLY
  2155     END-IF.
  2156
  2157
  2158* EXEC CICS RECEIVE
  2159*         MAP(MAP-NAME)
  2160*         MAPSET(MAPSET-NAME)
  2161*         INTO(EL1279AI)
  2162*    END-EXEC.
  2163     MOVE LENGTH OF
  2164      EL1279AI
  2165       TO DFHEIV11
  2166*    MOVE '8"T I  L              ''   #00002124' TO DFHEIV0
  2167     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2168     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2169     MOVE X'2020233030303032313234' TO DFHEIV0(25:11)
  2170     CALL 'kxdfhei1' USING DFHEIV0,
  2171           MAP-NAME,
  2172           EL1279AI,
  2173           DFHEIV11,
  2174           MAPSET-NAME,
  2175           DFHEIV99,
  2176           DFHEIV99
  2177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2178
  2179
  2180     IF PFENTERL = ZEROS
  2181        GO TO 2001-CHECK-PFKEYS
  2182     END-IF.
  2183
  2184     IF EIBAID NOT = DFHENTER
  2185        MOVE ER-0004             TO EMI-ERROR
  2186        GO TO 2002-INPUT-ERROR
  2187     END-IF.
  2188
  2189     IF PFENTERI NUMERIC AND
  2190        (PFENTERI > 00 AND  < 25)
  2191        MOVE PF-VALUES (PFENTERI) TO EIBAID
  2192     ELSE
  2193        MOVE ER-0029 TO EMI-ERROR
  2194        GO TO 2002-INPUT-ERROR
  2195     END-IF.
  2196
  2197 2001-CHECK-PFKEYS.
  2198     IF EIBAID = DFHPF23
  2199        GO TO 9000-RETURN-CICS
  2200     END-IF.
  2201
  2202     IF EIBAID = DFHPF24
  2203        GO TO 9200-RETURN-MAIN-MENU
  2204     END-IF.
  2205
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL1279.cbl
  2206     IF EIBAID = DFHPF12
  2207        GO TO 9500-PF12
  2208     END-IF.
  2209
  2210     IF EIBAID = DFHPF5
  2211        IF PI-CHANGES-MADE
  2212            SET PF5-PRESSED          TO TRUE
  2213            MOVE -1                  TO FUNCTL
  2214            MOVE SPACES              TO PFENTERO
  2215            MOVE AL-UNNOF            TO PFENTERA
  2216            MOVE ER-0045             TO EMI-ERROR
  2217            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2218            GO TO 8200-SEND-DATAONLY
  2219         ELSE
  2220            MOVE PGM-EL1276         TO PGM-NAME
  2221            GO TO 9300-XCTL
  2222         END-IF
  2223     END-IF.
  2224
  2225     IF EIBAID = DFHPF6
  2226        IF PI-CHANGES-MADE
  2227            SET PF6-PRESSED          TO TRUE
  2228            MOVE -1                  TO FUNCTL
  2229            MOVE SPACES              TO PFENTERO
  2230            MOVE AL-UNNOF            TO PFENTERA
  2231            MOVE ER-0045             TO EMI-ERROR
  2232            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2233            GO TO 8200-SEND-DATAONLY
  2234         ELSE
  2235            IF PI-CLAIM-NOTE
  2236                SET PI-CERT-NOTE    TO TRUE
  2237            ELSE
  2238                SET PI-CLAIM-NOTE   TO TRUE
  2239            END-IF
  2240            SET PI-CHANGE-IN-NOTE-TYPE TO TRUE
  2241            GO TO 1000-START
  2242         END-IF
  2243     END-IF.
  2244
  2245     IF FUNCTL NOT = ZEROS AND EIBAID NOT = DFHENTER
  2246        IF FUNCTI = 'A' OR = SPACES
  2247           NEXT SENTENCE
  2248        ELSE
  2249           MOVE ER-0050          TO EMI-ERROR
  2250           MOVE -1 TO FUNCTL
  2251           MOVE AL-UABON TO FUNCTA PFENTERA
  2252           GO TO 2002-INPUT-ERROR
  2253        END-IF
  2254     END-IF.
  2255
  2256     IF EIBAID = DFHPF1
  2257        MOVE NUM-LINES-PER-SCREEN TO ROLL-COUNTER
  2258        GO TO 7400-PAGE-ROUTINE
  2259     END-IF.
  2260
  2261     IF EIBAID = DFHPF2
  2262        SUBTRACT NUM-LINES-PER-SCREEN FROM ROLL-COUNTER
  2263        GO TO 7400-PAGE-ROUTINE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL1279.cbl
  2264     END-IF.
  2265
  2266     IF EIBAID = DFHPF3
  2267        MOVE 5                   TO ROLL-COUNTER
  2268        GO TO 7400-PAGE-ROUTINE
  2269     END-IF.
  2270
  2271     IF EIBAID = DFHPF4
  2272        MOVE -5                  TO ROLL-COUNTER
  2273        GO TO 7400-PAGE-ROUTINE
  2274     END-IF.
  2275
  2276     IF EIBAID = DFHENTER
  2277        GO TO 2003-EDIT-DATA
  2278     END-IF.
  2279
  2280     MOVE ER-0029                TO EMI-ERROR.
  2281
  2282 2002-INPUT-ERROR.
  2283     MOVE -1                     TO PFENTERL
  2284     MOVE AL-UNBON               TO PFENTERA
  2285     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2286     GO TO 8200-SEND-DATAONLY.
  2287
  2288 2003-EDIT-DATA.
  2289
  2290     IF FUNCTI = 'L'
  2291         NEXT SENTENCE
  2292     ELSE
  2293         IF NOT MODIFY-CAP
  2294             MOVE 'UPDATE'       TO  SM-READ
  2295             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2296             MOVE ER-0070        TO  EMI-ERROR
  2297             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2298             GO TO 8100-SEND-INITIAL-MAP
  2299         END-IF
  2300     END-IF.
  2301
  2302     IF FUNCTL = ZEROS OR FUNCTI = SPACES
  2303        GO TO 4000-CHANGE-ROUTINE
  2304     END-IF.
  2305
  2306     IF (FUNCTI = 'S' OR = 'D' OR = 'Q' OR
  2307                = 'I' OR = 'A' OR = 'L')
  2308         NEXT SENTENCE
  2309     ELSE
  2310         MOVE ER-0023            TO EMI-ERROR
  2311         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2312         MOVE AL-UABON           TO FUNCTA
  2313         MOVE -1                 TO FUNCTL
  2314         GO TO 8200-SEND-DATAONLY
  2315     END-IF.
  2316
  2317     IF FUNCTI = 'D'  OR = 'I' OR = 'L'
  2318        PERFORM 2500-LINE-CHECK THRU 2599-EXIT
  2319     ELSE
  2320        IF LINE1L NOT = ZEROS OR
  2321           LINE2L NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL1279.cbl
  2322           MOVE ER-0030          TO EMI-ERROR
  2323           MOVE -1               TO LINE1L
  2324           MOVE AL-UNBON         TO LINE1A LINE2A
  2325           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2326           GO TO 8200-SEND-DATAONLY
  2327        END-IF
  2328     END-IF.
  2329
  2330     IF FUNCTI = 'A'
  2331        GO TO 5000-ADD-NEW-LINES
  2332     END-IF.
  2333     IF FUNCTI = 'Q'
  2334        GO TO 9410-RETURN
  2335     END-IF.
  2336     IF FUNCTI = 'S'
  2337        GO TO 4500-SAVE-DATA
  2338     END-IF.
  2339     IF PI-TOTAL-LINES = 0
  2340        MOVE ER-0048             TO EMI-ERROR
  2341        MOVE -1                  TO FUNCTL
  2342        MOVE AL-UNBON            TO FUNCTA
  2343        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2344        GO TO 8200-SEND-DATAONLY
  2345     END-IF.
  2346     IF FUNCTI = 'L'
  2347        GO TO 5500-LOOKUP
  2348     END-IF.
  2349     IF FUNCTI = 'D'
  2350        GO TO 3000-DELETE-LINES
  2351     END-IF.
  2352
  2353     GO TO 3500-INSERT-LINES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL1279.cbl
  2355 2500-LINE-CHECK.
  2356     IF LINE1L = ZEROS AND
  2357        LINE2L = ZEROS
  2358        MOVE ER-0069             TO EMI-ERROR
  2359        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2360        MOVE -1                  TO LINE1L
  2361        GO TO 8200-SEND-DATAONLY
  2362     END-IF.
  2363
  2364     IF LINE1L NOT = ZEROS
  2365        IF LINE1I = ZERO AND FUNCTI EQUAL 'L'
  2366            MOVE 1               TO LINE1I
  2367        END-IF
  2368        IF LINE1I = ZERO AND FUNCTI EQUAL 'D'
  2369           MOVE ER-0049          TO EMI-ERROR
  2370           MOVE AL-UNBON         TO LINE1A
  2371           MOVE -1               TO LINE1L
  2372           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2373           GO TO 8200-SEND-DATAONLY
  2374        END-IF
  2375        IF LINE1I NOT NUMERIC OR
  2376           LINE1I > PI-TOTAL-LINES
  2377           MOVE ER-0031          TO EMI-ERROR
  2378           MOVE AL-UNBON         TO LINE1A
  2379           MOVE -1               TO LINE1L
  2380           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2381           GO TO 8200-SEND-DATAONLY
  2382        ELSE
  2383           IF LINE2L = ZEROS
  2384              MOVE 1             TO LINE2I
  2385              IF FUNCTI = 'I'
  2386                  GO TO 2510-MAX-CHECK
  2387              ELSE
  2388                  NEXT SENTENCE
  2389              END-IF
  2390           ELSE
  2391              IF FUNCTI = 'I'
  2392                 GO TO 2510-MAX-CHECK
  2393              ELSE
  2394                 IF LINE2I NOT NUMERIC
  2395                    MOVE AL-UNBON TO LINE2A
  2396                    MOVE ER-0032  TO EMI-ERROR
  2397                    MOVE -1       TO LINE2L
  2398                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2399                    GO TO 8200-SEND-DATAONLY
  2400                 ELSE
  2401                    NEXT SENTENCE
  2402                 END-IF
  2403              END-IF
  2404           END-IF
  2405        END-IF
  2406     ELSE
  2407        IF LINE2L = ZEROS
  2408           NEXT SENTENCE
  2409        ELSE
  2410           MOVE -1               TO LINE2L
  2411           MOVE ER-0041          TO EMI-ERROR
  2412           MOVE AL-UNBON         TO LINE2A
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL1279.cbl
  2413           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2414           GO TO 8200-SEND-DATAONLY
  2415        END-IF
  2416     END-IF.
  2417     GO TO 2599-EXIT.
  2418 2510-MAX-CHECK.
  2419     IF LINE2I NOT NUMERIC
  2420        MOVE -1                  TO LINE2L
  2421        MOVE ER-0032             TO EMI-ERROR
  2422        MOVE AL-UNBON            TO LINE2A
  2423        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2424        GO TO 8200-SEND-DATAONLY
  2425     ELSE
  2426        COMPUTE ROLL-COUNTER = LINE2I + PI-TOTAL-LINES
  2427        IF ROLL-COUNTER GREATER THAN MAX-LINES
  2428           MOVE -1               TO LINE2L
  2429           MOVE ER-0044          TO EMI-ERROR
  2430           MOVE AL-UNBON         TO LINE2A
  2431           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2432           GO TO 8200-SEND-DATAONLY
  2433        END-IF
  2434     END-IF.
  2435 2599-EXIT.
  2436      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL1279.cbl
  2438 3000-DELETE-LINES.
  2439     IF LINE2L = ZEROS AND LINE2I = 1
  2440        MOVE LINE1I              TO LINE2I
  2441     END-IF.
  2442
  2443     IF LINE2I > PI-TOTAL-LINES OR < LINE1I
  2444        MOVE ER-0049             TO EMI-ERROR
  2445        MOVE AL-UNBON            TO LINE2A
  2446        MOVE -1                  TO LINE2L
  2447        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2448        GO TO 8200-SEND-DATAONLY
  2449     END-IF.
  2450
  2451     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2452     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2453             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2454             SC-INDX > NUM-LINES-PER-SCREEN
  2455     SET TB-INDX TO LINE1I.
  2456
  2457     IF NOT EMI-NO-ERRORS
  2458        GO TO 8200-SEND-DATAONLY
  2459     END-IF.
  2460
  2461     SET TB-INDX TO LINE1I
  2462     COMPUTE ROLL-COUNTER = LINE2I - LINE1I + 1.
  2463
  2464     IF LINE2I NOT = PI-TOTAL-LINES
  2465        SET TB-INDX1 TO LINE2I
  2466        SET TB-INDX1 UP BY 1
  2467        PERFORM 3100-DELETE-TABLE-ENTRIES
  2468                UNTIL TB-INDX1 > PI-TOTAL-LINES
  2469     END-IF.
  2470
  2471     PERFORM 3150-BLANK-TABLE-ENTRIES
  2472             ROLL-COUNTER TIMES.
  2473     SUBTRACT ROLL-COUNTER FROM PI-TOTAL-LINES.
  2474
  2475     IF PI-CURRENT-LINE > PI-TOTAL-LINES
  2476        MOVE PI-TOTAL-LINES      TO PI-CURRENT-LINE
  2477        SUBTRACT 1 FROM PI-CURRENT-LINE
  2478     END-IF.
  2479
  2480     SET TB-INDX  TO PI-CURRENT-LINE
  2481     MOVE LOW-VALUES             TO EL1279AI
  2482
  2483     IF PI-CURRENT-LINE > ZERO
  2484         PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  2485             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2486             SC-INDX > NUM-LINES-PER-SCREEN
  2487         PERFORM 7200-PUT-TEMP-STOR  THRU 7249-EXIT
  2488     END-IF.
  2489
  2490     MOVE '1'                    TO PI-UPDATE-SW.
  2491     IF PI-TOTAL-LINES = ZEROS
  2492        MOVE ZEROS               TO PI-CURRENT-LINE
  2493     END-IF.
  2494     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL1279.cbl
  2496
  2497 3100-DELETE-TABLE-ENTRIES.
  2498     MOVE REC-ENT (TB-INDX1)     TO REC-ENT (TB-INDX)
  2499     SET TB-INDX TB-INDX1 UP BY 1.
  2500
  2501 3150-BLANK-TABLE-ENTRIES.
  2502     MOVE SPACES               TO REC-ENT (TB-INDX).
  2503     MOVE SAVE-BIN-DATE        TO REC-LAST-MAINT-DT (TB-INDX).
  2504     MOVE EIBTIME              TO REC-LAST-MAINT-HHMMSS (TB-INDX).
  2505     MOVE PI-PROCESSOR-ID      TO REC-LAST-MAINT-BY (TB-INDX).
  2506     SET TB-INDX UP BY 1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL1279.cbl
  2508 3500-INSERT-LINES.
  2509
  2510     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2511     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2512             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2513             SC-INDX > NUM-LINES-PER-SCREEN.
  2514
  2515     IF NOT EMI-NO-ERRORS
  2516        GO TO 8200-SEND-DATAONLY
  2517     END-IF.
  2518
  2519     SET TB-INDX TO PI-TOTAL-LINES.
  2520     ADD LINE2I TO PI-TOTAL-LINES.
  2521     SET TB-INDX1 TO PI-TOTAL-LINES.
  2522     PERFORM 3600-INSERT-TABLE-ENTRIES
  2523             UNTIL TB-INDX = LINE1I.
  2524     SET TB-INDX UP BY 1.
  2525
  2526     IF LINE1I EQUAL ZERO
  2527         SET PI-CURRENT-LINE TO 1
  2528     ELSE
  2529         SET PI-CURRENT-LINE TO LINE1I
  2530     END-IF.
  2531
  2532     COMPUTE ROLL-COUNTER = PI-CURRENT-LINE +
  2533                            NUM-LINES-PER-SCREEN.
  2534     IF TB-INDX NOT LESS THAN ROLL-COUNTER OR
  2535                    LESS THAN PI-CURRENT-LINE
  2536        SET SC-INDX TO 1
  2537        SET SC-INDX DOWN BY 1
  2538     ELSE
  2539        SET ROLL-COUNTER TO TB-INDX
  2540        COMPUTE ROLL-COUNTER = ROLL-COUNTER - PI-CURRENT-LINE
  2541                  + 1
  2542        SET SC-INDX TO ROLL-COUNTER
  2543     END-IF.
  2544
  2545     PERFORM 3150-BLANK-TABLE-ENTRIES LINE2I TIMES.
  2546     SET TB-INDX TO PI-CURRENT-LINE.
  2547     MOVE LOW-VALUES             TO EL1279AI.
  2548
  2549     IF SC-INDX NOT = ZERO
  2550        MOVE -1 TO SC-TEXTL (SC-INDX)
  2551     END-IF.
  2552
  2553     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  2554            VARYING SC-INDX FROM 1 BY 1 UNTIL
  2555            SC-INDX > NUM-LINES-PER-SCREEN.
  2556     PERFORM 7200-PUT-TEMP-STOR  THRU 7249-EXIT.
  2557     MOVE '1'                    TO PI-UPDATE-SW.
  2558     GO TO 8100-SEND-INITIAL-MAP.
  2559
  2560 3600-INSERT-TABLE-ENTRIES.
  2561     MOVE REC-ENT (TB-INDX)      TO REC-ENT (TB-INDX1).
  2562     SET TB-INDX TB-INDX1 DOWN BY 1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL1279.cbl
  2564
  2565 4000-CHANGE-ROUTINE.
  2566     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2567     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2568             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2569             SC-INDX > NUM-LINES-PER-SCREEN.
  2570
  2571     IF NOT EMI-NO-ERRORS
  2572        GO TO 8200-SEND-DATAONLY
  2573     END-IF.
  2574
  2575     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  2576     MOVE SPACES                 TO ERRMSGBO.
  2577     GO TO 8200-SEND-DATAONLY.
  2578
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL1279.cbl
  2580 4500-SAVE-DATA.
  2581     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2582     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2583             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2584             SC-INDX > NUM-LINES-PER-SCREEN.
  2585     IF NOT EMI-NO-ERRORS
  2586        GO TO 8200-SEND-DATAONLY
  2587     END-IF.
  2588
  2589
  2590* EXEC CICS HANDLE CONDITION
  2591*         NOTFND(4610-ENDBR)
  2592*         NOTOPEN(6000-NOT-OPEN)
  2593*         ENDFILE(4610-ENDBR)
  2594*    END-EXEC.
  2595*    MOVE '"$IJ''                 ! $ #00002539' TO DFHEIV0
  2596     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  2597     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2598     MOVE X'2420233030303032353339' TO DFHEIV0(25:11)
  2599     CALL 'kxdfhei1' USING DFHEIV0
  2600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2601
  2602
  2603 4610-LOOP.
  2604
  2605* EXEC CICS READ
  2606*        DATASET (ERCNOT-FILE-ID)
  2607*        RIDFLD  (ERCNOT-KEY)
  2608*        SET     (ADDRESS OF CERT-NOTE-FILE)
  2609*        GTEQ
  2610*    END-EXEC.
  2611*    MOVE '&"S        G          (   #00002546' TO DFHEIV0
  2612     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  2613     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2614     MOVE X'2020233030303032353436' TO DFHEIV0(25:11)
  2615     CALL 'kxdfhei1' USING DFHEIV0,
  2616           ERCNOT-FILE-ID,
  2617           DFHEIV20,
  2618           DFHEIV99,
  2619           ERCNOT-KEY,
  2620           DFHEIV99,
  2621           DFHEIV99,
  2622           DFHEIV99
  2623     SET ADDRESS OF CERT-NOTE-FILE TO
  2624         DFHEIV20
  2625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2626
  2627
  2628     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  2629
  2630     IF ERCNOT-PARTIAL-KEY NOT = SV-PRIOR-KEY
  2631         MOVE SV-PRIOR-KEY       TO ERCNOT-PARTIAL-KEY
  2632         GO TO 4610-ENDBR
  2633     END-IF.
  2634
  2635
  2636* EXEC CICS DELETE
  2637*        DATASET (ERCNOT-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL1279.cbl
  2638*        RIDFLD  (ERCNOT-KEY)
  2639*    END-EXEC.
  2640*    MOVE '&(  R                 &   #00002560' TO DFHEIV0
  2641     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  2642     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2643     MOVE X'2020233030303032353630' TO DFHEIV0(25:11)
  2644     CALL 'kxdfhei1' USING DFHEIV0,
  2645           ERCNOT-FILE-ID,
  2646           ERCNOT-KEY,
  2647           DFHEIV99,
  2648           DFHEIV99,
  2649           DFHEIV99
  2650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2651
  2652
  2653     GO TO 4610-LOOP.
  2654 4610-ENDBR.
  2655
  2656* EXEC CICS GETMAIN
  2657*         LENGTH(ERCNOT-LENGTH)
  2658*         SET(ADDRESS OF CERT-NOTE-FILE)
  2659*         INITIMG(GETMAIN-SPACE)
  2660*    END-EXEC.
  2661*    MOVE ',"IL                  $   #00002567' TO DFHEIV0
  2662     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  2663     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2664     MOVE X'2020233030303032353637' TO DFHEIV0(25:11)
  2665     CALL 'kxdfhei1' USING DFHEIV0,
  2666           DFHEIV20,
  2667           ERCNOT-LENGTH,
  2668           GETMAIN-SPACE
  2669     SET ADDRESS OF CERT-NOTE-FILE TO
  2670         DFHEIV20
  2671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2672
  2673
  2674     MOVE ZERO                   TO  ERCNOT-SEQ.
  2675     MOVE ZERO                   TO  WS-BLANK-LINES.
  2676
  2677     PERFORM 4700-WRITE-FILE THRU 4799-EXIT
  2678             VARYING TB-INDX FROM 1 BY 1 UNTIL
  2679             TB-INDX > PI-TOTAL-LINES.
  2680
  2681     SUBTRACT WS-BLANK-LINES FROM PI-TOTAL-LINES.
  2682
  2683     PERFORM 4800-CERTIFICATE-UPDATE THRU 4899-EXIT.
  2684
  2685     GO TO 9410-RETURN.
  2686
  2687 4700-WRITE-FILE.
  2688     IF PI-CERT-NOTE AND REC-TEXT (TB-INDX)  EQUAL SPACES
  2689         ADD +1                  TO  WS-BLANK-LINES
  2690         GO TO 4799-EXIT
  2691     END-IF.
  2692
  2693     MOVE SPACES                 TO  CERT-NOTE-FILE.
  2694     ADD 1                       TO  ERCNOT-SEQ.
  2695     MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL1279.cbl
  2696     MOVE  'CZ'                  TO  CZ-RECORD-ID.
  2697     MOVE REC-TEXT (TB-INDX)     TO  CZ-NOTE.
  2698     MOVE REC-LAST-MAINT-BY (TB-INDX)
  2699                                 TO  CZ-LAST-MAINT-USER.
  2700     MOVE REC-LAST-MAINT-HHMMSS (TB-INDX)
  2701                                 TO  CZ-LAST-MAINT-HHMMSS.
  2702     MOVE REC-LAST-MAINT-DT (TB-INDX)
  2703                                 TO  CZ-LAST-MAINT-DT.
  2704
  2705
  2706* EXEC CICS WRITE
  2707*         DATASET(ERCNOT-FILE-ID)
  2708*         FROM(CERT-NOTE-FILE)
  2709*         RIDFLD(ERCNOT-KEY)
  2710*    END-EXEC.
  2711     MOVE LENGTH OF
  2712      CERT-NOTE-FILE
  2713       TO DFHEIV11
  2714*    MOVE '&$ L                  ''   #00002604' TO DFHEIV0
  2715     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2716     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2717     MOVE X'2020233030303032363034' TO DFHEIV0(25:11)
  2718     CALL 'kxdfhei1' USING DFHEIV0,
  2719           ERCNOT-FILE-ID,
  2720           CERT-NOTE-FILE,
  2721           DFHEIV11,
  2722           ERCNOT-KEY,
  2723           DFHEIV99,
  2724           DFHEIV99
  2725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2726
  2727 4799-EXIT.
  2728      EXIT.
  2729
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL1279.cbl
  2731 4800-CERTIFICATE-UPDATE.
  2732
  2733
  2734* EXEC CICS HANDLE CONDITION
  2735*        NOTFND   (4899-EXIT)
  2736*    END-EXEC.
  2737*    MOVE '"$I                   ! % #00002615' TO DFHEIV0
  2738     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2739     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2740     MOVE X'2520233030303032363135' TO DFHEIV0(25:11)
  2741     CALL 'kxdfhei1' USING DFHEIV0
  2742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2743
  2744
  2745
  2746* EXEC CICS READ
  2747*    EQUAL
  2748*    DATASET   (ELCERT-FILE-ID)
  2749*    SET       (ADDRESS OF CERTIFICATE-MASTER)
  2750*    RIDFLD    (ELCERT-KEY)
  2751*    UPDATE
  2752*    END-EXEC.
  2753*    MOVE '&"S        EU         (   #00002619' TO DFHEIV0
  2754     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2755     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2756     MOVE X'2020233030303032363139' TO DFHEIV0(25:11)
  2757     CALL 'kxdfhei1' USING DFHEIV0,
  2758           ELCERT-FILE-ID,
  2759           DFHEIV20,
  2760           DFHEIV99,
  2761           ELCERT-KEY,
  2762           DFHEIV99,
  2763           DFHEIV99,
  2764           DFHEIV99
  2765     SET ADDRESS OF CERTIFICATE-MASTER TO
  2766         DFHEIV20
  2767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2768
  2769
  2770     IF PI-TOTAL-LINES > 0
  2771        IF PI-CERT-NOTE
  2772           MOVE 'Y'           TO PI-CERT-NOTES-EXIST
  2773           IF CM-NOTE-SW = ' '
  2774              MOVE '1'        TO CM-NOTE-SW
  2775           ELSE
  2776             IF CM-NOTE-SW = '2'
  2777                MOVE '3'      TO CM-NOTE-SW
  2778             ELSE
  2779               IF CM-NOTE-SW = '4'
  2780                  MOVE '5'    TO CM-NOTE-SW
  2781               ELSE
  2782                 IF CM-NOTE-SW = '6'
  2783                    MOVE '7'  TO CM-NOTE-SW
  2784                 END-IF
  2785               END-IF
  2786             END-IF
  2787           END-IF
  2788        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL1279.cbl
  2789           MOVE 'Y'           TO PI-CLAIM-NOTES-EXIST
  2790           IF CM-NOTE-SW = ' '
  2791              MOVE '4'        TO CM-NOTE-SW
  2792           ELSE
  2793             IF CM-NOTE-SW = '1'
  2794                MOVE '5'      TO CM-NOTE-SW
  2795             ELSE
  2796               IF CM-NOTE-SW = '2'
  2797                  MOVE '6'    TO CM-NOTE-SW
  2798               ELSE
  2799                 IF CM-NOTE-SW = '3'
  2800                    MOVE '7'  TO CM-NOTE-SW
  2801                 END-IF
  2802               END-IF
  2803             END-IF
  2804           END-IF
  2805        END-IF
  2806     ELSE
  2807        IF PI-CERT-NOTE
  2808           MOVE 'N'           TO PI-CERT-NOTES-EXIST
  2809           IF CM-NOTE-SW = '1'
  2810              MOVE ' '        TO CM-NOTE-SW
  2811           ELSE
  2812             IF CM-NOTE-SW = '3'
  2813                MOVE '2'      TO CM-NOTE-SW
  2814             ELSE
  2815               IF CM-NOTE-SW = '5'
  2816                  MOVE '4'    TO CM-NOTE-SW
  2817               ELSE
  2818                 IF CM-NOTE-SW = '7'
  2819                    MOVE '6'  TO CM-NOTE-SW
  2820                 END-IF
  2821               END-IF
  2822             END-IF
  2823           END-IF
  2824        ELSE
  2825           MOVE 'N'           TO PI-CLAIM-NOTES-EXIST
  2826           IF CM-NOTE-SW = '4'
  2827              MOVE ' '        TO CM-NOTE-SW
  2828           ELSE
  2829             IF CM-NOTE-SW = '5'
  2830                MOVE '1'      TO CM-NOTE-SW
  2831             ELSE
  2832               IF CM-NOTE-SW = '6'
  2833                  MOVE '2'    TO CM-NOTE-SW
  2834               ELSE
  2835                 IF CM-NOTE-SW = '7'
  2836                    MOVE '3'  TO CM-NOTE-SW
  2837                 END-IF
  2838               END-IF
  2839             END-IF
  2840           END-IF
  2841        END-IF
  2842     END-IF.
  2843
  2844
  2845
  2846* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL1279.cbl
  2847*        FROM      (CERTIFICATE-MASTER)
  2848*        DATASET   (ELCERT-FILE-ID)
  2849*    END-EXEC.
  2850     MOVE LENGTH OF
  2851      CERTIFICATE-MASTER
  2852       TO DFHEIV11
  2853*    MOVE '&& L                  %   #00002702' TO DFHEIV0
  2854     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2855     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2856     MOVE X'2020233030303032373032' TO DFHEIV0(25:11)
  2857     CALL 'kxdfhei1' USING DFHEIV0,
  2858           ELCERT-FILE-ID,
  2859           CERTIFICATE-MASTER,
  2860           DFHEIV11,
  2861           DFHEIV99
  2862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2863
  2864
  2865 4899-EXIT.
  2866      EXIT.
  2867
  2868 4900-SET-NOTES-FLAG.
  2869
  2870
  2871* EXEC CICS HANDLE CONDITION
  2872*        NOTFND   (4900-EXIT)
  2873*    END-EXEC.
  2874*    MOVE '"$I                   ! & #00002712' TO DFHEIV0
  2875     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2876     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2877     MOVE X'2620233030303032373132' TO DFHEIV0(25:11)
  2878     CALL 'kxdfhei1' USING DFHEIV0
  2879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2880
  2881
  2882     MOVE SPACES                 TO  ELCERT-KEY.
  2883     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  2884     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  2885     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
  2886     MOVE PI-STATE               TO  ELCERT-STATE.
  2887     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  2888     MOVE PI-CERT-EFF-DT         TO  ELCERT-EFF-DT.
  2889     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  2890     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  2891
  2892
  2893* EXEC CICS READ
  2894*    EQUAL
  2895*    DATASET   (ELCERT-FILE-ID)
  2896*    SET       (ADDRESS OF CERTIFICATE-MASTER)
  2897*    RIDFLD    (ELCERT-KEY)
  2898*    END-EXEC.
  2899*    MOVE '&"S        E          (   #00002726' TO DFHEIV0
  2900     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2901     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2902     MOVE X'2020233030303032373236' TO DFHEIV0(25:11)
  2903     CALL 'kxdfhei1' USING DFHEIV0,
  2904           ELCERT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL1279.cbl
  2905           DFHEIV20,
  2906           DFHEIV99,
  2907           ELCERT-KEY,
  2908           DFHEIV99,
  2909           DFHEIV99,
  2910           DFHEIV99
  2911     SET ADDRESS OF CERTIFICATE-MASTER TO
  2912         DFHEIV20
  2913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2914
  2915
  2916     MOVE 'N'                    TO PI-BILLING-NOTES-EXIST
  2917                                    PI-CERT-NOTES-EXIST
  2918                                    PI-CLAIM-NOTES-EXIST.
  2919     IF CM-NOTE-SW EQUAL '2' OR '3' OR '6' OR '7'
  2920          MOVE 'Y'               TO PI-BILLING-NOTES-EXIST
  2921     END-IF.
  2922     IF CM-NOTE-SW EQUAL '1' OR '3' OR '5' OR '7'
  2923          MOVE 'Y'               TO PI-CERT-NOTES-EXIST
  2924     END-IF.
  2925     IF CM-NOTE-SW EQUAL '4' OR '5' OR '6' OR '7'
  2926          MOVE 'Y'               TO PI-CLAIM-NOTES-EXIST
  2927     END-IF.
  2928
  2929
  2930 4900-EXIT.
  2931      EXIT.
  2932
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL1279.cbl
  2934 5000-ADD-NEW-LINES.
  2935     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2936     MOVE 'N'                    TO WS-SCREEN-LINE.
  2937     MOVE 1                      TO WS-SUB.
  2938     MOVE ZERO                   TO WS-SUB1.
  2939     PERFORM VARYING SC-INDX FROM NUM-LINES-PER-SCREEN BY -1
  2940             UNTIL SCREEN-LINE-FOUND OR SC-INDX < 1
  2941         IF SC-TEXT (SC-INDX) >  SPACES
  2942             SET WS-SUB          TO SC-INDX
  2943             MOVE 'Y'            TO WS-SCREEN-LINE
  2944         END-IF
  2945     END-PERFORM.
  2946     IF PI-TOTAL-LINES = 0
  2947         MOVE 1                  TO WS-SUB1
  2948     ELSE
  2949         MOVE 2                  TO WS-SUB1
  2950     END-IF.
  2951     PERFORM VARYING SC-INDX FROM WS-SUB1 BY 1
  2952             UNTIL SC-INDX GREATER THAN WS-SUB
  2953         IF SC-TEXTL (SC-INDX) EQUAL ZEROS
  2954             MOVE 1      TO SC-TEXTL (SC-INDX)
  2955             MOVE SPACES TO SC-TEXT (SC-INDX)
  2956             MOVE LOW-VALUES TO SC-MTBY (SC-INDX)
  2957                                SC-MTDT (SC-INDX)
  2958         END-IF
  2959     END-PERFORM.
  2960     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2961             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2962             SC-INDX > NUM-LINES-PER-SCREEN.
  2963
  2964     IF NOT EMI-NO-ERRORS
  2965        GO TO 8200-SEND-DATAONLY
  2966     END-IF.
  2967
  2968     MOVE PI-TOTAL-LINES         TO  PI-CURRENT-LINE.
  2969     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  2970     MOVE LOW-VALUES             TO  EL1279AI.
  2971     SET TB-INDX TO PI-CURRENT-LINE.
  2972     MOVE 'A'                    TO FUNCTI.
  2973     MOVE -1                     TO  SC-TEXTL (2).
  2974     MOVE AL-UANON               TO  FUNCTA.
  2975     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  2976             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2977             SC-INDX > NUM-LINES-PER-SCREEN.
  2978     MOVE '1'                    TO PI-UPDATE-SW.
  2979     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL1279.cbl
  2981 5500-LOOKUP.
  2982     PERFORM 7500-READ-TS THRU 7599-EXIT.
  2983     SET TB-INDX TO PI-CURRENT-LINE.
  2984     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2985             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2986             SC-INDX > NUM-LINES-PER-SCREEN.
  2987
  2988     IF NOT EMI-NO-ERRORS
  2989        GO TO 8200-SEND-DATAONLY
  2990     END-IF.
  2991
  2992     MOVE LINE1I                 TO  PI-CURRENT-LINE.
  2993     SET TB-INDX                 TO PI-CURRENT-LINE.
  2994     MOVE LOW-VALUES             TO  EL1279AI.
  2995     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  2996             VARYING SC-INDX FROM 1 BY 1
  2997             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  2998     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  2999     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL1279.cbl
  3001 6000-NOT-OPEN.
  3002     MOVE ER-2954                TO  EMI-ERROR.
  3003     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3004
  3005     IF EIBAID = DFHCLEAR
  3006         GO TO 9410-RETURN
  3007     ELSE
  3008         GO TO 8100-SEND-INITIAL-MAP
  3009     END-IF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL1279.cbl
  3011 7000-BUILD-TABLE.
  3012
  3013     SET TB-INDX TO 1.
  3014     MOVE ZEROS                  TO  PI-TOTAL-LINES
  3015                                     PI-CURRENT-LINE
  3016                                     PI-TEMP-STOR-ITEMS
  3017                                     PI-UPDATE-SW.
  3018     MOVE LOW-VALUES             TO  EL1279AI.
  3019
  3020****IF TEMP STORAGE EXISTS, DELETE IT.
  3021     IF PI-CHANGE-IN-NOTE-TYPE
  3022         MOVE 'N' TO PI-SET-NOTE-CHANGE
  3023     ELSE
  3024         PERFORM 7500-READ-TS THRU 7599-EXIT
  3025     END-IF.
  3026
  3027     IF PI-TEMP-STOR-ITEMS NOT = ZERO
  3028        PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT
  3029     END-IF.
  3030
  3031
  3032* EXEC CICS HANDLE CONDITION
  3033*         NOTFND(7010-ENDBR)
  3034*         NOTOPEN(6000-NOT-OPEN)
  3035*         ENDFILE(7010-ENDBR)
  3036*    END-EXEC.
  3037*    MOVE '"$IJ''                 ! '' #00002848' TO DFHEIV0
  3038     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  3039     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3040     MOVE X'2720233030303032383438' TO DFHEIV0(25:11)
  3041     CALL 'kxdfhei1' USING DFHEIV0
  3042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3043
  3044
  3045
  3046* EXEC CICS STARTBR
  3047*         DATASET(ERCNOT-FILE-ID)
  3048*         RIDFLD(ERCNOT-KEY)
  3049*         KEYLENGTH(ERCNOT-START-LENGTH)
  3050*         GENERIC
  3051*         GTEQ
  3052*    END-EXEC.
  3053     MOVE 0
  3054       TO DFHEIV11
  3055*    MOVE '&,   KG    G          &   #00002854' TO DFHEIV0
  3056     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3057     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3058     MOVE X'2020233030303032383534' TO DFHEIV0(25:11)
  3059     CALL 'kxdfhei1' USING DFHEIV0,
  3060           ERCNOT-FILE-ID,
  3061           ERCNOT-KEY,
  3062           ERCNOT-START-LENGTH,
  3063           DFHEIV11,
  3064           DFHEIV99
  3065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3066
  3067
  3068 7001-LOOP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL1279.cbl
  3069
  3070* EXEC CICS READNEXT
  3071*         SET(ADDRESS OF CERT-NOTE-FILE)
  3072*         DATASET(ERCNOT-FILE-ID)
  3073*         RIDFLD(ERCNOT-KEY)
  3074*    END-EXEC.
  3075     MOVE 0
  3076       TO DFHEIV11
  3077*    MOVE '&.S                   )   #00002863' TO DFHEIV0
  3078     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3079     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3080     MOVE X'2020233030303032383633' TO DFHEIV0(25:11)
  3081     CALL 'kxdfhei1' USING DFHEIV0,
  3082           ERCNOT-FILE-ID,
  3083           DFHEIV20,
  3084           DFHEIV99,
  3085           ERCNOT-KEY,
  3086           DFHEIV99,
  3087           DFHEIV11,
  3088           DFHEIV99,
  3089           DFHEIV99
  3090     SET ADDRESS OF CERT-NOTE-FILE TO
  3091         DFHEIV20
  3092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3093
  3094
  3095     IF CZ-COMPANY-CD NOT = SV-COMPANY-CD
  3096         GO TO 7010-ENDBR
  3097     END-IF.
  3098
  3099     IF (CZ-CARRIER = SV-CARRIER)
  3100        AND (CZ-GROUPING = SV-GROUPING)
  3101        AND (CZ-STATE = SV-STATE)
  3102        AND (CZ-ACCOUNT = SV-ACCOUNT)
  3103        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  3104        AND (CZ-CERT-NO = SV-CERT-NO)
  3105        AND (CZ-RECORD-TYPE = PI-CURR-NOTE-REC-TYPE)
  3106          MOVE CZ-NOTE TO REC-TEXT (TB-INDX)
  3107          MOVE CZ-LAST-MAINT-USER TO REC-LAST-MAINT-BY (TB-INDX)
  3108          MOVE CZ-LAST-MAINT-DT TO REC-LAST-MAINT-DT (TB-INDX)
  3109          MOVE CZ-LAST-MAINT-HHMMSS TO
  3110                         REC-LAST-MAINT-HHMMSS (TB-INDX)
  3111          SET TB-INDX UP BY 1
  3112          GO TO 7001-LOOP
  3113     END-IF.
  3114 7010-ENDBR.
  3115     IF TB-INDX = 1
  3116         MOVE ER-0006            TO EMI-ERROR
  3117         MOVE 'A'                TO FUNCTI
  3118         MOVE -1                 TO SC-TEXTL (1)
  3119         MOVE AL-UANON           TO FUNCTA
  3120         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3121         MOVE ZEROS              TO PI-TOTAL-LINES
  3122         GO TO 8100-SEND-INITIAL-MAP
  3123     END-IF.
  3124
  3125
  3126* EXEC CICS ENDBR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL1279.cbl
  3127*         DATASET(ERCNOT-FILE-ID)
  3128*    END-EXEC.
  3129     MOVE 0
  3130       TO DFHEIV11
  3131*    MOVE '&2                    $   #00002899' TO DFHEIV0
  3132     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3133     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3134     MOVE X'2020233030303032383939' TO DFHEIV0(25:11)
  3135     CALL 'kxdfhei1' USING DFHEIV0,
  3136           ERCNOT-FILE-ID,
  3137           DFHEIV11,
  3138           DFHEIV99
  3139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3140
  3141
  3142     SET TB-INDX DOWN BY 1.
  3143     SET PI-TOTAL-LINES TO TB-INDX.
  3144     MOVE 1                      TO PI-CURRENT-LINE.
  3145
  3146 7050-FORMAT-LINES.
  3147     SET TB-INDX TO PI-CURRENT-LINE.
  3148     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3149             VARYING SC-INDX FROM 1
  3150             BY 1 UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  3151     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3152     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL1279.cbl
  3154 7100-FORMAT-SCREEN.
  3155     IF TB-INDX > PI-TOTAL-LINES
  3156        IF FUNCTI NOT = 'A'
  3157           MOVE AL-PANON         TO SC-TEXTA (SC-INDX)
  3158        END-IF
  3159     END-IF.
  3160
  3161     IF TB-INDX > PI-TOTAL-LINES
  3162         GO TO 7100-EXIT
  3163     END-IF.
  3164
  3165     SET WS-LINE TO TB-INDX.
  3166     MOVE WS-LINE TO SC-LIN (SC-INDX).
  3167     MOVE REC-TEXT (TB-INDX)     TO SC-TEXT (SC-INDX).
  3168     MOVE REC-LAST-MAINT-BY (TB-INDX) TO SC-MTBY (SC-INDX).
  3169     MOVE REC-LAST-MAINT-DT (TB-INDX) TO DC-BIN-DATE-1.
  3170     MOVE ' '                    TO DC-OPTION-CODE.
  3171     PERFORM 9700-LINK-DATE-CONVERT.
  3172     MOVE DC-GREG-DATE-1-MDY     TO SC-MTDT (SC-INDX).
  3173     SET ROLL-COUNTER TO TB-INDX.
  3174
  3175     IF NOT MODIFY-CAP
  3176         MOVE AL-PANOF           TO SC-TEXTA (SC-INDX)
  3177         SET TB-INDX UP BY 1
  3178         GO TO 7100-EXIT
  3179     END-IF.
  3180
  3181     SET TB-INDX UP BY 1.
  3182
  3183 7100-EXIT.
  3184      EXIT.
  3185
  3186 7200-PUT-TEMP-STOR.
  3187     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  3188     SET TS-INDX TO 1.
  3189     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
  3190     PERFORM 7300-WRITE-TS THRU 7399-EXIT
  3191             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
  3192             UNTIL TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
  3193 7249-EXIT.
  3194      EXIT.
  3195 7250-DELETE-TEMP-STOR.
  3196
  3197* EXEC CICS HANDLE CONDITION
  3198*         QIDERR(7299-EXIT)
  3199*    END-EXEC.
  3200*    MOVE '"$N                   ! ( #00002957' TO DFHEIV0
  3201     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  3202     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3203     MOVE X'2820233030303032393537' TO DFHEIV0(25:11)
  3204     CALL 'kxdfhei1' USING DFHEIV0
  3205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3206
  3207
  3208* EXEC CICS DELETEQ TS
  3209*         QUEUE(QID)
  3210*    END-EXEC.
  3211*    MOVE '*&                    #   #00002960' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL1279.cbl
  3212     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  3213     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3214     MOVE X'2020233030303032393630' TO DFHEIV0(25:11)
  3215     CALL 'kxdfhei1' USING DFHEIV0,
  3216           QID,
  3217           DFHEIV99
  3218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3219
  3220 7299-EXIT.
  3221     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL1279.cbl
  3223 7300-WRITE-TS.
  3224     MOVE TS-GROUP (TS-INDX)     TO TS-WORK-AREA.
  3225     SET TS-INDX UP BY 1.
  3226     ADD 1 TO PI-TEMP-STOR-ITEMS.
  3227
  3228* EXEC CICS WRITEQ TS
  3229*         FROM(TS-WORK-AREA)
  3230*         QUEUE(QID)
  3231*         LENGTH(TS-LENGTH)
  3232*         ITEM(PI-TEMP-STOR-ITEMS)
  3233*    END-EXEC.
  3234*    MOVE '*" I                  ''   #00002970' TO DFHEIV0
  3235     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  3236     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3237     MOVE X'2020233030303032393730' TO DFHEIV0(25:11)
  3238     CALL 'kxdfhei1' USING DFHEIV0,
  3239           QID,
  3240           TS-WORK-AREA,
  3241           TS-LENGTH,
  3242           PI-TEMP-STOR-ITEMS,
  3243           DFHEIV99,
  3244           DFHEIV99
  3245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3246
  3247 7399-EXIT.
  3248     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL1279.cbl
  3250 7400-PAGE-ROUTINE.
  3251
  3252     IF PFENTERL NOT = ZEROS
  3253        MOVE -1                  TO PFENTERL
  3254        ELSE
  3255        MOVE -1                  TO FUNCTL
  3256     END-IF.
  3257
  3258     IF PI-TOTAL-LINES = 0
  3259        MOVE ER-0047             TO EMI-ERROR
  3260        MOVE -1                  TO FUNCTL
  3261        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3262        GO TO 8200-SEND-DATAONLY
  3263     END-IF.
  3264
  3265     COMPUTE TEMP-CURR-LINE = PI-CURRENT-LINE + ROLL-COUNTER.
  3266
  3267     IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
  3268        MOVE ER-0067             TO EMI-ERROR
  3269        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3270        MOVE 1 TO TEMP-CURR-LINE
  3271     END-IF.
  3272
  3273     IF TEMP-CURR-LINE GREATER THAN PI-TOTAL-LINES
  3274        MOVE ER-0066             TO EMI-ERROR
  3275        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3276        COMPUTE TEMP-CURR-LINE = PI-TOTAL-LINES + 1
  3277                               - NUM-LINES-PER-SCREEN
  3278        IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
  3279           MOVE 1                TO TEMP-CURR-LINE
  3280        END-IF
  3281     END-IF.
  3282
  3283     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  3284     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3285             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3286             SC-INDX > NUM-LINES-PER-SCREEN.
  3287
  3288     IF EMI-ERROR = ER-0066 OR = ER-0067 OR = ZEROS
  3289        NEXT SENTENCE
  3290     ELSE
  3291        GO TO 8200-SEND-DATAONLY
  3292     END-IF.
  3293
  3294     MOVE TEMP-CURR-LINE         TO PI-CURRENT-LINE.
  3295     SET TB-INDX TO PI-CURRENT-LINE.
  3296     MOVE LOW-VALUES             TO EL1279AI.
  3297     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3298             VARYING SC-INDX FROM 1 BY 1
  3299             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  3300     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3301     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL1279.cbl
  3303
  3304 7450-SET-INDX.
  3305     IF PI-CURRENT-LINE = 0 AND PI-TOTAL-LINES = 0
  3306        SET TB-INDX TO 1
  3307     ELSE
  3308        PERFORM 7500-READ-TS THRU 7599-EXIT
  3309        IF PI-CURRENT-LINE = 0
  3310           SET TB-INDX TO 1
  3311        ELSE
  3312           SET TB-INDX TO PI-CURRENT-LINE
  3313        END-IF
  3314     END-IF.
  3315 7450-EXIT.
  3316      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL1279.cbl
  3318 7500-READ-TS.
  3319
  3320* EXEC CICS HANDLE CONDITION
  3321*         QIDERR(7590-TS-QIDERR)
  3322*         ITEMERR(7585-QID-ITEMERR)
  3323*    END-EXEC.
  3324*    MOVE '"$N<                  ! ) #00003048' TO DFHEIV0
  3325     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  3326     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3327     MOVE X'2920233030303033303438' TO DFHEIV0(25:11)
  3328     CALL 'kxdfhei1' USING DFHEIV0
  3329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3330
  3331     SET TS-INDX TO 1.
  3332     MOVE 1                      TO QID-ITEM.
  3333 7501-LOOP.
  3334
  3335* EXEC CICS READQ TS
  3336*         INTO(TS-WORK-AREA)
  3337*         QUEUE(QID)
  3338*         LENGTH(TS-LENGTH)
  3339*         ITEM(QID-ITEM)
  3340*    END-EXEC.
  3341*    MOVE '*$II   L              ''   #00003055' TO DFHEIV0
  3342     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3343     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3344     MOVE X'2020233030303033303535' TO DFHEIV0(25:11)
  3345     CALL 'kxdfhei1' USING DFHEIV0,
  3346           QID,
  3347           TS-WORK-AREA,
  3348           TS-LENGTH,
  3349           QID-ITEM,
  3350           DFHEIV99,
  3351           DFHEIV99
  3352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3353
  3354     MOVE TS-WORK-AREA           TO TS-GROUP (TS-INDX).
  3355     SET TS-INDX UP BY 1.
  3356     ADD 1 TO QID-ITEM.
  3357     GO TO 7501-LOOP.
  3358
  3359 7585-QID-ITEMERR.
  3360     IF EIBTRNID NOT = TRANS-ID
  3361        SUBTRACT 1 FROM QID-ITEM
  3362        MOVE QID-ITEM            TO PI-TEMP-STOR-ITEMS
  3363     END-IF.
  3364     GO TO 7599-EXIT.
  3365
  3366 7590-TS-QIDERR.
  3367     IF EIBTRNID = TRANS-ID
  3368        AND EIBAID = DFHCLEAR
  3369           GO TO 9410-RETURN
  3370     END-IF.
  3371     IF EIBTRNID = TRANS-ID
  3372        MOVE ER-0033             TO EMI-ERROR
  3373        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3374        GO TO 8100-SEND-INITIAL-MAP
  3375     END-IF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL1279.cbl
  3376
  3377 7599-EXIT.
  3378      EXIT.
  3379
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL1279.cbl
  3381 7600-UPDATE-TABLE-FROM-SCREEN.
  3382
  3383     IF SC-TEXTL (SC-INDX) NOT = ZEROS
  3384         IF TB-INDX NOT > PI-TOTAL-LINES
  3385             PERFORM 7700-MOVE-DATA THRU 7700-EXIT
  3386             SET TB-INDX UP BY 1
  3387         ELSE
  3388             IF PI-TOTAL-LINES = MAX-LINES
  3389                 MOVE ER-0051    TO EMI-ERROR
  3390                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3391                 GO TO 8200-SEND-DATAONLY
  3392             ELSE
  3393                 PERFORM 7700-MOVE-DATA THRU 7700-EXIT
  3394                 SET TB-INDX UP BY 1
  3395                 ADD 1 TO PI-TOTAL-LINES
  3396             END-IF
  3397         END-IF
  3398     ELSE
  3399        IF TB-INDX NOT > PI-TOTAL-LINES
  3400           SET TB-INDX UP BY 1
  3401        END-IF
  3402     END-IF.
  3403
  3404 7699-EXIT.
  3405      EXIT.
  3406
  3407 7700-MOVE-DATA.
  3408     MOVE '1'                    TO PI-UPDATE-SW.
  3409
  3410     IF SC-TEXTL (SC-INDX) NOT = ZEROS
  3411        MOVE SC-TEXT (SC-INDX)  TO REC-TEXT (TB-INDX)
  3412        MOVE PI-PROCESSOR-ID    TO REC-LAST-MAINT-BY (TB-INDX)
  3413        MOVE EIBTIME            TO REC-LAST-MAINT-HHMMSS (TB-INDX)
  3414        MOVE SAVE-BIN-DATE      TO REC-LAST-MAINT-DT (TB-INDX)
  3415     END-IF.
  3416
  3417 7700-EXIT.
  3418      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL1279.cbl
  3420 8100-SEND-INITIAL-MAP.
  3421     MOVE SAVE-DATE              TO DATEO.
  3422     MOVE EIBTIME                TO TIME-IN.
  3423     MOVE TIME-OUT               TO TIMEO.
  3424     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  3425     MOVE PI-PROCESSOR-ID        TO USERIDO.
  3426     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGBO.
  3427     MOVE PI-CARRIER             TO FCARRIRO.
  3428     MOVE PI-GROUPING            TO FGROUPO.
  3429     MOVE PI-STATE               TO FSTO.
  3430     MOVE PI-ACCOUNT             TO FACOUNTO.
  3431     MOVE PI-CERT-PRIME          TO FCERTO.
  3432     MOVE PI-CERT-SFX            TO FCRTSFXO.
  3433     MOVE  ' '                   TO DC-OPTION-CODE.
  3434     MOVE PI-CERT-EFF-DT         TO DC-BIN-DATE-1.
  3435     PERFORM 9700-LINK-DATE-CONVERT.
  3436     MOVE DC-GREG-DATE-1-EDIT    TO FEFFDTO.
  3437     MOVE PI-TOTAL-LINES         TO TOTO.
  3438     IF PI-CLAIM-NOTE
  3439         MOVE SCR-CLAIM-NOTE-TYPE TO FTYPEO
  3440         MOVE SCR-PF6-CERT        TO PF6NOTEO
  3441         MOVE SCR-CERT-YN         TO FTYPEYNO
  3442         IF PI-CERT-NOTES-EXIST = 'Y'
  3443             MOVE 'YES'           TO FCERTYNO
  3444         ELSE
  3445             MOVE 'NO '           TO FCERTYNO
  3446         END-IF
  3447     ELSE
  3448         MOVE SCR-CERT-NOTE-TYPE TO FTYPEO
  3449         MOVE SCR-PF6-CLAIM      TO PF6NOTEO
  3450         MOVE SCR-CLAIM-YN       TO FTYPEYNO
  3451         IF PI-CLAIM-NOTES-EXIST = 'Y'
  3452             MOVE 'YES'           TO FCERTYNO
  3453         ELSE
  3454             MOVE 'NO '           TO FCERTYNO
  3455         END-IF
  3456     END-IF.
  3457     IF PI-BILLING-NOTES-EXIST = 'Y'
  3458         MOVE 'YES'           TO FBILLYNO
  3459     ELSE
  3460         MOVE 'NO '           TO FBILLYNO
  3461     END-IF
  3462
  3463     MOVE -1                     TO FUNCTL.
  3464
  3465
  3466* EXEC CICS SEND
  3467*         MAP(MAP-NAME)
  3468*         MAPSET(MAPSET-NAME)
  3469*         FROM(EL1279AO)
  3470*         ERASE
  3471*         CURSOR
  3472*    END-EXEC.
  3473     MOVE LENGTH OF
  3474      EL1279AO
  3475       TO DFHEIV12
  3476     MOVE -1
  3477       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL1279.cbl
  3478*    MOVE '8$     CT  E    H L F ,   #00003172' TO DFHEIV0
  3479     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3480     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3481     MOVE X'2020233030303033313732' TO DFHEIV0(25:11)
  3482     CALL 'kxdfhei1' USING DFHEIV0,
  3483           MAP-NAME,
  3484           EL1279AO,
  3485           DFHEIV12,
  3486           MAPSET-NAME,
  3487           DFHEIV99,
  3488           DFHEIV99,
  3489           DFHEIV99,
  3490           DFHEIV11,
  3491           DFHEIV99,
  3492           DFHEIV99,
  3493           DFHEIV99
  3494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3495
  3496
  3497     GO TO 9100-RETURN-TRAN.
  3498
  3499 8200-SEND-DATAONLY.
  3500     MOVE EIBTIME                TO TIME-IN.
  3501     MOVE TIME-OUT               TO TIMEO.
  3502     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  3503     MOVE PI-PROCESSOR-ID        TO USERIDO.
  3504     MOVE PI-TOTAL-LINES         TO TOTO.
  3505
  3506     IF NOT EMI-NO-ERRORS
  3507        MOVE EMI-MESSAGE-AREA (1) TO ERRMSGBO
  3508     ELSE
  3509        MOVE -1                  TO FUNCTL
  3510     END-IF.
  3511
  3512
  3513* EXEC CICS SEND
  3514*         MAP(MAP-NAME)
  3515*         MAPSET(MAPSET-NAME)
  3516*         FROM(EL1279AO)
  3517*         DATAONLY
  3518*         CURSOR
  3519*    END-EXEC.
  3520     MOVE LENGTH OF
  3521      EL1279AO
  3522       TO DFHEIV12
  3523     MOVE -1
  3524       TO DFHEIV11
  3525*    MOVE '8$D    CT       H L F ,   #00003195' TO DFHEIV0
  3526     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3527     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3528     MOVE X'2020233030303033313935' TO DFHEIV0(25:11)
  3529     CALL 'kxdfhei1' USING DFHEIV0,
  3530           MAP-NAME,
  3531           EL1279AO,
  3532           DFHEIV12,
  3533           MAPSET-NAME,
  3534           DFHEIV99,
  3535           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL1279.cbl
  3536           DFHEIV99,
  3537           DFHEIV11,
  3538           DFHEIV99,
  3539           DFHEIV99,
  3540           DFHEIV99
  3541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3542
  3543
  3544     GO TO 9100-RETURN-TRAN.
  3545
  3546 8300-SEND-TEXT.
  3547
  3548* EXEC CICS SEND TEXT
  3549*         FROM(LOGOFF-TEXT)
  3550*         ERASE
  3551*         FREEKB
  3552*         LENGTH(LOGOFF-LENGTH)
  3553*    END-EXEC.
  3554*    MOVE '8&      T  E F  H   F -   #00003206' TO DFHEIV0
  3555     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3556     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3557     MOVE X'2020233030303033323036' TO DFHEIV0(25:11)
  3558     CALL 'kxdfhei1' USING DFHEIV0,
  3559           LOGOFF-TEXT,
  3560           LOGOFF-LENGTH,
  3561           DFHEIV99,
  3562           DFHEIV99,
  3563           DFHEIV99,
  3564           DFHEIV99,
  3565           DFHEIV99,
  3566           DFHEIV99,
  3567           DFHEIV99,
  3568           DFHEIV99,
  3569           DFHEIV99,
  3570           DFHEIV99
  3571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3572
  3573
  3574     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  3575
  3576
  3577* EXEC CICS RETURN
  3578*    END-EXEC.
  3579*    MOVE '.(                    &   #00003215' TO DFHEIV0
  3580     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3581     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3582     MOVE X'2020233030303033323135' TO DFHEIV0(25:11)
  3583     CALL 'kxdfhei1' USING DFHEIV0,
  3584           DFHEIV99,
  3585           DFHEIV99,
  3586           DFHEIV99,
  3587           DFHEIV99,
  3588           DFHEIV99
  3589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3590
  3591
  3592 8800-UNAUTHORIZED-ACCESS.
  3593     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL1279.cbl
  3594     GO TO 8300-SEND-TEXT.
  3595
  3596 9000-RETURN-CICS.
  3597     IF PI-CHANGES-MADE
  3598        MOVE ER-0045             TO EMI-ERROR
  3599        MOVE -1                  TO FUNCTL
  3600        MOVE SPACES              TO PFENTERO
  3601        MOVE AL-UNNOF            TO PFENTERA
  3602        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3603        GO TO 8200-SEND-DATAONLY
  3604     END-IF.
  3605
  3606     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  3607     MOVE XCTL-005               TO PGM-NAME.
  3608     GO TO 9300-XCTL.
  3609
  3610 9100-RETURN-TRAN.
  3611     MOVE SCRN-NUMBER            TO PI-CURRENT-SCREEN-NO.
  3612     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  3613
  3614* EXEC CICS RETURN
  3615*         TRANSID(TRANS-ID)
  3616*         COMMAREA(PROGRAM-INTERFACE-BLOCK)
  3617*         LENGTH(PI-COMM-LENGTH)
  3618*    END-EXEC.
  3619*    MOVE '.(CT                  &   #00003239' TO DFHEIV0
  3620     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3621     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3622     MOVE X'2020233030303033323339' TO DFHEIV0(25:11)
  3623     CALL 'kxdfhei1' USING DFHEIV0,
  3624           TRANS-ID,
  3625           PROGRAM-INTERFACE-BLOCK,
  3626           PI-COMM-LENGTH,
  3627           DFHEIV99,
  3628           DFHEIV99
  3629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3630
  3631
  3632
  3633 9200-RETURN-MAIN-MENU.
  3634     IF PI-CHANGES-MADE
  3635        MOVE -1                  TO FUNCTL
  3636        MOVE SPACES              TO PFENTERO
  3637        MOVE AL-UNNOF            TO PFENTERA
  3638        MOVE ER-0045             TO EMI-ERROR
  3639        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3640        GO TO 8200-SEND-DATAONLY
  3641     END-IF.
  3642
  3643     MOVE XCTL-126               TO PGM-NAME.
  3644
  3645 9300-XCTL.
  3646     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  3647
  3648* EXEC CICS XCTL
  3649*         PROGRAM  (PGM-NAME)
  3650*         COMMAREA (PROGRAM-INTERFACE-BLOCK)
  3651*         LENGTH   (PI-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL1279.cbl
  3652*    END-EXEC.
  3653*    MOVE '.$C                   $   #00003260' TO DFHEIV0
  3654     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3655     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3656     MOVE X'2020233030303033323630' TO DFHEIV0(25:11)
  3657     CALL 'kxdfhei1' USING DFHEIV0,
  3658           PGM-NAME,
  3659           PROGRAM-INTERFACE-BLOCK,
  3660           PI-COMM-LENGTH
  3661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3662
  3663
  3664 9400-CLEAR.
  3665
  3666     IF PI-CHANGES-MADE
  3667         MOVE ER-0045            TO EMI-ERROR
  3668         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3669         IF PI-CURRENT-LINE GREATER THAN ZERO
  3670             PERFORM 7500-READ-TS THRU 7599-EXIT
  3671             SET TB-INDX TO PI-CURRENT-LINE
  3672             PERFORM 7100-FORMAT-SCREEN  THRU  7100-EXIT
  3673                 VARYING SC-INDX FROM 1 BY 1 UNTIL
  3674                 SC-INDX GREATER NUM-LINES-PER-SCREEN
  3675         END-IF
  3676         GO TO 8100-SEND-INITIAL-MAP
  3677     END-IF.
  3678
  3679 9410-RETURN.
  3680     IF PF5-PRESSED
  3681         MOVE PGM-EL1276           TO PGM-NAME
  3682     ELSE
  3683         IF PF6-PRESSED
  3684             IF PI-CLAIM-NOTE
  3685                 SET PI-CERT-NOTE  TO TRUE
  3686             ELSE
  3687                 SET PI-CLAIM-NOTE TO TRUE
  3688             END-IF
  3689             SET PI-CHANGE-IN-NOTE-TYPE TO TRUE
  3690             MOVE 'N'              TO PI-PF6-PRESSED
  3691             GO TO 1000-START
  3692         ELSE
  3693             MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME
  3694         END-IF
  3695     END-IF.
  3696     GO TO 9300-XCTL.
  3697
  3698 9500-PF12.
  3699     IF PI-CHANGES-MADE
  3700        MOVE -1                  TO FUNCTL
  3701        MOVE SPACES              TO PFENTERO
  3702        MOVE AL-UNNOF            TO PFENTERA
  3703        MOVE ER-0045             TO EMI-ERROR
  3704        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3705        GO TO 8200-SEND-DATAONLY
  3706     END-IF.
  3707
  3708     MOVE 'EL010'                TO PGM-NAME.
  3709     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL1279.cbl
  3710
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL1279.cbl
  3712
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL1279.cbl
  3714 9600-PGMID-ERROR.
  3715
  3716* EXEC CICS HANDLE CONDITION
  3717*         PGMIDERR(8300-SEND-TEXT)
  3718*    END-EXEC.
  3719*    MOVE '"$L                   ! * #00003317' TO DFHEIV0
  3720     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3721     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3722     MOVE X'2A20233030303033333137' TO DFHEIV0(25:11)
  3723     CALL 'kxdfhei1' USING DFHEIV0
  3724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3725
  3726
  3727     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  3728     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  3729     MOVE XCTL-005               TO  PGM-NAME.
  3730     MOVE PGM-NAME               TO  LOGOFF-PGM.
  3731     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  3732
  3733     GO TO 9300-XCTL.
  3734
  3735 9700-LINK-DATE-CONVERT.
  3736
  3737     MOVE LINK-ELDATCV           TO  PGM-NAME.
  3738
  3739* EXEC CICS LINK
  3740*        PROGRAM    (PGM-NAME)
  3741*        COMMAREA   (DATE-CONVERSION-DATA)
  3742*        LENGTH     (DC-COMM-LENGTH)
  3743*    END-EXEC.
  3744*    MOVE '."C                   ''   #00003332' TO DFHEIV0
  3745     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3746     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3747     MOVE X'2020233030303033333332' TO DFHEIV0(25:11)
  3748     CALL 'kxdfhei1' USING DFHEIV0,
  3749           PGM-NAME,
  3750           DATE-CONVERSION-DATA,
  3751           DC-COMM-LENGTH,
  3752           DFHEIV99,
  3753           DFHEIV99,
  3754           DFHEIV99
  3755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3756
  3757
  3758 9700-EXIT.
  3759     EXIT.
  3760
  3761 9900-ERROR-FORMAT.
  3762     IF NOT EMI-ERRORS-COMPLETE
  3763        MOVE LINK-001            TO  PGM-NAME
  3764
  3765* EXEC CICS LINK
  3766*            PROGRAM(PGM-NAME)
  3767*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  3768*            LENGTH(EMI-COMM-LENGTH)
  3769*       END-EXEC
  3770*    MOVE '."C                   ''   #00003344' TO DFHEIV0
  3771     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL1279.cbl
  3772     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3773     MOVE X'2020233030303033333434' TO DFHEIV0(25:11)
  3774     CALL 'kxdfhei1' USING DFHEIV0,
  3775           PGM-NAME,
  3776           ERROR-MESSAGE-INTERFACE-BLOCK,
  3777           EMI-COMM-LENGTH,
  3778           DFHEIV99,
  3779           DFHEIV99,
  3780           DFHEIV99
  3781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3782     END-IF.
  3783 9900-EXIT.
  3784     EXIT.
  3785
  3786 9990-ABEND.
  3787     MOVE LINK-004               TO  PGM-NAME.
  3788     MOVE DFHEIBLK               TO  EMI-LINE1.
  3789
  3790
  3791* EXEC CICS LINK
  3792*        PROGRAM   (PGM-NAME)
  3793*        COMMAREA  (EMI-LINE1)
  3794*        LENGTH    (72)
  3795*    END-EXEC.
  3796     MOVE 72
  3797       TO DFHEIV11
  3798*    MOVE '."C                   ''   #00003357' TO DFHEIV0
  3799     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3800     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3801     MOVE X'2020233030303033333537' TO DFHEIV0(25:11)
  3802     CALL 'kxdfhei1' USING DFHEIV0,
  3803           PGM-NAME,
  3804           EMI-LINE1,
  3805           DFHEIV11,
  3806           DFHEIV99,
  3807           DFHEIV99,
  3808           DFHEIV99
  3809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3810
  3811
  3812     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSGBO.
  3813     MOVE -1                     TO  FUNCTL.
  3814
  3815     GO TO 8100-SEND-INITIAL-MAP.
  3816
  3817
  3818* GOBACK.
  3819     MOVE '9%                    "   ' TO DFHEIV0
  3820     MOVE 'EL1279' TO DFHEIV1
  3821     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3822     GOBACK.
  3823
  3824 9995-SECURITY-VIOLATION.
  3825*                                COPY ELCSCTP.
  3826******************************************************************
  3827*                                                                *
  3828*                            ELCSCTP                             *
  3829*                            VMOD=2.001                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL1279.cbl
  3830*                                                                *
  3831*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3832******************************************************************
  3833
  3834
  3835     MOVE EIBDATE          TO SM-JUL-DATE.
  3836     MOVE EIBTRMID         TO SM-TERMID.
  3837     MOVE THIS-PGM         TO SM-PGM.
  3838     MOVE EIBTIME          TO TIME-IN.
  3839     MOVE TIME-OUT         TO SM-TIME.
  3840     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3841
  3842
  3843* EXEC CICS LINK
  3844*         PROGRAM  ('EL003')
  3845*         COMMAREA (SECURITY-MESSAGE)
  3846*         LENGTH   (80)
  3847*    END-EXEC.
  3848     MOVE 'EL003' TO DFHEIV1
  3849     MOVE 80
  3850       TO DFHEIV11
  3851*    MOVE '."C                   ''   #00003388' TO DFHEIV0
  3852     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3853     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3854     MOVE X'2020233030303033333838' TO DFHEIV0(25:11)
  3855     CALL 'kxdfhei1' USING DFHEIV0,
  3856           DFHEIV1,
  3857           SECURITY-MESSAGE,
  3858           DFHEIV11,
  3859           DFHEIV99,
  3860           DFHEIV99,
  3861           DFHEIV99
  3862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3863
  3864
  3865******************************************************************
  3866
  3867
  3868 9995-EXIT.
  3869     EXIT.
  3870
  3871 9999-DFHBACK SECTION.
  3872     MOVE '9%                    "   ' TO DFHEIV0
  3873     MOVE 'EL1279' TO DFHEIV1
  3874     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3875     GOBACK.
  3876 9999-DFHEXIT.
  3877     IF DFHEIGDJ EQUAL 0001
  3878         NEXT SENTENCE
  3879     ELSE IF DFHEIGDJ EQUAL 2
  3880         GO TO 9400-CLEAR
  3881         DEPENDING ON DFHEIGDI
  3882     ELSE IF DFHEIGDJ EQUAL 3
  3883         GO TO 9990-ABEND,
  3884               9600-PGMID-ERROR
  3885         DEPENDING ON DFHEIGDI
  3886     ELSE IF DFHEIGDJ EQUAL 4
  3887         GO TO 4610-ENDBR,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL1279.cbl
  3888               6000-NOT-OPEN,
  3889               4610-ENDBR
  3890         DEPENDING ON DFHEIGDI
  3891     ELSE IF DFHEIGDJ EQUAL 5
  3892         GO TO 4899-EXIT
  3893         DEPENDING ON DFHEIGDI
  3894     ELSE IF DFHEIGDJ EQUAL 6
  3895         GO TO 4900-EXIT
  3896         DEPENDING ON DFHEIGDI
  3897     ELSE IF DFHEIGDJ EQUAL 7
  3898         GO TO 7010-ENDBR,
  3899               6000-NOT-OPEN,
  3900               7010-ENDBR
  3901         DEPENDING ON DFHEIGDI
  3902     ELSE IF DFHEIGDJ EQUAL 8
  3903         GO TO 7299-EXIT
  3904         DEPENDING ON DFHEIGDI
  3905     ELSE IF DFHEIGDJ EQUAL 9
  3906         GO TO 7590-TS-QIDERR,
  3907               7585-QID-ITEMERR
  3908         DEPENDING ON DFHEIGDI
  3909     ELSE IF DFHEIGDJ EQUAL 10
  3910         GO TO 8300-SEND-TEXT
  3911         DEPENDING ON DFHEIGDI.
  3912     MOVE '9%                    "   ' TO DFHEIV0
  3913     MOVE 'EL1279' TO DFHEIV1
  3914     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3915     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       30584     Code:       12352
