* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page   1
* EL1501.cbl
* Options: int("EL1501.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1501.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1501.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1501.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1501.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/01/95 15:33:51.
     7*                            VMOD=2.030.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*REMARKS.    TRANSACTION - EXH9 - CLAIM HISTORY
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page   2
* EL1501.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 062602    2002030700006  PEMA  Add note type of 'S'
    22*                                  (special review)
    23* 121802    2001061800003  SMVA  REMOVE OBSOLETE CODE
    24* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    25* 071210    2009122800001  AJRA  ADD 'LETTER TO BENE' ON LETTER
    26* 071510    2010070600001  PEMA  INT PMT VOID SHOULD NOT OPEN CLM
    27* 113010    2009122800001  AJRA  DISPLAY STOP DATE
    28* 041613  CR2013031200002  AJRA  ADD MAIL RECEIVED ACTION TYPE
    29* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    30* 031214    2014031200001  AJRA  UPDATE TOT INT ON VOID
    31******************************************************************
    32
    33 ENVIRONMENT DIVISION.
    34
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page   3
* EL1501.cbl
    36 DATA DIVISION.
    37 WORKING-STORAGE SECTION.
    38 01  DFH-START PIC X(04).
    39 77  FILLER  PIC X(32)  VALUE '********************************'.
    40 77  FILLER  PIC X(32)  VALUE '*   EL1501 WORKING STORAGE     *'.
    41 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.030 *********'.
    42 77  S1                          PIC S999 COMP-3 VALUE +0.
    43 77  S2                          PIC S999 COMP-3 VALUE +0.
    44
    45*                                    COPY ELCSCTM.
    46******************************************************************
    47*                                                                *
    48*                                                                *
    49*                            ELCSCTM                             *
    50*                            VMOD=2.001                          *
    51*                                                                *
    52*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    53*                                                                *
    54******************************************************************
    55 01  SECURITY-MESSAGE.
    56     12  FILLER                          PIC X(30)
    57            VALUE '** LOGIC SECURITY VIOLATION -'.
    58     12  SM-READ                         PIC X(6).
    59     12  FILLER                          PIC X(5)
    60            VALUE ' PGM='.
    61     12  SM-PGM                          PIC X(6).
    62     12  FILLER                          PIC X(5)
    63            VALUE ' OPR='.
    64     12  SM-PROCESSOR-ID                 PIC X(4).
    65     12  FILLER                          PIC X(6)
    66            VALUE ' TERM='.
    67     12  SM-TERMID                       PIC X(4).
    68     12  FILLER                          PIC XX   VALUE SPACE.
    69     12  SM-JUL-DATE                     PIC 9(5).
    70     12  FILLER                          PIC X    VALUE SPACE.
    71     12  SM-TIME                         PIC 99.99.
    72
    73
    74*                                    COPY ELCSCRTY.
    75******************************************************************
    76*                                                                *
    77*                                                                *
    78*                            ELCSCRTY                            *
    79*                            VMOD=2.001                          *
    80*                                                                *
    81*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    82*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    83*        SAVED IN PI-SECURITY-ADDRESS.                           *
    84*                                                                *
    85******************************************************************
    86 01  SECURITY-CONTROL.
    87     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    88     12  FILLER                       PIC XX    VALUE 'SC'.
    89     12  SC-CREDIT-CODES.
    90         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    91             20  SC-CREDIT-DISPLAY    PIC X.
    92             20  SC-CREDIT-UPDATE     PIC X.
    93     12  SC-CLAIMS-CODES.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page   4
* EL1501.cbl
    94         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    95             20  SC-CLAIMS-DISPLAY    PIC X.
    96             20  SC-CLAIMS-UPDATE     PIC X.
    97
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page   5
* EL1501.cbl
    99 01  WS-DATE-AREA.
   100     12  SAVE-DATE                   PIC X(8)    VALUE SPACES.
   101     12  SAVE-DATE-CCYYMMDD.
   102         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   103         16  SAVE-DATE-YMD.
   104             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   105             20  FILLER              PIC X(4)    VALUE SPACES.
   106     12  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
   107
   108 01  ws-save-error-interface-block pic x(400) value low-values.
   109 01  STANDARD-AREAS.
   110     12  WS-RESPONSE         PIC S9(8)   COMP.
   111         88  RESP-NORMAL              VALUE +00.
   112         88  RESP-ERROR               VALUE +01.
   113         88  RESP-NOTFND              VALUE +13.
   114         88  RESP-DUPREC              VALUE +14.
   115         88  RESP-ENDFILE             VALUE +20.
   116     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   117     12  MAP-NAME                    PIC X(8)    VALUE 'EL150B'.
   118     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL1501S'.
   119     12  TRANS-ID                    PIC X(4)    VALUE 'EXH9'.
   120     12  THIS-PGM                    PIC X(8)    VALUE 'EL1501'.
   121     12  PGM-NAME                    PIC X(8).
   122     12  TIME-IN                     PIC S9(7).
   123     12  TIME-OUT-R  REDEFINES TIME-IN.
   124         16  FILLER                  PIC X.
   125         16  TIME-OUT                PIC 99V99.
   126         16  FILLER                  PIC XX.
   127     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   128     12  XCTL-010                    PIC X(8)    VALUE 'EL010'.
   129     12  XCTL-126                    PIC X(8)    VALUE 'EL126'.
   130     12  XCTL-142                    PIC X(8)    VALUE 'EL142'.
   131     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   132     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   133     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   134     12  FILE-ID                     PIC X(8).
   135     12  SC-ITEM                     PIC S9(4)   VALUE +0001 COMP.
   136     12  WS-BLANK                    PIC X       VALUE ' '.
   137
   138 01  MISC-WORK-AREAS.
   139     12  WS-CK-Q-CONTROL             PIC S9(8) COMP.
   140     12  W-CALLED-NAME               PIC X(8).
   141     12  QID.
   142         16  QID-TERM                PIC X(4).
   143         16  FILLER                  PIC X(4)    VALUE '150B'.
   144     12  MAP-LENGTH                  PIC S9(4)   VALUE +1920 COMP.
   145     12  PASS-SWITCH                 PIC X       VALUE 'A'.
   146     12  DISPLAY-CNT                 PIC S9(4)   VALUE +1    COMP.
   147     12  FILE-SWITCH                 PIC X(4)    VALUE SPACES.
   148     12  WS-SUB                      PIC 9       VALUE 0.
   149     12  SUB                         PIC 9       VALUE 1.
   150     12  SUB-1                       PIC 9       VALUE 1.
   151     12  RETURNED-FROM               PIC X(8)    VALUE SPACES.
   152     12  DIRECTION-SWITCH            PIC X       VALUE 'N'.
   153     12  WS-RECORDS-READ-SW          PIC X       VALUE 'N'.
   154         88  RECORDS-READ                        VALUE 'Y'.
   155     12  SAVE-CONTROL                PIC X(39).
   156     12  WS-RECEIVED-DATE            PIC XX      VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page   6
* EL1501.cbl
   157     12  WS-CHECK-WRITTEN-DT         PIC XX      VALUE LOW-VALUES.
   158     12  WS-PMT-APPROVAL-SW          PIC X       VALUE SPACE.
   159     12  WS-CF-PMT-APPROVAL-SW       PIC X       VALUE SPACE.
   160         88  WS-CF-PMT-APPROVAL-USED             VALUE 'Y' 'G'.
   161         88  WS-CF-NO-APPROVAL                   VALUE ' ' 'N'.
   162         88  WS-CF-ALL-APPROVED                  VALUE 'Y'.
   163         88  WS-CF-GRADUATED-APPROVAL            VALUE 'G'.
   164
   165     12  WS-CV-PMT-CODE              PIC X       VALUE SPACE.
   166     12  WS-PAY-TYPE                 PIC X       VALUE SPACE.
   167     12  WS-AMOUNT-PAID              PIC S9(7)V99 VALUE ZEROS.
   168     12  WS-PAYMENT-ORIGIN           PIC X       VALUE SPACE.
   169     12  WS-RECON-SW                 PIC X       VALUE ' '.
   170         88  RECON-RCD-REDEEMED                  VALUE 'R'.
   171         88  RECON-RCD-NOT-FOUND                 VALUE 'X'.
   172
   173     12  WS-DEEDIT-LENGTH            PIC S9(4)   VALUE +16   COMP.
   174     12  WS-DEEDIT-FIELD             PIC X(16)   VALUE ZEROS.
   175     12  WS-DEEDIT-FIELD-V0 REDEFINES WS-DEEDIT-FIELD
   176                                     PIC S9(16).
   177
   178     12  WS-LF-COVERAGE-TYPE         PIC X       VALUE SPACE.
   179     12  WS-BEN-SEARCH-SW            PIC X       VALUE 'N'.
   180         88  BENEFIT-FOUND                       VALUE 'Y'.
   181         88  NO-BENEFIT-FOUND                    VALUE 'N'.
   182     12  WS-ACCESS.
   183         16  FILLER                  PIC XX      VALUE SPACES.
   184         16  WS-BEN-CD               PIC XX      VALUE SPACES.
   185
   186     12  WS-PRINTED-SW               PIC X       VALUE 'N'.
   187         88  PAYMENT-HAS-BEEN-PRINTED            VALUE 'Y'.
   188         88  PAYMENT-NOT-PRINTED                 VALUE 'N'.
   189
   190     12  WS-RELEASED-SW              PIC X       VALUE 'N'.
   191         88  PAYMENT-NOT-RELEASED                VALUE 'N'.
   192
   193     12  WS-UPDATE-SW                PIC X       VALUE 'N'.
   194     12  WS-VOID-CODE                PIC X       VALUE ' '.
   195
   196     12  WS-WORK-DATE.
   197         16  WS-WORK-MM              PIC 99      VALUE ZEROS.
   198         16  WS-WORK-DD              PIC 99      VALUE ZEROS.
   199         16  WS-WORK-YY              PIC 99      VALUE ZEROS.
   200
   201     12  WS-RCON-DATE.
   202         16  WS-RCON-YEAR.
   203             20  WS-RCON-YY-1        PIC 99.
   204             20  WS-RCON-YY-2        PIC 99.
   205         16  WS-RCON-MM              PIC 99.
   206         16  WS-RCON-DD              PIC 99.
   207     12  W-NAME-LAST             PIC  X(15).
   208     12  W-NAME-FIRST            PIC  X(15).
   209     12  W-NAME-MIDDLE.
   210         16  FILLER              PIC  X.
   211         16  W-NAME-MIDDLE-2     PIC  X.
   212         16  FILLER              PIC  X(13).
   213
   214     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page   7
* EL1501.cbl
   215     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   216 01  CSO-WORK-FIELDS.
   217     05  ERROR-ON-OUTPUT-SW          PIC X       VALUE 'N'.
   218       88  ERROR-ON-OUTPUT                       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page   8
* EL1501.cbl
   220 01  ELCRTT-KEY.
   221     05  CTRLR-COMP-CD       PIC X.
   222     05  CTRLR-CARRIER       PIC X.
   223     05  CTRLR-GROUPING      PIC X(6).
   224     05  CTRLR-STATE         PIC X(2).
   225     05  CTRLR-ACCOUNT       PIC X(10).
   226     05  CTRLR-EFF-DT        PIC XX.
   227     05  CTRLR-CERT-NO       PIC X(11).
   228     05  CTRLR-REC-TYPE      PIC X.
   229 01  ACCESS-KEYS.
   230     12  ELMSTR-KEY.
   231         16  MSTR-COMP-CD            PIC X.
   232         16  MSTR-CARRIER            PIC X.
   233         16  MSTR-CLAIM-NO           PIC X(7).
   234         16  MSTR-CERT-NO.
   235             20  MSTR-CERT-NO-PRIME  PIC X(10).
   236             20  MSTR-CERT-NO-SUFX   PIC X.
   237     12  ELCNTL-KEY.
   238         16  CNTL-COMP-ID            PIC X(3).
   239         16  CNTL-REC-TYPE           PIC X.
   240         16  CNTL-ACCESS             PIC X(4).
   241         16  CNTL-SEQ-NO             PIC S9(4)     COMP.
   242     12  ELCERT-KEY.
   243         16  CERT-COMP-CD            PIC X.
   244         16  CERT-CARRIER            PIC X.
   245         16  CERT-GROUPING           PIC X(6).
   246         16  CERT-STATE              PIC XX.
   247         16  CERT-ACCOUNT            PIC X(10).
   248         16  CERT-EFF-DT             PIC XX.
   249         16  CERT-CERT-NO.
   250             20  CERT-CERT-NO-PRIME  PIC X(10).
   251             20  CERT-CERT-NO-SUFX   PIC X.
   252     12  ELTRLR-KEY.
   253         16  TRLR-COMP-CD            PIC X.
   254         16  TRLR-CARRIER            PIC X.
   255         16  TRLR-CLAIM-NO           PIC X(7).
   256         16  TRLR-CERT-NO.
   257             20  TRLR-CERT-NO-PRIME  PIC X(10).
   258             20  TRLR-CERT-NO-SUFX   PIC X.
   259         16  TRLR-SEQ-NO             PIC S9(4)   COMP.
   260     12  ELACTQ-KEY.
   261         16  ACTQ-COMP-CD            PIC X.
   262         16  ACTQ-CARRIER            PIC X.
   263         16  ACTQ-CLAIM-NO           PIC X(7).
   264         16  ACTQ-CERT-NO.
   265             20  ACTQ-CERT-NO-PRIME  PIC X(10).
   266             20  ACTQ-CERT-NO-SUFX   PIC X.
   267     12  ELCHKQ-KEY.
   268         16  CHKQ-COMP-CD            PIC X.
   269         16  CHKQ-CONTROL            PIC S9(8)   COMP.
   270         16  CHKQ-SEQ-NO             PIC S9(4)   COMP.
   271     12  ELRCON-KEY.
   272         16  RCON-COMPANY-CD         PIC X.
   273         16  RCON-CHECK-NO           PIC X(7).
   274         16  RCON-CHECK-ORIGIN       PIC X.
   275         16  RCON-GL-ACCOUNT-NO      PIC X(10).
   276     12  EMPLCY-KEY.
   277         16  PLCY-COMPANY-CD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page   9
* EL1501.cbl
   278         16  PLCY-CARRIER            PIC X.
   279         16  PLCY-GROUPING           PIC X(6).
   280         16  PLCY-STATE              PIC XX.
   281         16  PLCY-PRODUCER           PIC X(10).
   282         16  PLCY-EFF-DT             PIC XX.
   283         16  PLCY-REFERENCE-NO       PIC X(20).
   284     12  W-NOTE-KEY.
   285         16  W-NOTE-COMP-CD      PIC X.
   286         16  W-NOTE-CERT-KEY.
   287             20  W-NOTE-CARRIER  PIC X.
   288             20  W-NOTE-GROUPING PIC X(6).
   289             20  W-NOTE-STATE    PIC X(2).
   290             20  W-NOTE-ACCOUNT  PIC X(10).
   291             20  W-NOTE-EFF-DT   PIC XX.
   292             20  W-NOTE-CERT-NO  PIC X(11).
   293
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  10
* EL1501.cbl
   295 01  ERROR-MESSAGES.
   296     12  ER-0000                     PIC X(4)    VALUE '0000'.
   297     12  ER-0004                     PIC X(4)    VALUE '0004'.
   298     12  ER-0008                     PIC X(4)    VALUE '0008'.
   299     12  ER-0029                     PIC X(4)    VALUE '0029'.
   300     12  ER-0033                     PIC X(4)    VALUE '0033'.
   301     12  ER-0042                     PIC X(4)    VALUE '0042'.
   302     12  ER-0068                     PIC X(4)    VALUE '0068'.
   303     12  ER-0070                     PIC X(4)    VALUE '0070'.
   304     12  ER-0130                     PIC X(4)    VALUE '0130'.
   305     12  ER-0154                     PIC X(4)    VALUE '0154'.
   306     12  ER-0169                     PIC X(4)    VALUE '0169'.
   307     12  ER-0172                     PIC X(4)    VALUE '0172'.
   308     12  ER-0190                     PIC X(4)    VALUE '0190'.
   309     12  ER-0204                     PIC X(4)    VALUE '0204'.
   310     12  ER-0206                     PIC X(4)    VALUE '0206'.
   311     12  ER-0282                     PIC X(4)    VALUE '0282'.
   312     12  ER-0303                     PIC X(4)    VALUE '0303'.
   313     12  ER-0334                     PIC X(4)    VALUE '0334'.
   314     12  ER-0335                     PIC X(4)    VALUE '0335'.
   315     12  ER-0336                     PIC X(4)    VALUE '0336'.
   316     12  ER-0337                     PIC X(4)    VALUE '0337'.
   317     12  ER-0338                     PIC X(4)    VALUE '0338'.
   318     12  ER-0376                     PIC X(4)    VALUE '0376'.
   319     12  ER-0412                     PIC X(4)    VALUE '0412'.
   320     12  ER-0413                     PIC X(4)    VALUE '0413'.
   321     12  ER-0660                     PIC X(4)    VALUE '0660'.
   322     12  ER-0661                     PIC X(4)    VALUE '0661'.
   323     12  ER-0662                     PIC X(4)    VALUE '0662'.
   324     12  ER-0663                     PIC X(4)    VALUE '0663'.
   325     12  ER-0664                     PIC X(4)    VALUE '0664'.
   326     12  ER-0665                     PIC X(4)    VALUE '0665'.
   327     12  ER-0666                     PIC X(4)    VALUE '0666'.
   328     12  ER-0667                     PIC X(4)    VALUE '0667'.
   329     12  ER-0672                     PIC X(4)    VALUE '0672'.
   330     12  ER-0776                     PIC X(4)    VALUE '0776'.
   331     12  ER-0800                     PIC X(4)    VALUE '0800'.
   332     12  ER-0801                     PIC X(4)    VALUE '0801'.
   333     12  ER-0816                     PIC X(4)    VALUE '0816'.
   334     12  ER-0823                     PIC X(4)    VALUE '0823'.
   335     12  ER-0833                     PIC X(4)    VALUE '0833'.
   336     12  ER-0835                     PIC X(4)    VALUE '0835'.
   337     12  ER-0849                     PIC X(4)    VALUE '0849'.
   338     12  ER-0919                     PIC X(4)    VALUE '0919'.
   339     12  ER-0920                     PIC X(4)    VALUE '0920'.
   340     12  ER-0921                     PIC X(4)    VALUE '0921'.
   341     12  ER-0922                     PIC X(4)    VALUE '0922'.
   342     12  ER-0923                     PIC X(4)    VALUE '0923'.
   343     12  ER-0925                     PIC X(4)    VALUE '0925'.
   344     12  ER-0939                     PIC X(4)    VALUE '0939'.
   345     12  ER-0940                     PIC X(4)    VALUE '0940'.
   346     12  ER-0941                     PIC X(4)    VALUE '0941'.
   347     12  ER-0942                     PIC X(4)    VALUE '0942'.
   348     12  ER-0946                     PIC X(4)    VALUE '0946'.
   349     12  ER-0947                     PIC X(4)    VALUE '0947'.
   350     12  ER-0948                     PIC X(4)    VALUE '0948'.
   351     12  ER-0949                     PIC X(4)    VALUE '0949'.
   352     12  ER-0950                     PIC X(4)    VALUE '0950'.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  11
* EL1501.cbl
   353     12  ER-0951                     PIC X(4)    VALUE '0951'.
   354     12  ER-0954                     PIC X(4)    VALUE '0954'.
   355     12  ER-0974                     PIC X(4)    VALUE '0974'.
   356     12  ER-0975                     PIC X(4)    VALUE '0975'.
   357     12  ER-2378                     PIC X(4)    VALUE '2378'.
   358     12  ER-2379                     PIC X(4)    VALUE '2379'.
   359     12  ER-2893                     PIC X(4)    VALUE '2893'.
   360     12  ER-7999                     PIC X(4)    VALUE '7999'.
   361     12  ER-8003                     PIC X(4)    VALUE '8003'.
   362     12  ER-8051                     PIC X(4)    VALUE '8051'.
   363     12  ER-8052                     PIC X(4)    VALUE '8052'.
   364     12  ER-8053                     PIC X(4)    VALUE '8053'.
   365     12  ER-8054                     PIC X(4)    VALUE '8054'.
   366     12  ER-8055                     PIC X(4)    VALUE '8055'.
   367     12  ER-8056                     PIC X(4)    VALUE '8056'.
   368     12  ER-8057                     PIC X(4)    VALUE '8057'.
   369     12  ER-8058                     PIC X(4)    VALUE '8058'.
   370     12  ER-8059                     PIC X(4)    VALUE '8059'.
   371     12  ER-8060                     PIC X(4)    VALUE '8060'.
   372     12  ER-8061                     PIC X(4)    VALUE '8061'.
   373     12  ER-8062                     PIC X(4)    VALUE '8062'.
   374     12  ER-8063                     PIC X(4)    VALUE '8063'.
   375     12  ER-8064                     PIC X(4)    VALUE '8064'.
   376     12  ER-8065                     PIC X(4)    VALUE '8065'.
   377     12  ER-8066                     PIC X(4)    VALUE '8066'.
   378     12  ER-8152                     PIC X(4)    VALUE '8152'.
   379     12  ER-8153                     PIC X(4)    VALUE '8153'.
   380     12  ER-8154                     PIC X(4)    VALUE '8154'.
   381     12  ER-8155                     PIC X(4)    VALUE '8155'.
   382     12  ER-9211                     PIC X(4)    VALUE '9211'.
   383     12  ER-9883                     PIC X(4)    VALUE '9883'.
   384
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  12
* EL1501.cbl
   386 01  TEXT-WORK-AREAS.
   387     12  PAYMENT-LINE-1.
   388         16  PMT-HDG1.
   389             20  PMT-LINE-NO         PIC X.
   390             20  FILLER              PIC X.
   391             20  PMT-HDG1-LIT        PIC X(8).
   392         16  PMT-TEXT-1.
   393             20  PMT-TYPE-LIT        PIC X(6).
   394             20  PMT-TYPE            PIC X(7).
   395             20  PMT-CHECK-NO-LIT    PIC X(11).
   396             20  PMT-CHECK-NO        PIC X(7).
   397             20  PMT-DT-WRITTEN-LIT  PIC X(14).
   398             20  PMT-DT-WRITTEN      PIC X(8).
   399             20  PMT-AMT-PD-LIT      PIC X(5).
   400             20  PMT-AMT-PAID        PIC Z(6).99-.
   401     12  PAYMENT-LINE-2.
   402         16  PMT-HDG2.
   403             20  FILLER              PIC X(6).
   404             20  PMT-HDG2-LIT        PIC X(4).
   405         16  PMT-TEXT-2.
   406             20  PMT-FROM-LIT        PIC X(6).
   407             20  PMT-PAID-FROM       PIC X(8).
   408             20  PMT-THRU-LIT        PIC X(10).
   409             20  PMT-PAID-THRU       PIC X(8).
   410             20  PMT-VOID-LIT        PIC X(13).
   411             20  PMT-VOID-DT         PIC X(8).
   412             20  PMT-PAYEE-LIT       PIC X(8).
   413             20  PMT-PAYEE           PIC X(7).
   414     12  AUTO-PMT-LINE-1.
   415         16  AUTO-PMT-HDG1.
   416             20  AUTO-LINE-NO        PIC X.
   417             20  FILLER              PIC X.
   418             20  AUTO-HDG1-LIT       PIC X(8).
   419         16  AUTO-PMT-TEXT1.
   420             20  AUTO-EFF-DT-LIT     PIC X(6).
   421             20  AUTO-EFF-DT         PIC X(8).
   422             20  AUTO-1ST-AMT-LIT    PIC X(10).
   423             20  AUTO-1ST-AMT        PIC Z(5).99.
   424             20  AUTO-REG-AMT-LIT    PIC X(14).
   425             20  AUTO-REG-AMT        PIC Z(5).99.
   426             20  AUTO-PMT-STATUS-LIT PIC X(8).
   427             20  AUTO-PMT-STATUS     PIC X(6).
   428     12  AUTO-PMT-LINE-2.
   429         16  AUTO-PMT-HDG2.
   430             20  FILLER              PIC X(6).
   431             20  AUTO-HDG2-LIT       PIC X(4).
   432         16  AUTO-PMT-TEXT2.
   433             20  AUTO-PAYEE-LIT      PIC X(6).
   434             20  AUTO-PAYEE          PIC X(8).
   435             20  AUTO-1ST-PMT-LIT    PIC X(10).
   436             20  AUTO-1ST-PMT-DT     PIC X(8).
   437             20  AUTO-LST-PMT-LIT    PIC X(14).
   438             20  AUTO-LST-PMT-DT     PIC X(8).
   439             20  FILLER              PIC X(4).
   440     12  CORRESPONDENCE-LINE-1.
   441         16  CORR-HDG1.
   442             20  CORR-LINE-NO        PIC X.
   443             20  FILLER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  13
* EL1501.cbl
   444             20  CORR-HDG1-LIT       PIC X(8).
   445         16  CORR-TEXT-1.
   446             20  CORR-FORM-LIT       PIC X(6).
   447             20  CORR-FORM-TYPE      PIC X(4).
   448*             20  FILLER              PIC X(4).
   449             20  CORR-DT-SENT-LIT    PIC X(10).
   450             20  CORR-DT-SENT        PIC X(8).
   451             20  CORR-INIT-PRT-LIT   PIC X(11).
   452             20  CORR-INIT-PRT-DT    PIC X(8).
   453             20  CORR-ADDR-LIT       PIC X(05).
   454             20  CORR-ADDR-TYPE      PIC XX.
   455             20  CORR-LET-TO-BEN     PIC X(14).
   456     12  CORRESPONDENCE-LINE-2.
   457         16  CORR-HDG2.
   458             20  FILLER              PIC X(6).
   459             20  CORR-HDG2-LIT       PIC X(4).
   460         16  CORR-TEXT-2.
   461             20  CORR-RESEND-LIT     PIC X(6).
   462             20  CORR-RESEND-DT      PIC X(8).
   463             20  CORR-RECVD-LIT      PIC X(10).
   464             20  CORR-RECVD-DT       PIC X(8).
   465             20  CORR-FOLLOW-UP-LIT  PIC X(14).
   466             20  CORR-FOLLOW-UP-DT   PIC X(8).
   467             20  CORR-ARCH-LIT       PIC X(6).
   468             20  CORR-ARCH-NO        PIC 9(8).
   469*            20  FILLER              PIC X(14).
   470     12  FORM-LINE-1.
   471         16  FORM-HDG1.
   472             20  FORM-LINE-NO        PIC X.
   473             20  FILLER              PIC X.
   474             20  FORM-HDG1-LIT       PIC X(8).
   475         16  FORM-TEXT-1.
   476             20  FORM-TYPE-LIT       PIC X(6).
   477             20  FORM-TYPE           PIC X(4).
   478             20  FILLER              PIC X(4).
   479             20  FORM-SEND-ON-LIT    PIC X(10).
   480             20  FORM-SEND-ON-DT     PIC X(8).
   481             20  FORM-RESEND-LIT     PIC X(14).
   482             20  FORM-RESEND-DT      PIC X(8).
   483             20  FORM-FOLLOW-UP-LIT  PIC X(6).
   484             20  FORM-FOLLOW-UP-DT   PIC X(8).
   485     12  FORM-LINE-2.
   486         16  FORM-HDG2.
   487             20  FILLER              PIC X(6).
   488             20  FORM-HDG2-LIT       PIC X(4).
   489         16  FORM-TEXT-2.
   490             20  FORM-REC-INS-LIT    PIC X(6).
   491             20  FORM-REC-INS-DT     PIC X(8).
   492             20  FORM-REC-PHY-LIT    PIC X(10).
   493             20  FORM-REC-PHY-DT     PIC X(8).
   494             20  FORM-REC-EMP-LIT    PIC X(14).
   495             20  FORM-REC-EMP-DT     PIC X(8).
   496             20  FILLER              PIC X(12).
   497     12  INCUR-CHG-LINE-1.
   498         16  INCUR-CHG-HDG1.
   499             20  INCUR-LINE-NO       PIC X.
   500             20  FILLER              PIC X.
   501             20  INCUR-HDG1-LIT      PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  14
* EL1501.cbl
   502         16  INCUR-TEXT-1.
   503             20  INCUR-INCUR-LIT     PIC X(6).
   504             20  INCUR-INCUR-DT      PIC X(8).
   505             20  INCUR-REPORT-LIT    PIC X(10).
   506             20  INCUR-REPORT-DT     PIC X(8).
   507             20  INCUR-ESTAB-LIT     PIC X(14).
   508             20  INCUR-ESTAB-DT      PIC X(8).
   509             20  INCUR-NO-PMTS-LIT   PIC X(11).
   510             20  INCUR-NO-PMTS       PIC ZZ9.
   511     12  INCUR-CHG-LINE-2.
   512         16  INCUR-CHG-HDG2.
   513             20  FILLER              PIC X(6).
   514             20  INCUR-HDG2-LIT      PIC X(4).
   515         16  INCUR-TEXT-2.
   516             20  INCUR-PD-THRU-LIT   PIC X(6).
   517             20  INCUR-PD-THRU-DT    PIC X(8).
   518             20  INCUR-TOT-PD-LIT    PIC X(10).
   519             20  INCUR-TOT-PD        PIC Z(5).99.
   520             20  INCUR-TOT-DAYS-LIT  PIC X(14).
   521             20  INCUR-TOT-DAYS-PD   PIC ZZ9.
   522             20  FILLER              PIC X(19).
   523     12  DENIAL-LINE-1.
   524         16  DENIAL-HDG1.
   525             20  DENIAL-LINE-NO      PIC X.
   526             20  FILLER              PIC X.
   527             20  DENIAL-HDG1-LIT     PIC X(8).
   528         16  DENIAL-TEXT-1.
   529             20  DENIAL-LN1-LIT      PIC X(6).
   530             20  DENIAL-LN1          PIC X(62).
   531     12  DENIAL-LINE-2.
   532         16  DENIAL-HDG2.
   533             20  FILLER              PIC X(10).
   534         16  DENIAL-TEXT-2.
   535             20  DENIAL-LN2-LIT      PIC X(6).
   536             20  DENIAL-LN2          PIC X(62).
   537     12  GEN-INFO-LINE-1.
   538         16  GEN-INFO-HDG1.
   539             20  GI-LINE-NO          PIC X.
   540             20  FILLER              PIC X.
   541             20  GI-HDG1-LIT         PIC X(8).
   542         16  GEN-INFO-TEXT-1.
   543             20  GEN-INFO-MSG-1-LIT  PIC X(6).
   544             20  GEN-INFO-MSG-1      PIC X(62).
   545     12  GEN-INFO-LINE-2.
   546         16  GEN-INFO-HDG2.
   547             20  FILLER              PIC XX.
   548             20  GI-HDG2-LIT         PIC X(8).
   549         16  GEN-INFO-TEXT-2.
   550             20  GEN-INFO-MSG-2-LIT  PIC X(6).
   551             20  GEN-INFO-MSG-2      PIC X(62).
   552     12  REMINDER-LINE-1.
   553         16  REMINDER-HDG1.
   554             20  REM-LINE-NO         PIC X.
   555             20  FILLER              PIC X.
   556             20  REM-HDG1-LIT        PIC X(8).
   557         16  REMINDER-TEXT-1.
   558             20  REM-LINE-1-LIT      PIC X(6).
   559             20  REM-LINE-1          PIC X(62).
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  15
* EL1501.cbl
   560     12  REMINDER-LINE-2.
   561         16  REMINDER-HDG2.
   562             20  FILLER              PIC X(10).
   563         16  REMINDER-TEXT-2.
   564             20  REM-LINE-2-LIT      PIC X(6).
   565             20  REM-LINE-2          PIC X(62).
   566
   567 01  PAYMENT-DESCRIPTION-TABLE.
   568     12  FILLER                      PIC X(8)    VALUE 'PARTIAL '.
   569     12  FILLER                      PIC X(8)    VALUE 'FINAL   '.
   570     12  FILLER                      PIC X(8)    VALUE 'LUMP SUM'.
   571     12  FILLER                      PIC X(8)    VALUE 'ADDITION'.
   572     12  FILLER                      PIC X(8)    VALUE 'CHRG EXP'.
   573     12  FILLER                      PIC X(8)    VALUE 'NON-CHG '.
   574     12  FILLER                      PIC X(8)    VALUE 'LF PRM  '.
   575     12  FILLER                      PIC X(8)    VALUE 'A/H PRM '.
   576     12  FILLER                      PIC X(8)    VALUE 'ENT CORR'.
   577 01  PAYMENT-DESC-R   REDEFINES PAYMENT-DESCRIPTION-TABLE.
   578     12  PAY-DESC                    PIC X(8)    OCCURS 2.
   579
   580 01  CV-PAYMENT-DESCRIPTION-TABLE.
   581     12  FILLER                      PIC X(7)    VALUE 'FUL DTH'.
   582     12  FILLER                      PIC X(7)    VALUE 'HLF DTH'.
   583     12  FILLER                      PIC X(7)    VALUE 'FUL ADD'.
   584     12  FILLER                      PIC X(7)    VALUE 'HLF ADD'.
   585     12  FILLER                      PIC X(7)    VALUE 'FUL RID'.
   586     12  FILLER                      PIC X(7)    VALUE 'HLF RID'.
   587     12  FILLER                      PIC X(7)    VALUE 'NON-CHG'.
   588     12  FILLER                      PIC X(7)    VALUE 'ADDL   '.
   589 01  CV-PAYMENT-DESC-R REDEFINES CV-PAYMENT-DESCRIPTION-TABLE.
   590     12  CV-PAY-DESC                 PIC X(7)    OCCURS 2.
   591
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  16
* EL1501.cbl
   593*                                    COPY ELCDATE.
   594******************************************************************
   595*                                                                *
   596*                                                                *
   597*                            ELCDATE.                            *
   598*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   599*                            VMOD=2.003
   600*                                                                *
   601*                                                                *
   602*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   603*                 LENGTH = 200                                   *
   604******************************************************************
   605
   606 01  DATE-CONVERSION-DATA.
   607     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   608     12  DC-OPTION-CODE                PIC X.
   609         88  BIN-TO-GREG                VALUE ' '.
   610         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   611         88  EDIT-GREG-TO-BIN           VALUE '2'.
   612         88  YMD-GREG-TO-BIN            VALUE '3'.
   613         88  MDY-GREG-TO-BIN            VALUE '4'.
   614         88  JULIAN-TO-BIN              VALUE '5'.
   615         88  BIN-PLUS-ELAPSED           VALUE '6'.
   616         88  FIND-CENTURY               VALUE '7'.
   617         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   618         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   619         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   620         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   621         88  JULIAN-TO-BIN-3            VALUE 'C'.
   622         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   623         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   624         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   625         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   626         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   627         88  CHECK-LEAP-YEAR            VALUE 'H'.
   628         88  BIN-3-TO-GREG              VALUE 'I'.
   629         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   630         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   631         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   632         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   633         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   634         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   635         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   636         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   637         88  THREE-CHARACTER-BIN
   638                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   639         88  GREGORIAN-TO-BIN
   640                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   641         88  BIN-TO-GREGORIAN
   642                  VALUES ' ' '1' 'I' '8' 'G'.
   643         88  JULIAN-TO-BINARY
   644                  VALUES '5' 'C' 'E' 'F'.
   645     12  DC-ERROR-CODE                 PIC X.
   646         88  NO-CONVERSION-ERROR        VALUE ' '.
   647         88  DATE-CONVERSION-ERROR
   648                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   649         88  DATE-IS-ZERO               VALUE '1'.
   650         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  17
* EL1501.cbl
   651         88  DATE-IS-INVALID            VALUE '3'.
   652         88  DATE1-GREATER-DATE2        VALUE '4'.
   653         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   654         88  DATE-INVALID-OPTION        VALUE '9'.
   655         88  INVALID-CENTURY            VALUE 'A'.
   656         88  ONLY-CENTURY               VALUE 'B'.
   657         88  ONLY-LEAP-YEAR             VALUE 'C'.
   658         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   659     12  DC-END-OF-MONTH               PIC X.
   660         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   661     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   662         88  USE-NORMAL-PROCESS         VALUE ' '.
   663         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   664         88  ADJUST-UP-100-YRS          VALUE '2'.
   665     12  FILLER                        PIC X.
   666     12  DC-CONVERSION-DATES.
   667         16  DC-BIN-DATE-1             PIC XX.
   668         16  DC-BIN-DATE-2             PIC XX.
   669         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   670         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   671                       DC-GREG-DATE-1-EDIT.
   672             20  DC-EDIT1-MONTH        PIC 99.
   673             20  SLASH1-1              PIC X.
   674             20  DC-EDIT1-DAY          PIC 99.
   675             20  SLASH1-2              PIC X.
   676             20  DC-EDIT1-YEAR         PIC 99.
   677         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   678         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   679                     DC-GREG-DATE-2-EDIT.
   680             20  DC-EDIT2-MONTH        PIC 99.
   681             20  SLASH2-1              PIC X.
   682             20  DC-EDIT2-DAY          PIC 99.
   683             20  SLASH2-2              PIC X.
   684             20  DC-EDIT2-YEAR         PIC 99.
   685         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   686         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   687                     DC-GREG-DATE-1-YMD.
   688             20  DC-YMD-YEAR           PIC 99.
   689             20  DC-YMD-MONTH          PIC 99.
   690             20  DC-YMD-DAY            PIC 99.
   691         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   692         16  DC-GREG-DATE-1-MDY-R REDEFINES
   693                      DC-GREG-DATE-1-MDY.
   694             20  DC-MDY-MONTH          PIC 99.
   695             20  DC-MDY-DAY            PIC 99.
   696             20  DC-MDY-YEAR           PIC 99.
   697         16  DC-GREG-DATE-1-ALPHA.
   698             20  DC-ALPHA-MONTH        PIC X(10).
   699             20  DC-ALPHA-DAY          PIC 99.
   700             20  FILLER                PIC XX.
   701             20  DC-ALPHA-CENTURY.
   702                 24 DC-ALPHA-CEN-N     PIC 99.
   703             20  DC-ALPHA-YEAR         PIC 99.
   704         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   705         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   706         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   707         16  DC-JULIAN-DATE            PIC 9(05).
   708         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  18
* EL1501.cbl
   709                                       PIC 9(05).
   710         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   711             20  DC-JULIAN-YEAR        PIC 99.
   712             20  DC-JULIAN-DAYS        PIC 999.
   713         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   714         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   715         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   716     12  DATE-CONVERSION-VARIBLES.
   717         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   718         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   719             20  FILLER                PIC 9(3).
   720             20  HOLD-CEN-1-CCYY.
   721                 24  HOLD-CEN-1-CC     PIC 99.
   722                 24  HOLD-CEN-1-YY     PIC 99.
   723             20  HOLD-CEN-1-MO         PIC 99.
   724             20  HOLD-CEN-1-DA         PIC 99.
   725         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   726             20  HOLD-CEN-1-R-MO       PIC 99.
   727             20  HOLD-CEN-1-R-DA       PIC 99.
   728             20  HOLD-CEN-1-R-CCYY.
   729                 24  HOLD-CEN-1-R-CC   PIC 99.
   730                 24  HOLD-CEN-1-R-YY   PIC 99.
   731             20  FILLER                PIC 9(3).
   732         16  HOLD-CENTURY-1-X.
   733             20  FILLER                PIC X(3)  VALUE SPACES.
   734             20  HOLD-CEN-1-X-CCYY.
   735                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   736                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   737             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   738             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   739         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   740             20  HOLD-CEN-1-R-X-MO     PIC XX.
   741             20  HOLD-CEN-1-R-X-DA     PIC XX.
   742             20  HOLD-CEN-1-R-X-CCYY.
   743                 24  HOLD-CEN-1-R-X-CC PIC XX.
   744                 24  HOLD-CEN-1-R-X-YY PIC XX.
   745             20  FILLER                PIC XXX.
   746         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   747         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   748         16  DC-JULIAN-DATE-1          PIC 9(07).
   749         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   750             20  DC-JULIAN-1-CCYY.
   751                 24  DC-JULIAN-1-CC    PIC 99.
   752                 24  DC-JULIAN-1-YR    PIC 99.
   753             20  DC-JULIAN-DA-1        PIC 999.
   754         16  DC-JULIAN-DATE-2          PIC 9(07).
   755         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   756             20  DC-JULIAN-2-CCYY.
   757                 24  DC-JULIAN-2-CC    PIC 99.
   758                 24  DC-JULIAN-2-YR    PIC 99.
   759             20  DC-JULIAN-DA-2        PIC 999.
   760         16  DC-GREG-DATE-A-EDIT.
   761             20  DC-EDITA-MONTH        PIC 99.
   762             20  SLASHA-1              PIC X VALUE '/'.
   763             20  DC-EDITA-DAY          PIC 99.
   764             20  SLASHA-2              PIC X VALUE '/'.
   765             20  DC-EDITA-CCYY.
   766                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  19
* EL1501.cbl
   767                 24  DC-EDITA-YEAR     PIC 99.
   768         16  DC-GREG-DATE-B-EDIT.
   769             20  DC-EDITB-MONTH        PIC 99.
   770             20  SLASHB-1              PIC X VALUE '/'.
   771             20  DC-EDITB-DAY          PIC 99.
   772             20  SLASHB-2              PIC X VALUE '/'.
   773             20  DC-EDITB-CCYY.
   774                 24  DC-EDITB-CENT     PIC 99.
   775                 24  DC-EDITB-YEAR     PIC 99.
   776         16  DC-GREG-DATE-CYMD         PIC 9(08).
   777         16  DC-GREG-DATE-CYMD-R REDEFINES
   778                              DC-GREG-DATE-CYMD.
   779             20  DC-CYMD-CEN           PIC 99.
   780             20  DC-CYMD-YEAR          PIC 99.
   781             20  DC-CYMD-MONTH         PIC 99.
   782             20  DC-CYMD-DAY           PIC 99.
   783         16  DC-GREG-DATE-MDCY         PIC 9(08).
   784         16  DC-GREG-DATE-MDCY-R REDEFINES
   785                              DC-GREG-DATE-MDCY.
   786             20  DC-MDCY-MONTH         PIC 99.
   787             20  DC-MDCY-DAY           PIC 99.
   788             20  DC-MDCY-CEN           PIC 99.
   789             20  DC-MDCY-YEAR          PIC 99.
   790    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   791        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   792    12  DC-EL310-DATE                  PIC X(21).
   793    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  20
* EL1501.cbl
   795*                                    COPY ELCLOGOF.
   796******************************************************************
   797*                                                                *
   798*                                                                *
   799*                            ELCLOGOF.                           *
   800*                            VMOD=2.001                          *
   801*                                                                *
   802*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   803*                                                                *
   804******************************************************************
   805 01  CLASIC-LOGOFF.
   806     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   807     12  LOGOFF-TEXT.
   808         16  FILLER          PIC X(5)    VALUE SPACES.
   809         16  LOGOFF-MSG.
   810             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   811             20  FILLER      PIC X       VALUE SPACES.
   812             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   813         16  FILLER          PIC X(80)
   814           VALUE '* YOU ARE NOW LOGGED OFF'.
   815         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   816         16  FILLER          PIC X       VALUE QUOTE.
   817         16  LOGOFF-SYS-MSG  PIC X(17)
   818           VALUE 'S CLAS-IC SYSTEM '.
   819     12  TEXT-MESSAGES.
   820         16  UNACCESS-MSG    PIC X(29)
   821             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   822         16  PGMIDERR-MSG    PIC X(17)
   823             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  21
* EL1501.cbl
   825*                                    COPY ELCATTR.
   826******************************************************************
   827*                                                                *
   828*                            ELCATTR.                            *
   829*                            VMOD=2.001                          *
   830*                                                                *
   831*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   832*                                                                *
   833*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   834*                                                                *
   835*                   POS 1   P=PROTECTED                          *
   836*                           U=UNPROTECTED                        *
   837*                           S=ASKIP                              *
   838*                   POS 2   A=ALPHA/NUMERIC                      *
   839*                           N=NUMERIC                            *
   840*                   POS 3   N=NORMAL                             *
   841*                           B=BRIGHT                             *
   842*                           D=DARK                               *
   843*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   844*                           OF=MODIFIED DATA TAG OFF             *
   845*                                                                *
   846*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   847******************************************************************
   848 01  ATTRIBUTE-LIST.
   849     12  AL-PABOF            PIC X       VALUE 'Y'.
   850     12  AL-PABON            PIC X       VALUE 'Z'.
   851     12  AL-PADOF            PIC X       VALUE '%'.
   852     12  AL-PADON            PIC X       VALUE '_'.
   853     12  AL-PANOF            PIC X       VALUE '-'.
   854     12  AL-PANON            PIC X       VALUE '/'.
   855     12  AL-SABOF            PIC X       VALUE '8'.
   856     12  AL-SABON            PIC X       VALUE '9'.
   857     12  AL-SADOF            PIC X       VALUE '@'.
   858     12  AL-SADON            PIC X       VALUE QUOTE.
   859     12  AL-SANOF            PIC X       VALUE '0'.
   860     12  AL-SANON            PIC X       VALUE '1'.
   861     12  AL-UABOF            PIC X       VALUE 'H'.
   862     12  AL-UABON            PIC X       VALUE 'I'.
   863     12  AL-UADOF            PIC X       VALUE '<'.
   864     12  AL-UADON            PIC X       VALUE '('.
   865     12  AL-UANOF            PIC X       VALUE ' '.
   866     12  AL-UANON            PIC X       VALUE 'A'.
   867     12  AL-UNBOF            PIC X       VALUE 'Q'.
   868     12  AL-UNBON            PIC X       VALUE 'R'.
   869     12  AL-UNDOF            PIC X       VALUE '*'.
   870     12  AL-UNDON            PIC X       VALUE ')'.
   871     12  AL-UNNOF            PIC X       VALUE '&'.
   872     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  22
* EL1501.cbl
   874*                                    COPY ELCDCTB.
   875*    EJECT
   876*                                    COPY ELCDMO.
   877*    EJECT
   878*                                    COPY ELCEMIB.
   879******************************************************************
   880*                                                                *
   881*                                                                *
   882*                            ELCEMIB.                            *
   883*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   884*                            VMOD=2.005                          *
   885*                                                                *
   886*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   887*                                                                *
   888******************************************************************
   889 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   890     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   891     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   892     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   893     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   894     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   895     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   896     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   897     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   898     12  EMI-SWITCH1             PIC X        VALUE '1'.
   899         88  EMI-NO-ERRORS                    VALUE '1'.
   900         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   901         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   902     12  EMI-SWITCH2             PIC X        VALUE '1'.
   903         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   904     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   905         88  EMI-AREA1-EMPTY                  VALUE '1'.
   906         88  EMI-AREA1-FULL                   VALUE '2'.
   907     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   908         88  EMI-AREA2-EMPTY                  VALUE '1'.
   909         88  EMI-AREA2-FULL                   VALUE '2'.
   910     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   911         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   912         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   913         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   914         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   915         88  EMI-BYPASS-FATALS                VALUE 'X'.
   916     12  EMI-ERROR-LINES.
   917         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   918         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   919         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   920         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   921             20  EMI-ERR-CODES OCCURS 10 TIMES.
   922                 24  EMI-ERR-NUM         PIC X(4).
   923                 24  EMI-FILLER          PIC X.
   924                 24  EMI-SEV             PIC X.
   925                 24  FILLER              PIC X.
   926             20  FILLER                  PIC X(02).
   927     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   928         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   929             20  EMI-ERROR-NUMBER    PIC X(4).
   930             20  EMI-FILL            PIC X.
   931             20  EMI-SEVERITY        PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  23
* EL1501.cbl
   932             20  FILLER              PIC X.
   933             20  EMI-ERROR-TEXT.
   934                 24  EMI-TEXT-VARIABLE   PIC X(10).
   935                 24  FILLER          PIC X(55).
   936     12  EMI-SEVERITY-SAVE           PIC X.
   937         88  EMI-NOTE                    VALUE 'N'.
   938         88  EMI-WARNING                 VALUE 'W'.
   939         88  EMI-FORCABLE                VALUE 'F'.
   940         88  EMI-FATAL                   VALUE 'X'.
   941     12  EMI-MESSAGE-FLAG            PIC X.
   942         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   943         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   944     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   945     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   946         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   947         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   948         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   949     12  emi-claim-no                pic x(7).
   950     12  emi-claim-type              pic x(6).
   951     12  FILLER                      PIC X(124)  VALUE SPACES.
   952     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   953     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   954     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   955     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  24
* EL1501.cbl
   957*                                    COPY ELCNWA.
   958*    EJECT
   959*                                    COPY MPCPOLUP.
   960*    EJECT
   961*                            COPY ELCINTF.
   962******************************************************************
   963*                                                                *
   964*                                                                *
   965*                            ELCINTF.                            *
   966*                            VMOD=2.017                          *
   967*                                                                *
   968*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   969*                                                                *
   970*       LENGTH = 1024                                            *
   971*                                                                *
   972******************************************************************
   973*                   C H A N G E   L O G
   974*
   975* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   976*-----------------------------------------------------------------
   977*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   978* EFFECTIVE    NUMBER
   979*-----------------------------------------------------------------
   980* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   981******************************************************************
   982 01  PROGRAM-INTERFACE-BLOCK.
   983     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   984     12  PI-CALLING-PROGRAM              PIC X(8).
   985     12  PI-SAVED-PROGRAM-1              PIC X(8).
   986     12  PI-SAVED-PROGRAM-2              PIC X(8).
   987     12  PI-SAVED-PROGRAM-3              PIC X(8).
   988     12  PI-SAVED-PROGRAM-4              PIC X(8).
   989     12  PI-SAVED-PROGRAM-5              PIC X(8).
   990     12  PI-SAVED-PROGRAM-6              PIC X(8).
   991     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   992     12  PI-COMPANY-ID                   PIC XXX.
   993     12  PI-COMPANY-CD                   PIC X.
   994
   995     12  PI-COMPANY-PASSWORD             PIC X(8).
   996
   997     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   998
   999     12  PI-CONTROL-IN-PROGRESS.
  1000         16  PI-CARRIER                  PIC X.
  1001         16  PI-GROUPING                 PIC X(6).
  1002         16  PI-STATE                    PIC XX.
  1003         16  PI-ACCOUNT                  PIC X(10).
  1004         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1005                                         PIC X(10).
  1006         16  PI-CLAIM-CERT-GRP.
  1007             20  PI-CLAIM-NO             PIC X(7).
  1008             20  PI-CERT-NO.
  1009                 25  PI-CERT-PRIME       PIC X(10).
  1010                 25  PI-CERT-SFX         PIC X.
  1011             20  PI-CERT-EFF-DT          PIC XX.
  1012         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1013             20  PI-PLAN-CODE            PIC X(2).
  1014             20  PI-REVISION-NUMBER      PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  25
* EL1501.cbl
  1015             20  PI-PLAN-EFF-DT          PIC X(2).
  1016             20  PI-PLAN-EXP-DT          PIC X(2).
  1017             20  FILLER                  PIC X(11).
  1018         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1019             20  PI-OE-REFERENCE-1.
  1020                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1021                 25  PI-OE-REF-1-SUFF    PIC XX.
  1022
  1023     12  PI-SESSION-IN-PROGRESS          PIC X.
  1024         88  CLAIM-SESSION                   VALUE '1'.
  1025         88  CREDIT-SESSION                  VALUE '2'.
  1026         88  WARRANTY-SESSION                VALUE '3'.
  1027         88  MORTGAGE-SESSION                VALUE '4'.
  1028         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1029
  1030
  1031*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1032
  1033     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1034     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1035
  1036     12  PI-CREDIT-USER                  PIC X.
  1037         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1038         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1039
  1040     12  PI-CLAIM-USER                   PIC X.
  1041         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1042         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1043
  1044     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1045         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1046         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1047         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1048         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1049         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1050
  1051     12  PI-PROCESSOR-ID                 PIC X(4).
  1052
  1053     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1054
  1055     12  PI-MEMBER-CAPTION               PIC X(10).
  1056
  1057     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1058         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1059
  1060     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1061     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1062     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1063     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1064
  1065     12  PI-AH-OVERRIDE-L1               PIC X.
  1066     12  PI-AH-OVERRIDE-L2               PIC XX.
  1067     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1068     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1069
  1070     12  PI-NEW-SYSTEM                   PIC X(2).
  1071
  1072     12  PI-PRIMARY-CERT-NO              PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  26
* EL1501.cbl
  1073     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1074         88  PI-USES-PAID-TO                 VALUE '1'.
  1075     12  PI-CRDTCRD-SYSTEM.
  1076         16  PI-CRDTCRD-USER             PIC X.
  1077             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1078             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1079         16  PI-CC-MONTH-END-DT          PIC XX.
  1080     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1081
  1082     12  PI-OE-REFERENCE-2.
  1083         16  PI-OE-REF-2-PRIME           PIC X(10).
  1084         16  PI-OE-REF-2-SUFF            PIC X.
  1085
  1086     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1087
  1088     12  PI-LANGUAGE-TYPE                PIC X.
  1089             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1090             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1091             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1092
  1093     12  PI-POLICY-LINKAGE-IND           PIC X.
  1094         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1095         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1096                                                   LOW-VALUES.
  1097
  1098     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1099     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1100         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1101         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1102
  1103     12  PI-PROCESSOR-CSR-IND            PIC X.
  1104         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1105         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1106
  1107     12  FILLER                          PIC X(3).
  1108
  1109     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1110
  1111     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1112         PI-SYSTEM-LEVEL.
  1113
  1114         16  PI-ENTRY-CODES.
  1115             20  PI-ENTRY-CD-1           PIC X.
  1116             20  PI-ENTRY-CD-2           PIC X.
  1117
  1118         16  PI-RETURN-CODES.
  1119             20  PI-RETURN-CD-1          PIC X.
  1120             20  PI-RETURN-CD-2          PIC X.
  1121
  1122         16  PI-UPDATE-STATUS-SAVE.
  1123             20  PI-UPDATE-BY            PIC X(4).
  1124             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1125
  1126         16  PI-LOWER-CASE-LETTERS       PIC X.
  1127             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1128
  1129*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1130*            88  CLAIM-NO-UNIQUE             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  27
* EL1501.cbl
  1131*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1132
  1133         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1134             88  ST-ACCNT-CNTL               VALUE ' '.
  1135             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1136             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1137             88  ACCNT-CNTL                  VALUE '3'.
  1138             88  CARR-ACCNT-CNTL             VALUE '4'.
  1139
  1140         16  PI-PROCESSOR-CAP-LIST.
  1141             20  PI-SYSTEM-CONTROLS.
  1142                24 PI-SYSTEM-DISPLAY     PIC X.
  1143                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1144                24 PI-SYSTEM-MODIFY      PIC X.
  1145                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1146             20  FILLER                  PIC XX.
  1147             20  PI-DISPLAY-CAP          PIC X.
  1148                 88  DISPLAY-CAP             VALUE 'Y'.
  1149             20  PI-MODIFY-CAP           PIC X.
  1150                 88  MODIFY-CAP              VALUE 'Y'.
  1151             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1152                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1153             20  PI-FORCE-CAP            PIC X.
  1154                 88  FORCE-CAP               VALUE 'Y'.
  1155
  1156         16  PI-PROGRAM-CONTROLS.
  1157             20  PI-PGM-PRINT-OPT        PIC X.
  1158             20  PI-PGM-FORMAT-OPT       PIC X.
  1159             20  PI-PGM-PROCESS-OPT      PIC X.
  1160             20  PI-PGM-TOTALS-OPT       PIC X.
  1161
  1162         16  PI-HELP-INTERFACE.
  1163             20  PI-LAST-ERROR-NO        PIC X(4).
  1164             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1165
  1166         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1167             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1168
  1169         16  PI-CR-CONTROL-IN-PROGRESS.
  1170             20  PI-CR-CARRIER           PIC X.
  1171             20  PI-CR-GROUPING          PIC X(6).
  1172             20  PI-CR-STATE             PIC XX.
  1173             20  PI-CR-ACCOUNT           PIC X(10).
  1174             20  PI-CR-FIN-RESP          PIC X(10).
  1175             20  PI-CR-TYPE              PIC X.
  1176
  1177         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1178
  1179         16  PI-CR-MONTH-END-DT          PIC XX.
  1180
  1181         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1182             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1183             88  PI-ZERO-CARRIER             VALUE '1'.
  1184             88  PI-ZERO-GROUPING            VALUE '2'.
  1185             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1186
  1187         16  PI-CARRIER-SECURITY         PIC X.
  1188             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  28
* EL1501.cbl
  1189
  1190         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1191             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1192             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1193
  1194         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1195             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1196                                         INDEXED BY PI-ACCESS-NDX
  1197                                         PIC X.
  1198
  1199         16  PI-GA-BILLING-CONTROL       PIC X.
  1200             88  PI-GA-BILLING               VALUE '1'.
  1201
  1202         16  PI-MAIL-PROCESSING          PIC X.
  1203             88  PI-MAIL-YES                 VALUE 'Y'.
  1204
  1205         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1206
  1207         16  PI-AR-SYSTEM.
  1208             20  PI-AR-PROCESSING-CNTL   PIC X.
  1209                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1210             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1211             20  PI-AR-MONTH-END-DT      PIC XX.
  1212
  1213         16  PI-MP-SYSTEM.
  1214             20  PI-MORTGAGE-USER            PIC X.
  1215                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1216                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1217             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1218                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1219                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1220                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1221                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1222                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1223             20  PI-MP-MONTH-END-DT          PIC XX.
  1224             20  PI-MP-REFERENCE-NO.
  1225                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1226                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1227
  1228         16  PI-LABEL-CONTROL            PIC X(01).
  1229             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1230             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1231
  1232         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1233             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1234
  1235         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1236             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1237             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1238
  1239         16  FILLER                      PIC X(14).
  1240
  1241     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1242******************************************************************
  1243     12  PI-REDEF    REDEFINES PI-PROGRAM-WORK-AREA.
  1244         16  FILLER                  PIC x(2).
  1245         16  pi-el142-priority       pic x.
  1246         16  filler                  pic x.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  29
* EL1501.cbl
  1247         16  PI-MAP-NAME             PIC X(8).
  1248         16  PI-QUALIFICATION-SWITCHES  COMP-3.
  1249             20  PI-REMINDERS-SW     PIC S9.
  1250             20  PI-LETTERS-SW       PIC S9.
  1251             20  PI-PAYMENTS-SW      PIC S9.
  1252             20  PI-AUTO-PAY-SW      PIC S9.
  1253             20  PI-NOTES-SW         PIC S9.
  1254             20  PI-RES-EXP-SW       PIC S9.
  1255             20  PI-DENIALS-SW       PIC S9.
  1256             20  PI-INCURRED-DATE-SW PIC S9.
  1257             20  PI-FORMS-SW         PIC S9.
  1258         16  FILLER                  PIC X(8).
  1259         16  PI-ACTIVITY-TRAILERS-KEY.
  1260             20  PI-ATK-COMPANY-CODE PIC X.
  1261             20  PI-ATK-CARRIER      PIC X.
  1262             20  PI-ATK-CLAIM-NO     PIC X(7).
  1263             20  PI-ATK-CERT-NO      PIC X(11).
  1264             20  PI-ATK-SEQ-NO       PIC S9(4)     COMP.
  1265         16  PI-PREV-ACTIVITY-TRAILERS-KEY.
  1266             20  PI-PREV-ATK-COMPANY-CODE PIC X.
  1267             20  PI-PREV-ATK-CARRIER      PIC X.
  1268             20  PI-PREV-ATK-CLAIM-NO     PIC X(7).
  1269             20  PI-PREV-ATK-CERT-NO      PIC X(11).
  1270             20  PI-PREV-ATK-SEQ-NO       PIC S9(4)     COMP.
  1271         16  PI-SAVE-KEY.
  1272             20  PI-SAVE-ATK-COMPANY-CODE PIC X.
  1273             20  PI-SAVE-ATK-CARRIER      PIC X.
  1274             20  PI-SAVE-ATK-CLAIM-NO     PIC X(7).
  1275             20  PI-SAVE-ATK-CERT-NO      PIC X(11).
  1276             20  PI-SAVE-ATK-SEQ-NO       PIC S9(4)     COMP.
  1277         16  PI-PREV-AID                  PIC X.
  1278         16  PI-RECORD-COUNT              PIC S9        COMP-3.
  1279         16  PI-END-OF-FILE               PIC S9        COMP-3.
  1280         16  PI-SAVE-CURSOR               PIC S9(4)     COMP.
  1281         16  PI-PURGED-SW                 PIC X.
  1282             88  CLAIM-IS-PURGED                 VALUE 'Y'.
  1283         16  PI-LINE-NO                   PIC 9.
  1284         16  PI-PREV-SEQ-NO               PIC S9(4)   COMP.
  1285         16  PI-FIRST-TIME-SW             PIC X.
  1286             88  FIRST-TIME                      VALUE 'Y'.
  1287         16  PI-PREV-DIRECTION            PIC X.
  1288         16  PI-SEQ-NUMBERS.
  1289             20  PI-SEQ-NO-TABLE OCCURS 8 TIMES.
  1290                 24  PI-TRLR-LN-NO        PIC 9.
  1291                 24  PI-TRLR-SEQ-NO       PIC S9(4)   COMP.
  1292                 24  PI-TRLR-TYPE         PIC X.
  1293         16  PI-PAY-TYPE                  PIC X.
  1294         16  pi-save-type                 pic x.
  1295         16  PI-FULL-SCREEN-IND           PIC X.
  1296             88  PI-FULL-SCREEN-SHOWN            VALUE 'Y'.
  1297         16  FILLER                       PIC X(499).
  1298
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  30
* EL1501.cbl
  1300*                                    COPY ELCAID.
  1301******************************************************************
  1302*                                                                *
  1303*                            ELCAID.                             *
  1304*                            VMOD=2.001                          *
  1305*                                                                *
  1306*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1307*                                                                *
  1308*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1309*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1310******************************************************************
  1311
  1312 01  DFHAID.
  1313   02  DFHNULL   PIC  X  VALUE  ' '.
  1314   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1315   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1316   02  DFHPEN    PIC  X  VALUE  '='.
  1317   02  DFHOPID   PIC  X  VALUE  'W'.
  1318   02  DFHPA1    PIC  X  VALUE  '%'.
  1319   02  DFHPA2    PIC  X  VALUE  '>'.
  1320   02  DFHPA3    PIC  X  VALUE  ','.
  1321   02  DFHPF1    PIC  X  VALUE  '1'.
  1322   02  DFHPF2    PIC  X  VALUE  '2'.
  1323   02  DFHPF3    PIC  X  VALUE  '3'.
  1324   02  DFHPF4    PIC  X  VALUE  '4'.
  1325   02  DFHPF5    PIC  X  VALUE  '5'.
  1326   02  DFHPF6    PIC  X  VALUE  '6'.
  1327   02  DFHPF7    PIC  X  VALUE  '7'.
  1328   02  DFHPF8    PIC  X  VALUE  '8'.
  1329   02  DFHPF9    PIC  X  VALUE  '9'.
  1330   02  DFHPF10   PIC  X  VALUE  ':'.
  1331   02  DFHPF11   PIC  X  VALUE  '#'.
  1332   02  DFHPF12   PIC  X  VALUE  '@'.
  1333   02  DFHPF13   PIC  X  VALUE  'A'.
  1334   02  DFHPF14   PIC  X  VALUE  'B'.
  1335   02  DFHPF15   PIC  X  VALUE  'C'.
  1336   02  DFHPF16   PIC  X  VALUE  'D'.
  1337   02  DFHPF17   PIC  X  VALUE  'E'.
  1338   02  DFHPF18   PIC  X  VALUE  'F'.
  1339   02  DFHPF19   PIC  X  VALUE  'G'.
  1340   02  DFHPF20   PIC  X  VALUE  'H'.
  1341   02  DFHPF21   PIC  X  VALUE  'I'.
  1342*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1343   02  DFHPF22   PIC  X  VALUE  '['.
  1344   02  DFHPF23   PIC  X  VALUE  '.'.
  1345   02  DFHPF24   PIC  X  VALUE  '<'.
  1346   02  DFHMSRE   PIC  X  VALUE  'X'.
  1347   02  DFHSTRF   PIC  X  VALUE  'h'.
  1348   02  DFHTRIG   PIC  X  VALUE  '"'.
  1349 01  FILLER    REDEFINES DFHAID.
  1350     12  FILLER                      PIC X(8).
  1351     12  PF-VALUES                   PIC X       OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  31
* EL1501.cbl
  1353*                                    COPY EL1501S.
  1354 01  EL150BI.
  1355     05  FILLER            PIC  X(0012).
  1356*    -------------------------------
  1357     05  RUNDTEL PIC S9(0004) COMP.
  1358     05  RUNDTEF PIC  X(0001).
  1359     05  FILLER REDEFINES RUNDTEF.
  1360         10  RUNDTEA PIC  X(0001).
  1361     05  RUNDTEI PIC  X(0008).
  1362*    -------------------------------
  1363     05  RUNTIMEL PIC S9(0004) COMP.
  1364     05  RUNTIMEF PIC  X(0001).
  1365     05  FILLER REDEFINES RUNTIMEF.
  1366         10  RUNTIMEA PIC  X(0001).
  1367     05  RUNTIMEI PIC  X(0005).
  1368*    -------------------------------
  1369     05  CLMNOL PIC S9(0004) COMP.
  1370     05  CLMNOF PIC  X(0001).
  1371     05  FILLER REDEFINES CLMNOF.
  1372         10  CLMNOA PIC  X(0001).
  1373     05  CLMNOI PIC  X(0007).
  1374*    -------------------------------
  1375     05  CARRL PIC S9(0004) COMP.
  1376     05  CARRF PIC  X(0001).
  1377     05  FILLER REDEFINES CARRF.
  1378         10  CARRA PIC  X(0001).
  1379     05  CARRI PIC  X(0001).
  1380*    -------------------------------
  1381     05  CERTNOL PIC S9(0004) COMP.
  1382     05  CERTNOF PIC  X(0001).
  1383     05  FILLER REDEFINES CERTNOF.
  1384         10  CERTNOA PIC  X(0001).
  1385     05  CERTNOI PIC  X(0010).
  1386*    -------------------------------
  1387     05  SUFXL PIC S9(0004) COMP.
  1388     05  SUFXF PIC  X(0001).
  1389     05  FILLER REDEFINES SUFXF.
  1390         10  SUFXA PIC  X(0001).
  1391     05  SUFXI PIC  X(0001).
  1392*    -------------------------------
  1393     05  LN1HDGL PIC S9(0004) COMP.
  1394     05  LN1HDGF PIC  X(0001).
  1395     05  FILLER REDEFINES LN1HDGF.
  1396         10  LN1HDGA PIC  X(0001).
  1397     05  LN1HDGI PIC  X(0010).
  1398*    -------------------------------
  1399     05  LN1TXTL PIC S9(0004) COMP.
  1400     05  LN1TXTF PIC  X(0001).
  1401     05  FILLER REDEFINES LN1TXTF.
  1402         10  LN1TXTA PIC  X(0001).
  1403     05  LN1TXTI PIC  X(0068).
  1404*    -------------------------------
  1405     05  LN2HDGL PIC S9(0004) COMP.
  1406     05  LN2HDGF PIC  X(0001).
  1407     05  FILLER REDEFINES LN2HDGF.
  1408         10  LN2HDGA PIC  X(0001).
  1409     05  LN2HDGI PIC  X(0010).
  1410*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  32
* EL1501.cbl
  1411     05  LN2TXTL PIC S9(0004) COMP.
  1412     05  LN2TXTF PIC  X(0001).
  1413     05  FILLER REDEFINES LN2TXTF.
  1414         10  LN2TXTA PIC  X(0001).
  1415     05  LN2TXTI PIC  X(0068).
  1416*    -------------------------------
  1417     05  LN3HDGL PIC S9(0004) COMP.
  1418     05  LN3HDGF PIC  X(0001).
  1419     05  FILLER REDEFINES LN3HDGF.
  1420         10  LN3HDGA PIC  X(0001).
  1421     05  LN3HDGI PIC  X(0010).
  1422*    -------------------------------
  1423     05  LN3TXTL PIC S9(0004) COMP.
  1424     05  LN3TXTF PIC  X(0001).
  1425     05  FILLER REDEFINES LN3TXTF.
  1426         10  LN3TXTA PIC  X(0001).
  1427     05  LN3TXTI PIC  X(0068).
  1428*    -------------------------------
  1429     05  LN4HDGL PIC S9(0004) COMP.
  1430     05  LN4HDGF PIC  X(0001).
  1431     05  FILLER REDEFINES LN4HDGF.
  1432         10  LN4HDGA PIC  X(0001).
  1433     05  LN4HDGI PIC  X(0010).
  1434*    -------------------------------
  1435     05  LN4TXTL PIC S9(0004) COMP.
  1436     05  LN4TXTF PIC  X(0001).
  1437     05  FILLER REDEFINES LN4TXTF.
  1438         10  LN4TXTA PIC  X(0001).
  1439     05  LN4TXTI PIC  X(0068).
  1440*    -------------------------------
  1441     05  LN5HDGL PIC S9(0004) COMP.
  1442     05  LN5HDGF PIC  X(0001).
  1443     05  FILLER REDEFINES LN5HDGF.
  1444         10  LN5HDGA PIC  X(0001).
  1445     05  LN5HDGI PIC  X(0010).
  1446*    -------------------------------
  1447     05  LN5TXTL PIC S9(0004) COMP.
  1448     05  LN5TXTF PIC  X(0001).
  1449     05  FILLER REDEFINES LN5TXTF.
  1450         10  LN5TXTA PIC  X(0001).
  1451     05  LN5TXTI PIC  X(0068).
  1452*    -------------------------------
  1453     05  LN6HDGL PIC S9(0004) COMP.
  1454     05  LN6HDGF PIC  X(0001).
  1455     05  FILLER REDEFINES LN6HDGF.
  1456         10  LN6HDGA PIC  X(0001).
  1457     05  LN6HDGI PIC  X(0010).
  1458*    -------------------------------
  1459     05  LN6TXTL PIC S9(0004) COMP.
  1460     05  LN6TXTF PIC  X(0001).
  1461     05  FILLER REDEFINES LN6TXTF.
  1462         10  LN6TXTA PIC  X(0001).
  1463     05  LN6TXTI PIC  X(0068).
  1464*    -------------------------------
  1465     05  LN7HDGL PIC S9(0004) COMP.
  1466     05  LN7HDGF PIC  X(0001).
  1467     05  FILLER REDEFINES LN7HDGF.
  1468         10  LN7HDGA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  33
* EL1501.cbl
  1469     05  LN7HDGI PIC  X(0010).
  1470*    -------------------------------
  1471     05  LN7TXTL PIC S9(0004) COMP.
  1472     05  LN7TXTF PIC  X(0001).
  1473     05  FILLER REDEFINES LN7TXTF.
  1474         10  LN7TXTA PIC  X(0001).
  1475     05  LN7TXTI PIC  X(0068).
  1476*    -------------------------------
  1477     05  LN8HDGL PIC S9(0004) COMP.
  1478     05  LN8HDGF PIC  X(0001).
  1479     05  FILLER REDEFINES LN8HDGF.
  1480         10  LN8HDGA PIC  X(0001).
  1481     05  LN8HDGI PIC  X(0010).
  1482*    -------------------------------
  1483     05  LN8TXTL PIC S9(0004) COMP.
  1484     05  LN8TXTF PIC  X(0001).
  1485     05  FILLER REDEFINES LN8TXTF.
  1486         10  LN8TXTA PIC  X(0001).
  1487     05  LN8TXTI PIC  X(0068).
  1488*    -------------------------------
  1489     05  LN9HDGL PIC S9(0004) COMP.
  1490     05  LN9HDGF PIC  X(0001).
  1491     05  FILLER REDEFINES LN9HDGF.
  1492         10  LN9HDGA PIC  X(0001).
  1493     05  LN9HDGI PIC  X(0010).
  1494*    -------------------------------
  1495     05  LN9TXTL PIC S9(0004) COMP.
  1496     05  LN9TXTF PIC  X(0001).
  1497     05  FILLER REDEFINES LN9TXTF.
  1498         10  LN9TXTA PIC  X(0001).
  1499     05  LN9TXTI PIC  X(0068).
  1500*    -------------------------------
  1501     05  LN10HDGL PIC S9(0004) COMP.
  1502     05  LN10HDGF PIC  X(0001).
  1503     05  FILLER REDEFINES LN10HDGF.
  1504         10  LN10HDGA PIC  X(0001).
  1505     05  LN10HDGI PIC  X(0010).
  1506*    -------------------------------
  1507     05  LN10TXTL PIC S9(0004) COMP.
  1508     05  LN10TXTF PIC  X(0001).
  1509     05  FILLER REDEFINES LN10TXTF.
  1510         10  LN10TXTA PIC  X(0001).
  1511     05  LN10TXTI PIC  X(0068).
  1512*    -------------------------------
  1513     05  LN11HDGL PIC S9(0004) COMP.
  1514     05  LN11HDGF PIC  X(0001).
  1515     05  FILLER REDEFINES LN11HDGF.
  1516         10  LN11HDGA PIC  X(0001).
  1517     05  LN11HDGI PIC  X(0010).
  1518*    -------------------------------
  1519     05  LN11TXTL PIC S9(0004) COMP.
  1520     05  LN11TXTF PIC  X(0001).
  1521     05  FILLER REDEFINES LN11TXTF.
  1522         10  LN11TXTA PIC  X(0001).
  1523     05  LN11TXTI PIC  X(0068).
  1524*    -------------------------------
  1525     05  LN12HDGL PIC S9(0004) COMP.
  1526     05  LN12HDGF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  34
* EL1501.cbl
  1527     05  FILLER REDEFINES LN12HDGF.
  1528         10  LN12HDGA PIC  X(0001).
  1529     05  LN12HDGI PIC  X(0010).
  1530*    -------------------------------
  1531     05  LN12TXTL PIC S9(0004) COMP.
  1532     05  LN12TXTF PIC  X(0001).
  1533     05  FILLER REDEFINES LN12TXTF.
  1534         10  LN12TXTA PIC  X(0001).
  1535     05  LN12TXTI PIC  X(0068).
  1536*    -------------------------------
  1537     05  LN13HDGL PIC S9(0004) COMP.
  1538     05  LN13HDGF PIC  X(0001).
  1539     05  FILLER REDEFINES LN13HDGF.
  1540         10  LN13HDGA PIC  X(0001).
  1541     05  LN13HDGI PIC  X(0010).
  1542*    -------------------------------
  1543     05  LN13TXTL PIC S9(0004) COMP.
  1544     05  LN13TXTF PIC  X(0001).
  1545     05  FILLER REDEFINES LN13TXTF.
  1546         10  LN13TXTA PIC  X(0001).
  1547     05  LN13TXTI PIC  X(0068).
  1548*    -------------------------------
  1549     05  LN14HDGL PIC S9(0004) COMP.
  1550     05  LN14HDGF PIC  X(0001).
  1551     05  FILLER REDEFINES LN14HDGF.
  1552         10  LN14HDGA PIC  X(0001).
  1553     05  LN14HDGI PIC  X(0010).
  1554*    -------------------------------
  1555     05  LN14TXTL PIC S9(0004) COMP.
  1556     05  LN14TXTF PIC  X(0001).
  1557     05  FILLER REDEFINES LN14TXTF.
  1558         10  LN14TXTA PIC  X(0001).
  1559     05  LN14TXTI PIC  X(0068).
  1560*    -------------------------------
  1561     05  LN15HDGL PIC S9(0004) COMP.
  1562     05  LN15HDGF PIC  X(0001).
  1563     05  FILLER REDEFINES LN15HDGF.
  1564         10  LN15HDGA PIC  X(0001).
  1565     05  LN15HDGI PIC  X(0010).
  1566*    -------------------------------
  1567     05  LN15TXTL PIC S9(0004) COMP.
  1568     05  LN15TXTF PIC  X(0001).
  1569     05  FILLER REDEFINES LN15TXTF.
  1570         10  LN15TXTA PIC  X(0001).
  1571     05  LN15TXTI PIC  X(0068).
  1572*    -------------------------------
  1573     05  LN16HDGL PIC S9(0004) COMP.
  1574     05  LN16HDGF PIC  X(0001).
  1575     05  FILLER REDEFINES LN16HDGF.
  1576         10  LN16HDGA PIC  X(0001).
  1577     05  LN16HDGI PIC  X(0010).
  1578*    -------------------------------
  1579     05  TRLR8BL PIC S9(0004) COMP.
  1580     05  TRLR8BF PIC  X(0001).
  1581     05  FILLER REDEFINES TRLR8BF.
  1582         10  TRLR8BA PIC  X(0001).
  1583     05  TRLR8BI PIC  X(0068).
  1584*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  35
* EL1501.cbl
  1585     05  ERRMSG1L PIC S9(0004) COMP.
  1586     05  ERRMSG1F PIC  X(0001).
  1587     05  FILLER REDEFINES ERRMSG1F.
  1588         10  ERRMSG1A PIC  X(0001).
  1589     05  ERRMSG1I PIC  X(0079).
  1590*    -------------------------------
  1591     05  LINENOL PIC S9(0004) COMP.
  1592     05  LINENOF PIC  X(0001).
  1593     05  FILLER REDEFINES LINENOF.
  1594         10  LINENOA PIC  X(0001).
  1595     05  LINENOI PIC  X(0001).
  1596*    -------------------------------
  1597     05  RECVDTL PIC S9(0004) COMP.
  1598     05  RECVDTF PIC  X(0001).
  1599     05  FILLER REDEFINES RECVDTF.
  1600         10  RECVDTA PIC  X(0001).
  1601     05  RECVDTI PIC  X(0008).
  1602*    -------------------------------
  1603     05  RECVTYPL PIC S9(0004) COMP.
  1604     05  RECVTYPF PIC  X(0001).
  1605     05  FILLER REDEFINES RECVTYPF.
  1606         10  RECVTYPA PIC  X(0001).
  1607     05  RECVTYPI PIC  X(0001).
  1608*    -------------------------------
  1609     05  ENTERPFL PIC S9(0004) COMP.
  1610     05  ENTERPFF PIC  X(0001).
  1611     05  FILLER REDEFINES ENTERPFF.
  1612         10  ENTERPFA PIC  X(0001).
  1613     05  ENTERPFI PIC  99.
  1614*    -------------------------------
  1615     05  PF5L PIC S9(0004) COMP.
  1616     05  PF5F PIC  X(0001).
  1617     05  FILLER REDEFINES PF5F.
  1618         10  PF5A PIC  X(0001).
  1619     05  PF5I PIC  X(0016).
  1620*    -------------------------------
  1621     05  PF6L PIC S9(0004) COMP.
  1622     05  PF6F PIC  X(0001).
  1623     05  FILLER REDEFINES PF6F.
  1624         10  PF6A PIC  X(0001).
  1625     05  PF6I PIC  X(0016).
  1626 01  EL150BO REDEFINES EL150BI.
  1627     05  FILLER            PIC  X(0012).
  1628*    -------------------------------
  1629     05  FILLER            PIC  X(0003).
  1630     05  RUNDTEO PIC  X(0008).
  1631*    -------------------------------
  1632     05  FILLER            PIC  X(0003).
  1633     05  RUNTIMEO PIC  99.99.
  1634*    -------------------------------
  1635     05  FILLER            PIC  X(0003).
  1636     05  CLMNOO PIC  X(0007).
  1637*    -------------------------------
  1638     05  FILLER            PIC  X(0003).
  1639     05  CARRO PIC  X(0001).
  1640*    -------------------------------
  1641     05  FILLER            PIC  X(0003).
  1642     05  CERTNOO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  36
* EL1501.cbl
  1643*    -------------------------------
  1644     05  FILLER            PIC  X(0003).
  1645     05  SUFXO PIC  X(0001).
  1646*    -------------------------------
  1647     05  FILLER            PIC  X(0003).
  1648     05  LN1HDGO PIC  X(0010).
  1649*    -------------------------------
  1650     05  FILLER            PIC  X(0003).
  1651     05  LN1TXTO PIC  X(0068).
  1652*    -------------------------------
  1653     05  FILLER            PIC  X(0003).
  1654     05  LN2HDGO PIC  X(0010).
  1655*    -------------------------------
  1656     05  FILLER            PIC  X(0003).
  1657     05  LN2TXTO PIC  X(0068).
  1658*    -------------------------------
  1659     05  FILLER            PIC  X(0003).
  1660     05  LN3HDGO PIC  X(0010).
  1661*    -------------------------------
  1662     05  FILLER            PIC  X(0003).
  1663     05  LN3TXTO PIC  X(0068).
  1664*    -------------------------------
  1665     05  FILLER            PIC  X(0003).
  1666     05  LN4HDGO PIC  X(0010).
  1667*    -------------------------------
  1668     05  FILLER            PIC  X(0003).
  1669     05  LN4TXTO PIC  X(0068).
  1670*    -------------------------------
  1671     05  FILLER            PIC  X(0003).
  1672     05  LN5HDGO PIC  X(0010).
  1673*    -------------------------------
  1674     05  FILLER            PIC  X(0003).
  1675     05  LN5TXTO PIC  X(0068).
  1676*    -------------------------------
  1677     05  FILLER            PIC  X(0003).
  1678     05  LN6HDGO PIC  X(0010).
  1679*    -------------------------------
  1680     05  FILLER            PIC  X(0003).
  1681     05  LN6TXTO PIC  X(0068).
  1682*    -------------------------------
  1683     05  FILLER            PIC  X(0003).
  1684     05  LN7HDGO PIC  X(0010).
  1685*    -------------------------------
  1686     05  FILLER            PIC  X(0003).
  1687     05  LN7TXTO PIC  X(0068).
  1688*    -------------------------------
  1689     05  FILLER            PIC  X(0003).
  1690     05  LN8HDGO PIC  X(0010).
  1691*    -------------------------------
  1692     05  FILLER            PIC  X(0003).
  1693     05  LN8TXTO PIC  X(0068).
  1694*    -------------------------------
  1695     05  FILLER            PIC  X(0003).
  1696     05  LN9HDGO PIC  X(0010).
  1697*    -------------------------------
  1698     05  FILLER            PIC  X(0003).
  1699     05  LN9TXTO PIC  X(0068).
  1700*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  37
* EL1501.cbl
  1701     05  FILLER            PIC  X(0003).
  1702     05  LN10HDGO PIC  X(0010).
  1703*    -------------------------------
  1704     05  FILLER            PIC  X(0003).
  1705     05  LN10TXTO PIC  X(0068).
  1706*    -------------------------------
  1707     05  FILLER            PIC  X(0003).
  1708     05  LN11HDGO PIC  X(0010).
  1709*    -------------------------------
  1710     05  FILLER            PIC  X(0003).
  1711     05  LN11TXTO PIC  X(0068).
  1712*    -------------------------------
  1713     05  FILLER            PIC  X(0003).
  1714     05  LN12HDGO PIC  X(0010).
  1715*    -------------------------------
  1716     05  FILLER            PIC  X(0003).
  1717     05  LN12TXTO PIC  X(0068).
  1718*    -------------------------------
  1719     05  FILLER            PIC  X(0003).
  1720     05  LN13HDGO PIC  X(0010).
  1721*    -------------------------------
  1722     05  FILLER            PIC  X(0003).
  1723     05  LN13TXTO PIC  X(0068).
  1724*    -------------------------------
  1725     05  FILLER            PIC  X(0003).
  1726     05  LN14HDGO PIC  X(0010).
  1727*    -------------------------------
  1728     05  FILLER            PIC  X(0003).
  1729     05  LN14TXTO PIC  X(0068).
  1730*    -------------------------------
  1731     05  FILLER            PIC  X(0003).
  1732     05  LN15HDGO PIC  X(0010).
  1733*    -------------------------------
  1734     05  FILLER            PIC  X(0003).
  1735     05  LN15TXTO PIC  X(0068).
  1736*    -------------------------------
  1737     05  FILLER            PIC  X(0003).
  1738     05  LN16HDGO PIC  X(0010).
  1739*    -------------------------------
  1740     05  FILLER            PIC  X(0003).
  1741     05  TRLR8BO PIC  X(0068).
  1742*    -------------------------------
  1743     05  FILLER            PIC  X(0003).
  1744     05  ERRMSG1O PIC  X(0079).
  1745*    -------------------------------
  1746     05  FILLER            PIC  X(0003).
  1747     05  LINENOO PIC  X(0001).
  1748*    -------------------------------
  1749     05  FILLER            PIC  X(0003).
  1750     05  RECVDTO PIC  X(0008).
  1751*    -------------------------------
  1752     05  FILLER            PIC  X(0003).
  1753     05  RECVTYPO PIC  X(0001).
  1754*    -------------------------------
  1755     05  FILLER            PIC  X(0003).
  1756     05  ENTERPFO PIC  X(0002).
  1757*    -------------------------------
  1758     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  38
* EL1501.cbl
  1759     05  PF5O PIC  X(0016).
  1760*    -------------------------------
  1761     05  FILLER            PIC  X(0003).
  1762     05  PF6O PIC  X(0016).
  1763*    -------------------------------
  1764 01  EL150BI-R REDEFINES EL150BI.
  1765     12  FILLER                      PIC X(62).
  1766     12  EL150BI-OCCURS OCCURS 16.
  1767         16  MAP-HDG-LENGTH          PIC S9(4)   COMP.
  1768         16  MAP-HDG-ATTRB           PIC X.
  1769         16  MAP-HDG.
  1770             20  MAP-LINE-NO         PIC X.
  1771             20  FILLER              PIC X.
  1772             20  MAP-HDG-LIT         PIC X(8).
  1773         16  MAP-TEXT-LENGTH         PIC S9(4)   COMP.
  1774         16  MAP-TEXT-ATTRB          PIC X.
  1775         16  MAP-TEXT                PIC X(68).
  1776
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  39
* EL1501.cbl
  1778****************************************************************
  1779*
  1780* Copyright (c) 2007 by Clerity Solutions, Inc.
  1781* All rights reserved.
  1782*
  1783****************************************************************
  1784 01  DFHEIV.
  1785   02  DFHEIV0               PIC X(35).
  1786   02  DFHEIV1               PIC X(08).
  1787   02  DFHEIV2               PIC X(08).
  1788   02  DFHEIV3               PIC X(08).
  1789   02  DFHEIV4               PIC X(06).
  1790   02  DFHEIV5               PIC X(04).
  1791   02  DFHEIV6               PIC X(04).
  1792   02  DFHEIV7               PIC X(02).
  1793   02  DFHEIV8               PIC X(02).
  1794   02  DFHEIV9               PIC X(01).
  1795   02  DFHEIV10              PIC S9(7) COMP-3.
  1796   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1797   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1798   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1799   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1800   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1801   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1802   02  DFHEIV17              PIC X(04).
  1803   02  DFHEIV18              PIC X(04).
  1804   02  DFHEIV19              PIC X(04).
  1805   02  DFHEIV20              USAGE IS POINTER.
  1806   02  DFHEIV21              USAGE IS POINTER.
  1807   02  DFHEIV22              USAGE IS POINTER.
  1808   02  DFHEIV23              USAGE IS POINTER.
  1809   02  DFHEIV24              USAGE IS POINTER.
  1810   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1811   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1812   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1813   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1814   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1815   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1816   02  FILLER                PIC X(02).
  1817   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1818   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1819   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1820   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1821   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1822 LINKAGE  SECTION.
  1823*****************************************************************
  1824*                                                               *
  1825* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1826* All rights reserved.                                          *
  1827*                                                               *
  1828*****************************************************************
  1829 01  dfheiblk.
  1830     02  eibtime          pic s9(7) comp-3.
  1831     02  eibdate          pic s9(7) comp-3.
  1832     02  eibtrnid         pic x(4).
  1833     02  eibtaskn         pic s9(7) comp-3.
  1834     02  eibtrmid         pic x(4).
  1835     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  40
* EL1501.cbl
  1836     02  eibcposn         pic s9(4) comp.
  1837     02  eibcalen         pic s9(4) comp.
  1838     02  eibaid           pic x(1).
  1839     02  eibfiller1       pic x(1).
  1840     02  eibfn            pic x(2).
  1841     02  eibfiller2       pic x(2).
  1842     02  eibrcode         pic x(6).
  1843     02  eibfiller3       pic x(2).
  1844     02  eibds            pic x(8).
  1845     02  eibreqid         pic x(8).
  1846     02  eibrsrce         pic x(8).
  1847     02  eibsync          pic x(1).
  1848     02  eibfree          pic x(1).
  1849     02  eibrecv          pic x(1).
  1850     02  eibsend          pic x(1).
  1851     02  eibatt           pic x(1).
  1852     02  eibeoc           pic x(1).
  1853     02  eibfmh           pic x(1).
  1854     02  eibcompl         pic x(1).
  1855     02  eibsig           pic x(1).
  1856     02  eibconf          pic x(1).
  1857     02  eiberr           pic x(1).
  1858     02  eibrldbk         pic x(1).
  1859     02  eiberrcd         pic x(4).
  1860     02  eibsynrb         pic x(1).
  1861     02  eibnodat         pic x(1).
  1862     02  eibfiller5       pic x(2).
  1863     02  eibresp          pic 9(09) comp.
  1864     02  eibresp2         pic 9(09) comp.
  1865     02  dfheigdj         pic s9(4) comp.
  1866     02  dfheigdk         pic s9(4) comp.
  1867 01  DFHCOMMAREA                     PIC X(1024).
  1868
  1869*                                    COPY ELCMSTR.
  1870******************************************************************
  1871*                                                                *
  1872*                            ELCMSTR.                            *
  1873*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1874*                            VMOD=2.012                          *
  1875*                                                                *
  1876*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  1877*                                                                *
  1878*   FILE TYPE = VSAM,KSDS                                        *
  1879*   RECORD SIZE = 350  RECFORM = FIXED                           *
  1880*                                                                *
  1881*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  1882*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  1883*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  1884*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  1885*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  1886*                                                 RKP=75,LEN=21  *
  1887*                                                                *
  1888*   **** NOTE ****                                               *
  1889*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  1890*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  1891*                                                                *
  1892*   LOG = YES                                                    *
  1893*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  41
* EL1501.cbl
  1894******************************************************************
  1895*                   C H A N G E   L O G
  1896*
  1897* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1898*-----------------------------------------------------------------
  1899*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1900* EFFECTIVE    NUMBER
  1901*-----------------------------------------------------------------
  1902* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1903* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1904* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  1905******************************************************************
  1906 01  CLAIM-MASTER.
  1907     12  CL-RECORD-ID                PIC XX.
  1908         88  VALID-CL-ID         VALUE 'CL'.
  1909
  1910     12  CL-CONTROL-PRIMARY.
  1911         16  CL-COMPANY-CD           PIC X.
  1912         16  CL-CARRIER              PIC X.
  1913         16  CL-CLAIM-NO             PIC X(7).
  1914         16  CL-CERT-NO.
  1915             20  CL-CERT-PRIME       PIC X(10).
  1916             20  CL-CERT-SFX         PIC X.
  1917
  1918     12  CL-CONTROL-BY-NAME.
  1919         16  CL-COMPANY-CD-A1        PIC X.
  1920         16  CL-INSURED-LAST-NAME    PIC X(15).
  1921         16  CL-INSURED-NAME.
  1922             20  CL-INSURED-1ST-NAME PIC X(12).
  1923             20  CL-INSURED-MID-INIT PIC X.
  1924
  1925     12  CL-CONTROL-BY-SSN.
  1926         16  CL-COMPANY-CD-A2        PIC X.
  1927         16  CL-SOC-SEC-NO.
  1928             20  CL-SSN-STATE        PIC XX.
  1929             20  CL-SSN-ACCOUNT      PIC X(6).
  1930             20  CL-SSN-LN3          PIC X(3).
  1931
  1932     12  CL-CONTROL-BY-CERT-NO.
  1933         16  CL-COMPANY-CD-A4        PIC X.
  1934         16  CL-CERT-NO-A4.
  1935             20  CL-CERT-A4-PRIME    PIC X(10).
  1936             20  CL-CERT-A4-SFX      PIC X.
  1937
  1938     12  CL-CONTROL-BY-CCN.
  1939         16  CL-COMPANY-CD-A5        PIC X.
  1940         16  CL-CCN-A5.
  1941             20  CL-CCN.
  1942                 24  CL-CCN-PREFIX-A5 PIC X(4).
  1943                 24  CL-CCN-PRIME-A5 PIC X(12).
  1944             20  CL-CCN-FILLER-A5    PIC X(4).
  1945
  1946     12  CL-INSURED-PROFILE-DATA.
  1947         16  CL-INSURED-BIRTH-DT     PIC XX.
  1948         16  CL-INSURED-SEX-CD       PIC X.
  1949             88  INSURED-IS-MALE        VALUE 'M'.
  1950             88  INSURED-IS-FEMALE      VALUE 'F'.
  1951             88  INSURED-SEX-UNKNOWN    VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  42
* EL1501.cbl
  1952         16  CL-INSURED-OCC-CD       PIC X(6).
  1953         16  FILLER                  PIC X(5).
  1954
  1955     12  CL-PROCESSING-INFO.
  1956         16  CL-PROCESSOR-ID         PIC X(4).
  1957         16  CL-CLAIM-STATUS         PIC X.
  1958             88  CLAIM-IS-OPEN          VALUE 'O'.
  1959             88  CLAIM-IS-CLOSED        VALUE 'C'.
  1960         16  CL-CLAIM-TYPE           PIC X.
  1961*            88  AH-CLAIM               VALUE 'A'.
  1962*            88  LIFE-CLAIM             VALUE 'L'.
  1963*            88  PROPERTY-CLAIM         VALUE 'P'.
  1964*            88  IUI-CLAIM              VALUE 'I'.
  1965*            88  GAP-CLAIM              VALUE 'G'.
  1966         16  CL-CLAIM-PREM-TYPE      PIC X.
  1967             88  SINGLE-PREMIUM         VALUE '1'.
  1968             88  O-B-COVERAGE           VALUE '2'.
  1969             88  OPEN-END-COVERAGE      VALUE '3'.
  1970         16  CL-INCURRED-DT          PIC XX.
  1971         16  CL-REPORTED-DT          PIC XX.
  1972         16  CL-FILE-ESTABLISH-DT    PIC XX.
  1973         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  1974         16  CL-LAST-PMT-DT          PIC XX.
  1975         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  1976         16  CL-PAID-THRU-DT         PIC XX.
  1977         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  1978         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  1979         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  1980         16  CL-PMT-CALC-METHOD      PIC X.
  1981             88  CL-360-DAY-YR          VALUE '1'.
  1982             88  CL-365-DAY-YR          VALUE '2'.
  1983             88  CL-FULL-MONTHS         VALUE '3'.
  1984         16  CL-CAUSE-CD             PIC X(6).
  1985
  1986         16  CL-PRIME-CERT-NO.
  1987             20  CL-PRIME-CERT-PRIME PIC X(10).
  1988             20  CL-PRIME-CERT-SFX   PIC X.
  1989
  1990         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  1991             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  1992             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  1993
  1994         16  CL-MICROFILM-NO         PIC X(10).
  1995         16  CL-PROG-FORM-TYPE       PIC X.
  1996         16  CL-LAST-ADD-ON-DT       PIC XX.
  1997
  1998         16  CL-LAST-REOPEN-DT       PIC XX.
  1999         16  CL-LAST-CLOSE-DT        PIC XX.
  2000         16  CL-LAST-CLOSE-REASON    PIC X(01).
  2001             88  FINAL-PAID             VALUE '1'.
  2002             88  CLAIM-DENIED           VALUE '2'.
  2003             88  AUTO-CLOSE             VALUE '3'.
  2004             88  MANUAL-CLOSE           VALUE '4'.
  2005             88  BENEFITS-CHANGED       VALUE 'C'.
  2006             88  SETUP-ERRORS           VALUE 'E'.
  2007         16  CL-ASSOC-CERT-SEQU      PIC S99.
  2008         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  2009         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  43
* EL1501.cbl
  2010             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  2011         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  2012         16  FILLER                  PIC X.
  2013
  2014     12  CL-CERTIFICATE-DATA.
  2015         16  CL-CERT-ORIGIN          PIC X.
  2016             88  CERT-WAS-ONLINE        VALUE '1'.
  2017             88  CERT-WAS-CREATED       VALUE '2'.
  2018             88  COVERAGE-WAS-ADDED     VALUE '3'.
  2019         16  CL-CERT-KEY-DATA.
  2020             20  CL-CERT-CARRIER     PIC X.
  2021             20  CL-CERT-GROUPING    PIC X(6).
  2022             20  CL-CERT-STATE       PIC XX.
  2023             20  CL-CERT-ACCOUNT.
  2024                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  2025                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  2026             20  CL-CERT-EFF-DT      PIC XX.
  2027
  2028     12  CL-STATUS-CONTROLS.
  2029         16  CL-PRIORITY-CD          PIC X.
  2030             88  CONFIDENTIAL-DATA      VALUE '8'.
  2031             88  HIGHEST-PRIORITY       VALUE '9'.
  2032         16  CL-SUPV-ATTN-CD         PIC X.
  2033             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  2034             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  2035         16  CL-PURGED-DT            PIC XX.
  2036         16  CL-RESTORED-DT          PIC XX.
  2037         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  2038         16  CL-NEXT-RESEND-DT       PIC XX.
  2039         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  2040         16  CL-CRITICAL-PERIOD      PIC 99.
  2041*        16  FILLER                  PIC XX.
  2042         16  CL-LAST-MAINT-DT        PIC XX.
  2043         16  CL-LAST-MAINT-USER      PIC X(4).
  2044         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  2045         16  CL-LAST-MAINT-TYPE      PIC X.
  2046             88  CLAIM-SET-UP           VALUE ' '.
  2047             88  PAYMENT-MADE           VALUE '1'.
  2048             88  LETTER-SENT            VALUE '2'.
  2049             88  MASTER-WAS-ALTERED     VALUE '3'.
  2050             88  MASTER-WAS-RESTORED    VALUE '4'.
  2051             88  INCURRED-DATE-CHANGED  VALUE '5'.
  2052             88  FILE-CONVERTED         VALUE '6'.
  2053             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  2054             88  ERROR-CORRECTION       VALUE 'E'.
  2055         16  CL-RELATED-CLAIM-NO     PIC X(7).
  2056         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  2057         16  CL-BENEFICIARY          PIC X(10).
  2058         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  2059         16  CL-DENIAL-TYPE          PIC X.
  2060             88  CL-TYPE-DENIAL          VALUE '1'.
  2061             88  CL-TYPE-RESCISSION      VALUE '2'.
  2062             88  CL-TYPE-REFORMATION     VALUE '3'.
  2063             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  2064             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  2065         16  CL-CRIT-PER-RECURRENT   PIC X.
  2066         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  2067         16  CL-RTW-DT               PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  44
* EL1501.cbl
  2068
  2069     12  CL-TRAILER-CONTROLS.
  2070         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  2071             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  2072             88  CL-LAST-TRL-AVAIL      VALUE +100.
  2073             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  2074         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  2075         16  FILLER                  PIC XX.
  2076         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  2077         16  CL-ADDRESS-TRAILER-CNT.
  2078             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  2079                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  2080             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  2081                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  2082             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  2083                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  2084             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  2085                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  2086             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  2087                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  2088             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  2089                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  2090             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  2091                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  2092
  2093     12  CL-CV-REFERENCE-NO.
  2094         16  CL-CV-REFNO-PRIME       PIC X(18).
  2095         16  CL-CV-REFNO-SFX         PIC XX.
  2096
  2097     12  CL-FILE-LOCATION            PIC X(4).
  2098
  2099     12  CL-PROCESS-ERRORS.
  2100         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  2101             88  NO-FATAL-ERRORS        VALUE ZERO.
  2102         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  2103             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  2104
  2105     12  CL-PRODUCT-CD               PIC X.
  2106
  2107     12  CL-CURRENT-KEY-DATA.
  2108         16  CL-CURRENT-CARRIER      PIC X.
  2109         16  CL-CURRENT-GROUPING     PIC X(6).
  2110         16  CL-CURRENT-STATE        PIC XX.
  2111         16  CL-CURRENT-ACCOUNT      PIC X(10).
  2112
  2113     12  CL-ASSOCIATES               PIC X.
  2114         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  2115         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  2116         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  2117         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  2118
  2119     12  CL-ACTIVITY-CODE            PIC 99.
  2120     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  2121     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  2122
  2123     12  CL-LAPSE-REPORT-CODE        PIC 9.
  2124     12  CL-LAG-REPORT-CODE          PIC 9.
  2125     12  CL-LOAN-TYPE                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  45
* EL1501.cbl
  2126     12  CL-LEGAL-STATE              PIC XX.
  2127
  2128     12  CL-YESNOSW                  PIC X.
  2129     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  2130         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  2131         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  2132         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  2133     12  cl-insured-claim            pic x.
  2134         88  cl-claim-on-primary         value 'P'.
  2135         88  cl-claim-on-secondary       value 'S'.
  2136     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  46
* EL1501.cbl
  2138*                                    COPY ELCCNTL.
  2139******************************************************************
  2140*                                                                *
  2141*                                                                *
  2142*                            ELCCNTL.                            *
  2143*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2144*                            VMOD=2.059                          *
  2145*                                                                *
  2146*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2147*                                                                *
  2148*   FILE TYPE = VSAM,KSDS                                        *
  2149*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2150*                                                                *
  2151*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2152*       ALTERNATE INDEX = NONE                                   *
  2153*                                                                *
  2154*   LOG = YES                                                    *
  2155*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2156******************************************************************
  2157*                   C H A N G E   L O G
  2158*
  2159* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2160*-----------------------------------------------------------------
  2161*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2162* EFFECTIVE    NUMBER
  2163*-----------------------------------------------------------------
  2164* 082503                   PEMA  ADD BENEFIT GROUP
  2165* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2166* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2167* 092705    2005050300006  PEMA  ADD SPP LEASES
  2168* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2169* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2170* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2171* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2172* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2173* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2174* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2175* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2176* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2177******************************************************************
  2178*
  2179 01  CONTROL-FILE.
  2180     12  CF-RECORD-ID                       PIC XX.
  2181         88  VALID-CF-ID                        VALUE 'CF'.
  2182
  2183     12  CF-CONTROL-PRIMARY.
  2184         16  CF-COMPANY-ID                  PIC XXX.
  2185         16  CF-RECORD-TYPE                 PIC X.
  2186             88  CF-COMPANY-MASTER              VALUE '1'.
  2187             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2188             88  CF-STATE-MASTER                VALUE '3'.
  2189             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2190             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2191             88  CF-CARRIER-MASTER              VALUE '6'.
  2192             88  CF-MORTALITY-MASTER            VALUE '7'.
  2193             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2194             88  CF-TERMINAL-MASTER             VALUE '9'.
  2195             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  47
* EL1501.cbl
  2196             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2197             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2198             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2199             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2200             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2201             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2202             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2203             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2204         16  CF-ACCESS-CD-GENL              PIC X(4).
  2205         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2206             20  CF-PROCESSOR               PIC X(4).
  2207         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2208             20  CF-STATE-CODE              PIC XX.
  2209             20  FILLER                     PIC XX.
  2210         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2211             20  FILLER                     PIC XX.
  2212             20  CF-HI-BEN-IN-REC           PIC XX.
  2213         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2214             20  FILLER                     PIC XXX.
  2215             20  CF-CARRIER-CNTL            PIC X.
  2216         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2217             20  FILLER                     PIC XX.
  2218             20  CF-HI-TYPE-IN-REC          PIC 99.
  2219         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2220             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2221                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2222             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2223             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2224         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2225             20  FILLER                     PIC X.
  2226             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2227         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2228             20  FILLER                     PIC XX.
  2229             20  CF-MORTGAGE-PLAN           PIC XX.
  2230         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2231
  2232     12  CF-LAST-MAINT-DT                   PIC XX.
  2233     12  CF-LAST-MAINT-BY                   PIC X(4).
  2234     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2235
  2236     12  CF-RECORD-BODY                     PIC X(728).
  2237
  2238
  2239****************************************************************
  2240*             COMPANY MASTER RECORD                            *
  2241****************************************************************
  2242
  2243     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2244         16  CF-COMPANY-ADDRESS.
  2245             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2246             20  CF-CL-IN-CARE-OF           PIC X(30).
  2247             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2248             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2249             20  CF-CL-CITY-STATE           PIC X(30).
  2250             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2251             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2252         16  CF-COMPANY-CD                  PIC X.
  2253         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  48
* EL1501.cbl
  2254         16  CF-SECURITY-OPTION             PIC X.
  2255             88  ALL-SECURITY                   VALUE '1'.
  2256             88  COMPANY-VERIFY                 VALUE '2'.
  2257             88  PROCESSOR-VERIFY               VALUE '3'.
  2258             88  NO-SECURITY                    VALUE '4'.
  2259             88  ALL-BUT-TERM                   VALUE '5'.
  2260         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2261             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2262         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2263             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2264         16  CF-INFORCE-LOCATION            PIC X.
  2265             88  CERTS-ARE-ONLINE               VALUE '1'.
  2266             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2267             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2268         16  CF-LOWER-CASE-LETTERS          PIC X.
  2269         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2270             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2271             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2272             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2273             88  CF-ACCNT-CNTL                  VALUE '3'.
  2274             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2275
  2276         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2277         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2278
  2279         16  CF-LGX-CREDIT-USER             PIC X.
  2280             88  CO-IS-NOT-USER                 VALUE 'N'.
  2281             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2282
  2283         16 CF-CREDIT-CALC-CODES.
  2284             20  CF-CR-REM-TERM-CALC PIC X.
  2285               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2286               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2287               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2288               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2289               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2290               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2291               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2292             20  CF-CR-R78-METHOD           PIC X.
  2293               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2294               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2295
  2296         16  CF-CLAIM-CONTROL-COUNTS.
  2297             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2298                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2299
  2300             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2301                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2302
  2303             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2304                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2305
  2306             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2307                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2308
  2309         16  CF-CURRENT-MONTH-END           PIC XX.
  2310
  2311         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  49
* EL1501.cbl
  2312             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2313             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2314             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2315             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2316                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2317                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2318             20  CF-CO-PREM-REJECT-SW       PIC X.
  2319                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2320                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2321             20  CF-CO-REF-REJECT-SW        PIC X.
  2322                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2323                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2324
  2325         16  CF-CO-REPORTING-DT             PIC XX.
  2326         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2327         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2328           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2329           88  CF-CO-MONTH-END                  VALUE '1'.
  2330
  2331         16  CF-LGX-CLAIM-USER              PIC X.
  2332             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2333             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2334
  2335         16  CF-CREDIT-EDIT-CONTROLS.
  2336             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2337             20  CF-MIN-AGE                 PIC 99.
  2338             20  CF-DEFAULT-AGE             PIC 99.
  2339             20  CF-MIN-TERM                PIC S999      COMP-3.
  2340             20  CF-MAX-TERM                PIC S999      COMP-3.
  2341             20  CF-DEFAULT-SEX             PIC X.
  2342             20  CF-JOINT-AGE-INPUT         PIC X.
  2343                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2344             20  CF-BIRTH-DATE-INPUT        PIC X.
  2345                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2346             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2347                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2348                 88  CF-ZERO-CARRIER            VALUE '1'.
  2349                 88  CF-ZERO-GROUPING           VALUE '2'.
  2350                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2351             20  CF-EDIT-SW                 PIC X.
  2352                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2353             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2354             20  CF-CR-PR-METHOD            PIC X.
  2355               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2356               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2357             20  FILLER                     PIC X.
  2358
  2359         16  CF-CREDIT-MISC-CONTROLS.
  2360             20  CF-REIN-TABLE-SW           PIC X.
  2361                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2362             20  CF-COMP-TABLE-SW           PIC X.
  2363                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2364             20  CF-EXPERIENCE-RETENTION-AGE
  2365                                            PIC S9        COMP-3.
  2366             20  CF-CONVERSION-DT           PIC XX.
  2367             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2368             20  CF-RUN-FREQUENCY-SW        PIC X.
  2369                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  50
* EL1501.cbl
  2370                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2371
  2372             20  CF-CR-CHECK-NO-CONTROL.
  2373                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2374                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2375                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2376                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2377                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2378                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2379
  2380                 24  CF-CR-CHECK-COUNT       REDEFINES
  2381                     CF-CR-CHECK-COUNTER      PIC X(4).
  2382
  2383                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2384                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2385
  2386                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2387                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2388                 24  CF-MAIL-PROCESSING       PIC X.
  2389                     88  MAIL-PROCESSING          VALUE 'Y'.
  2390
  2391         16  CF-MISC-SYSTEM-CONTROL.
  2392             20  CF-SYSTEM-C                 PIC X.
  2393                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2394             20  CF-SYSTEM-D                 PIC X.
  2395                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2396             20  CF-SOC-SEC-NO-SW            PIC X.
  2397                 88  SOC-SEC-NO-USED             VALUE '1'.
  2398             20  CF-MEMBER-NO-SW             PIC X.
  2399                 88  MEMBER-NO-USED              VALUE '1'.
  2400             20  CF-TAX-ID-NUMBER            PIC X(11).
  2401             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2402             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2403                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2404                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2405                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2406                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2407             20  CF-SYSTEM-E                 PIC X.
  2408                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2409
  2410         16  CF-LGX-LIFE-USER               PIC X.
  2411             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2412             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2413
  2414         16  CF-CR-MONTH-END-DT             PIC XX.
  2415
  2416         16  CF-FILE-MAINT-DATES.
  2417             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2418                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2419             20  CF-LAST-BATCH       REDEFINES
  2420                 CF-LAST-BATCH-NO               PIC X(4).
  2421             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2422             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2423             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2424             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2425             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2426             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2427             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  51
* EL1501.cbl
  2428             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2429             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2430             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2431
  2432         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2433         16  FILLER                         PIC X.
  2434
  2435         16  CF-ALT-MORT-CODE               PIC X(4).
  2436         16  CF-MEMBER-CAPTION              PIC X(10).
  2437
  2438         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2439             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2440             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2441             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2442             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2443             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2444
  2445         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2446
  2447         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2448         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2449         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2450         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2451
  2452         16  CF-AH-OVERRIDE-L1              PIC X.
  2453         16  CF-AH-OVERRIDE-L2              PIC XX.
  2454         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2455         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2456
  2457         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2458         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2459
  2460         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2461         16  CF-AR-LAST-EL860-DT            PIC XX.
  2462         16  CF-MP-MONTH-END-DT             PIC XX.
  2463
  2464         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2465         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2466             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2467
  2468         16  CF-AR-MONTH-END-DT             PIC XX.
  2469
  2470         16  CF-CRDTCRD-USER                PIC X.
  2471             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2472             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2473
  2474         16  CF-CC-MONTH-END-DT             PIC XX.
  2475
  2476         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2477
  2478         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2479             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2480             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2481             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2482         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2483         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2484         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2485         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  52
* EL1501.cbl
  2486             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2487             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2488         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2489         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2490         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2491             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2492         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2493
  2494         16  CF-CL-ZIP-CODE.
  2495             20  CF-CL-ZIP-PRIME.
  2496                 24  CF-CL-ZIP-1ST          PIC X.
  2497                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2498                 24  FILLER                 PIC X(4).
  2499             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2500         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2501             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2502             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2503             20  FILLER                     PIC XXX.
  2504
  2505         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2506         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2507         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2508         16  CF-CO-OPTION-START-DATE        PIC XX.
  2509         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2510           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2511                                                      '3' '4'.
  2512           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2513           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2514           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2515           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2516           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2517           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2518
  2519         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2520
  2521         16  CF-PAYMENT-APPROVAL-LEVELS.
  2522             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2523             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2524             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2525             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2526             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2527             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2528
  2529         16  CF-END-USER-REPORTING-USER     PIC X.
  2530             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2531             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2532
  2533         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2534             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2535             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2536
  2537         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2538
  2539         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2540         16  FILLER                         PIC X.
  2541
  2542         16  CF-CREDIT-ARCHIVE-CNTL.
  2543             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  53
* EL1501.cbl
  2544             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2545             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2546
  2547         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2548
  2549         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2550             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2551             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2552
  2553         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2554             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2555             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2556
  2557         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2558
  2559         16  CF-CO-ACH-ID-CODE              PIC  X.
  2560             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2561             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2562             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2563         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2564         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2565         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2566         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2567         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2568         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2569         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2570         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2571         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2572                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2573         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2574                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2575
  2576         16  CF-CO-OVER-SHORT.
  2577             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2578             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2579
  2580*         16  FILLER                         PIC X(102).
  2581         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2582             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2583             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2584
  2585         16  CF-AH-APPROVAL-DAYS.
  2586             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2587             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2588             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2589             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2590
  2591         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2592
  2593         16  CF-APPROV-LEV-5.
  2594             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2595             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2596             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2597
  2598         16  FILLER                         PIC X(68).
  2599****************************************************************
  2600*             PROCESSOR/USER RECORD                            *
  2601****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  54
* EL1501.cbl
  2602
  2603     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2604         16  CF-PROCESSOR-NAME              PIC X(30).
  2605         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2606         16  CF-PROCESSOR-TITLE             PIC X(26).
  2607         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2608                 88  MESSAGE-YES                VALUE 'Y'.
  2609                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2610
  2611*****************************************************
  2612****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2613****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2614****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2615****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2616*****************************************************
  2617
  2618         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2619             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2620             20  CF-APPLICATION-FORCE       PIC X.
  2621             20  CF-INDIVIDUAL-APP.
  2622                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2623                     28  CF-BROWSE-APP      PIC X.
  2624                     28  CF-UPDATE-APP      PIC X.
  2625
  2626         16  CF-CURRENT-TERM-ON             PIC X(4).
  2627         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2628             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2629             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2630             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2631             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2632             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2633             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2634             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2635         16  CF-PROCESSOR-CARRIER           PIC X.
  2636             88  NO-CARRIER-SECURITY            VALUE ' '.
  2637         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2638             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2639         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2640             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2641         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2642             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2643
  2644         16  CF-PROC-SYS-ACCESS-SW.
  2645             20  CF-PROC-CREDIT-CLAIMS-SW.
  2646                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2647                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2648                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2649                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2650             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2651                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2652                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2653             20  CF-PROC-LIFE-GNRLDGR-SW.
  2654                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2655                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2656                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2657                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2658             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2659                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  55
* EL1501.cbl
  2660                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2661         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2662             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2663             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2664         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2665
  2666         16  CF-APPROVAL-LEVEL                  PIC X.
  2667             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2668             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2669             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2670             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2671             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2672
  2673         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2674
  2675         16  CF-LANGUAGE-TYPE                   PIC X.
  2676             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2677             88  CF-LANG-IS-FR                      VALUE 'F'.
  2678
  2679         16  CF-CSR-IND                         PIC X.
  2680         16  FILLER                             PIC X(239).
  2681
  2682****************************************************************
  2683*             PROCESSOR/REMINDERS RECORD                       *
  2684****************************************************************
  2685
  2686     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2687         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2688             20  CF-START-REMIND-DT         PIC XX.
  2689             20  CF-END-REMIND-DT           PIC XX.
  2690             20  CF-REMINDER-TEXT           PIC X(50).
  2691         16  FILLER                         PIC X(296).
  2692
  2693
  2694****************************************************************
  2695*             STATE MASTER RECORD                              *
  2696****************************************************************
  2697
  2698     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2699         16  CF-STATE-ABBREVIATION          PIC XX.
  2700         16  CF-STATE-NAME                  PIC X(25).
  2701         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2702         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2703             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2704             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2705             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2706             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2707                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2708                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2709             20  CF-ST-PREM-REJECT-SW       PIC X.
  2710                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2711                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2712             20  CF-ST-REF-REJECT-SW        PIC X.
  2713                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2714                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2715         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2716         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2717         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  56
* EL1501.cbl
  2718             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2719             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2720             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2721         16  CF-ST-FST-PMT-EXTENSION.
  2722             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2723             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2724                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2725                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2726                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2727                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2728         16  CF-ST-STATE-CALL.
  2729             20  CF-ST-CALL-UNEARNED        PIC X.
  2730             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2731             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2732         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2733             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2734             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2735         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2736         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2737         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2738         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2739         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2740         16  FILLER                         PIC X.
  2741         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2742             20  CF-ST-BENEFIT-CD           PIC XX.
  2743             20  CF-ST-BENEFIT-KIND         PIC X.
  2744                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2745                 88  CF-ST-AH-KIND              VALUE 'A'.
  2746             20  CF-ST-REM-TERM-CALC        PIC X.
  2747                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2748                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2749                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2750                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2751                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2752                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2753                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2754                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2755
  2756             20  CF-ST-REFUND-CALC          PIC X.
  2757                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2758                 88  ST-REFD-BY-R78             VALUE '1'.
  2759                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2760                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2761                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2762                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2763                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2764                 88  ST-REFD-UTAH               VALUE '7'.
  2765                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2766                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2767                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2768
  2769             20  CF-ST-EARNING-CALC         PIC X.
  2770                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2771                 88  ST-EARN-BY-R78             VALUE '1'.
  2772                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2773                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2774                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2775                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  57
* EL1501.cbl
  2776                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2777                 88  ST-EARN-MEAN               VALUE '8'.
  2778                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2779
  2780             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2781                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2782                 88  ST-OVRD-BY-R78             VALUE '1'.
  2783                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2784                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2785                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2786                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2787                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2788                 88  ST-OVRD-MEAN               VALUE '8'.
  2789                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2790             20  FILLER                     PIC X.
  2791
  2792         16  CF-ST-COMMISSION-CAPS.
  2793             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2794             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2795             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2796             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2797         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2798                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2799
  2800         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2801
  2802         16  CF-ST-STATUTORY-INTEREST.
  2803             20  CF-ST-STAT-DATE-FROM       PIC X.
  2804                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2805                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2806             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2807             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2808             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2809             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2810             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2811
  2812         16  CF-ST-OVER-SHORT.
  2813             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2814             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2815
  2816         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2817
  2818         16  CF-ST-RT-CALC                  PIC X.
  2819
  2820         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2821         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2822         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2823         16  CF-ST-RF-LR-CALC               PIC X.
  2824         16  CF-ST-RF-LL-CALC               PIC X.
  2825         16  CF-ST-RF-LN-CALC               PIC X.
  2826         16  CF-ST-RF-AH-CALC               PIC X.
  2827         16  CF-ST-RF-CP-CALC               PIC X.
  2828*        16  FILLER                         PIC X(206).
  2829*CIDMOD         16  FILLER                         PIC X(192).
  2830         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2831             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2832         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2833         16  CF-ST-VFY-2ND-BENE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  58
* EL1501.cbl
  2834         16  CF-ST-CAUSAL-STATE             PIC X.
  2835         16  FILLER                         PIC X(185).
  2836
  2837****************************************************************
  2838*             BENEFIT MASTER RECORD                            *
  2839****************************************************************
  2840
  2841     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2842         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2843             20  CF-BENEFIT-CODE            PIC XX.
  2844             20  CF-BENEFIT-NUMERIC  REDEFINES
  2845                 CF-BENEFIT-CODE            PIC XX.
  2846             20  CF-BENEFIT-ALPHA           PIC XXX.
  2847             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2848             20  CF-BENEFIT-COMMENT         PIC X(10).
  2849
  2850             20  CF-LF-COVERAGE-TYPE        PIC X.
  2851                 88  CF-REDUCING                VALUE 'R'.
  2852                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2853
  2854             20  CF-SPECIAL-CALC-CD         PIC X.
  2855                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2856                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2857                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2858                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2859                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2860                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2861                 88  CF-FARM-PLAN               VALUE 'F'.
  2862                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2863                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2864                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2865                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2866                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2867                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2868                 88  CF-PRUDENTIAL              VALUE 'P'.
  2869                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2870                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2871                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2872                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2873                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2874                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2875
  2876             20  CF-JOINT-INDICATOR         PIC X.
  2877                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2878
  2879*            20  FILLER                     PIC X(12).
  2880             20  FILLER                     PIC X(11).
  2881             20  CF-BENEFIT-CATEGORY        PIC X.
  2882             20  CF-LOAN-TYPE               PIC X(8).
  2883
  2884             20  CF-CO-REM-TERM-CALC        PIC X.
  2885                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2886                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2887                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2888                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2889                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2890
  2891             20  CF-CO-EARNINGS-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  59
* EL1501.cbl
  2892                 88  CO-EARN-BY-R78             VALUE '1'.
  2893                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2894                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2895                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2896                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2897                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2898                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2899                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2900
  2901             20  CF-CO-REFUND-CALC          PIC X.
  2902                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2903                 88  CO-REFD-BY-R78             VALUE '1'.
  2904                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2905                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2906                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2907                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2908                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2909                 88  CO-REFD-MEAN               VALUE '8'.
  2910                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2911                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2912                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2913
  2914             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2915                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2916                 88  CO-OVRD-BY-R78             VALUE '1'.
  2917                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2918                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2919                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2920                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2921                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2922                 88  CO-OVRD-MEAN               VALUE '8'.
  2923                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2924
  2925             20  CF-CO-BEN-I-G-CD           PIC X.
  2926                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2927                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2928                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2929
  2930         16  FILLER                         PIC X(304).
  2931
  2932
  2933****************************************************************
  2934*             CARRIER MASTER RECORD                            *
  2935****************************************************************
  2936
  2937     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2938         16  CF-ADDRESS-DATA.
  2939             20  CF-MAIL-TO-NAME            PIC X(30).
  2940             20  CF-IN-CARE-OF              PIC X(30).
  2941             20  CF-ADDRESS-LINE-1          PIC X(30).
  2942             20  CF-ADDRESS-LINE-2          PIC X(30).
  2943             20  CF-CITY-STATE              PIC X(30).
  2944             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2945             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2946
  2947         16  CF-CLAIM-NO-CONTROL.
  2948             20  CF-CLAIM-NO-METHOD         PIC X.
  2949                 88  CLAIM-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  60
* EL1501.cbl
  2950                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2951                 88  CLAIM-NO-SEQ               VALUE '3'.
  2952                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2953             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2954                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2955                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2956                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2957
  2958         16  CF-CHECK-NO-CONTROL.
  2959             20  CF-CHECK-NO-METHOD         PIC X.
  2960                 88  CHECK-NO-MANUAL            VALUE '1'.
  2961                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2962                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2963                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2964             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2965                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2966
  2967         16  CF-DOMICILE-STATE              PIC XX.
  2968
  2969         16  CF-EXPENSE-CONTROLS.
  2970             20  CF-EXPENSE-METHOD          PIC X.
  2971                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2972                 88  DOLLARS-PER-PMT            VALUE '2'.
  2973                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2974                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2975             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2976             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2977
  2978         16  CF-CORRESPONDENCE-CONTROL.
  2979             20  CF-LETTER-RESEND-OPT       PIC X.
  2980                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2981                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2982             20  FILLER                     PIC X(4).
  2983
  2984         16  CF-RESERVE-CONTROLS.
  2985             20  CF-MANUAL-SW               PIC X.
  2986                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2987             20  CF-FUTURE-SW               PIC X.
  2988                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2989             20  CF-PTC-SW                  PIC X.
  2990                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2991             20  CF-IBNR-SW                 PIC X.
  2992                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2993             20  CF-PTC-LF-SW               PIC X.
  2994                 88  CF-LF-PTC-USED             VALUE '1'.
  2995             20  CF-CDT-ACCESS-METHOD       PIC X.
  2996                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2997                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2998                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2999             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3000
  3001         16  CF-CLAIM-CALC-METHOD           PIC X.
  3002             88  360-PLUS-MONTHS                VALUE '1'.
  3003             88  365-PLUS-MONTHS                VALUE '2'.
  3004             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3005             88  360-DAILY                      VALUE '4'.
  3006             88  365-DAILY                      VALUE '5'.
  3007
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  61
* EL1501.cbl
  3008         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3009         16  FILLER                         PIC X(11).
  3010
  3011         16  CF-LIMIT-AMOUNTS.
  3012             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3013             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3014             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3015             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3016             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3017             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3018             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3019             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3020             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3021             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3022
  3023         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3024         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3025         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3026
  3027         16  CF-ZIP-CODE.
  3028             20  CF-ZIP-PRIME.
  3029                 24  CF-ZIP-1ST             PIC X.
  3030                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3031                 24  FILLER                 PIC X(4).
  3032             20  CF-ZIP-PLUS4               PIC X(4).
  3033         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3034             20  CF-CAN-POSTAL-1            PIC XXX.
  3035             20  CF-CAN-POSTAL-2            PIC XXX.
  3036             20  FILLER                     PIC XXX.
  3037
  3038         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3039         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3040         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3041
  3042         16  CF-RATING-SWITCH               PIC X.
  3043             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3044             88  CF-NO-RATING                   VALUE 'N'.
  3045
  3046         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3047
  3048         16  CF-CARRIER-OVER-SHORT.
  3049             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3050             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3051
  3052         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3053         16  CF-SECPAY-SWITCH               PIC X.
  3054             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3055             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3056         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3057         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3058         16  FILLER                         PIC X(444).
  3059*        16  FILLER                         PIC X(452).
  3060
  3061
  3062****************************************************************
  3063*             MORTALITY MASTER RECORD                          *
  3064****************************************************************
  3065
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  62
* EL1501.cbl
  3066     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3067         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3068                                INDEXED BY CF-MORT-NDX.
  3069             20  CF-MORT-TABLE              PIC X(5).
  3070             20  CF-MORT-TABLE-TYPE         PIC X.
  3071                 88  CF-MORT-JOINT              VALUE 'J'.
  3072                 88  CF-MORT-SINGLE             VALUE 'S'.
  3073                 88  CF-MORT-COMBINED           VALUE 'C'.
  3074                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3075                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3076             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3077             20  CF-MORT-AGE-METHOD         PIC XX.
  3078                 88  CF-AGE-LAST                VALUE 'AL'.
  3079                 88  CF-AGE-NEAR                VALUE 'AN'.
  3080             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3081             20  CF-MORT-ADJUSTMENT-DIRECTION
  3082                                            PIC X.
  3083                 88  CF-MINUS                   VALUE '-'.
  3084                 88  CF-PLUS                    VALUE '+'.
  3085             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3086             20  CF-MORT-JOINT-CODE         PIC X.
  3087                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3088             20  CF-MORT-PC-Q               PIC X.
  3089                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3090             20  CF-MORT-TABLE-CODE         PIC X(4).
  3091             20  CF-MORT-COMMENTS           PIC X(15).
  3092             20  FILLER                     PIC X(14).
  3093
  3094         16  FILLER                         PIC X(251).
  3095
  3096
  3097****************************************************************
  3098*             BUSSINESS TYPE MASTER RECORD                     *
  3099****************************************************************
  3100
  3101     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3102* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3103* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3104* AND RECORD 05 IS TYPES 81-99
  3105         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3106             20  CF-BUSINESS-TITLE          PIC  X(19).
  3107             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3108                                            PIC S9V9(4) COMP-3.
  3109             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3110             20  FILLER                     PIC  X.
  3111         16  FILLER                         PIC  X(248).
  3112
  3113
  3114****************************************************************
  3115*             TERMINAL MASTER RECORD                           *
  3116****************************************************************
  3117
  3118     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3119
  3120         16  CF-COMPANY-TERMINALS.
  3121             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3122                                  PIC X(4).
  3123         16  FILLER               PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  63
* EL1501.cbl
  3124
  3125
  3126****************************************************************
  3127*             LIFE EDIT MASTER RECORD                          *
  3128****************************************************************
  3129
  3130     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3131         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3132             20  CF-LIFE-CODE-IN            PIC XX.
  3133             20  CF-LIFE-CODE-OUT           PIC XX.
  3134         16  FILLER                         PIC X(248).
  3135
  3136
  3137****************************************************************
  3138*             AH EDIT MASTER RECORD                            *
  3139****************************************************************
  3140
  3141     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3142         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3143             20  CF-AH-CODE-IN              PIC XXX.
  3144             20  CF-AH-CODE-OUT             PIC XX.
  3145         16  FILLER                         PIC X(248).
  3146
  3147
  3148****************************************************************
  3149*             CREDIBILITY TABLES                               *
  3150****************************************************************
  3151
  3152     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3153         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3154                             INDEXED BY CF-CRDB-NDX.
  3155             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3156             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3157             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3158         16  FILLER                         PIC  X(332).
  3159
  3160
  3161****************************************************************
  3162*             REPORT CUSTOMIZATION RECORD                      *
  3163****************************************************************
  3164
  3165     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3166         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3167             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3168             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3169             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3170**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3171****       A T-TRANSFER.                                   ****
  3172             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3173
  3174         16  FILLER                         PIC XX.
  3175
  3176         16  CF-CARRIER-CNTL-OPT.
  3177             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3178                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3179                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3180             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3181                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  64
* EL1501.cbl
  3182         16  CF-GROUP-CNTL-OPT.
  3183             20  CF-GROUP-OPT-SEQ           PIC 9.
  3184                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3185                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3186             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3187                                            PIC X(6).
  3188         16  CF-STATE-CNTL-OPT.
  3189             20  CF-STATE-OPT-SEQ           PIC 9.
  3190                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3191                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3192             20  CF-STATE-SELECT OCCURS 3 TIMES
  3193                                            PIC XX.
  3194         16  CF-ACCOUNT-CNTL-OPT.
  3195             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3196                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3197                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3198             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3199                                            PIC X(10).
  3200         16  CF-BUS-TYP-CNTL-OPT.
  3201             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3202                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3203                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3204             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3205                                            PIC XX.
  3206         16  CF-LF-TYP-CNTL-OPT.
  3207             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3208                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3209                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3210             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3211                                            PIC XX.
  3212         16  CF-AH-TYP-CNTL-OPT.
  3213             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3214                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3215                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3216             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3217                                            PIC XX.
  3218         16  CF-REPTCD1-CNTL-OPT.
  3219             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3220                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3221                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3222             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3223                                            PIC X(10).
  3224         16  CF-REPTCD2-CNTL-OPT.
  3225             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3226                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3227                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3228             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3229                                            PIC X(10).
  3230         16  CF-USER1-CNTL-OPT.
  3231             20  CF-USER1-OPT-SEQ           PIC 9.
  3232                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3233                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3234             20  CF-USER1-SELECT OCCURS 3 TIMES
  3235                                            PIC X(10).
  3236         16  CF-USER2-CNTL-OPT.
  3237             20  CF-USER2-OPT-SEQ           PIC 9.
  3238                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3239                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  65
* EL1501.cbl
  3240             20  CF-USER2-SELECT OCCURS 3 TIMES
  3241                                            PIC X(10).
  3242         16  CF-USER3-CNTL-OPT.
  3243             20  CF-USER3-OPT-SEQ           PIC 9.
  3244                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3245                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3246             20  CF-USER3-SELECT OCCURS 3 TIMES
  3247                                            PIC X(10).
  3248         16  CF-USER4-CNTL-OPT.
  3249             20  CF-USER4-OPT-SEQ           PIC 9.
  3250                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3251                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3252             20  CF-USER4-SELECT OCCURS 3 TIMES
  3253                                            PIC X(10).
  3254         16  CF-USER5-CNTL-OPT.
  3255             20  CF-USER5-OPT-SEQ           PIC 9.
  3256                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3257                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3258             20  CF-USER5-SELECT OCCURS 3 TIMES
  3259                                            PIC X(10).
  3260         16  CF-REINS-CNTL-OPT.
  3261             20  CF-REINS-OPT-SEQ           PIC 9.
  3262                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3263                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3264             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3265                 24  CF-REINS-PRIME         PIC XXX.
  3266                 24  CF-REINS-SUB           PIC XXX.
  3267
  3268         16  CF-AGENT-CNTL-OPT.
  3269             20  CF-AGENT-OPT-SEQ           PIC 9.
  3270                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3271                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3272             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3273                                            PIC X(10).
  3274
  3275         16  FILLER                         PIC X(43).
  3276
  3277         16  CF-LOSS-RATIO-SELECT.
  3278             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3279             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3280         16  CF-ENTRY-DATE-SELECT.
  3281             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3282             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3283         16  CF-EFFECTIVE-DATE-SELECT.
  3284             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3285             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3286
  3287         16  CF-EXCEPTION-LIST-IND          PIC X.
  3288             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3289
  3290         16  FILLER                         PIC X(318).
  3291
  3292****************************************************************
  3293*                  EXCEPTION REPORTING RECORD                  *
  3294****************************************************************
  3295
  3296     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3297         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  66
* EL1501.cbl
  3298             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3299
  3300         16  CF-COMBINED-LIFE-AH-OPT.
  3301             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3302             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3303             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3304             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3305
  3306         16  CF-LIFE-OPT.
  3307             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3308             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3309             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3310             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3311             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3312             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3313             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3314             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3315             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3316             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3317
  3318         16  CF-AH-OPT.
  3319             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3320             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3321             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3322             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3323             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3324             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3325             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3326             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3327             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3328             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3329
  3330         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3331             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3332             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3333             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3334
  3335         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3336
  3337         16  FILLER                         PIC X(673).
  3338
  3339
  3340****************************************************************
  3341*             MORTGAGE SYSTEM PLAN RECORD                      *
  3342****************************************************************
  3343
  3344     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3345         16  CF-PLAN-TYPE                   PIC X.
  3346             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3347             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3348             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3349         16  CF-PLAN-ABBREV                 PIC XXX.
  3350         16  CF-PLAN-DESCRIPT               PIC X(10).
  3351         16  CF-PLAN-NOTES                  PIC X(20).
  3352         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3353         16  CF-PLAN-UNDERWRITING.
  3354             20  CF-PLAN-TERM-DATA.
  3355                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  67
* EL1501.cbl
  3356                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3357             20  CF-PLAN-AGE-DATA.
  3358                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3359                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3360                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3361             20  CF-PLAN-BENEFIT-DATA.
  3362                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3363                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3364                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3365                                            PIC S9(7)V99  COMP-3.
  3366         16  CF-PLAN-POLICY-FORMS.
  3367             20  CF-POLICY-FORM             PIC X(12).
  3368             20  CF-MASTER-APPLICATION      PIC X(12).
  3369             20  CF-MASTER-POLICY           PIC X(12).
  3370         16  CF-PLAN-RATING.
  3371             20  CF-RATE-CODE               PIC X(5).
  3372             20  CF-SEX-RATING              PIC X.
  3373                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3374                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3375             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3376             20  CF-SUB-STD-TYPE            PIC X.
  3377                 88  CF-PCT-OF-PREM            VALUE '1'.
  3378                 88  CF-PCT-OF-BENE            VALUE '2'.
  3379         16  CF-PLAN-PREM-TOLERANCES.
  3380             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3381             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3382         16  CF-PLAN-PYMT-TOLERANCES.
  3383             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3384             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3385         16  CF-PLAN-MISC-DATA.
  3386             20  FILLER                     PIC X.
  3387             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3388             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3389         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3390         16  CF-PLAN-IND-GRP                PIC X.
  3391             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3392                                                     '1'.
  3393             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3394                                                     '2'.
  3395         16  CF-MIB-SEARCH-SW               PIC X.
  3396             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3397             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3398             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3399             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3400         16  CF-ALPHA-SEARCH-SW             PIC X.
  3401             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3402             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3403             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3404             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3405             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3406             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3407             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3408             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3409             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3410             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3411                                                     'A' 'B' 'C'
  3412                                                     'X' 'Y' 'Z'.
  3413         16  CF-EFF-DT-RULE-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  68
* EL1501.cbl
  3414             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3415             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3416             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3417             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3418             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3419         16  FILLER                         PIC X(4).
  3420         16  CF-HEALTH-QUESTIONS            PIC X.
  3421             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3422         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3423         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3424         16  CF-PLAN-SNGL-JNT               PIC X.
  3425             88  CF-COMBINED-PLAN              VALUE 'C'.
  3426             88  CF-JNT-PLAN                   VALUE 'J'.
  3427             88  CF-SNGL-PLAN                  VALUE 'S'.
  3428         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3429         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3430         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3431         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3432         16  CF-RERATE-CNTL                 PIC  X.
  3433             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3434             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3435             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3436             88  CF-AUTO-RECALC                 VALUE '4'.
  3437         16  CF-BENEFIT-TYPE                PIC  X.
  3438             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3439             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3440         16  CF-POLICY-FEE                  PIC S999V99
  3441                                                    COMP-3.
  3442         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3443         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3444         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3445         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3446         16  FILLER                         PIC  X(32).
  3447         16  CF-TERMINATION-FORM            PIC  X(04).
  3448         16  FILLER                         PIC  X(08).
  3449         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3450                                                       COMP-3.
  3451         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3452         16  CF-ISSUE-LETTER                PIC  X(4).
  3453         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3454         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3455             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3456             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3457         16  CF-MP-REFUND-CALC              PIC X.
  3458             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3459             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3460             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3461             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3462             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3463             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3464             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3465             88  CF-MP-REFD-MEAN                VALUE '8'.
  3466         16  CF-ALT-RATE-CODE               PIC  X(5).
  3467
  3468
  3469         16  FILLER                         PIC X(498).
  3470****************************************************************
  3471*             MORTGAGE COMPANY MASTER RECORD                   *
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  69
* EL1501.cbl
  3472****************************************************************
  3473
  3474     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3475         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3476         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3477             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3478             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3479             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3480             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3481             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3482
  3483         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3484         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3485         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3486         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3487         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3488
  3489         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3490             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3491         16  CF-MP-RECON-USE-IND            PIC X(1).
  3492             88  CF-MP-USE-RECON             VALUE 'Y'.
  3493         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3494             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3495         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3496             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3497             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3498         16  FILLER                         PIC X(1).
  3499         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3500             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3501         16  CF-MORTG-MIB-VERSION           PIC X.
  3502             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3503             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3504             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3505         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3506             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3507                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3508             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3509                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3510             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3511                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3512             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3513                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3514             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3515                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3516             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3517                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3518         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3519         16  FILLER                         PIC X(7).
  3520         16  CF-MORTG-DESTINATION-SYMBOL.
  3521             20  CF-MORTG-MIB-COMM          PIC X(5).
  3522             20  CF-MORTG-MIB-TERM          PIC X(5).
  3523         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3524             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3525         16  FILLER                         PIC X(03).
  3526         16  CF-MP-CHECK-NO-CONTROL.
  3527             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3528                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3529                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  70
* EL1501.cbl
  3530                                                ' ' LOW-VALUES.
  3531                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3532                                               VALUE '3'.
  3533         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3534         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3535         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3536             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3537                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3538             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3539                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3540             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3541                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3542             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3543                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3544             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3545                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3546             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3547                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3548         16  CF-MORTG-BILLING-AREA.
  3549             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3550                                            PIC X.
  3551         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3552         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3553         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3554         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3555             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3556             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3557         16  FILLER                         PIC X.
  3558         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3559             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3560             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3561         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3562         16  FILLER                         PIC X(8).
  3563         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3564         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3565         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3566         16  CF-ACH-COMPANY-ID.
  3567             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3568                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3569                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3570                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3571             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3572         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3573             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3574         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3575             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3576             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3577         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3578         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3579         16  FILLER                         PIC X(536).
  3580
  3581****************************************************************
  3582*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3583****************************************************************
  3584
  3585     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3586         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3587             20  CF-FEMALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  71
* EL1501.cbl
  3588                 24  CF-FEMALE-FT           PIC 99.
  3589                 24  CF-FEMALE-IN           PIC 99.
  3590             20  CF-FEMALE-MIN-WT           PIC 999.
  3591             20  CF-FEMALE-MAX-WT           PIC 999.
  3592         16  FILLER                         PIC X(428).
  3593
  3594     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3595         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3596             20  CF-MALE-HEIGHT.
  3597                 24  CF-MALE-FT             PIC 99.
  3598                 24  CF-MALE-IN             PIC 99.
  3599             20  CF-MALE-MIN-WT             PIC 999.
  3600             20  CF-MALE-MAX-WT             PIC 999.
  3601         16  FILLER                         PIC X(428).
  3602******************************************************************
  3603*             AUTOMATIC ACTIVITY RECORD                          *
  3604******************************************************************
  3605     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3606         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3607             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3608             20  CF-SYS-LETTER-ID           PIC X(04).
  3609             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3610             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3611             20  CF-SYS-RESET-SW            PIC X(01).
  3612             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3613             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3614
  3615         16  FILLER                         PIC X(50).
  3616
  3617         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3618             20  CF-USER-ACTIVE-SW          PIC X(01).
  3619             20  CF-USER-LETTER-ID          PIC X(04).
  3620             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3621             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3622             20  CF-USER-RESET-SW           PIC X(01).
  3623             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3624             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3625             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3626
  3627         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  72
* EL1501.cbl
  3629*                                    COPY ELCCERT.
  3630******************************************************************
  3631*                                                                *
  3632*                            ELCCERT.                            *
  3633*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3634*                            VMOD=2.013                          *
  3635*                                                                *
  3636*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3637*                                                                *
  3638*   FILE TYPE = VSAM,KSDS                                        *
  3639*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3640*                                                                *
  3641*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3642*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3643*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3644*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3645*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3646*                                                                *
  3647*   LOG = YES                                                    *
  3648*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3649******************************************************************
  3650*                   C H A N G E   L O G
  3651*
  3652* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3653*-----------------------------------------------------------------
  3654*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3655* EFFECTIVE    NUMBER
  3656*-----------------------------------------------------------------
  3657* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3658* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3659* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3660* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3661* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3662* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3663* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3664* 032612  CR2011110200001  PEMA  AHL CHANGES
  3665******************************************************************
  3666
  3667 01  CERTIFICATE-MASTER.
  3668     12  CM-RECORD-ID                      PIC XX.
  3669         88  VALID-CM-ID                      VALUE 'CM'.
  3670
  3671     12  CM-CONTROL-PRIMARY.
  3672         16  CM-COMPANY-CD                 PIC X.
  3673         16  CM-CARRIER                    PIC X.
  3674         16  CM-GROUPING.
  3675             20  CM-GROUPING-PREFIX        PIC X(3).
  3676             20  CM-GROUPING-PRIME         PIC X(3).
  3677         16  CM-STATE                      PIC XX.
  3678         16  CM-ACCOUNT.
  3679             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3680             20  CM-ACCOUNT-PRIME          PIC X(6).
  3681         16  CM-CERT-EFF-DT                PIC XX.
  3682         16  CM-CERT-NO.
  3683             20  CM-CERT-PRIME             PIC X(10).
  3684             20  CM-CERT-SFX               PIC X.
  3685
  3686     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  73
* EL1501.cbl
  3687         16  CM-COMPANY-CD-A1              PIC X.
  3688         16  CM-INSURED-LAST-NAME          PIC X(15).
  3689         16  CM-INSURED-INITIALS.
  3690             20  CM-INSURED-INITIAL1       PIC X.
  3691             20  CM-INSURED-INITIAL2       PIC X.
  3692
  3693     12  CM-CONTROL-BY-SSN.
  3694         16  CM-COMPANY-CD-A2              PIC X.
  3695         16  CM-SOC-SEC-NO.
  3696             20  CM-SSN-STATE              PIC XX.
  3697             20  CM-SSN-ACCOUNT            PIC X(6).
  3698             20  CM-SSN-LN3.
  3699                 25  CM-INSURED-INITIALS-A2.
  3700                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3701                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3702                 25 CM-PART-LAST-NAME-A2         PIC X.
  3703
  3704     12  CM-CONTROL-BY-CERT-NO.
  3705         16  CM-COMPANY-CD-A4              PIC X.
  3706         16  CM-CERT-NO-A4                 PIC X(11).
  3707
  3708     12  CM-CONTROL-BY-MEMB.
  3709         16  CM-COMPANY-CD-A5              PIC X.
  3710         16  CM-MEMBER-NO.
  3711             20  CM-MEMB-STATE             PIC XX.
  3712             20  CM-MEMB-ACCOUNT           PIC X(6).
  3713             20  CM-MEMB-LN4.
  3714                 25  CM-INSURED-INITIALS-A5.
  3715                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3716                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3717                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3718
  3719     12  CM-INSURED-PROFILE-DATA.
  3720         16  CM-INSURED-FIRST-NAME.
  3721             20  CM-INSURED-1ST-INIT       PIC X.
  3722             20  FILLER                    PIC X(9).
  3723         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3724         16  CM-INSURED-SEX                PIC X.
  3725             88  CM-SEX-MALE                  VALUE 'M'.
  3726             88  CM-SEX-FEMAL                 VALUE 'F'.
  3727         16  CM-INSURED-JOINT-AGE          PIC 99.
  3728         16  CM-JOINT-INSURED-NAME.
  3729             20  CM-JT-LAST-NAME           PIC X(15).
  3730             20  CM-JT-FIRST-NAME.
  3731                 24  CM-JT-1ST-INIT        PIC X.
  3732                 24  FILLER                PIC X(9).
  3733             20  CM-JT-INITIAL             PIC X.
  3734
  3735     12  CM-LIFE-DATA.
  3736         16  CM-LF-BENEFIT-CD              PIC XX.
  3737         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3738         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3739         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3740         16  CM-LF-DEV-CODE                PIC XXX.
  3741         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3742         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3743         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3744         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  74
* EL1501.cbl
  3745         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3746         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3747         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3748         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3749         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3750         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3751         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3752         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3753         16  FILLER                        PIC XX.
  3754
  3755     12  CM-AH-DATA.
  3756         16  CM-AH-BENEFIT-CD              PIC XX.
  3757         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  3758         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  3759         16  CM-AH-DEV-CODE                PIC XXX.
  3760         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3761         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  3762         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3763         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3764         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3765         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  3766         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  3767         16  CM-AH-PAID-THRU-DT            PIC XX.
  3768             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  3769         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3770         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3771         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  3772         16  FILLER                        PIC X.
  3773
  3774     12  CM-LOAN-INFORMATION.
  3775         16  CM-LIVES                      PIC S9(7)     COMP-3.
  3776         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  3777                                           PIC S9(5)V99  COMP-3.
  3778         16  CM-BILLED                     PIC S9(7)     COMP-3.
  3779         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  3780         16  CM-PAY-FREQUENCY              PIC S99.
  3781         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  3782         16  CM-RATE-CLASS                 PIC XX.
  3783         16  CM-BENEFICIARY                PIC X(25).
  3784         16  CM-POLICY-FORM-NO             PIC X(12).
  3785         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  3786         16  CM-LAST-ADD-ON-DT             PIC XX.
  3787         16  CM-DEDUCTIBLE-AMOUNTS.
  3788             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  3789             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  3790         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3791             20  CM-RESIDENT-STATE         PIC XX.
  3792             20  CM-RATE-CODE              PIC X(4).
  3793             20  FILLER                    PIC XX.
  3794         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3795             20  CM-LOAN-OFFICER           PIC X(5).
  3796             20  FILLER                    PIC XXX.
  3797         16  CM-CSR-CODE                   PIC XXX.
  3798         16  CM-UNDERWRITING-CODE          PIC X.
  3799             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  3800         16  CM-POST-CARD-IND              PIC X.
  3801         16  CM-NH-INTERFACE-SW            PIC X.
  3802         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  75
* EL1501.cbl
  3803             88  CM-SING-PRM                  VALUE '1'.
  3804             88  CM-O-B-COVERAGE              VALUE '2'.
  3805             88  CM-OPEN-END                  VALUE '3'.
  3806         16  CM-IND-GRP-TYPE               PIC X.
  3807             88  CM-INDIVIDUAL                VALUE 'I'.
  3808             88  CM-GROUP                     VALUE 'G'.
  3809         16  CM-SKIP-CODE                  PIC X.
  3810             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  3811             88  SKIP-JULY                    VALUE '1'.
  3812             88  SKIP-AUGUST                  VALUE '2'.
  3813             88  SKIP-SEPTEMBER               VALUE '3'.
  3814             88  SKIP-JULY-AUG                VALUE '4'.
  3815             88  SKIP-AUG-SEPT                VALUE '5'.
  3816             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  3817             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  3818             88  SKIP-JUNE                    VALUE '8'.
  3819             88  SKIP-JUNE-JULY               VALUE '9'.
  3820             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  3821             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  3822         16  CM-PAYMENT-MODE               PIC X.
  3823             88  PAY-MONTHLY                  VALUE SPACE.
  3824             88  PAY-WEEKLY                   VALUE '1'.
  3825             88  PAY-SEMI-MONTHLY             VALUE '2'.
  3826             88  PAY-BI-WEEKLY                VALUE '3'.
  3827             88  PAY-SEMI-ANUALLY             VALUE '4'.
  3828         16  CM-LOAN-NUMBER                PIC X(8).
  3829         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  3830         16  CM-OLD-LOF                    PIC XXX.
  3831*        16  CM-LOAN-OFFICER               PIC XXX.
  3832         16  CM-REIN-TABLE                 PIC XXX.
  3833         16  CM-SPECIAL-REIN-CODE          PIC X.
  3834         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  3835         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  3836         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  3837
  3838     12  CM-STATUS-DATA.
  3839         16  CM-ENTRY-STATUS               PIC X.
  3840         16  CM-ENTRY-DT                   PIC XX.
  3841
  3842         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  3843         16  CM-LF-CANCEL-DT               PIC XX.
  3844         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  3845
  3846         16  CM-LF-STATUS-AT-DEATH         PIC X.
  3847         16  CM-LF-DEATH-DT                PIC XX.
  3848         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  3849
  3850         16  CM-LF-CURRENT-STATUS          PIC X.
  3851             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3852                                                'M' '4' '5' '9'.
  3853             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  3854             88  CM-LF-POLICY-PENDING         VALUE '2'.
  3855             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  3856             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  3857             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  3858             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3859             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  3860             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  76
* EL1501.cbl
  3861             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  3862             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  3863             88  CM-LF-DECLINED               VALUE 'D'.
  3864             88  CM-LF-VOIDED                 VALUE 'V'.
  3865
  3866         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  3867         16  CM-AH-CANCEL-DT               PIC XX.
  3868         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  3869
  3870         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  3871         16  CM-AH-SETTLEMENT-DT           PIC XX.
  3872         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  3873
  3874         16  CM-AH-CURRENT-STATUS          PIC X.
  3875             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3876                                                'M' '4' '5' '9'.
  3877             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  3878             88  CM-AH-POLICY-PENDING         VALUE '2'.
  3879             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  3880             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  3881             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  3882             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  3883             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  3884             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  3885             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  3886             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  3887             88  CM-AH-DECLINED               VALUE 'D'.
  3888             88  CM-AH-VOIDED                 VALUE 'V'.
  3889
  3890         16  CM-CLAIM-INTERFACE-SW         PIC X.
  3891             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  3892             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  3893             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  3894         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  3895
  3896         16  CM-ENTRY-BATCH                PIC X(6).
  3897         16  CM-LF-EXIT-BATCH              PIC X(6).
  3898         16  CM-AH-EXIT-BATCH              PIC X(6).
  3899         16  CM-LAST-MONTH-END             PIC XX.
  3900
  3901     12  CM-NOTE-SW                        PIC X.
  3902         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  3903         88  CERT-NOTES-PRESENT               VALUE '1'.
  3904         88  BILLING-NOTES-PRESENT            VALUE '2'.
  3905         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  3906         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  3907         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  3908         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  3909         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  3910     12  CM-COMP-EXCP-SW                   PIC X.
  3911         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  3912         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  3913     12  CM-INSURED-ADDRESS-SW             PIC X.
  3914         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  3915         88  INSURED-ADDR-PRESENT             VALUE '1'.
  3916
  3917*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  3918     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  77
* EL1501.cbl
  3919     12  FILLER                            PIC X.
  3920
  3921*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  3922     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  3923     12  FILLER                            PIC X.
  3924*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  3925     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  3926
  3927     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  3928         88  CERT-ADDED-BATCH                 VALUE ' '.
  3929         88  CERT-ADDED-ONLINE                VALUE '1'.
  3930         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  3931         88  CERT-PURGED-OFFLINE              VALUE '3'.
  3932         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  3933     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  3934         88  CERT-AS-LOADED                   VALUE ' '.
  3935         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  3936         88  CERT-CLAIM-ONLINE                VALUE '2'.
  3937         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  3938         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  3939         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  3940         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  3941         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  3942
  3943     12  CM-ACCOUNT-COMM-PCTS.
  3944         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  3945         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3946
  3947     12  CM-USER-FIELD                     PIC X.
  3948     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  3949     12  CM-CLP-STATE                      PIC XX.
  3950     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  3951     12  CM-USER-RESERVED                  PIC XXX.
  3952     12  FILLER REDEFINES CM-USER-RESERVED.
  3953         16  CM-AH-CLASS-CD                PIC XX.
  3954         16  F                             PIC X.
  3955******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  78
* EL1501.cbl
  3957*                                    COPY ELCTRLR.
  3958******************************************************************
  3959*                                                                *
  3960*                            ELCTRLR.                            *
  3961*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3962*                            VMOD=2.014                          *
  3963*                                                                *
  3964*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  3965*                                                                *
  3966*   FILE TYPE = VSAM,KSDS                                        *
  3967*   RECORD SIZE = 200    RECFORM = FIXED                         *
  3968*                                                                *
  3969*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  3970*       ALTERNATE INDEX = NONE                                   *
  3971*                                                                *
  3972*   LOG = YES                                                    *
  3973*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3974******************************************************************
  3975*                   C H A N G E   L O G
  3976*
  3977* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3978*-----------------------------------------------------------------
  3979*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3980* EFFECTIVE    NUMBER
  3981*-----------------------------------------------------------------
  3982* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3983* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  3984* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  3985* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  3986* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  3987* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  3988* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  3989* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  3990* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  3991* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  3992* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  3993* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  3994* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  3995* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  3996* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  3997* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3998* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  3999******************************************************************
  4000 01  ACTIVITY-TRAILERS.
  4001     12  AT-RECORD-ID                    PIC XX.
  4002         88  VALID-AT-ID                       VALUE 'AT'.
  4003
  4004     12  AT-CONTROL-PRIMARY.
  4005         16  AT-COMPANY-CD               PIC X.
  4006         16  AT-CARRIER                  PIC X.
  4007         16  AT-CLAIM-NO                 PIC X(7).
  4008         16  AT-CERT-NO.
  4009             20  AT-CERT-PRIME           PIC X(10).
  4010             20  AT-CERT-SFX             PIC X.
  4011         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4012             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4013             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4014             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  79
* EL1501.cbl
  4015             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4016             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4017             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4018             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4019             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4020             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4021             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4022             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4023             88  AT-BENEFICIARY-TRL           VALUE +91.
  4024             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4025             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4026             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4027             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4028
  4029     12  AT-TRAILER-TYPE                 PIC X.
  4030         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4031         88  PAYMENT-TR                       VALUE '2'.
  4032         88  AUTO-PAY-TR                      VALUE '3'.
  4033         88  CORRESPONDENCE-TR                VALUE '4'.
  4034         88  ADDRESS-TR                       VALUE '5'.
  4035         88  GENERAL-INFO-TR                  VALUE '6'.
  4036         88  AUTO-PROMPT-TR                   VALUE '7'.
  4037         88  DENIAL-TR                        VALUE '8'.
  4038         88  INCURRED-CHG-TR                  VALUE '9'.
  4039         88  FORM-CONTROL-TR                  VALUE 'A'.
  4040
  4041     12  AT-RECORDED-DT                  PIC XX.
  4042     12  AT-RECORDED-BY                  PIC X(4).
  4043     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4044
  4045     12  AT-TRAILER-BODY                 PIC X(165).
  4046
  4047     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4048         16  AT-RESERVE-CONTROLS.
  4049             20  AT-MANUAL-SW            PIC X.
  4050                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4051             20  AT-FUTURE-SW            PIC X.
  4052                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4053             20  AT-PTC-SW               PIC X.
  4054                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4055             20  AT-IBNR-SW              PIC X.
  4056                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4057             20  AT-PTC-LF-SW            PIC X.
  4058                 88  AT-LF-PTC-USED          VALUE '1'.
  4059             20  AT-CDT-ACCESS-METHOD    PIC X.
  4060                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4061                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4062                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4063             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4064         16  AT-LAST-COMPUTED-DT         PIC XX.
  4065         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4066         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4067         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4068         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4069         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4070         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4071         16  AT-EXPENSE-CONTROLS.
  4072             20  AT-EXPENSE-METHOD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  80
* EL1501.cbl
  4073                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4074                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4075                 88  PERCENT-OF-PMT           VALUE '3'.
  4076                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4077             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4078             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4079         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4080         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4081
  4082         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4083         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4084
  4085*        16  FILLER                      PIC X(53).
  4086         16  FILLER                      PIC X(47).
  4087
  4088         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4089         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4090
  4091         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4092             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4093             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4094*                    C = CLOSED
  4095*                    O = OPEN
  4096             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4097*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4098
  4099     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4100         16  AT-PAYMENT-TYPE             PIC X.
  4101             88  PARTIAL-PAYMENT                VALUE '1'.
  4102             88  FINAL-PAYMENT                  VALUE '2'.
  4103             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4104             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4105             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4106             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4107             88  VOIDED-PAYMENT                 VALUE '9'.
  4108             88  TRANSFER                       VALUE 'T'.
  4109             88  LIFE-INTEREST                  VALUE 'I'.
  4110
  4111         16  AT-CLAIM-TYPE               PIC X.
  4112             88  PAID-FOR-AH                    VALUE 'A'.
  4113             88  PAID-FOR-LIFE                  VALUE 'L'.
  4114             88  PAID-FOR-IUI                   VALUE 'I'.
  4115             88  PAID-FOR-GAP                   VALUE 'G'.
  4116         16  AT-CLAIM-PREM-TYPE          PIC X.
  4117             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4118             88  AT-O-B-COVERAGE                VALUE '2'.
  4119             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4120         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4121         16  AT-CHECK-NO                 PIC X(7).
  4122         16  AT-PAID-FROM-DT             PIC XX.
  4123         16  AT-PAID-THRU-DT             PIC XX.
  4124         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4125         16  FILLER                      PIC X.
  4126         16  AT-PAYEES-NAME              PIC X(30).
  4127         16  AT-PAYMENT-ORIGIN           PIC X.
  4128             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4129             88  ONLINE-AUTO-PMT                VALUE '2'.
  4130             88  OFFLINE-PMT                    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  81
* EL1501.cbl
  4131         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4132         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4133         16  AT-VOID-DATA.
  4134             20  AT-VOID-DT              PIC XX.
  4135*00144       20  AT-VOID-REASON          PIC X(30).
  4136             20  AT-VOID-REASON          PIC X(26).
  4137         16  AT-PMT-APPROVED-BY          PIC X(04).
  4138         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4139         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4140         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4141                                         PIC S99V9(5)  COMP-3.
  4142         16  AT-CREDIT-INTERFACE.
  4143             20  AT-PMT-SELECT-DT        PIC XX.
  4144                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4145             20  AT-PMT-ACCEPT-DT        PIC XX.
  4146                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4147             20  AT-VOID-SELECT-DT       PIC XX.
  4148                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4149             20  AT-VOID-ACCEPT-DT       PIC XX.
  4150                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4151
  4152         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4153                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4154                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4155         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4156
  4157         16  AT-FORCE-CONTROL            PIC X.
  4158             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4159         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4160         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4161         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4162         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4163         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4164         16  AT-BENEFIT-TYPE             PIC X.
  4165
  4166         16  AT-EXPENSE-TYPE             PIC X.
  4167         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4168
  4169         16  AT-PAYEE-TYPE-CD.
  4170             20  AT-PAYEE-TYPE           PIC X.
  4171                 88  INSURED-PAID           VALUE 'I'.
  4172                 88  BENEFICIARY-PAID       VALUE 'B'.
  4173                 88  ACCOUNT-PAID           VALUE 'A'.
  4174                 88  OTHER-1-PAID           VALUE 'O'.
  4175                 88  OTHER-2-PAID           VALUE 'Q'.
  4176                 88  DOCTOR-PAID            VALUE 'P'.
  4177                 88  EMPLOYER-PAID          VALUE 'E'.
  4178             20  AT-PAYEE-SEQ            PIC X.
  4179
  4180         16  AT-CASH-PAYMENT             PIC X.
  4181         16  AT-GROUPED-PAYMENT          PIC X.
  4182         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4183         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4184         16  AT-APPROVED-LEVEL           PIC X.
  4185         16  AT-VOID-TYPE                PIC X.
  4186             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4187             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4188         16  AT-AIG-UNEMP-IND            PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  82
* EL1501.cbl
  4189             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4190         16  AT-ASSOCIATES               PIC X.
  4191             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4192             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4193
  4194         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4195         16  AT-CV-PMT-CODE              PIC X.
  4196             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4197             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4198             88  FULL-ADD-PAYMENT           VALUE '3'.
  4199             88  HALF-ADD-PAYMENT           VALUE '4'.
  4200             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4201             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4202             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4203             88  ADDL-PAYMENT               VALUE '8'.
  4204
  4205         16  AT-EOB-CODE1                PIC XXX.
  4206         16  AT-EOB-CODE2                PIC XXX.
  4207         16  AT-EOB-CODE3                PIC XXX.
  4208         16  FILLER REDEFINES AT-EOB-CODE3.
  4209             20  AT-PRINT-CLM-FORM       PIC X.
  4210             20  AT-PRINT-SURVEY         PIC X.
  4211             20  AT-SPECIAL-RELEASE      PIC X.
  4212         16  AT-EOB-CODE4                PIC XXX.
  4213         16  FILLER REDEFINES AT-EOB-CODE4.
  4214             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4215             20  FILLER                  PIC X.
  4216         16  AT-EOB-CODE5                PIC XXX.
  4217         16  FILLER REDEFINES AT-EOB-CODE5.
  4218             20  AT-PMT-PROOF-DT         PIC XX.
  4219             20  FILLER                  PIC X.
  4220
  4221         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4222             88  AT-PRINT-EOB            VALUE 'Y'.
  4223
  4224         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4225         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4226
  4227     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4228         16  AT-SCHEDULE-START-DT        PIC XX.
  4229         16  AT-SCHEDULE-END-DT          PIC XX.
  4230         16  AT-TERMINATED-DT            PIC XX.
  4231         16  AT-LAST-PMT-TYPE            PIC X.
  4232             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4233             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4234         16  AT-FIRST-PMT-DATA.
  4235             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4236             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4237             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4238         16  AT-REGULAR-PMT-DATA.
  4239             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4240             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4241             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4242         16  AT-AUTO-PAYEE-CD.
  4243             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4244                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4245                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4246                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  83
* EL1501.cbl
  4247                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4248                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4249             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4250         16  AT-AUTO-PAY-DAY             PIC 99.
  4251         16  AT-AUTO-CASH                PIC X.
  4252             88  AT-CASH                      VALUE 'Y'.
  4253             88  AT-NON-CASH                  VALUE 'N'.
  4254*        16  FILLER                      PIC X(129).
  4255         16  AT-AUTO-END-LETTER          PIC X(4).
  4256         16  FILLER                      PIC X(125).
  4257
  4258         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4259         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4260
  4261     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4262         16  AT-LETTER-SENT-DT           PIC XX.
  4263         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4264         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4265         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4266         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4267         16  AT-LETTER-ORIGIN            PIC X.
  4268             88  ONLINE-CREATION              VALUE '1' '3'.
  4269             88  OFFLINE-CREATION             VALUE '2' '4'.
  4270             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4271             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4272         16  AT-STD-LETTER-FORM          PIC X(4).
  4273         16  AT-REASON-TEXT              PIC X(70).
  4274         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4275         16  AT-ADDRESEE-TYPE            PIC X.
  4276              88  INSURED-ADDRESEE            VALUE 'I'.
  4277              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4278              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4279              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4280              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4281              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4282              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4283         16  AT-ADDRESSEE-NAME           PIC X(30).
  4284         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4285         16  AT-RESEND-PRINT-DATE        PIC XX.
  4286         16  AT-CORR-SOL-UNSOL           PIC X.
  4287         16  AT-LETTER-PURGED-DT         PIC XX.
  4288*
  4289*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4290*
  4291         16  AT-CSO-REDEFINITION.
  4292             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4293             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4294             20  AT-LETTER-TO-BENE       PIC X(1).
  4295             20  AT-STOP-LETTER-DT       PIC X(2).
  4296             20  FILLER                  PIC X(19).
  4297*             20  FILLER                  PIC X(27).
  4298             20  AT-CSO-LETTER-STATUS    PIC X.
  4299                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4300                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4301                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4302             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4303             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4304*
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  84
* EL1501.cbl
  4305*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4306*
  4307*        16  FILLER                      PIC X(26).
  4308*
  4309*        16  AT-DMD-BSR-CODE             PIC X.
  4310*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4311*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4312*
  4313*        16  AT-DMD-LETTER-STATUS        PIC X.
  4314*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4315*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4316*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4317*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4318*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4319
  4320         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4321         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4322
  4323     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4324         16  AT-ADDRESS-TYPE             PIC X.
  4325             88  INSURED-ADDRESS               VALUE 'I'.
  4326             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4327             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4328             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4329             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4330             88  OTHER-ADDRESS-1               VALUE 'O'.
  4331             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4332         16  AT-MAIL-TO-NAME             PIC X(30).
  4333         16  AT-ADDRESS-LINE-1           PIC X(30).
  4334         16  AT-ADDRESS-LINE-2           PIC X(30).
  4335         16  AT-CITY-STATE.
  4336             20  AT-CITY                 PIC X(28).
  4337             20  AT-STATE                PIC XX.
  4338         16  AT-ZIP.
  4339             20  AT-ZIP-CODE.
  4340                 24  AT-ZIP-1ST          PIC X.
  4341                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4342                 24  FILLER              PIC X(4).
  4343             20  AT-ZIP-PLUS4            PIC X(4).
  4344         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4345             20  AT-CAN-POSTAL-1         PIC XXX.
  4346             20  AT-CAN-POSTAL-2         PIC XXX.
  4347             20  FILLER                  PIC XXX.
  4348         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4349*         16  FILLER                      PIC X(23).
  4350         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4351         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4352         16  FILLER                      PIC X(13).
  4353         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4354         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4355
  4356     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4357         16  AT-INFO-LINE-1              PIC X(60).
  4358         16  FILLER REDEFINES AT-INFO-LINE-1.
  4359             20  AT-NOTE-ERROR-NO OCCURS 15
  4360                                         PIC X(4).
  4361         16  AT-INFO-LINE-2              PIC X(60).
  4362         16  AT-INFO-TRAILER-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  85
* EL1501.cbl
  4363             88  AT-ERRORS-NOTE          VALUE 'E'.
  4364             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4365             88  AT-CALL-NOTE            VALUE 'C'.
  4366             88  AT-MAINT-NOTE           VALUE 'M'.
  4367             88  AT-CERT-CHANGE          VALUE 'X'.
  4368             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4369             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4370         16  AT-CALL-TYPE                PIC X.
  4371             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4372             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4373         16  AT-NOTE-CONTINUATION        PIC X.
  4374             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4375         16  AT-EOB-CODES-EXIST          PIC X.
  4376             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4377         16  FILLER                      PIC X(35).
  4378         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4379         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4380
  4381     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4382         16  AT-PROMPT-LINE-1            PIC X(60).
  4383         16  AT-PROMPT-LINE-2            PIC X(60).
  4384         16  AT-PROMPT-START-DT          PIC XX.
  4385         16  AT-PROMPT-END-DT            PIC XX.
  4386         16  FILLER                      PIC X(35).
  4387         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4388         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4389
  4390     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4391         16  AT-DENIAL-INFO-1            PIC X(60).
  4392         16  AT-DENIAL-INFO-2            PIC X(60).
  4393         16  AT-DENIAL-DT                PIC XX.
  4394         16  AT-RETRACTION-DT            PIC XX.
  4395         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4396*         16  FILLER                      PIC X(31).
  4397         16  AT-DENIAL-PROOF-DT          PIC XX.
  4398         16  FILLER                      PIC X(29).
  4399         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4400         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4401
  4402     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4403         16  AT-OLD-INCURRED-DT          PIC XX.
  4404         16  AT-OLD-REPORTED-DT          PIC XX.
  4405         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4406         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4407         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4408         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4409         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4410         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4411         16  FILLER                      PIC X(26).
  4412         16  AT-OLD-DIAG-CODE            PIC X(6).
  4413         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4414         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4415         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4416         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4417         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4418         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4419         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4420         16  FILLER                      PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  86
* EL1501.cbl
  4421         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4422
  4423     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4424         16  AT-FORM-SEND-ON-DT          PIC XX.
  4425         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4426         16  AT-FORM-RE-SEND-DT          PIC XX.
  4427         16  AT-FORM-ANSWERED-DT         PIC XX.
  4428         16  AT-FORM-PRINTED-DT          PIC XX.
  4429         16  AT-FORM-REPRINT-DT          PIC XX.
  4430         16  AT-FORM-TYPE                PIC X.
  4431             88  INITIAL-FORM                  VALUE '1'.
  4432             88  PROGRESS-FORM                 VALUE '2'.
  4433         16  AT-INSTRUCT-LN-1            PIC X(28).
  4434         16  AT-INSTRUCT-LN-2            PIC X(28).
  4435         16  AT-INSTRUCT-LN-3            PIC X(28).
  4436         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4437         16  AT-FORM-ADDRESS             PIC X.
  4438             88  FORM-TO-INSURED              VALUE 'I'.
  4439             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4440             88  FORM-TO-OTHER-1              VALUE 'O'.
  4441             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4442         16  AT-RELATED-1.
  4443             20 AT-REL-CARR-1            PIC X.
  4444             20 AT-REL-CLAIM-1           PIC X(7).
  4445             20 AT-REL-CERT-1            PIC X(11).
  4446         16  AT-RELATED-2.
  4447             20 AT-REL-CARR-2            PIC X.
  4448             20 AT-REL-CLAIM-2           PIC X(7).
  4449             20 AT-REL-CERT-2            PIC X(11).
  4450         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4451         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4452         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4453         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4454         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4455         16  AT-STOP-FORM-DT             PIC X(2).
  4456
  4457         16  FILLER                      PIC X(09).
  4458         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4459         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4460******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  87
* EL1501.cbl
  4462*                                    COPY ELCACTQ.
  4463******************************************************************
  4464*                                                                *
  4465*                            ELCACTQ.                            *
  4466*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  4467*                            VMOD=2.004                          *
  4468*                                                                *
  4469*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  4470*                                                                *
  4471*   FILE TYPE = VSAM,KSDS                                        *
  4472*   RECORD SIZE = 60     RECFORM = FIXED                         *
  4473*                                                                *
  4474*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  4475*       ALTERNATE INDEX = NONE                                   *
  4476*                                                                *
  4477*   LOG = YES                                                    *
  4478*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4479*                                                                *
  4480*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  4481******************************************************************
  4482
  4483 01  ACTIVITY-QUE.
  4484     12  AQ-RECORD-ID                PIC XX.
  4485         88  VALID-AQ-ID                VALUE 'AQ'.
  4486
  4487     12  AQ-CONTROL-PRIMARY.
  4488         16  AQ-COMPANY-CD           PIC X.
  4489         16  AQ-CARRIER              PIC X.
  4490         16  AQ-CLAIM-NO             PIC X(7).
  4491         16  AQ-CERT-NO.
  4492             20  AQ-CERT-PRIME       PIC X(10).
  4493             20  AQ-CERT-SFX         PIC X.
  4494
  4495     12  AQ-PENDING-ACTIVITY-FLAGS.
  4496         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  4497         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  4498             88  PENDING-PAYMENTS       VALUE '1'.
  4499         16  AQ-PENDING-STATUS-FLAG  PIC X.
  4500             88  PENDING-FULL-PRINT     VALUE '1'.
  4501             88  PENDING-PART-PRINT     VALUE '2'.
  4502         16  AQ-PENDING-LETTER-FLAG  PIC X.
  4503             88  PENDING-LETTERS        VALUE '1'.
  4504         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  4505             88  PENDING-RESTORE        VALUE 'C'.
  4506             88  PENDING-RESTORE-LETTER VALUE 'L'.
  4507
  4508     12  FILLER                      PIC X(20).
  4509
  4510     12  AQ-RESEND-DATE              PIC XX.
  4511     12  AQ-FOLLOWUP-DATE            PIC XX.
  4512     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  4513     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  4514     12  AQ-AUTO-LETTER              PIC X(4).
  4515     12  FILLER                      PIC XX.
  4516     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  4517*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  88
* EL1501.cbl
  4519*                                    COPY ELCCHKQ.
  4520******************************************************************
  4521*                                                                *
  4522*                                                                *
  4523*                            ELCCHKQ.                            *
  4524*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4525*                            VMOD=2.007                          *
  4526*                                                                *
  4527*   FILE DESCRIPTION = CHECK QUE FILE                            *
  4528*                                                                *
  4529*   FILE TYPE = VSAM,KSDS                                        *
  4530*   RECORD SIZE = 100  RECFORM = FIXED                           *
  4531*                                                                *
  4532*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  4533*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  4534*                                                                *
  4535*   LOG = YES                                                    *
  4536*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4537******************************************************************
  4538 01  CHECK-QUE.
  4539     12  CQ-RECORD-ID                PIC XX.
  4540         88  VALID-CQ-ID         VALUE 'CQ'.
  4541
  4542     12  CQ-CONTROL-PRIMARY.
  4543         16  CQ-COMPANY-CD           PIC X.
  4544         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  4545         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  4546
  4547     12  CQ-CONTROL-BY-PAYEE.
  4548         16  CQ-CONTROL-BY-NUMBER.
  4549             20  CQ-COMPANY-CD-A1     PIC X.
  4550             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  4551         16  CQ-PAYEE-CARRIER        PIC X.
  4552         16  CQ-PAYEE-GROUPING       PIC X(6).
  4553         16  CQ-PAYEE-STATE          PIC XX.
  4554         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  4555         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  4556
  4557     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  4558         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  4559         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  4560         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  4561         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  4562         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  4563         16  FILLER                  PIC X(3).
  4564
  4565     12  CQ-ENTRY-TYPE               PIC X.
  4566             88  CHECK-ON-QUE           VALUE 'Q'.
  4567             88  ALIGNMENT-CHECK        VALUE 'A'.
  4568             88  SPOILED-CHECK          VALUE 'S'.
  4569             88  PAYMENT-ABORTED        VALUE 'X'.
  4570
  4571     12  CQ-CLAIM-MAST-CNTL.
  4572         16  CQ-CARRIER              PIC X.
  4573         16  CQ-CLAIM-NO             PIC X(7).
  4574         16  CQ-CERT-NO.
  4575             20  CQ-CERT-PRIME       PIC X(10).
  4576             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  89
* EL1501.cbl
  4577         16  CQ-CLAIM-TYPE           PIC X.
  4578             88  CQ-LIFE-CLAIM          VALUE 'L'.
  4579             88  CQ-AH-CLAIM            VALUE 'A'.
  4580         16  CQ-CLAIM-SUB-TYPE       PIC X.
  4581             88  CQ-FIXED-COVERAGE      VALUE '1'.
  4582             88  CQ-O-B-COVERAGE        VALUE '2'.
  4583             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  4584
  4585     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  4586     12  CQ-CHECK-NUMBER             PIC X(7).
  4587     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  4588     12  CQ-PAYMENT-TYPE             PIC X.
  4589             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  4590             88  CQ-FINAL-PAYMENT          VALUE '2'.
  4591             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  4592             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  4593             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  4594             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  4595             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  4596             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  4597     12  CQ-VOID-INDICATOR           PIC X.
  4598             88  CHECK-IS-STOPPED          VALUE 'S'.
  4599             88  CHECK-IS-VOID             VALUE 'V'.
  4600     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  4601     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  4602     12  CQ-CHECK-BY-USER            PIC X(4).
  4603     12  CQ-PRE-NUMBERING-SW         PIC X.
  4604       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  4605       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  4606
  4607     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  4608     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  4609     12  CQ-LEDGER-FLAG              PIC X(01).
  4610     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  4611     12  CQ-LAST-UPDATED-DT          PIC XX.
  4612     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  4613     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  4614
  4615     12  FILLER                      PIC X(04).
  4616
  4617******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  90
* EL1501.cbl
  4619*                                    COPY ELCRCON.
  4620******************************************************************
  4621*                                                                *
  4622*
  4623*   THIS COPYBOOK IS NOT BEING USED IN LOGIC
  4624*
  4625*
  4626*                                                                *
  4627*                            ELCRCON.                            *
  4628*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4629*                            VMOD=2.003                          *
  4630*                                                                *
  4631*   FILE DESCRIPTION = CHECK RECONCILIATION FILE                 *
  4632*                                                                *
  4633*   FILE TYPE = VSAM,KSDS                                        *
  4634*   RECORD SIZE = 194  RECFORM = FIXED                           *
  4635*                                                                *
  4636*   BASE CLUSTER = ELRCON                         RKP=2,LEN=19   *
  4637*                                                                *
  4638*   LOG = YES                                                    *
  4639*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4640******************************************************************
  4641
  4642 01  CHECK-RECONCILIATION.
  4643     12  RC-RECORD-ID                          PIC XX.
  4644         88  VALID-RC-ID                    VALUE 'RC'.
  4645     12  RC-CONTROL-PRIMARY.
  4646         16  RC-COMPANY-CD                     PIC X.
  4647         16  RC-CHECK-NO                       PIC X(7).
  4648         16  RC-CHECK-ORIGIN                   PIC X.
  4649         16  RC-GL-ACCOUNT-NO                  PIC X(10).
  4650
  4651     12  RC-CHECK-DATA.
  4652         16  RC-ISSUE-DATE.
  4653             20  RC-ISSUE-YYYY.
  4654               22  RC-ISSUE-CC                 PIC XX.
  4655               22  RC-ISSUE-YY                 PIC XX.
  4656             20  RC-ISSUE-MM                   PIC XX.
  4657             20  RC-ISSUE-DD                   PIC XX.
  4658         16  RC-CHECK-AMOUNT                   PIC 9(7)V99.
  4659         16  RC-CARRIER                        PIC X.
  4660         16  RC-CLAIM-NO                       PIC X(7).
  4661         16  RC-REFERENCE-NO                   PIC X(20).
  4662         16  RC-MORTGAGE-REF   REDEFINES  RC-REFERENCE-NO.
  4663             20  RC-MORT-REF-1-18              PIC X(18).
  4664             20  RC-MORT-REF-SUF-19-20         PIC XX.
  4665         16  FILLER  REDEFINES  RC-MORTGAGE-REF.
  4666             20  FILLER                        PIC X(13).
  4667             20  RC-CLAIM-REF.
  4668               22  RC-CLAIM-PREFIX             PIC X.
  4669               22  RC-CLAIM-NO-REF             PIC X(6).
  4670         16  RC-COVERAGE-TYPE                  PIC X.
  4671         16  RC-BENEFIT-CODE                   PIC XX.
  4672         16  RC-BENEFICIARY                    PIC X(10).
  4673         16  RC-PAYMENT-TYPE                   PIC X.
  4674         16  RC-STATUS                         PIC X.
  4675           88  RC-STATUS-ABANDONED                VALUE 'A'.
  4676           88  RC-STATUS-DESTROYED                VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  91
* EL1501.cbl
  4677           88  RC-STATUS-OUTSTANDING              VALUE 'O'.
  4678           88  RC-STATUS-REDEEMED                 VALUE 'R'.
  4679           88  RC-STATUS-STOP-PAY                 VALUE 'S'.
  4680           88  RC-STATUS-UNREDEEMED               VALUE 'U'.
  4681           88  RC-STATUS-VOIDED                   VALUE 'V'.
  4682         16  RC-STATUS-DATE.
  4683             20  RC-STATUS-YYYY.
  4684               22  RC-STATUS-CC                PIC XX.
  4685               22  RC-STATUS-YY                PIC XX.
  4686             20  RC-STATUS-MM                  PIC XX.
  4687             20  RC-STATUS-DD                  PIC XX.
  4688
  4689     12  RC-MAINT-AREA.
  4690         16  RC-LAST-MAINT-BY                  PIC X(4).
  4691         16  RC-LAST-MAINT-DT                  PIC XX.
  4692         16  RC-LAST-MAINT-HHMMSS    COMP-3    PIC S9(7).
  4693
  4694     12  RC-CHECK-MAINT-AREA.
  4695         16  RC-LAST-CHECK-BY                  PIC X(4).
  4696         16  RC-LAST-CHECK-DT                  PIC XX.
  4697         16  RC-LAST-CHECK-HHMMSS    COMP-3    PIC S9(7).
  4698     12  RC-CASHED-AMOUNT                      PIC 9(7)V99.
  4699
  4700     12  RC-CHECK-NOTE                         PIC X(67).
  4701     12  FILLER                                PIC X(11).
  4702
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  92
* EL1501.cbl
  4704*                                    COPY ERCDMDNT.
  4705*    EJECT
  4706*                                    COPY ELCDAR.
  4707******************************************************************
  4708*                                                                *
  4709*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  4710*   FILE TYPE = VSAM,KSDS                                        *
  4711*   RECORD SIZE = 25   RECFORM = FIXED                           *
  4712*   BASE CLUSTER = DLYACTV                                       *
  4713*   LOG = YES                                                    *
  4714*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  4715*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  4716*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  4717*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  4718*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  4719*               BY PROGRAM "LGINFCE".                            *
  4720*                                                                *
  4721******************************************************************
  4722 01  DAILY-ACTIVITY-RECORD.
  4723     05  DA-KEY.
  4724         10  DA-COMP-CD          PIC X.
  4725         10  DA-CARRIER          PIC X.
  4726         10  DA-CLAIM-NO         PIC X(7).
  4727         10  DA-CERT-NO.
  4728             15  DA-CERT-PRIME   PIC X(10).
  4729             15  DA-CERT-SFX     PIC X.
  4730     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  4731     05  DA-RECORD-TYPE          PIC X.
  4732     05  FILLER                  PIC X(2).
  4733******************************************************************
  4734*                                    copy ELCCRTT.
  4735******************************************************************
  4736*                                                                *
  4737*                            ELCCRTT.                            *
  4738*                                                                *
  4739*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  4740*                                                                *
  4741*   FILE TYPE = VSAM,KSDS                                        *
  4742*   RECORD SIZE = 552  RECFORM = FIXED                           *
  4743*                                                                *
  4744*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  4745*                                                                *
  4746*   LOG = YES                                                    *
  4747*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4748******************************************************************
  4749*                   C H A N G E   L O G
  4750*
  4751* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4752*-----------------------------------------------------------------
  4753*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4754* EFFECTIVE    NUMBER
  4755*-----------------------------------------------------------------
  4756* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  4757* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  4758* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  4759* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4760* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4761******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  93
* EL1501.cbl
  4762
  4763 01  CERTIFICATE-TRAILERS.
  4764     12  CS-RECORD-ID                      PIC XX.
  4765         88  VALID-CS-ID                      VALUE 'CS'.
  4766
  4767     12  CS-CONTROL-PRIMARY.
  4768         16  CS-COMPANY-CD                 PIC X.
  4769         16  CS-CARRIER                    PIC X.
  4770         16  CS-GROUPING                   PIC X(6).
  4771         16  CS-STATE                      PIC XX.
  4772         16  CS-ACCOUNT                    PIC X(10).
  4773         16  CS-CERT-EFF-DT                PIC XX.
  4774         16  CS-CERT-NO.
  4775             20  CS-CERT-PRIME             PIC X(10).
  4776             20  CS-CERT-SFX               PIC X.
  4777         16  CS-TRAILER-TYPE               PIC X.
  4778             88  COMM-TRLR           VALUE 'A'.
  4779             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  4780             88  CERT-DATA-TRLR      VALUE 'C'.
  4781
  4782     12  CS-DATA-AREA                      PIC X(516).
  4783
  4784     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  4785         16  CS-BANK-COMMISSION-AREA.
  4786             20  CS-BANK-COMMS       OCCURS 10.
  4787                 24  CS-AGT                PIC X(10).
  4788                 24  CS-COM-TYP            PIC X.
  4789                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  4790                 24  CS-RECALC-LV-INDIC    PIC X.
  4791                 24  FILLER                PIC X(10).
  4792         16  FILLER                        PIC X(256).
  4793
  4794     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  4795****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  4796****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  4797         16  CS-MB-CLAIM-DATA OCCURS 2.
  4798             20  FILLER OCCURS 10.
  4799                 24  CS-CLAIM-TYPE         PIC X.
  4800                     88  CS-AH-CLM           VALUE 'A'.
  4801                     88  CS-IU-CLM           VALUE 'I'.
  4802                     88  CS-GP-CLM           VALUE 'G'.
  4803                     88  CS-LF-CLM           VALUE 'L'.
  4804                     88  CS-PR-CLM           VALUE 'P'.
  4805                 24  CS-BANK               PIC S999 COMP-3.
  4806                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  4807                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  4808                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  4809         16  FILLER                        PIC X(216).
  4810     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  4811         16  CS-VIN-NUMBER                 PIC X(17).
  4812         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  4813         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  4814         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  4815         16  FILLER                        PIC X(496).
  4816******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  94
* EL1501.cbl
  4818*                                    COPY MPCPLCY.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  95
* EL1501.cbl
  4820 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  4821                          CONTROL-FILE CERTIFICATE-MASTER
  4822                          ACTIVITY-TRAILERS ACTIVITY-QUE
  4823                          CHECK-QUE CHECK-RECONCILIATION
  4824                          DAILY-ACTIVITY-RECORD
  4825                          CERTIFICATE-TRAILERS.
  4826 0000-DFHEXIT SECTION.
  4827     MOVE '9#                    $   ' TO DFHEIV0.
  4828     MOVE 'EL1501' TO DFHEIV1.
  4829     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4830
  4831     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  4832     MOVE '5'                    TO  DC-OPTION-CODE.
  4833     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  4834     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  4835     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  4836     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  4837
  4838     IF SAVE-DATE-YY > 70
  4839         MOVE 19                 TO  SAVE-DATE-CC
  4840     ELSE
  4841         MOVE 20                 TO  SAVE-DATE-CC.
  4842
  4843     IF EIBCALEN = 0
  4844         GO TO 8800-UNAUTHORIZED-ACCESS.
  4845
  4846     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  4847
  4848     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  4849     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  4850
  4851     MOVE EIBTRMID               TO QID-TERM.
  4852
  4853
  4854* EXEC CICS HANDLE CONDITION
  4855*        QIDERR   (1000-SHOW-CLAIM-HISTORY)
  4856*        MAPFAIL  (0100-FIRST-TIME-IN)
  4857*        NOTOPEN  (8500-FILE-NOTOPEN)
  4858*        PGMIDERR (9600-PGMID-ERROR)
  4859*        ERROR    (9990-ABEND)
  4860*    END-EXEC.
  4861*    MOVE '"$N?JL.               ! " #00004849' TO DFHEIV0
  4862     MOVE X'22244E3F4A4C2E2020202020' TO DFHEIV0(1:12)
  4863     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4864     MOVE X'2220233030303034383439' TO DFHEIV0(25:11)
  4865     CALL 'kxdfhei1' USING DFHEIV0
  4866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4867
  4868
  4869     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  4870         MOVE PI-CALLING-PROGRAM       TO RETURNED-FROM.
  4871
  4872     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  4873         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  4874             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  4875             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  4876             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  4877             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  96
* EL1501.cbl
  4878             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  4879             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  4880             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  4881             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  4882         ELSE
  4883             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  4884             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  4885             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  4886             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  4887             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  4888             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  4889             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  4890             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  4891
  4892     IF RETURNED-FROM NOT = SPACES
  4893         GO TO 0600-RECOVER-TEMP-STORAGE.
  4894
  4895     IF EIBAID = DFHCLEAR
  4896         GO TO 9400-CLEAR.
  4897
  4898     IF PI-PROCESSOR-ID = 'LGXX'
  4899         NEXT SENTENCE
  4900     ELSE
  4901
  4902* EXEC CICS READQ TS
  4903*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  4904*            INTO    (SECURITY-CONTROL)
  4905*            LENGTH  (SC-COMM-LENGTH)
  4906*            ITEM    (SC-ITEM)
  4907*        END-EXEC
  4908*    MOVE '*$II   L              ''   #00004889' TO DFHEIV0
  4909     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4910     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4911     MOVE X'2020233030303034383839' TO DFHEIV0(25:11)
  4912     CALL 'kxdfhei1' USING DFHEIV0,
  4913           PI-SECURITY-TEMP-STORE-ID,
  4914           SECURITY-CONTROL,
  4915           SC-COMM-LENGTH,
  4916           SC-ITEM,
  4917           DFHEIV99,
  4918           DFHEIV99
  4919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4920             MOVE SC-CLAIMS-DISPLAY (16)  TO  PI-DISPLAY-CAP
  4921             MOVE SC-CLAIMS-UPDATE  (16)  TO  PI-MODIFY-CAP
  4922             IF NOT DISPLAY-CAP
  4923                 MOVE 'READ'              TO  SM-READ
  4924                 PERFORM 9995-SECURITY-VIOLATION
  4925                 MOVE ER-0070             TO  EMI-ERROR
  4926                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4927                 GO TO 8100-SEND-INITIAL-MAP.
  4928
  4929     IF EIBTRNID = TRANS-ID
  4930         GO TO 0200-RECEIVE.
  4931
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  97
* EL1501.cbl
  4933 0100-FIRST-TIME-IN.
  4934     MOVE LOW-VALUES             TO  EL150BO
  4935                                     PI-PROGRAM-WORK-AREA.
  4936
  4937     MOVE 'Y'                    TO  PI-FIRST-TIME-SW
  4938                                     WS-RECORDS-READ-SW.
  4939     MOVE 1                      TO  PI-LINE-NO.
  4940     MOVE ZERO                   TO  PI-PREV-SEQ-NO
  4941                                     PI-REMINDERS-SW
  4942                                     PI-LETTERS-SW
  4943                                     PI-PAYMENTS-SW
  4944                                     PI-AUTO-PAY-SW
  4945                                     PI-NOTES-SW
  4946                                     PI-RES-EXP-SW
  4947                                     PI-DENIALS-SW
  4948                                     PI-INCURRED-DATE-SW
  4949                                     PI-FORMS-SW.
  4950
  4951
  4952* EXEC CICS DELETEQ TS
  4953*        QUEUE(QID)
  4954*    END-EXEC.
  4955*    MOVE '*&                    #   #00004926' TO DFHEIV0
  4956     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  4957     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4958     MOVE X'2020233030303034393236' TO DFHEIV0(25:11)
  4959     CALL 'kxdfhei1' USING DFHEIV0,
  4960           QID,
  4961           DFHEIV99
  4962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4963
  4964
  4965     GO TO 1000-SHOW-CLAIM-HISTORY.
  4966
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  98
* EL1501.cbl
  4968 0200-RECEIVE.
  4969     MOVE 'B'                    TO  PASS-SWITCH.
  4970     MOVE LOW-VALUES             TO  EL150BI.
  4971
  4972     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  4973         MOVE ER-0008            TO  EMI-ERROR
  4974         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4975         MOVE -1                 TO  ENTERPFL
  4976         GO TO 8200-SEND-DATAONLY.
  4977
  4978
  4979* EXEC CICS RECEIVE
  4980*        MAP      (MAP-NAME)
  4981*        MAPSET   (MAPSET-NAME)
  4982*        INTO     (EL150BI)
  4983*    END-EXEC.
  4984     MOVE LENGTH OF
  4985      EL150BI
  4986       TO DFHEIV11
  4987*    MOVE '8"T I  L              ''   #00004943' TO DFHEIV0
  4988     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  4989     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4990     MOVE X'2020233030303034393433' TO DFHEIV0(25:11)
  4991     CALL 'kxdfhei1' USING DFHEIV0,
  4992           MAP-NAME,
  4993           EL150BI,
  4994           DFHEIV11,
  4995           MAPSET-NAME,
  4996           DFHEIV99,
  4997           DFHEIV99
  4998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4999
  5000
  5001     IF ENTERPFL = 0
  5002         GO TO 0300-CHECK-PFKEYS.
  5003
  5004     IF EIBAID = DFHENTER
  5005         MOVE ER-0004            TO  EMI-ERROR
  5006         GO TO 0320-INPUT-ERROR.
  5007
  5008     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  5009         MOVE PF-VALUES (ENTERPFI)   TO  EIBAID
  5010     ELSE
  5011         MOVE ER-0029                TO  EMI-ERROR
  5012         GO TO 0320-INPUT-ERROR.
  5013
  5014 0300-CHECK-PFKEYS.
  5015     IF EIBAID = DFHPF23
  5016         GO TO 8810-PF23.
  5017
  5018     IF EIBAID = DFHPF24
  5019         GO TO 9200-RETURN-MAIN-MENU.
  5020
  5021     IF EIBAID = DFHPF12
  5022         GO TO 9500-PF12.
  5023
  5024     IF EIBAID = DFHPF3
  5025        IF LINENOL > +0
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page  99
* EL1501.cbl
  5026            GO TO 0500-CREATE-TEMP-STORAGE
  5027        ELSE
  5028            MOVE ER-0672        TO  EMI-ERROR
  5029            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5030            MOVE -1             TO  LINENOL
  5031            GO TO 8200-SEND-DATAONLY.
  5032
  5033     IF EIBAID = DFHPF4
  5034        IF LINENOL > +0
  5035           IF (PI-EL142-PRIORITY = '8')
  5036              AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
  5037                   AND 'AMWA')
  5038              MOVE ER-8003        TO  EMI-ERROR
  5039              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5040              MOVE -1             TO  LINENOL
  5041              GO TO 8200-SEND-DATAONLY
  5042           ELSE
  5043              MOVE 'V'            TO  WS-VOID-CODE
  5044              GO TO 5000-VOID-PAYMENT
  5045           END-IF
  5046        ELSE
  5047           MOVE ER-0663        TO  EMI-ERROR
  5048           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5049           MOVE -1             TO  LINENOL
  5050           GO TO 8200-SEND-DATAONLY
  5051        END-IF
  5052     END-IF
  5053
  5054     IF EIBAID = DFHPF5
  5055        IF LINENOL > +0
  5056           IF (PI-EL142-PRIORITY = '8')
  5057              AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
  5058                   AND 'AMWA')
  5059              MOVE ER-8003        TO  EMI-ERROR
  5060              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5061              MOVE -1             TO  LINENOL
  5062              GO TO 8200-SEND-DATAONLY
  5063           ELSE
  5064              MOVE 'S'           TO  WS-VOID-CODE
  5065              GO TO 5000-VOID-PAYMENT
  5066           END-IF
  5067        ELSE
  5068           MOVE ER-0835        TO  EMI-ERROR
  5069           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5070           MOVE -1             TO  LINENOL
  5071           GO TO 8200-SEND-DATAONLY
  5072        END-IF
  5073     END-IF
  5074
  5075*    IF EIBAID = DFHPF6
  5076*        IF PI-COMPANY-ID = 'DMD'
  5077*            IF LINENOL NOT = ZEROS
  5078*                MOVE LINENOI        TO SUB-1
  5079*                IF PI-TRLR-TYPE (SUB-1) = '2'
  5080*                    PERFORM 0500-CREATE-TEMP-STORAGE
  5081*                    MOVE 'EL402DMD' TO PGM-NAME
  5082*                    GO TO 9300-XCTL
  5083*                ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 100
* EL1501.cbl
  5084*                    MOVE ER-0940    TO EMI-ERROR
  5085*                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5086*                    MOVE -1         TO LINENOL
  5087*                    GO TO 8200-SEND-DATAONLY
  5088*            ELSE
  5089*                MOVE ER-0939    TO EMI-ERROR
  5090*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5091*                MOVE -1         TO LINENOL
  5092*                GO TO 8200-SEND-DATAONLY.
  5093
  5094     MOVE SPACES                 TO  ERRMSG1O.
  5095
  5096     IF EIBAID = DFHPF1
  5097         MOVE 'F'                TO  DIRECTION-SWITCH
  5098         MOVE 'Y'                TO  PI-FIRST-TIME-SW
  5099         GO TO 1000-SHOW-CLAIM-HISTORY.
  5100
  5101     IF EIBAID = DFHPF2
  5102         MOVE 'B'                TO  DIRECTION-SWITCH
  5103         MOVE 'Y'                TO  PI-FIRST-TIME-SW
  5104         MOVE PI-TRLR-SEQ-NO (1) TO  PI-PREV-SEQ-NO
  5105         GO TO 1000-SHOW-CLAIM-HISTORY.
  5106
  5107     IF EIBAID = DFHENTER
  5108         GO TO 0330-EDIT-DATA.
  5109
  5110     MOVE ER-0029                TO EMI-ERROR.
  5111
  5112 0320-INPUT-ERROR.
  5113     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5114
  5115     IF ENTERPFL = 0
  5116         MOVE -1                 TO ENTERPFL
  5117     ELSE
  5118         MOVE AL-UNBON           TO ENTERPFA
  5119         MOVE -1                 TO ENTERPFL.
  5120
  5121     GO TO 8200-SEND-DATAONLY.
  5122
  5123 0330-EDIT-DATA.
  5124     IF NOT MODIFY-CAP
  5125         MOVE 'UPDATE'           TO  SM-READ
  5126         PERFORM 9995-SECURITY-VIOLATION
  5127         MOVE ER-0070            TO  EMI-ERROR
  5128         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5129         GO TO 8100-SEND-INITIAL-MAP.
  5130
  5131     IF LINENOL  > 0 AND
  5132        RECVDTL  > 0 AND
  5133        RECVTYPL > 0
  5134           GO TO 4000-RECEIVE-FORMS.
  5135
  5136     IF LINENOL > 0 AND
  5137        RECVDTL > 0
  5138           GO TO 3000-RECEIVE-LETTERS.
  5139
  5140     IF LINENOL > 0
  5141         MOVE LINENOI            TO  SUB-1
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 101
* EL1501.cbl
  5142         IF PI-TRLR-TYPE (SUB-1) = 'A'
  5143             MOVE ER-0665        TO  EMI-ERROR
  5144             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5145             MOVE -1             TO  LINENOL
  5146             GO TO 8200-SEND-DATAONLY
  5147         ELSE
  5148             IF PI-TRLR-TYPE (SUB-1) = '4'
  5149                 MOVE ER-0666        TO  EMI-ERROR
  5150                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5151                 MOVE -1             TO  LINENOL
  5152                 GO TO 8200-SEND-DATAONLY
  5153             ELSE
  5154                 IF PI-TRLR-TYPE (SUB-1) = '2'
  5155                     MOVE ER-0667    TO  EMI-ERROR
  5156                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5157                     MOVE -1         TO  LINENOL
  5158                     GO TO 8200-SEND-DATAONLY.
  5159
  5160     MOVE 'F'                    TO  DIRECTION-SWITCH.
  5161     MOVE 'Y'                    TO  PI-FIRST-TIME-SW.
  5162     GO TO 1000-SHOW-CLAIM-HISTORY.
  5163
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 102
* EL1501.cbl
  5165 0500-CREATE-TEMP-STORAGE.
  5166     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  5167     MOVE SPACES                 TO PI-FULL-SCREEN-IND.
  5168
  5169
  5170* EXEC CICS WRITEQ TS
  5171*        QUEUE    (QID)
  5172*        FROM     (PROGRAM-INTERFACE-BLOCK)
  5173*        LENGTH   (PI-COMM-LENGTH)
  5174*    END-EXEC.
  5175*    MOVE '*"                    ''   #00005117' TO DFHEIV0
  5176     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  5177     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5178     MOVE X'2020233030303035313137' TO DFHEIV0(25:11)
  5179     CALL 'kxdfhei1' USING DFHEIV0,
  5180           QID,
  5181           PROGRAM-INTERFACE-BLOCK,
  5182           PI-COMM-LENGTH,
  5183           DFHEIV99,
  5184           DFHEIV99,
  5185           DFHEIV99
  5186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5187
  5188
  5189     IF LINENOL > +0
  5190         MOVE LINENOI            TO  SUB-1
  5191         IF PI-TRLR-TYPE (SUB-1) = '2'
  5192            MOVE +1                      TO  PI-PAYMENTS-SW
  5193            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5194                                             PI-SAVE-ATK-SEQ-NO
  5195         ELSE
  5196         IF PI-TRLR-TYPE (SUB-1) = '3'
  5197            MOVE +1                      TO  PI-AUTO-PAY-SW
  5198            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5199                                             PI-SAVE-ATK-SEQ-NO
  5200         ELSE
  5201         IF PI-TRLR-TYPE (SUB-1) = '4'
  5202            MOVE +1                      TO  PI-LETTERS-SW
  5203            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5204                                             PI-SAVE-ATK-SEQ-NO
  5205         ELSE
  5206         IF PI-TRLR-TYPE (SUB-1) = '6'
  5207            MOVE +1                      TO  PI-NOTES-SW
  5208            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5209                                             PI-SAVE-ATK-SEQ-NO
  5210         ELSE
  5211         IF PI-TRLR-TYPE (SUB-1) = '7'
  5212            MOVE +1                      TO  PI-REMINDERS-SW
  5213            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5214                                             PI-SAVE-ATK-SEQ-NO
  5215         ELSE
  5216         IF PI-TRLR-TYPE (SUB-1) = '8'
  5217            MOVE +1                      TO  PI-DENIALS-SW
  5218            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5219                                             PI-SAVE-ATK-SEQ-NO
  5220         ELSE
  5221         IF PI-TRLR-TYPE (SUB-1) = '9'
  5222            MOVE +1                      TO  PI-INCURRED-DATE-SW
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 103
* EL1501.cbl
  5223            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5224                                             PI-SAVE-ATK-SEQ-NO
  5225         ELSE
  5226            MOVE +1                      TO  PI-FORMS-SW
  5227            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5228                                             PI-SAVE-ATK-SEQ-NO
  5229     ELSE
  5230         MOVE +1                         TO  PI-REMINDERS-SW
  5231                                             PI-LETTERS-SW
  5232                                             PI-PAYMENTS-SW
  5233                                             PI-AUTO-PAY-SW
  5234                                             PI-NOTES-SW
  5235                                             PI-RES-EXP-SW
  5236                                             PI-DENIALS-SW
  5237                                             PI-INCURRED-DATE-SW
  5238                                             PI-FORMS-SW
  5239         MOVE +0                         TO  PI-ATK-SEQ-NO.
  5240
  5241     IF EIBAID = DFHPF6
  5242         MOVE PI-COMPANY-CD      TO  PI-SAVE-ATK-COMPANY-CODE
  5243                                     PI-ATK-COMPANY-CODE
  5244         MOVE PI-CARRIER         TO  PI-SAVE-ATK-CARRIER
  5245                                     PI-ATK-CARRIER
  5246         MOVE PI-CLAIM-NO        TO  PI-SAVE-ATK-CLAIM-NO
  5247                                     PI-ATK-CLAIM-NO
  5248         MOVE PI-CERT-NO         TO  PI-SAVE-ATK-CERT-NO
  5249                                     PI-ATK-CERT-NO
  5250         MOVE 'Y'                TO  PI-FIRST-TIME-SW.
  5251
  5252     IF EIBAID = DFHPF3
  5253         MOVE XCTL-142           TO  PGM-NAME
  5254         MOVE 'EL142A'           TO  PI-MAP-NAME
  5255         MOVE PI-COMPANY-CD      TO  PI-SAVE-ATK-COMPANY-CODE
  5256                                     PI-ATK-COMPANY-CODE
  5257         MOVE PI-CARRIER         TO  PI-SAVE-ATK-CARRIER
  5258                                     PI-ATK-CARRIER
  5259         MOVE PI-CLAIM-NO        TO  PI-SAVE-ATK-CLAIM-NO
  5260                                     PI-ATK-CLAIM-NO
  5261         MOVE PI-CERT-NO         TO  PI-SAVE-ATK-CERT-NO
  5262                                     PI-ATK-CERT-NO
  5263         MOVE 'Y'                TO  PI-FIRST-TIME-SW
  5264         GO TO 9300-XCTL.
  5265
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 104
* EL1501.cbl
  5267 0600-RECOVER-TEMP-STORAGE.
  5268     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  5269
  5270
  5271* EXEC CICS HANDLE CONDITION
  5272*        QIDERR   (0690-QIDERR)
  5273*    END-EXEC.
  5274*    MOVE '"$N                   ! # #00005204' TO DFHEIV0
  5275     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  5276     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5277     MOVE X'2320233030303035323034' TO DFHEIV0(25:11)
  5278     CALL 'kxdfhei1' USING DFHEIV0
  5279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5280
  5281
  5282
  5283* EXEC CICS READQ TS
  5284*        QUEUE    (QID)
  5285*        INTO     (PROGRAM-INTERFACE-BLOCK)
  5286*        LENGTH   (PI-COMM-LENGTH)
  5287*    END-EXEC.
  5288*    MOVE '*$I    L              ''   #00005208' TO DFHEIV0
  5289     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  5290     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5291     MOVE X'2020233030303035323038' TO DFHEIV0(25:11)
  5292     CALL 'kxdfhei1' USING DFHEIV0,
  5293           QID,
  5294           PROGRAM-INTERFACE-BLOCK,
  5295           PI-COMM-LENGTH,
  5296           DFHEIV99,
  5297           DFHEIV99,
  5298           DFHEIV99
  5299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5300
  5301
  5302
  5303* EXEC CICS DELETEQ TS
  5304*        QUEUE   (QID)
  5305*    END-EXEC.
  5306*    MOVE '*&                    #   #00005214' TO DFHEIV0
  5307     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  5308     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5309     MOVE X'2020233030303035323134' TO DFHEIV0(25:11)
  5310     CALL 'kxdfhei1' USING DFHEIV0,
  5311           QID,
  5312           DFHEIV99
  5313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5314
  5315
  5316     MOVE SAVE-CONTROL           TO  PI-CONTROL-IN-PROGRESS.
  5317     MOVE LOW-VALUES             TO  EL150BO.
  5318     MOVE ZEROS                  TO  PI-PREV-SEQ-NO.
  5319     MOVE 'F'                    TO  DIRECTION-SWITCH.
  5320     MOVE 'Y'                    TO  PI-FIRST-TIME-SW.
  5321
  5322     GO TO 1000-SHOW-CLAIM-HISTORY.
  5323
  5324 0690-QIDERR.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 105
* EL1501.cbl
  5325     MOVE ER-0033                TO  EMI-ERROR.
  5326     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5327     MOVE LOW-VALUES             TO  EL150BO.
  5328     MOVE -1                     TO  ENTERPFL.
  5329     GO TO 8100-SEND-INITIAL-MAP.
  5330
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 106
* EL1501.cbl
  5332 1000-SHOW-CLAIM-HISTORY.
  5333
  5334     PERFORM 2000-BUILD-TRAILER-DISPLAY THRU 2999-EXIT.
  5335
  5336     MOVE PI-CARRIER             TO  CARRO.
  5337     MOVE PI-CLAIM-NO            TO  CLMNOO.
  5338     MOVE PI-CERT-PRIME          TO  CERTNOO.
  5339     MOVE PI-CERT-SFX            TO  SUFXO.
  5340
  5341     MOVE -1                     TO  LINENOL.
  5342
  5343     IF RECORDS-READ
  5344         MOVE 'N'                TO  WS-RECORDS-READ-SW
  5345         GO TO 8100-SEND-INITIAL-MAP
  5346     ELSE
  5347         GO TO 8200-SEND-DATAONLY.
  5348
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 107
* EL1501.cbl
  5350 2000-BUILD-TRAILER-DISPLAY.
  5351
  5352     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
  5353     MOVE PI-CARRIER             TO  TRLR-CARRIER.
  5354     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
  5355     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
  5356     MOVE 'TRLR'                 TO  FILE-SWITCH.
  5357     MOVE PI-PREV-SEQ-NO         TO  TRLR-SEQ-NO.
  5358
  5359     IF PI-PREV-DIRECTION = 'B'
  5360         IF DIRECTION-SWITCH = 'F'
  5361             MOVE PI-TRLR-SEQ-NO (8) TO  TRLR-SEQ-NO
  5362                                         PI-PREV-SEQ-NO.
  5363
  5364     IF DIRECTION-SWITCH = 'B'
  5365        MOVE 'B'                 TO  PI-PREV-DIRECTION
  5366        MOVE +15                 TO  DISPLAY-CNT
  5367        GO TO 2050-START-BROWSE.
  5368
  5369     MOVE +1                     TO  DISPLAY-CNT.
  5370     MOVE 'F'                    TO  DIRECTION-SWITCH
  5371                                     PI-PREV-DIRECTION.
  5372 2010-START-BROWSE.
  5373
  5374* EXEC CICS HANDLE CONDITION
  5375*        ENDFILE   (2950-NO-MORE-TRAILERS)
  5376*        NOTFND    (2950-NO-MORE-TRAILERS)
  5377*    END-EXEC.
  5378*    MOVE '"$''I                  ! $ #00005275' TO DFHEIV0
  5379     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  5380     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5381     MOVE X'2420233030303035323735' TO DFHEIV0(25:11)
  5382     CALL 'kxdfhei1' USING DFHEIV0
  5383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5384
  5385
  5386
  5387* EXEC CICS STARTBR
  5388*        DATASET   ('ELTRLR')
  5389*        RIDFLD    (ELTRLR-KEY)
  5390*        GTEQ
  5391*    END-EXEC.
  5392     MOVE 'ELTRLR' TO DFHEIV1
  5393     MOVE 0
  5394       TO DFHEIV11
  5395*    MOVE '&,         G          &   #00005280' TO DFHEIV0
  5396     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5397     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5398     MOVE X'2020233030303035323830' TO DFHEIV0(25:11)
  5399     CALL 'kxdfhei1' USING DFHEIV0,
  5400           DFHEIV1,
  5401           ELTRLR-KEY,
  5402           DFHEIV99,
  5403           DFHEIV11,
  5404           DFHEIV99
  5405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5406
  5407
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 108
* EL1501.cbl
  5408     MOVE 1                      TO  PI-LINE-NO
  5409                                     SUB-1.
  5410
  5411 2020-BROWSE-FORWARD.
  5412
  5413
  5414* EXEC CICS HANDLE CONDITION
  5415*        NOTFND    (2020-BROWSE-FORWARD)
  5416*    END-EXEC.
  5417*    MOVE '"$I                   ! % #00005291' TO DFHEIV0
  5418     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5419     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5420     MOVE X'2520233030303035323931' TO DFHEIV0(25:11)
  5421     CALL 'kxdfhei1' USING DFHEIV0
  5422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5423
  5424
  5425
  5426* EXEC CICS READNEXT
  5427*        DATASET   ('ELTRLR')
  5428*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
  5429*        RIDFLD    (ELTRLR-KEY)
  5430*    END-EXEC.
  5431     MOVE 'ELTRLR' TO DFHEIV1
  5432     MOVE 0
  5433       TO DFHEIV11
  5434*    MOVE '&.S                   )   #00005295' TO DFHEIV0
  5435     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  5436     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5437     MOVE X'2020233030303035323935' TO DFHEIV0(25:11)
  5438     CALL 'kxdfhei1' USING DFHEIV0,
  5439           DFHEIV1,
  5440           DFHEIV20,
  5441           DFHEIV99,
  5442           ELTRLR-KEY,
  5443           DFHEIV99,
  5444           DFHEIV11,
  5445           DFHEIV99,
  5446           DFHEIV99
  5447     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5448         DFHEIV20
  5449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5450
  5451
  5452     IF (PI-COMPANY-CD NOT = TRLR-COMP-CD)  OR
  5453        (PI-CARRIER    NOT = TRLR-CARRIER)  OR
  5454        (PI-CLAIM-NO   NOT = TRLR-CLAIM-NO) OR
  5455        (PI-CERT-NO    NOT = TRLR-CERT-NO)
  5456            GO TO 2950-NO-MORE-TRAILERS.
  5457
  5458     IF TRLR-SEQ-NO = 90
  5459         GO TO 2020-BROWSE-FORWARD.
  5460
  5461     IF RESERVE-EXPENSE-TR OR ADDRESS-TR
  5462         GO TO 2020-BROWSE-FORWARD.
  5463
  5464     IF TRLR-SEQ-NO = PI-PREV-SEQ-NO
  5465         MOVE 'N'                TO  WS-RECORDS-READ-SW
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 109
* EL1501.cbl
  5466         GO TO 2020-BROWSE-FORWARD
  5467     ELSE
  5468         IF FIRST-TIME
  5469             PERFORM 2070-INITIALIZE-SCREEN-AREA THRU 2070-EXIT
  5470             MOVE 'N'            TO  PI-FIRST-TIME-SW
  5471             MOVE 'Y'            TO  WS-RECORDS-READ-SW
  5472         ELSE
  5473             MOVE 'Y'            TO  WS-RECORDS-READ-SW.
  5474
  5475     MOVE TRLR-SEQ-NO            TO  PI-PREV-SEQ-NO.
  5476     GO TO 2090-DISPLAY-TRAILER.
  5477
  5478 2050-START-BROWSE.
  5479
  5480* EXEC CICS HANDLE CONDITION
  5481*        ENDFILE   (2950-NO-MORE-TRAILERS)
  5482*        NOTFND    (2950-NO-MORE-TRAILERS)
  5483*    END-EXEC.
  5484*    MOVE '"$''I                  ! & #00005328' TO DFHEIV0
  5485     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  5486     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5487     MOVE X'2620233030303035333238' TO DFHEIV0(25:11)
  5488     CALL 'kxdfhei1' USING DFHEIV0
  5489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5490
  5491
  5492
  5493* EXEC CICS STARTBR
  5494*        DATASET   ('ELTRLR')
  5495*        RIDFLD    (ELTRLR-KEY)
  5496*        GTEQ
  5497*    END-EXEC.
  5498     MOVE 'ELTRLR' TO DFHEIV1
  5499     MOVE 0
  5500       TO DFHEIV11
  5501*    MOVE '&,         G          &   #00005333' TO DFHEIV0
  5502     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5503     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5504     MOVE X'2020233030303035333333' TO DFHEIV0(25:11)
  5505     CALL 'kxdfhei1' USING DFHEIV0,
  5506           DFHEIV1,
  5507           ELTRLR-KEY,
  5508           DFHEIV99,
  5509           DFHEIV11,
  5510           DFHEIV99
  5511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5512
  5513
  5514     MOVE 8                      TO  PI-LINE-NO
  5515                                     SUB-1.
  5516
  5517 2060-BROWSE-BACKWARD.
  5518
  5519
  5520* EXEC CICS READPREV
  5521*        DATASET   ('ELTRLR')
  5522*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
  5523*        RIDFLD    (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 110
* EL1501.cbl
  5524*    END-EXEC.
  5525     MOVE 'ELTRLR' TO DFHEIV1
  5526     MOVE 0
  5527       TO DFHEIV11
  5528*    MOVE '&0S                   )   #00005344' TO DFHEIV0
  5529     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  5530     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5531     MOVE X'2020233030303035333434' TO DFHEIV0(25:11)
  5532     CALL 'kxdfhei1' USING DFHEIV0,
  5533           DFHEIV1,
  5534           DFHEIV20,
  5535           DFHEIV99,
  5536           ELTRLR-KEY,
  5537           DFHEIV99,
  5538           DFHEIV11,
  5539           DFHEIV99,
  5540           DFHEIV99
  5541     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5542         DFHEIV20
  5543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5544
  5545
  5546     IF (PI-COMPANY-CD NOT = TRLR-COMP-CD)  OR
  5547        (PI-CARRIER    NOT = TRLR-CARRIER)  OR
  5548        (PI-CLAIM-NO   NOT = TRLR-CLAIM-NO) OR
  5549        (PI-CERT-NO    NOT = TRLR-CERT-NO)
  5550            GO TO 2950-NO-MORE-TRAILERS.
  5551
  5552     IF TRLR-SEQ-NO = 90
  5553         GO TO 2060-BROWSE-BACKWARD.
  5554
  5555     IF RESERVE-EXPENSE-TR OR ADDRESS-TR
  5556         GO TO 2060-BROWSE-BACKWARD.
  5557
  5558     IF TRLR-SEQ-NO = PI-PREV-SEQ-NO
  5559         MOVE 'N'                TO  WS-RECORDS-READ-SW
  5560         GO TO 2060-BROWSE-BACKWARD
  5561     ELSE
  5562         IF FIRST-TIME
  5563             PERFORM 2070-INITIALIZE-SCREEN-AREA THRU 2070-EXIT
  5564             MOVE 'N'            TO  PI-FIRST-TIME-SW
  5565             MOVE 'Y'            TO  WS-RECORDS-READ-SW
  5566         ELSE
  5567             MOVE 'Y'            TO  WS-RECORDS-READ-SW.
  5568
  5569     MOVE TRLR-SEQ-NO            TO  PI-PREV-SEQ-NO.
  5570     GO TO 2090-DISPLAY-TRAILER.
  5571
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 111
* EL1501.cbl
  5573 2070-INITIALIZE-SCREEN-AREA.
  5574
  5575     MOVE SPACES                 TO  TEXT-WORK-AREAS
  5576                                     MAP-HDG (1)   MAP-TEXT (1)
  5577                                     MAP-HDG (2)   MAP-TEXT (2)
  5578                                     MAP-HDG (3)   MAP-TEXT (3)
  5579                                     MAP-HDG (4)   MAP-TEXT (4)
  5580                                     MAP-HDG (5)   MAP-TEXT (5)
  5581                                     MAP-HDG (6)   MAP-TEXT (6)
  5582                                     MAP-HDG (7)   MAP-TEXT (7)
  5583                                     MAP-HDG (8)   MAP-TEXT (8)
  5584                                     MAP-HDG (9)   MAP-TEXT (9)
  5585                                     MAP-HDG (10)  MAP-TEXT (10)
  5586                                     MAP-HDG (11)  MAP-TEXT (11)
  5587                                     MAP-HDG (12)  MAP-TEXT (12)
  5588                                     MAP-HDG (13)  MAP-TEXT (13)
  5589                                     MAP-HDG (14)  MAP-TEXT (14)
  5590                                     MAP-HDG (15)  MAP-TEXT (15)
  5591                                     MAP-HDG (16)  MAP-TEXT (16).
  5592
  5593     MOVE ZEROS                  TO  PMT-AMT-PAID
  5594                                     AUTO-1ST-AMT
  5595                                     AUTO-REG-AMT
  5596                                     INCUR-TOT-PD.
  5597
  5598 2070-EXIT.
  5599     EXIT.
  5600
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 112
* EL1501.cbl
  5602 2090-DISPLAY-TRAILER.
  5603
  5604     IF PAYMENT-TR
  5605         GO TO 2100-PAYMENT-TRAILER.
  5606
  5607     IF AUTO-PAY-TR
  5608        GO TO 2200-AUTO-PAYMENT-TRAILER.
  5609
  5610     IF CORRESPONDENCE-TR
  5611         GO TO 2300-CORRESPONDENCE-TRAILER.
  5612
  5613     IF GENERAL-INFO-TR
  5614         GO TO 2400-GENERAL-INFO-TRAILER.
  5615
  5616     IF AUTO-PROMPT-TR
  5617         GO TO 2500-AUTO-PROMPT-TRAILER.
  5618
  5619     IF DENIAL-TR
  5620         GO TO 2600-DENIAL-TRAILER.
  5621
  5622     IF INCURRED-CHG-TR
  5623         GO TO 2700-INCURRED-CHANGE-TRAILER.
  5624
  5625     IF FORM-CONTROL-TR
  5626         GO TO 2710-FORM-CONTROL-TRAILER.
  5627
  5628     IF DIRECTION-SWITCH = 'B'
  5629         GO TO 2060-BROWSE-BACKWARD
  5630     ELSE
  5631         GO TO 2020-BROWSE-FORWARD.
  5632
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 113
* EL1501.cbl
  5634 2100-PAYMENT-TRAILER.
  5635     MOVE ZEROS                  TO  PMT-AMT-PAID.
  5636     MOVE PI-LINE-NO             TO  PMT-LINE-NO.
  5637     MOVE 'PAYMENT '             TO  PMT-HDG1-LIT.
  5638     MOVE 'TYPE: '               TO  PMT-TYPE-LIT.
  5639
  5640     IF TRANSFER
  5641        MOVE 'TRANSFR'           TO PMT-TYPE
  5642        GO TO 2100-CONT
  5643     ELSE
  5644        IF AT-PAYMENT-TYPE = 'I'
  5645           MOVE 'INTEREST'       TO PMT-TYPE
  5646           GO TO 2100-CONT
  5647        END-IF
  5648     END-IF
  5649     IF AT-CV-PMT-CODE = ' '
  5650         MOVE AT-PAYMENT-TYPE            TO  WS-SUB
  5651         IF  WS-SUB < 1 OR > 6
  5652             MOVE 2                      TO  WS-SUB
  5653             MOVE PAY-DESC (WS-SUB)      TO  PMT-TYPE
  5654         ELSE
  5655             MOVE PAY-DESC (WS-SUB)      TO  PMT-TYPE
  5656     ELSE
  5657         MOVE AT-CV-PMT-CODE             TO  WS-SUB
  5658         IF WS-SUB < 1 OR > 8
  5659             MOVE 1                      TO  WS-SUB
  5660             MOVE CV-PAY-DESC (WS-SUB)   TO  PMT-TYPE
  5661         ELSE
  5662             MOVE CV-PAY-DESC (WS-SUB)   TO  PMT-TYPE.
  5663
  5664 2100-CONT.
  5665
  5666     MOVE ' CHECK NO: '          TO  PMT-CHECK-NO-LIT.
  5667     MOVE AT-CHECK-NO            TO  PMT-CHECK-NO.
  5668
  5669     IF AT-CHECK-WRITTEN-DT = LOW-VALUES
  5670         IF AT-TO-BE-WRITTEN-DT = LOW-VALUES
  5671             MOVE ' DT WRITTEN : '         TO  PMT-DT-WRITTEN-LIT
  5672             MOVE SPACES                   TO  PMT-DT-WRITTEN
  5673         ELSE
  5674             MOVE ' HOLD UNTIL : '         TO  PMT-DT-WRITTEN-LIT
  5675             MOVE AT-TO-BE-WRITTEN-DT      TO  DC-BIN-DATE-1
  5676             MOVE ' '                      TO  DC-OPTION-CODE
  5677             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5678             IF NO-CONVERSION-ERROR
  5679                 MOVE DC-GREG-DATE-1-EDIT  TO  PMT-DT-WRITTEN
  5680             ELSE
  5681                 MOVE SPACES               TO  PMT-DT-WRITTEN
  5682     ELSE
  5683         MOVE ' DT WRITTEN : '             TO  PMT-DT-WRITTEN-LIT
  5684         MOVE AT-CHECK-WRITTEN-DT          TO  DC-BIN-DATE-1
  5685         MOVE ' '                          TO  DC-OPTION-CODE
  5686         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5687         IF NO-CONVERSION-ERROR
  5688             MOVE DC-GREG-DATE-1-EDIT      TO  PMT-DT-WRITTEN
  5689         ELSE
  5690             MOVE SPACES                   TO  PMT-DT-WRITTEN.
  5691
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 114
* EL1501.cbl
  5692     MOVE ' AMT:'                TO  PMT-AMT-PD-LIT.
  5693     MOVE AT-AMOUNT-PAID         TO  PMT-AMT-PAID.
  5694
  5695     MOVE 'PAID'                 TO  PMT-HDG2-LIT.
  5696     MOVE 'FROM: '               TO  PMT-FROM-LIT.
  5697
  5698     IF AT-PAID-FROM-DT = LOW-VALUES
  5699         MOVE SPACES                     TO  PMT-PAID-FROM
  5700     ELSE
  5701         MOVE AT-PAID-FROM-DT            TO  DC-BIN-DATE-1
  5702         MOVE ' '                        TO  DC-OPTION-CODE
  5703         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5704         IF NO-CONVERSION-ERROR
  5705             MOVE DC-GREG-DATE-1-EDIT    TO PMT-PAID-FROM
  5706         ELSE
  5707             MOVE SPACES                 TO  PMT-PAID-FROM.
  5708
  5709     IF PI-USES-PAID-TO
  5710         MOVE ' PAID TO: '               TO  PMT-THRU-LIT
  5711     ELSE
  5712         MOVE ' PD THRU: '               TO  PMT-THRU-LIT.
  5713
  5714     IF AT-PAID-THRU-DT = LOW-VALUES
  5715         MOVE SPACES                     TO  PMT-PAID-THRU
  5716     ELSE
  5717         IF PI-USES-PAID-TO
  5718             MOVE AT-PAID-THRU-DT        TO  DC-BIN-DATE-1
  5719             MOVE '6'                    TO  DC-OPTION-CODE
  5720             MOVE +1                     TO  DC-ELAPSED-DAYS
  5721             MOVE +0                     TO  DC-ELAPSED-MONTHS
  5722             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5723             IF NO-CONVERSION-ERROR
  5724                 MOVE DC-GREG-DATE-1-EDIT TO PMT-PAID-THRU
  5725             ELSE
  5726                 MOVE SPACES             TO  PMT-PAID-THRU
  5727         ELSE
  5728             MOVE AT-PAID-THRU-DT        TO  DC-BIN-DATE-1
  5729             MOVE ' '                    TO  DC-OPTION-CODE
  5730             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5731             IF NO-CONVERSION-ERROR
  5732                 MOVE DC-GREG-DATE-1-EDIT TO  PMT-PAID-THRU
  5733             ELSE
  5734                 MOVE SPACES             TO  PMT-PAID-THRU.
  5735
  5736     MOVE ' PAYEE: '             TO  PMT-PAYEE-LIT.
  5737     IF INSURED-PAID
  5738         MOVE 'INSURED'          TO  PMT-PAYEE.
  5739     IF BENEFICIARY-PAID
  5740         MOVE 'BENEF '           TO  PMT-PAYEE.
  5741     IF ACCOUNT-PAID
  5742         MOVE 'ACCOUNT'          TO  PMT-PAYEE.
  5743     IF OTHER-1-PAID
  5744         MOVE 'OTHER 1'          TO  PMT-PAYEE.
  5745     IF OTHER-2-PAID
  5746         MOVE 'OTHER 2'          TO  PMT-PAYEE.
  5747     IF DOCTOR-PAID
  5748         MOVE 'DOCTOR'           TO  PMT-PAYEE.
  5749     IF EMPLOYER-PAID
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 115
* EL1501.cbl
  5750         MOVE 'EMPLOY'           TO  PMT-PAYEE.
  5751
  5752     IF AT-VOID-DT = LOW-VALUES OR SPACES
  5753         MOVE SPACES                     TO  PMT-VOID-LIT
  5754     ELSE
  5755         IF AT-VOID-TYPE = 'S'
  5756             MOVE ' STOP DATE : '        TO  PMT-VOID-LIT
  5757         ELSE
  5758             MOVE ' VOID DATE : '        TO  PMT-VOID-LIT.
  5759
  5760     IF AT-VOID-DT = LOW-VALUES
  5761         MOVE SPACES                     TO  PMT-VOID-DT
  5762     ELSE
  5763         MOVE AT-VOID-DT                 TO  DC-BIN-DATE-1
  5764         MOVE ' '                        TO  DC-OPTION-CODE
  5765         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5766         IF NO-CONVERSION-ERROR
  5767             MOVE DC-GREG-DATE-1-EDIT    TO  PMT-VOID-DT
  5768         ELSE
  5769             MOVE SPACES                 TO  PMT-VOID-DT.
  5770
  5771     MOVE PMT-HDG1               TO  MAP-HDG        (DISPLAY-CNT).
  5772     MOVE PMT-TEXT-1             TO  MAP-TEXT       (DISPLAY-CNT).
  5773     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  5774     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
  5775     ADD +1 TO DISPLAY-CNT.
  5776     MOVE PMT-HDG2               TO  MAP-HDG        (DISPLAY-CNT).
  5777     MOVE PMT-TEXT-2             TO  MAP-TEXT       (DISPLAY-CNT).
  5778     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
  5779                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  5780     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  5781     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  5782     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  5783
  5784     GO TO 2800-INCR-DISPLAY-CNT.
  5785
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 116
* EL1501.cbl
  5787 2200-AUTO-PAYMENT-TRAILER.
  5788     MOVE PI-LINE-NO             TO  AUTO-LINE-NO.
  5789     MOVE 'AUTO PMT'             TO  AUTO-HDG1-LIT.
  5790
  5791     MOVE 'EFF : '                       TO  AUTO-EFF-DT-LIT.
  5792
  5793     IF AT-SCHEDULE-START-DT = LOW-VALUES
  5794         MOVE SPACES                     TO  AUTO-EFF-DT
  5795     ELSE
  5796         MOVE AT-SCHEDULE-START-DT   TO  DC-BIN-DATE-1
  5797         MOVE ' '                    TO  DC-OPTION-CODE
  5798         MOVE +0                     TO  DC-ELAPSED-DAYS
  5799                                         DC-ELAPSED-MONTHS
  5800         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5801         IF NO-CONVERSION-ERROR
  5802             MOVE DC-GREG-DATE-1-EDIT TO AUTO-EFF-DT
  5803         ELSE
  5804             MOVE SPACES             TO  AUTO-EFF-DT.
  5805
  5806     MOVE ' 1ST AMT: '           TO  AUTO-1ST-AMT-LIT.
  5807     MOVE ' REG AMOUNT : '       TO  AUTO-REG-AMT-LIT.
  5808     MOVE AT-FIRST-PMT-AMT       TO  AUTO-1ST-AMT.
  5809     MOVE AT-REGULAR-PMT-AMT     TO  AUTO-REG-AMT.
  5810
  5811     MOVE ' STAT : '             TO  AUTO-PMT-STATUS-LIT.
  5812
  5813     IF AT-TERMINATED-DT NOT = LOW-VALUES
  5814         MOVE 'TERM'             TO  AUTO-PMT-STATUS
  5815     ELSE
  5816         MOVE 'ACTIVE'           TO  AUTO-PMT-STATUS.
  5817
  5818     MOVE 'PAYE'                 TO  AUTO-HDG2-LIT.
  5819     MOVE '    : '               TO  AUTO-PAYEE-LIT.
  5820
  5821     IF INSURED-PAID-AUTO
  5822         MOVE 'INSURED '         TO  AUTO-PAYEE.
  5823     IF BENEFICIARY-PAID-AUTO
  5824         MOVE 'BENEF   '         TO  AUTO-PAYEE.
  5825     IF ACCOUNT-PAID-AUTO
  5826         MOVE 'ACCOUNT '         TO  AUTO-PAYEE.
  5827     IF OTHER-1-PAID-AUTO
  5828         MOVE 'OTHER 1 '         TO  AUTO-PAYEE.
  5829     IF OTHER-2-PAID
  5830         MOVE 'OTHER 2 '         TO  AUTO-PAYEE.
  5831     IF DOCTOR-PAID
  5832         MOVE 'DOCTOR  '         TO  AUTO-PAYEE.
  5833
  5834     MOVE ' 1ST PMT: '                   TO  AUTO-1ST-PMT-LIT.
  5835
  5836     IF AT-1ST-PAY-THRU-DT = LOW-VALUES
  5837         MOVE SPACES                     TO  AUTO-1ST-PMT-DT
  5838     ELSE
  5839         IF PI-USES-PAID-TO
  5840             MOVE AT-1ST-PAY-THRU-DT     TO  DC-BIN-DATE-1
  5841             MOVE '6'                    TO  DC-OPTION-CODE
  5842             MOVE +1                     TO  DC-ELAPSED-DAYS
  5843             MOVE +0                     TO  DC-ELAPSED-MONTHS
  5844             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 117
* EL1501.cbl
  5845             IF NO-CONVERSION-ERROR
  5846                 MOVE DC-GREG-DATE-1-EDIT TO AUTO-1ST-PMT-DT
  5847             ELSE
  5848                 MOVE SPACES             TO  AUTO-1ST-PMT-DT
  5849         ELSE
  5850             MOVE AT-1ST-PAY-THRU-DT     TO  DC-BIN-DATE-1
  5851             MOVE ' '                    TO  DC-OPTION-CODE
  5852             MOVE +0                     TO  DC-ELAPSED-DAYS
  5853                                             DC-ELAPSED-MONTHS
  5854             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5855             IF NO-CONVERSION-ERROR
  5856                 MOVE DC-GREG-DATE-1-EDIT TO AUTO-1ST-PMT-DT
  5857             ELSE
  5858                 MOVE SPACES             TO  AUTO-1ST-PMT-DT.
  5859
  5860     IF AT-TERMINATED-DT = LOW-VALUES
  5861         IF AT-SCHEDULE-END-DT = LOW-VALUES
  5862             MOVE SPACES                     TO  AUTO-LST-PMT-DT
  5863         ELSE
  5864             MOVE ' LST PMT    : '           TO  AUTO-LST-PMT-LIT
  5865             IF PI-USES-PAID-TO
  5866                 MOVE AT-SCHEDULE-END-DT     TO  DC-BIN-DATE-1
  5867                 MOVE '6'                    TO  DC-OPTION-CODE
  5868                 MOVE +1                     TO  DC-ELAPSED-DAYS
  5869                 MOVE +0                     TO  DC-ELAPSED-MONTHS
  5870                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5871                 IF NO-CONVERSION-ERROR
  5872                     MOVE DC-GREG-DATE-1-EDIT TO AUTO-LST-PMT-DT
  5873                 ELSE
  5874                     MOVE SPACES             TO  AUTO-LST-PMT-DT
  5875             ELSE
  5876                 MOVE AT-SCHEDULE-END-DT     TO  DC-BIN-DATE-1
  5877                 MOVE ' '                    TO  DC-OPTION-CODE
  5878                 MOVE +0                     TO  DC-ELAPSED-DAYS
  5879                                                 DC-ELAPSED-MONTHS
  5880                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5881                 IF NO-CONVERSION-ERROR
  5882                     MOVE DC-GREG-DATE-1-EDIT TO AUTO-LST-PMT-DT
  5883                 ELSE
  5884                     MOVE SPACES             TO  AUTO-LST-PMT-DT
  5885     ELSE
  5886         MOVE ' TERM DATE  : '               TO  AUTO-LST-PMT-LIT
  5887         MOVE AT-TERMINATED-DT               TO  DC-BIN-DATE-1
  5888         MOVE ' '                            TO  DC-OPTION-CODE
  5889         MOVE +0                             TO  DC-ELAPSED-DAYS
  5890                                                 DC-ELAPSED-MONTHS
  5891         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5892         IF NO-CONVERSION-ERROR
  5893             MOVE DC-GREG-DATE-1-EDIT        TO  AUTO-LST-PMT-DT
  5894         ELSE
  5895             MOVE SPACES                     TO  AUTO-LST-PMT-DT.
  5896
  5897     MOVE AUTO-PMT-HDG1          TO  MAP-HDG        (DISPLAY-CNT).
  5898     MOVE AUTO-PMT-TEXT1         TO  MAP-TEXT       (DISPLAY-CNT).
  5899     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  5900     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
  5901     ADD +1 TO DISPLAY-CNT.
  5902     MOVE AUTO-PMT-HDG2          TO  MAP-HDG        (DISPLAY-CNT).
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 118
* EL1501.cbl
  5903     MOVE AUTO-PMT-TEXT2         TO  MAP-TEXT       (DISPLAY-CNT).
  5904     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
  5905                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  5906     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  5907     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  5908     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  5909
  5910     GO TO 2800-INCR-DISPLAY-CNT.
  5911
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 119
* EL1501.cbl
  5913 2300-CORRESPONDENCE-TRAILER.
  5914     MOVE PI-LINE-NO             TO  CORR-LINE-NO.
  5915     MOVE 'LETTER'               TO  CORR-HDG1-LIT.
  5916     MOVE 'FORM: '               TO  CORR-FORM-LIT.
  5917     MOVE AT-STD-LETTER-FORM     TO  CORR-FORM-TYPE.
  5918
  5919     MOVE ' DT SENT: '                   TO  CORR-DT-SENT-LIT.
  5920
  5921     IF AT-LETTER-SENT-DT = LOW-VALUES
  5922         MOVE SPACES                     TO  CORR-DT-SENT
  5923     ELSE
  5924         MOVE AT-LETTER-SENT-DT          TO  DC-BIN-DATE-1
  5925         MOVE ' '                        TO  DC-OPTION-CODE
  5926         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5927         IF NO-CONVERSION-ERROR
  5928             MOVE DC-GREG-DATE-1-EDIT    TO  CORR-DT-SENT
  5929         ELSE
  5930             MOVE SPACES                 TO  CORR-DT-SENT.
  5931
  5932        MOVE ' INIT PRT: '               TO  CORR-INIT-PRT-LIT.
  5933
  5934     IF AT-INITIAL-PRINT-DATE = LOW-VALUES
  5935         MOVE SPACES                     TO  CORR-INIT-PRT-DT
  5936     ELSE
  5937         MOVE AT-INITIAL-PRINT-DATE      TO  DC-BIN-DATE-1
  5938         MOVE ' '                        TO  DC-OPTION-CODE
  5939         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5940         IF NO-CONVERSION-ERROR
  5941             MOVE DC-GREG-DATE-1-EDIT    TO  CORR-INIT-PRT-DT
  5942         ELSE
  5943             MOVE SPACES                 TO  CORR-INIT-PRT-DT.
  5944
  5945     MOVE ' TO: '                TO  CORR-ADDR-LIT.
  5946     MOVE AT-ADDRESEE-TYPE       TO  CORR-ADDR-TYPE.
  5947
  5948     IF AT-LETTER-TO-BENE EQUAL 'Y'
  5949        MOVE 'LETTER TO BENE'    TO CORR-LET-TO-BEN
  5950     ELSE
  5951        MOVE SPACES              TO CORR-LET-TO-BEN
  5952     END-IF.
  5953
  5954     MOVE 'DATE: '                          TO  CORR-RESEND-LIT.
  5955
  5956     IF AT-RESEND-PRINT-DATE = LOW-VALUES
  5957         IF AT-AUTO-RE-SEND-DT = LOW-VALUES
  5958             MOVE SPACES                    TO  CORR-RESEND-DT
  5959         ELSE
  5960             MOVE 'RSND'                    TO  CORR-HDG2-LIT
  5961             MOVE AT-AUTO-RE-SEND-DT        TO  DC-BIN-DATE-1
  5962             MOVE ' '                       TO  DC-OPTION-CODE
  5963             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5964             IF NO-CONVERSION-ERROR
  5965                 MOVE DC-GREG-DATE-1-EDIT   TO  CORR-RESEND-DT
  5966             ELSE
  5967                 MOVE SPACES                TO  CORR-RESEND-DT
  5968     ELSE
  5969         MOVE 'RSNT'                        TO  CORR-HDG2-LIT
  5970         MOVE AT-RESEND-PRINT-DATE          TO  DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 120
* EL1501.cbl
  5971         MOVE ' '                           TO  DC-OPTION-CODE
  5972         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5973         IF NO-CONVERSION-ERROR
  5974             MOVE DC-GREG-DATE-1-EDIT       TO  CORR-RESEND-DT
  5975         ELSE
  5976             MOVE SPACES                    TO  CORR-RESEND-DT.
  5977
  5978     IF AT-STOP-LETTER-DT NOT = LOW-VALUES AND SPACES
  5979        AND (AT-LETTER-ANSWERED-DT = LOW-VALUES  OR
  5980             AT-LETTER-ANSWERED-DT > AT-STOP-LETTER-DT)
  5981           MOVE '    STOP:'             TO  CORR-RECVD-LIT
  5982           MOVE AT-STOP-LETTER-DT       TO  DC-BIN-DATE-1
  5983           MOVE ' '                     TO  DC-OPTION-CODE
  5984           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5985           IF NO-CONVERSION-ERROR
  5986             MOVE DC-GREG-DATE-1-EDIT   TO  CORR-RECVD-DT
  5987           ELSE
  5988             MOVE SPACES                TO  CORR-RECVD-DT
  5989           END-IF
  5990     ELSE
  5991        IF AT-LETTER-SENT-DT = LOW-VALUES OR SPACES
  5992            MOVE 'MAIL RCVD'    TO CORR-HDG1-LIT
  5993        END-IF
  5994        MOVE ' RECVD  : '               TO  CORR-RECVD-LIT
  5995        IF AT-LETTER-ANSWERED-DT = LOW-VALUES
  5996            MOVE SPACES                 TO  CORR-RECVD-DT
  5997        ELSE
  5998            MOVE AT-LETTER-ANSWERED-DT  TO  DC-BIN-DATE-1
  5999            MOVE ' '                    TO  DC-OPTION-CODE
  6000            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6001            IF NO-CONVERSION-ERROR
  6002                MOVE DC-GREG-DATE-1-EDIT TO CORR-RECVD-DT
  6003            ELSE
  6004                MOVE SPACES             TO  CORR-RECVD-DT
  6005            END-IF
  6006        END-IF
  6007     END-IF.
  6008
  6009     MOVE ' FOLLOW UP  : '              TO  CORR-FOLLOW-UP-LIT.
  6010
  6011     IF AT-RECEIPT-FOLLOW-UP = LOW-VALUES
  6012         MOVE SPACES                    TO  CORR-FOLLOW-UP-DT
  6013     ELSE
  6014         MOVE AT-RECEIPT-FOLLOW-UP      TO  DC-BIN-DATE-1
  6015         MOVE ' '                       TO  DC-OPTION-CODE
  6016         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6017         IF NO-CONVERSION-ERROR
  6018             MOVE DC-GREG-DATE-1-EDIT   TO  CORR-FOLLOW-UP-DT
  6019         ELSE
  6020             MOVE SPACES                TO  CORR-FOLLOW-UP-DT.
  6021
  6022     MOVE ' ARC: '               TO  CORR-ARCH-LIT.
  6023     MOVE AT-LETTER-ARCHIVE-NO   TO  CORR-ARCH-NO.
  6024
  6025     MOVE CORR-HDG1              TO  MAP-HDG        (DISPLAY-CNT).
  6026     MOVE CORR-TEXT-1            TO  MAP-TEXT       (DISPLAY-CNT).
  6027     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  6028     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 121
* EL1501.cbl
  6029     ADD +1 TO DISPLAY-CNT.
  6030     MOVE CORR-HDG2              TO  MAP-HDG        (DISPLAY-CNT).
  6031     MOVE CORR-TEXT-2            TO  MAP-TEXT       (DISPLAY-CNT).
  6032     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
  6033                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  6034     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  6035     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  6036     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  6037
  6038     GO TO 2800-INCR-DISPLAY-CNT.
  6039
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 122
* EL1501.cbl
  6041 2400-GENERAL-INFO-TRAILER.
  6042
  6043     MOVE SPACES                 TO GEN-INFO-LINE-1
  6044                                    GEN-INFO-LINE-2.
  6045
  6046     IF AT-PAYMENT-NOTE
  6047         IF DIRECTION-SWITCH = 'B'
  6048             GO TO 2060-BROWSE-BACKWARD
  6049         ELSE
  6050             GO TO 2020-BROWSE-FORWARD.
  6051
  6052     MOVE PI-LINE-NO             TO  GI-LINE-NO.
  6053     evaluate true
  6054        when at-maint-note
  6055           MOVE 'MAINT'          TO GI-HDG1-LIT
  6056        when at-call-note
  6057           MOVE 'CALL'           TO GI-HDG1-LIT
  6058           IF AT-PHONE-CALL-IN
  6059               MOVE '     IN'    TO GI-HDG2-LIT
  6060           ELSE
  6061               MOVE '     OUT'   TO GI-HDG2-LIT
  6062           END-IF
  6063        when at-cert-change
  6064           MOVE 'CERT CHG'       TO GI-HDG1-LIT
  6065        when at-errors-note
  6066           move  'NOTE'          TO  GI-HDG1-LIT
  6067           perform 7520-read-claim-mstr
  6068                                 thru 7520-exit
  6069           if resp-normal
  6070              move cl-claim-type to pi-save-type
  6071           end-if
  6072           move error-message-interface-block
  6073                                 to ws-save-error-interface-block
  6074           perform varying s1 from +1 by +1 until
  6075              at-note-error-no (s1) = spaces
  6076              move at-note-error-no (s1)
  6077                                 to emi-error
  6078              PERFORM 9900-ERROR-FORMAT
  6079                                 THRU 9900-EXIT
  6080              if at-note-error-no (s1) = '1653'
  6081                 evaluate true
  6082                    when pi-save-type = 'L'
  6083                       move '    LF    '
  6084                                 to emi-text-variable (1)
  6085                    when pi-save-type = 'I'
  6086                       move '    IU    '
  6087                                 to emi-text-variable (1)
  6088                    when other
  6089                       move '    AH    '
  6090                                 to emi-text-variable (1)
  6091                 end-evaluate
  6092              end-if
  6093              move 'MSG : '      to gen-info-msg-1-lit
  6094              move emi-line1 (8:64)
  6095                                 to gen-info-msg-1
  6096              move gen-info-hdg1 to map-hdg (display-cnt)
  6097              move gen-info-text-1
  6098                                 to map-text (display-cnt)
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 123
* EL1501.cbl
  6099              move al-sabon      to map-hdg-attrb (display-cnt)
  6100                                    map-text-attrb (display-cnt)
  6101              add +1 to display-cnt pi-line-no
  6102           end-perform
  6103           if s1 > +1
  6104              subtract +1 from display-cnt
  6105              subtract +1 from pi-line-no
  6106           end-if
  6107           move ws-save-error-interface-block
  6108                                 to error-message-interface-block
  6109           MOVE TRLR-SEQ-NO      TO PI-TRLR-SEQ-NO (SUB-1)
  6110           MOVE PI-LINE-NO       TO PI-TRLR-LN-NO  (SUB-1)
  6111           MOVE AT-TRAILER-TYPE  TO PI-TRLR-TYPE   (SUB-1)
  6112           GO TO 2800-INCR-DISPLAY-CNT
  6113        when other
  6114           move  'NOTE'          TO  GI-HDG1-LIT
  6115     end-evaluate
  6116
  6117     MOVE 'MSG : '               TO  GEN-INFO-MSG-1-LIT
  6118                                     GEN-INFO-MSG-2-LIT.
  6119
  6120     MOVE AT-INFO-LINE-1         TO  GEN-INFO-MSG-1.
  6121     MOVE AT-INFO-LINE-2         TO  GEN-INFO-MSG-2.
  6122
  6123     MOVE GEN-INFO-HDG1          TO  MAP-HDG        (DISPLAY-CNT).
  6124     MOVE GEN-INFO-TEXT-1        TO  MAP-TEXT       (DISPLAY-CNT).
  6125     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  6126     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
  6127     ADD +1 TO DISPLAY-CNT.
  6128     MOVE GEN-INFO-HDG2          TO  MAP-HDG        (DISPLAY-CNT).
  6129     MOVE GEN-INFO-TEXT-2        TO  MAP-TEXT       (DISPLAY-CNT).
  6130     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
  6131                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  6132     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  6133     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  6134     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  6135
  6136     GO TO 2800-INCR-DISPLAY-CNT.
  6137
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 124
* EL1501.cbl
  6139 2500-AUTO-PROMPT-TRAILER.
  6140     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  6141     MOVE '5'                    TO  DC-OPTION-CODE.
  6142     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  6143
  6144     IF DC-BIN-DATE-1 > AT-PROMPT-END-DT
  6145         IF DIRECTION-SWITCH = 'B'
  6146             GO TO 2060-BROWSE-BACKWARD
  6147         ELSE
  6148             GO TO 2020-BROWSE-FORWARD.
  6149
  6150     MOVE PI-LINE-NO             TO  REM-LINE-NO.
  6151     MOVE 'REMINDER'             TO  REM-HDG1-LIT.
  6152     MOVE 'LN 1: '               TO  REM-LINE-1-LIT.
  6153     MOVE 'LN 2: '               TO  REM-LINE-2-LIT.
  6154
  6155     MOVE AT-PROMPT-LINE-1       TO  REM-LINE-1.
  6156     MOVE AT-PROMPT-LINE-2       TO  REM-LINE-2.
  6157
  6158     MOVE REMINDER-HDG1          TO  MAP-HDG        (DISPLAY-CNT).
  6159     MOVE REMINDER-TEXT-1        TO  MAP-TEXT       (DISPLAY-CNT).
  6160     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  6161     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
  6162     ADD +1 TO DISPLAY-CNT.
  6163     MOVE REMINDER-HDG2          TO  MAP-HDG        (DISPLAY-CNT).
  6164     MOVE REMINDER-TEXT-2        TO  MAP-TEXT       (DISPLAY-CNT).
  6165     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
  6166                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  6167     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  6168     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  6169     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  6170
  6171     GO TO 2800-INCR-DISPLAY-CNT.
  6172
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 125
* EL1501.cbl
  6174 2600-DENIAL-TRAILER.
  6175     MOVE PI-LINE-NO             TO  DENIAL-LINE-NO.
  6176     MOVE 'DENIAL'               TO  DENIAL-HDG1-LIT.
  6177     MOVE 'LN 1: '               TO  DENIAL-LN1-LIT.
  6178     MOVE 'LN 2: '               TO  DENIAL-LN2-LIT.
  6179
  6180     MOVE AT-DENIAL-INFO-1       TO  DENIAL-LN1.
  6181     MOVE AT-DENIAL-INFO-2       TO  DENIAL-LN2.
  6182
  6183     MOVE DENIAL-HDG1            TO  MAP-HDG        (DISPLAY-CNT).
  6184     MOVE DENIAL-TEXT-1          TO  MAP-TEXT       (DISPLAY-CNT).
  6185     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  6186     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
  6187     ADD +1 TO DISPLAY-CNT.
  6188     MOVE DENIAL-HDG2            TO  MAP-HDG        (DISPLAY-CNT).
  6189     MOVE DENIAL-TEXT-2          TO  MAP-TEXT       (DISPLAY-CNT).
  6190     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
  6191                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  6192     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  6193     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  6194     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  6195
  6196     GO TO 2800-INCR-DISPLAY-CNT.
  6197
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 126
* EL1501.cbl
  6199 2700-INCURRED-CHANGE-TRAILER.
  6200     MOVE PI-LINE-NO             TO  INCUR-LINE-NO.
  6201     MOVE 'INCUR CG'             TO  INCUR-HDG1-LIT.
  6202
  6203     MOVE 'INC : '                       TO  INCUR-INCUR-LIT.
  6204     IF AT-OLD-INCURRED-DT = LOW-VALUES
  6205         MOVE SPACES                     TO  INCUR-INCUR-DT
  6206     ELSE
  6207         MOVE AT-OLD-INCURRED-DT         TO  DC-BIN-DATE-1
  6208         MOVE ' '                        TO  DC-OPTION-CODE
  6209         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6210         IF NO-CONVERSION-ERROR
  6211             MOVE DC-GREG-DATE-1-EDIT    TO  INCUR-INCUR-DT
  6212         ELSE
  6213             MOVE SPACES                 TO  INCUR-INCUR-DT.
  6214
  6215     MOVE ' REPORT : '                   TO  INCUR-REPORT-LIT.
  6216     IF AT-OLD-REPORTED-DT = LOW-VALUES
  6217         MOVE SPACES                     TO  INCUR-REPORT-DT
  6218     ELSE
  6219         MOVE AT-OLD-REPORTED-DT         TO  DC-BIN-DATE-1
  6220         MOVE ' '                        TO  DC-OPTION-CODE
  6221         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6222         IF NO-CONVERSION-ERROR
  6223             MOVE DC-GREG-DATE-1-EDIT    TO  INCUR-REPORT-DT
  6224         ELSE
  6225             MOVE SPACES                 TO  INCUR-REPORT-DT.
  6226
  6227     MOVE ' ESTABLISH  : '               TO  INCUR-ESTAB-LIT.
  6228     IF AT-OLD-ESTABLISHED-DT = LOW-VALUES
  6229         MOVE SPACES                     TO  INCUR-ESTAB-DT
  6230     ELSE
  6231         MOVE AT-OLD-ESTABLISHED-DT      TO  DC-BIN-DATE-1
  6232         MOVE ' '                        TO  DC-OPTION-CODE
  6233         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6234         IF NO-CONVERSION-ERROR
  6235             MOVE DC-GREG-DATE-1-EDIT    TO  INCUR-ESTAB-DT
  6236         ELSE
  6237             MOVE SPACES                 TO  INCUR-ESTAB-DT.
  6238
  6239     MOVE 'PAID'                         TO  INCUR-HDG2-LIT.
  6240     IF PI-USES-PAID-TO
  6241         MOVE '  TO: '                   TO  INCUR-PD-THRU-LIT
  6242     ELSE
  6243         MOVE 'THRU: '                   TO  INCUR-PD-THRU-LIT.
  6244
  6245     IF AT-OLD-PAID-THRU-DT = LOW-VALUES
  6246         MOVE SPACES                     TO  INCUR-PD-THRU-DT
  6247     ELSE
  6248         MOVE AT-OLD-PAID-THRU-DT        TO  DC-BIN-DATE-1
  6249         MOVE ' '                        TO  DC-OPTION-CODE
  6250         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6251         IF NO-CONVERSION-ERROR
  6252             MOVE DC-GREG-DATE-1-EDIT    TO  INCUR-PD-THRU-DT
  6253         ELSE
  6254             MOVE SPACES                 TO  INCUR-PD-THRU-DT.
  6255
  6256     MOVE ' TOT AMT: '           TO  INCUR-TOT-PD-LIT.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 127
* EL1501.cbl
  6257     MOVE ' TOT DAYS PD: '       TO  INCUR-TOT-DAYS-LIT.
  6258     MOVE ' NO PMTS : '          TO  INCUR-NO-PMTS-LIT.
  6259     MOVE AT-OLD-TOTAL-PAID      TO  INCUR-TOT-PD.
  6260     MOVE AT-OLD-DAYS-PAID       TO  INCUR-TOT-DAYS-PD.
  6261     MOVE AT-OLD-NO-OF-PMTS      TO  INCUR-NO-PMTS.
  6262
  6263     MOVE INCUR-CHG-HDG1         TO  MAP-HDG        (DISPLAY-CNT).
  6264     MOVE INCUR-TEXT-1           TO  MAP-TEXT       (DISPLAY-CNT).
  6265     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  6266     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
  6267     ADD +1 TO DISPLAY-CNT.
  6268     MOVE INCUR-CHG-HDG2         TO  MAP-HDG        (DISPLAY-CNT).
  6269     MOVE INCUR-TEXT-2           TO  MAP-TEXT       (DISPLAY-CNT).
  6270     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
  6271                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  6272     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  6273     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  6274     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  6275
  6276     GO TO 2800-INCR-DISPLAY-CNT.
  6277
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 128
* EL1501.cbl
  6279 2710-FORM-CONTROL-TRAILER.
  6280     MOVE PI-LINE-NO             TO  FORM-LINE-NO.
  6281     MOVE 'FORM    '             TO  FORM-HDG1-LIT.
  6282
  6283     MOVE 'FORM: '               TO  FORM-TYPE-LIT.
  6284
  6285     IF INITIAL-FORM
  6286        MOVE 'INIT'              TO  FORM-TYPE
  6287     ELSE
  6288        MOVE 'PROG'              TO  FORM-TYPE.
  6289
  6290     IF AT-FORM-PRINTED-DT = LOW-VALUES
  6291         MOVE ' SEND ON: '                   TO  FORM-SEND-ON-LIT
  6292         IF AT-FORM-SEND-ON-DT = LOW-VALUES
  6293             MOVE SPACES                     TO  FORM-SEND-ON-DT
  6294         ELSE
  6295             MOVE AT-FORM-SEND-ON-DT         TO  DC-BIN-DATE-1
  6296             MOVE ' '                        TO  DC-OPTION-CODE
  6297             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6298             IF NO-CONVERSION-ERROR
  6299                 MOVE DC-GREG-DATE-1-EDIT    TO  FORM-SEND-ON-DT
  6300             ELSE
  6301                 MOVE SPACES                 TO  FORM-SEND-ON-DT
  6302     ELSE
  6303         MOVE ' SENT ON: '                   TO  FORM-SEND-ON-LIT
  6304         MOVE AT-FORM-PRINTED-DT             TO  DC-BIN-DATE-1
  6305         MOVE ' '                            TO  DC-OPTION-CODE
  6306         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6307         IF NO-CONVERSION-ERROR
  6308             MOVE DC-GREG-DATE-1-EDIT        TO  FORM-SEND-ON-DT
  6309         ELSE
  6310             MOVE SPACES                     TO  FORM-SEND-ON-DT.
  6311
  6312     IF AT-FORM-REPRINT-DT = LOW-VALUES
  6313         MOVE ' RESEND     : '               TO  FORM-RESEND-LIT
  6314         IF AT-FORM-RE-SEND-DT = LOW-VALUES
  6315             MOVE SPACES                     TO  FORM-RESEND-DT
  6316         ELSE
  6317             MOVE AT-FORM-RE-SEND-DT         TO  DC-BIN-DATE-1
  6318             MOVE ' '                        TO  DC-OPTION-CODE
  6319             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6320             IF NO-CONVERSION-ERROR
  6321                 MOVE DC-GREG-DATE-1-EDIT    TO  FORM-RESEND-DT
  6322             ELSE
  6323                 MOVE SPACES                 TO  FORM-RESEND-DT
  6324     ELSE
  6325         MOVE ' RESENT     : '               TO  FORM-RESEND-LIT
  6326         MOVE AT-FORM-REPRINT-DT             TO  DC-BIN-DATE-1
  6327         MOVE ' '                            TO  DC-OPTION-CODE
  6328         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6329         IF NO-CONVERSION-ERROR
  6330             MOVE DC-GREG-DATE-1-EDIT        TO  FORM-RESEND-DT
  6331         ELSE
  6332             MOVE SPACES                     TO  FORM-RESEND-DT.
  6333
  6334     MOVE ' FOL: '                       TO  FORM-FOLLOW-UP-LIT.
  6335
  6336     IF AT-FORM-FOLLOW-UP-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 129
* EL1501.cbl
  6337         MOVE SPACES                     TO  FORM-FOLLOW-UP-DT
  6338     ELSE
  6339         MOVE AT-FORM-FOLLOW-UP-DT       TO  DC-BIN-DATE-1
  6340         MOVE ' '                        TO  DC-OPTION-CODE
  6341         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6342         IF NO-CONVERSION-ERROR
  6343             MOVE DC-GREG-DATE-1-EDIT    TO  FORM-FOLLOW-UP-DT
  6344         ELSE
  6345             MOVE SPACES                 TO  FORM-FOLLOW-UP-DT.
  6346
  6347     MOVE 'REC '                      TO  FORM-HDG2-LIT.
  6348     MOVE 'INS : '                    TO  FORM-REC-INS-LIT.
  6349
  6350     IF AT-FORM-ANSWERED-DT = LOW-VALUES
  6351         MOVE SPACES                  TO  FORM-REC-INS-DT
  6352     ELSE
  6353         MOVE AT-FORM-ANSWERED-DT     TO  DC-BIN-DATE-1
  6354         MOVE ' '                     TO  DC-OPTION-CODE
  6355         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6356         IF NO-CONVERSION-ERROR
  6357             MOVE DC-GREG-DATE-1-EDIT TO  FORM-REC-INS-DT
  6358         ELSE
  6359             MOVE SPACES              TO  FORM-REC-INS-DT.
  6360
  6361     MOVE ' REC PHY: '                 TO  FORM-REC-PHY-LIT.
  6362
  6363     IF AT-PHY-FORM-ANSWERED-DT = LOW-VALUES
  6364         MOVE SPACES                   TO  FORM-REC-PHY-DT
  6365     ELSE
  6366         MOVE AT-PHY-FORM-ANSWERED-DT  TO  DC-BIN-DATE-1
  6367         MOVE ' '                      TO  DC-OPTION-CODE
  6368         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6369         IF NO-CONVERSION-ERROR
  6370             MOVE DC-GREG-DATE-1-EDIT  TO  FORM-REC-PHY-DT
  6371         ELSE
  6372             MOVE SPACES               TO  FORM-REC-PHY-DT.
  6373
  6374     MOVE ' REC EMP    : '             TO  FORM-REC-EMP-LIT.
  6375
  6376     IF AT-EMP-FORM-ANSWERED-DT = LOW-VALUES
  6377         MOVE SPACES                   TO  FORM-REC-EMP-DT
  6378     ELSE
  6379         MOVE AT-EMP-FORM-ANSWERED-DT  TO  DC-BIN-DATE-1
  6380         MOVE ' '                      TO  DC-OPTION-CODE
  6381         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6382         IF NO-CONVERSION-ERROR
  6383             MOVE DC-GREG-DATE-1-EDIT  TO  FORM-REC-EMP-DT
  6384         ELSE
  6385             MOVE SPACES               TO  FORM-REC-EMP-DT.
  6386
  6387     MOVE FORM-HDG1              TO  MAP-HDG        (DISPLAY-CNT).
  6388     MOVE FORM-TEXT-1            TO  MAP-TEXT       (DISPLAY-CNT).
  6389     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  6390     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
  6391     ADD +1 TO DISPLAY-CNT.
  6392     MOVE FORM-HDG2              TO  MAP-HDG        (DISPLAY-CNT).
  6393     MOVE FORM-TEXT-2            TO  MAP-TEXT       (DISPLAY-CNT).
  6394     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 130
* EL1501.cbl
  6395                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  6396     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  6397     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  6398     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  6399
  6400     GO TO 2800-INCR-DISPLAY-CNT.
  6401
  6402 2800-INCR-DISPLAY-CNT.
  6403
  6404     IF DIRECTION-SWITCH = 'F'
  6405         ADD +1 TO DISPLAY-CNT
  6406                   PI-LINE-NO
  6407                   SUB-1
  6408         IF DISPLAY-CNT > +16
  6409             GO TO 2999-EXIT
  6410         ELSE
  6411             NEXT SENTENCE
  6412     ELSE
  6413         SUBTRACT +3 FROM DISPLAY-CNT
  6414         SUBTRACT +1 FROM PI-LINE-NO
  6415         SUBTRACT +1 FROM SUB-1
  6416         IF DISPLAY-CNT < +1
  6417             GO TO 2999-EXIT.
  6418
  6419     IF DIRECTION-SWITCH = 'B'
  6420         GO TO 2060-BROWSE-BACKWARD
  6421     ELSE
  6422         GO TO 2020-BROWSE-FORWARD.
  6423
  6424 2950-NO-MORE-TRAILERS.
  6425     MOVE ER-0303                TO  EMI-ERROR.
  6426     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6427
  6428 2999-EXIT.
  6429     EXIT.
  6430
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 131
* EL1501.cbl
  6432 3000-RECEIVE-LETTERS.
  6433
  6434     MOVE LINENOI                TO  SUB-1.
  6435
  6436     IF PI-TRLR-TYPE (SUB-1) = '4'
  6437         NEXT SENTENCE
  6438     ELSE
  6439     IF PI-TRLR-TYPE (SUB-1) = '2'
  6440         MOVE ER-0667            TO  EMI-ERROR
  6441         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6442         MOVE -1                 TO  LINENOL
  6443         GO TO 8200-SEND-DATAONLY
  6444     ELSE
  6445     IF PI-TRLR-TYPE (SUB-1) = 'A'
  6446         MOVE ER-0665            TO  EMI-ERROR
  6447         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6448         MOVE -1                 TO  LINENOL
  6449         GO TO 8200-SEND-DATAONLY
  6450     ELSE
  6451         MOVE ER-0660            TO  EMI-ERROR
  6452         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6453         MOVE -1                 TO  LINENOL
  6454         GO TO 8200-SEND-DATAONLY.
  6455
  6456     IF RECVDTI = SPACES
  6457         MOVE LOW-VALUES                   TO  WS-RECEIVED-DATE
  6458     ELSE
  6459         MOVE RECVDTI                      TO  WS-DEEDIT-FIELD
  6460         PERFORM 9800-DEEDIT THRU 9800-EXIT
  6461         IF WS-DEEDIT-FIELD-V0 NUMERIC
  6462             MOVE '4'                      TO  DC-OPTION-CODE
  6463             MOVE WS-DEEDIT-FIELD-V0       TO  DC-GREG-DATE-1-MDY
  6464             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6465             IF NO-CONVERSION-ERROR
  6466                 MOVE DC-BIN-DATE-1        TO  WS-RECEIVED-DATE
  6467                 MOVE DC-GREG-DATE-1-EDIT  TO  RECVDTO
  6468                 MOVE AL-UANON             TO  RECVDTA
  6469             ELSE
  6470                 MOVE LOW-VALUES           TO  WS-RECEIVED-DATE.
  6471
  6472     MOVE PI-TRLR-SEQ-NO (SUB-1) TO  TRLR-SEQ-NO.
  6473     PERFORM 7000-READ-TRLR-UPDATE THRU 7000-EXIT.
  6474
  6475     MOVE WS-RECEIVED-DATE       TO  AT-LETTER-ANSWERED-DT.
  6476     MOVE PI-PROCESSOR-ID        TO  AT-CORR-LAST-UPDATED-BY.
  6477     MOVE SAVE-BIN-DATE          TO  AT-CORR-LAST-MAINT-DT.
  6478
  6479     PERFORM 7100-REWRITE-TRLR THRU 7100-EXIT.
  6480
  6481     PERFORM 7500-READ-CLAIM-MSTR-UPDATE THRU 7500-EXIT.
  6482
  6483*    IF PI-COMPANY-ID = 'DMD'
  6484*        MOVE 11                 TO CL-ACTIVITY-CODE
  6485*        MOVE SAVE-BIN-DATE      TO CL-ACTIVITY-MAINT-DT
  6486*        MOVE 'CORR'             TO CL-ACTIVITY-MAINT-TYPE
  6487*        MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID.
  6488
  6489     PERFORM 7600-REWRITE-CLAIM-MSTR THRU 7600-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 132
* EL1501.cbl
  6490
  6491     MOVE ER-0000                TO  EMI-ERROR.
  6492     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6493     MOVE -1                     TO  LINENOL.
  6494     MOVE AL-UANOF               TO  LINENOA  RECVDTA
  6495                                     RECVTYPA.
  6496     MOVE LOW-VALUES             TO  EL150BO.
  6497     MOVE 'F'                    TO  DIRECTION-SWITCH
  6498                                     PI-PREV-DIRECTION.
  6499     MOVE 'Y'                    TO  PI-FIRST-TIME-SW.
  6500     MOVE PI-TRLR-SEQ-NO (1)     TO  PI-PREV-SEQ-NO.
  6501     SUBTRACT +1 FROM PI-PREV-SEQ-NO.
  6502     GO TO 1000-SHOW-CLAIM-HISTORY.
  6503
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 133
* EL1501.cbl
  6505 4000-RECEIVE-FORMS.
  6506
  6507     MOVE LINENOI                TO  SUB-1.
  6508
  6509     IF PI-TRLR-TYPE (SUB-1) = 'A'
  6510         NEXT SENTENCE
  6511     ELSE
  6512     IF PI-TRLR-TYPE (SUB-1) = '4'
  6513         MOVE ER-0666            TO  EMI-ERROR
  6514         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6515         MOVE -1                 TO  LINENOL
  6516         GO TO 8200-SEND-DATAONLY
  6517     ELSE
  6518     IF PI-TRLR-TYPE (SUB-1) = '2'
  6519         MOVE ER-0667            TO  EMI-ERROR
  6520         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6521         MOVE -1                 TO  LINENOL
  6522         GO TO 8200-SEND-DATAONLY
  6523     ELSE
  6524         MOVE ER-0661            TO  EMI-ERROR
  6525         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6526         MOVE -1                 TO  LINENOL
  6527         GO TO 8200-SEND-DATAONLY.
  6528
  6529     IF RECVTYPI = 'I' OR 'P' OR 'E'
  6530         NEXT SENTENCE
  6531     ELSE
  6532         MOVE ER-0662            TO  EMI-ERROR
  6533         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6534         MOVE -1                 TO  RECVTYPL
  6535         GO TO 8200-SEND-DATAONLY.
  6536
  6537     IF RECVDTI = SPACES
  6538         MOVE LOW-VALUES                   TO  WS-RECEIVED-DATE
  6539     ELSE
  6540         MOVE RECVDTI                      TO  WS-DEEDIT-FIELD
  6541         PERFORM 9800-DEEDIT THRU 9800-EXIT
  6542         IF WS-DEEDIT-FIELD-V0 NUMERIC
  6543             MOVE '4'                      TO  DC-OPTION-CODE
  6544             MOVE WS-DEEDIT-FIELD-V0       TO  DC-GREG-DATE-1-MDY
  6545             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6546             IF NO-CONVERSION-ERROR
  6547                 MOVE DC-BIN-DATE-1        TO  WS-RECEIVED-DATE
  6548                 MOVE DC-GREG-DATE-1-EDIT  TO  RECVDTO
  6549                 MOVE AL-UANON             TO  RECVDTA
  6550             ELSE
  6551                 MOVE LOW-VALUES           TO  WS-RECEIVED-DATE.
  6552
  6553     MOVE PI-TRLR-SEQ-NO (SUB-1)     TO  TRLR-SEQ-NO.
  6554     PERFORM 7000-READ-TRLR-UPDATE THRU 7000-EXIT.
  6555
  6556     IF RECVTYPI = 'I'
  6557         MOVE WS-RECEIVED-DATE       TO  AT-FORM-ANSWERED-DT
  6558     ELSE
  6559     IF RECVTYPI = 'P'
  6560         MOVE WS-RECEIVED-DATE       TO  AT-PHY-FORM-ANSWERED-DT
  6561     ELSE
  6562         MOVE WS-RECEIVED-DATE       TO  AT-EMP-FORM-ANSWERED-DT.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 134
* EL1501.cbl
  6563
  6564     MOVE PI-PROCESSOR-ID            TO  AT-FORM-LAST-UPDATED-BY.
  6565     MOVE SAVE-BIN-DATE              TO  AT-FORM-LAST-MAINT-DT.
  6566
  6567     PERFORM 7100-REWRITE-TRLR THRU 7100-EXIT.
  6568
  6569     MOVE ER-0000                TO  EMI-ERROR.
  6570     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6571     MOVE -1                     TO  LINENOL.
  6572     MOVE AL-UANOF               TO  LINENOA  RECVDTA
  6573                                     RECVTYPA.
  6574     MOVE LOW-VALUES             TO  EL150BO.
  6575     MOVE 'F'                    TO  DIRECTION-SWITCH
  6576                                     PI-PREV-DIRECTION.
  6577     MOVE 'Y'                    TO  PI-FIRST-TIME-SW.
  6578     MOVE PI-TRLR-SEQ-NO (1)     TO  PI-PREV-SEQ-NO.
  6579     SUBTRACT +1 FROM PI-PREV-SEQ-NO.
  6580     GO TO 1000-SHOW-CLAIM-HISTORY.
  6581
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 135
* EL1501.cbl
  6583
  6584 5000-VOID-PAYMENT.
  6585
  6586     MOVE LINENOI                TO  SUB-1.
  6587
  6588     IF PI-TRLR-TYPE (SUB-1) = '2'
  6589         NEXT SENTENCE
  6590     ELSE
  6591     IF PI-TRLR-TYPE (SUB-1) = '4'
  6592         MOVE ER-0666            TO  EMI-ERROR
  6593         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6594         MOVE -1                 TO  LINENOL
  6595         GO TO 8200-SEND-DATAONLY
  6596     ELSE
  6597     IF PI-TRLR-TYPE (SUB-1) = 'A'
  6598         MOVE ER-0665            TO  EMI-ERROR
  6599         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6600         MOVE -1                 TO  LINENOL
  6601         GO TO 8200-SEND-DATAONLY
  6602     ELSE
  6603         MOVE ER-0664            TO  EMI-ERROR
  6604         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6605         MOVE -1                 TO  LINENOL
  6606         GO TO 8200-SEND-DATAONLY.
  6607
  6608     PERFORM 7500-READ-CLAIM-MSTR-UPDATE THRU 7500-EXIT.
  6609
  6610     MOVE PI-TRLR-SEQ-NO (SUB-1) TO  TRLR-SEQ-NO.
  6611     PERFORM 7000-READ-TRLR-UPDATE THRU 7000-EXIT.
  6612
  6613     IF AT-CHECK-WRITTEN-DT > SAVE-BIN-DATE
  6614         MOVE ER-2893            TO EMI-ERROR
  6615         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6616         MOVE -1                 TO LINENOL
  6617         PERFORM 7510-UNLOCK-CLAIM-MSTR THRU 7510-EXIT
  6618         PERFORM 7010-UNLOCK-TRLR       THRU 7010-EXIT
  6619         GO TO 8200-SEND-DATAONLY
  6620     END-IF.
  6621
  6622     IF AT-VOID-DT = LOW-VALUES OR SPACES
  6623         NEXT SENTENCE
  6624     ELSE
  6625         MOVE ER-0800            TO  EMI-ERROR
  6626         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6627         MOVE -1                 TO  LINENOL
  6628         PERFORM 7510-UNLOCK-CLAIM-MSTR THRU 7510-EXIT
  6629         PERFORM 7010-UNLOCK-TRLR       THRU 7010-EXIT
  6630         GO TO 8200-SEND-DATAONLY.
  6631
  6632*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6633*        IF AT-CASH-PAYMENT = 'N'
  6634*            IF AT-CHECK-WRITTEN-DT = SPACES OR LOW-VALUES
  6635*                MOVE ER-0833    TO  EMI-ERROR
  6636*                MOVE -1         TO  LINENOL
  6637*                PERFORM 9900-ERROR-FORMAT      THRU 9900-EXIT
  6638*                PERFORM 7510-UNLOCK-CLAIM-MSTR THRU 7510-EXIT
  6639*                PERFORM 7010-UNLOCK-TRLR       THRU 7010-EXIT
  6640*                GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 136
* EL1501.cbl
  6641*
  6642*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6643*      IF AT-CASH-PAYMENT = 'N'
  6644*        IF AT-RECORDED-DT = SAVE-BIN-DATE
  6645*          NEXT SENTENCE
  6646*        ELSE
  6647*          IF PI-PROCESSOR-USER-ALMIGHTY = 'Y'
  6648*            NEXT SENTENCE
  6649*          ELSE
  6650*            MOVE ER-0816        TO  EMI-ERROR
  6651*            MOVE -1             TO  LINENOL
  6652*            PERFORM 9900-ERROR-FORMAT      THRU 9900-EXIT
  6653*            PERFORM 7510-UNLOCK-CLAIM-MSTR THRU 7510-EXIT
  6654*            PERFORM 7010-UNLOCK-TRLR       THRU 7010-EXIT
  6655*            GO TO 8200-SEND-DATAONLY.
  6656*
  6657*    IF PI-COMPANY-ID = 'DMD'
  6658*        IF CLAIM-IS-CLOSED
  6659*            IF SETUP-ERRORS
  6660*                MOVE ER-0941    TO EMI-ERROR
  6661*                MOVE -1         TO LINENOL
  6662*                PERFORM 9900-ERROR-FORMAT      THRU 9900-EXIT
  6663*                PERFORM 7510-UNLOCK-CLAIM-MSTR THRU 7510-EXIT
  6664*                PERFORM 7010-UNLOCK-TRLR       THRU 7010-EXIT
  6665*                GO TO 8200-SEND-DATAONLY
  6666*            ELSE
  6667*                IF BENEFITS-CHANGED
  6668*                    IF SYSTEM-MODIFY-CAP
  6669*                        NEXT SENTENCE
  6670*                    ELSE
  6671*                        MOVE ER-0942    TO EMI-ERROR
  6672*                        MOVE -1         TO LINENOL
  6673*                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6674*                        PERFORM 7510-UNLOCK-CLAIM-MSTR
  6675*                                                  THRU 7510-EXIT
  6676*                        PERFORM 7010-UNLOCK-TRLR  THRU 7010-EXIT
  6677*                        GO TO 8200-SEND-DATAONLY.
  6678*
  6679*    IF PI-COMPANY-ID = 'DMD'
  6680*        IF AT-CASH-PAYMENT = 'N'
  6681*            IF SYSTEM-MODIFY-CAP
  6682*                NEXT SENTENCE
  6683*            ELSE
  6684*                IF AT-RECORDED-DT = SAVE-BIN-DATE
  6685*                    NEXT SENTENCE
  6686*                ELSE
  6687*                    MOVE ER-0920  TO EMI-ERROR
  6688*                    MOVE -1       TO LINENOL
  6689*                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6690*                    PERFORM 7510-UNLOCK-CLAIM-MSTR
  6691*                                             THRU 7510-EXIT
  6692*                    PERFORM 7010-UNLOCK-TRLR THRU 7010-EXIT
  6693*                    GO TO 8200-SEND-DATAONLY.
  6694*
  6695*    IF PI-COMPANY-ID = 'DMD'
  6696*       IF AT-PAYMENT-TYPE NOT = '4' AND '5' AND '6'
  6697*          MOVE 'O'              TO  CL-CLAIM-STATUS
  6698*       END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 137
* EL1501.cbl
  6699*       PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
  6700
  6701     if pi-company-id = 'DCC'
  6702        and at-payment-type = '1' or '2'
  6703        perform 5300-upd-cert-trlr thru 5300-exit
  6704     end-if
  6705     MOVE AT-CHECK-WRITTEN-DT    TO  WS-CHECK-WRITTEN-DT.
  6706     MOVE AT-PAYMENT-APPROVAL-SW TO  WS-PMT-APPROVAL-SW.
  6707     MOVE AT-AMOUNT-PAID         TO  WS-AMOUNT-PAID.
  6708     MOVE AT-PAYMENT-ORIGIN      TO  WS-PAYMENT-ORIGIN.
  6709     MOVE AT-CV-PMT-CODE         TO  WS-CV-PMT-CODE.
  6710
  6711     IF AT-PAYMENT-TYPE NOT = '5' AND '6' AND 'I'
  6712         SUBTRACT AT-AMOUNT-PAID    FROM CL-TOTAL-PAID-AMT
  6713         SUBTRACT AT-DAYS-IN-PERIOD FROM CL-NO-OF-DAYS-PAID
  6714         IF AT-PAYMENT-TYPE NOT = '4'
  6715             SUBTRACT +1 FROM CL-NO-OF-PMTS-MADE
  6716             IF (AT-PAID-THRU-DT NOT = CL-PAID-THRU-DT) OR
  6717                (AT-RECORDED-BY = 'ZZZZ')
  6718                 NEXT SENTENCE
  6719             ELSE
  6720                 MOVE AT-PREV-LAST-PMT-DT    TO  CL-LAST-PMT-DT
  6721                 MOVE AT-PREV-PAID-THRU-DT   TO  CL-PAID-THRU-DT
  6722                 MOVE AT-PREV-LAST-PMT-AMT   TO  CL-LAST-PMT-AMT.
  6723
  6724     IF AT-PAYMENT-TYPE = 'I'
  6725        IF CL-TOTAL-INT-PAID NUMERIC AND
  6726           CL-TOTAL-INT-PAID NOT LESS THAN AT-AMOUNT-PAID
  6727              SUBTRACT AT-AMOUNT-PAID FROM CL-TOTAL-INT-PAID
  6728        END-IF
  6729     END-IF.
  6730
  6731     IF CL-NO-OF-DAYS-PAID < ZERO
  6732         MOVE +0                 TO  CL-NO-OF-DAYS-PAID.
  6733
  6734     IF CL-NO-OF-PMTS-MADE < ZERO
  6735         MOVE +0                 TO  CL-NO-OF-PMTS-MADE.
  6736
  6737     MOVE SAVE-BIN-DATE          TO  AT-VOID-DT
  6738                                     CL-LAST-REOPEN-DT.
  6739
  6740     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  6741     MOVE '1'                    TO  CNTL-REC-TYPE.
  6742     MOVE SPACES                 TO  CNTL-ACCESS.
  6743     MOVE +0                     TO  CNTL-SEQ-NO.
  6744     MOVE 'CNTL'                 TO  FILE-SWITCH.
  6745
  6746     PERFORM 7900-READ-CONTROL-FILE THRU 7900-EXIT.
  6747
  6748     MOVE CF-PAYMENT-APPROVAL-SW TO  WS-CF-PMT-APPROVAL-SW.
  6749
  6750     IF CF-PMT-APPROVAL-USED
  6751         MOVE 'V'                TO  AT-PAYMENT-APPROVAL-SW.
  6752
  6753*    IF PI-COMPANY-ID = 'CID'
  6754         PERFORM 9870-OUTPUT-ACTIVITY-RECORD THRU
  6755                 9870-EXIT.
  6756         IF ERROR-ON-OUTPUT
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 138
* EL1501.cbl
  6757             MOVE -1             TO ENTERPFL
  6758             MOVE AL-UANON       TO ENTERPFA
  6759             PERFORM 9900-ERROR-FORMAT THRU
  6760                     9900-EXIT
  6761             GO TO 8200-SEND-DATAONLY
  6762         END-IF.
  6763*    END-IF.
  6764
  6765******************************************************************
  6766**  1.  BYPASS READING THE RECON RECORD FOR THE FOLLOWING       **
  6767**      REASONS:                                                **
  6768**      A.  NON-CASH PAYMENT                                    **
  6769**      B.  CHECK HAS NOT BEEN PRINTED                          **
  6770**      C.  USER IS NOT A RECON USER                            **
  6771**      D.  PAYMENT IS A MANUAL (OFFLINE) PAYMENT               **
  6772******************************************************************
  6773
  6774     IF AT-CASH-PAYMENT = 'N'
  6775         GO TO 5005-CONT-VOID.
  6776
  6777     IF AT-CHECK-NO  = SPACES OR LOW-VALUES
  6778         GO TO 5005-CONT-VOID.
  6779
  6780     IF CF-CLAIMS-CHECK-RECON-USER NOT = 'Y'
  6781         GO TO 5005-CONT-VOID.
  6782
  6783     IF OFFLINE-PMT
  6784         GO TO 5005-CONT-VOID.
  6785
  6786******************************************************************
  6787**  1.  RECON SW VALUES = :                                     **
  6788**      A.  R = CHECK HAS BEEN REDEEMED - CANNOT BE VOIDED      **
  6789**      B.  X = RECON RECORD NOT FOUND                          **
  6790******************************************************************
  6791
  6792     MOVE 'RCON'                     TO  FILE-SWITCH.
  6793     PERFORM 5700-UPDATE-RECON THRU 5700-EXIT.
  6794     IF WS-RECON-SW = 'R'
  6795          PERFORM 7510-UNLOCK-CLAIM-MSTR THRU 7510-EXIT
  6796          PERFORM 7010-UNLOCK-TRLR       THRU 7010-EXIT
  6797          GO TO 8200-SEND-DATAONLY.
  6798
  6799*    IF WS-RECON-SW = 'X'
  6800*        IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'CIG' OR 'CUK'
  6801*            PERFORM 7510-UNLOCK-CLAIM-MSTR THRU 7510-EXIT
  6802*            PERFORM 7010-UNLOCK-TRLR       THRU 7010-EXIT
  6803*            GO TO 8200-SEND-DATAONLY.
  6804
  6805 5005-CONT-VOID.
  6806     IF AT-RECORDED-BY = 'ZZZZ'
  6807         GO TO 5010-BYPASS.
  6808
  6809     MOVE '7'                    TO  PI-PAY-TYPE.
  6810     MOVE AT-PAYMENT-TYPE        TO  WS-PAY-TYPE.
  6811
  6812*    IF PI-COMPANY-ID = 'DMD'
  6813*        MOVE 88888888           TO WS-CK-Q-CONTROL
  6814*     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 139
* EL1501.cbl
  6815         MOVE 99999999           TO WS-CK-Q-CONTROL.
  6816
  6817     IF AT-CHECK-QUE-CONTROL > ZEROS AND < WS-CK-Q-CONTROL
  6818         PERFORM 5200-UPDATE-CHECK-QUE THRU 5299-EXIT
  6819     ELSE
  6820         IF AT-CHECK-WRITTEN-DT NOT = LOW-VALUES AND SPACES
  6821             MOVE 'Y'                TO  WS-PRINTED-SW
  6822                                         WS-RELEASED-SW
  6823         ELSE
  6824             MOVE 'N'                TO  WS-PRINTED-SW
  6825                                         WS-RELEASED-SW.
  6826
  6827 5010-BYPASS.
  6828
  6829     IF PAYMENT-HAS-BEEN-PRINTED OR
  6830        OFFLINE-PMT
  6831         MOVE CF-CURRENT-MONTH-END   TO  AT-VOID-SELECT-DT
  6832     ELSE
  6833         MOVE LOW-VALUES             TO  AT-PMT-SELECT-DT
  6834                                         AT-VOID-SELECT-DT.
  6835
  6836     MOVE WS-VOID-CODE           TO  AT-VOID-TYPE.
  6837
  6838     MOVE PI-PROCESSOR-ID        TO  AT-PAYMENT-LAST-UPDATED-BY.
  6839     MOVE SAVE-BIN-DATE          TO  AT-PAYMENT-LAST-MAINT-DT.
  6840
  6841     PERFORM 7100-REWRITE-TRLR THRU 7100-EXIT.
  6842     IF WS-PAY-TYPE NOT = 'I'
  6843        PERFORM 5400-UPDATE-ZERO-TRAILER
  6844                                 THRU 5400-EXIT
  6845     END-IF
  6846*    IF CL-SYSTEM-IDENTIFIER = 'CV'
  6847*        PERFORM 5500-UPDATE-POLICY-MASTER THRU 5500-EXIT
  6848*    ELSE
  6849         PERFORM 5600-UPDATE-CERT THRU 5600-EXIT.
  6850
  6851     MOVE CL-CONTROL-PRIMARY     TO  ELACTQ-KEY.
  6852
  6853     IF WS-PAY-TYPE = '4' OR '5' OR '6' OR 'I'
  6854         GO TO 5020-CONTINUE-VOID.
  6855
  6856*    IF CL-SYSTEM-IDENTIFIER = 'CV'
  6857*        IF CL-NO-OF-PMTS-MADE > +0
  6858*            GO TO 5020-CONTINUE-VOID.
  6859
  6860     MOVE 'O'                    TO  CL-CLAIM-STATUS.
  6861
  6862 5020-CONTINUE-VOID.
  6863
  6864     PERFORM 7600-REWRITE-CLAIM-MSTR THRU 7600-EXIT.
  6865
  6866     IF WS-PAYMENT-ORIGIN = '3'
  6867         GO TO 5100-CONTINUE.
  6868
  6869     IF PAYMENT-HAS-BEEN-PRINTED AND
  6870        NOT WS-CF-PMT-APPROVAL-USED
  6871         GO TO 5100-CONTINUE.
  6872
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 140
* EL1501.cbl
  6873     MOVE 'ACTQ'                 TO  FILE-SWITCH.
  6874     PERFORM 7700-READ-ELACTQ THRU 7799-EXIT.
  6875
  6876 5100-CONTINUE.
  6877
  6878     MOVE ER-0000                TO  EMI-ERROR.
  6879     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6880     MOVE -1                     TO  LINENOL.
  6881     MOVE AL-UANOF               TO  LINENOA  RECVDTA
  6882                                     RECVTYPA.
  6883     MOVE LOW-VALUES             TO  EL150BO.
  6884     MOVE 'F'                    TO  DIRECTION-SWITCH
  6885                                     PI-PREV-DIRECTION.
  6886     MOVE 'Y'                    TO  PI-FIRST-TIME-SW.
  6887     MOVE PI-TRLR-SEQ-NO (1)     TO  PI-PREV-SEQ-NO.
  6888     SUBTRACT +1 FROM PI-PREV-SEQ-NO.
  6889     GO TO 1000-SHOW-CLAIM-HISTORY.
  6890
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 141
* EL1501.cbl
  6892 5200-UPDATE-CHECK-QUE.
  6893
  6894     MOVE PI-COMPANY-CD          TO  CHKQ-COMP-CD.
  6895     MOVE AT-CHECK-QUE-CONTROL   TO  CHKQ-CONTROL.
  6896     MOVE AT-CHECK-QUE-SEQUENCE  TO  CHKQ-SEQ-NO.
  6897
  6898
  6899* EXEC CICS HANDLE CONDITION
  6900*        NOTFND   (5290-NOTFND)
  6901*    END-EXEC.
  6902*    MOVE '"$I                   ! '' #00006702' TO DFHEIV0
  6903     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6904     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6905     MOVE X'2720233030303036373032' TO DFHEIV0(25:11)
  6906     CALL 'kxdfhei1' USING DFHEIV0
  6907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6908
  6909
  6910
  6911* EXEC CICS READ
  6912*        DATASET   ('ELCHKQ')
  6913*        RIDFLD    (ELCHKQ-KEY)
  6914*        SET       (ADDRESS OF CHECK-QUE)
  6915*        UPDATE
  6916*    END-EXEC.
  6917     MOVE 'ELCHKQ' TO DFHEIV1
  6918*    MOVE '&"S        EU         (   #00006706' TO DFHEIV0
  6919     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6920     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6921     MOVE X'2020233030303036373036' TO DFHEIV0(25:11)
  6922     CALL 'kxdfhei1' USING DFHEIV0,
  6923           DFHEIV1,
  6924           DFHEIV20,
  6925           DFHEIV99,
  6926           ELCHKQ-KEY,
  6927           DFHEIV99,
  6928           DFHEIV99,
  6929           DFHEIV99
  6930     SET ADDRESS OF CHECK-QUE TO
  6931         DFHEIV20
  6932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6933
  6934
  6935     MOVE 'Y'                    TO  WS-RELEASED-SW
  6936
  6937     IF CQ-TIMES-PRINTED = +0
  6938         MOVE 'N'                TO  WS-PRINTED-SW
  6939         GO TO 5210-DELETE-CHECK-QUE
  6940     ELSE
  6941         MOVE 'Y'                TO  WS-PRINTED-SW.
  6942
  6943     MOVE WS-VOID-CODE           TO  CQ-VOID-INDICATOR.
  6944
  6945
  6946* EXEC CICS REWRITE
  6947*        DATASET   ('ELCHKQ')
  6948*        FROM      (CHECK-QUE)
  6949*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 142
* EL1501.cbl
  6950     MOVE LENGTH OF
  6951      CHECK-QUE
  6952       TO DFHEIV11
  6953     MOVE 'ELCHKQ' TO DFHEIV1
  6954*    MOVE '&& L                  %   #00006723' TO DFHEIV0
  6955     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6956     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6957     MOVE X'2020233030303036373233' TO DFHEIV0(25:11)
  6958     CALL 'kxdfhei1' USING DFHEIV0,
  6959           DFHEIV1,
  6960           CHECK-QUE,
  6961           DFHEIV11,
  6962           DFHEIV99
  6963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6964
  6965
  6966     GO TO 5299-EXIT.
  6967
  6968 5210-DELETE-CHECK-QUE.
  6969
  6970
  6971* EXEC CICS DELETE
  6972*        DATASET  ('ELCHKQ')
  6973*    END-EXEC.
  6974     MOVE 'ELCHKQ' TO DFHEIV1
  6975*    MOVE '&(                    &   #00006732' TO DFHEIV0
  6976     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  6977     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6978     MOVE X'2020233030303036373332' TO DFHEIV0(25:11)
  6979     CALL 'kxdfhei1' USING DFHEIV0,
  6980           DFHEIV1,
  6981           DFHEIV99,
  6982           DFHEIV99,
  6983           DFHEIV99,
  6984           DFHEIV99
  6985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6986
  6987
  6988     MOVE +0                     TO  AT-CHECK-QUE-CONTROL
  6989                                     AT-CHECK-QUE-SEQUENCE.
  6990
  6991     GO TO 5299-EXIT.
  6992
  6993 5290-NOTFND.
  6994     MOVE 'N'                    TO  WS-PRINTED-SW
  6995                                     WS-RELEASED-SW.
  6996 5299-EXIT.
  6997     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 143
* EL1501.cbl
  6999 5300-UPD-CERT-TRLR.
  7000
  7001*    if cl-insured-claim = 'S'
  7002*       move +2 to s1
  7003*    else
  7004*       MOVE +1 to s1
  7005*    end-if
  7006
  7007     move +1 to s1
  7008     evaluate cl-claim-type
  7009        when 'A'
  7010           move +1 to s2
  7011        when 'I'
  7012           move +2 to s2
  7013        when 'G'
  7014           move +3 to s2
  7015        when 'L'
  7016           move +4 to s2
  7017        when 'P'
  7018           move +5 to s2
  7019     end-evaluate
  7020
  7021     MOVE CL-COMPANY-CD          TO CTRLR-COMP-CD
  7022     MOVE CL-CERT-KEY-DATA       TO ELCRTT-KEY (2:21)
  7023     MOVE CL-CERT-NO             TO CTRLR-CERT-NO
  7024     MOVE 'B'                    TO CTRLR-REC-TYPE
  7025
  7026
  7027* EXEC CICS READ
  7028*       UPDATE
  7029*       DATASET   ('ELCRTT')
  7030*       RIDFLD    (ELCRTT-KEY)
  7031*       set       (address of CERTIFICATE-TRAILERS)
  7032*       RESP      (WS-RESPONSE)
  7033*    END-EXEC
  7034     MOVE 'ELCRTT' TO DFHEIV1
  7035*    MOVE '&"S        EU         (  N#00006774' TO DFHEIV0
  7036     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7037     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7038     MOVE X'204E233030303036373734' TO DFHEIV0(25:11)
  7039     CALL 'kxdfhei1' USING DFHEIV0,
  7040           DFHEIV1,
  7041           DFHEIV20,
  7042           DFHEIV99,
  7043           ELCRTT-KEY,
  7044           DFHEIV99,
  7045           DFHEIV99,
  7046           DFHEIV99
  7047     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  7048         DFHEIV20
  7049     MOVE EIBRESP  TO WS-RESPONSE
  7050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7051
  7052     IF RESP-NORMAL
  7053        subtract at-amount-paid from cs-total-paid (s1 s2)
  7054        if cs-total-paid (s1 s2) < zeros
  7055           move zeros            to cs-total-paid (s1 s2)
  7056        end-if
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 144
* EL1501.cbl
  7057
  7058        subtract at-days-in-period from cs-days-paid (s1 s2)
  7059        if cs-days-paid (s1 s2) < zeros
  7060           move zeros            to cs-days-paid (s1 s2)
  7061        end-if
  7062
  7063* exec cics rewrite
  7064*          dataset    ('ELCRTT')
  7065*          from       (certificate-trailers)
  7066*          resp       (ws-response)
  7067*       end-exec
  7068     MOVE LENGTH OF
  7069      certificate-trailers
  7070       TO DFHEIV11
  7071     MOVE 'ELCRTT' TO DFHEIV1
  7072*    MOVE '&& L                  %  N#00006792' TO DFHEIV0
  7073     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7074     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7075     MOVE X'204E233030303036373932' TO DFHEIV0(25:11)
  7076     CALL 'kxdfhei1' USING DFHEIV0,
  7077           DFHEIV1,
  7078           certificate-trailers,
  7079           DFHEIV11,
  7080           DFHEIV99
  7081     MOVE EIBRESP  TO ws-response
  7082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7083     end-if
  7084
  7085     .
  7086 5300-EXIT.
  7087     EXIT.
  7088*5300-CREATE-DMO. Remove as dead code
  7089*5300-CONT. Remove as dead code
  7090*5300-NOTE-NOT-FOUND. Remove as dead code
  7091*5300-EXIT. Remove as dead code
  7092*5350-FORMAT-LAST-NAME-1ST. Remove as dead code
  7093*5350-EXIT. Remove as dead code
  7094*5360-MOVE-NAME. Remove as dead code
  7095*5360-MOVE-NAME-CYCLE. Remove as dead code
  7096*5360-EXIT. Remove as dead code
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 145
* EL1501.cbl
  7098 5400-UPDATE-ZERO-TRAILER.
  7099
  7100     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
  7101
  7102     MOVE ZEROS                  TO  TRLR-SEQ-NO.
  7103     PERFORM 7000-READ-TRLR-UPDATE THRU 7000-EXIT.
  7104
  7105     IF WS-PAY-TYPE = '5'
  7106         SUBTRACT WS-AMOUNT-PAID FROM AT-ITD-CHARGEABLE-EXPENSE.
  7107
  7108     IF WS-PAY-TYPE = '6'
  7109         SUBTRACT WS-AMOUNT-PAID FROM AT-ITD-PAID-EXPENSES.
  7110
  7111     IF AT-INITIAL-MANUAL-RESERVE NOT = ZEROS
  7112         ADD WS-AMOUNT-PAID      TO  AT-CURRENT-MANUAL-RESERVE.
  7113
  7114 5410-CHECK-OPEN-CLOSE.
  7115
  7116     IF PI-PAY-TYPE = '5' OR '6'
  7117         PERFORM 7100-REWRITE-TRLR THRU 7100-EXIT.
  7118
  7119     IF PI-PAY-TYPE = '1' OR '4' OR '7'
  7120        IF CLAIM-IS-OPEN
  7121           PERFORM 7100-REWRITE-TRLR THRU 7100-EXIT
  7122           GO TO 5400-EXIT.
  7123
  7124     IF PI-PAY-TYPE = '2' OR '3'
  7125        IF CLAIM-IS-CLOSED
  7126            PERFORM 7100-REWRITE-TRLR THRU 7100-EXIT
  7127            GO TO 5400-EXIT.
  7128
  7129     MOVE 1                      TO  SUB.
  7130
  7131 5420-LOOP.
  7132
  7133     IF AT-OPEN-CLOSE-TYPE (SUB) = SPACES
  7134         MOVE SAVE-BIN-DATE      TO  AT-OPEN-CLOSE-DATE (SUB)
  7135         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB)
  7136         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB)
  7137         PERFORM 7100-REWRITE-TRLR THRU 7100-EXIT
  7138         GO TO 5400-EXIT.
  7139
  7140     IF SUB = 6
  7141      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
  7142      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
  7143      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
  7144      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
  7145      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
  7146      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
  7147      GO TO 5420-LOOP.
  7148
  7149     ADD 1                       TO  SUB.
  7150     GO TO 5420-LOOP.
  7151
  7152 5400-EXIT.
  7153     EXIT.
  7154
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 146
* EL1501.cbl
  7156*5500-UPDATE-POLICY-MASTER.
  7157*
  7158*    MOVE PI-COMPANY-CD          TO  PLCY-COMPANY-CD.
  7159*    MOVE CL-CERT-CARRIER        TO  PLCY-CARRIER.
  7160*    MOVE CL-CERT-GROUPING       TO  PLCY-GROUPING.
  7161*    MOVE CL-CERT-STATE          TO  PLCY-STATE.
  7162*    MOVE CL-CERT-ACCOUNT        TO  PLCY-PRODUCER.
  7163*    MOVE CL-CERT-EFF-DT         TO  PLCY-EFF-DT.
  7164*    MOVE CL-CV-REFERENCE-NO     TO  PLCY-REFERENCE-NO.
  7165*
  7166*    EXEC CICS READ
  7167*        DATASET   ('MPPLCY')
  7168*        RIDFLD    (EMPLCY-KEY)
  7169*        SET       (ADDRESS OF POLICY-MASTER)
  7170*    END-EXEC.
  7171*
  7172*    MOVE LOW-VALUES             TO WS-POLICY-UPDATE-WORKING-GRPS.
  7173*    MOVE +0                     TO  WS-CLAIM-PAYMENT-CNT.
  7174*
  7175*    MOVE PM-COMPANY-CD          TO  WS-COMPANY-CD.
  7176*    MOVE PM-CARRIER             TO  WS-CARRIER.
  7177*    MOVE PM-GROUPING            TO  WS-GROUPING.
  7178*    MOVE PM-STATE               TO  WS-STATE.
  7179*    MOVE PM-PRODUCER            TO  WS-PRODUCER.
  7180*    MOVE PM-POLICY-EFF-DT       TO  WS-POLICY-EFF-DT.
  7181*    MOVE PM-REFERENCE-NUMBER    TO  WS-REFERENCE-NUMBER.
  7182*
  7183*    MOVE 'RW'                   TO  WS-EMPLCY-FUNCTION.
  7184*    MOVE PI-PROCESSOR-ID        TO  WS-LAST-CHANGE-PROCESSOR.
  7185*    MOVE SAVE-BIN-DATE          TO  WS-LAST-CHANGE-DT.
  7186*    MOVE EIBTIME                TO  WS-LAST-CHANGE-TIME.
  7187*
  7188*    IF CL-CLAIM-TYPE = 'A'
  7189*        GO TO 5500-UPDATE-AH-POLICY-DATA.
  7190*
  7191*5500-UPDATE-LF-POLICY-DATA.
  7192*
  7193*    IF WS-PAY-TYPE = '2'
  7194*** FROM AT-PAYMENT-TYPE - TYPES 1-6 IN CONVENIENCE VALUES
  7195*      IF WS-CV-PMT-CODE = '1' OR '2' OR '3' OR '4'
  7196*** LIFE / HALF LIFE / ADD / HALF ADD - CONV VALUES
  7197*        COMPUTE WS-CLAIM-PAYMENTS-ITD = PM-CLAIM-PAYMENTS-ITD -
  7198*                                        WS-AMOUNT-PAID
  7199*        COMPUTE WS-CLAIM-LIFE-ITD = PM-CLAIM-LIFE-ITD -
  7200*                                    WS-AMOUNT-PAID
  7201*        COMPUTE WS-CLAIM-PAYMENT-CNT = PM-CLAIM-PAYMENT-CNT - 1.
  7202*
  7203*    IF WS-PAY-TYPE = '2'
  7204*      IF WS-CV-PMT-CODE = '5' OR '6'
  7205*** RIDER AND HALF RIDER - CONV VALUES
  7206*        COMPUTE WS-CLAIM-RIDER-ITD = PM-CLAIM-RIDER-ITD -
  7207*                                        WS-AMOUNT-PAID.
  7208*
  7209*    IF WS-PAY-TYPE = '4'
  7210*** ADDITIONAL PAYMENT - TYPE 8 CONV VALUES
  7211*        COMPUTE WS-CLAIM-PAYMENTS-ITD = PM-CLAIM-PAYMENTS-ITD -
  7212*                                        WS-AMOUNT-PAID
  7213*        COMPUTE WS-CLAIM-LIFE-ITD = PM-CLAIM-LIFE-ITD -
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 147
* EL1501.cbl
  7214*                                    WS-AMOUNT-PAID
  7215*        COMPUTE WS-CLAIM-PAYMENT-CNT = PM-CLAIM-PAYMENT-CNT - 1.
  7216*
  7217*    IF WS-PAY-TYPE = '6'
  7218*** NON CHARGEABLE EXPENSE - TYPE 7 IN CONVENIENCE
  7219*        COMPUTE WS-CLAIM-EXPENSES-ITD = PM-CLAIM-EXPENSES-ITD -
  7220*                                        WS-AMOUNT-PAID.
  7221*
  7222*    IF PM-CLAIM-SETTLEMENT
  7223*        IF WS-CV-PMT-CODE = '1' OR '2' OR '3' OR '4'
  7224*            MOVE '6'             TO WS-CURRENT-STATUS
  7225*            IF PM-EXIT-DT > LOW-VALUES
  7226*                MOVE HIGH-VALUES TO WS-EXIT-DT.
  7227*
  7228*    GO TO 5500-UPDATE-CLAIM-HISTORY.
  7229*
  7230*5500-UPDATE-AH-POLICY-DATA.
  7231*
  7232*    IF WS-PAY-TYPE = '1' OR '4'
  7233*        COMPUTE WS-CLAIM-PAYMENTS-ITD = PM-CLAIM-PAYMENTS-ITD -
  7234*                                        WS-AMOUNT-PAID
  7235*        COMPUTE WS-CLAIM-AH-ITD = PM-CLAIM-AH-ITD -
  7236*                                  WS-AMOUNT-PAID
  7237*        COMPUTE WS-CLAIM-PAYMENT-CNT = PM-CLAIM-PAYMENT-CNT - 1.
  7238*
  7239*    IF WS-PAY-TYPE = '6'
  7240*        COMPUTE WS-CLAIM-EXPENSES-ITD = PM-CLAIM-EXPENSES-ITD -
  7241*                                        WS-AMOUNT-PAID.
  7242*
  7243*    IF PM-CLAIM-SETTLEMENT
  7244*        IF WS-CV-PMT-CODE = '2'
  7245*            MOVE '6'             TO WS-CURRENT-STATUS
  7246*            IF PM-EXIT-DT > LOW-VALUES
  7247*                MOVE HIGH-VALUES TO WS-EXIT-DT
  7248*            END-IF
  7249*        ELSE
  7250*            IF WS-CV-PMT-CODE = '1'
  7251*                    AND
  7252*               WS-CLAIM-PAYMENTS-ITD < PM-INS-TOTAL-BENEFIT
  7253*                MOVE '6'             TO WS-CURRENT-STATUS
  7254*                IF PM-EXIT-DT > LOW-VALUES
  7255*                    MOVE HIGH-VALUES TO WS-EXIT-DT.
  7256*
  7257*5500-UPDATE-CLAIM-HISTORY.
  7258*
  7259*    IF PM-CLAIM-ATTACH-CNT = +1 OR
  7260*       PM-CLAIM-INCURRED-DT = CL-INCURRED-DT
  7261*        NEXT SENTENCE
  7262*    ELSE
  7263*        GO TO 5500-FINISH-POLICY-UPDATE.
  7264*
  7265*    IF (PM-CLAIM-ATTACH-CNT = +1  AND
  7266*        CL-NO-OF-PMTS-MADE = +0)
  7267*               OR
  7268*       (PM-CLAIM-PAYMENT-CNT = +0)
  7269*           MOVE +0              TO  WS-CLAIM-LAST-PAYMENT-AMT
  7270*           MOVE '1'             TO  WS-CLAIM-INTERFACE-SW
  7271*           MOVE HIGH-VALUES     TO  WS-CLAIM-INCURRED-DT
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 148
* EL1501.cbl
  7272*                                    WS-CLAIM-PAID-TO-DT
  7273*       ELSE
  7274*           MOVE CL-PAID-THRU-DT TO  WS-CLAIM-PAID-TO-DT
  7275*           MOVE CL-LAST-PMT-AMT TO  WS-CLAIM-LAST-PAYMENT-AMT.
  7276*
  7277*5500-FINISH-POLICY-UPDATE.
  7278*
  7279*    IF WS-CLAIM-PAYMENT-CNT NEGATIVE
  7280*        MOVE +0                 TO  WS-CLAIM-PAYMENT-CNT.
  7281*
  7282*    EXEC CICS LINK
  7283*        PROGRAM     ('EMPLCY')
  7284*        COMMAREA    (WS-POLICY-MASTER-UPDATE-AREA)
  7285*        LENGTH      (WS-PM-COMM-LNGTH)
  7286*    END-EXEC.
  7287*
  7288*    IF WS-EMPLCY-RETURN-CODE = LOW-VALUES
  7289*        NEXT SENTENCE
  7290*    ELSE
  7291*        MOVE ER-9211            TO  EMI-ERROR
  7292*        MOVE -1                 TO  LINENOL
  7293*        MOVE AL-UABON           TO  LINENOA
  7294*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7295*        EXEC CICS SYNCPOINT
  7296*            ROLLBACK
  7297*        END-EXEC
  7298*        GO TO 8200-SEND-DATAONLY.
  7299*
  7300*5500-EXIT.
  7301*    EXIT.
  7302
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 149
* EL1501.cbl
  7304 5600-UPDATE-CERT.
  7305
  7306     MOVE PI-COMPANY-CD          TO  CERT-COMP-CD.
  7307     MOVE CL-CERT-CARRIER        TO  CERT-CARRIER.
  7308     MOVE CL-CERT-GROUPING       TO  CERT-GROUPING.
  7309     MOVE CL-CERT-STATE          TO  CERT-STATE.
  7310     MOVE CL-CERT-ACCOUNT        TO  CERT-ACCOUNT.
  7311     MOVE CL-CERT-EFF-DT         TO  CERT-EFF-DT.
  7312     MOVE CL-CERT-NO             TO  CERT-CERT-NO.
  7313     MOVE 'CERT'                 TO  FILE-SWITCH.
  7314
  7315     PERFORM 7800-READ-CERT-UPDATE.
  7316
  7317     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
  7318         GO TO 5610-AH-VOID.
  7319
  7320     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  7321     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  7322     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7323     MOVE '4'                    TO  CNTL-REC-TYPE.
  7324     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  7325     MOVE 'BENE'                 TO  FILE-SWITCH.
  7326     MOVE +0                     TO  SUB.
  7327     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  7328
  7329     IF NO-BENEFIT-FOUND
  7330         GO TO 8400-NOT-FOUND.
  7331
  7332     MOVE CF-LF-COVERAGE-TYPE (SUB)  TO  WS-LF-COVERAGE-TYPE.
  7333
  7334     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  7335        WS-LF-COVERAGE-TYPE = 'P'
  7336         IF WS-PAY-TYPE = '4'
  7337             SUBTRACT WS-AMOUNT-PAID FROM CM-LF-ITD-DEATH-AMT
  7338             IF CM-LF-CURRENT-STATUS = '1' OR '2'
  7339                 PERFORM 7810-REWRITE-CERT THRU 7810-EXIT
  7340                 GO TO 5600-EXIT
  7341             ELSE
  7342                 MOVE CM-LF-STATUS-AT-DEATH  TO
  7343                                             CM-LF-CURRENT-STATUS
  7344                 MOVE SPACES                 TO
  7345                                             CM-LF-STATUS-AT-DEATH
  7346                 MOVE LOW-VALUES             TO
  7347                                             CM-LF-DEATH-EXIT-DT
  7348                                             CM-LF-DEATH-DT
  7349                 PERFORM 7810-REWRITE-CERT THRU 7810-EXIT
  7350                 GO TO 5600-EXIT.
  7351
  7352     IF WS-PAY-TYPE = '4'
  7353         SUBTRACT WS-AMOUNT-PAID FROM CM-LF-ITD-DEATH-AMT
  7354         PERFORM 7810-REWRITE-CERT THRU 7810-EXIT
  7355         GO TO 5600-EXIT.
  7356
  7357     IF WS-PAY-TYPE = '2'
  7358         IF CM-LF-CURRENT-STATUS = '1' OR '2'
  7359             SUBTRACT WS-AMOUNT-PAID FROM CM-LF-ITD-DEATH-AMT
  7360             PERFORM 7810-REWRITE-CERT THRU 7810-EXIT
  7361             GO TO 5600-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 150
* EL1501.cbl
  7362         ELSE
  7363             MOVE CM-LF-STATUS-AT-DEATH TO  CM-LF-CURRENT-STATUS
  7364             MOVE SPACES                TO  CM-LF-STATUS-AT-DEATH
  7365             SUBTRACT WS-AMOUNT-PAID FROM CM-LF-ITD-DEATH-AMT
  7366             MOVE LOW-VALUES            TO  CM-LF-DEATH-EXIT-DT
  7367                                            CM-LF-DEATH-DT
  7368             PERFORM 7810-REWRITE-CERT THRU 7810-EXIT
  7369             GO TO 5600-EXIT
  7370     ELSE
  7371         GO TO 5620-UNLOCK-CERT.
  7372
  7373 5610-AH-VOID.
  7374
  7375     IF WS-PAY-TYPE = '4'
  7376         SUBTRACT WS-AMOUNT-PAID FROM CM-AH-ITD-LUMP-PMT
  7377         PERFORM 7810-REWRITE-CERT THRU 7810-EXIT
  7378         GO TO 5600-EXIT.
  7379
  7380     IF WS-PAY-TYPE = '3'
  7381         MOVE CM-AH-STATUS-AT-SETTLEMENT
  7382                                 TO  CM-AH-CURRENT-STATUS
  7383         MOVE SPACES             TO  CM-AH-STATUS-AT-SETTLEMENT
  7384         SUBTRACT WS-AMOUNT-PAID FROM CM-AH-ITD-LUMP-PMT
  7385         MOVE LOW-VALUES         TO  CM-AH-SETTLEMENT-EXIT-DT
  7386                                     CM-AH-SETTLEMENT-DT
  7387         PERFORM 7810-REWRITE-CERT THRU 7810-EXIT
  7388         GO TO 5600-EXIT
  7389     ELSE
  7390         GO TO 5620-UNLOCK-CERT.
  7391
  7392 5620-UNLOCK-CERT.
  7393
  7394
  7395* EXEC CICS UNLOCK
  7396*        DATASET   ('ELCERT')
  7397*    END-EXEC.
  7398     MOVE 'ELCERT' TO DFHEIV1
  7399*    MOVE '&*                    #   #00007108' TO DFHEIV0
  7400     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7401     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7402     MOVE X'2020233030303037313038' TO DFHEIV0(25:11)
  7403     CALL 'kxdfhei1' USING DFHEIV0,
  7404           DFHEIV1,
  7405           DFHEIV99
  7406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7407
  7408
  7409 5600-EXIT.
  7410     EXIT.
  7411
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 151
* EL1501.cbl
  7413 5700-UPDATE-RECON.
  7414
  7415
  7416* EXEC CICS HANDLE CONDITION
  7417*        NOTFND   (5700-NOT-FOUND)
  7418*        NOTOPEN  (8500-FILE-NOTOPEN)
  7419*    END-EXEC.
  7420*    MOVE '"$IJ                  ! ( #00007118' TO DFHEIV0
  7421     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  7422     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7423     MOVE X'2820233030303037313138' TO DFHEIV0(25:11)
  7424     CALL 'kxdfhei1' USING DFHEIV0
  7425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7426
  7427
  7428     MOVE PI-COMPANY-CD              TO  RCON-COMPANY-CD.
  7429     MOVE AT-CHECK-NO                TO  RCON-CHECK-NO.
  7430     MOVE 'C'                        TO  RCON-CHECK-ORIGIN.
  7431     MOVE SPACES                     TO  RCON-GL-ACCOUNT-NO.
  7432
  7433
  7434* EXEC CICS READ
  7435*        DATASET   ('ELRCON')
  7436*        RIDFLD    (ELRCON-KEY)
  7437*        SET       (ADDRESS OF CHECK-RECONCILIATION)
  7438*        UPDATE
  7439*    END-EXEC.
  7440     MOVE 'ELRCON' TO DFHEIV1
  7441*    MOVE '&"S        EU         (   #00007128' TO DFHEIV0
  7442     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7443     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7444     MOVE X'2020233030303037313238' TO DFHEIV0(25:11)
  7445     CALL 'kxdfhei1' USING DFHEIV0,
  7446           DFHEIV1,
  7447           DFHEIV20,
  7448           DFHEIV99,
  7449           ELRCON-KEY,
  7450           DFHEIV99,
  7451           DFHEIV99,
  7452           DFHEIV99
  7453     SET ADDRESS OF CHECK-RECONCILIATION TO
  7454         DFHEIV20
  7455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7456
  7457
  7458******************************************************************
  7459*           IF THE CHECK HAS BEEN REDEEMED - DO NOT VOID         *
  7460******************************************************************
  7461
  7462     IF RC-STATUS = 'R'
  7463         MOVE 'R'                    TO  WS-RECON-SW
  7464         MOVE ER-0823                TO  EMI-ERROR
  7465         MOVE -1                     TO  LINENOL
  7466         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7467
  7468* EXEC CICS UNLOCK
  7469*            DATASET   ('ELRCON')
  7470*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 152
* EL1501.cbl
  7471     MOVE 'ELRCON' TO DFHEIV1
  7472*    MOVE '&*                    #   #00007144' TO DFHEIV0
  7473     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7474     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7475     MOVE X'2020233030303037313434' TO DFHEIV0(25:11)
  7476     CALL 'kxdfhei1' USING DFHEIV0,
  7477           DFHEIV1,
  7478           DFHEIV99
  7479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7480         GO TO 5700-EXIT
  7481     ELSE
  7482         MOVE ' '                    TO  WS-RECON-SW.
  7483
  7484     MOVE WS-VOID-CODE               TO  RC-STATUS.
  7485
  7486     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7487     MOVE '5'                        TO  DC-OPTION-CODE.
  7488     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7489     MOVE DC-GREG-DATE-1-MDY         TO  WS-WORK-DATE.
  7490     IF WS-WORK-YY > 50
  7491         MOVE '19'                   TO  WS-RCON-YY-1
  7492         MOVE WS-WORK-YY             TO  WS-RCON-YY-2
  7493         MOVE WS-WORK-MM             TO  WS-RCON-MM
  7494         MOVE WS-WORK-DD             TO  WS-RCON-DD
  7495     ELSE
  7496         MOVE '20'                   TO  WS-RCON-YY-1
  7497         MOVE WS-WORK-YY             TO  WS-RCON-YY-2
  7498         MOVE WS-WORK-MM             TO  WS-RCON-MM
  7499         MOVE WS-WORK-DD             TO  WS-RCON-DD.
  7500
  7501     MOVE WS-RCON-DATE               TO  RC-STATUS-DATE.
  7502
  7503     MOVE PI-PROCESSOR-ID            TO  RC-LAST-MAINT-BY.
  7504     MOVE SAVE-BIN-DATE              TO  RC-LAST-MAINT-DT.
  7505     MOVE EIBTIME                    TO  RC-LAST-MAINT-HHMMSS.
  7506
  7507
  7508* EXEC CICS REWRITE
  7509*        DATASET   ('ELRCON')
  7510*        FROM      (CHECK-RECONCILIATION)
  7511*    END-EXEC.
  7512     MOVE LENGTH OF
  7513      CHECK-RECONCILIATION
  7514       TO DFHEIV11
  7515     MOVE 'ELRCON' TO DFHEIV1
  7516*    MOVE '&& L                  %   #00007174' TO DFHEIV0
  7517     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7518     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7519     MOVE X'2020233030303037313734' TO DFHEIV0(25:11)
  7520     CALL 'kxdfhei1' USING DFHEIV0,
  7521           DFHEIV1,
  7522           CHECK-RECONCILIATION,
  7523           DFHEIV11,
  7524           DFHEIV99
  7525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7526
  7527
  7528     GO TO 5700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 153
* EL1501.cbl
  7529
  7530 5700-NOT-FOUND.
  7531
  7532     MOVE 'X'                        TO  WS-RECON-SW.
  7533     MOVE -1                         TO  LINENOL.
  7534     MOVE ER-0801                    TO  EMI-ERROR.
  7535     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7536
  7537 5700-EXIT.
  7538     EXIT.
  7539
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 154
* EL1501.cbl
  7541 7000-READ-TRLR-UPDATE.
  7542
  7543     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
  7544     MOVE PI-CARRIER             TO  TRLR-CARRIER.
  7545     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
  7546     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
  7547
  7548
  7549* EXEC CICS READ
  7550*        DATASET   ('ELTRLR')
  7551*        RIDFLD    (ELTRLR-KEY)
  7552*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
  7553*        UPDATE
  7554*    END-EXEC.
  7555     MOVE 'ELTRLR' TO DFHEIV1
  7556*    MOVE '&"S        EU         (   #00007199' TO DFHEIV0
  7557     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7558     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7559     MOVE X'2020233030303037313939' TO DFHEIV0(25:11)
  7560     CALL 'kxdfhei1' USING DFHEIV0,
  7561           DFHEIV1,
  7562           DFHEIV20,
  7563           DFHEIV99,
  7564           ELTRLR-KEY,
  7565           DFHEIV99,
  7566           DFHEIV99,
  7567           DFHEIV99
  7568     SET ADDRESS OF ACTIVITY-TRAILERS TO
  7569         DFHEIV20
  7570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7571
  7572
  7573 7000-EXIT.
  7574     EXIT.
  7575
  7576 7010-UNLOCK-TRLR.
  7577
  7578
  7579* EXEC CICS UNLOCK
  7580*        DATASET   ('ELTRLR')
  7581*    END-EXEC.
  7582     MOVE 'ELTRLR' TO DFHEIV1
  7583*    MOVE '&*                    #   #00007211' TO DFHEIV0
  7584     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7585     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7586     MOVE X'2020233030303037323131' TO DFHEIV0(25:11)
  7587     CALL 'kxdfhei1' USING DFHEIV0,
  7588           DFHEIV1,
  7589           DFHEIV99
  7590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7591
  7592
  7593 7010-EXIT.
  7594     EXIT.
  7595
  7596 7100-REWRITE-TRLR.
  7597
  7598     MOVE PI-PROCESSOR-ID        TO  PI-UPDATE-BY.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 155
* EL1501.cbl
  7599     MOVE EIBTIME                TO  AT-LAST-MAINT-HHMMSS
  7600                                     PI-UPDATE-HHMMSS.
  7601
  7602
  7603* EXEC CICS REWRITE
  7604*        DATASET   ('ELTRLR')
  7605*        FROM      (ACTIVITY-TRAILERS)
  7606*    END-EXEC.
  7607     MOVE LENGTH OF
  7608      ACTIVITY-TRAILERS
  7609       TO DFHEIV11
  7610     MOVE 'ELTRLR' TO DFHEIV1
  7611*    MOVE '&& L                  %   #00007224' TO DFHEIV0
  7612     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7613     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7614     MOVE X'2020233030303037323234' TO DFHEIV0(25:11)
  7615     CALL 'kxdfhei1' USING DFHEIV0,
  7616           DFHEIV1,
  7617           ACTIVITY-TRAILERS,
  7618           DFHEIV11,
  7619           DFHEIV99
  7620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7621
  7622
  7623 7100-EXIT.
  7624     EXIT.
  7625
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 156
* EL1501.cbl
  7627 7200-FIND-BENEFIT.
  7628
  7629     MOVE 'N'                    TO  WS-BEN-SEARCH-SW.
  7630
  7631
  7632* EXEC CICS HANDLE CONDITION
  7633*        ENDFILE   (7200-EXIT)
  7634*        NOTFND    (7200-EXIT)
  7635*    END-EXEC.
  7636*    MOVE '"$''I                  ! ) #00007237' TO DFHEIV0
  7637     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  7638     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7639     MOVE X'2920233030303037323337' TO DFHEIV0(25:11)
  7640     CALL 'kxdfhei1' USING DFHEIV0
  7641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7642
  7643
  7644
  7645* EXEC CICS READ
  7646*        DATASET   ('ELCNTL')
  7647*        RIDFLD    (ELCNTL-KEY)
  7648*        SET       (ADDRESS OF CONTROL-FILE)
  7649*        GTEQ
  7650*    END-EXEC.
  7651     MOVE 'ELCNTL' TO DFHEIV1
  7652*    MOVE '&"S        G          (   #00007242' TO DFHEIV0
  7653     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7654     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7655     MOVE X'2020233030303037323432' TO DFHEIV0(25:11)
  7656     CALL 'kxdfhei1' USING DFHEIV0,
  7657           DFHEIV1,
  7658           DFHEIV20,
  7659           DFHEIV99,
  7660           ELCNTL-KEY,
  7661           DFHEIV99,
  7662           DFHEIV99,
  7663           DFHEIV99
  7664     SET ADDRESS OF CONTROL-FILE TO
  7665         DFHEIV20
  7666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7667
  7668
  7669     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID OR
  7670        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
  7671         GO TO 7200-EXIT.
  7672
  7673     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
  7674         VARYING SUB FROM 1 BY 1 UNTIL
  7675         ((SUB > 8) OR
  7676         (CF-BENEFIT-CODE (SUB) = WS-BEN-CD)).
  7677
  7678     IF SUB NOT = 9
  7679         MOVE 'Y'             TO  WS-BEN-SEARCH-SW.
  7680
  7681     GO TO 7200-EXIT.
  7682
  7683 7200-BENEFIT-DUMMY.
  7684
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 157
* EL1501.cbl
  7685 7200-DUMMY-EXIT.
  7686     EXIT.
  7687
  7688 7200-EXIT.
  7689     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 158
* EL1501.cbl
  7691 7500-READ-CLAIM-MSTR-UPDATE.
  7692
  7693     MOVE PI-COMPANY-CD          TO  MSTR-COMP-CD.
  7694     MOVE PI-CARRIER             TO  MSTR-CARRIER.
  7695     MOVE PI-CLAIM-NO            TO  MSTR-CLAIM-NO.
  7696     MOVE PI-CERT-NO             TO  MSTR-CERT-NO.
  7697
  7698
  7699* EXEC CICS READ
  7700*        DATASET   ('ELMSTR')
  7701*        RIDFLD    (ELMSTR-KEY)
  7702*        SET       (ADDRESS OF CLAIM-MASTER)
  7703*        UPDATE
  7704*    END-EXEC.
  7705     MOVE 'ELMSTR' TO DFHEIV1
  7706*    MOVE '&"S        EU         (   #00007278' TO DFHEIV0
  7707     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7708     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7709     MOVE X'2020233030303037323738' TO DFHEIV0(25:11)
  7710     CALL 'kxdfhei1' USING DFHEIV0,
  7711           DFHEIV1,
  7712           DFHEIV20,
  7713           DFHEIV99,
  7714           ELMSTR-KEY,
  7715           DFHEIV99,
  7716           DFHEIV99,
  7717           DFHEIV99
  7718     SET ADDRESS OF CLAIM-MASTER TO
  7719         DFHEIV20
  7720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7721
  7722
  7723 7500-EXIT.
  7724     EXIT.
  7725
  7726 7510-UNLOCK-CLAIM-MSTR.
  7727
  7728
  7729* EXEC CICS UNLOCK
  7730*        DATASET   ('ELMSTR')
  7731*    END-EXEC.
  7732     MOVE 'ELMSTR' TO DFHEIV1
  7733*    MOVE '&*                    #   #00007290' TO DFHEIV0
  7734     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7735     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7736     MOVE X'2020233030303037323930' TO DFHEIV0(25:11)
  7737     CALL 'kxdfhei1' USING DFHEIV0,
  7738           DFHEIV1,
  7739           DFHEIV99
  7740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7741
  7742
  7743 7510-EXIT.
  7744     EXIT.
  7745
  7746 7520-READ-CLAIM-MSTR.
  7747
  7748     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 159
* EL1501.cbl
  7749     MOVE PI-CARRIER             TO MSTR-CARRIER
  7750     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO
  7751     MOVE PI-CERT-NO             TO MSTR-CERT-NO
  7752
  7753
  7754* EXEC CICS READ
  7755*        DATASET   ('ELMSTR')
  7756*        RIDFLD    (ELMSTR-KEY)
  7757*        SET       (ADDRESS OF CLAIM-MASTER)
  7758*        RESP      (WS-RESPONSE)
  7759*    END-EXEC
  7760     MOVE 'ELMSTR' TO DFHEIV1
  7761*    MOVE '&"S        E          (  N#00007304' TO DFHEIV0
  7762     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7763     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7764     MOVE X'204E233030303037333034' TO DFHEIV0(25:11)
  7765     CALL 'kxdfhei1' USING DFHEIV0,
  7766           DFHEIV1,
  7767           DFHEIV20,
  7768           DFHEIV99,
  7769           ELMSTR-KEY,
  7770           DFHEIV99,
  7771           DFHEIV99,
  7772           DFHEIV99
  7773     SET ADDRESS OF CLAIM-MASTER TO
  7774         DFHEIV20
  7775     MOVE EIBRESP  TO WS-RESPONSE
  7776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7777
  7778     .
  7779 7520-EXIT.
  7780     EXIT.
  7781 7600-REWRITE-CLAIM-MSTR.
  7782
  7783     MOVE SAVE-BIN-DATE          TO  CL-LAST-MAINT-DT.
  7784     MOVE EIBTIME                TO  CL-LAST-MAINT-HHMMSS.
  7785     MOVE PI-PROCESSOR-ID        TO  CL-LAST-MAINT-USER.
  7786     MOVE '3'                    TO  CL-LAST-MAINT-TYPE.
  7787
  7788
  7789* EXEC CICS REWRITE
  7790*        DATASET   ('ELMSTR')
  7791*        FROM      (CLAIM-MASTER)
  7792*    END-EXEC.
  7793     MOVE LENGTH OF
  7794      CLAIM-MASTER
  7795       TO DFHEIV11
  7796     MOVE 'ELMSTR' TO DFHEIV1
  7797*    MOVE '&& L                  %   #00007321' TO DFHEIV0
  7798     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7799     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7800     MOVE X'2020233030303037333231' TO DFHEIV0(25:11)
  7801     CALL 'kxdfhei1' USING DFHEIV0,
  7802           DFHEIV1,
  7803           CLAIM-MASTER,
  7804           DFHEIV11,
  7805           DFHEIV99
  7806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 160
* EL1501.cbl
  7807
  7808
  7809 7600-EXIT.
  7810     EXIT.
  7811
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 161
* EL1501.cbl
  7813 7700-READ-ELACTQ.
  7814
  7815
  7816* EXEC CICS HANDLE CONDITION
  7817*        NOTFND   (7799-EXIT)
  7818*    END-EXEC.
  7819*    MOVE '"$I                   ! * #00007332' TO DFHEIV0
  7820     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7821     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7822     MOVE X'2A20233030303037333332' TO DFHEIV0(25:11)
  7823     CALL 'kxdfhei1' USING DFHEIV0
  7824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7825
  7826
  7827
  7828* EXEC CICS READ
  7829*        DATASET   ('ELACTQ')
  7830*        RIDFLD    (ELACTQ-KEY)
  7831*        SET       (ADDRESS OF ACTIVITY-QUE)
  7832*        UPDATE
  7833*    END-EXEC.
  7834     MOVE 'ELACTQ' TO DFHEIV1
  7835*    MOVE '&"S        EU         (   #00007336' TO DFHEIV0
  7836     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7837     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7838     MOVE X'2020233030303037333336' TO DFHEIV0(25:11)
  7839     CALL 'kxdfhei1' USING DFHEIV0,
  7840           DFHEIV1,
  7841           DFHEIV20,
  7842           DFHEIV99,
  7843           ELACTQ-KEY,
  7844           DFHEIV99,
  7845           DFHEIV99,
  7846           DFHEIV99
  7847     SET ADDRESS OF ACTIVITY-QUE TO
  7848         DFHEIV20
  7849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7850
  7851
  7852     IF AQ-PMT-UNAPPROVED-COUNT NOT NUMERIC
  7853         MOVE ZEROS              TO  AQ-PMT-UNAPPROVED-COUNT.
  7854
  7855     IF AQ-PAYMENT-COUNTER NOT NUMERIC
  7856         MOVE +0                 TO  AQ-PAYMENT-COUNTER.
  7857
  7858     IF WS-CF-PMT-APPROVAL-USED
  7859         IF AQ-PMT-UNAPPROVED-COUNT > +0 AND
  7860            WS-CHECK-WRITTEN-DT = LOW-VALUES AND
  7861            WS-PMT-APPROVAL-SW = 'U'
  7862             SUBTRACT +1 FROM AQ-PMT-UNAPPROVED-COUNT
  7863             MOVE 'Y'            TO  WS-UPDATE-SW.
  7864
  7865     IF PAYMENT-NOT-PRINTED OR
  7866        PAYMENT-NOT-RELEASED
  7867         IF AQ-PAYMENT-COUNTER > +0
  7868             SUBTRACT +1 FROM AQ-PAYMENT-COUNTER
  7869             MOVE 'Y'            TO  WS-UPDATE-SW.
  7870
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 162
* EL1501.cbl
  7871     IF AQ-PAYMENT-COUNTER = +0
  7872         MOVE ' '                TO  AQ-PENDING-PAYMENT-FLAG.
  7873
  7874     IF WS-UPDATE-SW = 'Y'
  7875         IF AQ-PENDING-ACTIVITY-FLAGS = SPACES
  7876             MOVE 'N'            TO  WS-UPDATE-SW
  7877             GO TO 7720-DELETE-ACTIVITY-QUE
  7878         ELSE
  7879             MOVE 'N'            TO  WS-UPDATE-SW
  7880     ELSE
  7881         GO TO 7750-UNLOCK-ACTIVITY-QUE.
  7882
  7883 7710-REWRITE-ACTIVITY-QUE.
  7884
  7885
  7886* EXEC CICS REWRITE
  7887*        DATASET   ('ELACTQ')
  7888*        FROM      (ACTIVITY-QUE)
  7889*    END-EXEC.
  7890     MOVE LENGTH OF
  7891      ACTIVITY-QUE
  7892       TO DFHEIV11
  7893     MOVE 'ELACTQ' TO DFHEIV1
  7894*    MOVE '&& L                  %   #00007376' TO DFHEIV0
  7895     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7896     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7897     MOVE X'2020233030303037333736' TO DFHEIV0(25:11)
  7898     CALL 'kxdfhei1' USING DFHEIV0,
  7899           DFHEIV1,
  7900           ACTIVITY-QUE,
  7901           DFHEIV11,
  7902           DFHEIV99
  7903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7904
  7905
  7906     GO TO 7799-EXIT.
  7907
  7908 7720-DELETE-ACTIVITY-QUE.
  7909
  7910
  7911* EXEC CICS DELETE
  7912*        DATASET   ('ELACTQ')
  7913*    END-EXEC.
  7914     MOVE 'ELACTQ' TO DFHEIV1
  7915*    MOVE '&(                    &   #00007385' TO DFHEIV0
  7916     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7917     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7918     MOVE X'2020233030303037333835' TO DFHEIV0(25:11)
  7919     CALL 'kxdfhei1' USING DFHEIV0,
  7920           DFHEIV1,
  7921           DFHEIV99,
  7922           DFHEIV99,
  7923           DFHEIV99,
  7924           DFHEIV99
  7925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7926
  7927
  7928     GO TO 7799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 163
* EL1501.cbl
  7929
  7930 7750-UNLOCK-ACTIVITY-QUE.
  7931
  7932
  7933* EXEC CICS UNLOCK
  7934*        DATASET   ('ELACTQ')
  7935*    END-EXEC.
  7936     MOVE 'ELACTQ' TO DFHEIV1
  7937*    MOVE '&*                    #   #00007393' TO DFHEIV0
  7938     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7939     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7940     MOVE X'2020233030303037333933' TO DFHEIV0(25:11)
  7941     CALL 'kxdfhei1' USING DFHEIV0,
  7942           DFHEIV1,
  7943           DFHEIV99
  7944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7945
  7946
  7947     MOVE 'N'                    TO  WS-UPDATE-SW.
  7948
  7949 7799-EXIT.
  7950     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 164
* EL1501.cbl
  7952 7800-READ-CERT-UPDATE.
  7953
  7954
  7955* EXEC CICS READ
  7956*        DATASET   ('ELCERT')
  7957*        RIDFLD    (ELCERT-KEY)
  7958*        SET       (ADDRESS OF CERTIFICATE-MASTER)
  7959*        UPDATE
  7960*    END-EXEC.
  7961     MOVE 'ELCERT' TO DFHEIV1
  7962*    MOVE '&"S        EU         (   #00007404' TO DFHEIV0
  7963     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7964     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7965     MOVE X'2020233030303037343034' TO DFHEIV0(25:11)
  7966     CALL 'kxdfhei1' USING DFHEIV0,
  7967           DFHEIV1,
  7968           DFHEIV20,
  7969           DFHEIV99,
  7970           ELCERT-KEY,
  7971           DFHEIV99,
  7972           DFHEIV99,
  7973           DFHEIV99
  7974     SET ADDRESS OF CERTIFICATE-MASTER TO
  7975         DFHEIV20
  7976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7977
  7978
  7979 7800-EXIT.
  7980     EXIT.
  7981
  7982 7810-REWRITE-CERT.
  7983
  7984
  7985* EXEC CICS REWRITE
  7986*        DATASET   ('ELCERT')
  7987*        FROM      (CERTIFICATE-MASTER)
  7988*    END-EXEC.
  7989     MOVE LENGTH OF
  7990      CERTIFICATE-MASTER
  7991       TO DFHEIV11
  7992     MOVE 'ELCERT' TO DFHEIV1
  7993*    MOVE '&& L                  %   #00007416' TO DFHEIV0
  7994     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7995     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7996     MOVE X'2020233030303037343136' TO DFHEIV0(25:11)
  7997     CALL 'kxdfhei1' USING DFHEIV0,
  7998           DFHEIV1,
  7999           CERTIFICATE-MASTER,
  8000           DFHEIV11,
  8001           DFHEIV99
  8002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8003
  8004
  8005 7810-EXIT.
  8006     EXIT.
  8007
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 165
* EL1501.cbl
  8009 7900-READ-CONTROL-FILE.
  8010
  8011
  8012* EXEC CICS READ
  8013*        DATASET   ('ELCNTL')
  8014*        RIDFLD    (ELCNTL-KEY)
  8015*        SET       (ADDRESS OF CONTROL-FILE)
  8016*    END-EXEC.
  8017     MOVE 'ELCNTL' TO DFHEIV1
  8018*    MOVE '&"S        E          (   #00007427' TO DFHEIV0
  8019     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8020     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8021     MOVE X'2020233030303037343237' TO DFHEIV0(25:11)
  8022     CALL 'kxdfhei1' USING DFHEIV0,
  8023           DFHEIV1,
  8024           DFHEIV20,
  8025           DFHEIV99,
  8026           ELCNTL-KEY,
  8027           DFHEIV99,
  8028           DFHEIV99,
  8029           DFHEIV99
  8030     SET ADDRESS OF CONTROL-FILE TO
  8031         DFHEIV20
  8032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8033
  8034
  8035 7900-EXIT.
  8036     EXIT.
  8037
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 166
* EL1501.cbl
  8039 8000-LOAD-ERROR-MESSAGES.
  8040     IF EMI-NO-ERRORS
  8041         GO TO 8000-EXIT.
  8042
  8043     IF EMI-NUMBER-OF-LINES = 1
  8044         MOVE EMI-LINE1          TO  ERRMSG1O
  8045         GO TO 8000-EXIT.
  8046
  8047     MOVE EMI-LINE1              TO  ERRMSG1O.
  8048
  8049 8000-EXIT.
  8050     EXIT.
  8051
  8052 8100-SEND-INITIAL-MAP.
  8053
  8054     IF PI-FULL-SCREEN-SHOWN
  8055         GO TO 8200-SEND-DATAONLY.
  8056
  8057     MOVE 'Y'                    TO PI-FULL-SCREEN-IND.
  8058
  8059     MOVE SAVE-DATE              TO  RUNDTEO.
  8060     MOVE EIBTIME                TO  TIME-IN.
  8061     MOVE TIME-OUT               TO  RUNTIMEO.
  8062     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
  8063
  8064*    IF PI-COMPANY-ID NOT = 'DMD'
  8065         MOVE SPACES             TO PF6O.
  8066         MOVE AL-SADOF           TO PF6A.
  8067
  8068
  8069* EXEC CICS SEND
  8070*        MAP      (MAP-NAME)
  8071*        MAPSET   (MAPSET-NAME)
  8072*        FROM     (EL150BO)
  8073*        ERASE
  8074*        CURSOR
  8075*    END-EXEC.
  8076     MOVE LENGTH OF
  8077      EL150BO
  8078       TO DFHEIV12
  8079     MOVE -1
  8080       TO DFHEIV11
  8081*    MOVE '8$     CT  E    H L F ,   #00007466' TO DFHEIV0
  8082     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8083     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8084     MOVE X'2020233030303037343636' TO DFHEIV0(25:11)
  8085     CALL 'kxdfhei1' USING DFHEIV0,
  8086           MAP-NAME,
  8087           EL150BO,
  8088           DFHEIV12,
  8089           MAPSET-NAME,
  8090           DFHEIV99,
  8091           DFHEIV99,
  8092           DFHEIV99,
  8093           DFHEIV11,
  8094           DFHEIV99,
  8095           DFHEIV99,
  8096           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 167
* EL1501.cbl
  8097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8098
  8099
  8100     GO TO 9100-RETURN-TRAN.
  8101
  8102 8200-SEND-DATAONLY.
  8103
  8104     IF NOT PI-FULL-SCREEN-SHOWN
  8105         GO TO 8100-SEND-INITIAL-MAP.
  8106
  8107     MOVE SAVE-DATE              TO  RUNDTEO.
  8108     MOVE EIBTIME                TO  TIME-IN.
  8109     MOVE TIME-OUT               TO  RUNTIMEO.
  8110     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
  8111
  8112     MOVE PI-CARRIER             TO  CARRO.
  8113     MOVE PI-CLAIM-NO            TO  CLMNOO.
  8114     MOVE PI-CERT-PRIME          TO  CERTNOO.
  8115     MOVE PI-CERT-SFX            TO  SUFXO.
  8116
  8117*    IF PI-COMPANY-ID NOT = 'DMD'
  8118         MOVE SPACES             TO PF6O.
  8119         MOVE AL-SADOF           TO PF6A.
  8120
  8121
  8122* EXEC CICS SEND
  8123*        MAP      (MAP-NAME)
  8124*        MAPSET   (MAPSET-NAME)
  8125*        FROM     (EL150BO)
  8126*        DATAONLY
  8127*        CURSOR
  8128*    END-EXEC.
  8129     MOVE LENGTH OF
  8130      EL150BO
  8131       TO DFHEIV12
  8132     MOVE -1
  8133       TO DFHEIV11
  8134*    MOVE '8$D    CT       H L F ,   #00007495' TO DFHEIV0
  8135     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  8136     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8137     MOVE X'2020233030303037343935' TO DFHEIV0(25:11)
  8138     CALL 'kxdfhei1' USING DFHEIV0,
  8139           MAP-NAME,
  8140           EL150BO,
  8141           DFHEIV12,
  8142           MAPSET-NAME,
  8143           DFHEIV99,
  8144           DFHEIV99,
  8145           DFHEIV99,
  8146           DFHEIV11,
  8147           DFHEIV99,
  8148           DFHEIV99,
  8149           DFHEIV99
  8150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8151
  8152
  8153     GO TO 9100-RETURN-TRAN.
  8154
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 168
* EL1501.cbl
  8155 8300-SEND-TEXT.
  8156
  8157* EXEC CICS SEND TEXT
  8158*        FROM     (LOGOFF-TEXT)
  8159*        LENGTH   (LOGOFF-LENGTH)
  8160*        ERASE
  8161*        FREEKB
  8162*    END-EXEC.
  8163*    MOVE '8&      T  E F  H   F -   #00007506' TO DFHEIV0
  8164     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8165     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8166     MOVE X'2020233030303037353036' TO DFHEIV0(25:11)
  8167     CALL 'kxdfhei1' USING DFHEIV0,
  8168           LOGOFF-TEXT,
  8169           LOGOFF-LENGTH,
  8170           DFHEIV99,
  8171           DFHEIV99,
  8172           DFHEIV99,
  8173           DFHEIV99,
  8174           DFHEIV99,
  8175           DFHEIV99,
  8176           DFHEIV99,
  8177           DFHEIV99,
  8178           DFHEIV99,
  8179           DFHEIV99
  8180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8181
  8182
  8183
  8184* EXEC CICS RETURN
  8185*        END-EXEC.
  8186*    MOVE '.(                    ''   #00007513' TO DFHEIV0
  8187     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8188     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8189     MOVE X'2020233030303037353133' TO DFHEIV0(25:11)
  8190     CALL 'kxdfhei1' USING DFHEIV0,
  8191           DFHEIV99,
  8192           DFHEIV99,
  8193           DFHEIV99,
  8194           DFHEIV99,
  8195           DFHEIV99,
  8196           DFHEIV99
  8197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8198
  8199
  8200 8400-NOT-FOUND.
  8201     IF FILE-SWITCH = 'BENE'
  8202         MOVE ER-0282            TO  EMI-ERROR.
  8203
  8204     MOVE -1                     TO  LINENOL.
  8205     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8206
  8207     IF PASS-SWITCH = 'A'
  8208         GO TO 8100-SEND-INITIAL-MAP
  8209     ELSE
  8210         GO TO 8200-SEND-DATAONLY.
  8211
  8212 8500-FILE-NOTOPEN.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 169
* EL1501.cbl
  8213
  8214     IF FILE-SWITCH = 'TRLR'
  8215         MOVE ER-0172            TO  EMI-ERROR.
  8216
  8217     IF FILE-SWITCH = 'CERT'
  8218         MOVE ER-0169            TO  EMI-ERROR.
  8219
  8220     IF FILE-SWITCH = 'CNTL'
  8221         MOVE ER-0042            TO  EMI-ERROR.
  8222
  8223     IF FILE-SWITCH = 'ACTQ'
  8224         MOVE ER-0338            TO  EMI-ERROR.
  8225
  8226     IF FILE-SWITCH = 'MSTR'
  8227         MOVE ER-0154            TO  EMI-ERROR.
  8228
  8229     IF FILE-SWITCH = 'RCON'
  8230         MOVE ER-0776            TO  EMI-ERROR.
  8231
  8232     IF FILE-SWITCH = 'PLCY'
  8233         MOVE ER-9883            TO  EMI-ERROR.
  8234
  8235     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8236
  8237     MOVE -1                     TO  LINENOL.
  8238
  8239     IF PASS-SWITCH = 'A'
  8240         GO TO 8100-SEND-INITIAL-MAP
  8241     ELSE
  8242         GO TO 8200-SEND-DATAONLY.
  8243
  8244 8800-UNAUTHORIZED-ACCESS.
  8245     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  8246     GO TO 8300-SEND-TEXT.
  8247
  8248 8810-PF23.
  8249     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  8250     MOVE XCTL-005               TO  PGM-NAME.
  8251     GO TO 9300-XCTL.
  8252
  8253 9100-RETURN-TRAN.
  8254     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  8255     MOVE '150B'                 TO  PI-CURRENT-SCREEN-NO.
  8256
  8257
  8258* EXEC CICS RETURN
  8259*        TRANSID    (TRANS-ID)
  8260*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8261*        LENGTH     (PI-COMM-LENGTH)
  8262*    END-EXEC.
  8263*    MOVE '.(CT                  ''   #00007573' TO DFHEIV0
  8264     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8265     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8266     MOVE X'2020233030303037353733' TO DFHEIV0(25:11)
  8267     CALL 'kxdfhei1' USING DFHEIV0,
  8268           TRANS-ID,
  8269           PROGRAM-INTERFACE-BLOCK,
  8270           PI-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 170
* EL1501.cbl
  8271           DFHEIV99,
  8272           DFHEIV99,
  8273           DFHEIV99
  8274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8275
  8276
  8277 9200-RETURN-MAIN-MENU.
  8278     MOVE XCTL-126               TO PGM-NAME.
  8279     GO TO 9300-XCTL.
  8280
  8281 9300-XCTL.
  8282
  8283* EXEC CICS HANDLE CONDITION
  8284*        PGMIDERR   (9350-NOT-FOUND)
  8285*    END-EXEC.
  8286*    MOVE '"$L                   ! + #00007584' TO DFHEIV0
  8287     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8288     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8289     MOVE X'2B20233030303037353834' TO DFHEIV0(25:11)
  8290     CALL 'kxdfhei1' USING DFHEIV0
  8291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8292
  8293
  8294
  8295* EXEC CICS XCTL
  8296*        PROGRAM    (PGM-NAME)
  8297*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8298*        LENGTH     (PI-COMM-LENGTH)
  8299*    END-EXEC.
  8300*    MOVE '.$C                   %   #00007588' TO DFHEIV0
  8301     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8302     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8303     MOVE X'2020233030303037353838' TO DFHEIV0(25:11)
  8304     CALL 'kxdfhei1' USING DFHEIV0,
  8305           PGM-NAME,
  8306           PROGRAM-INTERFACE-BLOCK,
  8307           PI-COMM-LENGTH,
  8308           DFHEIV99
  8309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8310
  8311
  8312 9350-NOT-FOUND.
  8313     MOVE ER-0923                TO EMI-ERROR.
  8314     MOVE -1                     TO LINENOL.
  8315     PERFORM 9900-ERROR-FORMAT      THRU 9900-EXIT.
  8316     PERFORM 7510-UNLOCK-CLAIM-MSTR THRU 7510-EXIT.
  8317     PERFORM 7010-UNLOCK-TRLR       THRU 7010-EXIT.
  8318     GO TO 8200-SEND-DATAONLY.
  8319
  8320 9400-CLEAR.
  8321     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  8322     GO TO 9300-XCTL.
  8323
  8324 9500-PF12.
  8325     MOVE XCTL-010               TO  PGM-NAME.
  8326     GO TO 9300-XCTL.
  8327
  8328 9600-PGMID-ERROR.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 171
* EL1501.cbl
  8329
  8330* EXEC CICS HANDLE CONDITION
  8331*        PGMIDERR   (8300-SEND-TEXT)
  8332*    END-EXEC.
  8333*    MOVE '"$L                   ! , #00007611' TO DFHEIV0
  8334     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8335     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8336     MOVE X'2C20233030303037363131' TO DFHEIV0(25:11)
  8337     CALL 'kxdfhei1' USING DFHEIV0
  8338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8339
  8340
  8341     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  8342     MOVE ' '                    TO  PI-ENTRY-CD-1.
  8343     MOVE XCTL-005               TO  PGM-NAME.
  8344     MOVE PGM-NAME               TO  LOGOFF-PGM.
  8345     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  8346     GO TO 9300-XCTL.
  8347
  8348 9700-LINK-DATE-CONVERT.
  8349     MOVE LINK-ELDATCV           TO PGM-NAME.
  8350
  8351
  8352* EXEC CICS LINK
  8353*        PROGRAM    (PGM-NAME)
  8354*        COMMAREA   (DATE-CONVERSION-DATA)
  8355*        LENGTH     (DC-COMM-LENGTH)
  8356*    END-EXEC.
  8357*    MOVE '."C                   (   #00007625' TO DFHEIV0
  8358     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8359     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8360     MOVE X'2020233030303037363235' TO DFHEIV0(25:11)
  8361     CALL 'kxdfhei1' USING DFHEIV0,
  8362           PGM-NAME,
  8363           DATE-CONVERSION-DATA,
  8364           DC-COMM-LENGTH,
  8365           DFHEIV99,
  8366           DFHEIV99,
  8367           DFHEIV99,
  8368           DFHEIV99
  8369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8370
  8371
  8372 9700-EXIT.
  8373     EXIT.
  8374
  8375 9800-DEEDIT.
  8376
  8377
  8378* EXEC CICS BIF DEEDIT
  8379*        FIELD   (WS-DEEDIT-FIELD)
  8380*        LENGTH  (WS-DEEDIT-LENGTH)
  8381*    END-EXEC.
  8382*    MOVE '@"L                   #   #00007636' TO DFHEIV0
  8383     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8384     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8385     MOVE X'2020233030303037363336' TO DFHEIV0(25:11)
  8386     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 172
* EL1501.cbl
  8387           WS-DEEDIT-FIELD,
  8388           WS-DEEDIT-LENGTH
  8389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8390
  8391
  8392 9800-EXIT.
  8393     EXIT.
  8394
  8395
  8396 9870-OUTPUT-ACTIVITY-RECORD.
  8397
  8398
  8399* EXEC CICS GETMAIN
  8400*        SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
  8401*        LENGTH(25)
  8402*        INITIMG(WS-BLANK)
  8403*    END-EXEC.
  8404     MOVE 25
  8405       TO DFHEIV11
  8406*    MOVE ',"IL                  $   #00007647' TO DFHEIV0
  8407     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8408     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8409     MOVE X'2020233030303037363437' TO DFHEIV0(25:11)
  8410     CALL 'kxdfhei1' USING DFHEIV0,
  8411           DFHEIV20,
  8412           DFHEIV11,
  8413           WS-BLANK
  8414     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  8415         DFHEIV20
  8416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8417
  8418
  8419     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  8420     MOVE ELMSTR-KEY             TO DA-KEY.
  8421     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
  8422
  8423     IF WS-PAY-TYPE EQUAL '7'
  8424         MOVE 'V'                TO DA-RECORD-TYPE
  8425     ELSE
  8426         MOVE 'P'                TO DA-RECORD-TYPE.
  8427
  8428
  8429* EXEC CICS HANDLE CONDITION
  8430*        NOTOPEN (9870-NOTOPEN)
  8431*        DUPREC (9870-EXIT)
  8432*    END-EXEC.
  8433*    MOVE '"$J%                  ! - #00007662' TO DFHEIV0
  8434     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  8435     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8436     MOVE X'2D20233030303037363632' TO DFHEIV0(25:11)
  8437     CALL 'kxdfhei1' USING DFHEIV0
  8438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8439
  8440
  8441
  8442* EXEC CICS WRITE
  8443*        DATASET ('DLYACTV')
  8444*        RIDFLD (DA-KEY)
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 173
* EL1501.cbl
  8445*        FROM (DAILY-ACTIVITY-RECORD)
  8446*        LENGTH (25)
  8447*    END-EXEC.
  8448     MOVE 'DLYACTV' TO DFHEIV1
  8449     MOVE 25
  8450       TO DFHEIV11
  8451*    MOVE '&$ L                  ''   #00007667' TO DFHEIV0
  8452     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8453     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8454     MOVE X'2020233030303037363637' TO DFHEIV0(25:11)
  8455     CALL 'kxdfhei1' USING DFHEIV0,
  8456           DFHEIV1,
  8457           DAILY-ACTIVITY-RECORD,
  8458           DFHEIV11,
  8459           DA-KEY,
  8460           DFHEIV99,
  8461           DFHEIV99
  8462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8463
  8464
  8465     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
  8466     GO TO 9870-EXIT.
  8467
  8468 9870-NOTOPEN.
  8469
  8470     MOVE '2955'                 TO EMI-ERROR.
  8471     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
  8472
  8473 9870-EXIT.
  8474
  8475 9900-ERROR-FORMAT.
  8476     IF NOT EMI-ERRORS-COMPLETE
  8477         MOVE LINK-001           TO PGM-NAME
  8478
  8479* EXEC CICS LINK
  8480*            PROGRAM    (PGM-NAME)
  8481*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8482*            LENGTH     (EMI-COMM-LENGTH)
  8483*        END-EXEC.
  8484*    MOVE '."C                   (   #00007687' TO DFHEIV0
  8485     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8486     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8487     MOVE X'2020233030303037363837' TO DFHEIV0(25:11)
  8488     CALL 'kxdfhei1' USING DFHEIV0,
  8489           PGM-NAME,
  8490           ERROR-MESSAGE-INTERFACE-BLOCK,
  8491           EMI-COMM-LENGTH,
  8492           DFHEIV99,
  8493           DFHEIV99,
  8494           DFHEIV99,
  8495           DFHEIV99
  8496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8497
  8498
  8499 9900-EXIT.
  8500     EXIT.
  8501
  8502 9990-ABEND.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 174
* EL1501.cbl
  8503     MOVE -1                     TO  ENTERPFL.
  8504     MOVE LINK-004               TO  PGM-NAME.
  8505
  8506     MOVE DFHEIBLK               TO  EMI-LINE1
  8507
  8508* EXEC CICS LINK
  8509*        PROGRAM   (PGM-NAME)
  8510*        COMMAREA  (EMI-LINE1)
  8511*        LENGTH    (72)
  8512*    END-EXEC.
  8513     MOVE 72
  8514       TO DFHEIV11
  8515*    MOVE '."C                   (   #00007701' TO DFHEIV0
  8516     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8517     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8518     MOVE X'2020233030303037373031' TO DFHEIV0(25:11)
  8519     CALL 'kxdfhei1' USING DFHEIV0,
  8520           PGM-NAME,
  8521           EMI-LINE1,
  8522           DFHEIV11,
  8523           DFHEIV99,
  8524           DFHEIV99,
  8525           DFHEIV99,
  8526           DFHEIV99
  8527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8528
  8529
  8530     MOVE EMI-LINE1              TO  ERRMSG1O.
  8531     GO TO 8200-SEND-DATAONLY.
  8532
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 175
* EL1501.cbl
  8534 9995-SECURITY-VIOLATION.
  8535*                            COPY ELCSCTP.
  8536******************************************************************
  8537*                                                                *
  8538*                            ELCSCTP                             *
  8539*                            VMOD=2.001                          *
  8540*                                                                *
  8541*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8542******************************************************************
  8543
  8544
  8545     MOVE EIBDATE          TO SM-JUL-DATE.
  8546     MOVE EIBTRMID         TO SM-TERMID.
  8547     MOVE THIS-PGM         TO SM-PGM.
  8548     MOVE EIBTIME          TO TIME-IN.
  8549     MOVE TIME-OUT         TO SM-TIME.
  8550     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8551
  8552
  8553* EXEC CICS LINK
  8554*         PROGRAM  ('EL003')
  8555*         COMMAREA (SECURITY-MESSAGE)
  8556*         LENGTH   (80)
  8557*    END-EXEC.
  8558     MOVE 'EL003' TO DFHEIV1
  8559     MOVE 80
  8560       TO DFHEIV11
  8561*    MOVE '."C                   (   #00007729' TO DFHEIV0
  8562     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8563     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8564     MOVE X'2020233030303037373239' TO DFHEIV0(25:11)
  8565     CALL 'kxdfhei1' USING DFHEIV0,
  8566           DFHEIV1,
  8567           SECURITY-MESSAGE,
  8568           DFHEIV11,
  8569           DFHEIV99,
  8570           DFHEIV99,
  8571           DFHEIV99,
  8572           DFHEIV99
  8573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8574
  8575
  8576******************************************************************
  8577
  8578
  8579
  8580 9999-DFHBACK SECTION.
  8581     MOVE '9%                    "   ' TO DFHEIV0
  8582     MOVE 'EL1501' TO DFHEIV1
  8583     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8584     GOBACK.
  8585 9999-DFHEXIT.
  8586     IF DFHEIGDJ EQUAL 0001
  8587         NEXT SENTENCE
  8588     ELSE IF DFHEIGDJ EQUAL 2
  8589         GO TO 1000-SHOW-CLAIM-HISTORY,
  8590               0100-FIRST-TIME-IN,
  8591               8500-FILE-NOTOPEN,
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 05:52 Page 176
* EL1501.cbl
  8592               9600-PGMID-ERROR,
  8593               9990-ABEND
  8594         DEPENDING ON DFHEIGDI
  8595     ELSE IF DFHEIGDJ EQUAL 3
  8596         GO TO 0690-QIDERR
  8597         DEPENDING ON DFHEIGDI
  8598     ELSE IF DFHEIGDJ EQUAL 4
  8599         GO TO 2950-NO-MORE-TRAILERS,
  8600               2950-NO-MORE-TRAILERS
  8601         DEPENDING ON DFHEIGDI
  8602     ELSE IF DFHEIGDJ EQUAL 5
  8603         GO TO 2020-BROWSE-FORWARD
  8604         DEPENDING ON DFHEIGDI
  8605     ELSE IF DFHEIGDJ EQUAL 6
  8606         GO TO 2950-NO-MORE-TRAILERS,
  8607               2950-NO-MORE-TRAILERS
  8608         DEPENDING ON DFHEIGDI
  8609     ELSE IF DFHEIGDJ EQUAL 7
  8610         GO TO 5290-NOTFND
  8611         DEPENDING ON DFHEIGDI
  8612     ELSE IF DFHEIGDJ EQUAL 8
  8613         GO TO 5700-NOT-FOUND,
  8614               8500-FILE-NOTOPEN
  8615         DEPENDING ON DFHEIGDI
  8616     ELSE IF DFHEIGDJ EQUAL 9
  8617         GO TO 7200-EXIT,
  8618               7200-EXIT
  8619         DEPENDING ON DFHEIGDI
  8620     ELSE IF DFHEIGDJ EQUAL 10
  8621         GO TO 7799-EXIT
  8622         DEPENDING ON DFHEIGDI
  8623     ELSE IF DFHEIGDJ EQUAL 11
  8624         GO TO 9350-NOT-FOUND
  8625         DEPENDING ON DFHEIGDI
  8626     ELSE IF DFHEIGDJ EQUAL 12
  8627         GO TO 8300-SEND-TEXT
  8628         DEPENDING ON DFHEIGDI
  8629     ELSE IF DFHEIGDJ EQUAL 13
  8630         GO TO 9870-NOTOPEN,
  8631               9870-EXIT
  8632         DEPENDING ON DFHEIGDI.
  8633     MOVE '9%                    "   ' TO DFHEIV0
  8634     MOVE 'EL1501' TO DFHEIV1
  8635     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8636     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        7572     Code:       21847
