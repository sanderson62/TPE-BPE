* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6509.cbl
* Options: int("EL6509.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6509.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6509.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6509.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6509.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/06/95 08:37:08.
     7*                            VMOD=2.005.
     8*
     9*AUTHOR.           LOGIC,INC.
    10*                  DALLAS,TEXAS.
    11
    12*DATE-COMPILED.
    13*SECURITY.   *****************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6509.cbl
    14*            *                                                   *
    15*            * THIS PROGRAM IS THE PROPERTY OF LOCIC, INC. *
    16*            *                                                   *
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    19*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    20*            *                                                   *
    21*            *****************************************************
    22*
    23*REMARKS.     TRANSACTION - EXDA - ACCOUNT NOTE MAINTENANCE.
    24*
    25******************************************************************
    26*                   C H A N G E   L O G
    27*
    28* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    29*-----------------------------------------------------------------
    30*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    31* EFFECTIVE    NUMBER
    32*-----------------------------------------------------------------
    33* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    34*                              ADJUSTED REDEFINES EL6509AI FILLER
    35* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
    36*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
    37* 110209  CR2008092300001  AJRA  DELETE TEMP STORE ON INITIAL BUIL
    38******************************************************************
    39 ENVIRONMENT DIVISION.
    40
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6509.cbl
    42 DATA DIVISION.
    43 WORKING-STORAGE SECTION.
    44 01  DFH-START PIC X(04).
    45 77  FILLER  PIC X(32)  VALUE '********************************'.
    46 77  FILLER  PIC X(32)  VALUE '*     EL6509 WORKING STORAGE   *'.
    47 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.005 ***********'.
    48
    49*    COPY ELCSCTM.
    50******************************************************************
    51*                                                                *
    52*                                                                *
    53*                            ELCSCTM                             *
    54*                            VMOD=2.001                          *
    55*                                                                *
    56*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    57*                                                                *
    58******************************************************************
    59 01  SECURITY-MESSAGE.
    60     12  FILLER                          PIC X(30)
    61            VALUE '** LOGIC SECURITY VIOLATION -'.
    62     12  SM-READ                         PIC X(6).
    63     12  FILLER                          PIC X(5)
    64            VALUE ' PGM='.
    65     12  SM-PGM                          PIC X(6).
    66     12  FILLER                          PIC X(5)
    67            VALUE ' OPR='.
    68     12  SM-PROCESSOR-ID                 PIC X(4).
    69     12  FILLER                          PIC X(6)
    70            VALUE ' TERM='.
    71     12  SM-TERMID                       PIC X(4).
    72     12  FILLER                          PIC XX   VALUE SPACE.
    73     12  SM-JUL-DATE                     PIC 9(5).
    74     12  FILLER                          PIC X    VALUE SPACE.
    75     12  SM-TIME                         PIC 99.99.
    76
    77*    COPY ELCSCRTY.
    78******************************************************************
    79*                                                                *
    80*                                                                *
    81*                            ELCSCRTY                            *
    82*                            VMOD=2.001                          *
    83*                                                                *
    84*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    85*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    86*        SAVED IN PI-SECURITY-ADDRESS.                           *
    87*                                                                *
    88******************************************************************
    89 01  SECURITY-CONTROL.
    90     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    91     12  FILLER                       PIC XX    VALUE 'SC'.
    92     12  SC-CREDIT-CODES.
    93         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    94             20  SC-CREDIT-DISPLAY    PIC X.
    95             20  SC-CREDIT-UPDATE     PIC X.
    96     12  SC-CLAIMS-CODES.
    97         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    98             20  SC-CLAIMS-DISPLAY    PIC X.
    99             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6509.cbl
   100
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6509.cbl
   102 01  STANDARD-AREAS.
   103     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   104     12  MAP-NAME                PIC X(8)    VALUE 'EL6509A'.
   105     12  MAPSET-NAME             PIC X(8)    VALUE 'EL6509S '.
   106     12  SCRN-NUMBER             PIC X(4)    VALUE '650I'.
   107     12  TRANS-ID                PIC X(4)    VALUE 'EXDA'.
   108     12  W-PRINT-TRANS           PIC X(4)    VALUE 'EXDB'.
   109     12  THIS-PGM                PIC X(8)    VALUE 'EL6509'.
   110     12  PGM-NAME                PIC X(8).
   111     12  PGM-EL650               PIC X(8)    VALUE 'EL650'.
   112
   113     12  ERACNT-FILE-ID          PIC X(8)    VALUE 'ERACNT'.
   114     12  ELCNTL-FILE-ID          PIC X(8)    VALUE 'ELCNTL'.
   115     12  QID.
   116         16  QID-TERM            PIC X(4).
   117         16  FILLER              PIC X(4)    VALUE '650I'.
   118     12  QID-ITEM                PIC S9(4)   COMP VALUE +0.
   119     12  SC-ITEM                 PIC S9(4)   COMP VALUE +1.
   120
   121 01  WORK-AREA.
   122     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   123     12  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   124
   125     12  FN-CONVERT              PIC XX.
   126     12  FN-BIN REDEFINES FN-CONVERT  PIC S9(4)  COMP.
   127
   128     12  ERACNT-LENGTH           PIC S9(4)   COMP VALUE +120.
   129     12  ERACNT-KEY-LENGTH       PIC S9(4)   COMP VALUE +23.
   130     12  ERACNT-START-LENGTH     PIC S9(4)   COMP VALUE +21.
   131     12  ERACNT-KEY.
   132         16  ERACNT-PARTIAL-KEY.
   133             20 ERACNT-COMPANY-CD    PIC X.
   134             20 ERACNT-CARRIER       PIC X.
   135             20 ERACNT-GROUPING      PIC X(06).
   136             20 ERACNT-STATE         PIC XX.
   137             20 ERACNT-ACCOUNT       PIC X(10).
   138             20 ERACNT-REC-TYP       PIC X.
   139         16 ERACNT-SEQ           PIC S9(4) COMP.
   140     12  SV-PRIOR-KEY.
   141         20 SV-COMPANY-CD            PIC X.
   142         20 SV-CARRIER               PIC X.
   143         20 SV-GROUPING              PIC X(06).
   144         20 SV-STATE                 PIC XX.
   145         20 SV-ACCOUNT               PIC X(10).
   146         20 SV-REC-TYP               PIC X.
   147         20 SV-SEQ                   PIC S9(4) COMP.
   148     12  W-START-BR              PIC X       VALUE SPACES.
   149     12  VG-CNTL-KEY.
   150         20 VG-CARRIER               PIC X.
   151         20 VG-GROUPING              PIC X(06).
   152         20 VG-STATE                 PIC XX.
   153         20 VG-ACCOUNT               PIC X(10).
   154     12  W-WORK-CONT.
   155         16  W-WORK-PRIME        PIC X(14)   VALUE SPACES.
   156         16  FILLER              PIC X       VALUE '-'.
   157         16  W-WORK-SFX          PIC X       VALUE SPACES.
   158     12  ELCNTL-KEY.
   159         16  ELCNTL-COMPANY      PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6509.cbl
   160         16  ELCNTL-REC-TYPE     PIC X.
   161         16  FILLER              PIC X(4).
   162         16  ELCNTL-SEQ-NO       PIC S9(4)   COMP.
   163     12  TIME-IN                 PIC S9(7).
   164     12  TIME-SPLIT REDEFINES TIME-IN.
   165         16  FILLER              PIC X.
   166         16  TIME-OUT            PIC 99V99.
   167         16  FILLER              PIC 9(2).
   168     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   169     12  XCTL-126                PIC X(8)    VALUE 'EL126'.
   170     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   171     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   172     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   173     12  MAX-LINES               PIC 999     VALUE 300.
   174     12  NUM-LINES-PER-SCREEN    PIC 99      VALUE 12.
   175     12  TS-NUM-REC-IN-GROUP     PIC 99      VALUE 50.
   176     12  TS-GROUP-WORK           PIC 9(5)    VALUE 0  COMP-3.
   177     12  TS-LENGTH               PIC S9(4)   VALUE +3600 COMP.
   178     12  ROLL-COUNTER            PIC S999    VALUE +0 COMP-3.
   179     12  TEMP-CURR-LINE          PIC S9(3)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6509.cbl
   181 01  ERROR-MESSAGES.
   182     12  ER-0000             PIC X(04)       VALUE '0000'.
   183     12  ER-0004             PIC X(04)       VALUE '0004'.
   184     12  ER-0006             PIC X(04)       VALUE '0006'.
   185     12  ER-0008             PIC X(04)       VALUE '0008'.
   186     12  ER-0023             PIC X(04)       VALUE '0023'.
   187     12  ER-0029             PIC X(04)       VALUE '0029'.
   188     12  ER-0030             PIC X(04)       VALUE '0030'.
   189     12  ER-0031             PIC X(04)       VALUE '0031'.
   190     12  ER-0032             PIC X(04)       VALUE '0032'.
   191     12  ER-0033             PIC X(04)       VALUE '0033'.
   192     12  ER-0041             PIC X(04)       VALUE '0041'.
   193     12  ER-0044             PIC X(04)       VALUE '0044'.
   194     12  ER-0045             PIC X(04)       VALUE '0045'.
   195     12  ER-0047             PIC X(04)       VALUE '0047'.
   196     12  ER-0048             PIC X(04)       VALUE '0048'.
   197     12  ER-0049             PIC X(04)       VALUE '0049'.
   198     12  ER-0050             PIC X(04)       VALUE '0050'.
   199     12  ER-0051             PIC X(04)       VALUE '0051'.
   200     12  ER-0066             PIC X(04)       VALUE '0066'.
   201     12  ER-0067             PIC X(04)       VALUE '0067'.
   202     12  ER-0069             PIC X(04)       VALUE '0069'.
   203     12  ER-0070             PIC X(04)       VALUE '0070'.
   204     12  ER-0140             PIC X(04)       VALUE '0140'.
   205     12  ER-0412             PIC X(04)       VALUE '0412'.
   206     12  ER-0413             PIC X(04)       VALUE '0413'.
   207     12  ER-3784             PIC X(04)       VALUE '3784'.
   208     12  ER-3786             PIC X(04)       VALUE '3786'.
   209     12  ER-3787             PIC X(04)       VALUE '3787'.
   210     12  ER-3788             PIC X(04)       VALUE '3788'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6509.cbl
   212*                       COPY ELCLOGOF.
   213******************************************************************
   214*                                                                *
   215*                                                                *
   216*                            ELCLOGOF.                           *
   217*                            VMOD=2.001                          *
   218*                                                                *
   219*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   220*                                                                *
   221******************************************************************
   222 01  CLASIC-LOGOFF.
   223     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   224     12  LOGOFF-TEXT.
   225         16  FILLER          PIC X(5)    VALUE SPACES.
   226         16  LOGOFF-MSG.
   227             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   228             20  FILLER      PIC X       VALUE SPACES.
   229             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   230         16  FILLER          PIC X(80)
   231           VALUE '* YOU ARE NOW LOGGED OFF'.
   232         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   233         16  FILLER          PIC X       VALUE QUOTE.
   234         16  LOGOFF-SYS-MSG  PIC X(17)
   235           VALUE 'S CLAS-IC SYSTEM '.
   236     12  TEXT-MESSAGES.
   237         16  UNACCESS-MSG    PIC X(29)
   238             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   239         16  PGMIDERR-MSG    PIC X(17)
   240             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6509.cbl
   242*                       COPY ELCAID.
   243******************************************************************
   244*                                                                *
   245*                            ELCAID.                             *
   246*                            VMOD=2.001                          *
   247*                                                                *
   248*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   249*                                                                *
   250*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   251*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   252******************************************************************
   253
   254 01  DFHAID.
   255   02  DFHNULL   PIC  X  VALUE  ' '.
   256   02  DFHENTER  PIC  X  VALUE  QUOTE.
   257   02  DFHCLEAR  PIC  X  VALUE  '_'.
   258   02  DFHPEN    PIC  X  VALUE  '='.
   259   02  DFHOPID   PIC  X  VALUE  'W'.
   260   02  DFHPA1    PIC  X  VALUE  '%'.
   261   02  DFHPA2    PIC  X  VALUE  '>'.
   262   02  DFHPA3    PIC  X  VALUE  ','.
   263   02  DFHPF1    PIC  X  VALUE  '1'.
   264   02  DFHPF2    PIC  X  VALUE  '2'.
   265   02  DFHPF3    PIC  X  VALUE  '3'.
   266   02  DFHPF4    PIC  X  VALUE  '4'.
   267   02  DFHPF5    PIC  X  VALUE  '5'.
   268   02  DFHPF6    PIC  X  VALUE  '6'.
   269   02  DFHPF7    PIC  X  VALUE  '7'.
   270   02  DFHPF8    PIC  X  VALUE  '8'.
   271   02  DFHPF9    PIC  X  VALUE  '9'.
   272   02  DFHPF10   PIC  X  VALUE  ':'.
   273   02  DFHPF11   PIC  X  VALUE  '#'.
   274   02  DFHPF12   PIC  X  VALUE  '@'.
   275   02  DFHPF13   PIC  X  VALUE  'A'.
   276   02  DFHPF14   PIC  X  VALUE  'B'.
   277   02  DFHPF15   PIC  X  VALUE  'C'.
   278   02  DFHPF16   PIC  X  VALUE  'D'.
   279   02  DFHPF17   PIC  X  VALUE  'E'.
   280   02  DFHPF18   PIC  X  VALUE  'F'.
   281   02  DFHPF19   PIC  X  VALUE  'G'.
   282   02  DFHPF20   PIC  X  VALUE  'H'.
   283   02  DFHPF21   PIC  X  VALUE  'I'.
   284*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   285   02  DFHPF22   PIC  X  VALUE  '['.
   286   02  DFHPF23   PIC  X  VALUE  '.'.
   287   02  DFHPF24   PIC  X  VALUE  '<'.
   288   02  DFHMSRE   PIC  X  VALUE  'X'.
   289   02  DFHSTRF   PIC  X  VALUE  'h'.
   290   02  DFHTRIG   PIC  X  VALUE  '"'.
   291 01  FILLER  REDEFINES DFHAID.
   292     12  FILLER                  PIC X(8).
   293     12  PF-VALUES OCCURS 24 TIMES       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6509.cbl
   295*                       COPY ELCEMIB.
   296******************************************************************
   297*                                                                *
   298*                                                                *
   299*                            ELCEMIB.                            *
   300*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   301*                            VMOD=2.005                          *
   302*                                                                *
   303*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   304*                                                                *
   305******************************************************************
   306 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   307     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   308     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   309     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   310     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   311     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   312     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   313     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   314     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   315     12  EMI-SWITCH1             PIC X        VALUE '1'.
   316         88  EMI-NO-ERRORS                    VALUE '1'.
   317         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   318         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   319     12  EMI-SWITCH2             PIC X        VALUE '1'.
   320         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   321     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   322         88  EMI-AREA1-EMPTY                  VALUE '1'.
   323         88  EMI-AREA1-FULL                   VALUE '2'.
   324     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   325         88  EMI-AREA2-EMPTY                  VALUE '1'.
   326         88  EMI-AREA2-FULL                   VALUE '2'.
   327     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   328         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   329         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   330         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   331         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   332         88  EMI-BYPASS-FATALS                VALUE 'X'.
   333     12  EMI-ERROR-LINES.
   334         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   335         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   336         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   337         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   338             20  EMI-ERR-CODES OCCURS 10 TIMES.
   339                 24  EMI-ERR-NUM         PIC X(4).
   340                 24  EMI-FILLER          PIC X.
   341                 24  EMI-SEV             PIC X.
   342                 24  FILLER              PIC X.
   343             20  FILLER                  PIC X(02).
   344     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   345         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   346             20  EMI-ERROR-NUMBER    PIC X(4).
   347             20  EMI-FILL            PIC X.
   348             20  EMI-SEVERITY        PIC X.
   349             20  FILLER              PIC X.
   350             20  EMI-ERROR-TEXT.
   351                 24  EMI-TEXT-VARIABLE   PIC X(10).
   352                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6509.cbl
   353     12  EMI-SEVERITY-SAVE           PIC X.
   354         88  EMI-NOTE                    VALUE 'N'.
   355         88  EMI-WARNING                 VALUE 'W'.
   356         88  EMI-FORCABLE                VALUE 'F'.
   357         88  EMI-FATAL                   VALUE 'X'.
   358     12  EMI-MESSAGE-FLAG            PIC X.
   359         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   360         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   361     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   362     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   363         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   364         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   365         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   366     12  FILLER                      PIC X(137)  VALUE SPACES.
   367     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   368     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   369     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   370     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6509.cbl
   372*                       COPY ELCINTF.
   373******************************************************************
   374*                                                                *
   375*                                                                *
   376*                            ELCINTF.                            *
   377*                            VMOD=2.017                          *
   378*                                                                *
   379*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   380*                                                                *
   381*       LENGTH = 1024                                            *
   382*                                                                *
   383******************************************************************
   384 01  PROGRAM-INTERFACE-BLOCK.
   385     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   386     12  PI-CALLING-PROGRAM              PIC X(8).
   387     12  PI-SAVED-PROGRAM-1              PIC X(8).
   388     12  PI-SAVED-PROGRAM-2              PIC X(8).
   389     12  PI-SAVED-PROGRAM-3              PIC X(8).
   390     12  PI-SAVED-PROGRAM-4              PIC X(8).
   391     12  PI-SAVED-PROGRAM-5              PIC X(8).
   392     12  PI-SAVED-PROGRAM-6              PIC X(8).
   393     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   394     12  PI-COMPANY-ID                   PIC XXX.
   395     12  PI-COMPANY-CD                   PIC X.
   396
   397     12  PI-COMPANY-PASSWORD             PIC X(8).
   398
   399     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   400
   401     12  PI-CONTROL-IN-PROGRESS.
   402         16  PI-CARRIER                  PIC X.
   403         16  PI-GROUPING                 PIC X(6).
   404         16  PI-STATE                    PIC XX.
   405         16  PI-ACCOUNT                  PIC X(10).
   406         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   407                                         PIC X(10).
   408         16  PI-CLAIM-CERT-GRP.
   409             20  PI-CLAIM-NO             PIC X(7).
   410             20  PI-CERT-NO.
   411                 25  PI-CERT-PRIME       PIC X(10).
   412                 25  PI-CERT-SFX         PIC X.
   413             20  PI-CERT-EFF-DT          PIC XX.
   414         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   415             20  PI-PLAN-CODE            PIC X(2).
   416             20  PI-REVISION-NUMBER      PIC X(3).
   417             20  PI-PLAN-EFF-DT          PIC X(2).
   418             20  PI-PLAN-EXP-DT          PIC X(2).
   419             20  FILLER                  PIC X(11).
   420         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   421             20  PI-OE-REFERENCE-1.
   422                 25  PI-OE-REF-1-PRIME   PIC X(18).
   423                 25  PI-OE-REF-1-SUFF    PIC XX.
   424
   425     12  PI-SESSION-IN-PROGRESS          PIC X.
   426         88  CLAIM-SESSION                   VALUE '1'.
   427         88  CREDIT-SESSION                  VALUE '2'.
   428         88  WARRANTY-SESSION                VALUE '3'.
   429         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6509.cbl
   430         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   431
   432
   433*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   434
   435     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   436     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   437
   438     12  PI-CREDIT-USER                  PIC X.
   439         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   440         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   441
   442     12  PI-CLAIM-USER                   PIC X.
   443         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   444         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   445
   446     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   447         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   448         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   449         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   450         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   451         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   452
   453     12  PI-PROCESSOR-ID                 PIC X(4).
   454
   455     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   456
   457     12  PI-MEMBER-CAPTION               PIC X(10).
   458
   459     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   460         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   461
   462     12  PI-LIFE-OVERRIDE-L1             PIC X.
   463     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   464     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   465     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   466
   467     12  PI-AH-OVERRIDE-L1               PIC X.
   468     12  PI-AH-OVERRIDE-L2               PIC XX.
   469     12  PI-AH-OVERRIDE-L6               PIC X(6).
   470     12  PI-AH-OVERRIDE-L12              PIC X(12).
   471
   472     12  PI-NEW-SYSTEM                   PIC X(2).
   473
   474     12  PI-PRIMARY-CERT-NO              PIC X(11).
   475     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   476         88  PI-USES-PAID-TO                 VALUE '1'.
   477     12  PI-CRDTCRD-SYSTEM.
   478         16  PI-CRDTCRD-USER             PIC X.
   479             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   480             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   481         16  PI-CC-MONTH-END-DT          PIC XX.
   482     12  PI-PROCESSOR-PRINTER            PIC X(4).
   483
   484     12  PI-OE-REFERENCE-2.
   485         16  PI-OE-REF-2-PRIME           PIC X(10).
   486         16  PI-OE-REF-2-SUFF            PIC X.
   487
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6509.cbl
   488     12  PI-REM-TRM-CALC-OPTION          PIC X.
   489
   490     12  PI-LANGUAGE-TYPE                PIC X.
   491             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   492             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   493             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   494
   495     12  PI-POLICY-LINKAGE-IND           PIC X.
   496         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   497         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   498                                                   LOW-VALUES.
   499
   500     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   501     12  PI-CLAIM-PW-SESSION             PIC X(1).
   502         88  PI-CLAIM-CREDIT                 VALUE '1'.
   503         88  PI-CLAIM-CONVEN                 VALUE '2'.
   504     12  FILLER                          PIC X(4).
   505
   506     12  PI-SYSTEM-LEVEL                 PIC X(145).
   507
   508     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   509         PI-SYSTEM-LEVEL.
   510
   511         16  PI-ENTRY-CODES.
   512             20  PI-ENTRY-CD-1           PIC X.
   513             20  PI-ENTRY-CD-2           PIC X.
   514
   515         16  PI-RETURN-CODES.
   516             20  PI-RETURN-CD-1          PIC X.
   517             20  PI-RETURN-CD-2          PIC X.
   518
   519         16  PI-UPDATE-STATUS-SAVE.
   520             20  PI-UPDATE-BY            PIC X(4).
   521             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   522
   523         16  PI-LOWER-CASE-LETTERS       PIC X.
   524             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   525
   526*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   527*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   528*            88  CARRIER-CLM-CNTL            VALUE '2'.
   529
   530         16  PI-CERT-ACCESS-CONTROL      PIC X.
   531             88  ST-ACCNT-CNTL               VALUE ' '.
   532             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   533             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   534             88  ACCNT-CNTL                  VALUE '3'.
   535             88  CARR-ACCNT-CNTL             VALUE '4'.
   536
   537         16  PI-PROCESSOR-CAP-LIST.
   538             20  PI-SYSTEM-CONTROLS.
   539                24 PI-SYSTEM-DISPLAY     PIC X.
   540                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   541                24 PI-SYSTEM-MODIFY      PIC X.
   542                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   543             20  FILLER                  PIC XX.
   544             20  PI-DISPLAY-CAP          PIC X.
   545                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6509.cbl
   546             20  PI-MODIFY-CAP           PIC X.
   547                 88  MODIFY-CAP              VALUE 'Y'.
   548             20  PI-MSG-AT-LOGON-CAP     PIC X.
   549                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   550             20  PI-FORCE-CAP            PIC X.
   551                 88  FORCE-CAP               VALUE 'Y'.
   552
   553         16  PI-PROGRAM-CONTROLS.
   554             20  PI-PGM-PRINT-OPT        PIC X.
   555             20  PI-PGM-FORMAT-OPT       PIC X.
   556             20  PI-PGM-PROCESS-OPT      PIC X.
   557             20  PI-PGM-TOTALS-OPT       PIC X.
   558
   559         16  PI-HELP-INTERFACE.
   560             20  PI-LAST-ERROR-NO        PIC X(4).
   561             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   562
   563         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   564             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   565
   566         16  PI-CR-CONTROL-IN-PROGRESS.
   567             20  PI-CR-CARRIER           PIC X.
   568             20  PI-CR-GROUPING          PIC X(6).
   569             20  PI-CR-STATE             PIC XX.
   570             20  PI-CR-ACCOUNT           PIC X(10).
   571             20  PI-CR-FIN-RESP          PIC X(10).
   572             20  PI-CR-TYPE              PIC X.
   573
   574         16  PI-CR-BATCH-NUMBER          PIC X(6).
   575
   576         16  PI-CR-MONTH-END-DT          PIC XX.
   577
   578         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   579             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   580             88  PI-ZERO-CARRIER             VALUE '1'.
   581             88  PI-ZERO-GROUPING            VALUE '2'.
   582             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   583
   584         16  PI-CARRIER-SECURITY         PIC X.
   585             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   586
   587         16  PI-ACCOUNT-SECURITY         PIC X(10).
   588             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   589             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   590
   591         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   592             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   593                                         INDEXED BY PI-ACCESS-NDX
   594                                         PIC X.
   595
   596         16  PI-GA-BILLING-CONTROL       PIC X.
   597             88  PI-GA-BILLING               VALUE '1'.
   598
   599         16  PI-MAIL-PROCESSING          PIC X.
   600             88  PI-MAIL-YES                 VALUE 'Y'.
   601
   602         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   603
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6509.cbl
   604         16  PI-AR-SYSTEM.
   605             20  PI-AR-PROCESSING-CNTL   PIC X.
   606                 88  PI-AR-PROCESSING        VALUE 'Y'.
   607             20  PI-AR-SUMMARY-CODE      PIC X(6).
   608             20  PI-AR-MONTH-END-DT      PIC XX.
   609
   610         16  PI-MP-SYSTEM.
   611             20  PI-MORTGAGE-USER            PIC X.
   612                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   613                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   614             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   615                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   616                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   617                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   618                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   619                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   620             20  PI-MP-MONTH-END-DT          PIC XX.
   621             20  PI-MP-REFERENCE-NO.
   622                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   623                 24  PI-MP-REFERENCE-SFX     PIC XX.
   624
   625         16  PI-LABEL-CONTROL            PIC X(01).
   626             88  PI-CREATE-LABELS                    VALUE 'Y'.
   627             88  PI-BYPASS-LABELS                    VALUE 'N'.
   628
   629         16  PI-BILL-GROUPING-CODE       PIC X(01).
   630             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   631
   632         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   633             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   634             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   635
   636         16  FILLER                      PIC X(14).
   637
   638     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   639******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6509.cbl
   641*                       COPY ELC650PI.
   642******************************************************************
   643*
   644*                            ELC650PI.
   645*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   646*                            VMOD=2.007
   647*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
   648*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
   649* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
   650*
   651******************************************************************
   652
   653     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   654         16  PI-MAINT                   PIC X.
   655         16  PI-PREV-ACCOUNT            PIC X(20).
   656         16  PI-PREV-VG-ACCOUNT         PIC X(20).
   657         16  PI-ACCT-KEY.
   658             20  PI-ACCT-CCGSA-KEY.
   659                 24  PI-ACCT-CO             PIC X.
   660                 24  PI-ACCT-CARRIER        PIC X.
   661                 24  PI-ACCT-GROUPING       PIC X(6).
   662                 24  PI-ACCT-STATE          PIC XX.
   663                 24  PI-ACCT-ACCOUNT        PIC X(10).
   664             20  PI-ACCT-EXP-DT           PIC XX.
   665             20  PI-ACCT-REST-OF-EXP      PIC X(4).
   666         16  PI-ACCT-ID                 PIC X(8).
   667         16  PI-PLAN-KEY.
   668             20  PI-PLAN-ACCT-KEY.
   669                 24  PI-PLAN-COMPANY-CD PIC X.
   670                 24  PI-PLAN-CARRIER    PIC X.
   671                 24  PI-PLAN-GROUP      PIC X(6).
   672                 24  PI-PLAN-STATE      PIC X(2).
   673                 24  PI-PLAN-ACCOUNT    PIC X(10).
   674             20  PI-PLAN-BEN-TYPE       PIC X.
   675             20  PI-PLAN-BEN            PIC XX.
   676             20  PI-PLAN-REVISION       PIC X(3).
   677         16  PI-WS-STATE                PIC XX.
   678         16  PI-WS-CLASS                PIC XX.
   679         16  PI-WS-DEV                  PIC X(3).
   680         16  PI-WS-TYPE                 PIC X.
   681         16  PI-WS-PLAN                 PIC XX.
   682
   683         16  PI-ERPNDB-ALT-KEY.
   684             20  PI-PB-COMPANY-CD-A1    PIC X.
   685             20  PI-PB-CARRIER          PIC X.
   686             20  PI-PB-GROUPING         PIC X(6).
   687             20  PI-PB-STATE            PIC XX.
   688             20  PI-PB-ACCOUNT          PIC X(10).
   689             20  PI-PB-CERT-EFF-DT      PIC XX.
   690             20  PI-PB-CERT-NO          PIC X(10).
   691             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
   692             20  PI-PB-RECORD-TYPE      PIC X.
   693
   694         16  PI-DATE-RANGE-TABLE.
   695             20  PI-TABLE-ENT OCCURS 32 TIMES
   696                            INDEXED BY T-INDEX.
   697                 24  PI-BIN-EFF-DT          PIC XX.
   698                 24  PI-BIN-EXP-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6509.cbl
   699                 24  PI-BIN-MAINT-DT        PIC XX.
   700                 24  PI-BIN-LO-CERT         PIC XX.
   701                 24  PI-BIN-AR-HI-CERT      PIC XX.
   702                 24  PI-BIN-HI-CERT         PIC XX.
   703         16  PI-PAGE-NUMBER             PIC S9.
   704             88  PI-FST-PAGE               VALUE +1.
   705             88  PI-2ND-PAGE               VALUE +2.
   706             88  PI-3RD-PAGE               VALUE +3.
   707             88  PI-LST-PAGE               VALUE +4.
   708         16  PI-TOTAL-LINES             PIC S99.
   709         16  PI-LINE-SELECTED    PIC S9.
   710***  Y2K PROJ 7744
   711         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
   712         16  BIN-EFFCHG-SAVE     PIC XX.
   713         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
   714***  Y2K PROJ 7744
   715         16  BIN-EXPCHG-SAVE     PIC XX.
   716         16  PI-RECORD-ADDED-SW  PIC X.
   717             88  PI-RECORD-ADDED            VALUE '1'.
   718             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
   719         16  PI-ACCNAME          PIC X(30).
   720         16  PI-COMM-POINTER     PIC S9(8)   COMP.
   721         16  PI-SV-MAINT         PIC X.
   722         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
   723         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
   724         16  PI-UPDATE-SW        PIC X.
   725             88  PI-CHANGES-MADE             VALUE '1'.
   726         16  PI-NOTE-TYPE        PIC X.
   727             88  PI-ACCT-NOTE                VALUE '1'.
   728         16  PI-DMD-FILE-SW      PIC X.
   729             88  END-OF-FILE                 VALUE 'E'.
   730             88  INTO-NEXT-BENEFITS          VALUE 'I'.
   731             88  FIRST-OCCURS                VALUE 'F'.
   732         16  PI-DMD-OCCURS       PIC S999.
   733         16  PI-DMD-SCREEN       PIC X.
   734             88  SCREEN-1-DISPLAYED  VALUE '1'.
   735             88  SCREEN-2-DISPLAYED  VALUE '2'.
   736             88  SCREEN-3-DISPLAYED  VALUE '3'.
   737         16  PI-NAMEFLG          PIC X.
   738         16  PI-EL650-DEL-SW     PIC X.
   739         16  FILLER              PIC X(41).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6509.cbl
   742*                          COPY ELCATTR.
   743******************************************************************
   744*                                                                *
   745*                            ELCATTR.                            *
   746*                            VMOD=2.001                          *
   747*                                                                *
   748*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   749*                                                                *
   750*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   751*                                                                *
   752*                   POS 1   P=PROTECTED                          *
   753*                           U=UNPROTECTED                        *
   754*                           S=ASKIP                              *
   755*                   POS 2   A=ALPHA/NUMERIC                      *
   756*                           N=NUMERIC                            *
   757*                   POS 3   N=NORMAL                             *
   758*                           B=BRIGHT                             *
   759*                           D=DARK                               *
   760*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   761*                           OF=MODIFIED DATA TAG OFF             *
   762*                                                                *
   763*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   764******************************************************************
   765 01  ATTRIBUTE-LIST.
   766     12  AL-PABOF            PIC X       VALUE 'Y'.
   767     12  AL-PABON            PIC X       VALUE 'Z'.
   768     12  AL-PADOF            PIC X       VALUE '%'.
   769     12  AL-PADON            PIC X       VALUE '_'.
   770     12  AL-PANOF            PIC X       VALUE '-'.
   771     12  AL-PANON            PIC X       VALUE '/'.
   772     12  AL-SABOF            PIC X       VALUE '8'.
   773     12  AL-SABON            PIC X       VALUE '9'.
   774     12  AL-SADOF            PIC X       VALUE '@'.
   775     12  AL-SADON            PIC X       VALUE QUOTE.
   776     12  AL-SANOF            PIC X       VALUE '0'.
   777     12  AL-SANON            PIC X       VALUE '1'.
   778     12  AL-UABOF            PIC X       VALUE 'H'.
   779     12  AL-UABON            PIC X       VALUE 'I'.
   780     12  AL-UADOF            PIC X       VALUE '<'.
   781     12  AL-UADON            PIC X       VALUE '('.
   782     12  AL-UANOF            PIC X       VALUE ' '.
   783     12  AL-UANON            PIC X       VALUE 'A'.
   784     12  AL-UNBOF            PIC X       VALUE 'Q'.
   785     12  AL-UNBON            PIC X       VALUE 'R'.
   786     12  AL-UNDOF            PIC X       VALUE '*'.
   787     12  AL-UNDON            PIC X       VALUE ')'.
   788     12  AL-UNNOF            PIC X       VALUE '&'.
   789     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6509.cbl
   791*                          COPY ELCDATE.
   792******************************************************************
   793*                                                                *
   794*                                                                *
   795*                            ELCDATE.                            *
   796*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   797*                            VMOD=2.003
   798*                                                                *
   799*                                                                *
   800*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   801*                 LENGTH = 200                                   *
   802******************************************************************
   803
   804 01  DATE-CONVERSION-DATA.
   805     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   806     12  DC-OPTION-CODE                PIC X.
   807         88  BIN-TO-GREG                VALUE ' '.
   808         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   809         88  EDIT-GREG-TO-BIN           VALUE '2'.
   810         88  YMD-GREG-TO-BIN            VALUE '3'.
   811         88  MDY-GREG-TO-BIN            VALUE '4'.
   812         88  JULIAN-TO-BIN              VALUE '5'.
   813         88  BIN-PLUS-ELAPSED           VALUE '6'.
   814         88  FIND-CENTURY               VALUE '7'.
   815         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   816         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   817         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   818         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   819         88  JULIAN-TO-BIN-3            VALUE 'C'.
   820         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   821         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   822         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   823         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   824         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   825         88  CHECK-LEAP-YEAR            VALUE 'H'.
   826         88  BIN-3-TO-GREG              VALUE 'I'.
   827         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   828         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   829         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   830         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   831         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   832         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   833         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   834         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   835         88  THREE-CHARACTER-BIN
   836                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   837         88  GREGORIAN-TO-BIN
   838                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   839         88  BIN-TO-GREGORIAN
   840                  VALUES ' ' '1' 'I' '8' 'G'.
   841         88  JULIAN-TO-BINARY
   842                  VALUES '5' 'C' 'E' 'F'.
   843     12  DC-ERROR-CODE                 PIC X.
   844         88  NO-CONVERSION-ERROR        VALUE ' '.
   845         88  DATE-CONVERSION-ERROR
   846                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   847         88  DATE-IS-ZERO               VALUE '1'.
   848         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6509.cbl
   849         88  DATE-IS-INVALID            VALUE '3'.
   850         88  DATE1-GREATER-DATE2        VALUE '4'.
   851         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   852         88  DATE-INVALID-OPTION        VALUE '9'.
   853         88  INVALID-CENTURY            VALUE 'A'.
   854         88  ONLY-CENTURY               VALUE 'B'.
   855         88  ONLY-LEAP-YEAR             VALUE 'C'.
   856         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   857     12  DC-END-OF-MONTH               PIC X.
   858         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   859     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   860         88  USE-NORMAL-PROCESS         VALUE ' '.
   861         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   862         88  ADJUST-UP-100-YRS          VALUE '2'.
   863     12  FILLER                        PIC X.
   864     12  DC-CONVERSION-DATES.
   865         16  DC-BIN-DATE-1             PIC XX.
   866         16  DC-BIN-DATE-2             PIC XX.
   867         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   868         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   869                       DC-GREG-DATE-1-EDIT.
   870             20  DC-EDIT1-MONTH        PIC 99.
   871             20  SLASH1-1              PIC X.
   872             20  DC-EDIT1-DAY          PIC 99.
   873             20  SLASH1-2              PIC X.
   874             20  DC-EDIT1-YEAR         PIC 99.
   875         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   876         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   877                     DC-GREG-DATE-2-EDIT.
   878             20  DC-EDIT2-MONTH        PIC 99.
   879             20  SLASH2-1              PIC X.
   880             20  DC-EDIT2-DAY          PIC 99.
   881             20  SLASH2-2              PIC X.
   882             20  DC-EDIT2-YEAR         PIC 99.
   883         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   884         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   885                     DC-GREG-DATE-1-YMD.
   886             20  DC-YMD-YEAR           PIC 99.
   887             20  DC-YMD-MONTH          PIC 99.
   888             20  DC-YMD-DAY            PIC 99.
   889         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   890         16  DC-GREG-DATE-1-MDY-R REDEFINES
   891                      DC-GREG-DATE-1-MDY.
   892             20  DC-MDY-MONTH          PIC 99.
   893             20  DC-MDY-DAY            PIC 99.
   894             20  DC-MDY-YEAR           PIC 99.
   895         16  DC-GREG-DATE-1-ALPHA.
   896             20  DC-ALPHA-MONTH        PIC X(10).
   897             20  DC-ALPHA-DAY          PIC 99.
   898             20  FILLER                PIC XX.
   899             20  DC-ALPHA-CENTURY.
   900                 24 DC-ALPHA-CEN-N     PIC 99.
   901             20  DC-ALPHA-YEAR         PIC 99.
   902         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   903         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   904         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   905         16  DC-JULIAN-DATE            PIC 9(05).
   906         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6509.cbl
   907                                       PIC 9(05).
   908         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   909             20  DC-JULIAN-YEAR        PIC 99.
   910             20  DC-JULIAN-DAYS        PIC 999.
   911         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   912         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   913         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   914     12  DATE-CONVERSION-VARIBLES.
   915         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   916         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   917             20  FILLER                PIC 9(3).
   918             20  HOLD-CEN-1-CCYY.
   919                 24  HOLD-CEN-1-CC     PIC 99.
   920                 24  HOLD-CEN-1-YY     PIC 99.
   921             20  HOLD-CEN-1-MO         PIC 99.
   922             20  HOLD-CEN-1-DA         PIC 99.
   923         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   924             20  HOLD-CEN-1-R-MO       PIC 99.
   925             20  HOLD-CEN-1-R-DA       PIC 99.
   926             20  HOLD-CEN-1-R-CCYY.
   927                 24  HOLD-CEN-1-R-CC   PIC 99.
   928                 24  HOLD-CEN-1-R-YY   PIC 99.
   929             20  FILLER                PIC 9(3).
   930         16  HOLD-CENTURY-1-X.
   931             20  FILLER                PIC X(3)  VALUE SPACES.
   932             20  HOLD-CEN-1-X-CCYY.
   933                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   934                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   935             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   936             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   937         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   938             20  HOLD-CEN-1-R-X-MO     PIC XX.
   939             20  HOLD-CEN-1-R-X-DA     PIC XX.
   940             20  HOLD-CEN-1-R-X-CCYY.
   941                 24  HOLD-CEN-1-R-X-CC PIC XX.
   942                 24  HOLD-CEN-1-R-X-YY PIC XX.
   943             20  FILLER                PIC XXX.
   944         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   945         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   946         16  DC-JULIAN-DATE-1          PIC 9(07).
   947         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   948             20  DC-JULIAN-1-CCYY.
   949                 24  DC-JULIAN-1-CC    PIC 99.
   950                 24  DC-JULIAN-1-YR    PIC 99.
   951             20  DC-JULIAN-DA-1        PIC 999.
   952         16  DC-JULIAN-DATE-2          PIC 9(07).
   953         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   954             20  DC-JULIAN-2-CCYY.
   955                 24  DC-JULIAN-2-CC    PIC 99.
   956                 24  DC-JULIAN-2-YR    PIC 99.
   957             20  DC-JULIAN-DA-2        PIC 999.
   958         16  DC-GREG-DATE-A-EDIT.
   959             20  DC-EDITA-MONTH        PIC 99.
   960             20  SLASHA-1              PIC X VALUE '/'.
   961             20  DC-EDITA-DAY          PIC 99.
   962             20  SLASHA-2              PIC X VALUE '/'.
   963             20  DC-EDITA-CCYY.
   964                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6509.cbl
   965                 24  DC-EDITA-YEAR     PIC 99.
   966         16  DC-GREG-DATE-B-EDIT.
   967             20  DC-EDITB-MONTH        PIC 99.
   968             20  SLASHB-1              PIC X VALUE '/'.
   969             20  DC-EDITB-DAY          PIC 99.
   970             20  SLASHB-2              PIC X VALUE '/'.
   971             20  DC-EDITB-CCYY.
   972                 24  DC-EDITB-CENT     PIC 99.
   973                 24  DC-EDITB-YEAR     PIC 99.
   974         16  DC-GREG-DATE-CYMD         PIC 9(08).
   975         16  DC-GREG-DATE-CYMD-R REDEFINES
   976                              DC-GREG-DATE-CYMD.
   977             20  DC-CYMD-CEN           PIC 99.
   978             20  DC-CYMD-YEAR          PIC 99.
   979             20  DC-CYMD-MONTH         PIC 99.
   980             20  DC-CYMD-DAY           PIC 99.
   981         16  DC-GREG-DATE-MDCY         PIC 9(08).
   982         16  DC-GREG-DATE-MDCY-R REDEFINES
   983                              DC-GREG-DATE-MDCY.
   984             20  DC-MDCY-MONTH         PIC 99.
   985             20  DC-MDCY-DAY           PIC 99.
   986             20  DC-MDCY-CEN           PIC 99.
   987             20  DC-MDCY-YEAR          PIC 99.
   988    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   989        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   990    12  DC-EL310-DATE                  PIC X(21).
   991    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6509.cbl
   993*                          COPY EL6509S.
   994 01  EL6509AI.
   995     05  FILLER            PIC  X(0012).
   996*    -------------------------------
   997     05  DATEL PIC S9(0004) COMP.
   998     05  DATEF PIC  X(0001).
   999     05  FILLER REDEFINES DATEF.
  1000         10  DATEA PIC  X(0001).
  1001     05  DATEI PIC  X(0008).
  1002*    -------------------------------
  1003     05  TIMEL PIC S9(0004) COMP.
  1004     05  TIMEF PIC  X(0001).
  1005     05  FILLER REDEFINES TIMEF.
  1006         10  TIMEA PIC  X(0001).
  1007     05  TIMEI PIC  X(0005).
  1008*    -------------------------------
  1009     05  CMPNYIDL PIC S9(0004) COMP.
  1010     05  CMPNYIDF PIC  X(0001).
  1011     05  FILLER REDEFINES CMPNYIDF.
  1012         10  CMPNYIDA PIC  X(0001).
  1013     05  CMPNYIDI PIC  X(0003).
  1014*    -------------------------------
  1015     05  USERIDL PIC S9(0004) COMP.
  1016     05  USERIDF PIC  X(0001).
  1017     05  FILLER REDEFINES USERIDF.
  1018         10  USERIDA PIC  X(0001).
  1019     05  USERIDI PIC  X(0004).
  1020*    -------------------------------
  1021     05  CARRL PIC S9(0004) COMP.
  1022     05  CARRF PIC  X(0001).
  1023     05  FILLER REDEFINES CARRF.
  1024         10  CARRA PIC  X(0001).
  1025     05  CARRI PIC  X(0001).
  1026*    -------------------------------
  1027     05  GROUPL PIC S9(0004) COMP.
  1028     05  GROUPF PIC  X(0001).
  1029     05  FILLER REDEFINES GROUPF.
  1030         10  GROUPA PIC  X(0001).
  1031     05  GROUPI PIC  X(0006).
  1032*    -------------------------------
  1033     05  STATEL PIC S9(0004) COMP.
  1034     05  STATEF PIC  X(0001).
  1035     05  FILLER REDEFINES STATEF.
  1036         10  STATEA PIC  X(0001).
  1037     05  STATEI PIC  X(0002).
  1038*    -------------------------------
  1039     05  ACCTL PIC S9(0004) COMP.
  1040     05  ACCTF PIC  X(0001).
  1041     05  FILLER REDEFINES ACCTF.
  1042         10  ACCTA PIC  X(0001).
  1043     05  ACCTI PIC  X(0010).
  1044*    -------------------------------
  1045     05  NAMEL PIC S9(0004) COMP.
  1046     05  NAMEF PIC  X(0001).
  1047     05  FILLER REDEFINES NAMEF.
  1048         10  NAMEA PIC  X(0001).
  1049     05  NAMEI PIC  X(0030).
  1050*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6509.cbl
  1051     05  TOTL PIC S9(0004) COMP.
  1052     05  TOTF PIC  X(0001).
  1053     05  FILLER REDEFINES TOTF.
  1054         10  TOTA PIC  X(0001).
  1055     05  TOTI PIC  999.
  1056*    -------------------------------
  1057     05  L1L PIC S9(0004) COMP.
  1058     05  L1F PIC  X(0001).
  1059     05  FILLER REDEFINES L1F.
  1060         10  L1A PIC  X(0001).
  1061     05  L1I PIC  X(0003).
  1062*    -------------------------------
  1063     05  TEXT1L PIC S9(0004) COMP.
  1064     05  TEXT1F PIC  X(0001).
  1065     05  FILLER REDEFINES TEXT1F.
  1066         10  TEXT1A PIC  X(0001).
  1067     05  TEXT1I PIC  X(0060).
  1068*    -------------------------------
  1069     05  MTBY1L PIC S9(0004) COMP.
  1070     05  MTBY1F PIC  X(0001).
  1071     05  FILLER REDEFINES MTBY1F.
  1072         10  MTBY1A PIC  X(0001).
  1073     05  MTBY1I PIC  X(0004).
  1074*    -------------------------------
  1075     05  MTDT1L PIC S9(0004) COMP.
  1076     05  MTDT1F PIC  X(0001).
  1077     05  FILLER REDEFINES MTDT1F.
  1078         10  MTDT1A PIC  X(0001).
  1079     05  MTDT1I PIC  X(0006).
  1080*    -------------------------------
  1081     05  L2L PIC S9(0004) COMP.
  1082     05  L2F PIC  X(0001).
  1083     05  FILLER REDEFINES L2F.
  1084         10  L2A PIC  X(0001).
  1085     05  L2I PIC  X(0003).
  1086*    -------------------------------
  1087     05  TEXT2L PIC S9(0004) COMP.
  1088     05  TEXT2F PIC  X(0001).
  1089     05  FILLER REDEFINES TEXT2F.
  1090         10  TEXT2A PIC  X(0001).
  1091     05  TEXT2I PIC  X(0060).
  1092*    -------------------------------
  1093     05  MTBY2L PIC S9(0004) COMP.
  1094     05  MTBY2F PIC  X(0001).
  1095     05  FILLER REDEFINES MTBY2F.
  1096         10  MTBY2A PIC  X(0001).
  1097     05  MTBY2I PIC  X(0004).
  1098*    -------------------------------
  1099     05  MTDT2L PIC S9(0004) COMP.
  1100     05  MTDT2F PIC  X(0001).
  1101     05  FILLER REDEFINES MTDT2F.
  1102         10  MTDT2A PIC  X(0001).
  1103     05  MTDT2I PIC  X(0006).
  1104*    -------------------------------
  1105     05  L3L PIC S9(0004) COMP.
  1106     05  L3F PIC  X(0001).
  1107     05  FILLER REDEFINES L3F.
  1108         10  L3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6509.cbl
  1109     05  L3I PIC  X(0003).
  1110*    -------------------------------
  1111     05  TEXT3L PIC S9(0004) COMP.
  1112     05  TEXT3F PIC  X(0001).
  1113     05  FILLER REDEFINES TEXT3F.
  1114         10  TEXT3A PIC  X(0001).
  1115     05  TEXT3I PIC  X(0060).
  1116*    -------------------------------
  1117     05  MTBY3L PIC S9(0004) COMP.
  1118     05  MTBY3F PIC  X(0001).
  1119     05  FILLER REDEFINES MTBY3F.
  1120         10  MTBY3A PIC  X(0001).
  1121     05  MTBY3I PIC  X(0004).
  1122*    -------------------------------
  1123     05  MTDT3L PIC S9(0004) COMP.
  1124     05  MTDT3F PIC  X(0001).
  1125     05  FILLER REDEFINES MTDT3F.
  1126         10  MTDT3A PIC  X(0001).
  1127     05  MTDT3I PIC  X(0006).
  1128*    -------------------------------
  1129     05  L4L PIC S9(0004) COMP.
  1130     05  L4F PIC  X(0001).
  1131     05  FILLER REDEFINES L4F.
  1132         10  L4A PIC  X(0001).
  1133     05  L4I PIC  X(0003).
  1134*    -------------------------------
  1135     05  TEXT4L PIC S9(0004) COMP.
  1136     05  TEXT4F PIC  X(0001).
  1137     05  FILLER REDEFINES TEXT4F.
  1138         10  TEXT4A PIC  X(0001).
  1139     05  TEXT4I PIC  X(0060).
  1140*    -------------------------------
  1141     05  MTBY4L PIC S9(0004) COMP.
  1142     05  MTBY4F PIC  X(0001).
  1143     05  FILLER REDEFINES MTBY4F.
  1144         10  MTBY4A PIC  X(0001).
  1145     05  MTBY4I PIC  X(0004).
  1146*    -------------------------------
  1147     05  MTDT4L PIC S9(0004) COMP.
  1148     05  MTDT4F PIC  X(0001).
  1149     05  FILLER REDEFINES MTDT4F.
  1150         10  MTDT4A PIC  X(0001).
  1151     05  MTDT4I PIC  X(0006).
  1152*    -------------------------------
  1153     05  L5L PIC S9(0004) COMP.
  1154     05  L5F PIC  X(0001).
  1155     05  FILLER REDEFINES L5F.
  1156         10  L5A PIC  X(0001).
  1157     05  L5I PIC  X(0003).
  1158*    -------------------------------
  1159     05  TEXT5L PIC S9(0004) COMP.
  1160     05  TEXT5F PIC  X(0001).
  1161     05  FILLER REDEFINES TEXT5F.
  1162         10  TEXT5A PIC  X(0001).
  1163     05  TEXT5I PIC  X(0060).
  1164*    -------------------------------
  1165     05  MTBY5L PIC S9(0004) COMP.
  1166     05  MTBY5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6509.cbl
  1167     05  FILLER REDEFINES MTBY5F.
  1168         10  MTBY5A PIC  X(0001).
  1169     05  MTBY5I PIC  X(0004).
  1170*    -------------------------------
  1171     05  MTDT5L PIC S9(0004) COMP.
  1172     05  MTDT5F PIC  X(0001).
  1173     05  FILLER REDEFINES MTDT5F.
  1174         10  MTDT5A PIC  X(0001).
  1175     05  MTDT5I PIC  X(0006).
  1176*    -------------------------------
  1177     05  L6L PIC S9(0004) COMP.
  1178     05  L6F PIC  X(0001).
  1179     05  FILLER REDEFINES L6F.
  1180         10  L6A PIC  X(0001).
  1181     05  L6I PIC  X(0003).
  1182*    -------------------------------
  1183     05  TEXT6L PIC S9(0004) COMP.
  1184     05  TEXT6F PIC  X(0001).
  1185     05  FILLER REDEFINES TEXT6F.
  1186         10  TEXT6A PIC  X(0001).
  1187     05  TEXT6I PIC  X(0060).
  1188*    -------------------------------
  1189     05  MTBY6L PIC S9(0004) COMP.
  1190     05  MTBY6F PIC  X(0001).
  1191     05  FILLER REDEFINES MTBY6F.
  1192         10  MTBY6A PIC  X(0001).
  1193     05  MTBY6I PIC  X(0004).
  1194*    -------------------------------
  1195     05  MTDT6L PIC S9(0004) COMP.
  1196     05  MTDT6F PIC  X(0001).
  1197     05  FILLER REDEFINES MTDT6F.
  1198         10  MTDT6A PIC  X(0001).
  1199     05  MTDT6I PIC  X(0006).
  1200*    -------------------------------
  1201     05  L7L PIC S9(0004) COMP.
  1202     05  L7F PIC  X(0001).
  1203     05  FILLER REDEFINES L7F.
  1204         10  L7A PIC  X(0001).
  1205     05  L7I PIC  X(0003).
  1206*    -------------------------------
  1207     05  TEXT7L PIC S9(0004) COMP.
  1208     05  TEXT7F PIC  X(0001).
  1209     05  FILLER REDEFINES TEXT7F.
  1210         10  TEXT7A PIC  X(0001).
  1211     05  TEXT7I PIC  X(0060).
  1212*    -------------------------------
  1213     05  MTBY7L PIC S9(0004) COMP.
  1214     05  MTBY7F PIC  X(0001).
  1215     05  FILLER REDEFINES MTBY7F.
  1216         10  MTBY7A PIC  X(0001).
  1217     05  MTBY7I PIC  X(0004).
  1218*    -------------------------------
  1219     05  MTDT7L PIC S9(0004) COMP.
  1220     05  MTDT7F PIC  X(0001).
  1221     05  FILLER REDEFINES MTDT7F.
  1222         10  MTDT7A PIC  X(0001).
  1223     05  MTDT7I PIC  X(0006).
  1224*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6509.cbl
  1225     05  L8L PIC S9(0004) COMP.
  1226     05  L8F PIC  X(0001).
  1227     05  FILLER REDEFINES L8F.
  1228         10  L8A PIC  X(0001).
  1229     05  L8I PIC  X(0003).
  1230*    -------------------------------
  1231     05  TEXT8L PIC S9(0004) COMP.
  1232     05  TEXT8F PIC  X(0001).
  1233     05  FILLER REDEFINES TEXT8F.
  1234         10  TEXT8A PIC  X(0001).
  1235     05  TEXT8I PIC  X(0060).
  1236*    -------------------------------
  1237     05  MTBY8L PIC S9(0004) COMP.
  1238     05  MTBY8F PIC  X(0001).
  1239     05  FILLER REDEFINES MTBY8F.
  1240         10  MTBY8A PIC  X(0001).
  1241     05  MTBY8I PIC  X(0004).
  1242*    -------------------------------
  1243     05  MTDT8L PIC S9(0004) COMP.
  1244     05  MTDT8F PIC  X(0001).
  1245     05  FILLER REDEFINES MTDT8F.
  1246         10  MTDT8A PIC  X(0001).
  1247     05  MTDT8I PIC  X(0006).
  1248*    -------------------------------
  1249     05  L9L PIC S9(0004) COMP.
  1250     05  L9F PIC  X(0001).
  1251     05  FILLER REDEFINES L9F.
  1252         10  L9A PIC  X(0001).
  1253     05  L9I PIC  X(0003).
  1254*    -------------------------------
  1255     05  TEXT9L PIC S9(0004) COMP.
  1256     05  TEXT9F PIC  X(0001).
  1257     05  FILLER REDEFINES TEXT9F.
  1258         10  TEXT9A PIC  X(0001).
  1259     05  TEXT9I PIC  X(0060).
  1260*    -------------------------------
  1261     05  MTBY9L PIC S9(0004) COMP.
  1262     05  MTBY9F PIC  X(0001).
  1263     05  FILLER REDEFINES MTBY9F.
  1264         10  MTBY9A PIC  X(0001).
  1265     05  MTBY9I PIC  X(0004).
  1266*    -------------------------------
  1267     05  MTDT9L PIC S9(0004) COMP.
  1268     05  MTDT9F PIC  X(0001).
  1269     05  FILLER REDEFINES MTDT9F.
  1270         10  MTDT9A PIC  X(0001).
  1271     05  MTDT9I PIC  X(0006).
  1272*    -------------------------------
  1273     05  L10L PIC S9(0004) COMP.
  1274     05  L10F PIC  X(0001).
  1275     05  FILLER REDEFINES L10F.
  1276         10  L10A PIC  X(0001).
  1277     05  L10I PIC  X(0003).
  1278*    -------------------------------
  1279     05  TEXT10L PIC S9(0004) COMP.
  1280     05  TEXT10F PIC  X(0001).
  1281     05  FILLER REDEFINES TEXT10F.
  1282         10  TEXT10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6509.cbl
  1283     05  TEXT10I PIC  X(0060).
  1284*    -------------------------------
  1285     05  MTBY10L PIC S9(0004) COMP.
  1286     05  MTBY10F PIC  X(0001).
  1287     05  FILLER REDEFINES MTBY10F.
  1288         10  MTBY10A PIC  X(0001).
  1289     05  MTBY10I PIC  X(0004).
  1290*    -------------------------------
  1291     05  MTDT10L PIC S9(0004) COMP.
  1292     05  MTDT10F PIC  X(0001).
  1293     05  FILLER REDEFINES MTDT10F.
  1294         10  MTDT10A PIC  X(0001).
  1295     05  MTDT10I PIC  X(0006).
  1296*    -------------------------------
  1297     05  L11L PIC S9(0004) COMP.
  1298     05  L11F PIC  X(0001).
  1299     05  FILLER REDEFINES L11F.
  1300         10  L11A PIC  X(0001).
  1301     05  L11I PIC  X(0003).
  1302*    -------------------------------
  1303     05  TEXT11L PIC S9(0004) COMP.
  1304     05  TEXT11F PIC  X(0001).
  1305     05  FILLER REDEFINES TEXT11F.
  1306         10  TEXT11A PIC  X(0001).
  1307     05  TEXT11I PIC  X(0060).
  1308*    -------------------------------
  1309     05  MTBY11L PIC S9(0004) COMP.
  1310     05  MTBY11F PIC  X(0001).
  1311     05  FILLER REDEFINES MTBY11F.
  1312         10  MTBY11A PIC  X(0001).
  1313     05  MTBY11I PIC  X(0004).
  1314*    -------------------------------
  1315     05  MTDT11L PIC S9(0004) COMP.
  1316     05  MTDT11F PIC  X(0001).
  1317     05  FILLER REDEFINES MTDT11F.
  1318         10  MTDT11A PIC  X(0001).
  1319     05  MTDT11I PIC  X(0006).
  1320*    -------------------------------
  1321     05  L12L PIC S9(0004) COMP.
  1322     05  L12F PIC  X(0001).
  1323     05  FILLER REDEFINES L12F.
  1324         10  L12A PIC  X(0001).
  1325     05  L12I PIC  X(0003).
  1326*    -------------------------------
  1327     05  TEXT12L PIC S9(0004) COMP.
  1328     05  TEXT12F PIC  X(0001).
  1329     05  FILLER REDEFINES TEXT12F.
  1330         10  TEXT12A PIC  X(0001).
  1331     05  TEXT12I PIC  X(0060).
  1332*    -------------------------------
  1333     05  MTBY12L PIC S9(0004) COMP.
  1334     05  MTBY12F PIC  X(0001).
  1335     05  FILLER REDEFINES MTBY12F.
  1336         10  MTBY12A PIC  X(0001).
  1337     05  MTBY12I PIC  X(0004).
  1338*    -------------------------------
  1339     05  MTDT12L PIC S9(0004) COMP.
  1340     05  MTDT12F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6509.cbl
  1341     05  FILLER REDEFINES MTDT12F.
  1342         10  MTDT12A PIC  X(0001).
  1343     05  MTDT12I PIC  X(0006).
  1344*    -------------------------------
  1345     05  ERRMSGBL PIC S9(0004) COMP.
  1346     05  ERRMSGBF PIC  X(0001).
  1347     05  FILLER REDEFINES ERRMSGBF.
  1348         10  ERRMSGBA PIC  X(0001).
  1349     05  ERRMSGBI PIC  X(0072).
  1350*    -------------------------------
  1351     05  FUNCTL PIC S9(0004) COMP.
  1352     05  FUNCTF PIC  X(0001).
  1353     05  FILLER REDEFINES FUNCTF.
  1354         10  FUNCTA PIC  X(0001).
  1355     05  FUNCTI PIC  X(0001).
  1356*    -------------------------------
  1357     05  LINE1L PIC S9(0004) COMP.
  1358     05  LINE1F PIC  X(0001).
  1359     05  FILLER REDEFINES LINE1F.
  1360         10  LINE1A PIC  X(0001).
  1361     05  LINE1I PIC  999.
  1362*    -------------------------------
  1363     05  LINE2L PIC S9(0004) COMP.
  1364     05  LINE2F PIC  X(0001).
  1365     05  FILLER REDEFINES LINE2F.
  1366         10  LINE2A PIC  X(0001).
  1367     05  LINE2I PIC  999.
  1368*    -------------------------------
  1369     05  PFENTERL PIC S9(0004) COMP.
  1370     05  PFENTERF PIC  X(0001).
  1371     05  FILLER REDEFINES PFENTERF.
  1372         10  PFENTERA PIC  X(0001).
  1373     05  PFENTERI PIC  99.
  1374 01  EL6509AO REDEFINES EL6509AI.
  1375     05  FILLER            PIC  X(0012).
  1376*    -------------------------------
  1377     05  FILLER            PIC  X(0003).
  1378     05  DATEO PIC  X(0008).
  1379*    -------------------------------
  1380     05  FILLER            PIC  X(0003).
  1381     05  TIMEO PIC  99.99.
  1382*    -------------------------------
  1383     05  FILLER            PIC  X(0003).
  1384     05  CMPNYIDO PIC  X(0003).
  1385*    -------------------------------
  1386     05  FILLER            PIC  X(0003).
  1387     05  USERIDO PIC  X(0004).
  1388*    -------------------------------
  1389     05  FILLER            PIC  X(0003).
  1390     05  CARRO PIC  X(0001).
  1391*    -------------------------------
  1392     05  FILLER            PIC  X(0003).
  1393     05  GROUPO PIC  X(0006).
  1394*    -------------------------------
  1395     05  FILLER            PIC  X(0003).
  1396     05  STATEO PIC  X(0002).
  1397*    -------------------------------
  1398     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6509.cbl
  1399     05  ACCTO PIC  X(0010).
  1400*    -------------------------------
  1401     05  FILLER            PIC  X(0003).
  1402     05  NAMEO PIC  X(0030).
  1403*    -------------------------------
  1404     05  FILLER            PIC  X(0003).
  1405     05  TOTO PIC  X(0003).
  1406*    -------------------------------
  1407     05  FILLER            PIC  X(0003).
  1408     05  L1O PIC  X(0003).
  1409*    -------------------------------
  1410     05  FILLER            PIC  X(0003).
  1411     05  TEXT1O PIC  X(0060).
  1412*    -------------------------------
  1413     05  FILLER            PIC  X(0003).
  1414     05  MTBY1O PIC  X(0004).
  1415*    -------------------------------
  1416     05  FILLER            PIC  X(0003).
  1417     05  MTDT1O PIC  X(0006).
  1418*    -------------------------------
  1419     05  FILLER            PIC  X(0003).
  1420     05  L2O PIC  X(0003).
  1421*    -------------------------------
  1422     05  FILLER            PIC  X(0003).
  1423     05  TEXT2O PIC  X(0060).
  1424*    -------------------------------
  1425     05  FILLER            PIC  X(0003).
  1426     05  MTBY2O PIC  X(0004).
  1427*    -------------------------------
  1428     05  FILLER            PIC  X(0003).
  1429     05  MTDT2O PIC  X(0006).
  1430*    -------------------------------
  1431     05  FILLER            PIC  X(0003).
  1432     05  L3O PIC  X(0003).
  1433*    -------------------------------
  1434     05  FILLER            PIC  X(0003).
  1435     05  TEXT3O PIC  X(0060).
  1436*    -------------------------------
  1437     05  FILLER            PIC  X(0003).
  1438     05  MTBY3O PIC  X(0004).
  1439*    -------------------------------
  1440     05  FILLER            PIC  X(0003).
  1441     05  MTDT3O PIC  X(0006).
  1442*    -------------------------------
  1443     05  FILLER            PIC  X(0003).
  1444     05  L4O PIC  X(0003).
  1445*    -------------------------------
  1446     05  FILLER            PIC  X(0003).
  1447     05  TEXT4O PIC  X(0060).
  1448*    -------------------------------
  1449     05  FILLER            PIC  X(0003).
  1450     05  MTBY4O PIC  X(0004).
  1451*    -------------------------------
  1452     05  FILLER            PIC  X(0003).
  1453     05  MTDT4O PIC  X(0006).
  1454*    -------------------------------
  1455     05  FILLER            PIC  X(0003).
  1456     05  L5O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6509.cbl
  1457*    -------------------------------
  1458     05  FILLER            PIC  X(0003).
  1459     05  TEXT5O PIC  X(0060).
  1460*    -------------------------------
  1461     05  FILLER            PIC  X(0003).
  1462     05  MTBY5O PIC  X(0004).
  1463*    -------------------------------
  1464     05  FILLER            PIC  X(0003).
  1465     05  MTDT5O PIC  X(0006).
  1466*    -------------------------------
  1467     05  FILLER            PIC  X(0003).
  1468     05  L6O PIC  X(0003).
  1469*    -------------------------------
  1470     05  FILLER            PIC  X(0003).
  1471     05  TEXT6O PIC  X(0060).
  1472*    -------------------------------
  1473     05  FILLER            PIC  X(0003).
  1474     05  MTBY6O PIC  X(0004).
  1475*    -------------------------------
  1476     05  FILLER            PIC  X(0003).
  1477     05  MTDT6O PIC  X(0006).
  1478*    -------------------------------
  1479     05  FILLER            PIC  X(0003).
  1480     05  L7O PIC  X(0003).
  1481*    -------------------------------
  1482     05  FILLER            PIC  X(0003).
  1483     05  TEXT7O PIC  X(0060).
  1484*    -------------------------------
  1485     05  FILLER            PIC  X(0003).
  1486     05  MTBY7O PIC  X(0004).
  1487*    -------------------------------
  1488     05  FILLER            PIC  X(0003).
  1489     05  MTDT7O PIC  X(0006).
  1490*    -------------------------------
  1491     05  FILLER            PIC  X(0003).
  1492     05  L8O PIC  X(0003).
  1493*    -------------------------------
  1494     05  FILLER            PIC  X(0003).
  1495     05  TEXT8O PIC  X(0060).
  1496*    -------------------------------
  1497     05  FILLER            PIC  X(0003).
  1498     05  MTBY8O PIC  X(0004).
  1499*    -------------------------------
  1500     05  FILLER            PIC  X(0003).
  1501     05  MTDT8O PIC  X(0006).
  1502*    -------------------------------
  1503     05  FILLER            PIC  X(0003).
  1504     05  L9O PIC  X(0003).
  1505*    -------------------------------
  1506     05  FILLER            PIC  X(0003).
  1507     05  TEXT9O PIC  X(0060).
  1508*    -------------------------------
  1509     05  FILLER            PIC  X(0003).
  1510     05  MTBY9O PIC  X(0004).
  1511*    -------------------------------
  1512     05  FILLER            PIC  X(0003).
  1513     05  MTDT9O PIC  X(0006).
  1514*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL6509.cbl
  1515     05  FILLER            PIC  X(0003).
  1516     05  L10O PIC  X(0003).
  1517*    -------------------------------
  1518     05  FILLER            PIC  X(0003).
  1519     05  TEXT10O PIC  X(0060).
  1520*    -------------------------------
  1521     05  FILLER            PIC  X(0003).
  1522     05  MTBY10O PIC  X(0004).
  1523*    -------------------------------
  1524     05  FILLER            PIC  X(0003).
  1525     05  MTDT10O PIC  X(0006).
  1526*    -------------------------------
  1527     05  FILLER            PIC  X(0003).
  1528     05  L11O PIC  X(0003).
  1529*    -------------------------------
  1530     05  FILLER            PIC  X(0003).
  1531     05  TEXT11O PIC  X(0060).
  1532*    -------------------------------
  1533     05  FILLER            PIC  X(0003).
  1534     05  MTBY11O PIC  X(0004).
  1535*    -------------------------------
  1536     05  FILLER            PIC  X(0003).
  1537     05  MTDT11O PIC  X(0006).
  1538*    -------------------------------
  1539     05  FILLER            PIC  X(0003).
  1540     05  L12O PIC  X(0003).
  1541*    -------------------------------
  1542     05  FILLER            PIC  X(0003).
  1543     05  TEXT12O PIC  X(0060).
  1544*    -------------------------------
  1545     05  FILLER            PIC  X(0003).
  1546     05  MTBY12O PIC  X(0004).
  1547*    -------------------------------
  1548     05  FILLER            PIC  X(0003).
  1549     05  MTDT12O PIC  X(0006).
  1550*    -------------------------------
  1551     05  FILLER            PIC  X(0003).
  1552     05  ERRMSGBO PIC  X(0072).
  1553*    -------------------------------
  1554     05  FILLER            PIC  X(0003).
  1555     05  FUNCTO PIC  X(0001).
  1556*    -------------------------------
  1557     05  FILLER            PIC  X(0003).
  1558     05  LINE1O PIC  X(0003).
  1559*    -------------------------------
  1560     05  FILLER            PIC  X(0003).
  1561     05  LINE2O PIC  X(0003).
  1562*    -------------------------------
  1563     05  FILLER            PIC  X(0003).
  1564     05  PFENTERO PIC  X(0002).
  1565*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL6509.cbl
  1567 01  EL6509R REDEFINES EL6509AI.
  1568     12  FILLER                  PIC X(114).
  1569     12  SC-ALL-LINES.
  1570      14 SC-LINES OCCURS 12 TIMES INDEXED BY SC-INDX.
  1571         16  SC-LINL             PIC S9(4)   COMP.
  1572         16  SC-LINA             PIC X.
  1573         16  SC-LIN              PIC Z99.
  1574         16  SC-TEXTL            PIC S9(4)   COMP.
  1575         16  SC-TEXTA            PIC X.
  1576         16  SC-TEXT             PIC X(60).
  1577         16  SC-MAINT-BYL        PIC S9(4)   COMP.
  1578         16  SC-MAINT-BYA        PIC X.
  1579         16  SC-MAINT-BY         PIC XXXX.
  1580         16  SC-MAINT-DTL        PIC S9(4)   COMP.
  1581         16  SC-MAINT-DTA        PIC X.
  1582         16  SC-MAINT-DT         PIC X(6).
  1583     12  FILLER                  PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL6509.cbl
  1585 01  RECORD-TABLE                PIC X(21600) VALUE SPACES.
  1586 01  REC-TABLE  REDEFINES RECORD-TABLE.
  1587     12  TS-GROUP OCCURS 6 TIMES INDEXED BY TS-INDX PIC X(3600).
  1588 01  REC-ENTRIES REDEFINES RECORD-TABLE.
  1589     12  REC-ENT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
  1590         16  REC-TEXT                    PIC X(60).
  1591         16  REC-LAST-MAINT-BY           PIC XXXX.
  1592         16  REC-LAST-MAINT-DT           PIC XX.
  1593         16  REC-LAST-MAINT-HHMMSS       PIC S9(7) COMP-3.
  1594         16  REC-PC                      PIC X(2).
  1595
  1596 01  TS-WORK-AREA                        PIC X(3600).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL6509.cbl
  1598
  1599****************************************************************
  1600*
  1601* Copyright (c) 2007 by Clerity Solutions, Inc.
  1602* All rights reserved.
  1603*
  1604****************************************************************
  1605 01  DFHEIV.
  1606   02  DFHEIV0               PIC X(35).
  1607   02  DFHEIV1               PIC X(08).
  1608   02  DFHEIV2               PIC X(08).
  1609   02  DFHEIV3               PIC X(08).
  1610   02  DFHEIV4               PIC X(06).
  1611   02  DFHEIV5               PIC X(04).
  1612   02  DFHEIV6               PIC X(04).
  1613   02  DFHEIV7               PIC X(02).
  1614   02  DFHEIV8               PIC X(02).
  1615   02  DFHEIV9               PIC X(01).
  1616   02  DFHEIV10              PIC S9(7) COMP-3.
  1617   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1618   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1619   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1620   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1621   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1622   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1623   02  DFHEIV17              PIC X(04).
  1624   02  DFHEIV18              PIC X(04).
  1625   02  DFHEIV19              PIC X(04).
  1626   02  DFHEIV20              USAGE IS POINTER.
  1627   02  DFHEIV21              USAGE IS POINTER.
  1628   02  DFHEIV22              USAGE IS POINTER.
  1629   02  DFHEIV23              USAGE IS POINTER.
  1630   02  DFHEIV24              USAGE IS POINTER.
  1631   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1632   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1633   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1634   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1635   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1636   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1637   02  FILLER                PIC X(02).
  1638   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1639   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1640   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1641   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1642   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1643 LINKAGE  SECTION.
  1644*****************************************************************
  1645*                                                               *
  1646* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1647* All rights reserved.                                          *
  1648*                                                               *
  1649*****************************************************************
  1650 01  dfheiblk.
  1651     02  eibtime          pic s9(7) comp-3.
  1652     02  eibdate          pic s9(7) comp-3.
  1653     02  eibtrnid         pic x(4).
  1654     02  eibtaskn         pic s9(7) comp-3.
  1655     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL6509.cbl
  1656     02  dfheigdi         pic s9(4) comp.
  1657     02  eibcposn         pic s9(4) comp.
  1658     02  eibcalen         pic s9(4) comp.
  1659     02  eibaid           pic x(1).
  1660     02  eibfiller1       pic x(1).
  1661     02  eibfn            pic x(2).
  1662     02  eibfiller2       pic x(2).
  1663     02  eibrcode         pic x(6).
  1664     02  eibfiller3       pic x(2).
  1665     02  eibds            pic x(8).
  1666     02  eibreqid         pic x(8).
  1667     02  eibrsrce         pic x(8).
  1668     02  eibsync          pic x(1).
  1669     02  eibfree          pic x(1).
  1670     02  eibrecv          pic x(1).
  1671     02  eibsend          pic x(1).
  1672     02  eibatt           pic x(1).
  1673     02  eibeoc           pic x(1).
  1674     02  eibfmh           pic x(1).
  1675     02  eibcompl         pic x(1).
  1676     02  eibsig           pic x(1).
  1677     02  eibconf          pic x(1).
  1678     02  eiberr           pic x(1).
  1679     02  eibrldbk         pic x(1).
  1680     02  eiberrcd         pic x(4).
  1681     02  eibsynrb         pic x(1).
  1682     02  eibnodat         pic x(1).
  1683     02  eibfiller5       pic x(2).
  1684     02  eibresp          pic 9(09) comp.
  1685     02  eibresp2         pic 9(09) comp.
  1686     02  dfheigdj         pic s9(4) comp.
  1687     02  dfheigdk         pic s9(4) comp.
  1688 01  DFHCOMMAREA                 PIC X(1500).
  1689
  1690*         COPY ERCACNT.
  1691******************************************************************
  1692*                                                                *
  1693*                                                                *
  1694*                            ERCACNT.                            *
  1695*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1696*                            VMOD=2.002                          *
  1697*                                                                *
  1698*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  1699*                                                                *
  1700*   FILE TYPE = VSAM,KSDS                                        *
  1701*   RECORD SIZE = 120   RECFORM = FIXED                          *
  1702*                                                                *
  1703*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  1704*       ALTERNATE INDEX = NONE                                   *
  1705*                                                                *
  1706*                                                                *
  1707*   LOG = YES                                                    *
  1708*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1709******************************************************************
  1710*                   C H A N G E   L O G
  1711*
  1712* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1713*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL6509.cbl
  1714*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1715* EFFECTIVE    NUMBER
  1716*-----------------------------------------------------------------
  1717* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  1718*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  1719******************************************************************
  1720 01  NOTE-FILE.
  1721     12  NT-FILE-ID                  PIC XX.
  1722         88  VALID-NOTE-ID              VALUE 'NT'.
  1723
  1724     12  NT-CONTROL-PRIMARY.
  1725         16  NT-COMPANY-CD           PIC X.
  1726         16  NT-ACCT-NOTE-KEY.
  1727             18  NT-CARRIER              PIC X.
  1728             18  NT-GROUPING             PIC X(06).
  1729             18  NT-STATE                PIC XX.
  1730             18  NT-ACCOUNT              PIC X(10).
  1731         16  NT-RECORD-TYPE          PIC X.
  1732              88  ACCT-NOTE          VALUE '1'.
  1733              88  ACCT-BRANCH-LOC    VALUE '2'.
  1734              88  ACCT-SHIPPING-ADDR VALUE '3'.
  1735         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  1736
  1737     12  NT-LAST-MAINT-DT            PIC XX.
  1738     12  NT-LAST-MAINT-BY            PIC X(4).
  1739     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  1740
  1741*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  1742*     SEQUENCE NUMBERS
  1743     12  NT-NOTE-INFORMATION.
  1744         16  NT-NOTE-LINE            PIC X(60).
  1745         16  FILLER                  PIC X(25).
  1746*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  1747     12  NT-LOCATION-INFORMATION REDEFINES
  1748                         NT-NOTE-INFORMATION.
  1749         16  NT-BRANCH-LOC-LINE      PIC X(60).
  1750         16  FILLER                  PIC X(25).
  1751*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  1752*     SEQUENCE NUMBER 1 IS NAME LINE 1
  1753*     SEQUENCE NUMBER 2 IS NAME LINE 2
  1754*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  1755*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  1756*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  1757*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  1758     12  NT-SHIPPING-INFORMATION REDEFINES
  1759                         NT-NOTE-INFORMATION.
  1760         16  NT-SHIPPING-LINE        PIC X(60).
  1761         16  NT-SHIP-STATE           PIC XX.
  1762         16  NT-SHIP-ZIP             PIC X(10).
  1763         16  FILLER                  PIC X(13).
  1764*****************************************************************
  1765*         COPY ELCCNTL.
  1766******************************************************************
  1767*                                                                *
  1768*                                                                *
  1769*                            ELCCNTL.                            *
  1770*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1771*                            VMOD=2.059                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL6509.cbl
  1772*                                                                *
  1773*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1774*                                                                *
  1775*   FILE TYPE = VSAM,KSDS                                        *
  1776*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1777*                                                                *
  1778*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1779*       ALTERNATE INDEX = NONE                                   *
  1780*                                                                *
  1781*   LOG = YES                                                    *
  1782*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1783******************************************************************
  1784*                   C H A N G E   L O G
  1785*
  1786* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1787*-----------------------------------------------------------------
  1788*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1789* EFFECTIVE    NUMBER
  1790*-----------------------------------------------------------------
  1791* 082503                   PEMA  ADD BENEFIT GROUP
  1792* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1793* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1794* 092705    2005050300006  PEMA  ADD SPP LEASES
  1795* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1796* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1797* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1798* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1799******************************************************************
  1800*
  1801 01  CONTROL-FILE.
  1802     12  CF-RECORD-ID                       PIC XX.
  1803         88  VALID-CF-ID                        VALUE 'CF'.
  1804
  1805     12  CF-CONTROL-PRIMARY.
  1806         16  CF-COMPANY-ID                  PIC XXX.
  1807         16  CF-RECORD-TYPE                 PIC X.
  1808             88  CF-COMPANY-MASTER              VALUE '1'.
  1809             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1810             88  CF-STATE-MASTER                VALUE '3'.
  1811             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1812             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1813             88  CF-CARRIER-MASTER              VALUE '6'.
  1814             88  CF-MORTALITY-MASTER            VALUE '7'.
  1815             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1816             88  CF-TERMINAL-MASTER             VALUE '9'.
  1817             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1818             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1819             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1820             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1821             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1822             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1823             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1824             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1825             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1826         16  CF-ACCESS-CD-GENL              PIC X(4).
  1827         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1828             20  CF-PROCESSOR               PIC X(4).
  1829         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL6509.cbl
  1830             20  CF-STATE-CODE              PIC XX.
  1831             20  FILLER                     PIC XX.
  1832         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1833             20  FILLER                     PIC XX.
  1834             20  CF-HI-BEN-IN-REC           PIC XX.
  1835         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1836             20  FILLER                     PIC XXX.
  1837             20  CF-CARRIER-CNTL            PIC X.
  1838         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1839             20  FILLER                     PIC XX.
  1840             20  CF-HI-TYPE-IN-REC          PIC 99.
  1841         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1842             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1843                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1844             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1845             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1846         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1847             20  FILLER                     PIC X.
  1848             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1849         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1850             20  FILLER                     PIC XX.
  1851             20  CF-MORTGAGE-PLAN           PIC XX.
  1852         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1853
  1854     12  CF-LAST-MAINT-DT                   PIC XX.
  1855     12  CF-LAST-MAINT-BY                   PIC X(4).
  1856     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1857
  1858     12  CF-RECORD-BODY                     PIC X(728).
  1859
  1860
  1861****************************************************************
  1862*             COMPANY MASTER RECORD                            *
  1863****************************************************************
  1864
  1865     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1866         16  CF-COMPANY-ADDRESS.
  1867             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1868             20  CF-CL-IN-CARE-OF           PIC X(30).
  1869             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1870             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1871             20  CF-CL-CITY-STATE           PIC X(30).
  1872             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1873             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1874         16  CF-COMPANY-CD                  PIC X.
  1875         16  CF-COMPANY-PASSWORD            PIC X(8).
  1876         16  CF-SECURITY-OPTION             PIC X.
  1877             88  ALL-SECURITY                   VALUE '1'.
  1878             88  COMPANY-VERIFY                 VALUE '2'.
  1879             88  PROCESSOR-VERIFY               VALUE '3'.
  1880             88  NO-SECURITY                    VALUE '4'.
  1881             88  ALL-BUT-TERM                   VALUE '5'.
  1882         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1883             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1884         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1885             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1886         16  CF-INFORCE-LOCATION            PIC X.
  1887             88  CERTS-ARE-ONLINE               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL6509.cbl
  1888             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1889             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1890         16  CF-LOWER-CASE-LETTERS          PIC X.
  1891         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1892             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1893             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1894             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1895             88  CF-ACCNT-CNTL                  VALUE '3'.
  1896             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1897
  1898         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1899         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1900
  1901         16  CF-LGX-CREDIT-USER             PIC X.
  1902             88  CO-IS-NOT-USER                 VALUE 'N'.
  1903             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1904
  1905         16 CF-CREDIT-CALC-CODES.
  1906             20  CF-CR-REM-TERM-CALC PIC X.
  1907               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1908               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1909               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1910               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1911               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1912               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1913               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1914             20  CF-CR-R78-METHOD           PIC X.
  1915               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1916               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1917
  1918         16  CF-CLAIM-CONTROL-COUNTS.
  1919             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1920                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1921
  1922             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1923                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1924
  1925             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1926                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1927
  1928             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1929                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1930
  1931         16  CF-CURRENT-MONTH-END           PIC XX.
  1932
  1933         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1934             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1935             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1936             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1937             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1938                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1939                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1940             20  CF-CO-PREM-REJECT-SW       PIC X.
  1941                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1942                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1943             20  CF-CO-REF-REJECT-SW        PIC X.
  1944                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1945                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL6509.cbl
  1946
  1947         16  CF-CO-REPORTING-DT             PIC XX.
  1948         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1949         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1950           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1951           88  CF-CO-MONTH-END                  VALUE '1'.
  1952
  1953         16  CF-LGX-CLAIM-USER              PIC X.
  1954             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1955             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1956
  1957         16  CF-CREDIT-EDIT-CONTROLS.
  1958             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1959             20  CF-MIN-AGE                 PIC 99.
  1960             20  CF-DEFAULT-AGE             PIC 99.
  1961             20  CF-MIN-TERM                PIC S999      COMP-3.
  1962             20  CF-MAX-TERM                PIC S999      COMP-3.
  1963             20  CF-DEFAULT-SEX             PIC X.
  1964             20  CF-JOINT-AGE-INPUT         PIC X.
  1965                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1966             20  CF-BIRTH-DATE-INPUT        PIC X.
  1967                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1968             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1969                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1970                 88  CF-ZERO-CARRIER            VALUE '1'.
  1971                 88  CF-ZERO-GROUPING           VALUE '2'.
  1972                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1973             20  CF-EDIT-SW                 PIC X.
  1974                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1975             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1976             20  CF-CR-PR-METHOD            PIC X.
  1977               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1978               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1979             20  FILLER                     PIC X.
  1980
  1981         16  CF-CREDIT-MISC-CONTROLS.
  1982             20  CF-REIN-TABLE-SW           PIC X.
  1983                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1984             20  CF-COMP-TABLE-SW           PIC X.
  1985                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1986             20  CF-EXPERIENCE-RETENTION-AGE
  1987                                            PIC S9        COMP-3.
  1988             20  CF-CONVERSION-DT           PIC XX.
  1989             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1990             20  CF-RUN-FREQUENCY-SW        PIC X.
  1991                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1992                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1993
  1994             20  CF-CR-CHECK-NO-CONTROL.
  1995                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1996                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1997                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1998                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1999                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2000                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2001
  2002                 24  CF-CR-CHECK-COUNT       REDEFINES
  2003                     CF-CR-CHECK-COUNTER      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL6509.cbl
  2004
  2005                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2006                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2007
  2008                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2009                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2010                 24  CF-MAIL-PROCESSING       PIC X.
  2011                     88  MAIL-PROCESSING          VALUE 'Y'.
  2012
  2013         16  CF-MISC-SYSTEM-CONTROL.
  2014             20  CF-SYSTEM-C                 PIC X.
  2015                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2016             20  CF-SYSTEM-D                 PIC X.
  2017                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2018             20  CF-SOC-SEC-NO-SW            PIC X.
  2019                 88  SOC-SEC-NO-USED             VALUE '1'.
  2020             20  CF-MEMBER-NO-SW             PIC X.
  2021                 88  MEMBER-NO-USED              VALUE '1'.
  2022             20  CF-TAX-ID-NUMBER            PIC X(11).
  2023             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2024             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2025                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2026                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2027                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2028                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2029             20  CF-SYSTEM-E                 PIC X.
  2030                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2031
  2032         16  CF-LGX-LIFE-USER               PIC X.
  2033             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2034             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2035
  2036         16  CF-CR-MONTH-END-DT             PIC XX.
  2037
  2038         16  CF-FILE-MAINT-DATES.
  2039             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2040                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2041             20  CF-LAST-BATCH       REDEFINES
  2042                 CF-LAST-BATCH-NO               PIC X(4).
  2043             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2044             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2045             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2046             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2047             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2048             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2049             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2050             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2051             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2052             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2053
  2054         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2055         16  FILLER                         PIC X.
  2056
  2057         16  CF-ALT-MORT-CODE               PIC X(4).
  2058         16  CF-MEMBER-CAPTION              PIC X(10).
  2059
  2060         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2061             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL6509.cbl
  2062             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2063             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2064             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2065             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2066
  2067         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2068
  2069         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2070         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2071         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2072         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2073
  2074         16  CF-AH-OVERRIDE-L1              PIC X.
  2075         16  CF-AH-OVERRIDE-L2              PIC XX.
  2076         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2077         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2078
  2079         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2080         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2081
  2082         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2083         16  CF-AR-LAST-EL860-DT            PIC XX.
  2084         16  CF-MP-MONTH-END-DT             PIC XX.
  2085
  2086         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2087         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2088             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2089
  2090         16  CF-AR-MONTH-END-DT             PIC XX.
  2091
  2092         16  CF-CRDTCRD-USER                PIC X.
  2093             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2094             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2095
  2096         16  CF-CC-MONTH-END-DT             PIC XX.
  2097
  2098         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2099
  2100         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2101             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2102             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2103             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2104         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2105         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2106         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2107         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2108             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2109             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2110         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2111         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2112         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2113             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2114         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2115
  2116         16  CF-CL-ZIP-CODE.
  2117             20  CF-CL-ZIP-PRIME.
  2118                 24  CF-CL-ZIP-1ST          PIC X.
  2119                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL6509.cbl
  2120                 24  FILLER                 PIC X(4).
  2121             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2122         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2123             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2124             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2125             20  FILLER                     PIC XXX.
  2126
  2127         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2128         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2129         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2130         16  CF-CO-OPTION-START-DATE        PIC XX.
  2131         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2132           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2133                                                      '3' '4'.
  2134           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2135           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2136           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2137           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2138           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2139           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2140
  2141         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2142
  2143         16  CF-PAYMENT-APPROVAL-LEVELS.
  2144             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2145             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2146             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2147             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2148             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2149             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2150
  2151         16  CF-END-USER-REPORTING-USER     PIC X.
  2152             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2153             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2154
  2155         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2156             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2157             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2158
  2159         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2160
  2161         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2162         16  FILLER                         PIC X.
  2163
  2164         16  CF-CREDIT-ARCHIVE-CNTL.
  2165             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2166             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2167             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2168
  2169         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2170
  2171         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2172             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2173             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2174
  2175         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2176             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2177             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL6509.cbl
  2178
  2179         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2180
  2181         16  CF-CO-ACH-ID-CODE              PIC  X.
  2182             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2183             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2184             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2185         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2186         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2187         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2188         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2189         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2190         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2191         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2192         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2193         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2194                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2195         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2196                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2197
  2198         16  CF-CO-OVER-SHORT.
  2199             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2200             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2201
  2202*         16  FILLER                         PIC X(102).
  2203         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2204             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2205             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2206
  2207         16  CF-AH-APPROVAL-DAYS.
  2208             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2209             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2210             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2211             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2212
  2213         16  FILLER                         PIC X(82).
  2214****************************************************************
  2215*             PROCESSOR/USER RECORD                            *
  2216****************************************************************
  2217
  2218     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2219         16  CF-PROCESSOR-NAME              PIC X(30).
  2220         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2221         16  CF-PROCESSOR-TITLE             PIC X(26).
  2222         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2223                 88  MESSAGE-YES                VALUE 'Y'.
  2224                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2225
  2226*****************************************************
  2227****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2228****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2229****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2230****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2231*****************************************************
  2232
  2233         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2234             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2235             20  CF-APPLICATION-FORCE       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL6509.cbl
  2236             20  CF-INDIVIDUAL-APP.
  2237                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2238                     28  CF-BROWSE-APP      PIC X.
  2239                     28  CF-UPDATE-APP      PIC X.
  2240
  2241         16  CF-CURRENT-TERM-ON             PIC X(4).
  2242         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2243             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2244             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2245             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2246             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2247             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2248             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2249             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2250         16  CF-PROCESSOR-CARRIER           PIC X.
  2251             88  NO-CARRIER-SECURITY            VALUE ' '.
  2252         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2253             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2254         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2255             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2256         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2257             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2258
  2259         16  CF-PROC-SYS-ACCESS-SW.
  2260             20  CF-PROC-CREDIT-CLAIMS-SW.
  2261                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2262                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2263                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2264                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2265             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2266                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2267                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2268             20  CF-PROC-LIFE-GNRLDGR-SW.
  2269                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2270                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2271                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2272                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2273             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2274                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2275                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2276         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2277             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2278             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2279         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2280
  2281         16  CF-APPROVAL-LEVEL                  PIC X.
  2282             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2283             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2284             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2285             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2286
  2287         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2288
  2289         16  CF-LANGUAGE-TYPE                   PIC X.
  2290             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2291             88  CF-LANG-IS-FR                      VALUE 'F'.
  2292         16  FILLER                             PIC  X(240).
  2293
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL6509.cbl
  2294****************************************************************
  2295*             PROCESSOR/REMINDERS RECORD                       *
  2296****************************************************************
  2297
  2298     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2299         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2300             20  CF-START-REMIND-DT         PIC XX.
  2301             20  CF-END-REMIND-DT           PIC XX.
  2302             20  CF-REMINDER-TEXT           PIC X(50).
  2303         16  FILLER                         PIC X(296).
  2304
  2305
  2306****************************************************************
  2307*             STATE MASTER RECORD                              *
  2308****************************************************************
  2309
  2310     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2311         16  CF-STATE-ABBREVIATION          PIC XX.
  2312         16  CF-STATE-NAME                  PIC X(25).
  2313         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2314         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2315             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2316             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2317             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2318             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2319                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2320                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2321             20  CF-ST-PREM-REJECT-SW       PIC X.
  2322                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2323                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2324             20  CF-ST-REF-REJECT-SW        PIC X.
  2325                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2326                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2327         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2328         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2329         16  CF-ST-REFUND-RULES.
  2330             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2331             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2332             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2333         16  CF-ST-FST-PMT-EXTENSION.
  2334             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2335             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2336                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2337                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2338                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2339                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2340         16  CF-ST-STATE-CALL.
  2341             20  CF-ST-CALL-UNEARNED        PIC X.
  2342             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2343             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2344         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2345             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2346             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2347         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2348         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2349         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2350         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2351         16  CF-ST-SPLIT-PAYMENT            PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL6509.cbl
  2352         16  FILLER                         PIC X.
  2353         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2354             20  CF-ST-BENEFIT-CD           PIC XX.
  2355             20  CF-ST-BENEFIT-KIND         PIC X.
  2356                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2357                 88  CF-ST-AH-KIND              VALUE 'A'.
  2358             20  CF-ST-REM-TERM-CALC        PIC X.
  2359                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2360                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2361                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2362                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2363                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2364                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2365                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2366                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2367
  2368             20  CF-ST-REFUND-CALC          PIC X.
  2369                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2370                 88  ST-REFD-BY-R78             VALUE '1'.
  2371                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2372                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2373                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2374                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2375                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2376                 88  ST-REFD-UTAH               VALUE '7'.
  2377                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2378                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2379                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2380
  2381             20  CF-ST-EARNING-CALC         PIC X.
  2382                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2383                 88  ST-EARN-BY-R78             VALUE '1'.
  2384                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2385                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2386                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2387                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2388                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2389                 88  ST-EARN-MEAN               VALUE '8'.
  2390                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2391
  2392             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2393                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2394                 88  ST-OVRD-BY-R78             VALUE '1'.
  2395                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2396                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2397                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2398                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2399                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2400                 88  ST-OVRD-MEAN               VALUE '8'.
  2401                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2402             20  FILLER                     PIC X.
  2403
  2404         16  CF-ST-COMMISSION-CAPS.
  2405             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2406             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2407             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2408             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2409         16  CF-COMM-CAP-LIMIT-TO           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL6509.cbl
  2410                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2411
  2412         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2413
  2414         16  CF-ST-STATUTORY-INTEREST.
  2415             20  CF-ST-STAT-DATE-FROM       PIC X.
  2416                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2417                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2418             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2419             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2420             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2421             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2422             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2423
  2424         16  CF-ST-OVER-SHORT.
  2425             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2426             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2427
  2428         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2429
  2430         16  CF-ST-RT-CALC                  PIC X.
  2431
  2432         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2433         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2434         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2435         16  CF-ST-RF-LR-CALC               PIC X.
  2436         16  CF-ST-RF-LL-CALC               PIC X.
  2437         16  CF-ST-RF-LN-CALC               PIC X.
  2438         16  CF-ST-RF-AH-CALC               PIC X.
  2439         16  CF-ST-RF-CP-CALC               PIC X.
  2440*        16  FILLER                         PIC X(206).
  2441*CIDMOD         16  FILLER                         PIC X(192).
  2442         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2443             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2444         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2445         16  FILLER                         PIC X(187).
  2446
  2447****************************************************************
  2448*             BENEFIT MASTER RECORD                            *
  2449****************************************************************
  2450
  2451     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2452         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2453             20  CF-BENEFIT-CODE            PIC XX.
  2454             20  CF-BENEFIT-NUMERIC  REDEFINES
  2455                 CF-BENEFIT-CODE            PIC XX.
  2456             20  CF-BENEFIT-ALPHA           PIC XXX.
  2457             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2458             20  CF-BENEFIT-COMMENT         PIC X(10).
  2459
  2460             20  CF-LF-COVERAGE-TYPE        PIC X.
  2461                 88  CF-REDUCING                VALUE 'R'.
  2462                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2463
  2464             20  CF-SPECIAL-CALC-CD         PIC X.
  2465                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2466                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2467                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL6509.cbl
  2468                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2469                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2470                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2471                 88  CF-FARM-PLAN               VALUE 'F'.
  2472                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2473                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2474                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2475                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2476                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2477                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2478                 88  CF-PRUDENTIAL              VALUE 'P'.
  2479                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2480                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2481                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2482                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2483                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2484                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2485
  2486             20  CF-JOINT-INDICATOR         PIC X.
  2487                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2488
  2489*            20  FILLER                     PIC X(12).
  2490             20  FILLER                     PIC X(11).
  2491             20  CF-BENEFIT-CATEGORY        PIC X.
  2492             20  CF-LOAN-TYPE               PIC X(8).
  2493
  2494             20  CF-CO-REM-TERM-CALC        PIC X.
  2495                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2496                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2497                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2498                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2499                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2500
  2501             20  CF-CO-EARNINGS-CALC        PIC X.
  2502                 88  CO-EARN-BY-R78             VALUE '1'.
  2503                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2504                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2505                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2506                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2507                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2508                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2509                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2510
  2511             20  CF-CO-REFUND-CALC          PIC X.
  2512                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2513                 88  CO-REFD-BY-R78             VALUE '1'.
  2514                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2515                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2516                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2517                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2518                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2519                 88  CO-REFD-MEAN               VALUE '8'.
  2520                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2521                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2522                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2523
  2524             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2525                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL6509.cbl
  2526                 88  CO-OVRD-BY-R78             VALUE '1'.
  2527                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2528                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2529                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2530                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2531                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2532                 88  CO-OVRD-MEAN               VALUE '8'.
  2533                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2534
  2535             20  CF-CO-BEN-I-G-CD           PIC X.
  2536                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2537                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2538                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2539
  2540         16  FILLER                         PIC X(304).
  2541
  2542
  2543****************************************************************
  2544*             CARRIER MASTER RECORD                            *
  2545****************************************************************
  2546
  2547     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2548         16  CF-ADDRESS-DATA.
  2549             20  CF-MAIL-TO-NAME            PIC X(30).
  2550             20  CF-IN-CARE-OF              PIC X(30).
  2551             20  CF-ADDRESS-LINE-1          PIC X(30).
  2552             20  CF-ADDRESS-LINE-2          PIC X(30).
  2553             20  CF-CITY-STATE              PIC X(30).
  2554             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2555             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2556
  2557         16  CF-CLAIM-NO-CONTROL.
  2558             20  CF-CLAIM-NO-METHOD         PIC X.
  2559                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2560                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2561                 88  CLAIM-NO-SEQ               VALUE '3'.
  2562                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2563             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2564                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2565                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2566                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2567
  2568         16  CF-CHECK-NO-CONTROL.
  2569             20  CF-CHECK-NO-METHOD         PIC X.
  2570                 88  CHECK-NO-MANUAL            VALUE '1'.
  2571                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2572                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2573                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2574             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2575                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2576
  2577         16  CF-DOMICILE-STATE              PIC XX.
  2578
  2579         16  CF-EXPENSE-CONTROLS.
  2580             20  CF-EXPENSE-METHOD          PIC X.
  2581                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2582                 88  DOLLARS-PER-PMT            VALUE '2'.
  2583                 88  PERCENT-OF-PAYMENT         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL6509.cbl
  2584                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2585             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2586             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2587
  2588         16  CF-CORRESPONDENCE-CONTROL.
  2589             20  CF-LETTER-RESEND-OPT       PIC X.
  2590                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2591                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2592             20  FILLER                     PIC X(4).
  2593
  2594         16  CF-RESERVE-CONTROLS.
  2595             20  CF-MANUAL-SW               PIC X.
  2596                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2597             20  CF-FUTURE-SW               PIC X.
  2598                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2599             20  CF-PTC-SW                  PIC X.
  2600                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2601             20  CF-IBNR-SW                 PIC X.
  2602                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2603             20  CF-PTC-LF-SW               PIC X.
  2604                 88  CF-LF-PTC-USED             VALUE '1'.
  2605             20  CF-CDT-ACCESS-METHOD       PIC X.
  2606                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2607                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2608                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2609             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2610
  2611         16  CF-CLAIM-CALC-METHOD           PIC X.
  2612             88  360-PLUS-MONTHS                VALUE '1'.
  2613             88  365-PLUS-MONTHS                VALUE '2'.
  2614             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2615             88  360-DAILY                      VALUE '4'.
  2616             88  365-DAILY                      VALUE '5'.
  2617
  2618         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2619         16  FILLER                         PIC X(11).
  2620
  2621         16  CF-LIMIT-AMOUNTS.
  2622             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2623             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2624             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2625             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2626             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2627             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2628             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2629             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2630             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2631             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2632
  2633         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2634         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2635         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2636
  2637         16  CF-ZIP-CODE.
  2638             20  CF-ZIP-PRIME.
  2639                 24  CF-ZIP-1ST             PIC X.
  2640                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2641                 24  FILLER                 PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL6509.cbl
  2642             20  CF-ZIP-PLUS4               PIC X(4).
  2643         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2644             20  CF-CAN-POSTAL-1            PIC XXX.
  2645             20  CF-CAN-POSTAL-2            PIC XXX.
  2646             20  FILLER                     PIC XXX.
  2647
  2648         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2649         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2650         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2651
  2652         16  CF-RATING-SWITCH               PIC X.
  2653             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2654             88  CF-NO-RATING                   VALUE 'N'.
  2655
  2656         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2657
  2658         16  CF-CARRIER-OVER-SHORT.
  2659             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2660             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2661
  2662         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2663         16  CF-SECPAY-SWITCH               PIC X.
  2664             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2665             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2666         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2667         16  FILLER                         PIC X(448).
  2668*        16  FILLER                         PIC X(452).
  2669
  2670
  2671****************************************************************
  2672*             MORTALITY MASTER RECORD                          *
  2673****************************************************************
  2674
  2675     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2676         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2677                                INDEXED BY CF-MORT-NDX.
  2678             20  CF-MORT-TABLE              PIC X(5).
  2679             20  CF-MORT-TABLE-TYPE         PIC X.
  2680                 88  CF-MORT-JOINT              VALUE 'J'.
  2681                 88  CF-MORT-SINGLE             VALUE 'S'.
  2682                 88  CF-MORT-COMBINED           VALUE 'C'.
  2683                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2684                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2685             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2686             20  CF-MORT-AGE-METHOD         PIC XX.
  2687                 88  CF-AGE-LAST                VALUE 'AL'.
  2688                 88  CF-AGE-NEAR                VALUE 'AN'.
  2689             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2690             20  CF-MORT-ADJUSTMENT-DIRECTION
  2691                                            PIC X.
  2692                 88  CF-MINUS                   VALUE '-'.
  2693                 88  CF-PLUS                    VALUE '+'.
  2694             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2695             20  CF-MORT-JOINT-CODE         PIC X.
  2696                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2697             20  CF-MORT-PC-Q               PIC X.
  2698                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2699             20  CF-MORT-TABLE-CODE         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL6509.cbl
  2700             20  CF-MORT-COMMENTS           PIC X(15).
  2701             20  FILLER                     PIC X(14).
  2702
  2703         16  FILLER                         PIC X(251).
  2704
  2705
  2706****************************************************************
  2707*             BUSSINESS TYPE MASTER RECORD                     *
  2708****************************************************************
  2709
  2710     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2711* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2712* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2713* AND RECORD 05 IS TYPES 81-99
  2714         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2715             20  CF-BUSINESS-TITLE          PIC  X(19).
  2716             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2717                                            PIC S9V9(4) COMP-3.
  2718             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2719             20  FILLER                     PIC  X.
  2720         16  FILLER                         PIC  X(248).
  2721
  2722
  2723****************************************************************
  2724*             TERMINAL MASTER RECORD                           *
  2725****************************************************************
  2726
  2727     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2728
  2729         16  CF-COMPANY-TERMINALS.
  2730             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2731                                  PIC X(4).
  2732         16  FILLER               PIC X(248).
  2733
  2734
  2735****************************************************************
  2736*             LIFE EDIT MASTER RECORD                          *
  2737****************************************************************
  2738
  2739     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2740         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2741             20  CF-LIFE-CODE-IN            PIC XX.
  2742             20  CF-LIFE-CODE-OUT           PIC XX.
  2743         16  FILLER                         PIC X(248).
  2744
  2745
  2746****************************************************************
  2747*             AH EDIT MASTER RECORD                            *
  2748****************************************************************
  2749
  2750     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2751         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2752             20  CF-AH-CODE-IN              PIC XXX.
  2753             20  CF-AH-CODE-OUT             PIC XX.
  2754         16  FILLER                         PIC X(248).
  2755
  2756
  2757****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL6509.cbl
  2758*             CREDIBILITY TABLES                               *
  2759****************************************************************
  2760
  2761     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2762         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2763                             INDEXED BY CF-CRDB-NDX.
  2764             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2765             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2766             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2767         16  FILLER                         PIC  X(332).
  2768
  2769
  2770****************************************************************
  2771*             REPORT CUSTOMIZATION RECORD                      *
  2772****************************************************************
  2773
  2774     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2775         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2776             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2777             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2778             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2779**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2780****       A T-TRANSFER.                                   ****
  2781             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2782
  2783         16  FILLER                         PIC XX.
  2784
  2785         16  CF-CARRIER-CNTL-OPT.
  2786             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2787                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2788                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2789             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2790                                            PIC X.
  2791         16  CF-GROUP-CNTL-OPT.
  2792             20  CF-GROUP-OPT-SEQ           PIC 9.
  2793                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2794                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2795             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2796                                            PIC X(6).
  2797         16  CF-STATE-CNTL-OPT.
  2798             20  CF-STATE-OPT-SEQ           PIC 9.
  2799                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2800                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2801             20  CF-STATE-SELECT OCCURS 3 TIMES
  2802                                            PIC XX.
  2803         16  CF-ACCOUNT-CNTL-OPT.
  2804             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2805                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2806                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2807             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2808                                            PIC X(10).
  2809         16  CF-BUS-TYP-CNTL-OPT.
  2810             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2811                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2812                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2813             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2814                                            PIC XX.
  2815         16  CF-LF-TYP-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL6509.cbl
  2816             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2817                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2818                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2819             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2820                                            PIC XX.
  2821         16  CF-AH-TYP-CNTL-OPT.
  2822             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2823                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2824                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2825             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2826                                            PIC XX.
  2827         16  CF-REPTCD1-CNTL-OPT.
  2828             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2829                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2830                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2831             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2832                                            PIC X(10).
  2833         16  CF-REPTCD2-CNTL-OPT.
  2834             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2835                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2836                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2837             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2838                                            PIC X(10).
  2839         16  CF-USER1-CNTL-OPT.
  2840             20  CF-USER1-OPT-SEQ           PIC 9.
  2841                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2842                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2843             20  CF-USER1-SELECT OCCURS 3 TIMES
  2844                                            PIC X(10).
  2845         16  CF-USER2-CNTL-OPT.
  2846             20  CF-USER2-OPT-SEQ           PIC 9.
  2847                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2848                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2849             20  CF-USER2-SELECT OCCURS 3 TIMES
  2850                                            PIC X(10).
  2851         16  CF-USER3-CNTL-OPT.
  2852             20  CF-USER3-OPT-SEQ           PIC 9.
  2853                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2854                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2855             20  CF-USER3-SELECT OCCURS 3 TIMES
  2856                                            PIC X(10).
  2857         16  CF-USER4-CNTL-OPT.
  2858             20  CF-USER4-OPT-SEQ           PIC 9.
  2859                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2860                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2861             20  CF-USER4-SELECT OCCURS 3 TIMES
  2862                                            PIC X(10).
  2863         16  CF-USER5-CNTL-OPT.
  2864             20  CF-USER5-OPT-SEQ           PIC 9.
  2865                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2866                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2867             20  CF-USER5-SELECT OCCURS 3 TIMES
  2868                                            PIC X(10).
  2869         16  CF-REINS-CNTL-OPT.
  2870             20  CF-REINS-OPT-SEQ           PIC 9.
  2871                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2872                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2873             20  CF-REINS-SELECT OCCURS 3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL6509.cbl
  2874                 24  CF-REINS-PRIME         PIC XXX.
  2875                 24  CF-REINS-SUB           PIC XXX.
  2876
  2877         16  CF-AGENT-CNTL-OPT.
  2878             20  CF-AGENT-OPT-SEQ           PIC 9.
  2879                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2880                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2881             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2882                                            PIC X(10).
  2883
  2884         16  FILLER                         PIC X(43).
  2885
  2886         16  CF-LOSS-RATIO-SELECT.
  2887             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2888             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2889         16  CF-ENTRY-DATE-SELECT.
  2890             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2891             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2892         16  CF-EFFECTIVE-DATE-SELECT.
  2893             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2894             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2895
  2896         16  CF-EXCEPTION-LIST-IND          PIC X.
  2897             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2898
  2899         16  FILLER                         PIC X(318).
  2900
  2901****************************************************************
  2902*                  EXCEPTION REPORTING RECORD                  *
  2903****************************************************************
  2904
  2905     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2906         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2907             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2908
  2909         16  CF-COMBINED-LIFE-AH-OPT.
  2910             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2911             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2912             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2913             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2914
  2915         16  CF-LIFE-OPT.
  2916             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2917             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2918             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2919             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2920             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2921             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2922             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2923             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2924             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2925             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2926
  2927         16  CF-AH-OPT.
  2928             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2929             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2930             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2931             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL6509.cbl
  2932             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2933             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2934             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2935             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2936             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2937             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2938
  2939         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2940             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2941             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2942             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2943
  2944         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2945
  2946         16  FILLER                         PIC X(673).
  2947
  2948
  2949****************************************************************
  2950*             MORTGAGE SYSTEM PLAN RECORD                      *
  2951****************************************************************
  2952
  2953     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2954         16  CF-PLAN-TYPE                   PIC X.
  2955             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2956             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2957             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2958         16  CF-PLAN-ABBREV                 PIC XXX.
  2959         16  CF-PLAN-DESCRIPT               PIC X(10).
  2960         16  CF-PLAN-NOTES                  PIC X(20).
  2961         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2962         16  CF-PLAN-UNDERWRITING.
  2963             20  CF-PLAN-TERM-DATA.
  2964                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2965                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2966             20  CF-PLAN-AGE-DATA.
  2967                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2968                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2969                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2970             20  CF-PLAN-BENEFIT-DATA.
  2971                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2972                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2973                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2974                                            PIC S9(7)V99  COMP-3.
  2975         16  CF-PLAN-POLICY-FORMS.
  2976             20  CF-POLICY-FORM             PIC X(12).
  2977             20  CF-MASTER-APPLICATION      PIC X(12).
  2978             20  CF-MASTER-POLICY           PIC X(12).
  2979         16  CF-PLAN-RATING.
  2980             20  CF-RATE-CODE               PIC X(5).
  2981             20  CF-SEX-RATING              PIC X.
  2982                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2983                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2984             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2985             20  CF-SUB-STD-TYPE            PIC X.
  2986                 88  CF-PCT-OF-PREM            VALUE '1'.
  2987                 88  CF-PCT-OF-BENE            VALUE '2'.
  2988         16  CF-PLAN-PREM-TOLERANCES.
  2989             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL6509.cbl
  2990             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2991         16  CF-PLAN-PYMT-TOLERANCES.
  2992             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2993             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2994         16  CF-PLAN-MISC-DATA.
  2995             20  FILLER                     PIC X.
  2996             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2997             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2998         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2999         16  CF-PLAN-IND-GRP                PIC X.
  3000             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3001                                                     '1'.
  3002             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3003                                                     '2'.
  3004         16  CF-MIB-SEARCH-SW               PIC X.
  3005             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3006             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3007             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3008             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3009         16  CF-ALPHA-SEARCH-SW             PIC X.
  3010             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3011             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3012             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3013             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3014             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3015             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3016             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3017             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3018             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3019             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3020                                                     'A' 'B' 'C'
  3021                                                     'X' 'Y' 'Z'.
  3022         16  CF-EFF-DT-RULE-SW              PIC X.
  3023             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3024             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3025             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3026             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3027             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3028         16  FILLER                         PIC X(4).
  3029         16  CF-HEALTH-QUESTIONS            PIC X.
  3030             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3031         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3032         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3033         16  CF-PLAN-SNGL-JNT               PIC X.
  3034             88  CF-COMBINED-PLAN              VALUE 'C'.
  3035             88  CF-JNT-PLAN                   VALUE 'J'.
  3036             88  CF-SNGL-PLAN                  VALUE 'S'.
  3037         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3038         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3039         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3040         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3041         16  CF-RERATE-CNTL                 PIC  X.
  3042             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3043             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3044             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3045             88  CF-AUTO-RECALC                 VALUE '4'.
  3046         16  CF-BENEFIT-TYPE                PIC  X.
  3047             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL6509.cbl
  3048             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3049         16  CF-POLICY-FEE                  PIC S999V99
  3050                                                    COMP-3.
  3051         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3052         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3053         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3054         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3055         16  FILLER                         PIC  X(32).
  3056         16  CF-TERMINATION-FORM            PIC  X(04).
  3057         16  FILLER                         PIC  X(08).
  3058         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3059                                                       COMP-3.
  3060         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3061         16  CF-ISSUE-LETTER                PIC  X(4).
  3062         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3063         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3064             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3065             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3066         16  CF-MP-REFUND-CALC              PIC X.
  3067             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3068             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3069             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3070             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3071             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3072             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3073             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3074             88  CF-MP-REFD-MEAN                VALUE '8'.
  3075         16  CF-ALT-RATE-CODE               PIC  X(5).
  3076
  3077
  3078         16  FILLER                         PIC X(498).
  3079****************************************************************
  3080*             MORTGAGE COMPANY MASTER RECORD                   *
  3081****************************************************************
  3082
  3083     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3084         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3085         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3086             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3087             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3088             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3089             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3090             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3091
  3092         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3093         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3094         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3095         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3096         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3097
  3098         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3099             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3100         16  CF-MP-RECON-USE-IND            PIC X(1).
  3101             88  CF-MP-USE-RECON             VALUE 'Y'.
  3102         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3103             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3104         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3105             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL6509.cbl
  3106             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3107         16  FILLER                         PIC X(1).
  3108         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3109             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3110         16  CF-MORTG-MIB-VERSION           PIC X.
  3111             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3112             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3113             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3114         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3115             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3116                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3117             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3118                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3119             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3120                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3121             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3122                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3123             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3124                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3125             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3126                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3127         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3128         16  FILLER                         PIC X(7).
  3129         16  CF-MORTG-DESTINATION-SYMBOL.
  3130             20  CF-MORTG-MIB-COMM          PIC X(5).
  3131             20  CF-MORTG-MIB-TERM          PIC X(5).
  3132         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3133             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3134         16  FILLER                         PIC X(03).
  3135         16  CF-MP-CHECK-NO-CONTROL.
  3136             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3137                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3138                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3139                                                ' ' LOW-VALUES.
  3140                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3141                                               VALUE '3'.
  3142         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3143         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3144         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3145             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3146                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3147             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3148                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3149             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3150                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3151             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3152                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3153             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3154                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3155             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3156                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3157         16  CF-MORTG-BILLING-AREA.
  3158             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3159                                            PIC X.
  3160         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3161         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3162         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3163         16  CF-MORTG-MIB-DEST-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL6509.cbl
  3164             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3165             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3166         16  FILLER                         PIC X.
  3167         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3168             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3169             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3170         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3171         16  FILLER                         PIC X(8).
  3172         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3173         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3174         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3175         16  CF-ACH-COMPANY-ID.
  3176             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3177                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3178                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3179                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3180             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3181         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3182             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3183         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3184             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3185             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3186         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3187         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3188         16  FILLER                         PIC X(536).
  3189
  3190****************************************************************
  3191*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3192****************************************************************
  3193
  3194     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3195         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3196             20  CF-FEMALE-HEIGHT.
  3197                 24  CF-FEMALE-FT           PIC 99.
  3198                 24  CF-FEMALE-IN           PIC 99.
  3199             20  CF-FEMALE-MIN-WT           PIC 999.
  3200             20  CF-FEMALE-MAX-WT           PIC 999.
  3201         16  FILLER                         PIC X(428).
  3202
  3203     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3204         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3205             20  CF-MALE-HEIGHT.
  3206                 24  CF-MALE-FT             PIC 99.
  3207                 24  CF-MALE-IN             PIC 99.
  3208             20  CF-MALE-MIN-WT             PIC 999.
  3209             20  CF-MALE-MAX-WT             PIC 999.
  3210         16  FILLER                         PIC X(428).
  3211******************************************************************
  3212*             AUTOMATIC ACTIVITY RECORD                          *
  3213******************************************************************
  3214     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3215         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3216             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3217             20  CF-SYS-LETTER-ID           PIC X(04).
  3218             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3219             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3220             20  CF-SYS-RESET-SW            PIC X(01).
  3221             20  CF-SYS-REPORT-DAYS         PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL6509.cbl
  3222             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3223
  3224         16  FILLER                         PIC X(50).
  3225
  3226         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3227             20  CF-USER-ACTIVE-SW          PIC X(01).
  3228             20  CF-USER-LETTER-ID          PIC X(04).
  3229             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3230             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3231             20  CF-USER-RESET-SW           PIC X(01).
  3232             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3233             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3234             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3235
  3236         16  FILLER                         PIC X(246).
  3237 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA NOTE-FILE
  3238                          CONTROL-FILE.
  3239 0000-DFHEXIT SECTION.
  3240     MOVE '9#                    $   ' TO DFHEIV0.
  3241     MOVE 'EL6509' TO DFHEIV1.
  3242     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3243
  3244     MOVE EIBTRMID               TO QID-TERM.
  3245     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  3246     MOVE '5'                    TO DC-OPTION-CODE.
  3247     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  3248     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  3249     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  3250
  3251     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK
  3252     IF EIBCALEN = ZEROS
  3253         GO TO 8800-UNAUTHORIZED-ACCESS.
  3254
  3255     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3256        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3257           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  3258           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  3259           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  3260           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  3261           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  3262           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  3263           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  3264           MOVE THIS-PGM TO PI-CALLING-PROGRAM
  3265        ELSE
  3266           MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  3267           MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  3268           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  3269           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  3270           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  3271           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  3272           MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  3273           MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  3274
  3275     MOVE LOW-VALUES TO EL6509AI.
  3276     MOVE SPACES                 TO  ERACNT-KEY.
  3277
  3278     IF PI-RETURN-TO-PROGRAM = PGM-EL650
  3279        OR PI-ACCT-NOTE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL6509.cbl
  3280        MOVE '1'                 TO  ERACNT-REC-TYP
  3281        MOVE 'A'                 TO  PI-NOTE-TYPE
  3282        MOVE PI-ACCT-CARRIER     TO  ERACNT-CARRIER
  3283                                     PI-CR-CARRIER
  3284                                     VG-CARRIER
  3285        MOVE PI-ACCT-GROUPING    TO  ERACNT-GROUPING
  3286                                     VG-GROUPING
  3287                                     PI-CR-GROUPING
  3288        MOVE PI-ACCT-STATE       TO  ERACNT-STATE
  3289                                     PI-CR-STATE
  3290                                     VG-STATE
  3291        MOVE PI-ACCT-ACCOUNT     TO  ERACNT-ACCOUNT
  3292                                     PI-CR-ACCOUNT
  3293                                     VG-ACCOUNT.
  3294
  3295     IF ACCNT-CNTL
  3296         MOVE SPACES             TO  ERACNT-CARRIER
  3297                                     VG-CARRIER
  3298                                     ERACNT-GROUPING
  3299                                     VG-GROUPING
  3300                                     ERACNT-STATE
  3301                                     VG-STATE.
  3302
  3303     IF ST-ACCNT-CNTL
  3304         MOVE SPACES             TO  ERACNT-CARRIER
  3305                                     VG-CARRIER
  3306                                     VG-GROUPING
  3307                                     ERACNT-GROUPING.
  3308
  3309     IF CARR-ACCNT-CNTL
  3310         MOVE SPACES             TO  ERACNT-GROUPING
  3311                                     ERACNT-STATE
  3312                                     VG-STATE.
  3313
  3314     IF CARR-ST-ACCNT-CNTL
  3315         MOVE SPACES             TO  ERACNT-GROUPING.
  3316
  3317     MOVE PI-COMPANY-CD          TO  ERACNT-COMPANY-CD.
  3318     MOVE ZEROS                  TO  ERACNT-SEQ.
  3319     MOVE ERACNT-PARTIAL-KEY     TO  SV-PRIOR-KEY.
  3320
  3321     IF EIBTRNID NOT = TRANS-ID
  3322        MOVE '0'                 TO  PI-UPDATE-SW
  3323        IF PI-PROCESSOR-ID NOT = 'LGXX'
  3324
  3325* EXEC CICS READQ TS
  3326*                    QUEUE (PI-SECURITY-TEMP-STORE-ID)
  3327*                    INTO (SECURITY-CONTROL)
  3328*                    LENGTH (SC-COMM-LENGTH)
  3329*                    ITEM  (SC-ITEM)
  3330*                    END-EXEC
  3331*    MOVE '*$II   L              ''   #00003320' TO DFHEIV0
  3332     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3333     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3334     MOVE X'2020233030303033333230' TO DFHEIV0(25:11)
  3335     CALL 'kxdfhei1' USING DFHEIV0,
  3336           PI-SECURITY-TEMP-STORE-ID,
  3337           SECURITY-CONTROL,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL6509.cbl
  3338           SC-COMM-LENGTH,
  3339           SC-ITEM,
  3340           DFHEIV99,
  3341           DFHEIV99
  3342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3343          MOVE SC-CREDIT-DISPLAY (25) TO PI-DISPLAY-CAP
  3344          MOVE SC-CREDIT-UPDATE (25)  TO PI-MODIFY-CAP.
  3345
  3346     IF NOT DISPLAY-CAP
  3347         MOVE 'READ'             TO  SM-READ
  3348         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  3349         MOVE ER-0070            TO  EMI-ERROR
  3350         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3351         GO TO 8100-SEND-INITIAL-MAP.
  3352
  3353
  3354* EXEC CICS HANDLE AID
  3355*         CLEAR(9400-CLEAR)
  3356*    END-EXEC.
  3357*    MOVE '"&=                  V! " #00003336' TO DFHEIV0
  3358     MOVE X'22263D202020202020202020' TO DFHEIV0(1:12)
  3359     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  3360     MOVE X'2220233030303033333336' TO DFHEIV0(25:11)
  3361     CALL 'kxdfhei1' USING DFHEIV0
  3362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3363
  3364
  3365
  3366* EXEC CICS HANDLE CONDITION
  3367*         ERROR(9990-ABEND)
  3368*         PGMIDERR(9600-PGMID-ERROR)
  3369*    END-EXEC.
  3370*    MOVE '"$.L                  ! # #00003340' TO DFHEIV0
  3371     MOVE X'22242E4C2020202020202020' TO DFHEIV0(1:12)
  3372     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3373     MOVE X'2320233030303033333430' TO DFHEIV0(25:11)
  3374     CALL 'kxdfhei1' USING DFHEIV0
  3375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3376
  3377
  3378     IF EIBTRNID NOT = TRANS-ID
  3379         GO TO 7000-BUILD-TABLE.
  3380
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL6509.cbl
  3382 2000-RECEIVE.
  3383     IF EIBAID = DFHPA1 OR
  3384        EIBAID = DFHPA2 OR
  3385        EIBAID = DFHPA3
  3386           MOVE ER-0008 TO EMI-ERROR
  3387           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3388           GO TO 8200-SEND-DATAONLY.
  3389
  3390
  3391* EXEC CICS RECEIVE
  3392*         MAP(MAP-NAME)
  3393*         MAPSET(MAPSET-NAME)
  3394*         INTO(EL6509AI)
  3395*         END-EXEC.
  3396     MOVE LENGTH OF
  3397      EL6509AI
  3398       TO DFHEIV11
  3399*    MOVE '8"T I  L              ''   #00003357' TO DFHEIV0
  3400     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3401     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3402     MOVE X'2020233030303033333537' TO DFHEIV0(25:11)
  3403     CALL 'kxdfhei1' USING DFHEIV0,
  3404           MAP-NAME,
  3405           EL6509AI,
  3406           DFHEIV11,
  3407           MAPSET-NAME,
  3408           DFHEIV99,
  3409           DFHEIV99
  3410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3411
  3412
  3413     IF PFENTERL = ZEROS
  3414        GO TO 2001-CHECK-PFKEYS.
  3415
  3416     IF EIBAID NOT = DFHENTER
  3417        MOVE ER-0004             TO EMI-ERROR
  3418        GO TO 2002-INPUT-ERROR.
  3419
  3420     IF PFENTERI NUMERIC AND
  3421        (PFENTERI > 00 AND  < 25)
  3422        MOVE PF-VALUES (PFENTERI) TO EIBAID
  3423        ELSE
  3424        MOVE ER-0029 TO EMI-ERROR
  3425        GO TO 2002-INPUT-ERROR.
  3426
  3427 2001-CHECK-PFKEYS.
  3428     IF EIBAID = DFHPF23
  3429        GO TO 9000-RETURN-CICS.
  3430
  3431     IF EIBAID = DFHPF24
  3432        GO TO 9200-RETURN-MAIN-MENU.
  3433
  3434     IF EIBAID = DFHPF12
  3435        GO TO 9500-PF12.
  3436
  3437     IF FUNCTL NOT = ZEROS AND EIBAID NOT = DFHENTER
  3438        IF FUNCTI = 'A' OR = SPACES
  3439           NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL6509.cbl
  3440           ELSE
  3441           MOVE ER-0050          TO EMI-ERROR
  3442           MOVE -1 TO FUNCTL
  3443           MOVE AL-UABON TO FUNCTA PFENTERA
  3444           GO TO 2002-INPUT-ERROR.
  3445
  3446     IF EIBAID = DFHPF1
  3447        MOVE NUM-LINES-PER-SCREEN TO ROLL-COUNTER
  3448        GO TO 7400-PAGE-ROUTINE.
  3449
  3450     IF EIBAID = DFHPF2
  3451        SUBTRACT NUM-LINES-PER-SCREEN FROM ROLL-COUNTER
  3452        GO TO 7400-PAGE-ROUTINE.
  3453
  3454     IF EIBAID = DFHPF3
  3455        MOVE 5                   TO ROLL-COUNTER
  3456        GO TO 7400-PAGE-ROUTINE.
  3457
  3458     IF EIBAID = DFHPF4
  3459        MOVE -5                  TO ROLL-COUNTER
  3460        GO TO 7400-PAGE-ROUTINE.
  3461
  3462     IF EIBAID = DFHPF8
  3463        GO TO 4500-SAVE-DATA.
  3464
  3465     IF EIBAID = DFHENTER
  3466        GO TO 2003-EDIT-DATA.
  3467
  3468     MOVE ER-0029                TO EMI-ERROR.
  3469
  3470 2002-INPUT-ERROR.
  3471     MOVE -1                     TO PFENTERL
  3472     MOVE AL-UNBON               TO PFENTERA
  3473     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3474     GO TO 8200-SEND-DATAONLY.
  3475
  3476 2003-EDIT-DATA.
  3477
  3478     IF FUNCTI = 'L'
  3479         NEXT SENTENCE
  3480     ELSE
  3481         IF NOT MODIFY-CAP
  3482             MOVE 'UPDATE'       TO  SM-READ
  3483             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  3484             MOVE ER-0070        TO  EMI-ERROR
  3485             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3486             GO TO 8100-SEND-INITIAL-MAP.
  3487
  3488     IF FUNCTL = ZEROS OR FUNCTI = SPACES
  3489        GO TO 4000-CHANGE-ROUTINE.
  3490
  3491     IF (FUNCTI = 'S' OR = 'D' OR = 'Q' OR
  3492                = 'I' OR = 'A' OR = 'L')
  3493         NEXT SENTENCE
  3494     ELSE
  3495         MOVE ER-0023            TO EMI-ERROR
  3496         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3497         MOVE AL-UABON           TO FUNCTA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL6509.cbl
  3498         MOVE -1                 TO FUNCTL
  3499         GO TO 8200-SEND-DATAONLY.
  3500
  3501     IF FUNCTI = 'D'  OR = 'I' OR = 'L'
  3502        PERFORM 2500-LINE-CHECK THRU 2599-EXIT
  3503        ELSE
  3504        IF LINE1L NOT = ZEROS OR
  3505           LINE2L NOT = ZEROS
  3506           MOVE ER-0030          TO EMI-ERROR
  3507           MOVE -1               TO LINE1L
  3508           MOVE AL-UNBON         TO LINE1A LINE2A
  3509           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3510           GO TO 8200-SEND-DATAONLY.
  3511
  3512     IF FUNCTI = 'A'
  3513        GO TO 5000-ADD-NEW-LINES.
  3514     IF FUNCTI = 'Q'
  3515        GO TO 9410-RETURN.
  3516     IF FUNCTI = 'S'
  3517        GO TO 4500-SAVE-DATA.
  3518     IF PI-TOTAL-LINES = 0
  3519        MOVE ER-0048             TO EMI-ERROR
  3520        MOVE -1                  TO FUNCTL
  3521        MOVE AL-UNBON            TO FUNCTA
  3522        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3523        GO TO 8200-SEND-DATAONLY.
  3524     IF FUNCTI = 'L'
  3525        GO TO 5500-LOOKUP.
  3526     IF FUNCTI = 'D'
  3527        GO TO 3000-DELETE-LINES.
  3528
  3529     GO TO 3500-INSERT-LINES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL6509.cbl
  3531 2500-LINE-CHECK.
  3532     IF LINE1L = ZEROS AND
  3533        LINE2L = ZEROS
  3534        MOVE ER-0069             TO EMI-ERROR
  3535        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3536        MOVE -1                  TO LINE1L
  3537        GO TO 8200-SEND-DATAONLY.
  3538
  3539     IF LINE1L NOT = ZEROS
  3540        IF LINE1I NOT NUMERIC OR
  3541           LINE1I > PI-TOTAL-LINES
  3542           MOVE ER-0031          TO EMI-ERROR
  3543           MOVE AL-UNBON         TO LINE1A
  3544           MOVE -1               TO LINE1L
  3545           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3546           GO TO 8200-SEND-DATAONLY
  3547         ELSE
  3548           IF LINE2L = ZEROS
  3549              MOVE 1             TO LINE2I
  3550              IF FUNCTI = 'I'
  3551                  GO TO 2510-MAX-CHECK
  3552               ELSE NEXT SENTENCE
  3553           ELSE
  3554              IF FUNCTI = 'I'
  3555                 GO TO 2510-MAX-CHECK
  3556              ELSE
  3557                 IF LINE2I NOT NUMERIC
  3558                    MOVE AL-UNBON TO LINE2A
  3559                    MOVE ER-0032  TO EMI-ERROR
  3560                    MOVE -1       TO LINE2L
  3561                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3562                    GO TO 8200-SEND-DATAONLY
  3563                 ELSE
  3564                    NEXT SENTENCE
  3565     ELSE
  3566        IF LINE2L = ZEROS
  3567           NEXT SENTENCE
  3568         ELSE
  3569           MOVE -1               TO LINE2L
  3570           MOVE ER-0041          TO EMI-ERROR
  3571           MOVE AL-UNBON         TO LINE2A
  3572           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3573           GO TO 8200-SEND-DATAONLY.
  3574     GO TO 2599-EXIT.
  3575 2510-MAX-CHECK.
  3576     IF LINE2I NOT NUMERIC
  3577        MOVE -1                  TO LINE2L
  3578        MOVE ER-0032             TO EMI-ERROR
  3579        MOVE AL-UNBON            TO LINE2A
  3580        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3581        GO TO 8200-SEND-DATAONLY
  3582        ELSE
  3583        COMPUTE ROLL-COUNTER = LINE2I + PI-TOTAL-LINES
  3584        IF ROLL-COUNTER GREATER THAN MAX-LINES
  3585           MOVE -1               TO LINE2L
  3586           MOVE ER-0044          TO EMI-ERROR
  3587           MOVE AL-UNBON         TO LINE2A
  3588           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL6509.cbl
  3589           GO TO 8200-SEND-DATAONLY.
  3590 2599-EXIT.
  3591      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL6509.cbl
  3593 3000-DELETE-LINES.
  3594     IF LINE2L = ZEROS AND LINE2I = 1
  3595        MOVE LINE1I              TO LINE2I.
  3596
  3597     IF LINE2I > PI-TOTAL-LINES OR < LINE1I
  3598        MOVE ER-0049             TO EMI-ERROR
  3599        MOVE AL-UNBON            TO LINE2A
  3600        MOVE -1                  TO LINE2L
  3601        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3602        GO TO 8200-SEND-DATAONLY.
  3603
  3604     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  3605     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3606             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3607             SC-INDX > NUM-LINES-PER-SCREEN
  3608     SET TB-INDX TO LINE1I.
  3609
  3610     PERFORM 3050-CHECK-FOR-CURRENT-DATE
  3611        UNTIL TB-INDX > LINE2I.
  3612
  3613     IF NOT EMI-NO-ERRORS
  3614        GO TO 8200-SEND-DATAONLY.
  3615
  3616     SET TB-INDX TO LINE1I
  3617     COMPUTE ROLL-COUNTER = LINE2I - LINE1I + 1.
  3618
  3619     IF LINE2I NOT = PI-TOTAL-LINES
  3620        SET TB-INDX1 TO LINE2I
  3621        SET TB-INDX1 UP BY 1
  3622        PERFORM 3100-DELETE-TABLE-ENTRIES
  3623                UNTIL TB-INDX1 > PI-TOTAL-LINES.
  3624
  3625     PERFORM 3150-BLANK-TABLE-ENTRIES
  3626             ROLL-COUNTER TIMES
  3627     SUBTRACT ROLL-COUNTER FROM PI-TOTAL-LINES
  3628
  3629     IF PI-CURRENT-LINE > PI-TOTAL-LINES
  3630        MOVE PI-TOTAL-LINES      TO PI-CURRENT-LINE
  3631        SUBTRACT 1 FROM PI-CURRENT-LINE.
  3632
  3633     SET TB-INDX  TO PI-CURRENT-LINE
  3634     MOVE LOW-VALUES             TO EL6509AI
  3635
  3636     IF PI-CURRENT-LINE > ZERO
  3637         PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3638             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3639             SC-INDX > NUM-LINES-PER-SCREEN
  3640         PERFORM 7200-PUT-TEMP-STOR  THRU 7249-EXIT.
  3641
  3642     MOVE '1'                    TO PI-UPDATE-SW.
  3643     IF PI-TOTAL-LINES = ZEROS
  3644        MOVE ZEROS               TO PI-CURRENT-LINE.
  3645     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL6509.cbl
  3647
  3648 3050-CHECK-FOR-CURRENT-DATE.
  3649     IF (REC-LAST-MAINT-DT (TB-INDX) = SAVE-BIN-DATE)
  3650        OR (PI-PROCESSOR-ID = 'PEMA' OR 'AJRA')
  3651        NEXT SENTENCE
  3652     ELSE
  3653        MOVE ER-3786             TO EMI-ERROR
  3654        MOVE AL-UNBON            TO FUNCTA
  3655        MOVE -1                  TO FUNCTL
  3656        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3657        GO TO 8200-SEND-DATAONLY.
  3658
  3659     IF REC-LAST-MAINT-BY (TB-INDX) = PI-PROCESSOR-ID
  3660        OR (PI-PROCESSOR-ID = 'PEMA' OR 'AJRA')
  3661        NEXT SENTENCE
  3662     ELSE
  3663        MOVE ER-3787             TO EMI-ERROR
  3664        MOVE AL-UNBON            TO FUNCTA
  3665        MOVE -1                  TO FUNCTL
  3666        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3667        GO TO 8200-SEND-DATAONLY.
  3668
  3669     SET TB-INDX TB-INDX1 UP BY 1.
  3670
  3671 3100-DELETE-TABLE-ENTRIES.
  3672     MOVE REC-ENT (TB-INDX1)     TO REC-ENT (TB-INDX)
  3673     SET TB-INDX TB-INDX1 UP BY 1.
  3674
  3675 3150-BLANK-TABLE-ENTRIES.
  3676     MOVE SPACES                 TO REC-ENT (TB-INDX).
  3677     MOVE LOW-VALUES             TO REC-LAST-MAINT-DT (TB-INDX).
  3678     MOVE ZERO                 TO REC-LAST-MAINT-HHMMSS (TB-INDX).
  3679     SET TB-INDX UP BY 1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL6509.cbl
  3681 3500-INSERT-LINES.
  3682
  3683     PERFORM 7450-SET-INDX THRU 7450-EXIT
  3684     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3685             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3686             SC-INDX > NUM-LINES-PER-SCREEN
  3687
  3688     IF NOT EMI-NO-ERRORS
  3689        GO TO 8200-SEND-DATAONLY.
  3690
  3691     SET TB-INDX TO PI-TOTAL-LINES
  3692     ADD LINE2I TO PI-TOTAL-LINES
  3693     SET TB-INDX1 TO PI-TOTAL-LINES
  3694     PERFORM 3600-INSERT-TABLE-ENTRIES
  3695             UNTIL TB-INDX = LINE1I
  3696     SET TB-INDX UP BY 1.
  3697
  3698     COMPUTE ROLL-COUNTER = PI-CURRENT-LINE + NUM-LINES-PER-SCREEN
  3699     IF TB-INDX NOT LESS THAN ROLL-COUNTER OR
  3700                    LESS THAN PI-CURRENT-LINE
  3701        SET SC-INDX TO 1
  3702        SET SC-INDX DOWN BY 1
  3703     ELSE
  3704        SET ROLL-COUNTER TO TB-INDX
  3705        COMPUTE ROLL-COUNTER = ROLL-COUNTER - PI-CURRENT-LINE
  3706                  + 1
  3707        SET SC-INDX TO ROLL-COUNTER.
  3708
  3709     PERFORM 3150-BLANK-TABLE-ENTRIES LINE2I TIMES
  3710     SET TB-INDX TO PI-CURRENT-LINE
  3711     MOVE LOW-VALUES             TO EL6509AI
  3712
  3713     IF SC-INDX NOT = ZERO
  3714        MOVE -1 TO SC-TEXTL (SC-INDX).
  3715
  3716     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3717            VARYING SC-INDX FROM 1 BY 1 UNTIL
  3718            SC-INDX > NUM-LINES-PER-SCREEN
  3719     PERFORM 7200-PUT-TEMP-STOR  THRU 7249-EXIT
  3720     MOVE '1'                    TO PI-UPDATE-SW.
  3721     GO TO 8100-SEND-INITIAL-MAP.
  3722
  3723 3600-INSERT-TABLE-ENTRIES.
  3724     MOVE REC-ENT (TB-INDX)      TO REC-ENT (TB-INDX1)
  3725     SET TB-INDX TB-INDX1 DOWN BY 1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL6509.cbl
  3727
  3728 4000-CHANGE-ROUTINE.
  3729     PERFORM 7450-SET-INDX THRU 7450-EXIT
  3730     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3731             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3732             SC-INDX > NUM-LINES-PER-SCREEN.
  3733
  3734     IF NOT EMI-NO-ERRORS
  3735        GO TO 8200-SEND-DATAONLY.
  3736
  3737     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT
  3738     MOVE SPACES                 TO ERRMSGBO
  3739     GO TO 8200-SEND-DATAONLY.
  3740
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL6509.cbl
  3742 4500-SAVE-DATA.
  3743     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  3744     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3745             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3746             SC-INDX > NUM-LINES-PER-SCREEN.
  3747     IF NOT EMI-NO-ERRORS
  3748        GO TO 8200-SEND-DATAONLY.
  3749
  3750
  3751* EXEC CICS HANDLE CONDITION
  3752*         NOTFND(4610-ENDBR)
  3753*         NOTOPEN(6000-NOT-OPEN)
  3754*         ENDFILE(4610-ENDBR)
  3755*         END-EXEC.
  3756*    MOVE '"$IJ''                 ! $ #00003700' TO DFHEIV0
  3757     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  3758     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3759     MOVE X'2420233030303033373030' TO DFHEIV0(25:11)
  3760     CALL 'kxdfhei1' USING DFHEIV0
  3761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3762
  3763
  3764 4610-LOOP.
  3765
  3766* EXEC CICS READ
  3767*        DATASET (ERACNT-FILE-ID)
  3768*        RIDFLD  (ERACNT-KEY)
  3769*        SET     (ADDRESS OF NOTE-FILE)
  3770*        GTEQ
  3771*        END-EXEC.
  3772*    MOVE '&"S        G          (   #00003707' TO DFHEIV0
  3773     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3774     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3775     MOVE X'2020233030303033373037' TO DFHEIV0(25:11)
  3776     CALL 'kxdfhei1' USING DFHEIV0,
  3777           ERACNT-FILE-ID,
  3778           DFHEIV20,
  3779           DFHEIV99,
  3780           ERACNT-KEY,
  3781           DFHEIV99,
  3782           DFHEIV99,
  3783           DFHEIV99
  3784     SET ADDRESS OF NOTE-FILE TO
  3785         DFHEIV20
  3786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3787
  3788
  3789     MOVE NT-CONTROL-PRIMARY     TO ERACNT-KEY.
  3790
  3791     IF ERACNT-PARTIAL-KEY NOT = SV-PRIOR-KEY
  3792         MOVE SV-PRIOR-KEY       TO ERACNT-PARTIAL-KEY
  3793         GO TO 4610-ENDBR.
  3794
  3795
  3796* EXEC CICS DELETE
  3797*        DATASET (ERACNT-FILE-ID)
  3798*        RIDFLD  (ERACNT-KEY)
  3799*        END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL6509.cbl
  3800*    MOVE '&(  R                 &   #00003720' TO DFHEIV0
  3801     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  3802     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3803     MOVE X'2020233030303033373230' TO DFHEIV0(25:11)
  3804     CALL 'kxdfhei1' USING DFHEIV0,
  3805           ERACNT-FILE-ID,
  3806           ERACNT-KEY,
  3807           DFHEIV99,
  3808           DFHEIV99,
  3809           DFHEIV99
  3810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3811
  3812
  3813     GO TO 4610-LOOP.
  3814 4610-ENDBR.
  3815
  3816* EXEC CICS GETMAIN
  3817*         LENGTH(ERACNT-LENGTH)
  3818*         SET(ADDRESS OF NOTE-FILE)
  3819*         INITIMG(GETMAIN-SPACE)
  3820*         END-EXEC.
  3821*    MOVE ',"IL                  $   #00003727' TO DFHEIV0
  3822     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  3823     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3824     MOVE X'2020233030303033373237' TO DFHEIV0(25:11)
  3825     CALL 'kxdfhei1' USING DFHEIV0,
  3826           DFHEIV20,
  3827           ERACNT-LENGTH,
  3828           GETMAIN-SPACE
  3829     SET ADDRESS OF NOTE-FILE TO
  3830         DFHEIV20
  3831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3832
  3833
  3834     PERFORM 4700-WRITE-FILE THRU 4799-EXIT
  3835             VARYING TB-INDX FROM 1 BY 1 UNTIL
  3836             TB-INDX > PI-TOTAL-LINES.
  3837
  3838     IF EIBAID = DFHPF8
  3839           GO TO 9550-START-PRINT.
  3840
  3841     GO TO 9410-RETURN.
  3842
  3843 4700-WRITE-FILE.
  3844     MOVE SPACES                 TO  NOTE-FILE.
  3845     ADD 1 TO ERACNT-SEQ
  3846     MOVE ERACNT-KEY             TO  NT-CONTROL-PRIMARY.
  3847     MOVE  'NT'                  TO  NT-FILE-ID.
  3848     MOVE REC-TEXT (TB-INDX)     TO  NT-NOTE-LINE
  3849     MOVE REC-LAST-MAINT-BY (TB-INDX)
  3850                                 TO  NT-LAST-MAINT-BY.
  3851     MOVE REC-LAST-MAINT-HHMMSS (TB-INDX)
  3852                                 TO  NT-LAST-MAINT-HHMMSS.
  3853     MOVE REC-LAST-MAINT-DT (TB-INDX)
  3854                                 TO  NT-LAST-MAINT-DT.
  3855
  3856
  3857* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL6509.cbl
  3858*         DATASET(ERACNT-FILE-ID)
  3859*         FROM(NOTE-FILE)
  3860*         RIDFLD(ERACNT-KEY)
  3861*         END-EXEC.
  3862     MOVE LENGTH OF
  3863      NOTE-FILE
  3864       TO DFHEIV11
  3865*    MOVE '&$ L                  ''   #00003755' TO DFHEIV0
  3866     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3867     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3868     MOVE X'2020233030303033373535' TO DFHEIV0(25:11)
  3869     CALL 'kxdfhei1' USING DFHEIV0,
  3870           ERACNT-FILE-ID,
  3871           NOTE-FILE,
  3872           DFHEIV11,
  3873           ERACNT-KEY,
  3874           DFHEIV99,
  3875           DFHEIV99
  3876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3877
  3878 4799-EXIT.
  3879      EXIT.
  3880
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL6509.cbl
  3882 5000-ADD-NEW-LINES.
  3883     PERFORM 7450-SET-INDX THRU 7450-EXIT
  3884     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3885             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3886             SC-INDX > NUM-LINES-PER-SCREEN
  3887
  3888     IF NOT EMI-NO-ERRORS
  3889        GO TO 8200-SEND-DATAONLY.
  3890
  3891     MOVE PI-TOTAL-LINES         TO  PI-CURRENT-LINE
  3892     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT
  3893     MOVE LOW-VALUES             TO  EL6509AI
  3894     SET TB-INDX TO PI-CURRENT-LINE
  3895     MOVE 'A'                    TO FUNCTI
  3896     MOVE -1                     TO  SC-TEXTL (2)
  3897     MOVE AL-UANON               TO  FUNCTA
  3898     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3899             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3900             SC-INDX > NUM-LINES-PER-SCREEN
  3901     MOVE '1'                              TO PI-UPDATE-SW.
  3902     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL6509.cbl
  3904 5500-LOOKUP.
  3905     PERFORM 7500-READ-TS THRU 7599-EXIT
  3906     SET TB-INDX TO PI-CURRENT-LINE
  3907     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3908             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3909             SC-INDX > NUM-LINES-PER-SCREEN
  3910
  3911     IF NOT EMI-NO-ERRORS
  3912        GO TO 8200-SEND-DATAONLY.
  3913
  3914     MOVE LINE1I                 TO  PI-CURRENT-LINE
  3915     SET TB-INDX TO PI-CURRENT-LINE
  3916     MOVE LOW-VALUES             TO  EL6509AI
  3917     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3918             VARYING SC-INDX FROM 1 BY 1
  3919             UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  3920     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3921     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL6509.cbl
  3923 6000-NOT-OPEN.
  3924     MOVE ER-3788                TO  EMI-ERROR.
  3925     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3926
  3927     IF EIBAID = DFHCLEAR
  3928         GO TO 9410-RETURN
  3929     ELSE
  3930         GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL6509.cbl
  3932 7000-BUILD-TABLE.
  3933
  3934     SET TB-INDX TO 1.
  3935     MOVE ZEROS                  TO  PI-TOTAL-LINES
  3936                                     PI-CURRENT-LINE
  3937                                     PI-TEMP-STOR-ITEMS
  3938                                     PI-UPDATE-SW.
  3939     MOVE LOW-VALUES             TO  EL6509AI.
  3940     PERFORM 7500-READ-TS THRU 7599-EXIT
  3941
  3942****IF TEMP STORAGE IS FOUND, DELETE IT.
  3943     IF PI-TEMP-STOR-ITEMS NOT = ZERO
  3944        PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT
  3945*00792         MOVE ER-0140             TO  EMI-ERROR
  3946*00793         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3947*00794         MULTIPLY PI-TEMP-STOR-ITEMS BY TS-NUM-REC-IN-GROUP
  3948*00795                  PI-TOTAL-LINES
  3949*00796         MOVE 1                   TO  PI-CURRENT-LINE
  3950*00797         SET TB-INDX TO 1
  3951*00798         PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3952*00799                 VARYING SC-INDX FROM 1
  3953*00800                 BY 1 UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  3954*00801         GO TO 8100-SEND-INITIAL-MAP.
  3955     END-IF.
  3956
  3957
  3958* EXEC CICS HANDLE CONDITION
  3959*         NOTFND(7010-ENDBR)
  3960*         NOTOPEN(6000-NOT-OPEN)
  3961*         ENDFILE(7010-ENDBR)
  3962*    END-EXEC.
  3963*    MOVE '"$IJ''                 ! % #00003839' TO DFHEIV0
  3964     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  3965     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3966     MOVE X'2520233030303033383339' TO DFHEIV0(25:11)
  3967     CALL 'kxdfhei1' USING DFHEIV0
  3968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3969
  3970
  3971
  3972* EXEC CICS STARTBR
  3973*         DATASET(ERACNT-FILE-ID)
  3974*         RIDFLD(ERACNT-KEY)
  3975*         KEYLENGTH(ERACNT-START-LENGTH)
  3976*         GENERIC
  3977*         GTEQ
  3978*    END-EXEC.
  3979     MOVE 0
  3980       TO DFHEIV11
  3981*    MOVE '&,   KG    G          &   #00003845' TO DFHEIV0
  3982     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3983     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3984     MOVE X'2020233030303033383435' TO DFHEIV0(25:11)
  3985     CALL 'kxdfhei1' USING DFHEIV0,
  3986           ERACNT-FILE-ID,
  3987           ERACNT-KEY,
  3988           ERACNT-START-LENGTH,
  3989           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL6509.cbl
  3990           DFHEIV99
  3991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3992
  3993
  3994 7001-LOOP.
  3995
  3996* EXEC CICS READNEXT
  3997*         SET(ADDRESS OF NOTE-FILE)
  3998*         DATASET(ERACNT-FILE-ID)
  3999*         RIDFLD(ERACNT-KEY)
  4000*         END-EXEC.
  4001     MOVE 0
  4002       TO DFHEIV11
  4003*    MOVE '&.S                   )   #00003854' TO DFHEIV0
  4004     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4005     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4006     MOVE X'2020233030303033383534' TO DFHEIV0(25:11)
  4007     CALL 'kxdfhei1' USING DFHEIV0,
  4008           ERACNT-FILE-ID,
  4009           DFHEIV20,
  4010           DFHEIV99,
  4011           ERACNT-KEY,
  4012           DFHEIV99,
  4013           DFHEIV11,
  4014           DFHEIV99,
  4015           DFHEIV99
  4016     SET ADDRESS OF NOTE-FILE TO
  4017         DFHEIV20
  4018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4019
  4020
  4021     IF NT-COMPANY-CD NOT = SV-COMPANY-CD
  4022         GO TO 7010-ENDBR.
  4023
  4024     IF (NT-CARRIER = SV-CARRIER)
  4025        AND (NT-GROUPING = SV-GROUPING)
  4026        AND (NT-STATE = SV-STATE)
  4027        AND (NT-ACCOUNT = SV-ACCOUNT)
  4028        AND (NT-RECORD-TYPE = '1')
  4029          MOVE NT-NOTE-LINE TO REC-TEXT (TB-INDX)
  4030          MOVE NT-LAST-MAINT-BY TO REC-LAST-MAINT-BY (TB-INDX)
  4031          MOVE NT-LAST-MAINT-DT TO REC-LAST-MAINT-DT (TB-INDX)
  4032          MOVE NT-LAST-MAINT-HHMMSS TO
  4033                         REC-LAST-MAINT-HHMMSS (TB-INDX)
  4034          SET TB-INDX UP BY 1
  4035          GO TO 7001-LOOP.
  4036 7010-ENDBR.
  4037     IF TB-INDX = 1
  4038         MOVE ER-0006            TO EMI-ERROR
  4039         MOVE 'A'                TO FUNCTI
  4040         MOVE -1                 TO SC-TEXTL (1)
  4041         MOVE AL-UANON           TO FUNCTA
  4042         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4043         MOVE ZEROS              TO PI-TOTAL-LINES
  4044         GO TO 8100-SEND-INITIAL-MAP.
  4045
  4046
  4047* EXEC CICS ENDBR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL6509.cbl
  4048*         DATASET(ERACNT-FILE-ID)
  4049*         END-EXEC.
  4050     MOVE 0
  4051       TO DFHEIV11
  4052*    MOVE '&2                    $   #00003885' TO DFHEIV0
  4053     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4054     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4055     MOVE X'2020233030303033383835' TO DFHEIV0(25:11)
  4056     CALL 'kxdfhei1' USING DFHEIV0,
  4057           ERACNT-FILE-ID,
  4058           DFHEIV11,
  4059           DFHEIV99
  4060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4061
  4062
  4063     SET TB-INDX DOWN BY 1.
  4064     SET PI-TOTAL-LINES TO TB-INDX.
  4065     MOVE 1                      TO PI-CURRENT-LINE.
  4066
  4067 7050-FORMAT-LINES.
  4068     SET TB-INDX TO PI-CURRENT-LINE.
  4069     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  4070             VARYING SC-INDX FROM 1
  4071             BY 1 UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  4072     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT
  4073     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL6509.cbl
  4075 7100-FORMAT-SCREEN.
  4076     IF TB-INDX > PI-TOTAL-LINES
  4077        IF FUNCTI NOT = 'A'
  4078           MOVE AL-PANON         TO SC-TEXTA (SC-INDX).
  4079
  4080     IF TB-INDX > PI-TOTAL-LINES
  4081         GO TO 7100-EXIT.
  4082
  4083     MOVE REC-TEXT (TB-INDX)     TO SC-TEXT (SC-INDX).
  4084     MOVE REC-LAST-MAINT-BY (TB-INDX)
  4085                                 TO SC-MAINT-BY (SC-INDX).
  4086     PERFORM 7110-FORMAT-DATE  THRU 7110-EXIT.
  4087     SET ROLL-COUNTER TO TB-INDX.
  4088     MOVE ROLL-COUNTER           TO SC-LIN (SC-INDX).
  4089
  4090     IF NOT MODIFY-CAP
  4091         MOVE AL-PANOF           TO SC-TEXTA (SC-INDX)
  4092         SET TB-INDX UP BY 1
  4093         GO TO 7100-EXIT.
  4094
  4095     IF (REC-LAST-MAINT-BY (TB-INDX) NOT = SPACES AND LOW-VALUES)
  4096          AND
  4097        (REC-LAST-MAINT-BY (TB-INDX) NOT EQUAL PI-PROCESSOR-ID)
  4098          AND
  4099        (PI-PROCESSOR-ID NOT = 'PEMA' AND 'AJRA')
  4100           MOVE AL-PANOF         TO SC-TEXTA (SC-INDX)
  4101           SET TB-INDX UP BY 1
  4102           GO TO 7100-EXIT.
  4103
  4104     IF (REC-LAST-MAINT-DT (TB-INDX) = SAVE-BIN-DATE OR
  4105                              LOW-VALUES OR SPACES)
  4106        OR (PI-PROCESSOR-ID = 'PEMA' OR 'AJRA')
  4107           SET TB-INDX UP BY 1
  4108        ELSE
  4109           MOVE AL-PANOF         TO SC-TEXTA (SC-INDX)
  4110           SET TB-INDX UP BY 1.
  4111
  4112 7100-EXIT.
  4113      EXIT.
  4114
  4115 7110-FORMAT-DATE.
  4116     IF REC-LAST-MAINT-DT (TB-INDX) = LOW-VALUES OR SPACES
  4117            NEXT SENTENCE
  4118      ELSE
  4119        MOVE REC-LAST-MAINT-DT (TB-INDX)
  4120                                 TO DC-BIN-DATE-1
  4121        MOVE SPACES              TO DC-OPTION-CODE
  4122        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  4123        MOVE DC-GREG-DATE-1-MDY  TO SC-MAINT-DT (SC-INDX).
  4124
  4125 7110-EXIT.  EXIT.
  4126
  4127 7200-PUT-TEMP-STOR.
  4128     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT
  4129     SET TS-INDX TO 1
  4130     MOVE 0                      TO PI-TEMP-STOR-ITEMS
  4131     PERFORM 7300-WRITE-TS THRU 7399-EXIT
  4132             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL6509.cbl
  4133             UNTIL TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
  4134 7249-EXIT.
  4135      EXIT.
  4136 7250-DELETE-TEMP-STOR.
  4137
  4138* EXEC CICS HANDLE CONDITION
  4139*         QIDERR(7299-EXIT)
  4140*         END-EXEC.
  4141*    MOVE '"$N                   ! & #00003963' TO DFHEIV0
  4142     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  4143     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4144     MOVE X'2620233030303033393633' TO DFHEIV0(25:11)
  4145     CALL 'kxdfhei1' USING DFHEIV0
  4146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4147
  4148
  4149* EXEC CICS DELETEQ TS
  4150*         QUEUE(QID)
  4151*         END-EXEC.
  4152*    MOVE '*&                    #   #00003966' TO DFHEIV0
  4153     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  4154     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4155     MOVE X'2020233030303033393636' TO DFHEIV0(25:11)
  4156     CALL 'kxdfhei1' USING DFHEIV0,
  4157           QID,
  4158           DFHEIV99
  4159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4160
  4161 7299-EXIT.
  4162     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL6509.cbl
  4164 7300-WRITE-TS.
  4165     MOVE TS-GROUP (TS-INDX)     TO TS-WORK-AREA
  4166     SET TS-INDX UP BY 1
  4167     ADD 1 TO PI-TEMP-STOR-ITEMS
  4168
  4169* EXEC CICS WRITEQ TS
  4170*         FROM(TS-WORK-AREA)
  4171*         QUEUE(QID)
  4172*         LENGTH(TS-LENGTH)
  4173*         ITEM(PI-TEMP-STOR-ITEMS)
  4174*         END-EXEC.
  4175*    MOVE '*" I                  ''   #00003976' TO DFHEIV0
  4176     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  4177     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4178     MOVE X'2020233030303033393736' TO DFHEIV0(25:11)
  4179     CALL 'kxdfhei1' USING DFHEIV0,
  4180           QID,
  4181           TS-WORK-AREA,
  4182           TS-LENGTH,
  4183           PI-TEMP-STOR-ITEMS,
  4184           DFHEIV99,
  4185           DFHEIV99
  4186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4187
  4188 7399-EXIT.
  4189     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL6509.cbl
  4191 7400-PAGE-ROUTINE.
  4192
  4193     IF PFENTERL NOT = ZEROS
  4194        MOVE -1                  TO PFENTERL
  4195        ELSE
  4196        MOVE -1                  TO FUNCTL.
  4197
  4198     IF PI-TOTAL-LINES = 0
  4199        MOVE ER-0047             TO EMI-ERROR
  4200        MOVE -1                  TO FUNCTL
  4201        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4202        GO TO 8200-SEND-DATAONLY.
  4203
  4204     COMPUTE TEMP-CURR-LINE = PI-CURRENT-LINE + ROLL-COUNTER.
  4205
  4206     IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
  4207        MOVE ER-0067             TO EMI-ERROR
  4208        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4209        MOVE 1 TO TEMP-CURR-LINE.
  4210
  4211     IF TEMP-CURR-LINE GREATER THAN PI-TOTAL-LINES
  4212        MOVE ER-0066             TO EMI-ERROR
  4213        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4214        COMPUTE TEMP-CURR-LINE = PI-TOTAL-LINES + 1
  4215                               - NUM-LINES-PER-SCREEN
  4216        IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
  4217           MOVE 1                TO TEMP-CURR-LINE.
  4218
  4219     PERFORM 7450-SET-INDX THRU 7450-EXIT
  4220     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  4221             VARYING SC-INDX FROM 1 BY 1 UNTIL
  4222             SC-INDX > NUM-LINES-PER-SCREEN
  4223
  4224     IF EMI-ERROR = ER-0066 OR = ER-0067 OR = ZEROS
  4225        NEXT SENTENCE
  4226        ELSE
  4227        GO TO 8200-SEND-DATAONLY.
  4228
  4229     MOVE TEMP-CURR-LINE         TO PI-CURRENT-LINE
  4230     SET TB-INDX TO PI-CURRENT-LINE
  4231     MOVE LOW-VALUES             TO EL6509AI
  4232     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  4233             VARYING SC-INDX FROM 1 BY 1
  4234             UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  4235     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  4236     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL6509.cbl
  4238
  4239 7450-SET-INDX.
  4240     IF PI-CURRENT-LINE = 0 AND PI-TOTAL-LINES = 0
  4241        SET TB-INDX TO 1
  4242     ELSE
  4243        PERFORM 7500-READ-TS THRU 7599-EXIT
  4244        IF PI-CURRENT-LINE = 0
  4245           SET TB-INDX TO 1
  4246        ELSE
  4247           SET TB-INDX TO PI-CURRENT-LINE.
  4248 7450-EXIT.
  4249      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL6509.cbl
  4251 7500-READ-TS.
  4252
  4253* EXEC CICS HANDLE CONDITION
  4254*         QIDERR(7590-TS-QIDERR)
  4255*         ITEMERR(7585-QID-ITEMERR)
  4256*         END-EXEC.
  4257*    MOVE '"$N<                  ! '' #00004046' TO DFHEIV0
  4258     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  4259     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4260     MOVE X'2720233030303034303436' TO DFHEIV0(25:11)
  4261     CALL 'kxdfhei1' USING DFHEIV0
  4262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4263
  4264     SET TS-INDX TO 1.
  4265     MOVE 1                      TO QID-ITEM.
  4266 7501-LOOP.
  4267
  4268* EXEC CICS READQ TS
  4269*         INTO(TS-WORK-AREA)
  4270*         QUEUE(QID)
  4271*         LENGTH(TS-LENGTH)
  4272*         ITEM(QID-ITEM)
  4273*         END-EXEC.
  4274*    MOVE '*$II   L              ''   #00004053' TO DFHEIV0
  4275     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4276     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4277     MOVE X'2020233030303034303533' TO DFHEIV0(25:11)
  4278     CALL 'kxdfhei1' USING DFHEIV0,
  4279           QID,
  4280           TS-WORK-AREA,
  4281           TS-LENGTH,
  4282           QID-ITEM,
  4283           DFHEIV99,
  4284           DFHEIV99
  4285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4286
  4287     MOVE TS-WORK-AREA           TO TS-GROUP (TS-INDX).
  4288     SET TS-INDX UP BY 1.
  4289     ADD 1 TO QID-ITEM.
  4290     GO TO 7501-LOOP.
  4291
  4292 7585-QID-ITEMERR.
  4293     IF EIBTRNID NOT = TRANS-ID
  4294        SUBTRACT 1 FROM QID-ITEM
  4295        MOVE QID-ITEM            TO PI-TEMP-STOR-ITEMS.
  4296        GO TO 7599-EXIT.
  4297
  4298 7590-TS-QIDERR.
  4299     IF EIBTRNID = TRANS-ID
  4300        AND EIBAID = DFHCLEAR
  4301           GO TO 9410-RETURN.
  4302     IF EIBTRNID = TRANS-ID
  4303        MOVE ER-0033             TO EMI-ERROR
  4304        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4305        GO TO 8100-SEND-INITIAL-MAP.
  4306
  4307 7599-EXIT.
  4308      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL6509.cbl
  4309
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL6509.cbl
  4311 7600-UPDATE-TABLE-FROM-SCREEN.
  4312
  4313     IF SC-TEXTL (SC-INDX) NOT = ZEROS
  4314         IF TB-INDX NOT > PI-TOTAL-LINES
  4315             PERFORM 7700-MOVE-DATA THRU 7700-EXIT
  4316             SET TB-INDX UP BY 1
  4317         ELSE
  4318             IF PI-TOTAL-LINES = MAX-LINES
  4319                 MOVE ER-0051    TO EMI-ERROR
  4320                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4321                 GO TO 8200-SEND-DATAONLY
  4322             ELSE
  4323                 PERFORM 7700-MOVE-DATA THRU 7700-EXIT
  4324                 SET TB-INDX UP BY 1
  4325                 ADD 1 TO PI-TOTAL-LINES
  4326     ELSE
  4327        IF TB-INDX NOT > PI-TOTAL-LINES
  4328           SET TB-INDX UP BY 1.
  4329
  4330 7699-EXIT.
  4331      EXIT.
  4332
  4333 7700-MOVE-DATA.
  4334     MOVE '1'                    TO PI-UPDATE-SW.
  4335
  4336     IF SC-TEXTL (SC-INDX) NOT = ZEROS
  4337         MOVE SC-TEXT (SC-INDX)  TO REC-TEXT (TB-INDX).
  4338
  4339     IF REC-LAST-MAINT-DT (TB-INDX) = LOW-VALUES OR SPACES
  4340        MOVE PI-PROCESSOR-ID     TO REC-LAST-MAINT-BY (TB-INDX)
  4341                                  SC-MAINT-BY (SC-INDX)
  4342        MOVE EIBTIME            TO REC-LAST-MAINT-HHMMSS (TB-INDX)
  4343        MOVE SAVE-BIN-DATE       TO REC-LAST-MAINT-DT (TB-INDX).
  4344
  4345     PERFORM 7110-FORMAT-DATE.
  4346
  4347 7700-EXIT.
  4348      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL6509.cbl
  4350 8100-SEND-INITIAL-MAP.
  4351     MOVE SAVE-DATE              TO DATEO.
  4352     MOVE EIBTIME                TO TIME-IN.
  4353     MOVE TIME-OUT               TO TIMEO.
  4354     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  4355     MOVE PI-PROCESSOR-ID        TO USERIDO.
  4356     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGBO.
  4357     MOVE VG-CARRIER             TO CARRO.
  4358     MOVE VG-GROUPING            TO GROUPO.
  4359     MOVE VG-STATE               TO STATEO.
  4360     MOVE VG-ACCOUNT             TO ACCTO.
  4361     MOVE PI-TOTAL-LINES         TO TOTI.
  4362     MOVE PI-ACCNAME             TO NAMEO.
  4363     MOVE -1                     TO FUNCTL.
  4364
  4365
  4366* EXEC CICS SEND
  4367*         MAP(MAP-NAME)
  4368*         MAPSET(MAPSET-NAME)
  4369*         FROM(EL6509AO)
  4370*         ERASE
  4371*         CURSOR
  4372*         END-EXEC.
  4373     MOVE LENGTH OF
  4374      EL6509AO
  4375       TO DFHEIV12
  4376     MOVE -1
  4377       TO DFHEIV11
  4378*    MOVE '8$     CT  E    H L F ,   #00004137' TO DFHEIV0
  4379     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  4380     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4381     MOVE X'2020233030303034313337' TO DFHEIV0(25:11)
  4382     CALL 'kxdfhei1' USING DFHEIV0,
  4383           MAP-NAME,
  4384           EL6509AO,
  4385           DFHEIV12,
  4386           MAPSET-NAME,
  4387           DFHEIV99,
  4388           DFHEIV99,
  4389           DFHEIV99,
  4390           DFHEIV11,
  4391           DFHEIV99,
  4392           DFHEIV99,
  4393           DFHEIV99
  4394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4395
  4396
  4397     GO TO 9100-RETURN-TRAN.
  4398
  4399 8200-SEND-DATAONLY.
  4400     MOVE EIBTIME                TO TIME-IN
  4401     MOVE TIME-OUT               TO TIMEO
  4402     MOVE PI-COMPANY-ID          TO CMPNYIDO
  4403     MOVE PI-PROCESSOR-ID        TO USERIDO
  4404     MOVE PI-TOTAL-LINES         TO TOTI
  4405
  4406     IF NOT EMI-NO-ERRORS
  4407        MOVE EMI-MESSAGE-AREA (1) TO ERRMSGBO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL6509.cbl
  4408        ELSE
  4409        MOVE -1                  TO FUNCTL.
  4410
  4411
  4412* EXEC CICS SEND
  4413*         MAP(MAP-NAME)
  4414*         MAPSET(MAPSET-NAME)
  4415*         FROM(EL6509AO)
  4416*         DATAONLY
  4417*         CURSOR
  4418*         END-EXEC.
  4419     MOVE LENGTH OF
  4420      EL6509AO
  4421       TO DFHEIV12
  4422     MOVE -1
  4423       TO DFHEIV11
  4424*    MOVE '8$D    CT       H L F ,   #00004159' TO DFHEIV0
  4425     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  4426     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4427     MOVE X'2020233030303034313539' TO DFHEIV0(25:11)
  4428     CALL 'kxdfhei1' USING DFHEIV0,
  4429           MAP-NAME,
  4430           EL6509AO,
  4431           DFHEIV12,
  4432           MAPSET-NAME,
  4433           DFHEIV99,
  4434           DFHEIV99,
  4435           DFHEIV99,
  4436           DFHEIV11,
  4437           DFHEIV99,
  4438           DFHEIV99,
  4439           DFHEIV99
  4440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4441
  4442
  4443     GO TO 9100-RETURN-TRAN.
  4444
  4445 8300-SEND-TEXT.
  4446
  4447* EXEC CICS SEND TEXT
  4448*         FROM(LOGOFF-TEXT)
  4449*         ERASE
  4450*         FREEKB
  4451*         LENGTH(LOGOFF-LENGTH)
  4452*         END-EXEC.
  4453*    MOVE '8&      T  E F  H   F -   #00004170' TO DFHEIV0
  4454     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  4455     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  4456     MOVE X'2020233030303034313730' TO DFHEIV0(25:11)
  4457     CALL 'kxdfhei1' USING DFHEIV0,
  4458           LOGOFF-TEXT,
  4459           LOGOFF-LENGTH,
  4460           DFHEIV99,
  4461           DFHEIV99,
  4462           DFHEIV99,
  4463           DFHEIV99,
  4464           DFHEIV99,
  4465           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL6509.cbl
  4466           DFHEIV99,
  4467           DFHEIV99,
  4468           DFHEIV99,
  4469           DFHEIV99
  4470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4471
  4472
  4473     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  4474
  4475
  4476* EXEC CICS RETURN
  4477*         END-EXEC.
  4478*    MOVE '.(                    &   #00004179' TO DFHEIV0
  4479     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4480     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4481     MOVE X'2020233030303034313739' TO DFHEIV0(25:11)
  4482     CALL 'kxdfhei1' USING DFHEIV0,
  4483           DFHEIV99,
  4484           DFHEIV99,
  4485           DFHEIV99,
  4486           DFHEIV99,
  4487           DFHEIV99
  4488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4489
  4490
  4491 8800-UNAUTHORIZED-ACCESS.
  4492     MOVE UNACCESS-MSG           TO LOGOFF-MSG
  4493     GO TO 8300-SEND-TEXT.
  4494
  4495 9000-RETURN-CICS.
  4496     IF PI-CHANGES-MADE
  4497        MOVE ER-0045             TO EMI-ERROR
  4498        MOVE -1                  TO FUNCTL
  4499        MOVE SPACES              TO PFENTERO
  4500        MOVE AL-UNNOF            TO PFENTERA
  4501        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4502        GO TO 8200-SEND-DATAONLY.
  4503
  4504     MOVE EIBAID                 TO PI-ENTRY-CD-1
  4505     MOVE XCTL-005               TO PGM-NAME.
  4506     GO TO 9300-XCTL.
  4507
  4508 9100-RETURN-TRAN.
  4509     MOVE SCRN-NUMBER            TO PI-CURRENT-SCREEN-NO
  4510     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
  4511
  4512* EXEC CICS RETURN
  4513*         TRANSID(TRANS-ID)
  4514*         COMMAREA(PROGRAM-INTERFACE-BLOCK)
  4515*         LENGTH(PI-COMM-LENGTH)
  4516*         END-EXEC.
  4517*    MOVE '.(CT                  &   #00004202' TO DFHEIV0
  4518     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  4519     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4520     MOVE X'2020233030303034323032' TO DFHEIV0(25:11)
  4521     CALL 'kxdfhei1' USING DFHEIV0,
  4522           TRANS-ID,
  4523           PROGRAM-INTERFACE-BLOCK,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL6509.cbl
  4524           PI-COMM-LENGTH,
  4525           DFHEIV99,
  4526           DFHEIV99
  4527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4528
  4529
  4530
  4531 9200-RETURN-MAIN-MENU.
  4532     IF PI-CHANGES-MADE
  4533        MOVE -1                  TO FUNCTL
  4534        MOVE SPACES              TO PFENTERO
  4535        MOVE AL-UNNOF            TO PFENTERA
  4536        MOVE ER-0045             TO EMI-ERROR
  4537        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4538        GO TO 8200-SEND-DATAONLY.
  4539
  4540     MOVE XCTL-126               TO PGM-NAME.
  4541
  4542 9300-XCTL.
  4543     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  4544
  4545* EXEC CICS XCTL
  4546*         PROGRAM  (PGM-NAME)
  4547*         COMMAREA (PROGRAM-INTERFACE-BLOCK)
  4548*         LENGTH   (PI-COMM-LENGTH)
  4549*         END-EXEC.
  4550*    MOVE '.$C                   $   #00004222' TO DFHEIV0
  4551     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4552     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4553     MOVE X'2020233030303034323232' TO DFHEIV0(25:11)
  4554     CALL 'kxdfhei1' USING DFHEIV0,
  4555           PGM-NAME,
  4556           PROGRAM-INTERFACE-BLOCK,
  4557           PI-COMM-LENGTH
  4558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4559
  4560
  4561 9400-CLEAR.
  4562
  4563     IF PI-CHANGES-MADE
  4564         MOVE ER-0045            TO EMI-ERROR
  4565         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4566         IF PI-CURRENT-LINE GREATER THAN ZERO
  4567             PERFORM 7500-READ-TS THRU 7599-EXIT
  4568             SET TB-INDX TO PI-CURRENT-LINE
  4569             PERFORM 7100-FORMAT-SCREEN  THRU  7100-EXIT
  4570                 VARYING SC-INDX FROM 1 BY 1 UNTIL
  4571                 SC-INDX GREATER NUM-LINES-PER-SCREEN
  4572         END-IF
  4573         GO TO 8100-SEND-INITIAL-MAP.
  4574
  4575 9410-RETURN.
  4576     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME
  4577     GO TO 9300-XCTL.
  4578
  4579 9500-PF12.
  4580     IF PI-CHANGES-MADE
  4581        MOVE -1                  TO FUNCTL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL6509.cbl
  4582        MOVE SPACES              TO PFENTERO
  4583        MOVE AL-UNNOF            TO PFENTERA
  4584        MOVE ER-0045             TO EMI-ERROR
  4585        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4586        GO TO 8200-SEND-DATAONLY.
  4587
  4588     MOVE 'EL010'                TO PGM-NAME
  4589     GO TO 9300-XCTL.
  4590
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL6509.cbl
  4592 9550-START-PRINT.
  4593     PERFORM 7200-PUT-TEMP-STOR     THRU 7249-EXIT.
  4594
  4595     MOVE SPACES                 TO  ELCNTL-KEY.
  4596     MOVE PI-COMPANY-ID          TO  ELCNTL-COMPANY.
  4597     MOVE '1'                    TO  ELCNTL-REC-TYPE.
  4598     MOVE ZEROS                  TO  ELCNTL-SEQ-NO.
  4599
  4600
  4601* EXEC CICS HANDLE CONDITION
  4602*              NOTFND(9410-RETURN)
  4603*              END-EXEC.
  4604*    MOVE '"$I                   ! ( #00004267' TO DFHEIV0
  4605     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4606     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4607     MOVE X'2820233030303034323637' TO DFHEIV0(25:11)
  4608     CALL 'kxdfhei1' USING DFHEIV0
  4609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4610
  4611
  4612
  4613* EXEC CICS READ DATASET(ELCNTL-FILE-ID)
  4614*                   SET (ADDRESS OF CONTROL-FILE)
  4615*                   RIDFLD(ELCNTL-KEY)
  4616*                   END-EXEC.
  4617*    MOVE '&"S        E          (   #00004271' TO DFHEIV0
  4618     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4619     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4620     MOVE X'2020233030303034323731' TO DFHEIV0(25:11)
  4621     CALL 'kxdfhei1' USING DFHEIV0,
  4622           ELCNTL-FILE-ID,
  4623           DFHEIV20,
  4624           DFHEIV99,
  4625           ELCNTL-KEY,
  4626           DFHEIV99,
  4627           DFHEIV99,
  4628           DFHEIV99
  4629     SET ADDRESS OF CONTROL-FILE TO
  4630         DFHEIV20
  4631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4632
  4633
  4634
  4635* EXEC CICS HANDLE CONDITION
  4636*                TERMIDERR (9560-BAD-TERMID)
  4637*                TRANSIDERR (9570-BAD-TRANSID)
  4638*                END-EXEC.
  4639*    MOVE '"$[\                  ! ) #00004276' TO DFHEIV0
  4640     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  4641     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4642     MOVE X'2920233030303034323736' TO DFHEIV0(25:11)
  4643     CALL 'kxdfhei1' USING DFHEIV0
  4644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4645
  4646
  4647     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
  4648*        MOVE EIBTRMID       TO CF-FORMS-PRINTER-ID
  4649
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL6509.cbl
  4650* EXEC CICS START
  4651*                  TRANSID (W-PRINT-TRANS)
  4652*                  TERMID (CF-FORMS-PRINTER-ID)
  4653*                  FROM (PROGRAM-INTERFACE-BLOCK)
  4654*                  LENGTH (PI-COMM-LENGTH)
  4655*        END-EXEC
  4656*    MOVE '0( LF                 0   #00004283' TO DFHEIV0
  4657     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  4658     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  4659     MOVE X'2020233030303034323833' TO DFHEIV0(25:11)
  4660     CALL 'kxdfhei1' USING DFHEIV0,
  4661           DFHEIV99,
  4662           W-PRINT-TRANS,
  4663           DFHEIV99,
  4664           PROGRAM-INTERFACE-BLOCK,
  4665           PI-COMM-LENGTH,
  4666           DFHEIV99,
  4667           DFHEIV99,
  4668           DFHEIV99,
  4669           DFHEIV99,
  4670           DFHEIV99,
  4671           DFHEIV99,
  4672           DFHEIV99,
  4673           DFHEIV99,
  4674           DFHEIV99,
  4675           DFHEIV99
  4676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4677     ELSE
  4678
  4679* EXEC CICS START
  4680*                  TRANSID (W-PRINT-TRANS)
  4681*                  TERMID (CF-FORMS-PRINTER-ID)
  4682*                  FROM (PROGRAM-INTERFACE-BLOCK)
  4683*                  LENGTH (PI-COMM-LENGTH)
  4684*        END-EXEC.
  4685*    MOVE '0( LFT                0   #00004290' TO DFHEIV0
  4686     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  4687     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  4688     MOVE X'2020233030303034323930' TO DFHEIV0(25:11)
  4689     CALL 'kxdfhei1' USING DFHEIV0,
  4690           DFHEIV99,
  4691           W-PRINT-TRANS,
  4692           DFHEIV99,
  4693           PROGRAM-INTERFACE-BLOCK,
  4694           PI-COMM-LENGTH,
  4695           CF-FORMS-PRINTER-ID,
  4696           DFHEIV99,
  4697           DFHEIV99,
  4698           DFHEIV99,
  4699           DFHEIV99,
  4700           DFHEIV99,
  4701           DFHEIV99,
  4702           DFHEIV99,
  4703           DFHEIV99,
  4704           DFHEIV99
  4705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4706
  4707
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL6509.cbl
  4708     MOVE -1 TO LINE1L.
  4709     MOVE ER-3784    TO EMI-ERROR
  4710     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4711     GO TO 8200-SEND-DATAONLY.
  4712
  4713 9560-BAD-TERMID.
  4714     MOVE ER-0412    TO EMI-ERROR
  4715     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4716     GO TO 8200-SEND-DATAONLY.
  4717
  4718 9570-BAD-TRANSID.
  4719     MOVE ER-0413    TO EMI-ERROR
  4720     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4721     GO TO 8200-SEND-DATAONLY.
  4722
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL6509.cbl
  4724 9600-PGMID-ERROR.
  4725
  4726* EXEC CICS HANDLE CONDITION
  4727*         PGMIDERR(8300-SEND-TEXT)
  4728*         END-EXEC.
  4729*    MOVE '"$L                   ! * #00004314' TO DFHEIV0
  4730     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  4731     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4732     MOVE X'2A20233030303034333134' TO DFHEIV0(25:11)
  4733     CALL 'kxdfhei1' USING DFHEIV0
  4734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4735
  4736
  4737     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  4738     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  4739     MOVE XCTL-005               TO  PGM-NAME.
  4740     MOVE PGM-NAME               TO  LOGOFF-PGM.
  4741     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  4742
  4743     GO TO 9300-XCTL.
  4744
  4745 9700-LINK-DATE-CONVERT.
  4746
  4747     MOVE LINK-ELDATCV           TO  PGM-NAME.
  4748
  4749* EXEC CICS LINK
  4750*        PROGRAM    (PGM-NAME)
  4751*        COMMAREA   (DATE-CONVERSION-DATA)
  4752*        LENGTH     (DC-COMM-LENGTH)
  4753*        END-EXEC.
  4754*    MOVE '."C                   ''   #00004329' TO DFHEIV0
  4755     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4756     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4757     MOVE X'2020233030303034333239' TO DFHEIV0(25:11)
  4758     CALL 'kxdfhei1' USING DFHEIV0,
  4759           PGM-NAME,
  4760           DATE-CONVERSION-DATA,
  4761           DC-COMM-LENGTH,
  4762           DFHEIV99,
  4763           DFHEIV99,
  4764           DFHEIV99
  4765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4766
  4767
  4768 9700-EXIT.
  4769     EXIT.
  4770
  4771 9900-ERROR-FORMAT.
  4772     IF NOT EMI-ERRORS-COMPLETE
  4773        MOVE LINK-001            TO  PGM-NAME
  4774
  4775* EXEC CICS LINK
  4776*            PROGRAM(PGM-NAME)
  4777*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  4778*            LENGTH(EMI-COMM-LENGTH)
  4779*            END-EXEC.
  4780*    MOVE '."C                   ''   #00004341' TO DFHEIV0
  4781     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL6509.cbl
  4782     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4783     MOVE X'2020233030303034333431' TO DFHEIV0(25:11)
  4784     CALL 'kxdfhei1' USING DFHEIV0,
  4785           PGM-NAME,
  4786           ERROR-MESSAGE-INTERFACE-BLOCK,
  4787           EMI-COMM-LENGTH,
  4788           DFHEIV99,
  4789           DFHEIV99,
  4790           DFHEIV99
  4791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4792
  4793 9900-EXIT.       EXIT.
  4794
  4795 9990-ABEND.
  4796     MOVE LINK-004               TO  PGM-NAME.
  4797     MOVE DFHEIBLK               TO  EMI-LINE1.
  4798
  4799
  4800* EXEC CICS LINK
  4801*        PROGRAM   (PGM-NAME)
  4802*        COMMAREA  (EMI-LINE1)
  4803*        LENGTH    (72)
  4804*        END-EXEC.
  4805     MOVE 72
  4806       TO DFHEIV11
  4807*    MOVE '."C                   ''   #00004352' TO DFHEIV0
  4808     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4809     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4810     MOVE X'2020233030303034333532' TO DFHEIV0(25:11)
  4811     CALL 'kxdfhei1' USING DFHEIV0,
  4812           PGM-NAME,
  4813           EMI-LINE1,
  4814           DFHEIV11,
  4815           DFHEIV99,
  4816           DFHEIV99,
  4817           DFHEIV99
  4818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4819
  4820
  4821     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSGBO.
  4822     MOVE -1                     TO  FUNCTL.
  4823
  4824     GO TO 8100-SEND-INITIAL-MAP.
  4825
  4826
  4827* GOBACK.
  4828     MOVE '9%                    "   ' TO DFHEIV0
  4829     MOVE 'EL6509' TO DFHEIV1
  4830     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4831     GOBACK.
  4832
  4833 9995-SECURITY-VIOLATION.
  4834*                                COPY ELCSCTP.
  4835******************************************************************
  4836*                                                                *
  4837*                            ELCSCTP                             *
  4838*                            VMOD=2.001                          *
  4839*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL6509.cbl
  4840*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  4841******************************************************************
  4842
  4843
  4844     MOVE EIBDATE          TO SM-JUL-DATE.
  4845     MOVE EIBTRMID         TO SM-TERMID.
  4846     MOVE THIS-PGM         TO SM-PGM.
  4847     MOVE EIBTIME          TO TIME-IN.
  4848     MOVE TIME-OUT         TO SM-TIME.
  4849     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  4850
  4851
  4852* EXEC CICS LINK
  4853*         PROGRAM  ('EL003')
  4854*         COMMAREA (SECURITY-MESSAGE)
  4855*         LENGTH   (80)
  4856*    END-EXEC.
  4857     MOVE 'EL003' TO DFHEIV1
  4858     MOVE 80
  4859       TO DFHEIV11
  4860*    MOVE '."C                   ''   #00004383' TO DFHEIV0
  4861     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4862     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4863     MOVE X'2020233030303034333833' TO DFHEIV0(25:11)
  4864     CALL 'kxdfhei1' USING DFHEIV0,
  4865           DFHEIV1,
  4866           SECURITY-MESSAGE,
  4867           DFHEIV11,
  4868           DFHEIV99,
  4869           DFHEIV99,
  4870           DFHEIV99
  4871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4872
  4873
  4874******************************************************************
  4875
  4876
  4877 9995-EXIT.
  4878     EXIT.
  4879
  4880 9999-DFHBACK SECTION.
  4881     MOVE '9%                    "   ' TO DFHEIV0
  4882     MOVE 'EL6509' TO DFHEIV1
  4883     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4884     GOBACK.
  4885 9999-DFHEXIT.
  4886     IF DFHEIGDJ EQUAL 0001
  4887         NEXT SENTENCE
  4888     ELSE IF DFHEIGDJ EQUAL 2
  4889         GO TO 9400-CLEAR
  4890         DEPENDING ON DFHEIGDI
  4891     ELSE IF DFHEIGDJ EQUAL 3
  4892         GO TO 9990-ABEND,
  4893               9600-PGMID-ERROR
  4894         DEPENDING ON DFHEIGDI
  4895     ELSE IF DFHEIGDJ EQUAL 4
  4896         GO TO 4610-ENDBR,
  4897               6000-NOT-OPEN,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL6509.cbl
  4898               4610-ENDBR
  4899         DEPENDING ON DFHEIGDI
  4900     ELSE IF DFHEIGDJ EQUAL 5
  4901         GO TO 7010-ENDBR,
  4902               6000-NOT-OPEN,
  4903               7010-ENDBR
  4904         DEPENDING ON DFHEIGDI
  4905     ELSE IF DFHEIGDJ EQUAL 6
  4906         GO TO 7299-EXIT
  4907         DEPENDING ON DFHEIGDI
  4908     ELSE IF DFHEIGDJ EQUAL 7
  4909         GO TO 7590-TS-QIDERR,
  4910               7585-QID-ITEMERR
  4911         DEPENDING ON DFHEIGDI
  4912     ELSE IF DFHEIGDJ EQUAL 8
  4913         GO TO 9410-RETURN
  4914         DEPENDING ON DFHEIGDI
  4915     ELSE IF DFHEIGDJ EQUAL 9
  4916         GO TO 9560-BAD-TERMID,
  4917               9570-BAD-TRANSID
  4918         DEPENDING ON DFHEIGDI
  4919     ELSE IF DFHEIGDJ EQUAL 10
  4920         GO TO 8300-SEND-TEXT
  4921         DEPENDING ON DFHEIGDI.
  4922     MOVE '9%                    "   ' TO DFHEIV0
  4923     MOVE 'EL6509' TO DFHEIV1
  4924     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4925     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       30112     Code:       11669
