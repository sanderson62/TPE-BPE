* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    66******************************************************************
    67
    68 ENVIRONMENT DIVISION.
    69
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page   3
* EL6311.cbl
    71 DATA DIVISION.
    72 WORKING-STORAGE SECTION.
    73 01  DFH-START PIC X(04).
    74 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    75 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    76 77  FILLER  PIC X(32)  VALUE '********************************'.
    77 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    78 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    79 77  A1                          PIC S999 COMP-3 VALUE +0.
    80 77  N1                          PIC S999 COMP-3 VALUE +0.
    81 77  N2                          PIC S999 COMP-3 VALUE +0.
    82 77  N3                          PIC S999 COMP-3 VALUE +0.
    83 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    84 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    85 77  WS-REVERSE-SW               PIC X VALUE 'N'.
    86     88  REVERSAL                    VALUE 'Y'.
    87 77  WS-NOTE-SW                  PIC X  VALUE ' '.
    88 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
    89 77  WS-END                      PIC S999 COMP-3 VALUE +0.
    90 77  WS-TALLY                    PIC 99  VALUE ZEROS.
    91 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
    92     88  ERMAIL-FOUND                 VALUE 'Y'.
    93 77  A2                          PIC S9(5) COMP-3 VALUE +0.
    94 77  M1                          PIC S9(5) COMP-3 VALUE +0.
    95 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    96 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
    97     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
    98
    99*    COPY ELCSCTM.
   100******************************************************************
   101*                                                                *
   102*                                                                *
   103*                            ELCSCTM                             *
   104*                            VMOD=2.001                          *
   105*                                                                *
   106*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   107*                                                                *
   108******************************************************************
   109 01  SECURITY-MESSAGE.
   110     12  FILLER                          PIC X(30)
   111            VALUE '** LOGIC SECURITY VIOLATION -'.
   112     12  SM-READ                         PIC X(6).
   113     12  FILLER                          PIC X(5)
   114            VALUE ' PGM='.
   115     12  SM-PGM                          PIC X(6).
   116     12  FILLER                          PIC X(5)
   117            VALUE ' OPR='.
   118     12  SM-PROCESSOR-ID                 PIC X(4).
   119     12  FILLER                          PIC X(6)
   120            VALUE ' TERM='.
   121     12  SM-TERMID                       PIC X(4).
   122     12  FILLER                          PIC XX   VALUE SPACE.
   123     12  SM-JUL-DATE                     PIC 9(5).
   124     12  FILLER                          PIC X    VALUE SPACE.
   125     12  SM-TIME                         PIC 99.99.
   126
   127
   128*    COPY ELCSCRTY.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page   4
* EL6311.cbl
   129******************************************************************
   130*                                                                *
   131*                                                                *
   132*                            ELCSCRTY                            *
   133*                            VMOD=2.001                          *
   134*                                                                *
   135*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   136*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   137*        SAVED IN PI-SECURITY-ADDRESS.                           *
   138*                                                                *
   139******************************************************************
   140 01  SECURITY-CONTROL.
   141     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   142     12  FILLER                       PIC XX    VALUE 'SC'.
   143     12  SC-CREDIT-CODES.
   144         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   145             20  SC-CREDIT-DISPLAY    PIC X.
   146             20  SC-CREDIT-UPDATE     PIC X.
   147     12  SC-CLAIMS-CODES.
   148         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   149             20  SC-CLAIMS-DISPLAY    PIC X.
   150             20  SC-CLAIMS-UPDATE     PIC X.
   151
   152 01  WS-VA-NO-COMM-MESS.
   153     12  FILLER                  PIC X(41) VALUE
   154        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   155 01  WS-OC-MESSAGE.
   156     12  FILLER                  PIC X(43) VALUE
   157        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   158     12  WS-OC-DIS-AMT           PIC -----9.99.
   159     12  FILLER                  PIC X(4) VALUE ' ON '.
   160     12  WS-OC-DATE              PIC X(10).
   161 01  WS-DATE-AREA.
   162     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   163     12  WS-CURRENT-DT.
   164         16  FILLER              PIC X(6)    VALUE SPACES.
   165         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   166     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   167     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   168     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   169
   170 01  STANDARD-AREAS.
   171     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   172     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   173     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   174     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   175     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   176     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   177     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   178     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   179     12  PGM-NAME                PIC X(8).
   180     12  TIME-IN                 PIC S9(7).
   181     12  TIME-OUT-R  REDEFINES TIME-IN.
   182         16  FILLER              PIC X.
   183         16  TIME-OUT            PIC 99V99.
   184         16  FILLER              PIC XX.
   185     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   186     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page   5
* EL6311.cbl
   187     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   188     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   189     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   190     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   191     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   192     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   193     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   194     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   195     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   196     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   197     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   198     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   199     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   200     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   201     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   202     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   203     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   204     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   205     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   206     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   207     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   208     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   209     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   210     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   211     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   212     12  FILE-ID                 PIC X(8).
   213     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   214     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   215     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   216     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   217     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   218     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   219     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   220     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   221     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   222     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   223     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   224     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   225     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   226     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   227     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   228
   229 01  WS-PASS-AREA.
   230     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   231     05  WS-PASS-VADS-REC    PIC X(350).
   232*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   233*                                COPY ELCZREC.
   234******************************************************************
   235*                                                                *
   236*                                                                *
   237*                            ELCZREC.                            *
   238*                                                                *
   239*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   240*                                                                *
   241******************************************************************
   242*-----------------------------------------------------------------
   243*                   C H A N G E   L O G
   244*
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page   6
* EL6311.cbl
   245* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   246*-----------------------------------------------------------------
   247*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   248* EFFECTIVE    NUMBER
   249*-----------------------------------------------------------------
   250* 122011    2011022800001  AJRA  NEW FILE
   251* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   252* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   253* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   254*-----------------------------------------------------------------
   255 01  W-Z-CONTROL-DATA.
   256     05  W-NUMBER-OF-COPIES      PIC  9.
   257     05  FILLER                  PIC  X.
   258     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   259     05  FILLER                  PIC  X.
   260     05  W-DAYS-TO-RESEND        PIC  999.
   261     05  FILLER                  PIC  X.
   262     05  W-FORM-TO-RESEND        PIC  X(4).
   263     05  W-ADD-BAR-CODE          PIC  X.
   264     05  W-PROMPT-LETTER         PIC  X.
   265     05  W-HAS-RETURN-ENV        PIC  X.
   266     05  W-ENCLOSURE-CD          PIC  XXX.
   267     05  FILLER                  PIC  X.
   268     05  W-AUTO-CLOSE-IND        PIC  X.
   269     05  FILLER                  PIC  X.
   270     05  W-LETTER-TO-BENE        PIC  X.
   271     05  FILLER                  PIC  X.
   272     05  W-LETTER-TO-ACCT        PIC  X.
   273     05  FILLER                  PIC  X.
   274     05  W-LETTER-TYPE           PIC  X.
   275     05  FILLER                  PIC  X.
   276     05  W-PRINT-CERTIFICATE     PIC  X.
   277     05  FILLER                  PIC  X.
   278     05  W-REFUND-REQUIRED       PIC  X.
   279     05  FILLER                  PIC  X.
   280     05  W-ONBASE-CODE           PIC  XX.
   281     05  FILLER                  PIC  X.
   282     05  W-ACCT-SUMM             PIC  X.
   283     05  FILLER                  PIC  X.
   284     05  W-CSO-SUMM              PIC  X.
   285     05  FILLER                  PIC  X.
   286     05  W-REASONS-REQUIRED      PIC  X.
   287     05  FILLER                  PIC  X(29).
   288******************************************************************
   289*                                                                *
   290*              A C C E S S   K E Y S                             *
   291*                                                                *
   292******************************************************************
   293
   294 01  ACCESS-KEYS.
   295     12  ERPYAJ-KEY.
   296         16  ERPYAJ-COMPANY-CD       PIC X.
   297         16  ERPYAJ-CARRIER          PIC X.
   298         16  ERPYAJ-GROUPING         PIC X(6).
   299         16  ERPYAJ-FIN-RESP         PIC X(10).
   300         16  ERPYAJ-ACCOUNT          PIC X(10).
   301         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   302         16  ERPYAJ-TYPE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page   7
* EL6311.cbl
   303     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   304     12  ELCERT-KEY.
   305         16  ELCERT-COMPANY-CD       PIC X.
   306         16  ELCERT-CARRIER          PIC X.
   307         16  ELCERT-GROUPING         PIC X(6).
   308         16  ELCERT-STATE            PIC XX.
   309         16  ELCERT-ACCOUNT          PIC X(10).
   310         16  ELCERT-CERT-EFF-DT      PIC XX.
   311         16  ELCERT-CERT-NO.
   312             20  ELCERT-CERT-PRIME   PIC X(10).
   313             20  ELCERT-CERT-SFX     PIC X.
   314
   315     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   316     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   317     12  ELCRTO-KEY.
   318         16  ELCRTO-COMPANY-CD       PIC X.
   319         16  ELCRTO-CARRIER          PIC X.
   320         16  ELCRTO-GROUPING         PIC X(6).
   321         16  ELCRTO-STATE            PIC XX.
   322         16  ELCRTO-ACCOUNT          PIC X(10).
   323         16  ELCRTO-CERT-EFF-DT      PIC XX.
   324         16  ELCRTO-CERT-NO.
   325             20  ELCRTO-CERT-PRIME   PIC X(10).
   326             20  ELCRTO-CERT-SFX     PIC X.
   327         16  ELCRTO-RECORD-TYPE      PIC X.
   328         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   329
   330     12  ELCRTT-KEY.
   331         16  ELCRTT-PRIMARY          PIC X(33).
   332         16  ELCRTT-REC-TYPE         PIC X(1).
   333     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   334     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   335
   336     12  ERPNDB-KEY.
   337         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   338         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   339         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   340         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   341             ERPNDB-BATCH-SEQ-NO     PIC XX.
   342         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   343
   344     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   345     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   346     12  ELLETR-KEY.
   347         16  LETR-COMPANY-CD     PIC X.
   348         16  LETR-LETTER-ID      PIC X(4).
   349         16  LETR-FILLER         PIC X(8).
   350         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   351     12  ERPNDM-KEY.
   352         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   353         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   354         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   355         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   356
   357*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   358     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   359*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   360     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page   8
* EL6311.cbl
   361
   362     12  ERPNDB-ALT-KEY.
   363         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   364         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   365         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   366         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   367         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   368         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   369         16  ERPNDB-CERT-NO.
   370             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   371             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   372         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   373         16  ERPNDB-RECORD-TYPE      PIC X.
   374
   375      12  ERPNDB-CSR-KEY.
   376          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   377          20  ERPNDB-CSR-ID                PIC X(4).
   378          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   379          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   380          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   381
   382     12  ERNOTE-KEY.
   383         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   384         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   385         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   386         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   387         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   388         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   389         16  ERNOTE-CERT-NO.
   390             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   391             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   392
   393     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   394     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   395
   396     12  ERCNOT-KEY.
   397         16  ERCNOT-PART-KEY.
   398             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   399             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   400             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   401             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   402             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   403             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   404             20  ERCNOT-CERT-NO.
   405                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   406                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   407         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   408         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   409
   410     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   411     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   412
   413     12  ERMAIL-KEY.
   414         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   415         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   416         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   417         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   418         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page   9
* EL6311.cbl
   419         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   420         16  ERMAIL-CERT-NO.
   421             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   422             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   423
   424     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   425     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   426
   427     12  ERRQST-KEY.
   428         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   429         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   430
   431     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   432     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   433
   434     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   435
   436     12  ERLOFC-KEY.
   437         16  ERLOFC-COMPANY-CD          PIC  X.
   438         16  ERLOFC-CARRIER             PIC  X.
   439         16  ERLOFC-GROUPING            PIC  X(6).
   440         16  ERLOFC-STATE               PIC  XX.
   441         16  ERLOFC-ACCOUNT             PIC  X(10).
   442         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   443*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   444
   445     12  ERACCT-KEY.
   446         16  ERACCT-COMPANY-CD          PIC  X.
   447         16  ERACCT-CARRIER             PIC  X.
   448         16  ERACCT-GROUPING            PIC  X(6).
   449         16  ERACCT-STATE               PIC  XX.
   450         16  ERACCT-ACCOUNT             PIC  X(10).
   451         16  ERACCT-EXP-DT.
   452             20  ERACCT-DT              PIC  XX.
   453             20  ERACCT-FILL            PIC  X(4).
   454
   455     12  ERENDT-KEY.
   456         16  ENDT-COMPANY-CD       PIC X.
   457         16  ENDT-CARRIER          PIC X.
   458         16  ENDT-GROUPING         PIC X(6).
   459         16  ENDT-STATE            PIC XX.
   460         16  ENDT-ACCOUNT          PIC X(10).
   461         16  ENDT-CERT-EFF-DT      PIC XX.
   462         16  ENDT-CERT-PRIME       PIC X(10).
   463         16  ENDT-CERT-SFX         PIC X.
   464         16  ENDT-RECORD-TYPE      PIC X.
   465         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   466
   467 01  WS-ELMSTR-WORK.
   468     12  ELMSTR-KEY.
   469         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   470         16  MSTR-CERT-NO.
   471             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   472             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   473     12  W-CLAIM-KEY.
   474         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   475         16  W-CL-CERT-NO.
   476             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  10
* EL6311.cbl
   477             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   478      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   479 01  CANCEL-GEN-PASS-AREA.
   480     05  CG-OPTION-CODE          PIC X.
   481         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   482         88  CG-FLAT-CANCEL        VALUE '1'.
   483         88  CG-CANCEL             VALUE '2'.
   484         88  CG-CANCEL-REISSUE     VALUE '3'.
   485     05  CG-ERROR-CODE           PIC 99.
   486         88  CG-SUCCESS            VALUE 00.
   487         88  CG-DATE-ERROR         VALUE 01.
   488         88  CG-CERT-NOT-FOUND     VALUE 02.
   489         88  CG-AMOUNT-ERROR       VALUE 04.
   490         88  CG-OPTION-ERROR       VALUE 05.
   491         88  CG-PREV-CAN           VALUE 06.
   492         88  CG-INVALID-DATA       VALUE 07.
   493         88  CG-NO-ACCT-MSTR       VALUE 08.
   494         88  CG-SFX-A-EXIST        VALUE 09.
   495         88  CG-MISC-ERROR         VALUE 99.
   496     05  CG-COMPANY-ID           PIC XXX.
   497     05  CG-PROC-ID              PIC XXXX.
   498     05  CG-CURRENT-DT           PIC XX.
   499     05  CG-MONTH-END-DT         PIC XX.
   500     05  CG-CERT-KEY.
   501         10  CG-CERT-COMPANY-CD  PIC X.
   502         10  CG-CERT-CARRIER     PIC X.
   503         10  CG-CERT-GROUP       PIC X(6).
   504         10  CG-CERT-STATE       PIC XX.
   505         10  CG-CERT-ACCOUNT     PIC X(10).
   506         10  CG-CERT-EFF-DT      PIC XX.
   507         10  CG-CERT-CERT-NO     PIC X(11).
   508     05  CG-LF-CAN-DATA.
   509         10  CG-LF-CAN-DT        PIC XX.
   510         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   511     05  CG-AH-CAN-DATA.
   512         10  CG-AH-CAN-DT        PIC XX.
   513         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   514     05  CG-CERT-PROFILE-DATA.
   515         10  CG-INS-LNAME        PIC X(15).
   516         10  CG-INS-FNAME        PIC X(10).
   517         10  CG-INS-MID-INIT     PIC X.
   518         10  CG-INS-AGE          PIC 99.
   519         10  CG-JNT-LNAME        PIC X(15).
   520         10  CG-JNT-FNAME        PIC X(10).
   521         10  CG-JNT-MID-INIT     PIC X.
   522         10  CG-JNT-AGE          PIC 99.
   523     05  CG-LF-ISS-DATA.
   524         10  CG-LF-BENCD         PIC XX.
   525         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   526         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   527     05  CG-AH-ISS-DATA.
   528         10  CG-AH-BENCD         PIC XX.
   529         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   530     05  CG-BATCH-NO             PIC X(6).
   531     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   532     05  FILLER                  PIC X(306).
   533******************************************************************
   534*                                                                *
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  11
* EL6311.cbl
   535*            G E N E R A L   W O R K   A R E A                   *
   536*                                                                *
   537******************************************************************
   538
   539 01  WORK-AREA.
   540     12  WS-RESPONSE             PIC S9(8)   COMP.
   541         88  RESP-NORMAL                  VALUE +00.
   542         88  RESP-NOTFND                  VALUE +13.
   543         88  RESP-DUPREC                  VALUE +14.
   544         88  RESP-DUPKEY                  VALUE +15.
   545         88  RESP-NOTOPEN                 VALUE +19.
   546         88  RESP-ENDFILE                 VALUE +20.
   547     12  DEEDIT-FIELD            PIC X(15).
   548     12  FILLER          REDEFINES DEEDIT-FIELD.
   549         16  FILLER              PIC X(4).
   550         16  DEEDIT-FIELD-X11    PIC X(11).
   551     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   552                                 PIC S9(15).
   553     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   554                                 PIC S9(13)V99.
   555     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   556                                 PIC S9(11)V9999.
   557     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   558     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   559     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   560         16  WS-CALC-TERM-WHOLE  PIC S999.
   561         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   562
   563     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   564     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   565         16  WS-HR-MINS          PIC 99V99.
   566         16  FILLER              PIC XX.
   567
   568     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   569     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   570
   571     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   572     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   573
   574     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   575     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   576     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   577     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   578     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   579     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   580     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   581
   582     12  QID.
   583         16  QID-TERM            PIC X(4).
   584         16  FILLER              PIC X(4)    VALUE '607B'.
   585
   586     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   587         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   588
   589     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   590         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   591
   592     12  WS-MODE-CODE            PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  12
* EL6311.cbl
   593         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'.
   594
   595     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   596
   597     12  WS-NUMERIC-SW           PIC X.
   598        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   599
   600     12  WS-EDIT-CSO-FIELD.
   601         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   602                                 PIC X.
   603
   604     12  WS-SAVE-INPUT-FIELDS.
   605         16  WS-BAGE             PIC 99       VALUE ZERO.
   606*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   607         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   608         16  FILLER REDEFINES WS-BAPR.
   609             20  WS-APR-WHOLE-NUM    PIC 99.
   610             20  WS-APR-DEC          PIC 9999.
   611         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   612         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   613
   614         16  WS-B-COVERAGE OCCURS 2 TIMES.
   615             20  WS-TERM-IN-DAYS-SW  PIC X.
   616                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   617             20  WS-BTERM        PIC 999       COMP-3.
   618             20  WS-BALT-TERM    PIC 999       COMP-3.
   619             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   620             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   621             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   622             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   623             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   624             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   625
   626         16  WS-C-FIELDS COMP-3.
   627             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   628             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   629             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   630
   631         16  WS-D-FIELDS COMP-3.
   632             20  WS-DRISS        PIC S9(5)    VALUE +0.
   633             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   634             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   635             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   636             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   637             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   638
   639     12  WS-SAVE-BIRTH-DATE.
   640         16  FILLER              PIC X(4)   VALUE SPACES.
   641         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   642
   643     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   644     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   645     12  FILLER REDEFINES WS-WORK-BIN-RED.
   646         16  FILLER              PIC X(02).
   647         16  WS-WORK-BIN-DT      PIC X(02).
   648     12  WS-SW-1                 PIC X     VALUE SPACE.
   649     12  WS-SW-2                 PIC X     VALUE SPACE.
   650     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  13
* EL6311.cbl
   651         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   652     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   653         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   654
   655     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   656     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   657     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   658     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   659     12  WS-CONVERTED-CANCEL-DATES.
   660         16  WS-CONVERTED-CANDT1                  PIC XX.
   661         16  WS-CONVERTED-CANDT2                  PIC XX.
   662
   663     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   664
   665     12  WS-REC-FOUND-SW         PIC X.
   666         88  RECORD-NOT-FOUND    VALUE 'N'.
   667
   668     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   669         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   670         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   671
   672     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   673         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   674         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   675
   676     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   677         88  BROWSE-STARTED      VALUE 'Y'.
   678
   679     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   680         88  FIRST-TIME          VALUE 'Y'.
   681
   682     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   683         88  FIRST-ENTRY         VALUE 'Y'.
   684
   685     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   686         88  REC-BILLED          VALUE 'Y'.
   687
   688     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   689         88  NO-CURSOR-SET       VALUE +0.
   690         88  CURSOR-SET          VALUE +1.
   691
   692     12  WS-ERR-SW               PIC X.
   693         88  STD-ERRORS          VALUE 'S'.
   694         88  TRN-ERRORS          VALUE 'T'.
   695
   696     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   697         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   698
   699     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   700         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   701
   702     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   703         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   704
   705     12  WS-ERR-CODE.
   706         16  FILLER              PIC 99.
   707         16  WS-ERROR-SUB        PIC 99.
   708
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  14
* EL6311.cbl
   709     12  WS-DATE-WORK.
   710         16  WS-WORK-MM          PIC XX.
   711         16  WS-WORK-DD          PIC XX.
   712         16  WS-WORK-YY          PIC XX.
   713
   714     12  WS-MM-YY.
   715         16  WS-MM               PIC XX.
   716         16  FILLER              PIC X     VALUE '/'.
   717         16  WS-YY               PIC XX.
   718
   719     12  WS-CERT-EFF-DT          PIC XX.
   720
   721     12  WS-MEMBER-NO            PIC X(12).
   722     12  FILLER  REDEFINES  WS-MEMBER-NO.
   723         16  WS-MEMBER-NO-1-8    PIC 9(8).
   724         16  FILLER              PIC X(4).
   725
   726     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   727
   728     12  WS-ERPNDB-ALT-KEY.
   729         16  WS-PB-COMPANY-CD-A1         PIC X.
   730         16  WS-PB-CARRIER               PIC X.
   731         16  WS-PB-GROUPING              PIC X(6).
   732         16  WS-PB-STATE                 PIC XX.
   733         16  WS-PB-ACCOUNT               PIC X(10).
   734         16  WS-PB-CERT-EFF-DT           PIC XX.
   735         16  WS-PB-CERT-NO.
   736             20  WS-PB-CERT-PRIME        PIC X(10).
   737             20  WS-PB-CERT-SFX          PIC X.
   738         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   739         16  WS-PB-RECORD-TYPE           PIC X.
   740
   741     12  WS-SHOW-SAVE-AREAS.
   742         16  WS-NEW-CERT-NO.
   743             20  WS-NEW-PRIME    PIC X(10).
   744             20  WS-NEW-SUFFIX   PIC X.
   745         16  WS-NEW-CERT-EFF-DT  PIC XX.
   746         16  WS-NEW-RECORD-TYPE  PIC X.
   747         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   748             88   SHOW-RECORD            VALUE 'Y'.
   749
   750     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   751
   752     12  WS-BATCH-NO.
   753         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   754         16  FILLER              PIC X(5) VALUE SPACES.
   755
   756     12  WS-FIRST-NAME.
   757         16  WS-1ST-INIT         PIC X.
   758         16  FILLER              PIC X(9).
   759
   760     12  WS-INITIALS.
   761         16  WS-INITIAL-1        PIC X.
   762         16  WS-INITIAL-2        PIC X.
   763
   764     12  WS-C-HDG.
   765         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   766         16  FILLER              PIC X(4) VALUE '-REF'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  15
* EL6311.cbl
   767
   768     12  WS-D-PREM-HDG.
   769         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   770         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   771
   772     12  WS-D-REFUND-HDG.
   773         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   774         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   775
   776     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   777
   778     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   779     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   780     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   781     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   782     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   783     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   784     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   785
   786     12  WS-01-CANCEL-ERR        PIC X(25)
   787         VALUE 'CANCEL DATE ERROR'.
   788     12  WS-02-CANCEL-ERR        PIC X(25)
   789         VALUE 'CERT NOT FOUND'.
   790     12  WS-04-CANCEL-ERR        PIC X(25)
   791         VALUE 'CANCEL AMOUNT ERROR'.
   792     12  WS-05-CANCEL-ERR        PIC X(25)
   793         VALUE 'CANCEL OPTION ERROR'.
   794     12  WS-06-CANCEL-ERR        PIC X(25)
   795         VALUE 'PREVIOUSLY CANCELLED'.
   796     12  WS-07-CANCEL-ERR        PIC X(25)
   797         VALUE 'INVALID DATA'.
   798     12  WS-08-CANCEL-ERR        PIC X(25)
   799         VALUE 'NO ACCOUNT MASTER'.
   800     12  WS-09-CANCEL-ERR        PIC X(25)
   801         VALUE 'SUFFIX ALREADY EXISTS'.
   802     12  WS-99-CANCEL-ERR        PIC X(25)
   803         VALUE 'MISC CANCEL ERROR'.
   804
   805     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   806     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   807
   808     12  WS-AGE-FIELDS.
   809         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   810         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   811         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   812         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   813
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  16
* EL6311.cbl
   815
   816******************************************************************
   817*                                                                *
   818*                 B A T C H   T O T A L S                        *
   819*                                                                *
   820******************************************************************
   821
   822     12  WS-BATCH-RECORD.
   823         16  FILLER                       PIC X(10).
   824         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   825         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   826         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   827         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   828         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   829         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   830         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   831         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   832         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   833         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   834         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   835         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   836         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   837         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   838         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   839         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   840         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   841         16  WS-ACCOUNT-NAME              PIC X(30).
   842         16  FILLER                       PIC X.
   843         16  WS-REFERENCE                 PIC X(12).
   844         16  FILLER                       PIC X(197).
   845
   846     12  WS-BATCH-TOTALS.
   847         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   848         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   849         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   850         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   851         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   852         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   853         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   854         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   855         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   856         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   857         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   858         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   859         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   860         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   861         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   862         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   863         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   864         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   865         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   866
   867     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   868
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  17
* EL6311.cbl
   870
   871******************************************************************
   872*                                                                *
   873*                E R R O R   M E S S A G E S                     *
   874*                                                                *
   875******************************************************************
   876
   877 01  ERROR-MESSAGES.
   878     12  ER-0004                 PIC  9(4) VALUE 0004.
   879     12  ER-0008                 PIC  9(4) VALUE 0008.
   880     12  ER-0023                 PIC  9(4) VALUE 0023.
   881     12  ER-0029                 PIC  9(4) VALUE 0029.
   882     12  ER-0033                 PIC  9(4) VALUE 0033.
   883     12  ER-0070                 PIC  9(4) VALUE 0070.
   884     12  ER-0220                 PIC  9(4) VALUE 0220.
   885     12  ER-0248                 PIC  9(4) VALUE 0248.
   886     12  ER-0280                 PIC  9(4) VALUE 0280.
   887     12  ER-0348                 PIC  9(4) VALUE 0348.
   888     12  ER-0582                 PIC  9(4) VALUE 0582.
   889     12  ER-0877                 PIC  9(4) VALUE 0877.
   890     12  ER-1236                 PIC  9(4) VALUE 1236.
   891     12  ER-1570                 PIC  9(4) VALUE 1570.
   892     12  ER-1575                 PIC  9(4) VALUE 1575.
   893     12  ER-1609                 PIC  9(4) VALUE 1609.
   894     12  ER-1819                 PIC  9(4) VALUE 1819.
   895     12  ER-2077                 PIC  9(4) VALUE 2077.
   896     12  ER-2129                 PIC  9(4) VALUE 2129.
   897     12  ER-2188                 PIC  9(4) VALUE 2188.
   898     12  ER-2192                 PIC  9(4) VALUE 2192.
   899     12  ER-2196                 PIC  9(4) VALUE 2196.
   900     12  ER-2197                 PIC  9(4) VALUE 2197.
   901     12  ER-2198                 PIC  9(4) VALUE 2198.
   902     12  ER-2200                 PIC  9(4) VALUE 2200.
   903     12  ER-2212                 PIC  9(4) VALUE 2212.
   904     12  ER-2218                 PIC  9(4) VALUE 2218.
   905     12  ER-2220                 PIC  9(4) VALUE 2220.
   906     12  ER-2222                 PIC  9(4) VALUE 2222.
   907     12  ER-2223                 PIC  9(4) VALUE 2223.
   908     12  ER-2224                 PIC  9(4) VALUE 2224.
   909     12  ER-2225                 PIC  9(4) VALUE 2225.
   910     12  ER-2226                 PIC  9(4) VALUE 2226.
   911     12  ER-2227                 PIC  9(4) VALUE 2227.
   912     12  ER-2228                 PIC  9(4) VALUE 2228.
   913     12  ER-2240                 PIC  9(4) VALUE 2240.
   914     12  ER-2241                 PIC  9(4) VALUE 2241.
   915     12  ER-2242                 PIC  9(4) VALUE 2242.
   916     12  ER-2243                 PIC  9(4) VALUE 2243.
   917     12  ER-2244                 PIC  9(4) VALUE 2244.
   918     12  ER-2245                 PIC  9(4) VALUE 2245.
   919     12  ER-2246                 PIC  9(4) VALUE 2246.
   920     12  ER-2247                 PIC  9(4) VALUE 2247.
   921     12  ER-2251                 PIC  9(4) VALUE 2251.
   922     12  ER-2252                 PIC  9(4) VALUE 2252.
   923     12  ER-2253                 PIC  9(4) VALUE 2253.
   924     12  ER-2254                 PIC  9(4) VALUE 2254.
   925     12  ER-2255                 PIC  9(4) VALUE 2255.
   926     12  ER-2256                 PIC  9(4) VALUE 2256.
   927     12  ER-2257                 PIC  9(4) VALUE 2257.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  18
* EL6311.cbl
   928     12  ER-2258                 PIC  9(4) VALUE 2258.
   929     12  ER-2259                 PIC  9(4) VALUE 2259.
   930     12  ER-2260                 PIC  9(4) VALUE 2260.
   931     12  ER-2261                 PIC  9(4) VALUE 2261.
   932     12  ER-2287                 PIC  9(4) VALUE 2287.
   933     12  ER-2336                 PIC  9(4) VALUE 2336.
   934     12  ER-2337                 PIC  9(4) VALUE 2337.
   935     12  ER-2437                 PIC  9(4) VALUE 2437.
   936     12  ER-2471                 PIC  9(4) VALUE 2471.
   937     12  ER-2530                 PIC  9(4) VALUE 2530.
   938     12  ER-2531                 PIC  9(4) VALUE 2531.
   939     12  ER-2532                 PIC  9(4) VALUE 2532.
   940     12  ER-2533                 PIC  9(4) VALUE 2533.
   941     12  ER-2547                 PIC  9(4) VALUE 2547.
   942     12  ER-2591                 PIC  9(4) VALUE 2591.
   943     12  ER-2592                 PIC  9(4) VALUE 2592.
   944     12  ER-2593                 PIC  9(4) VALUE 2593.
   945     12  ER-2600                 PIC  9(4) VALUE 2600.
   946     12  ER-2601                 PIC  9(4) VALUE 2601.
   947     12  ER-2604                 PIC  9(4) VALUE 2604.
   948     12  ER-2605                 PIC  9(4) VALUE 2605.
   949     12  ER-2606                 PIC  9(4) VALUE 2606.
   950     12  ER-2607                 PIC  9(4) VALUE 2607.
   951     12  ER-2622                 PIC  9(4) VALUE 2622.
   952     12  ER-2625                 PIC  9(4) VALUE 2625.
   953     12  ER-2626                 PIC  9(4) VALUE 2626.
   954     12  ER-2627                 PIC  9(4) VALUE 2627.
   955     12  ER-2628                 PIC  9(4) VALUE 2628.
   956     12  ER-2629                 PIC  9(4) VALUE 2629.
   957     12  ER-2630                 PIC  9(4) VALUE 2630.
   958     12  ER-2631                 PIC  9(4) VALUE 2631.
   959     12  ER-2632                 PIC  9(4) VALUE 2632.
   960     12  ER-2633                 PIC  9(4) VALUE 2633.
   961     12  ER-2634                 PIC  9(4) VALUE 2634.
   962     12  ER-2635                 PIC  9(4) VALUE 2635.
   963     12  ER-2636                 PIC  9(4) VALUE 2636.
   964     12  ER-2639                 PIC  9(4) VALUE 2639.
   965     12  ER-2640                 PIC  9(4) VALUE 2640.
   966     12  ER-2647                 PIC  9(4) VALUE 2647.
   967     12  ER-2648                 PIC  9(4) VALUE 2648.
   968     12  ER-2649                 PIC  9(4) VALUE 2649.
   969     12  ER-2650                 PIC  9(4) VALUE 2650.
   970     12  ER-2653                 PIC  9(4) VALUE 2653.
   971     12  ER-2654                 PIC  9(4) VALUE 2654.
   972     12  ER-2655                 PIC  9(4) VALUE 2655.
   973     12  ER-2656                 PIC  9(4) VALUE 2656.
   974     12  ER-2657                 PIC  9(4) VALUE 2657.
   975     12  ER-2660                 PIC  9(4) VALUE 2660.
   976     12  ER-2661                 PIC  9(4) VALUE 2661.
   977     12  ER-2662                 PIC  9(4) VALUE 2662.
   978     12  ER-2663                 PIC  9(4) VALUE 2663.
   979     12  ER-2664                 PIC  9(4) VALUE 2664.
   980     12  ER-2667                 PIC  9(4) VALUE 2667.
   981     12  ER-2668                 PIC  9(4) VALUE 2668.
   982     12  ER-2669                 PIC  9(4) VALUE 2669.
   983     12  ER-2670                 PIC  9(4) VALUE 2670.
   984     12  ER-2671                 PIC  9(4) VALUE 2671.
   985     12  ER-2672                 PIC  9(4) VALUE 2672.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  19
* EL6311.cbl
   986     12  ER-2673                 PIC  9(4) VALUE 2673.
   987     12  ER-2677                 PIC  9(4) VALUE 2677.
   988     12  ER-2678                 PIC  9(4) VALUE 2678.
   989     12  ER-2679                 PIC  9(4) VALUE 2679.
   990     12  ER-2680                 PIC  9(4) VALUE 2680.
   991     12  ER-2681                 PIC  9(4) VALUE 2681.
   992     12  ER-2682                 PIC  9(4) VALUE 2682.
   993     12  ER-2683                 PIC  9(4) VALUE 2683.
   994     12  ER-2684                 PIC  9(4) VALUE 2684.
   995     12  ER-2686                 PIC  9(4) VALUE 2686.
   996     12  ER-2689                 PIC  9(4) VALUE 2689.
   997     12  ER-2690                 PIC  9(4) VALUE 2690.
   998     12  ER-2693                 PIC  9(4) VALUE 2693.
   999     12  ER-2695                 PIC  9(4) VALUE 2695.
  1000     12  ER-2701                 PIC  9(4) VALUE 2701.
  1001     12  ER-2720                 PIC  9(4) VALUE 2720.
  1002     12  ER-2709                 PIC  9(4) VALUE 2709.
  1003     12  ER-2704                 PIC  9(4) VALUE 2704.
  1004     12  ER-2725                 PIC  9(4) VALUE 2725.
  1005     12  ER-2726                 PIC  9(4) VALUE 2726.
  1006     12  ER-2728                 PIC  9(4) VALUE 2728.
  1007     12  ER-2729                 PIC  9(4) VALUE 2729.
  1008     12  ER-2731                 PIC  9(4) VALUE 2731.
  1009     12  ER-2732                 PIC  9(4) VALUE 2732.
  1010     12  ER-2733                 PIC  9(4) VALUE 2733.
  1011     12  ER-2735                 PIC  9(4) VALUE 2735.
  1012     12  ER-2738                 PIC  9(4) VALUE 2738.
  1013     12  ER-2742                 PIC  9(4) VALUE 2742.
  1014     12  ER-2743                 PIC  9(4) VALUE 2743.
  1015     12  ER-2744                 PIC  9(4) VALUE 2744.
  1016     12  ER-2747                 PIC  9(4) VALUE 2747.
  1017     12  ER-2749                 PIC  9(4) VALUE 2749.
  1018     12  ER-2753                 PIC  9(4) VALUE 2753.
  1019     12  ER-2755                 PIC  9(4) VALUE 2755.
  1020     12  ER-2757                 PIC  9(4) VALUE 2757.
  1021     12  ER-2771                 PIC  9(4) VALUE 2771.
  1022     12  ER-2774                 PIC  9(4) VALUE 2774.
  1023     12  ER-2775                 PIC  9(4) VALUE 2775.
  1024     12  ER-2776                 PIC  9(4) VALUE 2776.
  1025     12  ER-2777                 PIC  9(4) VALUE 2777.
  1026     12  ER-2794                 PIC  9(4) VALUE 2794.
  1027     12  ER-2799                 PIC  9(4) VALUE 2799.
  1028     12  ER-2900                 PIC  9(4) VALUE 2900.
  1029     12  ER-2902                 PIC  9(4) VALUE 2902.
  1030     12  ER-2945                 PIC  9(4) VALUE 2945.
  1031     12  ER-3000                 PIC  9(4) VALUE 3000.
  1032     12  ER-3006                 PIC  9(4) VALUE 3006.
  1033     12  ER-3054                 PIC  9(4) VALUE 3054.
  1034     12  ER-3224                 PIC  9(4) VALUE 3224.
  1035     12  ER-3504                 PIC  9(4) VALUE 3504.
  1036     12  ER-3513                 PIC  9(4) VALUE 3513.
  1037     12  ER-3831                 PIC  9(4) VALUE 3831.
  1038     12  ER-3834                 PIC  9(4) VALUE 3834.
  1039     12  ER-3835                 PIC  9(4) VALUE 3835.
  1040     12  ER-4005                 PIC  9(4) VALUE 4005.
  1041     12  ER-7144                 PIC  9(4) VALUE 7144.
  1042     12  ER-7401                 PIC  9(4) VALUE 7401.
  1043     12  ER-7402                 PIC  9(4) VALUE 7402.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  20
* EL6311.cbl
  1044     12  ER-7403                 PIC  9(4) VALUE 7403.
  1045     12  ER-7404                 PIC  9(4) VALUE 7404.
  1046     12  ER-7423                 PIC  9(4) VALUE 7423.
  1047     12  ER-7424                 PIC  9(4) VALUE 7424.
  1048     12  ER-7433                 PIC  9(4) VALUE 7433.
  1049     12  ER-7450                 PIC  9(4) VALUE 7450.
  1050     12  ER-7451                 PIC  9(4) VALUE 7451.
  1051     12  ER-7530                 PIC  9(4) VALUE 7530.
  1052     12  ER-7573                 PIC  9(4) VALUE 7573.
  1053     12  ER-7631                 PIC  9(4) VALUE 7631.
  1054     12  ER-7632                 PIC  9(4) VALUE 7632.
  1055     12  ER-7633                 PIC  9(4) VALUE 7633.
  1056     12  ER-7537                 PIC  9(4) VALUE 7537.
  1057     12  ER-7538                 PIC  9(4) VALUE 7538.
  1058     12  ER-7574                 PIC  9(4) VALUE 7574.
  1059     12  ER-7997                 PIC  9(4) VALUE 7997.
  1060     12  ER-7998                 PIC  9(4) VALUE 7998.
  1061     12  ER-8148                 PIC  9(4) VALUE 8148.
  1062     12  ER-9063                 PIC  9(4) VALUE 9063.
  1063     12  ER-9076                 PIC  9(4) VALUE 9076.
  1064     12  ER-9618                 PIC  9(4) VALUE 9618.
  1065     12  ER-9841                 PIC  9(4) VALUE 9841.
  1066
  1067*                                COPY ELCTEXT.
  1068******************************************************************
  1069*                                                                *
  1070*                                                                *
  1071*                            ELCTEXT.                            *
  1072*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1073*                            VMOD=2.008                          *
  1074*                                                                *
  1075*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1076*                                     FORM LETTERS,              *
  1077*                                     CERT FORM DISPLAY.
  1078*                                                                *
  1079*   FILE TYPE = VSAM,KSDS                                        *
  1080*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1081*                                                                *
  1082*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1083*       ALTERNATE INDEX = NONE                                   *
  1084*                                                                *
  1085*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1086*       ALTERNATE INDEX = NONE                                   *
  1087*                                                                *
  1088*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1089*       ALTERNATE INDEX = NONE                                   *
  1090*                                                                *
  1091*   LOG = NO                                                     *
  1092*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1093******************************************************************
  1094 01  TEXT-FILES.
  1095     12  TEXT-FILE-ID                PIC XX.
  1096         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1097         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1098         88  HELP-FILE-TEXT             VALUE 'TH'.
  1099
  1100     12  TX-CONTROL-PRIMARY.
  1101         16  TX-COMPANY-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  21
* EL6311.cbl
  1102             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1103         16  TX-ACCESS-CD-GENL       PIC X(12).
  1104
  1105         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1106             20  TX-LETTER-NO        PIC X(4).
  1107             20  FILLER              PIC X(8).
  1108
  1109         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1110             20  TX-FORM-NO          PIC X(12).
  1111
  1112         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1113             20  TX-HELP-TYPE        PIC X.
  1114                 88  HELP-FOR-GENERAL   VALUE ' '.
  1115                 88  HELP-BY-SCREEN     VALUE 'S'.
  1116                 88  HELP-BY-ERROR      VALUE 'E'.
  1117             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1118                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1119             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1120                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1121             20  FILLER              PIC X(4).
  1122
  1123         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1124
  1125     12  TX-PROCESS-CONTROL          PIC XX.
  1126         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1127
  1128     12  TX-TEXT-LINE                PIC X(70).
  1129
  1130     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1131         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1132         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1133         88  TX-VALID-FORM-SQUEEZE-VALUE
  1134                                        VALUE 'Y' ' '.
  1135
  1136     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1137         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1138         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1139         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1140         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1141         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1142         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1143         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1144                                              'K' 'N' ' '
  1145                                              'Z'.
  1146
  1147     12  TX-ARCHIVE-SW               PIC X.
  1148         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1149         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1150         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1151
  1152     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1153     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1154
  1155     12  TX-BSR-CODE                 PIC X.
  1156         88  TX-BSR-LETTER              VALUE 'B'.
  1157         88  TX-NON-BSR-LETTER          VALUE ' '.
  1158
  1159     12  FILLER                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  22
* EL6311.cbl
  1160*****************************************************************
  1161*                                COPY ELCCRTO.
  1162******************************************************************
  1163*                                                                *
  1164*                            ELCCRTO.                            *
  1165*                                                                *
  1166*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1167*                                                                *
  1168*   FILE TYPE = VSAM,KSDS                                        *
  1169*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1170*                                                                *
  1171*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1172*                                                                *
  1173*   LOG = YES                                                    *
  1174*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1175******************************************************************
  1176*                   C H A N G E   L O G
  1177*
  1178* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1179*-----------------------------------------------------------------
  1180*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1181* EFFECTIVE    NUMBER
  1182*-----------------------------------------------------------------
  1183* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1184* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1185* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1186* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1187* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1188******************************************************************
  1189 01  ORIGINAL-CERTIFICATE.
  1190     12  OC-RECORD-ID                      PIC XX.
  1191         88  VALID-OC-ID                      VALUE 'OC'.
  1192     12  OC-CONTROL-PRIMARY.
  1193         16  OC-COMPANY-CD                 PIC X.
  1194         16  OC-CARRIER                    PIC X.
  1195         16  OC-GROUPING                   PIC X(6).
  1196         16  OC-STATE                      PIC XX.
  1197         16  OC-ACCOUNT                    PIC X(10).
  1198         16  OC-CERT-EFF-DT                PIC XX.
  1199         16  OC-CERT-NO.
  1200             20  OC-CERT-PRIME             PIC X(10).
  1201             20  OC-CERT-SFX               PIC X.
  1202         16  OC-RECORD-TYPE                PIC X.
  1203         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1204     12  OC-LAST-MAINT-DT                  PIC XX.
  1205     12  OC-LAST-MAINT-BY                  PIC X(4).
  1206     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1207     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1208     12  FILLER                            PIC X(49).
  1209     12  OC-ORIG-REC.
  1210         16  OC-INS-LAST-NAME              PIC X(15).
  1211         16  OC-INS-FIRST-NAME             PIC X(10).
  1212         16  OC-INS-MIDDLE-INIT            PIC X.
  1213         16  OC-INS-AGE                    PIC S999     COMP-3.
  1214         16  OC-JNT-LAST-NAME              PIC X(15).
  1215         16  OC-JNT-FIRST-NAME             PIC X(10).
  1216         16  OC-JNT-MIDDLE-INIT            PIC X.
  1217         16  OC-JNT-AGE                    PIC S999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  23
* EL6311.cbl
  1218         16  OC-LF-BENCD                   PIC XX.
  1219         16  OC-LF-TERM                    PIC S999      COMP-3.
  1220         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1221         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1222         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1223         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1224         16  OC-LF-EXP-DT                  PIC XX.
  1225         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1226         16  OC-LF-CANCEL-DT               PIC XX.
  1227         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1228         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1229         16  OC-AH-BENCD                   PIC XX.
  1230         16  OC-AH-TERM                    PIC S999      COMP-3.
  1231         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1232         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1233         16  OC-AH-EXP-DT                  PIC XX.
  1234         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1235         16  OC-AH-CP                      PIC 99.
  1236         16  OC-AH-CANCEL-DT               PIC XX.
  1237         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1238         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1239         16  OC-CRED-BENE-NAME             PIC X(25).
  1240         16  OC-1ST-PMT-DT                 PIC XX.
  1241         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1242         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1243         16  OC-ISSUE-TRAN-IND             PIC X.
  1244         16  OC-CANCEL-TRAN-IND            PIC X.
  1245         16  FILLER                        PIC X(211).
  1246
  1247     12  FILLER                            PIC X(50).
  1248******************************************************************
  1249*                                COPY ERCACCT.
  1250******************************************************************
  1251*                                                                *
  1252*                                                                *
  1253*                            ERCACCT                             *
  1254*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1255*                            VMOD=2.031                          *
  1256*                                                                *
  1257*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1258*                                                                *
  1259*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1260*   VSAM ACCOUNT MASTER FILES.                                   *
  1261*                                                                *
  1262*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1263*                                                                *
  1264*   FILE TYPE = VSAM,KSDS                                        *
  1265*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1266*                                                                *
  1267*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1268*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1269*                                                                *
  1270*   LOG = NO                                                     *
  1271*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1272*                                                                *
  1273*                                                                *
  1274******************************************************************
  1275*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  24
* EL6311.cbl
  1276*
  1277* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1278*-----------------------------------------------------------------
  1279*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1280* EFFECTIVE    NUMBER
  1281*-----------------------------------------------------------------
  1282* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1283* 092705    2005050300006  PEMA  ADD SPP LEASES
  1284* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1285* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1286* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1287* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1288* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1289******************************************************************
  1290
  1291 01  ACCOUNT-MASTER.
  1292     12  AM-RECORD-ID                      PIC XX.
  1293         88  VALID-AM-ID                      VALUE 'AM'.
  1294
  1295     12  AM-CONTROL-PRIMARY.
  1296         16  AM-COMPANY-CD                 PIC X.
  1297         16  AM-MSTR-CNTRL.
  1298             20  AM-CONTROL-A.
  1299                 24  AM-CARRIER            PIC X.
  1300                 24  AM-GROUPING.
  1301                     28 AM-GROUPING-PREFIX PIC XXX.
  1302                     28 AM-GROUPING-PRIME  PIC XXX.
  1303                 24  AM-STATE              PIC XX.
  1304                 24  AM-ACCOUNT.
  1305                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1306                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1307             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1308                                           PIC X(19).
  1309             20  AM-CNTRL-B.
  1310                 24  AM-EXPIRATION-DT      PIC XX.
  1311                 24  FILLER                PIC X(4).
  1312             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1313                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1314
  1315     12  AM-CONTROL-BY-VAR-GRP.
  1316         16  AM-COMPANY-CD-A1              PIC X.
  1317         16  AM-VG-CARRIER                 PIC X.
  1318         16  AM-VG-GROUPING                PIC X(6).
  1319         16  AM-VG-STATE                   PIC XX.
  1320         16  AM-VG-ACCOUNT                 PIC X(10).
  1321         16  AM-VG-DATE.
  1322             20  AM-VG-EXPIRATION-DT       PIC XX.
  1323             20  FILLER                    PIC X(4).
  1324         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1325                                           PIC 9(11)      COMP-3.
  1326     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1327         16  FILLER                        PIC X(10).
  1328         16  AM-VG-KEY3.
  1329             20  AM-VG3-ACCOUNT            PIC X(10).
  1330             20  AM-VG3-EXP-DT             PIC XX.
  1331         16  FILLER                        PIC X(4).
  1332     12  AM-MAINT-INFORMATION.
  1333         16  AM-LAST-MAINT-DT              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  25
* EL6311.cbl
  1334         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1335         16  AM-LAST-MAINT-USER            PIC X(4).
  1336         16  FILLER                        PIC XX.
  1337
  1338     12  AM-EFFECTIVE-DT                   PIC XX.
  1339     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1340
  1341     12  AM-PREV-DATES  COMP-3.
  1342         16  AM-PREV-EXP-DT                PIC 9(11).
  1343         16  AM-PREV-EFF-DT                PIC 9(11).
  1344
  1345     12  AM-REPORT-CODE-1                  PIC X(10).
  1346     12  AM-REPORT-CODE-2                  PIC X(10).
  1347
  1348     12  AM-CITY-CODE                      PIC X(4).
  1349     12  AM-COUNTY-PARISH                  PIC X(6).
  1350
  1351     12  AM-NAME                           PIC X(30).
  1352     12  AM-PERSON                         PIC X(30).
  1353     12  AM-ADDRS                          PIC X(30).
  1354     12  AM-CITY.
  1355         16  AM-ADDR-CITY                  PIC X(28).
  1356         16  AM-ADDR-STATE                 PIC XX.
  1357     12  AM-ZIP.
  1358         16  AM-ZIP-PRIME.
  1359             20  AM-ZIP-PRI-1ST            PIC X.
  1360                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1361             20  FILLER                    PIC X(4).
  1362         16  AM-ZIP-PLUS4                  PIC X(4).
  1363     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1364         16  AM-CAN-POSTAL-1               PIC XXX.
  1365         16  AM-CAN-POSTAL-2               PIC XXX.
  1366         16  FILLER                        PIC XXX.
  1367     12  AM-TEL-NO.
  1368         16  AM-AREA-CODE                  PIC 999.
  1369         16  AM-TEL-PRE                    PIC 999.
  1370         16  AM-TEL-NBR                    PIC 9(4).
  1371     12  AM-TEL-LOC                        PIC X.
  1372         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1373         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1374
  1375     12  AM-COMM-STRUCTURE.
  1376         16  AM-DEFN-1.
  1377             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1378                 24  AM-AGT.
  1379                     28  AM-AGT-PREFIX     PIC X(4).
  1380                     28  AM-AGT-PRIME      PIC X(6).
  1381                 24  AM-COM-TYP            PIC X.
  1382                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1383                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1384                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1385                 24  AM-RECALC-LV-INDIC    PIC X.
  1386                 24  AM-RETRO-LV-INDIC     PIC X.
  1387                 24  AM-GL-CODES           PIC X.
  1388                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1389                 24  FILLER                PIC X(01).
  1390         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1391             20  AM-COM-TBLS        OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  26
* EL6311.cbl
  1392                 24  FILLER                PIC X(11).
  1393                 24  AM-L-COMA             PIC XXX.
  1394                 24  AM-J-COMA             PIC XXX.
  1395                 24  AM-A-COMA             PIC XXX.
  1396                 24  FILLER                PIC X(6).
  1397
  1398     12  AM-COMM-CHANGE-STATUS             PIC X.
  1399         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1400
  1401     12  AM-CSR-CODE                       PIC X(4).
  1402
  1403     12  AM-BILLING-STATUS                 PIC X.
  1404         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1405         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1406     12  AM-AUTO-REFUND-SW                 PIC X.
  1407         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1408         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1409     12  AM-GPCD                           PIC 99.
  1410     12  AM-IG                             PIC X.
  1411         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1412         88  AM-HAS-GROUP                     VALUE '2'.
  1413     12  AM-STATUS                         PIC X.
  1414         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1415         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1416         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1417         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1418         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1419         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1420     12  AM-REMIT-TO                       PIC 99.
  1421     12  AM-ID-NO                          PIC X(11).
  1422
  1423     12  AM-CAL-TABLE                      PIC XX.
  1424     12  AM-LF-DEVIATION                   PIC XXX.
  1425     12  AM-AH-DEVIATION                   PIC XXX.
  1426     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1427     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1428     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1429     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1430     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1431     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1432
  1433     12  AM-USER-FIELDS.
  1434         16  AM-FLD-1                      PIC XX.
  1435         16  AM-FLD-2                      PIC XX.
  1436         16  AM-FLD-3                      PIC XX.
  1437         16  AM-FLD-4                      PIC XX.
  1438         16  AM-FLD-5                      PIC XX.
  1439
  1440     12  AM-1ST-PROD-DATE.
  1441         16  AM-1ST-PROD-YR                PIC XX.
  1442         16  AM-1ST-PROD-MO                PIC XX.
  1443         16  AM-1ST-PROD-DA                PIC XX.
  1444     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1445     12  AM-CERTS-PURGED-DATE.
  1446         16  AM-PUR-YR                     PIC XX.
  1447         16  AM-PUR-MO                     PIC XX.
  1448         16  AM-PUR-DA                     PIC XX.
  1449     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  27
* EL6311.cbl
  1450     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1451     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1452     12  AM-INACTIVE-DATE.
  1453         16  AM-INA-MO                     PIC 99.
  1454         16  AM-INA-DA                     PIC 99.
  1455         16  AM-INA-YR                     PIC 99.
  1456     12  AM-AR-HI-CERT-DATE                PIC XX.
  1457
  1458     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1459     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1460
  1461     12  AM-OB-PAYMENT-MODE                PIC X.
  1462         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1463         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1464         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1465         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1466
  1467     12  AM-AH-ONLY-INDICATOR              PIC X.
  1468         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1469         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1470
  1471     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1472
  1473     12  AM-OVER-SHORT.
  1474         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1475         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1476
  1477     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1478     12  AM-DCC-CLP-STATE                  PIC XX.
  1479
  1480     12  AM-RECALC-COMM                    PIC X.
  1481     12  AM-RECALC-REIN                    PIC X.
  1482
  1483     12  AM-REI-TABLE                      PIC XXX.
  1484     12  AM-REI-ET-LF                      PIC X.
  1485     12  AM-REI-ET-AH                      PIC X.
  1486     12  AM-REI-PE-LF                      PIC X.
  1487     12  AM-REI-PE-AH                      PIC X.
  1488     12  AM-REI-PRT-ST                     PIC X.
  1489     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1490     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1491     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1492     12  AM-REI-GROUP-A                    PIC X(6).
  1493     12  AM-REI-MORT                       PIC X(4).
  1494     12  AM-REI-PRT-OW                     PIC X.
  1495     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1496     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1497     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1498     12  AM-REI-GROUP-B                    PIC X(6).
  1499
  1500     12  AM-TRUST-TYPE                     PIC X(2).
  1501
  1502     12  AM-EMPLOYER-STMT-USED             PIC X.
  1503     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1504
  1505     12  AM-STD-AH-TYPE                    PIC XX.
  1506     12  AM-EARN-METHODS.
  1507         16  AM-EARN-METHOD-R              PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  28
* EL6311.cbl
  1508             88 AM-REF-RL-R78                 VALUE 'R'.
  1509             88 AM-REF-RL-PR                  VALUE 'P'.
  1510             88 AM-REF-RL-MEAN                VALUE 'M'.
  1511             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1512         16  AM-EARN-METHOD-L              PIC X.
  1513             88 AM-REF-LL-R78                 VALUE 'R'.
  1514             88 AM-REF-LL-PR                  VALUE 'P'.
  1515             88 AM-REF-LL-MEAN                VALUE 'M'.
  1516             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1517         16  AM-EARN-METHOD-A              PIC X.
  1518             88 AM-REF-AH-R78                 VALUE 'R'.
  1519             88 AM-REF-AH-PR                  VALUE 'P'.
  1520             88 AM-REF-AH-MEAN                VALUE 'M'.
  1521             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1522             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1523             88 AM-REF-AH-NET                 VALUE 'N'.
  1524
  1525     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1526     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1527     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1528
  1529     12  AM-RET-Y-N                        PIC X.
  1530     12  AM-RET-P-E                        PIC X.
  1531     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1532     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1533     12  AM-RET-GRP                        PIC X(6).
  1534     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1535         16  AM-POOL-PRIME                 PIC XXX.
  1536         16  AM-POOL-SUB                   PIC XXX.
  1537     12  AM-RETRO-EARNINGS.
  1538         16  AM-RET-EARN-R                 PIC X.
  1539         16  AM-RET-EARN-L                 PIC X.
  1540         16  AM-RET-EARN-A                 PIC X.
  1541     12  AM-RET-ST-TAX-USE                 PIC X.
  1542         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1543         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1544     12  AM-RETRO-BEG-EARNINGS.
  1545         16  AM-RET-BEG-EARN-R             PIC X.
  1546         16  AM-RET-BEG-EARN-L             PIC X.
  1547         16  AM-RET-BEG-EARN-A             PIC X.
  1548     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1549     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1550
  1551     12  AM-USER-SELECT-OPTIONS.
  1552         16  AM-USER-SELECT-1              PIC X(10).
  1553         16  AM-USER-SELECT-2              PIC X(10).
  1554         16  AM-USER-SELECT-3              PIC X(10).
  1555         16  AM-USER-SELECT-4              PIC X(10).
  1556         16  AM-USER-SELECT-5              PIC X(10).
  1557
  1558     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1559
  1560     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1561
  1562     12  AM-RPT045A-SWITCH                 PIC X.
  1563         88  RPT045A-OFF                   VALUE 'N'.
  1564
  1565     12  AM-INSURANCE-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  29
* EL6311.cbl
  1566         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1567         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1568
  1569     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1570         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1571
  1572     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1573         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1574         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1575
  1576     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1577
  1578     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1579     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1580     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1581     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1582     12  AM-DCC-UEF-STATE                  PIC XX.
  1583     12  FILLER                            PIC XXX.
  1584     12  AM-REPORT-CODE-3                  PIC X(10).
  1585*    12  FILLER                            PIC X(22).
  1586
  1587     12  AM-RESERVE-DATE.
  1588         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1589         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1590         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1591
  1592     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1593     12  AM-NOTIFICATION-TYPES.
  1594         16  AM-NOTIF-OF-LETTERS           PIC X.
  1595         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1596         16  AM-NOTIF-OF-REPORTS           PIC X.
  1597         16  AM-NOTIF-OF-STATUS            PIC X.
  1598
  1599     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1600         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1601         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1602         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1603         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1604
  1605     12  AM-BENEFIT-CONTROLS.
  1606         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1607             20  AM-BENEFIT-CODE           PIC XX.
  1608             20  AM-BENEFIT-TYPE           PIC X.
  1609             20  AM-BENEFIT-REVISION       PIC XXX.
  1610             20  AM-BENEFIT-REM-TERM       PIC X.
  1611             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1612             20  FILLER                    PIC XX.
  1613         16  FILLER                        PIC X(80).
  1614
  1615     12  AM-TRANSFER-DATA.
  1616         16  AM-TRANSFERRED-FROM.
  1617             20  AM-TRNFROM-CARRIER        PIC X.
  1618             20  AM-TRNFROM-GROUPING.
  1619                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1620                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1621             20  AM-TRNFROM-STATE          PIC XX.
  1622             20  AM-TRNFROM-ACCOUNT.
  1623                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  30
* EL6311.cbl
  1624                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1625             20  AM-TRNFROM-DTE            PIC XX.
  1626         16  AM-TRANSFERRED-TO.
  1627             20  AM-TRNTO-CARRIER          PIC X.
  1628             20  AM-TRNTO-GROUPING.
  1629                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1630                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1631             20  AM-TRNTO-STATE            PIC XX.
  1632             20  AM-TRNTO-ACCOUNT.
  1633                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1634                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1635             20  AM-TRNTO-DTE              PIC XX.
  1636         16  FILLER                        PIC X(10).
  1637
  1638     12  AM-SAVED-REMIT-TO                 PIC 99.
  1639
  1640     12  AM-COMM-STRUCTURE-SAVED.
  1641         16  AM-DEFN-1-SAVED.
  1642             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1643                 24  AM-AGT-SV             PIC X(10).
  1644                 24  AM-COM-TYP-SV         PIC X.
  1645                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1646                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1647                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1648                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1649                 24  FILLER                PIC X.
  1650                 24  AM-GL-CODES-SV        PIC X.
  1651                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1652                 24  FILLER                PIC X.
  1653         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1654             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1655                 24  FILLER                PIC X(11).
  1656                 24  AM-L-COMA-SV          PIC XXX.
  1657                 24  AM-J-COMA-SV          PIC XXX.
  1658                 24  AM-A-COMA-SV          PIC XXX.
  1659                 24  FILLER                PIC X(6).
  1660
  1661     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1662         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1663            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1664            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1665            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1666
  1667     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1668     12  FILLER                            PIC X(120).
  1669
  1670     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1671         16  AM-CONTROL-NAME               PIC X(30).
  1672         16  AM-EXECUTIVE-ONE.
  1673             20  AM-EXEC1-NAME             PIC X(15).
  1674             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1675                                                          COMP-3.
  1676             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1677                                                          COMP-3.
  1678         16  AM-EXECUTIVE-TWO.
  1679             20  AM-EXEC2-NAME             PIC X(15).
  1680             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1681                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  31
* EL6311.cbl
  1682             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1683                                                          COMP-3.
  1684
  1685     12  AM-RETRO-ADDITIONAL-DATA.
  1686         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1687         16  AM-RETRO-PREM-P-E             PIC X.
  1688         16  AM-RETRO-CLMS-P-I             PIC X.
  1689         16  AM-RETRO-RET-BRACKET-LF.
  1690             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1691                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1692                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1693             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1694                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1695                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1696             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1697                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1698                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1699         16  AM-RETRO-RET-BRACKET-AH.
  1700             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1701                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1702                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1703                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1704             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1705                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1706                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1707             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1708                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1709                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1710
  1711     12  AM-COMMENTS.
  1712         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1713
  1714     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1715         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1716         16  AM-FLI-BILLING-CODE           PIC X.
  1717         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1718         16  AM-FLI-UNITED-IDENT           PIC X.
  1719         16  AM-FLI-INTEREST-LOST-DATA.
  1720             20  AM-FLI-BANK-NO            PIC X(5).
  1721             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1722             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1723             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1724         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1725             20  AM-FLI-AGT                PIC X(9).
  1726             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1727             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1728         16  FILLER                        PIC X(102).
  1729
  1730     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1731         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1732             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1733             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1734             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1735             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1736             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1737         16  FILLER                          PIC X(10).
  1738******************************************************************
  1739*                                COPY ELCVADS.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  32
* EL6311.cbl
  1740******************************************************************
  1741*                                                                *
  1742*                                                                *
  1743*                            ELCVADS.                            *
  1744*                                                                *
  1745*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1746*   ELVADS                  LENGTH = 350                         *
  1747******************************************************************
  1748******************************************************************
  1749*                   C H A N G E   L O G
  1750*
  1751* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1752*-----------------------------------------------------------------
  1753*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1754* EFFECTIVE    NUMBER
  1755*-----------------------------------------------------------------
  1756* 100111    2011022800001  AJRA  NAPERSOFT
  1757******************************************************************
  1758
  1759 01  VIRGINIA-DISCLOSURE.
  1760     12  VD-COMPANY-CD              PIC X.
  1761     12  VD-CARRIER                 PIC X.
  1762     12  VD-GROUPING.
  1763         20  VD-GROUPING-PREFIX     PIC XXX.
  1764         20  VD-GROUPING-PRIME      PIC XXX.
  1765     12  VD-STATE                   PIC XX.
  1766     12  VD-ACCOUNT.
  1767         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1768         20  VD-ACCOUNT-PRIME       PIC X(6).
  1769     12  VD-CERT-EFF-DT             PIC XX.
  1770     12  VD-CERT-NO.
  1771         20  VD-CERT-PRIME          PIC X(10).
  1772         20  VD-CERT-SFX            PIC X.
  1773     12  VD-ENTRY-BATCH             PIC X(6).
  1774     12  VD-CSR-ID                  PIC X(4).
  1775     12  VD-NAME.
  1776         20  VD-INSURED-LAST-NAME   PIC X(15).
  1777         20  VD-INSURED-FIRST-NAME.
  1778             24  VD-INSURED-1ST-INIT PIC X.
  1779             24  FILLER             PIC X(9).
  1780         20  VD-INSURED-MIDDLE-INIT PIC X.
  1781     12  VD-JOINT-INSURED.
  1782         20 VD-JOINT-LAST-NAME      PIC X(15).
  1783         20 VD-JOINT-FIRST-NAME.
  1784            24  VD-JOINT-FIRST-INIT PIC X.
  1785            24  FILLER              PIC X(9).
  1786         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1787     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1788     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1789     12  VD-INSURED-CITY-STATE.
  1790         20  VD-INSURED-CITY        PIC X(28).
  1791         20  VD-INSURED-STATE       PIC XX.
  1792     12  VD-INSURED-ZIP-CODE.
  1793         20  VD-INSURED-ZIP-PRIME.
  1794             24  VD-INSURED-ZIP-1   PIC X.
  1795                 88  VD-CANADIAN-POST-CODE
  1796                                       VALUE 'A' THRU 'Z'.
  1797             24  FILLER             PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  33
* EL6311.cbl
  1798         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1799     12  VD-BENEFICIARY-NAME        PIC X(30).
  1800     12  VD-ACCOUNT-NAME            PIC X(30).
  1801     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1802     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1803     12  VD-1ST-PMT-DT              PIC XX.
  1804     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1805         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1806         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1807                                             '90' THRU '99'.
  1808     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1809                                    PIC XX.
  1810     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1811     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1812     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1813     12  VD-LF-TERM                 PIC S999   COMP-3.
  1814     12  VD-AH-BENEFIT-CD           PIC XX.
  1815         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1816         88  VD-INVALID-AH             VALUE '  ' '00'
  1817                                             '90' THRU '99'.
  1818     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1819     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1820     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1821     12  VD-AH-TERM                 PIC S999   COMP-3.
  1822     12  VD-LETTER-ID               PIC X(4).
  1823     12  VD-PROC-ID                 PIC X(4).
  1824     12  VD-COMP-ID                 PIC X(3).
  1825     12  VD-CURRENT-DATE            PIC XX.
  1826     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1827     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1828     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  34
* EL6311.cbl
  1830*    COPY ELCDATE.
  1831******************************************************************
  1832*                                                                *
  1833*                                                                *
  1834*                            ELCDATE.                            *
  1835*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1836*                            VMOD=2.003
  1837*                                                                *
  1838*                                                                *
  1839*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1840*                 LENGTH = 200                                   *
  1841******************************************************************
  1842
  1843 01  DATE-CONVERSION-DATA.
  1844     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1845     12  DC-OPTION-CODE                PIC X.
  1846         88  BIN-TO-GREG                VALUE ' '.
  1847         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1848         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1849         88  YMD-GREG-TO-BIN            VALUE '3'.
  1850         88  MDY-GREG-TO-BIN            VALUE '4'.
  1851         88  JULIAN-TO-BIN              VALUE '5'.
  1852         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1853         88  FIND-CENTURY               VALUE '7'.
  1854         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1855         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1856         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1857         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1858         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1859         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1860         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1861         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1862         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1863         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1864         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1865         88  BIN-3-TO-GREG              VALUE 'I'.
  1866         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1867         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1868         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1869         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1870         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1871         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1872         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1873         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1874         88  THREE-CHARACTER-BIN
  1875                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1876         88  GREGORIAN-TO-BIN
  1877                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1878         88  BIN-TO-GREGORIAN
  1879                  VALUES ' ' '1' 'I' '8' 'G'.
  1880         88  JULIAN-TO-BINARY
  1881                  VALUES '5' 'C' 'E' 'F'.
  1882     12  DC-ERROR-CODE                 PIC X.
  1883         88  NO-CONVERSION-ERROR        VALUE ' '.
  1884         88  DATE-CONVERSION-ERROR
  1885                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1886         88  DATE-IS-ZERO               VALUE '1'.
  1887         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  35
* EL6311.cbl
  1888         88  DATE-IS-INVALID            VALUE '3'.
  1889         88  DATE1-GREATER-DATE2        VALUE '4'.
  1890         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1891         88  DATE-INVALID-OPTION        VALUE '9'.
  1892         88  INVALID-CENTURY            VALUE 'A'.
  1893         88  ONLY-CENTURY               VALUE 'B'.
  1894         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1895         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1896     12  DC-END-OF-MONTH               PIC X.
  1897         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1898     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1899         88  USE-NORMAL-PROCESS         VALUE ' '.
  1900         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1901         88  ADJUST-UP-100-YRS          VALUE '2'.
  1902     12  FILLER                        PIC X.
  1903     12  DC-CONVERSION-DATES.
  1904         16  DC-BIN-DATE-1             PIC XX.
  1905         16  DC-BIN-DATE-2             PIC XX.
  1906         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1907         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1908                       DC-GREG-DATE-1-EDIT.
  1909             20  DC-EDIT1-MONTH        PIC 99.
  1910             20  SLASH1-1              PIC X.
  1911             20  DC-EDIT1-DAY          PIC 99.
  1912             20  SLASH1-2              PIC X.
  1913             20  DC-EDIT1-YEAR         PIC 99.
  1914         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1915         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1916                     DC-GREG-DATE-2-EDIT.
  1917             20  DC-EDIT2-MONTH        PIC 99.
  1918             20  SLASH2-1              PIC X.
  1919             20  DC-EDIT2-DAY          PIC 99.
  1920             20  SLASH2-2              PIC X.
  1921             20  DC-EDIT2-YEAR         PIC 99.
  1922         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1923         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1924                     DC-GREG-DATE-1-YMD.
  1925             20  DC-YMD-YEAR           PIC 99.
  1926             20  DC-YMD-MONTH          PIC 99.
  1927             20  DC-YMD-DAY            PIC 99.
  1928         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1929         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1930                      DC-GREG-DATE-1-MDY.
  1931             20  DC-MDY-MONTH          PIC 99.
  1932             20  DC-MDY-DAY            PIC 99.
  1933             20  DC-MDY-YEAR           PIC 99.
  1934         16  DC-GREG-DATE-1-ALPHA.
  1935             20  DC-ALPHA-MONTH        PIC X(10).
  1936             20  DC-ALPHA-DAY          PIC 99.
  1937             20  FILLER                PIC XX.
  1938             20  DC-ALPHA-CENTURY.
  1939                 24 DC-ALPHA-CEN-N     PIC 99.
  1940             20  DC-ALPHA-YEAR         PIC 99.
  1941         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1942         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1943         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1944         16  DC-JULIAN-DATE            PIC 9(05).
  1945         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  36
* EL6311.cbl
  1946                                       PIC 9(05).
  1947         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1948             20  DC-JULIAN-YEAR        PIC 99.
  1949             20  DC-JULIAN-DAYS        PIC 999.
  1950         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1951         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1952         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1953     12  DATE-CONVERSION-VARIBLES.
  1954         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1955         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1956             20  FILLER                PIC 9(3).
  1957             20  HOLD-CEN-1-CCYY.
  1958                 24  HOLD-CEN-1-CC     PIC 99.
  1959                 24  HOLD-CEN-1-YY     PIC 99.
  1960             20  HOLD-CEN-1-MO         PIC 99.
  1961             20  HOLD-CEN-1-DA         PIC 99.
  1962         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1963             20  HOLD-CEN-1-R-MO       PIC 99.
  1964             20  HOLD-CEN-1-R-DA       PIC 99.
  1965             20  HOLD-CEN-1-R-CCYY.
  1966                 24  HOLD-CEN-1-R-CC   PIC 99.
  1967                 24  HOLD-CEN-1-R-YY   PIC 99.
  1968             20  FILLER                PIC 9(3).
  1969         16  HOLD-CENTURY-1-X.
  1970             20  FILLER                PIC X(3)  VALUE SPACES.
  1971             20  HOLD-CEN-1-X-CCYY.
  1972                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1973                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1974             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1975             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1976         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1977             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1978             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1979             20  HOLD-CEN-1-R-X-CCYY.
  1980                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1981                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1982             20  FILLER                PIC XXX.
  1983         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1984         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1985         16  DC-JULIAN-DATE-1          PIC 9(07).
  1986         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1987             20  DC-JULIAN-1-CCYY.
  1988                 24  DC-JULIAN-1-CC    PIC 99.
  1989                 24  DC-JULIAN-1-YR    PIC 99.
  1990             20  DC-JULIAN-DA-1        PIC 999.
  1991         16  DC-JULIAN-DATE-2          PIC 9(07).
  1992         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1993             20  DC-JULIAN-2-CCYY.
  1994                 24  DC-JULIAN-2-CC    PIC 99.
  1995                 24  DC-JULIAN-2-YR    PIC 99.
  1996             20  DC-JULIAN-DA-2        PIC 999.
  1997         16  DC-GREG-DATE-A-EDIT.
  1998             20  DC-EDITA-MONTH        PIC 99.
  1999             20  SLASHA-1              PIC X VALUE '/'.
  2000             20  DC-EDITA-DAY          PIC 99.
  2001             20  SLASHA-2              PIC X VALUE '/'.
  2002             20  DC-EDITA-CCYY.
  2003                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  37
* EL6311.cbl
  2004                 24  DC-EDITA-YEAR     PIC 99.
  2005         16  DC-GREG-DATE-B-EDIT.
  2006             20  DC-EDITB-MONTH        PIC 99.
  2007             20  SLASHB-1              PIC X VALUE '/'.
  2008             20  DC-EDITB-DAY          PIC 99.
  2009             20  SLASHB-2              PIC X VALUE '/'.
  2010             20  DC-EDITB-CCYY.
  2011                 24  DC-EDITB-CENT     PIC 99.
  2012                 24  DC-EDITB-YEAR     PIC 99.
  2013         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2014         16  DC-GREG-DATE-CYMD-R REDEFINES
  2015                              DC-GREG-DATE-CYMD.
  2016             20  DC-CYMD-CEN           PIC 99.
  2017             20  DC-CYMD-YEAR          PIC 99.
  2018             20  DC-CYMD-MONTH         PIC 99.
  2019             20  DC-CYMD-DAY           PIC 99.
  2020         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2021         16  DC-GREG-DATE-MDCY-R REDEFINES
  2022                              DC-GREG-DATE-MDCY.
  2023             20  DC-MDCY-MONTH         PIC 99.
  2024             20  DC-MDCY-DAY           PIC 99.
  2025             20  DC-MDCY-CEN           PIC 99.
  2026             20  DC-MDCY-YEAR          PIC 99.
  2027    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2028        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2029    12  DC-EL310-DATE                  PIC X(21).
  2030    12  FILLER                         PIC X(28).
  2031
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  38
* EL6311.cbl
  2033*    COPY ELCLOGOF.
  2034******************************************************************
  2035*                                                                *
  2036*                                                                *
  2037*                            ELCLOGOF.                           *
  2038*                            VMOD=2.001                          *
  2039*                                                                *
  2040*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2041*                                                                *
  2042******************************************************************
  2043 01  CLASIC-LOGOFF.
  2044     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2045     12  LOGOFF-TEXT.
  2046         16  FILLER          PIC X(5)    VALUE SPACES.
  2047         16  LOGOFF-MSG.
  2048             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2049             20  FILLER      PIC X       VALUE SPACES.
  2050             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2051         16  FILLER          PIC X(80)
  2052           VALUE '* YOU ARE NOW LOGGED OFF'.
  2053         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2054         16  FILLER          PIC X       VALUE QUOTE.
  2055         16  LOGOFF-SYS-MSG  PIC X(17)
  2056           VALUE 'S CLAS-IC SYSTEM '.
  2057     12  TEXT-MESSAGES.
  2058         16  UNACCESS-MSG    PIC X(29)
  2059             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2060         16  PGMIDERR-MSG    PIC X(17)
  2061             VALUE 'PROGRAM NOT FOUND'.
  2062
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  39
* EL6311.cbl
  2064*    COPY ELCATTR.
  2065******************************************************************
  2066*                                                                *
  2067*                            ELCATTR.                            *
  2068*                            VMOD=2.001                          *
  2069*                                                                *
  2070*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2071*                                                                *
  2072*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2073*                                                                *
  2074*                   POS 1   P=PROTECTED                          *
  2075*                           U=UNPROTECTED                        *
  2076*                           S=ASKIP                              *
  2077*                   POS 2   A=ALPHA/NUMERIC                      *
  2078*                           N=NUMERIC                            *
  2079*                   POS 3   N=NORMAL                             *
  2080*                           B=BRIGHT                             *
  2081*                           D=DARK                               *
  2082*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2083*                           OF=MODIFIED DATA TAG OFF             *
  2084*                                                                *
  2085*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2086******************************************************************
  2087 01  ATTRIBUTE-LIST.
  2088     12  AL-PABOF            PIC X       VALUE 'Y'.
  2089     12  AL-PABON            PIC X       VALUE 'Z'.
  2090     12  AL-PADOF            PIC X       VALUE '%'.
  2091     12  AL-PADON            PIC X       VALUE '_'.
  2092     12  AL-PANOF            PIC X       VALUE '-'.
  2093     12  AL-PANON            PIC X       VALUE '/'.
  2094     12  AL-SABOF            PIC X       VALUE '8'.
  2095     12  AL-SABON            PIC X       VALUE '9'.
  2096     12  AL-SADOF            PIC X       VALUE '@'.
  2097     12  AL-SADON            PIC X       VALUE QUOTE.
  2098     12  AL-SANOF            PIC X       VALUE '0'.
  2099     12  AL-SANON            PIC X       VALUE '1'.
  2100     12  AL-UABOF            PIC X       VALUE 'H'.
  2101     12  AL-UABON            PIC X       VALUE 'I'.
  2102     12  AL-UADOF            PIC X       VALUE '<'.
  2103     12  AL-UADON            PIC X       VALUE '('.
  2104     12  AL-UANOF            PIC X       VALUE ' '.
  2105     12  AL-UANON            PIC X       VALUE 'A'.
  2106     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2107     12  AL-UNBON            PIC X       VALUE 'R'.
  2108     12  AL-UNDOF            PIC X       VALUE '*'.
  2109     12  AL-UNDON            PIC X       VALUE ')'.
  2110     12  AL-UNNOF            PIC X       VALUE '&'.
  2111     12  AL-UNNON            PIC X       VALUE 'J'.
  2112
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  40
* EL6311.cbl
  2114*    COPY ELCEMIB.
  2115******************************************************************
  2116*                                                                *
  2117*                                                                *
  2118*                            ELCEMIB.                            *
  2119*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2120*                            VMOD=2.005                          *
  2121*                                                                *
  2122*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2123*                                                                *
  2124******************************************************************
  2125 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2126     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2127     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2128     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2129     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2130     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2131     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2132     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2133     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2134     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2135         88  EMI-NO-ERRORS                    VALUE '1'.
  2136         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2137         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2138     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2139         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2140     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2141         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2142         88  EMI-AREA1-FULL                   VALUE '2'.
  2143     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2144         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2145         88  EMI-AREA2-FULL                   VALUE '2'.
  2146     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2147         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2148         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2149         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2150         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2151         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2152     12  EMI-ERROR-LINES.
  2153         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2154         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2155         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2156         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2157             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2158                 24  EMI-ERR-NUM         PIC X(4).
  2159                 24  EMI-FILLER          PIC X.
  2160                 24  EMI-SEV             PIC X.
  2161                 24  FILLER              PIC X.
  2162             20  FILLER                  PIC X(02).
  2163     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2164         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2165             20  EMI-ERROR-NUMBER    PIC X(4).
  2166             20  EMI-FILL            PIC X.
  2167             20  EMI-SEVERITY        PIC X.
  2168             20  FILLER              PIC X.
  2169             20  EMI-ERROR-TEXT.
  2170                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2171                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  41
* EL6311.cbl
  2172     12  EMI-SEVERITY-SAVE           PIC X.
  2173         88  EMI-NOTE                    VALUE 'N'.
  2174         88  EMI-WARNING                 VALUE 'W'.
  2175         88  EMI-FORCABLE                VALUE 'F'.
  2176         88  EMI-FATAL                   VALUE 'X'.
  2177     12  EMI-MESSAGE-FLAG            PIC X.
  2178         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2179         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2180     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2181     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2182         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2183         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2184         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2185     12  emi-claim-no                pic x(7).
  2186     12  emi-claim-type              pic x(6).
  2187     12  FILLER                      PIC X(124)  VALUE SPACES.
  2188     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2189     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2190     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2191     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2192
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  42
* EL6311.cbl
  2194*    COPY ELCINTF.
  2195******************************************************************
  2196*                                                                *
  2197*                                                                *
  2198*                            ELCINTF.                            *
  2199*                            VMOD=2.017                          *
  2200*                                                                *
  2201*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2202*                                                                *
  2203*       LENGTH = 1024                                            *
  2204*                                                                *
  2205******************************************************************
  2206*                   C H A N G E   L O G
  2207*
  2208* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2209*-----------------------------------------------------------------
  2210*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2211* EFFECTIVE    NUMBER
  2212*-----------------------------------------------------------------
  2213* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2214******************************************************************
  2215 01  PROGRAM-INTERFACE-BLOCK.
  2216     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2217     12  PI-CALLING-PROGRAM              PIC X(8).
  2218     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2219     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2220     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2221     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2222     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2223     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2224     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2225     12  PI-COMPANY-ID                   PIC XXX.
  2226     12  PI-COMPANY-CD                   PIC X.
  2227
  2228     12  PI-COMPANY-PASSWORD             PIC X(8).
  2229
  2230     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2231
  2232     12  PI-CONTROL-IN-PROGRESS.
  2233         16  PI-CARRIER                  PIC X.
  2234         16  PI-GROUPING                 PIC X(6).
  2235         16  PI-STATE                    PIC XX.
  2236         16  PI-ACCOUNT                  PIC X(10).
  2237         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2238                                         PIC X(10).
  2239         16  PI-CLAIM-CERT-GRP.
  2240             20  PI-CLAIM-NO             PIC X(7).
  2241             20  PI-CERT-NO.
  2242                 25  PI-CERT-PRIME       PIC X(10).
  2243                 25  PI-CERT-SFX         PIC X.
  2244             20  PI-CERT-EFF-DT          PIC XX.
  2245         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2246             20  PI-PLAN-CODE            PIC X(2).
  2247             20  PI-REVISION-NUMBER      PIC X(3).
  2248             20  PI-PLAN-EFF-DT          PIC X(2).
  2249             20  PI-PLAN-EXP-DT          PIC X(2).
  2250             20  FILLER                  PIC X(11).
  2251         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  43
* EL6311.cbl
  2252             20  PI-OE-REFERENCE-1.
  2253                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2254                 25  PI-OE-REF-1-SUFF    PIC XX.
  2255
  2256     12  PI-SESSION-IN-PROGRESS          PIC X.
  2257         88  CLAIM-SESSION                   VALUE '1'.
  2258         88  CREDIT-SESSION                  VALUE '2'.
  2259         88  WARRANTY-SESSION                VALUE '3'.
  2260         88  MORTGAGE-SESSION                VALUE '4'.
  2261         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2262
  2263
  2264*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2265
  2266     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2267     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2268
  2269     12  PI-CREDIT-USER                  PIC X.
  2270         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2271         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2272
  2273     12  PI-CLAIM-USER                   PIC X.
  2274         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2275         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2276
  2277     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2278         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2279         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2280         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2281         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2282         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2283
  2284     12  PI-PROCESSOR-ID                 PIC X(4).
  2285
  2286     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2287
  2288     12  PI-MEMBER-CAPTION               PIC X(10).
  2289
  2290     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2291         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2292
  2293     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2294     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2295     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2296     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2297
  2298     12  PI-AH-OVERRIDE-L1               PIC X.
  2299     12  PI-AH-OVERRIDE-L2               PIC XX.
  2300     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2301     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2302
  2303     12  PI-NEW-SYSTEM                   PIC X(2).
  2304
  2305     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2306     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2307         88  PI-USES-PAID-TO                 VALUE '1'.
  2308     12  PI-CRDTCRD-SYSTEM.
  2309         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  44
* EL6311.cbl
  2310             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2311             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2312         16  PI-CC-MONTH-END-DT          PIC XX.
  2313     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2314
  2315     12  PI-OE-REFERENCE-2.
  2316         16  PI-OE-REF-2-PRIME           PIC X(10).
  2317         16  PI-OE-REF-2-SUFF            PIC X.
  2318
  2319     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2320
  2321     12  PI-LANGUAGE-TYPE                PIC X.
  2322             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2323             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2324             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2325
  2326     12  PI-POLICY-LINKAGE-IND           PIC X.
  2327         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2328         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2329                                                   LOW-VALUES.
  2330
  2331     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2332     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2333         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2334         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2335
  2336     12  PI-PROCESSOR-CSR-IND            PIC X.
  2337         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2338         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2339
  2340     12  FILLER                          PIC X(3).
  2341
  2342     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2343
  2344     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2345         PI-SYSTEM-LEVEL.
  2346
  2347         16  PI-ENTRY-CODES.
  2348             20  PI-ENTRY-CD-1           PIC X.
  2349             20  PI-ENTRY-CD-2           PIC X.
  2350
  2351         16  PI-RETURN-CODES.
  2352             20  PI-RETURN-CD-1          PIC X.
  2353             20  PI-RETURN-CD-2          PIC X.
  2354
  2355         16  PI-UPDATE-STATUS-SAVE.
  2356             20  PI-UPDATE-BY            PIC X(4).
  2357             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2358
  2359         16  PI-LOWER-CASE-LETTERS       PIC X.
  2360             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2361
  2362*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2363*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2364*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2365
  2366         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2367             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  45
* EL6311.cbl
  2368             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2369             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2370             88  ACCNT-CNTL                  VALUE '3'.
  2371             88  CARR-ACCNT-CNTL             VALUE '4'.
  2372
  2373         16  PI-PROCESSOR-CAP-LIST.
  2374             20  PI-SYSTEM-CONTROLS.
  2375                24 PI-SYSTEM-DISPLAY     PIC X.
  2376                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2377                24 PI-SYSTEM-MODIFY      PIC X.
  2378                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2379             20  FILLER                  PIC XX.
  2380             20  PI-DISPLAY-CAP          PIC X.
  2381                 88  DISPLAY-CAP             VALUE 'Y'.
  2382             20  PI-MODIFY-CAP           PIC X.
  2383                 88  MODIFY-CAP              VALUE 'Y'.
  2384             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2385                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2386             20  PI-FORCE-CAP            PIC X.
  2387                 88  FORCE-CAP               VALUE 'Y'.
  2388
  2389         16  PI-PROGRAM-CONTROLS.
  2390             20  PI-PGM-PRINT-OPT        PIC X.
  2391             20  PI-PGM-FORMAT-OPT       PIC X.
  2392             20  PI-PGM-PROCESS-OPT      PIC X.
  2393             20  PI-PGM-TOTALS-OPT       PIC X.
  2394
  2395         16  PI-HELP-INTERFACE.
  2396             20  PI-LAST-ERROR-NO        PIC X(4).
  2397             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2398
  2399         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2400             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2401
  2402         16  PI-CR-CONTROL-IN-PROGRESS.
  2403             20  PI-CR-CARRIER           PIC X.
  2404             20  PI-CR-GROUPING          PIC X(6).
  2405             20  PI-CR-STATE             PIC XX.
  2406             20  PI-CR-ACCOUNT           PIC X(10).
  2407             20  PI-CR-FIN-RESP          PIC X(10).
  2408             20  PI-CR-TYPE              PIC X.
  2409
  2410         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2411
  2412         16  PI-CR-MONTH-END-DT          PIC XX.
  2413
  2414         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2415             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2416             88  PI-ZERO-CARRIER             VALUE '1'.
  2417             88  PI-ZERO-GROUPING            VALUE '2'.
  2418             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2419
  2420         16  PI-CARRIER-SECURITY         PIC X.
  2421             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2422
  2423         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2424             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2425             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  46
* EL6311.cbl
  2426
  2427         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2428             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2429                                         INDEXED BY PI-ACCESS-NDX
  2430                                         PIC X.
  2431
  2432         16  PI-GA-BILLING-CONTROL       PIC X.
  2433             88  PI-GA-BILLING               VALUE '1'.
  2434
  2435         16  PI-MAIL-PROCESSING          PIC X.
  2436             88  PI-MAIL-YES                 VALUE 'Y'.
  2437
  2438         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2439
  2440         16  PI-AR-SYSTEM.
  2441             20  PI-AR-PROCESSING-CNTL   PIC X.
  2442                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2443             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2444             20  PI-AR-MONTH-END-DT      PIC XX.
  2445
  2446         16  PI-MP-SYSTEM.
  2447             20  PI-MORTGAGE-USER            PIC X.
  2448                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2449                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2450             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2451                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2452                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2453                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2454                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2455                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2456             20  PI-MP-MONTH-END-DT          PIC XX.
  2457             20  PI-MP-REFERENCE-NO.
  2458                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2459                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2460
  2461         16  PI-LABEL-CONTROL            PIC X(01).
  2462             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2463             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2464
  2465         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2466             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2467
  2468         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2469             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2470             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2471
  2472         16  FILLER                      PIC X(14).
  2473
  2474     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2475******************************************************************
  2476
  2477     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2478*    COPY ELC631PI.
  2479******************************************************************
  2480*                                                                *
  2481*                                                                *
  2482*                            ELC631PI                            *
  2483*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  47
* EL6311.cbl
  2484*                                                                *
  2485*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2486*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2487*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2488*                                                                *
  2489*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2490*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2491*    BETWEEN PROGRAMS.                                           *
  2492*                                                                *
  2493*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2494*                                                                *
  2495*               EL631 - EL6311 - EL6312 - EL6313                 *
  2496*                                                                *
  2497******************************************************************
  2498
  2499         16  PI-631-DATA.
  2500             20  PI-ERPNDB-KEY.
  2501                 24  PI-PB-COMPANY-CD     PIC X.
  2502                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2503                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2504                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2505
  2506             20  PI-ERPNDB-ALT-KEY.
  2507                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2508                 24  PI-PB-CARRIER        PIC X.
  2509                 24  PI-PB-GROUPING       PIC X(6).
  2510                 24  PI-PB-STATE          PIC XX.
  2511                 24  PI-PB-ACCOUNT        PIC X(10).
  2512                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2513                 24  PI-PB-CERT-NO.
  2514                     28  PI-PB-CERT-PRIME PIC X(10).
  2515                     28  PI-PB-CERT-SFX   PIC X.
  2516                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2517                 24  PI-PB-RECORD-TYPE    PIC X.
  2518
  2519             20  PI-ERPNDB-CSR-KEY.
  2520                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2521                 24  PI-PB-CSR-ID             PIC X(4).
  2522                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2523                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2524                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2525
  2526             20  PI-BROWSE-TYPE               PIC X.
  2527                 88  PI-FILE-BROWSE             VALUE ' '.
  2528                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2529                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2530                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2531                 88  PI-CSR-BROWSE              VALUE '4'.
  2532
  2533             20  PI-MAINT-FUNCTION            PIC X.
  2534                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2535                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2536                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2537                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2538                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2539                 88  PI-PF5-FUNCTION            VALUE '5'.
  2540                 88  PI-PF6-FUNCTION            VALUE '6'.
  2541
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  48
* EL6311.cbl
  2542             20  PI-FILE-SWITCHES.
  2543                 24  PI-ALL-ISSUES-SW         PIC X.
  2544                     88  ALL-ISSUES             VALUE 'Y'.
  2545                 24  PI-ALL-CANCELS-SW        PIC X.
  2546                     88  ALL-CANCELS            VALUE 'Y'.
  2547                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2548                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2549                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2550                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2551                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2552                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2553                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2554                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2555                 24  PI-HOLD-REC-SW           PIC X.
  2556                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2557                 24  PI-CHANGE-REC-SW         PIC X.
  2558                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2559                 24  PI-CHK-REQ-REC-SW        PIC X.
  2560                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2561                 24  PI-ISSUE-WARNING-SW      PIC X.
  2562                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2563                 24  PI-CANCEL-WARNING-SW     PIC X.
  2564                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2565             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2566                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2567             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2568                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2569
  2570             20  PI-MAP-NAME                  PIC X(8).
  2571
  2572             20  PI-CURSOR                    PIC S9(4) COMP.
  2573
  2574             20  PI-PREV-ALT-KEY              PIC X(36).
  2575             20  PI-PREV-CSR-KEY              PIC X(15).
  2576             20  PI-PREV-KEY.
  2577                 24  PI-PREV-COMPANY-CD       PIC X.
  2578                 24  PI-PREV-BATCH            PIC X(6).
  2579                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2580                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2581             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2582             20  PI-BROWSE-SW                 PIC X.
  2583                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2584                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2585             20  PI-SV-CARRIER                PIC X.
  2586             20  PI-SV-GROUPING               PIC X(6).
  2587             20  PI-SV-STATE                  PIC XX.
  2588             20  PI-EDIT-SW                   PIC X.
  2589             20  PI-DISPLAY-SW                PIC XX.
  2590                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
  2591                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2592             20  PI-CRITERIA-DATA             PIC X(350).
  2593             20  PI-BMODE                     PIC X.
  2594             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2595             20  PI-BPMTS                     PIC S999     COMP-3.
  2596             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2597             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2598             20  PI-CSR-SESSION-SW            PIC X.
  2599                 88  CSR-EDIT-SESSION           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  49
* EL6311.cbl
  2600             20  PI-ERRORS-SW                 PIC X.
  2601                 88  FATAL-ERRORS               VALUE 'X'.
  2602*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2603             20  FILLER                       PIC X(5).
  2604
  2605        16  FILLER             PIC X(94).
  2606
  2607 01  W-LETTER-COMMUNICATION-AREAS.
  2608*    COPY ELC1042.
  2609******************************************************************
  2610*                                                                *
  2611*                                                                *
  2612*                           ELC1042                              *
  2613*                            VMOD=2.002                          *
  2614*                                                                *
  2615*    NOTE                                                        *
  2616*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2617*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2618*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2619*        TO THESE PROGRAMS.                                      *
  2620*                                                                *
  2621*    NOTE                                                        *
  2622*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2623*        USE ONLY!                                               *
  2624*                                                                *
  2625******************************************************************
  2626
  2627         16  PI-1042-WA.
  2628             20  PI-ACTION       PIC  X(01).
  2629                 88 PI-SHOW-MODE           VALUE '1'.
  2630                 88 PI-CLEAR-MODE          VALUE '2'.
  2631                 88 PI-CREATE-MODE         VALUE '3'.
  2632             20  PI-COMM-CONTROL PIC  X(12).
  2633             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2634             20  PI-EOF-SW       PIC  X(01).
  2635                 88  PI-FILE-EOF           VALUE 'Y'.
  2636             20  PI-FILETYP      PIC  X(01).
  2637             20  PI-FORM-SQUEEZE-CONTROL
  2638                                 PIC  X(01).
  2639                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2640                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2641             20  PI-LAST-CONTROL PIC  X(12).
  2642             20  PI-TEMP-STOR-ITEMS
  2643                                 PIC S9(04) COMP.
  2644             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2645             20  PI-UPDATE-SW    PIC  9(01).
  2646                 88 ANY-UPDATES            VALUE 1.
  2647             20  PI-104-SCREEN-SENT-IND
  2648                                 PIC  X(01).
  2649                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2650                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2651             20  PI-1042-SCREEN-SENT-IND
  2652                                 PIC  X(01).
  2653                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2654                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2655             20  PI-1042-ARCHIVE-IND
  2656                                 PIC  X(01).
  2657                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  50
* EL6311.cbl
  2658             20  FILLER          PIC  X(29).
  2659*    COPY ELC689PI.
  2660******************************************************************
  2661*                                                                *
  2662*                            ELC689PI                            *
  2663*                            VMOD=2.003                          *
  2664*                                                                *
  2665*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2666*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2667*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2668*                                                                *
  2669*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2670*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2671*    BETWEEN PROGRAMS.                                           *
  2672*                                                                *
  2673*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2674*                                                                *
  2675*               EL631 - EL689  - EL6891 - EL6892                 *
  2676*                                                                *
  2677******************************************************************
  2678*                   C H A N G E   L O G
  2679*
  2680* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2681*-----------------------------------------------------------------
  2682*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2683* EFFECTIVE    NUMBER
  2684*-----------------------------------------------------------------
  2685* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2686* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2687* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2688******************************************************************
  2689
  2690
  2691         16  PI-689-WORK-AREA.
  2692             20  PI-689-ALT-PRINTER-ID
  2693                                 PIC  X(04).
  2694             20  PI-689-ARCHIVE-NUMBER
  2695                                 PIC  9(08).
  2696             20  PI-689-ARCHIVE-SW
  2697                                 PIC  X(01).
  2698                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2699             20  PI-689-DATA-SOURCE
  2700                                 PIC  X(01).
  2701                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2702                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2703                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2704                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  2705                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2706             20  PI-689-ERROR-IND
  2707                                 PIC  X(01).
  2708                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2709             20  PI-689-ERROR    PIC  9(04).
  2710                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2711                 88  PI-689-FATAL-ERROR
  2712                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2713                            0042 0047 0051 0066 0067 0070
  2714                            0168 0169 0174 0175 0176 0177 0179
  2715                            0180 0181 0182 0184 0185 0189 0190
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  51
* EL6311.cbl
  2716                            0191
  2717                            0215 0279 0280
  2718                            0412 0413 0454
  2719                            0533 0537
  2720                            2055 2114 2208 2209 2216 2232 2369
  2721                            2398 2433 2908 2999
  2722                            3000 3770 3771 3775
  2723                            7250 7365 7367 7368 7369 7370 7371
  2724                            7272 7373 7374 7376 7377 7378 7379
  2725                            7381 7388 7390 7393 7395 7396 7398
  2726                            9095 9096 9281 9298 9299 9320 9327
  2727                            9426 9427.
  2728                 88  PI-689-STOP-ERROR
  2729                     VALUES 0004 0008 0013 0023 0029 0033
  2730                            0042 0047 0066 0067 0070
  2731                            0168 0169 0174 0175 0176 0177
  2732                            0181 0182 0184 0185 0189 0190
  2733                            0279 0280
  2734                            0412 0413 0454
  2735                            2055 2208 2209 2216 2232
  2736                            2398 2999
  2737                            3000 3770 3771 3775
  2738                            7250 7365 7369 7370 7371
  2739                            7272 7373 7374 7376 7377 7378 7379
  2740                            7381 7388 7390 7393 7396 7398
  2741                            9095 9096 9299 9320 9426.
  2742             20  PI-689-FOLLOW-UP-DATE
  2743                                 PIC  X(02).
  2744             20  PI-689-FORM-NUMBER
  2745                                 PIC  X(04).
  2746             20  PI-689-LABEL-SOURCE
  2747                                 PIC X(01).
  2748                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2749                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2750                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2751                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2752                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2753                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2754                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2755             20  PI-689-NUMBER-COPIES
  2756                                 PIC  9(01).
  2757             20  PI-689-NUMBER-LABEL-LINES
  2758                                 PIC  9(01).
  2759             20  PI-689-NUMBER-TEXT-RECORDS
  2760                                 PIC  9(03).
  2761             20  PI-689-PRINT-ORDER-SW
  2762                                 PIC  X(01).
  2763                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2764                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2765                 88  PI-689-PRINT-LATER     VALUE '3'.
  2766                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2767             20  PI-689-PRINT-RESTRICTION
  2768                                 PIC  X(01).
  2769                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2770                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2771                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2772             20  PI-689-PRINT-SW PIC  X(01).
  2773                 88  PI-689-PRINT-PERFORMED VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  52
* EL6311.cbl
  2774             20  PI-689-RESEND-DATE-1
  2775                                 PIC  X(02).
  2776             20  PI-689-RESEND-LETR-1
  2777                                 PIC X(4).
  2778             20  PI-689-TEMP-STOR-ID
  2779                                 PIC  X(08).
  2780             20  PI-689-USE-SCREEN-IND
  2781                                 PIC  X(01).
  2782                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2783             20  PI-689-ARCH-POINTER
  2784                                 PIC S9(08) COMP.
  2785                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2786             20  PI-689-ARCT-POINTER
  2787                                 PIC S9(08) COMP.
  2788                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2789             20  PI-689-VARIABLE-DATA-GRP.
  2790                 24  PI-689-VARIABLE-DATA-1
  2791                                 PIC  X(30).
  2792                 24  PI-689-VARIABLE-DATA-2
  2793                                 PIC  X(30).
  2794                 24  PI-689-VARIABLE-DATA-3
  2795                                 PIC  X(30).
  2796                 24  PI-689-VARIABLE-DATA-4
  2797                                 PIC  X(30).
  2798
  2799         16  PI-689-KEY-DATA-FIELDS.
  2800             20  PI-689-ACCOUNT  PIC  X(10).
  2801             20  PI-689-CARRIER  PIC  X(01).
  2802             20  PI-689-CERT-NO.
  2803                 24  PI-689-CERT-PRIME
  2804                                 PIC  X(10).
  2805                 24  PI-689-CERT-SFX
  2806                                 PIC  X(01).
  2807             20  PI-689-CHG-SEQ-NO
  2808                                 PIC S9(04)    COMP.
  2809             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2810                                 PIC  X(02).
  2811             20  PI-689-ENTRY-BATCH
  2812                                 PIC  X(06).
  2813             20  PI-689-EFF-DATE PIC  X(02).
  2814             20  PI-689-EXP-DATE PIC  X(02).
  2815             20  PI-689-GROUPING PIC  X(06).
  2816             20  PI-689-RESP-PERSON
  2817                                 PIC  X(10).
  2818             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2819             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2820                                 PIC  X(04).
  2821             20  PI-689-STATE    PIC  X(02).
  2822             20  PI-689-TYPE     PIC  X(01).
  2823             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2824             20  PI-689-ALT-SEQ-NO
  2825                                 PIC S9(04)    COMP.
  2826         16  PI-689-DATE-EDIT    PIC  X(08).
  2827         16  PI-689-FOLLOW-UP-EDIT
  2828                                 PIC  X(08).
  2829         16  PI-689-RESEND1-EDIT PIC  X(08).
  2830         16  PI-689-SEQ-EDIT     PIC  X(08).
  2831         16  PI-689-BCSEQ-EDIT   PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  53
* EL6311.cbl
  2832         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2833             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2834         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2835         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  54
* EL6311.cbl
  2837
  2838 01  WS-EL6315-PASS-AREA.
  2839        16  PI-6315-ISS-CAN-SW      PIC X.
  2840        16  FILLER                  PIC X(120).
  2841        16  PI-RES-REF-CLM-TYPE     PIC X.
  2842        16  FILLER                  PIC X.
  2843        16  PI-6315-PASS-AREA.
  2844            20 FILLER               PIC X(236).
  2845            20 PI-6315-FINALIZED    PIC X.
  2846            20 FILLER               PIC X(280).
  2847
  2848 01  WS-EL6316-PASS-AREA.
  2849        16  PI-ISS-CAN-SW           PIC X.
  2850        16  FILLER                  PIC X(121).
  2851        16  PI-CLM-RESC-IND         PIC X.
  2852        16  PI-6316-PASS-AREA.
  2853            20 FILLER               PIC X(236).
  2854            20 PI-6316-FINALIZED    PIC X.
  2855            20 FILLER               PIC X(280).
  2856
  2857******************************************************************
  2858*                                                                *
  2859*         P A S S   A R E A   F O R   E D I T                    *
  2860*                                                                *
  2861******************************************************************
  2862
  2863 01  PASSED-RECORD.
  2864     12  RECORD-SAVE                  PIC X(585).
  2865* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2866*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2867*                    BY  WK-CURRENT-DATE.
  2868******************************************************************
  2869*                                                                *
  2870*                                                                *
  2871*                             ELC50W1                            *
  2872*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2873*                            VMOD=2.004                          *
  2874*                                                                *
  2875*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2876*                                                                *
  2877*                                                                *
  2878******************************************************************
  2879
  2880     12  WK-WORK-AREA.
  2881         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2882         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2883         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2884         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2885         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2886         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2887         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2888         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2889         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2890         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2891         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2892         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2893         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2894         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  55
* EL6311.cbl
  2895         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2896         16  WK-CREDIT-EDIT-CONTROLS.
  2897             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2898             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2899             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2900             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2901             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2902             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2903         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2904         16  WK-SAVE-REIN-DATA.
  2905             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2906             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2907             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2908         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2909             88  ENTRY-FROM-EL6311       VALUE '6'.
  2910         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2911         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2912     12  WK-RECORD-ADDRESSES.
  2913         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2914         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2915         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2916         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2917         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2918         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2919         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2920         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2921     12  WK-OVER-SHORT-AREA.
  2922         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  2923         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  2924         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  2925             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  2926         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  56
* EL6311.cbl
  2928
  2929*    COPY ELCEDITC.
  2930******************************************************************
  2931*                                                                *
  2932*                                                                *
  2933*                            ELCEDITC                            *
  2934*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2935*                            VMOD=2.012                          *
  2936*                                                                *
  2937*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  2938*                     EL6313, EL050 AND EL517.                   *
  2939*                                                                *
  2940******************************************************************
  2941******************************************************************
  2942*                   C H A N G E   L O G
  2943*
  2944* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2945*-----------------------------------------------------------------
  2946*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2947* EFFECTIVE    NUMBER
  2948*-----------------------------------------------------------------
  2949* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2950******************************************************************
  2951
  2952     12  EDIT-CRITERIA-DATA.
  2953         16  EC-CO-MONTH-END-DT       PIC XX.
  2954         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  2955         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  2956         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  2957         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  2958         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  2959         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  2960         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  2961         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  2962         16  EC-CO-REM-TERM-CALC      PIC X.
  2963               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  2964               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  2965               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  2966               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  2967
  2968         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  2969               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  2970               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  2971               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  2972               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  2973               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  2974               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  2975               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  2976               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  2977               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  2978               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  2979
  2980         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  2981               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  2982               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  2983               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  2984               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  2985               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  57
* EL6311.cbl
  2986               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  2987               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  2988               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  2989
  2990         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  2991                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  2992                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  2993
  2994         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  2995                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  2996                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  2997                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  2998                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  2999                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3000                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3001                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3002                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3003
  3004         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3005               88  EC-BR-REDUCING                   VALUE 'R'.
  3006               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3007
  3008         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3009         16  EC-BR-LF-DESC             PIC X(10).
  3010         16  EC-BR-AH-DESC             PIC X(10).
  3011         16  EC-BR-LF-COMMENT          PIC X(10).
  3012         16  EC-BR-AH-COMMENT          PIC X(10).
  3013
  3014         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3015               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3016               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3017               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3018               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3019
  3020         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3021               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3022               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3023               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3024               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3025
  3026         16  EC-BR-LF-REFUND-CALC      PIC X.
  3027                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3028                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3029                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3030                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3031                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3032                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3033                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3034
  3035         16  EC-BR-AH-REFUND-CALC      PIC X.
  3036                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3037                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3038                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3039                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3040                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3041                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3042                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3043                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  58
* EL6311.cbl
  3044
  3045         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3046                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3047                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3048                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3049
  3050         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3051                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3052                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3053                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3054
  3055         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3056         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3057         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3058         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3059
  3060         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3061         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3062                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3063                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3064                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3065                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3066
  3067         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3068               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3069               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3070               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3071               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3072               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3073
  3074         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3075               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3076               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3077               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3078               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3079               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3080
  3081         16  EC-ST-LF-REFUND-CALC      PIC X.
  3082                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3083                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3084                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3085                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3086                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3087                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3088                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3089                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3090
  3091         16  EC-ST-AH-REFUND-CALC      PIC X.
  3092                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3093                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3094                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3095                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3096                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3097                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3098                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3099                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3100
  3101         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  59
* EL6311.cbl
  3102         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3103         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3104         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3105         16  EC-AM-EXPIRATION-DT       PIC XX.
  3106         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3107         16  EC-AM-CLASS-CD            PIC XX.
  3108         16  EC-AM-LF-DEVIATION        PIC XXX.
  3109         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3110         16  EC-AM-AH-DEVIATION        PIC XXX.
  3111         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3112         16  EC-AM-PHONE-NO            PIC X(10).
  3113
  3114         16  EC-AM-LF-REFUND-CALC      PIC X.
  3115                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3116                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3117                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3118                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3119                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3120                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3121                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3122
  3123         16  EC-AM-AH-REFUND-CALC      PIC X.
  3124                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3125                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3126                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3127                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3128                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3129                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3130                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3131
  3132         16  EC-AM-BEN-I-G-CD          PIC X.
  3133                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3134                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3135                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3136
  3137         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3138         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3139         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3140         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3141         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3142         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3143         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3144         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3145         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3146
  3147         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3148         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3149         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3150         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3151         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3152         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3153         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3154         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3155         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3156         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3157         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3158         16  EC-RT-LF-NSP-ST           PIC XX.
  3159         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  60
* EL6311.cbl
  3160         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3161         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3162
  3163         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3164             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3165                                             'M' '5' '9' '2'.
  3166             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3167             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3168             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3169             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3170             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3171             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3172             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3173             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3174             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3175             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3176
  3177         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3178             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3179                                             'M' '5' '9' '2'.
  3180             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3181             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3182             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3183             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3184             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3185             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3186             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3187             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3188             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3189             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3190
  3191         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3192         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3193         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3194         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3195         16  EC-CM-DEATH-DT            PIC XX.
  3196
  3197*DMD CUSTOM CODING FIELDS BELOW
  3198*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3199         16  EC-BR-DMD-RATING-SW       PIC X.
  3200                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3201                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3202                 88  NO-DMD-RATING               VALUE 'N'.
  3203
  3204         16  EC-NEW-CERT               PIC X(11).
  3205         16  EC-NEW-STATE              PIC XX.
  3206         16  FILLER                    PIC X.
  3207*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3208         16  OVER-SHORT-EDIT-FIELDS.
  3209             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3210             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3211             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3212             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3213             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3214             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3215             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3216             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3217             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  61
* EL6311.cbl
  3218         16  FILLER                    PIC X(71).
  3219
  3220******************************************************************
  3221
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  62
* EL6311.cbl
  3223
  3224*    COPY ELCJPFX.
  3225******************************************************************
  3226*                                                                *
  3227*                                                                *
  3228*                            ELCJPFX.                            *
  3229*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3230*                            VMOD=2.002                          *
  3231*                                                                *
  3232*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3233*                                                                *
  3234*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3235*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3236*        ELCNTL - CONTROL FILE                                   *
  3237*        ELMSTR - CLAIM MASTERS                                  *
  3238*        ELTRLR - ACTIVITY TRAILERS                              *
  3239*        ELCHKQ - CHECK QUE                                      *
  3240******************************************************************
  3241 01  JOURNAL-RECORD.
  3242     12  jp-date                     pic s9(5) comp-3.
  3243     12  jp-time                     pic s9(7) comp-3.
  3244     12  JP-USER-ID                  PIC X(4).
  3245     12  JP-FILE-ID                  PIC X(8).
  3246     12  JP-PROGRAM-ID               PIC X(8).
  3247     12  JP-RECORD-TYPE              PIC X.
  3248         88 JP-ADD              VALUE 'A'.
  3249         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3250         88 JP-AFTER-CHANGE     VALUE 'C'.
  3251         88 JP-DELETE           VALUE 'D'.
  3252         88 JP-GENERIC-DELETE   VALUE 'G'.
  3253         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3254         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3255     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3256     12  JP-RECORD-AREA
  3257
  3258
  3259                             PIC X(608).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  63
* EL6311.cbl
  3261*    COPY ELCAID.
  3262******************************************************************
  3263*                                                                *
  3264*                            ELCAID.                             *
  3265*                            VMOD=2.001                          *
  3266*                                                                *
  3267*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3268*                                                                *
  3269*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3270*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3271******************************************************************
  3272
  3273 01  DFHAID.
  3274   02  DFHNULL   PIC  X  VALUE  ' '.
  3275   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3276   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3277   02  DFHPEN    PIC  X  VALUE  '='.
  3278   02  DFHOPID   PIC  X  VALUE  'W'.
  3279   02  DFHPA1    PIC  X  VALUE  '%'.
  3280   02  DFHPA2    PIC  X  VALUE  '>'.
  3281   02  DFHPA3    PIC  X  VALUE  ','.
  3282   02  DFHPF1    PIC  X  VALUE  '1'.
  3283   02  DFHPF2    PIC  X  VALUE  '2'.
  3284   02  DFHPF3    PIC  X  VALUE  '3'.
  3285   02  DFHPF4    PIC  X  VALUE  '4'.
  3286   02  DFHPF5    PIC  X  VALUE  '5'.
  3287   02  DFHPF6    PIC  X  VALUE  '6'.
  3288   02  DFHPF7    PIC  X  VALUE  '7'.
  3289   02  DFHPF8    PIC  X  VALUE  '8'.
  3290   02  DFHPF9    PIC  X  VALUE  '9'.
  3291   02  DFHPF10   PIC  X  VALUE  ':'.
  3292   02  DFHPF11   PIC  X  VALUE  '#'.
  3293   02  DFHPF12   PIC  X  VALUE  '@'.
  3294   02  DFHPF13   PIC  X  VALUE  'A'.
  3295   02  DFHPF14   PIC  X  VALUE  'B'.
  3296   02  DFHPF15   PIC  X  VALUE  'C'.
  3297   02  DFHPF16   PIC  X  VALUE  'D'.
  3298   02  DFHPF17   PIC  X  VALUE  'E'.
  3299   02  DFHPF18   PIC  X  VALUE  'F'.
  3300   02  DFHPF19   PIC  X  VALUE  'G'.
  3301   02  DFHPF20   PIC  X  VALUE  'H'.
  3302   02  DFHPF21   PIC  X  VALUE  'I'.
  3303*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3304   02  DFHPF22   PIC  X  VALUE  '['.
  3305   02  DFHPF23   PIC  X  VALUE  '.'.
  3306   02  DFHPF24   PIC  X  VALUE  '<'.
  3307   02  DFHMSRE   PIC  X  VALUE  'X'.
  3308   02  DFHSTRF   PIC  X  VALUE  'h'.
  3309   02  DFHTRIG   PIC  X  VALUE  '"'.
  3310
  3311 01  FILLER    REDEFINES DFHAID.
  3312     12  FILLER              PIC X(8).
  3313     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3314
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  64
* EL6311.cbl
  3316*    COPY EL6311S.
  3317 01  EL631BI.
  3318     05  FILLER            PIC  X(0012).
  3319*    -------------------------------
  3320     05  BDATEL PIC S9(0004) COMP.
  3321     05  BDATEF PIC  X(0001).
  3322     05  FILLER REDEFINES BDATEF.
  3323         10  BDATEA PIC  X(0001).
  3324     05  BDATEI PIC  X(0008).
  3325*    -------------------------------
  3326     05  BTIMEL PIC S9(0004) COMP.
  3327     05  BTIMEF PIC  X(0001).
  3328     05  FILLER REDEFINES BTIMEF.
  3329         10  BTIMEA PIC  X(0001).
  3330     05  BTIMEI PIC  X(0005).
  3331*    -------------------------------
  3332     05  BHEADL PIC S9(0004) COMP.
  3333     05  BHEADF PIC  X(0001).
  3334     05  FILLER REDEFINES BHEADF.
  3335         10  BHEADA PIC  X(0001).
  3336     05  BHEADI PIC  X(0038).
  3337*    -------------------------------
  3338     05  BNCERTLL PIC S9(0004) COMP.
  3339     05  BNCERTLF PIC  X(0001).
  3340     05  FILLER REDEFINES BNCERTLF.
  3341         10  BNCERTLA PIC  X(0001).
  3342     05  BNCERTLI PIC  X(0008).
  3343*    -------------------------------
  3344     05  BNCERTL PIC S9(0004) COMP.
  3345     05  BNCERTF PIC  X(0001).
  3346     05  FILLER REDEFINES BNCERTF.
  3347         10  BNCERTA PIC  X(0001).
  3348     05  BNCERTI PIC  X(0011).
  3349*    -------------------------------
  3350     05  BNSTATLL PIC S9(0004) COMP.
  3351     05  BNSTATLF PIC  X(0001).
  3352     05  FILLER REDEFINES BNSTATLF.
  3353         10  BNSTATLA PIC  X(0001).
  3354     05  BNSTATLI PIC  X(0009).
  3355*    -------------------------------
  3356     05  BNSTATL PIC S9(0004) COMP.
  3357     05  BNSTATF PIC  X(0001).
  3358     05  FILLER REDEFINES BNSTATF.
  3359         10  BNSTATA PIC  X(0001).
  3360     05  BNSTATI PIC  X(0002).
  3361*    -------------------------------
  3362     05  BCHGTL PIC S9(0004) COMP.
  3363     05  BCHGTF PIC  X(0001).
  3364     05  FILLER REDEFINES BCHGTF.
  3365         10  BCHGTA PIC  X(0001).
  3366     05  BCHGTI PIC  X(0004).
  3367*    -------------------------------
  3368     05  BCHGL PIC S9(0004) COMP.
  3369     05  BCHGF PIC  X(0001).
  3370     05  FILLER REDEFINES BCHGF.
  3371         10  BCHGA PIC  X(0001).
  3372     05  BCHGI PIC  X(0004).
  3373*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  65
* EL6311.cbl
  3374     05  BMAINTL PIC S9(0004) COMP.
  3375     05  BMAINTF PIC  X(0001).
  3376     05  FILLER REDEFINES BMAINTF.
  3377         10  BMAINTA PIC  X(0001).
  3378     05  BMAINTI PIC  X(0001).
  3379*    -------------------------------
  3380     05  BMANTBYL PIC S9(0004) COMP.
  3381     05  BMANTBYF PIC  X(0001).
  3382     05  FILLER REDEFINES BMANTBYF.
  3383         10  BMANTBYA PIC  X(0001).
  3384     05  BMANTBYI PIC  X(0004).
  3385*    -------------------------------
  3386     05  BCHGHDGL PIC S9(0004) COMP.
  3387     05  BCHGHDGF PIC  X(0001).
  3388     05  FILLER REDEFINES BCHGHDGF.
  3389         10  BCHGHDGA PIC  X(0001).
  3390     05  BCHGHDGI PIC  X(0003).
  3391*    -------------------------------
  3392     05  BMANTDTL PIC S9(0004) COMP.
  3393     05  BMANTDTF PIC  X(0001).
  3394     05  FILLER REDEFINES BMANTDTF.
  3395         10  BMANTDTA PIC  X(0001).
  3396     05  BMANTDTI PIC  X(0008).
  3397*    -------------------------------
  3398     05  BMANTATL PIC S9(0004) COMP.
  3399     05  BMANTATF PIC  X(0001).
  3400     05  FILLER REDEFINES BMANTATF.
  3401         10  BMANTATA PIC  X(0001).
  3402     05  BMANTATI PIC  X(0005).
  3403*    -------------------------------
  3404     05  BCSRL PIC S9(0004) COMP.
  3405     05  BCSRF PIC  X(0001).
  3406     05  FILLER REDEFINES BCSRF.
  3407         10  BCSRA PIC  X(0001).
  3408     05  BCSRI PIC  X(0004).
  3409*    -------------------------------
  3410     05  BBATCHL PIC S9(0004) COMP.
  3411     05  BBATCHF PIC  X(0001).
  3412     05  FILLER REDEFINES BBATCHF.
  3413         10  BBATCHA PIC  X(0001).
  3414     05  BBATCHI PIC  X(0006).
  3415*    -------------------------------
  3416     05  BSEQL PIC S9(0004) COMP.
  3417     05  BSEQF PIC  X(0001).
  3418     05  FILLER REDEFINES BSEQF.
  3419         10  BSEQA PIC  X(0001).
  3420     05  BSEQI PIC  X(0004).
  3421*    -------------------------------
  3422     05  BMOENDTL PIC S9(0004) COMP.
  3423     05  BMOENDTF PIC  X(0001).
  3424     05  FILLER REDEFINES BMOENDTF.
  3425         10  BMOENDTA PIC  X(0001).
  3426     05  BMOENDTI PIC  X(0008).
  3427*    -------------------------------
  3428     05  BCARRL PIC S9(0004) COMP.
  3429     05  BCARRF PIC  X(0001).
  3430     05  FILLER REDEFINES BCARRF.
  3431         10  BCARRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  66
* EL6311.cbl
  3432     05  BCARRI PIC  X(0001).
  3433*    -------------------------------
  3434     05  BGROUPL PIC S9(0004) COMP.
  3435     05  BGROUPF PIC  X(0001).
  3436     05  FILLER REDEFINES BGROUPF.
  3437         10  BGROUPA PIC  X(0001).
  3438     05  BGROUPI PIC  X(0006).
  3439*    -------------------------------
  3440     05  BSTATEL PIC S9(0004) COMP.
  3441     05  BSTATEF PIC  X(0001).
  3442     05  FILLER REDEFINES BSTATEF.
  3443         10  BSTATEA PIC  X(0001).
  3444     05  BSTATEI PIC  X(0002).
  3445*    -------------------------------
  3446     05  BACCTL PIC S9(0004) COMP.
  3447     05  BACCTF PIC  X(0001).
  3448     05  FILLER REDEFINES BACCTF.
  3449         10  BACCTA PIC  X(0001).
  3450     05  BACCTI PIC  X(0010).
  3451*    -------------------------------
  3452     05  BVINHL PIC S9(0004) COMP.
  3453     05  BVINHF PIC  X(0001).
  3454     05  FILLER REDEFINES BVINHF.
  3455         10  BVINHA PIC  X(0001).
  3456     05  BVINHI PIC  X(0004).
  3457*    -------------------------------
  3458     05  BVINL PIC S9(0004) COMP.
  3459     05  BVINF PIC  X(0001).
  3460     05  FILLER REDEFINES BVINF.
  3461         10  BVINA PIC  X(0001).
  3462     05  BVINI PIC  X(0017).
  3463*    -------------------------------
  3464     05  BREFHDGL PIC S9(0004) COMP.
  3465     05  BREFHDGF PIC  X(0001).
  3466     05  FILLER REDEFINES BREFHDGF.
  3467         10  BREFHDGA PIC  X(0001).
  3468     05  BREFHDGI PIC  X(0004).
  3469*    -------------------------------
  3470     05  BREFL PIC S9(0004) COMP.
  3471     05  BREFF PIC  X(0001).
  3472     05  FILLER REDEFINES BREFF.
  3473         10  BREFA PIC  X(0001).
  3474     05  BREFI PIC  X(0012).
  3475*    -------------------------------
  3476     05  BAGEDEFL PIC S9(0004) COMP.
  3477     05  BAGEDEFF PIC  X(0001).
  3478     05  FILLER REDEFINES BAGEDEFF.
  3479         10  BAGEDEFA PIC  X(0001).
  3480     05  BAGEDEFI PIC  X(0004).
  3481*    -------------------------------
  3482     05  BCERTNOL PIC S9(0004) COMP.
  3483     05  BCERTNOF PIC  X(0001).
  3484     05  FILLER REDEFINES BCERTNOF.
  3485         10  BCERTNOA PIC  X(0001).
  3486     05  BCERTNOI PIC  X(0010).
  3487*    -------------------------------
  3488     05  BSUFIXL PIC S9(0004) COMP.
  3489     05  BSUFIXF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  67
* EL6311.cbl
  3490     05  FILLER REDEFINES BSUFIXF.
  3491         10  BSUFIXA PIC  X(0001).
  3492     05  BSUFIXI PIC  X(0001).
  3493*    -------------------------------
  3494     05  BEFFDTL PIC S9(0004) COMP.
  3495     05  BEFFDTF PIC  X(0001).
  3496     05  FILLER REDEFINES BEFFDTF.
  3497         10  BEFFDTA PIC  X(0001).
  3498     05  BEFFDTI PIC  X(0008).
  3499*    -------------------------------
  3500     05  BLSTNML PIC S9(0004) COMP.
  3501     05  BLSTNMF PIC  X(0001).
  3502     05  FILLER REDEFINES BLSTNMF.
  3503         10  BLSTNMA PIC  X(0001).
  3504     05  BLSTNMI PIC  X(0015).
  3505*    -------------------------------
  3506     05  B1STNML PIC S9(0004) COMP.
  3507     05  B1STNMF PIC  X(0001).
  3508     05  FILLER REDEFINES B1STNMF.
  3509         10  B1STNMA PIC  X(0001).
  3510     05  B1STNMI PIC  X(0010).
  3511*    -------------------------------
  3512     05  BINITL PIC S9(0004) COMP.
  3513     05  BINITF PIC  X(0001).
  3514     05  FILLER REDEFINES BINITF.
  3515         10  BINITA PIC  X(0001).
  3516     05  BINITI PIC  X(0001).
  3517*    -------------------------------
  3518     05  BSEXL PIC S9(0004) COMP.
  3519     05  BSEXF PIC  X(0001).
  3520     05  FILLER REDEFINES BSEXF.
  3521         10  BSEXA PIC  X(0001).
  3522     05  BSEXI PIC  X(0001).
  3523*    -------------------------------
  3524     05  BAGEL PIC S9(0004) COMP.
  3525     05  BAGEF PIC  X(0001).
  3526     05  FILLER REDEFINES BAGEF.
  3527         10  BAGEA PIC  X(0001).
  3528     05  BAGEI PIC  X(0002).
  3529*    -------------------------------
  3530     05  BBIRTHL PIC S9(0004) COMP.
  3531     05  BBIRTHF PIC  X(0001).
  3532     05  FILLER REDEFINES BBIRTHF.
  3533         10  BBIRTHA PIC  X(0001).
  3534     05  BBIRTHI PIC  X(0008).
  3535*    -------------------------------
  3536     05  B1STPMTL PIC S9(0004) COMP.
  3537     05  B1STPMTF PIC  X(0001).
  3538     05  FILLER REDEFINES B1STPMTF.
  3539         10  B1STPMTA PIC  X(0001).
  3540     05  B1STPMTI PIC  X(0008).
  3541*    -------------------------------
  3542     05  BDAYSL PIC S9(0004) COMP.
  3543     05  BDAYSF PIC  X(0001).
  3544     05  FILLER REDEFINES BDAYSF.
  3545         10  BDAYSA PIC  X(0001).
  3546     05  BDAYSI PIC  X(0003).
  3547*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  68
* EL6311.cbl
  3548     05  BLNTRML PIC S9(0004) COMP.
  3549     05  BLNTRMF PIC  X(0001).
  3550     05  FILLER REDEFINES BLNTRMF.
  3551         10  BLNTRMA PIC  X(0001).
  3552     05  BLNTRMI PIC  X(0003).
  3553*    -------------------------------
  3554     05  BLNOFCRL PIC S9(0004) COMP.
  3555     05  BLNOFCRF PIC  X(0001).
  3556     05  FILLER REDEFINES BLNOFCRF.
  3557         10  BLNOFCRA PIC  X(0001).
  3558     05  BLNOFCRI PIC  X(0005).
  3559*    -------------------------------
  3560     05  BMODEL PIC S9(0004) COMP.
  3561     05  BMODEF PIC  X(0001).
  3562     05  FILLER REDEFINES BMODEF.
  3563         10  BMODEA PIC  X(0001).
  3564     05  BMODEI PIC  X(0001).
  3565*    -------------------------------
  3566     05  BFREQL PIC S9(0004) COMP.
  3567     05  BFREQF PIC  X(0001).
  3568     05  FILLER REDEFINES BFREQF.
  3569         10  BFREQA PIC  X(0001).
  3570     05  BFREQI PIC  X(0002).
  3571*    -------------------------------
  3572     05  BPMTSL PIC S9(0004) COMP.
  3573     05  BPMTSF PIC  X(0001).
  3574     05  FILLER REDEFINES BPMTSF.
  3575         10  BPMTSA PIC  X(0001).
  3576     05  BPMTSI PIC  999.
  3577*    -------------------------------
  3578     05  BPMTAMTL PIC S9(0004) COMP.
  3579     05  BPMTAMTF PIC  X(0001).
  3580     05  FILLER REDEFINES BPMTAMTF.
  3581         10  BPMTAMTA PIC  X(0001).
  3582     05  BPMTAMTI PIC  9(7)V99.
  3583*    -------------------------------
  3584     05  BAPRL PIC S9(0004) COMP.
  3585     05  BAPRF PIC  X(0001).
  3586     05  FILLER REDEFINES BAPRF.
  3587         10  BAPRA PIC  X(0001).
  3588     05  BAPRI PIC  X(7).
  3589*    -------------------------------
  3590     05  BLIVESL PIC S9(0004) COMP.
  3591     05  BLIVESF PIC  X(0001).
  3592     05  FILLER REDEFINES BLIVESF.
  3593         10  BLIVESA PIC  X(0001).
  3594     05  BLIVESI PIC  X(0009).
  3595*    -------------------------------
  3596     05  BMEMCAPL PIC S9(0004) COMP.
  3597     05  BMEMCAPF PIC  X(0001).
  3598     05  FILLER REDEFINES BMEMCAPF.
  3599         10  BMEMCAPA PIC  X(0001).
  3600     05  BMEMCAPI PIC  X(0011).
  3601*    -------------------------------
  3602     05  BORIGHDL PIC S9(0004) COMP.
  3603     05  BORIGHDF PIC  X(0001).
  3604     05  FILLER REDEFINES BORIGHDF.
  3605         10  BORIGHDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  69
* EL6311.cbl
  3606     05  BORIGHDI PIC  X(0009).
  3607*    -------------------------------
  3608     05  DMDBILL PIC S9(0004) COMP.
  3609     05  DMDBILF PIC  X(0001).
  3610     05  FILLER REDEFINES DMDBILF.
  3611         10  DMDBILA PIC  X(0001).
  3612     05  DMDBILI PIC  X(0006).
  3613*    -------------------------------
  3614     05  BFORCEL PIC S9(0004) COMP.
  3615     05  BFORCEF PIC  X(0001).
  3616     05  FILLER REDEFINES BFORCEF.
  3617         10  BFORCEA PIC  X(0001).
  3618     05  BFORCEI PIC  X(0001).
  3619*    -------------------------------
  3620     05  BENTRYL PIC S9(0004) COMP.
  3621     05  BENTRYF PIC  X(0001).
  3622     05  FILLER REDEFINES BENTRYF.
  3623         10  BENTRYA PIC  X(0001).
  3624     05  BENTRYI PIC  X(0001).
  3625*    -------------------------------
  3626     05  BREINL PIC S9(0004) COMP.
  3627     05  BREINF PIC  X(0001).
  3628     05  FILLER REDEFINES BREINF.
  3629         10  BREINA PIC  X(0001).
  3630     05  BREINI PIC  X(0001).
  3631*    -------------------------------
  3632     05  BBILCDL PIC S9(0004) COMP.
  3633     05  BBILCDF PIC  X(0001).
  3634     05  FILLER REDEFINES BBILCDF.
  3635         10  BBILCDA PIC  X(0001).
  3636     05  BBILCDI PIC  X(0001).
  3637*    -------------------------------
  3638     05  BUNWRITL PIC S9(0004) COMP.
  3639     05  BUNWRITF PIC  X(0001).
  3640     05  FILLER REDEFINES BUNWRITF.
  3641         10  BUNWRITA PIC  X(0001).
  3642     05  BUNWRITI PIC  X(0001).
  3643*    -------------------------------
  3644     05  BSKPCDL PIC S9(0004) COMP.
  3645     05  BSKPCDF PIC  X(0001).
  3646     05  FILLER REDEFINES BSKPCDF.
  3647         10  BSKPCDA PIC  X(0001).
  3648     05  BSKPCDI PIC  X(0001).
  3649*    -------------------------------
  3650     05  BINDGRPL PIC S9(0004) COMP.
  3651     05  BINDGRPF PIC  X(0001).
  3652     05  FILLER REDEFINES BINDGRPF.
  3653         10  BINDGRPA PIC  X(0001).
  3654     05  BINDGRPI PIC  X(0001).
  3655*    -------------------------------
  3656     05  BSIGL PIC S9(0004) COMP.
  3657     05  BSIGF PIC  X(0001).
  3658     05  FILLER REDEFINES BSIGF.
  3659         10  BSIGA PIC  X(0001).
  3660     05  BSIGI PIC  X(0001).
  3661*    -------------------------------
  3662     05  BRTCLSL PIC S9(0004) COMP.
  3663     05  BRTCLSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  70
* EL6311.cbl
  3664     05  FILLER REDEFINES BRTCLSF.
  3665         10  BRTCLSA PIC  X(0001).
  3666     05  BRTCLSI PIC  X(0002).
  3667*    -------------------------------
  3668     05  BCHGCNTL PIC S9(0004) COMP.
  3669     05  BCHGCNTF PIC  X(0001).
  3670     05  FILLER REDEFINES BCHGCNTF.
  3671         10  BCHGCNTA PIC  X(0001).
  3672     05  BCHGCNTI PIC  X(0003).
  3673*    -------------------------------
  3674     05  BMEMBERL PIC S9(0004) COMP.
  3675     05  BMEMBERF PIC  X(0001).
  3676     05  FILLER REDEFINES BMEMBERF.
  3677         10  BMEMBERA PIC  X(0001).
  3678     05  BMEMBERI PIC  X(0012).
  3679*    -------------------------------
  3680     05  BORGNOL PIC S9(0004) COMP.
  3681     05  BORGNOF PIC  X(0001).
  3682     05  FILLER REDEFINES BORGNOF.
  3683         10  BORGNOA PIC  X(0001).
  3684     05  BORGNOI PIC  X(0006).
  3685*    -------------------------------
  3686     05  BORGSEQL PIC S9(0004) COMP.
  3687     05  BORGSEQF PIC  X(0001).
  3688     05  FILLER REDEFINES BORGSEQF.
  3689         10  BORGSEQA PIC  X(0001).
  3690     05  BORGSEQI PIC  X(0004).
  3691*    -------------------------------
  3692     05  BBILLEDL PIC S9(0004) COMP.
  3693     05  BBILLEDF PIC  X(0001).
  3694     05  FILLER REDEFINES BBILLEDF.
  3695         10  BBILLEDA PIC  X(0001).
  3696     05  BBILLEDI PIC  9(9).
  3697*    -------------------------------
  3698     05  BKIND1L PIC S9(0004) COMP.
  3699     05  BKIND1F PIC  X(0001).
  3700     05  FILLER REDEFINES BKIND1F.
  3701         10  BKIND1A PIC  X(0001).
  3702     05  BKIND1I PIC  X(0002).
  3703*    -------------------------------
  3704     05  BTYPE1L PIC S9(0004) COMP.
  3705     05  BTYPE1F PIC  X(0001).
  3706     05  FILLER REDEFINES BTYPE1F.
  3707         10  BTYPE1A PIC  X(0001).
  3708     05  BTYPE1I PIC  X(0003).
  3709*    -------------------------------
  3710     05  BTERM1L PIC S9(0004) COMP.
  3711     05  BTERM1F PIC  X(0001).
  3712     05  FILLER REDEFINES BTERM1F.
  3713         10  BTERM1A PIC  X(0001).
  3714     05  BTERM1I PIC  X(0003).
  3715*    -------------------------------
  3716     05  BBEN1L PIC S9(0004) COMP.
  3717     05  BBEN1F PIC  X(0001).
  3718     05  FILLER REDEFINES BBEN1F.
  3719         10  BBEN1A PIC  X(0001).
  3720     05  BBEN1I PIC  X(0012).
  3721*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  71
* EL6311.cbl
  3722     05  BPREM1L PIC S9(0004) COMP.
  3723     05  BPREM1F PIC  X(0001).
  3724     05  FILLER REDEFINES BPREM1F.
  3725         10  BPREM1A PIC  X(0001).
  3726     05  BPREM1I PIC  X(0011).
  3727*    -------------------------------
  3728     05  BEXPIR1L PIC S9(0004) COMP.
  3729     05  BEXPIR1F PIC  X(0001).
  3730     05  FILLER REDEFINES BEXPIR1F.
  3731         10  BEXPIR1A PIC  X(0001).
  3732     05  BEXPIR1I PIC  X(0008).
  3733*    -------------------------------
  3734     05  BCP1L PIC S9(0004) COMP.
  3735     05  BCP1F PIC  X(0001).
  3736     05  FILLER REDEFINES BCP1F.
  3737         10  BCP1A PIC  X(0001).
  3738     05  BCP1I PIC  X(0002).
  3739*    -------------------------------
  3740     05  BALTBN1L PIC S9(0004) COMP.
  3741     05  BALTBN1F PIC  X(0001).
  3742     05  FILLER REDEFINES BALTBN1F.
  3743         10  BALTBN1A PIC  X(0001).
  3744     05  BALTBN1I PIC  X(0012).
  3745*    -------------------------------
  3746     05  BALTPR1L PIC S9(0004) COMP.
  3747     05  BALTPR1F PIC  X(0001).
  3748     05  FILLER REDEFINES BALTPR1F.
  3749         10  BALTPR1A PIC  X(0001).
  3750     05  BALTPR1I PIC  X(0011).
  3751*    -------------------------------
  3752     05  BBNCD1L PIC S9(0004) COMP.
  3753     05  BBNCD1F PIC  X(0001).
  3754     05  FILLER REDEFINES BBNCD1F.
  3755         10  BBNCD1A PIC  X(0001).
  3756     05  BBNCD1I PIC  X(0003).
  3757*    -------------------------------
  3758     05  BCPRM1L PIC S9(0004) COMP.
  3759     05  BCPRM1F PIC  X(0001).
  3760     05  FILLER REDEFINES BCPRM1F.
  3761         10  BCPRM1A PIC  X(0001).
  3762     05  BCPRM1I PIC  X(0011).
  3763*    -------------------------------
  3764     05  BCAPRM1L PIC S9(0004) COMP.
  3765     05  BCAPRM1F PIC  X(0001).
  3766     05  FILLER REDEFINES BCAPRM1F.
  3767         10  BCAPRM1A PIC  X(0001).
  3768     05  BCAPRM1I PIC  X(0011).
  3769*    -------------------------------
  3770     05  BENABR1L PIC S9(0004) COMP.
  3771     05  BENABR1F PIC  X(0001).
  3772     05  FILLER REDEFINES BENABR1F.
  3773         10  BENABR1A PIC  X(0001).
  3774     05  BENABR1I PIC  X(0005).
  3775*    -------------------------------
  3776     05  BDIFF1L PIC S9(0004) COMP.
  3777     05  BDIFF1F PIC  X(0001).
  3778     05  FILLER REDEFINES BDIFF1F.
  3779         10  BDIFF1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  72
* EL6311.cbl
  3780     05  BDIFF1I PIC  X(0011).
  3781*    -------------------------------
  3782     05  BBILIT1L PIC S9(0004) COMP.
  3783     05  BBILIT1F PIC  X(0001).
  3784     05  FILLER REDEFINES BBILIT1F.
  3785         10  BBILIT1A PIC  X(0001).
  3786     05  BBILIT1I PIC  X(0008).
  3787*    -------------------------------
  3788     05  BADIFF1L PIC S9(0004) COMP.
  3789     05  BADIFF1F PIC  X(0001).
  3790     05  FILLER REDEFINES BADIFF1F.
  3791         10  BADIFF1A PIC  X(0001).
  3792     05  BADIFF1I PIC  X(0011).
  3793*    -------------------------------
  3794     05  BKIND2L PIC S9(0004) COMP.
  3795     05  BKIND2F PIC  X(0001).
  3796     05  FILLER REDEFINES BKIND2F.
  3797         10  BKIND2A PIC  X(0001).
  3798     05  BKIND2I PIC  X(0002).
  3799*    -------------------------------
  3800     05  BTYPE2L PIC S9(0004) COMP.
  3801     05  BTYPE2F PIC  X(0001).
  3802     05  FILLER REDEFINES BTYPE2F.
  3803         10  BTYPE2A PIC  X(0001).
  3804     05  BTYPE2I PIC  X(0003).
  3805*    -------------------------------
  3806     05  BTERM2L PIC S9(0004) COMP.
  3807     05  BTERM2F PIC  X(0001).
  3808     05  FILLER REDEFINES BTERM2F.
  3809         10  BTERM2A PIC  X(0001).
  3810     05  BTERM2I PIC  X(0003).
  3811*    -------------------------------
  3812     05  BBEN2L PIC S9(0004) COMP.
  3813     05  BBEN2F PIC  X(0001).
  3814     05  FILLER REDEFINES BBEN2F.
  3815         10  BBEN2A PIC  X(0001).
  3816     05  BBEN2I PIC  X(0012).
  3817*    -------------------------------
  3818     05  BPREM2L PIC S9(0004) COMP.
  3819     05  BPREM2F PIC  X(0001).
  3820     05  FILLER REDEFINES BPREM2F.
  3821         10  BPREM2A PIC  X(0001).
  3822     05  BPREM2I PIC  X(0011).
  3823*    -------------------------------
  3824     05  BEXPIR2L PIC S9(0004) COMP.
  3825     05  BEXPIR2F PIC  X(0001).
  3826     05  FILLER REDEFINES BEXPIR2F.
  3827         10  BEXPIR2A PIC  X(0001).
  3828     05  BEXPIR2I PIC  X(0008).
  3829*    -------------------------------
  3830     05  BCP2L PIC S9(0004) COMP.
  3831     05  BCP2F PIC  X(0001).
  3832     05  FILLER REDEFINES BCP2F.
  3833         10  BCP2A PIC  X(0001).
  3834     05  BCP2I PIC  X(0002).
  3835*    -------------------------------
  3836     05  BALTBN2L PIC S9(0004) COMP.
  3837     05  BALTBN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  73
* EL6311.cbl
  3838     05  FILLER REDEFINES BALTBN2F.
  3839         10  BALTBN2A PIC  X(0001).
  3840     05  BALTBN2I PIC  X(0012).
  3841*    -------------------------------
  3842     05  BALTPR2L PIC S9(0004) COMP.
  3843     05  BALTPR2F PIC  X(0001).
  3844     05  FILLER REDEFINES BALTPR2F.
  3845         10  BALTPR2A PIC  X(0001).
  3846     05  BALTPR2I PIC  X(0011).
  3847*    -------------------------------
  3848     05  BBNCD2L PIC S9(0004) COMP.
  3849     05  BBNCD2F PIC  X(0001).
  3850     05  FILLER REDEFINES BBNCD2F.
  3851         10  BBNCD2A PIC  X(0001).
  3852     05  BBNCD2I PIC  X(0003).
  3853*    -------------------------------
  3854     05  BCPRM2L PIC S9(0004) COMP.
  3855     05  BCPRM2F PIC  X(0001).
  3856     05  FILLER REDEFINES BCPRM2F.
  3857         10  BCPRM2A PIC  X(0001).
  3858     05  BCPRM2I PIC  X(0011).
  3859*    -------------------------------
  3860     05  BCAPRM2L PIC S9(0004) COMP.
  3861     05  BCAPRM2F PIC  X(0001).
  3862     05  FILLER REDEFINES BCAPRM2F.
  3863         10  BCAPRM2A PIC  X(0001).
  3864     05  BCAPRM2I PIC  X(0011).
  3865*    -------------------------------
  3866     05  BENABR2L PIC S9(0004) COMP.
  3867     05  BENABR2F PIC  X(0001).
  3868     05  FILLER REDEFINES BENABR2F.
  3869         10  BENABR2A PIC  X(0001).
  3870     05  BENABR2I PIC  X(0005).
  3871*    -------------------------------
  3872     05  BDIFF2L PIC S9(0004) COMP.
  3873     05  BDIFF2F PIC  X(0001).
  3874     05  FILLER REDEFINES BDIFF2F.
  3875         10  BDIFF2A PIC  X(0001).
  3876     05  BDIFF2I PIC  X(0011).
  3877*    -------------------------------
  3878     05  BBILIT2L PIC S9(0004) COMP.
  3879     05  BBILIT2F PIC  X(0001).
  3880     05  FILLER REDEFINES BBILIT2F.
  3881         10  BBILIT2A PIC  X(0001).
  3882     05  BBILIT2I PIC  X(0008).
  3883*    -------------------------------
  3884     05  BADIFF2L PIC S9(0004) COMP.
  3885     05  BADIFF2F PIC  X(0001).
  3886     05  FILLER REDEFINES BADIFF2F.
  3887         10  BADIFF2A PIC  X(0001).
  3888     05  BADIFF2I PIC  X(0011).
  3889*    -------------------------------
  3890     05  BERMSG1L PIC S9(0004) COMP.
  3891     05  BERMSG1F PIC  X(0001).
  3892     05  FILLER REDEFINES BERMSG1F.
  3893         10  BERMSG1A PIC  X(0001).
  3894     05  BERMSG1I PIC  X(0078).
  3895*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  74
* EL6311.cbl
  3896     05  BERMSG2L PIC S9(0004) COMP.
  3897     05  BERMSG2F PIC  X(0001).
  3898     05  FILLER REDEFINES BERMSG2F.
  3899         10  BERMSG2A PIC  X(0001).
  3900     05  BERMSG2I PIC  X(0078).
  3901*    -------------------------------
  3902     05  BERMSG3L PIC S9(0004) COMP.
  3903     05  BERMSG3F PIC  X(0001).
  3904     05  FILLER REDEFINES BERMSG3F.
  3905         10  BERMSG3A PIC  X(0001).
  3906     05  BERMSG3I PIC  X(0078).
  3907*    -------------------------------
  3908     05  BPFENTRL PIC S9(0004) COMP.
  3909     05  BPFENTRF PIC  X(0001).
  3910     05  FILLER REDEFINES BPFENTRF.
  3911         10  BPFENTRA PIC  X(0001).
  3912     05  BPFENTRI PIC  9(2).
  3913*    -------------------------------
  3914     05  BPF5HDRL PIC S9(0004) COMP.
  3915     05  BPF5HDRF PIC  X(0001).
  3916     05  FILLER REDEFINES BPF5HDRF.
  3917         10  BPF5HDRA PIC  X(0001).
  3918     05  BPF5HDRI PIC  X(0005).
  3919*    -------------------------------
  3920     05  BPF4HDRL PIC S9(0004) COMP.
  3921     05  BPF4HDRF PIC  X(0001).
  3922     05  FILLER REDEFINES BPF4HDRF.
  3923         10  BPF4HDRA PIC  X(0001).
  3924     05  BPF4HDRI PIC  X(0013).
  3925*    -------------------------------
  3926     05  BF15HDRL PIC S9(0004) COMP.
  3927     05  BF15HDRF PIC  X(0001).
  3928     05  FILLER REDEFINES BF15HDRF.
  3929         10  BF15HDRA PIC  X(0001).
  3930     05  BF15HDRI PIC  X(0010).
  3931 01  EL631BO REDEFINES EL631BI.
  3932     05  FILLER            PIC  X(0012).
  3933*    -------------------------------
  3934     05  FILLER            PIC  X(0003).
  3935     05  BDATEO PIC  X(0008).
  3936*    -------------------------------
  3937     05  FILLER            PIC  X(0003).
  3938     05  BTIMEO PIC  99.99.
  3939*    -------------------------------
  3940     05  FILLER            PIC  X(0003).
  3941     05  BHEADO PIC  X(0038).
  3942*    -------------------------------
  3943     05  FILLER            PIC  X(0003).
  3944     05  BNCERTLO PIC  X(0008).
  3945*    -------------------------------
  3946     05  FILLER            PIC  X(0003).
  3947     05  BNCERTO PIC  X(0011).
  3948*    -------------------------------
  3949     05  FILLER            PIC  X(0003).
  3950     05  BNSTATLO PIC  X(0009).
  3951*    -------------------------------
  3952     05  FILLER            PIC  X(0003).
  3953     05  BNSTATO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  75
* EL6311.cbl
  3954*    -------------------------------
  3955     05  FILLER            PIC  X(0003).
  3956     05  BCHGTO PIC  X(0004).
  3957*    -------------------------------
  3958     05  FILLER            PIC  X(0003).
  3959     05  BCHGO PIC  ZZZ9.
  3960*    -------------------------------
  3961     05  FILLER            PIC  X(0003).
  3962     05  BMAINTO PIC  X(0001).
  3963*    -------------------------------
  3964     05  FILLER            PIC  X(0003).
  3965     05  BMANTBYO PIC  X(0004).
  3966*    -------------------------------
  3967     05  FILLER            PIC  X(0003).
  3968     05  BCHGHDGO PIC  X(0003).
  3969*    -------------------------------
  3970     05  FILLER            PIC  X(0003).
  3971     05  BMANTDTO PIC  X(0008).
  3972*    -------------------------------
  3973     05  FILLER            PIC  X(0003).
  3974     05  BMANTATO PIC  99.99.
  3975*    -------------------------------
  3976     05  FILLER            PIC  X(0003).
  3977     05  BCSRO PIC  X(0004).
  3978*    -------------------------------
  3979     05  FILLER            PIC  X(0003).
  3980     05  BBATCHO PIC  X(0006).
  3981*    -------------------------------
  3982     05  FILLER            PIC  X(0003).
  3983     05  BSEQO PIC  X(0004).
  3984*    -------------------------------
  3985     05  FILLER            PIC  X(0003).
  3986     05  BMOENDTO PIC  X(0008).
  3987*    -------------------------------
  3988     05  FILLER            PIC  X(0003).
  3989     05  BCARRO PIC  X(0001).
  3990*    -------------------------------
  3991     05  FILLER            PIC  X(0003).
  3992     05  BGROUPO PIC  X(0006).
  3993*    -------------------------------
  3994     05  FILLER            PIC  X(0003).
  3995     05  BSTATEO PIC  X(0002).
  3996*    -------------------------------
  3997     05  FILLER            PIC  X(0003).
  3998     05  BACCTO PIC  X(0010).
  3999*    -------------------------------
  4000     05  FILLER            PIC  X(0003).
  4001     05  BVINHO PIC  X(0004).
  4002*    -------------------------------
  4003     05  FILLER            PIC  X(0003).
  4004     05  BVINO PIC  X(0017).
  4005*    -------------------------------
  4006     05  FILLER            PIC  X(0003).
  4007     05  BREFHDGO PIC  X(0004).
  4008*    -------------------------------
  4009     05  FILLER            PIC  X(0003).
  4010     05  BREFO PIC  X(0012).
  4011*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  76
* EL6311.cbl
  4012     05  FILLER            PIC  X(0003).
  4013     05  BAGEDEFO PIC  X(0004).
  4014*    -------------------------------
  4015     05  FILLER            PIC  X(0003).
  4016     05  BCERTNOO PIC  X(0010).
  4017*    -------------------------------
  4018     05  FILLER            PIC  X(0003).
  4019     05  BSUFIXO PIC  X(0001).
  4020*    -------------------------------
  4021     05  FILLER            PIC  X(0003).
  4022     05  BEFFDTO PIC  X(0008).
  4023*    -------------------------------
  4024     05  FILLER            PIC  X(0003).
  4025     05  BLSTNMO PIC  X(0015).
  4026*    -------------------------------
  4027     05  FILLER            PIC  X(0003).
  4028     05  B1STNMO PIC  X(0010).
  4029*    -------------------------------
  4030     05  FILLER            PIC  X(0003).
  4031     05  BINITO PIC  X(0001).
  4032*    -------------------------------
  4033     05  FILLER            PIC  X(0003).
  4034     05  BSEXO PIC  X(0001).
  4035*    -------------------------------
  4036     05  FILLER            PIC  X(0003).
  4037     05  BAGEO PIC  X(0002).
  4038*    -------------------------------
  4039     05  FILLER            PIC  X(0003).
  4040     05  BBIRTHO PIC  X(0008).
  4041*    -------------------------------
  4042     05  FILLER            PIC  X(0003).
  4043     05  B1STPMTO PIC  X(0008).
  4044*    -------------------------------
  4045     05  FILLER            PIC  X(0003).
  4046     05  BDAYSO PIC  X(0003).
  4047*    -------------------------------
  4048     05  FILLER            PIC  X(0003).
  4049     05  BLNTRMO PIC  X(0003).
  4050*    -------------------------------
  4051     05  FILLER            PIC  X(0003).
  4052     05  BLNOFCRO PIC  X(0005).
  4053*    -------------------------------
  4054     05  FILLER            PIC  X(0003).
  4055     05  BMODEO PIC  X(0001).
  4056*    -------------------------------
  4057     05  FILLER            PIC  X(0003).
  4058     05  BFREQO PIC  X(0002).
  4059*    -------------------------------
  4060     05  FILLER            PIC  X(0003).
  4061     05  BPMTSO PIC  X(0003).
  4062*    -------------------------------
  4063     05  FILLER            PIC  X(0003).
  4064     05  BPMTAMTO PIC  ZZZZZ9.99.
  4065*    -------------------------------
  4066     05  FILLER            PIC  X(0003).
  4067     05  BAPRO PIC  99.9999.
  4068*    -------------------------------
  4069     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  77
* EL6311.cbl
  4070     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4071*    -------------------------------
  4072     05  FILLER            PIC  X(0003).
  4073     05  BMEMCAPO PIC  X(0011).
  4074*    -------------------------------
  4075     05  FILLER            PIC  X(0003).
  4076     05  BORIGHDO PIC  X(0009).
  4077*    -------------------------------
  4078     05  FILLER            PIC  X(0003).
  4079     05  DMDBILO PIC  X(0006).
  4080*    -------------------------------
  4081     05  FILLER            PIC  X(0003).
  4082     05  BFORCEO PIC  X(0001).
  4083*    -------------------------------
  4084     05  FILLER            PIC  X(0003).
  4085     05  BENTRYO PIC  X(0001).
  4086*    -------------------------------
  4087     05  FILLER            PIC  X(0003).
  4088     05  BREINO PIC  X(0001).
  4089*    -------------------------------
  4090     05  FILLER            PIC  X(0003).
  4091     05  BBILCDO PIC  X(0001).
  4092*    -------------------------------
  4093     05  FILLER            PIC  X(0003).
  4094     05  BUNWRITO PIC  X(0001).
  4095*    -------------------------------
  4096     05  FILLER            PIC  X(0003).
  4097     05  BSKPCDO PIC  X(0001).
  4098*    -------------------------------
  4099     05  FILLER            PIC  X(0003).
  4100     05  BINDGRPO PIC  X(0001).
  4101*    -------------------------------
  4102     05  FILLER            PIC  X(0003).
  4103     05  BSIGO PIC  X(0001).
  4104*    -------------------------------
  4105     05  FILLER            PIC  X(0003).
  4106     05  BRTCLSO PIC  X(0002).
  4107*    -------------------------------
  4108     05  FILLER            PIC  X(0003).
  4109     05  BCHGCNTO PIC  X(0003).
  4110*    -------------------------------
  4111     05  FILLER            PIC  X(0003).
  4112     05  BMEMBERO PIC  X(0012).
  4113*    -------------------------------
  4114     05  FILLER            PIC  X(0003).
  4115     05  BORGNOO PIC  X(0006).
  4116*    -------------------------------
  4117     05  FILLER            PIC  X(0003).
  4118     05  BORGSEQO PIC  X(0004).
  4119*    -------------------------------
  4120     05  FILLER            PIC  X(0003).
  4121     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4122*    -------------------------------
  4123     05  FILLER            PIC  X(0003).
  4124     05  BKIND1O PIC  X(0002).
  4125*    -------------------------------
  4126     05  FILLER            PIC  X(0003).
  4127     05  BTYPE1O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  78
* EL6311.cbl
  4128*    -------------------------------
  4129     05  FILLER            PIC  X(0003).
  4130     05  BTERM1O PIC  X(0003).
  4131*    -------------------------------
  4132     05  FILLER            PIC  X(0003).
  4133     05  BBEN1O PIC  X(0012).
  4134*    -------------------------------
  4135     05  FILLER            PIC  X(0003).
  4136     05  BPREM1O PIC  X(0011).
  4137*    -------------------------------
  4138     05  FILLER            PIC  X(0003).
  4139     05  BEXPIR1O PIC  X(0008).
  4140*    -------------------------------
  4141     05  FILLER            PIC  X(0003).
  4142     05  BCP1O PIC  X(0002).
  4143*    -------------------------------
  4144     05  FILLER            PIC  X(0003).
  4145     05  BALTBN1O PIC  X(0012).
  4146*    -------------------------------
  4147     05  FILLER            PIC  X(0003).
  4148     05  BALTPR1O PIC  X(0011).
  4149*    -------------------------------
  4150     05  FILLER            PIC  X(0003).
  4151     05  BBNCD1O PIC  X(0003).
  4152*    -------------------------------
  4153     05  FILLER            PIC  X(0003).
  4154     05  BCPRM1O PIC  X(0011).
  4155*    -------------------------------
  4156     05  FILLER            PIC  X(0003).
  4157     05  BCAPRM1O PIC  X(0011).
  4158*    -------------------------------
  4159     05  FILLER            PIC  X(0003).
  4160     05  BENABR1O PIC  X(0005).
  4161*    -------------------------------
  4162     05  FILLER            PIC  X(0003).
  4163     05  BDIFF1O PIC  X(0011).
  4164*    -------------------------------
  4165     05  FILLER            PIC  X(0003).
  4166     05  BBILIT1O PIC  X(0008).
  4167*    -------------------------------
  4168     05  FILLER            PIC  X(0003).
  4169     05  BADIFF1O PIC  X(0011).
  4170*    -------------------------------
  4171     05  FILLER            PIC  X(0003).
  4172     05  BKIND2O PIC  X(0002).
  4173*    -------------------------------
  4174     05  FILLER            PIC  X(0003).
  4175     05  BTYPE2O PIC  X(0003).
  4176*    -------------------------------
  4177     05  FILLER            PIC  X(0003).
  4178     05  BTERM2O PIC  X(0003).
  4179*    -------------------------------
  4180     05  FILLER            PIC  X(0003).
  4181     05  BBEN2O PIC  X(0012).
  4182*    -------------------------------
  4183     05  FILLER            PIC  X(0003).
  4184     05  BPREM2O PIC  X(0011).
  4185*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  79
* EL6311.cbl
  4186     05  FILLER            PIC  X(0003).
  4187     05  BEXPIR2O PIC  X(0008).
  4188*    -------------------------------
  4189     05  FILLER            PIC  X(0003).
  4190     05  BCP2O PIC  X(0002).
  4191*    -------------------------------
  4192     05  FILLER            PIC  X(0003).
  4193     05  BALTBN2O PIC  X(0012).
  4194*    -------------------------------
  4195     05  FILLER            PIC  X(0003).
  4196     05  BALTPR2O PIC  X(0011).
  4197*    -------------------------------
  4198     05  FILLER            PIC  X(0003).
  4199     05  BBNCD2O PIC  X(0003).
  4200*    -------------------------------
  4201     05  FILLER            PIC  X(0003).
  4202     05  BCPRM2O PIC  X(0011).
  4203*    -------------------------------
  4204     05  FILLER            PIC  X(0003).
  4205     05  BCAPRM2O PIC  X(0011).
  4206*    -------------------------------
  4207     05  FILLER            PIC  X(0003).
  4208     05  BENABR2O PIC  X(0005).
  4209*    -------------------------------
  4210     05  FILLER            PIC  X(0003).
  4211     05  BDIFF2O PIC  X(0011).
  4212*    -------------------------------
  4213     05  FILLER            PIC  X(0003).
  4214     05  BBILIT2O PIC  X(0008).
  4215*    -------------------------------
  4216     05  FILLER            PIC  X(0003).
  4217     05  BADIFF2O PIC  X(0011).
  4218*    -------------------------------
  4219     05  FILLER            PIC  X(0003).
  4220     05  BERMSG1O PIC  X(0078).
  4221*    -------------------------------
  4222     05  FILLER            PIC  X(0003).
  4223     05  BERMSG2O PIC  X(0078).
  4224*    -------------------------------
  4225     05  FILLER            PIC  X(0003).
  4226     05  BERMSG3O PIC  X(0078).
  4227*    -------------------------------
  4228     05  FILLER            PIC  X(0003).
  4229     05  BPFENTRO PIC  X(0002).
  4230*    -------------------------------
  4231     05  FILLER            PIC  X(0003).
  4232     05  BPF5HDRO PIC  X(0005).
  4233*    -------------------------------
  4234     05  FILLER            PIC  X(0003).
  4235     05  BPF4HDRO PIC  X(0013).
  4236*    -------------------------------
  4237     05  FILLER            PIC  X(0003).
  4238     05  BF15HDRO PIC  X(0010).
  4239*    -------------------------------
  4240 01  EL631CI REDEFINES EL631BI.
  4241     05  FILLER            PIC  X(0012).
  4242*    -------------------------------
  4243     05  CDATEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  80
* EL6311.cbl
  4244     05  CDATEF PIC  X(0001).
  4245     05  FILLER REDEFINES CDATEF.
  4246         10  CDATEA PIC  X(0001).
  4247     05  CDATEI PIC  X(0008).
  4248*    -------------------------------
  4249     05  CTIMEL PIC S9(0004) COMP.
  4250     05  CTIMEF PIC  X(0001).
  4251     05  FILLER REDEFINES CTIMEF.
  4252         10  CTIMEA PIC  X(0001).
  4253     05  CTIMEI PIC  X(0005).
  4254*    -------------------------------
  4255     05  CHEADL PIC S9(0004) COMP.
  4256     05  CHEADF PIC  X(0001).
  4257     05  FILLER REDEFINES CHEADF.
  4258         10  CHEADA PIC  X(0001).
  4259     05  CHEADI PIC  X(0038).
  4260*    -------------------------------
  4261     05  CCHGTL PIC S9(0004) COMP.
  4262     05  CCHGTF PIC  X(0001).
  4263     05  FILLER REDEFINES CCHGTF.
  4264         10  CCHGTA PIC  X(0001).
  4265     05  CCHGTI PIC  X(0004).
  4266*    -------------------------------
  4267     05  CCHGL PIC S9(0004) COMP.
  4268     05  CCHGF PIC  X(0001).
  4269     05  FILLER REDEFINES CCHGF.
  4270         10  CCHGA PIC  X(0001).
  4271     05  CCHGI PIC  X(0004).
  4272*    -------------------------------
  4273     05  CMAINTL PIC S9(0004) COMP.
  4274     05  CMAINTF PIC  X(0001).
  4275     05  FILLER REDEFINES CMAINTF.
  4276         10  CMAINTA PIC  X(0001).
  4277     05  CMAINTI PIC  X(0001).
  4278*    -------------------------------
  4279     05  CMANTBYL PIC S9(0004) COMP.
  4280     05  CMANTBYF PIC  X(0001).
  4281     05  FILLER REDEFINES CMANTBYF.
  4282         10  CMANTBYA PIC  X(0001).
  4283     05  CMANTBYI PIC  X(0004).
  4284*    -------------------------------
  4285     05  CCHGHDGL PIC S9(0004) COMP.
  4286     05  CCHGHDGF PIC  X(0001).
  4287     05  FILLER REDEFINES CCHGHDGF.
  4288         10  CCHGHDGA PIC  X(0001).
  4289     05  CCHGHDGI PIC  X(0003).
  4290*    -------------------------------
  4291     05  CMANTDTL PIC S9(0004) COMP.
  4292     05  CMANTDTF PIC  X(0001).
  4293     05  FILLER REDEFINES CMANTDTF.
  4294         10  CMANTDTA PIC  X(0001).
  4295     05  CMANTDTI PIC  X(0008).
  4296*    -------------------------------
  4297     05  CMANTATL PIC S9(0004) COMP.
  4298     05  CMANTATF PIC  X(0001).
  4299     05  FILLER REDEFINES CMANTATF.
  4300         10  CMANTATA PIC  X(0001).
  4301     05  CMANTATI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  81
* EL6311.cbl
  4302*    -------------------------------
  4303     05  CCSRL PIC S9(0004) COMP.
  4304     05  CCSRF PIC  X(0001).
  4305     05  FILLER REDEFINES CCSRF.
  4306         10  CCSRA PIC  X(0001).
  4307     05  CCSRI PIC  X(0004).
  4308*    -------------------------------
  4309     05  CBATCHL PIC S9(0004) COMP.
  4310     05  CBATCHF PIC  X(0001).
  4311     05  FILLER REDEFINES CBATCHF.
  4312         10  CBATCHA PIC  X(0001).
  4313     05  CBATCHI PIC  X(0006).
  4314*    -------------------------------
  4315     05  CSEQL PIC S9(0004) COMP.
  4316     05  CSEQF PIC  X(0001).
  4317     05  FILLER REDEFINES CSEQF.
  4318         10  CSEQA PIC  X(0001).
  4319     05  CSEQI PIC  X(0004).
  4320*    -------------------------------
  4321     05  CMOENDTL PIC S9(0004) COMP.
  4322     05  CMOENDTF PIC  X(0001).
  4323     05  FILLER REDEFINES CMOENDTF.
  4324         10  CMOENDTA PIC  X(0001).
  4325     05  CMOENDTI PIC  X(0008).
  4326*    -------------------------------
  4327     05  CCARRL PIC S9(0004) COMP.
  4328     05  CCARRF PIC  X(0001).
  4329     05  FILLER REDEFINES CCARRF.
  4330         10  CCARRA PIC  X(0001).
  4331     05  CCARRI PIC  X(0001).
  4332*    -------------------------------
  4333     05  CGROUPL PIC S9(0004) COMP.
  4334     05  CGROUPF PIC  X(0001).
  4335     05  FILLER REDEFINES CGROUPF.
  4336         10  CGROUPA PIC  X(0001).
  4337     05  CGROUPI PIC  X(0006).
  4338*    -------------------------------
  4339     05  CSTATEL PIC S9(0004) COMP.
  4340     05  CSTATEF PIC  X(0001).
  4341     05  FILLER REDEFINES CSTATEF.
  4342         10  CSTATEA PIC  X(0001).
  4343     05  CSTATEI PIC  X(0002).
  4344*    -------------------------------
  4345     05  CACCTL PIC S9(0004) COMP.
  4346     05  CACCTF PIC  X(0001).
  4347     05  FILLER REDEFINES CACCTF.
  4348         10  CACCTA PIC  X(0001).
  4349     05  CACCTI PIC  X(0010).
  4350*    -------------------------------
  4351     05  CORIGHDL PIC S9(0004) COMP.
  4352     05  CORIGHDF PIC  X(0001).
  4353     05  FILLER REDEFINES CORIGHDF.
  4354         10  CORIGHDA PIC  X(0001).
  4355     05  CORIGHDI PIC  X(0011).
  4356*    -------------------------------
  4357     05  CORGNOL PIC S9(0004) COMP.
  4358     05  CORGNOF PIC  X(0001).
  4359     05  FILLER REDEFINES CORGNOF.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  82
* EL6311.cbl
  4360         10  CORGNOA PIC  X(0001).
  4361     05  CORGNOI PIC  X(0006).
  4362*    -------------------------------
  4363     05  CORGSEQL PIC S9(0004) COMP.
  4364     05  CORGSEQF PIC  X(0001).
  4365     05  FILLER REDEFINES CORGSEQF.
  4366         10  CORGSEQA PIC  X(0001).
  4367     05  CORGSEQI PIC  X(0004).
  4368*    -------------------------------
  4369     05  CREFHDGL PIC S9(0004) COMP.
  4370     05  CREFHDGF PIC  X(0001).
  4371     05  FILLER REDEFINES CREFHDGF.
  4372         10  CREFHDGA PIC  X(0001).
  4373     05  CREFHDGI PIC  X(0010).
  4374*    -------------------------------
  4375     05  CREFL PIC S9(0004) COMP.
  4376     05  CREFF PIC  X(0001).
  4377     05  FILLER REDEFINES CREFF.
  4378         10  CREFA PIC  X(0001).
  4379     05  CREFI PIC  X(0012).
  4380*    -------------------------------
  4381     05  CNHINTL PIC S9(0004) COMP.
  4382     05  CNHINTF PIC  X(0001).
  4383     05  FILLER REDEFINES CNHINTF.
  4384         10  CNHINTA PIC  X(0001).
  4385     05  CNHINTI PIC  9(7)V99.
  4386*    -------------------------------
  4387     05  CCERTNOL PIC S9(0004) COMP.
  4388     05  CCERTNOF PIC  X(0001).
  4389     05  FILLER REDEFINES CCERTNOF.
  4390         10  CCERTNOA PIC  X(0001).
  4391     05  CCERTNOI PIC  X(0010).
  4392*    -------------------------------
  4393     05  CSUFIXL PIC S9(0004) COMP.
  4394     05  CSUFIXF PIC  X(0001).
  4395     05  FILLER REDEFINES CSUFIXF.
  4396         10  CSUFIXA PIC  X(0001).
  4397     05  CSUFIXI PIC  X(0001).
  4398*    -------------------------------
  4399     05  CEFFDTL PIC S9(0004) COMP.
  4400     05  CEFFDTF PIC  X(0001).
  4401     05  FILLER REDEFINES CEFFDTF.
  4402         10  CEFFDTA PIC  X(0001).
  4403     05  CEFFDTI PIC  X(0008).
  4404*    -------------------------------
  4405     05  CLSTNML PIC S9(0004) COMP.
  4406     05  CLSTNMF PIC  X(0001).
  4407     05  FILLER REDEFINES CLSTNMF.
  4408         10  CLSTNMA PIC  X(0001).
  4409     05  CLSTNMI PIC  X(0015).
  4410*    -------------------------------
  4411     05  CPCYNL PIC S9(0004) COMP.
  4412     05  CPCYNF PIC  X(0001).
  4413     05  FILLER REDEFINES CPCYNF.
  4414         10  CPCYNA PIC  X(0001).
  4415     05  CPCYNI PIC  X(0001).
  4416*    -------------------------------
  4417     05  CINAMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  83
* EL6311.cbl
  4418     05  CINAMEF PIC  X(0001).
  4419     05  FILLER REDEFINES CINAMEF.
  4420         10  CINAMEA PIC  X(0001).
  4421     05  CINAMEI PIC  X(0015).
  4422*    -------------------------------
  4423     05  CINITSL PIC S9(0004) COMP.
  4424     05  CINITSF PIC  X(0001).
  4425     05  FILLER REDEFINES CINITSF.
  4426         10  CINITSA PIC  X(0001).
  4427     05  CINITSI PIC  X(0010).
  4428*    -------------------------------
  4429     05  CCANREAL PIC S9(0004) COMP.
  4430     05  CCANREAF PIC  X(0001).
  4431     05  FILLER REDEFINES CCANREAF.
  4432         10  CCANREAA PIC  X(0001).
  4433     05  CCANREAI PIC  X(0001).
  4434*    -------------------------------
  4435     05  CKIND1L PIC S9(0004) COMP.
  4436     05  CKIND1F PIC  X(0001).
  4437     05  FILLER REDEFINES CKIND1F.
  4438         10  CKIND1A PIC  X(0001).
  4439     05  CKIND1I PIC  X(0002).
  4440*    -------------------------------
  4441     05  CCANDT1L PIC S9(0004) COMP.
  4442     05  CCANDT1F PIC  X(0001).
  4443     05  FILLER REDEFINES CCANDT1F.
  4444         10  CCANDT1A PIC  X(0001).
  4445     05  CCANDT1I PIC  X(0008).
  4446*    -------------------------------
  4447     05  CREFND1L PIC S9(0004) COMP.
  4448     05  CREFND1F PIC  X(0001).
  4449     05  FILLER REDEFINES CREFND1F.
  4450         10  CREFND1A PIC  X(0001).
  4451     05  CREFND1I PIC  S9(9)V99.
  4452*    -------------------------------
  4453     05  CMTHD1L PIC S9(0004) COMP.
  4454     05  CMTHD1F PIC  X(0001).
  4455     05  FILLER REDEFINES CMTHD1F.
  4456         10  CMTHD1A PIC  X(0001).
  4457     05  CMTHD1I PIC  X(0001).
  4458*    -------------------------------
  4459     05  CKIND2L PIC S9(0004) COMP.
  4460     05  CKIND2F PIC  X(0001).
  4461     05  FILLER REDEFINES CKIND2F.
  4462         10  CKIND2A PIC  X(0001).
  4463     05  CKIND2I PIC  X(0002).
  4464*    -------------------------------
  4465     05  CCANDT2L PIC S9(0004) COMP.
  4466     05  CCANDT2F PIC  X(0001).
  4467     05  FILLER REDEFINES CCANDT2F.
  4468         10  CCANDT2A PIC  X(0001).
  4469     05  CCANDT2I PIC  X(0008).
  4470*    -------------------------------
  4471     05  CREFND2L PIC S9(0004) COMP.
  4472     05  CREFND2F PIC  X(0001).
  4473     05  FILLER REDEFINES CREFND2F.
  4474         10  CREFND2A PIC  X(0001).
  4475     05  CREFND2I PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  84
* EL6311.cbl
  4476*    -------------------------------
  4477     05  CMTHD2L PIC S9(0004) COMP.
  4478     05  CMTHD2F PIC  X(0001).
  4479     05  FILLER REDEFINES CMTHD2F.
  4480         10  CMTHD2A PIC  X(0001).
  4481     05  CMTHD2I PIC  X(0001).
  4482*    -------------------------------
  4483     05  CLIVESL PIC S9(0004) COMP.
  4484     05  CLIVESF PIC  X(0001).
  4485     05  FILLER REDEFINES CLIVESF.
  4486         10  CLIVESA PIC  X(0001).
  4487     05  CLIVESI PIC  X(0003).
  4488*    -------------------------------
  4489     05  CFORCEL PIC S9(0004) COMP.
  4490     05  CFORCEF PIC  X(0001).
  4491     05  FILLER REDEFINES CFORCEF.
  4492         10  CFORCEA PIC  X(0001).
  4493     05  CFORCEI PIC  X(0001).
  4494*    -------------------------------
  4495     05  CBILCDL PIC S9(0004) COMP.
  4496     05  CBILCDF PIC  X(0001).
  4497     05  FILLER REDEFINES CBILCDF.
  4498         10  CBILCDA PIC  X(0001).
  4499     05  CBILCDI PIC  X(0001).
  4500*    -------------------------------
  4501     05  CCRFND1L PIC S9(0004) COMP.
  4502     05  CCRFND1F PIC  X(0001).
  4503     05  FILLER REDEFINES CCRFND1F.
  4504         10  CCRFND1A PIC  X(0001).
  4505     05  CCRFND1I PIC  X(0011).
  4506*    -------------------------------
  4507     05  CCRFND2L PIC S9(0004) COMP.
  4508     05  CCRFND2F PIC  X(0001).
  4509     05  FILLER REDEFINES CCRFND2F.
  4510         10  CCRFND2A PIC  X(0001).
  4511     05  CCRFND2I PIC  X(0011).
  4512*    -------------------------------
  4513     05  CBILIT1L PIC S9(0004) COMP.
  4514     05  CBILIT1F PIC  X(0001).
  4515     05  FILLER REDEFINES CBILIT1F.
  4516         10  CBILIT1A PIC  X(0001).
  4517     05  CBILIT1I PIC  X(0008).
  4518*    -------------------------------
  4519     05  CDRFND1L PIC S9(0004) COMP.
  4520     05  CDRFND1F PIC  X(0001).
  4521     05  FILLER REDEFINES CDRFND1F.
  4522         10  CDRFND1A PIC  X(0001).
  4523     05  CDRFND1I PIC  X(0011).
  4524*    -------------------------------
  4525     05  CBILIT2L PIC S9(0004) COMP.
  4526     05  CBILIT2F PIC  X(0001).
  4527     05  FILLER REDEFINES CBILIT2F.
  4528         10  CBILIT2A PIC  X(0001).
  4529     05  CBILIT2I PIC  X(0008).
  4530*    -------------------------------
  4531     05  CDRFND2L PIC S9(0004) COMP.
  4532     05  CDRFND2F PIC  X(0001).
  4533     05  FILLER REDEFINES CDRFND2F.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  85
* EL6311.cbl
  4534         10  CDRFND2A PIC  X(0001).
  4535     05  CDRFND2I PIC  X(0011).
  4536*    -------------------------------
  4537     05  CCANTXTL PIC S9(0004) COMP.
  4538     05  CCANTXTF PIC  X(0001).
  4539     05  FILLER REDEFINES CCANTXTF.
  4540         10  CCANTXTA PIC  X(0001).
  4541     05  CCANTXTI PIC  X(0005).
  4542*    -------------------------------
  4543     05  CCANFEEL PIC S9(0004) COMP.
  4544     05  CCANFEEF PIC  X(0001).
  4545     05  FILLER REDEFINES CCANFEEF.
  4546         10  CCANFEEA PIC  X(0001).
  4547     05  CCANFEEI PIC  X(0002).
  4548*    -------------------------------
  4549     05  CTERM1L PIC S9(0004) COMP.
  4550     05  CTERM1F PIC  X(0001).
  4551     05  FILLER REDEFINES CTERM1F.
  4552         10  CTERM1A PIC  X(0001).
  4553     05  CTERM1I PIC  X(0003).
  4554*    -------------------------------
  4555     05  CRTERM1L PIC S9(0004) COMP.
  4556     05  CRTERM1F PIC  X(0001).
  4557     05  FILLER REDEFINES CRTERM1F.
  4558         10  CRTERM1A PIC  X(0001).
  4559     05  CRTERM1I PIC  X(0003).
  4560*    -------------------------------
  4561     05  CPREM1L PIC S9(0004) COMP.
  4562     05  CPREM1F PIC  X(0001).
  4563     05  FILLER REDEFINES CPREM1F.
  4564         10  CPREM1A PIC  X(0001).
  4565     05  CPREM1I PIC  X(0011).
  4566*    -------------------------------
  4567     05  CTERM2L PIC S9(0004) COMP.
  4568     05  CTERM2F PIC  X(0001).
  4569     05  FILLER REDEFINES CTERM2F.
  4570         10  CTERM2A PIC  X(0001).
  4571     05  CTERM2I PIC  X(0003).
  4572*    -------------------------------
  4573     05  CRTERM2L PIC S9(0004) COMP.
  4574     05  CRTERM2F PIC  X(0001).
  4575     05  FILLER REDEFINES CRTERM2F.
  4576         10  CRTERM2A PIC  X(0001).
  4577     05  CRTERM2I PIC  X(0003).
  4578*    -------------------------------
  4579     05  CPREM2L PIC S9(0004) COMP.
  4580     05  CPREM2F PIC  X(0001).
  4581     05  FILLER REDEFINES CPREM2F.
  4582         10  CPREM2A PIC  X(0001).
  4583     05  CPREM2I PIC  X(0011).
  4584*    -------------------------------
  4585     05  CENTRDTL PIC S9(0004) COMP.
  4586     05  CENTRDTF PIC  X(0001).
  4587     05  FILLER REDEFINES CENTRDTF.
  4588         10  CENTRDTA PIC  X(0001).
  4589     05  CENTRDTI PIC  X(0008).
  4590*    -------------------------------
  4591     05  CPAYEEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  86
* EL6311.cbl
  4592     05  CPAYEEF PIC  X(0001).
  4593     05  FILLER REDEFINES CPAYEEF.
  4594         10  CPAYEEA PIC  X(0001).
  4595     05  CPAYEEI PIC  X(0006).
  4596*    -------------------------------
  4597     05  CRFNDSWL PIC S9(0004) COMP.
  4598     05  CRFNDSWF PIC  X(0001).
  4599     05  FILLER REDEFINES CRFNDSWF.
  4600         10  CRFNDSWA PIC  X(0001).
  4601     05  CRFNDSWI PIC  X(0003).
  4602*    -------------------------------
  4603     05  CLFHDGL PIC S9(0004) COMP.
  4604     05  CLFHDGF PIC  X(0001).
  4605     05  FILLER REDEFINES CLFHDGF.
  4606         10  CLFHDGA PIC  X(0001).
  4607     05  CLFHDGI PIC  X(0006).
  4608*    -------------------------------
  4609     05  CAHHDGL PIC S9(0004) COMP.
  4610     05  CAHHDGF PIC  X(0001).
  4611     05  FILLER REDEFINES CAHHDGF.
  4612         10  CAHHDGA PIC  X(0001).
  4613     05  CAHHDGI PIC  X(0006).
  4614*    -------------------------------
  4615     05  CENTDTL PIC S9(0004) COMP.
  4616     05  CENTDTF PIC  X(0001).
  4617     05  FILLER REDEFINES CENTDTF.
  4618         10  CENTDTA PIC  X(0001).
  4619     05  CENTDTI PIC  X(0008).
  4620*    -------------------------------
  4621     05  CENTBYL PIC S9(0004) COMP.
  4622     05  CENTBYF PIC  X(0001).
  4623     05  FILLER REDEFINES CENTBYF.
  4624         10  CENTBYA PIC  X(0001).
  4625     05  CENTBYI PIC  X(0004).
  4626*    -------------------------------
  4627     05  CCHGCNTL PIC S9(0004) COMP.
  4628     05  CCHGCNTF PIC  X(0001).
  4629     05  FILLER REDEFINES CCHGCNTF.
  4630         10  CCHGCNTA PIC  X(0001).
  4631     05  CCHGCNTI PIC  X(0003).
  4632*    -------------------------------
  4633     05  CLFREFNL PIC S9(0004) COMP.
  4634     05  CLFREFNF PIC  X(0001).
  4635     05  FILLER REDEFINES CLFREFNF.
  4636         10  CLFREFNA PIC  X(0001).
  4637     05  CLFREFNI PIC  X(0006).
  4638*    -------------------------------
  4639     05  CAHREFNL PIC S9(0004) COMP.
  4640     05  CAHREFNF PIC  X(0001).
  4641     05  FILLER REDEFINES CAHREFNF.
  4642         10  CAHREFNA PIC  X(0001).
  4643     05  CAHREFNI PIC  X(0006).
  4644*    -------------------------------
  4645     05  CREINCDL PIC S9(0004) COMP.
  4646     05  CREINCDF PIC  X(0001).
  4647     05  FILLER REDEFINES CREINCDF.
  4648         10  CREINCDA PIC  X(0001).
  4649     05  CREINCDI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  87
* EL6311.cbl
  4650*    -------------------------------
  4651     05  CAEFFDTL PIC S9(0004) COMP.
  4652     05  CAEFFDTF PIC  X(0001).
  4653     05  FILLER REDEFINES CAEFFDTF.
  4654         10  CAEFFDTA PIC  X(0001).
  4655     05  CAEFFDTI PIC  X(0008).
  4656*    -------------------------------
  4657     05  CAEXPDTL PIC S9(0004) COMP.
  4658     05  CAEXPDTF PIC  X(0001).
  4659     05  FILLER REDEFINES CAEXPDTF.
  4660         10  CAEXPDTA PIC  X(0001).
  4661     05  CAEXPDTI PIC  X(0008).
  4662*    -------------------------------
  4663     05  COMMLFL PIC S9(0004) COMP.
  4664     05  COMMLFF PIC  X(0001).
  4665     05  FILLER REDEFINES COMMLFF.
  4666         10  COMMLFA PIC  X(0001).
  4667     05  COMMLFI PIC  X(0006).
  4668*    -------------------------------
  4669     05  COMMAHL PIC S9(0004) COMP.
  4670     05  COMMAHF PIC  X(0001).
  4671     05  FILLER REDEFINES COMMAHF.
  4672         10  COMMAHA PIC  X(0001).
  4673     05  COMMAHI PIC  X(0006).
  4674*    -------------------------------
  4675     05  CERMSG1L PIC S9(0004) COMP.
  4676     05  CERMSG1F PIC  X(0001).
  4677     05  FILLER REDEFINES CERMSG1F.
  4678         10  CERMSG1A PIC  X(0001).
  4679     05  CERMSG1I PIC  X(0078).
  4680*    -------------------------------
  4681     05  CERMSG2L PIC S9(0004) COMP.
  4682     05  CERMSG2F PIC  X(0001).
  4683     05  FILLER REDEFINES CERMSG2F.
  4684         10  CERMSG2A PIC  X(0001).
  4685     05  CERMSG2I PIC  X(0078).
  4686*    -------------------------------
  4687     05  CERMSG3L PIC S9(0004) COMP.
  4688     05  CERMSG3F PIC  X(0001).
  4689     05  FILLER REDEFINES CERMSG3F.
  4690         10  CERMSG3A PIC  X(0001).
  4691     05  CERMSG3I PIC  X(0078).
  4692*    -------------------------------
  4693     05  CPFENTRL PIC S9(0004) COMP.
  4694     05  CPFENTRF PIC  X(0001).
  4695     05  FILLER REDEFINES CPFENTRF.
  4696         10  CPFENTRA PIC  X(0001).
  4697     05  CPFENTRI PIC  9(2).
  4698*    -------------------------------
  4699     05  CPF5HDRL PIC S9(0004) COMP.
  4700     05  CPF5HDRF PIC  X(0001).
  4701     05  FILLER REDEFINES CPF5HDRF.
  4702         10  CPF5HDRA PIC  X(0001).
  4703     05  CPF5HDRI PIC  X(0005).
  4704*    -------------------------------
  4705     05  CPF4HDRL PIC S9(0004) COMP.
  4706     05  CPF4HDRF PIC  X(0001).
  4707     05  FILLER REDEFINES CPF4HDRF.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  88
* EL6311.cbl
  4708         10  CPF4HDRA PIC  X(0001).
  4709     05  CPF4HDRI PIC  X(0013).
  4710*    -------------------------------
  4711     05  CF15HDRL PIC S9(0004) COMP.
  4712     05  CF15HDRF PIC  X(0001).
  4713     05  FILLER REDEFINES CF15HDRF.
  4714         10  CF15HDRA PIC  X(0001).
  4715     05  CF15HDRI PIC  X(0022).
  4716 01  EL631CO REDEFINES EL631BI.
  4717     05  FILLER            PIC  X(0012).
  4718*    -------------------------------
  4719     05  FILLER            PIC  X(0003).
  4720     05  CDATEO PIC  X(0008).
  4721*    -------------------------------
  4722     05  FILLER            PIC  X(0003).
  4723     05  CTIMEO PIC  99.99.
  4724*    -------------------------------
  4725     05  FILLER            PIC  X(0003).
  4726     05  CHEADO PIC  X(0038).
  4727*    -------------------------------
  4728     05  FILLER            PIC  X(0003).
  4729     05  CCHGTO PIC  X(0004).
  4730*    -------------------------------
  4731     05  FILLER            PIC  X(0003).
  4732     05  CCHGO PIC  ZZZ9.
  4733*    -------------------------------
  4734     05  FILLER            PIC  X(0003).
  4735     05  CMAINTO PIC  X(0001).
  4736*    -------------------------------
  4737     05  FILLER            PIC  X(0003).
  4738     05  CMANTBYO PIC  X(0004).
  4739*    -------------------------------
  4740     05  FILLER            PIC  X(0003).
  4741     05  CCHGHDGO PIC  X(0003).
  4742*    -------------------------------
  4743     05  FILLER            PIC  X(0003).
  4744     05  CMANTDTO PIC  X(0008).
  4745*    -------------------------------
  4746     05  FILLER            PIC  X(0003).
  4747     05  CMANTATO PIC  99.99.
  4748*    -------------------------------
  4749     05  FILLER            PIC  X(0003).
  4750     05  CCSRO PIC  X(0004).
  4751*    -------------------------------
  4752     05  FILLER            PIC  X(0003).
  4753     05  CBATCHO PIC  X(0006).
  4754*    -------------------------------
  4755     05  FILLER            PIC  X(0003).
  4756     05  CSEQO PIC  X(0004).
  4757*    -------------------------------
  4758     05  FILLER            PIC  X(0003).
  4759     05  CMOENDTO PIC  X(0008).
  4760*    -------------------------------
  4761     05  FILLER            PIC  X(0003).
  4762     05  CCARRO PIC  X(0001).
  4763*    -------------------------------
  4764     05  FILLER            PIC  X(0003).
  4765     05  CGROUPO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  89
* EL6311.cbl
  4766*    -------------------------------
  4767     05  FILLER            PIC  X(0003).
  4768     05  CSTATEO PIC  X(0002).
  4769*    -------------------------------
  4770     05  FILLER            PIC  X(0003).
  4771     05  CACCTO PIC  X(0010).
  4772*    -------------------------------
  4773     05  FILLER            PIC  X(0003).
  4774     05  CORIGHDO PIC  X(0011).
  4775*    -------------------------------
  4776     05  FILLER            PIC  X(0003).
  4777     05  CORGNOO PIC  X(0006).
  4778*    -------------------------------
  4779     05  FILLER            PIC  X(0003).
  4780     05  CORGSEQO PIC  X(0004).
  4781*    -------------------------------
  4782     05  FILLER            PIC  X(0003).
  4783     05  CREFHDGO PIC  X(0010).
  4784*    -------------------------------
  4785     05  FILLER            PIC  X(0003).
  4786     05  CREFO PIC  X(0012).
  4787*    -------------------------------
  4788     05  FILLER            PIC  X(0003).
  4789     05  CNHINTO PIC  999999.99.
  4790*    -------------------------------
  4791     05  FILLER            PIC  X(0003).
  4792     05  CCERTNOO PIC  X(0010).
  4793*    -------------------------------
  4794     05  FILLER            PIC  X(0003).
  4795     05  CSUFIXO PIC  X(0001).
  4796*    -------------------------------
  4797     05  FILLER            PIC  X(0003).
  4798     05  CEFFDTO PIC  X(0008).
  4799*    -------------------------------
  4800     05  FILLER            PIC  X(0003).
  4801     05  CLSTNMO PIC  X(0015).
  4802*    -------------------------------
  4803     05  FILLER            PIC  X(0003).
  4804     05  CPCYNO PIC  X(0001).
  4805*    -------------------------------
  4806     05  FILLER            PIC  X(0003).
  4807     05  CINAMEO PIC  X(0015).
  4808*    -------------------------------
  4809     05  FILLER            PIC  X(0003).
  4810     05  CINITSO PIC  X(0010).
  4811*    -------------------------------
  4812     05  FILLER            PIC  X(0003).
  4813     05  CCANREAO PIC  X(0001).
  4814*    -------------------------------
  4815     05  FILLER            PIC  X(0003).
  4816     05  CKIND1O PIC  X(0002).
  4817*    -------------------------------
  4818     05  FILLER            PIC  X(0003).
  4819     05  CCANDT1O PIC  X(0008).
  4820*    -------------------------------
  4821     05  FILLER            PIC  X(0003).
  4822     05  CREFND1O PIC  Z(7).99-.
  4823*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  90
* EL6311.cbl
  4824     05  FILLER            PIC  X(0003).
  4825     05  CMTHD1O PIC  X(0001).
  4826*    -------------------------------
  4827     05  FILLER            PIC  X(0003).
  4828     05  CKIND2O PIC  X(0002).
  4829*    -------------------------------
  4830     05  FILLER            PIC  X(0003).
  4831     05  CCANDT2O PIC  X(0008).
  4832*    -------------------------------
  4833     05  FILLER            PIC  X(0003).
  4834     05  CREFND2O PIC  Z(7).99-.
  4835*    -------------------------------
  4836     05  FILLER            PIC  X(0003).
  4837     05  CMTHD2O PIC  X(0001).
  4838*    -------------------------------
  4839     05  FILLER            PIC  X(0003).
  4840     05  CLIVESO PIC  X(0003).
  4841*    -------------------------------
  4842     05  FILLER            PIC  X(0003).
  4843     05  CFORCEO PIC  X(0001).
  4844*    -------------------------------
  4845     05  FILLER            PIC  X(0003).
  4846     05  CBILCDO PIC  X(0001).
  4847*    -------------------------------
  4848     05  FILLER            PIC  X(0003).
  4849     05  CCRFND1O PIC  Z(7).99-.
  4850*    -------------------------------
  4851     05  FILLER            PIC  X(0003).
  4852     05  CCRFND2O PIC  Z(7).99-.
  4853*    -------------------------------
  4854     05  FILLER            PIC  X(0003).
  4855     05  CBILIT1O PIC  X(0008).
  4856*    -------------------------------
  4857     05  FILLER            PIC  X(0003).
  4858     05  CDRFND1O PIC  Z(7).99-.
  4859*    -------------------------------
  4860     05  FILLER            PIC  X(0003).
  4861     05  CBILIT2O PIC  X(0008).
  4862*    -------------------------------
  4863     05  FILLER            PIC  X(0003).
  4864     05  CDRFND2O PIC  Z(7).99-.
  4865*    -------------------------------
  4866     05  FILLER            PIC  X(0003).
  4867     05  CCANTXTO PIC  X(0005).
  4868*    -------------------------------
  4869     05  FILLER            PIC  X(0003).
  4870     05  CCANFEEO PIC  Z9.
  4871*    -------------------------------
  4872     05  FILLER            PIC  X(0003).
  4873     05  CTERM1O PIC  ZZ9.
  4874*    -------------------------------
  4875     05  FILLER            PIC  X(0003).
  4876     05  CRTERM1O PIC  ZZ9.
  4877*    -------------------------------
  4878     05  FILLER            PIC  X(0003).
  4879     05  CPREM1O PIC  ZZZZZZ9.99-.
  4880*    -------------------------------
  4881     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  91
* EL6311.cbl
  4882     05  CTERM2O PIC  ZZ9.
  4883*    -------------------------------
  4884     05  FILLER            PIC  X(0003).
  4885     05  CRTERM2O PIC  ZZ9.
  4886*    -------------------------------
  4887     05  FILLER            PIC  X(0003).
  4888     05  CPREM2O PIC  ZZZZZZ9.99-.
  4889*    -------------------------------
  4890     05  FILLER            PIC  X(0003).
  4891     05  CENTRDTO PIC  X(0008).
  4892*    -------------------------------
  4893     05  FILLER            PIC  X(0003).
  4894     05  CPAYEEO PIC  X(0006).
  4895*    -------------------------------
  4896     05  FILLER            PIC  X(0003).
  4897     05  CRFNDSWO PIC  X(0003).
  4898*    -------------------------------
  4899     05  FILLER            PIC  X(0003).
  4900     05  CLFHDGO PIC  X(0006).
  4901*    -------------------------------
  4902     05  FILLER            PIC  X(0003).
  4903     05  CAHHDGO PIC  X(0006).
  4904*    -------------------------------
  4905     05  FILLER            PIC  X(0003).
  4906     05  CENTDTO PIC  X(0008).
  4907*    -------------------------------
  4908     05  FILLER            PIC  X(0003).
  4909     05  CENTBYO PIC  X(0004).
  4910*    -------------------------------
  4911     05  FILLER            PIC  X(0003).
  4912     05  CCHGCNTO PIC  X(0003).
  4913*    -------------------------------
  4914     05  FILLER            PIC  X(0003).
  4915     05  CLFREFNO PIC  X(0006).
  4916*    -------------------------------
  4917     05  FILLER            PIC  X(0003).
  4918     05  CAHREFNO PIC  X(0006).
  4919*    -------------------------------
  4920     05  FILLER            PIC  X(0003).
  4921     05  CREINCDO PIC  X(0003).
  4922*    -------------------------------
  4923     05  FILLER            PIC  X(0003).
  4924     05  CAEFFDTO PIC  X(0008).
  4925*    -------------------------------
  4926     05  FILLER            PIC  X(0003).
  4927     05  CAEXPDTO PIC  X(0008).
  4928*    -------------------------------
  4929     05  FILLER            PIC  X(0003).
  4930     05  COMMLFO PIC  .99999.
  4931*    -------------------------------
  4932     05  FILLER            PIC  X(0003).
  4933     05  COMMAHO PIC  .99999.
  4934*    -------------------------------
  4935     05  FILLER            PIC  X(0003).
  4936     05  CERMSG1O PIC  X(0078).
  4937*    -------------------------------
  4938     05  FILLER            PIC  X(0003).
  4939     05  CERMSG2O PIC  X(0078).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  92
* EL6311.cbl
  4940*    -------------------------------
  4941     05  FILLER            PIC  X(0003).
  4942     05  CERMSG3O PIC  X(0078).
  4943*    -------------------------------
  4944     05  FILLER            PIC  X(0003).
  4945     05  CPFENTRO PIC  X(0002).
  4946*    -------------------------------
  4947     05  FILLER            PIC  X(0003).
  4948     05  CPF5HDRO PIC  X(0005).
  4949*    -------------------------------
  4950     05  FILLER            PIC  X(0003).
  4951     05  CPF4HDRO PIC  X(0013).
  4952*    -------------------------------
  4953     05  FILLER            PIC  X(0003).
  4954     05  CF15HDRO PIC  X(0022).
  4955*    -------------------------------
  4956 01  EL631DI REDEFINES EL631BI.
  4957     05  FILLER            PIC  X(0012).
  4958*    -------------------------------
  4959     05  DDATEL PIC S9(0004) COMP.
  4960     05  DDATEF PIC  X(0001).
  4961     05  FILLER REDEFINES DDATEF.
  4962         10  DDATEA PIC  X(0001).
  4963     05  DDATEI PIC  X(0008).
  4964*    -------------------------------
  4965     05  DTIMEL PIC S9(0004) COMP.
  4966     05  DTIMEF PIC  X(0001).
  4967     05  FILLER REDEFINES DTIMEF.
  4968         10  DTIMEA PIC  X(0001).
  4969     05  DTIMEI PIC  X(0005).
  4970*    -------------------------------
  4971     05  DHEADL PIC S9(0004) COMP.
  4972     05  DHEADF PIC  X(0001).
  4973     05  FILLER REDEFINES DHEADF.
  4974         10  DHEADA PIC  X(0001).
  4975     05  DHEADI PIC  X(0038).
  4976*    -------------------------------
  4977     05  DLDATEL PIC S9(0004) COMP.
  4978     05  DLDATEF PIC  X(0001).
  4979     05  FILLER REDEFINES DLDATEF.
  4980         10  DLDATEA PIC  X(0001).
  4981     05  DLDATEI PIC  X(0010).
  4982*    -------------------------------
  4983     05  DBATCHL PIC S9(0004) COMP.
  4984     05  DBATCHF PIC  X(0001).
  4985     05  FILLER REDEFINES DBATCHF.
  4986         10  DBATCHA PIC  X(0001).
  4987     05  DBATCHI PIC  X(0011).
  4988*    -------------------------------
  4989     05  DACCTNML PIC S9(0004) COMP.
  4990     05  DACCTNMF PIC  X(0001).
  4991     05  FILLER REDEFINES DACCTNMF.
  4992         10  DACCTNMA PIC  X(0001).
  4993     05  DACCTNMI PIC  X(0030).
  4994*    -------------------------------
  4995     05  DPROCDTL PIC S9(0004) COMP.
  4996     05  DPROCDTF PIC  X(0001).
  4997     05  FILLER REDEFINES DPROCDTF.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  93
* EL6311.cbl
  4998         10  DPROCDTA PIC  X(0001).
  4999     05  DPROCDTI PIC  X(0008).
  5000*    -------------------------------
  5001     05  DINPUTL PIC S9(0004) COMP.
  5002     05  DINPUTF PIC  X(0001).
  5003     05  FILLER REDEFINES DINPUTF.
  5004         10  DINPUTA PIC  X(0001).
  5005     05  DINPUTI PIC  X(0008).
  5006*    -------------------------------
  5007     05  DMAINDTL PIC S9(0004) COMP.
  5008     05  DMAINDTF PIC  X(0001).
  5009     05  FILLER REDEFINES DMAINDTF.
  5010         10  DMAINDTA PIC  X(0001).
  5011     05  DMAINDTI PIC  X(0008).
  5012*    -------------------------------
  5013     05  DCARRL PIC S9(0004) COMP.
  5014     05  DCARRF PIC  X(0001).
  5015     05  FILLER REDEFINES DCARRF.
  5016         10  DCARRA PIC  X(0001).
  5017     05  DCARRI PIC  X(0001).
  5018*    -------------------------------
  5019     05  DGROUPL PIC S9(0004) COMP.
  5020     05  DGROUPF PIC  X(0001).
  5021     05  FILLER REDEFINES DGROUPF.
  5022         10  DGROUPA PIC  X(0001).
  5023     05  DGROUPI PIC  X(0006).
  5024*    -------------------------------
  5025     05  DSTATEL PIC S9(0004) COMP.
  5026     05  DSTATEF PIC  X(0001).
  5027     05  FILLER REDEFINES DSTATEF.
  5028         10  DSTATEA PIC  X(0001).
  5029     05  DSTATEI PIC  X(0002).
  5030*    -------------------------------
  5031     05  DACCTL PIC S9(0004) COMP.
  5032     05  DACCTF PIC  X(0001).
  5033     05  FILLER REDEFINES DACCTF.
  5034         10  DACCTA PIC  X(0001).
  5035     05  DACCTI PIC  X(0010).
  5036*    -------------------------------
  5037     05  DRECVDTL PIC S9(0004) COMP.
  5038     05  DRECVDTF PIC  X(0001).
  5039     05  FILLER REDEFINES DRECVDTF.
  5040         10  DRECVDTA PIC  X(0001).
  5041     05  DRECVDTI PIC  X(0008).
  5042*    -------------------------------
  5043     05  DCSRL PIC S9(0004) COMP.
  5044     05  DCSRF PIC  X(0001).
  5045     05  FILLER REDEFINES DCSRF.
  5046         10  DCSRA PIC  X(0001).
  5047     05  DCSRI PIC  X(0004).
  5048*    -------------------------------
  5049     05  DREFHDGL PIC S9(0004) COMP.
  5050     05  DREFHDGF PIC  X(0001).
  5051     05  FILLER REDEFINES DREFHDGF.
  5052         10  DREFHDGA PIC  X(0001).
  5053     05  DREFHDGI PIC  X(0010).
  5054*    -------------------------------
  5055     05  DREFL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  94
* EL6311.cbl
  5056     05  DREFF PIC  X(0001).
  5057     05  FILLER REDEFINES DREFF.
  5058         10  DREFA PIC  X(0001).
  5059     05  DREFI PIC  X(0012).
  5060*    -------------------------------
  5061     05  DLFPHDGL PIC S9(0004) COMP.
  5062     05  DLFPHDGF PIC  X(0001).
  5063     05  FILLER REDEFINES DLFPHDGF.
  5064         10  DLFPHDGA PIC  X(0001).
  5065     05  DLFPHDGI PIC  X(0010).
  5066*    -------------------------------
  5067     05  DAHPHDGL PIC S9(0004) COMP.
  5068     05  DAHPHDGF PIC  X(0001).
  5069     05  FILLER REDEFINES DAHPHDGF.
  5070         10  DAHPHDGA PIC  X(0001).
  5071     05  DAHPHDGI PIC  X(0010).
  5072*    -------------------------------
  5073     05  DLFRHDGL PIC S9(0004) COMP.
  5074     05  DLFRHDGF PIC  X(0001).
  5075     05  FILLER REDEFINES DLFRHDGF.
  5076         10  DLFRHDGA PIC  X(0001).
  5077     05  DLFRHDGI PIC  X(0009).
  5078*    -------------------------------
  5079     05  DAHRHDGL PIC S9(0004) COMP.
  5080     05  DAHRHDGF PIC  X(0001).
  5081     05  FILLER REDEFINES DAHRHDGF.
  5082         10  DAHRHDGA PIC  X(0001).
  5083     05  DAHRHDGI PIC  X(0009).
  5084*    -------------------------------
  5085     05  DRISSL PIC S9(0004) COMP.
  5086     05  DRISSF PIC  X(0001).
  5087     05  FILLER REDEFINES DRISSF.
  5088         10  DRISSA PIC  X(0001).
  5089     05  DRISSI PIC  X(0005).
  5090*    -------------------------------
  5091     05  DRLFPRML PIC S9(0004) COMP.
  5092     05  DRLFPRMF PIC  X(0001).
  5093     05  FILLER REDEFINES DRLFPRMF.
  5094         10  DRLFPRMA PIC  X(0001).
  5095     05  DRLFPRMI PIC  S9(9)V99.
  5096*    -------------------------------
  5097     05  DRAHPRML PIC S9(0004) COMP.
  5098     05  DRAHPRMF PIC  X(0001).
  5099     05  FILLER REDEFINES DRAHPRMF.
  5100         10  DRAHPRMA PIC  X(0001).
  5101     05  DRAHPRMI PIC  S9(9)V99.
  5102*    -------------------------------
  5103     05  DRCANCL PIC S9(0004) COMP.
  5104     05  DRCANCF PIC  X(0001).
  5105     05  FILLER REDEFINES DRCANCF.
  5106         10  DRCANCA PIC  X(0001).
  5107     05  DRCANCI PIC  X(0005).
  5108*    -------------------------------
  5109     05  DRLFRFDL PIC S9(0004) COMP.
  5110     05  DRLFRFDF PIC  X(0001).
  5111     05  FILLER REDEFINES DRLFRFDF.
  5112         10  DRLFRFDA PIC  X(0001).
  5113     05  DRLFRFDI PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  95
* EL6311.cbl
  5114*    -------------------------------
  5115     05  DRAHRFDL PIC S9(0004) COMP.
  5116     05  DRAHRFDF PIC  X(0001).
  5117     05  FILLER REDEFINES DRAHRFDF.
  5118         10  DRAHRFDA PIC  X(0001).
  5119     05  DRAHRFDI PIC  S9(9)V99.
  5120*    -------------------------------
  5121     05  DEISSL PIC S9(0004) COMP.
  5122     05  DEISSF PIC  X(0001).
  5123     05  FILLER REDEFINES DEISSF.
  5124         10  DEISSA PIC  X(0001).
  5125     05  DEISSI PIC  X(0005).
  5126*    -------------------------------
  5127     05  DELFPRML PIC S9(0004) COMP.
  5128     05  DELFPRMF PIC  X(0001).
  5129     05  FILLER REDEFINES DELFPRMF.
  5130         10  DELFPRMA PIC  X(0001).
  5131     05  DELFPRMI PIC  X(0011).
  5132*    -------------------------------
  5133     05  DEAHPRML PIC S9(0004) COMP.
  5134     05  DEAHPRMF PIC  X(0001).
  5135     05  FILLER REDEFINES DEAHPRMF.
  5136         10  DEAHPRMA PIC  X(0001).
  5137     05  DEAHPRMI PIC  X(0011).
  5138*    -------------------------------
  5139     05  DECANCL PIC S9(0004) COMP.
  5140     05  DECANCF PIC  X(0001).
  5141     05  FILLER REDEFINES DECANCF.
  5142         10  DECANCA PIC  X(0001).
  5143     05  DECANCI PIC  X(0005).
  5144*    -------------------------------
  5145     05  DELFRFDL PIC S9(0004) COMP.
  5146     05  DELFRFDF PIC  X(0001).
  5147     05  FILLER REDEFINES DELFRFDF.
  5148         10  DELFRFDA PIC  X(0001).
  5149     05  DELFRFDI PIC  X(0011).
  5150*    -------------------------------
  5151     05  DEAHRFDL PIC S9(0004) COMP.
  5152     05  DEAHRFDF PIC  X(0001).
  5153     05  FILLER REDEFINES DEAHRFDF.
  5154         10  DEAHRFDA PIC  X(0001).
  5155     05  DEAHRFDI PIC  X(0011).
  5156*    -------------------------------
  5157     05  DCISSL PIC S9(0004) COMP.
  5158     05  DCISSF PIC  X(0001).
  5159     05  FILLER REDEFINES DCISSF.
  5160         10  DCISSA PIC  X(0001).
  5161     05  DCISSI PIC  X(0005).
  5162*    -------------------------------
  5163     05  DCLFPRML PIC S9(0004) COMP.
  5164     05  DCLFPRMF PIC  X(0001).
  5165     05  FILLER REDEFINES DCLFPRMF.
  5166         10  DCLFPRMA PIC  X(0001).
  5167     05  DCLFPRMI PIC  X(0011).
  5168*    -------------------------------
  5169     05  DCAHPRML PIC S9(0004) COMP.
  5170     05  DCAHPRMF PIC  X(0001).
  5171     05  FILLER REDEFINES DCAHPRMF.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  96
* EL6311.cbl
  5172         10  DCAHPRMA PIC  X(0001).
  5173     05  DCAHPRMI PIC  X(0011).
  5174*    -------------------------------
  5175     05  DCCANCL PIC S9(0004) COMP.
  5176     05  DCCANCF PIC  X(0001).
  5177     05  FILLER REDEFINES DCCANCF.
  5178         10  DCCANCA PIC  X(0001).
  5179     05  DCCANCI PIC  X(0005).
  5180*    -------------------------------
  5181     05  DCLFRFDL PIC S9(0004) COMP.
  5182     05  DCLFRFDF PIC  X(0001).
  5183     05  FILLER REDEFINES DCLFRFDF.
  5184         10  DCLFRFDA PIC  X(0001).
  5185     05  DCLFRFDI PIC  X(0011).
  5186*    -------------------------------
  5187     05  DCAHRFDL PIC S9(0004) COMP.
  5188     05  DCAHRFDF PIC  X(0001).
  5189     05  FILLER REDEFINES DCAHRFDF.
  5190         10  DCAHRFDA PIC  X(0001).
  5191     05  DCAHRFDI PIC  X(0011).
  5192*    -------------------------------
  5193     05  DOISSL PIC S9(0004) COMP.
  5194     05  DOISSF PIC  X(0001).
  5195     05  FILLER REDEFINES DOISSF.
  5196         10  DOISSA PIC  X(0001).
  5197     05  DOISSI PIC  X(0005).
  5198*    -------------------------------
  5199     05  DOLFPRML PIC S9(0004) COMP.
  5200     05  DOLFPRMF PIC  X(0001).
  5201     05  FILLER REDEFINES DOLFPRMF.
  5202         10  DOLFPRMA PIC  X(0001).
  5203     05  DOLFPRMI PIC  X(0011).
  5204*    -------------------------------
  5205     05  DOAHPRML PIC S9(0004) COMP.
  5206     05  DOAHPRMF PIC  X(0001).
  5207     05  FILLER REDEFINES DOAHPRMF.
  5208         10  DOAHPRMA PIC  X(0001).
  5209     05  DOAHPRMI PIC  X(0011).
  5210*    -------------------------------
  5211     05  DOCANCL PIC S9(0004) COMP.
  5212     05  DOCANCF PIC  X(0001).
  5213     05  FILLER REDEFINES DOCANCF.
  5214         10  DOCANCA PIC  X(0001).
  5215     05  DOCANCI PIC  X(0005).
  5216*    -------------------------------
  5217     05  DOLFRFDL PIC S9(0004) COMP.
  5218     05  DOLFRFDF PIC  X(0001).
  5219     05  FILLER REDEFINES DOLFRFDF.
  5220         10  DOLFRFDA PIC  X(0001).
  5221     05  DOLFRFDI PIC  X(0011).
  5222*    -------------------------------
  5223     05  DOAHRFDL PIC S9(0004) COMP.
  5224     05  DOAHRFDF PIC  X(0001).
  5225     05  FILLER REDEFINES DOAHRFDF.
  5226         10  DOAHRFDA PIC  X(0001).
  5227     05  DOAHRFDI PIC  X(0011).
  5228*    -------------------------------
  5229     05  DITOTALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  97
* EL6311.cbl
  5230     05  DITOTALF PIC  X(0001).
  5231     05  FILLER REDEFINES DITOTALF.
  5232         10  DITOTALA PIC  X(0001).
  5233     05  DITOTALI PIC  X(0005).
  5234*    -------------------------------
  5235     05  DIFATALL PIC S9(0004) COMP.
  5236     05  DIFATALF PIC  X(0001).
  5237     05  FILLER REDEFINES DIFATALF.
  5238         10  DIFATALA PIC  X(0001).
  5239     05  DIFATALI PIC  X(0005).
  5240*    -------------------------------
  5241     05  DIFORCEL PIC S9(0004) COMP.
  5242     05  DIFORCEF PIC  X(0001).
  5243     05  FILLER REDEFINES DIFORCEF.
  5244         10  DIFORCEA PIC  X(0001).
  5245     05  DIFORCEI PIC  X(0005).
  5246*    -------------------------------
  5247     05  DIHOLDL PIC S9(0004) COMP.
  5248     05  DIHOLDF PIC  X(0001).
  5249     05  FILLER REDEFINES DIHOLDF.
  5250         10  DIHOLDA PIC  X(0001).
  5251     05  DIHOLDI PIC  X(0005).
  5252*    -------------------------------
  5253     05  DIAVAILL PIC S9(0004) COMP.
  5254     05  DIAVAILF PIC  X(0001).
  5255     05  FILLER REDEFINES DIAVAILF.
  5256         10  DIAVAILA PIC  X(0001).
  5257     05  DIAVAILI PIC  X(0005).
  5258*    -------------------------------
  5259     05  DIGPREML PIC S9(0004) COMP.
  5260     05  DIGPREMF PIC  X(0001).
  5261     05  FILLER REDEFINES DIGPREMF.
  5262         10  DIGPREMA PIC  X(0001).
  5263     05  DIGPREMI PIC  X(0011).
  5264*    -------------------------------
  5265     05  DIBPREML PIC S9(0004) COMP.
  5266     05  DIBPREMF PIC  X(0001).
  5267     05  FILLER REDEFINES DIBPREMF.
  5268         10  DIBPREMA PIC  X(0001).
  5269     05  DIBPREMI PIC  X(0011).
  5270*    -------------------------------
  5271     05  DCTOTALL PIC S9(0004) COMP.
  5272     05  DCTOTALF PIC  X(0001).
  5273     05  FILLER REDEFINES DCTOTALF.
  5274         10  DCTOTALA PIC  X(0001).
  5275     05  DCTOTALI PIC  X(0005).
  5276*    -------------------------------
  5277     05  DCFATALL PIC S9(0004) COMP.
  5278     05  DCFATALF PIC  X(0001).
  5279     05  FILLER REDEFINES DCFATALF.
  5280         10  DCFATALA PIC  X(0001).
  5281     05  DCFATALI PIC  X(0005).
  5282*    -------------------------------
  5283     05  DCFORCEL PIC S9(0004) COMP.
  5284     05  DCFORCEF PIC  X(0001).
  5285     05  FILLER REDEFINES DCFORCEF.
  5286         10  DCFORCEA PIC  X(0001).
  5287     05  DCFORCEI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  98
* EL6311.cbl
  5288*    -------------------------------
  5289     05  DCHOLDL PIC S9(0004) COMP.
  5290     05  DCHOLDF PIC  X(0001).
  5291     05  FILLER REDEFINES DCHOLDF.
  5292         10  DCHOLDA PIC  X(0001).
  5293     05  DCHOLDI PIC  X(0005).
  5294*    -------------------------------
  5295     05  DCAVAILL PIC S9(0004) COMP.
  5296     05  DCAVAILF PIC  X(0001).
  5297     05  FILLER REDEFINES DCAVAILF.
  5298         10  DCAVAILA PIC  X(0001).
  5299     05  DCAVAILI PIC  X(0005).
  5300*    -------------------------------
  5301     05  DCGPREML PIC S9(0004) COMP.
  5302     05  DCGPREMF PIC  X(0001).
  5303     05  FILLER REDEFINES DCGPREMF.
  5304         10  DCGPREMA PIC  X(0001).
  5305     05  DCGPREMI PIC  X(0011).
  5306*    -------------------------------
  5307     05  DCBPREML PIC S9(0004) COMP.
  5308     05  DCBPREMF PIC  X(0001).
  5309     05  FILLER REDEFINES DCBPREMF.
  5310         10  DCBPREMA PIC  X(0001).
  5311     05  DCBPREMI PIC  X(0011).
  5312*    -------------------------------
  5313     05  DNTOTALL PIC S9(0004) COMP.
  5314     05  DNTOTALF PIC  X(0001).
  5315     05  FILLER REDEFINES DNTOTALF.
  5316         10  DNTOTALA PIC  X(0001).
  5317     05  DNTOTALI PIC  X(0005).
  5318*    -------------------------------
  5319     05  DNFATALL PIC S9(0004) COMP.
  5320     05  DNFATALF PIC  X(0001).
  5321     05  FILLER REDEFINES DNFATALF.
  5322         10  DNFATALA PIC  X(0001).
  5323     05  DNFATALI PIC  X(0005).
  5324*    -------------------------------
  5325     05  DNFORCEL PIC S9(0004) COMP.
  5326     05  DNFORCEF PIC  X(0001).
  5327     05  FILLER REDEFINES DNFORCEF.
  5328         10  DNFORCEA PIC  X(0001).
  5329     05  DNFORCEI PIC  X(0005).
  5330*    -------------------------------
  5331     05  DNHOLDL PIC S9(0004) COMP.
  5332     05  DNHOLDF PIC  X(0001).
  5333     05  FILLER REDEFINES DNHOLDF.
  5334         10  DNHOLDA PIC  X(0001).
  5335     05  DNHOLDI PIC  X(0005).
  5336*    -------------------------------
  5337     05  DNAVAILL PIC S9(0004) COMP.
  5338     05  DNAVAILF PIC  X(0001).
  5339     05  FILLER REDEFINES DNAVAILF.
  5340         10  DNAVAILA PIC  X(0001).
  5341     05  DNAVAILI PIC  X(0005).
  5342*    -------------------------------
  5343     05  DNGPREML PIC S9(0004) COMP.
  5344     05  DNGPREMF PIC  X(0001).
  5345     05  FILLER REDEFINES DNGPREMF.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page  99
* EL6311.cbl
  5346         10  DNGPREMA PIC  X(0001).
  5347     05  DNGPREMI PIC  X(0011).
  5348*    -------------------------------
  5349     05  DNBPREML PIC S9(0004) COMP.
  5350     05  DNBPREMF PIC  X(0001).
  5351     05  FILLER REDEFINES DNBPREMF.
  5352         10  DNBPREMA PIC  X(0001).
  5353     05  DNBPREMI PIC  X(0011).
  5354*    -------------------------------
  5355     05  DERMSGL PIC S9(0004) COMP.
  5356     05  DERMSGF PIC  X(0001).
  5357     05  FILLER REDEFINES DERMSGF.
  5358         10  DERMSGA PIC  X(0001).
  5359     05  DERMSGI PIC  X(0075).
  5360*    -------------------------------
  5361     05  DPFENTRL PIC S9(0004) COMP.
  5362     05  DPFENTRF PIC  X(0001).
  5363     05  FILLER REDEFINES DPFENTRF.
  5364         10  DPFENTRA PIC  X(0001).
  5365     05  DPFENTRI PIC  9(2).
  5366 01  EL631DO REDEFINES EL631BI.
  5367     05  FILLER            PIC  X(0012).
  5368*    -------------------------------
  5369     05  FILLER            PIC  X(0003).
  5370     05  DDATEO PIC  X(0008).
  5371*    -------------------------------
  5372     05  FILLER            PIC  X(0003).
  5373     05  DTIMEO PIC  99.99.
  5374*    -------------------------------
  5375     05  FILLER            PIC  X(0003).
  5376     05  DHEADO PIC  X(0038).
  5377*    -------------------------------
  5378     05  FILLER            PIC  X(0003).
  5379     05  DLDATEO PIC  X(0010).
  5380*    -------------------------------
  5381     05  FILLER            PIC  X(0003).
  5382     05  DBATCHO PIC  X(0011).
  5383*    -------------------------------
  5384     05  FILLER            PIC  X(0003).
  5385     05  DACCTNMO PIC  X(0030).
  5386*    -------------------------------
  5387     05  FILLER            PIC  X(0003).
  5388     05  DPROCDTO PIC  X(0008).
  5389*    -------------------------------
  5390     05  FILLER            PIC  X(0003).
  5391     05  DINPUTO PIC  X(0008).
  5392*    -------------------------------
  5393     05  FILLER            PIC  X(0003).
  5394     05  DMAINDTO PIC  X(0008).
  5395*    -------------------------------
  5396     05  FILLER            PIC  X(0003).
  5397     05  DCARRO PIC  X(0001).
  5398*    -------------------------------
  5399     05  FILLER            PIC  X(0003).
  5400     05  DGROUPO PIC  X(0006).
  5401*    -------------------------------
  5402     05  FILLER            PIC  X(0003).
  5403     05  DSTATEO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 100
* EL6311.cbl
  5404*    -------------------------------
  5405     05  FILLER            PIC  X(0003).
  5406     05  DACCTO PIC  X(0010).
  5407*    -------------------------------
  5408     05  FILLER            PIC  X(0003).
  5409     05  DRECVDTO PIC  X(0008).
  5410*    -------------------------------
  5411     05  FILLER            PIC  X(0003).
  5412     05  DCSRO PIC  X(0004).
  5413*    -------------------------------
  5414     05  FILLER            PIC  X(0003).
  5415     05  DREFHDGO PIC  X(0010).
  5416*    -------------------------------
  5417     05  FILLER            PIC  X(0003).
  5418     05  DREFO PIC  X(0012).
  5419*    -------------------------------
  5420     05  FILLER            PIC  X(0003).
  5421     05  DLFPHDGO PIC  X(0010).
  5422*    -------------------------------
  5423     05  FILLER            PIC  X(0003).
  5424     05  DAHPHDGO PIC  X(0010).
  5425*    -------------------------------
  5426     05  FILLER            PIC  X(0003).
  5427     05  DLFRHDGO PIC  X(0009).
  5428*    -------------------------------
  5429     05  FILLER            PIC  X(0003).
  5430     05  DAHRHDGO PIC  X(0009).
  5431*    -------------------------------
  5432     05  FILLER            PIC  X(0003).
  5433     05  DRISSO PIC  ZZ99-.
  5434*    -------------------------------
  5435     05  FILLER            PIC  X(0003).
  5436     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5437*    -------------------------------
  5438     05  FILLER            PIC  X(0003).
  5439     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5440*    -------------------------------
  5441     05  FILLER            PIC  X(0003).
  5442     05  DRCANCO PIC  ZZ99-.
  5443*    -------------------------------
  5444     05  FILLER            PIC  X(0003).
  5445     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5446*    -------------------------------
  5447     05  FILLER            PIC  X(0003).
  5448     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5449*    -------------------------------
  5450     05  FILLER            PIC  X(0003).
  5451     05  DEISSO PIC  ZZ99-.
  5452*    -------------------------------
  5453     05  FILLER            PIC  X(0003).
  5454     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5455*    -------------------------------
  5456     05  FILLER            PIC  X(0003).
  5457     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5458*    -------------------------------
  5459     05  FILLER            PIC  X(0003).
  5460     05  DECANCO PIC  ZZ99-.
  5461*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 101
* EL6311.cbl
  5462     05  FILLER            PIC  X(0003).
  5463     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5464*    -------------------------------
  5465     05  FILLER            PIC  X(0003).
  5466     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5467*    -------------------------------
  5468     05  FILLER            PIC  X(0003).
  5469     05  DCISSO PIC  ZZ99-.
  5470*    -------------------------------
  5471     05  FILLER            PIC  X(0003).
  5472     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5473*    -------------------------------
  5474     05  FILLER            PIC  X(0003).
  5475     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5476*    -------------------------------
  5477     05  FILLER            PIC  X(0003).
  5478     05  DCCANCO PIC  ZZ99-.
  5479*    -------------------------------
  5480     05  FILLER            PIC  X(0003).
  5481     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5482*    -------------------------------
  5483     05  FILLER            PIC  X(0003).
  5484     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5485*    -------------------------------
  5486     05  FILLER            PIC  X(0003).
  5487     05  DOISSO PIC  ZZ99-.
  5488*    -------------------------------
  5489     05  FILLER            PIC  X(0003).
  5490     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5491*    -------------------------------
  5492     05  FILLER            PIC  X(0003).
  5493     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5494*    -------------------------------
  5495     05  FILLER            PIC  X(0003).
  5496     05  DOCANCO PIC  ZZ99-.
  5497*    -------------------------------
  5498     05  FILLER            PIC  X(0003).
  5499     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5500*    -------------------------------
  5501     05  FILLER            PIC  X(0003).
  5502     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5503*    -------------------------------
  5504     05  FILLER            PIC  X(0003).
  5505     05  DITOTALO PIC  ZZZ99.
  5506*    -------------------------------
  5507     05  FILLER            PIC  X(0003).
  5508     05  DIFATALO PIC  ZZZ99.
  5509*    -------------------------------
  5510     05  FILLER            PIC  X(0003).
  5511     05  DIFORCEO PIC  ZZZ99.
  5512*    -------------------------------
  5513     05  FILLER            PIC  X(0003).
  5514     05  DIHOLDO PIC  ZZZ99.
  5515*    -------------------------------
  5516     05  FILLER            PIC  X(0003).
  5517     05  DIAVAILO PIC  ZZZ99.
  5518*    -------------------------------
  5519     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 102
* EL6311.cbl
  5520     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5521*    -------------------------------
  5522     05  FILLER            PIC  X(0003).
  5523     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5524*    -------------------------------
  5525     05  FILLER            PIC  X(0003).
  5526     05  DCTOTALO PIC  ZZZ99.
  5527*    -------------------------------
  5528     05  FILLER            PIC  X(0003).
  5529     05  DCFATALO PIC  ZZZ99.
  5530*    -------------------------------
  5531     05  FILLER            PIC  X(0003).
  5532     05  DCFORCEO PIC  ZZZ99.
  5533*    -------------------------------
  5534     05  FILLER            PIC  X(0003).
  5535     05  DCHOLDO PIC  ZZZ99.
  5536*    -------------------------------
  5537     05  FILLER            PIC  X(0003).
  5538     05  DCAVAILO PIC  ZZZ99.
  5539*    -------------------------------
  5540     05  FILLER            PIC  X(0003).
  5541     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5542*    -------------------------------
  5543     05  FILLER            PIC  X(0003).
  5544     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5545*    -------------------------------
  5546     05  FILLER            PIC  X(0003).
  5547     05  DNTOTALO PIC  ---99.
  5548*    -------------------------------
  5549     05  FILLER            PIC  X(0003).
  5550     05  DNFATALO PIC  ---99.
  5551*    -------------------------------
  5552     05  FILLER            PIC  X(0003).
  5553     05  DNFORCEO PIC  ---99.
  5554*    -------------------------------
  5555     05  FILLER            PIC  X(0003).
  5556     05  DNHOLDO PIC  ---99.
  5557*    -------------------------------
  5558     05  FILLER            PIC  X(0003).
  5559     05  DNAVAILO PIC  ---99.
  5560*    -------------------------------
  5561     05  FILLER            PIC  X(0003).
  5562     05  DNGPREMO PIC  -------9.99.
  5563*    -------------------------------
  5564     05  FILLER            PIC  X(0003).
  5565     05  DNBPREMO PIC  -------9.99.
  5566*    -------------------------------
  5567     05  FILLER            PIC  X(0003).
  5568     05  DERMSGO PIC  X(0075).
  5569*    -------------------------------
  5570     05  FILLER            PIC  X(0003).
  5571     05  DPFENTRO PIC  X(0002).
  5572*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 103
* EL6311.cbl
  5574 01  MAP-B REDEFINES EL631BI.
  5575     12  FILLER                  PIC X(569).
  5576*    12  FILLER                  PIC X(512).
  5577*    12  FILLER                  PIC X(510).
  5578     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5579         16  BKIND-LEN               PIC S9(4)  COMP.
  5580         16  BKIND-ATTRB             PIC X.
  5581         16  BKIND                   PIC XX.
  5582         16  BTYPE-LEN               PIC S9(4)  COMP.
  5583         16  BTYPE-ATTRB             PIC X.
  5584         16  BTYPE                   PIC X(3).
  5585         16  BTERM-LEN               PIC S9(4)  COMP.
  5586         16  BTERM-ATTRB             PIC X.
  5587         16  BTERMI                  PIC 999.
  5588         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5589         16  BBEN-LEN                PIC S9(4)  COMP.
  5590         16  BBEN-ATTRB              PIC X.
  5591         16  BBENI                   PIC 9(10)V99.
  5592*        16  BBENI                   PIC 9(12).
  5593         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5594         16  BPREM-LEN               PIC S9(4)  COMP.
  5595         16  BPREM-ATTRB             PIC X.
  5596         16  BPREMI                  PIC S9(9)V99.
  5597*        16  BPREMI                  PIC 9(11).
  5598         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5599         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5600         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5601         16  BEXPIRE-ATTRB           PIC X.
  5602         16  BEXPIRE                 PIC X(8).
  5603         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5604         16  BCRIT-PERD-ATTRB        PIC X.
  5605         16  BCRIT-PERDI             PIC 99.
  5606         16  BCRIT-PERDO REDEFINES
  5607                         BCRIT-PERDI PIC ZZ.
  5608         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5609         16  BALT-BEN-ATTRB          PIC X.
  5610         16  BALT-BENI               PIC 9(10)V99.
  5611*        16  BALT-BENI               PIC 9(12).
  5612         16  BALT-BENO REDEFINES
  5613                           BALT-BENI PIC Z(9).ZZ.
  5614         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5615         16  BALT-PREM-ATTRB         PIC X.
  5616         16  BALT-PREMI              PIC 9(9)V99.
  5617*        16  BALT-PREMI              PIC 9(11).
  5618         16  BALT-PREMO REDEFINES
  5619                          BALT-PREMI PIC Z(7).ZZ-.
  5620         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5621         16  BBEN-CD-ATTRB           PIC X.
  5622         16  BBEN-CD                 PIC XXX.
  5623         16  BCPREM-LEN              PIC S9(4)  COMP.
  5624         16  BCPREM-ATTRB            PIC X.
  5625         16  BCPREMI                 PIC S9(9)V99.
  5626*        16  BCPREMI                 PIC X(11).
  5627         16  BCPREMO REDEFINES BCPREMI
  5628                                     PIC Z(7).99-.
  5629         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5630         16  BCALT-PREM-ATTRB        PIC X.
  5631         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 104
* EL6311.cbl
  5632         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5633         16  BBEN-ABBR-ATTRB         PIC X.
  5634         16  BBEN-ABBR               PIC X(5).
  5635         16  BDIFF-LEN               PIC S9(4)  COMP.
  5636         16  BDIFF-ATTRB             PIC X.
  5637         16  BDIFFO                  PIC Z(7).99-.
  5638         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5639         16  BBILL-LIT-ATTRB         PIC X.
  5640         16  BBILL-LIT               PIC X(8).
  5641         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5642         16  BDALT-PREM-ATTRB        PIC X.
  5643         16  BDALT-PREM              PIC Z(7).99-.
  5644
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 105
* EL6311.cbl
  5646
  5647****************************************************************
  5648*
  5649* Copyright (c) 2007 by Clerity Solutions, Inc.
  5650* All rights reserved.
  5651*
  5652****************************************************************
  5653 01  DFHEIV.
  5654   02  DFHEIV0               PIC X(35).
  5655   02  DFHEIV1               PIC X(08).
  5656   02  DFHEIV2               PIC X(08).
  5657   02  DFHEIV3               PIC X(08).
  5658   02  DFHEIV4               PIC X(06).
  5659   02  DFHEIV5               PIC X(04).
  5660   02  DFHEIV6               PIC X(04).
  5661   02  DFHEIV7               PIC X(02).
  5662   02  DFHEIV8               PIC X(02).
  5663   02  DFHEIV9               PIC X(01).
  5664   02  DFHEIV10              PIC S9(7) COMP-3.
  5665   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5666   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5667   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5668   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5669   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5670   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5671   02  DFHEIV17              PIC X(04).
  5672   02  DFHEIV18              PIC X(04).
  5673   02  DFHEIV19              PIC X(04).
  5674   02  DFHEIV20              USAGE IS POINTER.
  5675   02  DFHEIV21              USAGE IS POINTER.
  5676   02  DFHEIV22              USAGE IS POINTER.
  5677   02  DFHEIV23              USAGE IS POINTER.
  5678   02  DFHEIV24              USAGE IS POINTER.
  5679   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5680   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5681   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5682   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5683   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5684   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5685   02  FILLER                PIC X(02).
  5686   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5687   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5688   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5689   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5690   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5691 LINKAGE  SECTION.
  5692*****************************************************************
  5693*                                                               *
  5694* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5695* All rights reserved.                                          *
  5696*                                                               *
  5697*****************************************************************
  5698 01  dfheiblk.
  5699     02  eibtime          pic s9(7) comp-3.
  5700     02  eibdate          pic s9(7) comp-3.
  5701     02  eibtrnid         pic x(4).
  5702     02  eibtaskn         pic s9(7) comp-3.
  5703     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 106
* EL6311.cbl
  5704     02  dfheigdi         pic s9(4) comp.
  5705     02  eibcposn         pic s9(4) comp.
  5706     02  eibcalen         pic s9(4) comp.
  5707     02  eibaid           pic x(1).
  5708     02  eibfiller1       pic x(1).
  5709     02  eibfn            pic x(2).
  5710     02  eibfiller2       pic x(2).
  5711     02  eibrcode         pic x(6).
  5712     02  eibfiller3       pic x(2).
  5713     02  eibds            pic x(8).
  5714     02  eibreqid         pic x(8).
  5715     02  eibrsrce         pic x(8).
  5716     02  eibsync          pic x(1).
  5717     02  eibfree          pic x(1).
  5718     02  eibrecv          pic x(1).
  5719     02  eibsend          pic x(1).
  5720     02  eibatt           pic x(1).
  5721     02  eibeoc           pic x(1).
  5722     02  eibfmh           pic x(1).
  5723     02  eibcompl         pic x(1).
  5724     02  eibsig           pic x(1).
  5725     02  eibconf          pic x(1).
  5726     02  eiberr           pic x(1).
  5727     02  eibrldbk         pic x(1).
  5728     02  eiberrcd         pic x(4).
  5729     02  eibsynrb         pic x(1).
  5730     02  eibnodat         pic x(1).
  5731     02  eibfiller5       pic x(2).
  5732     02  eibresp          pic 9(09) comp.
  5733     02  eibresp2         pic 9(09) comp.
  5734     02  dfheigdj         pic s9(4) comp.
  5735     02  dfheigdk         pic s9(4) comp.
  5736 01  DFHCOMMAREA                 PIC X(1300).
  5737
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 107
* EL6311.cbl
  5739*    COPY ERCPNDB.
  5740******************************************************************
  5741*                                                                *
  5742*                                                                *
  5743*                            ERCPNDB.                            *
  5744*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5745*                            VMOD=2.025                          *
  5746*                                                                *
  5747*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5748*                                                                *
  5749******************************************************************
  5750*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5751*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5752******************************************************************
  5753*                                                                *
  5754*                                                                *
  5755*   FILE TYPE = VSAM,KSDS                                        *
  5756*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5757*                                                                *
  5758*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5759*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5760*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5761*                                                 RKP=13,LEN=36  *
  5762*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5763*                                      AND CHG-SEQ.)             *
  5764*                                                RKP=49,LEN=11   *
  5765*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5766*                                      AND CHG-SEQ.)             *
  5767*                                                RKP=60,LEN=15   *
  5768*                                                                *
  5769*   LOG = NO                                                     *
  5770*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5771******************************************************************
  5772******************************************************************
  5773*                   C H A N G E   L O G
  5774*
  5775* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5776*-----------------------------------------------------------------
  5777*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5778* EFFECTIVE    NUMBER
  5779*-----------------------------------------------------------------
  5780* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5781* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5782* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5783* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5784* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5785* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5786* 032306                   PEMA  ADD BOW LOAN NUMBER
  5787* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5788* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5789* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5790* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5791* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5792* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5793* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5794* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5795******************************************************************
  5796
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 108
* EL6311.cbl
  5797 01  PENDING-BUSINESS.
  5798     12  PB-RECORD-ID                     PIC XX.
  5799         88  VALID-PB-ID                        VALUE 'PB'.
  5800
  5801     12  PB-CONTROL-PRIMARY.
  5802         16  PB-COMPANY-CD                PIC X.
  5803         16  PB-ENTRY-BATCH               PIC X(6).
  5804         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5805         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5806
  5807     12  PB-CONTROL-BY-ACCOUNT.
  5808         16  PB-COMPANY-CD-A1             PIC X.
  5809         16  PB-CARRIER                   PIC X.
  5810         16  PB-GROUPING.
  5811             20  PB-GROUPING-PREFIX       PIC XXX.
  5812             20  PB-GROUPING-PRIME        PIC XXX.
  5813         16  PB-STATE                     PIC XX.
  5814         16  PB-ACCOUNT.
  5815             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5816             20  PB-ACCOUNT-PRIME         PIC X(6).
  5817         16  PB-CERT-EFF-DT               PIC XX.
  5818         16  PB-CERT-NO.
  5819             20  PB-CERT-PRIME            PIC X(10).
  5820             20  PB-CERT-SFX              PIC X.
  5821         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  5822
  5823         16  PB-RECORD-TYPE               PIC X.
  5824             88  PB-MAILING-DATA                VALUE '0'.
  5825             88  PB-ISSUE                       VALUE '1'.
  5826             88  PB-CANCELLATION                VALUE '2'.
  5827             88  PB-BATCH-TRAILER               VALUE '9'.
  5828
  5829     12  PB-CONTROL-BY-ORIG-BATCH.
  5830         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5831         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5832         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5833         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5834
  5835     12  PB-CONTROL-BY-CSR.
  5836         16  PB-CSR-COMPANY-CD            PIC X.
  5837         16  PB-CSR-ID                    PIC X(4).
  5838         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5839         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5840         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5841******************************************************************
  5842*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5843******************************************************************
  5844
  5845     12  PB-LAST-MAINT-DT                 PIC XX.
  5846     12  PB-LAST-MAINT-BY                 PIC X(4).
  5847     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5848
  5849     12  PB-RECORD-BODY                   PIC X(375).
  5850
  5851     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5852         16  PB-CERT-ORIGIN               PIC X.
  5853             88  CLASIC-CREATED-CERT         VALUE '1'.
  5854         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 109
* EL6311.cbl
  5855             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5856             20  PB-I-INSURED-FIRST-NAME.
  5857                 24  PB-I-INSURED-1ST-INIT PIC X.
  5858                 24  FILLER                PIC X(9).
  5859             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5860         16  PB-I-AGE                     PIC S99   COMP-3.
  5861         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5862         16  PB-I-BIRTHDAY                PIC XX.
  5863         16  PB-I-INSURED-SEX             PIC X.
  5864             88  PB-SEX-MALE     VALUE 'M'.
  5865             88  PB-SEX-FEMALE   VALUE 'F'.
  5866
  5867         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5868         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5869         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5870         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5871         16  PB-I-SKIP-CODE               PIC X.
  5872             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5873             88  PB-SKIP-JULY              VALUE '1'.
  5874             88  PB-SKIP-AUGUST            VALUE '2'.
  5875             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5876             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5877             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5878             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  5879             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  5880             88  PB-SKIP-JUNE              VALUE '8'.
  5881             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5882             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5883             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5884         16  PB-I-TERM-TYPE               PIC X.
  5885             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5886             88  PB-PAID-WEEKLY            VALUE 'W'.
  5887             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5888             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5889             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5890         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5891         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5892         16  PB-I-DATA-ENTRY-SW           PIC X.
  5893             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5894             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5895             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  5896             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  5897         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  5898         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  5899*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  5900         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  5901         16  FILLER                       PIC X.
  5902
  5903         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  5904             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  5905             88  PB-INVALID-LIFE             VALUE '  ' '00'
  5906                                                   '90' THRU '99'.
  5907         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  5908                                          PIC XX.
  5909         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  5910         16  PB-I-AMOUNT-FINANCED REDEFINES
  5911                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  5912         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 110
* EL6311.cbl
  5913         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  5914                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  5915         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5916         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  5917         16  PB-I-CLP-AMOUNT REDEFINES
  5918                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  5919         16  PB-I-LF-CALC-FLAG            PIC X.
  5920             88 PB-COMP-LF-PREM               VALUE '?'.
  5921         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  5922         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  5923         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  5924         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  5925         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5926         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5927         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  5928         16  PB-I-LF-ABBR                 PIC XXX.
  5929         16  PB-I-LF-INPUT-CD             PIC XX.
  5930
  5931         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5932             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5933             88  PB-INVALID-AH               VALUE '  ' '00'
  5934                                                   '90' THRU '99'.
  5935         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5936         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5937         16  PB-I-AH-CALC-FLAG            PIC X.
  5938             88 PB-COMP-AH-PREM                  VALUE '?'.
  5939         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5940         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5941         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5942         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5943         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5944         16  PB-I-AH-ABBR                 PIC XXX.
  5945         16  PB-I-AH-INPUT-CD             PIC XXX.
  5946
  5947         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5948         16  PB-I-REIN-TABLE              PIC XXX.
  5949         16  PB-I-BUSINESS-TYPE           PIC 99.
  5950         16  PB-I-INDV-GRP-CD             PIC X.
  5951         16  PB-I-MORT-CODE.
  5952             20  PB-I-TABLE               PIC X.
  5953             20  PB-I-INTEREST            PIC XX.
  5954             20  PB-I-MORT-TYP            PIC X.
  5955         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  5956         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  5957         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  5958         16  PB-I-INDV-GRP-OVRD           PIC X.
  5959         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  5960         16  PB-I-SIG-SW                  PIC X.
  5961             88  PB-POLICY-SIGNED             VALUE 'Y'.
  5962         16  PB-I-RATE-CLASS              PIC XX.
  5963         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  5964         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  5965         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  5966         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  5967         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  5968         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  5969         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5970         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 111
* EL6311.cbl
  5971         16  PB-I-OB-FLAG                 PIC X.
  5972             88  PB-I-OB                      VALUE 'B'.
  5973             88  PB-I-SUMMARY                 VALUE 'Z'.
  5974         16  PB-I-ENTRY-STATUS            PIC X.
  5975             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  5976                                              'M' '5' '9' '2'.
  5977             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  5978             88  PB-I-POLICY-PENDING          VALUE '2'.
  5979             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  5980             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  5981             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  5982             88  PB-I-REIN-ONLY               VALUE '9'.
  5983             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  5984             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  5985             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  5986             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5987         16  PB-I-INT-CODE                PIC X.
  5988             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  5989             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5990         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  5991         16  PB-I-SOC-SEC-NO              PIC X(11).
  5992         16  PB-I-MEMBER-NO               PIC X(12).
  5993         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  5994*        16  PB-I-LOAN-OFFICER            PIC XXX.
  5995         16  PB-I-OLD-LOF                 PIC XXX.
  5996         16  PB-I-LF-EXPIRE-DT            PIC XX.
  5997         16  PB-I-AH-EXPIRE-DT            PIC XX.
  5998         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  5999         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6000         16  PB-I-LIFE-INDICATOR          PIC X.
  6001             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6002         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6003         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6004                                          PIC S9(5)V99    COMP-3.
  6005         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6006             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6007             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6008         16  PB-I-1ST-PMT-DT              PIC XX.
  6009         16  PB-I-JOINT-INSURED.
  6010             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6011             20 PB-I-JOINT-FIRST-NAME.
  6012                24  PB-I-JOINT-FIRST-INIT PIC X.
  6013                24  FILLER                PIC X(9).
  6014             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6015*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6016         16  PB-I-BENEFICIARY-NAME.
  6017             20  PB-I-BANK-NUMBER         PIC X(10).
  6018             20  FILLER                   PIC X(15).
  6019         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6020         16  PB-I-REFERENCE               PIC X(12).
  6021         16  FILLER REDEFINES PB-I-REFERENCE.
  6022             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6023             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6024             20  PB-I-CLP-STATE           PIC XX.
  6025         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6026             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6027             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6028             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 112
* EL6311.cbl
  6029         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6030         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6031         16  PB-I-RESIDENT-STATE          PIC XX.
  6032         16  PB-I-RATE-CODE               PIC X(4).
  6033         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6034         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6035         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6036         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6037         16  PB-I-BANK-NOCHRGB            PIC 99.
  6038         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6039         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6040
  6041     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6042         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6043             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6044         16  PB-C-CANCEL-ORIGIN           PIC X.
  6045             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6046         16  PB-C-LF-CANCEL-DT            PIC XX.
  6047         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6048         16  PB-C-LF-CALC-REQ             PIC X.
  6049             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6050         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6051         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6052         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6053             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6054         16  PB-C-AH-CANCEL-DT            PIC XX.
  6055         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6056         16  PB-C-AH-CALC-REQ             PIC X.
  6057             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6058         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6059         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6060         16  PB-C-LAST-NAME               PIC X(15).
  6061         16  PB-C-REFUND-SW               PIC X.
  6062             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6063             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6064         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6065         16  PB-C-PAYEE-CODE              PIC X(6).
  6066         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6067         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6068         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6069         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6070         16  PB-C-REFERENCE               PIC X(12).
  6071         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6072         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6073         16  PB-C-POST-CARD-IND           PIC X.
  6074         16  PB-C-CANCEL-REASON           PIC X.
  6075         16  PB-C-REF-INTERFACE-SW        PIC X.
  6076         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6077         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6078         16  FILLER                       PIC X(01).
  6079*        16  FILLER                       PIC X(18).
  6080         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6081*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6082         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  6083         16  PB-CANCELED-CERT-DATA.
  6084             20  PB-CI-INSURED-NAME.
  6085                 24  PB-CI-LAST-NAME      PIC X(15).
  6086                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 113
* EL6311.cbl
  6087             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6088             20  PB-CI-INSURED-SEX        PIC X.
  6089             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6090             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6091             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6092             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6093             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6094             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6095             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6096             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6097             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6098             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6099             20  PB-CI-RATE-CLASS         PIC XX.
  6100             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6101             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6102             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6103             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6104             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6105             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6106             20  PB-CI-LF-ABBR            PIC X(3).
  6107             20  PB-CI-AH-ABBR            PIC X(3).
  6108             20  PB-CI-OB-FLAG            PIC X.
  6109                 88  PB-CI-OB                VALUE 'B'.
  6110             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6111                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6112                                           'M' '4' '5' '9' '2'.
  6113                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6114                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6115                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6116                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6117                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6118                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6119                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6120                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6121                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6122                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6123                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6124                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6125             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6126                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6127                                           'M' '4' '5' '9' '2'.
  6128                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6129                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6130                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6131                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6132                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6133                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6134                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6135                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6136                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6137                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6138                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6139                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6140             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6141             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6142             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6143             20  PB-CI-MEMBER-NO          PIC X(12).
  6144             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 114
* EL6311.cbl
  6145                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6146                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6147             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6148             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6149             20  PB-CI-COMP-EXCP-SW       PIC X.
  6150                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6151                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6152             20  PB-CI-ENTRY-STATUS       PIC X.
  6153             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6154             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6155             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6156             20  PB-CI-DEATH-DT           PIC XX.
  6157             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6158             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6159             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6160             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6161             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6162             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6163             20  PB-CI-ENTRY-DT              PIC XX.
  6164             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6165             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6166             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6167             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6168             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6169             20  PB-CI-OLD-LOF               PIC XXX.
  6170*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6171             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6172             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6173             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6174             20  PB-CI-INDV-GRP-CD           PIC X.
  6175             20  PB-CI-BENEFICIARY-NAME.
  6176                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6177                 24  FILLER                  PIC X(15).
  6178             20  PB-CI-NOTE-SW               PIC X.
  6179             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6180             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6181             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6182             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6183             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6184             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6185             20  PB-CI-FIRST-NAME            PIC X(10).
  6186             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6187
  6188         16  FILLER                       PIC X(13).
  6189*032306  16  FILLER                       PIC X(27).
  6190*        16  FILLER                       PIC X(46).
  6191
  6192     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6193         16  FILLER                       PIC X(10).
  6194         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6195         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6196         16  PB-M-INSURED-MID-INIT        PIC X.
  6197         16  PB-M-INSURED-AGE             PIC 99.
  6198         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6199         16  PB-M-INSURED-SEX             PIC X.
  6200         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6201         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6202         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 115
* EL6311.cbl
  6203         16  PB-M-INSURED-CITY-STATE.
  6204             20  PB-M-INSURED-CITY        PIC X(28).
  6205             20  PB-M-INSURED-STATE       PIC XX.
  6206         16  PB-M-INSURED-ZIP-CODE.
  6207             20  PB-M-INSURED-ZIP-PRIME.
  6208                 24  PB-M-INSURED-ZIP-1   PIC X.
  6209                     88  PB-M-CANADIAN-POST-CODE
  6210                                             VALUE 'A' THRU 'Z'.
  6211                 24  FILLER               PIC X(4).
  6212             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6213         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6214                                        PB-M-INSURED-ZIP-CODE.
  6215             20  PM-M-INS-CAN-POST1       PIC XXX.
  6216             20  PM-M-INS-CAN-POST2       PIC XXX.
  6217             20  FILLER                   PIC XXX.
  6218         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6219         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6220         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6221         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6222         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6223         16  PB-M-CRED-BENE-CITYST.
  6224             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6225             20  PB-M-CRED-BENE-STATE     PIC XX.
  6226         16  FILLER                       PIC X(92).
  6227
  6228     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6229         16  FILLER                       PIC X(10).
  6230         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6231         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6232         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6233         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6234         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6235         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6236         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6237         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6238         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6239         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6240         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6241         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6242         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6243         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6244         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6245         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6246         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6247         16  PB-ACCOUNT-NAME              PIC X(30).
  6248         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6249         16  PB-REFERENCE                 PIC X(12).
  6250         16  PB-B-RECEIVED-DT             PIC XX.
  6251         16  FILLER                       PIC X(234).
  6252
  6253     12  PB-RECORD-STATUS.
  6254         16  PB-CREDIT-SELECT-DT          PIC XX.
  6255         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6256         16  PB-BILLED-DT                 PIC XX.
  6257         16  PB-BILLING-STATUS            PIC X.
  6258             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6259             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6260             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 116
* EL6311.cbl
  6261         16  PB-RECORD-BILL               PIC X.
  6262             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6263             88  PB-RECORD-RETURNED           VALUE 'R'.
  6264             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6265             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6266             88  PB-OVERRIDE-AH               VALUE 'A'.
  6267             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6268         16  PB-BATCH-ENTRY               PIC X.
  6269             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6270             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6271             88  PB-REISSUED-CERT             VALUE 'E'.
  6272             88  PB-MONTHLY-CERT              VALUE 'M'.
  6273             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6274             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6275             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6276         16  PB-FORCE-CODE                PIC X.
  6277             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6278             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6279             88  PB-CANCEL-FORCE              VALUE '8'.
  6280             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6281             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6282             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6283             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6284             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6285             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6286             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6287         16  PB-FATAL-FLAG                PIC X.
  6288             88  PB-FATAL-ERRORS              VALUE 'X'.
  6289         16  PB-FORCE-ER-CD               PIC X.
  6290             88  PB-FORCE-ERRORS              VALUE 'F'.
  6291             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6292         16  PB-WARN-ER-CD                PIC X.
  6293             88  PB-WARNING-ERRORS            VALUE 'W'.
  6294         16  FILLER                       PIC X.
  6295         16  PB-OUT-BAL-CD                PIC X.
  6296             88  PB-OUT-OF-BAL                VALUE 'O'.
  6297         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6298         16  PB-AH-OVERRIDE-L1            PIC X.
  6299         16  PB-INPUT-DT                  PIC XX.
  6300         16  PB-INPUT-BY                  PIC X(4).
  6301         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6302         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6303         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6304         16  PB-LF-EARNING-METHOD         PIC X.
  6305         16  PB-AH-EARNING-METHOD         PIC X.
  6306         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6307         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6308         16  PB-REIN-CD                   PIC XXX.
  6309         16  PB-LF-REFUND-TYPE            PIC X.
  6310         16  PB-AH-REFUND-TYPE            PIC X.
  6311         16  PB-ACCT-EFF-DT               PIC XX.
  6312         16  PB-ACCT-EXP-DT               PIC XX.
  6313         16  PB-COMPANY-ID                PIC X(3).
  6314         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6315         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6316         16  PB-SV-CARRIER                PIC X.
  6317         16  PB-SV-GROUPING               PIC X(6).
  6318         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 117
* EL6311.cbl
  6319         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6320         16  PB-GA-BILLING-INFO.
  6321             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6322                                          PIC XX.
  6323         16  PB-SV-REMIT-TO  REDEFINES
  6324             PB-GA-BILLING-INFO           PIC X(10).
  6325         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6326         16  PB-I-LOAN-OFFICER            PIC X(5).
  6327         16  PB-I-VIN                     PIC X(17).
  6328
  6329         16  FILLER                       PIC X(04).
  6330         16  IMNET-BYPASS-SW              PIC X.
  6331
  6332******************************************************************
  6333*                COMMON EDIT ERRORS                              *
  6334******************************************************************
  6335
  6336     12  PB-COMMON-ERRORS.
  6337         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6338                                           PIC S9(4)     COMP.
  6339
  6340******************************************************************
  6341
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 118
* EL6311.cbl
  6343*    COPY ELCCERT.
  6344******************************************************************
  6345*                                                                *
  6346*                            ELCCERT.                            *
  6347*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6348*                            VMOD=2.013                          *
  6349*                                                                *
  6350*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6351*                                                                *
  6352*   FILE TYPE = VSAM,KSDS                                        *
  6353*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6354*                                                                *
  6355*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6356*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6357*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6358*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6359*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6360*                                                                *
  6361*   LOG = YES                                                    *
  6362*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6363******************************************************************
  6364*                   C H A N G E   L O G
  6365*
  6366* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6367*-----------------------------------------------------------------
  6368*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6369* EFFECTIVE    NUMBER
  6370*-----------------------------------------------------------------
  6371* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6372* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6373* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6374* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6375* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6376* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6377* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6378* 032612  CR2011110200001  PEMA  AHL CHANGES
  6379******************************************************************
  6380
  6381 01  CERTIFICATE-MASTER.
  6382     12  CM-RECORD-ID                      PIC XX.
  6383         88  VALID-CM-ID                      VALUE 'CM'.
  6384
  6385     12  CM-CONTROL-PRIMARY.
  6386         16  CM-COMPANY-CD                 PIC X.
  6387         16  CM-CARRIER                    PIC X.
  6388         16  CM-GROUPING.
  6389             20  CM-GROUPING-PREFIX        PIC X(3).
  6390             20  CM-GROUPING-PRIME         PIC X(3).
  6391         16  CM-STATE                      PIC XX.
  6392         16  CM-ACCOUNT.
  6393             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6394             20  CM-ACCOUNT-PRIME          PIC X(6).
  6395         16  CM-CERT-EFF-DT                PIC XX.
  6396         16  CM-CERT-NO.
  6397             20  CM-CERT-PRIME             PIC X(10).
  6398             20  CM-CERT-SFX               PIC X.
  6399
  6400     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 119
* EL6311.cbl
  6401         16  CM-COMPANY-CD-A1              PIC X.
  6402         16  CM-INSURED-LAST-NAME          PIC X(15).
  6403         16  CM-INSURED-INITIALS.
  6404             20  CM-INSURED-INITIAL1       PIC X.
  6405             20  CM-INSURED-INITIAL2       PIC X.
  6406
  6407     12  CM-CONTROL-BY-SSN.
  6408         16  CM-COMPANY-CD-A2              PIC X.
  6409         16  CM-SOC-SEC-NO.
  6410             20  CM-SSN-STATE              PIC XX.
  6411             20  CM-SSN-ACCOUNT            PIC X(6).
  6412             20  CM-SSN-LN3.
  6413                 25  CM-INSURED-INITIALS-A2.
  6414                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6415                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6416                 25 CM-PART-LAST-NAME-A2         PIC X.
  6417
  6418     12  CM-CONTROL-BY-CERT-NO.
  6419         16  CM-COMPANY-CD-A4              PIC X.
  6420         16  CM-CERT-NO-A4                 PIC X(11).
  6421
  6422     12  CM-CONTROL-BY-MEMB.
  6423         16  CM-COMPANY-CD-A5              PIC X.
  6424         16  CM-MEMBER-NO.
  6425             20  CM-MEMB-STATE             PIC XX.
  6426             20  CM-MEMB-ACCOUNT           PIC X(6).
  6427             20  CM-MEMB-LN4.
  6428                 25  CM-INSURED-INITIALS-A5.
  6429                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6430                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6431                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6432
  6433     12  CM-INSURED-PROFILE-DATA.
  6434         16  CM-INSURED-FIRST-NAME.
  6435             20  CM-INSURED-1ST-INIT       PIC X.
  6436             20  FILLER                    PIC X(9).
  6437         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6438         16  CM-INSURED-SEX                PIC X.
  6439             88  CM-SEX-MALE                  VALUE 'M'.
  6440             88  CM-SEX-FEMAL                 VALUE 'F'.
  6441         16  CM-INSURED-JOINT-AGE          PIC 99.
  6442         16  CM-JOINT-INSURED-NAME.
  6443             20  CM-JT-LAST-NAME           PIC X(15).
  6444             20  CM-JT-FIRST-NAME.
  6445                 24  CM-JT-1ST-INIT        PIC X.
  6446                 24  FILLER                PIC X(9).
  6447             20  CM-JT-INITIAL             PIC X.
  6448
  6449     12  CM-LIFE-DATA.
  6450         16  CM-LF-BENEFIT-CD              PIC XX.
  6451         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6452         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6453         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6454         16  CM-LF-DEV-CODE                PIC XXX.
  6455         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6456         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6457         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6458         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 120
* EL6311.cbl
  6459         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6460         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6461         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6462         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6463         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6464         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6465         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6466         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6467         16  FILLER                        PIC XX.
  6468
  6469     12  CM-AH-DATA.
  6470         16  CM-AH-BENEFIT-CD              PIC XX.
  6471         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6472         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6473         16  CM-AH-DEV-CODE                PIC XXX.
  6474         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6475         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6476         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6477         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6478         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6479         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6480         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6481         16  CM-AH-PAID-THRU-DT            PIC XX.
  6482             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6483         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6484         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6485         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6486         16  FILLER                        PIC X.
  6487
  6488     12  CM-LOAN-INFORMATION.
  6489         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6490         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6491                                           PIC S9(5)V99  COMP-3.
  6492         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6493         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6494         16  CM-PAY-FREQUENCY              PIC S99.
  6495         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6496         16  CM-RATE-CLASS                 PIC XX.
  6497         16  CM-BENEFICIARY                PIC X(25).
  6498         16  CM-POLICY-FORM-NO             PIC X(12).
  6499         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6500         16  CM-LAST-ADD-ON-DT             PIC XX.
  6501         16  CM-DEDUCTIBLE-AMOUNTS.
  6502             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6503             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6504         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6505             20  CM-RESIDENT-STATE         PIC XX.
  6506             20  CM-RATE-CODE              PIC X(4).
  6507             20  FILLER                    PIC XX.
  6508         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6509             20  CM-LOAN-OFFICER           PIC X(5).
  6510             20  FILLER                    PIC XXX.
  6511         16  CM-CSR-CODE                   PIC XXX.
  6512         16  CM-UNDERWRITING-CODE          PIC X.
  6513             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6514         16  CM-POST-CARD-IND              PIC X.
  6515         16  CM-NH-INTERFACE-SW            PIC X.
  6516         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 121
* EL6311.cbl
  6517             88  CM-SING-PRM                  VALUE '1'.
  6518             88  CM-O-B-COVERAGE              VALUE '2'.
  6519             88  CM-OPEN-END                  VALUE '3'.
  6520         16  CM-IND-GRP-TYPE               PIC X.
  6521             88  CM-INDIVIDUAL                VALUE 'I'.
  6522             88  CM-GROUP                     VALUE 'G'.
  6523         16  CM-SKIP-CODE                  PIC X.
  6524             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6525             88  SKIP-JULY                    VALUE '1'.
  6526             88  SKIP-AUGUST                  VALUE '2'.
  6527             88  SKIP-SEPTEMBER               VALUE '3'.
  6528             88  SKIP-JULY-AUG                VALUE '4'.
  6529             88  SKIP-AUG-SEPT                VALUE '5'.
  6530             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6531             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6532             88  SKIP-JUNE                    VALUE '8'.
  6533             88  SKIP-JUNE-JULY               VALUE '9'.
  6534             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6535             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6536         16  CM-PAYMENT-MODE               PIC X.
  6537             88  PAY-MONTHLY                  VALUE SPACE.
  6538             88  PAY-WEEKLY                   VALUE '1'.
  6539             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6540             88  PAY-BI-WEEKLY                VALUE '3'.
  6541             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6542         16  CM-LOAN-NUMBER                PIC X(8).
  6543         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6544         16  CM-OLD-LOF                    PIC XXX.
  6545*        16  CM-LOAN-OFFICER               PIC XXX.
  6546         16  CM-REIN-TABLE                 PIC XXX.
  6547         16  CM-SPECIAL-REIN-CODE          PIC X.
  6548         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6549         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6550         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6551
  6552     12  CM-STATUS-DATA.
  6553         16  CM-ENTRY-STATUS               PIC X.
  6554         16  CM-ENTRY-DT                   PIC XX.
  6555
  6556         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6557         16  CM-LF-CANCEL-DT               PIC XX.
  6558         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6559
  6560         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6561         16  CM-LF-DEATH-DT                PIC XX.
  6562         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6563
  6564         16  CM-LF-CURRENT-STATUS          PIC X.
  6565             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6566                                                'M' '4' '5' '9'.
  6567             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6568             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6569             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6570             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6571             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6572             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6573             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6574             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 122
* EL6311.cbl
  6575             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6576             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6577             88  CM-LF-DECLINED               VALUE 'D'.
  6578             88  CM-LF-VOIDED                 VALUE 'V'.
  6579
  6580         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6581         16  CM-AH-CANCEL-DT               PIC XX.
  6582         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6583
  6584         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6585         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6586         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6587
  6588         16  CM-AH-CURRENT-STATUS          PIC X.
  6589             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6590                                                'M' '4' '5' '9'.
  6591             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6592             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6593             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6594             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6595             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6596             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6597             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6598             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6599             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6600             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6601             88  CM-AH-DECLINED               VALUE 'D'.
  6602             88  CM-AH-VOIDED                 VALUE 'V'.
  6603
  6604         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6605             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6606             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6607             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6608         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6609
  6610         16  CM-ENTRY-BATCH                PIC X(6).
  6611         16  CM-LF-EXIT-BATCH              PIC X(6).
  6612         16  CM-AH-EXIT-BATCH              PIC X(6).
  6613         16  CM-LAST-MONTH-END             PIC XX.
  6614
  6615     12  CM-NOTE-SW                        PIC X.
  6616         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6617         88  CERT-NOTES-PRESENT               VALUE '1'.
  6618         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6619         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6620         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6621         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6622         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6623         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6624     12  CM-COMP-EXCP-SW                   PIC X.
  6625         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6626         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6627     12  CM-INSURED-ADDRESS-SW             PIC X.
  6628         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6629         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6630
  6631*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6632     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 123
* EL6311.cbl
  6633     12  FILLER                            PIC X.
  6634
  6635*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6636     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6637     12  FILLER                            PIC X.
  6638*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6639     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6640
  6641     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6642         88  CERT-ADDED-BATCH                 VALUE ' '.
  6643         88  CERT-ADDED-ONLINE                VALUE '1'.
  6644         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6645         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6646         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6647     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6648         88  CERT-AS-LOADED                   VALUE ' '.
  6649         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6650         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6651         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6652         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6653         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6654         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6655         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6656
  6657     12  CM-ACCOUNT-COMM-PCTS.
  6658         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6659         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6660
  6661     12  CM-USER-FIELD                     PIC X.
  6662     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6663     12  CM-CLP-STATE                      PIC XX.
  6664     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6665     12  CM-USER-RESERVED                  PIC XXX.
  6666     12  FILLER REDEFINES CM-USER-RESERVED.
  6667         16  CM-AH-CLASS-CD                PIC XX.
  6668         16  F                             PIC X.
  6669******************************************************************
  6670
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 124
* EL6311.cbl
  6672*    COPY ERCNOTE.
  6673******************************************************************
  6674*                                                                *
  6675*                                                                *
  6676*                            ERCNOTE                             *
  6677*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6678*                            VMOD=2.003                          *
  6679*                                                                *
  6680*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6681*                                                                *
  6682*        FILE TYPE= VSAM,KSDS                                    *
  6683*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6684*                                                                *
  6685*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6686*                                                                *
  6687*        LOG = YES                                               *
  6688*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6689*                                                                *
  6690******************************************************************
  6691*                   C H A N G E   L O G
  6692*
  6693* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6694*-----------------------------------------------------------------
  6695*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6696* EFFECTIVE    NUMBER
  6697*-----------------------------------------------------------------
  6698* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6699*                                FILE WILL CONTAIN BILLING NOTES O
  6700******************************************************************
  6701
  6702 01  CERTIFICATE-NOTE.
  6703     12  CN-RECORD-ID                PIC  XX.
  6704         88  VALID-CN-ID                  VALUE 'CN'.
  6705
  6706     12  CN-CONTROL-PRIMARY.
  6707         16  CN-COMPANY-CD           PIC X.
  6708         16  CN-CARRIER              PIC X.
  6709         16  CN-GROUPING.
  6710             20 CN-GROUPING-PREFIX   PIC XXX.
  6711             20 CN-GROUPING-PRIME    PIC XXX.
  6712         16  CN-STATE                PIC XX.
  6713         16  CN-ACCOUNT.
  6714             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6715             20 CN-ACCOUNT-PRIME     PIC X(6).
  6716         16  CN-CERT-EFF-DT          PIC XX.
  6717         16  CN-CERT-NO.
  6718             20  CN-CERT-PRIME       PIC X(10).
  6719             20  CN-CERT-SFX         PIC X.
  6720
  6721     12  CN-BILLING-START-LINE-NO    PIC 99.
  6722     12  CN-BILLING-END-LINE-NO      PIC 99.
  6723
  6724     12  CN-LINES.
  6725         16  CN-LINE OCCURS 10       PIC X(77).
  6726
  6727     12  CN-LAST-MAINT-DT            PIC XX.
  6728     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6729     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 125
* EL6311.cbl
  6730     12  FILLER                      PIC X(6).
  6731******************************************************************
  6732
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 126
* EL6311.cbl
  6734*    COPY ERCPNDM.
  6735******************************************************************
  6736*                                                                *
  6737*                                                                *
  6738*                            ERCPNDM                             *
  6739*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6740*                            VMOD=2.003                          *
  6741*                                                                *
  6742*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6743*                                                                *
  6744*   FILE TYPE = VSAM,KSDS                                        *
  6745*   RECORD SIZE = 374   RECFORM = FIX                            *
  6746*                                                                *
  6747*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6748*   ALTERNATE PATH    = NOT USED                                 *
  6749*                                                                *
  6750*   LOG = YES                                                    *
  6751*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6752******************************************************************
  6753*                   C H A N G E   L O G
  6754*
  6755* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6756*-----------------------------------------------------------------
  6757*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6758* EFFECTIVE    NUMBER
  6759*-----------------------------------------------------------------
  6760* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6761* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6762* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6763******************************************************************
  6764
  6765 01  PENDING-MAILING-DATA.
  6766     12  PM-RECORD-ID                      PIC XX.
  6767         88  VALID-MA-ID                       VALUE 'PM'.
  6768
  6769     12  PM-CONTROL-PRIMARY.
  6770         16  PM-COMPANY-CD                 PIC X.
  6771         16  PM-ENTRY-BATCH                PIC X(6).
  6772         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6773         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6774
  6775     12  FILLER                            PIC X(14).
  6776
  6777     12  PM-ACCESS-CONTROL.
  6778         16  PM-SOURCE-SYSTEM              PIC XX.
  6779             88  PM-FROM-CREDIT                VALUE 'CR'.
  6780             88  PM-FROM-VSI                   VALUE 'VS'.
  6781             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6782             88  PM-FROM-OTHER                 VALUE 'OT'.
  6783         16  PM-RECORD-ADD-DT              PIC XX.
  6784         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6785         16  PM-LAST-MAINT-DT              PIC XX.
  6786         16  PM-LAST-MAINT-BY              PIC XXXX.
  6787         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6788
  6789     12  PM-PROFILE-INFO.
  6790         16  PM-QUALIFY-CODE-1             PIC XX.
  6791         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 127
* EL6311.cbl
  6792         16  PM-QUALIFY-CODE-3             PIC XX.
  6793         16  PM-QUALIFY-CODE-4             PIC XX.
  6794         16  PM-QUALIFY-CODE-5             PIC XX.
  6795
  6796         16  PM-INSURED-LAST-NAME          PIC X(15).
  6797         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6798         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6799         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6800         16  PM-INSURED-BIRTH-DT           PIC XX.
  6801         16  PM-INSURED-SEX                PIC X.
  6802             88  PM-SEX-MALE                   VALUE 'M'.
  6803             88  PM-SEX-FEMALE                 VALUE 'F'.
  6804         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6805
  6806         16  PM-ADDRESS-CORRECTED          PIC X.
  6807         16  PM-JOINT-BIRTH-DT             PIC XX.
  6808*        16  FILLER                        PIC X(12).
  6809
  6810         16  PM-ADDRESS-LINE-1             PIC X(30).
  6811         16  PM-ADDRESS-LINE-2             PIC X(30).
  6812         16  PM-CITY-STATE.
  6813             20  PM-CITY                   PIC X(28).
  6814             20  PM-STATE                  PIC XX.
  6815         16  PM-ZIP.
  6816             20  PM-ZIP-CODE.
  6817                 24  PM-ZIP-1              PIC X.
  6818                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6819                 24  FILLER                PIC X(4).
  6820             20  PM-ZIP-PLUS4              PIC X(4).
  6821         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6822             20  PM-CAN-POST1              PIC XXX.
  6823             20  PM-CAN-POST2              PIC XXX.
  6824             20  FILLER                    PIC XXX.
  6825
  6826         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6827
  6828         16  FILLER                        PIC X(03).
  6829
  6830     12  PM-CRED-BENE-INFO.
  6831         16  PM-CRED-BENE-NAME             PIC X(25).
  6832         16  PM-CRED-BENE-ADDR             PIC X(30).
  6833         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6834         16  PM-CRED-BENE-CTYST.
  6835             20  PM-CRED-BENE-CITY         PIC X(28).
  6836             20  PM-CRED-BENE-STATE        PIC XX.
  6837         16  PM-CRED-BENE-ZIP.
  6838             20  PM-CB-ZIP-CODE.
  6839                 24  PM-CB-ZIP-1           PIC X.
  6840                     88  PM-CB-CANADIAN-POST-CODE
  6841                                  VALUE 'A' THRU 'Z'.
  6842                 24  FILLER                PIC X(4).
  6843             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6844         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6845             20  PM-CB-CAN-POST1           PIC XXX.
  6846             20  PM-CB-CAN-POST2           PIC XXX.
  6847             20  FILLER                    PIC XXX.
  6848     12  PM-POST-CARD-MAIL-DATA.
  6849         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 128
* EL6311.cbl
  6850             20  PM-MAIL-TYPE              PIC X.
  6851                 88  PM-12MO-MAILING           VALUE '1'.
  6852                 88  PM-EXP-MAILING            VALUE '2'.
  6853             20  PM-MAIL-STATUS            PIC X.
  6854                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6855                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6856                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6857             20  PM-MAIL-DATE              PIC XX.
  6858     12  FILLER                            PIC XX.
  6859     12  FILLER                            PIC X(12).
  6860*    12  FILLER                            PIC X(30).
  6861
  6862******************************************************************
  6863
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 129
* EL6311.cbl
  6865*    COPY ERCMAIL.
  6866******************************************************************
  6867*                                                                *
  6868*                                                                *
  6869*                            ERCMAIL                             *
  6870*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6871*                            VMOD=2.003                          *
  6872*                                                                *
  6873*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6874*                                                                *
  6875*   FILE TYPE = VSAM,KSDS                                        *
  6876*   RECORD SIZE = 374   RECFORM = FIX                            *
  6877*                                                                *
  6878*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6879*   ALTERNATE PATH    = NOT USED                                 *
  6880*                                                                *
  6881*   LOG = YES                                                    *
  6882*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6883******************************************************************
  6884*                   C H A N G E   L O G
  6885*
  6886* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6887*-----------------------------------------------------------------
  6888*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6889* EFFECTIVE    NUMBER
  6890*-----------------------------------------------------------------
  6891* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6892* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6893* 111108                   PEMA  ADD CRED BENE ADDR2
  6894******************************************************************
  6895
  6896 01  MAILING-DATA.
  6897     12  MA-RECORD-ID                      PIC XX.
  6898         88  VALID-MA-ID                       VALUE 'MA'.
  6899
  6900     12  MA-CONTROL-PRIMARY.
  6901         16  MA-COMPANY-CD                 PIC X.
  6902         16  MA-CARRIER                    PIC X.
  6903         16  MA-GROUPING.
  6904             20  MA-GROUPING-PREFIX        PIC XXX.
  6905             20  MA-GROUPING-PRIME         PIC XXX.
  6906         16  MA-STATE                      PIC XX.
  6907         16  MA-ACCOUNT.
  6908             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6909             20  MA-ACCOUNT-PRIME          PIC X(6).
  6910         16  MA-CERT-EFF-DT                PIC XX.
  6911         16  MA-CERT-NO.
  6912             20  MA-CERT-PRIME             PIC X(10).
  6913             20  MA-CERT-SFX               PIC X.
  6914
  6915     12  FILLER                            PIC XX.
  6916
  6917     12  MA-ACCESS-CONTROL.
  6918         16  MA-SOURCE-SYSTEM              PIC XX.
  6919             88  MA-FROM-CREDIT                VALUE 'CR'.
  6920             88  MA-FROM-VSI                   VALUE 'VS'.
  6921             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6922             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 130
* EL6311.cbl
  6923         16  MA-RECORD-ADD-DT              PIC XX.
  6924         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6925         16  MA-LAST-MAINT-DT              PIC XX.
  6926         16  MA-LAST-MAINT-BY              PIC XXXX.
  6927         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6928
  6929     12  MA-PROFILE-INFO.
  6930         16  MA-QUALIFY-CODE-1             PIC XX.
  6931         16  MA-QUALIFY-CODE-2             PIC XX.
  6932         16  MA-QUALIFY-CODE-3             PIC XX.
  6933         16  MA-QUALIFY-CODE-4             PIC XX.
  6934         16  MA-QUALIFY-CODE-5             PIC XX.
  6935
  6936         16  MA-INSURED-LAST-NAME          PIC X(15).
  6937         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6938         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6939         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6940         16  MA-INSURED-BIRTH-DT           PIC XX.
  6941         16  MA-INSURED-SEX                PIC X.
  6942             88  MA-SEX-MALE                   VALUE 'M'.
  6943             88  MA-SEX-FEMALE                 VALUE 'F'.
  6944         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6945
  6946         16  MA-ADDRESS-CORRECTED          PIC X.
  6947         16  MA-JOINT-BIRTH-DT             PIC XX.
  6948*        16  FILLER                        PIC X(12).
  6949
  6950         16  MA-ADDRESS-LINE-1             PIC X(30).
  6951         16  MA-ADDRESS-LINE-2             PIC X(30).
  6952         16  MA-CITY-STATE.
  6953             20  MA-CITY                   PIC X(28).
  6954             20  MA-ADDR-STATE             PIC XX.
  6955         16  MA-ZIP.
  6956             20  MA-ZIP-CODE.
  6957                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6958                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6959                 24  FILLER                PIC X(4).
  6960             20  MA-ZIP-PLUS4              PIC X(4).
  6961         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6962             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6963             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6964             20  FILLER                    PIC X(3).
  6965
  6966         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6967
  6968         16  FILLER                        PIC XXX.
  6969*        16  FILLER                        PIC X(10).
  6970
  6971     12  MA-CRED-BENE-INFO.
  6972         16  MA-CRED-BENE-NAME                 PIC X(25).
  6973         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6974         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6975         16  MA-CRED-BENE-CTYST.
  6976             20  MA-CRED-BENE-CITY             PIC X(28).
  6977             20  MA-CRED-BENE-STATE            PIC XX.
  6978         16  MA-CRED-BENE-ZIP.
  6979             20  MA-CB-ZIP-CODE.
  6980                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 131
* EL6311.cbl
  6981                     88  MA-CB-CANADIAN-POST-CODE
  6982                                           VALUE 'A' THRU 'Z'.
  6983                 24  FILLER                    PIC X(4).
  6984             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6985         16  MA-CB-CANADIAN-POSTAL-CODE
  6986                            REDEFINES MA-CRED-BENE-ZIP.
  6987             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6988             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6989             20  FILLER                        PIC X(3).
  6990     12  MA-POST-CARD-MAIL-DATA.
  6991         16  MA-MAIL-DATA OCCURS 7.
  6992             20  MA-MAIL-TYPE              PIC X.
  6993                 88  MA-12MO-MAILING           VALUE '1'.
  6994                 88  MA-EXP-MAILING            VALUE '2'.
  6995             20  MA-MAIL-STATUS            PIC X.
  6996                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6997                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6998                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6999             20  MA-MAIL-DATE              PIC XX.
  7000     12  FILLER                            PIC XX.
  7001     12  FILLER                            PIC XX.
  7002*    12  FILLER                            PIC X(30).
  7003******************************************************************
  7004
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 132
* EL6311.cbl
  7006*    COPY ERCRQST.
  7007******************************************************************
  7008*                                                                *
  7009*                                                                *
  7010*                            ERCRQST.                            *
  7011*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7012*                            VMOD=2.002                          *
  7013*                                                                *
  7014*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7015*                                                                *
  7016*   FILE TYPE = VSAM,KSDS                                        *
  7017*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7018*                                                                *
  7019*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7020*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7021*                                   ACCOUNT, REF, BATCH)         *
  7022*                                                RKP=9, LEN=38   *
  7023*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7024*                                   ACCOUNT, REF, BATCH)         *
  7025*                                                RKP=47, LEN=46  *
  7026*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7027*                                   BATCH)                       *
  7028*                                                RKP=93, LEN=24  *
  7029*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7030*                                   REF, BATCH)                  *
  7031*                                                RKP=117, LEN=35 *
  7032*   LOG = NO                                                     *
  7033*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7034******************************************************************
  7035
  7036 01  AR-REQUEST-RECORD.
  7037     12  RQ-RECORD-ID                     PIC XX.
  7038         88  VALID-RQ-ID                        VALUE 'RQ'.
  7039
  7040     12  RQ-CONTROL-PRIMARY.
  7041         16  RQ-COMPANY-CD                PIC X.
  7042         16  RQ-ENTRY-BATCH               PIC X(6).
  7043
  7044     12  RQ-CONTROL-BY-ACCT-REF.
  7045         16  RQ-COMPANY-CD-A1             PIC X.
  7046         16  RQ-CARRIER-A1                PIC X.
  7047         16  RQ-GROUPING-A1               PIC X(6).
  7048         16  RQ-STATE-A1                  PIC XX.
  7049         16  RQ-ACCOUNT-A1                PIC X(10).
  7050         16  RQ-REFERENCE-A1              PIC X(12).
  7051         16  RQ-BATCH-A1                  PIC X(6).
  7052
  7053     12  RQ-CONTROL-BY-FIN-RESP.
  7054         16  RQ-COMPANY-CD-A2             PIC X.
  7055         16  RQ-CARRIER-A2                PIC X.
  7056         16  RQ-GROUPING-A2               PIC X(6).
  7057         16  RQ-FIN-RESP-A2               PIC X(10).
  7058         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7059         16  RQ-REFERENCE-A2              PIC X(12).
  7060         16  RQ-BATCH-A2                  PIC X(6).
  7061
  7062     12  RQ-CONTROL-BY-ACCT-AGENT.
  7063         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 133
* EL6311.cbl
  7064         16  RQ-CARRIER-A3                PIC X.
  7065         16  RQ-GROUPING-A3               PIC X(6).
  7066         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7067         16  RQ-BATCH-A3                  PIC X(6).
  7068
  7069     12  RQ-CONTROL-BY-SUMMARY.
  7070         16  RQ-COMPANY-CD-A4             PIC X.
  7071         16  RQ-SUMMARY-CODE              PIC X(6).
  7072         16  RQ-ACCOUNT-A4                PIC X(10).
  7073         16  RQ-REFERENCE-A4              PIC X(12).
  7074         16  RQ-BATCH-A4                  PIC X(6).
  7075
  7076     12  RQ-REQUEST-METHOD                PIC X.
  7077         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7078         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7079         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7080         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7081     12  FILLER                           PIC X.
  7082     12  RQ-STATUS                        PIC X.
  7083         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7084         88  RQ-RESUBMIT                      VALUE 'R'.
  7085     12  RQ-PROCESSOR-ID                  PIC X(4).
  7086     12  RQ-ENTRY-DT                      PIC XX.
  7087     12  RQ-MO-END-DT                     PIC XX.
  7088     12  RQ-REQUEST-DT                    PIC XX.
  7089     12  RQ-STMT-DT                       PIC XX.
  7090     12  RQ-REVERSAL-DT                   PIC XX.
  7091     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7092     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7093
  7094     12  FILLER                           PIC X(27).
  7095
  7096******************************************************************
  7097
  7098
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 134
* EL6311.cbl
  7100*    COPY ERCLOFC.
  7101******************************************************************
  7102*                                                                *
  7103*                                                                *
  7104*                            ERCLOFC                             *
  7105*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7106*                            VMOD=2.003                          *
  7107*                                                                *
  7108*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7109*                                                                *
  7110*   FILE TYPE = VSAM,KSDS                                        *
  7111*   RECORD SIZE = 670   RECFORM = FIX                            *
  7112*                                                                *
  7113*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7114*                                                                *
  7115*   LOG = YES                                                    *
  7116*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7117*                                                                *
  7118******************************************************************
  7119
  7120 01  LOAN-OFFICER-MASTER.
  7121     12  LO-RECORD-ID                PIC XX.
  7122         88  VALID-LO-ID                VALUE 'LO'.
  7123
  7124     12  LO-CONTROL-PRIMARY.
  7125         16  LO-COMPANY-CD           PIC X.
  7126         16  LO-CARRIER              PIC X.
  7127         16  LO-GROUPING.
  7128             20  LO-GROUPING-PREFIX  PIC XXX.
  7129             20  LO-GROUPING-PRIME   PIC XXX.
  7130         16  LO-STATE                PIC XX.
  7131         16  LO-ACCOUNT.
  7132             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7133             20  LO-ACCOUNT-PRIME    PIC X(6).
  7134         16  LO-OFFICER-CODE         PIC X(5).
  7135
  7136     12  LO-OFFICER-NAME             PIC X(30).
  7137
  7138     12  LO-LAST-MAINT-DT            PIC XX.
  7139     12  LO-LAST-USER                PIC X(4).
  7140     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7141
  7142     12  LO-COMP-CONTROL             PIC X.
  7143             88  LO-SHOW-COMP           VALUE 'Y'.
  7144             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7145     12  LO-DETAIL-CONTROL           PIC X.
  7146             88  LO-PRINT-DETAIL        VALUE 'D'.
  7147             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7148
  7149     12  LO-SV-CARRIER               PIC X.
  7150     12  LO-SV-GROUPING              PIC X(6).
  7151     12  LO-SV-STATE                 PIC XX.
  7152
  7153     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7154     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7155
  7156     12  LO-OFFICER-INFO.
  7157         16  FILLER OCCURS 12 TIMES.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 135
* EL6311.cbl
  7158             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7159             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7160             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7161             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7162             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7163             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7164             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7165             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7166     12  FILLER                      PIC X(198).
  7167******************************************************************
  7168
  7169*    COPY ERCPYAJ.
  7170******************************************************************
  7171*                                                                *
  7172*                            ERCPYAJ                             *
  7173*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7174*                            VMOD=2.015                          *
  7175*                                                                *
  7176*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7177*                                                                *
  7178*                                                                *
  7179*   FILE TYPE = VSAM,KSDS                                        *
  7180*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7181*                                                                *
  7182*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7183*       ALTERNATE PATHS = NONE                                   *
  7184*                                                                *
  7185*   LOG = YES                                                    *
  7186*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7187******************************************************************
  7188******************************************************************
  7189*                   C H A N G E   L O G
  7190*
  7191* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7192*-----------------------------------------------------------------
  7193*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7194* EFFECTIVE    NUMBER
  7195*-----------------------------------------------------------------
  7196* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7197* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7198******************************************************************
  7199
  7200 01  PENDING-PAY-ADJ.
  7201     12  PY-RECORD-ID                     PIC XX.
  7202         88  VALID-PY-ID                        VALUE 'PY'.
  7203
  7204     12  PY-CONTROL-PRIMARY.
  7205         16  PY-COMPANY-CD                PIC X.
  7206         16  PY-CARRIER                   PIC X.
  7207         16  PY-GROUPING                  PIC X(6).
  7208         16  PY-FIN-RESP                  PIC X(10).
  7209         16  PY-ACCOUNT                   PIC X(10).
  7210         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7211                                          PIC X(10).
  7212         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7213         16  PY-RECORD-TYPE               PIC X.
  7214             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7215             88  PY-DEPOSIT                   VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 136
* EL6311.cbl
  7216             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7217             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7218             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7219             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7220             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7221             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7222             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7223             88  PY-FICA-ENTRY                VALUE 'F'.
  7224             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7225             88  PY-POLICY-FEE                VALUE 'W'.
  7226             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7227
  7228     12  PY-PYMT-TYPE                     PIC X.
  7229             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7230             88  PY-REINS-PYMT                VALUE 'R'.
  7231             88  PY-EXP-PYMT                  VALUE 'E'.
  7232
  7233     12  PY-BIL-INV                       PIC X(6).
  7234     12  PY-REF-NO                        PIC X(12).
  7235
  7236     12  PY-LAST-MAINT-DT                 PIC XX.
  7237     12  PY-LAST-MAINT-BY                 PIC X(4).
  7238     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7239
  7240     12  PY-PYADJ-RECORD.
  7241         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7242         16  PY-ENTRY-COMMENT             PIC X(30).
  7243         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7244             20  PY-GL-ACCOUNT            PIC X(10).
  7245             20  PY-GL-STATE              PIC X(02).
  7246             20  PY-GL-CANC-SW            PIC X(01).
  7247                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7248                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7249             20  PY-GL-COMMENT            PIC X(10).
  7250             20  FILLER      REDEFINES PY-GL-COMMENT.
  7251                 24  PY-GL-CHECK-NO       PIC 9(06).
  7252                 24  FILLER               PIC X(04).
  7253             20  FILLER                   PIC X(07).
  7254         16  PY-SAVE-ACCOUNT              PIC X(10).
  7255         16  PY-SAVE-TYPE                 PIC X(01).
  7256
  7257         16  PY-LETTERS.
  7258             20  PY-LETTER OCCURS 3 TIMES
  7259                           INDEXED BY PY-LET-NDX
  7260                                          PIC X(04).
  7261
  7262         16  PY-ERCOMP-TYPE               PIC X.
  7263             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7264             88  PY-GA-TYPE                   VALUE 'G'.
  7265             88  PY-BANK-TYPE                 VALUE 'B'.
  7266         16  FILLER                       PIC X(05).
  7267
  7268     12  PY-RECORD-STATUS.
  7269         16  PY-CREDIT-SELECT-DT          PIC XX.
  7270         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7271         16  PY-BILLED-DATE               PIC XX.
  7272         16  PY-REPORTED-DT               PIC XX.
  7273         16  PY-PMT-APPLIED               PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 137
* EL6311.cbl
  7274             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7275             88  PY-GA-PMT                    VALUE 'G'.
  7276             88  PY-OVWRITE-PMT               VALUE 'O'.
  7277             88  PY-NON-AR-PMT                VALUE 'N'.
  7278         16  FILLER                       PIC X(5).
  7279         16  PY-INPUT-DT                  PIC XX.
  7280         16  PY-CHECK-NUMBER              PIC X(6).
  7281         16  PY-VOID-SW                   PIC X.
  7282             88  PY-CHECK-VOIDED              VALUE 'V'.
  7283         16  PY-CHECK-ORIGIN-SW           PIC X.
  7284             88  PY-BILLING-CHECK             VALUE 'B'.
  7285             88  PY-REFUND-CHECK              VALUE 'R'.
  7286             88  PY-GA-CHECK                  VALUE 'G'.
  7287             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7288             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7289         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7290         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7291         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7292         16  PY-BILL-FLAG                 PIC X.
  7293             88  PY-BILLED                    VALUE 'B'.
  7294         16  PY-AR-FLAG                   PIC X.
  7295             88  PY-AR-CYCLE                  VALUE 'C'.
  7296             88  PY-AR-MONTH-END              VALUE 'M'.
  7297         16  PY-AR-DATE                   PIC XX.
  7298
  7299     12  PY-GL-CODES.
  7300         16  PY-GL-DB                     PIC X(14).
  7301         16  PY-GL-CR                     PIC X(14).
  7302         16  PY-GL-FLAG                   PIC X.
  7303         16  PY-GL-DATE                   PIC XX.
  7304
  7305     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7306     12  FILLER                           PIC X(3).
  7307******************************************************************
  7308
  7309*    COPY ERCCNOT.
  7310******************************************************************
  7311*                                                                *
  7312*                            ERCCNOT                             *
  7313*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7314*                            VMOD=2.003                          *
  7315*                                                                *
  7316*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7317*                                                                *
  7318*        FILE TYPE= VSAM,KSDS                                    *
  7319*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7320*                                                                *
  7321*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7322*                                                                *
  7323*        LOG = YES                                               *
  7324*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7325*                                                                *
  7326******************************************************************
  7327*                   C H A N G E   L O G
  7328*
  7329* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7330*-----------------------------------------------------------------
  7331*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 138
* EL6311.cbl
  7332* EFFECTIVE    NUMBER
  7333*-----------------------------------------------------------------
  7334* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7335******************************************************************
  7336
  7337 01  CERT-NOTE-FILE.
  7338     12  CZ-RECORD-ID                PIC  XX.
  7339         88  VALID-CZ-ID                  VALUE 'CZ'.
  7340
  7341     12  CZ-CONTROL-PRIMARY.
  7342         16  CZ-COMPANY-CD           PIC X.
  7343         16  CZ-CARRIER              PIC X.
  7344         16  CZ-GROUPING.
  7345             20 CZ-GROUPING-PREFIX   PIC XXX.
  7346             20 CZ-GROUPING-PRIME    PIC XXX.
  7347         16  CZ-STATE                PIC XX.
  7348         16  CZ-ACCOUNT.
  7349             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7350             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7351         16  CZ-CERT-EFF-DT          PIC XX.
  7352         16  CZ-CERT-NO.
  7353             20  CZ-CERT-PRIME       PIC X(10).
  7354             20  CZ-CERT-SFX         PIC X.
  7355         16  CZ-RECORD-TYPE          PIC X.
  7356             88  CERT-NOTE           VALUE '1'.
  7357             88  CLAIM-CERT-NOTE     VALUE '2'.
  7358         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7359
  7360     12  CZ-LAST-MAINT-DT            PIC XX.
  7361     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7362     12  CZ-LAST-MAINT-USER          PIC X(4).
  7363
  7364     12  CZ-NOTE-INFORMATION.
  7365         16  CZ-NOTE                 PIC X(63).
  7366         16  FILLER                  PIC X(39).
  7367******************************************************************
  7368
  7369*    COPY ELCMSTR.
  7370******************************************************************
  7371*                                                                *
  7372*                            ELCMSTR.                            *
  7373*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7374*                            VMOD=2.012                          *
  7375*                                                                *
  7376*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7377*                                                                *
  7378*   FILE TYPE = VSAM,KSDS                                        *
  7379*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7380*                                                                *
  7381*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7382*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7383*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7384*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7385*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7386*                                                 RKP=75,LEN=21  *
  7387*                                                                *
  7388*   **** NOTE ****                                               *
  7389*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 139
* EL6311.cbl
  7390*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7391*                                                                *
  7392*   LOG = YES                                                    *
  7393*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7394******************************************************************
  7395*                   C H A N G E   L O G
  7396*
  7397* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7398*-----------------------------------------------------------------
  7399*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7400* EFFECTIVE    NUMBER
  7401*-----------------------------------------------------------------
  7402* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7403* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7404* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7405******************************************************************
  7406 01  CLAIM-MASTER.
  7407     12  CL-RECORD-ID                PIC XX.
  7408         88  VALID-CL-ID         VALUE 'CL'.
  7409
  7410     12  CL-CONTROL-PRIMARY.
  7411         16  CL-COMPANY-CD           PIC X.
  7412         16  CL-CARRIER              PIC X.
  7413         16  CL-CLAIM-NO             PIC X(7).
  7414         16  CL-CERT-NO.
  7415             20  CL-CERT-PRIME       PIC X(10).
  7416             20  CL-CERT-SFX         PIC X.
  7417
  7418     12  CL-CONTROL-BY-NAME.
  7419         16  CL-COMPANY-CD-A1        PIC X.
  7420         16  CL-INSURED-LAST-NAME    PIC X(15).
  7421         16  CL-INSURED-NAME.
  7422             20  CL-INSURED-1ST-NAME PIC X(12).
  7423             20  CL-INSURED-MID-INIT PIC X.
  7424
  7425     12  CL-CONTROL-BY-SSN.
  7426         16  CL-COMPANY-CD-A2        PIC X.
  7427         16  CL-SOC-SEC-NO.
  7428             20  CL-SSN-STATE        PIC XX.
  7429             20  CL-SSN-ACCOUNT      PIC X(6).
  7430             20  CL-SSN-LN3          PIC X(3).
  7431
  7432     12  CL-CONTROL-BY-CERT-NO.
  7433         16  CL-COMPANY-CD-A4        PIC X.
  7434         16  CL-CERT-NO-A4.
  7435             20  CL-CERT-A4-PRIME    PIC X(10).
  7436             20  CL-CERT-A4-SFX      PIC X.
  7437
  7438     12  CL-CONTROL-BY-CCN.
  7439         16  CL-COMPANY-CD-A5        PIC X.
  7440         16  CL-CCN-A5.
  7441             20  CL-CCN.
  7442                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7443                 24  CL-CCN-PRIME-A5 PIC X(12).
  7444             20  CL-CCN-FILLER-A5    PIC X(4).
  7445
  7446     12  CL-INSURED-PROFILE-DATA.
  7447         16  CL-INSURED-BIRTH-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 140
* EL6311.cbl
  7448         16  CL-INSURED-SEX-CD       PIC X.
  7449             88  INSURED-IS-MALE        VALUE 'M'.
  7450             88  INSURED-IS-FEMALE      VALUE 'F'.
  7451             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7452         16  CL-INSURED-OCC-CD       PIC X(6).
  7453         16  FILLER                  PIC X(5).
  7454
  7455     12  CL-PROCESSING-INFO.
  7456         16  CL-PROCESSOR-ID         PIC X(4).
  7457         16  CL-CLAIM-STATUS         PIC X.
  7458             88  CLAIM-IS-OPEN          VALUE 'O'.
  7459             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7460         16  CL-CLAIM-TYPE           PIC X.
  7461*            88  AH-CLAIM               VALUE 'A'.
  7462*            88  LIFE-CLAIM             VALUE 'L'.
  7463*            88  PROPERTY-CLAIM         VALUE 'P'.
  7464*            88  IUI-CLAIM              VALUE 'I'.
  7465*            88  GAP-CLAIM              VALUE 'G'.
  7466         16  CL-CLAIM-PREM-TYPE      PIC X.
  7467             88  SINGLE-PREMIUM         VALUE '1'.
  7468             88  O-B-COVERAGE           VALUE '2'.
  7469             88  OPEN-END-COVERAGE      VALUE '3'.
  7470         16  CL-INCURRED-DT          PIC XX.
  7471         16  CL-REPORTED-DT          PIC XX.
  7472         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7473         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7474         16  CL-LAST-PMT-DT          PIC XX.
  7475         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7476         16  CL-PAID-THRU-DT         PIC XX.
  7477         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7478         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7479         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7480         16  CL-PMT-CALC-METHOD      PIC X.
  7481             88  CL-360-DAY-YR          VALUE '1'.
  7482             88  CL-365-DAY-YR          VALUE '2'.
  7483             88  CL-FULL-MONTHS         VALUE '3'.
  7484         16  CL-CAUSE-CD             PIC X(6).
  7485
  7486         16  CL-PRIME-CERT-NO.
  7487             20  CL-PRIME-CERT-PRIME PIC X(10).
  7488             20  CL-PRIME-CERT-SFX   PIC X.
  7489
  7490         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7491             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7492             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7493
  7494         16  CL-MICROFILM-NO         PIC X(10).
  7495         16  CL-PROG-FORM-TYPE       PIC X.
  7496         16  CL-LAST-ADD-ON-DT       PIC XX.
  7497
  7498         16  CL-LAST-REOPEN-DT       PIC XX.
  7499         16  CL-LAST-CLOSE-DT        PIC XX.
  7500         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7501             88  FINAL-PAID             VALUE '1'.
  7502             88  CLAIM-DENIED           VALUE '2'.
  7503             88  AUTO-CLOSE             VALUE '3'.
  7504             88  MANUAL-CLOSE           VALUE '4'.
  7505             88  BENEFITS-CHANGED       VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 141
* EL6311.cbl
  7506             88  SETUP-ERRORS           VALUE 'E'.
  7507         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7508         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7509         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7510             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7511         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7512         16  FILLER                  PIC X.
  7513
  7514     12  CL-CERTIFICATE-DATA.
  7515         16  CL-CERT-ORIGIN          PIC X.
  7516             88  CERT-WAS-ONLINE        VALUE '1'.
  7517             88  CERT-WAS-CREATED       VALUE '2'.
  7518             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7519         16  CL-CERT-KEY-DATA.
  7520             20  CL-CERT-CARRIER     PIC X.
  7521             20  CL-CERT-GROUPING    PIC X(6).
  7522             20  CL-CERT-STATE       PIC XX.
  7523             20  CL-CERT-ACCOUNT.
  7524                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7525                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7526             20  CL-CERT-EFF-DT      PIC XX.
  7527
  7528     12  CL-STATUS-CONTROLS.
  7529         16  CL-PRIORITY-CD          PIC X.
  7530             88  CONFIDENTIAL-DATA      VALUE '8'.
  7531             88  HIGHEST-PRIORITY       VALUE '9'.
  7532         16  CL-SUPV-ATTN-CD         PIC X.
  7533             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7534             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7535         16  CL-PURGED-DT            PIC XX.
  7536         16  CL-RESTORED-DT          PIC XX.
  7537         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7538         16  CL-NEXT-RESEND-DT       PIC XX.
  7539         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7540         16  CL-CRITICAL-PERIOD      PIC 99.
  7541*        16  FILLER                  PIC XX.
  7542         16  CL-LAST-MAINT-DT        PIC XX.
  7543         16  CL-LAST-MAINT-USER      PIC X(4).
  7544         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7545         16  CL-LAST-MAINT-TYPE      PIC X.
  7546             88  CLAIM-SET-UP           VALUE ' '.
  7547             88  PAYMENT-MADE           VALUE '1'.
  7548             88  LETTER-SENT            VALUE '2'.
  7549             88  MASTER-WAS-ALTERED     VALUE '3'.
  7550             88  MASTER-WAS-RESTORED    VALUE '4'.
  7551             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7552             88  FILE-CONVERTED         VALUE '6'.
  7553             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7554             88  ERROR-CORRECTION       VALUE 'E'.
  7555         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7556         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7557         16  CL-BENEFICIARY          PIC X(10).
  7558         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7559         16  CL-DENIAL-TYPE          PIC X.
  7560             88  CL-TYPE-DENIAL          VALUE '1'.
  7561             88  CL-TYPE-RESCISSION      VALUE '2'.
  7562             88  CL-TYPE-REFORMATION     VALUE '3'.
  7563             88  CL-TYPE-REF-TO-RES      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 142
* EL6311.cbl
  7564             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7565         16  CL-CRIT-PER-RECURRENT   PIC X.
  7566         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7567         16  CL-RTW-DT               PIC XX.
  7568
  7569     12  CL-TRAILER-CONTROLS.
  7570         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7571             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7572             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7573             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7574         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7575         16  FILLER                  PIC XX.
  7576         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7577         16  CL-ADDRESS-TRAILER-CNT.
  7578             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7579                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7580             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7581                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7582             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7583                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7584             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7585                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7586             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7587                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7588             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7589                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7590             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7591                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7592
  7593     12  CL-CV-REFERENCE-NO.
  7594         16  CL-CV-REFNO-PRIME       PIC X(18).
  7595         16  CL-CV-REFNO-SFX         PIC XX.
  7596
  7597     12  CL-FILE-LOCATION            PIC X(4).
  7598
  7599     12  CL-PROCESS-ERRORS.
  7600         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7601             88  NO-FATAL-ERRORS        VALUE ZERO.
  7602         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7603             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7604
  7605     12  CL-PRODUCT-CD               PIC X.
  7606
  7607     12  CL-CURRENT-KEY-DATA.
  7608         16  CL-CURRENT-CARRIER      PIC X.
  7609         16  CL-CURRENT-GROUPING     PIC X(6).
  7610         16  CL-CURRENT-STATE        PIC XX.
  7611         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7612
  7613     12  CL-ASSOCIATES               PIC X.
  7614         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7615         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7616         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7617         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7618
  7619     12  CL-ACTIVITY-CODE            PIC 99.
  7620     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7621     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 143
* EL6311.cbl
  7622
  7623     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7624     12  CL-LAG-REPORT-CODE          PIC 9.
  7625     12  CL-LOAN-TYPE                PIC XX.
  7626     12  CL-LEGAL-STATE              PIC XX.
  7627
  7628     12  CL-YESNOSW                  PIC X.
  7629     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7630         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7631         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7632         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7633     12  cl-insured-claim            pic x.
  7634         88  cl-claim-on-primary         value 'P'.
  7635         88  cl-claim-on-secondary       value 'S'.
  7636     12  cl-benefit-expiration-dt    PIC XX.
  7637
  7638*    COPY ERCENDT.
  7639******************************************************************
  7640*                                                                *
  7641*                                                                *
  7642*                            ERCENDT.                            *
  7643*                            VMOD=2.001                          *
  7644*                                                                *
  7645*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7646*                                                                *
  7647*   FILE TYPE = VSAM,KSDS                                        *
  7648*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7649*                                                                *
  7650*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7651*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7652*                                                                *
  7653*   LOG = NO                                                     *
  7654*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7655******************************************************************
  7656*-----------------------------------------------------------------
  7657*                   C H A N G E   L O G
  7658*
  7659* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7660*-----------------------------------------------------------------
  7661*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7662* EFFECTIVE    NUMBER
  7663*-----------------------------------------------------------------
  7664* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7665*                                WITH OPEN CLAIMS
  7666* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7667* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7668* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7669*-----------------------------------------------------------------
  7670 01  ENDORSEMENT-RECORD.
  7671     12  EN-RECORD-ID                PIC XX.
  7672         88  VALID-EN-ID                VALUE 'EN'.
  7673     12  EN-CONTROL-PRIMARY.
  7674         16  EN-COMPANY-CD           PIC X.
  7675         16  EN-CARRIER              PIC X.
  7676         16  EN-GROUPING             PIC X(6).
  7677         16  EN-STATE                PIC XX.
  7678         16  EN-ACCOUNT              PIC X(10).
  7679         16  EN-CERT-EFF-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 144
* EL6311.cbl
  7680         16  EN-CERT-NO.
  7681             20  EN-CERT-PRIME       PIC X(10).
  7682             20  EN-CERT-SFX         PIC X.
  7683         16  EN-REC-TYPE             PIC X.
  7684             88  EN-ISSUE               VALUE 'I'.
  7685             88  EN-CANCELLATION        VALUE 'C'.
  7686         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7687     12  EN-CONTROL-BY-ARCH-NO.
  7688         16  EN-COMPANY-CD-A1              PIC X.
  7689         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7690     12  EN-LAST-MAINT-DT            PIC XX.
  7691     12  EN-LAST-MAINT-BY            PIC X(4).
  7692     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7693     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7694     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7695         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7696         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7697         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7698         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7699         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7700         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7701         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7702         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7703         16  EN-LF-ORIG-BENCD        PIC XX.
  7704         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7705         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7706         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7707         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7708         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7709         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7710*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7711         16  EN-ORIG-CRED-BENE       PIC X(25).
  7712         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7713         16  FILLER                  PIC X.
  7714         16  EN-AH-ORIG-BENCD        PIC XX.
  7715         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7716         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7717         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7718         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7719*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7720*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7721         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7722         16  F                       PIC X(09).
  7723         16  EN-AH-ORIG-CP           PIC 99.
  7724         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7725         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7726         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7727         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7728         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7729         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7730         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7731         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7732         16  EN-LF-NEW-BENCD         PIC XX.
  7733         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7734         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7735         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7736         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7737         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 145
* EL6311.cbl
  7738         16  EN-LF-NEW-EXP-DT        PIC XX.
  7739         16  EN-NEW-CRED-BENE        PIC X(25).
  7740         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7741         16  FILLER                  PIC X.
  7742         16  EN-AH-NEW-BENCD         PIC XX.
  7743         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7744         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7745         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7746         16  EN-AH-NEW-EXP-DT        PIC XX.
  7747*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7748*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7749*        16  F                       PIC X(12).
  7750         16  EN-AH-NEW-CP            PIC 99.
  7751         16  EN-SIG-SW               PIC X.
  7752         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7753         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7754         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7755         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7756         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7757         16  FILLER                  PIC X(33).
  7758     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7759         16  EN-LF-ORIG-REF-DT       PIC XX.
  7760         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7761         16  EN-AH-ORIG-REF-DT       PIC XX.
  7762         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7763         16  EN-LF-NEW-REF-DT        PIC XX.
  7764         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7765         16  EN-AH-NEW-REF-DT        PIC XX.
  7766         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7767         16  EN-FLAG-CERT            PIC X.
  7768         16  EN-INS-LAST-NAME        PIC X(15).
  7769         16  EN-INS-FIRST-NAME       PIC X(10).
  7770         16  EN-INS-MIDDLE-INIT      PIC X.
  7771         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7772         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7773         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7774         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7775         16  FILLER                  PIC X(262).
  7776     12  EN-MONEY-SW             PIC X.
  7777     12  EN-HEALTH-APP           PIC X.
  7778     12  EN-VOUCHER-SW           PIC X.
  7779     12  EN-PAYEE                PIC X(14).
  7780     12  EN-INPUT-DT             PIC XX.
  7781     12  EN-PROCESS-DT           PIC XX.
  7782     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7783     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7784     12  EN-REASON-CODES.
  7785         16  F OCCURS 12.
  7786             20  EN-REASON-CODE  PIC X(4).
  7787     12  EN-TEMPLATE-USED        PIC X(8).
  7788     12  EN-DOCU-TYPE            PIC X.
  7789         88  EN-VERI-DOCU          VALUE 'V'.
  7790         88  EN-GCE-DOCU           VALUE 'G'.
  7791         88  EN-CANC-DOCU          VALUE 'C'.
  7792     12  EN-COMMENTS1            PIC X(13).
  7793     12  EN-COMMENTS2            PIC X(70).
  7794     12  EN-COMM-CHGBK           PIC X.
  7795         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 146
* EL6311.cbl
  7796         88  EN-CHG-ACCT           VALUE 'Y'.
  7797     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7798     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7799     12  EN-BATCH-NUMBER         PIC X(6).
  7800     12  EN-ACCT-SUMM            PIC X.
  7801     12  EN-CSO-SUMM             PIC X.
  7802     12  FILLER                  PIC X(13).
  7803******************************************************************
  7804
  7805*    COPY ELCCRTT.
  7806******************************************************************
  7807*                                                                *
  7808*                            ELCCRTT.                            *
  7809*                                                                *
  7810*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7811*                                                                *
  7812*   FILE TYPE = VSAM,KSDS                                        *
  7813*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7814*                                                                *
  7815*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7816*                                                                *
  7817*   LOG = YES                                                    *
  7818*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7819******************************************************************
  7820*                   C H A N G E   L O G
  7821*
  7822* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7823*-----------------------------------------------------------------
  7824*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7825* EFFECTIVE    NUMBER
  7826*-----------------------------------------------------------------
  7827* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7828* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7829* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7830* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7831* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7832******************************************************************
  7833
  7834 01  CERTIFICATE-TRAILERS.
  7835     12  CS-RECORD-ID                      PIC XX.
  7836         88  VALID-CS-ID                      VALUE 'CS'.
  7837
  7838     12  CS-CONTROL-PRIMARY.
  7839         16  CS-COMPANY-CD                 PIC X.
  7840         16  CS-CARRIER                    PIC X.
  7841         16  CS-GROUPING                   PIC X(6).
  7842         16  CS-STATE                      PIC XX.
  7843         16  CS-ACCOUNT                    PIC X(10).
  7844         16  CS-CERT-EFF-DT                PIC XX.
  7845         16  CS-CERT-NO.
  7846             20  CS-CERT-PRIME             PIC X(10).
  7847             20  CS-CERT-SFX               PIC X.
  7848         16  CS-TRAILER-TYPE               PIC X.
  7849             88  COMM-TRLR           VALUE 'A'.
  7850             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7851             88  CERT-DATA-TRLR      VALUE 'C'.
  7852
  7853     12  CS-DATA-AREA                      PIC X(516).
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 147
* EL6311.cbl
  7854
  7855     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7856         16  CS-BANK-COMMISSION-AREA.
  7857             20  CS-BANK-COMMS       OCCURS 10.
  7858                 24  CS-AGT                PIC X(10).
  7859                 24  CS-COM-TYP            PIC X.
  7860                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7861                 24  CS-RECALC-LV-INDIC    PIC X.
  7862                 24  FILLER                PIC X(10).
  7863         16  FILLER                        PIC X(256).
  7864
  7865     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7866****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7867****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  7868         16  CS-MB-CLAIM-DATA OCCURS 2.
  7869             20  FILLER OCCURS 10.
  7870                 24  CS-CLAIM-TYPE         PIC X.
  7871                     88  CS-AH-CLM           VALUE 'A'.
  7872                     88  CS-IU-CLM           VALUE 'I'.
  7873                     88  CS-GP-CLM           VALUE 'G'.
  7874                     88  CS-LF-CLM           VALUE 'L'.
  7875                     88  CS-PR-CLM           VALUE 'P'.
  7876                 24  CS-BANK               PIC S999 COMP-3.
  7877                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  7878                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  7879                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  7880         16  FILLER                        PIC X(216).
  7881     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7882         16  CS-VIN-NUMBER                 PIC X(17).
  7883         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7884         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7885         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7886         16  FILLER                        PIC X(496).
  7887******************************************************************
  7888
  7889 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  7890                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  7891                          PENDING-MAILING-DATA MAILING-DATA
  7892                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  7893                          PENDING-PAY-ADJ CERT-NOTE-FILE
  7894                          CLAIM-MASTER ENDORSEMENT-RECORD
  7895                          CERTIFICATE-TRAILERS.
  7896 0000-DFHEXIT SECTION.
  7897     MOVE '9#                    $   ' TO DFHEIV0.
  7898     MOVE 'EL6311' TO DFHEIV1.
  7899     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7900
  7901     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7902     MOVE EIBTRMID               TO QID-TERM.
  7903     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  7904     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7905     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7906     MOVE 2                      TO EMI-SWITCH2.
  7907
  7908     IF EIBCALEN = 0
  7909         GO TO 8800-UNAUTHORIZED-ACCESS.
  7910
  7911     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 148
* EL6311.cbl
  7912     MOVE '5'                   TO DC-OPTION-CODE.
  7913     PERFORM 9700-DATE-LINK.
  7914     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  7915     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  7916
  7917     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  7918     MOVE SPACE                  TO DC-OPTION-CODE.
  7919     PERFORM 9700-DATE-LINK.
  7920     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  7921     MOVE LOW-VALUES             TO EL631BI.
  7922
  7923
  7924* EXEC CICS HANDLE CONDITION
  7925*        PGMIDERR  (9600-PGMID-ERROR)
  7926*        ERROR     (9990-ABEND)
  7927*        INVREQ    (9990-ABEND)
  7928*        QIDERR    (0010-MAIN-LOGIC)
  7929*    END-EXEC.
  7930*    MOVE '"$L.8N                ! " #00007919' TO DFHEIV0
  7931     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  7932     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7933     MOVE X'2220233030303037393139' TO DFHEIV0(25:11)
  7934     CALL 'kxdfhei1' USING DFHEIV0
  7935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7936
  7937
  7938     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7939         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7940             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7941             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  7942             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7943             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7944             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7945             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7946             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7947             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7948
  7949             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  7950                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  7951
  7952             ELSE
  7953                 NEXT SENTENCE
  7954
  7955         ELSE
  7956             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  7957             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7958             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7959             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7960             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7961             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7962             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7963             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7964             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7965             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  7966             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  7967             GO TO 3900-RE-DISPLAY-RECORD
  7968     ELSE
  7969         GO TO 0020-MAIN-LOGIC.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 149
* EL6311.cbl
  7970
  7971 0010-MAIN-LOGIC.
  7972     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  7973                                    WS-FIRST-ENTRY-SW.
  7974
  7975     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  7976
  7977     MOVE LOW-VALUES             TO EC-NEW-CERT
  7978                                    EC-NEW-STATE.
  7979
  7980     IF PI-DISPLAY-ORIGINAL-BATCH
  7981         NEXT SENTENCE
  7982     ELSE
  7983         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  7984             GO TO 5000-BROWSE-BATCH-HEADERS.
  7985
  7986     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  7987         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  7988
  7989     IF PI-CSR-BROWSE
  7990        GO TO 4200-BROWSE-CSR-FORWARD.
  7991
  7992     IF PI-FILE-BROWSE
  7993         GO TO 4300-BROWSE-FILE-FORWARD.
  7994
  7995     GO TO 4000-BROWSE-DETAIL-FORWARD.
  7996
  7997 0020-MAIN-LOGIC.
  7998     IF EIBAID = DFHCLEAR
  7999         GO TO 9400-CLEAR.
  8000
  8001     MOVE LOW-VALUES             TO EC-NEW-CERT
  8002                                    EC-NEW-STATE.
  8003
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 150
* EL6311.cbl
  8005
  8006******************************************************************
  8007*                                                                *
  8008*              R E C E I V E   M A P                             *
  8009*                                                                *
  8010******************************************************************
  8011
  8012 0200-RECEIVE.
  8013     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8014         MOVE ER-0008            TO EMI-ERROR
  8015         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8016         IF PI-MAP-NAME = EL631B
  8017             MOVE -1                 TO BMAINTL
  8018             GO TO 8200-SEND-DATAONLY
  8019         ELSE
  8020             IF PI-MAP-NAME = EL631C
  8021                 MOVE -1                 TO CMAINTL
  8022                 GO TO 8200-SEND-DATAONLY
  8023             ELSE
  8024                 IF PI-MAP-NAME = EL631D
  8025                     MOVE -1                 TO DPFENTRL
  8026                     GO TO 8200-SEND-DATAONLY.
  8027
  8028
  8029* EXEC CICS RECEIVE
  8030*        MAP      (PI-MAP-NAME)
  8031*        MAPSET   (MAPSET-EL6311S)
  8032*        INTO     (EL631BI)
  8033*    END-EXEC.
  8034     MOVE LENGTH OF
  8035      EL631BI
  8036       TO DFHEIV11
  8037*    MOVE '8"T I  L              ''   #00008016' TO DFHEIV0
  8038     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8039     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8040     MOVE X'2020233030303038303136' TO DFHEIV0(25:11)
  8041     CALL 'kxdfhei1' USING DFHEIV0,
  8042           PI-MAP-NAME,
  8043           EL631BI,
  8044           DFHEIV11,
  8045           MAPSET-EL6311S,
  8046           DFHEIV99,
  8047           DFHEIV99
  8048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8049
  8050
  8051******************************************************************
  8052*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8053******************************************************************
  8054
  8055     IF BTYPE-LEN (1) EQUAL +3
  8056        IF BTYPE (1) EQUAL ALL ' '
  8057            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8058
  8059     IF BTYPE-LEN (2) EQUAL +3
  8060        IF BTYPE (2) EQUAL ALL ' '
  8061            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8062
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 151
* EL6311.cbl
  8063     INSPECT EL631BI CONVERTING '_' TO ' '.
  8064
  8065     IF PI-MAP-NAME = EL631B
  8066         IF BPFENTRL GREATER THAN ZEROS
  8067             IF EIBAID NOT = DFHENTER
  8068                 MOVE ER-0004       TO EMI-ERROR
  8069                 MOVE -1            TO BPFENTRL
  8070                 MOVE AL-UNBOF      TO BPFENTRA
  8071                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8072                 GO TO 8200-SEND-DATAONLY
  8073             ELSE
  8074                 IF BPFENTRI NUMERIC AND
  8075                   (BPFENTRI GREATER 0 AND LESS 25)
  8076                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8077                 ELSE
  8078                     MOVE ER-0029  TO EMI-ERROR
  8079                     MOVE AL-UNBON TO BPFENTRA
  8080                     MOVE -1       TO BPFENTRL
  8081                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8082                     GO TO 8200-SEND-DATAONLY
  8083         ELSE
  8084             NEXT SENTENCE
  8085     ELSE
  8086         IF PI-MAP-NAME = EL631C
  8087            IF CPFENTRL GREATER THAN ZEROS
  8088                IF EIBAID NOT = DFHENTER
  8089                 MOVE ER-0004         TO EMI-ERROR
  8090                 MOVE -1              TO CPFENTRL
  8091                 MOVE AL-UNBOF        TO CPFENTRA
  8092                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8093                 GO TO 8200-SEND-DATAONLY
  8094             ELSE
  8095                 IF CPFENTRI NUMERIC AND
  8096                   (CPFENTRI GREATER 0 AND LESS 25)
  8097                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8098                 ELSE
  8099                     MOVE ER-0029      TO EMI-ERROR
  8100                     MOVE AL-UNBON     TO CPFENTRA
  8101                     MOVE -1           TO CPFENTRL
  8102                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8103                     GO TO 8200-SEND-DATAONLY
  8104         ELSE
  8105             NEXT SENTENCE
  8106     ELSE
  8107     IF PI-MAP-NAME = EL631D
  8108         IF DPFENTRL GREATER THAN ZEROS
  8109             IF EIBAID NOT = DFHENTER
  8110                 MOVE ER-0004         TO EMI-ERROR
  8111                 MOVE -1              TO DPFENTRL
  8112                 MOVE AL-UNBOF        TO DPFENTRA
  8113                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8114                 GO TO 8200-SEND-DATAONLY
  8115             ELSE
  8116                 IF DPFENTRI NUMERIC AND
  8117                   (DPFENTRI GREATER 0 AND LESS 25)
  8118                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8119                 ELSE
  8120                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 152
* EL6311.cbl
  8121                     MOVE AL-UNBON     TO DPFENTRA
  8122                     MOVE -1           TO DPFENTRL
  8123                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8124                     GO TO 8200-SEND-DATAONLY.
  8125
  8126     IF EIBAID = DFHPF23
  8127         GO TO 8810-PF23.
  8128
  8129     IF EIBAID = DFHPF24
  8130         GO TO 9200-RETURN-MAIN-MENU.
  8131
  8132     IF EIBAID = DFHPF12
  8133         GO TO 9500-PF12.
  8134
  8135     IF PI-MAP-NAME = EL631B
  8136        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8137
  8138     IF PI-MAP-NAME = EL631C
  8139        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8140
  8141     IF PI-MAP-NAME = EL631D
  8142        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8143
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 153
* EL6311.cbl
  8145
  8146******************************************************************
  8147*                                                                *
  8148*      ISSUE SCREEN PF KEY CHECKING                              *
  8149*                                                                *
  8150******************************************************************
  8151
  8152******************************************************************
  8153*                                                                *
  8154*      PF KEY FUNCTIONS:                                         *
  8155*                                                                *
  8156*      PF1  = BROWSE FORWARD                                     *
  8157*      PF2  = BROWSE BACKWARD                                    *
  8158*      PF3  = CERTIFICATE LOOKUP                                 *
  8159*      PF4  = DISPLAY BATCH HEADER                               *
  8160*      PF5  = ADD ISSUE  SCREEN                                  *
  8161*      PF6  = ADD CANCEL SCREEN                                  *
  8162*      PF7  = CERTIFICATE DISPLAY                                *
  8163*      PF8  = CERTIFICATE NOTES                                  *
  8164*      PF9  = EDIT CONTROL                                       *
  8165*      PF10 = DISPLAY LETTER SCREEN                              *
  8166*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8167*      PF12 = HELP SCREEN                                        *
  8168*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8169*      PF14 = ACCOUNT MASTER                                     *
  8170*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8171*      PF16 = DISPLAY LETTER REVIEW                              *
  8172*                                                                *
  8173******************************************************************
  8174
  8175 0300-CHECK-ISSUE-PF-KEYS.
  8176     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8177        MOVE ER-2337            TO EMI-ERROR
  8178        MOVE -1                  TO BMAINTL
  8179        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8180        GO TO 8200-SEND-DATAONLY.
  8181
  8182     IF EIBAID = DFHPF1
  8183        MOVE '0'                TO PI-EDIT-SW
  8184        IF PI-PRIMARY-BROWSE
  8185           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8186        ELSE
  8187           IF PI-PRIMARY-WITH-SELECT
  8188              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8189           ELSE
  8190              IF PI-FILE-BROWSE
  8191                 GO TO 4300-BROWSE-FILE-FORWARD
  8192              ELSE
  8193                 IF PI-CSR-BROWSE
  8194                    GO TO 4200-BROWSE-CSR-FORWARD
  8195                 ELSE
  8196                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8197
  8198     IF EIBAID = DFHPF2
  8199        MOVE '0'                TO PI-EDIT-SW
  8200        IF PI-PRIMARY-BROWSE
  8201           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8202        ELSE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 154
* EL6311.cbl
  8203           IF PI-PRIMARY-WITH-SELECT
  8204              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8205           ELSE
  8206              IF PI-FILE-BROWSE
  8207                 GO TO 4800-BROWSE-FILE-BACKWARD
  8208              ELSE
  8209                 IF PI-CSR-BROWSE
  8210                    GO TO 4900-BROWSE-CSR-BACKWARD
  8211                 ELSE
  8212                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8213
  8214     IF EIBAID = DFHPF3
  8215        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8216        MOVE XCTL-EL127         TO PGM-NAME
  8217        GO TO 9300-XCTL.
  8218
  8219     IF (EIBAID = DFHPF15 OR DFHPF6)
  8220        AND (CSR-EDIT-SESSION)
  8221*       AND (FATAL-OR-UNFORCED)
  8222        AND (FATAL-ERRORS)
  8223        MOVE ER-1819             TO EMI-ERROR
  8224        MOVE -1                  TO BMAINTL
  8225        MOVE AL-UANON            TO BMAINTA
  8226        PERFORM 9900-ERROR-FORMAT
  8227                                 THRU 9900-EXIT
  8228        GO TO 8200-SEND-DATAONLY
  8229     END-IF
  8230     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8231      OR (EIBAID = DFHPF10)
  8232        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8233        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8234        IF (RESP-NORMAL)
  8235           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8236              AM-CONTROL-PRIMARY (1:20))
  8237            IF AM-NAME NOT GREATER THAN SPACES OR
  8238               AM-ADDRS NOT GREATER THAN SPACES  OR
  8239               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8240               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8241               AM-ZIP NOT GREATER THAN SPACES
  8242               MOVE ER-3834             TO EMI-ERROR
  8243               MOVE -1                  TO BMAINTL
  8244               MOVE AL-UANON            TO BMAINTA
  8245               PERFORM 9900-ERROR-FORMAT
  8246                                 THRU 9900-EXIT
  8247               GO TO 8200-SEND-DATAONLY
  8248            END-IF
  8249        ELSE
  8250           MOVE ER-1609             TO EMI-ERROR
  8251           MOVE -1                  TO BMAINTL
  8252           MOVE AL-UANON            TO BMAINTA
  8253           PERFORM 9900-ERROR-FORMAT
  8254                                THRU 9900-EXIT
  8255           GO TO 8200-SEND-DATAONLY
  8256        END-IF
  8257
  8258        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8259        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8260        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 155
* EL6311.cbl
  8261            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8262               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8263               MA-CITY NOT GREATER THAN SPACES OR
  8264               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8265               MA-ZIP-CODE NOT GREATER THAN SPACES
  8266               MOVE ER-3835             TO EMI-ERROR
  8267               MOVE -1                  TO BMAINTL
  8268               MOVE AL-UANON            TO BMAINTA
  8269               PERFORM 9900-ERROR-FORMAT
  8270                                 THRU 9900-EXIT
  8271               GO TO 8200-SEND-DATAONLY
  8272            END-IF
  8273        ELSE
  8274           MOVE ER-3000             TO EMI-ERROR
  8275           MOVE -1                  TO BMAINTL
  8276           MOVE AL-UANON            TO BMAINTA
  8277           PERFORM 9900-ERROR-FORMAT
  8278                                THRU 9900-EXIT
  8279           GO TO 8200-SEND-DATAONLY
  8280        END-IF
  8281
  8282     END-IF
  8283     IF (EIBAID = DFHPF15)
  8284        AND (CSR-EDIT-SESSION)
  8285        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8286        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8287        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8288        MOVE PI-SV-STATE         TO PI-STATE
  8289        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8290        MOVE BCERTNOI            TO PI-CERT-PRIME
  8291        MOVE BSUFIXI             TO PI-CERT-SFX
  8292        MOVE BEFFDTI             TO DEEDIT-FIELD
  8293        PERFORM 8600-DEEDIT
  8294        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8295        MOVE '4'                 TO DC-OPTION-CODE
  8296        PERFORM 9700-DATE-LINK
  8297        IF DATE-CONVERSION-ERROR
  8298           MOVE ER-0348          TO EMI-ERROR
  8299           MOVE -1               TO BEFFDTL
  8300           MOVE AL-UABON         TO BEFFDTA
  8301           PERFORM 9900-ERROR-FORMAT
  8302                                 THRU 9900-EXIT
  8303           GO TO 8200-SEND-DATAONLY
  8304        ELSE
  8305           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8306           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8307           MOVE XCTL-EL6315      TO PGM-NAME
  8308           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8309           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8310           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8311           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8312           GO TO 9300-XCTL
  8313        END-IF
  8314     END-IF
  8315
  8316     IF EIBAID = DFHPF4
  8317        MOVE '0'                TO PI-EDIT-SW
  8318        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 156
* EL6311.cbl
  8319           NEXT SENTENCE
  8320        ELSE
  8321           GO TO 7200-DISPLAY-BATCHES.
  8322
  8323     IF EIBAID = DFHPF5
  8324        MOVE ER-0029                TO EMI-ERROR
  8325        MOVE -1                     TO BPFENTRL
  8326        MOVE AL-UNBON               TO BPFENTRA
  8327        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8328        GO TO 8200-SEND-DATAONLY.
  8329*        MOVE '0'                TO PI-EDIT-SW
  8330*        IF PI-DISPLAY-ORIGINAL-BATCH
  8331*           NEXT SENTENCE
  8332*        ELSE
  8333*           MOVE EL631B              TO PI-MAP-NAME
  8334*           MOVE LOW-VALUES          TO EL631BI
  8335*           MOVE 'A'                 TO BMAINTO
  8336*           MOVE AL-UANON            TO BMAINTA
  8337*           MOVE -1                  TO BMAINTL
  8338*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8339*           GO TO 8100-SEND-INITIAL-MAP.
  8340
  8341     IF EIBAID = DFHPF6
  8342        IF NOT CSR-EDIT-SESSION
  8343           MOVE ER-0029                TO EMI-ERROR
  8344           MOVE -1                     TO BPFENTRL
  8345           MOVE AL-UNBON               TO BPFENTRA
  8346           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8347           GO TO 8200-SEND-DATAONLY
  8348*           MOVE '0'              TO PI-EDIT-SW
  8349*           IF PI-DISPLAY-ORIGINAL-BATCH
  8350*              NEXT SENTENCE
  8351*           ELSE
  8352*              MOVE EL631C        TO PI-MAP-NAME
  8353*              MOVE LOW-VALUES    TO EL631CI
  8354*              MOVE 'A'           TO CMAINTO
  8355*              MOVE AL-UANON      TO CMAINTA
  8356*              MOVE -1            TO CMAINTL
  8357*              MOVE '6'           TO PI-MAINT-FUNCTION
  8358*              GO TO 8100-SEND-INITIAL-MAP
  8359*           END-IF
  8360        ELSE
  8361           PERFORM 5100-PROCESS-POL-RESC
  8362                                 THRU 5100-EXIT
  8363           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8364           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8365                                    PI-PREV-SEQ-NO
  8366           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8367*                                    WS-CANCEL-LETTER-SW
  8368                                    PI-ALL-ISSUES-SW
  8369                                    PI-ALL-CANCELS-SW
  8370           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8371        END-IF
  8372     END-IF
  8373     IF EIBAID = DFHPF7
  8374        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8375        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8376        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 157
* EL6311.cbl
  8377        MOVE PI-SV-STATE            TO PI-STATE
  8378        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8379        MOVE BCERTNOI               TO PI-CERT-PRIME
  8380        MOVE BSUFIXI                TO PI-CERT-SFX
  8381        MOVE BEFFDTI                TO DEEDIT-FIELD
  8382        PERFORM 8600-DEEDIT
  8383        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8384        MOVE '4'                    TO DC-OPTION-CODE
  8385        PERFORM 9700-DATE-LINK
  8386        IF DATE-CONVERSION-ERROR
  8387           MOVE ER-0348            TO EMI-ERROR
  8388           MOVE -1                  TO BEFFDTL
  8389           MOVE AL-UABON            TO BEFFDTA
  8390           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8391           GO TO 8200-SEND-DATAONLY
  8392        ELSE
  8393           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8394           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8395           MOVE XCTL-EL1273        TO PGM-NAME
  8396           GO TO 9300-XCTL.
  8397
  8398     IF EIBAID = DFHPF8
  8399        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8400        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8401        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8402        MOVE PI-SV-STATE            TO PI-STATE
  8403        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8404        MOVE BCERTNOI               TO PI-CERT-PRIME
  8405        MOVE BSUFIXI                TO PI-CERT-SFX
  8406        MOVE BEFFDTI                TO DEEDIT-FIELD
  8407        PERFORM 8600-DEEDIT
  8408        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8409        MOVE '4'                    TO DC-OPTION-CODE
  8410        PERFORM 9700-DATE-LINK
  8411        IF DATE-CONVERSION-ERROR
  8412           MOVE ER-0348            TO EMI-ERROR
  8413           MOVE -1                  TO BEFFDTL
  8414           MOVE AL-UABON            TO BEFFDTA
  8415           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8416           GO TO 8200-SEND-DATAONLY
  8417        ELSE
  8418           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8419           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8420           IF PI-COMPANY-ID = 'DMD'
  8421               MOVE XCTL-EL401DMD      TO PGM-NAME
  8422             ELSE
  8423               MOVE XCTL-EL1279        TO PGM-NAME
  8424           END-IF
  8425           GO TO 9300-XCTL.
  8426
  8427     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8428        MOVE XCTL-EL6312         TO PGM-NAME
  8429
  8430* EXEC CICS XCTL
  8431*           PROGRAM   (PGM-NAME)
  8432*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8433*           LENGTH    (WS-COMM-LENGTH)
  8434*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 158
* EL6311.cbl
  8435*    MOVE '.$C                   %   #00008400' TO DFHEIV0
  8436     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8437     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8438     MOVE X'2020233030303038343030' TO DFHEIV0(25:11)
  8439     CALL 'kxdfhei1' USING DFHEIV0,
  8440           PGM-NAME,
  8441           PROGRAM-INTERFACE-BLOCK,
  8442           WS-COMM-LENGTH,
  8443           DFHEIV99
  8444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8445     ELSE
  8446        MOVE '0'                 TO  PI-EDIT-SW.
  8447
  8448     IF  EIBAID = DFHPF10
  8449         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8450         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8451         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8452                                    PI-1042-WA
  8453         MOVE 4                  TO PI-689-DATA-SOURCE
  8454         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8455         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8456         MOVE PI-SV-STATE        TO PI-689-STATE
  8457         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8458         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8459         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8460         MOVE PI-PB-ALT-CHG-SEQ-NO
  8461                                 TO PI-689-ALT-SEQ-NO
  8462         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8463         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8464         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8465         MOVE +0                 TO PI-689-CONTROL
  8466         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8467                                    PI-689-EXP-DATE
  8468                                    PI-689-RESP-PERSON
  8469                                    PI-689-TYPE
  8470                                    PI-689-FOLLOW-UP-EDIT
  8471                                    PI-689-RESEND1-EDIT
  8472                                    PI-689-SEQ-EDIT
  8473                                    PI-689-BCSEQ-EDIT
  8474                                    PI-689-LBL-OVERRIDE
  8475         MOVE W-LETTER-COMMUNICATION-AREAS
  8476                                 TO PI-PROGRAM-WORK-AREA
  8477         MOVE XCTL-EL689         TO PGM-NAME
  8478         GO TO 9300-XCTL.
  8479
  8480     IF  EIBAID = DFHPF16
  8481         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8482         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8483         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8484                                    PI-1042-WA
  8485         MOVE 4                  TO PI-689-DATA-SOURCE
  8486         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8487         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8488         MOVE PI-SV-STATE        TO PI-689-STATE
  8489         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8490         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8491         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8492         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 159
* EL6311.cbl
  8493                                 TO PI-689-ALT-SEQ-NO
  8494         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8495         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8496         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8497         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8498         MOVE W-LETTER-COMMUNICATION-AREAS
  8499                                 TO PI-PROGRAM-WORK-AREA
  8500         MOVE XCTL-EL690         TO PGM-NAME
  8501         GO TO 9300-XCTL.
  8502
  8503     IF EIBAID = DFHPF13
  8504         MOVE XCTL-EL6313        TO PGM-NAME
  8505         GO TO 9300-XCTL.
  8506
  8507     IF EIBAID = DFHPF17
  8508        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8509        IF (PB-I-LOAN-APR > ZEROS)
  8510           AND (PB-I-BENEFICIARY-NAME NOT
  8511              = SPACES AND LOW-VALUES)
  8512
  8513           MOVE LINK-ELVADS          TO PGM-NAME
  8514
  8515* EXEC CICS LINK
  8516*              PROGRAM    (PGM-NAME)
  8517*              COMMAREA   (WS-PASS-AREA)
  8518*              LENGTH     (WS-PASS-AREA-LENGTH)
  8519*          END-EXEC
  8520*    MOVE '."C                   (   #00008474' TO DFHEIV0
  8521     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8522     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8523     MOVE X'2020233030303038343734' TO DFHEIV0(25:11)
  8524     CALL 'kxdfhei1' USING DFHEIV0,
  8525           PGM-NAME,
  8526           WS-PASS-AREA,
  8527           WS-PASS-AREA-LENGTH,
  8528           DFHEIV99,
  8529           DFHEIV99,
  8530           DFHEIV99,
  8531           DFHEIV99
  8532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8533
  8534           MOVE 0000             TO EMI-ERROR
  8535           MOVE -1               TO BMAINTL
  8536           PERFORM 9900-ERROR-FORMAT
  8537                                 THRU 9900-EXIT
  8538           GO TO 8200-SEND-DATAONLY
  8539        ELSE
  8540           MOVE ER-0877            TO EMI-ERROR
  8541           MOVE -1                  TO BEFFDTL
  8542           MOVE AL-UABON            TO BEFFDTA
  8543           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8544           GO TO 8200-SEND-DATAONLY
  8545        END-IF
  8546     END-IF
  8547     IF EIBAID = DFHPF14
  8548        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8549        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  8550        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 160
* EL6311.cbl
  8551        MOVE PI-SV-STATE            TO PI-CR-STATE
  8552        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8553        MOVE SPACE                  TO PI-EDIT-SW
  8554        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8555        MOVE XCTL-EL650             TO PGM-NAME
  8556        GO TO 9300-XCTL.
  8557
  8558     IF EIBAID = DFHPF15
  8559        IF PI-COMPANY-ID  =  'HER'
  8560            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8561            MOVE XCTL-EL680         TO PGM-NAME
  8562            GO TO 9300-XCTL.
  8563
  8564     IF EIBAID = DFHENTER OR DFHPF11
  8565        GO TO 1000-ISSUE-MAINLINE.
  8566
  8567     MOVE ER-0029                TO EMI-ERROR
  8568     MOVE -1                     TO BPFENTRL
  8569     MOVE AL-UNBON               TO BPFENTRA
  8570     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8571     GO TO 8200-SEND-DATAONLY.
  8572
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 161
* EL6311.cbl
  8574
  8575******************************************************************
  8576*                                                                *
  8577*      CANCEL SCREEN PF KEY CHECKING                             *
  8578*                                                                *
  8579******************************************************************
  8580
  8581******************************************************************
  8582*                                                                *
  8583*      PF KEY FUNCTIONS:                                         *
  8584*                                                                *
  8585*      PF1  = BROWSE FORWARD                                     *
  8586*      PF2  = BROWSE BACKWARD                                    *
  8587*      PF3  = CERTIFICATE LOOKUP                                 *
  8588*      PF4  = DISPLAY BATCH HEADER                               *
  8589*      PF5  = ADD ISSUE SCREEN                                   *
  8590*      PF6  = ADD CANCEL SCREEN                                  *
  8591*      PF7  = CERTIFICATE DISPLAY                                *
  8592*      PF8  = CERTIFICATE NOTES                                  *
  8593*      PF9  = EDIT CONTROL                                       *
  8594*      PF10 = DISPLAY LETTER SCREEN                              *
  8595*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8596*      PF12 = DISPLAY HELP SCREEN                                *
  8597*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8598*      PF14 = ACCOUNT MASTER                                     *
  8599*      PF16 = LETTER REVIEW                                      *
  8600*                                                                *
  8601******************************************************************
  8602
  8603 0400-CHECK-CANCEL-PF-KEYS.
  8604     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8605        MOVE ER-2337             TO EMI-ERROR
  8606        MOVE -1                  TO CMAINTL
  8607        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8608        GO TO 8200-SEND-DATAONLY.
  8609
  8610     IF EIBAID = DFHPF1
  8611        MOVE '0'                TO PI-EDIT-SW
  8612        IF PI-PRIMARY-BROWSE
  8613           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8614        ELSE
  8615           IF PI-PRIMARY-WITH-SELECT
  8616              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8617           ELSE
  8618              IF PI-FILE-BROWSE
  8619                 GO TO 4300-BROWSE-FILE-FORWARD
  8620              ELSE
  8621                 IF PI-CSR-BROWSE
  8622                    GO TO 4200-BROWSE-CSR-FORWARD
  8623                 ELSE
  8624                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8625
  8626     IF EIBAID = DFHPF2
  8627        MOVE '0'                TO PI-EDIT-SW
  8628        IF PI-PRIMARY-BROWSE
  8629           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8630        ELSE
  8631           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 162
* EL6311.cbl
  8632              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8633           ELSE
  8634              IF PI-FILE-BROWSE
  8635                 GO TO 4800-BROWSE-FILE-BACKWARD
  8636              ELSE
  8637                 IF PI-CSR-BROWSE
  8638                    GO TO 4900-BROWSE-CSR-BACKWARD
  8639                 ELSE
  8640                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8641
  8642     IF EIBAID = DFHPF3
  8643        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8644        MOVE XCTL-EL127         TO PGM-NAME
  8645        GO TO 9300-XCTL.
  8646
  8647     IF (EIBAID = DFHPF15 OR DFHPF17)
  8648        AND (CSR-EDIT-SESSION)
  8649*       AND (FATAL-OR-UNFORCED)
  8650        AND (FATAL-ERRORS)
  8651        MOVE ER-1819             TO EMI-ERROR
  8652        MOVE -1                  TO CMAINTL
  8653        MOVE AL-UANON            TO CMAINTA
  8654        PERFORM 9900-ERROR-FORMAT
  8655                                 THRU 9900-EXIT
  8656        GO TO 8200-SEND-DATAONLY
  8657     END-IF
  8658     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8659       AND (CSR-EDIT-SESSION)
  8660        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8661        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8662        IF (RESP-NORMAL)
  8663           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8664              AM-CONTROL-PRIMARY (1:20))
  8665            IF AM-NAME NOT GREATER THAN SPACES OR
  8666               AM-ADDRS NOT GREATER THAN SPACES  OR
  8667               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8668               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8669               AM-ZIP NOT GREATER THAN SPACES
  8670               MOVE ER-3834             TO EMI-ERROR
  8671               MOVE -1                  TO BMAINTL
  8672               MOVE AL-UANON            TO BMAINTA
  8673               PERFORM 9900-ERROR-FORMAT
  8674                                 THRU 9900-EXIT
  8675               GO TO 8200-SEND-DATAONLY
  8676            END-IF
  8677        ELSE
  8678           MOVE ER-1609             TO EMI-ERROR
  8679           MOVE -1                  TO BMAINTL
  8680           MOVE AL-UANON            TO BMAINTA
  8681           PERFORM 9900-ERROR-FORMAT
  8682                                THRU 9900-EXIT
  8683           GO TO 8200-SEND-DATAONLY
  8684        END-IF
  8685
  8686        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8687        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8688        IF (ERMAIL-FOUND)
  8689            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 163
* EL6311.cbl
  8690               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8691               MA-CITY NOT GREATER THAN SPACES OR
  8692               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8693               MA-ZIP-CODE NOT GREATER THAN SPACES
  8694               MOVE ER-3835             TO EMI-ERROR
  8695               MOVE -1                  TO BMAINTL
  8696               MOVE AL-UANON            TO BMAINTA
  8697               PERFORM 9900-ERROR-FORMAT
  8698                                 THRU 9900-EXIT
  8699               GO TO 8200-SEND-DATAONLY
  8700            END-IF
  8701        ELSE
  8702           MOVE ER-3000             TO EMI-ERROR
  8703           MOVE -1                  TO BMAINTL
  8704           MOVE AL-UANON            TO BMAINTA
  8705           PERFORM 9900-ERROR-FORMAT
  8706                                THRU 9900-EXIT
  8707           GO TO 8200-SEND-DATAONLY
  8708        END-IF
  8709
  8710     END-IF
  8711     IF (EIBAID = DFHPF15 OR DFHPF17)
  8712        AND (CSR-EDIT-SESSION)
  8713        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8714        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8715        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8716        MOVE PI-SV-STATE         TO PI-STATE
  8717        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8718        MOVE CCERTNOI            TO PI-CERT-PRIME
  8719        MOVE CSUFIXI             TO PI-CERT-SFX
  8720        MOVE CEFFDTI             TO DEEDIT-FIELD
  8721        PERFORM 8600-DEEDIT
  8722        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8723        MOVE '4'                 TO DC-OPTION-CODE
  8724        PERFORM 9700-DATE-LINK
  8725        IF DATE-CONVERSION-ERROR
  8726           MOVE ER-0348          TO EMI-ERROR
  8727           MOVE -1               TO CEFFDTL
  8728           MOVE AL-UABON         TO CEFFDTA
  8729           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8730           GO TO 8200-SEND-DATAONLY
  8731        ELSE
  8732           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8733           PERFORM 6000-CREATE-TEMP-STORAGE
  8734                                 THRU 6000-EXIT
  8735           IF EIBAID = DFHPF17
  8736               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  8737                                  THRU 6400-EXIT
  8738               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  8739                                 '2' AND '3' AND '4'
  8740                  MOVE ER-3831     TO  EMI-ERROR
  8741                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8742                  GO TO 8200-SEND-DATAONLY
  8743               END-IF
  8744               MOVE 'Y'          TO PI-CLM-RESC-IND
  8745           ELSE
  8746               MOVE 'N'          TO PI-CLM-RESC-IND
  8747           END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 164
* EL6311.cbl
  8748           MOVE XCTL-EL6316      TO PGM-NAME
  8749           MOVE '2'              TO PI-ISS-CAN-SW
  8750           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  8751           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8752           GO TO 9300-XCTL
  8753        END-IF
  8754     END-IF
  8755
  8756     IF EIBAID = DFHPF4
  8757        MOVE '0'                TO PI-EDIT-SW
  8758        IF PI-DISPLAY-ORIGINAL-BATCH
  8759           NEXT SENTENCE
  8760        ELSE
  8761           GO TO 7200-DISPLAY-BATCHES.
  8762
  8763     IF EIBAID = DFHPF5
  8764        MOVE ER-0029                TO EMI-ERROR
  8765        MOVE -1                     TO BPFENTRL
  8766        MOVE AL-UNBON               TO BPFENTRA
  8767        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8768        GO TO 8200-SEND-DATAONLY.
  8769*        MOVE '0'                TO PI-EDIT-SW
  8770*        IF PI-DISPLAY-ORIGINAL-BATCH
  8771*           NEXT SENTENCE
  8772*        ELSE
  8773*           MOVE EL631B              TO PI-MAP-NAME
  8774*           MOVE LOW-VALUES          TO EL631BI
  8775*           MOVE 'A'                 TO BMAINTO
  8776*           MOVE AL-UANON            TO BMAINTA
  8777*           MOVE -1                  TO BMAINTL
  8778*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8779*           GO TO 8100-SEND-INITIAL-MAP.
  8780
  8781     IF EIBAID = DFHPF6
  8782        MOVE ER-0029                TO EMI-ERROR
  8783        MOVE -1                     TO BPFENTRL
  8784        MOVE AL-UNBON               TO BPFENTRA
  8785        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8786        GO TO 8200-SEND-DATAONLY.
  8787*        MOVE '0'                TO PI-EDIT-SW
  8788*        IF PI-DISPLAY-ORIGINAL-BATCH
  8789*           NEXT SENTENCE
  8790*        ELSE
  8791*           MOVE EL631C              TO PI-MAP-NAME
  8792*           MOVE LOW-VALUES          TO EL631CI
  8793*           MOVE 'A'                 TO CMAINTO
  8794*           MOVE AL-UANON            TO CMAINTA
  8795*           MOVE -1                  TO CMAINTL
  8796*           MOVE '6'                 TO PI-MAINT-FUNCTION
  8797*           GO TO 8100-SEND-INITIAL-MAP.
  8798
  8799     IF EIBAID = DFHPF7
  8800        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8801        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8802        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8803        MOVE PI-SV-STATE            TO PI-STATE
  8804        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8805        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 165
* EL6311.cbl
  8806        MOVE CSUFIXI                TO PI-CERT-SFX
  8807        MOVE CEFFDTI                TO DEEDIT-FIELD
  8808        PERFORM 8600-DEEDIT
  8809        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8810        MOVE '4'                    TO DC-OPTION-CODE
  8811        PERFORM 9700-DATE-LINK
  8812        IF DATE-CONVERSION-ERROR
  8813           MOVE ER-0348            TO EMI-ERROR
  8814           MOVE -1                  TO BEFFDTL
  8815           MOVE AL-UABON            TO BEFFDTA
  8816           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8817           GO TO 8200-SEND-DATAONLY
  8818        ELSE
  8819           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8820           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8821           MOVE XCTL-EL1273        TO PGM-NAME
  8822           GO TO 9300-XCTL.
  8823
  8824     IF EIBAID = DFHPF8
  8825        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8826        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8827        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8828        MOVE PI-SV-STATE            TO PI-STATE
  8829        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8830        MOVE CCERTNOI               TO PI-CERT-PRIME
  8831        MOVE CSUFIXI                TO PI-CERT-SFX
  8832        MOVE CEFFDTI                TO DEEDIT-FIELD
  8833        PERFORM 8600-DEEDIT
  8834        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8835        MOVE '4'                    TO DC-OPTION-CODE
  8836        PERFORM 9700-DATE-LINK
  8837        IF DATE-CONVERSION-ERROR
  8838           MOVE ER-0348             TO EMI-ERROR
  8839           MOVE -1                  TO BEFFDTL
  8840           MOVE AL-UABON            TO BEFFDTA
  8841           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8842           GO TO 8200-SEND-DATAONLY
  8843        ELSE
  8844           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8845           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8846           IF PI-COMPANY-ID = 'DMD'
  8847               MOVE XCTL-EL401DMD      TO PGM-NAME
  8848             ELSE
  8849               MOVE XCTL-EL1279        TO PGM-NAME
  8850           END-IF
  8851           GO TO 9300-XCTL.
  8852
  8853     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8854        MOVE XCTL-EL6312     TO PGM-NAME
  8855
  8856* EXEC CICS XCTL
  8857*           PROGRAM  (PGM-NAME)
  8858*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  8859*           LENGTH   (WS-COMM-LENGTH)
  8860*       END-EXEC
  8861*    MOVE '.$C                   %   #00008801' TO DFHEIV0
  8862     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8863     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 166
* EL6311.cbl
  8864     MOVE X'2020233030303038383031' TO DFHEIV0(25:11)
  8865     CALL 'kxdfhei1' USING DFHEIV0,
  8866           PGM-NAME,
  8867           PROGRAM-INTERFACE-BLOCK,
  8868           WS-COMM-LENGTH,
  8869           DFHEIV99
  8870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8871     ELSE
  8872        MOVE '0'                 TO  PI-EDIT-SW.
  8873
  8874     IF EIBAID = DFHPF10
  8875         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8876         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  8877         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8878         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8879                                    PI-1042-WA
  8880         MOVE 4                  TO PI-689-DATA-SOURCE
  8881         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8882         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8883         MOVE PI-SV-STATE        TO PI-689-STATE
  8884         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8885         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8886         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8887         MOVE PI-PB-ALT-CHG-SEQ-NO
  8888                                 TO PI-689-ALT-SEQ-NO
  8889         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8890         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8891         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8892         MOVE +0                 TO PI-689-CONTROL
  8893         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8894                                    PI-689-EXP-DATE
  8895                                    PI-689-RESP-PERSON
  8896                                    PI-689-TYPE
  8897                                    PI-689-FOLLOW-UP-EDIT
  8898                                    PI-689-RESEND1-EDIT
  8899                                    PI-689-SEQ-EDIT
  8900                                    PI-689-BCSEQ-EDIT
  8901                                    PI-689-LBL-OVERRIDE
  8902         MOVE W-LETTER-COMMUNICATION-AREAS
  8903                                 TO PI-PROGRAM-WORK-AREA
  8904         MOVE XCTL-EL689         TO PGM-NAME
  8905         GO TO 9300-XCTL.
  8906
  8907     IF  EIBAID = DFHPF16
  8908         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8909         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8910         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8911                                    PI-1042-WA
  8912         MOVE 4                  TO PI-689-DATA-SOURCE
  8913         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8914         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8915         MOVE PI-SV-STATE        TO PI-689-STATE
  8916         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8917         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8918         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8919         MOVE PI-PB-ALT-CHG-SEQ-NO
  8920                                 TO PI-689-ALT-SEQ-NO
  8921         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 167
* EL6311.cbl
  8922         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8923         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8924         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8925         MOVE W-LETTER-COMMUNICATION-AREAS
  8926                                 TO PI-PROGRAM-WORK-AREA
  8927         MOVE XCTL-EL690         TO PGM-NAME
  8928         GO TO 9300-XCTL.
  8929
  8930     IF EIBAID = DFHPF13
  8931        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8932        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8933        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8934        MOVE PI-SV-STATE            TO PI-STATE
  8935        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8936        MOVE CCERTNOI               TO PI-CERT-PRIME
  8937        MOVE CSUFIXI                TO PI-CERT-SFX
  8938        MOVE CEFFDTI                TO DEEDIT-FIELD
  8939        PERFORM 8600-DEEDIT
  8940        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8941        MOVE '4'                    TO DC-OPTION-CODE
  8942        PERFORM 9700-DATE-LINK
  8943        IF DATE-CONVERSION-ERROR
  8944           MOVE ER-0348            TO EMI-ERROR
  8945           MOVE -1                  TO CEFFDTL
  8946           MOVE AL-UABON            TO CEFFDTA
  8947           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8948           GO TO 8200-SEND-DATAONLY
  8949        ELSE
  8950           MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  8951           MOVE AL-UANON            TO CEFFDTA
  8952           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8953           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8954           MOVE XCTL-EL677         TO PGM-NAME
  8955           GO TO 9300-XCTL.
  8956
  8957     IF EIBAID = DFHPF14
  8958        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8959        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  8960        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8961        MOVE PI-SV-STATE            TO PI-CR-STATE
  8962        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8963        MOVE SPACE                  TO PI-EDIT-SW
  8964        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8965        MOVE XCTL-EL650             TO PGM-NAME
  8966        GO TO 9300-XCTL.
  8967
  8968     IF EIBAID = DFHENTER OR DFHPF11
  8969        GO TO 2000-CANCEL-MAINLINE.
  8970
  8971     MOVE ER-0029                TO EMI-ERROR.
  8972     MOVE -1                     TO CPFENTRL.
  8973     MOVE AL-UNBON               TO CPFENTRA.
  8974     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8975     GO TO 8200-SEND-DATAONLY.
  8976
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 168
* EL6311.cbl
  8978
  8979******************************************************************
  8980*                                                                *
  8981*      BATCH SCREEN PF KEY CHECKING                              *
  8982*                                                                *
  8983******************************************************************
  8984
  8985******************************************************************
  8986*                                                                *
  8987*      PF KEY FUNCTIONS:                                         *
  8988*                                                                *
  8989*      PF1 = BROWSE FORWARD                                      *
  8990*      PF2 = BROWSE BACKWARD                                     *
  8991*      PF3 = DISPLAY PREMIUM TOTALS                              *
  8992*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  8993*                                                                *
  8994*                                                                *
  8995******************************************************************
  8996
  8997 0500-CHECK-BATCH-PF-KEYS.
  8998     IF EIBAID = DFHPF1
  8999        MOVE '0'                TO PI-EDIT-SW
  9000        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9001           GO TO 5000-BROWSE-BATCH-HEADERS
  9002        ELSE
  9003           IF PI-GOOD-BROWSE
  9004              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9005                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9006              ELSE
  9007                 IF PI-FILE-BROWSE
  9008                    GO TO 4300-BROWSE-FILE-FORWARD
  9009                 ELSE
  9010                    IF PI-CSR-BROWSE
  9011                       GO TO 4200-BROWSE-CSR-FORWARD
  9012                    ELSE
  9013                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9014           ELSE
  9015              GO TO 0800-BROWSE-ERROR.
  9016
  9017     IF EIBAID = DFHPF2
  9018        MOVE '0'                TO PI-EDIT-SW
  9019        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9020           GO TO 5500-BROWSE-BATCH-BACKWARD
  9021        ELSE
  9022           IF PI-GOOD-BROWSE
  9023              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9024                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9025              ELSE
  9026                 IF PI-FILE-BROWSE
  9027                    GO TO 4800-BROWSE-FILE-BACKWARD
  9028                 ELSE
  9029                    IF PI-CSR-BROWSE
  9030                       GO TO 4900-BROWSE-CSR-BACKWARD
  9031                    ELSE
  9032                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9033           ELSE
  9034              GO TO 0800-BROWSE-ERROR.
  9035
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 169
* EL6311.cbl
  9036     IF EIBAID = DFHPF3
  9037        GO TO 3000-BATCH-MAINLINE.
  9038
  9039     IF  EIBAID = DFHPF4
  9040        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9041        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9042        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9043        MOVE PI-SV-STATE            TO PI-CR-STATE
  9044        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9045                                       PI-CR-FIN-RESP
  9046        MOVE 'A'                    TO PI-CR-TYPE
  9047        MOVE SPACE                  TO PI-EDIT-SW
  9048        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9049        MOVE XCTL-EL640             TO PGM-NAME
  9050        GO TO 9300-XCTL.
  9051
  9052     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9053       AND
  9054        (EIBAID = DFHENTER)
  9055           GO TO 3500-EDIT-BATCH-DATA.
  9056
  9057     IF EIBAID = DFHENTER
  9058        GO TO 3500-EDIT-BATCH-DATA.
  9059
  9060     MOVE ER-0029             TO EMI-ERROR.
  9061     MOVE -1                  TO DPFENTRL.
  9062     MOVE AL-UNBON            TO DPFENTRA.
  9063     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9064     GO TO 8200-SEND-DATAONLY.
  9065
  9066 0800-BROWSE-ERROR.
  9067     MOVE ER-2258                TO EMI-ERROR.
  9068     MOVE -1                     TO DPFENTRL.
  9069     MOVE AL-UNBON               TO DPFENTRA.
  9070     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9071     GO TO 8200-SEND-DATAONLY.
  9072
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 170
* EL6311.cbl
  9074
  9075******************************************************************
  9076*                                                                *
  9077*                I S S U E   M A I N L I N E                     *
  9078*                                                                *
  9079******************************************************************
  9080
  9081 1000-ISSUE-MAINLINE.
  9082     IF PI-DISPLAY-ORIGINAL-BATCH
  9083        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9084           MOVE ER-0023             TO EMI-ERROR
  9085           MOVE -1                  TO BMAINTL
  9086           MOVE AL-UABON            TO BMAINTA
  9087           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9088           GO TO 8200-SEND-DATAONLY
  9089        ELSE
  9090           NEXT SENTENCE
  9091     ELSE
  9092        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9093           MOVE ER-0023             TO EMI-ERROR
  9094           MOVE -1                  TO BMAINTL
  9095           MOVE AL-UABON            TO BMAINTA
  9096           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9097           GO TO 8200-SEND-DATAONLY.
  9098
  9099     IF BMAINTI = 'S'
  9100        GO TO 1100-SHOW-REQUEST.
  9101
  9102     IF NOT MODIFY-CAP
  9103         MOVE 'UPDATE'       TO SM-READ
  9104         PERFORM 9995-SECURITY-VIOLATION
  9105         MOVE ER-0070        TO EMI-ERROR
  9106         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9107         GO TO 8100-SEND-INITIAL-MAP.
  9108
  9109     IF BMAINTL GREATER THAN ZEROS
  9110        IF PI-PF5-FUNCTION
  9111           IF BMAINTI NOT = 'A'
  9112              MOVE AL-UABON  TO BMAINTA
  9113              MOVE -1        TO BMAINTL
  9114              MOVE ER-2260   TO EMI-ERROR
  9115              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9116              GO TO 8200-SEND-DATAONLY.
  9117
  9118     IF BCERTNOL = ZEROS
  9119       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9120         NEXT SENTENCE
  9121     ELSE
  9122         IF BCERTNOL NOT = ZEROS
  9123             MOVE AL-UANON       TO BCERTNOA
  9124         ELSE
  9125             MOVE -1             TO BCERTNOL
  9126             MOVE  1             TO SET-CURSOR-SW
  9127             MOVE ER-2218        TO EMI-ERROR
  9128             MOVE AL-UABON       TO BCERTNOA
  9129             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9130
  9131     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 171
* EL6311.cbl
  9132         MOVE AL-UANON       TO BSUFIXA
  9133     ELSE
  9134         MOVE AL-SANOF       TO BSUFIXA.
  9135
  9136     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9137        NEXT SENTENCE
  9138     ELSE
  9139        IF BEFFDTL NOT = ZEROS
  9140           MOVE AL-UNNON             TO BEFFDTA
  9141           MOVE BEFFDTI              TO DEEDIT-FIELD
  9142           PERFORM 8600-DEEDIT
  9143           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9144           MOVE 4                    TO DC-OPTION-CODE
  9145           PERFORM 9700-DATE-LINK
  9146           IF NO-CONVERSION-ERROR
  9147              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9148              ELSE
  9149              MOVE -1                TO BEFFDTL
  9150              MOVE  1                TO SET-CURSOR-SW
  9151              MOVE ER-2226           TO EMI-ERROR
  9152              MOVE AL-UNBON          TO BEFFDTA
  9153              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9154           ELSE
  9155              MOVE -1                TO BEFFDTL
  9156              MOVE  1                TO SET-CURSOR-SW
  9157              MOVE ER-2220           TO EMI-ERROR
  9158              MOVE AL-UNBON          TO BEFFDTA
  9159              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9160
  9161     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9162
  9163     IF BCERTNOL NOT = ZEROS
  9164        MOVE BCERTNOI                TO WS-NEW-PRIME
  9165     ELSE
  9166        MOVE SPACES                  TO WS-NEW-PRIME.
  9167
  9168     IF BSUFIXL NOT = ZEROS
  9169        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9170     ELSE
  9171        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9172
  9173     IF BEFFDTL NOT = ZEROS
  9174        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9175     ELSE
  9176        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9177
  9178     IF BMAINTI = 'A' OR 'K' OR 'S'
  9179        NEXT SENTENCE
  9180     ELSE
  9181        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9182        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9183           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9184           WS-PB-RECORD-TYPE NOT = '1'
  9185           IF BMAINTI = 'C'
  9186               MOVE ER-2287          TO EMI-ERROR
  9187               MOVE -1               TO BCERTNOL
  9188               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9189               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 172
* EL6311.cbl
  9190               GO TO 8200-SEND-DATAONLY
  9191             ELSE
  9192               MOVE ER-2260          TO EMI-ERROR
  9193               MOVE -1               TO BCERTNOL
  9194               MOVE AL-UABON         TO BCERTNOA
  9195               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9196               GO TO 8200-SEND-DATAONLY.
  9197
  9198     IF BMAINTI = 'D'
  9199         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9200
  9201*    IF BMICRNOL  NOT =  ZEROS
  9202*        IF BMICRNOI  NUMERIC
  9203*            MOVE AL-UNNON       TO  BMICRNOA
  9204*        ELSE
  9205*            MOVE -1             TO  BMICRNOL
  9206*            MOVE 1              TO  SET-CURSOR-SW
  9207*            MOVE AL-UNBON       TO  BMICRNOA
  9208*            MOVE ER-2701        TO  EMI-ERROR
  9209*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9210     IF BVINL NOT = ZEROS
  9211        MOVE AL-UANON            TO BVINA
  9212     END-IF
  9213     IF B1STNML NOT = ZEROS
  9214         MOVE AL-UANON                TO B1STNMA.
  9215
  9216     IF BINITL  NOT = ZEROS
  9217        MOVE AL-UANON                TO BINITA.
  9218
  9219     IF BSEXL NOT = ZEROS
  9220        IF BSEXI = 'M' OR 'F'
  9221           MOVE AL-UANON             TO BSEXA
  9222        ELSE
  9223           MOVE -1               TO BSEXL
  9224           MOVE ER-2629          TO EMI-ERROR
  9225           MOVE AL-UABON         TO BSEXA
  9226           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9227
  9228     IF BAGEL NOT = ZEROS
  9229         IF BAGEI NUMERIC
  9230             MOVE BAGEI              TO WS-BAGE
  9231             MOVE AL-UNNON           TO BAGEA
  9232         ELSE
  9233             MOVE -1                 TO BAGEL
  9234             MOVE  1                 TO SET-CURSOR-SW
  9235             MOVE ER-2223            TO EMI-ERROR
  9236             MOVE AL-UNBON           TO BAGEA
  9237             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9238
  9239     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9240
  9241     IF (BBIRTHL GREATER THAN +0) AND
  9242        (BBIRTHI NOT EQUAL SPACES)
  9243        NEXT SENTENCE
  9244     ELSE
  9245        GO TO 1010-CHECK-AGE.
  9246
  9247     MOVE BBIRTHI                TO DEEDIT-FIELD.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 173
* EL6311.cbl
  9248     PERFORM 8600-DEEDIT.
  9249     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9250     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9251     MOVE AL-UNNON               TO BBIRTHA.
  9252     MOVE '4'                    TO DC-OPTION-CODE.
  9253     PERFORM 9700-DATE-LINK.
  9254     IF DATE-CONVERSION-ERROR
  9255        MOVE -1                  TO BBIRTHL
  9256        MOVE  1                  TO SET-CURSOR-SW
  9257        MOVE ER-2228             TO EMI-ERROR
  9258        MOVE AL-UNBON            TO BBIRTHA
  9259        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9260        GO TO 1010-CHECK-AGE.
  9261
  9262     IF (NO-CONVERSION-ERROR) AND
  9263        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9264        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9265        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9266        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9267                                    WS-CONVERTED-BIRTH
  9268        MOVE AL-UANON            TO BBIRTHA
  9269     ELSE
  9270        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9271        MOVE AL-UANON            TO BBIRTHA.
  9272
  9273 1010-CHECK-AGE.
  9274
  9275*    IF BAGEL = ZERO
  9276*       IF BBIRTHL GREATER THAN ZERO
  9277*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9278
  9279     IF B1STPMTL NOT = ZEROS
  9280        IF B1STPMTI = SPACES
  9281           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9282        ELSE
  9283           MOVE B1STPMTI             TO DEEDIT-FIELD
  9284           PERFORM 8600-DEEDIT
  9285           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9286           MOVE AL-UNNON             TO B1STPMTA
  9287           MOVE 4                    TO DC-OPTION-CODE
  9288           PERFORM 9700-DATE-LINK
  9289           IF NO-CONVERSION-ERROR
  9290              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9291              MOVE AL-UANON          TO B1STPMTA
  9292           ELSE
  9293              MOVE -1                TO B1STPMTL
  9294              MOVE  1                TO SET-CURSOR-SW
  9295              MOVE ER-2200           TO EMI-ERROR
  9296              MOVE AL-UNBON          TO B1STPMTA
  9297              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9298
  9299     IF BDAYSL NOT = ZEROS
  9300         IF BDAYSI NUMERIC
  9301             MOVE AL-UNNON           TO BDAYSA
  9302         ELSE
  9303             MOVE -1                 TO BDAYSL
  9304             MOVE ER-2530            TO EMI-ERROR
  9305             MOVE AL-UNBON           TO BDAYSA
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 174
* EL6311.cbl
  9306             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9307
  9308     IF BLNTRML NOT = ZEROS
  9309         IF BLNTRMI NUMERIC
  9310             MOVE AL-UNNON       TO BLNTRMA
  9311         ELSE
  9312             MOVE -1             TO BLNTRML
  9313             MOVE ER-2533        TO EMI-ERROR
  9314             MOVE AL-UNBON       TO BLNTRMA
  9315             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9316
  9317**   IF PI-COMPANY-ID = 'DMD'
  9318     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9319        NEXT SENTENCE
  9320     ELSE
  9321         IF BLNOFCRL NOT = ZEROS
  9322            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9323            IF LOAN-OFFICER-FOUND
  9324                MOVE AL-UANON        TO BLNOFCRA
  9325             ELSE
  9326                 MOVE SPACE          TO WS-LOAN-OFFICER
  9327                 MOVE -1             TO BLNOFCRL
  9328                 MOVE  1             TO SET-CURSOR-SW
  9329                 MOVE ER-3006        TO EMI-ERROR
  9330                 MOVE AL-UNBON       TO BLNOFCRA
  9331                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9332
  9333     IF BFREQL NOT = ZEROS
  9334         IF BFREQI NUMERIC
  9335             MOVE AL-UNNON       TO BFREQA
  9336         ELSE
  9337             MOVE -1             TO BFREQL
  9338             MOVE  1             TO SET-CURSOR-SW
  9339             MOVE ER-2223        TO EMI-ERROR
  9340             MOVE AL-UNBON       TO BFREQA
  9341             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9342
  9343     IF BMODEL NOT = ZEROS
  9344         MOVE BMODEI             TO WS-MODE-CODE
  9345                                    PI-BMODE
  9346         IF WS-MODE-CODE-VALID
  9347             MOVE AL-UANON       TO BMODEA
  9348         ELSE
  9349             MOVE -1             TO BMODEL
  9350             MOVE ER-2591        TO EMI-ERROR
  9351             MOVE AL-UABON       TO BMODEA
  9352             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9353
  9354     IF BPMTSL NOT = ZEROS
  9355         IF BPMTSI NUMERIC
  9356             MOVE AL-UNNON           TO BPMTSA
  9357             MOVE BPMTSI             TO PI-BPMTS
  9358         ELSE
  9359             MOVE -1                 TO BPMTSL
  9360             MOVE ER-2592            TO EMI-ERROR
  9361             MOVE AL-UNBON           TO BPMTSA
  9362             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9363
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 175
* EL6311.cbl
  9364     IF BPMTAMTL NOT = ZEROS
  9365
  9366* EXEC CICS BIF DEEDIT
  9367*            FIELD  (BPMTAMTI)
  9368*            LENGTH (9)
  9369*       END-EXEC
  9370     MOVE 9
  9371       TO DFHEIV11
  9372*    MOVE '@"L                   #   #00009300' TO DFHEIV0
  9373     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9374     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9375     MOVE X'2020233030303039333030' TO DFHEIV0(25:11)
  9376     CALL 'kxdfhei1' USING DFHEIV0,
  9377           BPMTAMTI,
  9378           DFHEIV11
  9379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9380        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9381*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9382*        PERFORM 8600-DEEDIT
  9383*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9384
  9385*    IF BAPRL NOT = ZEROS
  9386*        EXEC CICS BIF DEEDIT
  9387*            FIELD  (BAPRI)
  9388*            LENGTH (7)
  9389*        END-EXEC
  9390*        MOVE BAPRI              TO WS-BAPR.
  9391
  9392     IF BAPRL > 0
  9393        MOVE +0                  TO  WS-BAPR
  9394        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9395           (WS-SUB > 7)
  9396           OR (BAPRI (WS-SUB:1) NUMERIC)
  9397           OR (BAPRI (WS-SUB:1) = '.')
  9398        END-PERFORM
  9399        IF WS-SUB > 7
  9400           MOVE ER-2471       TO EMI-ERROR
  9401           MOVE -1            TO BAPRL
  9402           MOVE AL-UNBON      TO BAPRA
  9403           PERFORM 9900-ERROR-FORMAT
  9404                                 THRU 9900-EXIT
  9405        ELSE
  9406           IF BAPRI (WS-SUB:1) NUMERIC
  9407              MOVE WS-SUB           TO WS-BEG
  9408              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9409                 (WS-SUB > 7)
  9410                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9411              END-PERFORM
  9412              COMPUTE WS-END = WS-SUB - WS-BEG
  9413              MOVE BAPRI (WS-BEG:WS-END)
  9414                                 TO WS-APR-WHOLE-NUM
  9415           END-IF
  9416           IF BAPRI (WS-SUB:1) = '.'
  9417              COMPUTE WS-BEG = WS-SUB + 1
  9418              IF (WS-BEG < 8)
  9419                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9420                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9421                    (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 176
* EL6311.cbl
  9422                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9423                 END-PERFORM
  9424                 COMPUTE WS-END = WS-SUB - WS-BEG
  9425                 MOVE BAPRI (WS-BEG:WS-END)
  9426                                 TO WS-APR-DEC (1:WS-END)
  9427              END-IF
  9428           END-IF
  9429           MOVE AL-UNNON      TO BAPRA
  9430           MOVE WS-BAPR       TO BAPRO
  9431        END-IF
  9432     END-IF
  9433*     IF BAPRL NOT = ZEROS
  9434*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9435*        PERFORM 8600-DEEDIT
  9436*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9437
  9438     IF BLIVESL NOT = ZEROS
  9439        MOVE BLIVESI             TO DEEDIT-FIELD
  9440        PERFORM 8600-DEEDIT
  9441        IF DEEDIT-FIELD-V0 NUMERIC
  9442           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9443           MOVE AL-UNNON         TO BLIVESA
  9444        ELSE
  9445           MOVE -1               TO BLIVESL
  9446           MOVE AL-UNBON         TO BLIVESA
  9447           MOVE ER-2223          TO EMI-ERROR
  9448           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9449
  9450*DMD CUSTOM CODING*************START
  9451*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9452     IF PI-COMPANY-ID NOT = 'DMD'
  9453         MOVE ZEROS               TO BBILLEDL
  9454         GO TO 1010-EDIT-CONT.
  9455
  9456     IF BBILLEDL NOT = ZEROS
  9457        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9458        MOVE 'Y'                 TO WS-NUMERIC-SW
  9459        MOVE +1                  TO WS-CSO-SUB
  9460        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9461        IF CSO-NUMERIC-FIELD
  9462
  9463* EXEC CICS BIF DEEDIT
  9464*              FIELD  (BBILLEDI)
  9465*              LENGTH (9)
  9466*          END-EXEC
  9467     MOVE 9
  9468       TO DFHEIV11
  9469*    MOVE '@"L                   #   #00009386' TO DFHEIV0
  9470     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9471     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9472     MOVE X'2020233030303039333836' TO DFHEIV0(25:11)
  9473     CALL 'kxdfhei1' USING DFHEIV0,
  9474           BBILLEDI,
  9475           DFHEIV11
  9476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9477           MOVE BBILLEDI         TO WS-BILLED
  9478           MOVE AL-UNNON         TO BBILLEDA
  9479        ELSE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 177
* EL6311.cbl
  9480           MOVE -1               TO BBILLEDL
  9481           MOVE AL-UNBON         TO BBILLEDA
  9482           MOVE ER-2547          TO EMI-ERROR
  9483           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9484     ELSE
  9485        IF BMAINTI EQUAL 'A'
  9486           MOVE -1               TO BBILLEDL
  9487           MOVE AL-UNBON         TO BBILLEDA
  9488           MOVE ER-8148          TO EMI-ERROR
  9489           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9490
  9491 1010-EDIT-CONT.
  9492
  9493     IF BFORCEL  NOT = ZEROS
  9494         IF FORCE-CAP
  9495            MOVE AL-UANON            TO BFORCEA
  9496         ELSE
  9497            MOVE ER-2945             TO EMI-ERROR
  9498            MOVE AL-UABON            TO BFORCEA
  9499            MOVE -1                  TO BFORCEL
  9500            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9501
  9502     IF BENTRYL NOT = ZEROS
  9503        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9504                         'D' AND 'V' AND 'U' AND 'M'
  9505           MOVE ER-2224              TO EMI-ERROR
  9506           MOVE AL-UABON             TO BENTRYA
  9507           MOVE -1                   TO BENTRYL
  9508           MOVE  1                   TO SET-CURSOR-SW
  9509           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9510        ELSE
  9511           MOVE AL-UANON             TO BENTRYA.
  9512
  9513     IF BUNWRITL NOT = ZEROS
  9514        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9515           MOVE ER-7574              TO EMI-ERROR
  9516           MOVE AL-UABON             TO BUNWRITA
  9517           MOVE -1                   TO BUNWRITL
  9518           MOVE  1                   TO SET-CURSOR-SW
  9519           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9520        ELSE
  9521           MOVE AL-UANON             TO BUNWRITA.
  9522
  9523     IF BREINL  NOT = ZEROS
  9524         MOVE AL-UANON               TO BREINA.
  9525
  9526     IF BBILCDL NOT = ZEROS
  9527        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9528                             AND 'A' AND 'B' AND 'E'
  9529           MOVE ER-2225              TO EMI-ERROR
  9530           MOVE AL-UABON             TO BBILCDA
  9531           MOVE -1                   TO BBILCDL
  9532           MOVE  1                   TO SET-CURSOR-SW
  9533           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9534        ELSE
  9535           MOVE AL-UANON             TO BBILCDA.
  9536
  9537     IF BSKPCDL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 178
* EL6311.cbl
  9538         MOVE AL-UANON               TO BSKPCDA.
  9539
  9540     IF BINDGRPL NOT = ZEROS
  9541         MOVE AL-UANON               TO BINDGRPA.
  9542
  9543     IF BSIGL   NOT = ZEROS
  9544         MOVE AL-UANON               TO BSIGA.
  9545
  9546     IF BRTCLSL NOT = ZEROS
  9547         MOVE AL-UANON               TO BRTCLSA.
  9548
  9549     IF BMEMBERL NOT = ZEROS
  9550         MOVE AL-UANON               TO BMEMBERA.
  9551
  9552     MOVE +0                         TO WS-SUB1.
  9553
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 179
* EL6311.cbl
  9555
  9556******************************************************************
  9557*                                                                *
  9558*           E D I T   I S S U E   C O V E R A G E S              *
  9559*                                                                *
  9560******************************************************************
  9561
  9562 1020-EDIT-COVERAGES.
  9563     ADD +1                      TO WS-SUB1.
  9564
  9565     IF WS-SUB1 GREATER +2
  9566        GO TO 1025-EDIT-COMPLETE.
  9567
  9568     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9569       IF (BMODEL   GREATER ZERO  OR
  9570            BPMTSL   GREATER ZERO  OR
  9571            BPMTAMTL GREATER ZERO)
  9572          AND
  9573            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  9574               GO TO 1021-CONT-EDIT.
  9575
  9576     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9577        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9578        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9579        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9580        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9581        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9582        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9583        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9584        NEXT SENTENCE
  9585         ELSE
  9586            GO TO 1020-EDIT-COVERAGES.
  9587
  9588 1021-CONT-EDIT.
  9589
  9590     IF BMAINTI = 'A'
  9591        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9592           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9593        ELSE
  9594           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9595           MOVE ER-7404          TO EMI-ERROR
  9596           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9597           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9598     ELSE
  9599        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9600           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9601
  9602     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9603        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9604        PERFORM 8600-DEEDIT
  9605        IF DEEDIT-FIELD-V0 NUMERIC
  9606           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9607        ELSE
  9608           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9609
  9610     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9611*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
  9612        IF BMODEL  GREATER THAN ZEROS  AND
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 180
* EL6311.cbl
  9613           BPMTSL  GREATER THAN ZEROS
  9614           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9615
  9616     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9617         IF BMODEL   GREATER THAN ZEROS  OR
  9618            BPMTSL   GREATER THAN ZEROS  OR
  9619            BPMTAMTL GREATER THAN ZEROS
  9620             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9621
  9622     IF BMAINTI = ('C' OR 'K')
  9623        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9624           NEXT SENTENCE
  9625        ELSE
  9626           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9627           PERFORM 8600-DEEDIT
  9628           IF DEEDIT-FIELD-V0 NUMERIC
  9629              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  9630              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9631                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9632              ELSE
  9633                    MOVE ER-2241      TO EMI-ERROR
  9634                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9635                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9636                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9637           ELSE
  9638              MOVE ER-2223          TO EMI-ERROR
  9639              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9640              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9641              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9642     ELSE
  9643        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9644            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9645            PERFORM 8600-DEEDIT
  9646            IF DEEDIT-FIELD-V0      NUMERIC
  9647               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9648                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9649                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9650               ELSE
  9651                  MOVE ER-2241         TO EMI-ERROR
  9652                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9653                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9654                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9655            ELSE
  9656              MOVE ER-2223             TO EMI-ERROR
  9657              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9658              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9659              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9660        ELSE
  9661            MOVE ER-2240               TO EMI-ERROR
  9662            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9663            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9664*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9665*        IF BMODEL  GREATER THAN ZEROS  AND
  9666*           BPMTSL  GREATER THAN ZEROS
  9667*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9668
  9669     IF BBEN-LEN (WS-SUB1) = ZEROS
  9670        AND BMAINTI = ('C' OR 'K')
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 181
* EL6311.cbl
  9671           NEXT SENTENCE
  9672     ELSE
  9673        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  9674           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  9675
  9676* EXEC CICS BIF DEEDIT
  9677*              FIELD  (BBENI (WS-SUB1))
  9678*              LENGTH (12)
  9679*          END-EXEC
  9680     MOVE 12
  9681       TO DFHEIV11
  9682*    MOVE '@"L                   #   #00009588' TO DFHEIV0
  9683     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9684     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9685     MOVE X'2020233030303039353838' TO DFHEIV0(25:11)
  9686     CALL 'kxdfhei1' USING DFHEIV0,
  9687           BBENI(WS-SUB1),
  9688           DFHEIV11
  9689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9690           IF BBENI (WS-SUB1)  NUMERIC
  9691              IF BBENI (WS-SUB1) GREATER THAN ZEROS
  9692                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
  9693*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  9694*          PERFORM 8600-DEEDIT
  9695*          IF DEEDIT-FIELD-V2  NUMERIC
  9696*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9697*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
  9698              ELSE
  9699                 MOVE ER-7632    TO EMI-ERROR
  9700                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9701                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9702                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9703           ELSE
  9704              MOVE ER-2223         TO EMI-ERROR
  9705              MOVE -1              TO BBEN-LEN   (WS-SUB1)
  9706              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
  9707              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9708        ELSE
  9709           MOVE ER-7632    TO EMI-ERROR
  9710           MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9711           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9712           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9713
  9714     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
  9715        AND (BMAINTI = ('C' OR 'K'))
  9716        CONTINUE
  9717     ELSE
  9718        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
  9719           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
  9720           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
  9721              FOR ALL '.'
  9722           IF WS-TALLY > 1
  9723              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9724                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
  9725              END-PERFORM
  9726              IF A1 < 9
  9727                 ADD 3 TO A1
  9728                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 182
* EL6311.cbl
  9729              END-IF
  9730           ELSE
  9731              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9732                (A1 > 11)
  9733                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
  9734                  LOW-VALUES OR SPACES)
  9735              END-PERFORM
  9736              IF A1 > 1 AND < 12
  9737                 MOVE SPACES
  9738                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  9739              END-IF
  9740           END-IF
  9741
  9742* EXEC CICS BIF DEEDIT
  9743*              FIELD  (BPREMI (WS-SUB1))
  9744*              LENGTH (11)
  9745*          END-EXEC
  9746     MOVE 11
  9747       TO DFHEIV11
  9748*    MOVE '@"L                   #   #00009643' TO DFHEIV0
  9749     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9750     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9751     MOVE X'2020233030303039363433' TO DFHEIV0(25:11)
  9752     CALL 'kxdfhei1' USING DFHEIV0,
  9753           BPREMI(WS-SUB1),
  9754           DFHEIV11
  9755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9756           IF BPREMI (WS-SUB1) NUMERIC
  9757              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
  9758                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
  9759*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
  9760*          PERFORM 8600-DEEDIT
  9761*          IF DEEDIT-FIELD-V2  NUMERIC
  9762*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9763*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
  9764              ELSE
  9765                 IF PI-COMPANY-ID NOT = 'DCC'
  9766                    MOVE ER-7633    TO EMI-ERROR
  9767                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
  9768                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
  9769                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9770                 END-IF
  9771              END-IF
  9772           ELSE
  9773              MOVE ER-2223         TO EMI-ERROR
  9774              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9775              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9776              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9777           END-IF
  9778        ELSE
  9779           IF PI-COMPANY-ID NOT = 'DCC'
  9780              MOVE ER-7633         TO EMI-ERROR
  9781              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9782              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9783              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9784           END-IF
  9785        END-IF
  9786     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 183
* EL6311.cbl
  9787
  9788     IF BCPREM-LEN   (WS-SUB1) = ZEROS
  9789        NEXT SENTENCE
  9790     ELSE
  9791        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
  9792
  9793* EXEC CICS BIF DEEDIT
  9794*           FIELD  (BCPREMI (WS-SUB1))
  9795*           LENGTH (11)
  9796*       END-EXEC
  9797     MOVE 11
  9798       TO DFHEIV11
  9799*    MOVE '@"L                   #   #00009683' TO DFHEIV0
  9800     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9801     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9802     MOVE X'2020233030303039363833' TO DFHEIV0(25:11)
  9803     CALL 'kxdfhei1' USING DFHEIV0,
  9804           BCPREMI(WS-SUB1),
  9805           DFHEIV11
  9806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9807        IF BCPREMI (WS-SUB1) NUMERIC
  9808           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
  9809*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
  9810*       PERFORM 8600-DEEDIT
  9811*       IF DEEDIT-FIELD-V2  NUMERIC
  9812*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
  9813        ELSE
  9814           MOVE ER-2223         TO EMI-ERROR
  9815           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
  9816           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
  9817           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9818
  9819     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9820        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
  9821        PERFORM 8600-DEEDIT
  9822        IF DEEDIT-FIELD-V0 NUMERIC
  9823           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
  9824           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9825         ELSE
  9826           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
  9827           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9828           MOVE ER-2223              TO EMI-ERROR
  9829           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9830
  9831     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9832        IF BEXPIRE   (WS-SUB1) = SPACES
  9833           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
  9834        ELSE
  9835           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
  9836           PERFORM 8600-DEEDIT
  9837           IF DEEDIT-FIELD-V0        NUMERIC
  9838              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
  9839              MOVE 4                TO DC-OPTION-CODE
  9840              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9841              PERFORM 9700-DATE-LINK
  9842              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
  9843                                                        (WS-SUB1)
  9844              IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 184
* EL6311.cbl
  9845                 NEXT SENTENCE
  9846              ELSE
  9847                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
  9848                 MOVE ER-2531    TO EMI-ERROR
  9849                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
  9850                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9851           ELSE
  9852             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
  9853             MOVE ER-2532        TO EMI-ERROR
  9854             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
  9855             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9856
  9857     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
  9858        NEXT SENTENCE
  9859     ELSE
  9860
  9861* EXEC CICS BIF DEEDIT
  9862*           FIELD  (BALT-BENI (WS-SUB1))
  9863*           LENGTH (12)
  9864*       END-EXEC
  9865     MOVE 12
  9866       TO DFHEIV11
  9867*    MOVE '@"L                   #   #00009740' TO DFHEIV0
  9868     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9869     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9870     MOVE X'2020233030303039373430' TO DFHEIV0(25:11)
  9871     CALL 'kxdfhei1' USING DFHEIV0,
  9872           BALT-BENI(WS-SUB1),
  9873           DFHEIV11
  9874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9875        IF BALT-BENI (WS-SUB1) NUMERIC
  9876           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
  9877*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
  9878*       PERFORM 8600-DEEDIT
  9879*       IF DEEDIT-FIELD-V0 NUMERIC
  9880*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
  9881        ELSE
  9882           MOVE ER-2223         TO EMI-ERROR
  9883           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
  9884           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
  9885           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9886
  9887     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
  9888        NEXT SENTENCE
  9889     ELSE
  9890
  9891* EXEC CICS BIF DEEDIT
  9892*           FIELD  (BALT-PREMI (WS-SUB1))
  9893*           LENGTH (11)
  9894*       END-EXEC
  9895     MOVE 11
  9896       TO DFHEIV11
  9897*    MOVE '@"L                   #   #00009759' TO DFHEIV0
  9898     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9899     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9900     MOVE X'2020233030303039373539' TO DFHEIV0(25:11)
  9901     CALL 'kxdfhei1' USING DFHEIV0,
  9902           BALT-PREMI(WS-SUB1),
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 185
* EL6311.cbl
  9903           DFHEIV11
  9904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9905        IF BALT-PREMI (WS-SUB1) NUMERIC
  9906           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
  9907*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
  9908*       PERFORM 8600-DEEDIT
  9909*       IF DEEDIT-FIELD-V0 NUMERIC
  9910*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
  9911        ELSE
  9912           MOVE ER-2223         TO EMI-ERROR
  9913           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
  9914           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
  9915           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9916
  9917      GO TO 1020-EDIT-COVERAGES.
  9918
  9919 1025-EDIT-COMPLETE.
  9920     IF PI-COMPANY-ID  =  'DMD'
  9921        MOVE LOW-VALUES             TO BNCERTI
  9922                                       BNSTATI.
  9923
  9924     IF EMI-ERROR = ZEROS
  9925         NEXT SENTENCE
  9926     ELSE
  9927         GO TO 8200-SEND-DATAONLY.
  9928
  9929     IF BMAINTI = 'A'
  9930         GO TO 1200-ADD-ISSUE-ROUTINE.
  9931
  9932     IF BMAINTI = 'C'
  9933         GO TO 1300-CHANGE-ISSUE-ROUTINE.
  9934
  9935     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
  9936
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 186
* EL6311.cbl
  9938
  9939 1030-EDIT-FOR-NUMERICS.
  9940     IF WS-CSO-SUB EQUAL 10
  9941        GO TO 1030-EDIT-EXIT.
  9942
  9943     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
  9944        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
  9945        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
  9946           ADD +1               TO WS-CSO-SUB
  9947           GO TO 1030-EDIT-FOR-NUMERICS.
  9948
  9949     MOVE 'N'                   TO WS-NUMERIC-SW.
  9950
  9951 1030-EDIT-EXIT.
  9952******************************************************************
  9953*                                                                *
  9954*                 C A L C U L A T E   A G E                      *
  9955*                                                                *
  9956******************************************************************
  9957
  9958
  9959 1095-CALC-AGE.
  9960
  9961     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
  9962     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
  9963     MOVE 1                  TO DC-OPTION-CODE.
  9964     PERFORM 9700-DATE-LINK
  9965     IF NO-CONVERSION-ERROR
  9966         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
  9967         MOVE WS-BAGE            TO BAGEI
  9968         MOVE +2                 TO BAGEL
  9969         MOVE AL-UNNON TO BAGEA.
  9970
  9971 1099-EXIT.
  9972     EXIT.
  9973
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 187
* EL6311.cbl
  9975
  9976******************************************************************
  9977*                                                                *
  9978*                   S H O W   I S S U E                          *
  9979*                                                                *
  9980******************************************************************
  9981
  9982 1100-SHOW-REQUEST.
  9983     MOVE 'S'                    TO PI-MAINT-FUNCTION.
  9984
  9985     IF BCERTNOL = ZEROS AND
  9986        BEFFDTL  = ZEROS
  9987        MOVE -1                  TO BMAINTL
  9988        GO TO 8200-SEND-DATAONLY.
  9989
  9990     MOVE BCERTNOI               TO WS-NEW-PRIME.
  9991
  9992     IF BSUFIXL NOT = ZEROS
  9993        MOVE BSUFIXI             TO WS-NEW-SUFFIX
  9994     ELSE
  9995        MOVE SPACE               TO WS-NEW-SUFFIX.
  9996
  9997     MOVE BEFFDTI                TO DEEDIT-FIELD.
  9998     PERFORM 8600-DEEDIT.
  9999     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10000     MOVE '4'                    TO DC-OPTION-CODE.
 10001     PERFORM 9700-DATE-LINK.
 10002     IF DATE-CONVERSION-ERROR
 10003        MOVE ER-0348             TO EMI-ERROR
 10004        MOVE -1                  TO BEFFDTL
 10005        MOVE AL-UABON            TO BEFFDTA
 10006        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10007        GO TO 8200-SEND-DATAONLY
 10008     ELSE
 10009        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10010        MOVE AL-UANON            TO BEFFDTA
 10011        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10012
 10013     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10014
 10015     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10016        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10017          MOVE 'Y'                    TO WS-SHOW-SW
 10018          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10019             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10020           ELSE
 10021             IF PI-FILE-BROWSE
 10022                GO TO 4300-BROWSE-FILE-FORWARD
 10023              ELSE
 10024                IF PI-CSR-BROWSE
 10025                   GO TO 4200-BROWSE-CSR-FORWARD
 10026                ELSE
 10027                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10028        ELSE
 10029           GO TO 3900-RE-DISPLAY-RECORD.
 10030
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 188
* EL6311.cbl
 10032
 10033******************************************************************
 10034*                                                                *
 10035*            A D D   I S S U E   R O U T I N E                   *
 10036*                                                                *
 10037******************************************************************
 10038
 10039***************************************************************
 10040*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10041*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10042*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10043*     4. LINK TO THE EDIT ROUTINE.                            *
 10044*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10045*     6. WRITE THE NEW ISSUE RECORD.                          *
 10046*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10047*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10048*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10049*        ELSE                                                 *
 10050*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10051***************************************************************
 10052
 10053 1200-ADD-ISSUE-ROUTINE.
 10054     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10055
 10056
 10057* EXEC CICS GETMAIN
 10058*        SET     (ADDRESS OF PENDING-BUSINESS)
 10059*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10060*    END-EXEC.
 10061*    MOVE '," L                  $   #00009914' TO DFHEIV0
 10062     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10063     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10064     MOVE X'2020233030303039393134' TO DFHEIV0(25:11)
 10065     CALL 'kxdfhei1' USING DFHEIV0,
 10066           DFHEIV20,
 10067           ERPNDB-RECORD-LENGTH,
 10068           DFHEIV99
 10069     SET ADDRESS OF PENDING-BUSINESS TO
 10070         DFHEIV20
 10071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10072
 10073
 10074
 10075* EXEC CICS HANDLE CONDITION
 10076*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10077*    END-EXEC.
 10078*    MOVE '"$I                   ! # #00009919' TO DFHEIV0
 10079     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10080     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10081     MOVE X'2320233030303039393139' TO DFHEIV0(25:11)
 10082     CALL 'kxdfhei1' USING DFHEIV0
 10083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10084
 10085
 10086     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10087     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10088     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10089
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 189
* EL6311.cbl
 10090
 10091* EXEC CICS READ
 10092*        INTO    (PENDING-BUSINESS)
 10093*        DATASET (FILE-ID-ERPNDB)
 10094*        RIDFLD  (ERPNDB-KEY)
 10095*    END-EXEC.
 10096     MOVE LENGTH OF
 10097      PENDING-BUSINESS
 10098       TO DFHEIV11
 10099*    MOVE '&"IL       E          (   #00009927' TO DFHEIV0
 10100     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10101     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10102     MOVE X'2020233030303039393237' TO DFHEIV0(25:11)
 10103     CALL 'kxdfhei1' USING DFHEIV0,
 10104           FILE-ID-ERPNDB,
 10105           PENDING-BUSINESS,
 10106           DFHEIV11,
 10107           ERPNDB-KEY,
 10108           DFHEIV99,
 10109           DFHEIV99,
 10110           DFHEIV99
 10111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10112
 10113
 10114     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10115
 10116     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10117     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10118     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10119     MOVE SPACES                 TO PENDING-BUSINESS.
 10120     MOVE 'PB'                   TO PB-RECORD-ID.
 10121     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10122     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10123     MOVE SPACES                 TO PB-CERT-SFX.
 10124     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10125     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10126                                    PB-ALT-CHG-SEQ-NO.
 10127
 10128     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10129     MOVE '1'                    TO PB-RECORD-TYPE.
 10130
 10131     IF BSUFIXL NOT = ZEROS
 10132        MOVE BSUFIXI             TO PB-CERT-SFX.
 10133
 10134     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10135
 10136     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10137     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10138
 10139     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10140                                    PB-I-LF-PREM-CALC
 10141                                    PB-I-LF-ALT-PREM-CALC
 10142                                    PB-I-LF-RATE
 10143                                    PB-I-LF-ALT-RATE
 10144                                    PB-I-LF-REI-RATE
 10145                                    PB-I-LF-ALT-REI-RATE
 10146                                    PB-I-RATE-DEV-PCT-LF
 10147                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 190
* EL6311.cbl
 10148                                    PB-I-AH-RATE
 10149                                    PB-I-AH-REI-RATE
 10150                                    PB-I-AH-RATE-TRM
 10151                                    PB-I-RATE-DEV-PCT-AH
 10152                                    PB-I-BUSINESS-TYPE
 10153                                    PB-I-LIFE-COMMISSION
 10154                                    PB-I-JOINT-COMMISSION
 10155                                    PB-I-JOINT-AGE
 10156                                    PB-I-AH-COMMISSION
 10157                                    PB-I-CURR-SEQ
 10158                                    PB-CHG-COUNT
 10159                                    PB-LF-BILLED-AMTS
 10160                                    PB-AH-BILLED-AMTS
 10161                                    PB-CALC-TOLERANCE
 10162                                    PB-I-EXTENTION-DAYS
 10163*                                   PB-I-MICROFILM-NO
 10164                                    PB-I-TERM-IN-DAYS.
 10165
 10166     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10167                                    PB-I-LF-EXPIRE-DT
 10168                                    PB-I-AH-EXPIRE-DT
 10169                                    PB-BILLED-DT
 10170                                    PB-ACCT-EFF-DT
 10171                                    PB-ACCT-EXP-DT
 10172                                    PB-I-1ST-PMT-DT.
 10173
 10174     MOVE 'X'                    TO PB-FATAL-FLAG.
 10175
 10176     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10177
 10178     IF BLSTNML GREATER THAN ZEROS
 10179         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10180
 10181*    IF BMICRNOL  GREATER  ZEROS
 10182*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10183*    ELSE
 10184*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10185     IF BVINL > ZEROS
 10186        MOVE BVINI               TO PB-I-VIN
 10187     END-IF
 10188     IF B1STNML GREATER THAN ZEROS
 10189         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10190
 10191     IF BINITL  GREATER THAN ZEROS
 10192         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10193
 10194     IF BBIRTHL GREATER THAN ZERO
 10195         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10196     ELSE
 10197         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10198
 10199     IF B1STPMTL GREATER THAN ZERO
 10200         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10201     ELSE
 10202         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10203
 10204     IF BAGEL    GREATER THAN ZEROS
 10205         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 191
* EL6311.cbl
 10206        ELSE
 10207         MOVE ZEROS              TO PB-I-AGE.
 10208
 10209     IF BSEXL    GREATER THAN ZEROS
 10210         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10211
 10212     IF BTERM-LEN (1) GREATER THAN ZEROS
 10213        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10214     ELSE
 10215        MOVE ZEROS               TO PB-I-LF-TERM.
 10216
 10217     IF BTERM-LEN (2) GREATER THAN ZEROS
 10218        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10219     ELSE
 10220        MOVE ZEROS               TO PB-I-AH-TERM.
 10221
 10222     IF BLNTRML       GREATER THAN ZEROS
 10223         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10224        ELSE
 10225         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10226
 10227     IF BFREQL        GREATER THAN ZEROS
 10228         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10229        ELSE
 10230         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10231
 10232     IF BSKPCDL       GREATER THAN ZEROS
 10233         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10234
 10235     IF BMODEL        GREATER THAN ZEROS
 10236         MOVE BMODEI             TO PB-I-TERM-TYPE
 10237                                    PI-BMODE.
 10238
 10239     IF BPMTSL        GREATER THAN ZEROS
 10240         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10241                                    PI-BPMTS
 10242        ELSE
 10243         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10244                                    PI-BPMTS.
 10245
 10246     IF BPMTAMTL      GREATER THAN ZEROS
 10247         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10248        ELSE
 10249         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10250
 10251     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10252        IF BTYPE  (1)   NOT = ZEROS
 10253           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10254                                    PI-BTYPE (1)
 10255           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10256           MOVE SPACES           TO PB-I-LF-ABBR
 10257        ELSE
 10258           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10259                                    PB-I-LF-ABBR
 10260           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10261     ELSE
 10262        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10263                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 192
* EL6311.cbl
 10264        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10265
 10266     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10267         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10268     ELSE
 10269         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10270
 10271     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10272         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10273     ELSE
 10274         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10275
 10276     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10277         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10278            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10279            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10280         ELSE
 10281            MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10282            MOVE '?'             TO PB-I-LF-CALC-FLAG
 10283     ELSE
 10284         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10285
 10286     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10287         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10288
 10289     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10290         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10291         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10292     ELSE
 10293         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10294
 10295     IF  BALT-PREM-LEN     (2) > ZEROS
 10296         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10297     ELSE
 10298         MOVE ZEROS            TO PB-I-TOT-FEES.
 10299
 10300     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10301        IF BTYPE      (2)   NOT = ZEROS
 10302           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10303                                  PI-BTYPE (2)
 10304           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10305           MOVE SPACES         TO PB-I-AH-ABBR
 10306        ELSE
 10307           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10308                                  PB-I-AH-ABBR
 10309           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10310     ELSE
 10311        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10312                                  PB-I-AH-ABBR
 10313        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10314
 10315     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10316         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10317     ELSE
 10318         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10319
 10320     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10321         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 193
* EL6311.cbl
 10322            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10323            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10324         ELSE
 10325            MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10326            MOVE '?'             TO PB-I-AH-CALC-FLAG
 10327     ELSE
 10328         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10329
 10330     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10331         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10332
 10333     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10334        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10335     ELSE
 10336        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10337
 10338     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10339        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10340     ELSE
 10341        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10342
 10343     IF BINDGRPL  GREATER THAN ZEROS
 10344         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10345
 10346     IF BRTCLSL   GREATER THAN ZEROS
 10347         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10348
 10349     IF BSIGL     GREATER THAN ZEROS
 10350         MOVE BSIGI              TO PB-I-SIG-SW.
 10351
 10352     IF BAPRL     GREATER THAN ZEROS
 10353         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10354     ELSE
 10355         MOVE ZEROS              TO PB-I-LOAN-APR.
 10356
 10357     IF BMEMBERL  GREATER THAN ZEROS
 10358         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10359
 10360     IF BLNOFCRL  GREATER THAN ZEROS
 10361         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10362
 10363     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10364        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10365     ELSE
 10366        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10367
 10368     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10369        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10370     ELSE
 10371        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10372
 10373     IF BDAYSL   GREATER THAN ZEROS
 10374        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10375                                    PB-I-EXTENTION-DAYS
 10376     ELSE
 10377        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10378                                    PB-I-EXTENTION-DAYS.
 10379
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 194
* EL6311.cbl
 10380     IF BDAYSL GREATER THAN ZEROS
 10381        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10382
 10383     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10384        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10385           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10386
 10387     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10388        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10389           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10390
 10391     IF B1STPMTL GREATER THAN ZEROS
 10392        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10393
 10394     IF PB-EXT-DAYS-PROCESSING
 10395        IF PB-I-EXTENTION-DAYS = ZEROS
 10396           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10397
 10398     IF PB-EXPIRE-DT-PROCESSING
 10399        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10400           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10401             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10402
 10403     IF PB-1ST-PMT-DT-PROCESSING
 10404        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10405           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10406
 10407     IF BREINL GREATER THAN ZEROS
 10408        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10409
 10410     IF BENTRYL NOT = ZEROS
 10411        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10412        IF PI-COMPANY-ID = 'CID'
 10413           AND (PB-BATCH-ENTRY = 'P')
 10414           AND (PB-STATE = 'VA')
 10415           PERFORM 1500-UPDATE-ERNOTE
 10416                                 THRU 1500-EXIT
 10417        END-IF
 10418     END-IF
 10419     IF BUNWRITL NOT = ZEROS
 10420        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10421
 10422     IF BFORCEL NOT = ZEROS
 10423        MOVE BFORCEI             TO PB-FORCE-CODE.
 10424
 10425     IF BBILCDL NOT = ZEROS
 10426        MOVE BBILCDI             TO PB-RECORD-BILL.
 10427
 10428     IF BLIVESL GREATER THAN ZEROS
 10429        MOVE WS-BLIVES           TO PB-I-LIVES
 10430     ELSE
 10431        MOVE ZEROS               TO PB-I-LIVES.
 10432
 10433     IF BBILLEDL GREATER THAN ZEROS
 10434        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 10435     ELSE
 10436        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10437
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 195
* EL6311.cbl
 10438*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10439
 10440 1260-WRITE-PB-RECORD.
 10441     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10442                                    PB-INPUT-BY.
 10443     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10444     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10445                                    PB-INPUT-DT.
 10446
 10447     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10448     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10449                                    PB-CONTROL-BY-ORIG-BATCH.
 10450
 10451
 10452     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10453     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10454     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10455     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10456     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10457
 10458     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10459
 10460     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10461
 10462     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10463     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10464     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10465
 10466     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10467     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10468
 10469 1275-WRITE-PENDING-BUSINESS.
 10470     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10471     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10472     MOVE 'A'                    TO JP-RECORD-TYPE.
 10473     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10474
 10475
 10476* EXEC CICS HANDLE CONDITION
 10477*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10478*    END-EXEC.
 10479*    MOVE '"$%                   ! $ #00010294' TO DFHEIV0
 10480     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10481     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10482     MOVE X'2420233030303130323934' TO DFHEIV0(25:11)
 10483     CALL 'kxdfhei1' USING DFHEIV0
 10484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10485
 10486
 10487
 10488* EXEC CICS WRITE
 10489*        DATASET (FILE-ID-ERPNDB)
 10490*        FROM    (PENDING-BUSINESS)
 10491*        RIDFLD  (PB-CONTROL-PRIMARY)
 10492*    END-EXEC.
 10493     MOVE LENGTH OF
 10494      PENDING-BUSINESS
 10495       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 196
* EL6311.cbl
 10496*    MOVE '&$ L                  ''   #00010298' TO DFHEIV0
 10497     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10498     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10499     MOVE X'2020233030303130323938' TO DFHEIV0(25:11)
 10500     CALL 'kxdfhei1' USING DFHEIV0,
 10501           FILE-ID-ERPNDB,
 10502           PENDING-BUSINESS,
 10503           DFHEIV11,
 10504           PB-CONTROL-PRIMARY,
 10505           DFHEIV99,
 10506           DFHEIV99
 10507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10508
 10509
 10510     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10511
 10512     PERFORM 8400-LOG-JOURNAL-RECORD.
 10513
 10514******************************************************************
 10515*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10516******************************************************************
 10517     display ' made it to add orig cert '
 10518     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10519     MOVE ' '                    TO WS-ERMAIL-SW
 10520
 10521* EXEC CICS READ
 10522*       DATASET   (FILE-ID-ERMAIL)
 10523*       SET       (ADDRESS OF MAILING-DATA)
 10524*       RIDFLD    (ERMAIL-KEY)
 10525*       RESP      (WS-RESPONSE)
 10526*    END-EXEC
 10527*    MOVE '&"S        E          (  N#00010314' TO DFHEIV0
 10528     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10529     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10530     MOVE X'204E233030303130333134' TO DFHEIV0(25:11)
 10531     CALL 'kxdfhei1' USING DFHEIV0,
 10532           FILE-ID-ERMAIL,
 10533           DFHEIV20,
 10534           DFHEIV99,
 10535           ERMAIL-KEY,
 10536           DFHEIV99,
 10537           DFHEIV99,
 10538           DFHEIV99
 10539     SET ADDRESS OF MAILING-DATA TO
 10540         DFHEIV20
 10541     MOVE EIBRESP  TO WS-RESPONSE
 10542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10543     IF RESP-NORMAL
 10544        SET ERMAIL-FOUND TO TRUE
 10545     END-IF
 10546
 10547     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 10548     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10549     MOVE 'OC'                   TO OC-RECORD-ID
 10550     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10551                                 TO OC-CONTROL-PRIMARY (1:33)
 10552     MOVE 'I'                    TO OC-RECORD-TYPE
 10553     MOVE +4096                  TO OC-KEY-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 197
* EL6311.cbl
 10554     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10555     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10556     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10557     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10558     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10559     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10560     MOVE PB-I-AGE               TO OC-INS-AGE
 10561     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10562     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10563     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10564     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10565     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10566     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10567     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10568     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10569     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10570     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10571     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10572     IF PB-I-JOINT-COMMISSION > +0
 10573         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10574     ELSE
 10575         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10576     END-IF
 10577     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10578     MOVE +0                     TO OC-LF-CANCEL-AMT
 10579                                    OC-LF-ITD-CANCEL-AMT
 10580     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10581     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10582     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10583     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10584     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10585     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10586     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10587     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10588     MOVE +0                     TO OC-AH-CANCEL-AMT
 10589                                    OC-AH-ITD-CANCEL-AMT
 10590     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10591     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10592     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10593     IF ERMAIL-FOUND
 10594        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10595     END-IF
 10596     IF NOT CERT-TRL-REC-NOT-FOUND
 10597        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10598                           OC-INS-AGE-DEFAULT-FLAG
 10599        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 10600                           OC-JNT-AGE-DEFAULT-FLAG
 10601     END-IF
 10602     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10603     .
 10604 1275-WRITE-ELCRTO.
 10605
 10606* EXEC CICS WRITE
 10607*       DATASET   ('ELCRTO')
 10608*       FROM      (ORIGINAL-CERTIFICATE)
 10609*       RIDFLD    (OC-CONTROL-PRIMARY)
 10610*       RESP      (WS-RESPONSE)
 10611*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 198
* EL6311.cbl
 10612     MOVE LENGTH OF
 10613      ORIGINAL-CERTIFICATE
 10614       TO DFHEIV11
 10615     MOVE 'ELCRTO' TO DFHEIV1
 10616*    MOVE '&$ L                  ''  N#00010382' TO DFHEIV0
 10617     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10618     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10619     MOVE X'204E233030303130333832' TO DFHEIV0(25:11)
 10620     CALL 'kxdfhei1' USING DFHEIV0,
 10621           DFHEIV1,
 10622           ORIGINAL-CERTIFICATE,
 10623           DFHEIV11,
 10624           OC-CONTROL-PRIMARY,
 10625           DFHEIV99,
 10626           DFHEIV99
 10627     MOVE EIBRESP  TO WS-RESPONSE
 10628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10629     display ' just wrote 1275 ' ws-response
 10630     IF RESP-DUPKEY
 10631        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10632        GO TO 1275-WRITE-ELCRTO
 10633     ELSE
 10634        IF NOT RESP-NORMAL
 10635           MOVE -1               TO BMAINTL
 10636           MOVE ER-7450          TO EMI-ERROR
 10637           PERFORM 9900-ERROR-FORMAT
 10638                                 THRU 9900-EXIT
 10639           GO TO 8200-SEND-DATAONLY
 10640        END-IF
 10641     END-IF
 10642******************************************************************
 10643*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10644******************************************************************
 10645
 10646
 10647* EXEC CICS READ
 10648*        INTO    (PENDING-BUSINESS)
 10649*        DATASET (FILE-ID-ERPNDB)
 10650*        RIDFLD  (ERPNDB-KEY)
 10651*        UPDATE
 10652*    END-EXEC.
 10653     MOVE LENGTH OF
 10654      PENDING-BUSINESS
 10655       TO DFHEIV11
 10656*    MOVE '&"IL       EU         (   #00010405' TO DFHEIV0
 10657     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10658     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10659     MOVE X'2020233030303130343035' TO DFHEIV0(25:11)
 10660     CALL 'kxdfhei1' USING DFHEIV0,
 10661           FILE-ID-ERPNDB,
 10662           PENDING-BUSINESS,
 10663           DFHEIV11,
 10664           ERPNDB-KEY,
 10665           DFHEIV99,
 10666           DFHEIV99,
 10667           DFHEIV99
 10668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10669
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 199
* EL6311.cbl
 10670
 10671     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10672     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10673     MOVE 'B'                    TO JP-RECORD-TYPE.
 10674     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10675
 10676     PERFORM 8400-LOG-JOURNAL-RECORD.
 10677
 10678     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 10679
 10680
 10681* EXEC CICS REWRITE
 10682*        DATASET (FILE-ID-ERPNDB)
 10683*        FROM    (PENDING-BUSINESS)
 10684*    END-EXEC.
 10685     MOVE LENGTH OF
 10686      PENDING-BUSINESS
 10687       TO DFHEIV11
 10688*    MOVE '&& L                  %   #00010421' TO DFHEIV0
 10689     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10690     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10691     MOVE X'2020233030303130343231' TO DFHEIV0(25:11)
 10692     CALL 'kxdfhei1' USING DFHEIV0,
 10693           FILE-ID-ERPNDB,
 10694           PENDING-BUSINESS,
 10695           DFHEIV11,
 10696           DFHEIV99
 10697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10698
 10699
 10700     MOVE 'C'                    TO JP-RECORD-TYPE.
 10701     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10702
 10703     PERFORM 8400-LOG-JOURNAL-RECORD.
 10704
 10705     IF WS-ERRORS-PRESENT
 10706         GO TO 3900-RE-DISPLAY-RECORD.
 10707
 10708     MOVE ZEROS                  TO EMI-ERROR.
 10709     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10710     MOVE LOW-VALUES             TO EL631BI.
 10711     MOVE  -1                    TO BMAINTL.
 10712     GO TO 8100-SEND-INITIAL-MAP.
 10713
 10714 1280-BATCH-HDR-NOT-FOUND.
 10715     MOVE -1                     TO BMAINTL.
 10716     MOVE ER-7450                TO EMI-ERROR.
 10717     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10718     GO TO 8200-SEND-DATAONLY.
 10719
 10720 1290-DUPLICATE-ALT-INDEX.
 10721
 10722******************************************************************
 10723*                                                                *
 10724*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 10725*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 10726*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 10727*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 200
* EL6311.cbl
 10728*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 10729*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 10730*                                                                *
 10731******************************************************************
 10732
 10733     IF LCP-ONCTR-01 =  0
 10734         ADD 1 TO LCP-ONCTR-01
 10735        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 10736
 10737     ADD +1                      TO WS-SEQ-NO-COUNTER.
 10738
 10739     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 10740         NEXT SENTENCE
 10741     ELSE
 10742         ADD +1 TO PB-BATCH-SEQ-NO
 10743                   PB-CSR-BATCH-SEQ-NO
 10744         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 10745         GO TO 1275-WRITE-PENDING-BUSINESS.
 10746
 10747     MOVE -1                     TO BCERTNOL.
 10748     MOVE AL-UABON               TO BCERTNOA.
 10749     MOVE AL-UNBON               TO BEFFDTA.
 10750
 10751     MOVE 1                      TO EMI-SUB
 10752                                    EMI-SWITCH1
 10753                                    EMI-SWITCH-AREA-1
 10754                                    EMI-SWITCH-AREA-2.
 10755
 10756     MOVE SPACES                 TO EMI-ERROR-LINES.
 10757
 10758
 10759* EXEC CICS SYNCPOINT ROLLBACK
 10760*    END-EXEC.
 10761*    MOVE '6"R                   !   #00010484' TO DFHEIV0
 10762     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10763     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10764     MOVE X'2020233030303130343834' TO DFHEIV0(25:11)
 10765     CALL 'kxdfhei1' USING DFHEIV0
 10766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10767
 10768
 10769     MOVE ER-2247                TO EMI-ERROR.
 10770     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10771     GO TO 8200-SEND-DATAONLY.
 10772
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 201
* EL6311.cbl
 10774
 10775
 10776 1295-READ-CERT-TRAILER.
 10777
 10778
 10779* EXEC CICS GETMAIN
 10780*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 10781*        LENGTH  (ELCRTT-RECORD-LENGTH)
 10782*        INITIMG (GETMAIN-SPACE)
 10783*    END-EXEC
 10784*    MOVE ',"IL                  $   #00010496' TO DFHEIV0
 10785     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10786     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10787     MOVE X'2020233030303130343936' TO DFHEIV0(25:11)
 10788     CALL 'kxdfhei1' USING DFHEIV0,
 10789           DFHEIV20,
 10790           ELCRTT-RECORD-LENGTH,
 10791           GETMAIN-SPACE
 10792     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 10793         DFHEIV20
 10794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10795
 10796     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 10797     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 10798     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 10799
 10800
 10801* EXEC CICS HANDLE CONDITION
 10802*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 10803*    END-EXEC.
 10804*    MOVE '"$I                   ! % #00010506' TO DFHEIV0
 10805     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10806     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10807     MOVE X'2520233030303130353036' TO DFHEIV0(25:11)
 10808     CALL 'kxdfhei1' USING DFHEIV0
 10809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10810
 10811
 10812
 10813* EXEC CICS READ
 10814*        DATASET  (CRTT-ID)
 10815*        RIDFLD   (ELCRTT-KEY)
 10816*        INTO     (CERTIFICATE-TRAILERS)
 10817*    END-EXEC.
 10818     MOVE LENGTH OF
 10819      CERTIFICATE-TRAILERS
 10820       TO DFHEIV11
 10821*    MOVE '&"IL       E          (   #00010510' TO DFHEIV0
 10822     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10823     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10824     MOVE X'2020233030303130353130' TO DFHEIV0(25:11)
 10825     CALL 'kxdfhei1' USING DFHEIV0,
 10826           CRTT-ID,
 10827           CERTIFICATE-TRAILERS,
 10828           DFHEIV11,
 10829           ELCRTT-KEY,
 10830           DFHEIV99,
 10831           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 202
* EL6311.cbl
 10832           DFHEIV99
 10833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10834
 10835
 10836     GO TO 1295-EXIT.
 10837
 10838 1295-CERT-TRL-REC-NOTFND.
 10839     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 10840
 10841 1295-EXIT.
 10842     EXIT.
 10843
 10844******************************************************************
 10845*                                                                *
 10846*          C H A N G E   I S S U E   R O U T I N E               *
 10847*                                                                *
 10848******************************************************************
 10849
 10850***************************************************************
 10851*                                                             *
 10852*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 10853*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10854*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 10855*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 10856*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 10857*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 10858*     5. LINK TO THE EDIT ROUTINE.                            *
 10859*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10860*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 10861*              THE EDIT ROUTINE.                              *
 10862*     7. REWRITE THE NEW ISSUE                                *
 10863*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10864*                                                             *
 10865***************************************************************
 10866
 10867 1300-CHANGE-ISSUE-ROUTINE.
 10868     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 10869
 10870     IF BCHGL NOT = ZEROS
 10871        MOVE ER-2196             TO EMI-ERROR
 10872        MOVE AL-UABON            TO BMAINTA
 10873        MOVE -1                  TO BMAINTL
 10874        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10875        GO TO 8200-SEND-DATAONLY.
 10876
 10877     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10878
 10879     IF BSUFIXL NOT = ZEROS
 10880        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10881     ELSE
 10882        MOVE SPACE               TO WS-NEW-SUFFIX.
 10883
 10884     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10885     PERFORM 8600-DEEDIT.
 10886     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10887     MOVE '4'                    TO DC-OPTION-CODE.
 10888     PERFORM 9700-DATE-LINK.
 10889     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 203
* EL6311.cbl
 10890        MOVE ER-0348             TO EMI-ERROR
 10891        MOVE -1                  TO BEFFDTL
 10892        MOVE AL-UABON            TO BEFFDTA
 10893        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10894        GO TO 8200-SEND-DATAONLY
 10895     ELSE
 10896        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10897        MOVE AL-UANON            TO BEFFDTA
 10898        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10899
 10900 1325-PROCESS-ISSUE-CHANGES.
 10901
 10902* EXEC CICS HANDLE CONDITION
 10903*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 10904*    END-EXEC.
 10905*    MOVE '"$I                   ! & #00010581' TO DFHEIV0
 10906     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10907     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10908     MOVE X'2620233030303130353831' TO DFHEIV0(25:11)
 10909     CALL 'kxdfhei1' USING DFHEIV0
 10910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10911
 10912
 10913     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 10914     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 10915     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 10916
 10917
 10918* EXEC CICS GETMAIN
 10919*        SET      (ADDRESS OF PENDING-BUSINESS)
 10920*        LENGTH   (ERPNDB-RECORD-LENGTH)
 10921*        INITIMG  (GETMAIN-SPACE)
 10922*     END-EXEC.
 10923*    MOVE ',"IL                  $   #00010589' TO DFHEIV0
 10924     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10925     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10926     MOVE X'2020233030303130353839' TO DFHEIV0(25:11)
 10927     CALL 'kxdfhei1' USING DFHEIV0,
 10928           DFHEIV20,
 10929           ERPNDB-RECORD-LENGTH,
 10930           GETMAIN-SPACE
 10931     SET ADDRESS OF PENDING-BUSINESS TO
 10932         DFHEIV20
 10933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10934
 10935
 10936
 10937* EXEC CICS READ
 10938*        INTO    (PENDING-BUSINESS)
 10939*        DATASET (FILE-ID-ERPNDB)
 10940*        RIDFLD  (ERPNDB-KEY)
 10941*    END-EXEC.
 10942     MOVE LENGTH OF
 10943      PENDING-BUSINESS
 10944       TO DFHEIV11
 10945*    MOVE '&"IL       E          (   #00010595' TO DFHEIV0
 10946     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10947     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 204
* EL6311.cbl
 10948     MOVE X'2020233030303130353935' TO DFHEIV0(25:11)
 10949     CALL 'kxdfhei1' USING DFHEIV0,
 10950           FILE-ID-ERPNDB,
 10951           PENDING-BUSINESS,
 10952           DFHEIV11,
 10953           ERPNDB-KEY,
 10954           DFHEIV99,
 10955           DFHEIV99,
 10956           DFHEIV99
 10957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10958
 10959
 10960     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10961
 10962
 10963* EXEC CICS HANDLE CONDITION
 10964*         NOTFND     (1385-REC-NOT-FOUND)
 10965*    END-EXEC.
 10966*    MOVE '"$I                   ! '' #00010603' TO DFHEIV0
 10967     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10968     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10969     MOVE X'2720233030303130363033' TO DFHEIV0(25:11)
 10970     CALL 'kxdfhei1' USING DFHEIV0
 10971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10972
 10973
 10974**********************************************************
 10975*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 10976*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 10977**********************************************************
 10978
 10979
 10980* EXEC CICS READ
 10981*        DATASET (FILE-ID-ERPNDB)
 10982*        INTO    (PENDING-BUSINESS)
 10983*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 10984*    END-EXEC.
 10985     MOVE LENGTH OF
 10986      PENDING-BUSINESS
 10987       TO DFHEIV11
 10988*    MOVE '&"IL       E          (   #00010612' TO DFHEIV0
 10989     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10990     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10991     MOVE X'2020233030303130363132' TO DFHEIV0(25:11)
 10992     CALL 'kxdfhei1' USING DFHEIV0,
 10993           FILE-ID-ERPNDB,
 10994           PENDING-BUSINESS,
 10995           DFHEIV11,
 10996           PI-PREV-CONTROL-PRIMARY,
 10997           DFHEIV99,
 10998           DFHEIV99,
 10999           DFHEIV99
 11000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11001
 11002
 11003********** DO NOT ALLOW CHANGES IF THRU A/R
 11004     IF BMAINTI = 'C'
 11005         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 205
* EL6311.cbl
 11006             MOVE ER-4005          TO EMI-ERROR
 11007             MOVE -1               TO BMAINTL
 11008             MOVE AL-UABON         TO BMAINTA
 11009             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11010             GO TO 8200-SEND-DATAONLY.
 11011**********
 11012
 11013     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11014        MOVE -1                 TO BMAINTL
 11015        MOVE ER-2197            TO EMI-ERROR
 11016        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11017        GO TO 8200-SEND-DATAONLY.
 11018
 11019     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11020        MOVE ER-2196             TO EMI-ERROR
 11021        MOVE AL-UABON            TO BMAINTA
 11022        MOVE -1                  TO BMAINTL
 11023        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11024        GO TO 8200-SEND-DATAONLY.
 11025
 11026     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11027
 11028     IF PB-BILLED-DT = LOW-VALUES AND
 11029        PB-CHG-COUNT = ZEROS
 11030        NEXT SENTENCE
 11031     ELSE
 11032        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11033            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11034           OR
 11035           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11036            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11037           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11038
 11039
 11040* EXEC CICS READ
 11041*        DATASET (FILE-ID-ERPNDB)
 11042*        INTO    (PENDING-BUSINESS)
 11043*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11044*        UPDATE
 11045*    END-EXEC.
 11046     MOVE LENGTH OF
 11047      PENDING-BUSINESS
 11048       TO DFHEIV11
 11049*    MOVE '&"IL       EU         (   #00010654' TO DFHEIV0
 11050     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11051     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11052     MOVE X'2020233030303130363534' TO DFHEIV0(25:11)
 11053     CALL 'kxdfhei1' USING DFHEIV0,
 11054           FILE-ID-ERPNDB,
 11055           PENDING-BUSINESS,
 11056           DFHEIV11,
 11057           PI-PREV-CONTROL-PRIMARY,
 11058           DFHEIV99,
 11059           DFHEIV99,
 11060           DFHEIV99
 11061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11062
 11063
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 206
* EL6311.cbl
 11064     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11065     MOVE 'B'                    TO JP-RECORD-TYPE
 11066     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11067     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11068
 11069     PERFORM 8400-LOG-JOURNAL-RECORD.
 11070
 11071     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11072        PB-CHG-COUNT NOT = ZEROS
 11073        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11074            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11075           OR
 11076           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11077            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11078            MOVE LOW-VALUES             TO PB-BILLED-DT
 11079            ADD +1                      TO PB-CHG-COUNT.
 11080
 11081     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11082     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11083     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11084     MOVE '5'                    TO DC-OPTION-CODE.
 11085     PERFORM 9700-DATE-LINK
 11086     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11087
 11088*    IF BMICRNOL  GREATER  ZEROS
 11089*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11090
 11091     IF BVINL > ZEROS
 11092        MOVE BVINI               TO PB-I-VIN
 11093     END-IF
 11094     IF (BFORCEL NOT = ZEROS)
 11095        AND (PB-COMPANY-ID = 'DCC')
 11096        AND (BFORCEI = ' ')
 11097        AND (PB-FORCE-CODE = 'O')
 11098        COMPUTE PB-I-AH-PREMIUM-AMT =
 11099           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11100        PERFORM 1800-REMOVE-CERT-NOTES
 11101                                 THRU 1800-EXIT
 11102        PERFORM 1900-DELETE-ERPYAJ
 11103                                 THRU 1900-EXIT
 11104        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11105     END-IF
 11106     IF (BFORCEL NOT = ZEROS)
 11107        AND (PB-COMPANY-ID = 'DCC')
 11108        AND (BFORCEI = 'O')
 11109        AND (PB-FORCE-CODE NOT = 'O')
 11110        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11111           PB-I-AH-PREM-CALC
 11112        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11113        MOVE SPACE               TO DC-OPTION-CODE
 11114        PERFORM 9700-DATE-LINK
 11115        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11116        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11117        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11118        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11119        PERFORM 1500-UPDATE-ERNOTE
 11120                                 THRU 1500-EXIT
 11121        PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 207
* EL6311.cbl
 11122                                 THRU 1600-EXIT
 11123     END-IF
 11124     IF BLSTNML  GREATER THAN ZEROS
 11125         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11126
 11127     IF B1STNML  GREATER THAN ZEROS
 11128         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11129
 11130     IF BINITL   GREATER THAN ZEROS
 11131         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11132
 11133     IF BBIRTHL  GREATER THAN ZERO
 11134         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11135
 11136     IF B1STPMTL GREATER THAN ZERO
 11137         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11138
 11139     IF BAGEL    GREATER THAN ZEROS
 11140         MOVE BAGEI              TO PB-I-AGE.
 11141
 11142     MOVE 'N'                    TO WS-INS-AGE-SET
 11143                                    WS-JNT-AGE-SET.
 11144     IF BAGEL    GREATER THAN ZEROS
 11145        MOVE 'Y'                TO WS-INS-AGE-SET
 11146        IF BAGEI = ZERO AND
 11147             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11148           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11149           MOVE 'AGE*'          TO BAGEDEFO
 11150        ELSE
 11151           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11152           MOVE 'AGE '          TO BAGEDEFO
 11153        END-IF
 11154        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11155     END-IF.
 11156
 11157     IF BSEXL    GREATER THAN ZEROS
 11158         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11159
 11160     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11161        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11162
 11163     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11164        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11165
 11166     IF BLNTRML  GREATER THAN ZEROS
 11167         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11168
 11169     IF BFREQL   GREATER THAN ZEROS
 11170         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11171
 11172     IF BSKPCDL  GREATER THAN ZEROS
 11173         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11174
 11175     IF BMODEL   GREATER THAN ZEROS
 11176         MOVE BMODEI             TO PB-I-TERM-TYPE
 11177                                    PI-BMODE.
 11178
 11179     IF BPMTSL   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 208
* EL6311.cbl
 11180         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11181                                    PI-BPMTS.
 11182
 11183     IF BPMTAMTL GREATER THAN ZEROS
 11184         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11185
 11186     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11187         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11188
 11189     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11190         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11191
 11192     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11193
 11194     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11195         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11196            SUBTRACT PB-I-LF-PREMIUM-AMT
 11197                     FROM WS-B-LF-ISS-PRM-ENTERED
 11198            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11199            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11200            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11201         ELSE
 11202            MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11203            MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11204
 11205     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11206            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11207                     FROM WS-B-LF-ISS-PRM-ENTERED
 11208         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11209         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11210
 11211     IF  BALT-PREM-LEN     (2)  > ZEROS
 11212         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11213
 11214     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11215         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11216
 11217     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11218         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11219            SUBTRACT PB-I-AH-PREMIUM-AMT
 11220                     FROM WS-B-AH-ISS-PRM-ENTERED
 11221            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11222            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11223            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11224         ELSE
 11225            MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11226            MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11227
 11228     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11229        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11230
 11231     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11232        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11233
 11234     IF BINDGRPL            GREATER THAN ZEROS
 11235         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11236
 11237     IF BRTCLSL             GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 209
* EL6311.cbl
 11238         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11239
 11240     IF BSIGL               GREATER THAN ZEROS
 11241         MOVE BSIGI              TO PB-I-SIG-SW.
 11242
 11243     IF BAPRL               GREATER THAN ZEROS
 11244         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11245
 11246     IF BMEMBERL            GREATER THAN ZEROS
 11247         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11248
 11249     IF BLNOFCRL            GREATER THAN ZEROS
 11250         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11251
 11252     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11253        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11254
 11255     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11256        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11257
 11258     IF BDAYSL              GREATER THAN ZEROS
 11259        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11260                                    PB-I-EXTENTION-DAYS.
 11261
 11262     IF BDAYSL GREATER THAN ZEROS
 11263        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 11264
 11265     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11266        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11267           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11268
 11269     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11270        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11271           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11272
 11273     IF B1STPMTL GREATER THAN ZEROS
 11274        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11275
 11276     IF PB-EXT-DAYS-PROCESSING
 11277        IF PB-I-EXTENTION-DAYS = ZEROS
 11278           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11279
 11280     IF PB-EXPIRE-DT-PROCESSING
 11281        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11282           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11283             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11284
 11285     IF PB-1ST-PMT-DT-PROCESSING
 11286        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11287           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11288
 11289     IF BREINL GREATER THAN ZEROS
 11290        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11291
 11292     IF BFORCEL NOT = ZEROS
 11293        MOVE BFORCEI             TO PB-FORCE-CODE.
 11294     IF (BENTRYL NOT = ZEROS)
 11295        AND (PB-COMPANY-ID = 'CID')
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 210
* EL6311.cbl
 11296        AND (PB-STATE = 'VA')
 11297        AND (BENTRYI NOT = 'P')
 11298        AND (PB-BATCH-ENTRY = 'P')
 11299        PERFORM 1800-REMOVE-CERT-NOTES
 11300                                 THRU 1800-EXIT
 11301     END-IF
 11302     IF BENTRYL NOT = ZEROS
 11303        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11304        IF PI-COMPANY-ID = 'CID'
 11305           AND (PB-BATCH-ENTRY = 'P')
 11306           AND (PB-STATE = 'VA')
 11307           PERFORM 1500-UPDATE-ERNOTE
 11308                                 THRU 1500-EXIT
 11309        END-IF
 11310     END-IF
 11311
 11312     IF BUNWRITL NOT = ZEROS
 11313        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11314
 11315     IF BBILCDL NOT = ZEROS
 11316        MOVE BBILCDI             TO PB-RECORD-BILL.
 11317
 11318     IF BLIVESL GREATER THAN ZEROS
 11319        MOVE WS-BLIVES           TO PB-I-LIVES.
 11320
 11321
 11322*DMD CUSTOM CODING*************START
 11323     IF PI-COMPANY-ID NOT = 'DMD'
 11324         MOVE ZEROS               TO BBILLEDL.
 11325*DMD CUSTOM CODING*************END
 11326
 11327     IF BBILLEDL GREATER THAN ZEROS
 11328        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11329
 11330
 11331*****************************************************************
 11332*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11333*****************************************************************
 11334
 11335     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11336        IF BTYPE  (1)   = ZEROS OR SPACES
 11337           IF REMOVE-LF-COVERAGE
 11338               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11339                                        PI-BTYPE (1)
 11340               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11341                                        WS-B-LF-ISS-PRM-ENTERED
 11342               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11343                                        WS-B-LF-ISS-PRM-ENTERED
 11344               SUBTRACT PB-I-LF-PREM-CALC FROM
 11345                                        WS-B-LF-ISS-PRM-COMPUTED
 11346               MOVE ZEROS            TO PB-I-LF-TERM
 11347                                        PB-I-LF-BENEFIT-AMT
 11348                                        PB-I-LF-PREMIUM-AMT
 11349                                        PB-I-LF-BENEFIT-CD
 11350                                        PB-I-LF-PREM-CALC
 11351                                        PB-I-LF-CRIT-PER
 11352                                        PB-I-LF-ALT-BENEFIT-AMT
 11353                                        PB-I-LF-ALT-PREMIUM-AMT
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 211
* EL6311.cbl
 11354               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11355           ELSE
 11356               NEXT SENTENCE
 11357        ELSE
 11358           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11359                                    PI-BTYPE (1).
 11360     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11361        IF BTYPE  (2)   = ZEROS OR SPACES
 11362           IF  REMOVE-AH-COVERAGE
 11363               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11364                                        PI-BTYPE (2)
 11365               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11366                                        WS-B-AH-ISS-PRM-ENTERED
 11367               SUBTRACT PB-I-AH-PREM-CALC FROM
 11368                                        WS-B-AH-ISS-PRM-COMPUTED
 11369               MOVE ZEROS            TO PB-I-AH-TERM
 11370                                        PB-I-AH-BENEFIT-AMT
 11371                                        PB-I-AH-PREMIUM-AMT
 11372                                        PB-I-AH-BENEFIT-CD
 11373                                        PB-I-AH-PREM-CALC
 11374                                        PB-I-AH-CRIT-PER
 11375               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11376           ELSE
 11377               NEXT SENTENCE
 11378        ELSE
 11379           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11380                                    PI-BTYPE (2).
 11381 1360-REWRITE-PB-RECORD.
 11382     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11383
 11384     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11385     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11386
 11387     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11388
 11389     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11390     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11391
 11392     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11393         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11394
 11395     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11396         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11397
 11398     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11399
 11400     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11401
 11402     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11403
 11404     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11405     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11406     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11407
 11408     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11409     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11410
 11411 1375-REWRITE-PB-RECORD.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 212
* EL6311.cbl
 11412     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11413     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11414     MOVE 'C'                    TO JP-RECORD-TYPE.
 11415     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11416
 11417
 11418* EXEC CICS REWRITE
 11419*        DATASET (FILE-ID-ERPNDB)
 11420*        FROM    (PENDING-BUSINESS)
 11421*    END-EXEC.
 11422     MOVE LENGTH OF
 11423      PENDING-BUSINESS
 11424       TO DFHEIV11
 11425*    MOVE '&& L                  %   #00011014' TO DFHEIV0
 11426     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11427     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11428     MOVE X'2020233030303131303134' TO DFHEIV0(25:11)
 11429     CALL 'kxdfhei1' USING DFHEIV0,
 11430           FILE-ID-ERPNDB,
 11431           PENDING-BUSINESS,
 11432           DFHEIV11,
 11433           DFHEIV99
 11434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11435
 11436
 11437     PERFORM 8400-LOG-JOURNAL-RECORD.
 11438******************************************************************
 11439*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11440******************************************************************
 11441     display ' made it to update orig cert '
 11442     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11443     MOVE ' '                    TO WS-ERMAIL-SW
 11444
 11445* EXEC CICS READ
 11446*       DATASET   (FILE-ID-ERMAIL)
 11447*       SET       (ADDRESS OF MAILING-DATA)
 11448*       RIDFLD    (ERMAIL-KEY)
 11449*       RESP      (WS-RESPONSE)
 11450*    END-EXEC
 11451*    MOVE '&"S        E          (  N#00011026' TO DFHEIV0
 11452     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11453     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11454     MOVE X'204E233030303131303236' TO DFHEIV0(25:11)
 11455     CALL 'kxdfhei1' USING DFHEIV0,
 11456           FILE-ID-ERMAIL,
 11457           DFHEIV20,
 11458           DFHEIV99,
 11459           ERMAIL-KEY,
 11460           DFHEIV99,
 11461           DFHEIV99,
 11462           DFHEIV99
 11463     SET ADDRESS OF MAILING-DATA TO
 11464         DFHEIV20
 11465     MOVE EIBRESP  TO WS-RESPONSE
 11466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11467     IF RESP-NORMAL
 11468        SET ERMAIL-FOUND TO TRUE
 11469     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 213
* EL6311.cbl
 11470
 11471     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11472     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11473                                 TO ELCRTO-KEY
 11474     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11475     MOVE +0                     TO ELCRTO-SEQ-NO
 11476
 11477* EXEC CICS READ
 11478*       DATASET   ('ELCRTO')
 11479*       INTO      (ORIGINAL-CERTIFICATE)
 11480*       RIDFLD    (ELCRTO-KEY)
 11481*       GTEQ
 11482*       RESP      (WS-RESPONSE)
 11483*    END-EXEC
 11484     MOVE LENGTH OF
 11485      ORIGINAL-CERTIFICATE
 11486       TO DFHEIV11
 11487     MOVE 'ELCRTO' TO DFHEIV1
 11488*    MOVE '&"IL       G          (  N#00011041' TO DFHEIV0
 11489     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11490     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11491     MOVE X'204E233030303131303431' TO DFHEIV0(25:11)
 11492     CALL 'kxdfhei1' USING DFHEIV0,
 11493           DFHEIV1,
 11494           ORIGINAL-CERTIFICATE,
 11495           DFHEIV11,
 11496           ELCRTO-KEY,
 11497           DFHEIV99,
 11498           DFHEIV99,
 11499           DFHEIV99
 11500     MOVE EIBRESP  TO WS-RESPONSE
 11501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11502     display ' just read gteq ' ws-response
 11503     IF RESP-NORMAL
 11504        AND (OC-CONTROL-PRIMARY (1:33) =
 11505                 PB-CONTROL-BY-ACCOUNT (1:33))
 11506        AND (OC-RECORD-TYPE = 'I')
 11507        display ' resp norm, key =, type i '
 11508        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11509           display ' end proc blank '
 11510           display ' csr edit session ' PI-CSR-SESSION-SW
 11511           IF NOT CSR-EDIT-SESSION
 11512
 11513* EXEC CICS READ
 11514*                DATASET   ('ELCRTO')
 11515*                INTO      (ORIGINAL-CERTIFICATE)
 11516*                RIDFLD    (OC-CONTROL-PRIMARY)
 11517*                UPDATE
 11518*                RESP      (WS-RESPONSE)
 11519*             END-EXEC
 11520     MOVE LENGTH OF
 11521      ORIGINAL-CERTIFICATE
 11522       TO DFHEIV11
 11523     MOVE 'ELCRTO' TO DFHEIV1
 11524*    MOVE '&"IL       EU         (  N#00011058' TO DFHEIV0
 11525     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11526     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11527     MOVE X'204E233030303131303538' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 214
* EL6311.cbl
 11528     CALL 'kxdfhei1' USING DFHEIV0,
 11529           DFHEIV1,
 11530           ORIGINAL-CERTIFICATE,
 11531           DFHEIV11,
 11532           OC-CONTROL-PRIMARY,
 11533           DFHEIV99,
 11534           DFHEIV99,
 11535           DFHEIV99
 11536     MOVE EIBRESP  TO WS-RESPONSE
 11537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11538              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11539              IF RESP-NORMAL
 11540                 display ' good read upd '
 11541                 MOVE PB-I-INSURED-LAST-NAME TO
 11542                         OC-INS-LAST-NAME
 11543                 MOVE PB-I-INSURED-FIRST-NAME TO
 11544                         OC-INS-FIRST-NAME
 11545                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11546                         OC-INS-MIDDLE-INIT
 11547                 MOVE PB-I-AGE         TO OC-INS-AGE
 11548                 MOVE PB-I-JOINT-LAST-NAME   TO
 11549                         OC-JNT-LAST-NAME
 11550                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11551                         OC-JNT-FIRST-NAME
 11552                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11553                         OC-JNT-MIDDLE-INIT
 11554                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11555                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11556                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11557                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11558                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11559                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11560                         OC-LF-ALT-BEN-AMT
 11561                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11562                         OC-LF-ALT-PRM-AMT
 11563                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11564                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11565                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11566                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11567                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11568                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11569                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11570                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11571                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11572                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11573                 IF OC-CANCEL-TRAN-IND = 'N'
 11574                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 11575                    MOVE +0            TO OC-LF-CANCEL-AMT
 11576                                          OC-LF-ITD-CANCEL-AMT
 11577                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 11578                    MOVE +0            TO OC-AH-CANCEL-AMT
 11579                                          OC-AH-ITD-CANCEL-AMT
 11580                 END-IF
 11581                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11582                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11583                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11584                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11585                 IF ERMAIL-FOUND
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 215
* EL6311.cbl
 11586                    MOVE MA-CRED-BENE-NAME
 11587                                 TO OC-CRED-BENE-NAME
 11588                 END-IF
 11589                 IF NOT CERT-TRL-REC-NOT-FOUND
 11590                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11591                           OC-INS-AGE-DEFAULT-FLAG
 11592                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11593                           OC-JNT-AGE-DEFAULT-FLAG
 11594                 END-IF
 11595
 11596* EXEC CICS REWRITE
 11597*                   DATASET   ('ELCRTO')
 11598*                   FROM      (ORIGINAL-CERTIFICATE)
 11599*                   RESP      (WS-RESPONSE)
 11600*                END-EXEC
 11601     MOVE LENGTH OF
 11602      ORIGINAL-CERTIFICATE
 11603       TO DFHEIV11
 11604     MOVE 'ELCRTO' TO DFHEIV1
 11605*    MOVE '&& L                  %  N#00011122' TO DFHEIV0
 11606     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11607     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11608     MOVE X'204E233030303131313232' TO DFHEIV0(25:11)
 11609     CALL 'kxdfhei1' USING DFHEIV0,
 11610           DFHEIV1,
 11611           ORIGINAL-CERTIFICATE,
 11612           DFHEIV11,
 11613           DFHEIV99
 11614     MOVE EIBRESP  TO WS-RESPONSE
 11615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11616                 display ' just rewrote ' ws-response
 11617              END-IF
 11618           END-IF
 11619        ELSE
 11620           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 11621           MOVE 'OC'             TO OC-RECORD-ID
 11622           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11623           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11624           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11625           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11626           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11627           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11628           MOVE PB-I-AGE         TO OC-INS-AGE
 11629           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11630           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11631           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11632           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11633           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11634           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11635           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11636           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11637           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11638           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11639           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11640           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11641           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11642           MOVE +0               TO OC-LF-CANCEL-AMT
 11643                                    OC-LF-ITD-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 216
* EL6311.cbl
 11644           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11645           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11646           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11647           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11648           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11649           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11650           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11651           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11652           MOVE +0               TO OC-AH-CANCEL-AMT
 11653                                    OC-AH-ITD-CANCEL-AMT
 11654           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11655           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11656           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 11657           IF ERMAIL-FOUND
 11658              MOVE MA-CRED-BENE-NAME
 11659                                 TO OC-CRED-BENE-NAME
 11660           END-IF
 11661           IF NOT CERT-TRL-REC-NOT-FOUND
 11662              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11663                           OC-INS-AGE-DEFAULT-FLAG
 11664              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11665                           OC-JNT-AGE-DEFAULT-FLAG
 11666           END-IF
 11667           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 11668
 11669* EXEC CICS WRITE
 11670*             DATASET   ('ELCRTO')
 11671*             FROM      (ORIGINAL-CERTIFICATE)
 11672*             RIDFLD    (OC-CONTROL-PRIMARY)
 11673*             RESP      (WS-RESPONSE)
 11674*          END-EXEC
 11675     MOVE LENGTH OF
 11676      ORIGINAL-CERTIFICATE
 11677       TO DFHEIV11
 11678     MOVE 'ELCRTO' TO DFHEIV1
 11679*    MOVE '&$ L                  ''  N#00011179' TO DFHEIV0
 11680     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11681     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11682     MOVE X'204E233030303131313739' TO DFHEIV0(25:11)
 11683     CALL 'kxdfhei1' USING DFHEIV0,
 11684           DFHEIV1,
 11685           ORIGINAL-CERTIFICATE,
 11686           DFHEIV11,
 11687           OC-CONTROL-PRIMARY,
 11688           DFHEIV99,
 11689           DFHEIV99
 11690     MOVE EIBRESP  TO WS-RESPONSE
 11691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11692        END-IF
 11693     ELSE
 11694        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 11695        MOVE 'OC'                TO OC-RECORD-ID
 11696        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11697                                 TO OC-CONTROL-PRIMARY (1:33)
 11698        MOVE 'I'                 TO OC-RECORD-TYPE
 11699        MOVE +4096               TO OC-KEY-SEQ-NO
 11700        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 11701        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 217
* EL6311.cbl
 11702        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 11703        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11704        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11705        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11706        MOVE PB-I-AGE            TO OC-INS-AGE
 11707        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11708        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11709        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11710        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 11711        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 11712        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 11713        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11714        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11715        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11716        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11717        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 11718        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11719        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 11720        MOVE +0                  TO OC-LF-CANCEL-AMT
 11721                                    OC-LF-ITD-CANCEL-AMT
 11722        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 11723        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 11724        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11725        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11726        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 11727        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 11728        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 11729        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 11730        MOVE +0                  TO OC-AH-CANCEL-AMT
 11731                                    OC-AH-ITD-CANCEL-AMT
 11732        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 11733        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 11734        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 11735        IF ERMAIL-FOUND
 11736           MOVE MA-CRED-BENE-NAME
 11737                                 TO OC-CRED-BENE-NAME
 11738        END-IF
 11739        IF NOT CERT-TRL-REC-NOT-FOUND
 11740           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11741                           OC-INS-AGE-DEFAULT-FLAG
 11742           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11743                           OC-JNT-AGE-DEFAULT-FLAG
 11744        END-IF
 11745        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 11746
 11747* EXEC CICS WRITE
 11748*          DATASET   ('ELCRTO')
 11749*          FROM      (ORIGINAL-CERTIFICATE)
 11750*          RIDFLD    (OC-CONTROL-PRIMARY)
 11751*          RESP      (WS-RESPONSE)
 11752*       END-EXEC
 11753     MOVE LENGTH OF
 11754      ORIGINAL-CERTIFICATE
 11755       TO DFHEIV11
 11756     MOVE 'ELCRTO' TO DFHEIV1
 11757*    MOVE '&$ L                  ''  N#00011239' TO DFHEIV0
 11758     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11759     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 218
* EL6311.cbl
 11760     MOVE X'204E233030303131323339' TO DFHEIV0(25:11)
 11761     CALL 'kxdfhei1' USING DFHEIV0,
 11762           DFHEIV1,
 11763           ORIGINAL-CERTIFICATE,
 11764           DFHEIV11,
 11765           OC-CONTROL-PRIMARY,
 11766           DFHEIV99,
 11767           DFHEIV99
 11768     MOVE EIBRESP  TO WS-RESPONSE
 11769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11770     END-IF
 11771******************************************************************
 11772*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11773******************************************************************
 11774
 11775     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 11776     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 11777
 11778
 11779* EXEC CICS READ
 11780*        INTO    (PENDING-BUSINESS)
 11781*        DATASET (FILE-ID-ERPNDB)
 11782*        RIDFLD  (ERPNDB-KEY)
 11783*        UPDATE
 11784*    END-EXEC.
 11785     MOVE LENGTH OF
 11786      PENDING-BUSINESS
 11787       TO DFHEIV11
 11788*    MOVE '&"IL       EU         (   #00011253' TO DFHEIV0
 11789     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11790     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11791     MOVE X'2020233030303131323533' TO DFHEIV0(25:11)
 11792     CALL 'kxdfhei1' USING DFHEIV0,
 11793           FILE-ID-ERPNDB,
 11794           PENDING-BUSINESS,
 11795           DFHEIV11,
 11796           ERPNDB-KEY,
 11797           DFHEIV99,
 11798           DFHEIV99,
 11799           DFHEIV99
 11800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11801
 11802
 11803     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 11804     MOVE 'B'                    TO JP-RECORD-TYPE.
 11805     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11806
 11807     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11808
 11809     PERFORM 8400-LOG-JOURNAL-RECORD.
 11810
 11811     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 11812
 11813     MOVE 'C'                    TO JP-RECORD-TYPE.
 11814     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11815
 11816
 11817* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 219
* EL6311.cbl
 11818*        DATASET    (FILE-ID-ERPNDB)
 11819*        FROM       (PENDING-BUSINESS)
 11820*    END-EXEC.
 11821     MOVE LENGTH OF
 11822      PENDING-BUSINESS
 11823       TO DFHEIV11
 11824*    MOVE '&& L                  %   #00011273' TO DFHEIV0
 11825     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11826     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11827     MOVE X'2020233030303131323733' TO DFHEIV0(25:11)
 11828     CALL 'kxdfhei1' USING DFHEIV0,
 11829           FILE-ID-ERPNDB,
 11830           PENDING-BUSINESS,
 11831           DFHEIV11,
 11832           DFHEIV99
 11833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11834
 11835
 11836     PERFORM 8400-LOG-JOURNAL-RECORD.
 11837
 11838     IF WS-ERRORS-PRESENT
 11839        GO TO 3900-RE-DISPLAY-RECORD.
 11840
 11841     MOVE ZEROS                  TO EMI-ERROR.
 11842     MOVE -1                     TO BMAINTL.
 11843     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11844     GO TO 3900-RE-DISPLAY-RECORD.
 11845
 11846 1380-BATCH-HDR-NOT-FOUND.
 11847     MOVE -1                     TO BMAINTL.
 11848     MOVE ER-7450                TO EMI-ERROR.
 11849     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11850     GO TO 8200-SEND-DATAONLY.
 11851
 11852 1385-REC-NOT-FOUND.
 11853     MOVE -1                     TO BMAINTL.
 11854     MOVE ER-7451                TO EMI-ERROR.
 11855     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11856     GO TO 8200-SEND-DATAONLY.
 11857
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 220
* EL6311.cbl
 11859
 11860 1386-UPDATE-AGE-FLAGS.
 11861
 11862
 11863* EXEC CICS GETMAIN
 11864*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11865*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11866*        INITIMG (GETMAIN-SPACE)
 11867*    END-EXEC
 11868*    MOVE ',"IL                  $   #00011304' TO DFHEIV0
 11869     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11870     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11871     MOVE X'2020233030303131333034' TO DFHEIV0(25:11)
 11872     CALL 'kxdfhei1' USING DFHEIV0,
 11873           DFHEIV20,
 11874           ELCRTT-RECORD-LENGTH,
 11875           GETMAIN-SPACE
 11876     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11877         DFHEIV20
 11878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11879
 11880
 11881* EXEC CICS HANDLE CONDITION
 11882*        NOTFND   (1386-NOTFND)
 11883*    END-EXEC.
 11884*    MOVE '"$I                   ! ( #00011310' TO DFHEIV0
 11885     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11886     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11887     MOVE X'2820233030303131333130' TO DFHEIV0(25:11)
 11888     CALL 'kxdfhei1' USING DFHEIV0
 11889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11890
 11891
 11892     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 11893     MOVE 'C'                TO ELCRTT-REC-TYPE
 11894
 11895
 11896* EXEC CICS READ
 11897*        UPDATE
 11898*        DATASET  (CRTT-ID)
 11899*        RIDFLD   (ELCRTT-KEY)
 11900*        INTO     (CERTIFICATE-TRAILERS)
 11901*    END-EXEC.
 11902     MOVE LENGTH OF
 11903      CERTIFICATE-TRAILERS
 11904       TO DFHEIV11
 11905*    MOVE '&"IL       EU         (   #00011317' TO DFHEIV0
 11906     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11907     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11908     MOVE X'2020233030303131333137' TO DFHEIV0(25:11)
 11909     CALL 'kxdfhei1' USING DFHEIV0,
 11910           CRTT-ID,
 11911           CERTIFICATE-TRAILERS,
 11912           DFHEIV11,
 11913           ELCRTT-KEY,
 11914           DFHEIV99,
 11915           DFHEIV99,
 11916           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 221
* EL6311.cbl
 11917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11918
 11919
 11920     IF WS-INS-AGE-SET = 'Y'
 11921        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 11922     END-IF
 11923     IF WS-JNT-AGE-SET = 'Y'
 11924        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 11925     END-IF
 11926
 11927
 11928* EXEC CICS REWRITE
 11929*       DATASET  (CRTT-ID)
 11930*       FROM     (CERTIFICATE-TRAILERS)
 11931*    END-EXEC.
 11932     MOVE LENGTH OF
 11933      CERTIFICATE-TRAILERS
 11934       TO DFHEIV11
 11935*    MOVE '&& L                  %   #00011331' TO DFHEIV0
 11936     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11937     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11938     MOVE X'2020233030303131333331' TO DFHEIV0(25:11)
 11939     CALL 'kxdfhei1' USING DFHEIV0,
 11940           CRTT-ID,
 11941           CERTIFICATE-TRAILERS,
 11942           DFHEIV11,
 11943           DFHEIV99
 11944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11945
 11946
 11947     GO TO 1386-EXIT.
 11948
 11949 1386-NOTFND.
 11950
 11951     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 11952     MOVE 'CS'         TO CS-RECORD-ID.
 11953     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 11954     MOVE 'C'          TO ELCRTT-REC-TYPE.
 11955     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 11956     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 11957     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 11958
 11959* EXEC CICS WRITE
 11960*       DATASET  (CRTT-ID)
 11961*       RIDFLD   (ELCRTT-KEY)
 11962*       FROM     (CERTIFICATE-TRAILERS)
 11963*    END-EXEC.
 11964     MOVE LENGTH OF
 11965      CERTIFICATE-TRAILERS
 11966       TO DFHEIV11
 11967*    MOVE '&$ L                  ''   #00011347' TO DFHEIV0
 11968     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11969     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11970     MOVE X'2020233030303131333437' TO DFHEIV0(25:11)
 11971     CALL 'kxdfhei1' USING DFHEIV0,
 11972           CRTT-ID,
 11973           CERTIFICATE-TRAILERS,
 11974           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 222
* EL6311.cbl
 11975           ELCRTT-KEY,
 11976           DFHEIV99,
 11977           DFHEIV99
 11978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11979
 11980
 11981 1386-EXIT.
 11982     EXIT.
 11983
 11984 1390-UPDATE-ERPNDM.
 11985
 11986
 11987* EXEC CICS HANDLE CONDITION
 11988*        NOTFND (1399-EXIT)
 11989*    END-EXEC.
 11990*    MOVE '"$I                   ! ) #00011358' TO DFHEIV0
 11991     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11992     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11993     MOVE X'2920233030303131333538' TO DFHEIV0(25:11)
 11994     CALL 'kxdfhei1' USING DFHEIV0
 11995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11996
 11997
 11998     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 11999
 12000
 12001* EXEC CICS READ
 12002*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12003*        DATASET (FILE-ID-ERPNDM)
 12004*        RIDFLD  (ERPNDM-KEY)
 12005*        UPDATE
 12006*    END-EXEC.
 12007*    MOVE '&"S        EU         (   #00011364' TO DFHEIV0
 12008     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12009     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12010     MOVE X'2020233030303131333634' TO DFHEIV0(25:11)
 12011     CALL 'kxdfhei1' USING DFHEIV0,
 12012           FILE-ID-ERPNDM,
 12013           DFHEIV20,
 12014           DFHEIV99,
 12015           ERPNDM-KEY,
 12016           DFHEIV99,
 12017           DFHEIV99,
 12018           DFHEIV99
 12019     SET ADDRESS OF PENDING-MAILING-DATA TO
 12020         DFHEIV20
 12021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12022
 12023
 12024     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12025     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12026     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12027
 12028     IF BLSTNML GREATER THAN ZEROS
 12029         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12030
 12031     IF B1STNML GREATER  THAN ZEROS
 12032         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 223
* EL6311.cbl
 12033
 12034     IF BINITL GREATER THAN ZEROS
 12035         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12036
 12037     IF BAGEL GREATER THAN ZEROS
 12038         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12039
 12040     IF BBIRTHL GREATER THAN ZEROS
 12041         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12042
 12043     IF BSEXL GREATER THAN ZEROS
 12044         MOVE  BSEXI             TO PM-INSURED-SEX.
 12045
 12046
 12047* EXEC CICS REWRITE
 12048*        DATASET (FILE-ID-ERPNDM)
 12049*        FROM    (PENDING-MAILING-DATA)
 12050*    END-EXEC.
 12051     MOVE LENGTH OF
 12052      PENDING-MAILING-DATA
 12053       TO DFHEIV11
 12054*    MOVE '&& L                  %   #00011393' TO DFHEIV0
 12055     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12056     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12057     MOVE X'2020233030303131333933' TO DFHEIV0(25:11)
 12058     CALL 'kxdfhei1' USING DFHEIV0,
 12059           FILE-ID-ERPNDM,
 12060           PENDING-MAILING-DATA,
 12061           DFHEIV11,
 12062           DFHEIV99
 12063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12064
 12065
 12066 1399-EXIT.
 12067     EXIT.
 12068
 12069******************************************************************
 12070*                                                                *
 12071*          D E L E T E   I S S U E   R O U T I N E               *
 12072*                                                                *
 12073******************************************************************
 12074
 12075 1400-DELETE-ISSUE-ROUTINE.
 12076     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12077
 12078     IF BCHGL NOT = ZEROS
 12079        MOVE ER-2196             TO EMI-ERROR
 12080        MOVE AL-UABON            TO BMAINTA
 12081        MOVE -1                  TO BMAINTL
 12082        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12083        GO TO 8200-SEND-DATAONLY.
 12084
 12085
 12086* EXEC CICS HANDLE CONDITION
 12087*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12088*    END-EXEC.
 12089*    MOVE '"$I                   ! * #00011417' TO DFHEIV0
 12090     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 224
* EL6311.cbl
 12091     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12092     MOVE X'2A20233030303131343137' TO DFHEIV0(25:11)
 12093     CALL 'kxdfhei1' USING DFHEIV0
 12094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12095
 12096
 12097     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12098     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12099     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12100
 12101
 12102* EXEC CICS READ
 12103*        SET     (ADDRESS OF PENDING-BUSINESS)
 12104*        DATASET (FILE-ID-ERPNDB)
 12105*        RIDFLD  (ERPNDB-KEY)
 12106*    END-EXEC.
 12107*    MOVE '&"S        E          (   #00011425' TO DFHEIV0
 12108     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12109     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12110     MOVE X'2020233030303131343235' TO DFHEIV0(25:11)
 12111     CALL 'kxdfhei1' USING DFHEIV0,
 12112           FILE-ID-ERPNDB,
 12113           DFHEIV20,
 12114           DFHEIV99,
 12115           ERPNDB-KEY,
 12116           DFHEIV99,
 12117           DFHEIV99,
 12118           DFHEIV99
 12119     SET ADDRESS OF PENDING-BUSINESS TO
 12120         DFHEIV20
 12121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12122
 12123
 12124     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12125
 12126     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12127
 12128     IF BSUFIXL NOT = ZEROS
 12129        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12130     ELSE
 12131        MOVE SPACE               TO WS-NEW-SUFFIX.
 12132
 12133     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12134     PERFORM 8600-DEEDIT.
 12135     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12136     MOVE '4'                    TO DC-OPTION-CODE.
 12137     PERFORM 9700-DATE-LINK.
 12138     IF DATE-CONVERSION-ERROR
 12139        MOVE ER-0348             TO EMI-ERROR
 12140        MOVE -1                  TO BEFFDTL
 12141        MOVE AL-UABON            TO BEFFDTA
 12142        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12143        GO TO 8200-SEND-DATAONLY
 12144     ELSE
 12145        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12146        MOVE AL-UANON            TO BEFFDTA
 12147        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12148
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 225
* EL6311.cbl
 12149
 12150* EXEC CICS HANDLE CONDITION
 12151*         NOTFND    (1490-RECORD-NOT-FOUND)
 12152*    END-EXEC.
 12153*    MOVE '"$I                   ! + #00011456' TO DFHEIV0
 12154     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12155     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12156     MOVE X'2B20233030303131343536' TO DFHEIV0(25:11)
 12157     CALL 'kxdfhei1' USING DFHEIV0
 12158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12159
 12160
 12161
 12162* EXEC CICS READ
 12163*        SET     (ADDRESS OF PENDING-BUSINESS)
 12164*        DATASET (FILE-ID-ERPNDB)
 12165*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12166*        UPDATE
 12167*    END-EXEC.
 12168*    MOVE '&"S        EU         (   #00011460' TO DFHEIV0
 12169     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12170     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12171     MOVE X'2020233030303131343630' TO DFHEIV0(25:11)
 12172     CALL 'kxdfhei1' USING DFHEIV0,
 12173           FILE-ID-ERPNDB,
 12174           DFHEIV20,
 12175           DFHEIV99,
 12176           PI-PREV-CONTROL-PRIMARY,
 12177           DFHEIV99,
 12178           DFHEIV99,
 12179           DFHEIV99
 12180     SET ADDRESS OF PENDING-BUSINESS TO
 12181         DFHEIV20
 12182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12183
 12184
 12185     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12186        MOVE -1                 TO BMAINTL
 12187        MOVE ER-2197            TO EMI-ERROR
 12188        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12189        GO TO 8200-SEND-DATAONLY.
 12190
 12191     IF PB-BILLED-DT NOT = LOW-VALUES
 12192        MOVE -1                 TO BMAINTL
 12193        MOVE ER-2129            TO EMI-ERROR
 12194        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12195        GO TO 8200-SEND-DATAONLY.
 12196
 12197     IF PB-CHG-COUNT NOT = ZEROS
 12198        MOVE ER-2336            TO EMI-ERROR
 12199        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12200        MOVE AL-UABON            TO BMAINTA
 12201        MOVE -1                  TO BMAINTL
 12202        GO TO 8200-SEND-DATAONLY.
 12203
 12204     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12205        PB-CHG-COUNT NOT = ZEROS
 12206        MOVE ER-2196             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 226
* EL6311.cbl
 12207        MOVE AL-UABON            TO BMAINTA
 12208        MOVE -1                  TO BMAINTL
 12209        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12210        GO TO 8200-SEND-DATAONLY.
 12211******************************************************************
 12212*                                                                *
 12213*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12214*                                                                *
 12215******************************************************************
 12216     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12217     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12218     MOVE +0                     TO ELCRTO-SEQ-NO
 12219
 12220* EXEC CICS READ
 12221*       DATASET   ('ELCRTO')
 12222*       INTO      (ORIGINAL-CERTIFICATE)
 12223*       RIDFLD    (ELCRTO-KEY)
 12224*       GTEQ
 12225*       RESP      (WS-RESPONSE)
 12226*    END-EXEC
 12227     MOVE LENGTH OF
 12228      ORIGINAL-CERTIFICATE
 12229       TO DFHEIV11
 12230     MOVE 'ELCRTO' TO DFHEIV1
 12231*    MOVE '&"IL       G          (  N#00011501' TO DFHEIV0
 12232     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12233     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12234     MOVE X'204E233030303131353031' TO DFHEIV0(25:11)
 12235     CALL 'kxdfhei1' USING DFHEIV0,
 12236           DFHEIV1,
 12237           ORIGINAL-CERTIFICATE,
 12238           DFHEIV11,
 12239           ELCRTO-KEY,
 12240           DFHEIV99,
 12241           DFHEIV99,
 12242           DFHEIV99
 12243     MOVE EIBRESP  TO WS-RESPONSE
 12244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12245     IF RESP-NORMAL
 12246        AND (OC-CONTROL-PRIMARY (1:33) =
 12247                 PB-CONTROL-BY-ACCOUNT (1:33))
 12248        AND (OC-RECORD-TYPE = 'I')
 12249
 12250* EXEC CICS READ
 12251*          DATASET   ('ELCRTO')
 12252*          INTO      (ORIGINAL-CERTIFICATE)
 12253*          RIDFLD    (ELCRTO-KEY)
 12254*          UPDATE
 12255*          RESP      (WS-RESPONSE)
 12256*       END-EXEC
 12257     MOVE LENGTH OF
 12258      ORIGINAL-CERTIFICATE
 12259       TO DFHEIV11
 12260     MOVE 'ELCRTO' TO DFHEIV1
 12261*    MOVE '&"IL       EU         (  N#00011512' TO DFHEIV0
 12262     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12263     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12264     MOVE X'204E233030303131353132' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 227
* EL6311.cbl
 12265     CALL 'kxdfhei1' USING DFHEIV0,
 12266           DFHEIV1,
 12267           ORIGINAL-CERTIFICATE,
 12268           DFHEIV11,
 12269           ELCRTO-KEY,
 12270           DFHEIV99,
 12271           DFHEIV99,
 12272           DFHEIV99
 12273     MOVE EIBRESP  TO WS-RESPONSE
 12274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12275        IF RESP-NORMAL
 12276
 12277* EXEC CICS DELETE
 12278*             DATASET   ('ELCRTO')
 12279*          END-EXEC
 12280     MOVE 'ELCRTO' TO DFHEIV1
 12281*    MOVE '&(                    &   #00011520' TO DFHEIV0
 12282     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12283     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12284     MOVE X'2020233030303131353230' TO DFHEIV0(25:11)
 12285     CALL 'kxdfhei1' USING DFHEIV0,
 12286           DFHEIV1,
 12287           DFHEIV99,
 12288           DFHEIV99,
 12289           DFHEIV99,
 12290           DFHEIV99
 12291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12292        END-IF
 12293     END-IF
 12294******************************************************************
 12295*                                                                *
 12296*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12297*                                                                *
 12298******************************************************************
 12299
 12300* EXEC CICS HANDLE CONDITION
 12301*        NOTFND    (1405-DELETE-CERTIFICATE)
 12302*    END-EXEC.
 12303*    MOVE '"$I                   ! , #00011530' TO DFHEIV0
 12304     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12305     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12306     MOVE X'2C20233030303131353330' TO DFHEIV0(25:11)
 12307     CALL 'kxdfhei1' USING DFHEIV0
 12308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12309
 12310
 12311
 12312* EXEC CICS READ
 12313*        EQUAL
 12314*        DATASET   (FILE-ID-ERPNDM)
 12315*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12316*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 12317*        UPDATE
 12318*    END-EXEC.
 12319*    MOVE '&"S        EU         (   #00011534' TO DFHEIV0
 12320     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12321     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12322     MOVE X'2020233030303131353334' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 228
* EL6311.cbl
 12323     CALL 'kxdfhei1' USING DFHEIV0,
 12324           FILE-ID-ERPNDM,
 12325           DFHEIV20,
 12326           DFHEIV99,
 12327           PI-PREV-CONTROL-PRIMARY,
 12328           DFHEIV99,
 12329           DFHEIV99,
 12330           DFHEIV99
 12331     SET ADDRESS OF PENDING-MAILING-DATA TO
 12332         DFHEIV20
 12333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12334
 12335
 12336     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12337     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12338     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12339
 12340     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12341
 12342
 12343* EXEC CICS DELETE
 12344*        DATASET   (FILE-ID-ERPNDM)
 12345*    END-EXEC.
 12346*    MOVE '&(                    &   #00011548' TO DFHEIV0
 12347     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12348     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12349     MOVE X'2020233030303131353438' TO DFHEIV0(25:11)
 12350     CALL 'kxdfhei1' USING DFHEIV0,
 12351           FILE-ID-ERPNDM,
 12352           DFHEIV99,
 12353           DFHEIV99,
 12354           DFHEIV99,
 12355           DFHEIV99
 12356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12357
 12358
 12359******************************************************************
 12360*                PROCESS   CERTIFICATE                           *
 12361******************************************************************
 12362
 12363 1405-DELETE-CERTIFICATE.
 12364
 12365* EXEC CICS HANDLE CONDITION
 12366*         NOTFND  (1420-CONTINUE-DELETE)
 12367*    END-EXEC.
 12368*    MOVE '"$I                   ! - #00011557' TO DFHEIV0
 12369     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12370     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12371     MOVE X'2D20233030303131353537' TO DFHEIV0(25:11)
 12372     CALL 'kxdfhei1' USING DFHEIV0
 12373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12374
 12375
 12376     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12377     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12378     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12379     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12380
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 229
* EL6311.cbl
 12381
 12382* EXEC CICS READ
 12383*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12384*        DATASET (FILE-ID-ELCERT)
 12385*        RIDFLD  (ELCERT-KEY)
 12386*        UPDATE
 12387*    END-EXEC.
 12388*    MOVE '&"S        EU         (   #00011566' TO DFHEIV0
 12389     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12390     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12391     MOVE X'2020233030303131353636' TO DFHEIV0(25:11)
 12392     CALL 'kxdfhei1' USING DFHEIV0,
 12393           FILE-ID-ELCERT,
 12394           DFHEIV20,
 12395           DFHEIV99,
 12396           ELCERT-KEY,
 12397           DFHEIV99,
 12398           DFHEIV99,
 12399           DFHEIV99
 12400     SET ADDRESS OF CERTIFICATE-MASTER TO
 12401         DFHEIV20
 12402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12403
 12404
 12405     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12406
 12407     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12408     MOVE 'B'                    TO JP-RECORD-TYPE
 12409     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12410
 12411     PERFORM 8400-LOG-JOURNAL-RECORD.
 12412
 12413     IF CERT-NOTES-ARE-NOT-PRESENT
 12414        MOVE ' '                 TO WS-CERT-NOTE-SW
 12415     ELSE
 12416        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12417
 12418     IF INSURED-ADDR-PRESENT
 12419        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12420
 12421******************************************************************
 12422******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12423******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12424******************************************************************
 12425******************************************************************
 12426
 12427     IF CERT-ADDED-BATCH AND
 12428        (NOT NO-CLAIM-ATTACHED
 12429         OR
 12430         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12431        GO TO 1410-REWRITE-CERT.
 12432
 12433******************************************************************
 12434******************************************************************
 12435
 12436     IF CERT-ADDED-BATCH  AND
 12437        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12438        GO TO 1410-REWRITE-CERT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 230
* EL6311.cbl
 12439
 12440     IF NO-CLAIM-ATTACHED
 12441        NEXT SENTENCE
 12442     ELSE
 12443        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12444        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12445        GO TO 1410-REWRITE-CERT.
 12446
 12447     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12448     MOVE 'D'                      TO JP-RECORD-TYPE.
 12449     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12450
 12451
 12452* EXEC CICS DELETE
 12453*         DATASET    (FILE-ID-ELCERT)
 12454*    END-EXEC.
 12455*    MOVE '&(                    &   #00011619' TO DFHEIV0
 12456     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12457     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12458     MOVE X'2020233030303131363139' TO DFHEIV0(25:11)
 12459     CALL 'kxdfhei1' USING DFHEIV0,
 12460           FILE-ID-ELCERT,
 12461           DFHEIV99,
 12462           DFHEIV99,
 12463           DFHEIV99,
 12464           DFHEIV99
 12465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12466
 12467
 12468     PERFORM 8400-LOG-JOURNAL-RECORD.
 12469
 12470******************************************************************
 12471*                                                                *
 12472*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12473*                                                                *
 12474******************************************************************
 12475
 12476     IF  CERT-NOTES-ARE-PRESENT
 12477         NEXT SENTENCE
 12478     ELSE
 12479         GO TO 1407-DELETE-MAILING.
 12480
 12481
 12482* EXEC CICS HANDLE CONDITION
 12483*         NOTFND  (1406-DELETE-ERNOTE)
 12484*    END-EXEC.
 12485*    MOVE '"$I                   ! . #00011636' TO DFHEIV0
 12486     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12487     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12488     MOVE X'2E20233030303131363336' TO DFHEIV0(25:11)
 12489     CALL 'kxdfhei1' USING DFHEIV0
 12490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12491
 12492
 12493     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12494     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12495     MOVE 0                     TO ERCNOT-SEQUENCE.
 12496
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 231
* EL6311.cbl
 12497 1406-DELETE-ERCNOT-LOOP.
 12498
 12499
 12500* EXEC CICS READ
 12501*        GTEQ
 12502*        DATASET   (FILE-ID-ERCNOT)
 12503*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12504*        RIDFLD    (ERCNOT-KEY)
 12505*    END-EXEC.
 12506*    MOVE '&"S        G          (   #00011646' TO DFHEIV0
 12507     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12508     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12509     MOVE X'2020233030303131363436' TO DFHEIV0(25:11)
 12510     CALL 'kxdfhei1' USING DFHEIV0,
 12511           FILE-ID-ERCNOT,
 12512           DFHEIV20,
 12513           DFHEIV99,
 12514           ERCNOT-KEY,
 12515           DFHEIV99,
 12516           DFHEIV99,
 12517           DFHEIV99
 12518     SET ADDRESS OF CERT-NOTE-FILE TO
 12519         DFHEIV20
 12520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12521
 12522
 12523     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12524     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12525         GO TO 1406-DELETE-ERNOTE
 12526     END-IF.
 12527
 12528     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12529     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12530     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12531
 12532     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12533
 12534
 12535* EXEC CICS DELETE
 12536*        DATASET   (FILE-ID-ERCNOT)
 12537*        RIDFLD    (ERCNOT-KEY)
 12538*        END-EXEC.
 12539*    MOVE '&(  R                 &   #00011664' TO DFHEIV0
 12540     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12541     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12542     MOVE X'2020233030303131363634' TO DFHEIV0(25:11)
 12543     CALL 'kxdfhei1' USING DFHEIV0,
 12544           FILE-ID-ERCNOT,
 12545           ERCNOT-KEY,
 12546           DFHEIV99,
 12547           DFHEIV99,
 12548           DFHEIV99
 12549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12550
 12551
 12552     PERFORM 8400-LOG-JOURNAL-RECORD.
 12553
 12554     GO TO 1406-DELETE-ERCNOT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 232
* EL6311.cbl
 12555
 12556 1406-DELETE-ERNOTE.
 12557
 12558
 12559* EXEC CICS HANDLE CONDITION
 12560*         NOTFND  (1407-DELETE-MAILING)
 12561*    END-EXEC.
 12562*    MOVE '"$I                   ! / #00011675' TO DFHEIV0
 12563     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12564     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12565     MOVE X'2F20233030303131363735' TO DFHEIV0(25:11)
 12566     CALL 'kxdfhei1' USING DFHEIV0
 12567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12568
 12569
 12570
 12571* EXEC CICS READ
 12572*        EQUAL
 12573*        DATASET   (FILE-ID-ERNOTE)
 12574*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 12575*        RIDFLD    (ELCERT-KEY)
 12576*        UPDATE
 12577*    END-EXEC.
 12578*    MOVE '&"S        EU         (   #00011679' TO DFHEIV0
 12579     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12580     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12581     MOVE X'2020233030303131363739' TO DFHEIV0(25:11)
 12582     CALL 'kxdfhei1' USING DFHEIV0,
 12583           FILE-ID-ERNOTE,
 12584           DFHEIV20,
 12585           DFHEIV99,
 12586           ELCERT-KEY,
 12587           DFHEIV99,
 12588           DFHEIV99,
 12589           DFHEIV99
 12590     SET ADDRESS OF CERTIFICATE-NOTE TO
 12591         DFHEIV20
 12592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12593
 12594
 12595     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 12596     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12597     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 12598
 12599     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12600
 12601
 12602* EXEC CICS DELETE
 12603*        DATASET   (FILE-ID-ERNOTE)
 12604*        END-EXEC.
 12605*    MOVE '&(                    &   #00011693' TO DFHEIV0
 12606     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12607     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12608     MOVE X'2020233030303131363933' TO DFHEIV0(25:11)
 12609     CALL 'kxdfhei1' USING DFHEIV0,
 12610           FILE-ID-ERNOTE,
 12611           DFHEIV99,
 12612           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 233
* EL6311.cbl
 12613           DFHEIV99,
 12614           DFHEIV99
 12615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12616
 12617
 12618     PERFORM 8400-LOG-JOURNAL-RECORD.
 12619
 12620******************************************************************
 12621*                                                                *
 12622*                DELETE MAILING ADDRESS RECORDS                  *
 12623*                                                                *
 12624******************************************************************
 12625
 12626 1407-DELETE-MAILING.
 12627     IF CERT-ADDRESS-PRESENT
 12628        NEXT SENTENCE
 12629     ELSE
 12630        GO TO 1420-CONTINUE-DELETE.
 12631
 12632
 12633* EXEC CICS HANDLE CONDITION
 12634*         NOTFND  (1420-CONTINUE-DELETE)
 12635*    END-EXEC.
 12636*    MOVE '"$I                   ! 0 #00011711' TO DFHEIV0
 12637     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12638     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12639     MOVE X'3020233030303131373131' TO DFHEIV0(25:11)
 12640     CALL 'kxdfhei1' USING DFHEIV0
 12641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12642
 12643
 12644
 12645* EXEC CICS READ
 12646*        EQUAL
 12647*        DATASET   (FILE-ID-ERMAIL)
 12648*        SET       (ADDRESS OF MAILING-DATA)
 12649*        RIDFLD    (ELCERT-KEY)
 12650*        UPDATE
 12651*    END-EXEC.
 12652*    MOVE '&"S        EU         (   #00011715' TO DFHEIV0
 12653     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12654     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12655     MOVE X'2020233030303131373135' TO DFHEIV0(25:11)
 12656     CALL 'kxdfhei1' USING DFHEIV0,
 12657           FILE-ID-ERMAIL,
 12658           DFHEIV20,
 12659           DFHEIV99,
 12660           ELCERT-KEY,
 12661           DFHEIV99,
 12662           DFHEIV99,
 12663           DFHEIV99
 12664     SET ADDRESS OF MAILING-DATA TO
 12665         DFHEIV20
 12666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12667
 12668
 12669     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 12670     MOVE 'D'                    TO  JP-RECORD-TYPE.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 234
* EL6311.cbl
 12671     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 12672
 12673     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12674
 12675
 12676* EXEC CICS DELETE
 12677*        DATASET   (FILE-ID-ERMAIL)
 12678*    END-EXEC.
 12679*    MOVE '&(                    &   #00011729' TO DFHEIV0
 12680     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12681     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12682     MOVE X'2020233030303131373239' TO DFHEIV0(25:11)
 12683     CALL 'kxdfhei1' USING DFHEIV0,
 12684           FILE-ID-ERMAIL,
 12685           DFHEIV99,
 12686           DFHEIV99,
 12687           DFHEIV99,
 12688           DFHEIV99
 12689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12690
 12691
 12692     GO TO 1420-CONTINUE-DELETE.
 12693
 12694 1410-REWRITE-CERT.
 12695     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12696     MOVE 'C'                      TO JP-RECORD-TYPE.
 12697     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12698     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12699
 12700
 12701* EXEC CICS REWRITE
 12702*         DATASET    (FILE-ID-ELCERT)
 12703*         FROM       (CERTIFICATE-MASTER)
 12704*         END-EXEC.
 12705     MOVE LENGTH OF
 12706      CERTIFICATE-MASTER
 12707       TO DFHEIV11
 12708*    MOVE '&& L                  %   #00011741' TO DFHEIV0
 12709     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12710     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12711     MOVE X'2020233030303131373431' TO DFHEIV0(25:11)
 12712     CALL 'kxdfhei1' USING DFHEIV0,
 12713           FILE-ID-ELCERT,
 12714           CERTIFICATE-MASTER,
 12715           DFHEIV11,
 12716           DFHEIV99
 12717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12718
 12719
 12720     PERFORM 8400-LOG-JOURNAL-RECORD.
 12721
 12722 1420-CONTINUE-DELETE.
 12723     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 12724     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 12725
 12726     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 12727     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 12728
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 235
* EL6311.cbl
 12729     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 12730
 12731 1450-DELETE-PB-RECORD.
 12732     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 12733     MOVE 'D'                      TO JP-RECORD-TYPE
 12734     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 12735
 12736
 12737* EXEC CICS DELETE
 12738*        DATASET    (FILE-ID-ERPNDB)
 12739*    END-EXEC.
 12740*    MOVE '&(                    &   #00011762' TO DFHEIV0
 12741     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12742     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12743     MOVE X'2020233030303131373632' TO DFHEIV0(25:11)
 12744     CALL 'kxdfhei1' USING DFHEIV0,
 12745           FILE-ID-ERPNDB,
 12746           DFHEIV99,
 12747           DFHEIV99,
 12748           DFHEIV99,
 12749           DFHEIV99
 12750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12751
 12752
 12753     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12754
 12755     PERFORM 8400-LOG-JOURNAL-RECORD.
 12756
 12757     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12758     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12759     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12760
 12761
 12762* EXEC CICS HANDLE CONDITION
 12763*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12764*    END-EXEC.
 12765*    MOVE '"$I                   ! 1 #00011774' TO DFHEIV0
 12766     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12767     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12768     MOVE X'3120233030303131373734' TO DFHEIV0(25:11)
 12769     CALL 'kxdfhei1' USING DFHEIV0
 12770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12771
 12772
 12773
 12774* EXEC CICS READ
 12775*        SET     (ADDRESS OF PENDING-BUSINESS)
 12776*        DATASET (FILE-ID-ERPNDB)
 12777*        RIDFLD  (ERPNDB-KEY)
 12778*        UPDATE
 12779*    END-EXEC.
 12780*    MOVE '&"S        EU         (   #00011778' TO DFHEIV0
 12781     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12782     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12783     MOVE X'2020233030303131373738' TO DFHEIV0(25:11)
 12784     CALL 'kxdfhei1' USING DFHEIV0,
 12785           FILE-ID-ERPNDB,
 12786           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 236
* EL6311.cbl
 12787           DFHEIV99,
 12788           ERPNDB-KEY,
 12789           DFHEIV99,
 12790           DFHEIV99,
 12791           DFHEIV99
 12792     SET ADDRESS OF PENDING-BUSINESS TO
 12793         DFHEIV20
 12794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12795
 12796
 12797     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12798
 12799     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 12800
 12801     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 12802        WS-B-CANCEL-CNT-ENTERED = ZEROS
 12803        MOVE 'D'                   TO JP-RECORD-TYPE
 12804        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 12805
 12806* EXEC CICS DELETE
 12807*            DATASET    (FILE-ID-ERPNDB)
 12808*       END-EXEC
 12809*    MOVE '&(                    &   #00011793' TO DFHEIV0
 12810     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12811     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12812     MOVE X'2020233030303131373933' TO DFHEIV0(25:11)
 12813     CALL 'kxdfhei1' USING DFHEIV0,
 12814           FILE-ID-ERPNDB,
 12815           DFHEIV99,
 12816           DFHEIV99,
 12817           DFHEIV99,
 12818           DFHEIV99
 12819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12820        PERFORM 8400-LOG-JOURNAL-RECORD
 12821     ELSE
 12822        MOVE 'B'                 TO JP-RECORD-TYPE
 12823        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 12824        PERFORM 8400-LOG-JOURNAL-RECORD
 12825        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 12826        MOVE 'C'                 TO JP-RECORD-TYPE
 12827        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 12828
 12829* EXEC CICS REWRITE
 12830*            DATASET    (FILE-ID-ERPNDB)
 12831*            FROM       (PENDING-BUSINESS)
 12832*       END-EXEC
 12833     MOVE LENGTH OF
 12834      PENDING-BUSINESS
 12835       TO DFHEIV11
 12836*    MOVE '&& L                  %   #00011804' TO DFHEIV0
 12837     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12838     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12839     MOVE X'2020233030303131383034' TO DFHEIV0(25:11)
 12840     CALL 'kxdfhei1' USING DFHEIV0,
 12841           FILE-ID-ERPNDB,
 12842           PENDING-BUSINESS,
 12843           DFHEIV11,
 12844           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 237
* EL6311.cbl
 12845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12846        PERFORM 8400-LOG-JOURNAL-RECORD.
 12847
 12848******************************************************************
 12849*                                                                *
 12850*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 12851*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 12852*                                                                *
 12853******************************************************************
 12854
 12855     IF NOT PI-AR-PROCESSING
 12856        GO TO 1475-DELETE-FINISHED.
 12857
 12858     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 12859        WS-B-CANCEL-CNT-ENTERED = ZEROS
 12860        NEXT SENTENCE
 12861     ELSE
 12862        GO TO 1475-DELETE-FINISHED.
 12863
 12864
 12865* EXEC CICS HANDLE CONDITION
 12866*         NOTFND    (1475-DELETE-FINISHED)
 12867*         END-EXEC.
 12868*    MOVE '"$I                   ! 2 #00011826' TO DFHEIV0
 12869     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12870     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12871     MOVE X'3220233030303131383236' TO DFHEIV0(25:11)
 12872     CALL 'kxdfhei1' USING DFHEIV0
 12873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12874
 12875
 12876     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 12877     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 12878
 12879
 12880* EXEC CICS READ
 12881*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 12882*        DATASET (FILE-ID-ERRQST)
 12883*        RIDFLD  (ERRQST-KEY)
 12884*        UPDATE
 12885*    END-EXEC.
 12886*    MOVE '&"S        EU         (   #00011833' TO DFHEIV0
 12887     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12888     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12889     MOVE X'2020233030303131383333' TO DFHEIV0(25:11)
 12890     CALL 'kxdfhei1' USING DFHEIV0,
 12891           FILE-ID-ERRQST,
 12892           DFHEIV20,
 12893           DFHEIV99,
 12894           ERRQST-KEY,
 12895           DFHEIV99,
 12896           DFHEIV99,
 12897           DFHEIV99
 12898     SET ADDRESS OF AR-REQUEST-RECORD TO
 12899         DFHEIV20
 12900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12901
 12902
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 238
* EL6311.cbl
 12903     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12904
 12905     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 12906
 12907     MOVE 'D'                      TO JP-RECORD-TYPE.
 12908     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 12909
 12910
 12911* EXEC CICS DELETE
 12912*         DATASET    (FILE-ID-ERRQST)
 12913*    END-EXEC.
 12914*    MOVE '&(                    &   #00011847' TO DFHEIV0
 12915     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12916     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12917     MOVE X'2020233030303131383437' TO DFHEIV0(25:11)
 12918     CALL 'kxdfhei1' USING DFHEIV0,
 12919           FILE-ID-ERRQST,
 12920           DFHEIV99,
 12921           DFHEIV99,
 12922           DFHEIV99,
 12923           DFHEIV99
 12924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12925
 12926
 12927     PERFORM 8400-LOG-JOURNAL-RECORD.
 12928
 12929 1475-DELETE-FINISHED.
 12930     MOVE ZEROS                  TO EMI-ERROR.
 12931     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12932     MOVE LOW-VALUES             TO EL631BI.
 12933     MOVE -1                     TO BMAINTL.
 12934     GO TO 8100-SEND-INITIAL-MAP.
 12935
 12936 1480-BATCH-HDR-NOT-FOUND.
 12937     MOVE -1                     TO BMAINTL.
 12938     MOVE ER-7450                TO EMI-ERROR.
 12939     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12940     GO TO 8200-SEND-DATAONLY.
 12941
 12942 1490-RECORD-NOT-FOUND.
 12943     MOVE -1                     TO BMAINTL.
 12944     MOVE ER-7451                TO EMI-ERROR.
 12945     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12946     GO TO 8200-SEND-DATAONLY.
 12947
 12948******************************************************************
 12949*            O V E R   C H A R G E   P R O C E S S I N G         *
 12950******************************************************************
 12951 1500-UPDATE-ERNOTE.
 12952     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 12953     MOVE 'A'                    TO WS-NOTE-SW
 12954     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 12955     .
 12956 1500-EXIT.
 12957     EXIT.
 12958 1510-ADD-ERNOTE-REC.
 12959
 12960* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 239
* EL6311.cbl
 12961*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 12962*        LENGTH  (ERNOTE-RECORD-LENGTH)
 12963*        INITIMG (GETMAIN-SPACE)
 12964*    END-EXEC
 12965*    MOVE ',"IL                  $   #00011883' TO DFHEIV0
 12966     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12967     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12968     MOVE X'2020233030303131383833' TO DFHEIV0(25:11)
 12969     CALL 'kxdfhei1' USING DFHEIV0,
 12970           DFHEIV20,
 12971           ERNOTE-RECORD-LENGTH,
 12972           GETMAIN-SPACE
 12973     SET ADDRESS OF CERTIFICATE-NOTE TO
 12974         DFHEIV20
 12975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12976     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12977                                 TO ERNOTE-KEY
 12978
 12979* EXEC CICS READ
 12980*       DATASET    (FILE-ID-ERNOTE)
 12981*       RIDFLD     (ERNOTE-KEY)
 12982*       INTO       (CERTIFICATE-NOTE)
 12983*       RESP       (WS-RESPONSE)
 12984*       UPDATE
 12985*    END-EXEC
 12986     MOVE LENGTH OF
 12987      CERTIFICATE-NOTE
 12988       TO DFHEIV11
 12989*    MOVE '&"IL       EU         (  N#00011890' TO DFHEIV0
 12990     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12991     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12992     MOVE X'204E233030303131383930' TO DFHEIV0(25:11)
 12993     CALL 'kxdfhei1' USING DFHEIV0,
 12994           FILE-ID-ERNOTE,
 12995           CERTIFICATE-NOTE,
 12996           DFHEIV11,
 12997           ERNOTE-KEY,
 12998           DFHEIV99,
 12999           DFHEIV99,
 13000           DFHEIV99
 13001     MOVE EIBRESP  TO WS-RESPONSE
 13002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13003     IF RESP-NORMAL
 13004        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13005           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13006        END-IF
 13007        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13008           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13009        END-IF
 13010        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13011           (N1 > +10)
 13012           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13013           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13014        END-PERFORM
 13015        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13016          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13017
 13018* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 240
* EL6311.cbl
 13019*            DATASET    (FILE-ID-ERNOTE)
 13020*          END-EXEC
 13021*    MOVE '&*                    #   #00011911' TO DFHEIV0
 13022     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13023     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13024     MOVE X'2020233030303131393131' TO DFHEIV0(25:11)
 13025     CALL 'kxdfhei1' USING DFHEIV0,
 13026           FILE-ID-ERNOTE,
 13027           DFHEIV99
 13028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13029        ELSE
 13030          PERFORM VARYING N1 FROM +1 BY +1
 13031           UNTIL (N1 > +10)
 13032           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13033          END-PERFORM
 13034          IF (N1 < +11)
 13035            IF N1 >= CN-BILLING-START-LINE-NO AND
 13036              N1 <= CN-BILLING-END-LINE-NO
 13037              IF PI-COMPANY-ID = 'DCC'
 13038                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13039              ELSE
 13040                 MOVE WS-VA-NO-COMM-MESS
 13041                                    TO CN-LINE (N1)
 13042              END-IF
 13043            ELSE
 13044              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13045               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13046                IF PI-COMPANY-ID = 'DCC'
 13047                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13048                ELSE
 13049                  MOVE WS-VA-NO-COMM-MESS
 13050                                    TO CN-LINE (N1)
 13051                END-IF
 13052                MOVE N1             TO CN-BILLING-END-LINE-NO
 13053              ELSE
 13054                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13055                  IF PI-COMPANY-ID = 'DCC'
 13056                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13057                  ELSE
 13058                     MOVE WS-VA-NO-COMM-MESS
 13059                                    TO CN-LINE (N1)
 13060                  END-IF
 13061                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13062                                      CN-BILLING-START-LINE-NO
 13063                ELSE
 13064                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13065                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13066                     IF PI-COMPANY-ID = 'DCC'
 13067                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13068                     ELSE
 13069                       MOVE WS-VA-NO-COMM-MESS
 13070                                    TO CN-LINE (N1)
 13071                     END-IF
 13072                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13073                  ELSE
 13074                     PERFORM 1700-SQUEEZE-IT-IN
 13075                                 THRU 1700-EXIT
 13076                  END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 241
* EL6311.cbl
 13077                END-IF
 13078              END-IF
 13079            END-IF
 13080            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13081            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13082            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13083
 13084* EXEC CICS REWRITE
 13085*              DATASET    (FILE-ID-ERNOTE)
 13086*              FROM       (CERTIFICATE-NOTE)
 13087*              RESP       (WS-RESPONSE)
 13088*           END-EXEC
 13089     MOVE LENGTH OF
 13090      CERTIFICATE-NOTE
 13091       TO DFHEIV11
 13092*    MOVE '&& L                  %  N#00011968' TO DFHEIV0
 13093     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13094     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13095     MOVE X'204E233030303131393638' TO DFHEIV0(25:11)
 13096     CALL 'kxdfhei1' USING DFHEIV0,
 13097           FILE-ID-ERNOTE,
 13098           CERTIFICATE-NOTE,
 13099           DFHEIV11,
 13100           DFHEIV99
 13101     MOVE EIBRESP  TO WS-RESPONSE
 13102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13103          END-IF
 13104        END-IF
 13105     ELSE
 13106        MOVE SPACES              TO CERTIFICATE-NOTE
 13107        MOVE 'CN'                TO CN-RECORD-ID
 13108        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13109                                 TO CN-CONTROL-PRIMARY
 13110                                    ERNOTE-KEY
 13111        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13112                                    CN-BILLING-END-LINE-NO
 13113        IF PI-COMPANY-ID = 'DCC'
 13114           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13115        ELSE
 13116           MOVE WS-VA-NO-COMM-MESS
 13117                                 TO CN-LINE (1)
 13118        END-IF
 13119        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13120        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13121        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13122
 13123* EXEC CICS WRITE
 13124*          DATASET    (FILE-ID-ERNOTE)
 13125*          FROM       (CERTIFICATE-NOTE)
 13126*          RIDFLD     (ERNOTE-KEY)
 13127*          RESP       (WS-RESPONSE)
 13128*       END-EXEC
 13129     MOVE LENGTH OF
 13130      CERTIFICATE-NOTE
 13131       TO DFHEIV11
 13132*    MOVE '&$ L                  ''  N#00011992' TO DFHEIV0
 13133     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13134     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 242
* EL6311.cbl
 13135     MOVE X'204E233030303131393932' TO DFHEIV0(25:11)
 13136     CALL 'kxdfhei1' USING DFHEIV0,
 13137           FILE-ID-ERNOTE,
 13138           CERTIFICATE-NOTE,
 13139           DFHEIV11,
 13140           ERNOTE-KEY,
 13141           DFHEIV99,
 13142           DFHEIV99
 13143     MOVE EIBRESP  TO WS-RESPONSE
 13144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13145     END-IF
 13146     .
 13147 1510-EXIT.
 13148     EXIT.
 13149 1520-UPDATE-ELCERT.
 13150     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13151                                 TO ELCERT-KEY
 13152
 13153* EXEC CICS READ
 13154*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13155*        DATASET (FILE-ID-ELCERT)
 13156*        RIDFLD  (ELCERT-KEY)
 13157*        UPDATE
 13158*        RESP    (WS-RESPONSE)
 13159*    END-EXEC
 13160*    MOVE '&"S        EU         (  N#00012005' TO DFHEIV0
 13161     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13162     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13163     MOVE X'204E233030303132303035' TO DFHEIV0(25:11)
 13164     CALL 'kxdfhei1' USING DFHEIV0,
 13165           FILE-ID-ELCERT,
 13166           DFHEIV20,
 13167           DFHEIV99,
 13168           ELCERT-KEY,
 13169           DFHEIV99,
 13170           DFHEIV99,
 13171           DFHEIV99
 13172     SET ADDRESS OF CERTIFICATE-MASTER TO
 13173         DFHEIV20
 13174     MOVE EIBRESP  TO WS-RESPONSE
 13175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13176     IF RESP-NORMAL
 13177        IF WS-NOTE-SW = 'A'
 13178           IF CM-NOTE-SW = ' '
 13179              MOVE '2'             TO CM-NOTE-SW
 13180           ELSE
 13181             IF CM-NOTE-SW = '1'
 13182                MOVE '3'           TO CM-NOTE-SW
 13183             ELSE
 13184               IF CM-NOTE-SW = '4'
 13185                  MOVE '6'         TO CM-NOTE-SW
 13186               ELSE
 13187                 IF CM-NOTE-SW = '5'
 13188                    MOVE '7'       TO CM-NOTE-SW
 13189                 END-IF
 13190               END-IF
 13191             END-IF
 13192           END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 243
* EL6311.cbl
 13193        ELSE
 13194           IF CM-NOTE-SW = '2'
 13195              MOVE ' '             TO CM-NOTE-SW
 13196           ELSE
 13197             IF CM-NOTE-SW = '3'
 13198                MOVE '1'           TO CM-NOTE-SW
 13199             ELSE
 13200               IF CM-NOTE-SW = '6'
 13201                  MOVE '4'         TO CM-NOTE-SW
 13202               ELSE
 13203                 IF CM-NOTE-SW = '7'
 13204                    MOVE '5'       TO CM-NOTE-SW
 13205                 END-IF
 13206               END-IF
 13207             END-IF
 13208           END-IF
 13209        END-IF
 13210
 13211* EXEC CICS REWRITE
 13212*          DATASET    (FILE-ID-ELCERT)
 13213*          FROM       (CERTIFICATE-MASTER)
 13214*          RESP       (WS-RESPONSE)
 13215*       END-EXEC
 13216     MOVE LENGTH OF
 13217      CERTIFICATE-MASTER
 13218       TO DFHEIV11
 13219*    MOVE '&& L                  %  N#00012046' TO DFHEIV0
 13220     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13221     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13222     MOVE X'204E233030303132303436' TO DFHEIV0(25:11)
 13223     CALL 'kxdfhei1' USING DFHEIV0,
 13224           FILE-ID-ELCERT,
 13225           CERTIFICATE-MASTER,
 13226           DFHEIV11,
 13227           DFHEIV99
 13228     MOVE EIBRESP  TO WS-RESPONSE
 13229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13230        IF RESP-NORMAL
 13231           CONTINUE
 13232        ELSE
 13233           MOVE WS-RESPONSE TO EMI-ERROR
 13234           PERFORM 9900-ERROR-FORMAT
 13235                                 THRU 9900-EXIT
 13236           GO TO 8200-SEND-DATAONLY
 13237        END-IF
 13238     ELSE
 13239        MOVE -1                  TO BMAINTL
 13240        MOVE 0249                TO EMI-ERROR
 13241        PERFORM 9900-ERROR-FORMAT
 13242                                 THRU 9900-EXIT
 13243        GO TO 8200-SEND-DATAONLY
 13244     END-IF
 13245     .
 13246 1520-EXIT.
 13247     EXIT.
 13248 1600-UPDATE-ERPYAJ.
 13249     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13250                                 THRU 1610-EXIT
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 244
* EL6311.cbl
 13251     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13252                                 THRU 1620-EXIT
 13253     .
 13254 1600-EXIT.
 13255     EXIT.
 13256 1610-ADD-ERPYAJ-BANK-REC.
 13257
 13258* EXEC CICS GETMAIN
 13259*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13260*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13261*        INITIMG (GETMAIN-SPACE)
 13262*    END-EXEC
 13263*    MOVE ',"IL                  $   #00012078' TO DFHEIV0
 13264     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13265     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13266     MOVE X'2020233030303132303738' TO DFHEIV0(25:11)
 13267     CALL 'kxdfhei1' USING DFHEIV0,
 13268           DFHEIV20,
 13269           ERPYAJ-RECORD-LENGTH,
 13270           GETMAIN-SPACE
 13271     SET ADDRESS OF PENDING-PAY-ADJ TO
 13272         DFHEIV20
 13273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13274     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13275     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13276     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13277     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13278     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13279     MOVE +10                    TO ERPYAJ-SEQ-NO
 13280     MOVE 'R'                    TO ERPYAJ-TYPE
 13281     IF REVERSAL
 13282        MOVE 'C'                 TO ERPYAJ-TYPE
 13283     END-IF
 13284     MOVE SPACES                 TO PENDING-PAY-ADJ
 13285     MOVE 'PY'                   TO PY-RECORD-ID
 13286     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13287     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13288     IF REVERSAL
 13289        MOVE PB-I-DCC-OVER-CHG-AMT
 13290                                 TO PY-ENTRY-AMT
 13291     END-IF
 13292     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13293                                    PY-INPUT-DT
 13294*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13295*                                   PY-INPUT-DT
 13296     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13297     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13298     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13299     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13300     IF PB-CARRIER = '2'
 13301        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13302     ELSE
 13303        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13304     END-IF
 13305     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13306                                    PY-BILLED-DATE
 13307                                    PY-AR-DATE
 13308                                    PY-REPORTED-DT
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 245
* EL6311.cbl
 13309                                    PY-CHECK-WRITTEN-DT
 13310     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13311                                    PY-CHECK-QUE-SEQUENCE
 13312     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13313     PERFORM WITH TEST AFTER
 13314        UNTIL (NOT RESP-DUPKEY)
 13315           AND (NOT RESP-DUPREC)
 13316
 13317* EXEC CICS WRITE
 13318*          DATASET    (FILE-ID-ERPYAJ)
 13319*          FROM       (PENDING-PAY-ADJ)
 13320*          RIDFLD     (ERPYAJ-KEY)
 13321*          RESP       (WS-RESPONSE)
 13322*       END-EXEC
 13323     MOVE LENGTH OF
 13324      PENDING-PAY-ADJ
 13325       TO DFHEIV11
 13326*    MOVE '&$ L                  ''  N#00012125' TO DFHEIV0
 13327     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13328     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13329     MOVE X'204E233030303132313235' TO DFHEIV0(25:11)
 13330     CALL 'kxdfhei1' USING DFHEIV0,
 13331           FILE-ID-ERPYAJ,
 13332           PENDING-PAY-ADJ,
 13333           DFHEIV11,
 13334           ERPYAJ-KEY,
 13335           DFHEIV99,
 13336           DFHEIV99
 13337     MOVE EIBRESP  TO WS-RESPONSE
 13338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13339        IF RESP-DUPKEY OR RESP-DUPREC
 13340           ADD +1                TO ERPYAJ-SEQ-NO
 13341           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13342        END-IF
 13343     END-PERFORM
 13344     .
 13345 1610-EXIT.
 13346     EXIT.
 13347 1620-ADD-ERPYAJ-DLR-REC.
 13348     MOVE 'C'                    TO ERPYAJ-TYPE
 13349     IF REVERSAL
 13350        MOVE 'R'                 TO ERPYAJ-TYPE
 13351     END-IF
 13352     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13353                                    ERPYAJ-ACCOUNT
 13354     ADD +1                      TO ERPYAJ-SEQ-NO
 13355     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13356     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13357     IF PB-CARRIER = '2'
 13358        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13359     ELSE
 13360        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13361     END-IF
 13362     PERFORM WITH TEST AFTER
 13363        UNTIL (NOT RESP-DUPKEY)
 13364           AND (NOT RESP-DUPREC)
 13365
 13366* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 246
* EL6311.cbl
 13367*          DATASET    (FILE-ID-ERPYAJ)
 13368*          FROM       (PENDING-PAY-ADJ)
 13369*          RIDFLD     (ERPYAJ-KEY)
 13370*          RESP       (WS-RESPONSE)
 13371*       END-EXEC
 13372     MOVE LENGTH OF
 13373      PENDING-PAY-ADJ
 13374       TO DFHEIV11
 13375*    MOVE '&$ L                  ''  N#00012157' TO DFHEIV0
 13376     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13377     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13378     MOVE X'204E233030303132313537' TO DFHEIV0(25:11)
 13379     CALL 'kxdfhei1' USING DFHEIV0,
 13380           FILE-ID-ERPYAJ,
 13381           PENDING-PAY-ADJ,
 13382           DFHEIV11,
 13383           ERPYAJ-KEY,
 13384           DFHEIV99,
 13385           DFHEIV99
 13386     MOVE EIBRESP  TO WS-RESPONSE
 13387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13388        IF RESP-DUPKEY OR RESP-DUPREC
 13389           ADD +1                TO ERPYAJ-SEQ-NO
 13390           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13391        END-IF
 13392     END-PERFORM
 13393     .
 13394 1620-EXIT.
 13395     EXIT.
 13396 1700-SQUEEZE-IT-IN.
 13397     IF (N1 > CN-BILLING-END-LINE-NO)
 13398        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13399           N1 = +1
 13400           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13401           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13402              IF PI-COMPANY-ID = 'DCC'
 13403                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13404              ELSE
 13405                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13406              END-IF
 13407              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 13408              MOVE +2 TO N1
 13409           END-IF
 13410        END-PERFORM
 13411     ELSE
 13412        IF (N1 < CN-BILLING-START-LINE-NO)
 13413           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13414              N1 = +10
 13415              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13416              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13417                 IF PI-COMPANY-ID = 'DCC'
 13418                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 13419                 ELSE
 13420                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13421                 END-IF
 13422                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13423                 MOVE +9 TO N1
 13424              END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 247
* EL6311.cbl
 13425           END-PERFORM
 13426        END-IF
 13427     END-IF
 13428     .
 13429 1700-EXIT.
 13430     EXIT.
 13431 1800-REMOVE-CERT-NOTES.
 13432     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13433                                 TO ERNOTE-KEY
 13434
 13435* EXEC CICS READ
 13436*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13437*       DATASET    (FILE-ID-ERNOTE)
 13438*       RIDFLD     (ERNOTE-KEY)
 13439*       RESP       (WS-RESPONSE)
 13440*       UPDATE
 13441*    END-EXEC
 13442*    MOVE '&"S        EU         (  N#00012209' TO DFHEIV0
 13443     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13444     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13445     MOVE X'204E233030303132323039' TO DFHEIV0(25:11)
 13446     CALL 'kxdfhei1' USING DFHEIV0,
 13447           FILE-ID-ERNOTE,
 13448           DFHEIV20,
 13449           DFHEIV99,
 13450           ERNOTE-KEY,
 13451           DFHEIV99,
 13452           DFHEIV99,
 13453           DFHEIV99
 13454     SET ADDRESS OF CERTIFICATE-NOTE TO
 13455         DFHEIV20
 13456     MOVE EIBRESP  TO WS-RESPONSE
 13457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13458     IF RESP-NORMAL
 13459        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13460           (N1 > +10)
 13461           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13462           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13463        END-PERFORM
 13464        IF N1 < +11
 13465           MOVE SPACES              TO CN-LINE (N1)
 13466           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13467              N1 <= CN-BILLING-END-LINE-NO
 13468              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13469              IF CN-BILLING-END-LINE-NO <
 13470                               CN-BILLING-START-LINE-NO
 13471                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13472                                     CN-BILLING-START-LINE-NO
 13473              END-IF
 13474              PERFORM 1820-SQUEEZE-ERNOTE
 13475                                  THRU 1820-EXIT
 13476           END-IF
 13477           IF CN-LINES = SPACES
 13478
 13479* EXEC CICS DELETE
 13480*                DATASET    (FILE-ID-ERNOTE)
 13481*                RESP       (WS-RESPONSE)
 13482*             END-EXEC
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 248
* EL6311.cbl
 13483*    MOVE '&(                    &  N#00012236' TO DFHEIV0
 13484     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13485     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13486     MOVE X'204E233030303132323336' TO DFHEIV0(25:11)
 13487     CALL 'kxdfhei1' USING DFHEIV0,
 13488           FILE-ID-ERNOTE,
 13489           DFHEIV99,
 13490           DFHEIV99,
 13491           DFHEIV99,
 13492           DFHEIV99
 13493     MOVE EIBRESP  TO WS-RESPONSE
 13494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13495              IF RESP-NORMAL
 13496                 MOVE 'D'        TO WS-NOTE-SW
 13497                 PERFORM 1520-UPDATE-ELCERT
 13498                                 THRU 1520-EXIT
 13499              END-IF
 13500           ELSE
 13501
 13502* EXEC CICS REWRITE
 13503*                DATASET    (FILE-ID-ERNOTE)
 13504*                FROM       (CERTIFICATE-NOTE)
 13505*                RESP       (WS-RESPONSE)
 13506*             END-EXEC
 13507     MOVE LENGTH OF
 13508      CERTIFICATE-NOTE
 13509       TO DFHEIV11
 13510*    MOVE '&& L                  %  N#00012246' TO DFHEIV0
 13511     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13512     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13513     MOVE X'204E233030303132323436' TO DFHEIV0(25:11)
 13514     CALL 'kxdfhei1' USING DFHEIV0,
 13515           FILE-ID-ERNOTE,
 13516           CERTIFICATE-NOTE,
 13517           DFHEIV11,
 13518           DFHEIV99
 13519     MOVE EIBRESP  TO WS-RESPONSE
 13520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13521           END-IF
 13522        END-IF
 13523     END-IF
 13524     .
 13525 1800-EXIT.
 13526     EXIT.
 13527 1820-SQUEEZE-ERNOTE.
 13528     MOVE CN-BILLING-START-LINE-NO TO N2
 13529     IF N2 = 0
 13530         MOVE +1                 TO N2
 13531     END-IF
 13532     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13533        (N1 > +9)
 13534        IF CN-LINE (N1) = SPACES
 13535           MOVE CN-LINE (N1 + +1)
 13536                                 TO CN-LINE (N1)
 13537           MOVE SPACES           TO CN-LINE (N1 + +1)
 13538        END-IF
 13539     END-PERFORM
 13540     .
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 249
* EL6311.cbl
 13541 1820-EXIT.
 13542     EXIT.
 13543 1900-DELETE-ERPYAJ.
 13544     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13545     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13546     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13547     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13548     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13549     MOVE +10                    TO ERPYAJ-SEQ-NO
 13550     MOVE 'R'                    TO ERPYAJ-TYPE
 13551     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13552
 13553* EXEC CICS STARTBR
 13554*       DATASET    (FILE-ID-ERPYAJ)
 13555*       RIDFLD     (ERPYAJ-KEY)
 13556*       RESP       (WS-RESPONSE)
 13557*    END-EXEC
 13558     MOVE 0
 13559       TO DFHEIV11
 13560*    MOVE '&,         G          &  N#00012282' TO DFHEIV0
 13561     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13562     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13563     MOVE X'204E233030303132323832' TO DFHEIV0(25:11)
 13564     CALL 'kxdfhei1' USING DFHEIV0,
 13565           FILE-ID-ERPYAJ,
 13566           ERPYAJ-KEY,
 13567           DFHEIV99,
 13568           DFHEIV11,
 13569           DFHEIV99
 13570     MOVE EIBRESP  TO WS-RESPONSE
 13571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13572     IF RESP-NORMAL
 13573        CONTINUE
 13574     ELSE
 13575        GO TO 1900-GET-DEALER
 13576     END-IF
 13577     .
 13578 1900-READNEXT-ERPYAJ-B.
 13579*  GET THE BANK ERPYAJ RECORD
 13580
 13581* EXEC CICS READNEXT
 13582*       DATASET    (FILE-ID-ERPYAJ)
 13583*       RIDFLD     (ERPYAJ-KEY)
 13584*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13585*       RESP       (WS-RESPONSE)
 13586*    END-EXEC
 13587     MOVE 0
 13588       TO DFHEIV11
 13589*    MOVE '&.S                   )  N#00012295' TO DFHEIV0
 13590     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13591     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13592     MOVE X'204E233030303132323935' TO DFHEIV0(25:11)
 13593     CALL 'kxdfhei1' USING DFHEIV0,
 13594           FILE-ID-ERPYAJ,
 13595           DFHEIV20,
 13596           DFHEIV99,
 13597           ERPYAJ-KEY,
 13598           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 250
* EL6311.cbl
 13599           DFHEIV11,
 13600           DFHEIV99,
 13601           DFHEIV99
 13602     SET ADDRESS OF PENDING-PAY-ADJ TO
 13603         DFHEIV20
 13604     MOVE EIBRESP  TO WS-RESPONSE
 13605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13606     IF RESP-NORMAL
 13607        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13608           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13609              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13610                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13611
 13612* EXEC CICS READ
 13613*                   DATASET    (FILE-ID-ERPYAJ)
 13614*                   RIDFLD     (ERPYAJ-KEY)
 13615*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13616*                   RESP       (WS-RESPONSE)
 13617*                   UPDATE
 13618*                END-EXEC
 13619*    MOVE '&"S        EU         (  N#00012306' TO DFHEIV0
 13620     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13621     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13622     MOVE X'204E233030303132333036' TO DFHEIV0(25:11)
 13623     CALL 'kxdfhei1' USING DFHEIV0,
 13624           FILE-ID-ERPYAJ,
 13625           DFHEIV20,
 13626           DFHEIV99,
 13627           ERPYAJ-KEY,
 13628           DFHEIV99,
 13629           DFHEIV99,
 13630           DFHEIV99
 13631     SET ADDRESS OF PENDING-PAY-ADJ TO
 13632         DFHEIV20
 13633     MOVE EIBRESP  TO WS-RESPONSE
 13634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13635                 IF RESP-NORMAL
 13636
 13637* EXEC CICS DELETE
 13638*                      DATASET   (FILE-ID-ERPYAJ)
 13639*                      RESP      (WS-RESPONSE)
 13640*                   END-EXEC
 13641*    MOVE '&(                    &  N#00012314' TO DFHEIV0
 13642     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13643     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13644     MOVE X'204E233030303132333134' TO DFHEIV0(25:11)
 13645     CALL 'kxdfhei1' USING DFHEIV0,
 13646           FILE-ID-ERPYAJ,
 13647           DFHEIV99,
 13648           DFHEIV99,
 13649           DFHEIV99,
 13650           DFHEIV99
 13651     MOVE EIBRESP  TO WS-RESPONSE
 13652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13653                 END-IF
 13654              ELSE
 13655                 SET REVERSAL    TO TRUE
 13656                 PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 251
* EL6311.cbl
 13657                                 THRU 1600-EXIT
 13658                 GO TO 1900-EXIT
 13659              END-IF
 13660           ELSE
 13661              GO TO 1900-READNEXT-ERPYAJ-B
 13662           END-IF
 13663        END-IF
 13664
 13665* EXEC CICS ENDBR
 13666*          DATASET   (FILE-ID-ERPYAJ)
 13667*       END-EXEC
 13668     MOVE 0
 13669       TO DFHEIV11
 13670*    MOVE '&2                    $   #00012329' TO DFHEIV0
 13671     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13672     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13673     MOVE X'2020233030303132333239' TO DFHEIV0(25:11)
 13674     CALL 'kxdfhei1' USING DFHEIV0,
 13675           FILE-ID-ERPYAJ,
 13676           DFHEIV11,
 13677           DFHEIV99
 13678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13679     END-IF
 13680     .
 13681 1900-GET-DEALER.
 13682     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13683     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13684     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13685     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13686     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 13687     MOVE +10                    TO ERPYAJ-SEQ-NO
 13688     MOVE 'C'                    TO ERPYAJ-TYPE
 13689     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13690
 13691* EXEC CICS STARTBR
 13692*       DATASET    (FILE-ID-ERPYAJ)
 13693*       RIDFLD     (ERPYAJ-KEY)
 13694*       RESP       (WS-RESPONSE)
 13695*    END-EXEC
 13696     MOVE 0
 13697       TO DFHEIV11
 13698*    MOVE '&,         G          &  N#00012343' TO DFHEIV0
 13699     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13700     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13701     MOVE X'204E233030303132333433' TO DFHEIV0(25:11)
 13702     CALL 'kxdfhei1' USING DFHEIV0,
 13703           FILE-ID-ERPYAJ,
 13704           ERPYAJ-KEY,
 13705           DFHEIV99,
 13706           DFHEIV11,
 13707           DFHEIV99
 13708     MOVE EIBRESP  TO WS-RESPONSE
 13709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13710     IF RESP-NORMAL
 13711        CONTINUE
 13712     ELSE
 13713        GO TO 1900-EXIT
 13714     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 252
* EL6311.cbl
 13715     .
 13716 1900-READNEXT-ERPYAJ-D.
 13717*  GET THE DEALER ERPYAJ RECORD
 13718
 13719* EXEC CICS READNEXT
 13720*       DATASET    (FILE-ID-ERPYAJ)
 13721*       RIDFLD     (ERPYAJ-KEY)
 13722*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13723*       RESP       (WS-RESPONSE)
 13724*    END-EXEC
 13725     MOVE 0
 13726       TO DFHEIV11
 13727*    MOVE '&.S                   )  N#00012356' TO DFHEIV0
 13728     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13729     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13730     MOVE X'204E233030303132333536' TO DFHEIV0(25:11)
 13731     CALL 'kxdfhei1' USING DFHEIV0,
 13732           FILE-ID-ERPYAJ,
 13733           DFHEIV20,
 13734           DFHEIV99,
 13735           ERPYAJ-KEY,
 13736           DFHEIV99,
 13737           DFHEIV11,
 13738           DFHEIV99,
 13739           DFHEIV99
 13740     SET ADDRESS OF PENDING-PAY-ADJ TO
 13741         DFHEIV20
 13742     MOVE EIBRESP  TO WS-RESPONSE
 13743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13744     IF RESP-NORMAL
 13745        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13746           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13747              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13748                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13749
 13750* EXEC CICS READ
 13751*                   DATASET    (FILE-ID-ERPYAJ)
 13752*                   RIDFLD     (ERPYAJ-KEY)
 13753*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13754*                   RESP       (WS-RESPONSE)
 13755*                   UPDATE
 13756*                END-EXEC
 13757*    MOVE '&"S        EU         (  N#00012367' TO DFHEIV0
 13758     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13759     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13760     MOVE X'204E233030303132333637' TO DFHEIV0(25:11)
 13761     CALL 'kxdfhei1' USING DFHEIV0,
 13762           FILE-ID-ERPYAJ,
 13763           DFHEIV20,
 13764           DFHEIV99,
 13765           ERPYAJ-KEY,
 13766           DFHEIV99,
 13767           DFHEIV99,
 13768           DFHEIV99
 13769     SET ADDRESS OF PENDING-PAY-ADJ TO
 13770         DFHEIV20
 13771     MOVE EIBRESP  TO WS-RESPONSE
 13772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 253
* EL6311.cbl
 13773                 IF RESP-NORMAL
 13774
 13775* EXEC CICS DELETE
 13776*                      DATASET   (FILE-ID-ERPYAJ)
 13777*                      RESP      (WS-RESPONSE)
 13778*                   END-EXEC
 13779*    MOVE '&(                    &  N#00012375' TO DFHEIV0
 13780     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13781     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13782     MOVE X'204E233030303132333735' TO DFHEIV0(25:11)
 13783     CALL 'kxdfhei1' USING DFHEIV0,
 13784           FILE-ID-ERPYAJ,
 13785           DFHEIV99,
 13786           DFHEIV99,
 13787           DFHEIV99,
 13788           DFHEIV99
 13789     MOVE EIBRESP  TO WS-RESPONSE
 13790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13791                 END-IF
 13792              ELSE
 13793                 SET REVERSAL    TO TRUE
 13794              END-IF
 13795           ELSE
 13796              GO TO 1900-READNEXT-ERPYAJ-D
 13797           END-IF
 13798        END-IF
 13799
 13800* EXEC CICS ENDBR
 13801*          DATASET   (FILE-ID-ERPYAJ)
 13802*       END-EXEC
 13803     MOVE 0
 13804       TO DFHEIV11
 13805*    MOVE '&2                    $   #00012387' TO DFHEIV0
 13806     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13807     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13808     MOVE X'2020233030303132333837' TO DFHEIV0(25:11)
 13809     CALL 'kxdfhei1' USING DFHEIV0,
 13810           FILE-ID-ERPYAJ,
 13811           DFHEIV11,
 13812           DFHEIV99
 13813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13814     END-IF
 13815     .
 13816 1900-EXIT.
 13817     EXIT.
 13818******************************************************************
 13819*            C A N C E L   M A I N L I N E                       *
 13820******************************************************************
 13821
 13822 2000-CANCEL-MAINLINE.
 13823     IF PI-DISPLAY-ORIGINAL-BATCH
 13824        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 13825           MOVE ER-0023             TO EMI-ERROR
 13826           MOVE -1                  TO CMAINTL
 13827           MOVE AL-UABON            TO CMAINTA
 13828           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13829           GO TO 8200-SEND-DATAONLY
 13830        ELSE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 254
* EL6311.cbl
 13831           NEXT SENTENCE
 13832     ELSE
 13833        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 13834           MOVE ER-0023             TO EMI-ERROR
 13835           MOVE -1                  TO CMAINTL
 13836           MOVE AL-UABON            TO CMAINTA
 13837           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13838           GO TO 8200-SEND-DATAONLY.
 13839
 13840     IF CMAINTI = 'S'
 13841        GO TO 2100-SHOW-REQUEST.
 13842
 13843     IF NOT MODIFY-CAP
 13844         MOVE 'UPDATE'       TO SM-READ
 13845         PERFORM 9995-SECURITY-VIOLATION
 13846         MOVE ER-0070        TO EMI-ERROR
 13847         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13848         GO TO 8100-SEND-INITIAL-MAP.
 13849
 13850     IF CMAINTL GREATER THAN ZEROS
 13851        IF PI-PF6-FUNCTION
 13852           IF CMAINTI NOT = 'A'
 13853              MOVE AL-UABON  TO CMAINTA
 13854              MOVE -1        TO CMAINTL
 13855              MOVE ER-2260   TO EMI-ERROR
 13856              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13857              GO TO 8200-SEND-DATAONLY.
 13858
 13859     IF CCERTNOL = ZEROS
 13860       AND (CMAINTI = 'C' OR 'K' OR 'D')
 13861         NEXT SENTENCE
 13862     ELSE
 13863         IF CCERTNOL NOT = ZEROS
 13864             MOVE AL-UANON       TO CCERTNOA
 13865         ELSE
 13866             MOVE -1             TO CCERTNOL
 13867             MOVE  1             TO SET-CURSOR-SW
 13868             MOVE ER-2218       TO EMI-ERROR
 13869             MOVE AL-UABON       TO CCERTNOA
 13870             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13871
 13872     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 13873        NEXT SENTENCE
 13874     ELSE
 13875        IF CEFFDTL NOT = ZEROS
 13876           MOVE AL-UNNON         TO CEFFDTA
 13877           MOVE CEFFDTI TO DEEDIT-FIELD
 13878           PERFORM 8600-DEEDIT
 13879           MOVE 4                TO DC-OPTION-CODE
 13880           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 13881           PERFORM 9700-DATE-LINK
 13882           IF NO-CONVERSION-ERROR
 13883              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 13884              ELSE
 13885              MOVE -1            TO CEFFDTL
 13886              MOVE  1            TO SET-CURSOR-SW
 13887              MOVE ER-2226      TO EMI-ERROR
 13888              MOVE AL-UNBON      TO CEFFDTA
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 255
* EL6311.cbl
 13889              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13890          ELSE
 13891          MOVE -1                 TO CEFFDTL
 13892          MOVE  1                 TO SET-CURSOR-SW
 13893          MOVE ER-2220            TO EMI-ERROR
 13894          MOVE AL-UNBON           TO CEFFDTA
 13895          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13896
 13897     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 13898
 13899     IF CCERTNOL NOT = ZEROS
 13900        MOVE CCERTNOI                TO WS-NEW-PRIME
 13901     ELSE
 13902        MOVE SPACES                  TO WS-NEW-PRIME.
 13903
 13904     IF CSUFIXL NOT = ZEROS
 13905        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 13906     ELSE
 13907        MOVE SPACE                   TO WS-NEW-SUFFIX.
 13908
 13909     IF CEFFDTL NOT = ZEROS
 13910        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 13911     ELSE
 13912        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 13913
 13914     IF CMAINTI = 'A' OR 'K' OR 'S'
 13915        NEXT SENTENCE
 13916     ELSE
 13917        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 13918        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 13919           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 13920           WS-PB-RECORD-TYPE NOT = '2'
 13921           IF CMAINTI = 'C'
 13922              MOVE ER-2287          TO EMI-ERROR
 13923              MOVE -1               TO CCERTNOL
 13924              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 13925              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13926              GO TO 8200-SEND-DATAONLY
 13927             ELSE
 13928              MOVE ER-2260          TO EMI-ERROR
 13929              MOVE -1               TO CCERTNOL
 13930              MOVE AL-UABON         TO CCERTNOA
 13931              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13932              GO TO 8200-SEND-DATAONLY.
 13933
 13934     IF CMAINTI = 'D'
 13935        GO TO 2400-DELETE-CANCEL-ROUTINE.
 13936
 13937     IF CLSTNML GREATER THAN ZEROS
 13938         MOVE AL-UANON           TO CLSTNMA.
 13939
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 256
* EL6311.cbl
 13941
 13942******************************************************************
 13943*                                                                *
 13944*           E D I T   C A N C E L   C O V E R A G E S            *
 13945*                                                                *
 13946******************************************************************
 13947
 13948 2015-EDIT-COVERAGES.
 13949     IF CCANDT1L      GREATER THAN ZEROS OR
 13950        CREFND1L      GREATER THAN ZEROS OR
 13951        CCANDT2L      GREATER THAN ZEROS OR
 13952        CREFND2L      GREATER THAN ZEROS OR
 13953        CMTHD1L       GREATER THAN ZEROS OR
 13954        CMTHD2L       GREATER THAN ZEROS OR
 13955        CLIVESL       GREATER THAN ZEROS OR
 13956        CPAYEEL       GREATER THAN ZEROS OR
 13957        CFORCEL       GREATER THAN ZEROS OR
 13958        CBILCDL       GREATER THAN ZEROS OR
 13959        CCANREAL      GREATER THAN ZEROS
 13960            NEXT SENTENCE
 13961         ELSE
 13962            GO TO 2030-EDIT-COMPLETE.
 13963
 13964     IF CCANDT1L = ZEROS
 13965        AND (CMAINTI = 'C' OR 'K')
 13966        NEXT SENTENCE
 13967     ELSE
 13968        IF CCANDT1L      GREATER THAN ZEROS
 13969            MOVE AL-UNNON            TO CCANDT1A
 13970            IF CCANDT1I = SPACES
 13971               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 13972            ELSE
 13973               MOVE CCANDT1I            TO DEEDIT-FIELD
 13974               PERFORM 8600-DEEDIT
 13975               IF DEEDIT-FIELD-V0   NUMERIC
 13976                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 13977                  MOVE 4                TO DC-OPTION-CODE
 13978                  PERFORM 9700-DATE-LINK
 13979                  IF NO-CONVERSION-ERROR
 13980                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 13981                  ELSE
 13982                      MOVE -1        TO CCANDT1L
 13983                      MOVE ER-2227   TO EMI-ERROR
 13984                      MOVE AL-UNBON  TO CCANDT1A
 13985                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13986               ELSE
 13987                  MOVE -1         TO CCANDT1L
 13988                  MOVE ER-2223    TO EMI-ERROR
 13989                  MOVE AL-UNBON   TO CCANDT1A
 13990                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13991        ELSE
 13992            IF CREFND1L GREATER THAN ZEROS
 13993               MOVE -1             TO CCANDT1L
 13994               MOVE ER-2222        TO EMI-ERROR
 13995               MOVE AL-UNBOF       TO CCANDT1A
 13996               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13997
 13998     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 257
* EL6311.cbl
 13999        AND (CMAINTI = 'C' OR 'K')
 14000         NEXT SENTENCE
 14001     ELSE
 14002         IF CREFND1L NOT = ZEROS
 14003            MOVE AL-UNNON        TO CREFND1A
 14004
 14005* EXEC CICS BIF DEEDIT
 14006*               FIELD  (CREFND1I)
 14007*               LENGTH (11)
 14008*           END-EXEC
 14009     MOVE 11
 14010       TO DFHEIV11
 14011*    MOVE '@"L                   #   #00012580' TO DFHEIV0
 14012     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14013     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14014     MOVE X'2020233030303132353830' TO DFHEIV0(25:11)
 14015     CALL 'kxdfhei1' USING DFHEIV0,
 14016           CREFND1I,
 14017           DFHEIV11
 14018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14019            MOVE CREFND1I        TO WS-CREFND1
 14020*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14021*           PERFORM 8600-DEEDIT
 14022*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14023            IF WS-CREFND1  = ZEROS
 14024               AND CMAINTI = 'A'
 14025             MOVE ER-2437        TO EMI-ERROR
 14026             MOVE -1             TO CREFND1L
 14027             MOVE AL-UNBON       TO CREFND1A
 14028             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14029
 14030     IF CCANREAL > +0
 14031        MOVE AL-UANON            TO CCANREAA
 14032        IF CCANREAI = 'R' OR ' '
 14033           CONTINUE
 14034        ELSE
 14035           MOVE ER-9841        TO EMI-ERROR
 14036           MOVE -1             TO CCANREAL
 14037           MOVE AL-UABON       TO CCANREAA
 14038           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14039        END-IF
 14040     END-IF
 14041     IF CMTHD1L EQUAL +0
 14042        NEXT SENTENCE
 14043     ELSE
 14044        IF CMTHD1L NOT = +0
 14045           MOVE AL-UNNON        TO CMTHD1A
 14046           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14047                         OR '5' OR '6' OR '8' OR '9'
 14048                         OR 'R' OR ' '
 14049              NEXT SENTENCE
 14050           ELSE
 14051              MOVE ER-0582        TO EMI-ERROR
 14052              MOVE -1             TO CMTHD1L
 14053              MOVE AL-UNBON       TO CMTHD1A
 14054              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14055
 14056     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 258
* EL6311.cbl
 14057        AND (CMAINTI = 'C' OR 'K')
 14058         NEXT SENTENCE
 14059     ELSE
 14060         IF CCANDT2L  GREATER THAN ZEROS
 14061             MOVE AL-UNNON       TO CCANDT2A
 14062             IF CCANDT2I = SPACES
 14063                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14064             ELSE
 14065                MOVE CCANDT2I       TO DEEDIT-FIELD
 14066                PERFORM 8600-DEEDIT
 14067                IF DEEDIT-FIELD-V0   NUMERIC
 14068                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14069                   MOVE 4                TO DC-OPTION-CODE
 14070                   PERFORM 9700-DATE-LINK
 14071                   IF NO-CONVERSION-ERROR
 14072                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14073                   ELSE
 14074                      MOVE -1       TO CCANDT2L
 14075                      MOVE ER-2227  TO EMI-ERROR
 14076                      MOVE AL-UNBON TO CCANDT2A
 14077                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14078                ELSE
 14079                   MOVE -1         TO CCANDT2L
 14080                   MOVE ER-2223    TO EMI-ERROR
 14081                   MOVE AL-UNBON   TO CCANDT2A
 14082                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14083         ELSE
 14084            IF CREFND2L GREATER THAN ZEROS
 14085               MOVE -1             TO CCANDT2L
 14086               MOVE ER-2222        TO EMI-ERROR
 14087               MOVE AL-UNBOF       TO CCANDT2A
 14088               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14089
 14090     IF CREFND2L = ZEROS
 14091        AND (CMAINTI = 'C' OR 'K')
 14092         NEXT SENTENCE
 14093     ELSE
 14094         IF CREFND2L NOT = ZEROS
 14095            MOVE AL-UNNON        TO CREFND2A
 14096
 14097* EXEC CICS BIF DEEDIT
 14098*               FIELD  (CREFND2I)
 14099*               LENGTH (11)
 14100*           END-EXEC
 14101     MOVE 11
 14102       TO DFHEIV11
 14103*    MOVE '@"L                   #   #00012661' TO DFHEIV0
 14104     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14105     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14106     MOVE X'2020233030303132363631' TO DFHEIV0(25:11)
 14107     CALL 'kxdfhei1' USING DFHEIV0,
 14108           CREFND2I,
 14109           DFHEIV11
 14110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14111            MOVE CREFND2I        TO WS-CREFND2
 14112*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14113*           PERFORM 8600-DEEDIT
 14114*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 259
* EL6311.cbl
 14115            IF WS-CREFND2  = ZEROS
 14116               AND CMAINTI = 'A'
 14117             MOVE ER-2437        TO EMI-ERROR
 14118             MOVE -1             TO CREFND2L
 14119             MOVE AL-UNBON       TO CREFND2A
 14120             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14121
 14122     IF CMTHD2L EQUAL +0
 14123        NEXT SENTENCE
 14124     ELSE
 14125        IF CMTHD2L NOT = +0
 14126           MOVE AL-UNNON        TO CMTHD2A
 14127           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14128                         OR '5' OR '6' OR '8' OR '9'
 14129                         OR ' ' OR 'R'
 14130              NEXT SENTENCE
 14131           ELSE
 14132              MOVE ER-0582        TO EMI-ERROR
 14133              MOVE -1             TO CMTHD2L
 14134              MOVE AL-UNBON       TO CMTHD2A
 14135              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14136
 14137     IF CLIVESL GREATER THAN ZEROS
 14138         MOVE CLIVESI            TO DEEDIT-FIELD
 14139         PERFORM 8600-DEEDIT
 14140         IF DEEDIT-FIELD-V0 NUMERIC
 14141             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14142             MOVE AL-UNNON       TO CLIVESA
 14143         ELSE
 14144             MOVE -1             TO CLIVESL
 14145             MOVE AL-UNBON       TO CLIVESA
 14146             MOVE ER-2223        TO EMI-ERROR
 14147             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14148
 14149     IF CFORCEL  NOT = ZEROS
 14150         IF FORCE-CAP
 14151            MOVE AL-UANON            TO CFORCEA
 14152         ELSE
 14153            MOVE ER-2945             TO EMI-ERROR
 14154            MOVE AL-UABON            TO CFORCEA
 14155            MOVE -1                  TO CFORCEL
 14156            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14157
 14158     IF CPAYEEL GREATER THAN ZEROS
 14159        MOVE AL-UANON            TO CPAYEEA.
 14160
 14161     IF CBILCDL NOT = ZEROS
 14162        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14163                             AND 'A' AND 'B' AND 'E'
 14164           MOVE ER-2225              TO EMI-ERROR
 14165           MOVE AL-UABON             TO CBILCDA
 14166           MOVE -1                   TO CBILCDL
 14167           MOVE  1                   TO SET-CURSOR-SW
 14168           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14169        ELSE
 14170           MOVE AL-UANON             TO CBILCDA.
 14171
 14172 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 260
* EL6311.cbl
 14173     IF EMI-ERROR = ZEROS
 14174         NEXT SENTENCE
 14175     ELSE
 14176         GO TO 8200-SEND-DATAONLY.
 14177
 14178     IF CMAINTI = 'A'
 14179        GO TO 2200-ADD-CANCEL-ROUTINE.
 14180
 14181     IF CMAINTI = 'C'
 14182        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14183
 14184     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14185
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 261
* EL6311.cbl
 14187
 14188******************************************************************
 14189*                                                                *
 14190*                   S H O W   C A N C E L                        *
 14191*                                                                *
 14192******************************************************************
 14193
 14194 2100-SHOW-REQUEST.
 14195     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14196
 14197     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14198        MOVE -1                  TO CMAINTL
 14199        GO TO 8200-SEND-DATAONLY.
 14200
 14201     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14202
 14203     IF CSUFIXL NOT = ZEROS
 14204        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14205       ELSE
 14206        MOVE SPACE            TO WS-NEW-SUFFIX.
 14207
 14208     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14209     PERFORM 8600-DEEDIT.
 14210     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14211     MOVE '4'                    TO DC-OPTION-CODE.
 14212     PERFORM 9700-DATE-LINK.
 14213     IF DATE-CONVERSION-ERROR
 14214        MOVE ER-0348             TO EMI-ERROR
 14215        MOVE -1                  TO CEFFDTL
 14216        MOVE AL-UABON            TO CEFFDTA
 14217        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14218        GO TO 8200-SEND-DATAONLY
 14219     ELSE
 14220        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14221        MOVE AL-UANON            TO CEFFDTA
 14222        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14223
 14224     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14225
 14226     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14227        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14228        MOVE 'Y'                    TO WS-SHOW-SW
 14229        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14230           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14231        ELSE
 14232           IF PI-FILE-BROWSE
 14233              GO TO 4300-BROWSE-FILE-FORWARD
 14234           ELSE
 14235              IF PI-CSR-BROWSE
 14236                 GO TO 4200-BROWSE-CSR-FORWARD
 14237              ELSE
 14238                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14239     ELSE
 14240        GO TO 3900-RE-DISPLAY-RECORD.
 14241
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 262
* EL6311.cbl
 14243
 14244
 14245******************************************************************
 14246*                                                                *
 14247*            A D D   C A N C E L   R O U T I N E                 *
 14248*                                                                *
 14249******************************************************************
 14250
 14251 2200-ADD-CANCEL-ROUTINE.
 14252     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14253
 14254
 14255* EXEC CICS GETMAIN
 14256*        SET     (ADDRESS OF PENDING-BUSINESS)
 14257*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14258*    END-EXEC.
 14259*    MOVE '," L                  $   #00012808' TO DFHEIV0
 14260     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14261     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14262     MOVE X'2020233030303132383038' TO DFHEIV0(25:11)
 14263     CALL 'kxdfhei1' USING DFHEIV0,
 14264           DFHEIV20,
 14265           ERPNDB-RECORD-LENGTH,
 14266           DFHEIV99
 14267     SET ADDRESS OF PENDING-BUSINESS TO
 14268         DFHEIV20
 14269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14270
 14271
 14272
 14273* EXEC CICS HANDLE CONDITION
 14274*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14275*    END-EXEC.
 14276*    MOVE '"$I                   ! 3 #00012813' TO DFHEIV0
 14277     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14278     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14279     MOVE X'3320233030303132383133' TO DFHEIV0(25:11)
 14280     CALL 'kxdfhei1' USING DFHEIV0
 14281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14282
 14283
 14284     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14285     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14286     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14287
 14288
 14289* EXEC CICS READ
 14290*        INTO    (PENDING-BUSINESS)
 14291*        DATASET (FILE-ID-ERPNDB)
 14292*        RIDFLD  (ERPNDB-KEY)
 14293*    END-EXEC.
 14294     MOVE LENGTH OF
 14295      PENDING-BUSINESS
 14296       TO DFHEIV11
 14297*    MOVE '&"IL       E          (   #00012821' TO DFHEIV0
 14298     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14299     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14300     MOVE X'2020233030303132383231' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 263
* EL6311.cbl
 14301     CALL 'kxdfhei1' USING DFHEIV0,
 14302           FILE-ID-ERPNDB,
 14303           PENDING-BUSINESS,
 14304           DFHEIV11,
 14305           ERPNDB-KEY,
 14306           DFHEIV99,
 14307           DFHEIV99,
 14308           DFHEIV99
 14309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14310
 14311
 14312     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14313
 14314     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14315     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14316     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14317     MOVE SPACES                 TO PENDING-BUSINESS.
 14318     MOVE 'PB'                   TO PB-RECORD-ID.
 14319     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14320     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14321     MOVE SPACES                 TO PB-CERT-SFX.
 14322     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14323     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14324                                    PB-ALT-CHG-SEQ-NO.
 14325
 14326     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14327     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14328     MOVE '2'                    TO PB-RECORD-TYPE.
 14329
 14330     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14331     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14332
 14333
 14334     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14335                                    PB-ALT-CHG-SEQ-NO
 14336                                    PB-C-LF-REF-CALC
 14337                                    PB-C-AH-REF-CALC
 14338                                    PB-C-LF-RFND-CLP
 14339                                    PB-C-AH-RFND-CLP
 14340                                    PB-CI-INSURED-AGE
 14341                                    PB-CI-LF-TERM
 14342                                    PB-CI-AH-TERM
 14343                                    PB-CI-LF-BENEFIT-CD
 14344                                    PB-CI-LF-BENEFIT-AMT
 14345                                    PB-CI-LF-ALT-BENEFIT-AMT
 14346                                    PB-CI-LF-PREMIUM-AMT
 14347                                    PB-CI-LF-ALT-PREMIUM-AMT
 14348                                    PB-CI-AH-BENEFIT-CD
 14349                                    PB-CI-AH-BENEFIT-AMT
 14350                                    PB-CI-AH-PREMIUM-AMT
 14351                                    PB-CI-PAY-FREQUENCY
 14352                                    PB-CI-LOAN-APR
 14353                                    PB-CI-LOAN-TERM
 14354                                    PB-CI-LIFE-COMMISSION
 14355                                    PB-CI-AH-COMMISSION
 14356                                    PB-CI-CURR-SEQ
 14357                                    PB-CI-AH-CANCEL-AMT
 14358                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 264
* EL6311.cbl
 14359                                    PB-CI-RATE-DEV-PCT-LF
 14360                                    PB-CI-RATE-DEV-PCT-AH
 14361                                    PB-CI-EXTENTION-DAYS
 14362                                    PB-CI-TERM-IN-DAYS
 14363                                    PB-CI-LIVES
 14364                                    PB-CI-LF-CRIT-PER
 14365                                    PB-CI-AH-CRIT-PER
 14366                                    PB-C-LF-REM-TERM
 14367                                    PB-C-AH-REM-TERM
 14368                                    PB-CHG-COUNT
 14369                                    PB-LF-BILLED-AMTS
 14370                                    PB-AH-BILLED-AMTS
 14371                                    PB-C-NH-INT-ON-REFS
 14372*                                   PB-C-MICROFILM-NO
 14373                                    PB-CALC-TOLERANCE.
 14374
 14375     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14376                                    PB-CI-AH-SETTLEMENT-DT
 14377                                    PB-CI-DEATH-DT
 14378                                    PB-CI-LF-PRIOR-CANCEL-DT
 14379                                    PB-CI-AH-PRIOR-CANCEL-DT
 14380                                    PB-CI-ENTRY-DT
 14381                                    PB-CI-LF-EXPIRE-DT
 14382                                    PB-CI-AH-EXPIRE-DT
 14383                                    PB-CI-LOAN-1ST-PMT-DT
 14384                                    PB-C-LF-CANCEL-DT
 14385                                    PB-C-AH-CANCEL-DT
 14386                                    PB-CREDIT-ACCEPT-DT
 14387                                    PB-BILLED-DT
 14388                                    PB-ACCT-EFF-DT
 14389                                    PB-ACCT-EXP-DT.
 14390
 14391     MOVE 'X'                    TO PB-FATAL-FLAG.
 14392
 14393     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14394
 14395     IF CSUFIXL     GREATER THAN ZEROS
 14396        MOVE CSUFIXI             TO PB-CERT-SFX.
 14397
 14398*    IF CMICRNOL  GREATER  ZEROS
 14399*        IF CMICRNOI  NUMERIC
 14400*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14401*            MOVE AL-UNNON       TO  CMICRNOA
 14402*        ELSE
 14403*            MOVE -1             TO  CMICRNOL
 14404*            MOVE AL-UNBON       TO  CMICRNOA
 14405*            MOVE ER-2701        TO  EMI-ERROR
 14406*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14407
 14408     IF CLSTNML     GREATER THAN ZEROS
 14409        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14410
 14411     IF CCANREAL > ZEROS
 14412        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14413     END-IF
 14414     IF CPCYNL > ZEROS
 14415        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14416     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 265
* EL6311.cbl
 14417     IF CCANDT1L    GREATER THAN ZEROS
 14418        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14419
 14420     IF CCANDT2L    GREATER THAN ZEROS
 14421        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14422
 14423     IF CMTHD1L    GREATER THAN +0
 14424        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14425
 14426     IF CMTHD2L    GREATER THAN +0
 14427        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14428
 14429     IF CREFND1L    GREATER THAN ZEROS
 14430        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14431        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14432     ELSE
 14433        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14434
 14435     IF CREFND2L    GREATER THAN ZEROS
 14436        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14437        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14438     ELSE
 14439        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14440
 14441     IF CLIVESL     GREATER THAN ZEROS
 14442        MOVE WS-CLIVES           TO PB-C-LIVES
 14443     ELSE
 14444        MOVE ZEROS               TO PB-C-LIVES.
 14445
 14446     IF CPAYEEL     GREATER THAN ZEROS
 14447        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14448
 14449     IF CFORCEL     GREATER THAN ZEROS
 14450        MOVE CFORCEI             TO PB-FORCE-CODE.
 14451
 14452     IF CBILCDL     GREATER THAN ZEROS
 14453        MOVE CBILCDI             TO PB-RECORD-BILL.
 14454
 14455*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14456
 14457 2260-WRITE-PB-RECORD.
 14458     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14459                                    PB-INPUT-BY.
 14460     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14461     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14462                                    PB-INPUT-DT.
 14463
 14464     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14465     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14466                                    PB-CONTROL-BY-ORIG-BATCH.
 14467
 14468     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14469     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14470     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14471     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14472     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14473
 14474     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 266
* EL6311.cbl
 14475
 14476     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14477
 14478     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14479     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14480     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14481
 14482     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14483     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14484
 14485 2275-WRITE-PENDING-BUSINESS.
 14486     MOVE 'A'                    TO JP-RECORD-TYPE.
 14487     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14488     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14489     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14490
 14491
 14492* EXEC CICS HANDLE CONDITION
 14493*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14494*    END-EXEC.
 14495*    MOVE '"$%                   ! 4 #00013006' TO DFHEIV0
 14496     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14497     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14498     MOVE X'3420233030303133303036' TO DFHEIV0(25:11)
 14499     CALL 'kxdfhei1' USING DFHEIV0
 14500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14501
 14502
 14503
 14504* EXEC CICS WRITE
 14505*        DATASET (FILE-ID-ERPNDB)
 14506*        FROM    (PENDING-BUSINESS)
 14507*        RIDFLD  (PB-CONTROL-PRIMARY)
 14508*    END-EXEC.
 14509     MOVE LENGTH OF
 14510      PENDING-BUSINESS
 14511       TO DFHEIV11
 14512*    MOVE '&$ L                  ''   #00013010' TO DFHEIV0
 14513     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14514     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14515     MOVE X'2020233030303133303130' TO DFHEIV0(25:11)
 14516     CALL 'kxdfhei1' USING DFHEIV0,
 14517           FILE-ID-ERPNDB,
 14518           PENDING-BUSINESS,
 14519           DFHEIV11,
 14520           PB-CONTROL-PRIMARY,
 14521           DFHEIV99,
 14522           DFHEIV99
 14523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14524
 14525
 14526     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14527
 14528     PERFORM 8400-LOG-JOURNAL-RECORD.
 14529
 14530******************************************************************
 14531*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14532******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 267
* EL6311.cbl
 14533
 14534     display ' made it to add orig CANCEL cert '
 14535     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14536     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14537     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14538     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14539
 14540
 14541* EXEC CICS READ
 14542*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14543*        DATASET (FILE-ID-ELCERT)
 14544*        RIDFLD  (ELCERT-KEY)
 14545*        RESP    (WS-RESPONSE)
 14546*    END-EXEC.
 14547*    MOVE '&"S        E          (  N#00013030' TO DFHEIV0
 14548     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14549     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14550     MOVE X'204E233030303133303330' TO DFHEIV0(25:11)
 14551     CALL 'kxdfhei1' USING DFHEIV0,
 14552           FILE-ID-ELCERT,
 14553           DFHEIV20,
 14554           DFHEIV99,
 14555           ELCERT-KEY,
 14556           DFHEIV99,
 14557           DFHEIV99,
 14558           DFHEIV99
 14559     SET ADDRESS OF CERTIFICATE-MASTER TO
 14560         DFHEIV20
 14561     MOVE EIBRESP  TO WS-RESPONSE
 14562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14563
 14564
 14565     IF NOT RESP-NORMAL
 14566        GO TO 2276-BYPASS-CRTO
 14567     END-IF
 14568
 14569     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14570     MOVE ' '                    TO WS-ERMAIL-SW
 14571
 14572
 14573* EXEC CICS READ
 14574*       DATASET   (FILE-ID-ERMAIL)
 14575*       SET       (ADDRESS OF MAILING-DATA)
 14576*       RIDFLD    (ERMAIL-KEY)
 14577*       RESP      (WS-RESPONSE)
 14578*    END-EXEC
 14579*    MOVE '&"S        E          (  N#00013044' TO DFHEIV0
 14580     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14581     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14582     MOVE X'204E233030303133303434' TO DFHEIV0(25:11)
 14583     CALL 'kxdfhei1' USING DFHEIV0,
 14584           FILE-ID-ERMAIL,
 14585           DFHEIV20,
 14586           DFHEIV99,
 14587           ERMAIL-KEY,
 14588           DFHEIV99,
 14589           DFHEIV99,
 14590           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 268
* EL6311.cbl
 14591     SET ADDRESS OF MAILING-DATA TO
 14592         DFHEIV20
 14593     MOVE EIBRESP  TO WS-RESPONSE
 14594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14595
 14596     IF RESP-NORMAL
 14597        SET ERMAIL-FOUND TO TRUE
 14598     END-IF
 14599
 14600     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 14601
 14602     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 14603     MOVE 'OC'                   TO OC-RECORD-ID
 14604     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14605                                 TO OC-CONTROL-PRIMARY (1:33)
 14606     MOVE 'I'                    TO OC-RECORD-TYPE
 14607     MOVE +4096                  TO OC-KEY-SEQ-NO
 14608     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 14609     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 14610     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 14611
 14612     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 14613     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 14614     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 14615     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 14616     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 14617     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 14618     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 14619     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 14620     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 14621     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 14622     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 14623     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 14624     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 14625     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 14626     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 14627     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 14628     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 14629     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 14630     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 14631     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 14632     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 14633     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 14634     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 14635     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 14636     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 14637     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 14638     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 14639     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 14640     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 14641     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 14642     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 14643     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 14644
 14645     IF ERMAIL-FOUND
 14646        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 14647     END-IF
 14648     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 269
* EL6311.cbl
 14649        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 14650                           OC-INS-AGE-DEFAULT-FLAG
 14651        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 14652                           OC-JNT-AGE-DEFAULT-FLAG
 14653     END-IF
 14654     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 14655     .
 14656 2275-WRITE-ELCRTO.
 14657
 14658
 14659* EXEC CICS WRITE
 14660*       DATASET   ('ELCRTO')
 14661*       FROM      (ORIGINAL-CERTIFICATE)
 14662*       RIDFLD    (OC-CONTROL-PRIMARY)
 14663*       RESP      (WS-RESPONSE)
 14664*    END-EXEC
 14665     MOVE LENGTH OF
 14666      ORIGINAL-CERTIFICATE
 14667       TO DFHEIV11
 14668     MOVE 'ELCRTO' TO DFHEIV1
 14669*    MOVE '&$ L                  ''  N#00013113' TO DFHEIV0
 14670     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14671     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14672     MOVE X'204E233030303133313133' TO DFHEIV0(25:11)
 14673     CALL 'kxdfhei1' USING DFHEIV0,
 14674           DFHEIV1,
 14675           ORIGINAL-CERTIFICATE,
 14676           DFHEIV11,
 14677           OC-CONTROL-PRIMARY,
 14678           DFHEIV99,
 14679           DFHEIV99
 14680     MOVE EIBRESP  TO WS-RESPONSE
 14681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14682
 14683     display ' just wrote 2275 ' ws-response
 14684     IF RESP-DUPKEY
 14685        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 14686        GO TO 2275-WRITE-ELCRTO
 14687     ELSE
 14688        IF NOT RESP-NORMAL
 14689           MOVE -1               TO BMAINTL
 14690           MOVE ER-7450          TO EMI-ERROR
 14691           PERFORM 9900-ERROR-FORMAT
 14692                                 THRU 9900-EXIT
 14693           GO TO 8200-SEND-DATAONLY
 14694        END-IF
 14695     END-IF.
 14696
 14697 2276-BYPASS-CRTO.
 14698******************************************************************
 14699*       U P D A T E   T H E   B A T C H   H E A D E R            *
 14700******************************************************************
 14701
 14702
 14703* EXEC CICS READ
 14704*        INTO    (PENDING-BUSINESS)
 14705*        DATASET (FILE-ID-ERPNDB)
 14706*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 270
* EL6311.cbl
 14707*        UPDATE
 14708*    END-EXEC.
 14709     MOVE LENGTH OF
 14710      PENDING-BUSINESS
 14711       TO DFHEIV11
 14712*    MOVE '&"IL       EU         (   #00013139' TO DFHEIV0
 14713     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14714     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14715     MOVE X'2020233030303133313339' TO DFHEIV0(25:11)
 14716     CALL 'kxdfhei1' USING DFHEIV0,
 14717           FILE-ID-ERPNDB,
 14718           PENDING-BUSINESS,
 14719           DFHEIV11,
 14720           ERPNDB-KEY,
 14721           DFHEIV99,
 14722           DFHEIV99,
 14723           DFHEIV99
 14724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14725
 14726
 14727     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14728     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14729     MOVE 'B'                    TO JP-RECORD-TYPE.
 14730     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14731
 14732     PERFORM 8400-LOG-JOURNAL-RECORD.
 14733
 14734     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 14735
 14736
 14737* EXEC CICS REWRITE
 14738*        DATASET (FILE-ID-ERPNDB)
 14739*        FROM    (PENDING-BUSINESS)
 14740*    END-EXEC.
 14741     MOVE LENGTH OF
 14742      PENDING-BUSINESS
 14743       TO DFHEIV11
 14744*    MOVE '&& L                  %   #00013155' TO DFHEIV0
 14745     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14746     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14747     MOVE X'2020233030303133313535' TO DFHEIV0(25:11)
 14748     CALL 'kxdfhei1' USING DFHEIV0,
 14749           FILE-ID-ERPNDB,
 14750           PENDING-BUSINESS,
 14751           DFHEIV11,
 14752           DFHEIV99
 14753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14754
 14755
 14756     MOVE 'C'                    TO JP-RECORD-TYPE.
 14757     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14758
 14759     PERFORM 8400-LOG-JOURNAL-RECORD.
 14760
 14761     IF WS-ERRORS-PRESENT
 14762        GO TO 3900-RE-DISPLAY-RECORD.
 14763
 14764     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 271
* EL6311.cbl
 14765     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14766     MOVE LOW-VALUES             TO EL631CI.
 14767     MOVE  -1                    TO CMAINTL.
 14768     GO TO 8100-SEND-INITIAL-MAP.
 14769
 14770 2280-BATCH-HDR-NOT-FOUND.
 14771     MOVE -1                     TO BMAINTL.
 14772     MOVE ER-7450                TO EMI-ERROR.
 14773     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14774     GO TO 8200-SEND-DATAONLY.
 14775
 14776 2290-DUPLICATE-ALT-INDEX.
 14777
 14778******************************************************************
 14779*                                                                *
 14780*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 14781*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 14782*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 14783*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 14784*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 14785*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 14786*                                                                *
 14787******************************************************************
 14788
 14789     IF LCP-ONCTR-02 =  0
 14790         ADD 1 TO LCP-ONCTR-02
 14791        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 14792
 14793     ADD +1                      TO WS-SEQ-NO-COUNTER.
 14794
 14795     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 14796         NEXT SENTENCE
 14797     ELSE
 14798         ADD +1 TO PB-BATCH-SEQ-NO
 14799                   PB-CSR-BATCH-SEQ-NO
 14800         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 14801         GO TO 2275-WRITE-PENDING-BUSINESS.
 14802
 14803     MOVE -1                     TO CCERTNOL.
 14804     MOVE AL-UABON               TO CCERTNOA.
 14805     MOVE AL-UNBON               TO CEFFDTA.
 14806
 14807     MOVE 1                      TO EMI-SUB
 14808                                    EMI-SWITCH1
 14809                                    EMI-SWITCH-AREA-1
 14810                                    EMI-SWITCH-AREA-2.
 14811
 14812     MOVE SPACES                 TO EMI-ERROR-LINES.
 14813
 14814
 14815* EXEC CICS SYNCPOINT ROLLBACK
 14816*    END-EXEC.
 14817*    MOVE '6"R                   !   #00013218' TO DFHEIV0
 14818     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14819     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14820     MOVE X'2020233030303133323138' TO DFHEIV0(25:11)
 14821     CALL 'kxdfhei1' USING DFHEIV0
 14822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 272
* EL6311.cbl
 14823
 14824
 14825     MOVE ER-2247                TO EMI-ERROR.
 14826     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14827     GO TO 8200-SEND-DATAONLY.
 14828
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 273
* EL6311.cbl
 14830
 14831******************************************************************
 14832*                                                                *
 14833*          C H A N G E   C A N C E L   R O U T I N E             *
 14834*                                                                *
 14835******************************************************************
 14836
 14837***************************************************************
 14838*                                                             *
 14839*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 14840*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 14841*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 14842*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 14843*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 14844*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 14845*     5. LINK TO THE EDIT ROUTINE.                            *
 14846*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 14847*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 14848*              THE EDIT ROUTINE.                              *
 14849*     7. REWRITE THE NEW ISSUE                                *
 14850*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 14851*                                                             *
 14852***************************************************************
 14853 2300-CHANGE-CANCEL-ROUTINE.
 14854     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 14855
 14856     IF CCHGL NOT = ZEROS
 14857        MOVE ER-2196             TO EMI-ERROR
 14858        MOVE AL-UABON            TO CMAINTA
 14859        MOVE -1                  TO CMAINTL
 14860        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14861        GO TO 8200-SEND-DATAONLY.
 14862
 14863     MOVE CCERTNOI               TO WS-NEW-PRIME.
 14864
 14865     IF CSUFIXL NOT = ZEROS
 14866        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 14867     ELSE
 14868        MOVE SPACE               TO WS-NEW-SUFFIX.
 14869
 14870     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14871     PERFORM 8600-DEEDIT.
 14872     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14873     MOVE '4'                    TO DC-OPTION-CODE.
 14874
 14875     PERFORM 9700-DATE-LINK.
 14876
 14877     IF DATE-CONVERSION-ERROR
 14878        MOVE ER-0348             TO EMI-ERROR
 14879        MOVE -1                  TO CEFFDTL
 14880        MOVE AL-UABON            TO CEFFDTA
 14881        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14882        GO TO 8200-SEND-DATAONLY
 14883     ELSE
 14884        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14885        MOVE AL-UANON            TO CEFFDTA
 14886        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14887
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 274
* EL6311.cbl
 14888 2325-PROCESS-CANCEL-CHANGES.
 14889
 14890* EXEC CICS HANDLE CONDITION
 14891*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 14892*    END-EXEC.
 14893*    MOVE '"$I                   ! 5 #00013285' TO DFHEIV0
 14894     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14895     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14896     MOVE X'3520233030303133323835' TO DFHEIV0(25:11)
 14897     CALL 'kxdfhei1' USING DFHEIV0
 14898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14899
 14900
 14901     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 14902     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14903     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14904
 14905
 14906* EXEC CICS GETMAIN
 14907*        SET      (ADDRESS OF PENDING-BUSINESS)
 14908*        LENGTH   (ERPNDB-RECORD-LENGTH)
 14909*        INITIMG  (GETMAIN-SPACE)
 14910*     END-EXEC.
 14911*    MOVE ',"IL                  $   #00013293' TO DFHEIV0
 14912     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14913     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14914     MOVE X'2020233030303133323933' TO DFHEIV0(25:11)
 14915     CALL 'kxdfhei1' USING DFHEIV0,
 14916           DFHEIV20,
 14917           ERPNDB-RECORD-LENGTH,
 14918           GETMAIN-SPACE
 14919     SET ADDRESS OF PENDING-BUSINESS TO
 14920         DFHEIV20
 14921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14922
 14923
 14924
 14925* EXEC CICS READ
 14926*        INTO    (PENDING-BUSINESS)
 14927*        DATASET (FILE-ID-ERPNDB)
 14928*        RIDFLD  (ERPNDB-KEY)
 14929*    END-EXEC.
 14930     MOVE LENGTH OF
 14931      PENDING-BUSINESS
 14932       TO DFHEIV11
 14933*    MOVE '&"IL       E          (   #00013299' TO DFHEIV0
 14934     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14935     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14936     MOVE X'2020233030303133323939' TO DFHEIV0(25:11)
 14937     CALL 'kxdfhei1' USING DFHEIV0,
 14938           FILE-ID-ERPNDB,
 14939           PENDING-BUSINESS,
 14940           DFHEIV11,
 14941           ERPNDB-KEY,
 14942           DFHEIV99,
 14943           DFHEIV99,
 14944           DFHEIV99
 14945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 275
* EL6311.cbl
 14946
 14947
 14948     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14949
 14950
 14951* EXEC CICS HANDLE CONDITION
 14952*         NOTFND     (2385-REC-NOT-FOUND)
 14953*    END-EXEC.
 14954*    MOVE '"$I                   ! 6 #00013307' TO DFHEIV0
 14955     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14956     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14957     MOVE X'3620233030303133333037' TO DFHEIV0(25:11)
 14958     CALL 'kxdfhei1' USING DFHEIV0
 14959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14960
 14961
 14962**********************************************************
 14963*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 14964*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 14965**********************************************************
 14966
 14967
 14968* EXEC CICS READ
 14969*        DATASET (FILE-ID-ERPNDB)
 14970*        INTO    (PENDING-BUSINESS)
 14971*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 14972*    END-EXEC.
 14973     MOVE LENGTH OF
 14974      PENDING-BUSINESS
 14975       TO DFHEIV11
 14976*    MOVE '&"IL       E          (   #00013316' TO DFHEIV0
 14977     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14978     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14979     MOVE X'2020233030303133333136' TO DFHEIV0(25:11)
 14980     CALL 'kxdfhei1' USING DFHEIV0,
 14981           FILE-ID-ERPNDB,
 14982           PENDING-BUSINESS,
 14983           DFHEIV11,
 14984           PI-PREV-CONTROL-PRIMARY,
 14985           DFHEIV99,
 14986           DFHEIV99,
 14987           DFHEIV99
 14988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14989
 14990
 14991********** DO NOT ALLOW CHANGES IF THRU A/R
 14992     IF BMAINTI = 'C'
 14993         IF PB-EL860-INTERNAL-PROCESS
 14994             MOVE ER-4005          TO EMI-ERROR
 14995             MOVE -1               TO BMAINTL
 14996             MOVE AL-UABON         TO BMAINTA
 14997             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14998             GO TO 8200-SEND-DATAONLY.
 14999**********
 15000
 15001     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15002        MOVE -1                 TO CMAINTL
 15003        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 276
* EL6311.cbl
 15004        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15005        GO TO 8200-SEND-DATAONLY.
 15006
 15007     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15008        MOVE ER-2196             TO EMI-ERROR
 15009        MOVE AL-UABON            TO CMAINTA
 15010        MOVE -1                  TO CMAINTL
 15011        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15012        GO TO 8200-SEND-DATAONLY.
 15013     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15014
 15015     IF PB-BILLED-DT = LOW-VALUES AND
 15016        PB-CHG-COUNT = ZEROS
 15017        NEXT SENTENCE
 15018     ELSE
 15019        IF (CREFND1L GREATER THAN ZEROS AND
 15020            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15021           OR
 15022           (CREFND2L GREATER THAN ZEROS AND
 15023            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15024           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15025
 15026
 15027* EXEC CICS READ
 15028*        DATASET (FILE-ID-ERPNDB)
 15029*        INTO    (PENDING-BUSINESS)
 15030*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15031*        UPDATE
 15032*    END-EXEC.
 15033     MOVE LENGTH OF
 15034      PENDING-BUSINESS
 15035       TO DFHEIV11
 15036*    MOVE '&"IL       EU         (   #00013357' TO DFHEIV0
 15037     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15038     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15039     MOVE X'2020233030303133333537' TO DFHEIV0(25:11)
 15040     CALL 'kxdfhei1' USING DFHEIV0,
 15041           FILE-ID-ERPNDB,
 15042           PENDING-BUSINESS,
 15043           DFHEIV11,
 15044           PI-PREV-CONTROL-PRIMARY,
 15045           DFHEIV99,
 15046           DFHEIV99,
 15047           DFHEIV99
 15048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15049
 15050
 15051     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15052     MOVE 'B'                    TO JP-RECORD-TYPE
 15053     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15054     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15055
 15056     PERFORM 8400-LOG-JOURNAL-RECORD.
 15057
 15058     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15059          PB-CHG-COUNT NOT = ZEROS
 15060        IF (CREFND1L GREATER THAN ZEROS AND
 15061            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 277
* EL6311.cbl
 15062           OR
 15063           (CREFND2L GREATER THAN ZEROS AND
 15064            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15065            ADD +1                      TO PB-CHG-COUNT
 15066            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15067
 15068*    IF CMICRNOL  GREATER  ZEROS
 15069*        IF CMICRNOI  NUMERIC
 15070*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15071*            MOVE AL-UNNON       TO  CMICRNOA
 15072*        ELSE
 15073*            MOVE -1             TO  CMICRNOL
 15074*            MOVE AL-UNBON       TO  CMICRNOA
 15075*            MOVE ER-2701        TO  EMI-ERROR
 15076*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15077
 15078     IF CSUFIXL GREATER THAN ZEROS
 15079        MOVE CSUFIXI             TO PB-CERT-SFX.
 15080
 15081     IF CLSTNML GREATER THAN ZEROS
 15082         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15083
 15084     IF CCANREAL > ZEROS
 15085        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15086     END-IF
 15087     IF CPCYNL > ZEROS
 15088        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15089     END-IF
 15090     IF CCANDT1L    GREATER THAN ZEROS
 15091        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15092
 15093     IF CCANDT2L    GREATER THAN ZEROS
 15094        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15095
 15096     IF CMTHD1L    GREATER THAN +0
 15097        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15098
 15099     IF CMTHD2L    GREATER THAN +0
 15100        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15101
 15102     IF CREFND1L    GREATER THAN ZEROS
 15103        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15104        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15105        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15106        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15107
 15108     IF CREFND2L    GREATER THAN ZEROS
 15109        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15110        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15111        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15112        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15113
 15114     IF CLIVESL     GREATER THAN ZEROS
 15115        MOVE WS-CLIVES           TO PB-C-LIVES.
 15116
 15117     IF CPAYEEL     GREATER THAN ZEROS
 15118        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15119
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 278
* EL6311.cbl
 15120     IF CFORCEL     GREATER THAN ZEROS
 15121        MOVE CFORCEI             TO PB-FORCE-CODE.
 15122
 15123     IF CBILCDL     GREATER THAN ZEROS
 15124        MOVE CBILCDI             TO PB-RECORD-BILL.
 15125
 15126 2360-REWRITE-PB-RECORD.
 15127     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15128     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15129     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15130     MOVE 'C'                    TO JP-RECORD-TYPE.
 15131     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15132     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15133     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15134
 15135     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15136
 15137     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15138     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15139
 15140     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15141
 15142     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15143
 15144     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15145     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15146     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15147
 15148     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15149     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15150
 15151 2375-REWRITE-PENDING-BUSINESS.
 15152     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15153     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15154     MOVE 'C'                    TO JP-RECORD-TYPE.
 15155     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15156
 15157
 15158* EXEC CICS REWRITE
 15159*        DATASET (FILE-ID-ERPNDB)
 15160*        FROM    (PENDING-BUSINESS)
 15161*    END-EXEC.
 15162     MOVE LENGTH OF
 15163      PENDING-BUSINESS
 15164       TO DFHEIV11
 15165*    MOVE '&& L                  %   #00013470' TO DFHEIV0
 15166     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15167     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15168     MOVE X'2020233030303133343730' TO DFHEIV0(25:11)
 15169     CALL 'kxdfhei1' USING DFHEIV0,
 15170           FILE-ID-ERPNDB,
 15171           PENDING-BUSINESS,
 15172           DFHEIV11,
 15173           DFHEIV99
 15174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15175
 15176
 15177     PERFORM 8400-LOG-JOURNAL-RECORD.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 279
* EL6311.cbl
 15178
 15179******************************************************************
 15180*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15181******************************************************************
 15182
 15183     display ' made it to update orig cancel cert '
 15184
 15185     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15186     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15187     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15188     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15189
 15190
 15191* EXEC CICS READ
 15192*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15193*        DATASET (FILE-ID-ELCERT)
 15194*        RIDFLD  (ELCERT-KEY)
 15195*        RESP    (WS-RESPONSE)
 15196*    END-EXEC.
 15197*    MOVE '&"S        E          (  N#00013488' TO DFHEIV0
 15198     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15199     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15200     MOVE X'204E233030303133343838' TO DFHEIV0(25:11)
 15201     CALL 'kxdfhei1' USING DFHEIV0,
 15202           FILE-ID-ELCERT,
 15203           DFHEIV20,
 15204           DFHEIV99,
 15205           ELCERT-KEY,
 15206           DFHEIV99,
 15207           DFHEIV99,
 15208           DFHEIV99
 15209     SET ADDRESS OF CERTIFICATE-MASTER TO
 15210         DFHEIV20
 15211     MOVE EIBRESP  TO WS-RESPONSE
 15212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15213
 15214
 15215     IF NOT RESP-NORMAL
 15216        GO TO 2376-BYPASS-CRTO
 15217     END-IF
 15218
 15219
 15220     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15221     MOVE ' '                    TO WS-ERMAIL-SW
 15222
 15223
 15224* EXEC CICS READ
 15225*       DATASET   (FILE-ID-ERMAIL)
 15226*       SET       (ADDRESS OF MAILING-DATA)
 15227*       RIDFLD    (ERMAIL-KEY)
 15228*       RESP      (WS-RESPONSE)
 15229*    END-EXEC
 15230*    MOVE '&"S        E          (  N#00013503' TO DFHEIV0
 15231     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15232     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15233     MOVE X'204E233030303133353033' TO DFHEIV0(25:11)
 15234     CALL 'kxdfhei1' USING DFHEIV0,
 15235           FILE-ID-ERMAIL,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 280
* EL6311.cbl
 15236           DFHEIV20,
 15237           DFHEIV99,
 15238           ERMAIL-KEY,
 15239           DFHEIV99,
 15240           DFHEIV99,
 15241           DFHEIV99
 15242     SET ADDRESS OF MAILING-DATA TO
 15243         DFHEIV20
 15244     MOVE EIBRESP  TO WS-RESPONSE
 15245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15246
 15247     IF RESP-NORMAL
 15248        SET ERMAIL-FOUND TO TRUE
 15249     END-IF
 15250
 15251     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15252
 15253     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15254                                 TO ELCRTO-KEY
 15255     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15256     MOVE +0                     TO ELCRTO-SEQ-NO
 15257
 15258
 15259* EXEC CICS READ
 15260*       DATASET   ('ELCRTO')
 15261*       INTO      (ORIGINAL-CERTIFICATE)
 15262*       RIDFLD    (ELCRTO-KEY)
 15263*       GTEQ
 15264*       RESP      (WS-RESPONSE)
 15265*    END-EXEC
 15266     MOVE LENGTH OF
 15267      ORIGINAL-CERTIFICATE
 15268       TO DFHEIV11
 15269     MOVE 'ELCRTO' TO DFHEIV1
 15270*    MOVE '&"IL       G          (  N#00013521' TO DFHEIV0
 15271     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15272     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15273     MOVE X'204E233030303133353231' TO DFHEIV0(25:11)
 15274     CALL 'kxdfhei1' USING DFHEIV0,
 15275           DFHEIV1,
 15276           ORIGINAL-CERTIFICATE,
 15277           DFHEIV11,
 15278           ELCRTO-KEY,
 15279           DFHEIV99,
 15280           DFHEIV99,
 15281           DFHEIV99
 15282     MOVE EIBRESP  TO WS-RESPONSE
 15283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15284
 15285     display ' just read gteq ' ws-response
 15286     IF RESP-NORMAL
 15287        AND (OC-CONTROL-PRIMARY (1:33) =
 15288                 PB-CONTROL-BY-ACCOUNT (1:33))
 15289        AND (OC-RECORD-TYPE = 'I')
 15290        display ' resp norm, key =, type i '
 15291        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15292           display ' end proc blank '
 15293           display ' csr edit session ' PI-CSR-SESSION-SW
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 281
* EL6311.cbl
 15294           IF NOT CSR-EDIT-SESSION
 15295
 15296* EXEC CICS READ
 15297*                DATASET   ('ELCRTO')
 15298*                INTO      (ORIGINAL-CERTIFICATE)
 15299*                RIDFLD    (OC-CONTROL-PRIMARY)
 15300*                UPDATE
 15301*                RESP      (WS-RESPONSE)
 15302*             END-EXEC
 15303     MOVE LENGTH OF
 15304      ORIGINAL-CERTIFICATE
 15305       TO DFHEIV11
 15306     MOVE 'ELCRTO' TO DFHEIV1
 15307*    MOVE '&"IL       EU         (  N#00013539' TO DFHEIV0
 15308     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15309     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15310     MOVE X'204E233030303133353339' TO DFHEIV0(25:11)
 15311     CALL 'kxdfhei1' USING DFHEIV0,
 15312           DFHEIV1,
 15313           ORIGINAL-CERTIFICATE,
 15314           DFHEIV11,
 15315           OC-CONTROL-PRIMARY,
 15316           DFHEIV99,
 15317           DFHEIV99,
 15318           DFHEIV99
 15319     MOVE EIBRESP  TO WS-RESPONSE
 15320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15321              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15322              IF RESP-NORMAL
 15323                 display ' good read upd '
 15324                 IF OC-ISSUE-TRAN-IND = 'N'
 15325                    MOVE CM-INSURED-LAST-NAME   TO
 15326                         OC-INS-LAST-NAME
 15327                    MOVE CM-INSURED-FIRST-NAME  TO
 15328                         OC-INS-FIRST-NAME
 15329                    MOVE CM-INSURED-INITIAL2    TO
 15330                         OC-INS-MIDDLE-INIT
 15331                    MOVE CM-INSURED-ISSUE-AGE   TO
 15332                         OC-INS-AGE
 15333                    MOVE CM-JT-LAST-NAME        TO
 15334                         OC-JNT-LAST-NAME
 15335                    MOVE CM-JT-FIRST-NAME       TO
 15336                         OC-JNT-FIRST-NAME
 15337                    MOVE CM-JT-INITIAL          TO
 15338                         OC-JNT-MIDDLE-INIT
 15339                    MOVE CM-INSURED-JOINT-AGE   TO
 15340                         OC-JNT-AGE
 15341                    MOVE CM-LF-BENEFIT-CD       TO
 15342                         OC-LF-BENCD
 15343                    MOVE CM-LF-ORIG-TERM        TO
 15344                         OC-LF-TERM
 15345                    MOVE CM-LF-BENEFIT-AMT      TO
 15346                         OC-LF-BEN-AMT
 15347                    MOVE CM-LF-PREMIUM-AMT      TO
 15348                         OC-LF-PRM-AMT
 15349                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15350                         OC-LF-ALT-BEN-AMT
 15351                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 282
* EL6311.cbl
 15352                         OC-LF-ALT-PRM-AMT
 15353                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15354                         OC-LF-EXP-DT
 15355                    MOVE CM-LIFE-COMM-PCT       TO
 15356                         OC-LF-COMM-PCT
 15357                    MOVE CM-AH-BENEFIT-CD       TO
 15358                         OC-AH-BENCD
 15359                    MOVE CM-AH-ORIG-TERM        TO
 15360                         OC-AH-TERM
 15361                    MOVE CM-AH-BENEFIT-AMT      TO
 15362                         OC-AH-BEN-AMT
 15363                    MOVE CM-AH-PREMIUM-AMT      TO
 15364                         OC-AH-PRM-AMT
 15365                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15366                         OC-AH-EXP-DT
 15367                    MOVE CM-AH-COMM-PCT         TO
 15368                         OC-AH-COMM-PCT
 15369                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15370                         OC-AH-CP
 15371                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15372                         OC-1ST-PMT-DT
 15373                 END-IF
 15374                 MOVE PB-C-LF-CANCEL-DT      TO
 15375                         OC-LF-CANCEL-DT
 15376                 MOVE PB-C-LF-CANCEL-AMT     TO
 15377                         OC-LF-CANCEL-AMT
 15378                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15379                         OC-LF-ITD-CANCEL-AMT
 15380                 MOVE PB-C-AH-CANCEL-DT      TO
 15381                         OC-AH-CANCEL-DT
 15382                 MOVE PB-C-AH-CANCEL-AMT     TO
 15383                         OC-AH-CANCEL-AMT
 15384                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15385                         OC-AH-ITD-CANCEL-AMT
 15386                 MOVE 'Y'                    TO
 15387                         OC-CANCEL-TRAN-IND
 15388                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15389                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15390                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15391                 IF ERMAIL-FOUND
 15392                    MOVE MA-CRED-BENE-NAME
 15393                                 TO OC-CRED-BENE-NAME
 15394                 END-IF
 15395                 IF NOT CERT-TRL-REC-NOT-FOUND
 15396                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15397                           OC-INS-AGE-DEFAULT-FLAG
 15398                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15399                           OC-JNT-AGE-DEFAULT-FLAG
 15400                 END-IF
 15401
 15402* EXEC CICS REWRITE
 15403*                   DATASET   ('ELCRTO')
 15404*                   FROM      (ORIGINAL-CERTIFICATE)
 15405*                   RESP      (WS-RESPONSE)
 15406*                END-EXEC
 15407     MOVE LENGTH OF
 15408      ORIGINAL-CERTIFICATE
 15409       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 283
* EL6311.cbl
 15410     MOVE 'ELCRTO' TO DFHEIV1
 15411*    MOVE '&& L                  %  N#00013626' TO DFHEIV0
 15412     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15413     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15414     MOVE X'204E233030303133363236' TO DFHEIV0(25:11)
 15415     CALL 'kxdfhei1' USING DFHEIV0,
 15416           DFHEIV1,
 15417           ORIGINAL-CERTIFICATE,
 15418           DFHEIV11,
 15419           DFHEIV99
 15420     MOVE EIBRESP  TO WS-RESPONSE
 15421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15422                 display ' just rewrote ' ws-response
 15423              END-IF
 15424           END-IF
 15425        ELSE
 15426           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15427           MOVE 'OC'             TO OC-RECORD-ID
 15428           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15429           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15430           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15431           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15432           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15433           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15434           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15435           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15436           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15437           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15438           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15439           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15440           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15441           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15442           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15443           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15444           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15445           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15446           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15447           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15448           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15449           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15450           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15451           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15452           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15453           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15454           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15455           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15456           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15457           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15458           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15459           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15460           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15461           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15462           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15463           IF ERMAIL-FOUND
 15464              MOVE MA-CRED-BENE-NAME
 15465                                 TO OC-CRED-BENE-NAME
 15466           END-IF
 15467           IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 284
* EL6311.cbl
 15468              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15469                           OC-INS-AGE-DEFAULT-FLAG
 15470              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15471                           OC-JNT-AGE-DEFAULT-FLAG
 15472           END-IF
 15473           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15474
 15475* EXEC CICS WRITE
 15476*             DATASET   ('ELCRTO')
 15477*             FROM      (ORIGINAL-CERTIFICATE)
 15478*             RIDFLD    (OC-CONTROL-PRIMARY)
 15479*             RESP      (WS-RESPONSE)
 15480*          END-EXEC
 15481     MOVE LENGTH OF
 15482      ORIGINAL-CERTIFICATE
 15483       TO DFHEIV11
 15484     MOVE 'ELCRTO' TO DFHEIV1
 15485*    MOVE '&$ L                  ''  N#00013683' TO DFHEIV0
 15486     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15487     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15488     MOVE X'204E233030303133363833' TO DFHEIV0(25:11)
 15489     CALL 'kxdfhei1' USING DFHEIV0,
 15490           DFHEIV1,
 15491           ORIGINAL-CERTIFICATE,
 15492           DFHEIV11,
 15493           OC-CONTROL-PRIMARY,
 15494           DFHEIV99,
 15495           DFHEIV99
 15496     MOVE EIBRESP  TO WS-RESPONSE
 15497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15498        END-IF
 15499     ELSE
 15500        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 15501        MOVE 'OC'                TO OC-RECORD-ID
 15502        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15503                                 TO OC-CONTROL-PRIMARY (1:33)
 15504        MOVE 'I'                 TO OC-RECORD-TYPE
 15505        MOVE +4096               TO OC-KEY-SEQ-NO
 15506        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 15507        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 15508        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 15509        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15510        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15511        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15512        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15513        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15514        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15515        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15516        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15517        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15518        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15519        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15520        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15521        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15522        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15523        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15524        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15525        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 285
* EL6311.cbl
 15526        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15527        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15528        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15529        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15530        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15531        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15532        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15533        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15534        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15535        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15536        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15537        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15538        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15539        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15540        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15541        IF ERMAIL-FOUND
 15542           MOVE MA-CRED-BENE-NAME
 15543                                 TO OC-CRED-BENE-NAME
 15544        END-IF
 15545        IF NOT CERT-TRL-REC-NOT-FOUND
 15546           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15547                           OC-INS-AGE-DEFAULT-FLAG
 15548           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15549                           OC-JNT-AGE-DEFAULT-FLAG
 15550        END-IF
 15551        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 15552
 15553
 15554* EXEC CICS WRITE
 15555*          DATASET   ('ELCRTO')
 15556*          FROM      (ORIGINAL-CERTIFICATE)
 15557*          RIDFLD    (OC-CONTROL-PRIMARY)
 15558*          RESP      (WS-RESPONSE)
 15559*       END-EXEC
 15560     MOVE LENGTH OF
 15561      ORIGINAL-CERTIFICATE
 15562       TO DFHEIV11
 15563     MOVE 'ELCRTO' TO DFHEIV1
 15564*    MOVE '&$ L                  ''  N#00013744' TO DFHEIV0
 15565     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15566     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15567     MOVE X'204E233030303133373434' TO DFHEIV0(25:11)
 15568     CALL 'kxdfhei1' USING DFHEIV0,
 15569           DFHEIV1,
 15570           ORIGINAL-CERTIFICATE,
 15571           DFHEIV11,
 15572           OC-CONTROL-PRIMARY,
 15573           DFHEIV99,
 15574           DFHEIV99
 15575     MOVE EIBRESP  TO WS-RESPONSE
 15576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15577     END-IF.
 15578
 15579 2376-BYPASS-CRTO.
 15580******************************************************************
 15581*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15582******************************************************************
 15583
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 286
* EL6311.cbl
 15584
 15585* EXEC CICS HANDLE CONDITION
 15586*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15587*    END-EXEC.
 15588*    MOVE '"$I                   ! 7 #00013757' TO DFHEIV0
 15589     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15590     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15591     MOVE X'3720233030303133373537' TO DFHEIV0(25:11)
 15592     CALL 'kxdfhei1' USING DFHEIV0
 15593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15594
 15595
 15596
 15597* EXEC CICS READ
 15598*        INTO    (PENDING-BUSINESS)
 15599*        DATASET (FILE-ID-ERPNDB)
 15600*        RIDFLD  (ERPNDB-KEY)
 15601*        UPDATE
 15602*    END-EXEC.
 15603     MOVE LENGTH OF
 15604      PENDING-BUSINESS
 15605       TO DFHEIV11
 15606*    MOVE '&"IL       EU         (   #00013761' TO DFHEIV0
 15607     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15608     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15609     MOVE X'2020233030303133373631' TO DFHEIV0(25:11)
 15610     CALL 'kxdfhei1' USING DFHEIV0,
 15611           FILE-ID-ERPNDB,
 15612           PENDING-BUSINESS,
 15613           DFHEIV11,
 15614           ERPNDB-KEY,
 15615           DFHEIV99,
 15616           DFHEIV99,
 15617           DFHEIV99
 15618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15619
 15620
 15621     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15622     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15623     MOVE 'B'                    TO JP-RECORD-TYPE.
 15624     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15625
 15626     PERFORM 8400-LOG-JOURNAL-RECORD.
 15627
 15628     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15629
 15630
 15631* EXEC CICS REWRITE
 15632*        DATASET (FILE-ID-ERPNDB)
 15633*        FROM    (PENDING-BUSINESS)
 15634*    END-EXEC.
 15635     MOVE LENGTH OF
 15636      PENDING-BUSINESS
 15637       TO DFHEIV11
 15638*    MOVE '&& L                  %   #00013777' TO DFHEIV0
 15639     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15640     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15641     MOVE X'2020233030303133373737' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 287
* EL6311.cbl
 15642     CALL 'kxdfhei1' USING DFHEIV0,
 15643           FILE-ID-ERPNDB,
 15644           PENDING-BUSINESS,
 15645           DFHEIV11,
 15646           DFHEIV99
 15647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15648
 15649
 15650     MOVE 'C'                    TO JP-RECORD-TYPE.
 15651     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15652
 15653     PERFORM 8400-LOG-JOURNAL-RECORD.
 15654
 15655     IF WS-ERRORS-PRESENT
 15656         GO TO 3900-RE-DISPLAY-RECORD.
 15657
 15658     MOVE ZEROS                  TO EMI-ERROR
 15659     MOVE -1                     TO CMAINTL
 15660     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15661     GO TO 3900-RE-DISPLAY-RECORD.
 15662
 15663 2380-BATCH-HDR-NOT-FOUND.
 15664     MOVE -1                     TO BMAINTL.
 15665     MOVE ER-7450                TO EMI-ERROR.
 15666     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15667     GO TO 8200-SEND-DATAONLY.
 15668
 15669 2385-REC-NOT-FOUND.
 15670     MOVE -1                     TO BMAINTL.
 15671     MOVE ER-7451                TO EMI-ERROR.
 15672     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15673     GO TO 8200-SEND-DATAONLY.
 15674
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 288
* EL6311.cbl
 15676
 15677******************************************************************
 15678*                                                                *
 15679*          D E L E T E   C A N C E L   R O U T I N E             *
 15680*                                                                *
 15681******************************************************************
 15682
 15683 2400-DELETE-CANCEL-ROUTINE.
 15684     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 15685
 15686     IF CCHGL NOT = ZEROS
 15687        MOVE ER-2196             TO EMI-ERROR
 15688        MOVE AL-UABON            TO CMAINTA
 15689        MOVE -1                  TO CMAINTL
 15690        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15691        GO TO 8200-SEND-DATAONLY.
 15692
 15693
 15694* EXEC CICS HANDLE CONDITION
 15695*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 15696*    END-EXEC.
 15697*    MOVE '"$I                   ! 8 #00013825' TO DFHEIV0
 15698     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15699     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15700     MOVE X'3820233030303133383235' TO DFHEIV0(25:11)
 15701     CALL 'kxdfhei1' USING DFHEIV0
 15702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15703
 15704
 15705     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15706     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15707     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15708
 15709
 15710* EXEC CICS READ
 15711*        SET     (ADDRESS OF PENDING-BUSINESS)
 15712*        DATASET (FILE-ID-ERPNDB)
 15713*        RIDFLD  (ERPNDB-KEY)
 15714*    END-EXEC.
 15715*    MOVE '&"S        E          (   #00013833' TO DFHEIV0
 15716     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15717     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15718     MOVE X'2020233030303133383333' TO DFHEIV0(25:11)
 15719     CALL 'kxdfhei1' USING DFHEIV0,
 15720           FILE-ID-ERPNDB,
 15721           DFHEIV20,
 15722           DFHEIV99,
 15723           ERPNDB-KEY,
 15724           DFHEIV99,
 15725           DFHEIV99,
 15726           DFHEIV99
 15727     SET ADDRESS OF PENDING-BUSINESS TO
 15728         DFHEIV20
 15729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15730
 15731
 15732     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15733
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 289
* EL6311.cbl
 15734     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15735
 15736     IF CSUFIXL NOT = ZEROS
 15737        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15738     ELSE
 15739        MOVE SPACE               TO WS-NEW-SUFFIX.
 15740
 15741     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15742
 15743     PERFORM 8600-DEEDIT.
 15744     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15745     MOVE '4'                    TO DC-OPTION-CODE.
 15746     PERFORM 9700-DATE-LINK.
 15747
 15748     IF DATE-CONVERSION-ERROR
 15749        MOVE ER-0348             TO EMI-ERROR
 15750        MOVE -1                  TO CEFFDTL
 15751        MOVE AL-UABON            TO CEFFDTA
 15752        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15753        GO TO 8200-SEND-DATAONLY
 15754     ELSE
 15755        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15756        MOVE AL-UANON            TO CEFFDTA
 15757        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15758
 15759
 15760* EXEC CICS HANDLE CONDITION
 15761*         NOTFND    (2490-RECORD-NOT-FOUND)
 15762*    END-EXEC.
 15763*    MOVE '"$I                   ! 9 #00013866' TO DFHEIV0
 15764     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15765     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15766     MOVE X'3920233030303133383636' TO DFHEIV0(25:11)
 15767     CALL 'kxdfhei1' USING DFHEIV0
 15768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15769
 15770
 15771
 15772* EXEC CICS READ
 15773*        SET     (ADDRESS OF PENDING-BUSINESS)
 15774*        DATASET (FILE-ID-ERPNDB)
 15775*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15776*        UPDATE
 15777*    END-EXEC.
 15778*    MOVE '&"S        EU         (   #00013870' TO DFHEIV0
 15779     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15780     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15781     MOVE X'2020233030303133383730' TO DFHEIV0(25:11)
 15782     CALL 'kxdfhei1' USING DFHEIV0,
 15783           FILE-ID-ERPNDB,
 15784           DFHEIV20,
 15785           DFHEIV99,
 15786           PI-PREV-CONTROL-PRIMARY,
 15787           DFHEIV99,
 15788           DFHEIV99,
 15789           DFHEIV99
 15790     SET ADDRESS OF PENDING-BUSINESS TO
 15791         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 290
* EL6311.cbl
 15792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15793
 15794
 15795     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15796        MOVE -1                 TO CMAINTL
 15797        MOVE ER-2197            TO EMI-ERROR
 15798        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15799        GO TO 8200-SEND-DATAONLY.
 15800
 15801     IF PB-BILLED-DT NOT = LOW-VALUES
 15802        MOVE -1                 TO CMAINTL
 15803        MOVE ER-2129            TO EMI-ERROR
 15804        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15805        GO TO 8200-SEND-DATAONLY.
 15806
 15807     IF PB-CHG-COUNT NOT = ZEROS
 15808        MOVE ER-2336            TO EMI-ERROR
 15809        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15810        MOVE AL-UABON            TO CMAINTA
 15811        MOVE -1                  TO CMAINTL
 15812        GO TO 8200-SEND-DATAONLY.
 15813
 15814     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 15815        PB-CHG-COUNT NOT = ZEROS
 15816        MOVE ER-2196             TO EMI-ERROR
 15817        MOVE AL-UABON            TO CMAINTA
 15818        MOVE -1                  TO CMAINTL
 15819        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15820        GO TO 8200-SEND-DATAONLY.
 15821
 15822     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 15823        MOVE ER-2900 TO EMI-ERROR
 15824        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15825        MOVE AL-UABON         TO CMAINTA
 15826        MOVE -1               TO CMAINTL
 15827        GO TO 8200-SEND-DATAONLY.
 15828
 15829
 15830* EXEC CICS HANDLE CONDITION
 15831*         NOTFND  (2475-CONTINUE-DELETE)
 15832*    END-EXEC
 15833*    MOVE '"$I                   ! : #00013911' TO DFHEIV0
 15834     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15835     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15836     MOVE X'3A20233030303133393131' TO DFHEIV0(25:11)
 15837     CALL 'kxdfhei1' USING DFHEIV0
 15838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15839
 15840     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15841     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15842     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15843     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15844
 15845
 15846* EXEC CICS READ
 15847*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15848*        DATASET (FILE-ID-ELCERT)
 15849*        RIDFLD  (ELCERT-KEY)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 291
* EL6311.cbl
 15850*        UPDATE
 15851*    END-EXEC.
 15852*    MOVE '&"S        EU         (   #00013920' TO DFHEIV0
 15853     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15854     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15855     MOVE X'2020233030303133393230' TO DFHEIV0(25:11)
 15856     CALL 'kxdfhei1' USING DFHEIV0,
 15857           FILE-ID-ELCERT,
 15858           DFHEIV20,
 15859           DFHEIV99,
 15860           ELCERT-KEY,
 15861           DFHEIV99,
 15862           DFHEIV99,
 15863           DFHEIV99
 15864     SET ADDRESS OF CERTIFICATE-MASTER TO
 15865         DFHEIV20
 15866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15867
 15868
 15869     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15870
 15871     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 15872     MOVE 'B'                    TO JP-RECORD-TYPE.
 15873     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 15874     PERFORM 8400-LOG-JOURNAL-RECORD.
 15875
 15876     IF PB-CI-LIVES NOT NUMERIC
 15877         MOVE ZERO                    TO PB-CI-LIVES.
 15878
 15879     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 15880        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 15881           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15882           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 15883           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 15884                                            CM-LF-CANCEL-DT
 15885           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 15886        ELSE
 15887           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15888           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 15889           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 15890           MOVE PB-CI-LIVES              TO CM-LIVES.
 15891
 15892     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 15893        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 15894           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 15895               MOVE CM-LF-STATUS-AT-CANCEL
 15896                                        TO CM-LF-CURRENT-STATUS
 15897               MOVE SPACE
 15898                                        TO CM-LF-STATUS-AT-CANCEL
 15899           ELSE
 15900               MOVE PB-CI-LF-POLICY-STATUS
 15901                                        TO CM-LF-CURRENT-STATUS
 15902        ELSE
 15903           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 15904
 15905
 15906     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 15907        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 292
* EL6311.cbl
 15908           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15909           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 15910           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 15911                                            CM-AH-CANCEL-DT
 15912           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 15913        ELSE
 15914           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15915           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 15916           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 15917           MOVE PB-CI-LIVES              TO CM-LIVES.
 15918
 15919     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 15920        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 15921           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 15922               MOVE CM-AH-STATUS-AT-CANCEL
 15923                                        TO CM-AH-CURRENT-STATUS
 15924               MOVE SPACE
 15925                                        TO CM-AH-STATUS-AT-CANCEL
 15926           ELSE
 15927               MOVE PB-CI-AH-POLICY-STATUS
 15928                                        TO CM-AH-CURRENT-STATUS
 15929        ELSE
 15930           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 15931
 15932 2450-REWRITE-CERT.
 15933     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 15934     MOVE 'C'                      TO JP-RECORD-TYPE.
 15935     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 15936
 15937
 15938* EXEC CICS REWRITE
 15939*        DATASET  (FILE-ID-ELCERT)
 15940*        FROM     (CERTIFICATE-MASTER)
 15941*    END-EXEC.
 15942     MOVE LENGTH OF
 15943      CERTIFICATE-MASTER
 15944       TO DFHEIV11
 15945*    MOVE '&& L                  %   #00013995' TO DFHEIV0
 15946     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15947     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15948     MOVE X'2020233030303133393935' TO DFHEIV0(25:11)
 15949     CALL 'kxdfhei1' USING DFHEIV0,
 15950           FILE-ID-ELCERT,
 15951           CERTIFICATE-MASTER,
 15952           DFHEIV11,
 15953           DFHEIV99
 15954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15955
 15956
 15957     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 15958
 15959     PERFORM 8400-LOG-JOURNAL-RECORD.
 15960
 15961 2475-CONTINUE-DELETE.
 15962     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 15963     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 15964
 15965     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 293
* EL6311.cbl
 15966     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 15967
 15968     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 15969
 15970     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 15971     MOVE 'D'                    TO JP-RECORD-TYPE
 15972     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15973
 15974
 15975* EXEC CICS DELETE
 15976*        DATASET    (FILE-ID-ERPNDB)
 15977*    END-EXEC.
 15978*    MOVE '&(                    &   #00014017' TO DFHEIV0
 15979     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 15980     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15981     MOVE X'2020233030303134303137' TO DFHEIV0(25:11)
 15982     CALL 'kxdfhei1' USING DFHEIV0,
 15983           FILE-ID-ERPNDB,
 15984           DFHEIV99,
 15985           DFHEIV99,
 15986           DFHEIV99,
 15987           DFHEIV99
 15988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15989
 15990
 15991     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15992
 15993     PERFORM 8400-LOG-JOURNAL-RECORD.
 15994
 15995     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15996     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15997
 15998
 15999* EXEC CICS HANDLE CONDITION
 16000*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16001*    END-EXEC.
 16002*    MOVE '"$I                   ! ; #00014028' TO DFHEIV0
 16003     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16004     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16005     MOVE X'3B20233030303134303238' TO DFHEIV0(25:11)
 16006     CALL 'kxdfhei1' USING DFHEIV0
 16007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16008
 16009
 16010
 16011* EXEC CICS READ
 16012*        SET     (ADDRESS OF PENDING-BUSINESS)
 16013*        DATASET (FILE-ID-ERPNDB)
 16014*        RIDFLD  (ERPNDB-KEY)
 16015*        UPDATE
 16016*    END-EXEC.
 16017*    MOVE '&"S        EU         (   #00014032' TO DFHEIV0
 16018     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16019     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16020     MOVE X'2020233030303134303332' TO DFHEIV0(25:11)
 16021     CALL 'kxdfhei1' USING DFHEIV0,
 16022           FILE-ID-ERPNDB,
 16023           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 294
* EL6311.cbl
 16024           DFHEIV99,
 16025           ERPNDB-KEY,
 16026           DFHEIV99,
 16027           DFHEIV99,
 16028           DFHEIV99
 16029     SET ADDRESS OF PENDING-BUSINESS TO
 16030         DFHEIV20
 16031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16032
 16033
 16034     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16035     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16036
 16037     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16038        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16039        MOVE 'D'                 TO JP-RECORD-TYPE
 16040        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16041
 16042* EXEC CICS DELETE
 16043*            DATASET    (FILE-ID-ERPNDB)
 16044*       END-EXEC
 16045*    MOVE '&(                    &   #00014046' TO DFHEIV0
 16046     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16047     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16048     MOVE X'2020233030303134303436' TO DFHEIV0(25:11)
 16049     CALL 'kxdfhei1' USING DFHEIV0,
 16050           FILE-ID-ERPNDB,
 16051           DFHEIV99,
 16052           DFHEIV99,
 16053           DFHEIV99,
 16054           DFHEIV99
 16055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16056        PERFORM 8400-LOG-JOURNAL-RECORD
 16057     ELSE
 16058        MOVE 'B'                 TO JP-RECORD-TYPE
 16059        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16060        PERFORM 8400-LOG-JOURNAL-RECORD
 16061        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16062        MOVE 'C'                 TO JP-RECORD-TYPE
 16063        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16064
 16065* EXEC CICS REWRITE
 16066*            DATASET    (FILE-ID-ERPNDB)
 16067*            FROM       (PENDING-BUSINESS)
 16068*       END-EXEC
 16069     MOVE LENGTH OF
 16070      PENDING-BUSINESS
 16071       TO DFHEIV11
 16072*    MOVE '&& L                  %   #00014057' TO DFHEIV0
 16073     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16074     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16075     MOVE X'2020233030303134303537' TO DFHEIV0(25:11)
 16076     CALL 'kxdfhei1' USING DFHEIV0,
 16077           FILE-ID-ERPNDB,
 16078           PENDING-BUSINESS,
 16079           DFHEIV11,
 16080           DFHEIV99
 16081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 295
* EL6311.cbl
 16082        PERFORM 8400-LOG-JOURNAL-RECORD.
 16083
 16084******************************************************************
 16085*                                                                *
 16086*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16087*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16088*                                                                *
 16089******************************************************************
 16090
 16091     IF NOT PI-AR-PROCESSING
 16092        GO TO 2480-DELETE-FINISHED.
 16093
 16094     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16095        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16096        NEXT SENTENCE
 16097     ELSE
 16098        GO TO 2480-DELETE-FINISHED.
 16099
 16100
 16101* EXEC CICS HANDLE CONDITION
 16102*         NOTFND    (2480-DELETE-FINISHED)
 16103*    END-EXEC.
 16104*    MOVE '"$I                   ! < #00014079' TO DFHEIV0
 16105     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16106     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16107     MOVE X'3C20233030303134303739' TO DFHEIV0(25:11)
 16108     CALL 'kxdfhei1' USING DFHEIV0
 16109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16110
 16111
 16112     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16113     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16114
 16115
 16116* EXEC CICS READ
 16117*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16118*        DATASET (FILE-ID-ERRQST)
 16119*        RIDFLD  (ERRQST-KEY)
 16120*        UPDATE
 16121*    END-EXEC.
 16122*    MOVE '&"S        EU         (   #00014086' TO DFHEIV0
 16123     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16124     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16125     MOVE X'2020233030303134303836' TO DFHEIV0(25:11)
 16126     CALL 'kxdfhei1' USING DFHEIV0,
 16127           FILE-ID-ERRQST,
 16128           DFHEIV20,
 16129           DFHEIV99,
 16130           ERRQST-KEY,
 16131           DFHEIV99,
 16132           DFHEIV99,
 16133           DFHEIV99
 16134     SET ADDRESS OF AR-REQUEST-RECORD TO
 16135         DFHEIV20
 16136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16137
 16138
 16139     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 296
* EL6311.cbl
 16140
 16141     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16142
 16143     MOVE 'D'                      TO JP-RECORD-TYPE.
 16144     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16145
 16146
 16147* EXEC CICS DELETE
 16148*         DATASET    (FILE-ID-ERRQST)
 16149*    END-EXEC.
 16150*    MOVE '&(                    &   #00014100' TO DFHEIV0
 16151     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16152     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16153     MOVE X'2020233030303134313030' TO DFHEIV0(25:11)
 16154     CALL 'kxdfhei1' USING DFHEIV0,
 16155           FILE-ID-ERRQST,
 16156           DFHEIV99,
 16157           DFHEIV99,
 16158           DFHEIV99,
 16159           DFHEIV99
 16160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16161
 16162
 16163     PERFORM 8400-LOG-JOURNAL-RECORD.
 16164
 16165 2480-DELETE-FINISHED.
 16166     MOVE ZEROS                  TO EMI-ERROR.
 16167     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16168     MOVE LOW-VALUES             TO EL631CI.
 16169     MOVE -1                     TO CMAINTL.
 16170     GO TO 8100-SEND-INITIAL-MAP.
 16171
 16172 2485-BATCH-HDR-NOT-FOUND.
 16173     MOVE -1                     TO CMAINTL
 16174     MOVE AL-UABON               TO CMAINTA.
 16175     MOVE ER-7450                TO EMI-ERROR.
 16176     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16177     GO TO 8200-SEND-DATAONLY.
 16178
 16179 2490-RECORD-NOT-FOUND.
 16180     MOVE -1                     TO CMAINTL
 16181     MOVE AL-UABON               TO CMAINTA.
 16182     MOVE ER-7451                TO EMI-ERROR.
 16183     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16184     GO TO 8200-SEND-DATAONLY.
 16185
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 297
* EL6311.cbl
 16187
 16188***************************************************************
 16189*                                                             *
 16190*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16191*                                                             *
 16192***************************************************************
 16193
 16194***************************************************************
 16195*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16196*     AN ALREADY BILLED RECORD.                               *
 16197***************************************************************
 16198
 16199 2700-BUILD-CORRECTION-RECORD.
 16200     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16201     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16202     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16203     MOVE '5'                    TO DC-OPTION-CODE.
 16204     PERFORM 9700-DATE-LINK.
 16205     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16206
 16207     IF PB-CHG-COUNT = ZEROS
 16208        MOVE +1                  TO WS-SEQ-SAVE
 16209     ELSE
 16210        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16211
 16212     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 16213     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 16214
 16215     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 16216
 16217     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16218     MOVE 'A'                    TO JP-RECORD-TYPE.
 16219     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16220
 16221
 16222* EXEC CICS WRITE
 16223*        DATASET    (FILE-ID-ERPNDB)
 16224*        FROM       (PENDING-BUSINESS)
 16225*        RIDFLD     (PB-CONTROL-PRIMARY)
 16226*    END-EXEC.
 16227     MOVE LENGTH OF
 16228      PENDING-BUSINESS
 16229       TO DFHEIV11
 16230*    MOVE '&$ L                  ''   #00014162' TO DFHEIV0
 16231     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16232     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16233     MOVE X'2020233030303134313632' TO DFHEIV0(25:11)
 16234     CALL 'kxdfhei1' USING DFHEIV0,
 16235           FILE-ID-ERPNDB,
 16236           PENDING-BUSINESS,
 16237           DFHEIV11,
 16238           PB-CONTROL-PRIMARY,
 16239           DFHEIV99,
 16240           DFHEIV99
 16241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16242
 16243
 16244     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 298
* EL6311.cbl
 16245
 16246     PERFORM 8400-LOG-JOURNAL-RECORD.
 16247
 16248 2799-EXIT.
 16249      EXIT.
 16250
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 299
* EL6311.cbl
 16252
 16253******************************************************************
 16254*                                                                *
 16255*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 16256*                                                                *
 16257******************************************************************
 16258
 16259 2800-REWRITE-ISSUE-CERT-KEY.
 16260     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16261
 16262     IF  BCERTNOL GREATER THAN ZEROS
 16263         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 16264
 16265     IF  BSUFIXL  GREATER THAN ZEROS
 16266         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 16267
 16268     IF  BEFFDTL  GREATER THAN ZEROS
 16269         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16270
 16271 2810-READ-BY-ACCOUNT.
 16272
 16273* EXEC CICS HANDLE CONDITION
 16274*         NOTFND    (2820-PROCESS-REWRITE)
 16275*    END-EXEC.
 16276*    MOVE '"$I                   ! = #00014196' TO DFHEIV0
 16277     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16278     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16279     MOVE X'3D20233030303134313936' TO DFHEIV0(25:11)
 16280     CALL 'kxdfhei1' USING DFHEIV0
 16281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16282
 16283
 16284
 16285* EXEC CICS READ
 16286*        SET     (ADDRESS OF PENDING-BUSINESS)
 16287*        DATASET (FILE-ID-ERPNDB2)
 16288*        RIDFLD  (ERPNDB-ALT-KEY)
 16289*    END-EXEC.
 16290*    MOVE '&"S        E          (   #00014200' TO DFHEIV0
 16291     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16292     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16293     MOVE X'2020233030303134323030' TO DFHEIV0(25:11)
 16294     CALL 'kxdfhei1' USING DFHEIV0,
 16295           FILE-ID-ERPNDB2,
 16296           DFHEIV20,
 16297           DFHEIV99,
 16298           ERPNDB-ALT-KEY,
 16299           DFHEIV99,
 16300           DFHEIV99,
 16301           DFHEIV99
 16302     SET ADDRESS OF PENDING-BUSINESS TO
 16303         DFHEIV20
 16304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16305
 16306
 16307     GO TO 2890-DUPLICATE-RECORD.
 16308
 16309  2820-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 300
* EL6311.cbl
 16310
 16311* EXEC CICS HANDLE CONDITION
 16312*         NOTFND    (2885-RECORD-MISSING)
 16313*    END-EXEC.
 16314*    MOVE '"$I                   ! > #00014209' TO DFHEIV0
 16315     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16316     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16317     MOVE X'3E20233030303134323039' TO DFHEIV0(25:11)
 16318     CALL 'kxdfhei1' USING DFHEIV0
 16319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16320
 16321
 16322     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16323
 16324
 16325* EXEC CICS READ
 16326*        SET     (ADDRESS OF PENDING-BUSINESS)
 16327*        DATASET (FILE-ID-ERPNDB)
 16328*        RIDFLD  (ERPNDB-KEY)
 16329*        UPDATE
 16330*    END-EXEC.
 16331*    MOVE '&"S        EU         (   #00014215' TO DFHEIV0
 16332     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16333     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16334     MOVE X'2020233030303134323135' TO DFHEIV0(25:11)
 16335     CALL 'kxdfhei1' USING DFHEIV0,
 16336           FILE-ID-ERPNDB,
 16337           DFHEIV20,
 16338           DFHEIV99,
 16339           ERPNDB-KEY,
 16340           DFHEIV99,
 16341           DFHEIV99,
 16342           DFHEIV99
 16343     SET ADDRESS OF PENDING-BUSINESS TO
 16344         DFHEIV20
 16345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16346
 16347
 16348     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16349     MOVE 'D'                    TO JP-RECORD-TYPE.
 16350     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16351     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16352
 16353     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16354
 16355     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16356     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16357     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16358
 16359
 16360* EXEC CICS DELETE
 16361*        DATASET    (FILE-ID-ERPNDB)
 16362*    END-EXEC.
 16363*    MOVE '&(                    &   #00014233' TO DFHEIV0
 16364     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16365     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16366     MOVE X'2020233030303134323333' TO DFHEIV0(25:11)
 16367     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 301
* EL6311.cbl
 16368           FILE-ID-ERPNDB,
 16369           DFHEIV99,
 16370           DFHEIV99,
 16371           DFHEIV99,
 16372           DFHEIV99
 16373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16374
 16375
 16376     PERFORM 8400-LOG-JOURNAL-RECORD.
 16377
 16378
 16379* EXEC CICS GETMAIN
 16380*        SET      (ADDRESS OF PENDING-BUSINESS)
 16381*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16382*        INITIMG  (GETMAIN-SPACE)
 16383*    END-EXEC.
 16384*    MOVE ',"IL                  $   #00014239' TO DFHEIV0
 16385     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16386     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16387     MOVE X'2020233030303134323339' TO DFHEIV0(25:11)
 16388     CALL 'kxdfhei1' USING DFHEIV0,
 16389           DFHEIV20,
 16390           ERPNDB-RECORD-LENGTH,
 16391           GETMAIN-SPACE
 16392     SET ADDRESS OF PENDING-BUSINESS TO
 16393         DFHEIV20
 16394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16395
 16396
 16397     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16398
 16399
 16400* EXEC CICS HANDLE CONDITION
 16401*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 16402*    END-EXEC.
 16403*    MOVE '"$I                   ! ? #00014247' TO DFHEIV0
 16404     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16405     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16406     MOVE X'3F20233030303134323437' TO DFHEIV0(25:11)
 16407     CALL 'kxdfhei1' USING DFHEIV0
 16408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16409
 16410
 16411
 16412* EXEC CICS READ
 16413*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16414*        DATASET (FILE-ID-ELCERT)
 16415*        RIDFLD  (ELCERT-KEY)
 16416*        UPDATE
 16417*    END-EXEC.
 16418*    MOVE '&"S        EU         (   #00014251' TO DFHEIV0
 16419     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16420     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16421     MOVE X'2020233030303134323531' TO DFHEIV0(25:11)
 16422     CALL 'kxdfhei1' USING DFHEIV0,
 16423           FILE-ID-ELCERT,
 16424           DFHEIV20,
 16425           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 302
* EL6311.cbl
 16426           ELCERT-KEY,
 16427           DFHEIV99,
 16428           DFHEIV99,
 16429           DFHEIV99
 16430     SET ADDRESS OF CERTIFICATE-MASTER TO
 16431         DFHEIV20
 16432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16433
 16434
 16435     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 16436     MOVE 'B'                    TO JP-RECORD-TYPE
 16437     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16438     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16439
 16440     IF INSURED-ADDR-PRESENT
 16441        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 16442
 16443     IF CERT-NOTES-ARE-NOT-PRESENT
 16444        MOVE SPACE               TO WS-CERT-NOTE-SW
 16445     ELSE
 16446        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 16447
 16448     IF CERT-ADDED-BATCH      OR
 16449        CERT-AND-CLAIM-ONLINE OR
 16450        CERT-WAS-CREATED-FOR-CLAIM
 16451        NEXT SENTENCE
 16452     ELSE
 16453        GO TO 2825-DELETE-CERTIFICATE.
 16454
 16455     PERFORM 8400-LOG-JOURNAL-RECORD.
 16456
 16457*********************************************************
 16458** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 16459     IF CERT-ADDED-BATCH
 16460         GO TO 2822-REWRITE-ELCERT.
 16461*********************************************************
 16462
 16463     IF NO-CLAIM-ATTACHED
 16464        NEXT SENTENCE
 16465     ELSE
 16466        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 16467        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 16468
 16469 2822-REWRITE-ELCERT.
 16470     MOVE 'C'                    TO JP-RECORD-TYPE
 16471     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16472
 16473     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16474
 16475
 16476* EXEC CICS REWRITE
 16477*         DATASET    (FILE-ID-ELCERT)
 16478*         FROM       (CERTIFICATE-MASTER)
 16479*    END-EXEC.
 16480     MOVE LENGTH OF
 16481      CERTIFICATE-MASTER
 16482       TO DFHEIV11
 16483*    MOVE '&& L                  %   #00014298' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 303
* EL6311.cbl
 16484     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16485     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16486     MOVE X'2020233030303134323938' TO DFHEIV0(25:11)
 16487     CALL 'kxdfhei1' USING DFHEIV0,
 16488           FILE-ID-ELCERT,
 16489           CERTIFICATE-MASTER,
 16490           DFHEIV11,
 16491           DFHEIV99
 16492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16493
 16494
 16495     PERFORM 8400-LOG-JOURNAL-RECORD.
 16496
 16497     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 16498
 16499 2825-DELETE-CERTIFICATE.
 16500     MOVE 'D'                      TO JP-RECORD-TYPE.
 16501     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16502
 16503     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16504
 16505
 16506* EXEC CICS DELETE
 16507*         DATASET    (FILE-ID-ELCERT)
 16508*    END-EXEC.
 16509*    MOVE '&(                    &   #00014313' TO DFHEIV0
 16510     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16511     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16512     MOVE X'2020233030303134333133' TO DFHEIV0(25:11)
 16513     CALL 'kxdfhei1' USING DFHEIV0,
 16514           FILE-ID-ELCERT,
 16515           DFHEIV99,
 16516           DFHEIV99,
 16517           DFHEIV99,
 16518           DFHEIV99
 16519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16520
 16521
 16522     PERFORM 8400-LOG-JOURNAL-RECORD.
 16523
 16524******************************************************************
 16525*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 16526******************************************************************
 16527
 16528     IF CERT-NOTES-ARE-PRESENT
 16529        NEXT SENTENCE
 16530     ELSE
 16531        GO TO 2827-DELETE-MAILING.
 16532
 16533
 16534* EXEC CICS HANDLE CONDITION
 16535*         NOTFND  (2827-DELETE-MAILING)
 16536*    END-EXEC.
 16537*    MOVE '"$I                   ! @ #00014328' TO DFHEIV0
 16538     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16539     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16540     MOVE X'4020233030303134333238' TO DFHEIV0(25:11)
 16541     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 304
* EL6311.cbl
 16542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16543
 16544
 16545
 16546* EXEC CICS READ
 16547*        EQUAL
 16548*        DATASET   (FILE-ID-ERNOTE)
 16549*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 16550*        RIDFLD    (ELCERT-KEY)
 16551*        UPDATE
 16552*    END-EXEC.
 16553*    MOVE '&"S        EU         (   #00014332' TO DFHEIV0
 16554     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16555     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16556     MOVE X'2020233030303134333332' TO DFHEIV0(25:11)
 16557     CALL 'kxdfhei1' USING DFHEIV0,
 16558           FILE-ID-ERNOTE,
 16559           DFHEIV20,
 16560           DFHEIV99,
 16561           ELCERT-KEY,
 16562           DFHEIV99,
 16563           DFHEIV99,
 16564           DFHEIV99
 16565     SET ADDRESS OF CERTIFICATE-NOTE TO
 16566         DFHEIV20
 16567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16568
 16569
 16570     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 16571     MOVE 'D'                    TO  JP-RECORD-TYPE.
 16572     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 16573
 16574     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16575
 16576
 16577* EXEC CICS DELETE
 16578*        DATASET   (FILE-ID-ERNOTE)
 16579*    END-EXEC.
 16580*    MOVE '&(                    &   #00014346' TO DFHEIV0
 16581     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16582     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16583     MOVE X'2020233030303134333436' TO DFHEIV0(25:11)
 16584     CALL 'kxdfhei1' USING DFHEIV0,
 16585           FILE-ID-ERNOTE,
 16586           DFHEIV99,
 16587           DFHEIV99,
 16588           DFHEIV99,
 16589           DFHEIV99
 16590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16591
 16592
 16593     PERFORM 8400-LOG-JOURNAL-RECORD.
 16594
 16595******************************************************************
 16596*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 16597******************************************************************
 16598
 16599 2827-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 305
* EL6311.cbl
 16600     IF CERT-ADDRESS-PRESENT
 16601        NEXT SENTENCE
 16602     ELSE
 16603        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 16604
 16605
 16606* EXEC CICS HANDLE CONDITION
 16607*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 16608*    END-EXEC.
 16609*    MOVE '"$I                   ! A #00014362' TO DFHEIV0
 16610     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16611     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16612     MOVE X'4120233030303134333632' TO DFHEIV0(25:11)
 16613     CALL 'kxdfhei1' USING DFHEIV0
 16614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16615
 16616
 16617     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 16618
 16619
 16620* EXEC CICS READ
 16621*        EQUAL
 16622*        DATASET   (FILE-ID-ERMAIL)
 16623*        SET       (ADDRESS OF MAILING-DATA)
 16624*        RIDFLD    (ERMAIL-KEY)
 16625*        UPDATE
 16626*    END-EXEC.
 16627*    MOVE '&"S        EU         (   #00014368' TO DFHEIV0
 16628     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16629     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16630     MOVE X'2020233030303134333638' TO DFHEIV0(25:11)
 16631     CALL 'kxdfhei1' USING DFHEIV0,
 16632           FILE-ID-ERMAIL,
 16633           DFHEIV20,
 16634           DFHEIV99,
 16635           ERMAIL-KEY,
 16636           DFHEIV99,
 16637           DFHEIV99,
 16638           DFHEIV99
 16639     SET ADDRESS OF MAILING-DATA TO
 16640         DFHEIV20
 16641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16642
 16643
 16644     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 16645     MOVE 'D'                    TO  JP-RECORD-TYPE.
 16646     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 16647
 16648     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 16649
 16650
 16651* EXEC CICS DELETE
 16652*        DATASET   (FILE-ID-ERMAIL)
 16653*    END-EXEC.
 16654*    MOVE '&(                    &   #00014382' TO DFHEIV0
 16655     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16656     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16657     MOVE X'2020233030303134333832' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 306
* EL6311.cbl
 16658     CALL 'kxdfhei1' USING DFHEIV0,
 16659           FILE-ID-ERMAIL,
 16660           DFHEIV99,
 16661           DFHEIV99,
 16662           DFHEIV99,
 16663           DFHEIV99
 16664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16665
 16666
 16667     PERFORM 8400-LOG-JOURNAL-RECORD.
 16668
 16669 2830-BUILD-NEW-ISSUE-RECORD.
 16670     MOVE SPACES                 TO ELCERT-KEY.
 16671
 16672     IF  BCERTNOL GREATER THAN ZEROS
 16673         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 16674
 16675     IF  BSUFIXL  GREATER THAN ZEROS
 16676         MOVE BSUFIXI            TO  PB-CERT-SFX.
 16677
 16678     IF BEFFDTL GREATER THAN ZEROS
 16679        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 16680
 16681 2870-WRITE-PENDING-BUSINESS.
 16682     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16683     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16684     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16685     MOVE '5'                    TO DC-OPTION-CODE.
 16686     PERFORM 9700-DATE-LINK.
 16687     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16688
 16689     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 16690
 16691     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16692     MOVE 'A'                    TO JP-RECORD-TYPE.
 16693     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16694
 16695
 16696* EXEC CICS WRITE
 16697*        DATASET  (FILE-ID-ERPNDB)
 16698*        FROM     (PENDING-BUSINESS)
 16699*        RIDFLD   (PB-CONTROL-PRIMARY)
 16700*    END-EXEC.
 16701     MOVE LENGTH OF
 16702      PENDING-BUSINESS
 16703       TO DFHEIV11
 16704*    MOVE '&$ L                  ''   #00014414' TO DFHEIV0
 16705     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16706     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16707     MOVE X'2020233030303134343134' TO DFHEIV0(25:11)
 16708     CALL 'kxdfhei1' USING DFHEIV0,
 16709           FILE-ID-ERPNDB,
 16710           PENDING-BUSINESS,
 16711           DFHEIV11,
 16712           PB-CONTROL-PRIMARY,
 16713           DFHEIV99,
 16714           DFHEIV99
 16715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 307
* EL6311.cbl
 16716
 16717
 16718     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 16719
 16720     PERFORM 8400-LOG-JOURNAL-RECORD.
 16721
 16722     GO TO 1325-PROCESS-ISSUE-CHANGES.
 16723
 16724 2885-RECORD-MISSING.
 16725     MOVE -1                     TO BMAINTL
 16726     MOVE AL-UABON               TO BMAINTA
 16727     MOVE ER-2902                TO EMI-ERROR.
 16728     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16729     GO TO 8200-SEND-DATAONLY.
 16730
 16731 2890-DUPLICATE-RECORD.
 16732     MOVE -1                     TO BMAINTL.
 16733     MOVE AL-UABON               TO BCERTNOA.
 16734     MOVE AL-UNBON               TO BEFFDTA.
 16735     MOVE SPACE                  TO BMAINTI.
 16736
 16737     MOVE 1                      TO EMI-SUB
 16738                                    EMI-SWITCH1
 16739                                    EMI-SWITCH-AREA-1
 16740                                    EMI-SWITCH-AREA-2.
 16741
 16742     MOVE SPACES                 TO EMI-ERROR-LINES.
 16743
 16744
 16745* EXEC CICS SYNCPOINT ROLLBACK
 16746*    END-EXEC.
 16747*    MOVE '6"R                   !   #00014446' TO DFHEIV0
 16748     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16749     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16750     MOVE X'2020233030303134343436' TO DFHEIV0(25:11)
 16751     CALL 'kxdfhei1' USING DFHEIV0
 16752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16753
 16754
 16755     MOVE ER-2247                TO EMI-ERROR.
 16756     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 16757     GO TO 8200-SEND-DATAONLY.
 16758
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 308
* EL6311.cbl
 16760
 16761******************************************************************
 16762*                                                                *
 16763*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 16764*                                                                *
 16765******************************************************************
 16766
 16767 2900-REWRITE-CAN-CERT-KEY.
 16768     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16769
 16770     IF  CCERTNOL GREATER THAN ZEROS
 16771         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 16772
 16773     IF  CSUFIXL  GREATER THAN ZEROS
 16774         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 16775
 16776     IF  CEFFDTL  GREATER THAN ZEROS
 16777         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16778
 16779 2910-READ-BY-ACCOUNT.
 16780
 16781* EXEC CICS HANDLE CONDITION
 16782*         NOTFND    (2920-PROCESS-REWRITE)
 16783*    END-EXEC.
 16784*    MOVE '"$I                   ! B #00014474' TO DFHEIV0
 16785     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16786     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16787     MOVE X'4220233030303134343734' TO DFHEIV0(25:11)
 16788     CALL 'kxdfhei1' USING DFHEIV0
 16789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16790
 16791
 16792
 16793* EXEC CICS READ
 16794*        SET     (ADDRESS OF PENDING-BUSINESS)
 16795*        DATASET (FILE-ID-ERPNDB2)
 16796*        RIDFLD  (ERPNDB-ALT-KEY)
 16797*    END-EXEC.
 16798*    MOVE '&"S        E          (   #00014478' TO DFHEIV0
 16799     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16800     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16801     MOVE X'2020233030303134343738' TO DFHEIV0(25:11)
 16802     CALL 'kxdfhei1' USING DFHEIV0,
 16803           FILE-ID-ERPNDB2,
 16804           DFHEIV20,
 16805           DFHEIV99,
 16806           ERPNDB-ALT-KEY,
 16807           DFHEIV99,
 16808           DFHEIV99,
 16809           DFHEIV99
 16810     SET ADDRESS OF PENDING-BUSINESS TO
 16811         DFHEIV20
 16812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16813
 16814
 16815     GO TO 2990-DUPLICATE-RECORD.
 16816
 16817  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 309
* EL6311.cbl
 16818
 16819* EXEC CICS HANDLE CONDITION
 16820*         NOTFND    (2985-RECORD-MISSING)
 16821*    END-EXEC.
 16822*    MOVE '"$I                   ! C #00014487' TO DFHEIV0
 16823     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16824     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16825     MOVE X'4320233030303134343837' TO DFHEIV0(25:11)
 16826     CALL 'kxdfhei1' USING DFHEIV0
 16827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16828
 16829
 16830     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16831
 16832
 16833* EXEC CICS READ
 16834*        SET     (ADDRESS OF PENDING-BUSINESS)
 16835*        DATASET (FILE-ID-ERPNDB)
 16836*        RIDFLD  (ERPNDB-KEY)
 16837*        UPDATE
 16838*    END-EXEC.
 16839*    MOVE '&"S        EU         (   #00014493' TO DFHEIV0
 16840     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16841     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16842     MOVE X'2020233030303134343933' TO DFHEIV0(25:11)
 16843     CALL 'kxdfhei1' USING DFHEIV0,
 16844           FILE-ID-ERPNDB,
 16845           DFHEIV20,
 16846           DFHEIV99,
 16847           ERPNDB-KEY,
 16848           DFHEIV99,
 16849           DFHEIV99,
 16850           DFHEIV99
 16851     SET ADDRESS OF PENDING-BUSINESS TO
 16852         DFHEIV20
 16853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16854
 16855
 16856     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16857     MOVE 'D'                    TO JP-RECORD-TYPE.
 16858     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16859     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16860
 16861     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16862
 16863     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16864     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16865     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16866
 16867
 16868* EXEC CICS DELETE
 16869*        DATASET    (FILE-ID-ERPNDB)
 16870*    END-EXEC.
 16871*    MOVE '&(                    &   #00014511' TO DFHEIV0
 16872     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16873     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16874     MOVE X'2020233030303134353131' TO DFHEIV0(25:11)
 16875     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 310
* EL6311.cbl
 16876           FILE-ID-ERPNDB,
 16877           DFHEIV99,
 16878           DFHEIV99,
 16879           DFHEIV99,
 16880           DFHEIV99
 16881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16882
 16883
 16884     PERFORM 8400-LOG-JOURNAL-RECORD.
 16885
 16886
 16887* EXEC CICS GETMAIN
 16888*        SET      (ADDRESS OF PENDING-BUSINESS)
 16889*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16890*        INITIMG  (GETMAIN-SPACE)
 16891*    END-EXEC.
 16892*    MOVE ',"IL                  $   #00014517' TO DFHEIV0
 16893     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16894     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16895     MOVE X'2020233030303134353137' TO DFHEIV0(25:11)
 16896     CALL 'kxdfhei1' USING DFHEIV0,
 16897           DFHEIV20,
 16898           ERPNDB-RECORD-LENGTH,
 16899           GETMAIN-SPACE
 16900     SET ADDRESS OF PENDING-BUSINESS TO
 16901         DFHEIV20
 16902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16903
 16904
 16905     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16906
 16907 2950-PROCESS-CANCELS.
 16908
 16909
 16910* EXEC CICS HANDLE CONDITION
 16911*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 16912*    END-EXEC.
 16913*    MOVE '"$I                   ! D #00014527' TO DFHEIV0
 16914     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16915     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16916     MOVE X'4420233030303134353237' TO DFHEIV0(25:11)
 16917     CALL 'kxdfhei1' USING DFHEIV0
 16918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16919
 16920
 16921
 16922* EXEC CICS READ
 16923*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16924*        DATASET (FILE-ID-ELCERT)
 16925*        RIDFLD  (ELCERT-KEY)
 16926*        UPDATE
 16927*    END-EXEC.
 16928*    MOVE '&"S        EU         (   #00014531' TO DFHEIV0
 16929     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16930     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16931     MOVE X'2020233030303134353331' TO DFHEIV0(25:11)
 16932     CALL 'kxdfhei1' USING DFHEIV0,
 16933           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 311
* EL6311.cbl
 16934           DFHEIV20,
 16935           DFHEIV99,
 16936           ELCERT-KEY,
 16937           DFHEIV99,
 16938           DFHEIV99,
 16939           DFHEIV99
 16940     SET ADDRESS OF CERTIFICATE-MASTER TO
 16941         DFHEIV20
 16942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16943
 16944
 16945     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16946
 16947     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16948     MOVE 'B'                      TO JP-RECORD-TYPE.
 16949     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16950     PERFORM 8400-LOG-JOURNAL-RECORD.
 16951
 16952     IF PB-CI-LIVES NOT NUMERIC
 16953         MOVE ZERO                    TO PB-CI-LIVES.
 16954
 16955     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16956        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16957        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16958        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16959                                         CM-LF-CANCEL-DT
 16960     ELSE
 16961        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16962        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16963        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16964        MOVE PB-CI-LIVES              TO CM-LIVES.
 16965
 16966     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16967        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16968            MOVE CM-LF-STATUS-AT-CANCEL
 16969                                     TO CM-LF-CURRENT-STATUS
 16970            MOVE SPACE
 16971                                     TO CM-LF-STATUS-AT-CANCEL
 16972        ELSE
 16973            MOVE PB-CI-LF-POLICY-STATUS
 16974                                     TO CM-LF-CURRENT-STATUS
 16975     ELSE
 16976        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16977
 16978     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16979        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16980        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16981        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16982                                         CM-AH-CANCEL-DT
 16983     ELSE
 16984        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16985        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16986        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16987        MOVE PB-CI-LIVES              TO CM-LIVES.
 16988
 16989     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16990        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16991            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 312
* EL6311.cbl
 16992                                     TO CM-AH-CURRENT-STATUS
 16993            MOVE SPACE
 16994                                     TO CM-AH-STATUS-AT-CANCEL
 16995        ELSE
 16996            MOVE PB-CI-AH-POLICY-STATUS
 16997                                     TO CM-AH-CURRENT-STATUS
 16998     ELSE
 16999        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17000
 17001 2975-REWRITE-CERT.
 17002     MOVE 'C'                      TO JP-RECORD-TYPE.
 17003     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17004
 17005
 17006* EXEC CICS REWRITE
 17007*        DATASET    (FILE-ID-ELCERT)
 17008*        FROM       (CERTIFICATE-MASTER)
 17009*    END-EXEC.
 17010     MOVE LENGTH OF
 17011      CERTIFICATE-MASTER
 17012       TO DFHEIV11
 17013*    MOVE '&& L                  %   #00014598' TO DFHEIV0
 17014     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17015     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17016     MOVE X'2020233030303134353938' TO DFHEIV0(25:11)
 17017     CALL 'kxdfhei1' USING DFHEIV0,
 17018           FILE-ID-ELCERT,
 17019           CERTIFICATE-MASTER,
 17020           DFHEIV11,
 17021           DFHEIV99
 17022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17023
 17024
 17025     PERFORM 8400-LOG-JOURNAL-RECORD.
 17026
 17027 2960-BUILD-NEW-CANCEL-RECORD.
 17028     IF  CCERTNOL GREATER THAN ZEROS
 17029         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17030
 17031     IF  CSUFIXL  GREATER THAN ZEROS
 17032         MOVE CSUFIXI             TO PB-CERT-SFX.
 17033
 17034     IF  CEFFDTL  GREATER  THAN ZEROS
 17035         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17036
 17037 2970-WRITE-PENDING-BUSINESS.
 17038     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17039     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17040     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17041     MOVE '5'                    TO DC-OPTION-CODE.
 17042     PERFORM 9700-DATE-LINK.
 17043     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17044
 17045     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17046
 17047     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17048                                    PB-CI-INSURED-SEX
 17049                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 313
* EL6311.cbl
 17050                                    PB-CI-AH-BENEFIT-CD
 17051                                    PB-CI-RATE-CLASS
 17052                                    PB-CI-RATE-DEV-LF
 17053                                    PB-CI-RATE-DEV-AH
 17054                                    PB-CI-LF-ABBR
 17055                                    PB-CI-AH-ABBR
 17056                                    PB-CI-OB-FLAG
 17057                                    PB-CI-LF-POLICY-STATUS
 17058                                    PB-CI-AH-POLICY-STATUS
 17059                                    PB-CI-INDV-GRP-CD
 17060                                    PB-CI-BENEFICIARY-NAME
 17061                                    PB-CI-NOTE-SW
 17062                                    PB-CI-SOC-SEC-NO
 17063                                    PB-CI-MEMBER-NO
 17064                                    PB-CI-INT-CODE
 17065                                    PB-CI-COMP-EXCP-SW
 17066                                    PB-CI-ENTRY-STATUS
 17067                                    PB-CI-CREDIT-INTERFACE-SW-1
 17068                                    PB-CI-CREDIT-INTERFACE-SW-2
 17069                                    PB-CI-ENTRY-BATCH.
 17070
 17071     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17072                                    PB-CI-AH-SETTLEMENT-DT
 17073                                    PB-CI-DEATH-DT
 17074                                    PB-CI-LF-PRIOR-CANCEL-DT
 17075                                    PB-CI-AH-PRIOR-CANCEL-DT
 17076                                    PB-CI-LOAN-1ST-PMT-DT
 17077                                    PB-CI-ENTRY-DT
 17078                                    PB-CI-LF-EXPIRE-DT
 17079                                    PB-CI-AH-EXPIRE-DT.
 17080
 17081     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17082                                    PB-CI-LF-TERM
 17083                                    PB-CI-LF-BENEFIT-AMT
 17084                                    PB-CI-LF-ALT-BENEFIT-AMT
 17085                                    PB-CI-LF-PREMIUM-AMT
 17086                                    PB-CI-LF-ALT-PREMIUM-AMT
 17087                                    PB-CI-AH-TERM
 17088                                    PB-CI-AH-BENEFIT-AMT
 17089                                    PB-CI-AH-PREMIUM-AMT
 17090                                    PB-CI-RATE-DEV-PCT-LF
 17091                                    PB-CI-RATE-DEV-PCT-AH
 17092                                    PB-CI-LIFE-COMMISSION
 17093                                    PB-CI-AH-COMMISSION
 17094                                    PB-CI-PAY-FREQUENCY
 17095                                    PB-CI-LOAN-APR
 17096                                    PB-CI-LOAN-TERM
 17097                                    PB-CI-CURR-SEQ
 17098                                    PB-CI-AH-CANCEL-AMT
 17099                                    PB-CI-LF-CANCEL-AMT
 17100                                    PB-CI-EXTENTION-DAYS
 17101                                    PB-CI-TERM-IN-DAYS
 17102                                    PB-CI-LOAN-OFFICER
 17103                                    PB-CI-LIVES
 17104                                    PB-CI-LF-CRIT-PER
 17105                                    PB-CI-AH-CRIT-PER
 17106                                    PB-C-LF-REM-TERM
 17107                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 314
* EL6311.cbl
 17108
 17109     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17110     MOVE 'A'                    TO JP-RECORD-TYPE.
 17111     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17112
 17113
 17114* EXEC CICS HANDLE CONDITION
 17115*        DUPREC   (2990-DUPLICATE-RECORD)
 17116*    END-EXEC.
 17117*    MOVE '"$%                   ! E #00014691' TO DFHEIV0
 17118     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17119     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17120     MOVE X'4520233030303134363931' TO DFHEIV0(25:11)
 17121     CALL 'kxdfhei1' USING DFHEIV0
 17122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17123
 17124
 17125
 17126* EXEC CICS WRITE
 17127*        DATASET  (FILE-ID-ERPNDB)
 17128*        FROM     (PENDING-BUSINESS)
 17129*        RIDFLD   (PB-CONTROL-PRIMARY)
 17130*    END-EXEC.
 17131     MOVE LENGTH OF
 17132      PENDING-BUSINESS
 17133       TO DFHEIV11
 17134*    MOVE '&$ L                  ''   #00014695' TO DFHEIV0
 17135     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17136     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17137     MOVE X'2020233030303134363935' TO DFHEIV0(25:11)
 17138     CALL 'kxdfhei1' USING DFHEIV0,
 17139           FILE-ID-ERPNDB,
 17140           PENDING-BUSINESS,
 17141           DFHEIV11,
 17142           PB-CONTROL-PRIMARY,
 17143           DFHEIV99,
 17144           DFHEIV99
 17145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17146
 17147
 17148     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17149
 17150     PERFORM 8400-LOG-JOURNAL-RECORD.
 17151
 17152     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17153
 17154 2985-RECORD-MISSING.
 17155     MOVE -1                     TO CMAINTL
 17156     MOVE AL-UABON               TO CMAINTA.
 17157
 17158     MOVE ER-2902                TO EMI-ERROR.
 17159     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17160     GO TO 8200-SEND-DATAONLY.
 17161
 17162 2990-DUPLICATE-RECORD.
 17163     MOVE SPACE                  TO CMAINTI.
 17164     MOVE -1                     TO CMAINTL.
 17165     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 315
* EL6311.cbl
 17166     MOVE AL-UNBON               TO CEFFDTA.
 17167
 17168     MOVE 1                      TO EMI-SUB
 17169                                    EMI-SWITCH1
 17170                                    EMI-SWITCH-AREA-1
 17171                                    EMI-SWITCH-AREA-2.
 17172     MOVE SPACES                 TO EMI-ERROR-LINES.
 17173
 17174
 17175* EXEC CICS SYNCPOINT ROLLBACK
 17176*    END-EXEC.
 17177*    MOVE '6"R                   !   #00014727' TO DFHEIV0
 17178     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17179     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17180     MOVE X'2020233030303134373237' TO DFHEIV0(25:11)
 17181     CALL 'kxdfhei1' USING DFHEIV0
 17182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17183
 17184
 17185     MOVE ER-2247                TO EMI-ERROR.
 17186     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17187     GO TO 8200-SEND-DATAONLY.
 17188
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 316
* EL6311.cbl
 17190
 17191***************************************************************
 17192*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17193*     PREMIUM FOR A SINGLE BATCH.                             *
 17194*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17195***************************************************************
 17196
 17197 3000-BATCH-MAINLINE.
 17198     IF PI-PREV-KEY NOT = SPACES
 17199         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17200     ELSE
 17201         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17202
 17203     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17204
 17205 3010-READNEXT.
 17206
 17207* EXEC CICS READ
 17208*         DATASET    (FILE-ID-ERPNDB)
 17209*         SET        (ADDRESS OF PENDING-BUSINESS)
 17210*         RIDFLD     (ERPNDB-KEY)
 17211*         GTEQ
 17212*    END-EXEC.
 17213*    MOVE '&"S        G          (   #00014751' TO DFHEIV0
 17214     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17215     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17216     MOVE X'2020233030303134373531' TO DFHEIV0(25:11)
 17217     CALL 'kxdfhei1' USING DFHEIV0,
 17218           FILE-ID-ERPNDB,
 17219           DFHEIV20,
 17220           DFHEIV99,
 17221           ERPNDB-KEY,
 17222           DFHEIV99,
 17223           DFHEIV99,
 17224           DFHEIV99
 17225     SET ADDRESS OF PENDING-BUSINESS TO
 17226         DFHEIV20
 17227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17228
 17229
 17230     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17231        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17232          GO TO 3030-END-BATCH.
 17233
 17234     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17235
 17236     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17237        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17238          GO TO 3020-BUMP-SEQ.
 17239
 17240     IF PB-ISSUE
 17241        ADD +1                   TO WS-ISS-TOTAL-CNT
 17242        IF PB-FATAL-ERRORS
 17243           ADD +1                      TO WS-ISS-FATAL-CNT
 17244           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17245           GO TO 3020-BUMP-SEQ
 17246        ELSE
 17247           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 317
* EL6311.cbl
 17248              ADD +1                      TO WS-ISS-FORCE-CNT
 17249              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17250              GO TO 3020-BUMP-SEQ
 17251           ELSE
 17252              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17253                 ADD +1                      TO WS-ISS-HOLD-CNT
 17254                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17255                 GO TO 3020-BUMP-SEQ
 17256              ELSE
 17257                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17258                     THRU  3299-EXIT
 17259                 GO TO 3020-BUMP-SEQ.
 17260
 17261     IF PB-CANCELLATION
 17262        ADD +1                   TO WS-CAN-TOTAL-CNT
 17263        IF PB-FATAL-ERRORS
 17264           ADD +1                 TO WS-CAN-FATAL-CNT
 17265           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17266           GO TO 3020-BUMP-SEQ
 17267        ELSE
 17268           IF PB-UNFORCED-ERRORS
 17269              ADD +1                 TO WS-CAN-FORCE-CNT
 17270              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17271              GO TO 3020-BUMP-SEQ
 17272           ELSE
 17273              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17274                 ADD +1                 TO WS-CAN-HOLD-CNT
 17275                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17276                 GO TO 3020-BUMP-SEQ
 17277              ELSE
 17278                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17279                     THRU  3499-EXIT
 17280                 GO TO 3020-BUMP-SEQ.
 17281
 17282     IF PB-BATCH-TRAILER
 17283         GO TO 3030-END-BATCH.
 17284
 17285 3020-BUMP-SEQ.
 17286     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17287     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17288     GO TO 3010-READNEXT.
 17289
 17290 3030-END-BATCH.
 17291     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17292     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17293     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17294     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17295
 17296     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17297                                          - WS-ISS-FORCE-CNT
 17298                                          - WS-ISS-HOLD-CNT).
 17299
 17300     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17301     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 17302
 17303     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 17304     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 17305     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 318
* EL6311.cbl
 17306     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 17307     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17308                                          - WS-CAN-FORCE-CNT
 17309                                          - WS-CAN-HOLD-CNT).
 17310     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 17311     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 17312
 17313     COMPUTE WS-NET-TOTAL-CNT
 17314         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 17315     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 17316     COMPUTE WS-NET-FATAL-CNT
 17317         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 17318     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 17319     COMPUTE WS-NET-FORCE-CNT
 17320         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 17321     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 17322     COMPUTE WS-NET-HOLD-CNT
 17323         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 17324     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 17325
 17326     COMPUTE WS-NET-AVAIL-CNT
 17327          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17328                              - WS-ISS-FORCE-CNT
 17329                              - WS-ISS-HOLD-CNT)
 17330          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17331                              - WS-CAN-FORCE-CNT
 17332                              - WS-CAN-HOLD-CNT).
 17333     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 17334
 17335     COMPUTE WS-NET-GOOD-PREM
 17336         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 17337     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 17338     COMPUTE WS-NET-BAD-PREM
 17339         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 17340     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 17341
 17342     MOVE 0000                   TO EMI-ERROR.
 17343     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17344     MOVE -1                     TO DPFENTRL.
 17345     GO TO 8200-SEND-DATAONLY.
 17346
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 319
* EL6311.cbl
 17348
 17349******************************************************************
 17350*                                                                *
 17351*           A D D    B A D   I S S U E   P R E M I U M           *
 17352*                                                                *
 17353******************************************************************
 17354
 17355 3100-ADD-BAD-ISSUE-PREM.
 17356     IF PB-OVERRIDE-LIFE
 17357       OR PB-OVERRIDE-BOTH
 17358           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 17359           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 17360       ELSE
 17361           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 17362           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 17363
 17364     IF PB-OVERRIDE-AH
 17365       OR PB-OVERRIDE-BOTH
 17366           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 17367       ELSE
 17368           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 17369
 17370 3199-EXIT.
 17371     EXIT.
 17372
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 320
* EL6311.cbl
 17374
 17375******************************************************************
 17376*                                                                *
 17377*       A D D   G O O D   I S S U E   P R E M I U M              *
 17378*                                                                *
 17379******************************************************************
 17380
 17381 3200-ADD-GOOD-ISSUE-PREM.
 17382     IF PB-OVERRIDE-LIFE
 17383       OR PB-OVERRIDE-BOTH
 17384           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 17385           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 17386       ELSE
 17387           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17388           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 17389
 17390     IF PB-OVERRIDE-AH
 17391       OR PB-OVERRIDE-BOTH
 17392           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17393       ELSE
 17394           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 17395
 17396 3299-EXIT.
 17397     EXIT.
 17398
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 321
* EL6311.cbl
 17400
 17401
 17402******************************************************************
 17403*                                                                *
 17404*        A D D   B A D   C A N C E L   P R E M I U M             *
 17405*                                                                *
 17406******************************************************************
 17407
 17408 3300-ADD-BAD-CANCEL-PREM.
 17409     IF PB-OVERRIDE-LIFE
 17410       OR PB-OVERRIDE-BOTH
 17411           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 17412       ELSE
 17413           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17414
 17415     IF PB-OVERRIDE-AH
 17416       OR PB-OVERRIDE-BOTH
 17417           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 17418       ELSE
 17419           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17420
 17421 3399-EXIT.
 17422     EXIT.
 17423
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 322
* EL6311.cbl
 17425
 17426******************************************************************
 17427*                                                                *
 17428*       A D D   G O O D   C A N C E L   P R E M I U M            *
 17429*                                                                *
 17430******************************************************************
 17431
 17432 3400-ADD-GOOD-CANCEL-PREM.
 17433     IF PB-OVERRIDE-LIFE
 17434       OR PB-OVERRIDE-BOTH
 17435           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 17436       ELSE
 17437           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17438
 17439     IF PB-OVERRIDE-AH
 17440       OR PB-OVERRIDE-BOTH
 17441           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 17442       ELSE
 17443           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17444
 17445 3499-EXIT.
 17446     EXIT.
 17447
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 323
* EL6311.cbl
 17449
 17450******************************************************************
 17451*                                                                *
 17452*           E D I T   B A T C H   D A T A                        *
 17453*                                                                *
 17454******************************************************************
 17455
 17456 3500-EDIT-BATCH-DATA.
 17457     IF PI-PREV-KEY NOT = SPACES
 17458        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 17459     ELSE
 17460        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 17461
 17462     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 17463     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17464
 17465
 17466* EXEC CICS HANDLE CONDITION
 17467*         NOTFND      (3590-NOT-FOUND)
 17468*    END-EXEC.
 17469*    MOVE '"$I                   ! F #00014993' TO DFHEIV0
 17470     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17471     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17472     MOVE X'4620233030303134393933' TO DFHEIV0(25:11)
 17473     CALL 'kxdfhei1' USING DFHEIV0
 17474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17475
 17476
 17477     IF DRISSL   GREATER THAN ZEROS OR
 17478        DRISSL   GREATER THAN ZEROS OR
 17479        DRLFPRML GREATER THAN ZEROS OR
 17480        DRAHPRML GREATER THAN ZEROS OR
 17481        DRCANCL  GREATER THAN ZEROS OR
 17482        DRLFRFDL GREATER THAN ZEROS OR
 17483        DRAHRFDL GREATER THAN ZEROS
 17484              NEXT SENTENCE
 17485          ELSE
 17486              MOVE ER-3224    TO EMI-ERROR
 17487              MOVE -1         TO DPFENTRL
 17488              MOVE AL-UNBON   TO DPFENTRA
 17489              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17490              GO TO 8200-SEND-DATAONLY.
 17491
 17492     IF NOT MODIFY-CAP
 17493         MOVE 'UPDATE'       TO SM-READ
 17494         PERFORM 9995-SECURITY-VIOLATION
 17495         MOVE ER-0070        TO EMI-ERROR
 17496         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17497         GO TO 8100-SEND-INITIAL-MAP.
 17498
 17499        IF DRISSL GREATER THAN ZEROS
 17500           MOVE AL-UNNON         TO DRISSA
 17501           MOVE DRISSI           TO DEEDIT-FIELD
 17502           PERFORM 8600-DEEDIT
 17503           IF DEEDIT-FIELD-V0  NUMERIC
 17504              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 17505           ELSE
 17506              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 324
* EL6311.cbl
 17507              MOVE -1         TO DRISSL
 17508              MOVE AL-UNBON   TO DRISSA
 17509              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17510
 17511        IF DRLFPRML GREATER THAN ZEROS
 17512           MOVE AL-UNNON         TO DRLFPRMA
 17513
 17514* EXEC CICS BIF DEEDIT
 17515*              FIELD  (DRLFPRMI)
 17516*              LENGTH (11)
 17517*          END-EXEC
 17518     MOVE 11
 17519       TO DFHEIV11
 17520*    MOVE '@"L                   #   #00015033' TO DFHEIV0
 17521     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17522     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17523     MOVE X'2020233030303135303333' TO DFHEIV0(25:11)
 17524     CALL 'kxdfhei1' USING DFHEIV0,
 17525           DRLFPRMI,
 17526           DFHEIV11
 17527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17528           IF DRLFPRMI NUMERIC
 17529              MOVE DRLFPRMI   TO WS-DRLFPRM
 17530*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 17531*          PERFORM 8600-DEEDIT
 17532*          IF DEEDIT-FIELD-V2  NUMERIC
 17533*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 17534           ELSE
 17535              MOVE ER-2223    TO EMI-ERROR
 17536              MOVE -1         TO DRLFPRML
 17537              MOVE AL-UNBON   TO DRLFPRMA
 17538              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17539
 17540        IF DRAHPRML GREATER THAN ZEROS
 17541           MOVE AL-UNNON         TO DRAHPRMA
 17542
 17543* EXEC CICS BIF DEEDIT
 17544*              FIELD  (DRAHPRMI)
 17545*              LENGTH (11)
 17546*          END-EXEC
 17547     MOVE 11
 17548       TO DFHEIV11
 17549*    MOVE '@"L                   #   #00015051' TO DFHEIV0
 17550     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17551     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17552     MOVE X'2020233030303135303531' TO DFHEIV0(25:11)
 17553     CALL 'kxdfhei1' USING DFHEIV0,
 17554           DRAHPRMI,
 17555           DFHEIV11
 17556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17557           IF DRAHPRMI NUMERIC
 17558              MOVE DRAHPRMI   TO WS-DRAHPRM
 17559*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 17560*          PERFORM 8600-DEEDIT
 17561*          IF DEEDIT-FIELD-V2  NUMERIC
 17562*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 17563           ELSE
 17564              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 325
* EL6311.cbl
 17565              MOVE -1         TO DRAHPRML
 17566              MOVE AL-UNBON   TO DRAHPRMA
 17567              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17568
 17569        IF DRCANCL GREATER THAN ZEROS
 17570           MOVE AL-UNNON         TO DRCANCA
 17571           MOVE DRCANCI          TO DEEDIT-FIELD
 17572           PERFORM 8600-DEEDIT
 17573           IF DEEDIT-FIELD-V0  NUMERIC
 17574              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 17575           ELSE
 17576              MOVE ER-2223    TO EMI-ERROR
 17577              MOVE -1         TO DRCANCL
 17578              MOVE AL-UNBON   TO DRCANCL
 17579              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17580
 17581        IF DRLFRFDL GREATER THAN ZEROS
 17582           MOVE AL-UNNON         TO DRLFRFDA
 17583
 17584* EXEC CICS BIF DEEDIT
 17585*              FIELD  (DRLFRFDI)
 17586*              LENGTH (11)
 17587*          END-EXEC
 17588     MOVE 11
 17589       TO DFHEIV11
 17590*    MOVE '@"L                   #   #00015081' TO DFHEIV0
 17591     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17592     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17593     MOVE X'2020233030303135303831' TO DFHEIV0(25:11)
 17594     CALL 'kxdfhei1' USING DFHEIV0,
 17595           DRLFRFDI,
 17596           DFHEIV11
 17597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17598           IF DRLFRFDI NUMERIC
 17599              MOVE DRLFRFDI   TO WS-DRLFRFD
 17600*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 17601*          PERFORM 8600-DEEDIT
 17602*          IF DEEDIT-FIELD-V2  NUMERIC
 17603*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 17604           ELSE
 17605              MOVE ER-2223    TO EMI-ERROR
 17606              MOVE -1         TO DRLFRFDL
 17607              MOVE AL-UNBON   TO DRLFRFDA
 17608              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17609
 17610        IF DRAHRFDL GREATER THAN ZEROS
 17611           MOVE AL-UNNON         TO DRAHRFDA
 17612
 17613* EXEC CICS BIF DEEDIT
 17614*              FIELD  (DRAHRFDI)
 17615*              LENGTH (11)
 17616*          END-EXEC
 17617     MOVE 11
 17618       TO DFHEIV11
 17619*    MOVE '@"L                   #   #00015099' TO DFHEIV0
 17620     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17621     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17622     MOVE X'2020233030303135303939' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 326
* EL6311.cbl
 17623     CALL 'kxdfhei1' USING DFHEIV0,
 17624           DRAHRFDI,
 17625           DFHEIV11
 17626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17627           IF DRAHRFDI NUMERIC
 17628              MOVE DRAHRFDI   TO WS-DRAHRFD
 17629*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 17630*          PERFORM 8600-DEEDIT
 17631*          IF DEEDIT-FIELD-V2  NUMERIC
 17632*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 17633           ELSE
 17634              MOVE ER-2223    TO EMI-ERROR
 17635              MOVE -1         TO DRAHRFDL
 17636              MOVE AL-UNBON   TO DRAHRFDA
 17637              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17638
 17639     IF EMI-ERROR = ZEROS
 17640        GO 3600-UPDATE-BATCH-HEADER.
 17641
 17642     GO TO 8200-SEND-DATAONLY.
 17643
 17644 3590-NOT-FOUND.
 17645     MOVE ER-2192                TO EMI-ERROR.
 17646     MOVE -1                     TO DPFENTRL.
 17647     MOVE AL-UNBON               TO DPFENTRA.
 17648     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17649     GO TO 8200-SEND-DATAONLY.
 17650
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 327
* EL6311.cbl
 17652
 17653******************************************************************
 17654*                                                                *
 17655*           U P D A T E   B A T C H   H E A D E R                *
 17656*                                                                *
 17657******************************************************************
 17658
 17659 3600-UPDATE-BATCH-HEADER.
 17660
 17661* EXEC CICS HANDLE CONDITION
 17662*         NOTFND      (3690-NOT-FOUND)
 17663*    END-EXEC.
 17664*    MOVE '"$I                   ! G #00015136' TO DFHEIV0
 17665     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17666     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17667     MOVE X'4720233030303135313336' TO DFHEIV0(25:11)
 17668     CALL 'kxdfhei1' USING DFHEIV0
 17669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17670
 17671
 17672
 17673* EXEC CICS READ
 17674*        DATASET (FILE-ID-ERPNDB)
 17675*        RIDFLD  (ERPNDB-KEY)
 17676*        SET     (ADDRESS OF PENDING-BUSINESS)
 17677*        UPDATE
 17678*    END-EXEC.
 17679*    MOVE '&"S        EU         (   #00015140' TO DFHEIV0
 17680     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17681     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17682     MOVE X'2020233030303135313430' TO DFHEIV0(25:11)
 17683     CALL 'kxdfhei1' USING DFHEIV0,
 17684           FILE-ID-ERPNDB,
 17685           DFHEIV20,
 17686           DFHEIV99,
 17687           ERPNDB-KEY,
 17688           DFHEIV99,
 17689           DFHEIV99,
 17690           DFHEIV99
 17691     SET ADDRESS OF PENDING-BUSINESS TO
 17692         DFHEIV20
 17693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17694
 17695
 17696     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17697     MOVE 'B'                    TO JP-RECORD-TYPE.
 17698     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17699
 17700     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17701
 17702     PERFORM 8400-LOG-JOURNAL-RECORD.
 17703
 17704     IF DRISSL GREATER THAN ZEROS
 17705        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 17706
 17707     IF DRCANCL GREATER THAN ZEROS
 17708        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 17709
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 328
* EL6311.cbl
 17710
 17711     IF DRLFPRML GREATER THAN ZEROS
 17712        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 17713
 17714     IF DRAHPRML GREATER THAN ZEROS
 17715        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 17716
 17717     IF DRLFRFDL GREATER THAN ZEROS
 17718        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 17719
 17720     IF DRAHRFDL GREATER THAN ZEROS
 17721        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 17722
 17723 3670-REWRITE-BATCH-HEADER.
 17724     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 17725        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 17726        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 17727        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 17728        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 17729        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 17730        MOVE SPACE               TO PB-OUT-BAL-CD
 17731     ELSE
 17732        MOVE 'O'                 TO PB-OUT-BAL-CD.
 17733
 17734     MOVE 'C'                    TO JP-RECORD-TYPE.
 17735     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17736
 17737
 17738* EXEC CICS REWRITE
 17739*         DATASET      (FILE-ID-ERPNDB)
 17740*         FROM         (PENDING-BUSINESS)
 17741*    END-EXEC.
 17742     MOVE LENGTH OF
 17743      PENDING-BUSINESS
 17744       TO DFHEIV11
 17745*    MOVE '&& L                  %   #00015188' TO DFHEIV0
 17746     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17747     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17748     MOVE X'2020233030303135313838' TO DFHEIV0(25:11)
 17749     CALL 'kxdfhei1' USING DFHEIV0,
 17750           FILE-ID-ERPNDB,
 17751           PENDING-BUSINESS,
 17752           DFHEIV11,
 17753           DFHEIV99
 17754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17755
 17756
 17757     PERFORM 8400-LOG-JOURNAL-RECORD.
 17758
 17759     GO TO 7200-DISPLAY-BATCHES.
 17760
 17761 3690-NOT-FOUND.
 17762     MOVE ER-2192                TO EMI-ERROR.
 17763     MOVE -1                     TO DPFENTRL.
 17764     MOVE AL-UNBON               TO DPFENTRA.
 17765     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17766     GO TO 8200-SEND-DATAONLY.
 17767
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 329
* EL6311.cbl
 17769
 17770******************************************************************
 17771*                                                                *
 17772*           R E - D I S P L A Y   R E C O R D                    *
 17773*                                                                *
 17774******************************************************************
 17775
 17776 3900-RE-DISPLAY-RECORD.
 17777
 17778* EXEC CICS HANDLE CONDITION
 17779*         NOTFND   (3990-NOT-FOUND)
 17780*    END-EXEC.
 17781*    MOVE '"$I                   ! H #00015213' TO DFHEIV0
 17782     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17783     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17784     MOVE X'4820233030303135323133' TO DFHEIV0(25:11)
 17785     CALL 'kxdfhei1' USING DFHEIV0
 17786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17787
 17788
 17789     IF PI-DISPLAY-ORIGINAL-BATCH
 17790         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 17791     ELSE
 17792         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 17793
 17794
 17795* EXEC CICS READ
 17796*         DATASET   (FILE-ID)
 17797*         RIDFLD    (PI-PREV-KEY)
 17798*         SET       (ADDRESS OF PENDING-BUSINESS)
 17799*    END-EXEC.
 17800*    MOVE '&"S        E          (   #00015222' TO DFHEIV0
 17801     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17802     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17803     MOVE X'2020233030303135323232' TO DFHEIV0(25:11)
 17804     CALL 'kxdfhei1' USING DFHEIV0,
 17805           FILE-ID,
 17806           DFHEIV20,
 17807           DFHEIV99,
 17808           PI-PREV-KEY,
 17809           DFHEIV99,
 17810           DFHEIV99,
 17811           DFHEIV99
 17812     SET ADDRESS OF PENDING-BUSINESS TO
 17813         DFHEIV20
 17814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17815
 17816
 17817     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 17818
 17819     IF PB-ISSUE
 17820         GO TO 7000-DISPLAY-ISSUES.
 17821
 17822     IF PB-CANCELLATION
 17823         GO TO 7100-DISPLAY-CANCELS.
 17824
 17825     IF PB-BATCH-TRAILER
 17826         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 330
* EL6311.cbl
 17827
 17828 3990-NOT-FOUND.
 17829     MOVE LOW-VALUES             TO EL631BI.
 17830
 17831     IF PI-MAP-NAME = EL631B
 17832         MOVE -1                  TO BMAINTL
 17833     ELSE
 17834         MOVE -1                  TO CMAINTL.
 17835
 17836     GO TO 8100-SEND-INITIAL-MAP.
 17837
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 331
* EL6311.cbl
 17839
 17840***************************************************************
 17841*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 17842*                                                             *
 17843*      1. START BROWSE WITH                                   *
 17844*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 17845*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 17846*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 17847*                                                             *
 17848*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 17849*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 17850*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 17851*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 17852*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 17853*               AND IS IT TO BE DISPLAYED.                    *
 17854*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 17855*               DISPLAYED.                                    *
 17856*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 17857*               DISPLAYED.                                    *
 17858*                                                             *
 17859*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 17860*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 17861***************************************************************
 17862
 17863 4000-BROWSE-DETAIL-FORWARD.
 17864     IF FIRST-TIME
 17865        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 17866     ELSE
 17867        IF SHOW-RECORD
 17868           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 17869           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 17870           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 17871           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 17872           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 17873        ELSE
 17874           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 17875
 17876
 17877* EXEC CICS HANDLE CONDITION
 17878*         NOTFND   (4050-END-RECORDS)
 17879*         ENDFILE  (4050-END-RECORDS)
 17880*    END-EXEC.
 17881*    MOVE '"$I''                  ! I #00015287' TO DFHEIV0
 17882     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 17883     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17884     MOVE X'4920233030303135323837' TO DFHEIV0(25:11)
 17885     CALL 'kxdfhei1' USING DFHEIV0
 17886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17887
 17888
 17889
 17890* EXEC CICS STARTBR
 17891*         DATASET   (FILE-ID-ERPNDB2)
 17892*         RIDFLD    (ERPNDB-ALT-KEY)
 17893*    END-EXEC.
 17894     MOVE 0
 17895       TO DFHEIV11
 17896*    MOVE '&,         G          &   #00015292' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 332
* EL6311.cbl
 17897     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17898     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17899     MOVE X'2020233030303135323932' TO DFHEIV0(25:11)
 17900     CALL 'kxdfhei1' USING DFHEIV0,
 17901           FILE-ID-ERPNDB2,
 17902           ERPNDB-ALT-KEY,
 17903           DFHEIV99,
 17904           DFHEIV11,
 17905           DFHEIV99
 17906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17907
 17908
 17909     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 17910
 17911     IF FIRST-TIME OR SHOW-RECORD
 17912        MOVE SPACE               TO WS-FIRST-TIME-SW
 17913        GO TO 4005-READ-NEXT-RECORD.
 17914
 17915
 17916* EXEC CICS READNEXT
 17917*         DATASET    (FILE-ID-ERPNDB2)
 17918*         SET        (ADDRESS OF PENDING-BUSINESS)
 17919*         RIDFLD     (ERPNDB-ALT-KEY)
 17920*    END-EXEC.
 17921     MOVE 0
 17922       TO DFHEIV11
 17923*    MOVE '&.S                   )   #00015303' TO DFHEIV0
 17924     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17925     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17926     MOVE X'2020233030303135333033' TO DFHEIV0(25:11)
 17927     CALL 'kxdfhei1' USING DFHEIV0,
 17928           FILE-ID-ERPNDB2,
 17929           DFHEIV20,
 17930           DFHEIV99,
 17931           ERPNDB-ALT-KEY,
 17932           DFHEIV99,
 17933           DFHEIV11,
 17934           DFHEIV99,
 17935           DFHEIV99
 17936     SET ADDRESS OF PENDING-BUSINESS TO
 17937         DFHEIV20
 17938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17939
 17940
 17941 4005-READ-NEXT-RECORD.
 17942
 17943* EXEC CICS READNEXT
 17944*         DATASET    (FILE-ID-ERPNDB2)
 17945*         SET        (ADDRESS OF PENDING-BUSINESS)
 17946*         RIDFLD     (ERPNDB-ALT-KEY)
 17947*    END-EXEC.
 17948     MOVE 0
 17949       TO DFHEIV11
 17950*    MOVE '&.S                   )   #00015310' TO DFHEIV0
 17951     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17952     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17953     MOVE X'2020233030303135333130' TO DFHEIV0(25:11)
 17954     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 333
* EL6311.cbl
 17955           FILE-ID-ERPNDB2,
 17956           DFHEIV20,
 17957           DFHEIV99,
 17958           ERPNDB-ALT-KEY,
 17959           DFHEIV99,
 17960           DFHEIV11,
 17961           DFHEIV99,
 17962           DFHEIV99
 17963     SET ADDRESS OF PENDING-BUSINESS TO
 17964         DFHEIV20
 17965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17966
 17967
 17968     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 17969
 17970     IF WS-BATCH-PREFIX = '#CL'
 17971        GO TO 4005-READ-NEXT-RECORD.
 17972
 17973     IF SHOW-RECORD
 17974        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 17975           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 17976           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 17977           PB-STATE         NOT = PI-PB-STATE          OR
 17978           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 17979           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 17980           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 17981           GO TO 4050-END-RECORDS
 17982        ELSE
 17983           GO TO 4010-CHECK-REC-TYPE.
 17984
 17985     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 17986        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 17987        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 17988        PB-STATE            NOT = PI-PB-STATE          OR
 17989        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 17990        GO TO 4050-END-RECORDS.
 17991
 17992     IF PB-BATCH-TRAILER
 17993        GO TO 4005-READ-NEXT-RECORD.
 17994
 17995     IF PI-PB-CERT-NO NOT = LOW-VALUES
 17996        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 17997           GO TO 4005-READ-NEXT-RECORD
 17998        ELSE
 17999           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18000              GO TO 4010-CHECK-REC-TYPE
 18001           ELSE
 18002              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18003                 GO TO 4010-CHECK-REC-TYPE
 18004              ELSE
 18005                 GO TO 4005-READ-NEXT-RECORD.
 18006
 18007     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18008        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18009           GO TO 4005-READ-NEXT-RECORD.
 18010
 18011 4010-CHECK-REC-TYPE.
 18012     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 334
* EL6311.cbl
 18013         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18014             NEXT SENTENCE
 18015         ELSE
 18016             GO TO 4005-READ-NEXT-RECORD.
 18017
 18018     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18019         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18020             NEXT SENTENCE
 18021        ELSE
 18022             GO TO 4005-READ-NEXT-RECORD.
 18023
 18024     IF NOT DISPLAY-CHANGE-RECORDS AND
 18025            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18026        GO TO 4005-READ-NEXT-RECORD.
 18027
 18028     IF DISPLAY-HOLD-RECORDS AND
 18029        NOT PB-RECORD-ON-HOLD
 18030          GO TO 4005-READ-NEXT-RECORD.
 18031
 18032     IF PB-ISSUE
 18033        IF DISPLAY-CHK-REQ-RECORDS
 18034            GO TO 4005-READ-NEXT-RECORD.
 18035
 18036     IF PB-ISSUE
 18037        IF ISSUE-WITH-WARNING
 18038           IF PB-WARNING-ERRORS
 18039              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18040                  GO TO 4005-READ-NEXT-RECORD
 18041              ELSE
 18042                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18043                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18044                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18045                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18046                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18047                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18048                 GO TO 7000-DISPLAY-ISSUES
 18049           ELSE
 18050              GO TO 4005-READ-NEXT-RECORD.
 18051
 18052     IF PB-ISSUE
 18053        IF (ISSUES-IN-ERROR AND
 18054            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18055            ALL-ISSUES
 18056            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18057            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18058            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18059            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18060            MOVE PB-SV-STATE            TO PI-SV-STATE
 18061            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18062            GO TO 7000-DISPLAY-ISSUES
 18063        ELSE
 18064            GO TO 4005-READ-NEXT-RECORD.
 18065
 18066     IF PB-CANCELLATION
 18067        IF DISPLAY-CHK-REQ-RECORDS
 18068           IF PB-C-REFUND-REQUESTED
 18069              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18070              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 335
* EL6311.cbl
 18071              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18072              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18073              MOVE PB-SV-STATE            TO PI-SV-STATE
 18074              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18075              GO TO 7100-DISPLAY-CANCELS
 18076           ELSE
 18077               GO TO 4005-READ-NEXT-RECORD.
 18078
 18079     IF PB-CANCELLATION
 18080        IF CANCEL-WITH-WARNING
 18081           IF PB-WARNING-ERRORS
 18082              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18083                  GO TO 4005-READ-NEXT-RECORD
 18084              ELSE
 18085                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18086                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18087                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18088                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18089                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18090                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18091                 GO TO 7100-DISPLAY-CANCELS
 18092           ELSE
 18093              GO TO 4005-READ-NEXT-RECORD.
 18094
 18095     IF PB-CANCELLATION
 18096        IF (CANCEL-IN-ERROR  AND
 18097            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18098            ALL-CANCELS
 18099            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18100            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18101            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18102            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18103            MOVE PB-SV-STATE            TO PI-SV-STATE
 18104            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18105            GO TO 7100-DISPLAY-CANCELS.
 18106
 18107     GO TO 4005-READ-NEXT-RECORD.
 18108
 18109 4050-END-RECORDS.
 18110******************************************************************
 18111*                                                                *
 18112*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18113*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18114*         PROGRAM.                                               *
 18115*                                                                *
 18116******************************************************************
 18117
 18118     IF BROWSE-STARTED
 18119        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18120
 18121* EXEC CICS ENDBR
 18122*            DATASET  (FILE-ID-ERPNDB2)
 18123*       END-EXEC.
 18124     MOVE 0
 18125       TO DFHEIV11
 18126*    MOVE '&2                    $   #00015468' TO DFHEIV0
 18127     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18128     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 336
* EL6311.cbl
 18129     MOVE X'2020233030303135343638' TO DFHEIV0(25:11)
 18130     CALL 'kxdfhei1' USING DFHEIV0,
 18131           FILE-ID-ERPNDB2,
 18132           DFHEIV11,
 18133           DFHEIV99
 18134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18135
 18136
 18137     IF  EIBTRNID NOT = TRANS-EXB1
 18138         IF PENDING-BUS-RECS-FOUND
 18139             NEXT SENTENCE
 18140           ELSE
 18141             MOVE '9'            TO PI-BROWSE-SW
 18142             GO TO 9400-CLEAR.
 18143
 18144     IF SHOW-RECORD
 18145        MOVE ER-2253            TO EMI-ERROR
 18146       ELSE
 18147        MOVE ER-2254            TO EMI-ERROR.
 18148
 18149     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18150
 18151     IF PI-MAP-NAME = SPACES
 18152        MOVE -1                  TO DPFENTRL
 18153        MOVE EL631D               TO PI-MAP-NAME
 18154        GO TO 8100-SEND-INITIAL-MAP.
 18155
 18156     IF PI-MAP-NAME = EL631B
 18157        MOVE -1                  TO BMAINTL
 18158     ELSE
 18159        IF PI-MAP-NAME = EL631C
 18160           MOVE -1               TO CMAINTL
 18161        ELSE
 18162           MOVE -1               TO DPFENTRL.
 18163
 18164     GO TO 8200-SEND-DATAONLY.
 18165
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 337
* EL6311.cbl
 18167
 18168***************************************************************
 18169*                                                             *
 18170*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18171*                                                             *
 18172*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18173*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18174*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18175*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18176*                                                             *
 18177*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18178*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18179*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18180*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18181*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18182*                AND IS IT TO BE DISPLAYED.                   *
 18183*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18184*                DISPLAYED.                                   *
 18185*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18186*                DISPLAYED.                                   *
 18187*                                                             *
 18188*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18189*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18190*                                                             *
 18191*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18192*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18193*                THEY ARE NOT TO BE DISPLAYED.                *
 18194*                                                             *
 18195***************************************************************
 18196
 18197 4100-BROWSE-PRIMARY-FORWARD.
 18198     IF FIRST-TIME  OR SHOW-RECORD
 18199        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18200        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18201        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18202     ELSE
 18203        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18204        IF ERPNDB-BATCH-SEQ-NO = +9999
 18205           GO TO 4150-END-BATCH
 18206        ELSE
 18207           IF DISPLAY-CHANGE-RECORDS
 18208              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18209           ELSE
 18210              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18211              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18212
 18213     IF FIRST-TIME
 18214         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18215            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18216              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18217
 18218
 18219* EXEC CICS HANDLE CONDITION
 18220*         ENDFILE  (4150-END-BATCH)
 18221*    END-EXEC.
 18222*    MOVE '"$''                   ! J #00015553' TO DFHEIV0
 18223     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18224     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 338
* EL6311.cbl
 18225     MOVE X'4A20233030303135353533' TO DFHEIV0(25:11)
 18226     CALL 'kxdfhei1' USING DFHEIV0
 18227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18228
 18229
 18230 4105-READ-NEXT.
 18231
 18232* EXEC CICS HANDLE CONDITION
 18233*         NOTFND    (4150-END-BATCH)
 18234*    END-EXEC.
 18235*    MOVE '"$I                   ! K #00015558' TO DFHEIV0
 18236     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18237     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18238     MOVE X'4B20233030303135353538' TO DFHEIV0(25:11)
 18239     CALL 'kxdfhei1' USING DFHEIV0
 18240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18241
 18242
 18243     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18244
 18245     IF PI-DISPLAY-ORIGINAL-BATCH
 18246        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18247     ELSE
 18248        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18249
 18250
 18251* EXEC CICS READ
 18252*         DATASET   (FILE-ID)
 18253*         SET       (ADDRESS OF PENDING-BUSINESS)
 18254*         RIDFLD    (ERPNDB-KEY)
 18255*         GTEQ
 18256*    END-EXEC.
 18257*    MOVE '&"S        G          (   #00015569' TO DFHEIV0
 18258     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18259     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18260     MOVE X'2020233030303135353639' TO DFHEIV0(25:11)
 18261     CALL 'kxdfhei1' USING DFHEIV0,
 18262           FILE-ID,
 18263           DFHEIV20,
 18264           DFHEIV99,
 18265           ERPNDB-KEY,
 18266           DFHEIV99,
 18267           DFHEIV99,
 18268           DFHEIV99
 18269     SET ADDRESS OF PENDING-BUSINESS TO
 18270         DFHEIV20
 18271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18272
 18273
 18274     IF PI-DISPLAY-ORIGINAL-BATCH
 18275        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18276           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18277           GO TO 4150-END-BATCH
 18278        ELSE
 18279           IF PB-BATCH-TRAILER
 18280              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18281              GO TO 4105-READ-NEXT
 18282           ELSE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 339
* EL6311.cbl
 18283              NEXT SENTENCE
 18284     ELSE
 18285        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18286           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18287           GO TO 4150-END-BATCH.
 18288
 18289     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18290
 18291     IF WS-BATCH-PREFIX = '#CL'
 18292         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18293         GO TO 4105-READ-NEXT.
 18294
 18295     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18296     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18297     MOVE PB-STATE               TO PI-PB-STATE.
 18298     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18299
 18300     IF PB-BATCH-TRAILER
 18301        IF SHOW-RECORD
 18302           GO TO 4150-END-BATCH
 18303        ELSE
 18304           MOVE ER-2251         TO EMI-ERROR
 18305           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18306           MOVE 1               TO PI-BROWSE-TYPE
 18307           GO TO 7200-DISPLAY-BATCHES.
 18308
 18309     IF SHOW-RECORD
 18310           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18311              GO TO 4110-BUMP-SEQ
 18312           ELSE
 18313              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18314                 GO TO 4110-BUMP-SEQ
 18315              ELSE
 18316                 GO TO 4107-CHECK-REC-TYPE.
 18317
 18318     IF NOT  PI-PRIMARY-WITH-SELECT
 18319        GO TO 4107-CHECK-REC-TYPE.
 18320
 18321     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18322        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18323           GO TO 4110-BUMP-SEQ
 18324        ELSE
 18325           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18326              GO TO 4107-CHECK-REC-TYPE
 18327           ELSE
 18328              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18329                 GO TO 4107-CHECK-REC-TYPE
 18330              ELSE
 18331                 GO TO 4110-BUMP-SEQ.
 18332
 18333     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18334        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18335           GO TO 4110-BUMP-SEQ.
 18336
 18337 4107-CHECK-REC-TYPE.
 18338     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18339         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18340             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 340
* EL6311.cbl
 18341           ELSE
 18342             GO TO 4110-BUMP-SEQ.
 18343
 18344     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18345         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18346             NEXT SENTENCE
 18347           ELSE
 18348             GO TO 4110-BUMP-SEQ.
 18349
 18350     IF NOT DISPLAY-CHANGE-RECORDS AND
 18351        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18352           GO TO 4110-BUMP-SEQ.
 18353
 18354     IF DISPLAY-HOLD-RECORDS AND
 18355        NOT PB-RECORD-ON-HOLD
 18356          GO TO 4110-BUMP-SEQ.
 18357
 18358     IF PB-ISSUE
 18359        IF DISPLAY-CHK-REQ-RECORDS
 18360            GO TO 4110-BUMP-SEQ.
 18361
 18362     IF PB-ISSUE
 18363        IF ISSUE-WITH-WARNING
 18364           IF PB-WARNING-ERRORS
 18365              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18366                  GO TO 4110-BUMP-SEQ
 18367              ELSE
 18368                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18369                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18370                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18371                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18372                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18373                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18374                 GO TO 7000-DISPLAY-ISSUES
 18375        ELSE
 18376            GO TO 4110-BUMP-SEQ.
 18377
 18378     IF PB-ISSUE
 18379        IF (ISSUES-IN-ERROR AND
 18380            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18381            ALL-ISSUES
 18382            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18383            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18384            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18385            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18386            MOVE PB-SV-STATE            TO PI-SV-STATE
 18387            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18388            GO TO 7000-DISPLAY-ISSUES
 18389        ELSE
 18390            GO TO 4110-BUMP-SEQ.
 18391
 18392     IF PB-CANCELLATION
 18393        IF DISPLAY-CHK-REQ-RECORDS
 18394           IF PB-C-REFUND-REQUESTED
 18395              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18396              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18397              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18398              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 341
* EL6311.cbl
 18399              MOVE PB-SV-STATE            TO PI-SV-STATE
 18400              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18401              GO TO 7100-DISPLAY-CANCELS
 18402           ELSE
 18403              GO TO 4110-BUMP-SEQ.
 18404
 18405     IF PB-CANCELLATION
 18406        IF CANCEL-WITH-WARNING
 18407           IF PB-WARNING-ERRORS
 18408              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18409                  GO TO 4110-BUMP-SEQ
 18410              ELSE
 18411                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18412                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18413                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18414                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18415                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18416                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18417                 GO TO 7100-DISPLAY-CANCELS
 18418           ELSE
 18419              GO TO 4110-BUMP-SEQ.
 18420
 18421     IF PB-CANCELLATION
 18422        IF (CANCEL-IN-ERROR  AND
 18423            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18424            ALL-CANCELS
 18425            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18426            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18427            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18428            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18429            MOVE PB-SV-STATE            TO PI-SV-STATE
 18430            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 18431            GO TO 7100-DISPLAY-CANCELS.
 18432
 18433 4110-BUMP-SEQ.
 18434     IF NOT DISPLAY-CHANGE-RECORDS
 18435        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18436        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 18437     ELSE
 18438        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 18439           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 18440           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 18441        ELSE
 18442           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 18443           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 18444
 18445     GO TO 4105-READ-NEXT.
 18446
 18447 4150-END-BATCH.
 18448******************************************************************
 18449*                                                                *
 18450*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18451*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 18452*         PROGRAM.                                               *
 18453*                                                                *
 18454******************************************************************
 18455
 18456     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 342
* EL6311.cbl
 18457         IF PENDING-BUS-RECS-FOUND
 18458             NEXT SENTENCE
 18459           ELSE
 18460             MOVE '9'            TO PI-BROWSE-SW
 18461             GO TO 9400-CLEAR.
 18462
 18463     IF SHOW-RECORD
 18464        MOVE ER-2253             TO EMI-ERROR
 18465     ELSE
 18466        MOVE ER-2251             TO EMI-ERROR.
 18467
 18468     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18469
 18470     IF PI-MAP-NAME = SPACES
 18471        MOVE -1                  TO BMAINTL
 18472        MOVE EL631B              TO PI-MAP-NAME
 18473        GO TO 8100-SEND-INITIAL-MAP.
 18474
 18475     IF PI-MAP-NAME = EL631B
 18476        MOVE -1                  TO BMAINTL
 18477     ELSE
 18478        IF PI-MAP-NAME = EL631C
 18479           MOVE -1               TO CMAINTL
 18480        ELSE
 18481           MOVE -1               TO DPFENTRL.
 18482
 18483     GO TO 8200-SEND-DATAONLY.
 18484
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 343
* EL6311.cbl
 18486
 18487***************************************************************
 18488*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 18489*                                                             *
 18490*      1. START BROWSE WITH                                   *
 18491*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18492*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18493*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18494*                                                             *
 18495*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18496*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18497*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18498*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18499*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18500*               AND IS IT TO BE DISPLAYED.                    *
 18501*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18502*               DISPLAYED.                                    *
 18503*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18504*               DISPLAYED.                                    *
 18505*                                                             *
 18506*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18507*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18508***************************************************************
 18509
 18510 4200-BROWSE-CSR-FORWARD.
 18511
 18512     IF FIRST-TIME
 18513        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 18514     ELSE
 18515        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 18516
 18517
 18518* EXEC CICS HANDLE CONDITION
 18519*         NOTFND   (4250-END-RECORDS)
 18520*         ENDFILE  (4250-END-RECORDS)
 18521*    END-EXEC.
 18522*    MOVE '"$I''                  ! L #00015819' TO DFHEIV0
 18523     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18524     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18525     MOVE X'4C20233030303135383139' TO DFHEIV0(25:11)
 18526     CALL 'kxdfhei1' USING DFHEIV0
 18527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18528
 18529
 18530
 18531* EXEC CICS STARTBR
 18532*         DATASET   (FILE-ID-ERPNDB4)
 18533*         RIDFLD    (ERPNDB-CSR-KEY)
 18534*    END-EXEC.
 18535     MOVE 0
 18536       TO DFHEIV11
 18537*    MOVE '&,         G          &   #00015824' TO DFHEIV0
 18538     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18539     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18540     MOVE X'2020233030303135383234' TO DFHEIV0(25:11)
 18541     CALL 'kxdfhei1' USING DFHEIV0,
 18542           FILE-ID-ERPNDB4,
 18543           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 344
* EL6311.cbl
 18544           DFHEIV99,
 18545           DFHEIV11,
 18546           DFHEIV99
 18547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18548
 18549
 18550     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18551
 18552     IF FIRST-TIME
 18553        MOVE SPACE               TO WS-FIRST-TIME-SW
 18554        GO TO 4205-READ-NEXT-RECORD.
 18555
 18556
 18557* EXEC CICS READNEXT
 18558*         DATASET    (FILE-ID-ERPNDB4)
 18559*         SET        (ADDRESS OF PENDING-BUSINESS)
 18560*         RIDFLD     (ERPNDB-CSR-KEY)
 18561*    END-EXEC.
 18562     MOVE 0
 18563       TO DFHEIV11
 18564*    MOVE '&.S                   )   #00015835' TO DFHEIV0
 18565     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18566     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18567     MOVE X'2020233030303135383335' TO DFHEIV0(25:11)
 18568     CALL 'kxdfhei1' USING DFHEIV0,
 18569           FILE-ID-ERPNDB4,
 18570           DFHEIV20,
 18571           DFHEIV99,
 18572           ERPNDB-CSR-KEY,
 18573           DFHEIV99,
 18574           DFHEIV11,
 18575           DFHEIV99,
 18576           DFHEIV99
 18577     SET ADDRESS OF PENDING-BUSINESS TO
 18578         DFHEIV20
 18579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18580
 18581
 18582 4205-READ-NEXT-RECORD.
 18583
 18584
 18585* EXEC CICS READNEXT
 18586*         DATASET    (FILE-ID-ERPNDB4)
 18587*         SET        (ADDRESS OF PENDING-BUSINESS)
 18588*         RIDFLD     (ERPNDB-CSR-KEY)
 18589*    END-EXEC.
 18590     MOVE 0
 18591       TO DFHEIV11
 18592*    MOVE '&.S                   )   #00015843' TO DFHEIV0
 18593     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18594     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18595     MOVE X'2020233030303135383433' TO DFHEIV0(25:11)
 18596     CALL 'kxdfhei1' USING DFHEIV0,
 18597           FILE-ID-ERPNDB4,
 18598           DFHEIV20,
 18599           DFHEIV99,
 18600           ERPNDB-CSR-KEY,
 18601           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 345
* EL6311.cbl
 18602           DFHEIV11,
 18603           DFHEIV99,
 18604           DFHEIV99
 18605     SET ADDRESS OF PENDING-BUSINESS TO
 18606         DFHEIV20
 18607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18608
 18609
 18610     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18611
 18612     IF WS-BATCH-PREFIX = '#CL'
 18613        GO TO 4205-READ-NEXT-RECORD.
 18614
 18615     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 18616        PB-CSR-ID           NOT = PI-PB-CSR-ID
 18617        GO TO 4250-END-RECORDS.
 18618
 18619     IF PB-BATCH-TRAILER
 18620        GO TO 4205-READ-NEXT-RECORD.
 18621
 18622     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18623        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18624           GO TO 4205-READ-NEXT-RECORD
 18625        ELSE
 18626           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18627              GO TO 4210-CHECK-REC-TYPE
 18628           ELSE
 18629              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18630                 GO TO 4210-CHECK-REC-TYPE
 18631              ELSE
 18632                 GO TO 4205-READ-NEXT-RECORD.
 18633
 18634     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18635        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18636           GO TO 4205-READ-NEXT-RECORD.
 18637
 18638 4210-CHECK-REC-TYPE.
 18639     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18640         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18641             NEXT SENTENCE
 18642         ELSE
 18643             GO TO 4205-READ-NEXT-RECORD.
 18644
 18645     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18646         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18647             NEXT SENTENCE
 18648        ELSE
 18649             GO TO 4205-READ-NEXT-RECORD.
 18650
 18651     IF NOT DISPLAY-CHANGE-RECORDS AND
 18652            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18653        GO TO 4205-READ-NEXT-RECORD.
 18654
 18655     IF DISPLAY-HOLD-RECORDS AND
 18656        NOT PB-RECORD-ON-HOLD
 18657          GO TO 4205-READ-NEXT-RECORD.
 18658
 18659     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 346
* EL6311.cbl
 18660        IF DISPLAY-CHK-REQ-RECORDS
 18661            GO TO 4205-READ-NEXT-RECORD.
 18662
 18663     IF PB-ISSUE
 18664        IF ISSUE-WITH-WARNING
 18665           IF PB-WARNING-ERRORS
 18666              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18667                  GO TO 4205-READ-NEXT-RECORD
 18668              ELSE
 18669                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18670                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18671                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18672                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18673                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18674                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18675                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18676                 GO TO 7000-DISPLAY-ISSUES
 18677           ELSE
 18678              GO TO 4205-READ-NEXT-RECORD.
 18679
 18680     IF PB-ISSUE
 18681        IF (ISSUES-IN-ERROR AND
 18682            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18683            ALL-ISSUES
 18684            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18685            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18686            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18687            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18688            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18689            MOVE PB-SV-STATE            TO PI-SV-STATE
 18690            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18691            GO TO 7000-DISPLAY-ISSUES
 18692        ELSE
 18693            GO TO 4205-READ-NEXT-RECORD.
 18694
 18695     IF PB-CANCELLATION
 18696        IF DISPLAY-CHK-REQ-RECORDS
 18697           IF PB-C-REFUND-REQUESTED
 18698              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18699              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18700              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18701              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18702              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18703              MOVE PB-SV-STATE            TO PI-SV-STATE
 18704              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18705              GO TO 7100-DISPLAY-CANCELS
 18706           ELSE
 18707               GO TO 4205-READ-NEXT-RECORD.
 18708
 18709     IF PB-CANCELLATION
 18710        IF CANCEL-WITH-WARNING
 18711           IF PB-WARNING-ERRORS
 18712              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18713                  GO TO 4205-READ-NEXT-RECORD
 18714              ELSE
 18715                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18716                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18717                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 347
* EL6311.cbl
 18718                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18719                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18720                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18721                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18722                 GO TO 7100-DISPLAY-CANCELS
 18723           ELSE
 18724              GO TO 4205-READ-NEXT-RECORD.
 18725
 18726     IF PB-CANCELLATION
 18727        IF (CANCEL-IN-ERROR  AND
 18728            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18729            ALL-CANCELS
 18730            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18731            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18732            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18733            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18734            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18735            MOVE PB-SV-STATE            TO PI-SV-STATE
 18736            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18737            GO TO 7100-DISPLAY-CANCELS.
 18738
 18739     GO TO 4205-READ-NEXT-RECORD.
 18740
 18741 4250-END-RECORDS.
 18742******************************************************************
 18743*                                                                *
 18744*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18745*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18746*         PROGRAM.                                               *
 18747*                                                                *
 18748******************************************************************
 18749
 18750     IF BROWSE-STARTED
 18751        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18752
 18753* EXEC CICS ENDBR
 18754*            DATASET  (FILE-ID-ERPNDB4)
 18755*       END-EXEC.
 18756     MOVE 0
 18757       TO DFHEIV11
 18758*    MOVE '&2                    $   #00015991' TO DFHEIV0
 18759     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18760     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18761     MOVE X'2020233030303135393931' TO DFHEIV0(25:11)
 18762     CALL 'kxdfhei1' USING DFHEIV0,
 18763           FILE-ID-ERPNDB4,
 18764           DFHEIV11,
 18765           DFHEIV99
 18766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18767
 18768
 18769     IF  EIBTRNID NOT = TRANS-EXB1
 18770         IF PENDING-BUS-RECS-FOUND
 18771             NEXT SENTENCE
 18772           ELSE
 18773             MOVE '9'            TO PI-BROWSE-SW
 18774             GO TO 9400-CLEAR.
 18775
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 348
* EL6311.cbl
 18776     IF SHOW-RECORD
 18777        MOVE ER-2253            TO EMI-ERROR
 18778       ELSE
 18779        MOVE ER-2254            TO EMI-ERROR.
 18780
 18781     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18782
 18783     IF PI-MAP-NAME = SPACES
 18784        MOVE -1                  TO DPFENTRL
 18785        MOVE EL631D               TO PI-MAP-NAME
 18786        GO TO 8100-SEND-INITIAL-MAP.
 18787
 18788     IF PI-MAP-NAME = EL631B
 18789        MOVE -1                  TO BMAINTL
 18790     ELSE
 18791        IF PI-MAP-NAME = EL631C
 18792           MOVE -1               TO CMAINTL
 18793        ELSE
 18794           MOVE -1               TO DPFENTRL.
 18795
 18796     GO TO 8200-SEND-DATAONLY.
 18797
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 349
* EL6311.cbl
 18799
 18800***************************************************************
 18801*                                                             *
 18802*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 18803*                                                             *
 18804*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 18805*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18806*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18807*                                                             *
 18808*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18809*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18810*          A. IS IT WITHIN THE SAME COMPANY                   *
 18811*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18812*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18813*                AND IS IT TO BE DISPLAYED.                   *
 18814*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18815*                DISPLAYED.                                   *
 18816*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18817*                DISPLAYED.                                   *
 18818*                                                             *
 18819*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18820*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18821*                                                             *
 18822*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18823*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18824*                THEY ARE NOT TO BE DISPLAYED.                *
 18825*                                                             *
 18826***************************************************************
 18827
 18828 4300-BROWSE-FILE-FORWARD.
 18829     IF FIRST-TIME OR SHOW-RECORD
 18830        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 18831        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 18832        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18833     ELSE
 18834        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18835        IF ERPNDB-BATCH-SEQ-NO = +9999
 18836           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 18837        ELSE
 18838           IF DISPLAY-CHANGE-RECORDS
 18839              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18840           ELSE
 18841              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18842              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18843
 18844
 18845* EXEC CICS HANDLE CONDITION
 18846*         ENDFILE  (4350-END-BATCH)
 18847*         NOTFND   (4350-END-BATCH)
 18848*    END-EXEC.
 18849*    MOVE '"$''I                  ! M #00016070' TO DFHEIV0
 18850     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18851     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18852     MOVE X'4D20233030303136303730' TO DFHEIV0(25:11)
 18853     CALL 'kxdfhei1' USING DFHEIV0
 18854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18855
 18856
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 350
* EL6311.cbl
 18857 4305-READ-NEXT.
 18858     IF PI-DISPLAY-ORIGINAL-BATCH
 18859        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18860     ELSE
 18861        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18862
 18863
 18864* EXEC CICS READ
 18865*         DATASET   (FILE-ID)
 18866*         SET       (ADDRESS OF PENDING-BUSINESS)
 18867*         RIDFLD    (ERPNDB-KEY)
 18868*         GTEQ
 18869*    END-EXEC.
 18870*    MOVE '&"S        G          (   #00016081' TO DFHEIV0
 18871     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18872     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18873     MOVE X'2020233030303136303831' TO DFHEIV0(25:11)
 18874     CALL 'kxdfhei1' USING DFHEIV0,
 18875           FILE-ID,
 18876           DFHEIV20,
 18877           DFHEIV99,
 18878           ERPNDB-KEY,
 18879           DFHEIV99,
 18880           DFHEIV99,
 18881           DFHEIV99
 18882     SET ADDRESS OF PENDING-BUSINESS TO
 18883         DFHEIV20
 18884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18885
 18886
 18887     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 18888        GO TO 4350-END-BATCH.
 18889
 18890     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 18891                                    WS-BATCH-NO.
 18892
 18893     IF  WS-BATCH-PREFIX = '#CL'
 18894         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18895         GO TO 4305-READ-NEXT.
 18896
 18897     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 18898     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18899     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18900     MOVE PB-STATE               TO PI-PB-STATE.
 18901     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18902
 18903     IF PB-BATCH-TRAILER
 18904        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 18905        GO TO 4305-READ-NEXT.
 18906
 18907     IF SHOW-RECORD
 18908           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18909              GO TO 4310-BUMP-SEQ
 18910           ELSE
 18911              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18912                 GO TO 4310-BUMP-SEQ
 18913              ELSE
 18914                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 351
* EL6311.cbl
 18915
 18916     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18917        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18918           GO TO 4310-BUMP-SEQ
 18919        ELSE
 18920           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18921              GO TO 4307-CHECK-REC-TYPE
 18922           ELSE
 18923              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18924                 GO TO 4307-CHECK-REC-TYPE
 18925              ELSE
 18926                 GO TO 4310-BUMP-SEQ.
 18927
 18928     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18929        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18930           GO TO 4310-BUMP-SEQ.
 18931
 18932 4307-CHECK-REC-TYPE.
 18933     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18934         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18935             NEXT SENTENCE
 18936         ELSE
 18937             GO TO 4310-BUMP-SEQ.
 18938
 18939     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18940         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18941             NEXT SENTENCE
 18942        ELSE
 18943             GO TO 4310-BUMP-SEQ.
 18944
 18945     IF NOT DISPLAY-CHANGE-RECORDS AND
 18946            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18947        GO TO 4310-BUMP-SEQ.
 18948
 18949     IF DISPLAY-HOLD-RECORDS AND
 18950        NOT PB-RECORD-ON-HOLD
 18951          GO TO 4310-BUMP-SEQ.
 18952
 18953     IF PB-ISSUE
 18954        IF DISPLAY-CHK-REQ-RECORDS
 18955           GO TO 4310-BUMP-SEQ.
 18956
 18957     IF PB-ISSUE
 18958        IF ISSUE-WITH-WARNING
 18959           IF PB-WARNING-ERRORS
 18960              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18961                  GO TO 4310-BUMP-SEQ
 18962              ELSE
 18963                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18964                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18965                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18966                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18967                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18968                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18969                 GO TO 7000-DISPLAY-ISSUES
 18970           ELSE
 18971              GO TO 4310-BUMP-SEQ.
 18972
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 352
* EL6311.cbl
 18973     IF PB-ISSUE
 18974        IF (ISSUES-IN-ERROR AND
 18975            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18976            ALL-ISSUES
 18977            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18978            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18979            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18980            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18981            MOVE PB-SV-STATE            TO PI-SV-STATE
 18982            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18983            GO TO 7000-DISPLAY-ISSUES
 18984        ELSE
 18985            GO TO 4310-BUMP-SEQ.
 18986
 18987     IF PB-CANCELLATION
 18988        IF DISPLAY-CHK-REQ-RECORDS
 18989           IF PB-C-REFUND-REQUESTED
 18990              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18991              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18992              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18993              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18994              MOVE PB-SV-STATE            TO PI-SV-STATE
 18995              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18996              GO TO 7100-DISPLAY-CANCELS
 18997           ELSE
 18998              GO TO 4310-BUMP-SEQ.
 18999
 19000     IF PB-CANCELLATION
 19001        IF CANCEL-WITH-WARNING
 19002           IF PB-WARNING-ERRORS
 19003              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19004                  GO TO 4310-BUMP-SEQ
 19005              ELSE
 19006                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19007                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19008                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19009                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19010                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19011                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19012                 GO TO 7100-DISPLAY-CANCELS
 19013           ELSE
 19014              GO TO 4310-BUMP-SEQ.
 19015
 19016     IF PB-CANCELLATION
 19017        IF (CANCEL-IN-ERROR  AND
 19018            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19019            ALL-CANCELS
 19020            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19021            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19022            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19023            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19024            MOVE PB-SV-STATE            TO PI-SV-STATE
 19025            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19026            GO TO 7100-DISPLAY-CANCELS.
 19027
 19028 4310-BUMP-SEQ.
 19029     IF NOT DISPLAY-CHANGE-RECORDS
 19030        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 353
* EL6311.cbl
 19031        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19032     ELSE
 19033        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19034           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19035           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19036        ELSE
 19037           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19038           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19039
 19040     GO TO 4305-READ-NEXT.
 19041
 19042 4350-END-BATCH.
 19043
 19044******************************************************************
 19045*                                                                *
 19046*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19047*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19048*         PROGRAM.                                               *
 19049*                                                                *
 19050******************************************************************
 19051
 19052     IF  EIBTRNID NOT = TRANS-EXB1
 19053         IF PENDING-BUS-RECS-FOUND
 19054             NEXT SENTENCE
 19055           ELSE
 19056             MOVE '9'            TO PI-BROWSE-SW
 19057             GO TO 9400-CLEAR.
 19058
 19059     IF SHOW-RECORD
 19060        MOVE ER-2253            TO EMI-ERROR
 19061     ELSE
 19062        MOVE ER-2251            TO EMI-ERROR.
 19063
 19064     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19065
 19066     IF PI-MAP-NAME = SPACES
 19067        MOVE -1                  TO BMAINTL
 19068        MOVE EL631B               TO PI-MAP-NAME
 19069        GO TO 8100-SEND-INITIAL-MAP.
 19070
 19071     IF PI-MAP-NAME = EL631B
 19072        MOVE -1                  TO BMAINTL
 19073     ELSE
 19074        IF PI-MAP-NAME = EL631C
 19075           MOVE -1               TO CMAINTL
 19076        ELSE
 19077           MOVE -1               TO DPFENTRL.
 19078
 19079     GO TO 8200-SEND-DATAONLY.
 19080
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 354
* EL6311.cbl
 19082
 19083******************************************************************
 19084*                                                                *
 19085*        B R O W S E   D E T A I L   B A C K W A R D             *
 19086*                                                                *
 19087******************************************************************
 19088
 19089 4500-BROWSE-DETAIL-BACKWARD.
 19090
 19091     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19092
 19093
 19094* EXEC CICS HANDLE CONDITION
 19095*         NOTFND   (4570-NOT-FOUND)
 19096*         ENDFILE  (4550-END-RECORDS)
 19097*    END-EXEC
 19098*    MOVE '"$I''                  ! N #00016294' TO DFHEIV0
 19099     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19100     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19101     MOVE X'4E20233030303136323934' TO DFHEIV0(25:11)
 19102     CALL 'kxdfhei1' USING DFHEIV0
 19103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19104
 19105
 19106* EXEC CICS STARTBR
 19107*         DATASET   (FILE-ID-ERPNDB2)
 19108*         RIDFLD    (ERPNDB-ALT-KEY)
 19109*    END-EXEC.
 19110     MOVE 0
 19111       TO DFHEIV11
 19112*    MOVE '&,         G          &   #00016299' TO DFHEIV0
 19113     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19114     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19115     MOVE X'2020233030303136323939' TO DFHEIV0(25:11)
 19116     CALL 'kxdfhei1' USING DFHEIV0,
 19117           FILE-ID-ERPNDB2,
 19118           ERPNDB-ALT-KEY,
 19119           DFHEIV99,
 19120           DFHEIV11,
 19121           DFHEIV99
 19122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19123
 19124
 19125     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19126                                    WS-FIRST-TIME-SW.
 19127
 19128 4505-READ-PREV-RECORD.
 19129
 19130* EXEC CICS READPREV
 19131*         DATASET    (FILE-ID-ERPNDB2)
 19132*         SET        (ADDRESS OF PENDING-BUSINESS)
 19133*         RIDFLD     (ERPNDB-ALT-KEY)
 19134*    END-EXEC.
 19135     MOVE 0
 19136       TO DFHEIV11
 19137*    MOVE '&0S                   )   #00016308' TO DFHEIV0
 19138     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19139     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 355
* EL6311.cbl
 19140     MOVE X'2020233030303136333038' TO DFHEIV0(25:11)
 19141     CALL 'kxdfhei1' USING DFHEIV0,
 19142           FILE-ID-ERPNDB2,
 19143           DFHEIV20,
 19144           DFHEIV99,
 19145           ERPNDB-ALT-KEY,
 19146           DFHEIV99,
 19147           DFHEIV11,
 19148           DFHEIV99,
 19149           DFHEIV99
 19150     SET ADDRESS OF PENDING-BUSINESS TO
 19151         DFHEIV20
 19152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19153
 19154
 19155     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19156
 19157     IF WS-BATCH-PREFIX = '#CL'
 19158         GO TO 4505-READ-PREV-RECORD.
 19159
 19160     IF FIRST-TIME
 19161         MOVE SPACE               TO WS-FIRST-TIME-SW
 19162         GO TO 4505-READ-PREV-RECORD.
 19163
 19164     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19165        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19166        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19167        PB-STATE         NOT = PI-PB-STATE    OR
 19168        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19169          GO TO 4550-END-RECORDS.
 19170
 19171
 19172     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19173
 19174     IF PB-BATCH-TRAILER
 19175        GO TO 4505-READ-PREV-RECORD.
 19176
 19177     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19178
 19179     IF  WS-BATCH-PREFIX = '#CL'
 19180         GO TO 4505-READ-PREV-RECORD.
 19181
 19182     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19183        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19184           GO TO 4505-READ-PREV-RECORD
 19185        ELSE
 19186           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19187              GO TO 4510-CHECK-REC-TYPE
 19188           ELSE
 19189              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19190                 GO TO 4510-CHECK-REC-TYPE
 19191              ELSE
 19192                 GO TO 4505-READ-PREV-RECORD.
 19193
 19194     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19195        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19196           GO TO 4505-READ-PREV-RECORD.
 19197
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 356
* EL6311.cbl
 19198 4510-CHECK-REC-TYPE.
 19199     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19200         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19201             NEXT SENTENCE
 19202         ELSE
 19203             GO TO 4505-READ-PREV-RECORD.
 19204
 19205     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19206         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19207             NEXT SENTENCE
 19208        ELSE
 19209             GO TO 4505-READ-PREV-RECORD.
 19210
 19211     IF NOT DISPLAY-CHANGE-RECORDS AND
 19212            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19213        GO TO 4505-READ-PREV-RECORD.
 19214
 19215     IF DISPLAY-HOLD-RECORDS AND
 19216        NOT PB-RECORD-ON-HOLD
 19217          GO TO 4505-READ-PREV-RECORD.
 19218
 19219     IF PB-ISSUE
 19220        IF DISPLAY-CHK-REQ-RECORDS
 19221           GO TO 4505-READ-PREV-RECORD.
 19222
 19223     IF PB-ISSUE
 19224        IF ISSUE-WITH-WARNING
 19225           IF PB-WARNING-ERRORS
 19226              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19227                  GO TO 4505-READ-PREV-RECORD
 19228              ELSE
 19229                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19230                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19231                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19232                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19233                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19234                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19235                 GO TO 7000-DISPLAY-ISSUES
 19236           ELSE
 19237              GO TO 4505-READ-PREV-RECORD.
 19238
 19239     IF PB-ISSUE
 19240        IF (ISSUES-IN-ERROR AND
 19241            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19242            ALL-ISSUES
 19243            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19244            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19245            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19246            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19247            MOVE PB-SV-STATE            TO PI-SV-STATE
 19248            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19249            GO TO 7000-DISPLAY-ISSUES
 19250        ELSE
 19251            GO TO 4505-READ-PREV-RECORD.
 19252
 19253     IF PB-CANCELLATION
 19254        IF DISPLAY-CHK-REQ-RECORDS
 19255           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 357
* EL6311.cbl
 19256              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19257              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19258              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19259              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19260              MOVE PB-SV-STATE            TO PI-SV-STATE
 19261              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19262              GO TO 7100-DISPLAY-CANCELS
 19263           ELSE
 19264              GO TO 4505-READ-PREV-RECORD.
 19265
 19266     IF PB-CANCELLATION
 19267        IF CANCEL-WITH-WARNING
 19268           IF PB-WARNING-ERRORS
 19269              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19270                  GO TO 4505-READ-PREV-RECORD
 19271              ELSE
 19272                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19273                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19274                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19275                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19276                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19277                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19278                 GO TO 7100-DISPLAY-CANCELS
 19279           ELSE
 19280              GO TO 4505-READ-PREV-RECORD.
 19281
 19282     IF PB-CANCELLATION
 19283        IF (CANCEL-IN-ERROR  AND
 19284            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19285            ALL-CANCELS
 19286            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19287            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19288            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19289            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19290            MOVE PB-SV-STATE            TO PI-SV-STATE
 19291            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19292            GO TO 7100-DISPLAY-CANCELS.
 19293
 19294     GO TO 4505-READ-PREV-RECORD.
 19295
 19296 4550-END-RECORDS.
 19297     IF PI-MAP-NAME = EL631B
 19298        MOVE -1                  TO BMAINTL
 19299     ELSE
 19300        IF PI-MAP-NAME = EL631C
 19301           MOVE -1               TO CMAINTL
 19302        ELSE
 19303           MOVE -1               TO DPFENTRL.
 19304
 19305     MOVE ER-2255               TO EMI-ERROR.
 19306     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19307     GO TO 8200-SEND-DATAONLY.
 19308
 19309 4570-NOT-FOUND.
 19310
 19311******************************************************************
 19312*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 19313******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 358
* EL6311.cbl
 19314
 19315
 19316* EXEC CICS RESETBR
 19317*         DATASET    (FILE-ID-ERPNDB2)
 19318*         RIDFLD     (ERPNDB-ALT-KEY)
 19319*    END-EXEC.
 19320     MOVE 0
 19321       TO DFHEIV11
 19322*    MOVE '&4         G          &   #00016474' TO DFHEIV0
 19323     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19324     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19325     MOVE X'2020233030303136343734' TO DFHEIV0(25:11)
 19326     CALL 'kxdfhei1' USING DFHEIV0,
 19327           FILE-ID-ERPNDB2,
 19328           ERPNDB-ALT-KEY,
 19329           DFHEIV99,
 19330           DFHEIV11,
 19331           DFHEIV99
 19332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19333
 19334
 19335
 19336* EXEC CICS READNEXT
 19337*         DATASET    (FILE-ID-ERPNDB2)
 19338*         SET        (ADDRESS OF PENDING-BUSINESS)
 19339*         RIDFLD     (ERPNDB-ALT-KEY)
 19340*    END-EXEC.
 19341     MOVE 0
 19342       TO DFHEIV11
 19343*    MOVE '&.S                   )   #00016479' TO DFHEIV0
 19344     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19345     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19346     MOVE X'2020233030303136343739' TO DFHEIV0(25:11)
 19347     CALL 'kxdfhei1' USING DFHEIV0,
 19348           FILE-ID-ERPNDB2,
 19349           DFHEIV20,
 19350           DFHEIV99,
 19351           ERPNDB-ALT-KEY,
 19352           DFHEIV99,
 19353           DFHEIV11,
 19354           DFHEIV99,
 19355           DFHEIV99
 19356     SET ADDRESS OF PENDING-BUSINESS TO
 19357         DFHEIV20
 19358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19359
 19360
 19361
 19362* EXEC CICS READPREV
 19363*         DATASET    (FILE-ID-ERPNDB2)
 19364*         SET        (ADDRESS OF PENDING-BUSINESS)
 19365*         RIDFLD     (ERPNDB-ALT-KEY)
 19366*    END-EXEC.
 19367     MOVE 0
 19368       TO DFHEIV11
 19369*    MOVE '&0S                   )   #00016485' TO DFHEIV0
 19370     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19371     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 359
* EL6311.cbl
 19372     MOVE X'2020233030303136343835' TO DFHEIV0(25:11)
 19373     CALL 'kxdfhei1' USING DFHEIV0,
 19374           FILE-ID-ERPNDB2,
 19375           DFHEIV20,
 19376           DFHEIV99,
 19377           ERPNDB-ALT-KEY,
 19378           DFHEIV99,
 19379           DFHEIV11,
 19380           DFHEIV99,
 19381           DFHEIV99
 19382     SET ADDRESS OF PENDING-BUSINESS TO
 19383         DFHEIV20
 19384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19385
 19386
 19387 4580-READ-PREV-RECORD.
 19388
 19389* EXEC CICS READPREV
 19390*         DATASET    (FILE-ID-ERPNDB2)
 19391*         SET        (ADDRESS OF PENDING-BUSINESS)
 19392*         RIDFLD     (ERPNDB-ALT-KEY)
 19393*    END-EXEC.
 19394     MOVE 0
 19395       TO DFHEIV11
 19396*    MOVE '&0S                   )   #00016492' TO DFHEIV0
 19397     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19398     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19399     MOVE X'2020233030303136343932' TO DFHEIV0(25:11)
 19400     CALL 'kxdfhei1' USING DFHEIV0,
 19401           FILE-ID-ERPNDB2,
 19402           DFHEIV20,
 19403           DFHEIV99,
 19404           ERPNDB-ALT-KEY,
 19405           DFHEIV99,
 19406           DFHEIV11,
 19407           DFHEIV99,
 19408           DFHEIV99
 19409     SET ADDRESS OF PENDING-BUSINESS TO
 19410         DFHEIV20
 19411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19412
 19413
 19414     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19415
 19416     IF WS-BATCH-PREFIX = '#CL'
 19417        GO TO 4580-READ-PREV-RECORD.
 19418
 19419     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 19420     GO TO 4505-READ-PREV-RECORD.
 19421
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 360
* EL6311.cbl
 19423
 19424******************************************************************
 19425*                                                                *
 19426*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 19427*                                                                *
 19428******************************************************************
 19429
 19430 4600-BROWSE-PRIMARY-BACKWARD.
 19431        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 19432
 19433     IF ERPNDB-BATCH-SEQ-NO = +9999
 19434        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 19435
 19436        IF ERPNDB-BATCH-SEQ-NO = +0000
 19437           GO TO 4650-END-BATCH
 19438        ELSE
 19439           IF PI-MAP-NAME NOT = EL631D
 19440              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19441                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 19442              ELSE
 19443                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 19444                 IF DISPLAY-CHANGE-RECORDS
 19445                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 19446                 ELSE
 19447                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19448
 19449
 19450* EXEC CICS HANDLE CONDITION
 19451*         NOTFND    (4680-NOT-FOUND)
 19452*         ENDFILE   (4680-NOT-FOUND)
 19453*    END-EXEC.
 19454*    MOVE '"$I''                  ! O #00016533' TO DFHEIV0
 19455     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19456     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19457     MOVE X'4F20233030303136353333' TO DFHEIV0(25:11)
 19458     CALL 'kxdfhei1' USING DFHEIV0
 19459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19460
 19461
 19462 4605-READ-NEXT.
 19463     IF ERPNDB-BATCH-SEQ-NO = +0000
 19464        GO TO 4650-END-BATCH.
 19465
 19466     IF PI-DISPLAY-ORIGINAL-BATCH
 19467        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19468     ELSE
 19469        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19470
 19471
 19472* EXEC CICS READ
 19473*         DATASET   (FILE-ID)
 19474*         SET       (ADDRESS OF PENDING-BUSINESS)
 19475*         RIDFLD    (ERPNDB-KEY)
 19476*    END-EXEC.
 19477*    MOVE '&"S        E          (   #00016547' TO DFHEIV0
 19478     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19479     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19480     MOVE X'2020233030303136353437' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 361
* EL6311.cbl
 19481     CALL 'kxdfhei1' USING DFHEIV0,
 19482           FILE-ID,
 19483           DFHEIV20,
 19484           DFHEIV99,
 19485           ERPNDB-KEY,
 19486           DFHEIV99,
 19487           DFHEIV99,
 19488           DFHEIV99
 19489     SET ADDRESS OF PENDING-BUSINESS TO
 19490         DFHEIV20
 19491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19492
 19493
 19494     IF NOT  PI-PRIMARY-WITH-SELECT
 19495        GO TO 4607-CHECK-REC-TYPE.
 19496
 19497     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19498
 19499     IF  WS-BATCH-PREFIX = '#CL'
 19500         GO TO 4610-BUMP-SEQ.
 19501
 19502     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19503        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19504           GO TO 4610-BUMP-SEQ
 19505        ELSE
 19506           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19507              GO TO 4607-CHECK-REC-TYPE
 19508           ELSE
 19509              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19510                 GO TO 4607-CHECK-REC-TYPE
 19511              ELSE
 19512                 GO TO 4610-BUMP-SEQ.
 19513
 19514     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19515        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19516           GO TO 4610-BUMP-SEQ.
 19517
 19518 4607-CHECK-REC-TYPE.
 19519     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19520         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19521             NEXT SENTENCE
 19522         ELSE
 19523             GO TO 4610-BUMP-SEQ.
 19524
 19525     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19526         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19527             NEXT SENTENCE
 19528        ELSE
 19529             GO TO 4610-BUMP-SEQ.
 19530
 19531     IF NOT DISPLAY-CHANGE-RECORDS AND
 19532            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19533        GO TO 4610-BUMP-SEQ.
 19534
 19535     IF DISPLAY-HOLD-RECORDS AND
 19536        NOT PB-RECORD-ON-HOLD
 19537          GO TO 4610-BUMP-SEQ.
 19538
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 362
* EL6311.cbl
 19539     IF PB-ISSUE
 19540        IF DISPLAY-CHK-REQ-RECORDS
 19541           GO TO 4610-BUMP-SEQ.
 19542
 19543     IF PB-ISSUE
 19544        IF ISSUE-WITH-WARNING
 19545           IF PB-WARNING-ERRORS
 19546              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19547                  GO TO 4610-BUMP-SEQ
 19548              ELSE
 19549                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19550                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19551                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19552                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19553                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19554                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19555                 GO TO 7000-DISPLAY-ISSUES
 19556           ELSE
 19557              GO TO 4610-BUMP-SEQ.
 19558
 19559     IF PB-ISSUE
 19560        IF (ISSUES-IN-ERROR AND
 19561            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19562            ALL-ISSUES
 19563            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19564            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19565            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19566            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19567            MOVE PB-SV-STATE            TO PI-SV-STATE
 19568            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19569            GO TO 7000-DISPLAY-ISSUES
 19570        ELSE
 19571            GO TO 4610-BUMP-SEQ.
 19572
 19573     IF PB-CANCELLATION
 19574        IF DISPLAY-CHK-REQ-RECORDS
 19575           IF PB-C-REFUND-REQUESTED
 19576              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19577              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19578              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19579              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19580              MOVE PB-SV-STATE            TO PI-SV-STATE
 19581              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19582              GO TO 7100-DISPLAY-CANCELS
 19583           ELSE
 19584              GO TO 4610-BUMP-SEQ.
 19585
 19586     IF PB-CANCELLATION
 19587        IF CANCEL-WITH-WARNING
 19588           IF PB-WARNING-ERRORS
 19589              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19590                  GO TO 4610-BUMP-SEQ
 19591              ELSE
 19592                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19593                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19594                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19595                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19596                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 363
* EL6311.cbl
 19597                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19598                 GO TO 7100-DISPLAY-CANCELS
 19599           ELSE
 19600              GO TO 4610-BUMP-SEQ.
 19601
 19602     IF PB-CANCELLATION
 19603        IF (CANCEL-IN-ERROR  AND
 19604            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19605            ALL-CANCELS
 19606            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19607            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19608            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19609            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19610            MOVE PB-SV-STATE            TO PI-SV-STATE
 19611            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19612            GO TO 7100-DISPLAY-CANCELS.
 19613
 19614 4610-BUMP-SEQ.
 19615     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 19616        GO TO 4650-END-BATCH.
 19617
 19618     IF DISPLAY-CHANGE-RECORDS
 19619        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19620           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 19621        ELSE
 19622           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 19623           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 19624        ELSE
 19625           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 19626           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 19627
 19628        GO TO 4605-READ-NEXT.
 19629
 19630 4650-END-BATCH.
 19631     IF PI-MAP-NAME = EL631B
 19632        MOVE -1                  TO BMAINTL
 19633     ELSE
 19634        IF PI-MAP-NAME = EL631C
 19635           MOVE -1               TO CMAINTL
 19636        ELSE
 19637           MOVE -1               TO DPFENTRL.
 19638
 19639     MOVE ER-2252               TO EMI-ERROR.
 19640     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19641     GO TO 8200-SEND-DATAONLY.
 19642
 19643 4680-NOT-FOUND.
 19644     IF DISPLAY-CHANGE-RECORDS
 19645        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19646           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 19647        ELSE
 19648           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 19649           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 19650     ELSE
 19651        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 19652
 19653     GO TO 4605-READ-NEXT.
 19654
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 364
* EL6311.cbl
 19656
 19657******************************************************************
 19658*                                                                *
 19659*        B R O W S E   F I L E   B A C K W A R D S               *
 19660*                                                                *
 19661******************************************************************
 19662
 19663 4800-BROWSE-FILE-BACKWARD.
 19664
 19665* EXEC CICS HANDLE CONDITION
 19666*         NOTFND   (4860-NOT-FOUND)
 19667*         ENDFILE  (4850-END-RECORDS)
 19668*    END-EXEC.
 19669*    MOVE '"$I''                  ! P #00016723' TO DFHEIV0
 19670     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19671     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19672     MOVE X'5020233030303136373233' TO DFHEIV0(25:11)
 19673     CALL 'kxdfhei1' USING DFHEIV0
 19674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19675
 19676
 19677     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 19678
 19679     IF PI-DISPLAY-ORIGINAL-BATCH
 19680        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19681     ELSE
 19682        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19683
 19684
 19685* EXEC CICS STARTBR
 19686*         DATASET   (FILE-ID)
 19687*         RIDFLD    (ERPNDB-KEY)
 19688*    END-EXEC.
 19689     MOVE 0
 19690       TO DFHEIV11
 19691*    MOVE '&,         G          &   #00016735' TO DFHEIV0
 19692     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19693     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19694     MOVE X'2020233030303136373335' TO DFHEIV0(25:11)
 19695     CALL 'kxdfhei1' USING DFHEIV0,
 19696           FILE-ID,
 19697           ERPNDB-KEY,
 19698           DFHEIV99,
 19699           DFHEIV11,
 19700           DFHEIV99
 19701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19702
 19703
 19704     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19705
 19706
 19707* EXEC CICS READPREV
 19708*         DATASET    (FILE-ID-ERPNDB)
 19709*         SET        (ADDRESS OF PENDING-BUSINESS)
 19710*         RIDFLD     (ERPNDB-KEY)
 19711*    END-EXEC.
 19712     MOVE 0
 19713       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 365
* EL6311.cbl
 19714*    MOVE '&0S                   )   #00016742' TO DFHEIV0
 19715     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19716     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19717     MOVE X'2020233030303136373432' TO DFHEIV0(25:11)
 19718     CALL 'kxdfhei1' USING DFHEIV0,
 19719           FILE-ID-ERPNDB,
 19720           DFHEIV20,
 19721           DFHEIV99,
 19722           ERPNDB-KEY,
 19723           DFHEIV99,
 19724           DFHEIV11,
 19725           DFHEIV99,
 19726           DFHEIV99
 19727     SET ADDRESS OF PENDING-BUSINESS TO
 19728         DFHEIV20
 19729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19730
 19731
 19732 4810-READ-PREV-RECORD.
 19733
 19734* EXEC CICS READPREV
 19735*         DATASET    (FILE-ID-ERPNDB)
 19736*         SET        (ADDRESS OF PENDING-BUSINESS)
 19737*         RIDFLD     (ERPNDB-KEY)
 19738*    END-EXEC.
 19739     MOVE 0
 19740       TO DFHEIV11
 19741*    MOVE '&0S                   )   #00016749' TO DFHEIV0
 19742     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19743     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19744     MOVE X'2020233030303136373439' TO DFHEIV0(25:11)
 19745     CALL 'kxdfhei1' USING DFHEIV0,
 19746           FILE-ID-ERPNDB,
 19747           DFHEIV20,
 19748           DFHEIV99,
 19749           ERPNDB-KEY,
 19750           DFHEIV99,
 19751           DFHEIV11,
 19752           DFHEIV99,
 19753           DFHEIV99
 19754     SET ADDRESS OF PENDING-BUSINESS TO
 19755         DFHEIV20
 19756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19757
 19758
 19759     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 19760        GO TO 4850-END-RECORDS.
 19761
 19762     IF PB-BATCH-TRAILER
 19763        GO TO 4810-READ-PREV-RECORD.
 19764
 19765     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19766
 19767     IF  WS-BATCH-PREFIX = '#CL'
 19768         GO TO 4810-READ-PREV-RECORD.
 19769
 19770     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19771        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 366
* EL6311.cbl
 19772           GO TO 4810-READ-PREV-RECORD
 19773        ELSE
 19774           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19775              GO TO 4820-CHECK-REC-TYPE
 19776           ELSE
 19777              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19778                 GO TO 4820-CHECK-REC-TYPE
 19779              ELSE
 19780                 GO TO 4810-READ-PREV-RECORD.
 19781
 19782     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19783        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19784           GO TO 4810-READ-PREV-RECORD.
 19785
 19786 4820-CHECK-REC-TYPE.
 19787     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19788         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19789             NEXT SENTENCE
 19790         ELSE
 19791             GO TO 4810-READ-PREV-RECORD.
 19792
 19793     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19794         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19795             NEXT SENTENCE
 19796        ELSE
 19797             GO TO 4810-READ-PREV-RECORD.
 19798
 19799     IF NOT DISPLAY-CHANGE-RECORDS AND
 19800            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19801        GO TO 4810-READ-PREV-RECORD.
 19802
 19803     IF DISPLAY-HOLD-RECORDS AND
 19804        NOT PB-RECORD-ON-HOLD
 19805          GO TO 4810-READ-PREV-RECORD.
 19806
 19807     IF PB-ISSUE
 19808        IF DISPLAY-CHK-REQ-RECORDS
 19809           GO TO 4810-READ-PREV-RECORD.
 19810
 19811     IF PB-ISSUE
 19812        IF ISSUE-WITH-WARNING
 19813           IF PB-WARNING-ERRORS
 19814              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19815                  GO TO 4810-READ-PREV-RECORD
 19816              ELSE
 19817                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19818                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19819                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19820                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19821                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19822                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19823                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19824                 GO TO 7000-DISPLAY-ISSUES
 19825           ELSE
 19826              GO TO 4810-READ-PREV-RECORD.
 19827
 19828     IF PB-ISSUE
 19829        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 367
* EL6311.cbl
 19830            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19831            ALL-ISSUES
 19832            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19833            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19834            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19835            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19836            MOVE PB-SV-STATE            TO PI-SV-STATE
 19837            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19838            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19839            GO TO 7000-DISPLAY-ISSUES
 19840        ELSE
 19841            GO TO 4810-READ-PREV-RECORD.
 19842
 19843     IF PB-CANCELLATION
 19844        IF DISPLAY-CHK-REQ-RECORDS
 19845           IF PB-C-REFUND-REQUESTED
 19846              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19847              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19848              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19849              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19850              MOVE PB-SV-STATE            TO PI-SV-STATE
 19851              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19852              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19853              GO TO 7100-DISPLAY-CANCELS
 19854           ELSE
 19855              GO TO 4810-READ-PREV-RECORD.
 19856
 19857     IF PB-CANCELLATION
 19858        IF CANCEL-WITH-WARNING
 19859           IF PB-WARNING-ERRORS
 19860              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19861                  GO TO 4810-READ-PREV-RECORD
 19862              ELSE
 19863                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19864                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19865                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19866                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19867                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19868                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19869                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19870                 GO TO 7100-DISPLAY-CANCELS
 19871           ELSE
 19872              GO TO 4810-READ-PREV-RECORD.
 19873
 19874     IF PB-CANCELLATION
 19875        IF (CANCEL-IN-ERROR  AND
 19876            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19877            ALL-CANCELS
 19878            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19879            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19880            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19881            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19882            MOVE PB-SV-STATE            TO PI-SV-STATE
 19883            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19884            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19885            GO TO 7100-DISPLAY-CANCELS.
 19886
 19887     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 368
* EL6311.cbl
 19888
 19889 4850-END-RECORDS.
 19890     MOVE ER-2252                TO EMI-ERROR.
 19891     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19892
 19893     IF PI-MAP-NAME = EL631B
 19894        MOVE -1                  TO BPFENTRL
 19895     ELSE
 19896        MOVE -1                  TO CPFENTRL.
 19897
 19898     GO TO 8200-SEND-DATAONLY.
 19899
 19900 4860-NOT-FOUND.
 19901
 19902******************************************************************
 19903*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 19904******************************************************************
 19905
 19906
 19907* EXEC CICS RESETBR
 19908*         DATASET    (FILE-ID-ERPNDB)
 19909*         RIDFLD     (ERPNDB-KEY)
 19910*     END-EXEC.
 19911     MOVE 0
 19912       TO DFHEIV11
 19913*    MOVE '&4         G          &   #00016902' TO DFHEIV0
 19914     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19915     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19916     MOVE X'2020233030303136393032' TO DFHEIV0(25:11)
 19917     CALL 'kxdfhei1' USING DFHEIV0,
 19918           FILE-ID-ERPNDB,
 19919           ERPNDB-KEY,
 19920           DFHEIV99,
 19921           DFHEIV11,
 19922           DFHEIV99
 19923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19924
 19925
 19926
 19927* EXEC CICS READNEXT
 19928*         DATASET    (FILE-ID-ERPNDB)
 19929*         SET        (ADDRESS OF PENDING-BUSINESS)
 19930*         RIDFLD     (ERPNDB-KEY)
 19931*    END-EXEC.
 19932     MOVE 0
 19933       TO DFHEIV11
 19934*    MOVE '&.S                   )   #00016907' TO DFHEIV0
 19935     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19936     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19937     MOVE X'2020233030303136393037' TO DFHEIV0(25:11)
 19938     CALL 'kxdfhei1' USING DFHEIV0,
 19939           FILE-ID-ERPNDB,
 19940           DFHEIV20,
 19941           DFHEIV99,
 19942           ERPNDB-KEY,
 19943           DFHEIV99,
 19944           DFHEIV11,
 19945           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 369
* EL6311.cbl
 19946           DFHEIV99
 19947     SET ADDRESS OF PENDING-BUSINESS TO
 19948         DFHEIV20
 19949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19950
 19951
 19952
 19953* EXEC CICS READPREV
 19954*         DATASET    (FILE-ID-ERPNDB)
 19955*         SET        (ADDRESS OF PENDING-BUSINESS)
 19956*         RIDFLD     (ERPNDB-KEY)
 19957*    END-EXEC.
 19958     MOVE 0
 19959       TO DFHEIV11
 19960*    MOVE '&0S                   )   #00016913' TO DFHEIV0
 19961     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19962     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19963     MOVE X'2020233030303136393133' TO DFHEIV0(25:11)
 19964     CALL 'kxdfhei1' USING DFHEIV0,
 19965           FILE-ID-ERPNDB,
 19966           DFHEIV20,
 19967           DFHEIV99,
 19968           ERPNDB-KEY,
 19969           DFHEIV99,
 19970           DFHEIV11,
 19971           DFHEIV99,
 19972           DFHEIV99
 19973     SET ADDRESS OF PENDING-BUSINESS TO
 19974         DFHEIV20
 19975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19976
 19977
 19978     GO TO 4810-READ-PREV-RECORD.
 19979
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 370
* EL6311.cbl
 19981
 19982******************************************************************
 19983*                                                                *
 19984*           B R O W S E   C S R   B A C K W A R D                *
 19985*                                                                *
 19986******************************************************************
 19987
 19988 4900-BROWSE-CSR-BACKWARD.
 19989
 19990     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19991
 19992
 19993* EXEC CICS HANDLE CONDITION
 19994*         NOTFND   (4970-NOT-FOUND)
 19995*         ENDFILE  (4950-END-RECORDS)
 19996*    END-EXEC
 19997*    MOVE '"$I''                  ! Q #00016933' TO DFHEIV0
 19998     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19999     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20000     MOVE X'5120233030303136393333' TO DFHEIV0(25:11)
 20001     CALL 'kxdfhei1' USING DFHEIV0
 20002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20003
 20004
 20005* EXEC CICS STARTBR
 20006*         DATASET   (FILE-ID-ERPNDB4)
 20007*         RIDFLD    (ERPNDB-CSR-KEY)
 20008*    END-EXEC.
 20009     MOVE 0
 20010       TO DFHEIV11
 20011*    MOVE '&,         G          &   #00016938' TO DFHEIV0
 20012     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20013     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20014     MOVE X'2020233030303136393338' TO DFHEIV0(25:11)
 20015     CALL 'kxdfhei1' USING DFHEIV0,
 20016           FILE-ID-ERPNDB4,
 20017           ERPNDB-CSR-KEY,
 20018           DFHEIV99,
 20019           DFHEIV11,
 20020           DFHEIV99
 20021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20022
 20023
 20024     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20025                                    WS-FIRST-TIME-SW.
 20026
 20027 4905-READ-PREV-RECORD.
 20028
 20029* EXEC CICS READPREV
 20030*         DATASET    (FILE-ID-ERPNDB4)
 20031*         SET        (ADDRESS OF PENDING-BUSINESS)
 20032*         RIDFLD     (ERPNDB-CSR-KEY)
 20033*    END-EXEC.
 20034     MOVE 0
 20035       TO DFHEIV11
 20036*    MOVE '&0S                   )   #00016947' TO DFHEIV0
 20037     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20038     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 371
* EL6311.cbl
 20039     MOVE X'2020233030303136393437' TO DFHEIV0(25:11)
 20040     CALL 'kxdfhei1' USING DFHEIV0,
 20041           FILE-ID-ERPNDB4,
 20042           DFHEIV20,
 20043           DFHEIV99,
 20044           ERPNDB-CSR-KEY,
 20045           DFHEIV99,
 20046           DFHEIV11,
 20047           DFHEIV99,
 20048           DFHEIV99
 20049     SET ADDRESS OF PENDING-BUSINESS TO
 20050         DFHEIV20
 20051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20052
 20053
 20054     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20055
 20056     IF WS-BATCH-PREFIX = '#CL'
 20057         GO TO 4905-READ-PREV-RECORD.
 20058
 20059     IF FIRST-TIME
 20060         MOVE SPACE               TO WS-FIRST-TIME-SW
 20061         GO TO 4905-READ-PREV-RECORD.
 20062
 20063     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20064        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20065        GO TO 4950-END-RECORDS.
 20066
 20067     IF PB-BATCH-TRAILER
 20068        GO TO 4905-READ-PREV-RECORD.
 20069
 20070     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20071
 20072     IF  WS-BATCH-PREFIX = '#CL'
 20073         GO TO 4905-READ-PREV-RECORD.
 20074
 20075     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20076        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20077           GO TO 4905-READ-PREV-RECORD
 20078        ELSE
 20079           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20080              GO TO 4910-CHECK-REC-TYPE
 20081           ELSE
 20082              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20083                 GO TO 4910-CHECK-REC-TYPE
 20084              ELSE
 20085                 GO TO 4905-READ-PREV-RECORD.
 20086
 20087     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20088        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20089           GO TO 4905-READ-PREV-RECORD.
 20090
 20091 4910-CHECK-REC-TYPE.
 20092     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20093         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20094             NEXT SENTENCE
 20095         ELSE
 20096             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 372
* EL6311.cbl
 20097
 20098     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20099         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20100             NEXT SENTENCE
 20101        ELSE
 20102             GO TO 4905-READ-PREV-RECORD.
 20103
 20104     IF NOT DISPLAY-CHANGE-RECORDS AND
 20105            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20106        GO TO 4905-READ-PREV-RECORD.
 20107
 20108     IF DISPLAY-HOLD-RECORDS AND
 20109        NOT PB-RECORD-ON-HOLD
 20110          GO TO 4905-READ-PREV-RECORD.
 20111
 20112     IF PB-ISSUE
 20113        IF DISPLAY-CHK-REQ-RECORDS
 20114           GO TO 4905-READ-PREV-RECORD.
 20115
 20116     IF PB-ISSUE
 20117        IF ISSUE-WITH-WARNING
 20118           IF PB-WARNING-ERRORS
 20119              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20120                  GO TO 4505-READ-PREV-RECORD
 20121              ELSE
 20122                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20123                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20124                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20125                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20126                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20127                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20128                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20129                 GO TO 7000-DISPLAY-ISSUES
 20130           ELSE
 20131              GO TO 4905-READ-PREV-RECORD.
 20132
 20133     IF PB-ISSUE
 20134        IF (ISSUES-IN-ERROR AND
 20135            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20136            ALL-ISSUES
 20137            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20138            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20139            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20140            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20141            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20142            MOVE PB-SV-STATE            TO PI-SV-STATE
 20143            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20144            GO TO 7000-DISPLAY-ISSUES
 20145        ELSE
 20146            GO TO 4905-READ-PREV-RECORD.
 20147
 20148     IF PB-CANCELLATION
 20149        IF DISPLAY-CHK-REQ-RECORDS
 20150           IF PB-C-REFUND-REQUESTED
 20151              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20152              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20153              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20154              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 373
* EL6311.cbl
 20155              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20156              MOVE PB-SV-STATE            TO PI-SV-STATE
 20157              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20158              GO TO 7100-DISPLAY-CANCELS
 20159           ELSE
 20160              GO TO 4905-READ-PREV-RECORD.
 20161
 20162     IF PB-CANCELLATION
 20163        IF CANCEL-WITH-WARNING
 20164           IF PB-WARNING-ERRORS
 20165              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20166                  GO TO 4505-READ-PREV-RECORD
 20167              ELSE
 20168                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20169                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20170                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20171                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20172                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20173                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20174                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20175                 GO TO 7100-DISPLAY-CANCELS
 20176           ELSE
 20177              GO TO 4905-READ-PREV-RECORD.
 20178
 20179     IF PB-CANCELLATION
 20180        IF (CANCEL-IN-ERROR  AND
 20181            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20182            ALL-CANCELS
 20183            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20184            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20185            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20186            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20187            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20188            MOVE PB-SV-STATE            TO PI-SV-STATE
 20189            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20190            GO TO 7100-DISPLAY-CANCELS.
 20191
 20192     GO TO 4905-READ-PREV-RECORD.
 20193
 20194 4950-END-RECORDS.
 20195     IF PI-MAP-NAME = EL631B
 20196        MOVE -1                  TO BMAINTL
 20197     ELSE
 20198        IF PI-MAP-NAME = EL631C
 20199           MOVE -1               TO CMAINTL
 20200        ELSE
 20201           MOVE -1               TO DPFENTRL.
 20202
 20203     MOVE ER-2255               TO EMI-ERROR.
 20204     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20205     GO TO 8200-SEND-DATAONLY.
 20206
 20207 4970-NOT-FOUND.
 20208
 20209******************************************************************
 20210*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20211******************************************************************
 20212
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 374
* EL6311.cbl
 20213
 20214* EXEC CICS RESETBR
 20215*         DATASET    (FILE-ID-ERPNDB4)
 20216*         RIDFLD     (ERPNDB-CSR-KEY)
 20217*    END-EXEC.
 20218     MOVE 0
 20219       TO DFHEIV11
 20220*    MOVE '&4         G          &   #00017112' TO DFHEIV0
 20221     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20222     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20223     MOVE X'2020233030303137313132' TO DFHEIV0(25:11)
 20224     CALL 'kxdfhei1' USING DFHEIV0,
 20225           FILE-ID-ERPNDB4,
 20226           ERPNDB-CSR-KEY,
 20227           DFHEIV99,
 20228           DFHEIV11,
 20229           DFHEIV99
 20230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20231
 20232
 20233
 20234* EXEC CICS READNEXT
 20235*         DATASET    (FILE-ID-ERPNDB4)
 20236*         SET        (ADDRESS OF PENDING-BUSINESS)
 20237*         RIDFLD     (ERPNDB-CSR-KEY)
 20238*    END-EXEC.
 20239     MOVE 0
 20240       TO DFHEIV11
 20241*    MOVE '&.S                   )   #00017117' TO DFHEIV0
 20242     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20243     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20244     MOVE X'2020233030303137313137' TO DFHEIV0(25:11)
 20245     CALL 'kxdfhei1' USING DFHEIV0,
 20246           FILE-ID-ERPNDB4,
 20247           DFHEIV20,
 20248           DFHEIV99,
 20249           ERPNDB-CSR-KEY,
 20250           DFHEIV99,
 20251           DFHEIV11,
 20252           DFHEIV99,
 20253           DFHEIV99
 20254     SET ADDRESS OF PENDING-BUSINESS TO
 20255         DFHEIV20
 20256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20257
 20258
 20259
 20260* EXEC CICS READPREV
 20261*         DATASET    (FILE-ID-ERPNDB4)
 20262*         SET        (ADDRESS OF PENDING-BUSINESS)
 20263*         RIDFLD     (ERPNDB-CSR-KEY)
 20264*    END-EXEC.
 20265     MOVE 0
 20266       TO DFHEIV11
 20267*    MOVE '&0S                   )   #00017123' TO DFHEIV0
 20268     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20269     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20270     MOVE X'2020233030303137313233' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 375
* EL6311.cbl
 20271     CALL 'kxdfhei1' USING DFHEIV0,
 20272           FILE-ID-ERPNDB4,
 20273           DFHEIV20,
 20274           DFHEIV99,
 20275           ERPNDB-CSR-KEY,
 20276           DFHEIV99,
 20277           DFHEIV11,
 20278           DFHEIV99,
 20279           DFHEIV99
 20280     SET ADDRESS OF PENDING-BUSINESS TO
 20281         DFHEIV20
 20282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20283
 20284
 20285 4980-READ-PREV-RECORD.
 20286
 20287* EXEC CICS READPREV
 20288*         DATASET    (FILE-ID-ERPNDB4)
 20289*         SET        (ADDRESS OF PENDING-BUSINESS)
 20290*         RIDFLD     (ERPNDB-CSR-KEY)
 20291*    END-EXEC.
 20292     MOVE 0
 20293       TO DFHEIV11
 20294*    MOVE '&0S                   )   #00017130' TO DFHEIV0
 20295     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20296     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20297     MOVE X'2020233030303137313330' TO DFHEIV0(25:11)
 20298     CALL 'kxdfhei1' USING DFHEIV0,
 20299           FILE-ID-ERPNDB4,
 20300           DFHEIV20,
 20301           DFHEIV99,
 20302           ERPNDB-CSR-KEY,
 20303           DFHEIV99,
 20304           DFHEIV11,
 20305           DFHEIV99,
 20306           DFHEIV99
 20307     SET ADDRESS OF PENDING-BUSINESS TO
 20308         DFHEIV20
 20309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20310
 20311
 20312     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20313
 20314     IF WS-BATCH-PREFIX = '#CL'
 20315        GO TO 4980-READ-PREV-RECORD.
 20316
 20317     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20318     GO TO 4905-READ-PREV-RECORD.
 20319
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 376
* EL6311.cbl
 20321
 20322
 20323******************************************************************
 20324*                                                                *
 20325*        B R O W S E   B A T C H   H E A D E R S                 *
 20326*                                                                *
 20327******************************************************************
 20328
 20329 5000-BROWSE-BATCH-HEADERS.
 20330
 20331     IF EIBTRNID NOT = TRANS-EXB1
 20332        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 20333        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20334        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20335        GO TO 5010-READ-NEXT-RECORD.
 20336
 20337     IF EIBAID = DFHPF4
 20338        MOVE '0'                TO PI-EDIT-SW
 20339        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 20340        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20341        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20342        GO TO 5010-READ-NEXT-RECORD.
 20343
 20344     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20345     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 20346     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20347
 20348
 20349* EXEC CICS HANDLE CONDITION
 20350*         ENDFILE  (5050-NOT-FOUND)
 20351*    END-EXEC.
 20352*    MOVE '"$''                   ! R #00017172' TO DFHEIV0
 20353     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 20354     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20355     MOVE X'5220233030303137313732' TO DFHEIV0(25:11)
 20356     CALL 'kxdfhei1' USING DFHEIV0
 20357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20358
 20359
 20360 5010-READ-NEXT-RECORD.
 20361
 20362* EXEC CICS HANDLE CONDITION
 20363*         NOTFND    (5050-NOT-FOUND)
 20364*    END-EXEC.
 20365*    MOVE '"$I                   ! S #00017177' TO DFHEIV0
 20366     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20367     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20368     MOVE X'5320233030303137313737' TO DFHEIV0(25:11)
 20369     CALL 'kxdfhei1' USING DFHEIV0
 20370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20371
 20372
 20373
 20374* EXEC CICS READ
 20375*         DATASET   (FILE-ID-ERPNDB)
 20376*         SET       (ADDRESS OF PENDING-BUSINESS)
 20377*         RIDFLD    (ERPNDB-KEY)
 20378*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 377
* EL6311.cbl
 20379*    END-EXEC.
 20380*    MOVE '&"S        G          (   #00017181' TO DFHEIV0
 20381     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20382     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20383     MOVE X'2020233030303137313831' TO DFHEIV0(25:11)
 20384     CALL 'kxdfhei1' USING DFHEIV0,
 20385           FILE-ID-ERPNDB,
 20386           DFHEIV20,
 20387           DFHEIV99,
 20388           ERPNDB-KEY,
 20389           DFHEIV99,
 20390           DFHEIV99,
 20391           DFHEIV99
 20392     SET ADDRESS OF PENDING-BUSINESS TO
 20393         DFHEIV20
 20394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20395
 20396
 20397     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 20398         GO TO 5050-NOT-FOUND.
 20399
 20400     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20401
 20402     IF WS-BATCH-PREFIX = '#CL'
 20403         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20404         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 20405         GO TO 5010-READ-NEXT-RECORD.
 20406
 20407     IF NOT PB-BATCH-TRAILER
 20408         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20409         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 20410         GO TO 5010-READ-NEXT-RECORD.
 20411
 20412     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20413         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20414             NEXT SENTENCE
 20415         ELSE
 20416             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 20417             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20418             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20419             GO TO 5010-READ-NEXT-RECORD.
 20420
 20421     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20422         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20423             NEXT SENTENCE
 20424        ELSE
 20425             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20426             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20427             GO TO 5010-READ-NEXT-RECORD.
 20428
 20429     IF EIBAID = DFHPF4
 20430        MOVE '0'                TO PI-EDIT-SW
 20431        GO TO 7200-DISPLAY-BATCHES.
 20432
 20433     IF PI-CSR-BROWSE
 20434        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20435           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20436           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 378
* EL6311.cbl
 20437           GO TO 5010-READ-NEXT-RECORD.
 20438
 20439     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20440       IF PI-PB-CARRIER    = SPACES AND
 20441          PI-PB-GROUPING   = SPACES AND
 20442          PI-PB-STATE      = SPACES AND
 20443          PI-PB-ACCOUNT    = SPACES
 20444            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20445            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20446            GO TO 7200-DISPLAY-BATCHES
 20447         ELSE
 20448           IF PI-PB-CARRIER    = PB-CARRIER  AND
 20449              PI-PB-GROUPING   = PB-GROUPING AND
 20450              PI-PB-STATE      = PB-STATE    AND
 20451              PI-PB-ACCOUNT    = PB-ACCOUNT
 20452              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 20453              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20454              GO TO 7200-DISPLAY-BATCHES.
 20455
 20456     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 20457     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 20458
 20459
 20460* EXEC CICS HANDLE CONDITION
 20461*         NOTFND    (5050-NOT-FOUND)
 20462*    END-EXEC.
 20463*    MOVE '"$I                   ! T #00017250' TO DFHEIV0
 20464     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20465     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20466     MOVE X'5420233030303137323530' TO DFHEIV0(25:11)
 20467     CALL 'kxdfhei1' USING DFHEIV0
 20468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20469
 20470
 20471
 20472* EXEC CICS READ
 20473*         DATASET   (FILE-ID-ERPNDB)
 20474*         SET       (ADDRESS OF PENDING-BUSINESS)
 20475*         RIDFLD    (ERPNDB-KEY)
 20476*         GTEQ
 20477*    END-EXEC.
 20478*    MOVE '&"S        G          (   #00017254' TO DFHEIV0
 20479     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20480     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20481     MOVE X'2020233030303137323534' TO DFHEIV0(25:11)
 20482     CALL 'kxdfhei1' USING DFHEIV0,
 20483           FILE-ID-ERPNDB,
 20484           DFHEIV20,
 20485           DFHEIV99,
 20486           ERPNDB-KEY,
 20487           DFHEIV99,
 20488           DFHEIV99,
 20489           DFHEIV99
 20490     SET ADDRESS OF PENDING-BUSINESS TO
 20491         DFHEIV20
 20492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20493
 20494
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 379
* EL6311.cbl
 20495     GO TO 5010-READ-NEXT-RECORD.
 20496
 20497 5050-NOT-FOUND.
 20498
 20499******************************************************************
 20500*                                                                *
 20501*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 20502*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 20503*         PROGRAM.                                               *
 20504*                                                                *
 20505******************************************************************
 20506
 20507     IF EIBTRNID NOT = TRANS-EXB1
 20508        IF PENDING-BUS-RECS-FOUND
 20509            NEXT SENTENCE
 20510          ELSE
 20511            MOVE '9'            TO PI-BROWSE-SW
 20512            GO TO 9400-CLEAR.
 20513
 20514     MOVE ER-2256                TO EMI-ERROR.
 20515     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20516
 20517     IF PI-MAP-NAME = SPACES
 20518        MOVE EL631D              TO PI-MAP-NAME
 20519        MOVE -1                  TO DPFENTRL
 20520        GO TO 8100-SEND-INITIAL-MAP.
 20521
 20522     IF PI-MAP-NAME = EL631B
 20523        MOVE -1                  TO BMAINTL
 20524     ELSE
 20525        IF PI-MAP-NAME = EL631C
 20526           MOVE -1               TO CMAINTL
 20527        ELSE
 20528           MOVE -1               TO DPFENTRL
 20529           GO TO 8200-SEND-DATAONLY.
 20530
 20531     GO TO 8100-SEND-INITIAL-MAP.
 20532
 20533     .
 20534 5100-PROCESS-POL-RESC.
 20535     MOVE ZEROS                  TO CG-LF-BENCD
 20536                                    CG-AH-BENCD
 20537                                    CG-LF-CAN-AMT
 20538                                    CG-AH-CAN-AMT
 20539     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 20540                                    CG-AH-CAN-DT
 20541     MOVE SPACES                 TO CG-BATCH-NO
 20542     MOVE '4'                    TO CG-OPTION-CODE
 20543     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 20544     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 20545     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 20546     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 20547     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 20548     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 20549     MOVE PI-SV-STATE            TO CG-CERT-STATE
 20550     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 20551     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 20552     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 380
* EL6311.cbl
 20553     MOVE PI-PREV-ALT-KEY (1:33)
 20554                                 TO CG-CERT-KEY
 20555     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 20556     MOVE ZEROS                  TO CG-LF-CAN-AMT
 20557                                    CG-AH-CAN-AMT
 20558     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 20559                                    CG-AH-CAN-DT
 20560     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 20561     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 20562      display 'about to cancel ' cg-cert-key
 20563
 20564* EXEC CICS LINK
 20565*        PROGRAM  ('ELCANC')
 20566*        COMMAREA (CANCEL-GEN-PASS-AREA)
 20567*    END-EXEC
 20568     MOVE LENGTH OF
 20569      CANCEL-GEN-PASS-AREA
 20570       TO DFHEIV11
 20571     MOVE 'ELCANC' TO DFHEIV1
 20572*    MOVE '."C                   (   #00017329' TO DFHEIV0
 20573     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20574     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20575     MOVE X'2020233030303137333239' TO DFHEIV0(25:11)
 20576     CALL 'kxdfhei1' USING DFHEIV0,
 20577           DFHEIV1,
 20578           CANCEL-GEN-PASS-AREA,
 20579           DFHEIV11,
 20580           DFHEIV99,
 20581           DFHEIV99,
 20582           DFHEIV99,
 20583           DFHEIV99
 20584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20585     IF CG-SUCCESS
 20586        CONTINUE
 20587     ELSE
 20588        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 20589        MOVE '3'                 TO EMI-SWITCH1
 20590        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 20591        EVALUATE TRUE
 20592           WHEN CG-DATE-ERROR
 20593             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20594           WHEN CG-CERT-NOT-FOUND
 20595             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20596           WHEN CG-AMOUNT-ERROR
 20597             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20598           WHEN CG-OPTION-ERROR
 20599             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20600           WHEN CG-PREV-CAN
 20601             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20602           WHEN CG-INVALID-DATA
 20603             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20604           WHEN CG-NO-ACCT-MSTR
 20605             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20606           WHEN CG-SFX-A-EXIST
 20607             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20608           WHEN CG-MISC-ERROR
 20609             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20610           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 381
* EL6311.cbl
 20611             MOVE ' ERROR - ELCANC - RETURN '
 20612                                 TO EMI-ERROR-TEXT (1) (12:25)
 20613        END-EVALUATE
 20614        GO TO 8200-SEND-DATAONLY
 20615     END-IF
 20616     .
 20617 5100-EXIT.
 20618     EXIT.
 20619
 20620******************************************************************
 20621*                                                                *
 20622*        B R O W S E   B A T C H   B A C K W A R D S             *
 20623*                                                                *
 20624******************************************************************
 20625
 20626 5500-BROWSE-BATCH-BACKWARD.
 20627
 20628* EXEC CICS HANDLE CONDITION
 20629*         NOTFND   (5550-END-RECORDS)
 20630*         ENDFILE  (5550-END-RECORDS)
 20631*    END-EXEC.
 20632*    MOVE '"$I''                  ! U #00017375' TO DFHEIV0
 20633     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20634     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20635     MOVE X'5520233030303137333735' TO DFHEIV0(25:11)
 20636     CALL 'kxdfhei1' USING DFHEIV0
 20637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20638
 20639
 20640 5505-START-BROWSE.
 20641     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20642     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 20643     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20644
 20645
 20646* EXEC CICS STARTBR
 20647*         DATASET   (FILE-ID-ERPNDB)
 20648*         RIDFLD    (ERPNDB-ALT-KEY)
 20649*    END-EXEC.
 20650     MOVE 0
 20651       TO DFHEIV11
 20652*    MOVE '&,         G          &   #00017385' TO DFHEIV0
 20653     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20654     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20655     MOVE X'2020233030303137333835' TO DFHEIV0(25:11)
 20656     CALL 'kxdfhei1' USING DFHEIV0,
 20657           FILE-ID-ERPNDB,
 20658           ERPNDB-ALT-KEY,
 20659           DFHEIV99,
 20660           DFHEIV11,
 20661           DFHEIV99
 20662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20663
 20664
 20665     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20666
 20667
 20668* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 382
* EL6311.cbl
 20669*         DATASET    (FILE-ID-ERPNDB)
 20670*         SET        (ADDRESS OF PENDING-BUSINESS)
 20671*         RIDFLD     (ERPNDB-KEY)
 20672*    END-EXEC.
 20673     MOVE 0
 20674       TO DFHEIV11
 20675*    MOVE '&.S                   )   #00017392' TO DFHEIV0
 20676     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20677     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20678     MOVE X'2020233030303137333932' TO DFHEIV0(25:11)
 20679     CALL 'kxdfhei1' USING DFHEIV0,
 20680           FILE-ID-ERPNDB,
 20681           DFHEIV20,
 20682           DFHEIV99,
 20683           ERPNDB-KEY,
 20684           DFHEIV99,
 20685           DFHEIV11,
 20686           DFHEIV99,
 20687           DFHEIV99
 20688     SET ADDRESS OF PENDING-BUSINESS TO
 20689         DFHEIV20
 20690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20691
 20692
 20693
 20694* EXEC CICS READPREV
 20695*         DATASET    (FILE-ID-ERPNDB)
 20696*         SET        (ADDRESS OF PENDING-BUSINESS)
 20697*         RIDFLD     (ERPNDB-KEY)
 20698*    END-EXEC.
 20699     MOVE 0
 20700       TO DFHEIV11
 20701*    MOVE '&0S                   )   #00017398' TO DFHEIV0
 20702     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20703     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20704     MOVE X'2020233030303137333938' TO DFHEIV0(25:11)
 20705     CALL 'kxdfhei1' USING DFHEIV0,
 20706           FILE-ID-ERPNDB,
 20707           DFHEIV20,
 20708           DFHEIV99,
 20709           ERPNDB-KEY,
 20710           DFHEIV99,
 20711           DFHEIV11,
 20712           DFHEIV99,
 20713           DFHEIV99
 20714     SET ADDRESS OF PENDING-BUSINESS TO
 20715         DFHEIV20
 20716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20717
 20718
 20719
 20720* EXEC CICS READPREV
 20721*         DATASET    (FILE-ID-ERPNDB)
 20722*         SET        (ADDRESS OF PENDING-BUSINESS)
 20723*         RIDFLD     (ERPNDB-KEY)
 20724*    END-EXEC.
 20725     MOVE 0
 20726       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 383
* EL6311.cbl
 20727*    MOVE '&0S                   )   #00017404' TO DFHEIV0
 20728     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20729     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20730     MOVE X'2020233030303137343034' TO DFHEIV0(25:11)
 20731     CALL 'kxdfhei1' USING DFHEIV0,
 20732           FILE-ID-ERPNDB,
 20733           DFHEIV20,
 20734           DFHEIV99,
 20735           ERPNDB-KEY,
 20736           DFHEIV99,
 20737           DFHEIV11,
 20738           DFHEIV99,
 20739           DFHEIV99
 20740     SET ADDRESS OF PENDING-BUSINESS TO
 20741         DFHEIV20
 20742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20743
 20744
 20745     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20746        GO TO 5550-END-RECORDS.
 20747
 20748     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 20749
 20750     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20751
 20752     IF  WS-BATCH-PREFIX = '#CL'
 20753             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20754
 20755* EXEC CICS ENDBR
 20756*                 DATASET  (FILE-ID-ERPNDB)
 20757*            END-EXEC
 20758     MOVE 0
 20759       TO DFHEIV11
 20760*    MOVE '&2                    $   #00017419' TO DFHEIV0
 20761     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20762     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20763     MOVE X'2020233030303137343139' TO DFHEIV0(25:11)
 20764     CALL 'kxdfhei1' USING DFHEIV0,
 20765           FILE-ID-ERPNDB,
 20766           DFHEIV11,
 20767           DFHEIV99
 20768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20769         GO TO 5505-START-BROWSE.
 20770
 20771     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20772         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20773             NEXT SENTENCE
 20774         ELSE
 20775             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20776
 20777* EXEC CICS ENDBR
 20778*                 DATASET  (FILE-ID-ERPNDB)
 20779*            END-EXEC
 20780     MOVE 0
 20781       TO DFHEIV11
 20782*    MOVE '&2                    $   #00017429' TO DFHEIV0
 20783     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20784     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 384
* EL6311.cbl
 20785     MOVE X'2020233030303137343239' TO DFHEIV0(25:11)
 20786     CALL 'kxdfhei1' USING DFHEIV0,
 20787           FILE-ID-ERPNDB,
 20788           DFHEIV11,
 20789           DFHEIV99
 20790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20791             GO TO 5505-START-BROWSE.
 20792
 20793
 20794     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20795         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20796             NEXT SENTENCE
 20797        ELSE
 20798             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20799
 20800* EXEC CICS ENDBR
 20801*                 DATASET  (FILE-ID-ERPNDB)
 20802*            END-EXEC
 20803     MOVE 0
 20804       TO DFHEIV11
 20805*    MOVE '&2                    $   #00017440' TO DFHEIV0
 20806     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20807     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20808     MOVE X'2020233030303137343430' TO DFHEIV0(25:11)
 20809     CALL 'kxdfhei1' USING DFHEIV0,
 20810           FILE-ID-ERPNDB,
 20811           DFHEIV11,
 20812           DFHEIV99
 20813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20814             GO TO 5505-START-BROWSE.
 20815
 20816     IF NOT PB-BATCH-TRAILER
 20817        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20818
 20819* EXEC CICS ENDBR
 20820*            DATASET  (FILE-ID-ERPNDB)
 20821*       END-EXEC
 20822     MOVE 0
 20823       TO DFHEIV11
 20824*    MOVE '&2                    $   #00017447' TO DFHEIV0
 20825     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20826     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20827     MOVE X'2020233030303137343437' TO DFHEIV0(25:11)
 20828     CALL 'kxdfhei1' USING DFHEIV0,
 20829           FILE-ID-ERPNDB,
 20830           DFHEIV11,
 20831           DFHEIV99
 20832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20833        GO TO 5505-START-BROWSE.
 20834
 20835     IF PI-CSR-BROWSE
 20836        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20837           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 20838
 20839* EXEC CICS ENDBR
 20840*               DATASET  (FILE-ID-ERPNDB)
 20841*          END-EXEC
 20842     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 385
* EL6311.cbl
 20843       TO DFHEIV11
 20844*    MOVE '&2                    $   #00017455' TO DFHEIV0
 20845     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20846     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20847     MOVE X'2020233030303137343535' TO DFHEIV0(25:11)
 20848     CALL 'kxdfhei1' USING DFHEIV0,
 20849           FILE-ID-ERPNDB,
 20850           DFHEIV11,
 20851           DFHEIV99
 20852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20853           GO TO 5505-START-BROWSE.
 20854
 20855     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20856        IF PI-PB-CARRIER    = SPACES AND
 20857           PI-PB-GROUPING   = SPACES AND
 20858           PI-PB-STATE      = SPACES AND
 20859           PI-PB-ACCOUNT    = SPACES
 20860             GO TO 7200-DISPLAY-BATCHES
 20861          ELSE
 20862            IF PI-PB-CARRIER    = PB-CARRIER  AND
 20863               PI-PB-GROUPING   = PB-GROUPING AND
 20864               PI-PB-STATE      = PB-STATE    AND
 20865               PI-PB-ACCOUNT    = PB-ACCOUNT
 20866                 GO TO 7200-DISPLAY-BATCHES.
 20867
 20868     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 20869
 20870
 20871* EXEC CICS ENDBR
 20872*         DATASET  (FILE-ID-ERPNDB)
 20873*    END-EXEC.
 20874     MOVE 0
 20875       TO DFHEIV11
 20876*    MOVE '&2                    $   #00017475' TO DFHEIV0
 20877     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20878     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20879     MOVE X'2020233030303137343735' TO DFHEIV0(25:11)
 20880     CALL 'kxdfhei1' USING DFHEIV0,
 20881           FILE-ID-ERPNDB,
 20882           DFHEIV11,
 20883           DFHEIV99
 20884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20885
 20886
 20887     GO TO 5505-START-BROWSE.
 20888
 20889 5550-END-RECORDS.
 20890     MOVE ER-2257                TO EMI-ERROR.
 20891     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20892     MOVE -1                     TO DPFENTRL.
 20893
 20894     GO TO 8200-SEND-DATAONLY.
 20895
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 386
* EL6311.cbl
 20897
 20898******************************************************************
 20899*                                                                *
 20900*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 20901*                                                                *
 20902******************************************************************
 20903
 20904 6000-CREATE-TEMP-STORAGE.
 20905
 20906
 20907* EXEC CICS HANDLE CONDITION
 20908*        QIDERR  (6050-QID-ERROR)
 20909*    END-EXEC.
 20910*    MOVE '"$N                   ! V #00017498' TO DFHEIV0
 20911     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 20912     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20913     MOVE X'5620233030303137343938' TO DFHEIV0(25:11)
 20914     CALL 'kxdfhei1' USING DFHEIV0
 20915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20916
 20917
 20918
 20919* EXEC CICS WRITEQ TS
 20920*        QUEUE    (QID)
 20921*        FROM     (PROGRAM-INTERFACE-BLOCK)
 20922*        LENGTH   (WS-COMM-LENGTH)
 20923*        ITEM     (W-ONE)
 20924*    END-EXEC.
 20925*    MOVE '*" I                  ''   #00017502' TO DFHEIV0
 20926     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 20927     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20928     MOVE X'2020233030303137353032' TO DFHEIV0(25:11)
 20929     CALL 'kxdfhei1' USING DFHEIV0,
 20930           QID,
 20931           PROGRAM-INTERFACE-BLOCK,
 20932           WS-COMM-LENGTH,
 20933           W-ONE,
 20934           DFHEIV99,
 20935           DFHEIV99
 20936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20937
 20938
 20939 6000-EXIT.
 20940      EXIT.
 20941
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 387
* EL6311.cbl
 20943
 20944******************************************************************
 20945*                                                                *
 20946*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 20947*                                                                *
 20948******************************************************************
 20949
 20950 6050-RECOVER-TEMP-STORAGE.
 20951     IF PGM-NAME = XCTL-EL6312
 20952        GO TO 6050-EXIT.
 20953
 20954     IF PGM-NAME = XCTL-EL6313
 20955        GO TO 6050-EXIT.
 20956
 20957     IF PGM-NAME = XCTL-EL6315
 20958         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 20959     END-IF
 20960
 20961     IF PGM-NAME = XCTL-EL6316
 20962         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 20963     END-IF
 20964
 20965
 20966* EXEC CICS HANDLE CONDITION
 20967*        QIDERR  (6050-QID-ERROR)
 20968*    END-EXEC.
 20969*    MOVE '"$N                   ! W #00017535' TO DFHEIV0
 20970     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 20971     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20972     MOVE X'5720233030303137353335' TO DFHEIV0(25:11)
 20973     CALL 'kxdfhei1' USING DFHEIV0
 20974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20975
 20976
 20977
 20978* EXEC CICS READQ TS
 20979*         QUEUE   (QID)
 20980*         INTO    (PROGRAM-INTERFACE-BLOCK)
 20981*         LENGTH  (WS-COMM-LENGTH)
 20982*         ITEM    (W-ONE)
 20983*     END-EXEC.
 20984*    MOVE '*$II   L              ''   #00017539' TO DFHEIV0
 20985     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 20986     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20987     MOVE X'2020233030303137353339' TO DFHEIV0(25:11)
 20988     CALL 'kxdfhei1' USING DFHEIV0,
 20989           QID,
 20990           PROGRAM-INTERFACE-BLOCK,
 20991           WS-COMM-LENGTH,
 20992           W-ONE,
 20993           DFHEIV99,
 20994           DFHEIV99
 20995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20996
 20997
 20998 6050-DELETE-TEMP-STORAGE.
 20999
 21000
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 388
* EL6311.cbl
 21001* EXEC CICS DELETEQ TS
 21002*        QUEUE   (QID)
 21003*    END-EXEC.
 21004*    MOVE '*&                    #   #00017548' TO DFHEIV0
 21005     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21006     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21007     MOVE X'2020233030303137353438' TO DFHEIV0(25:11)
 21008     CALL 'kxdfhei1' USING DFHEIV0,
 21009           QID,
 21010           DFHEIV99
 21011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21012
 21013
 21014     GO TO 6050-EXIT.
 21015
 21016 6050-QID-ERROR.
 21017     MOVE ER-0033                TO EMI-ERROR
 21018     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21019
 21020 6050-EXIT.
 21021      EXIT.
 21022
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 389
* EL6311.cbl
 21024
 21025******************************************************************
 21026*                                                                *
 21027*            T E R M   C O N V E R S I O N                       *
 21028*                                                                *
 21029******************************************************************
 21030
 21031 6100-TERM-CONVERSION.
 21032
 21033     IF PI-BPMTS = ZERO
 21034         GO TO 6199-EXIT.
 21035
 21036     IF PI-BMODE = ' ' OR 'M'
 21037         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21038         GO TO 6105-ROUND-TERM.
 21039
 21040     IF PI-BMODE = 'S'
 21041         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21042         GO TO 6105-ROUND-TERM.
 21043
 21044     IF PI-BMODE = 'W'
 21045         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21046         GO TO 6105-ROUND-TERM.
 21047
 21048     IF PI-BMODE = 'B'
 21049         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21050         GO TO 6105-ROUND-TERM.
 21051
 21052     IF PI-BMODE = 'T'
 21053         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21054
 21055 6105-ROUND-TERM.
 21056
 21057     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21058         ADD +1                  TO WS-CALC-TERM-WHOLE
 21059         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21060
 21061     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21062         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21063
 21064     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21065         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21066                                      WS-BTERM    (WS-SUB1)
 21067         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21068
 21069     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21070         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21071             MOVE -1               TO BMODEL
 21072             MOVE ER-2593          TO EMI-ERROR
 21073             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21074             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21075
 21076 6124-CHECK-BENEFIT.
 21077
 21078     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21079        GO TO 6126-COMPUTE-BENEFIT.
 21080
 21081     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 390
* EL6311.cbl
 21082
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 391
* EL6311.cbl
 21084******************************************************************
 21085**         COMPUTE TERM AND BENEFIT
 21086******************************************************************
 21087 6125-COMPUTE-TERM-BENEFIT.
 21088
 21089     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21090        PI-BPMTAMT = ZERO
 21091         GO TO 6199-EXIT.
 21092
 21093     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21094                                     WS-BTERM  (WS-SUB1).
 21095     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21096
 21097 6126-COMPUTE-BENEFIT.
 21098
 21099     IF PI-BMODE = 'M' OR  ' '
 21100         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21101
 21102     IF PI-BMODE = 'W'
 21103         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21104
 21105     IF PI-BMODE = 'S'
 21106         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21107
 21108     IF PI-BMODE = 'B'
 21109         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21110
 21111     IF PI-BMODE = 'T'
 21112         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21113
 21114     IF WS-SUB1 = +1
 21115        COMPUTE WS-BBEN (WS-SUB1) =
 21116                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21117
 21118     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21119     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21120     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21121
 21122 6199-EXIT.
 21123     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 392
* EL6311.cbl
 21125
 21126******************************************************************
 21127*                                                                *
 21128*             D I S P L A Y   I S S U E S                        *
 21129*                                                                *
 21130******************************************************************
 21131
 21132 6200-CREATE-VADS.
 21133     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21134     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21135     MOVE SPACES                 TO WS-PASS-VADS-REC
 21136
 21137* EXEC CICS GETMAIN
 21138*       SET      (ADDRESS OF PENDING-BUSINESS)
 21139*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21140*       INITIMG  (GETMAIN-SPACE)
 21141*       RESP     (WS-RESPONSE)
 21142*    END-EXEC
 21143*    MOVE ',"IL                  $  N#00017674' TO DFHEIV0
 21144     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21145     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21146     MOVE X'204E233030303137363734' TO DFHEIV0(25:11)
 21147     CALL 'kxdfhei1' USING DFHEIV0,
 21148           DFHEIV20,
 21149           ERPNDB-RECORD-LENGTH,
 21150           GETMAIN-SPACE
 21151     SET ADDRESS OF PENDING-BUSINESS TO
 21152         DFHEIV20
 21153     MOVE EIBRESP  TO WS-RESPONSE
 21154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21155
 21156* EXEC CICS READ
 21157*       INTO    (PENDING-BUSINESS)
 21158*       DATASET (FILE-ID-ERPNDB)
 21159*       RIDFLD  (ERPNDB-KEY)
 21160*       RESP    (WS-RESPONSE)
 21161*    END-EXEC
 21162     MOVE LENGTH OF
 21163      PENDING-BUSINESS
 21164       TO DFHEIV11
 21165*    MOVE '&"IL       E          (  N#00017680' TO DFHEIV0
 21166     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21167     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21168     MOVE X'204E233030303137363830' TO DFHEIV0(25:11)
 21169     CALL 'kxdfhei1' USING DFHEIV0,
 21170           FILE-ID-ERPNDB,
 21171           PENDING-BUSINESS,
 21172           DFHEIV11,
 21173           ERPNDB-KEY,
 21174           DFHEIV99,
 21175           DFHEIV99,
 21176           DFHEIV99
 21177     MOVE EIBRESP  TO WS-RESPONSE
 21178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21179     IF RESP-NORMAL
 21180        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21181        IF (RESP-NORMAL)
 21182           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 393
* EL6311.cbl
 21183              AM-CONTROL-PRIMARY (1:20))
 21184           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21185        ELSE
 21186           MOVE 'ACCOUNT NOT FOUND'
 21187                                 TO VD-ACCOUNT-NAME
 21188        END-IF
 21189        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21190                                    TO M1
 21191        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21192        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21193           (A2 > M1)
 21194           OR (WS-WORK-FIELD (A2:1) = '*')
 21195           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21196           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21197        END-PERFORM
 21198        IF A2 > M1
 21199           CONTINUE
 21200        ELSE
 21201           MOVE WS-WORK-FIELD (1:A2 - 1)
 21202                                    TO VD-ACCOUNT-NAME
 21203        END-IF
 21204        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21205        MOVE PB-CARRIER          TO VD-CARRIER
 21206        MOVE PB-GROUPING         TO VD-GROUPING
 21207        MOVE PB-STATE            TO VD-STATE
 21208        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21209        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21210        MOVE PB-CERT-NO          TO VD-CERT-NO
 21211        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21212        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21213        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21214        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21215        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21216        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21217        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21218        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21219        MOVE PB-CSR-ID           TO VD-CSR-ID
 21220        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 21221        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 21222        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 21223        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 21224        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 21225        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 21226        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 21227        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 21228        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 21229        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 21230        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 21231        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 21232        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 21233     END-IF
 21234     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 21235
 21236
 21237* EXEC CICS GETMAIN
 21238*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 21239*       LENGTH   (ERPNDM-RECORD-LENGTH)
 21240*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 394
* EL6311.cbl
 21241*       RESP     (WS-RESPONSE)
 21242*    END-EXEC
 21243*    MOVE ',"IL                  $  N#00017743' TO DFHEIV0
 21244     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21245     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21246     MOVE X'204E233030303137373433' TO DFHEIV0(25:11)
 21247     CALL 'kxdfhei1' USING DFHEIV0,
 21248           DFHEIV20,
 21249           ERPNDM-RECORD-LENGTH,
 21250           GETMAIN-SPACE
 21251     SET ADDRESS OF PENDING-MAILING-DATA TO
 21252         DFHEIV20
 21253     MOVE EIBRESP  TO WS-RESPONSE
 21254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21255
 21256
 21257* EXEC CICS READ
 21258*       INTO    (PENDING-MAILING-DATA)
 21259*       DATASET (FILE-ID-ERPNDM)
 21260*       RIDFLD  (ERPNDM-KEY)
 21261*       RESP    (WS-RESPONSE)
 21262*    END-EXEC
 21263     MOVE LENGTH OF
 21264      PENDING-MAILING-DATA
 21265       TO DFHEIV11
 21266*    MOVE '&"IL       E          (  N#00017750' TO DFHEIV0
 21267     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21268     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21269     MOVE X'204E233030303137373530' TO DFHEIV0(25:11)
 21270     CALL 'kxdfhei1' USING DFHEIV0,
 21271           FILE-ID-ERPNDM,
 21272           PENDING-MAILING-DATA,
 21273           DFHEIV11,
 21274           ERPNDM-KEY,
 21275           DFHEIV99,
 21276           DFHEIV99,
 21277           DFHEIV99
 21278     MOVE EIBRESP  TO WS-RESPONSE
 21279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21280
 21281     IF RESP-NORMAL
 21282        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 21283        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 21284        MOVE PM-CITY              TO VD-INSURED-CITY
 21285        MOVE PM-STATE             TO VD-INSURED-STATE
 21286        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 21287     END-IF
 21288
 21289     MOVE 'VAC1'                  TO VD-LETTER-ID
 21290     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 21291     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 21292     MOVE EIBTIME                 TO VD-CURRENT-TIME
 21293     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 21294     MOVE +0                      TO VD-ARCHIVE-NO
 21295     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 21296     .
 21297 6200-EXIT.
 21298     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 395
* EL6311.cbl
 21299 6210-READ-ERACCT.
 21300     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 21301     MOVE LOW-VALUES             TO ERACCT-FILL
 21302
 21303* EXEC CICS READ
 21304*         DATASET   ('ERACCT')
 21305*         INTO      (ACCOUNT-MASTER)
 21306*         RIDFLD    (ERACCT-KEY)
 21307*         GTEQ
 21308*         RESP      (WS-RESPONSE)
 21309*    END-EXEC
 21310     MOVE LENGTH OF
 21311      ACCOUNT-MASTER
 21312       TO DFHEIV11
 21313     MOVE 'ERACCT' TO DFHEIV1
 21314*    MOVE '&"IL       G          (  N#00017778' TO DFHEIV0
 21315     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21316     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21317     MOVE X'204E233030303137373738' TO DFHEIV0(25:11)
 21318     CALL 'kxdfhei1' USING DFHEIV0,
 21319           DFHEIV1,
 21320           ACCOUNT-MASTER,
 21321           DFHEIV11,
 21322           ERACCT-KEY,
 21323           DFHEIV99,
 21324           DFHEIV99,
 21325           DFHEIV99
 21326     MOVE EIBRESP  TO WS-RESPONSE
 21327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21328     .
 21329 6210-EXIT.
 21330     EXIT.
 21331
 21332 6220-READ-ERMAIL.
 21333
 21334     MOVE ELCERT-KEY             TO ERMAIL-KEY
 21335     MOVE ' '                    TO WS-ERMAIL-SW
 21336
 21337
 21338* EXEC CICS READ
 21339*       DATASET   (FILE-ID-ERMAIL)
 21340*       SET       (ADDRESS OF MAILING-DATA)
 21341*       RIDFLD    (ERMAIL-KEY)
 21342*       RESP      (WS-RESPONSE)
 21343*    END-EXEC
 21344*    MOVE '&"S        E          (  N#00017794' TO DFHEIV0
 21345     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21346     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21347     MOVE X'204E233030303137373934' TO DFHEIV0(25:11)
 21348     CALL 'kxdfhei1' USING DFHEIV0,
 21349           FILE-ID-ERMAIL,
 21350           DFHEIV20,
 21351           DFHEIV99,
 21352           ERMAIL-KEY,
 21353           DFHEIV99,
 21354           DFHEIV99,
 21355           DFHEIV99
 21356     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 396
* EL6311.cbl
 21357         DFHEIV20
 21358     MOVE EIBRESP  TO WS-RESPONSE
 21359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21360
 21361     IF RESP-NORMAL
 21362        SET ERMAIL-FOUND TO TRUE
 21363     END-IF
 21364     .
 21365 6220-EXIT.
 21366     EXIT.
 21367
 21368 6400-CHECK-FOR-RES-REF-CLAIM.
 21369     display 'made it to 6400- for ' pi-cert-no
 21370     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 21371
 21372     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 21373                                    W-CL-COMP-CD.
 21374     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 21375                                    W-CL-CERT-NO.
 21376     MOVE SPACES                 TO MSTR-CERT-SFX.
 21377
 21378
 21379* EXEC CICS HANDLE CONDITION
 21380*        NOTFND  (6400-CONTINUE)
 21381*        ENDFILE (6400-CONTINUE)
 21382*    END-EXEC.
 21383*    MOVE '"$I''                  ! X #00017818' TO DFHEIV0
 21384     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21385     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21386     MOVE X'5820233030303137383138' TO DFHEIV0(25:11)
 21387     CALL 'kxdfhei1' USING DFHEIV0
 21388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21389
 21390
 21391
 21392* EXEC CICS IGNORE CONDITION
 21393*        DUPKEY
 21394*    END-EXEC.
 21395*    MOVE '"*$                   !   #00017823' TO DFHEIV0
 21396     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 21397     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21398     MOVE X'2020233030303137383233' TO DFHEIV0(25:11)
 21399     CALL 'kxdfhei1' USING DFHEIV0
 21400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21401
 21402
 21403
 21404* EXEC CICS STARTBR
 21405*        DATASET   (CLMS-ID)
 21406*        RIDFLD    (ELMSTR-KEY)
 21407*        GENERIC   EQUAL
 21408*        KEYLENGTH (ELMSTR-LENGTH)
 21409*    END-EXEC.
 21410     MOVE 0
 21411       TO DFHEIV11
 21412*    MOVE '&,   KG    E          &   #00017827' TO DFHEIV0
 21413     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 21414     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 397
* EL6311.cbl
 21415     MOVE X'2020233030303137383237' TO DFHEIV0(25:11)
 21416     CALL 'kxdfhei1' USING DFHEIV0,
 21417           CLMS-ID,
 21418           ELMSTR-KEY,
 21419           ELMSTR-LENGTH,
 21420           DFHEIV11,
 21421           DFHEIV99
 21422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21423
 21424
 21425     display 'browse started'
 21426     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21427
 21428 6400-NEXT-CLAIM.
 21429
 21430
 21431* EXEC CICS READNEXT
 21432*        DATASET   (CLMS-ID)
 21433*        RIDFLD    (ELMSTR-KEY)
 21434*        SET       (ADDRESS OF CLAIM-MASTER)
 21435*    END-EXEC.
 21436     MOVE 0
 21437       TO DFHEIV11
 21438*    MOVE '&.S                   )   #00017839' TO DFHEIV0
 21439     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21440     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21441     MOVE X'2020233030303137383339' TO DFHEIV0(25:11)
 21442     CALL 'kxdfhei1' USING DFHEIV0,
 21443           CLMS-ID,
 21444           DFHEIV20,
 21445           DFHEIV99,
 21446           ELMSTR-KEY,
 21447           DFHEIV99,
 21448           DFHEIV11,
 21449           DFHEIV99,
 21450           DFHEIV99
 21451     SET ADDRESS OF CLAIM-MASTER TO
 21452         DFHEIV20
 21453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21454
 21455
 21456     display 'read claim for ' mstr-cert-no
 21457     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 21458        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 21459         GO TO 6400-CONTINUE
 21460     END-IF.
 21461
 21462     IF PI-CARRIER     NOT = CL-CARRIER        OR
 21463        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 21464        PI-STATE       NOT = CL-CERT-STATE     OR
 21465        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 21466        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 21467         GO TO 6400-NEXT-CLAIM
 21468     END-IF.
 21469
 21470     display 'found claim ' cl-claim-no
 21471        ' with denial type ' cl-denial-type
 21472     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 398
* EL6311.cbl
 21473         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 21474         GO TO 6400-CONTINUE
 21475     END-IF.
 21476
 21477     GO TO 6400-NEXT-CLAIM.
 21478
 21479 6400-CONTINUE.
 21480
 21481     IF WS-BROWSE-STARTED-SW = 'Y'
 21482
 21483* EXEC CICS ENDBR
 21484*            DATASET   (CLMS-ID)
 21485*        END-EXEC
 21486     MOVE 0
 21487       TO DFHEIV11
 21488*    MOVE '&2                    $   #00017871' TO DFHEIV0
 21489     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21490     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21491     MOVE X'2020233030303137383731' TO DFHEIV0(25:11)
 21492     CALL 'kxdfhei1' USING DFHEIV0,
 21493           CLMS-ID,
 21494           DFHEIV11,
 21495           DFHEIV99
 21496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21497         MOVE 'N' TO WS-BROWSE-STARTED-SW
 21498     END-IF.
 21499
 21500 6400-EXIT.
 21501     EXIT.
 21502
 21503 7000-DISPLAY-ISSUES.
 21504
 21505     IF PI-DISPLAY-ORIGINAL-BATCH
 21506        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 21507        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 21508     ELSE
 21509        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 21510
 21511     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 21512
 21513     MOVE 'Y'                        TO WS-DISPLAY-SW.
 21514     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 21515
 21516     MOVE LOW-VALUES                 TO EL631BI.
 21517     MOVE ZEROS                      TO PI-BPMTAMT
 21518                                        PI-BPMTS.
 21519     MOVE SPACE                      TO PI-BMODE
 21520                                        PI-BTYPE (1)
 21521                                        PI-BTYPE (2).
 21522     MOVE EL631B                     TO PI-MAP-NAME.
 21523     MOVE 'Y'                        TO PI-BROWSE-SW.
 21524     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 21525                                        PI-HIGH-SEQ-NO.
 21526
 21527     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21528        MOVE AL-SABOF                TO BCHGTA
 21529        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 21530        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 399
* EL6311.cbl
 21531     ELSE
 21532        MOVE AL-SADOF                TO BCHGTA
 21533                                        BCHGA
 21534        MOVE PB-CHG-COUNT            TO BCHGO.
 21535
 21536     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 21537     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 21538     MOVE WS-HR-MINS                 TO BMANTATO.
 21539
 21540     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 21541        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 21542        MOVE SPACE                   TO DC-OPTION-CODE
 21543        PERFORM 9700-DATE-LINK
 21544        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 21545        MOVE 'INACTIVE'              TO BMOENDTO
 21546     ELSE
 21547        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 21548        MOVE SPACE                   TO DC-OPTION-CODE
 21549        PERFORM 9700-DATE-LINK
 21550        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 21551        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 21552        MOVE SPACE                   TO DC-OPTION-CODE
 21553        PERFORM 9700-DATE-LINK
 21554        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 21555
 21556*    MOVE PB-I-REFERENCE             TO BREFO.
 21557
 21558*    IF PI-COMPANY-ID EQUAL 'HER'
 21559*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 21560*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 21561*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 21562*                MOVE WS-MEMBER-NO-1-8
 21563*                                TO  BMICRNOO.
 21564
 21565*    IF PB-I-MICROFILM-NO  IS NUMERIC
 21566*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 21567*            MOVE PB-I-MICROFILM-NO
 21568*                                TO  BMICRNOO.
 21569     IF PB-I-VIN NOT = SPACES
 21570        MOVE PB-I-VIN            TO BVINO
 21571     END-IF
 21572
 21573     MOVE PB-CERT-PRIME              TO BCERTNOO.
 21574     MOVE PB-CERT-SFX                TO BSUFIXO.
 21575     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 21576     MOVE SPACE                      TO DC-OPTION-CODE.
 21577     PERFORM 9700-DATE-LINK.
 21578     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 21579
 21580     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 21581     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 21582     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 21583     MOVE PB-I-INSURED-SEX           TO BSEXO
 21584
 21585     IF PB-I-AGE NOT = ZEROS
 21586         MOVE PB-I-AGE               TO BAGEO.
 21587
 21588     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 400
* EL6311.cbl
 21589                                 TO ELCERT-KEY
 21590     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 21591     IF NOT CERT-TRL-REC-NOT-FOUND
 21592         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 21593             MOVE 'AGE*'             TO BAGEDEFO
 21594         ELSE
 21595             MOVE 'AGE '             TO BAGEDEFO
 21596         END-IF
 21597     ELSE
 21598         MOVE 'AGE '             TO BAGEDEFO
 21599     END-IF
 21600
 21601     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 21602         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 21603         MOVE SPACE                  TO DC-OPTION-CODE
 21604         PERFORM 9700-DATE-LINK
 21605         IF NO-CONVERSION-ERROR
 21606            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 21607
 21608     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 21609         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 21610         MOVE SPACE                  TO DC-OPTION-CODE
 21611         PERFORM 9700-DATE-LINK
 21612         IF NO-CONVERSION-ERROR
 21613            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 21614
 21615     IF PB-I-EXTENTION-DAYS NUMERIC
 21616        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 21617           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 21618        ELSE
 21619           IF PB-I-TERM-IN-DAYS NUMERIC
 21620              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 21621                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 21622
 21623     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 21624        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 21625
 21626     MOVE PB-FORCE-CODE              TO BFORCEO.
 21627     MOVE PB-I-TERM-TYPE             TO BMODEO
 21628                                        PI-BMODE.
 21629
 21630     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 21631        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 21632
 21633     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 21634         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 21635                                        PI-BPMTS.
 21636
 21637     IF PB-I-PAYMENT-AMOUNT NUMERIC
 21638         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 21639           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 21640                                        PI-BPMTAMT.
 21641
 21642     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 21643     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 21644     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 21645     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 21646     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 401
* EL6311.cbl
 21647     MOVE PB-I-SIG-SW                TO BSIGO.
 21648     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 21649     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 21650     MOVE PB-RECORD-BILL             TO BBILCDO.
 21651     MOVE PB-FORCE-CODE              TO BFORCEO.
 21652
 21653     IF (PB-I-LIVES NUMERIC)
 21654        AND (PB-I-LIVES > ZEROS)
 21655        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21656        IF (RESP-NORMAL)
 21657           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 21658           CONTINUE
 21659        ELSE
 21660           MOVE PB-I-LIVES       TO BLIVESO
 21661        END-IF
 21662     END-IF
 21663
 21664     IF PB-I-NUM-BILLED NUMERIC AND
 21665        PB-I-NUM-BILLED GREATER THAN ZEROS
 21666        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 21667*    ELSE
 21668*       MOVE ZEROS                   TO BBILLEDO.
 21669
 21670     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 21671
 21672     IF PB-I-LOAN-APR NOT = ZEROS
 21673        MOVE PB-I-LOAN-APR           TO BAPRO.
 21674
 21675     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 21676        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 21677
 21678     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 21679        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 21680           MOVE AL-SANOF                TO BORIGHDA
 21681           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 21682           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 21683
 21684     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 21685
 21686     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 21687        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 21688
 21689     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 21690        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 21691                                        PI-BTYPE (1).
 21692
 21693     IF PB-I-LF-TERM     GREATER THAN ZEROS
 21694        MOVE PB-I-LF-TERM            TO BTERMO (1).
 21695
 21696     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 21697        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 21698
 21699     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 21700        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 21701
 21702     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 21703        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 21704
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 402
* EL6311.cbl
 21705     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 21706        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 21707
 21708     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 21709         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 21710         MOVE SPACE                  TO DC-OPTION-CODE
 21711         PERFORM 9700-DATE-LINK
 21712         IF NO-CONVERSION-ERROR
 21713            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 21714
 21715     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21716        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 21717        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 21718        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 21719        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 21720                 GIVING BDIFFO (1)
 21721     ELSE
 21722        MOVE SPACES                  TO BBEN-CD     (1)
 21723                                        BBEN-ABBR   (1).
 21724
 21725     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 21726        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 21727        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 21728                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 21729
 21730     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21731       IF PB-RECORD-ON-HOLD
 21732          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 21733
 21734     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21735       IF PB-RECORD-RETURNED
 21736          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 21737
 21738     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21739        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 21740             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 21741
 21742     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 21743
 21744     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 21745        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 21746
 21747     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 21748        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 21749                                        PI-BTYPE (2).
 21750
 21751     IF PB-I-AH-TERM     GREATER THAN ZEROS
 21752        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 21753
 21754     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 21755        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 21756
 21757     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 21758        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 21759
 21760     IF PB-I-TOT-FEES NOT NUMERIC
 21761        MOVE ZEROS               TO PB-I-TOT-FEES
 21762     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 403
* EL6311.cbl
 21763     IF PB-I-TOT-FEES > ZEROS
 21764        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 21765
 21766     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 21767         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 21768         MOVE SPACE                  TO DC-OPTION-CODE
 21769         PERFORM 9700-DATE-LINK
 21770         IF NO-CONVERSION-ERROR
 21771            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 21772
 21773     IF PB-I-TOT-FEES > ZEROS
 21774        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 21775        SUBTRACT PB-I-TOT-FEES FROM
 21776                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 21777
 21778     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21779        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 21780        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 21781        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 21782        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 21783                 GIVING BDIFFO (2)
 21784     ELSE
 21785        MOVE SPACES                  TO BBEN-CD     (2)
 21786                                        BBEN-ABBR   (2).
 21787
 21788     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21789       IF PB-RECORD-ON-HOLD
 21790          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 21791
 21792     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21793       IF PB-RECORD-RETURNED
 21794          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 21795
 21796     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21797        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 21798             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 21799
 21800     MOVE PB-CSR-ID                  TO BCSRO.
 21801
 21802     IF PI-COMPANY-ID  =  'DMD'
 21803        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 21804            NEXT SENTENCE
 21805        ELSE
 21806            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 21807               MOVE 'NEW CERT'       TO BNCERTLI
 21808               MOVE EC-NEW-CERT      TO BNCERTO.
 21809
 21810     IF PI-COMPANY-ID  =  'DMD'
 21811        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 21812            NEXT SENTENCE
 21813        ELSE
 21814           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 21815               MOVE 'NEW STATE'      TO BNSTATLI
 21816               MOVE EC-NEW-STATE     TO BNSTATO.
 21817
 21818 7000-CONTINUE.
 21819     MOVE 'C'                        TO BMAINTI.
 21820     MOVE AL-UANON                   TO BMAINTA.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 404
* EL6311.cbl
 21821
 21822     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 21823        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 21824
 21825     IF PI-6315-FINALIZED = 'Y'   AND
 21826        PB-UNFORCED-ERRORS
 21827          MOVE -1                TO BFORCEL
 21828          MOVE  1                TO SET-CURSOR-SW
 21829     END-IF
 21830
 21831     IF NO-CURSOR-SET
 21832        MOVE -1                      TO BMAINTL.
 21833
 21834     GO TO 8100-SEND-INITIAL-MAP.
 21835
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 405
* EL6311.cbl
 21837
 21838******************************************************************
 21839*                                                                *
 21840*             D I S P L A Y   C A N C E L S                      *
 21841*                                                                *
 21842******************************************************************
 21843
 21844 7100-DISPLAY-CANCELS.
 21845     IF PI-DISPLAY-ORIGINAL-BATCH
 21846        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 21847        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 21848     ELSE
 21849        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 21850
 21851     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 21852
 21853     MOVE 'Y'                        TO WS-DISPLAY-SW.
 21854     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 21855
 21856     MOVE LOW-VALUES                 TO EL631CI.
 21857     MOVE EL631C                     TO PI-MAP-NAME.
 21858     MOVE 'Y'                        TO PI-BROWSE-SW.
 21859     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 21860                                        PI-HIGH-SEQ-NO.
 21861
 21862     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21863        MOVE AL-SABOF                TO CCHGTA
 21864        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 21865        MOVE AL-SANON                TO CCHGA
 21866      ELSE
 21867        MOVE AL-SADOF                TO CCHGTA
 21868                                        CCHGA
 21869        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 21870
 21871*    MOVE PB-C-REFERENCE             TO CREFO.
 21872
 21873*    IF PB-C-MICROFILM-NO IS NUMERIC
 21874*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 21875*          MOVE PB-C-MICROFILM-NO
 21876*                                TO CMICRNOO
 21877*          MOVE AL-UNNON         TO CMICRNOA
 21878*       END-IF
 21879*    END-IF
 21880     IF PB-C-NH-INT-ON-REFS NUMERIC
 21881        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 21882           MOVE PB-C-NH-INT-ON-REFS
 21883                                 TO CNHINTO
 21884           MOVE AL-SANOF         TO CNHINTA
 21885        END-IF
 21886     END-IF
 21887     MOVE PB-CERT-PRIME              TO CCERTNOO.
 21888     MOVE PB-CERT-SFX                TO CSUFIXO.
 21889     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 21890     MOVE SPACE                      TO DC-OPTION-CODE.
 21891     PERFORM 9700-DATE-LINK.
 21892     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 21893
 21894     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 406
* EL6311.cbl
 21895        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 21896        MOVE SPACE                   TO DC-OPTION-CODE
 21897        PERFORM 9700-DATE-LINK
 21898        IF NO-CONVERSION-ERROR
 21899           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 21900
 21901     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 21902        NEXT SENTENCE
 21903     ELSE
 21904        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 21905
 21906     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 21907        NEXT SENTENCE
 21908     ELSE
 21909        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 21910
 21911     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 21912        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 21913        MOVE SPACE                   TO DC-OPTION-CODE
 21914        PERFORM 9700-DATE-LINK
 21915        IF NO-CONVERSION-ERROR
 21916           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 21917
 21918     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21919         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 21920
 21921     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21922         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 21923
 21924     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 21925        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 21926        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 21927                 GIVING CDRFND1O.
 21928
 21929     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 21930        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 21931        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 21932                 GIVING CDRFND2O.
 21933
 21934     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21935       IF PB-RECORD-ON-HOLD
 21936          MOVE 'ON HOLD'             TO CBILIT1O.
 21937
 21938     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21939       IF PB-RECORD-RETURNED
 21940          MOVE 'RETURNED'            TO CBILIT1O.
 21941
 21942     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21943        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 21944             MOVE 'OVERRIDE'         TO CBILIT1O.
 21945
 21946     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21947       IF PB-RECORD-ON-HOLD
 21948          MOVE 'ON HOLD'             TO CBILIT2O.
 21949
 21950     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21951       IF PB-RECORD-RETURNED
 21952          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 407
* EL6311.cbl
 21953
 21954     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21955        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 21956             MOVE 'OVERRIDE'         TO CBILIT2O.
 21957
 21958     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 21959     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 21960     IF PB-C-POST-CARD-IND = 'Y'
 21961        MOVE 'Y'                     TO CPCYNO
 21962     ELSE
 21963        MOVE 'N'                     TO CPCYNO
 21964     END-IF
 21965     MOVE PB-FORCE-CODE              TO CFORCEO.
 21966     MOVE PB-RECORD-BILL             TO CBILCDO.
 21967     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 21968     MOVE SPACES                     TO CINITSO.
 21969     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 21970         MOVE PB-CI-FIRST-NAME       TO CINITSO
 21971     ELSE
 21972         MOVE PB-CI-INITIALS         TO CINITSO
 21973     END-IF.
 21974
 21975     IF PB-CI-CANCEL-FEE NUMERIC
 21976        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 21977        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 21978     ELSE
 21979        MOVE ZEROES                  TO W-CANCEL-FEE.
 21980
 21981     MOVE W-CANCEL-FEE               TO CCANFEEO.
 21982
 21983     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 21984        ADD PB-CI-LF-PREMIUM-AMT
 21985             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 21986
 21987     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 21988        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 21989
 21990     MOVE PB-CI-LF-TERM              TO CTERM1O.
 21991     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 21992     MOVE PB-CI-AH-TERM              TO CTERM2O.
 21993     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 21994
 21995     IF PB-C-LIVES NUMERIC
 21996        MOVE PB-C-LIVES              TO CLIVESO.
 21997
 21998     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 21999        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22000
 22001     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22002        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22003        MOVE SPACE                   TO DC-OPTION-CODE
 22004        PERFORM 9700-DATE-LINK
 22005        IF NO-CONVERSION-ERROR
 22006           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22007
 22008     IF  PB-C-REFUND-CREATED
 22009         MOVE 'YES'                  TO CRFNDSWO
 22010     ELSE
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 408
* EL6311.cbl
 22011         IF PB-C-REFUND-REQUESTED
 22012            MOVE 'REQ'               TO CRFNDSWO
 22013         ELSE
 22014            MOVE 'NO'                TO CRFNDSWO.
 22015
 22016     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22017     MOVE SPACE                      TO DC-OPTION-CODE.
 22018     PERFORM 9700-DATE-LINK.
 22019     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22020     MOVE PB-INPUT-BY                TO CENTBYO.
 22021
 22022     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22023        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22024        MOVE SPACE                   TO DC-OPTION-CODE
 22025        PERFORM 9700-DATE-LINK
 22026        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22027        MOVE 'INACTIVE'              TO CMOENDTO
 22028     ELSE
 22029        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22030        MOVE SPACE                   TO DC-OPTION-CODE
 22031        PERFORM 9700-DATE-LINK
 22032        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22033        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22034        MOVE SPACE                   TO DC-OPTION-CODE
 22035        PERFORM 9700-DATE-LINK
 22036        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22037
 22038     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22039
 22040     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22041     MOVE WS-HR-MINS                 TO CMANTATO.
 22042
 22043     EVALUATE PB-LF-REFUND-TYPE
 22044        WHEN '1'
 22045           MOVE 'RULE78'            TO CLFREFNO
 22046        WHEN '2'
 22047           MOVE 'PRORAT'            TO CLFREFNO
 22048        WHEN '3'
 22049           MOVE 'CALIF'             TO CLFREFNO
 22050        WHEN '4'
 22051           MOVE 'IRREG'             TO CLFREFNO
 22052        WHEN '5'
 22053           MOVE 'NETPAY'            TO CLFREFNO
 22054        WHEN '6'
 22055           MOVE 'ATCP'              TO CLFREFNO
 22056        WHEN '7'
 22057           MOVE 'UTAH'              TO CLFREFNO
 22058        WHEN '8'
 22059           MOVE 'MEAN'              TO CLFREFNO
 22060        WHEN '9'
 22061           MOVE 'SUM '              TO CLFREFNO
 22062        WHEN 'B'
 22063           MOVE 'BALN'              TO CLFREFNO
 22064     END-EVALUATE.
 22065
 22066     EVALUATE TRUE
 22067        WHEN PB-AH-REFUND-TYPE =  '1'
 22068           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 409
* EL6311.cbl
 22069        WHEN PB-AH-REFUND-TYPE =  '2'
 22070           MOVE 'PRORAT'            TO CAHREFNO
 22071        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22072           MOVE 'CALIF'             TO CAHREFNO
 22073        WHEN PB-AH-REFUND-TYPE =  '4'
 22074           MOVE 'IRREG'             TO CAHREFNO
 22075        WHEN PB-AH-REFUND-TYPE =  '5'
 22076           MOVE 'NETPAY'            TO CAHREFNO
 22077        WHEN PB-AH-REFUND-TYPE =  '6'
 22078           MOVE 'ATCP'              TO CAHREFNO
 22079        WHEN PB-AH-REFUND-TYPE =  '7'
 22080           MOVE 'UTAH'              TO CAHREFNO
 22081        WHEN PB-AH-REFUND-TYPE =  '8'
 22082           MOVE 'MEAN'              TO CAHREFNO
 22083        WHEN PB-AH-REFUND-TYPE =  '9'
 22084           MOVE 'SUM '              TO CAHREFNO
 22085        WHEN PB-AH-REFUND-TYPE =  'B'
 22086           MOVE 'BALN'              TO CAHREFNO
 22087     END-EVALUATE.
 22088
 22089     MOVE PB-REIN-CD                 TO CREINCDO.
 22090
 22091     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22092        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22093        MOVE SPACE                   TO DC-OPTION-CODE
 22094        PERFORM 9700-DATE-LINK
 22095        IF NO-CONVERSION-ERROR
 22096           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22097
 22098     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22099        MOVE 999999                  TO WS-EXP-DT-EDIT
 22100        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22101        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22102     ELSE
 22103        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22104           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22105           MOVE SPACE                   TO DC-OPTION-CODE
 22106           PERFORM 9700-DATE-LINK
 22107           IF NO-CONVERSION-ERROR
 22108              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22109
 22110     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22111        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22112           MOVE AL-SANOF                TO CORIGHDA
 22113           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22114           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22115
 22116     MOVE PB-CSR-ID              TO CCSRO.
 22117
 22118     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22119     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22120
 22121     MOVE 'C'                    TO CMAINTI.
 22122     MOVE AL-UANON               TO CMAINTA.
 22123
 22124     IF PI-6316-FINALIZED = 'Y'  AND
 22125        PB-UNFORCED-ERRORS
 22126          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 410
* EL6311.cbl
 22127          MOVE  1                TO SET-CURSOR-SW
 22128     END-IF
 22129
 22130     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22131        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22132
 22133     IF NO-CURSOR-SET
 22134        MOVE -1                  TO CMAINTL.
 22135
 22136     GO TO 8100-SEND-INITIAL-MAP.
 22137
 22138
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 411
* EL6311.cbl
 22140***************************************************************
 22141*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22142*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22143***************************************************************
 22144
 22145 7200-DISPLAY-BATCHES.
 22146     MOVE EL631D                 TO PI-MAP-NAME.
 22147     MOVE LOW-VALUES             TO EL631DI.
 22148
 22149     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22150
 22151
 22152* EXEC CICS HANDLE CONDITION
 22153*         NOTFND   (3690-NOT-FOUND)
 22154*    END-EXEC.
 22155*    MOVE '"$I                   ! Y #00018528' TO DFHEIV0
 22156     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22157     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22158     MOVE X'5920233030303138353238' TO DFHEIV0(25:11)
 22159     CALL 'kxdfhei1' USING DFHEIV0
 22160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22161
 22162
 22163     IF PI-DISPLAY-SCREEN
 22164        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22165     ELSE
 22166        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22167
 22168     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22169     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22170
 22171
 22172* EXEC CICS READ
 22173*         DATASET   (FILE-ID-ERPNDB)
 22174*         RIDFLD    (ERPNDB-KEY)
 22175*         SET       (ADDRESS OF PENDING-BUSINESS)
 22176*    END-EXEC.
 22177*    MOVE '&"S        E          (   #00018540' TO DFHEIV0
 22178     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22179     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22180     MOVE X'2020233030303138353430' TO DFHEIV0(25:11)
 22181     CALL 'kxdfhei1' USING DFHEIV0,
 22182           FILE-ID-ERPNDB,
 22183           DFHEIV20,
 22184           DFHEIV99,
 22185           ERPNDB-KEY,
 22186           DFHEIV99,
 22187           DFHEIV99,
 22188           DFHEIV99
 22189     SET ADDRESS OF PENDING-BUSINESS TO
 22190         DFHEIV20
 22191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22192
 22193
 22194     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22195     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22196     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22197     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 412
* EL6311.cbl
 22198     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22199
 22200     MOVE EL631D                 TO PI-MAP-NAME.
 22201     MOVE LOW-VALUES             TO EL631DI.
 22202     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22203
 22204*    IF PI-AR-PROCESSING
 22205*       MOVE PB-REFERENCE        TO DREFO.
 22206
 22207     MOVE PB-CSR-ID              TO DCSRO.
 22208
 22209     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22210        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 22211        MOVE SPACE               TO DC-OPTION-CODE
 22212        PERFORM 9700-DATE-LINK
 22213        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 22214        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 22215        MOVE 'INACTIVE'          TO DLDATEO
 22216     ELSE
 22217        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 22218        MOVE SPACE               TO DC-OPTION-CODE
 22219        PERFORM 9700-DATE-LINK
 22220        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 22221
 22222     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 22223     MOVE SPACE                  TO DC-OPTION-CODE.
 22224     PERFORM 9700-DATE-LINK.
 22225     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 22226
 22227     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 22228        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 22229     ELSE
 22230        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 22231        MOVE SPACE               TO DC-OPTION-CODE
 22232        PERFORM 9700-DATE-LINK
 22233        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 22234
 22235     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 22236     MOVE SPACE                  TO DC-OPTION-CODE.
 22237     PERFORM 9700-DATE-LINK.
 22238     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 22239
 22240     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 22241     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 22242
 22243     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 22244        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 22245                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 22246
 22247     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 22248     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 22249     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 22250
 22251     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 22252        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 22253                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 22254
 22255     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 413
* EL6311.cbl
 22256     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 22257     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 22258
 22259     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 22260        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 22261                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 22262
 22263     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 22264     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 22265
 22266     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 22267        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 22268                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 22269
 22270     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 22271     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 22272     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 22273
 22274     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 22275        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 22276                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 22277
 22278     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 22279     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 22280     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 22281
 22282     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 22283        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 22284                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 22285
 22286     MOVE -1                     TO DPFENTRL.
 22287     GO TO 8100-SEND-INITIAL-MAP.
 22288
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 414
* EL6311.cbl
 22290
 22291***************************************************************
 22292*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 22293*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 22294*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 22295*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 22296*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 22297*     ARE THEN SET ACCORDINGLY.                               *
 22298*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 22299*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 22300*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 22301***************************************************************
 22302
 22303******************************************************************
 22304*                                                                *
 22305*            E R R O R   A N A L Y S I S                         *
 22306*                                                                *
 22307******************************************************************
 22308
 22309******************************************************************
 22310*                                                                *
 22311*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 22312*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 22313*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 22314*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 22315*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 22316*                                                                *
 22317*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 22318*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 22319*                                                                *
 22320******************************************************************
 22321
 22322 7300-FORMAT-ERRORS.
 22323     MOVE ' '                    TO PI-ERRORS-SW
 22324     IF PB-COMMON-ERRORS = LOW-VALUES
 22325        IF PB-FATAL-ERRORS
 22326           MOVE ER-2695          TO EMI-ERROR
 22327           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22328           GO TO 7399-EXIT.
 22329
 22330     MOVE +0                     TO WS-SUB4.
 22331
 22332 7310-ERROR-LOOP.
 22333
 22334     ADD +1                      TO WS-SUB4.
 22335
 22336     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22337        GO TO 7350-SET-ERROR-FLAGS.
 22338
 22339     IF PI-COMPANY-ID = 'UCL'
 22340         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 22341             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 22342             MOVE ' '                   TO DC-OPTION-CODE
 22343             PERFORM 9700-DATE-LINK
 22344             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 22345
 22346     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 22347     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 415
* EL6311.cbl
 22348     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 22349
 22350     GO TO 7310-ERROR-LOOP.
 22351
 22352
 22353 7350-SET-ERROR-FLAGS.
 22354
 22355     IF EMI-FATAL-CTR NOT = ZEROS
 22356        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22357        MOVE 'X'                 TO PB-FATAL-FLAG
 22358                                    PI-ERRORS-SW
 22359        GO TO 7355-SET-ERROR-FLAGS.
 22360
 22361     IF EMI-FORCABLE-CTR NOT = ZEROS
 22362        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22363        IF PB-ISSUE
 22364           IF PB-ISSUE-FORCE
 22365              MOVE 'F'           TO PB-FORCE-ER-CD
 22366              MOVE ER-2600       TO EMI-ERROR
 22367              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22368             ELSE
 22369              MOVE 'X'           TO PB-FORCE-ER-CD
 22370*                                   PI-ERRORS-SW
 22371          ELSE
 22372           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 22373              MOVE 'F'           TO PB-FORCE-ER-CD
 22374              MOVE ER-2600       TO EMI-ERROR
 22375              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22376             ELSE
 22377              MOVE 'X'           TO PB-FORCE-ER-CD.
 22378*                                   PI-ERRORS-SW.
 22379
 22380     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 22381     IF PB-ISSUE
 22382         MOVE 'I'                TO ENDT-RECORD-TYPE
 22383     ELSE
 22384         MOVE 'C'                TO ENDT-RECORD-TYPE
 22385     END-IF
 22386     MOVE +0                     TO ENDT-SEQ-NO
 22387
 22388
 22389* EXEC CICS READ
 22390*        DATASET   (FILE-ID-ERENDT)
 22391*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 22392*        RIDFLD    (ERENDT-KEY)
 22393*        RESP      (WS-RESPONSE)
 22394*        GTEQ
 22395*    END-EXEC
 22396*    MOVE '&"S        G          (  N#00018740' TO DFHEIV0
 22397     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22398     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22399     MOVE X'204E233030303138373430' TO DFHEIV0(25:11)
 22400     CALL 'kxdfhei1' USING DFHEIV0,
 22401           FILE-ID-ERENDT,
 22402           DFHEIV20,
 22403           DFHEIV99,
 22404           ERENDT-KEY,
 22405           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 416
* EL6311.cbl
 22406           DFHEIV99,
 22407           DFHEIV99
 22408     SET ADDRESS OF ENDORSEMENT-RECORD TO
 22409         DFHEIV20
 22410     MOVE EIBRESP  TO WS-RESPONSE
 22411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22412
 22413     IF RESP-NORMAL
 22414        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 22415        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 22416            MOVE ER-0280          TO EMI-ERROR
 22417            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22418            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 22419            EVALUATE TRUE
 22420              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 22421                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 22422              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 22423                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 22424              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 22425                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 22426            END-EVALUATE
 22427        END-IF
 22428     END-IF
 22429
 22430
 22431
 22432     IF FIRST-ENTRY OR
 22433        EIBAID = DFHPF1 OR DFHPF2
 22434        MOVE '0'                TO PI-EDIT-SW
 22435        GO TO 7399-EXIT.
 22436
 22437 7355-SET-ERROR-FLAGS.
 22438
 22439     IF EMI-WARNING-CTR NOT = ZEROS
 22440        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22441        MOVE 'W'                 TO PB-WARN-ER-CD.
 22442
 22443     IF PB-UNFORCED-ERRORS OR
 22444        PB-FATAL-ERRORS    OR
 22445        PB-RECORD-ON-HOLD  OR
 22446        PB-RECORD-RETURNED OR
 22447        PB-CANCELLATION
 22448          NEXT SENTENCE
 22449        ELSE
 22450          GO TO 7399-EXIT.
 22451
 22452
 22453* EXEC CICS  HANDLE CONDITION
 22454*           NOTFND   (7399-EXIT)
 22455*    END-EXEC.
 22456*    MOVE '"$I                   ! Z #00018787' TO DFHEIV0
 22457     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22458     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22459     MOVE X'5A20233030303138373837' TO DFHEIV0(25:11)
 22460     CALL 'kxdfhei1' USING DFHEIV0
 22461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22462
 22463
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 417
* EL6311.cbl
 22464     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 22465     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 22466     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 22467     MOVE PB-SV-STATE            TO ELCERT-STATE.
 22468
 22469
 22470* EXEC CICS READ
 22471*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 22472*        DATASET (FILE-ID-ELCERT)
 22473*        RIDFLD  (ELCERT-KEY)
 22474*        UPDATE
 22475*    END-EXEC.
 22476*    MOVE '&"S        EU         (   #00018796' TO DFHEIV0
 22477     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22478     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22479     MOVE X'2020233030303138373936' TO DFHEIV0(25:11)
 22480     CALL 'kxdfhei1' USING DFHEIV0,
 22481           FILE-ID-ELCERT,
 22482           DFHEIV20,
 22483           DFHEIV99,
 22484           ELCERT-KEY,
 22485           DFHEIV99,
 22486           DFHEIV99,
 22487           DFHEIV99
 22488     SET ADDRESS OF CERTIFICATE-MASTER TO
 22489         DFHEIV20
 22490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22491
 22492
 22493
 22494     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 22495     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 22496
 22497     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 22498        GO TO 7360-REWRITE-CERT-MASTER.
 22499
 22500     IF PB-ISSUE
 22501        IF PB-RECORD-RETURNED
 22502            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 22503            GO TO 7360-REWRITE-CERT-MASTER
 22504        ELSE
 22505            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 22506            GO TO 7360-REWRITE-CERT-MASTER.
 22507
 22508     IF PB-RECORD-RETURNED
 22509         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 22510         GO TO 7360-REWRITE-CERT-MASTER.
 22511
 22512     IF (PB-C-LF-CANCEL-VOIDED)
 22513        or (pb-c-ah-cancel-voided)
 22514        IF (PB-UNFORCED-ERRORS OR
 22515            PB-FATAL-ERRORS    OR
 22516            PB-RECORD-ON-HOLD)
 22517            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 22518            GO TO 7360-REWRITE-CERT-MASTER
 22519        ELSE
 22520            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 22521            GO TO 7360-REWRITE-CERT-MASTER.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 418
* EL6311.cbl
 22522
 22523     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 22524                            OR PB-RECORD-ON-HOLD)
 22525        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 22526     ELSE
 22527        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 22528
 22529 7360-REWRITE-CERT-MASTER.
 22530
 22531     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 22532        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 22533
 22534* EXEC CICS UNLOCK
 22535*            DATASET    (FILE-ID-ELCERT)
 22536*       END-EXEC
 22537*    MOVE '&*                    #   #00018843' TO DFHEIV0
 22538     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22539     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22540     MOVE X'2020233030303138383433' TO DFHEIV0(25:11)
 22541     CALL 'kxdfhei1' USING DFHEIV0,
 22542           FILE-ID-ELCERT,
 22543           DFHEIV99
 22544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22545        GO TO 7399-EXIT.
 22546
 22547
 22548* EXEC CICS REWRITE
 22549*         DATASET    (FILE-ID-ELCERT)
 22550*         FROM       (CERTIFICATE-MASTER)
 22551*    END-EXEC.
 22552     MOVE LENGTH OF
 22553      CERTIFICATE-MASTER
 22554       TO DFHEIV11
 22555*    MOVE '&& L                  %   #00018848' TO DFHEIV0
 22556     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22557     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22558     MOVE X'2020233030303138383438' TO DFHEIV0(25:11)
 22559     CALL 'kxdfhei1' USING DFHEIV0,
 22560           FILE-ID-ELCERT,
 22561           CERTIFICATE-MASTER,
 22562           DFHEIV11,
 22563           DFHEIV99
 22564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22565
 22566
 22567 7399-EXIT.
 22568      EXIT.
 22569
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 419
* EL6311.cbl
 22571
 22572*************************************************************
 22573*                                                           *
 22574*              S E T   A T T R I B U T E S                  *
 22575*                                                           *
 22576*************************************************************
 22577
 22578 7400-SET-ATTRIBUTES.
 22579
 22580     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22581        GO TO 7499-EXIT.
 22582
 22583**2601**
 22584
 22585     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 22586        IF PB-ISSUE
 22587           MOVE AL-UABON         TO BEFFDTA
 22588           GO TO 7499-EXIT
 22589         ELSE
 22590           MOVE AL-UABON         TO CEFFDTA
 22591           GO TO 7499-EXIT.
 22592
 22593**2604**
 22594
 22595     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 22596        IF PB-ISSUE
 22597           MOVE AL-UABON         TO BTYPE1A
 22598           MOVE -1               TO BTYPE1L
 22599           MOVE  1               TO SET-CURSOR-SW
 22600           GO TO 7499-EXIT.
 22601
 22602**2605**
 22603
 22604     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 22605        IF PB-ISSUE
 22606           MOVE AL-UABON         TO BTYPE2A
 22607           MOVE -1               TO BTYPE2L
 22608           MOVE  1               TO SET-CURSOR-SW
 22609           GO TO 7499-EXIT.
 22610
 22611**2606**
 22612
 22613     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 22614        IF PB-ISSUE
 22615           MOVE AL-UABON         TO BSIGA
 22616           MOVE -1               TO BSIGL
 22617           MOVE  1               TO SET-CURSOR-SW
 22618           GO TO 7499-EXIT.
 22619
 22620**2607**
 22621
 22622     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 22623        IF PB-ISSUE
 22624           MOVE AL-UABON         TO BSIGA
 22625           MOVE -1               TO BSIGL
 22626           MOVE  1               TO SET-CURSOR-SW
 22627           GO TO 7499-EXIT.
 22628
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 420
* EL6311.cbl
 22629**2615**
 22630
 22631     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 22632        IF PB-ISSUE
 22633           MOVE AL-UABOF         TO BREINA
 22634           MOVE -1               TO BREINL
 22635           GO TO 7499-EXIT.
 22636
 22637**2622**
 22638
 22639     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 22640        IF PB-ISSUE
 22641           MOVE AL-UABON         TO BEFFDTA
 22642           GO TO 7499-EXIT
 22643        ELSE
 22644           MOVE AL-UABON         TO CEFFDTA
 22645           GO TO 7499-EXIT.
 22646
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 421
* EL6311.cbl
 22648
 22649*************************************************************
 22650*                                                           *
 22651*              I S S U E   E R R O R S                      *
 22652*                                                           *
 22653*************************************************************
 22654
 22655 7420-ISSUE-ERRORS.
 22656
 22657**2626**
 22658
 22659     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 22660        MOVE AL-UABON            TO BCERTNOA
 22661        GO TO 7499-EXIT.
 22662
 22663**2627**
 22664
 22665     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 22666        MOVE AL-UNBON            TO BAGEA
 22667        MOVE -1                  TO BAGEL
 22668        MOVE  1                  TO SET-CURSOR-SW
 22669        GO TO 7499-EXIT.
 22670
 22671**2628**
 22672
 22673     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 22674        MOVE AL-UNBON            TO BAGEA
 22675        MOVE -1                  TO BAGEL
 22676        MOVE  1                  TO SET-CURSOR-SW
 22677        GO TO 7499-EXIT.
 22678
 22679**2629**
 22680
 22681     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 22682        MOVE AL-UABON            TO BSEXA
 22683        MOVE -1                  TO BSEXL
 22684        MOVE  1                  TO SET-CURSOR-SW
 22685        GO TO 7499-EXIT.
 22686
 22687**2630**
 22688
 22689     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 22690        MOVE -1                  TO BTYPE1L
 22691        MOVE  1                  TO SET-CURSOR-SW
 22692        GO TO 7499-EXIT.
 22693
 22694**2631**
 22695
 22696     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 22697        MOVE -1                  TO BTYPE1L
 22698        MOVE  1                  TO SET-CURSOR-SW
 22699        GO TO 7499-EXIT.
 22700
 22701**2632**
 22702
 22703     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 22704        MOVE AL-UNBON            TO BBEN1A
 22705        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 422
* EL6311.cbl
 22706        MOVE  1                  TO SET-CURSOR-SW
 22707        GO TO 7499-EXIT.
 22708
 22709**2633**
 22710
 22711     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 22712        MOVE AL-UNBON            TO BPREM1A
 22713        MOVE -1                  TO BPREM1L
 22714        MOVE  1                  TO SET-CURSOR-SW
 22715        GO TO 7499-EXIT.
 22716
 22717**2634**
 22718
 22719     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 22720        MOVE -1                  TO BTYPE2L
 22721        MOVE  1                  TO SET-CURSOR-SW
 22722        GO TO 7499-EXIT.
 22723
 22724**2635**
 22725
 22726     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 22727        MOVE AL-UNBON            TO BBEN2A
 22728        MOVE -1                  TO BBEN2L
 22729        MOVE  1                  TO SET-CURSOR-SW
 22730        GO TO 7499-EXIT.
 22731
 22732**2636**
 22733
 22734     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 22735        MOVE AL-UNBON            TO BPREM2A
 22736        MOVE -1                  TO BPREM2L
 22737        MOVE  1                  TO SET-CURSOR-SW
 22738        GO TO 7499-EXIT.
 22739
 22740**2639**
 22741
 22742     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 22743        MOVE AL-UNBON            TO BBEN1A
 22744        MOVE -1                  TO BBEN1L
 22745        MOVE  1                  TO SET-CURSOR-SW
 22746        GO TO 7499-EXIT.
 22747
 22748**2640**
 22749
 22750     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 22751        MOVE AL-UNBON            TO BBEN2A
 22752        MOVE -1                  TO BBEN2L
 22753        MOVE  1                  TO SET-CURSOR-SW
 22754        GO TO 7499-EXIT.
 22755
 22756**2647**
 22757
 22758     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 22759        MOVE AL-UNBON            TO BTERM1A
 22760        MOVE -1                  TO BTERM1L
 22761        MOVE  1                  TO SET-CURSOR-SW
 22762        GO TO 7499-EXIT.
 22763
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 423
* EL6311.cbl
 22764**2648**
 22765
 22766     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 22767        MOVE AL-UNBON            TO BLNTRMA
 22768        MOVE -1                  TO BLNTRML
 22769        MOVE  1                  TO SET-CURSOR-SW
 22770        GO TO 7499-EXIT.
 22771
 22772**2649**
 22773
 22774     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 22775        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22776            MOVE AL-UNBON            TO BPREM1A
 22777            MOVE -1                  TO BPREM1L
 22778            MOVE  1                  TO SET-CURSOR-SW
 22779            GO TO 7499-EXIT
 22780     ELSE
 22781        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 22782           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22783            MOVE AL-UNBON            TO BPREM2A
 22784            MOVE -1                  TO BPREM2L
 22785            MOVE  1                  TO SET-CURSOR-SW
 22786            GO TO 7499-EXIT.
 22787
 22788**2650**
 22789
 22790     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 22791        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22792            MOVE AL-UNBON        TO BPREM1A
 22793            MOVE -1              TO BPREM1L
 22794            MOVE  1              TO SET-CURSOR-SW
 22795            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22796                MOVE AL-UNBON        TO BPREM2A
 22797                MOVE -1              TO BPREM2L
 22798                MOVE  1              TO SET-CURSOR-SW
 22799                GO TO 7499-EXIT
 22800            ELSE
 22801                GO TO 7499-EXIT
 22802        ELSE
 22803            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22804                MOVE AL-UNBON        TO BPREM2A
 22805                MOVE -1              TO BPREM2L
 22806                MOVE  1              TO SET-CURSOR-SW
 22807                GO TO 7499-EXIT
 22808            ELSE
 22809                GO TO 7499-EXIT.
 22810
 22811**2651**
 22812
 22813     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 22814        MOVE AL-UABON            TO BSIGA
 22815        MOVE -1                  TO BSIGL
 22816        MOVE  1                  TO SET-CURSOR-SW
 22817        GO TO 7499-EXIT.
 22818
 22819**2653**
 22820
 22821     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 424
* EL6311.cbl
 22822        MOVE AL-UABON            TO BFREQA
 22823        MOVE -1                  TO BFREQL
 22824        MOVE  1                  TO SET-CURSOR-SW
 22825        GO TO 7499-EXIT.
 22826
 22827**2654**
 22828
 22829     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 22830        MOVE AL-UABON            TO BFREQA
 22831        MOVE -1                  TO BFREQL
 22832        MOVE  1                  TO SET-CURSOR-SW
 22833        GO TO 7499-EXIT.
 22834
 22835**2655**
 22836
 22837     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 22838        MOVE AL-UABON            TO BFREQA
 22839        MOVE -1                  TO BFREQL
 22840        MOVE  1                  TO SET-CURSOR-SW
 22841        GO TO 7499-EXIT.
 22842
 22843**2656**
 22844
 22845     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 22846        MOVE AL-UNBON            TO BAPRA
 22847        MOVE -1                  TO BAPRL
 22848        MOVE  1                  TO SET-CURSOR-SW
 22849        GO TO 7499-EXIT.
 22850
 22851**2657**
 22852
 22853     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 22854        MOVE AL-UNBON            TO BAPRA
 22855        MOVE -1                  TO BAPRL
 22856        MOVE  1                  TO SET-CURSOR-SW
 22857        GO TO 7499-EXIT.
 22858
 22859**2658**
 22860
 22861     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 22862        MOVE AL-UNBON            TO BTERM2A
 22863        MOVE -1                  TO BTERM2L
 22864        MOVE  1                  TO SET-CURSOR-SW
 22865        GO TO 7499-EXIT.
 22866
 22867**2660**
 22868
 22869     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 22870        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 22871        MOVE -1                  TO BLSTNML
 22872        MOVE  1                  TO SET-CURSOR-SW
 22873        GO TO 7499-EXIT.
 22874
 22875
 22876**2662**
 22877
 22878     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 22879        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 425
* EL6311.cbl
 22880        MOVE -1                  TO BAGEL
 22881        MOVE  1                  TO SET-CURSOR-SW
 22882        GO TO 7499-EXIT.
 22883
 22884**2663**
 22885
 22886     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 22887        MOVE AL-UNBON            TO BAGEA
 22888        MOVE -1                  TO BAGEL
 22889        MOVE  1                  TO SET-CURSOR-SW
 22890        GO TO 7499-EXIT.
 22891
 22892**2664**
 22893
 22894     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 22895        MOVE AL-UABON            TO BREINA
 22896        MOVE -1                  TO BREINL
 22897        MOVE  1                  TO SET-CURSOR-SW
 22898        GO TO 7499-EXIT.
 22899
 22900**2667**
 22901
 22902     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 22903        MOVE AL-UNBON            TO BBEN2A
 22904        MOVE -1                  TO BBEN2L
 22905        MOVE  1                  TO SET-CURSOR-SW
 22906        GO TO 7499-EXIT.
 22907
 22908**2668**
 22909
 22910     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 22911        MOVE AL-UABON            TO BEFFDTA
 22912        GO TO 7499-EXIT.
 22913
 22914**2669**
 22915
 22916     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 22917       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 22918       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 22919        MOVE AL-UNBON            TO BAGEA
 22920        MOVE -1                  TO BAGEL
 22921        MOVE  1                  TO SET-CURSOR-SW
 22922        GO TO 7499-EXIT.
 22923
 22924**2670**
 22925
 22926     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 22927        MOVE AL-UABON            TO BFORCEA
 22928        MOVE -1                  TO BFORCEL
 22929        MOVE  1                  TO SET-CURSOR-SW
 22930        GO TO 7499-EXIT.
 22931
 22932**2671**
 22933
 22934     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 22935        MOVE AL-UABON            TO BEFFDTA
 22936        GO TO 7499-EXIT.
 22937
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 426
* EL6311.cbl
 22938**2672**
 22939
 22940     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 22941        MOVE AL-UABON            TO BEFFDTA
 22942        GO TO 7499-EXIT.
 22943
 22944**2673**
 22945
 22946     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 22947        MOVE AL-UABON            TO BEFFDTA
 22948        GO TO 7499-EXIT.
 22949
 22950**2674**
 22951
 22952     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 22953        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 22954        MOVE -1                  TO BTYPE1L
 22955        MOVE  1                  TO SET-CURSOR-SW
 22956        GO TO 7499-EXIT.
 22957
 22958**2677**
 22959
 22960     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 22961        MOVE AL-UNBON            TO BTERM1A
 22962        MOVE -1                  TO BTERM1L
 22963        MOVE  1                  TO SET-CURSOR-SW
 22964        GO TO 7499-EXIT.
 22965
 22966**2678**
 22967
 22968     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 22969        MOVE AL-UNBON            TO BTERM2A
 22970        MOVE -1                  TO BTERM2L
 22971        MOVE  1                  TO SET-CURSOR-SW
 22972        GO TO 7499-EXIT.
 22973
 22974**2679**
 22975
 22976     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 22977        MOVE AL-UABON            TO BTYPE1A
 22978        MOVE -1                  TO BTYPE1L
 22979        MOVE  1                  TO SET-CURSOR-SW
 22980        GO TO 7499-EXIT.
 22981
 22982**2680**
 22983
 22984     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 22985        MOVE AL-UABOF            TO B1STPMTA
 22986        MOVE -1                  TO B1STPMTL
 22987        MOVE  1                  TO SET-CURSOR-SW
 22988        GO TO 7499-EXIT.
 22989
 22990**2681**
 22991
 22992     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 22993        MOVE AL-UABON            TO BDAYSA
 22994        MOVE -1                  TO BDAYSL
 22995        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 427
* EL6311.cbl
 22996        GO TO 7499-EXIT.
 22997
 22998**2682**
 22999
 23000     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23001        MOVE AL-UABON            TO BTERM1A
 23002        MOVE -1                  TO BTERM1L
 23003        MOVE  1                  TO SET-CURSOR-SW
 23004        GO TO 7499-EXIT.
 23005
 23006**2683**
 23007
 23008     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23009        MOVE AL-UABON            TO BSKPCDA
 23010        MOVE -1                  TO BSKPCDL
 23011        MOVE  1                  TO SET-CURSOR-SW
 23012        GO TO 7499-EXIT.
 23013
 23014**2684**
 23015
 23016     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23017        MOVE AL-UABON            TO BTYPE2A
 23018        MOVE -1                  TO BTYPE2L
 23019        MOVE  1                  TO SET-CURSOR-SW
 23020        GO TO 7499-EXIT.
 23021
 23022**2686**
 23023
 23024     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23025        MOVE AL-UABON            TO BTYPE2A
 23026        MOVE -1                  TO BTYPE2L
 23027        MOVE  1                  TO SET-CURSOR-SW
 23028        GO TO 7499-EXIT.
 23029
 23030**2689**
 23031
 23032     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23033        MOVE AL-UABON            TO BSIGA
 23034        MOVE -1                  TO BSIGL
 23035        MOVE  1                  TO SET-CURSOR-SW
 23036        GO TO 7499-EXIT.
 23037
 23038**2690**
 23039
 23040     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23041        MOVE AL-UABOF            TO BLNOFCRA
 23042        MOVE -1                  TO BLNOFCRL
 23043        MOVE  1                  TO SET-CURSOR-SW
 23044        GO TO 7499-EXIT.
 23045
 23046**2693**
 23047
 23048     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23049        MOVE AL-UABOF            TO BLNOFCRA
 23050        MOVE AL-UNBON            TO BBEN1A
 23051        MOVE -1                  TO BBEN1L
 23052        MOVE  1                  TO SET-CURSOR-SW
 23053        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 428
* EL6311.cbl
 23054
 23055**2720**
 23056
 23057     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23058        MOVE AL-UNBON            TO BBEN1A
 23059        MOVE -1                  TO BBEN1L
 23060        MOVE  1                  TO SET-CURSOR-SW
 23061        GO TO 7499-EXIT.
 23062
 23063**2709**
 23064
 23065*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23066*       MOVE AL-UNBON            TO BBEN1A
 23067*       MOVE -1                  TO BBEN1L
 23068*       MOVE  1                  TO SET-CURSOR-SW
 23069*       GO TO 7499-EXIT.
 23070
 23071*************************************************************
 23072*                                                           *
 23073*            C A N C E L   E R R O R S                      *
 23074*                                                           *
 23075*************************************************************
 23076
 23077**2726**
 23078
 23079     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23080        MOVE AL-UABON            TO CCERTNOA
 23081        GO TO 7499-EXIT.
 23082
 23083**2728**
 23084
 23085     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23086        MOVE AL-UABON            TO CCERTNOA
 23087        GO TO 7499-EXIT.
 23088
 23089**2729**
 23090
 23091     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23092        MOVE AL-UABON            TO CCERTNOA
 23093        GO TO 7499-EXIT.
 23094
 23095**2730**
 23096
 23097     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23098        MOVE AL-UABON            TO CCERTNOA
 23099        GO TO 7499-EXIT.
 23100
 23101**2731**
 23102
 23103     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23104        MOVE AL-UABON            TO CCANDT1A
 23105        MOVE -1                  TO CCANDT1L
 23106        MOVE  1                  TO SET-CURSOR-SW
 23107        GO TO 7499-EXIT.
 23108
 23109**2732**
 23110
 23111     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 429
* EL6311.cbl
 23112        MOVE AL-UABON            TO CCANDT1A
 23113        MOVE -1                  TO CCANDT1L
 23114        MOVE  1                  TO SET-CURSOR-SW
 23115        GO TO 7499-EXIT.
 23116
 23117**2733**
 23118
 23119     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23120        MOVE AL-UABON            TO CCANDT1A
 23121        MOVE -1                  TO CCANDT1L
 23122        MOVE  1                  TO SET-CURSOR-SW
 23123        GO TO 7499-EXIT.
 23124
 23125**2734**
 23126
 23127     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23128        MOVE AL-UNBON            TO CREFND1A
 23129        MOVE -1                  TO CREFND1L
 23130        MOVE  1                  TO SET-CURSOR-SW
 23131        GO TO 7499-EXIT.
 23132
 23133**2735**
 23134
 23135     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23136        MOVE AL-UABON            TO CCANDT2A
 23137        MOVE -1                  TO CCANDT2L
 23138        MOVE  1                  TO SET-CURSOR-SW
 23139        GO TO 7499-EXIT.
 23140
 23141**2736**
 23142
 23143     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23144        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23145            MOVE AL-UNBON        TO CREFND1A
 23146            MOVE -1              TO CREFND1L
 23147            MOVE  1              TO SET-CURSOR-SW
 23148            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23149                MOVE AL-UNBON        TO CREFND2A
 23150                MOVE -1              TO CREFND2L
 23151                MOVE  1              TO SET-CURSOR-SW
 23152                GO TO 7499-EXIT
 23153            ELSE
 23154                GO TO 7499-EXIT
 23155        ELSE
 23156            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23157                MOVE AL-UNBON        TO CREFND2A
 23158                MOVE -1              TO CREFND2L
 23159                MOVE  1              TO SET-CURSOR-SW
 23160                GO TO 7499-EXIT
 23161            ELSE
 23162                GO TO 7499-EXIT.
 23163
 23164**2738**
 23165
 23166     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23167        MOVE -1                  TO CREFND2L
 23168        MOVE  1                  TO SET-CURSOR-SW
 23169        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 430
* EL6311.cbl
 23170
 23171**2739**
 23172
 23173     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23174        MOVE -1                  TO CREFND1L
 23175        MOVE  1                  TO SET-CURSOR-SW
 23176        GO TO 7499-EXIT.
 23177
 23178**2741**
 23179
 23180     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23181        MOVE -1                  TO CREFND1L
 23182        MOVE  1                  TO SET-CURSOR-SW
 23183        GO TO 7499-EXIT.
 23184
 23185**2743**
 23186
 23187     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23188        MOVE AL-UNBON            TO CCANDT1A
 23189        MOVE -1                  TO CCANDT1L
 23190        MOVE  1                  TO SET-CURSOR-SW
 23191        GO TO 7499-EXIT.
 23192
 23193**2744**
 23194
 23195     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23196        MOVE AL-UNBON            TO CCANDT2A
 23197        MOVE -1                  TO CCANDT2L
 23198        MOVE  1                  TO SET-CURSOR-SW
 23199        GO TO 7499-EXIT.
 23200
 23201**2747**
 23202
 23203     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23204        MOVE AL-UABON            TO CLSTNMA
 23205        MOVE -1                  TO CLSTNML
 23206        MOVE  1                  TO SET-CURSOR-SW
 23207        GO TO 7499-EXIT.
 23208
 23209**2749**
 23210
 23211     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 23212        MOVE AL-UABON            TO CFORCEA
 23213        MOVE -1                  TO CFORCEL
 23214        MOVE  1                  TO SET-CURSOR-SW
 23215        GO TO 7499-EXIT.
 23216
 23217**2753**
 23218
 23219     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 23220        MOVE AL-UNBON            TO CCANDT1A
 23221        MOVE -1                  TO CCANDT1L
 23222        MOVE  1                  TO SET-CURSOR-SW
 23223        GO TO 7499-EXIT.
 23224
 23225**2755**
 23226
 23227     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 431
* EL6311.cbl
 23228        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23229            MOVE AL-UNBON        TO CREFND1A
 23230            MOVE -1              TO CREFND1L
 23231            MOVE  1              TO SET-CURSOR-SW
 23232            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23233                MOVE AL-UNBON        TO CREFND2A
 23234                MOVE -1              TO CREFND2L
 23235                MOVE  1              TO SET-CURSOR-SW
 23236                GO TO 7499-EXIT
 23237            ELSE
 23238                GO TO 7499-EXIT
 23239        ELSE
 23240            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23241                MOVE AL-UNBON        TO CREFND2A
 23242                MOVE -1              TO CREFND2L
 23243                MOVE  1              TO SET-CURSOR-SW
 23244            ELSE
 23245                GO TO 7499-EXIT.
 23246
 23247**2757**
 23248
 23249     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 23250        MOVE AL-UNBON            TO CLIVESA
 23251        MOVE -1                  TO CLIVESL
 23252        MOVE  1                  TO SET-CURSOR-SW
 23253        GO TO 7499-EXIT.
 23254
 23255**2771**
 23256
 23257     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 23258        MOVE AL-UABON            TO CCANDT2A
 23259        MOVE -1                  TO CCANDT2L
 23260        MOVE  1                  TO SET-CURSOR-SW
 23261        GO TO 7499-EXIT.
 23262
 23263**2774**
 23264
 23265     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 23266        MOVE AL-UABON            TO CCANDT1A
 23267        MOVE -1                  TO CCANDT1L
 23268        MOVE  1                  TO SET-CURSOR-SW
 23269        GO TO 7499-EXIT.
 23270
 23271**2775**
 23272
 23273     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 23274        MOVE AL-UABON            TO CCANDT2A
 23275        MOVE -1                  TO CCANDT2L
 23276        MOVE  1                  TO SET-CURSOR-SW
 23277        GO TO 7499-EXIT.
 23278
 23279**2776**
 23280
 23281     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 23282        MOVE AL-UABON            TO CCANDT1A
 23283        MOVE -1                  TO CCANDT1L
 23284        MOVE  1                  TO SET-CURSOR-SW
 23285        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 432
* EL6311.cbl
 23286
 23287
 23288**2777**
 23289
 23290     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 23291        MOVE AL-UABON            TO CCANDT2A
 23292        MOVE -1                  TO CCANDT2L
 23293        MOVE  1                  TO SET-CURSOR-SW
 23294        GO TO 7499-EXIT.
 23295
 23296**2794**
 23297
 23298     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 23299        MOVE AL-UABON            TO CFORCEA
 23300        MOVE -1                  TO CFORCEL
 23301        MOVE  1                  TO SET-CURSOR-SW
 23302        GO TO 7499-EXIT.
 23303
 23304**2799**
 23305
 23306     IF PI-COMPANY-ID = 'UCL'
 23307         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 23308             MOVE AL-UNBON            TO BEFFDTA
 23309             MOVE -1                  TO BEFFDTL
 23310             MOVE  1                  TO SET-CURSOR-SW
 23311             GO TO 7499-EXIT.
 23312
 23313 7499-EXIT.
 23314      EXIT.
 23315
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 433
* EL6311.cbl
 23317
 23318 7500-READ-ERLOFC.
 23319     MOVE SPACES                 TO  WS-LOAN-OFFICER
 23320                                     ERLOFC-KEY.
 23321
 23322     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 23323
 23324     IF ST-ACCNT-CNTL
 23325         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23326
 23327     IF CARR-GROUP-ST-ACCNT-CNTL
 23328         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23329         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 23330         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 23331
 23332     IF CARR-ST-ACCNT-CNTL
 23333         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23334         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23335
 23336     IF CARR-ACCNT-CNTL
 23337         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 23338
 23339     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 23340
 23341     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 23342
 23343
 23344* EXEC CICS HANDLE CONDITION
 23345*        NOTFND   (7550-OFFICER-NOTFND)
 23346*    END-EXEC.
 23347*    MOVE '"$I                   ! [ #00019629' TO DFHEIV0
 23348     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23349     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23350     MOVE X'5B20233030303139363239' TO DFHEIV0(25:11)
 23351     CALL 'kxdfhei1' USING DFHEIV0
 23352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23353
 23354
 23355
 23356* EXEC CICS READ
 23357*        DATASET   (FILE-ID-ERLOFC)
 23358*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 23359*        RIDFLD    (ERLOFC-KEY)
 23360*        EQUAL
 23361*    END-EXEC.
 23362*    MOVE '&"S        E          (   #00019633' TO DFHEIV0
 23363     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23364     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23365     MOVE X'2020233030303139363333' TO DFHEIV0(25:11)
 23366     CALL 'kxdfhei1' USING DFHEIV0,
 23367           FILE-ID-ERLOFC,
 23368           DFHEIV20,
 23369           DFHEIV99,
 23370           ERLOFC-KEY,
 23371           DFHEIV99,
 23372           DFHEIV99,
 23373           DFHEIV99
 23374     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 434
* EL6311.cbl
 23375         DFHEIV20
 23376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23377
 23378
 23379     GO TO 7599-EXIT.
 23380
 23381 7550-OFFICER-NOTFND.
 23382     MOVE 'X'                    TO WS-LOAN-OFFICER.
 23383
 23384 7599-EXIT.
 23385      EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 435
* EL6311.cbl
 23387******************************************************************
 23388*                                                                *
 23389*            S  E N D    I N I T I A L   M A P                   *
 23390*                                                                *
 23391******************************************************************
 23392
 23393 8100-SEND-INITIAL-MAP.
 23394     MOVE EIBTIME                TO TIME-IN.
 23395
 23396     IF EIBAID = DFHPF11
 23397        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 23398        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23399
 23400
 23401     IF PI-COMPANY-ID = CLIENT-GIC
 23402        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23403                                       BCPREM-ATTRB (2).
 23404
 23405     IF PI-COMPANY-ID = (CLIENT-MIC OR
 23406                         CLIENT-PEM OR
 23407                         CLIENT-CSO)
 23408        AND PI-DISPLAY-ORIGINAL-BATCH
 23409          IF PI-MAP-NAME = EL631B
 23410             MOVE AL-SADOF               TO BPF5HDRA
 23411                                            BPF4HDRA
 23412          ELSE
 23413             IF PI-MAP-NAME = EL631C
 23414                MOVE AL-SADOF            TO CPF5HDRA
 23415                                            CPF4HDRA.
 23416
 23417     IF PI-MAP-NAME = EL631B
 23418        MOVE AL-SADOF               TO BPF5HDRA
 23419     ELSE
 23420        MOVE AL-SADOF               TO CPF5HDRA
 23421     END-IF
 23422
 23423*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 23424     IF PI-MAP-NAME = EL631B
 23425          IF PI-COMPANY-ID NOT = 'DMD'
 23426             MOVE AL-SANOF            TO BBILLEDA
 23427             MOVE AL-SADOF            TO DMDBILA.
 23428*DMD CUSTOM CODING*************END
 23429
 23430     IF PI-PROCESSOR-ID = 'LGXX'
 23431        IF PI-MAP-NAME = EL631B
 23432           MOVE AL-SABOF                    TO BREFHDGA
 23433           MOVE AL-SANOF                    TO BREFA
 23434        ELSE
 23435           IF PI-MAP-NAME = EL631C
 23436              MOVE AL-SABOF                 TO CREFHDGA
 23437              MOVE AL-SANOF                 TO CREFA.
 23438
 23439*******      ONLY SHOW CANCEL FEE FOR CLIENT ACE ON EL631C *******
 23440     IF PI-COMPANY-ID = (CLIENT-ACE OR CLIENT-LGX)
 23441        NEXT SENTENCE
 23442     ELSE
 23443        IF PI-MAP-NAME = EL631C
 23444           MOVE AL-SADOF            TO CCANTXTA
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 436
* EL6311.cbl
 23445                                       CCANFEEA.
 23446
 23447     IF PI-MAP-NAME = EL631D
 23448        IF PI-AR-PROCESSING
 23449           MOVE AL-SANOF            TO DREFHDGA
 23450        ELSE
 23451           MOVE AL-SADOF            TO DREFHDGA.
 23452
 23453     IF (PI-COMPANY-ID NOT = 'DCC')
 23454        AND (PI-MAP-NAME = EL631B)
 23455        MOVE AL-SADOF            TO BVINHA
 23456                                    BVINA
 23457     END-IF
 23458     IF PI-MAP-NAME = EL631B
 23459        IF CSR-EDIT-SESSION
 23460           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23461                                 TO BHEADO
 23462           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 23463        ELSE
 23464           MOVE AL-SADOF         TO BF15HDRA
 23465           MOVE '4=B-HDR      '  TO BPF4HDRO
 23466        END-IF
 23467        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23468        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 23469        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 23470        MOVE WS-CURRENT-DT          TO BDATEO
 23471        MOVE TIME-OUT               TO BTIMEO
 23472        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23473        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23474        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23475        IF   WS-DISPLAY-SCREEN
 23476             MOVE PB-ENTRY-BATCH    TO BBATCHO
 23477             MOVE PB-SV-CARRIER     TO BCARRO
 23478             MOVE PB-SV-GROUPING    TO BGROUPO
 23479             MOVE PB-SV-STATE       TO BSTATEO
 23480             MOVE PB-ACCOUNT        TO BACCTO
 23481        ELSE
 23482             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 23483     ELSE
 23484        IF PI-MAP-NAME = EL631C
 23485           MOVE '4=B-HDR      '     TO CPF4HDRO
 23486           IF CSR-EDIT-SESSION
 23487              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23488                                 TO CHEADO
 23489           ELSE
 23490              MOVE AL-SADOF      TO CF15HDRA
 23491           END-IF
 23492           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 23493           MOVE WS-CURRENT-DT          TO CDATEO
 23494           MOVE TIME-OUT               TO CTIMEO
 23495           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 23496           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 23497           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 23498           MOVE WS-C-HDG               TO CLFHDGO
 23499           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 23500           MOVE WS-C-HDG               TO CAHHDGO
 23501           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23502           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 437
* EL6311.cbl
 23503           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23504           IF   WS-DISPLAY-SCREEN
 23505                MOVE PB-ENTRY-BATCH    TO CBATCHO
 23506                MOVE PB-SV-CARRIER     TO CCARRO
 23507                MOVE PB-SV-GROUPING    TO CGROUPO
 23508                MOVE PB-SV-STATE       TO CSTATEO
 23509                MOVE PB-ACCOUNT        TO CACCTO
 23510           ELSE
 23511                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 23512        ELSE
 23513           MOVE WS-CURRENT-DT          TO DDATEO
 23514           MOVE TIME-OUT               TO DTIMEO
 23515           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 23516                                          WS-REFUND-HDG-OVERRIDE
 23517           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 23518           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 23519           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 23520                                          WS-REFUND-HDG-OVERRIDE
 23521           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 23522           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 23523           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 23524           IF CSR-EDIT-SESSION
 23525              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23526                                 TO DHEADO
 23527           END-IF
 23528           IF  WS-DISPLAY-SCREEN
 23529               MOVE PB-ENTRY-BATCH     TO DBATCHO
 23530               MOVE PB-CARRIER         TO DCARRO
 23531               MOVE PB-GROUPING        TO DGROUPO
 23532               MOVE PB-STATE           TO DSTATEO
 23533               MOVE PB-ACCOUNT         TO DACCTO
 23534               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 23535           ELSE
 23536               MOVE EL631D             TO PI-MAP-NAME
 23537               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 23538               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 23539
 23540     MOVE SPACE                        TO WS-DISPLAY-SW.
 23541
 23542
 23543* EXEC CICS SEND
 23544*        MAP      (PI-MAP-NAME)
 23545*        MAPSET   (MAPSET-EL6311S)
 23546*        FROM     (EL631BI)
 23547*        ERASE
 23548*        CURSOR
 23549*    END-EXEC.
 23550     MOVE LENGTH OF
 23551      EL631BI
 23552       TO DFHEIV12
 23553     MOVE -1
 23554       TO DFHEIV11
 23555*    MOVE '8$     CT  E    H L F ,   #00019803' TO DFHEIV0
 23556     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 23557     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 23558     MOVE X'2020233030303139383033' TO DFHEIV0(25:11)
 23559     CALL 'kxdfhei1' USING DFHEIV0,
 23560           PI-MAP-NAME,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 438
* EL6311.cbl
 23561           EL631BI,
 23562           DFHEIV12,
 23563           MAPSET-EL6311S,
 23564           DFHEIV99,
 23565           DFHEIV99,
 23566           DFHEIV99,
 23567           DFHEIV11,
 23568           DFHEIV99,
 23569           DFHEIV99,
 23570           DFHEIV99
 23571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23572
 23573
 23574     GO TO 9100-RETURN-TRAN.
 23575
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 439
* EL6311.cbl
 23577
 23578******************************************************************
 23579*                                                                *
 23580*              S E N D    D A T A O N L Y                        *
 23581*                                                                *
 23582******************************************************************
 23583
 23584 8200-SEND-DATAONLY.
 23585     MOVE EIBTIME                TO TIME-IN.
 23586
 23587     IF PI-COMPANY-ID = CLIENT-GIC
 23588        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23589                                       BCPREM-ATTRB (2).
 23590
 23591     IF PI-MAP-NAME = EL631B
 23592        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23593        MOVE WS-CURRENT-DT          TO BDATEO
 23594        MOVE TIME-OUT               TO BTIMEO
 23595        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23596        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23597        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23598        MOVE SPACES                 TO BPFENTRO
 23599        MOVE AL-UANOF               TO BPFENTRA
 23600
 23601*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 23602        IF PI-COMPANY-ID NOT = 'DMD'
 23603             MOVE AL-SANOF            TO BBILLEDA
 23604             MOVE AL-SADOF            TO DMDBILA
 23605         ELSE
 23606            NEXT SENTENCE
 23607*DMD CUSTOM CODING*************END
 23608     ELSE
 23609        IF PI-MAP-NAME = EL631C
 23610           MOVE WS-CURRENT-DT          TO CDATEO
 23611           MOVE TIME-OUT               TO CTIMEO
 23612           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23613           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 23614           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23615           MOVE SPACES                 TO CPFENTRO
 23616           MOVE AL-UANOF               TO CPFENTRA
 23617        ELSE
 23618           MOVE WS-CURRENT-DT          TO DDATEO
 23619           MOVE TIME-OUT               TO DTIMEO
 23620           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 23621
 23622
 23623* EXEC CICS SEND
 23624*        MAP      (PI-MAP-NAME)
 23625*        MAPSET   (MAPSET-EL6311S)
 23626*        FROM     (EL631BI)
 23627*        DATAONLY
 23628*        CURSOR
 23629*    END-EXEC.
 23630     MOVE LENGTH OF
 23631      EL631BI
 23632       TO DFHEIV12
 23633     MOVE -1
 23634       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 440
* EL6311.cbl
 23635*    MOVE '8$D    CT       H L F ,   #00019859' TO DFHEIV0
 23636     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 23637     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 23638     MOVE X'2020233030303139383539' TO DFHEIV0(25:11)
 23639     CALL 'kxdfhei1' USING DFHEIV0,
 23640           PI-MAP-NAME,
 23641           EL631BI,
 23642           DFHEIV12,
 23643           MAPSET-EL6311S,
 23644           DFHEIV99,
 23645           DFHEIV99,
 23646           DFHEIV99,
 23647           DFHEIV11,
 23648           DFHEIV99,
 23649           DFHEIV99,
 23650           DFHEIV99
 23651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23652
 23653
 23654     GO TO 9100-RETURN-TRAN.
 23655
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 441
* EL6311.cbl
 23657
 23658******************************************************************
 23659*                                                                *
 23660*           U T I L I T Y   R O U T I N E S                      *
 23661*                                                                *
 23662******************************************************************
 23663
 23664 8300-SEND-TEXT.
 23665
 23666* EXEC CICS SEND TEXT
 23667*        FROM     (LOGOFF-TEXT)
 23668*        LENGTH   (LOGOFF-LENGTH)
 23669*        ERASE
 23670*        FREEKB
 23671*    END-EXEC.
 23672*    MOVE '8&      T  E F  H   F -   #00019878' TO DFHEIV0
 23673     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 23674     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 23675     MOVE X'2020233030303139383738' TO DFHEIV0(25:11)
 23676     CALL 'kxdfhei1' USING DFHEIV0,
 23677           LOGOFF-TEXT,
 23678           LOGOFF-LENGTH,
 23679           DFHEIV99,
 23680           DFHEIV99,
 23681           DFHEIV99,
 23682           DFHEIV99,
 23683           DFHEIV99,
 23684           DFHEIV99,
 23685           DFHEIV99,
 23686           DFHEIV99,
 23687           DFHEIV99,
 23688           DFHEIV99
 23689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23690
 23691
 23692
 23693* EXEC CICS RETURN
 23694*    END-EXEC.
 23695*    MOVE '.(                    ''   #00019885' TO DFHEIV0
 23696     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 23697     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23698     MOVE X'2020233030303139383835' TO DFHEIV0(25:11)
 23699     CALL 'kxdfhei1' USING DFHEIV0,
 23700           DFHEIV99,
 23701           DFHEIV99,
 23702           DFHEIV99,
 23703           DFHEIV99,
 23704           DFHEIV99,
 23705           DFHEIV99
 23706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23707
 23708
 23709 8400-LOG-JOURNAL-RECORD.
 23710     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 23711     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 23712
 23713*    EXEC CICS JOURNAL
 23714*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 442
* EL6311.cbl
 23715*        JTYPEID     ('EL')
 23716*        FROM        (JOURNAL-RECORD)
 23717*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 23718*    END-EXEC.
 23719
 23720 8600-DEEDIT.
 23721
 23722* EXEC CICS BIF DEEDIT
 23723*         FIELD   (DEEDIT-FIELD)
 23724*         LENGTH  (15)
 23725*    END-EXEC.
 23726     MOVE 15
 23727       TO DFHEIV11
 23728*    MOVE '@"L                   #   #00019900' TO DFHEIV0
 23729     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 23730     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23731     MOVE X'2020233030303139393030' TO DFHEIV0(25:11)
 23732     CALL 'kxdfhei1' USING DFHEIV0,
 23733           DEEDIT-FIELD,
 23734           DFHEIV11
 23735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23736
 23737
 23738 8800-UNAUTHORIZED-ACCESS.
 23739     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 23740     GO TO 8300-SEND-TEXT.
 23741
 23742 8810-PF23.
 23743     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 23744     MOVE XCTL-EL005             TO PGM-NAME.
 23745     GO TO 9300-XCTL.
 23746
 23747 9100-RETURN-TRAN.
 23748     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 23749
 23750     IF  PI-MAP-NAME =  EL631B
 23751         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 23752
 23753     IF  PI-MAP-NAME =  EL631C
 23754         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 23755
 23756     IF  PI-MAP-NAME =  EL631D
 23757         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 23758
 23759
 23760* EXEC CICS RETURN
 23761*        TRANSID    (TRANS-EXB1)
 23762*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 23763*        LENGTH     (1300)
 23764*    END-EXEC.
 23765     MOVE 1300
 23766       TO DFHEIV11
 23767*    MOVE '.(CT                  ''   #00019926' TO DFHEIV0
 23768     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 23769     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23770     MOVE X'2020233030303139393236' TO DFHEIV0(25:11)
 23771     CALL 'kxdfhei1' USING DFHEIV0,
 23772           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 443
* EL6311.cbl
 23773           PROGRAM-INTERFACE-BLOCK,
 23774           DFHEIV11,
 23775           DFHEIV99,
 23776           DFHEIV99,
 23777           DFHEIV99
 23778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23779
 23780
 23781 9200-RETURN-MAIN-MENU.
 23782     MOVE XCTL-EL626             TO PGM-NAME.
 23783     GO TO 9300-XCTL.
 23784
 23785 9300-XCTL.
 23786
 23787* EXEC CICS XCTL
 23788*        PROGRAM    (PGM-NAME)
 23789*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 23790*        LENGTH     (PI-COMM-LENGTH)
 23791*    END-EXEC.
 23792*    MOVE '.$C                   %   #00019937' TO DFHEIV0
 23793     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 23794     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23795     MOVE X'2020233030303139393337' TO DFHEIV0(25:11)
 23796     CALL 'kxdfhei1' USING DFHEIV0,
 23797           PGM-NAME,
 23798           PROGRAM-INTERFACE-BLOCK,
 23799           PI-COMM-LENGTH,
 23800           DFHEIV99
 23801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23802
 23803
 23804 9400-CLEAR.
 23805     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 23806     GO TO 9300-XCTL.
 23807
 23808 9500-PF12.
 23809     MOVE XCTL-EL010             TO PGM-NAME.
 23810     GO TO 9300-XCTL.
 23811
 23812 9600-PGMID-ERROR.
 23813
 23814* EXEC CICS HANDLE CONDITION
 23815*        PGMIDERR    (8300-SEND-TEXT)
 23816*    END-EXEC.
 23817*    MOVE '"$L                   ! \ #00019952' TO DFHEIV0
 23818     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 23819     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23820     MOVE X'5C20233030303139393532' TO DFHEIV0(25:11)
 23821     CALL 'kxdfhei1' USING DFHEIV0
 23822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23823
 23824
 23825     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 23826     MOVE ' '                    TO PI-ENTRY-CD-1.
 23827     MOVE XCTL-EL005             TO PGM-NAME.
 23828     MOVE PGM-NAME               TO LOGOFF-PGM.
 23829     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 23830     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 444
* EL6311.cbl
 23831
 23832 9700-DATE-LINK.
 23833     MOVE LINK-ELDATCV           TO PGM-NAME.
 23834
 23835* EXEC CICS LINK
 23836*        PROGRAM    (PGM-NAME)
 23837*        COMMAREA   (DATE-CONVERSION-DATA)
 23838*        LENGTH     (DC-COMM-LENGTH)
 23839*    END-EXEC.
 23840*    MOVE '."C                   (   #00019965' TO DFHEIV0
 23841     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23842     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23843     MOVE X'2020233030303139393635' TO DFHEIV0(25:11)
 23844     CALL 'kxdfhei1' USING DFHEIV0,
 23845           PGM-NAME,
 23846           DATE-CONVERSION-DATA,
 23847           DC-COMM-LENGTH,
 23848           DFHEIV99,
 23849           DFHEIV99,
 23850           DFHEIV99,
 23851           DFHEIV99
 23852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23853
 23854
 23855 9800-LINK-PENDING-EDIT.
 23856     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 23857     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 23858
 23859     MOVE LINK-EL050             TO PGM-NAME
 23860     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 23861     MOVE ZEROS                  TO WK-CO-MAX-CAP
 23862                                    WK-CO-TOL-CLAIM
 23863                                    WK-CO-TOL-PREM
 23864                                    WK-CO-TOL-REFUND
 23865                                    WK-CO-TOL-PREM-PCT
 23866                                    WK-CO-TOL-REFUND-PCT
 23867                                    WK-REFUND-OVS-AMT
 23868                                    WK-REFUND-OVS-PCT
 23869                                    WK-ACCT-ADDR
 23870                                    WK-LIFE-EDIT-ADDR
 23871                                    WK-AH-EDIT-ADDR
 23872                                    WK-LIFE-BEN-ADDR
 23873                                    WK-AH-BEN-ADDR
 23874                                    WK-STATE-ADDR
 23875                                    WK-PLAN-ADDR
 23876                                    WK-FORM-ADDR
 23877     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 23878
 23879     MOVE '6'                    TO WK-ENTRY-SW.
 23880
 23881     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 23882
 23883     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 23884                                    EC-AM-EXPIRATION-DT
 23885                                    EC-AM-EFFECTIVE-DT
 23886                                    EC-CM-LF-CANCEL-DT
 23887                                    EC-CM-AH-CANCEL-DT
 23888                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 445
* EL6311.cbl
 23889
 23890     MOVE ZEROS                  TO EC-CO-TOL-PREM
 23891                                    EC-CO-TOL-REFUND
 23892                                    EC-CO-MIN-AGE
 23893                                    EC-CO-MIN-PREMIUM
 23894                                    EC-CO-MIN-TERM
 23895                                    EC-CO-MAX-TERM
 23896                                    EC-ST-TOL-PREM
 23897                                    EC-ST-TOL-REFUND
 23898                                    EC-AM-LF-TOL-PREM
 23899                                    EC-AM-AH-TOL-PREM
 23900                                    EC-AM-LF-MAX-ATT-AGE
 23901                                    EC-AM-LF-MAX-AGE
 23902                                    EC-AM-LF-MAX-TERM
 23903                                    EC-AM-LF-MAX-TOT-BEN
 23904                                    EC-AM-AH-MAX-ATT-AGE
 23905                                    EC-AM-AH-MAX-AGE
 23906                                    EC-AM-AH-MAX-TERM
 23907                                    EC-AM-AH-MAX-TOT-BEN
 23908                                    EC-AM-AH-MAX-MON-BEN
 23909                                    EC-RT-LF-MAX-ATT-AGE
 23910                                    EC-RT-LF-MAX-AGE
 23911                                    EC-RT-LF-MAX-TERM
 23912                                    EC-RT-LF-MAX-TOT-BEN
 23913                                    EC-RT-AH-MAX-ATT-AGE
 23914                                    EC-RT-AH-MAX-AGE
 23915                                    EC-RT-AH-MAX-TERM
 23916                                    EC-RT-AH-MAX-TOT-BEN
 23917                                    EC-RT-AH-MAX-MON-BEN
 23918                                    EC-RT-AH-RATE
 23919                                    EC-RT-LF-RATE
 23920                                    EC-RT-LF-NSP-RATE
 23921                                    EC-RT-AH-NSP-RATE
 23922                                    EC-CM-LF-PRIOR-REFUND
 23923                                    EC-CM-AH-PRIOR-REFUND.
 23924
 23925     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 23926                                    EC-ST-TOL-PREM-PCT
 23927                                    EC-AM-LF-TOL-REFUND
 23928                                    EC-AM-LF-DEV-PERCENT
 23929                                    EC-CO-TOL-REFUND-PCT
 23930                                    EC-ST-TOL-REFUND-PCT
 23931                                    EC-AM-AH-TOL-REFUND
 23932                                    EC-AM-AH-DEV-PERCENT.
 23933
 23934
 23935* EXEC CICS LINK
 23936*         PROGRAM   (PGM-NAME)
 23937*         COMMAREA  (PASSED-RECORD)
 23938*         LENGTH    (WS-EDIT-PASS-LENGTH)
 23939*    END-EXEC.
 23940*    MOVE '."C                   (   #00020050' TO DFHEIV0
 23941     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23942     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23943     MOVE X'2020233030303230303530' TO DFHEIV0(25:11)
 23944     CALL 'kxdfhei1' USING DFHEIV0,
 23945           PGM-NAME,
 23946           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 446
* EL6311.cbl
 23947           WS-EDIT-PASS-LENGTH,
 23948           DFHEIV99,
 23949           DFHEIV99,
 23950           DFHEIV99,
 23951           DFHEIV99
 23952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23953
 23954
 23955     MOVE '1'                    TO PI-EDIT-SW.
 23956     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 23957
 23958     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 23959
 23960     IF PI-COMPANY-ID = 'UCL'
 23961         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 23962
 23963     IF VALID-PB-ID
 23964        GO TO 9800-EXIT.
 23965
 23966     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 23967
 23968     IF PI-MAP-NAME = EL631B
 23969        MOVE -1                  TO BMAINTL
 23970       ELSE
 23971        MOVE -1                  TO CMAINTL.
 23972
 23973     GO TO 8200-SEND-DATAONLY.
 23974
 23975 9800-EXIT.
 23976      EXIT.
 23977
 23978 9900-ERROR-FORMAT.
 23979
 23980     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 23981
 23982     IF NOT EMI-ERRORS-COMPLETE
 23983         MOVE LINK-EL001         TO PGM-NAME
 23984
 23985* EXEC CICS LINK
 23986*            PROGRAM    (PGM-NAME)
 23987*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 23988*            LENGTH     (EMI-COMM-LENGTH)
 23989*        END-EXEC.
 23990*    MOVE '."C                   (   #00020085' TO DFHEIV0
 23991     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23992     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23993     MOVE X'2020233030303230303835' TO DFHEIV0(25:11)
 23994     CALL 'kxdfhei1' USING DFHEIV0,
 23995           PGM-NAME,
 23996           ERROR-MESSAGE-INTERFACE-BLOCK,
 23997           EMI-COMM-LENGTH,
 23998           DFHEIV99,
 23999           DFHEIV99,
 24000           DFHEIV99,
 24001           DFHEIV99
 24002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24003
 24004
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 447
* EL6311.cbl
 24005 9900-EXIT.
 24006     EXIT.
 24007
 24008 9990-ABEND.
 24009     MOVE LINK-EL004             TO PGM-NAME.
 24010     MOVE DFHEIBLK               TO EMI-LINE1.
 24011
 24012* EXEC CICS LINK
 24013*        PROGRAM   (PGM-NAME)
 24014*        COMMAREA  (EMI-LINE1)
 24015*        LENGTH    (72)
 24016*    END-EXEC.
 24017     MOVE 72
 24018       TO DFHEIV11
 24019*    MOVE '."C                   (   #00020097' TO DFHEIV0
 24020     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24021     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24022     MOVE X'2020233030303230303937' TO DFHEIV0(25:11)
 24023     CALL 'kxdfhei1' USING DFHEIV0,
 24024           PGM-NAME,
 24025           EMI-LINE1,
 24026           DFHEIV11,
 24027           DFHEIV99,
 24028           DFHEIV99,
 24029           DFHEIV99,
 24030           DFHEIV99
 24031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24032
 24033
 24034     IF PI-MAP-NAME = EL631B
 24035        MOVE -1                  TO BMAINTL
 24036       ELSE
 24037        MOVE -1                  TO CMAINTL.
 24038
 24039     IF EIBTRNID NOT = TRANS-EXB1
 24040        GO TO 8100-SEND-INITIAL-MAP
 24041       ELSE
 24042        GO TO 8200-SEND-DATAONLY.
 24043
 24044 9995-SECURITY-VIOLATION.
 24045*                            COPY ELCSCTP.
 24046******************************************************************
 24047*                                                                *
 24048*                            ELCSCTP                             *
 24049*                            VMOD=2.001                          *
 24050*                                                                *
 24051*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24052******************************************************************
 24053
 24054
 24055     MOVE EIBDATE          TO SM-JUL-DATE.
 24056     MOVE EIBTRMID         TO SM-TERMID.
 24057     MOVE THIS-PGM         TO SM-PGM.
 24058     MOVE EIBTIME          TO TIME-IN.
 24059     MOVE TIME-OUT         TO SM-TIME.
 24060     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24061
 24062
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 448
* EL6311.cbl
 24063* EXEC CICS LINK
 24064*         PROGRAM  ('EL003')
 24065*         COMMAREA (SECURITY-MESSAGE)
 24066*         LENGTH   (80)
 24067*    END-EXEC.
 24068     MOVE 'EL003' TO DFHEIV1
 24069     MOVE 80
 24070       TO DFHEIV11
 24071*    MOVE '."C                   (   #00020131' TO DFHEIV0
 24072     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24073     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24074     MOVE X'2020233030303230313331' TO DFHEIV0(25:11)
 24075     CALL 'kxdfhei1' USING DFHEIV0,
 24076           DFHEIV1,
 24077           SECURITY-MESSAGE,
 24078           DFHEIV11,
 24079           DFHEIV99,
 24080           DFHEIV99,
 24081           DFHEIV99,
 24082           DFHEIV99
 24083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24084
 24085
 24086******************************************************************
 24087
 24088
 24089 9999-DFHBACK SECTION.
 24090     MOVE '9%                    "   ' TO DFHEIV0
 24091     MOVE 'EL6311' TO DFHEIV1
 24092     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24093     GOBACK.
 24094 9999-DFHEXIT.
 24095     IF DFHEIGDJ EQUAL 0001
 24096         NEXT SENTENCE
 24097     ELSE IF DFHEIGDJ EQUAL 2
 24098         GO TO 9600-PGMID-ERROR,
 24099               9990-ABEND,
 24100               9990-ABEND,
 24101               0010-MAIN-LOGIC
 24102         DEPENDING ON DFHEIGDI
 24103     ELSE IF DFHEIGDJ EQUAL 3
 24104         GO TO 1280-BATCH-HDR-NOT-FOUND
 24105         DEPENDING ON DFHEIGDI
 24106     ELSE IF DFHEIGDJ EQUAL 4
 24107         GO TO 1290-DUPLICATE-ALT-INDEX
 24108         DEPENDING ON DFHEIGDI
 24109     ELSE IF DFHEIGDJ EQUAL 5
 24110         GO TO 1295-CERT-TRL-REC-NOTFND
 24111         DEPENDING ON DFHEIGDI
 24112     ELSE IF DFHEIGDJ EQUAL 6
 24113         GO TO 1380-BATCH-HDR-NOT-FOUND
 24114         DEPENDING ON DFHEIGDI
 24115     ELSE IF DFHEIGDJ EQUAL 7
 24116         GO TO 1385-REC-NOT-FOUND
 24117         DEPENDING ON DFHEIGDI
 24118     ELSE IF DFHEIGDJ EQUAL 8
 24119         GO TO 1386-NOTFND
 24120         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 449
* EL6311.cbl
 24121     ELSE IF DFHEIGDJ EQUAL 9
 24122         GO TO 1399-EXIT
 24123         DEPENDING ON DFHEIGDI
 24124     ELSE IF DFHEIGDJ EQUAL 10
 24125         GO TO 1480-BATCH-HDR-NOT-FOUND
 24126         DEPENDING ON DFHEIGDI
 24127     ELSE IF DFHEIGDJ EQUAL 11
 24128         GO TO 1490-RECORD-NOT-FOUND
 24129         DEPENDING ON DFHEIGDI
 24130     ELSE IF DFHEIGDJ EQUAL 12
 24131         GO TO 1405-DELETE-CERTIFICATE
 24132         DEPENDING ON DFHEIGDI
 24133     ELSE IF DFHEIGDJ EQUAL 13
 24134         GO TO 1420-CONTINUE-DELETE
 24135         DEPENDING ON DFHEIGDI
 24136     ELSE IF DFHEIGDJ EQUAL 14
 24137         GO TO 1406-DELETE-ERNOTE
 24138         DEPENDING ON DFHEIGDI
 24139     ELSE IF DFHEIGDJ EQUAL 15
 24140         GO TO 1407-DELETE-MAILING
 24141         DEPENDING ON DFHEIGDI
 24142     ELSE IF DFHEIGDJ EQUAL 16
 24143         GO TO 1420-CONTINUE-DELETE
 24144         DEPENDING ON DFHEIGDI
 24145     ELSE IF DFHEIGDJ EQUAL 17
 24146         GO TO 1480-BATCH-HDR-NOT-FOUND
 24147         DEPENDING ON DFHEIGDI
 24148     ELSE IF DFHEIGDJ EQUAL 18
 24149         GO TO 1475-DELETE-FINISHED
 24150         DEPENDING ON DFHEIGDI
 24151     ELSE IF DFHEIGDJ EQUAL 19
 24152         GO TO 2280-BATCH-HDR-NOT-FOUND
 24153         DEPENDING ON DFHEIGDI
 24154     ELSE IF DFHEIGDJ EQUAL 20
 24155         GO TO 2290-DUPLICATE-ALT-INDEX
 24156         DEPENDING ON DFHEIGDI
 24157     ELSE IF DFHEIGDJ EQUAL 21
 24158         GO TO 2380-BATCH-HDR-NOT-FOUND
 24159         DEPENDING ON DFHEIGDI
 24160     ELSE IF DFHEIGDJ EQUAL 22
 24161         GO TO 2385-REC-NOT-FOUND
 24162         DEPENDING ON DFHEIGDI
 24163     ELSE IF DFHEIGDJ EQUAL 23
 24164         GO TO 2380-BATCH-HDR-NOT-FOUND
 24165         DEPENDING ON DFHEIGDI
 24166     ELSE IF DFHEIGDJ EQUAL 24
 24167         GO TO 2485-BATCH-HDR-NOT-FOUND
 24168         DEPENDING ON DFHEIGDI
 24169     ELSE IF DFHEIGDJ EQUAL 25
 24170         GO TO 2490-RECORD-NOT-FOUND
 24171         DEPENDING ON DFHEIGDI
 24172     ELSE IF DFHEIGDJ EQUAL 26
 24173         GO TO 2475-CONTINUE-DELETE
 24174         DEPENDING ON DFHEIGDI
 24175     ELSE IF DFHEIGDJ EQUAL 27
 24176         GO TO 2485-BATCH-HDR-NOT-FOUND
 24177         DEPENDING ON DFHEIGDI
 24178     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 450
* EL6311.cbl
 24179         GO TO 2480-DELETE-FINISHED
 24180         DEPENDING ON DFHEIGDI
 24181     ELSE IF DFHEIGDJ EQUAL 29
 24182         GO TO 2820-PROCESS-REWRITE
 24183         DEPENDING ON DFHEIGDI
 24184     ELSE IF DFHEIGDJ EQUAL 30
 24185         GO TO 2885-RECORD-MISSING
 24186         DEPENDING ON DFHEIGDI
 24187     ELSE IF DFHEIGDJ EQUAL 31
 24188         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24189         DEPENDING ON DFHEIGDI
 24190     ELSE IF DFHEIGDJ EQUAL 32
 24191         GO TO 2827-DELETE-MAILING
 24192         DEPENDING ON DFHEIGDI
 24193     ELSE IF DFHEIGDJ EQUAL 33
 24194         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24195         DEPENDING ON DFHEIGDI
 24196     ELSE IF DFHEIGDJ EQUAL 34
 24197         GO TO 2920-PROCESS-REWRITE
 24198         DEPENDING ON DFHEIGDI
 24199     ELSE IF DFHEIGDJ EQUAL 35
 24200         GO TO 2985-RECORD-MISSING
 24201         DEPENDING ON DFHEIGDI
 24202     ELSE IF DFHEIGDJ EQUAL 36
 24203         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 24204         DEPENDING ON DFHEIGDI
 24205     ELSE IF DFHEIGDJ EQUAL 37
 24206         GO TO 2990-DUPLICATE-RECORD
 24207         DEPENDING ON DFHEIGDI
 24208     ELSE IF DFHEIGDJ EQUAL 38
 24209         GO TO 3590-NOT-FOUND
 24210         DEPENDING ON DFHEIGDI
 24211     ELSE IF DFHEIGDJ EQUAL 39
 24212         GO TO 3690-NOT-FOUND
 24213         DEPENDING ON DFHEIGDI
 24214     ELSE IF DFHEIGDJ EQUAL 40
 24215         GO TO 3990-NOT-FOUND
 24216         DEPENDING ON DFHEIGDI
 24217     ELSE IF DFHEIGDJ EQUAL 41
 24218         GO TO 4050-END-RECORDS,
 24219               4050-END-RECORDS
 24220         DEPENDING ON DFHEIGDI
 24221     ELSE IF DFHEIGDJ EQUAL 42
 24222         GO TO 4150-END-BATCH
 24223         DEPENDING ON DFHEIGDI
 24224     ELSE IF DFHEIGDJ EQUAL 43
 24225         GO TO 4150-END-BATCH
 24226         DEPENDING ON DFHEIGDI
 24227     ELSE IF DFHEIGDJ EQUAL 44
 24228         GO TO 4250-END-RECORDS,
 24229               4250-END-RECORDS
 24230         DEPENDING ON DFHEIGDI
 24231     ELSE IF DFHEIGDJ EQUAL 45
 24232         GO TO 4350-END-BATCH,
 24233               4350-END-BATCH
 24234         DEPENDING ON DFHEIGDI
 24235     ELSE IF DFHEIGDJ EQUAL 46
 24236         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 28-Oct-13 13:50 Page 451
* EL6311.cbl
 24237               4550-END-RECORDS
 24238         DEPENDING ON DFHEIGDI
 24239     ELSE IF DFHEIGDJ EQUAL 47
 24240         GO TO 4680-NOT-FOUND,
 24241               4680-NOT-FOUND
 24242         DEPENDING ON DFHEIGDI
 24243     ELSE IF DFHEIGDJ EQUAL 48
 24244         GO TO 4860-NOT-FOUND,
 24245               4850-END-RECORDS
 24246         DEPENDING ON DFHEIGDI
 24247     ELSE IF DFHEIGDJ EQUAL 49
 24248         GO TO 4970-NOT-FOUND,
 24249               4950-END-RECORDS
 24250         DEPENDING ON DFHEIGDI
 24251     ELSE IF DFHEIGDJ EQUAL 50
 24252         GO TO 5050-NOT-FOUND
 24253         DEPENDING ON DFHEIGDI
 24254     ELSE IF DFHEIGDJ EQUAL 51
 24255         GO TO 5050-NOT-FOUND
 24256         DEPENDING ON DFHEIGDI
 24257     ELSE IF DFHEIGDJ EQUAL 52
 24258         GO TO 5050-NOT-FOUND
 24259         DEPENDING ON DFHEIGDI
 24260     ELSE IF DFHEIGDJ EQUAL 53
 24261         GO TO 5550-END-RECORDS,
 24262               5550-END-RECORDS
 24263         DEPENDING ON DFHEIGDI
 24264     ELSE IF DFHEIGDJ EQUAL 54
 24265         GO TO 6050-QID-ERROR
 24266         DEPENDING ON DFHEIGDI
 24267     ELSE IF DFHEIGDJ EQUAL 55
 24268         GO TO 6050-QID-ERROR
 24269         DEPENDING ON DFHEIGDI
 24270     ELSE IF DFHEIGDJ EQUAL 56
 24271         GO TO 6400-CONTINUE,
 24272               6400-CONTINUE
 24273         DEPENDING ON DFHEIGDI
 24274     ELSE IF DFHEIGDJ EQUAL 57
 24275         GO TO 3690-NOT-FOUND
 24276         DEPENDING ON DFHEIGDI
 24277     ELSE IF DFHEIGDJ EQUAL 58
 24278         GO TO 7399-EXIT
 24279         DEPENDING ON DFHEIGDI
 24280     ELSE IF DFHEIGDJ EQUAL 59
 24281         GO TO 7550-OFFICER-NOTFND
 24282         DEPENDING ON DFHEIGDI
 24283     ELSE IF DFHEIGDJ EQUAL 60
 24284         GO TO 8300-SEND-TEXT
 24285         DEPENDING ON DFHEIGDI.
 24286     MOVE '9%                    "   ' TO DFHEIV0
 24287     MOVE 'EL6311' TO DFHEIV1
 24288     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24289     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14768     Code:       96486
