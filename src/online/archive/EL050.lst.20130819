* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45******************************************************************
    46 ENVIRONMENT DIVISION.
    47
    48 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page   3
* EL050.cbl
    50 WORKING-STORAGE SECTION.
    51 01  DFH-START PIC X(04).
    52
    53 77  FILLER   PIC X(32) VALUE '********************************'.
    54 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    55 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    56
    57 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    58 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    59                                   USAGE POINTER.
    60 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    61 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    62 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    63                                   USAGE IS POINTER.
    64 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    65 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    66                                   USAGE IS POINTER.
    67 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    68 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    69                                   USAGE IS POINTER.
    70
    71 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    72 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    73                                   USAGE IS POINTER.
    74
    75*    COPY ELC50WS.
    76*****************************************************************
    77*                                                               *
    78*                            ELC50WS.                           *
    79*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    80*                            VMOD=2.061.                        *
    81*                                                               *
    82*   THIS IS THE WORKING STORAGE FOR EL050                       *
    83*                                   EL517                       *
    84*****************************************************************
    85******************************************************************
    86*                   C H A N G E   L O G
    87*
    88* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    89*-----------------------------------------------------------------
    90*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    91* EFFECTIVE    NUMBER
    92*-----------------------------------------------------------------
    93* 123102                   PEMA  ADD DCC PROCESSING
    94* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    95* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    96* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    97* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    98* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    99* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   100* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   101* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   102* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   103* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   104* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   105* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   106* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   107* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page   4
* EL050.cbl
   108* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   109* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   110* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   111* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   112* 030309  CR2009021700001  PEMA  ADD ER-2883
   113* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   114* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   115* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   116* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   117* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   118* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   119* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   120* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   121* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   122* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   123* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   124* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   125* 061412  CR2011022800001  AJRA  NAPERSOFT
   126* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   127* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   128* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   129*-----------------------------------------------------------------
   130
   131 01  WORK-AREAS.
   132
   133*****************************************************************
   134*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   135*****************************************************************
   136
   137     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   138     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   139     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   140     12  WS-NAME-EDIT-WORK-AREA.
   141         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   142         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   143             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   144         16  WS-WORK-NAME.
   145             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   146             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   147             20  FILLER           PIC X(10)     VALUE SPACES.
   148         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   149             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   150
   151*****************************************************************
   152*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   153*****************************************************************
   154
   155     12  WS-ERRESC-KEY.
   156         16 WS-ERRESC-SEARCH-KEY.
   157             20  WS-ERRESC-COMPANY-CD PIC  X.
   158             20  WS-ERRESC-CARRIER    PIC  X.
   159             20  WS-ERRESC-GROUP      PIC X(6).
   160             20  WS-ERRESC-STATE      PIC XX.
   161             20  WS-ERRESC-ACCOUNT    PIC X(10).
   162         16 WS-ERRESC-RESIDUAL-KEY.
   163             20  WS-ERRESC-AGENT      PIC X(10).
   164             20  WS-ERRESC-RES-STATE  PIC XX.
   165             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page   5
* EL050.cbl
   166*                                          YYYYMMDD
   167     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   168     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   169
   170*RESIDENT STATE TAX MASTER(ERRESS)
   171*
   172     12  WS-ERRESS-KEY.
   173         16  WS-ERRESS-COMPANY-CD      PIC  X.
   174         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   175         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   176         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   177*                                          YYYYMMDD
   178
   179     12  WS-CONTRACT-DATE              PIC 9(8).
   180*                                          YYYYMMDD
   181     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   182     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   183         16 WS-YEAR-YY                 PIC   9999.
   184         16 FILLER                     PIC 9(4).
   185*                                          YYYYMMDD
   186     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   187     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   188     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   189     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   190
   191     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   192         88  DPRB-1ST-TIME                      VALUE ' '.
   193
   194*****************************************************************
   195*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   196*****************************************************************
   197
   198     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   199     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   200     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   201     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   202     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   203     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   204     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   205     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   206     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   207     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   208         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   209         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   210     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   211         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   212         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   213     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   214
   215     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   216     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   217
   218     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   219     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   220     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   221     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   222     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   223     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page   6
* EL050.cbl
   224     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   225     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   226     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   227     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   228     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   229     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   230     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   231     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   232     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   233     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   234     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   235     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   236     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   237     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   238     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   240     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   241     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   242     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   243     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   244     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   245     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   246     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   247     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   248     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   249     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   250     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   251     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   252     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   253     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   254     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   255     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   256     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   257     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   258     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   259     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   260     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   261     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   262     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   263     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   264     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   265     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   266     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   267     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   268     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   269     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   270     12  WS-2671-SW               PIC X         VALUE SPACE.
   271     12  WS-2672-SW               PIC X         VALUE SPACE.
   272     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   273         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   274     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   275         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   276     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   277
   278     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   279         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   280         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   281         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page   7
* EL050.cbl
   282         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   283
   284     12  WS-CREDIT-EDIT-CONTROLS.
   285         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   286         16  WS-MIN-AGE           PIC 99                VALUE  0.
   287         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   288         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   289         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   290         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   291
   292     12  WS-AGE-FIELDS.
   293         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   294         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   295         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   296         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   297
   298     12  WS-SAVE-ALLOWABLE-BENEFIT.
   299         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   300         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   301         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   302         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   303         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   304         16  FILLER                      PIC XX.
   305
   306     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   307     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   308     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   309     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   310     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   311     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   312     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   313     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   314     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   315     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   316
   317     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   318     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   319     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   320     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   321     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   322     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   323     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   324     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   325         88  WS-REDUCING              VALUE 'R'.
   326         88  WS-LEVEL                 VALUE 'L' 'P'.
   327     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   328
   329     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   330     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   331     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   332     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   333     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   334     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   335     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   336     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   337     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   338
   339     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page   8
* EL050.cbl
   340     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   341     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   342     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   343     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   344     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   345     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   346     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   347     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   348     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   349     12  WS-ACCT-SIG-SW.
   350         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   351         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   352     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   353     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   354     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   355     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   356     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   357     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   358     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   359     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   360     12  WS-INITIALS.
   361         16  WS-INIT-1            PIC X         VALUE SPACES.
   362         16  WS-INIT-2            PIC X         VALUE SPACES.
   363
   364     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   365     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   366     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   367     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   368     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   369*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   370     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   371     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   372     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   373     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   374     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   375     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   376     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   377     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   378     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   379     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   380     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   381     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   382     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   383     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   384     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   385     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   386     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   387     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   388     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   389     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   390     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   391     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   392******** FLA
   393     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   394     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   395     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   396     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   397     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page   9
* EL050.cbl
   398********
   399     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   400     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   401     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   402     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   403     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   404     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   405     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   406     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   407     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   408     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   409
   410     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   411         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   412                                         '0' THRU '9'.
   413
   414     12  NUMBER-OF-MONTHS.
   415         16  SK-MO OCCURS 12 TIMES PIC X.
   416
   417     12  WS-WORK-DATE.
   418         16  WS-YEAR            PIC 99    VALUE 00.
   419         16  WS-MONTH           PIC 99    VALUE 00.
   420         16  WS-DAY             PIC 99    VALUE 00.
   421
   422     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   423     12  WS-WORK-CRIT-DEV       REDEFINES
   424         WS-WORK-LF-CRIT-PER    PIC X(03).
   425
   426     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   427     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   428
   429     12  WS-WORK-DATE-FROM.
   430         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   431         16  FILLER             PIC X  VALUE SPACE.
   432         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   433         16  FILLER             PIC X         VALUE SPACE.
   434         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   435
   436     12  WS-WORK-DATE-THRU.
   437         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   438         16  FILLER             PIC X         VALUE SPACE.
   439         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   440         16  FILLER             PIC X         VALUE SPACE.
   441         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   442
   443     12  WS-LF-INPUT-CD.
   444         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   445         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   446
   447     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   448     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   449         16  WS-AH-INPUT-CD-1   PIC X.
   450         16  WS-AH-INPUT-CD-2-3 PIC XX.
   451
   452     12  WS-SWITCHES.
   453         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   454         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   455             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  10
* EL050.cbl
   456         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   457             88  BANK-ACCT-FOUND          VALUE 'Y'.
   458         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   459             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   460         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   461             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   462         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   463             88  COMP-MASTER-FOUND        VALUE 'Y'.
   464         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   465             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   466         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   467             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   468         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   469             88  STAT-MASTER-FOUND        VALUE 'Y'.
   470         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   471             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   472         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   473             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   474         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   475             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   476         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   477             88  FORM-MASTER-FOUND        VALUE 'Y'.
   478         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   479             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   480         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   481             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   482         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   483             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   484         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   485             88  NO-BENEFIT-FOUND         VALUE 'N'.
   486         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   487             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   488         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   489             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   490         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   491             88  AH-BENEFIT-FOUND         VALUE ' '.
   492             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   493         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   494             88  LF-BENEFIT-FOUND         VALUE ' '.
   495             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   496         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   497             88  NO-STATE-RECORD          VALUE '1'.
   498         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   499             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   500         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   501             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   502         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   503             88  CERT-WAS-FOUND           VALUE ' '.
   504             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   505         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   506             88  BROWSE-STARTED           VALUE 'Y'.
   507         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   508             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   509         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   510             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   511         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   512             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   513         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  11
* EL050.cbl
   514             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   515         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   516             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   517         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   518             88  APP-CERT-USED            VALUE 'Y' 'A'.
   519         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   520             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   521             88  FIRST-TIME-THROUGH       VALUE '1'.
   522             88  CTBL-NOT-FOUND           VALUE '2'.
   523
   524         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   525             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   526
   527         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   528             88  DLO-ERROR-FOUND          VALUE 'Y'.
   529
   530********FLA
   531     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   532     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   533********
   534     12  RC-SW-1                  PIC X           VALUE '0'.
   535     12  RC-SW-2                  PIC X           VALUE '0'.
   536     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   537     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   538     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   539     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   540     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   541     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   542     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   543     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   544     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   545     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   546     12  LIT-SPACES               PIC X           VALUE SPACES.
   547     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   548     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   549     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   550     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   551     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   552     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   553     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   554         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   555         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   556     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   557         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   558
   559 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   560     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   561     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   562 01  WS-CRI-SSN-WORK-AREA.
   563     05  WS-CRI-SOC-SEC-NO.
   564         10  WS-SS-REPT-CD       PIC X(5).
   565         10  WS-SS-LAST-NAME     PIC X(5).
   566         10  WS-SS-INITIAL       PIC X.
   567
   568     05  WS-CRI-REPORT-CODE.
   569         10  FILLER              PIC X(5).
   570         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   571
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  12
* EL050.cbl
   572     05  WS-CRI-LAST-NAME.
   573         10  WS-CRI-NAME-MOVE    PIC X(5).
   574         10  FILLER              PIC X(10).
   575
   576 01  WS-NUM-TABLE                PIC X(26)  VALUE
   577     '12345678012345070923456789'.
   578 01  FILLER REDEFINES WS-NUM-TABLE.
   579     05  WS-NUM OCCURS 26        PIC 9.
   580 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   581 01  V1                          PIC S999 COMP-3.
   582 01  V2                          PIC S999 COMP-3.
   583 01  V3                          PIC S999 COMP-3.
   584 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   585 01  FILLER REDEFINES WS-WORK-VIN.
   586     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   587 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   588 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   589 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   590 01  WS-HEX-WORK.
   591     05  FILLER                  PIC X  VALUE LOW-VALUES.
   592     05  WS-HEX-BYTE             PIC X.
   593 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   594 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   595 01  WS-WORK-HIN-ROW-B.
   596     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   597
   598 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   599 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   600     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   601 01  WS-ROW-D-TABLE.
   602     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   603
   604 01  WS-HIN-TABLE-B.
   605     05  F                       PIC XX VALUE 'A2'.
   606     05  F                       PIC XX VALUE 'B3'.
   607     05  F                       PIC XX VALUE 'C4'.
   608     05  F                       PIC XX VALUE 'D5'.
   609     05  F                       PIC XX VALUE 'E6'.
   610     05  F                       PIC XX VALUE 'F7'.
   611     05  F                       PIC XX VALUE 'G8'.
   612     05  F                       PIC XX VALUE 'H9'.
   613     05  F                       PIC XX VALUE 'I1'.
   614     05  F                       PIC XX VALUE 'J2'.
   615     05  F                       PIC XX VALUE 'K3'.
   616     05  F                       PIC XX VALUE 'L4'.
   617     05  F                       PIC XX VALUE 'M5'.
   618     05  F                       PIC XX VALUE 'N6'.
   619     05  F                       PIC XX VALUE 'O0'.
   620     05  F                       PIC XX VALUE 'P7'.
   621     05  F                       PIC XX VALUE 'Q0'.
   622     05  F                       PIC XX VALUE 'R8'.
   623     05  F                       PIC XX VALUE 'S9'.
   624     05  F                       PIC XX VALUE 'T2'.
   625     05  F                       PIC XX VALUE 'U3'.
   626     05  F                       PIC XX VALUE 'V4'.
   627     05  F                       PIC XX VALUE 'W5'.
   628     05  F                       PIC XX VALUE 'X6'.
   629     05  F                       PIC XX VALUE 'Y7'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  13
* EL050.cbl
   630     05  F                       PIC XX VALUE 'Z8'.
   631 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   632     05  WS-VAL-IN               PIC X.
   633     05  WS-VAL-OUT              PIC 9.
   634 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   635 01  WS-COMPARE-BINARY-DATES.
   636     05  WS-971231                PIC XX VALUE X'92FF'.
   637     05  WS-931231                PIC XX VALUE X'8CFF'.
   638     05  WS-791231                PIC XX VALUE X'77FF'.
   639     05  WS-771001                PIC XX VALUE X'74A1'.
   640     05  WS-820301                PIC XX VALUE X'7B41'.
   641     05  WS-831031                PIC XX VALUE X'7DBF'.
   642     05  WS-831231                PIC XX VALUE X'7DFF'.
   643     05  WS-810831                PIC XX VALUE X'7A7F'.
   644     05  WS-830901                PIC XX VALUE X'7D81'.
   645
   646 01  FILE-ACCESS-IDS.
   647     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   648     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   649     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   650     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   651     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   652     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   653     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   654     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   655     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   656     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   657     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   658     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   659     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   660     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   661     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   662     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   663     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   664 01  DD-IU-SW                    PIC X   VALUE ' '.
   665     88  DD-IU-PRESENT                 VALUE 'Y'.
   666
   667 01  ACCESS-KEYS.
   668     12  ELMSTR-KEY.
   669         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   670         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   671     12  W-CLAIM-KEY.
   672         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   673         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   674
   675     12  ELCNTL-KEY.
   676         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   677         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   678         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   679         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   680
   681     12  ELCERT-KEY.
   682         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   683         16  CERT-CARRIER         PIC X       VALUE SPACE.
   684         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   685         16  CERT-STATE           PIC XX      VALUE SPACES.
   686         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   687         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  14
* EL050.cbl
   688         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   689
   690     12  ELCERT2-KEY.
   691         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   692         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   693
   694     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   695
   696     12  ELCERT-SAVE.
   697         16  FILLER                      PIC XX    VALUE SPACES.
   698
   699         16  WCS-CONTROL-PRIMARY.
   700             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   701             20  WCS-CARRIER             PIC X     VALUE SPACE.
   702             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   703             20  WCS-STATE               PIC XX    VALUE SPACES.
   704             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   705             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   706             20  WCS-CERT-NO.
   707                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   708                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   709
   710         16  CS-CONTROL-BY-NAME.
   711             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   712             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   713             20  CS-INSURED-INITIALS.
   714                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   715                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   716
   717         16  CS-CONTROL-BY-SSN.
   718             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   719             20  CS-SOC-SEC-NO.
   720                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   721                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   722                 24  CS-SSN-LN3.
   723                     28 CS-INSURED-INITIALS-A2   PIC XX
   724                                     VALUE SPACES.
   725                     28 CS-PART-LAST-NAME-A2     PIC X
   726                                     VALUE SPACE.
   727
   728         16  CS-CONTROL-BY-CERT-NO.
   729             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   730             20  CS-CERT-NO-A4           PIC X(11)
   731                                     VALUE SPACES.
   732
   733         16  CS-CONTROL-BY-MEMB.
   734             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   735             20  CS-MEMBER-NO.
   736                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   737                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   738                 24  CS-MEMB-LN4.
   739                     28 CS-INSURED-INITIALS-A5   PIC XX
   740                                      VALUE SPACES.
   741                     28 CS-PART-LAST-NAME-A5     PIC XX
   742                                      VALUE SPACES.
   743
   744         16  FILLER              PIC X(360) VALUE SPACES.
   745
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  15
* EL050.cbl
   746     12  ERACCT-KEY.
   747         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   748         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   749         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   750         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   751         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   752         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   753
   754     12  ERCOMP-KEY.
   755         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   756         16  COMP-CARRIER         PIC X     VALUE SPACES.
   757         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   758         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   759         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   760         16  COMP-TYPE            PIC X     VALUE SPACES.
   761
   762     12  ERLOFC-KEY.
   763         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   764         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   765         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   766         16  LOFC-STATE           PIC XX    VALUE SPACES.
   767         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   768         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   769
   770     12  WS-ELCRTT-KEY.
   771         16  WS-ELCRTT-PRIMARY       PIC X(33).
   772         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   773
   774     12  ERBXRF-KEY.
   775         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   776         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   777         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   778         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   779
   780     12  ERAGTC-KEY.
   781         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   782         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   783         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   784         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   785         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   786         16  AGTC-TYPE            PIC X     VALUE SPACES.
   787
   788     12  ERPLAN-KEY.
   789         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   790         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   791         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   792         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   793         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   794         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   795         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   796         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   797
   798     12  ERFORM-KEY.
   799         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   800         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   801         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   802         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   803
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  16
* EL050.cbl
   804     12  ERREIN-KEY.
   805         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   806         16  REIN-TYPE            PIC X     VALUE SPACES.
   807         16  REIN-TABLE-CO.
   808             20  REIN-CODE-1      PIC X     VALUE SPACE.
   809             20  REIN-CODE-2      PIC X     VALUE SPACE.
   810             20  REIN-CODE-3      PIC X     VALUE SPACE.
   811         16  FILLER               PIC X(3)  VALUE SPACES.
   812
   813     12  ERCTBL-KEY.
   814         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   815         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   816         16  CTBL-CNTRL-2.
   817             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   818             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   819
   820     12  ELCRTO-KEY.
   821         16  ELCRTO-COMPANY-CD       PIC X.
   822         16  ELCRTO-CARRIER          PIC X.
   823         16  ELCRTO-GROUPING         PIC X(6).
   824         16  ELCRTO-STATE            PIC XX.
   825         16  ELCRTO-ACCOUNT          PIC X(10).
   826         16  ELCRTO-CERT-EFF-DT      PIC XX.
   827         16  ELCRTO-CERT-NO.
   828             20  ELCRTO-CERT-PRIME   PIC X(10).
   829             20  ELCRTO-CERT-SFX     PIC X.
   830         16  ELCRTO-RECORD-TYPE      PIC X.
   831         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   832
   833
   834     12  WS-ACCESS.
   835         16  FILLER               PIC XX    VALUE SPACES.
   836         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   837
   838     12  WS-CARR-ACCESS.
   839         16  FILLER               PIC X(3)  VALUE SPACES.
   840         16  WS-CARR              PIC X     VALUE SPACE.
   841*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   842*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   843     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   844         88  WS-DMD-LF-RATING   VALUE 'Y'.
   845         88  WS-DMD-AH-RATING   VALUE 'Y'.
   846         88  WS-DMD-NO-RATING   VALUE 'N'.
   847
   848     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   849         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   850                                         'NJ' 'NL'
   851                                         'PJ' 'PL'
   852                                         'SJ' 'SL'.
   853     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   854         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   855                                         'NI' 'NJ' 'NL' 'NU'
   856                                         'PJ' 'PL' 'PI' 'PU'
   857                                         'SI' 'SJ' 'SL' 'SU'
   858                                         'MX' 'MY' 'MZ'.
   859 01  ERPDEF-KEY-SAVE             PIC X(18).
   860 01  ERPDEF-KEY.
   861     12  ERPDEF-COMPANY-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  17
* EL050.cbl
   862     12  ERPDEF-STATE            PIC XX.
   863     12  ERPDEF-PROD-CD          PIC XXX.
   864     12  F                       PIC X(7).
   865     12  ERPDEF-BEN-TYPE         PIC X.
   866     12  ERPDEF-BEN-CODE         PIC XX.
   867     12  ERPDEF-EXP-DT           PIC XX.
   868
   869 01  ELSTAT-KEY-SAVE             PIC X(20).
   870 01  ELSTAT-KEY.
   871     12  ELSTAT-COMPANY-ID       PIC XXX.
   872     12  ELSTAT-CARRIER          PIC X.
   873     12  ELSTAT-GROUP            PIC X(6).
   874     12  ELSTAT-STATE            PIC XX.
   875     12  ELSTAT-EXP-DT           PIC 9(8).
   876 01  WS-ERROR-VALUES.
   877     12  ER-1570                     PIC S9(4)   VALUE +1570.
   878     12  ER-1571                     PIC S9(4)   VALUE +1571.
   879     12  ER-1575                     PIC S9(4)   VALUE +1575.
   880     12  ER-1891                     PIC S9(4)   VALUE +1891.
   881     12  ER-1892                     PIC S9(4)   VALUE +1892.
   882     12  ER-1893                     PIC S9(4)   VALUE +1893.
   883     12  ER-1894                     PIC S9(4)   VALUE +1894.
   884     12  ER-1895                     PIC S9(4)   VALUE +1895.
   885     12  ER-1896                     PIC S9(4)   VALUE +1896.
   886     12  ER-1897                     PIC S9(4)   VALUE +1897.
   887     12  ER-1898                     PIC S9(4)   VALUE +1898.
   888     12  ER-1899                     PIC S9(4)   VALUE +1899.
   889     12  ER-1900                     PIC S9(4)   VALUE +1900.
   890     12  ER-1901                     PIC S9(4)   VALUE +1901.
   891     12  ER-1902                     PIC S9(4)   VALUE +1902.
   892     12  ER-1903                     PIC S9(4)   VALUE +1903.
   893     12  ER-1904                     PIC S9(4)   VALUE +1904.
   894     12  ER-1905                     PIC S9(4)   VALUE +1905.
   895     12  ER-1906                     PIC S9(4)   VALUE +1906.
   896     12  ER-1907                     PIC S9(4)   VALUE +1907.
   897     12  ER-1909                     PIC S9(4)   VALUE +1909.
   898     12  ER-1910                     PIC S9(4)   VALUE +1910.
   899     12  ER-1911                     PIC S9(4)   VALUE +1911.
   900     12  ER-1912                     PIC S9(4)   VALUE +1912.
   901     12  ER-1913                     PIC S9(4)   VALUE +1913.
   902     12  ER-1914                     PIC S9(4)   VALUE +1914.
   903     12  ER-1915                     PIC S9(4)   VALUE +1915.
   904     12  ER-1916                     PIC S9(4)   VALUE +1916.
   905     12  ER-1917                     PIC S9(4)   VALUE +1917.
   906     12  ER-1918                     PIC S9(4)   VALUE +1918.
   907     12  ER-1919                     PIC S9(4)   VALUE +1919.
   908     12  ER-1920                     PIC S9(4)   VALUE +1920.
   909     12  ER-1921                     PIC S9(4)   VALUE +1921.
   910     12  ER-1922                     PIC S9(4)   VALUE +1922.
   911     12  ER-1923                     PIC S9(4)   VALUE +1923.
   912     12  ER-1924                     PIC S9(4)   VALUE +1924.
   913     12  ER-1925                     PIC S9(4)   VALUE +1925.
   914     12  ER-1926                     PIC S9(4)   VALUE +1926.
   915     12  ER-1927                     PIC S9(4)   VALUE +1927.
   916     12  ER-2393                     PIC S9(4)   VALUE +2393.
   917     12  ER-2600                     PIC S9(4)   VALUE +2600.
   918     12  ER-2601                     PIC S9(4)   VALUE +2601.
   919     12  ER-2602                     PIC S9(4)   VALUE +2602.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  18
* EL050.cbl
   920     12  ER-2603                     PIC S9(4)   VALUE +2603.
   921     12  ER-2604                     PIC S9(4)   VALUE +2604.
   922     12  ER-2605                     PIC S9(4)   VALUE +2605.
   923     12  ER-2606                     PIC S9(4)   VALUE +2606.
   924     12  ER-2607                     PIC S9(4)   VALUE +2607.
   925     12  ER-2608                     PIC S9(4)   VALUE +2608.
   926     12  ER-2609                     PIC S9(4)   VALUE +2609.
   927     12  ER-2610                     PIC S9(4)   VALUE +2610.
   928     12  ER-2611                     PIC S9(4)   VALUE +2611.
   929     12  ER-2612                     PIC S9(4)   VALUE +2612.
   930     12  ER-2613                     PIC S9(4)   VALUE +2613.
   931     12  ER-2614                     PIC S9(4)   VALUE +2614.
   932     12  ER-2615                     PIC S9(4)   VALUE +2615.
   933     12  ER-2616                     PIC S9(4)   VALUE +2616.
   934     12  ER-2617                     PIC S9(4)   VALUE +2617.
   935     12  ER-2618                     PIC S9(4)   VALUE +2618.
   936     12  ER-2619                     PIC S9(4)   VALUE +2619.
   937     12  ER-2620                     PIC S9(4)   VALUE +2620.
   938     12  ER-2621                     PIC S9(4)   VALUE +2621.
   939     12  ER-2622                     PIC S9(4)   VALUE +2622.
   940     12  ER-2623                     PIC S9(4)   VALUE +2623.
   941     12  ER-2624                     PIC S9(4)   VALUE +2624.
   942     12  ER-2625                     PIC S9(4)   VALUE +2625.
   943     12  ER-2626                     PIC S9(4)   VALUE +2626.
   944     12  ER-2627                     PIC S9(4)   VALUE +2627.
   945     12  ER-2628                     PIC S9(4)   VALUE +2628.
   946     12  ER-2629                     PIC S9(4)   VALUE +2629.
   947     12  ER-2630                     PIC S9(4)   VALUE +2630.
   948     12  ER-2631                     PIC S9(4)   VALUE +2631.
   949     12  ER-2632                     PIC S9(4)   VALUE +2632.
   950     12  ER-2633                     PIC S9(4)   VALUE +2633.
   951     12  ER-2634                     PIC S9(4)   VALUE +2634.
   952     12  ER-2635                     PIC S9(4)   VALUE +2635.
   953     12  ER-2636                     PIC S9(4)   VALUE +2636.
   954     12  ER-2637                     PIC S9(4)   VALUE +2637.
   955     12  ER-2638                     PIC S9(4)   VALUE +2638.
   956     12  ER-2639                     PIC S9(4)   VALUE +2639.
   957     12  ER-2640                     PIC S9(4)   VALUE +2640.
   958     12  ER-2641                     PIC S9(4)   VALUE +2641.
   959     12  ER-2642                     PIC S9(4)   VALUE +2642.
   960     12  ER-2643                     PIC S9(4)   VALUE +2643.
   961     12  ER-2644                     PIC S9(4)   VALUE +2644.
   962     12  ER-2645                     PIC S9(4)   VALUE +2645.
   963     12  ER-2646                     PIC S9(4)   VALUE +2646.
   964     12  ER-2647                     PIC S9(4)   VALUE +2647.
   965     12  ER-2648                     PIC S9(4)   VALUE +2648.
   966     12  ER-2649                     PIC S9(4)   VALUE +2649.
   967     12  ER-2650                     PIC S9(4)   VALUE +2650.
   968     12  ER-2651                     PIC S9(4)   VALUE +2651.
   969     12  ER-2652                     PIC S9(4)   VALUE +2652.
   970     12  ER-2653                     PIC S9(4)   VALUE +2653.
   971     12  ER-2654                     PIC S9(4)   VALUE +2654.
   972     12  ER-2655                     PIC S9(4)   VALUE +2655.
   973     12  ER-2656                     PIC S9(4)   VALUE +2656.
   974     12  ER-2657                     PIC S9(4)   VALUE +2657.
   975     12  ER-2658                     PIC S9(4)   VALUE +2658.
   976     12  ER-2659                     PIC S9(4)   VALUE +2659.
   977     12  ER-2660                     PIC S9(4)   VALUE +2660.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  19
* EL050.cbl
   978     12  ER-2661                     PIC S9(4)   VALUE +2661.
   979     12  ER-2662                     PIC S9(4)   VALUE +2662.
   980     12  ER-2663                     PIC S9(4)   VALUE +2663.
   981     12  ER-2664                     PIC S9(4)   VALUE +2664.
   982     12  ER-2665                     PIC S9(4)   VALUE +2665.
   983     12  ER-2666                     PIC S9(4)   VALUE +2666.
   984     12  ER-2667                     PIC S9(4)   VALUE +2667.
   985     12  ER-2668                     PIC S9(4)   VALUE +2668.
   986     12  ER-2669                     PIC S9(4)   VALUE +2669.
   987     12  ER-2670                     PIC S9(4)   VALUE +2670.
   988     12  ER-2671                     PIC S9(4)   VALUE +2671.
   989     12  ER-2672                     PIC S9(4)   VALUE +2672.
   990     12  ER-2673                     PIC S9(4)   VALUE +2673.
   991     12  ER-2674                     PIC S9(4)   VALUE +2674.
   992     12  ER-2675                     PIC S9(4)   VALUE +2675.
   993     12  ER-2676                     PIC S9(4)   VALUE +2676.
   994     12  ER-2677                     PIC S9(4)   VALUE +2677.
   995     12  ER-2678                     PIC S9(4)   VALUE +2678.
   996     12  ER-2679                     PIC S9(4)   VALUE +2679.
   997     12  ER-2680                     PIC S9(4)   VALUE +2680.
   998     12  ER-2681                     PIC S9(4)   VALUE +2681.
   999     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1000     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1001     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1002     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1003     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1004     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1005     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1006     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1007     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1008     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1009     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1010     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1011     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1012     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1013     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1014     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1015     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1016     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1017     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1018     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1019     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1020     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1021     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1022     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1023     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1024     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1025     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1026     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1027     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1028     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1029     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1030     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1031     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1032     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1033     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1034     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1035     12  ER-2728                     PIC S9(4)   VALUE +2728.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  20
* EL050.cbl
  1036     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1037     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1038     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1039     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1040     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1041     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1042     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1043     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1044     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1045     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1046     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1047     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1048     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1049     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1050     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1051     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1052     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1053     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1054     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1055     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1056     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1057     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1058     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1059     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1060     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1061     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1062     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1063     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1064     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1065     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1066     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1067     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1068     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1069     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1070     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1071     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1072     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1073     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1074     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1075     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1076     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1077     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1078     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1079     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1080     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1081     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1082     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1083     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1084     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1085     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1086     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1087     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1088     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1089     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1090     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1091     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1092     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1093     12  ER-2788                     PIC S9(4)   VALUE +2788.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  21
* EL050.cbl
  1094     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1095     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1096     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1097     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1098     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1099     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1100     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1101     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1102     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1103     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1104     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1105     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1106     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1107     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1108     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1109     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1110     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1111     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1112     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1113     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1114     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1115     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1116     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1117     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1118     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1119     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1120     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1121     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1122     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1123     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1124     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1125     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1126     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1127     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1128     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1129     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1130     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1131     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1132     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1133     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1134     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1135     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1136     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1137     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1138     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1139     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1140     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1141     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1142     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1143     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1144     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1145     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1146     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1147     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1148     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1149     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1150     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1151     12  ER-8039                     PIC S9(4)   VALUE +8039.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  22
* EL050.cbl
  1152     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1153     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1154     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1155     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1156     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1157     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1158     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1159     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1160     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1161     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1162     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1163     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1164     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1165     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1166     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1167     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1168     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1169     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1170     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1171     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1172     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1173     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1174     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1175     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1176     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1177     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1178     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1179     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1180     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1181     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1182     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1183     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1184     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1185     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1186     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1187     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1188     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1189     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1190     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1191     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1192     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1193     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1194     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1195     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1196     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1197     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1198     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1199     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1200     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1201     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1202     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1203     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1204     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1205     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1206     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1207     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1208     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1209     12  ER-8313                     PIC S9(4)   VALUE +8313.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  23
* EL050.cbl
  1210     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1211     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1212     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1213     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1214     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1215     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1216     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1217     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1218     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1219******************************************************************
  1220***************   END OF ELC50WS     ****************************
  1221******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  24
* EL050.cbl
  1224 01  WORKING-STORAGE-WORK-AREAS.
  1225     12  WS-RESPONSE             PIC S9(8)  COMP.
  1226         88  WS-RESP-NORMAL           VALUE +00.
  1227         88  WS-RESP-ERROR            VALUE +01.
  1228         88  WS-RESP-NOTFND           VALUE +13.
  1229         88  WS-RESP-DUPREC           VALUE +14.
  1230         88  WS-RESP-ENDFILE          VALUE +20.
  1231     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1232     12  WORK-AREAS.
  1233         16  WK-CONV-GREG.
  1234             24  WCG-CENT             PIC XX.
  1235             24  WCG-REST             PIC X(4).
  1236         16  WORK-GREGORIAN-DATE.
  1237             24  WK-GREG-CENT         PIC XX.
  1238             24  WK-GREG-DATE-YYMMDD.
  1239                 28  WK-GREG-YYMM     PIC X(4).
  1240                 28  WK-GREG-DD       PIC XX.
  1241
  1242         16  WORK-SELECT-DATE.
  1243             24  WK-SELECT-CENT            PIC XX.
  1244             24  WK-SELECT-DATE-YYMMDD.
  1245                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1246                 28  FILLER                PIC XX.
  1247
  1248         16  WK-FORM-NO.
  1249             24  WK-FORM-BANK-ID       PIC X(5).
  1250             24  WK-FORM-UNDRWRTR      PIC X(1).
  1251             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1252
  1253         16  WK-MEMBER-NO.
  1254             24  WK-MEMBER-1-6        PIC X(6).
  1255             24  WK-MEMBER-7-12       PIC X(6).
  1256
  1257         16  WK-FULL-CERT-NO.
  1258             24  WK-CERT-POS-1-2      PIC X(2).
  1259             24  WK-CERT-POS-3        PIC X(1).
  1260             24  WK-CERT-POS-4        PIC X(1).
  1261             24  WK-CERT-POS-5-6      PIC X(2).
  1262             24  WK-CERT-POS-7        PIC X(1).
  1263             24  WK-CERT-POS-8-11     PIC X(4).
  1264
  1265         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1266             88  VALID-RATE-CODE        VALUE 'Y'.
  1267             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1268
  1269         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1270         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1271         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1272         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1273         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1274         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1275         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1276         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1277         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1278         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1279
  1280* DLO001
  1281 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  25
* EL050.cbl
  1282     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1283     12  DMPF-RETURN-CODE          PIC XX.
  1284         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1285         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1286         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1287         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1288         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1289         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1290
  1291* DLO002
  1292 01  WS-DLO-INTERNAL-POLICY-FORM.
  1293     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1294     12  DIPF-RETURN-CODE          PIC XX.
  1295         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1296         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1297         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1298         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1299         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1300         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1301
  1302* DLO003
  1303 01  WS-DLO-VALID-BANK-ID.
  1304     12  DVBI-BANK-ID              PIC X(5).
  1305     12  DVBI-BANK-ID-TYPE         PIC X.
  1306         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1307         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1308         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1309         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1310         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1311     12  DVBI-RETURN-CODE          PIC XX.
  1312         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1313         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1314         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1315         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1316         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1317         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1318         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1319         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1320         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1321
  1322* DLO007
  1323 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1324     12  DCUA-RES-STATE            PIC XX.
  1325     12  DCUA-BEN-TYPE             PIC XX.
  1326     12  DCUA-SYS-IDENT            PIC X.
  1327         88  DCUA-CLAIM                        VALUE 'C'.
  1328         88  DCUA-PREMIUM                      VALUE 'P'.
  1329     12  DCUA-COVERAGE-RULE        PIC X.
  1330     12  DCUA-CLIENT-ID            PIC X(10).
  1331     12  DCUA-EFF-DATE             PIC X(8).
  1332     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1333     12  DCUA-RETURN-CODE          PIC XX.
  1334         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1335     12  DCUA-CERT-NUMBER          PIC X(11).
  1336     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1337     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1338
  1339* DLO011
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  26
* EL050.cbl
  1340 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1341     12  DPRB-RATE-CODE            PIC X(4).
  1342     12  DPRB-COVERAGE-CATEG       PIC X.
  1343     12  DPRB-RETURN-CODE          PIC XX.
  1344         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1345         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1346         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1347         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1348         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1349         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1350         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1351         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1352         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1353     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1354     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1355     12  DPRB-BEN-TYPE             PIC XX.
  1356
  1357* DLO017
  1358 01  WS-DLO-VALID-RATE-CODE.
  1359     12  DVRC-RATE-CODE            PIC X(4).
  1360     12  DVRC-RETURN-CODE          PIC XX.
  1361         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1362         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1363         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1364         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1365         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1366         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1367
  1368* DLO019
  1369 01  WS-DLO-ORIG-COV-CAT.
  1370     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1371     12  DOCC-RETURN-CODE          PIC XX.
  1372     12  DOCC-ORIG-COV-CAT         PIC X.
  1373     12  DOCC-UNDERWITER           PIC XX.
  1374     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1375     12  DOCC-FILLER               PIC X(6).
  1376
  1377* DLO021
  1378 01  WS-DLO-VALID-LOAN-OFFICER.
  1379     12  DVLO-LOAN-OFFICER.
  1380         16  DVLO-BILL-TYPE        PIC X.
  1381         16  DVLO-BILL-SOURCE      PIC X.
  1382         16  DVLO-BATCH-TYPE       PIC X.
  1383     12  DVLO-RETURN-CODE          PIC XX.
  1384         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1385         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1386         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1387         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1388         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1389         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1390
  1391* DLO022
  1392 01  WS-DLO-VALID-STATE-CODE.
  1393     12  DVSC-STATE-CODE           PIC XX.
  1394     12  DVSC-RETURN-CODE          PIC XX.
  1395         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1396
  1397* DLO023
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  27
* EL050.cbl
  1398 01  WS-DLO-VALID-CODE-VALUES.
  1399     12  DVCV-SYSTEM-ID            PIC XX.
  1400         88  DVCV-CLAIMS                       VALUE 'CL'.
  1401         88  DVCV-CREDIT                       VALUE 'CR'.
  1402     12  DVCV-RECORD-TYPE          PIC XX.
  1403         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1404         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1405         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1406         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1407         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1408         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1409         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1410         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1411     12  DVCV-RECORD-KEY           PIC X(6).
  1412     12  DVCV-RETURN-CODE          PIC XX.
  1413         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1414         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1415         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1416         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1417         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1418         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1419         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1420     12  DVCV-CODE-DESC            PIC X(60).
  1421     12  DVCV-GEN-DESC-1           PIC X(20).
  1422     12  DVCV-GEN-DESC-2           PIC X(20).
  1423     12  DVCV-GEN-DESC-3           PIC X(20).
  1424
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  28
* EL050.cbl
  1426*    COPY ERCBXRF.
  1427******************************************************************
  1428*                                                                *
  1429*                                                                *
  1430*                            ERCBXRF                             *
  1431*                                                                *
  1432*   ONLINE CREDIT SYSTEM                                         *
  1433*                                                                *
  1434*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1435*                                                                *
  1436*   FILE TYPE = VSAM,KSDS                                        *
  1437*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1438*                                                                *
  1439*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1440*       ALTERNATE PATH = NONE                                    *
  1441*                                                                *
  1442*   LOG = NO                                                     *
  1443*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1444*                                                                *
  1445******************************************************************
  1446
  1447 01  BANK-CROSS-REFERENCE.
  1448     12  BK-RECORD-ID                PIC XX.
  1449         88  VALID-BK-ID             VALUE 'BK'.
  1450
  1451     12  BK-CONTROL-PRIMARY.
  1452         16  BK-COMPANY-CD           PIC X.
  1453         16  BK-CARRIER              PIC X.
  1454         16  BK-GROUPING             PIC X(6).
  1455         16  BK-BANK-NO              PIC X(10).
  1456
  1457     12  BK-MAINT-INFORMATION.
  1458         16  BK-LAST-MAINT-DT        PIC XX.
  1459         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1460         16  BK-LAST-MAINT-USER      PIC X(4).
  1461         16  FILLER                  PIC X(9).
  1462
  1463     12  FILLER                      PIC X(37).
  1464
  1465     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1466
  1467     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1468                            DEPENDING ON BK-BANK-POINTER-CNT.
  1469         16  BK-AM-ACCOUNT           PIC X(10).
  1470         16  BK-AM-EXP-DT            PIC XX.
  1471         16  BK-AM-EFF-DT            PIC XX.
  1472         16  BK-AM-STATE             PIC XX.
  1473         16  FILLER                  PIC X(20).
  1474
  1475******************************************************************
  1476
  1477*    COPY ERCCOMP.
  1478******************************************************************
  1479*                                                                *
  1480*                                                                *
  1481*                            ERCCOMP                             *
  1482*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1483*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  29
* EL050.cbl
  1484*                                                                *
  1485*   ONLINE CREDIT SYSTEM                                         *
  1486*                                                                *
  1487*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1488*                                                                *
  1489*   FILE TYPE = VSAM,KSDS                                        *
  1490*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1491*                                                                *
  1492*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1493*       ALTERNATE PATH = NONE                                    *
  1494*                                                                *
  1495*   LOG = NO                                                     *
  1496*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1497*                                                                *
  1498******************************************************************
  1499*                   C H A N G E   L O G
  1500*
  1501* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1502*-----------------------------------------------------------------
  1503*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1504* EFFECTIVE    NUMBER
  1505*-----------------------------------------------------------------
  1506* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1507* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1508* 092205    2005050300006  PEMA  ADD LEASE FEE
  1509* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1510* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1511* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1512* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1513* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1514* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1515******************************************************************
  1516
  1517 01  COMPENSATION-MASTER.
  1518     12  CO-RECORD-ID                          PIC XX.
  1519         88  VALID-CO-ID                          VALUE 'CO'.
  1520
  1521     12  CO-CONTROL-PRIMARY.
  1522         16  CO-COMPANY-CD                     PIC X.
  1523         16  CO-CONTROL.
  1524             20  CO-CTL-1.
  1525                 24  CO-CARR-GROUP.
  1526                     28  CO-CARRIER            PIC X.
  1527                     28  CO-GROUPING.
  1528                         32  CO-GROUP-PREFIX   PIC XXX.
  1529                         32  CO-GROUP-PRIME    PIC XXX.
  1530                 24  CO-RESP-NO.
  1531                     28  CO-RESP-PREFIX        PIC X(4).
  1532                     28  CO-RESP-PRIME         PIC X(6).
  1533             20  CO-CTL-2.
  1534                 24  CO-ACCOUNT.
  1535                     28  CO-ACCT-PREFIX        PIC X(4).
  1536                     28  CO-ACCT-PRIME         PIC X(6).
  1537         16  CO-TYPE                           PIC X.
  1538             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1539             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1540             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1541
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  30
* EL050.cbl
  1542     12  CO-MAINT-INFORMATION.
  1543         16  CO-LAST-MAINT-DT                  PIC XX.
  1544         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1545         16  CO-LAST-MAINT-USER                PIC X(4).
  1546     12  FILLER                                PIC XX.
  1547     12  CO-STMT-TYPE                          PIC XXX.
  1548     12  CO-COMP-TYPE                          PIC X.
  1549         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1550     12  CO-STMT-OWNER                         PIC X(4).
  1551     12  CO-BALANCE-CONTROL                    PIC X.
  1552         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1553         88  CO-NO-BALANCE                        VALUE 'N'.
  1554
  1555     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1556         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1557         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1558         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1559
  1560     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1561         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1562         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1563
  1564     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1565     12  CO-GA-DIRECT-DEP                      PIC X.
  1566     12  CO-FUTURE-SPACE                       PIC X.
  1567         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1568
  1569     12  CO-ACCT-NAME                          PIC X(30).
  1570     12  CO-MAIL-NAME                          PIC X(30).
  1571     12  CO-ADDR-1                             PIC X(30).
  1572     12  CO-ADDR-2                             PIC X(30).
  1573     12  CO-ADDR-3.
  1574         16  CO-ADDR-CITY                      PIC X(27).
  1575         16  CO-ADDR-STATE                     PIC XX.
  1576     12  CO-CSO-1099                           PIC X.
  1577     12  CO-ZIP.
  1578         16  CO-ZIP-PRIME.
  1579             20  CO-ZIP-PRI-1ST                PIC X.
  1580                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1581             20  FILLER                        PIC X(4).
  1582         16  CO-ZIP-PLUS4                      PIC X(4).
  1583     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1584         16  CO-CAN-POSTAL-1                   PIC XXX.
  1585         16  CO-CAN-POSTAL-2                   PIC XXX.
  1586         16  FILLER                            PIC XXX.
  1587     12  CO-SOC-SEC                            PIC X(13).
  1588     12  CO-TELEPHONE.
  1589         16  CO-AREA-CODE                      PIC XXX.
  1590         16  CO-PREFIX                         PIC XXX.
  1591         16  CO-PHONE                          PIC X(4).
  1592
  1593     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1594
  1595     12  CO-AR-BAL-LEVEL                       PIC X.
  1596         88  CO-AR-REF-LVL                        VALUE '1'.
  1597         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1598         88  CO-AR-BILL-LVL                       VALUE '2'.
  1599         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  31
* EL050.cbl
  1600         88  CO-AR-FR-LVL                         VALUE '4'.
  1601
  1602     12  CO-AR-NORMAL-PRINT                    PIC X.
  1603         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1604         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1605
  1606     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1607
  1608     12  CO-AR-REPORTING                       PIC X.
  1609         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1610         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1611
  1612     12  CO-AR-PULL-CHECK                      PIC X.
  1613         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1614         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1615
  1616     12  CO-AR-BALANCE-PRINT                   PIC X.
  1617         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1618
  1619     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1620         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1621         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1622         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1623
  1624     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1625
  1626     12  CO-USER-CODE                          PIC X.
  1627     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1628
  1629******************************************************************
  1630*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1631*    THE LAST MONTH END RUN.
  1632******************************************************************
  1633
  1634     12  CO-LAST-ACTIVITY-DATE.
  1635         16  CO-ACT-YEAR                       PIC 99.
  1636         16  CO-ACT-MONTH                      PIC 99.
  1637         16  CO-ACT-DAY                        PIC 99.
  1638
  1639     12  CO-LAST-STMT-DT.
  1640         16  CO-LAST-STMT-YEAR                 PIC 99.
  1641         16  CO-LAST-STMT-MONTH                PIC 99.
  1642         16  CO-LAST-STMT-DAY                  PIC 99.
  1643
  1644     12  CO-MO-END-TOTALS.
  1645         16  CO-MONTHLY-TOTALS.
  1646             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1647             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1648             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1649             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1650             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1651
  1652         16  CO-AGING-TOTALS.
  1653             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1654             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1655             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1656             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1657
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  32
* EL050.cbl
  1658         16  CO-YTD-TOTALS.
  1659             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1660             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1661
  1662         16  CO-OVER-UNDER-TOTALS.
  1663             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1664             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1665
  1666     12  CO-MISCELLANEOUS-TOTALS.
  1667         16  CO-FICA-TOTALS.
  1668             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1669             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1670
  1671         16  CO-CLAIM-TOTALS.
  1672             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1673             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1674
  1675******************************************************************
  1676*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1677*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1678******************************************************************
  1679
  1680     12  CO-CURRENT-TOTALS.
  1681         16  CO-CURRENT-LAST-STMT-DT.
  1682             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1683             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1684             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1685
  1686         16  CO-CURRENT-MONTHLY-TOTALS.
  1687             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1688             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1689             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1690             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1691             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1692
  1693         16  CO-CURRENT-AGING-TOTALS.
  1694             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1695             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1696             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1697             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1698
  1699         16  CO-CURRENT-YTD-TOTALS.
  1700             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1701             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1702
  1703     12  CO-PAID-COMM-TOTALS.
  1704         16  CO-YTD-PAID-COMMS.
  1705             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1706             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1707
  1708     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1709         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1710         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1711
  1712     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1713         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1714         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1715         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  33
* EL050.cbl
  1716         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1717         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1718         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1719         88  CO-FINAL-LETTER                  VALUE 'F'.
  1720         88  CO-RECONCILING                   VALUE 'R'.
  1721         88  CO-PHONE-CALL                    VALUE 'P'.
  1722         88  CO-LEGAL                         VALUE 'L'.
  1723         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1724         88  CO-WRITE-OFF                     VALUE 'W'.
  1725         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1726
  1727     12  CO-CSR-CODE                       PIC X(4).
  1728
  1729     12  CO-GA-STATUS-INFO.
  1730         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1731         16  CO-GA-TERMINATION-DT          PIC XX.
  1732         16  CO-GA-STATUS-CODE             PIC X.
  1733             88  CO-GA-ACTIVE                 VALUE 'A'.
  1734             88  CO-GA-INACTIVE               VALUE 'I'.
  1735             88  CO-GA-PENDING                VALUE 'P'.
  1736         16  CO-GA-COMMENTS.
  1737             20  CO-GA-COMMENT-1           PIC X(40).
  1738             20  CO-GA-COMMENT-2           PIC X(40).
  1739             20  CO-GA-COMMENT-3           PIC X(40).
  1740             20  CO-GA-COMMENT-4           PIC X(40).
  1741
  1742     12  CO-RPTCD2                         PIC X(10).
  1743     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1744         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1745         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1746
  1747     12  CO-TYPE-AGENT                     PIC X(01).
  1748         88  CO-CORPORATION                   VALUE 'C'.
  1749         88  CO-PARTNERSHIP                   VALUE 'P'.
  1750         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1751         88  CO-TRUST                         VALUE 'T'.
  1752         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1753
  1754     12  CO-FAXNO.
  1755         16  CO-FAX-AREA-CODE                  PIC XXX.
  1756         16  CO-FAX-PREFIX                     PIC XXX.
  1757         16  CO-FAX-PHONE                      PIC X(4).
  1758
  1759     12  CO-BANK-INFORMATION.
  1760         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1761         16  CO-BANK-TRANSIT-NON REDEFINES
  1762             CO-BANK-TRANSIT-NO                PIC 9(8).
  1763
  1764         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1765     12  CO-MISC-DEDUCT-INFO REDEFINES
  1766                  CO-BANK-INFORMATION.
  1767         16  CO-MD-GL-ACCT                     PIC X(10).
  1768         16  CO-MD-DIV                         PIC XX.
  1769         16  CO-MD-CENTER                      PIC X(4).
  1770         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1771         16  CO-CREATE-AP-CHECK                PIC X.
  1772         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1773         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  34
* EL050.cbl
  1774     12  CO-ACH-STATUS                         PIC X.
  1775         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1776         88  CO-ACH-PENDING                        VALUE 'P'.
  1777
  1778     12  CO-BILL-SW                            PIC X.
  1779     12  CO-CONTROL-NAME                       PIC X(30).
  1780     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1781     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1782     12  CO-CLP-STATE                          PIC XX.
  1783     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1784     12  CO-SPP-REFUND-EDIT                    PIC X.
  1785
  1786******************************************************************
  1787
  1788*    COPY ERCAGTC.
  1789******************************************************************
  1790*                                                                *
  1791*                                                                *
  1792*                            ERCAGTC                             *
  1793*                            VMOD=2.001                          *
  1794*                                                                *
  1795*   ONLINE CREDIT SYSTEM                                         *
  1796*                                                                *
  1797*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1798*                                                                *
  1799*   FILE TYPE = VSAM,KSDS                                        *
  1800*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1801*                                                                *
  1802*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1803*       ALTERNATE PATH = NONE                                    *
  1804*                                                                *
  1805*   LOG = NO                                                     *
  1806*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1807*                                                                *
  1808******************************************************************
  1809*                   C H A N G E   L O G
  1810*
  1811* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1812*-----------------------------------------------------------------
  1813*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1814* EFFECTIVE    NUMBER
  1815*-----------------------------------------------------------------
  1816* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1817* 111004                         NEW FILE AND COPYBOOK
  1818* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1819******************************************************************
  1820 01  AGENT-COMMISSIONS.
  1821     12  AG-RECORD-ID                          PIC XX.
  1822         88  VALID-CO-ID                          VALUE 'AG'.
  1823     12  AG-CONTROL-PRIMARY.
  1824         16  AG-COMPANY-CD                     PIC X.
  1825         16  AG-CONTROL.
  1826             20  AG-CTL-1.
  1827                 24  AG-CARR-GROUP.
  1828                     28  AG-CARRIER            PIC X.
  1829                     28  AG-GROUPING           PIC X(6).
  1830                 24  AG-BANK                   PIC X(10).
  1831             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  35
* EL050.cbl
  1832                 24  AG-EXP-DT                 PIC XX.
  1833         16  AG-TYPE                           PIC X.
  1834             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1835             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1836     12  AG-MAINT-INFORMATION.
  1837         16  AG-LAST-MAINT-DT                  PIC XX.
  1838         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1839         16  AG-LAST-MAINT-USER                PIC X(4).
  1840         16  FILLER                            PIC X(10).
  1841     12  AG-EFF-DT                             PIC XX.
  1842     12  AG-COMM-STRUCTURE.
  1843         16  AG-AGT-COMMS OCCURS 10.
  1844             20  AG-AGT                PIC X(10).
  1845             20  AG-COM-TYP            PIC X.
  1846             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1847             20  AG-RECALC-LV-INDIC    PIC X.
  1848             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1849             20  AG-LRCALC-LV-INDIC    PIC X.
  1850             20  FILLER                PIC X(05).
  1851     12  FILLER                  PIC X(145).
  1852******************************************************************
  1853*    COPY ERCRESS.
  1854******************************************************************
  1855*                                                                *
  1856*                            ERCRESS                             *
  1857*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1858*                            VMOD=2.002                          *
  1859*                                                                *
  1860*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1861*                                                                *
  1862*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1863*   VSAM RESIDENT STATE TAX MASTER                              *
  1864*                                                                *
  1865*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1866*                                                                *
  1867*   FILE TYPE = VSAM,KSDS                                        *
  1868*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1869*                                                                *
  1870*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1871*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1872*                                                                *
  1873*   LOG = NO                                                     *
  1874*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1875*                                                                *
  1876*                                                                *
  1877******************************************************************
  1878
  1879 01  RESIDENT-STATE-TAX-MASTER.
  1880
  1881     10  ERRESS-PRIMARY-KEY.
  1882         15  RES-COMPANY-CD        PIC X.
  1883         15  RES-RESIDENT-STATE    PIC XX.
  1884         15  RES-COVERAGE-CATEGORY PIC X.
  1885         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1886*                                      YYYYMMDD
  1887*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1888
  1889     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  36
* EL050.cbl
  1890
  1891         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1892         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1893         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1894         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1895
  1896     10 RES-RECALC-SW              PIC   X.
  1897         88 RECALC                VALUE 'Y'.
  1898         88 NO-RECALC             VALUE 'N'.
  1899     10  RES-MAINT-BY              PIC X(4).
  1900     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1901     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1902*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  37
* EL050.cbl
  1904*    COPY ERCRESC.
  1905******************************************************************
  1906*                                                                *
  1907*                            ERCRESC                             *
  1908*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1909*                            VMOD=2.003                          *
  1910*                                                                *
  1911*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1912*                                                                *
  1913*   FILE TYPE = VSAM,KSDS                                        *
  1914*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1915*                                                                *
  1916*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1917*       ALTERNATE PATH1 = NONE                                   *
  1918*                                                                *
  1919*   LOG = NO                                                     *
  1920*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1921*                                                                *
  1922******************************************************************
  1923
  1924 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1925
  1926     10  ERRESC-RECORD-KEY.
  1927         15  RESC-COMPANY-CD           PIC   X.
  1928         15  RESC-CARRIER              PIC   X.
  1929         15  RESC-GROUP                PIC   X(6).
  1930         15  RESC-STATE                PIC   XX.
  1931         15  RESC-ACCOUNT              PIC   X(10).
  1932         15  RESC-AGENT                PIC   X(10).
  1933         15  RESC-RESIDENT-STATE       PIC   XX.
  1934         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1935*                                           YYYYMMDD
  1936     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1937
  1938     10  RESC-COMM-RECORD-DATA.
  1939         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1940             20 RESC-COVERAGE-CAT      PIC    X.
  1941             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1942             20 RESC-COMMISSION-TAB REDEFINES
  1943                RESC-COMMISSION-PER    PIC  XXX.
  1944
  1945     10  RESC-MAINT-BY                 PIC X(4).
  1946     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1947     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1948*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  38
* EL050.cbl
  1950*    COPY ERCPLAN.
  1951******************************************************************
  1952*                                                                *
  1953*                                                                *
  1954*                            ERCPLAN                             *
  1955*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1956*                            VMOD=2.003                          *
  1957*                                                                *
  1958*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1959*                                                                *
  1960*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1961*   PLAN MASTER                                                  *
  1962*                                                                *
  1963*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1964*                                                                *
  1965*   FILE TYPE = VSAM,KSDS                                        *
  1966*   RECORD SIZE = 420   RECFORM = FIX                            *
  1967*                                                                *
  1968*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1969*       ALTERNATE PATH1 = N/A                                    *
  1970*                                                                *
  1971*   LOG = NO                                                     *
  1972*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1973*                                                                *
  1974*                                                                *
  1975******************************************************************
  1976
  1977 01  PLAN-MASTER.
  1978     12  PL-RECORD-ID                      PIC XX.
  1979         88  VALID-PL-ID                      VALUE 'PL'.
  1980
  1981     12  PL-CONTROL-PRIMARY.
  1982         16  PL-COMPANY-CD                 PIC X.
  1983         16  PL-MSTR-CNTRL.
  1984             20  PL-CONTROL-A.
  1985                 24  PL-CARRIER            PIC X.
  1986                 24  PL-GROUPING           PIC X(6).
  1987                 24  PL-STATE              PIC XX.
  1988                 24  PL-ACCOUNT            PIC X(10).
  1989             20  PL-BENEFIT-TYPE           PIC X.
  1990             20  PL-BENEFIT-CODE           PIC XX.
  1991             20  PL-REVISION-NO            PIC X(3).
  1992
  1993     12  PL-CONTROL-BY-VAR-GRP.
  1994         16  PL-COMPANY-CD-A1              PIC X.
  1995         16  PL-VG-CARRIER                 PIC X.
  1996         16  PL-VG-GROUPING                PIC X(6).
  1997         16  PL-VG-STATE                   PIC XX.
  1998         16  PL-VG-ACCOUNT                 PIC X(10).
  1999         16  PL-BENEFIT-TYPE-A1            PIC X.
  2000         16  PL-BENEFIT-CODE-A1            PIC XX.
  2001         16  PL-REVISION-NO-A1             PIC 999.
  2002
  2003     12  PL-MAINT-INFORMATION.
  2004         16  PL-LAST-MAINT-DT              PIC XX.
  2005         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2006         16  PL-LAST-MAINT-USER            PIC X(4).
  2007         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  39
* EL050.cbl
  2008
  2009     12  PL-LIABILITY-LIMITS.
  2010         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2011         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2012             20  PL-LM-AGE                 PIC S99        COMP-3.
  2013             20  PL-LM-DUR                 PIC S999       COMP-3.
  2014             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2015             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2016
  2017     12  FILLER                            PIC X(30).
  2018
  2019     12  PL-GL-ACCOUNT-NOS.
  2020         16  PL-PREMIUM-GL                 PIC X(8).
  2021         16  PL-COMM-GL                    PIC X(8).
  2022         16  PL-CLAIM-GL                   PIC X(8).
  2023     12  FILLER                            PIC X(24).
  2024     12  PL-TOLERANCES.
  2025         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2026         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2027         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2028         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2029         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2030         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2031     12  PL-OVER-SHORT.
  2032         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2033         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2034     12  FILLER                            PIC X(24).
  2035     12  PLAN-MISC.
  2036         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2037         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2038         16  PL-IG                         PIC X.
  2039         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2040         16  PL-POLICY-FORM                PIC X(12).
  2041         16  PL-EDIT-FOR-FORM              PIC X(01).
  2042         16  PL-DEV-CODE                   PIC XXX.
  2043         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2044         16  PL-CALC-METHOD                PIC X.
  2045         16  PL-BENEFIT-GROUP              PIC X(05).
  2046         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2047
  2048         16  FILLER                        PIC X(99).
  2049******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  40
* EL050.cbl
  2051*    COPY ELCCERT.
  2052******************************************************************
  2053*                                                                *
  2054*                            ELCCERT.                            *
  2055*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2056*                            VMOD=2.013                          *
  2057*                                                                *
  2058*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2059*                                                                *
  2060*   FILE TYPE = VSAM,KSDS                                        *
  2061*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2062*                                                                *
  2063*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2064*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2065*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2066*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2067*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2068*                                                                *
  2069*   LOG = YES                                                    *
  2070*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2071******************************************************************
  2072*                   C H A N G E   L O G
  2073*
  2074* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2075*-----------------------------------------------------------------
  2076*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2077* EFFECTIVE    NUMBER
  2078*-----------------------------------------------------------------
  2079* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2080* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2081* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2082* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2083* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2084* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2085* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2086* 032612  CR2011110200001  PEMA  AHL CHANGES
  2087******************************************************************
  2088
  2089 01  CERTIFICATE-MASTER.
  2090     12  CM-RECORD-ID                      PIC XX.
  2091         88  VALID-CM-ID                      VALUE 'CM'.
  2092
  2093     12  CM-CONTROL-PRIMARY.
  2094         16  CM-COMPANY-CD                 PIC X.
  2095         16  CM-CARRIER                    PIC X.
  2096         16  CM-GROUPING.
  2097             20  CM-GROUPING-PREFIX        PIC X(3).
  2098             20  CM-GROUPING-PRIME         PIC X(3).
  2099         16  CM-STATE                      PIC XX.
  2100         16  CM-ACCOUNT.
  2101             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2102             20  CM-ACCOUNT-PRIME          PIC X(6).
  2103         16  CM-CERT-EFF-DT                PIC XX.
  2104         16  CM-CERT-NO.
  2105             20  CM-CERT-PRIME             PIC X(10).
  2106             20  CM-CERT-SFX               PIC X.
  2107
  2108     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  41
* EL050.cbl
  2109         16  CM-COMPANY-CD-A1              PIC X.
  2110         16  CM-INSURED-LAST-NAME          PIC X(15).
  2111         16  CM-INSURED-INITIALS.
  2112             20  CM-INSURED-INITIAL1       PIC X.
  2113             20  CM-INSURED-INITIAL2       PIC X.
  2114
  2115     12  CM-CONTROL-BY-SSN.
  2116         16  CM-COMPANY-CD-A2              PIC X.
  2117         16  CM-SOC-SEC-NO.
  2118             20  CM-SSN-STATE              PIC XX.
  2119             20  CM-SSN-ACCOUNT            PIC X(6).
  2120             20  CM-SSN-LN3.
  2121                 25  CM-INSURED-INITIALS-A2.
  2122                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2123                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2124                 25 CM-PART-LAST-NAME-A2         PIC X.
  2125
  2126     12  CM-CONTROL-BY-CERT-NO.
  2127         16  CM-COMPANY-CD-A4              PIC X.
  2128         16  CM-CERT-NO-A4                 PIC X(11).
  2129
  2130     12  CM-CONTROL-BY-MEMB.
  2131         16  CM-COMPANY-CD-A5              PIC X.
  2132         16  CM-MEMBER-NO.
  2133             20  CM-MEMB-STATE             PIC XX.
  2134             20  CM-MEMB-ACCOUNT           PIC X(6).
  2135             20  CM-MEMB-LN4.
  2136                 25  CM-INSURED-INITIALS-A5.
  2137                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2138                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2139                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2140
  2141     12  CM-INSURED-PROFILE-DATA.
  2142         16  CM-INSURED-FIRST-NAME.
  2143             20  CM-INSURED-1ST-INIT       PIC X.
  2144             20  FILLER                    PIC X(9).
  2145         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2146         16  CM-INSURED-SEX                PIC X.
  2147             88  CM-SEX-MALE                  VALUE 'M'.
  2148             88  CM-SEX-FEMAL                 VALUE 'F'.
  2149         16  CM-INSURED-JOINT-AGE          PIC 99.
  2150         16  CM-JOINT-INSURED-NAME.
  2151             20  CM-JT-LAST-NAME           PIC X(15).
  2152             20  CM-JT-FIRST-NAME.
  2153                 24  CM-JT-1ST-INIT        PIC X.
  2154                 24  FILLER                PIC X(9).
  2155             20  CM-JT-INITIAL             PIC X.
  2156
  2157     12  CM-LIFE-DATA.
  2158         16  CM-LF-BENEFIT-CD              PIC XX.
  2159         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2160         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2161         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2162         16  CM-LF-DEV-CODE                PIC XXX.
  2163         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2164         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2165         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2166         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  42
* EL050.cbl
  2167         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2168         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2169         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2170         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2171         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2172         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2173         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2174         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2175         16  FILLER                        PIC XX.
  2176
  2177     12  CM-AH-DATA.
  2178         16  CM-AH-BENEFIT-CD              PIC XX.
  2179         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2180         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2181         16  CM-AH-DEV-CODE                PIC XXX.
  2182         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2183         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2184         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2185         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2186         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2187         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2188         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2189         16  CM-AH-PAID-THRU-DT            PIC XX.
  2190             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2191         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2192         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2193         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2194         16  FILLER                        PIC X.
  2195
  2196     12  CM-LOAN-INFORMATION.
  2197         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2198         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2199                                           PIC S9(5)V99  COMP-3.
  2200         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2201         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2202         16  CM-PAY-FREQUENCY              PIC S99.
  2203         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2204         16  CM-RATE-CLASS                 PIC XX.
  2205         16  CM-BENEFICIARY                PIC X(25).
  2206         16  CM-POLICY-FORM-NO             PIC X(12).
  2207         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2208         16  CM-LAST-ADD-ON-DT             PIC XX.
  2209         16  CM-DEDUCTIBLE-AMOUNTS.
  2210             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2211             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2212         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2213             20  CM-RESIDENT-STATE         PIC XX.
  2214             20  CM-RATE-CODE              PIC X(4).
  2215             20  FILLER                    PIC XX.
  2216         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2217             20  CM-LOAN-OFFICER           PIC X(5).
  2218             20  FILLER                    PIC XXX.
  2219         16  CM-CSR-CODE                   PIC XXX.
  2220         16  CM-UNDERWRITING-CODE          PIC X.
  2221             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2222         16  CM-POST-CARD-IND              PIC X.
  2223         16  CM-NH-INTERFACE-SW            PIC X.
  2224         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  43
* EL050.cbl
  2225             88  CM-SING-PRM                  VALUE '1'.
  2226             88  CM-O-B-COVERAGE              VALUE '2'.
  2227             88  CM-OPEN-END                  VALUE '3'.
  2228         16  CM-IND-GRP-TYPE               PIC X.
  2229             88  CM-INDIVIDUAL                VALUE 'I'.
  2230             88  CM-GROUP                     VALUE 'G'.
  2231         16  CM-SKIP-CODE                  PIC X.
  2232             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2233             88  SKIP-JULY                    VALUE '1'.
  2234             88  SKIP-AUGUST                  VALUE '2'.
  2235             88  SKIP-SEPTEMBER               VALUE '3'.
  2236             88  SKIP-JULY-AUG                VALUE '4'.
  2237             88  SKIP-AUG-SEPT                VALUE '5'.
  2238             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2239             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2240             88  SKIP-JUNE                    VALUE '8'.
  2241             88  SKIP-JUNE-JULY               VALUE '9'.
  2242             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2243             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2244         16  CM-PAYMENT-MODE               PIC X.
  2245             88  PAY-MONTHLY                  VALUE SPACE.
  2246             88  PAY-WEEKLY                   VALUE '1'.
  2247             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2248             88  PAY-BI-WEEKLY                VALUE '3'.
  2249             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2250         16  CM-LOAN-NUMBER                PIC X(8).
  2251         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2252         16  CM-OLD-LOF                    PIC XXX.
  2253*        16  CM-LOAN-OFFICER               PIC XXX.
  2254         16  CM-REIN-TABLE                 PIC XXX.
  2255         16  CM-SPECIAL-REIN-CODE          PIC X.
  2256         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2257         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2258         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2259
  2260     12  CM-STATUS-DATA.
  2261         16  CM-ENTRY-STATUS               PIC X.
  2262         16  CM-ENTRY-DT                   PIC XX.
  2263
  2264         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2265         16  CM-LF-CANCEL-DT               PIC XX.
  2266         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2267
  2268         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2269         16  CM-LF-DEATH-DT                PIC XX.
  2270         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2271
  2272         16  CM-LF-CURRENT-STATUS          PIC X.
  2273             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2274                                                'M' '4' '5' '9'.
  2275             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2276             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2277             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2278             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2279             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2280             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2281             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2282             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  44
* EL050.cbl
  2283             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2284             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2285             88  CM-LF-DECLINED               VALUE 'D'.
  2286             88  CM-LF-VOIDED                 VALUE 'V'.
  2287
  2288         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2289         16  CM-AH-CANCEL-DT               PIC XX.
  2290         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2291
  2292         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2293         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2294         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2295
  2296         16  CM-AH-CURRENT-STATUS          PIC X.
  2297             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2298                                                'M' '4' '5' '9'.
  2299             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2300             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2301             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2302             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2303             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2304             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2305             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2306             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2307             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2308             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2309             88  CM-AH-DECLINED               VALUE 'D'.
  2310             88  CM-AH-VOIDED                 VALUE 'V'.
  2311
  2312         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2313             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2314             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2315             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2316         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2317
  2318         16  CM-ENTRY-BATCH                PIC X(6).
  2319         16  CM-LF-EXIT-BATCH              PIC X(6).
  2320         16  CM-AH-EXIT-BATCH              PIC X(6).
  2321         16  CM-LAST-MONTH-END             PIC XX.
  2322
  2323     12  CM-NOTE-SW                        PIC X.
  2324         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2325         88  CERT-NOTES-PRESENT               VALUE '1'.
  2326         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2327         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2328         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2329         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2330         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2331         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2332     12  CM-COMP-EXCP-SW                   PIC X.
  2333         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2334         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2335     12  CM-INSURED-ADDRESS-SW             PIC X.
  2336         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2337         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2338
  2339*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2340     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  45
* EL050.cbl
  2341     12  FILLER                            PIC X.
  2342
  2343*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2344     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2345     12  FILLER                            PIC X.
  2346*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2347     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2348
  2349     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2350         88  CERT-ADDED-BATCH                 VALUE ' '.
  2351         88  CERT-ADDED-ONLINE                VALUE '1'.
  2352         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2353         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2354         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2355     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2356         88  CERT-AS-LOADED                   VALUE ' '.
  2357         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2358         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2359         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2360         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2361         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2362         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2363         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2364
  2365     12  CM-ACCOUNT-COMM-PCTS.
  2366         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2367         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2368
  2369     12  CM-USER-FIELD                     PIC X.
  2370     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2371     12  CM-CLP-STATE                      PIC XX.
  2372     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2373     12  CM-USER-RESERVED                  PIC XXX.
  2374     12  FILLER REDEFINES CM-USER-RESERVED.
  2375         16  CM-AH-CLASS-CD                PIC XX.
  2376         16  F                             PIC X.
  2377******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  46
* EL050.cbl
  2379*    COPY ERCMAIL.
  2380******************************************************************
  2381*                                                                *
  2382*                                                                *
  2383*                            ERCMAIL                             *
  2384*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2385*                            VMOD=2.003                          *
  2386*                                                                *
  2387*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2388*                                                                *
  2389*   FILE TYPE = VSAM,KSDS                                        *
  2390*   RECORD SIZE = 374   RECFORM = FIX                            *
  2391*                                                                *
  2392*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2393*   ALTERNATE PATH    = NOT USED                                 *
  2394*                                                                *
  2395*   LOG = YES                                                    *
  2396*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2397******************************************************************
  2398*                   C H A N G E   L O G
  2399*
  2400* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2401*-----------------------------------------------------------------
  2402*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2403* EFFECTIVE    NUMBER
  2404*-----------------------------------------------------------------
  2405* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2406* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2407* 111108                   PEMA  ADD CRED BENE ADDR2
  2408******************************************************************
  2409
  2410 01  MAILING-DATA.
  2411     12  MA-RECORD-ID                      PIC XX.
  2412         88  VALID-MA-ID                       VALUE 'MA'.
  2413
  2414     12  MA-CONTROL-PRIMARY.
  2415         16  MA-COMPANY-CD                 PIC X.
  2416         16  MA-CARRIER                    PIC X.
  2417         16  MA-GROUPING.
  2418             20  MA-GROUPING-PREFIX        PIC XXX.
  2419             20  MA-GROUPING-PRIME         PIC XXX.
  2420         16  MA-STATE                      PIC XX.
  2421         16  MA-ACCOUNT.
  2422             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2423             20  MA-ACCOUNT-PRIME          PIC X(6).
  2424         16  MA-CERT-EFF-DT                PIC XX.
  2425         16  MA-CERT-NO.
  2426             20  MA-CERT-PRIME             PIC X(10).
  2427             20  MA-CERT-SFX               PIC X.
  2428
  2429     12  FILLER                            PIC XX.
  2430
  2431     12  MA-ACCESS-CONTROL.
  2432         16  MA-SOURCE-SYSTEM              PIC XX.
  2433             88  MA-FROM-CREDIT                VALUE 'CR'.
  2434             88  MA-FROM-VSI                   VALUE 'VS'.
  2435             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2436             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  47
* EL050.cbl
  2437         16  MA-RECORD-ADD-DT              PIC XX.
  2438         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2439         16  MA-LAST-MAINT-DT              PIC XX.
  2440         16  MA-LAST-MAINT-BY              PIC XXXX.
  2441         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2442
  2443     12  MA-PROFILE-INFO.
  2444         16  MA-QUALIFY-CODE-1             PIC XX.
  2445         16  MA-QUALIFY-CODE-2             PIC XX.
  2446         16  MA-QUALIFY-CODE-3             PIC XX.
  2447         16  MA-QUALIFY-CODE-4             PIC XX.
  2448         16  MA-QUALIFY-CODE-5             PIC XX.
  2449
  2450         16  MA-INSURED-LAST-NAME          PIC X(15).
  2451         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2452         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2453         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2454         16  MA-INSURED-BIRTH-DT           PIC XX.
  2455         16  MA-INSURED-SEX                PIC X.
  2456             88  MA-SEX-MALE                   VALUE 'M'.
  2457             88  MA-SEX-FEMALE                 VALUE 'F'.
  2458         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2459
  2460         16  MA-ADDRESS-CORRECTED          PIC X.
  2461         16  MA-JOINT-BIRTH-DT             PIC XX.
  2462*        16  FILLER                        PIC X(12).
  2463
  2464         16  MA-ADDRESS-LINE-1             PIC X(30).
  2465         16  MA-ADDRESS-LINE-2             PIC X(30).
  2466         16  MA-CITY-STATE.
  2467             20  MA-CITY                   PIC X(28).
  2468             20  MA-ADDR-STATE             PIC XX.
  2469         16  MA-ZIP.
  2470             20  MA-ZIP-CODE.
  2471                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2472                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2473                 24  FILLER                PIC X(4).
  2474             20  MA-ZIP-PLUS4              PIC X(4).
  2475         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2476             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2477             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2478             20  FILLER                    PIC X(3).
  2479
  2480         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2481
  2482         16  FILLER                        PIC XXX.
  2483*        16  FILLER                        PIC X(10).
  2484
  2485     12  MA-CRED-BENE-INFO.
  2486         16  MA-CRED-BENE-NAME                 PIC X(25).
  2487         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2488         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2489         16  MA-CRED-BENE-CTYST.
  2490             20  MA-CRED-BENE-CITY             PIC X(28).
  2491             20  MA-CRED-BENE-STATE            PIC XX.
  2492         16  MA-CRED-BENE-ZIP.
  2493             20  MA-CB-ZIP-CODE.
  2494                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  48
* EL050.cbl
  2495                     88  MA-CB-CANADIAN-POST-CODE
  2496                                           VALUE 'A' THRU 'Z'.
  2497                 24  FILLER                    PIC X(4).
  2498             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2499         16  MA-CB-CANADIAN-POSTAL-CODE
  2500                            REDEFINES MA-CRED-BENE-ZIP.
  2501             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2502             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2503             20  FILLER                        PIC X(3).
  2504     12  MA-POST-CARD-MAIL-DATA.
  2505         16  MA-MAIL-DATA OCCURS 7.
  2506             20  MA-MAIL-TYPE              PIC X.
  2507                 88  MA-12MO-MAILING           VALUE '1'.
  2508                 88  MA-EXP-MAILING            VALUE '2'.
  2509             20  MA-MAIL-STATUS            PIC X.
  2510                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2511                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2512                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2513             20  MA-MAIL-DATE              PIC XX.
  2514     12  FILLER                            PIC XX.
  2515     12  FILLER                            PIC XX.
  2516*    12  FILLER                            PIC X(30).
  2517******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  49
* EL050.cbl
  2519*    COPY ERCPNDM.
  2520******************************************************************
  2521*                                                                *
  2522*                                                                *
  2523*                            ERCPNDM                             *
  2524*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2525*                            VMOD=2.003                          *
  2526*                                                                *
  2527*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2528*                                                                *
  2529*   FILE TYPE = VSAM,KSDS                                        *
  2530*   RECORD SIZE = 374   RECFORM = FIX                            *
  2531*                                                                *
  2532*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2533*   ALTERNATE PATH    = NOT USED                                 *
  2534*                                                                *
  2535*   LOG = YES                                                    *
  2536*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2537******************************************************************
  2538*                   C H A N G E   L O G
  2539*
  2540* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2541*-----------------------------------------------------------------
  2542*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2543* EFFECTIVE    NUMBER
  2544*-----------------------------------------------------------------
  2545* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2546* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2547* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2548******************************************************************
  2549
  2550 01  PENDING-MAILING-DATA.
  2551     12  PM-RECORD-ID                      PIC XX.
  2552         88  VALID-MA-ID                       VALUE 'PM'.
  2553
  2554     12  PM-CONTROL-PRIMARY.
  2555         16  PM-COMPANY-CD                 PIC X.
  2556         16  PM-ENTRY-BATCH                PIC X(6).
  2557         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2558         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2559
  2560     12  FILLER                            PIC X(14).
  2561
  2562     12  PM-ACCESS-CONTROL.
  2563         16  PM-SOURCE-SYSTEM              PIC XX.
  2564             88  PM-FROM-CREDIT                VALUE 'CR'.
  2565             88  PM-FROM-VSI                   VALUE 'VS'.
  2566             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2567             88  PM-FROM-OTHER                 VALUE 'OT'.
  2568         16  PM-RECORD-ADD-DT              PIC XX.
  2569         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2570         16  PM-LAST-MAINT-DT              PIC XX.
  2571         16  PM-LAST-MAINT-BY              PIC XXXX.
  2572         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2573
  2574     12  PM-PROFILE-INFO.
  2575         16  PM-QUALIFY-CODE-1             PIC XX.
  2576         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  50
* EL050.cbl
  2577         16  PM-QUALIFY-CODE-3             PIC XX.
  2578         16  PM-QUALIFY-CODE-4             PIC XX.
  2579         16  PM-QUALIFY-CODE-5             PIC XX.
  2580
  2581         16  PM-INSURED-LAST-NAME          PIC X(15).
  2582         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2583         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2584         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2585         16  PM-INSURED-BIRTH-DT           PIC XX.
  2586         16  PM-INSURED-SEX                PIC X.
  2587             88  PM-SEX-MALE                   VALUE 'M'.
  2588             88  PM-SEX-FEMALE                 VALUE 'F'.
  2589         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2590
  2591         16  PM-ADDRESS-CORRECTED          PIC X.
  2592         16  PM-JOINT-BIRTH-DT             PIC XX.
  2593*        16  FILLER                        PIC X(12).
  2594
  2595         16  PM-ADDRESS-LINE-1             PIC X(30).
  2596         16  PM-ADDRESS-LINE-2             PIC X(30).
  2597         16  PM-CITY-STATE.
  2598             20  PM-CITY                   PIC X(28).
  2599             20  PM-STATE                  PIC XX.
  2600         16  PM-ZIP.
  2601             20  PM-ZIP-CODE.
  2602                 24  PM-ZIP-1              PIC X.
  2603                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2604                 24  FILLER                PIC X(4).
  2605             20  PM-ZIP-PLUS4              PIC X(4).
  2606         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2607             20  PM-CAN-POST1              PIC XXX.
  2608             20  PM-CAN-POST2              PIC XXX.
  2609             20  FILLER                    PIC XXX.
  2610
  2611         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2612
  2613         16  FILLER                        PIC X(03).
  2614
  2615     12  PM-CRED-BENE-INFO.
  2616         16  PM-CRED-BENE-NAME             PIC X(25).
  2617         16  PM-CRED-BENE-ADDR             PIC X(30).
  2618         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2619         16  PM-CRED-BENE-CTYST.
  2620             20  PM-CRED-BENE-CITY         PIC X(28).
  2621             20  PM-CRED-BENE-STATE        PIC XX.
  2622         16  PM-CRED-BENE-ZIP.
  2623             20  PM-CB-ZIP-CODE.
  2624                 24  PM-CB-ZIP-1           PIC X.
  2625                     88  PM-CB-CANADIAN-POST-CODE
  2626                                  VALUE 'A' THRU 'Z'.
  2627                 24  FILLER                PIC X(4).
  2628             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2629         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2630             20  PM-CB-CAN-POST1           PIC XXX.
  2631             20  PM-CB-CAN-POST2           PIC XXX.
  2632             20  FILLER                    PIC XXX.
  2633     12  PM-POST-CARD-MAIL-DATA.
  2634         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  51
* EL050.cbl
  2635             20  PM-MAIL-TYPE              PIC X.
  2636                 88  PM-12MO-MAILING           VALUE '1'.
  2637                 88  PM-EXP-MAILING            VALUE '2'.
  2638             20  PM-MAIL-STATUS            PIC X.
  2639                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2640                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2641                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2642             20  PM-MAIL-DATE              PIC XX.
  2643     12  FILLER                            PIC XX.
  2644     12  FILLER                            PIC X(12).
  2645*    12  FILLER                            PIC X(30).
  2646
  2647******************************************************************
  2648*                                COPY ERCLOFC.
  2649******************************************************************
  2650*                                                                *
  2651*                                                                *
  2652*                            ERCLOFC                             *
  2653*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2654*                            VMOD=2.003                          *
  2655*                                                                *
  2656*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2657*                                                                *
  2658*   FILE TYPE = VSAM,KSDS                                        *
  2659*   RECORD SIZE = 670   RECFORM = FIX                            *
  2660*                                                                *
  2661*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2662*                                                                *
  2663*   LOG = YES                                                    *
  2664*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2665*                                                                *
  2666******************************************************************
  2667
  2668 01  LOAN-OFFICER-MASTER.
  2669     12  LO-RECORD-ID                PIC XX.
  2670         88  VALID-LO-ID                VALUE 'LO'.
  2671
  2672     12  LO-CONTROL-PRIMARY.
  2673         16  LO-COMPANY-CD           PIC X.
  2674         16  LO-CARRIER              PIC X.
  2675         16  LO-GROUPING.
  2676             20  LO-GROUPING-PREFIX  PIC XXX.
  2677             20  LO-GROUPING-PRIME   PIC XXX.
  2678         16  LO-STATE                PIC XX.
  2679         16  LO-ACCOUNT.
  2680             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2681             20  LO-ACCOUNT-PRIME    PIC X(6).
  2682         16  LO-OFFICER-CODE         PIC X(5).
  2683
  2684     12  LO-OFFICER-NAME             PIC X(30).
  2685
  2686     12  LO-LAST-MAINT-DT            PIC XX.
  2687     12  LO-LAST-USER                PIC X(4).
  2688     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2689
  2690     12  LO-COMP-CONTROL             PIC X.
  2691             88  LO-SHOW-COMP           VALUE 'Y'.
  2692             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  52
* EL050.cbl
  2693     12  LO-DETAIL-CONTROL           PIC X.
  2694             88  LO-PRINT-DETAIL        VALUE 'D'.
  2695             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2696
  2697     12  LO-SV-CARRIER               PIC X.
  2698     12  LO-SV-GROUPING              PIC X(6).
  2699     12  LO-SV-STATE                 PIC XX.
  2700
  2701     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2702     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2703
  2704     12  LO-OFFICER-INFO.
  2705         16  FILLER OCCURS 12 TIMES.
  2706             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2707             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2708             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2709             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2710             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2711             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2712             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2713             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2714     12  FILLER                      PIC X(198).
  2715******************************************************************
  2716*                                COPY ERCPDEF.
  2717******************************************************************
  2718*                                                                *
  2719*                                                                *
  2720*                            ERCPDEF.                            *
  2721*                                                                *
  2722*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2723*                                                                *
  2724*    FILE TYPE = VSAM,KSDS                                       *
  2725*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2726*                                                                *
  2727*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2728*                                                                *
  2729*    LOG = YES                                                   *
  2730*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2731******************************************************************
  2732 01  PRODUCT-MASTER.
  2733    12  PD-RECORD-ID                 PIC X(02).
  2734        88  VALID-PD-ID                  VALUE 'PD'.
  2735    12  PD-CONTROL-PRIMARY.
  2736        16  PD-COMPANY-CD            PIC X.
  2737        16  PD-STATE                 PIC XX.
  2738        16  PD-PRODUCT-CD            PIC XXX.
  2739        16  PD-FILLER                PIC X(7).
  2740        16  PD-BEN-TYPE              PIC X.
  2741        16  PD-BEN-CODE              PIC XX.
  2742        16  PD-PROD-EXP-DT           PIC XX.
  2743    12  FILLER                       PIC X(50).
  2744    12  PD-PRODUCT-DATA OCCURS 8.
  2745        16  PD-PROD-CODE             PIC X.
  2746            88  PD-PROD-LIFE           VALUE 'L'.
  2747            88  PD-PROD-PROP           VALUE 'P'.
  2748            88  PD-PROD-AH             VALUE 'A'.
  2749            88  PD-PROD-IU             VALUE 'I'.
  2750            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  53
* EL050.cbl
  2751        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2752        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2753        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2754        16  PD-MAX-TERM              PIC S999        COMP-3.
  2755        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2756        16  FILLER                   PIC X.
  2757        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2758        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2759        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2760        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2761        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2762        16  PD-REC-CRIT-PERIOD       PIC X.
  2763        16  PD-RTW-MOS               PIC 99.
  2764        16  FILLER                   PIC X(5).
  2765    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2766    12  PD-TERM-LIMITS OCCURS 15.
  2767        16  PD-LOW-TERM              PIC S999        COMP-3.
  2768        16  PD-HI-TERM               PIC S999        COMP-3.
  2769*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2770    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2771        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2772        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2773    12  PD-EARN-FACTORS.
  2774        16  FILLER OCCURS 15.
  2775            20  FILLER OCCURS 15.
  2776                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2777    12  PD-PRODUCT-DESC              PIC X(80).
  2778    12  PD-TRUNCATED                 PIC X.
  2779    12  FILLER                       PIC X(59).
  2780    12  PD-MAINT-INFORMATION.
  2781        16  PD-LAST-MAINT-DT         PIC X(02).
  2782        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2783        16  PD-LAST-MAINT-BY         PIC X(04).
  2784*                                COPY ELCSTATE.
  2785******************************************************************
  2786*                                                                *
  2787*                                                                *
  2788*                            ELCSTATE.                           *
  2789*                                                                *
  2790*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2791*                                                                *
  2792*   FILE TYPE = VSAM,KSDS                                        *
  2793*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2794*                                                                *
  2795*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2796*       ALTERNATE INDEX = NONE                                   *
  2797*                                                                *
  2798*   LOG = YES                                                    *
  2799*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2800******************************************************************
  2801*                   C H A N G E   L O G
  2802*
  2803* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2804*-----------------------------------------------------------------
  2805*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2806* EFFECTIVE    NUMBER
  2807*-----------------------------------------------------------------
  2808* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  54
* EL050.cbl
  2809******************************************************************
  2810*
  2811 01  STATE-FILE.
  2812     12  SF-RECORD-ID                       PIC XX.
  2813         88  VALID-CF-ID                        VALUE 'SF'.
  2814     12  SF-CONTROL-PRIMARY.
  2815         16  SF-COMPANY-ID                  PIC XXX.
  2816         16  SF-CARRIER-CODE                PIC X.
  2817         16  SF-GROUPING                    PIC X(6).
  2818         16  SF-STATE-CODE                  PIC XX.
  2819         16  SF-EXPIRE-DATE                 PIC 9(8).
  2820****************************************************************
  2821*             STATE CONTROLS
  2822****************************************************************
  2823     12  SF-LAST-MAINT-DT                   PIC XX.
  2824     12  SF-LAST-MAINT-BY                   PIC X(4).
  2825     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2826     12  SF-STATE-RT-CONTROLS.
  2827         16  SF-ST-RT-CALC                  PIC X.
  2828     12  SF-ST-TAX-CONTROLS.
  2829         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2830         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2831         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2832     12  SF-ST-REFUND-OPTIONS.
  2833         16  SF-ST-RF-LR-CALC               PIC X.
  2834         16  SF-ST-RF-LL-CALC               PIC X.
  2835         16  SF-ST-RF-LN-CALC               PIC X.
  2836         16  SF-ST-RF-AH-CALC               PIC X.
  2837         16  SF-ST-RF-CP-CALC               PIC X.
  2838     12  SF-ST-UNEARN-PREM-OPTIONS.
  2839         16  SF-ST-LUEP-R78                 PIC X.
  2840         16  SF-ST-LUEP-PRO                 PIC X.
  2841         16  SF-ST-LUEP-ST                  PIC X.
  2842         16  SF-ST-LUEP-DOM                 PIC X.
  2843         16  SF-ST-AUEP-R78                 PIC X.
  2844         16  SF-ST-AUEP-PRO                 PIC X.
  2845         16  SF-ST-AUEP-ST                  PIC X.
  2846         16  SF-ST-AUEP-DOM                 PIC X.
  2847         16  SF-ST-CUEP-R78                 PIC X.
  2848         16  SF-ST-CUEP-PRO                 PIC X.
  2849         16  SF-ST-CUEP-ST                  PIC X.
  2850         16  SF-ST-CUEP-DOM                 PIC X.
  2851     12  SF-ST-EARN-PREM-OPTIONS.
  2852         16  SF-ST-LEP-R78                  PIC X.
  2853         16  SF-ST-LEP-PRO                  PIC X.
  2854         16  SF-ST-LEP-ST                   PIC X.
  2855         16  SF-ST-LEP-DOM                  PIC X.
  2856         16  SF-ST-AEP-R78                  PIC X.
  2857         16  SF-ST-AEP-PRO                  PIC X.
  2858         16  SF-ST-AEP-ST                   PIC X.
  2859         16  SF-ST-AEP-DOM                  PIC X.
  2860         16  SF-ST-CEP-R78                  PIC X.
  2861         16  SF-ST-CEP-PRO                  PIC X.
  2862         16  SF-ST-CEP-ST                   PIC X.
  2863         16  SF-ST-CEP-DOM                  PIC X.
  2864     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  55
* EL050.cbl
  2866*    COPY ELCCRTT.
  2867******************************************************************
  2868*                                                                *
  2869*                            ELCCRTT.                            *
  2870*                                                                *
  2871*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2872*                                                                *
  2873*   FILE TYPE = VSAM,KSDS                                        *
  2874*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2875*                                                                *
  2876*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2877*                                                                *
  2878*   LOG = YES                                                    *
  2879*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2880******************************************************************
  2881*                   C H A N G E   L O G
  2882*
  2883* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2884*-----------------------------------------------------------------
  2885*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2886* EFFECTIVE    NUMBER
  2887*-----------------------------------------------------------------
  2888* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2889* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2890* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2891* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2892******************************************************************
  2893
  2894 01  CERTIFICATE-TRAILERS.
  2895     12  CS-RECORD-ID                      PIC XX.
  2896         88  VALID-CS-ID                      VALUE 'CS'.
  2897
  2898     12  CS-CONTROL-PRIMARY.
  2899         16  CS-COMPANY-CD                 PIC X.
  2900         16  CS-CARRIER                    PIC X.
  2901         16  CS-GROUPING                   PIC X(6).
  2902         16  CS-STATE                      PIC XX.
  2903         16  CS-ACCOUNT                    PIC X(10).
  2904         16  CS-CERT-EFF-DT                PIC XX.
  2905         16  CS-CERT-NO.
  2906             20  CS-CERT-PRIME             PIC X(10).
  2907             20  CS-CERT-SFX               PIC X.
  2908         16  CS-TRAILER-TYPE               PIC X.
  2909             88  COMM-TRLR           VALUE 'A'.
  2910             88  FUTURE-TRLR         VALUE 'B'.
  2911             88  CERT-DATA-TRLR      VALUE 'C'.
  2912
  2913     12  CS-DATA-AREA                      PIC X(516).
  2914
  2915     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2916         16  CS-BANK-COMMISSION-AREA.
  2917             20  CS-BANK-COMMS       OCCURS 10.
  2918                 24  CS-AGT                PIC X(10).
  2919                 24  CS-COM-TYP            PIC X.
  2920                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2921                 24  CS-RECALC-LV-INDIC    PIC X.
  2922                 24  FILLER                PIC X(10).
  2923         16  FILLER                        PIC X(256).
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  56
* EL050.cbl
  2924
  2925     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2926         16  CS-VIN-NUMBER                 PIC X(17).
  2927         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2928         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2929         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2930         16  FILLER                        PIC X(496).
  2931******************************************************************
  2932*    COPY ELCCRTO.
  2933******************************************************************
  2934*                                                                *
  2935*                            ELCCRTO.                            *
  2936*                                                                *
  2937*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2938*                                                                *
  2939*   FILE TYPE = VSAM,KSDS                                        *
  2940*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2941*                                                                *
  2942*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2943*                                                                *
  2944*   LOG = YES                                                    *
  2945*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2946******************************************************************
  2947*                   C H A N G E   L O G
  2948*
  2949* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2950*-----------------------------------------------------------------
  2951*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2952* EFFECTIVE    NUMBER
  2953*-----------------------------------------------------------------
  2954* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2955* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2956* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2957* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2958* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  2959******************************************************************
  2960 01  ORIGINAL-CERTIFICATE.
  2961     12  OC-RECORD-ID                      PIC XX.
  2962         88  VALID-OC-ID                      VALUE 'OC'.
  2963     12  OC-CONTROL-PRIMARY.
  2964         16  OC-COMPANY-CD                 PIC X.
  2965         16  OC-CARRIER                    PIC X.
  2966         16  OC-GROUPING                   PIC X(6).
  2967         16  OC-STATE                      PIC XX.
  2968         16  OC-ACCOUNT                    PIC X(10).
  2969         16  OC-CERT-EFF-DT                PIC XX.
  2970         16  OC-CERT-NO.
  2971             20  OC-CERT-PRIME             PIC X(10).
  2972             20  OC-CERT-SFX               PIC X.
  2973         16  OC-RECORD-TYPE                PIC X.
  2974         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2975     12  OC-LAST-MAINT-DT                  PIC XX.
  2976     12  OC-LAST-MAINT-BY                  PIC X(4).
  2977     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2978     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2979     12  FILLER                            PIC X(49).
  2980     12  OC-ORIG-REC.
  2981         16  OC-INS-LAST-NAME              PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  57
* EL050.cbl
  2982         16  OC-INS-FIRST-NAME             PIC X(10).
  2983         16  OC-INS-MIDDLE-INIT            PIC X.
  2984         16  OC-INS-AGE                    PIC S999     COMP-3.
  2985         16  OC-JNT-LAST-NAME              PIC X(15).
  2986         16  OC-JNT-FIRST-NAME             PIC X(10).
  2987         16  OC-JNT-MIDDLE-INIT            PIC X.
  2988         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2989         16  OC-LF-BENCD                   PIC XX.
  2990         16  OC-LF-TERM                    PIC S999      COMP-3.
  2991         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2992         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2993         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2994         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2995         16  OC-LF-EXP-DT                  PIC XX.
  2996         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2997         16  OC-LF-CANCEL-DT               PIC XX.
  2998         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2999         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3000         16  OC-AH-BENCD                   PIC XX.
  3001         16  OC-AH-TERM                    PIC S999      COMP-3.
  3002         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3003         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3004         16  OC-AH-EXP-DT                  PIC XX.
  3005         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3006         16  OC-AH-CP                      PIC 99.
  3007         16  OC-AH-CANCEL-DT               PIC XX.
  3008         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3009         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3010         16  OC-CRED-BENE-NAME             PIC X(25).
  3011         16  OC-1ST-PMT-DT                 PIC XX.
  3012         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3013         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3014         16  OC-ISSUE-TRAN-IND             PIC X.
  3015         16  OC-CANCEL-TRAN-IND            PIC X.
  3016         16  FILLER                        PIC X(211).
  3017
  3018     12  FILLER                            PIC X(50).
  3019******************************************************************
  3020
  3021*    COPY ELCDATE.
  3022******************************************************************
  3023*                                                                *
  3024*                                                                *
  3025*                            ELCDATE.                            *
  3026*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3027*                            VMOD=2.003
  3028*                                                                *
  3029*                                                                *
  3030*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3031*                 LENGTH = 200                                   *
  3032******************************************************************
  3033
  3034 01  DATE-CONVERSION-DATA.
  3035     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3036     12  DC-OPTION-CODE                PIC X.
  3037         88  BIN-TO-GREG                VALUE ' '.
  3038         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3039         88  EDIT-GREG-TO-BIN           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  58
* EL050.cbl
  3040         88  YMD-GREG-TO-BIN            VALUE '3'.
  3041         88  MDY-GREG-TO-BIN            VALUE '4'.
  3042         88  JULIAN-TO-BIN              VALUE '5'.
  3043         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3044         88  FIND-CENTURY               VALUE '7'.
  3045         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3046         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3047         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3048         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3049         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3050         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3051         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3052         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3053         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3054         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3055         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3056         88  BIN-3-TO-GREG              VALUE 'I'.
  3057         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3058         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3059         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3060         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3061         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3062         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3063         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3064         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3065         88  THREE-CHARACTER-BIN
  3066                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3067         88  GREGORIAN-TO-BIN
  3068                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3069         88  BIN-TO-GREGORIAN
  3070                  VALUES ' ' '1' 'I' '8' 'G'.
  3071         88  JULIAN-TO-BINARY
  3072                  VALUES '5' 'C' 'E' 'F'.
  3073     12  DC-ERROR-CODE                 PIC X.
  3074         88  NO-CONVERSION-ERROR        VALUE ' '.
  3075         88  DATE-CONVERSION-ERROR
  3076                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3077         88  DATE-IS-ZERO               VALUE '1'.
  3078         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3079         88  DATE-IS-INVALID            VALUE '3'.
  3080         88  DATE1-GREATER-DATE2        VALUE '4'.
  3081         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3082         88  DATE-INVALID-OPTION        VALUE '9'.
  3083         88  INVALID-CENTURY            VALUE 'A'.
  3084         88  ONLY-CENTURY               VALUE 'B'.
  3085         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3086         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3087     12  DC-END-OF-MONTH               PIC X.
  3088         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3089     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3090         88  USE-NORMAL-PROCESS         VALUE ' '.
  3091         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3092         88  ADJUST-UP-100-YRS          VALUE '2'.
  3093     12  FILLER                        PIC X.
  3094     12  DC-CONVERSION-DATES.
  3095         16  DC-BIN-DATE-1             PIC XX.
  3096         16  DC-BIN-DATE-2             PIC XX.
  3097         16  DC-GREG-DATE-1-EDIT       PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  59
* EL050.cbl
  3098         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3099                       DC-GREG-DATE-1-EDIT.
  3100             20  DC-EDIT1-MONTH        PIC 99.
  3101             20  SLASH1-1              PIC X.
  3102             20  DC-EDIT1-DAY          PIC 99.
  3103             20  SLASH1-2              PIC X.
  3104             20  DC-EDIT1-YEAR         PIC 99.
  3105         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3106         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3107                     DC-GREG-DATE-2-EDIT.
  3108             20  DC-EDIT2-MONTH        PIC 99.
  3109             20  SLASH2-1              PIC X.
  3110             20  DC-EDIT2-DAY          PIC 99.
  3111             20  SLASH2-2              PIC X.
  3112             20  DC-EDIT2-YEAR         PIC 99.
  3113         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3114         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3115                     DC-GREG-DATE-1-YMD.
  3116             20  DC-YMD-YEAR           PIC 99.
  3117             20  DC-YMD-MONTH          PIC 99.
  3118             20  DC-YMD-DAY            PIC 99.
  3119         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3120         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3121                      DC-GREG-DATE-1-MDY.
  3122             20  DC-MDY-MONTH          PIC 99.
  3123             20  DC-MDY-DAY            PIC 99.
  3124             20  DC-MDY-YEAR           PIC 99.
  3125         16  DC-GREG-DATE-1-ALPHA.
  3126             20  DC-ALPHA-MONTH        PIC X(10).
  3127             20  DC-ALPHA-DAY          PIC 99.
  3128             20  FILLER                PIC XX.
  3129             20  DC-ALPHA-CENTURY.
  3130                 24 DC-ALPHA-CEN-N     PIC 99.
  3131             20  DC-ALPHA-YEAR         PIC 99.
  3132         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3133         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3134         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3135         16  DC-JULIAN-DATE            PIC 9(05).
  3136         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3137                                       PIC 9(05).
  3138         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3139             20  DC-JULIAN-YEAR        PIC 99.
  3140             20  DC-JULIAN-DAYS        PIC 999.
  3141         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3142         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3143         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3144     12  DATE-CONVERSION-VARIBLES.
  3145         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3146         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3147             20  FILLER                PIC 9(3).
  3148             20  HOLD-CEN-1-CCYY.
  3149                 24  HOLD-CEN-1-CC     PIC 99.
  3150                 24  HOLD-CEN-1-YY     PIC 99.
  3151             20  HOLD-CEN-1-MO         PIC 99.
  3152             20  HOLD-CEN-1-DA         PIC 99.
  3153         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3154             20  HOLD-CEN-1-R-MO       PIC 99.
  3155             20  HOLD-CEN-1-R-DA       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  60
* EL050.cbl
  3156             20  HOLD-CEN-1-R-CCYY.
  3157                 24  HOLD-CEN-1-R-CC   PIC 99.
  3158                 24  HOLD-CEN-1-R-YY   PIC 99.
  3159             20  FILLER                PIC 9(3).
  3160         16  HOLD-CENTURY-1-X.
  3161             20  FILLER                PIC X(3)  VALUE SPACES.
  3162             20  HOLD-CEN-1-X-CCYY.
  3163                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3164                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3165             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3166             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3167         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3168             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3169             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3170             20  HOLD-CEN-1-R-X-CCYY.
  3171                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3172                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3173             20  FILLER                PIC XXX.
  3174         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3175         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3176         16  DC-JULIAN-DATE-1          PIC 9(07).
  3177         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3178             20  DC-JULIAN-1-CCYY.
  3179                 24  DC-JULIAN-1-CC    PIC 99.
  3180                 24  DC-JULIAN-1-YR    PIC 99.
  3181             20  DC-JULIAN-DA-1        PIC 999.
  3182         16  DC-JULIAN-DATE-2          PIC 9(07).
  3183         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3184             20  DC-JULIAN-2-CCYY.
  3185                 24  DC-JULIAN-2-CC    PIC 99.
  3186                 24  DC-JULIAN-2-YR    PIC 99.
  3187             20  DC-JULIAN-DA-2        PIC 999.
  3188         16  DC-GREG-DATE-A-EDIT.
  3189             20  DC-EDITA-MONTH        PIC 99.
  3190             20  SLASHA-1              PIC X VALUE '/'.
  3191             20  DC-EDITA-DAY          PIC 99.
  3192             20  SLASHA-2              PIC X VALUE '/'.
  3193             20  DC-EDITA-CCYY.
  3194                 24  DC-EDITA-CENT     PIC 99.
  3195                 24  DC-EDITA-YEAR     PIC 99.
  3196         16  DC-GREG-DATE-B-EDIT.
  3197             20  DC-EDITB-MONTH        PIC 99.
  3198             20  SLASHB-1              PIC X VALUE '/'.
  3199             20  DC-EDITB-DAY          PIC 99.
  3200             20  SLASHB-2              PIC X VALUE '/'.
  3201             20  DC-EDITB-CCYY.
  3202                 24  DC-EDITB-CENT     PIC 99.
  3203                 24  DC-EDITB-YEAR     PIC 99.
  3204         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3205         16  DC-GREG-DATE-CYMD-R REDEFINES
  3206                              DC-GREG-DATE-CYMD.
  3207             20  DC-CYMD-CEN           PIC 99.
  3208             20  DC-CYMD-YEAR          PIC 99.
  3209             20  DC-CYMD-MONTH         PIC 99.
  3210             20  DC-CYMD-DAY           PIC 99.
  3211         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3212         16  DC-GREG-DATE-MDCY-R REDEFINES
  3213                              DC-GREG-DATE-MDCY.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  61
* EL050.cbl
  3214             20  DC-MDCY-MONTH         PIC 99.
  3215             20  DC-MDCY-DAY           PIC 99.
  3216             20  DC-MDCY-CEN           PIC 99.
  3217             20  DC-MDCY-YEAR          PIC 99.
  3218    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3219        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3220    12  DC-EL310-DATE                  PIC X(21).
  3221    12  FILLER                         PIC X(28).
  3222
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  62
* EL050.cbl
  3224*    COPY ELCCALC.
  3225******************************************************************
  3226*                                                                *
  3227*                           ELCCALC.                            *
  3228*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3229*                            VMOD=2.025                          *
  3230*                                                                *
  3231*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3232*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3233*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3234*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3235*                                                                *
  3236*  PASSED TO ELRTRM                                              *
  3237*  -----------------                                             *
  3238*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3239*  ORIGINAL TERM                                                 *
  3240*  BEGINNING DATE                                                *
  3241*  ENDING DATE                                                   *
  3242*  COMPANY I.D.                                                  *
  3243*  ACCOUNT MASTER USER FIELD                                     *
  3244*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3245*  FREE LOOK DAYS                                                *
  3246*                                                                *
  3247*  RETURNED FROM ELRTRM                                          *
  3248*  ---------------------                                         *
  3249*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3250*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3251*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3252*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3253*----------------------------------------------------------------*
  3254*  PASSED TO ELRAMT                                              *
  3255*  ----------------                                              *
  3256*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3257*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3258*  ORIGINAL AMOUNT                                               *
  3259*  ALTERNATE BENEFIT (BALLON)                                    *
  3260*  A.P.R. - NET PAY ONLY                                         *
  3261*  METHOD
  3262*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3263*  COMPANY I.D.                                                  *
  3264*  BENEFIT TYPE                                                  *
  3265*                                                                *
  3266*  RETURNED FROM ELRAMT                                          *
  3267*  --------------------                                          *
  3268*  REMAINING AMOUNT 1 - CURRENT                                  *
  3269*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3270*  REMAINING AMOUNT FACTOR
  3271*----------------------------------------------------------------*
  3272*  PASSED TO ELRESV                                              *
  3273*  -----------------                                             *
  3274*  CERTIFICATE EFFECTIVE DATE                                    *
  3275*  VALUATION DATE                                                *
  3276*  PAID THRU DATE                                                *
  3277*  BENEFIT                                                       *
  3278*  INCURRED DATE                                                 *
  3279*  REPORTED DATE                                                 *
  3280*  ISSUE AGE                                                     *
  3281*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  63
* EL050.cbl
  3282*  CDT PERCENT                                                   *
  3283*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3284* *CLAIM TYPE (LIFE, A/H)                                        *
  3285* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3286* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3287*                                                                *
  3288*  RETURNED FROM ELRESV                                          *
  3289*  --------------------                                          *
  3290*  CDT TABLE USED                                                *
  3291*  CDT FACTOR USED                                               *
  3292*  PAY TO CURRENT RESERVE                                        *
  3293*  I.B.N.R. - A/H ONLY                                           *
  3294*  FUTURE (ACCRUED) AH ONLY                                      *
  3295*----------------------------------------------------------------*
  3296*  PASSED TO ELRATE                                              *
  3297*  ----------------                                              *
  3298*  CERT ISSUE DATE                                               *
  3299*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3300*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3301*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3302*  STATE CODE (CLIENT DEFINED)                                   *
  3303*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3304*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3305*  DEVIATION CODE                                                *
  3306*  ISSUE AGE                                                     *
  3307*  ORIGINAL BENEFIT AMOUNT                                       *
  3308*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3309*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3310*  BENEFIT KIND (LIFE OR A/H)                                    *
  3311*  A.P.R.                                                        *
  3312*  METHOD
  3313*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3314*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3315*  COMPANY I.D. (3 CHARACTER)                                    *
  3316*  BENEFIT CODE                                                  *
  3317*  BENEFIT OVERRIDE CODE                                         *
  3318*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3319*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3320*  JOINT INDICATOR (CSL ONLY)                                    *
  3321*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3322*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3323*                                                                *
  3324*  RETURNED FROM ELRATE                                          *
  3325*  --------------------                                          *
  3326*  CALCULATED PREMIUM                                            *
  3327*  PREMIUM RATE                                                  *
  3328*  MORTALITY CODE                                                *
  3329*  MAX ATTAINED AGE                                              *
  3330*  MAX AGE                                                       *
  3331*  MAX TERM                                                      *
  3332*  MAX MONTHLY BENEFIT                                           *
  3333*  MAX TOTAL BENIFIT                                             *
  3334*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3335*----------------------------------------------------------------*
  3336*  PASSED TO ELRFND                                              *
  3337*  ----------------                                              *
  3338*  CERT ISSUE DATE                                               *
  3339*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  64
* EL050.cbl
  3340*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3341*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3342*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3343*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3344*  STATE CODE (CLIENT DEFINED)                                   *
  3345*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3346*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3347*  DEVIATION CODE                                                *
  3348*  ISSUE AGE                                                     *
  3349*  ORIGINAL BENEFIT AMOUNT                                       *
  3350*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3351*  PROCESS TYPE (CANCEL)                                         *
  3352*  BENEFIT KIND (LIFE OR A/H)                                    *
  3353*  A.P.R.                                                        *
  3354*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3355*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3356*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3357*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3358*  COMPANY I.D. (3 CHARACTER)                                    *
  3359*  BENEFIT CODE                                                  *
  3360*  BENEFIT OVERRIDE CODE                                         *
  3361*                                                                *
  3362*  RETURNED FROM ELRFND                                          *
  3363*  --------------------                                          *
  3364*  CALCULATED REFUND                                             *
  3365*----------------------------------------------------------------*
  3366*  PASSED TO ELEARN                                              *
  3367*  ----------------                                              *
  3368*  CERT ISSUE DATE                                               *
  3369*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3370*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3371*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3372*  STATE CODE (CLIENT DEFINED)                                   *
  3373*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3374*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3375*  DEVIATION CODE                                                *
  3376*  ISSUE AGE                                                     *
  3377*  ORIGINAL BENEFIT AMOUNT                                       *
  3378*  BENEFIT KIND (LIFE OR A/H)                                    *
  3379*  A.P.R.                                                        *
  3380*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3381*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3382*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3383*  COMPANY I.D. (3 CHARACTER)                                    *
  3384*  BENEFIT CODE                                                  *
  3385*  BENEFIT OVERRIDE CODE                                         *
  3386*                                                                *
  3387*  RETURNED FROM ELEARN                                          *
  3388*  --------------------                                          *
  3389*  INDICATED  EARNINGS                                           *
  3390*----------------------------------------------------------------*
  3391*                 LENGTH = 450                                   *
  3392*                                                                *
  3393******************************************************************
  3394******************************************************************
  3395*                   C H A N G E   L O G
  3396*
  3397* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  65
* EL050.cbl
  3398*-----------------------------------------------------------------
  3399*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3400* EFFECTIVE    NUMBER
  3401*-----------------------------------------------------------------
  3402* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3403* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3404* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3405* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3406* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3407* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3408* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3409* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3410* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3411******************************************************************
  3412
  3413 01  CALCULATION-PASS-AREA.
  3414     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3415                                     COMP.
  3416
  3417     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3418       88  NO-CP-ERROR                             VALUE ZERO.
  3419       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3420                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3421       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3422       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3423       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3424       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3425       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3426       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3427       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3428       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3429       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3430       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3431       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3432       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3433       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3434       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3435       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3436       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3437       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3438
  3439     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3440       88  NO-CP-ERROR-2                           VALUE ZERO.
  3441***********************  INPUT AREAS ****************************
  3442
  3443     12  CP-CALCULATION-AREA.
  3444         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3445         16  CP-CERT-EFF-DT        PIC XX.
  3446         16  CP-VALUATION-DT       PIC XX.
  3447         16  CP-PAID-THRU-DT       PIC XX.
  3448         16  CP-BENEFIT-TYPE       PIC X.
  3449           88  CP-AH                               VALUE 'A' 'D'
  3450                                                   'I' 'U'.
  3451           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3452           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3453         16  CP-INCURRED-DT        PIC XX.
  3454         16  CP-REPORTED-DT        PIC XX.
  3455         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  66
* EL050.cbl
  3456         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3457         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3458                                     COMP-3.
  3459         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3460                                     COMP-3.
  3461         16  CP-CDT-METHOD         PIC X.
  3462           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3463           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3464           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3465         16  CP-CLAIM-TYPE         PIC X.
  3466           88  CP-AH-CLAIM                         VALUE 'A'.
  3467           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3468         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3469                                     COMP-3.
  3470         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3471                                     COMP-3.
  3472         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3473                                     COMP-3.
  3474         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3475                                     COMP-3.
  3476         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3477                                     COMP-3.
  3478         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3479                                     COMP-3.
  3480         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3481                                     COMP-3.
  3482         16  CP-REM-TERM-METHOD    PIC X.
  3483           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3484           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3485           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3486           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3487           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3488           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3489           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3490         16  CP-EARNING-METHOD     PIC X.
  3491           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3492           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3493           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3494           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3495           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3496           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3497           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3498           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3499           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3500           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3501           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3502           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3503           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3504           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3505         16  CP-PROCESS-TYPE       PIC X.
  3506           88  CP-CLAIM                            VALUE '1'.
  3507           88  CP-CANCEL                           VALUE '2'.
  3508           88  CP-ISSUE                            VALUE '3'.
  3509         16  CP-SPECIAL-CALC-CD    PIC X.
  3510           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3511           88  CP-1-MTH-INTEREST               VALUE ' '.
  3512           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3513           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  67
* EL050.cbl
  3514           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3515           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3516           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3517           88  CP-FARM-PLAN                    VALUE 'F'.
  3518           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3519           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3520           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3521           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3522           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3523           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3524           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3525           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3526           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3527           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3528                                                     'W' 'X'.
  3529           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3530           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3531           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3532           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3533           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3534           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3535           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3536           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3537           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3538           88  CP-CSL-METH-1                   VALUE '5'.
  3539           88  CP-CSL-METH-2                   VALUE '6'.
  3540           88  CP-CSL-METH-3                   VALUE '7'.
  3541           88  CP-CSL-METH-4                   VALUE '8'.
  3542
  3543         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3544                                     COMP-3.
  3545         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3546         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3547         16  CP-STATE              PIC XX          VALUE SPACE.
  3548         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3549         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3550           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3551               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3552         16  CP-R78-OPTION         PIC X.
  3553           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3554           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3555
  3556         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3557         16  CP-IBNR-RESERVE-SW    PIC X.
  3558         16  CP-CLAIM-STATUS       PIC X.
  3559         16  CP-RATE-FILE          PIC X.
  3560         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3561                                     COMP-3.
  3562
  3563         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3564         16  CP-AH-OVERRIDE-CODE   PIC X.
  3565
  3566         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3567                                     COMP-3.
  3568         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3569                                   PIC S9(5)V99 COMP-3.
  3570         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3571                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  68
* EL050.cbl
  3572         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3573                                     COMP-3.
  3574         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3575                                     COMP-3.
  3576         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3577                                  PIC S9(7)V99 COMP-3.
  3578
  3579         16  CP-PAID-FROM-DATE     PIC X(02).
  3580         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3581         16  CP-EXT-DAYS-CALC      PIC X.
  3582           88  CP-EXT-NO-CHG                   VALUE ' '.
  3583           88  CP-EXT-CHG-LF                   VALUE '1'.
  3584           88  CP-EXT-CHG-AH                   VALUE '2'.
  3585           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3586         16  CP-DOMICILE-STATE     PIC XX.
  3587         16  CP-CARRIER            PIC X.
  3588         16  CP-REIN-FLAG          PIC X.
  3589         16  CP-REM-TRM-CALC-OPTION PIC X.
  3590           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3591                      '2' '3' '4' '5'.
  3592           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3593           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3594           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3595           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3596           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3597           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3598           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3599           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3600         16  CP-SIG-SWITCH         PIC X.
  3601         16  CP-RATING-METHOD      PIC X.
  3602           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3603           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3604           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3605           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3606           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3607           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3608           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3609           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3610           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3611         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3612                                     COMP-3.
  3613         16  CP-BEN-CATEGORY       PIC X.
  3614         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3615         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3616                                   PIC S99V9(5) COMP-3.
  3617         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3618         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3619                                   PIC S99V9(5) COMP-3.
  3620         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3621         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3622         16  CP-EXPIRE-DT          PIC XX.
  3623         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3624         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3625         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3626         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3627         16  CP-DDF-SPEC-CALC      PIC X.
  3628             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3629             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  69
* EL050.cbl
  3630         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3631         16  CP-CANCEL-REASON      PIC X.
  3632         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3633         16  CP-PMT-MODE           PIC X.
  3634         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3635         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3636         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3637         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3638         16  FILLER                PIC X.
  3639
  3640***************    OUTPUT FROM ELRESV   ************************
  3641
  3642         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3643
  3644         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3645                                     COMP-3.
  3646         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3647                                     COMP-3.
  3648         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3649                                     COMP-3.
  3650         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3651                                     COMP-3.
  3652         16  FILLER                PIC X(09).
  3653***************    OUTPUT FROM ELRTRM   *************************
  3654
  3655         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3656                                     COMP-3.
  3657         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3658                                     COMP-3.
  3659         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3660                                     COMP-3.
  3661         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3662                                     COMP-3.
  3663         16  FILLER                PIC X(12).
  3664
  3665***************    OUTPUT FROM ELRAMT   *************************
  3666
  3667         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3668                                     COMP-3.
  3669         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3670                                     COMP-3.
  3671         16  FILLER                PIC X(12).
  3672
  3673***************    OUTPUT FROM ELRATE   *************************
  3674
  3675         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3676                                     COMP-3.
  3677         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3678                                     COMP-3.
  3679         16  CP-MORTALITY-CODE     PIC X(4).
  3680         16  CP-RATE-EDIT-FLAG     PIC X.
  3681             88  CP-RATES-NEED-APR                  VALUE '1'.
  3682         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3683                                     COMP-3.
  3684         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3685         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3686         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3687                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  70
* EL050.cbl
  3688         16  FILLER                PIC X(07).
  3689
  3690***************    OUTPUT FROM ELRFND   *************************
  3691
  3692         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3693                                     COMP-3.
  3694         16  CP-REFUND-TYPE-USED   PIC X.
  3695           88  CP-R-AS-R78                         VALUE '1'.
  3696           88  CP-R-AS-PRORATA                     VALUE '2'.
  3697           88  CP-R-AS-CALIF                       VALUE '3'.
  3698           88  CP-R-AS-TEXAS                       VALUE '4'.
  3699           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3700           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3701           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3702           88  CP-R-AS-MEAN                        VALUE '8'.
  3703           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3704           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3705           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3706           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3707           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3708           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3709         16  FILLER                PIC X(12).
  3710
  3711***************    OUTPUT FROM ELEARN   *************************
  3712
  3713         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3714                                     COMP-3.
  3715         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3716                                     COMP-3.
  3717         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3718                                     COMP-3.
  3719         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3720                                     COMP-3.
  3721         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3722                                     COMP-3.
  3723         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3724                                     COMP-3.
  3725         16  CP-EARNING-TYPE-USED  PIC X.
  3726           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3727           88  CP-E-AS-R78                         VALUE '1'.
  3728           88  CP-E-AS-PRORATA                     VALUE '2'.
  3729           88  CP-E-AS-TEXAS                       VALUE '4'.
  3730           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3731           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3732           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3733           88  CP-E-AS-MEAN                        VALUE '8'.
  3734           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3735         16  FILLER                PIC X(12).
  3736
  3737***************    OUTPUT FROM ELPMNT   *************************
  3738
  3739         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3740                                     COMP-3.
  3741         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3742                                     COMP-3.
  3743         16  FILLER                PIC X(12).
  3744
  3745***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  71
* EL050.cbl
  3746         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3747                                     COMP-3.
  3748         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3749                                     COMP-3.
  3750         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3751                                     COMP-3.
  3752         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3753                                     COMP-3.
  3754         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3755                                     COMP-3.
  3756         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3757                                     COMP-3.
  3758         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3759             88  OPEN-RATE-FILE                   VALUE 'O'.
  3760             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3761             88  IO-ERROR                         VALUE 'E'.
  3762
  3763         16  CP-FIRST-PAY-DATE     PIC XX.
  3764
  3765         16  CP-JOINT-INDICATOR    PIC X.
  3766
  3767         16  CP-RESERVE-REMAINING-TERM
  3768                                   PIC S9(4)V9    VALUE ZERO
  3769                                     COMP-3.
  3770
  3771         16  CP-INSURED-BIRTH-DT   PIC XX.
  3772
  3773         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3774                                     COMP-3.
  3775
  3776         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3777                                     COMP-3.
  3778
  3779         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3780                                     COMP-3.
  3781
  3782         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3783                                     COMP-3.
  3784
  3785         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3786                                     COMP-3.
  3787
  3788         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3789                                     COMP-3.
  3790
  3791         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3792                                     COMP-3.
  3793
  3794         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3795             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3796
  3797         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3798                                     COMP-3.
  3799         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3800                                     COMP-3.
  3801         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3802         16  FILLER                PIC X(15).
  3803******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  72
* EL050.cbl
  3805******************************************************************
  3806*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3807*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3808*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3809*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3810*** MODIFICATION.                                              ***
  3811*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3812*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3813******************************************************************
  3814*    COPY ERCPNDB.
  3815******************************************************************
  3816*                                                                *
  3817*                                                                *
  3818*                            ERCPNDB.                            *
  3819*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3820*                            VMOD=2.025                          *
  3821*                                                                *
  3822*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3823*                                                                *
  3824******************************************************************
  3825*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3826*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3827******************************************************************
  3828*                                                                *
  3829*                                                                *
  3830*   FILE TYPE = VSAM,KSDS                                        *
  3831*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3832*                                                                *
  3833*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3834*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3835*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3836*                                                 RKP=13,LEN=36  *
  3837*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3838*                                      AND CHG-SEQ.)             *
  3839*                                                RKP=49,LEN=11   *
  3840*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3841*                                      AND CHG-SEQ.)             *
  3842*                                                RKP=60,LEN=15   *
  3843*                                                                *
  3844*   LOG = NO                                                     *
  3845*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3846******************************************************************
  3847******************************************************************
  3848*                   C H A N G E   L O G
  3849*
  3850* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3851*-----------------------------------------------------------------
  3852*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3853* EFFECTIVE    NUMBER
  3854*-----------------------------------------------------------------
  3855* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3856* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3857* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3858* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3859* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3860* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3861* 032306                   PEMA  ADD BOW LOAN NUMBER
  3862* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  73
* EL050.cbl
  3863* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3864* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3865* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3866* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3867* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3868* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3869* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3870******************************************************************
  3871
  3872 01  PENDING-BUSINESS.
  3873     12  PB-RECORD-ID                     PIC XX.
  3874         88  VALID-PB-ID                        VALUE 'PB'.
  3875
  3876     12  PB-CONTROL-PRIMARY.
  3877         16  PB-COMPANY-CD                PIC X.
  3878         16  PB-ENTRY-BATCH               PIC X(6).
  3879         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3880         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3881
  3882     12  PB-CONTROL-BY-ACCOUNT.
  3883         16  PB-COMPANY-CD-A1             PIC X.
  3884         16  PB-CARRIER                   PIC X.
  3885         16  PB-GROUPING.
  3886             20  PB-GROUPING-PREFIX       PIC XXX.
  3887             20  PB-GROUPING-PRIME        PIC XXX.
  3888         16  PB-STATE                     PIC XX.
  3889         16  PB-ACCOUNT.
  3890             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3891             20  PB-ACCOUNT-PRIME         PIC X(6).
  3892         16  PB-CERT-EFF-DT               PIC XX.
  3893         16  PB-CERT-NO.
  3894             20  PB-CERT-PRIME            PIC X(10).
  3895             20  PB-CERT-SFX              PIC X.
  3896         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3897
  3898         16  PB-RECORD-TYPE               PIC X.
  3899             88  PB-MAILING-DATA                VALUE '0'.
  3900             88  PB-ISSUE                       VALUE '1'.
  3901             88  PB-CANCELLATION                VALUE '2'.
  3902             88  PB-BATCH-TRAILER               VALUE '9'.
  3903
  3904     12  PB-CONTROL-BY-ORIG-BATCH.
  3905         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3906         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3907         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3908         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3909
  3910     12  PB-CONTROL-BY-CSR.
  3911         16  PB-CSR-COMPANY-CD            PIC X.
  3912         16  PB-CSR-ID                    PIC X(4).
  3913         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3914         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3915         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3916******************************************************************
  3917*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3918******************************************************************
  3919
  3920     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  74
* EL050.cbl
  3921     12  PB-LAST-MAINT-BY                 PIC X(4).
  3922     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3923
  3924     12  PB-RECORD-BODY                   PIC X(375).
  3925
  3926     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3927         16  PB-CERT-ORIGIN               PIC X.
  3928             88  CLASIC-CREATED-CERT         VALUE '1'.
  3929         16  PB-I-NAME.
  3930             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3931             20  PB-I-INSURED-FIRST-NAME.
  3932                 24  PB-I-INSURED-1ST-INIT PIC X.
  3933                 24  FILLER                PIC X(9).
  3934             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3935         16  PB-I-AGE                     PIC S99   COMP-3.
  3936         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3937         16  PB-I-BIRTHDAY                PIC XX.
  3938         16  PB-I-INSURED-SEX             PIC X.
  3939             88  PB-SEX-MALE     VALUE 'M'.
  3940             88  PB-SEX-FEMALE   VALUE 'F'.
  3941
  3942         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3943         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3944         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3945         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3946         16  PB-I-SKIP-CODE               PIC X.
  3947             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3948             88  PB-SKIP-JULY              VALUE '1'.
  3949             88  PB-SKIP-AUGUST            VALUE '2'.
  3950             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3951             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3952             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3953             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3954             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3955             88  PB-SKIP-JUNE              VALUE '8'.
  3956             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3957             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3958             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3959         16  PB-I-TERM-TYPE               PIC X.
  3960             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3961             88  PB-PAID-WEEKLY            VALUE 'W'.
  3962             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3963             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3964             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3965         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3966         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3967         16  PB-I-DATA-ENTRY-SW           PIC X.
  3968             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3969             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3970             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3971             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3972         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3973         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3974*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3975         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3976         16  FILLER                       PIC X.
  3977
  3978         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  75
* EL050.cbl
  3979             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3980             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3981                                                   '90' THRU '99'.
  3982         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3983                                          PIC XX.
  3984         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3985         16  PB-I-AMOUNT-FINANCED REDEFINES
  3986                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3987         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3988         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3989                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3990         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3991         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3992         16  PB-I-CLP-AMOUNT REDEFINES
  3993                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3994         16  PB-I-LF-CALC-FLAG            PIC X.
  3995             88 PB-COMP-LF-PREM               VALUE '?'.
  3996         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3997         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3998         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3999         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4000         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4001         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4002         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4003         16  PB-I-LF-ABBR                 PIC XXX.
  4004         16  PB-I-LF-INPUT-CD             PIC XX.
  4005
  4006         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4007             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4008             88  PB-INVALID-AH               VALUE '  ' '00'
  4009                                                   '90' THRU '99'.
  4010         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4011         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4012         16  PB-I-AH-CALC-FLAG            PIC X.
  4013             88 PB-COMP-AH-PREM                  VALUE '?'.
  4014         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4015         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4016         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4017         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4018         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4019         16  PB-I-AH-ABBR                 PIC XXX.
  4020         16  PB-I-AH-INPUT-CD             PIC XXX.
  4021
  4022         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4023         16  PB-I-REIN-TABLE              PIC XXX.
  4024         16  PB-I-BUSINESS-TYPE           PIC 99.
  4025         16  PB-I-INDV-GRP-CD             PIC X.
  4026         16  PB-I-MORT-CODE.
  4027             20  PB-I-TABLE               PIC X.
  4028             20  PB-I-INTEREST            PIC XX.
  4029             20  PB-I-MORT-TYP            PIC X.
  4030         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4031         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4032         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4033         16  PB-I-INDV-GRP-OVRD           PIC X.
  4034         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4035         16  PB-I-SIG-SW                  PIC X.
  4036             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  76
* EL050.cbl
  4037         16  PB-I-RATE-CLASS              PIC XX.
  4038         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4039         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4040         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4041         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4042         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4043         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4044         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4045         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4046         16  PB-I-OB-FLAG                 PIC X.
  4047             88  PB-I-OB                      VALUE 'B'.
  4048             88  PB-I-SUMMARY                 VALUE 'Z'.
  4049         16  PB-I-ENTRY-STATUS            PIC X.
  4050             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4051                                              'M' '5' '9' '2'.
  4052             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4053             88  PB-I-POLICY-PENDING          VALUE '2'.
  4054             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4055             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4056             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4057             88  PB-I-REIN-ONLY               VALUE '9'.
  4058             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4059             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4060             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4061             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4062         16  PB-I-INT-CODE                PIC X.
  4063             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4064             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4065         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4066         16  PB-I-SOC-SEC-NO              PIC X(11).
  4067         16  PB-I-MEMBER-NO               PIC X(12).
  4068         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4069*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4070         16  PB-I-OLD-LOF                 PIC XXX.
  4071         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4072         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4073         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4074         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4075         16  PB-I-LIFE-INDICATOR          PIC X.
  4076             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4077         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4078         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4079                                          PIC S9(5)V99    COMP-3.
  4080         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4081             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4082             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4083         16  PB-I-1ST-PMT-DT              PIC XX.
  4084         16  PB-I-JOINT-INSURED.
  4085             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4086             20 PB-I-JOINT-FIRST-NAME.
  4087                24  PB-I-JOINT-FIRST-INIT PIC X.
  4088                24  FILLER                PIC X(9).
  4089             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4090*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4091         16  PB-I-BENEFICIARY-NAME.
  4092             20  PB-I-BANK-NUMBER         PIC X(10).
  4093             20  FILLER                   PIC X(15).
  4094         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  77
* EL050.cbl
  4095         16  PB-I-REFERENCE               PIC X(12).
  4096         16  FILLER REDEFINES PB-I-REFERENCE.
  4097             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4098             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4099             20  PB-I-CLP-STATE           PIC XX.
  4100         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4101             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4102             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4103             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4104         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4105         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4106         16  PB-I-RESIDENT-STATE          PIC XX.
  4107         16  PB-I-RATE-CODE               PIC X(4).
  4108         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4109         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4110         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4111         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4112         16  PB-I-BANK-NOCHRGB            PIC 99.
  4113         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4114         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4115
  4116     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4117         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4118             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4119         16  PB-C-CANCEL-ORIGIN           PIC X.
  4120             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4121         16  PB-C-LF-CANCEL-DT            PIC XX.
  4122         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4123         16  PB-C-LF-CALC-REQ             PIC X.
  4124             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4125         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4126         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4127         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4128             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4129         16  PB-C-AH-CANCEL-DT            PIC XX.
  4130         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4131         16  PB-C-AH-CALC-REQ             PIC X.
  4132             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4133         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4134         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4135         16  PB-C-LAST-NAME               PIC X(15).
  4136         16  PB-C-REFUND-SW               PIC X.
  4137             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4138             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4139         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4140         16  PB-C-PAYEE-CODE              PIC X(6).
  4141         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4142         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4143         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4144         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4145         16  PB-C-REFERENCE               PIC X(12).
  4146         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4147         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4148         16  PB-C-POST-CARD-IND           PIC X.
  4149         16  PB-C-CANCEL-REASON           PIC X.
  4150         16  PB-C-REF-INTERFACE-SW        PIC X.
  4151         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4152         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  78
* EL050.cbl
  4153         16  FILLER                       PIC X(01).
  4154*        16  FILLER                       PIC X(18).
  4155         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4156*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4157         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4158         16  PB-CANCELED-CERT-DATA.
  4159             20  PB-CI-INSURED-NAME.
  4160                 24  PB-CI-LAST-NAME      PIC X(15).
  4161                 24  PB-CI-INITIALS       PIC XX.
  4162             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4163             20  PB-CI-INSURED-SEX        PIC X.
  4164             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4165             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4166             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4167             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4168             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4169             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4170             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4171             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4172             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4173             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4174             20  PB-CI-RATE-CLASS         PIC XX.
  4175             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4176             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4177             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4178             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4179             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4180             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4181             20  PB-CI-LF-ABBR            PIC X(3).
  4182             20  PB-CI-AH-ABBR            PIC X(3).
  4183             20  PB-CI-OB-FLAG            PIC X.
  4184                 88  PB-CI-OB                VALUE 'B'.
  4185             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4186                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4187                                           'M' '4' '5' '9' '2'.
  4188                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4189                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4190                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4191                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4192                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4193                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4194                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4195                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4196                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4197                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4198                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4199                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4200             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4201                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4202                                           'M' '4' '5' '9' '2'.
  4203                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4204                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4205                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4206                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4207                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4208                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4209                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4210                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  79
* EL050.cbl
  4211                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4212                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4213                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4214                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4215             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4216             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4217             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4218             20  PB-CI-MEMBER-NO          PIC X(12).
  4219             20  PB-CI-INT-CODE           PIC X.
  4220                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4221                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4222             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4223             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4224             20  PB-CI-COMP-EXCP-SW       PIC X.
  4225                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4226                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4227             20  PB-CI-ENTRY-STATUS       PIC X.
  4228             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4229             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4230             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4231             20  PB-CI-DEATH-DT           PIC XX.
  4232             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4233             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4234             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4235             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4236             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4237             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4238             20  PB-CI-ENTRY-DT              PIC XX.
  4239             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4240             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4241             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4242             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4243             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4244             20  PB-CI-OLD-LOF               PIC XXX.
  4245*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4246             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4247             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4248             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4249             20  PB-CI-INDV-GRP-CD           PIC X.
  4250             20  PB-CI-BENEFICIARY-NAME.
  4251                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4252                 24  FILLER                  PIC X(15).
  4253             20  PB-CI-NOTE-SW               PIC X.
  4254             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4255             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4256             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4257             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4258             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4259             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4260             20  PB-CI-FIRST-NAME            PIC X(10).
  4261             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4262
  4263         16  FILLER                       PIC X(13).
  4264*032306  16  FILLER                       PIC X(27).
  4265*        16  FILLER                       PIC X(46).
  4266
  4267     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4268         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  80
* EL050.cbl
  4269         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4270         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4271         16  PB-M-INSURED-MID-INIT        PIC X.
  4272         16  PB-M-INSURED-AGE             PIC 99.
  4273         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4274         16  PB-M-INSURED-SEX             PIC X.
  4275         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4276         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4277         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4278         16  PB-M-INSURED-CITY-STATE.
  4279             20  PB-M-INSURED-CITY        PIC X(28).
  4280             20  PB-M-INSURED-STATE       PIC XX.
  4281         16  PB-M-INSURED-ZIP-CODE.
  4282             20  PB-M-INSURED-ZIP-PRIME.
  4283                 24  PB-M-INSURED-ZIP-1   PIC X.
  4284                     88  PB-M-CANADIAN-POST-CODE
  4285                                             VALUE 'A' THRU 'Z'.
  4286                 24  FILLER               PIC X(4).
  4287             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4288         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4289                                        PB-M-INSURED-ZIP-CODE.
  4290             20  PM-M-INS-CAN-POST1       PIC XXX.
  4291             20  PM-M-INS-CAN-POST2       PIC XXX.
  4292             20  FILLER                   PIC XXX.
  4293         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4294         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4295         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4296         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4297         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4298         16  PB-M-CRED-BENE-CITYST.
  4299             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4300             20  PB-M-CRED-BENE-STATE     PIC XX.
  4301         16  FILLER                       PIC X(92).
  4302
  4303     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4304         16  FILLER                       PIC X(10).
  4305         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4306         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4307         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4308         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4309         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4310         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4311         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4312         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4313         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4314         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4315         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4316         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4317         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4318         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4319         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4320         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4321         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4322         16  PB-ACCOUNT-NAME              PIC X(30).
  4323         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4324         16  PB-REFERENCE                 PIC X(12).
  4325         16  PB-B-RECEIVED-DT             PIC XX.
  4326         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  81
* EL050.cbl
  4327
  4328     12  PB-RECORD-STATUS.
  4329         16  PB-CREDIT-SELECT-DT          PIC XX.
  4330         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4331         16  PB-BILLED-DT                 PIC XX.
  4332         16  PB-BILLING-STATUS            PIC X.
  4333             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4334             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4335             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4336         16  PB-RECORD-BILL               PIC X.
  4337             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4338             88  PB-RECORD-RETURNED           VALUE 'R'.
  4339             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4340             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4341             88  PB-OVERRIDE-AH               VALUE 'A'.
  4342             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4343         16  PB-BATCH-ENTRY               PIC X.
  4344             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4345             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4346             88  PB-REISSUED-CERT             VALUE 'E'.
  4347             88  PB-MONTHLY-CERT              VALUE 'M'.
  4348             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4349             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4350             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4351         16  PB-FORCE-CODE                PIC X.
  4352             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4353             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4354             88  PB-CANCEL-FORCE              VALUE '8'.
  4355             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4356             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4357             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4358             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4359             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4360             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4361             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4362         16  PB-FATAL-FLAG                PIC X.
  4363             88  PB-FATAL-ERRORS              VALUE 'X'.
  4364         16  PB-FORCE-ER-CD               PIC X.
  4365             88  PB-FORCE-ERRORS              VALUE 'F'.
  4366             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4367         16  PB-WARN-ER-CD                PIC X.
  4368             88  PB-WARNING-ERRORS            VALUE 'W'.
  4369         16  FILLER                       PIC X.
  4370         16  PB-OUT-BAL-CD                PIC X.
  4371             88  PB-OUT-OF-BAL                VALUE 'O'.
  4372         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4373         16  PB-AH-OVERRIDE-L1            PIC X.
  4374         16  PB-INPUT-DT                  PIC XX.
  4375         16  PB-INPUT-BY                  PIC X(4).
  4376         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4377         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4378         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4379         16  PB-LF-EARNING-METHOD         PIC X.
  4380         16  PB-AH-EARNING-METHOD         PIC X.
  4381         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4382         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4383         16  PB-REIN-CD                   PIC XXX.
  4384         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  82
* EL050.cbl
  4385         16  PB-AH-REFUND-TYPE            PIC X.
  4386         16  PB-ACCT-EFF-DT               PIC XX.
  4387         16  PB-ACCT-EXP-DT               PIC XX.
  4388         16  PB-COMPANY-ID                PIC X(3).
  4389         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4390         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4391         16  PB-SV-CARRIER                PIC X.
  4392         16  PB-SV-GROUPING               PIC X(6).
  4393         16  PB-SV-STATE                  PIC XX.
  4394         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4395         16  PB-GA-BILLING-INFO.
  4396             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4397                                          PIC XX.
  4398         16  PB-SV-REMIT-TO  REDEFINES
  4399             PB-GA-BILLING-INFO           PIC X(10).
  4400         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4401         16  PB-I-LOAN-OFFICER            PIC X(5).
  4402         16  PB-I-VIN                     PIC X(17).
  4403
  4404         16  FILLER                       PIC X(04).
  4405         16  IMNET-BYPASS-SW              PIC X.
  4406
  4407******************************************************************
  4408*                COMMON EDIT ERRORS                              *
  4409******************************************************************
  4410
  4411     12  PB-COMMON-ERRORS.
  4412         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4413                                           PIC S9(4)     COMP.
  4414
  4415******************************************************************
  4416
  4417* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4418*    COPY ELC50W1.
  4419******************************************************************
  4420*                                                                *
  4421*                                                                *
  4422*                             ELC50W1                            *
  4423*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4424*                            VMOD=2.004                          *
  4425*                                                                *
  4426*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4427*                                                                *
  4428*                                                                *
  4429******************************************************************
  4430
  4431     12  WK-WORK-AREA.
  4432         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4433         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4434         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4435         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4436         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4437         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4438         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4439         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4440         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4441         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4442         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  83
* EL050.cbl
  4443         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4444         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4445         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4446         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4447         16  WK-CREDIT-EDIT-CONTROLS.
  4448             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4449             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4450             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4451             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4452             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4453             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4454         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4455         16  WK-SAVE-REIN-DATA.
  4456             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4457             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4458             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4459         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4460             88  ENTRY-FROM-EL6311       VALUE '6'.
  4461         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4462         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4463     12  WK-RECORD-ADDRESSES.
  4464         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4465         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4466         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4467         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4468         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4469         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4470         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4471         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4472     12  WK-OVER-SHORT-AREA.
  4473         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4474         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4475         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4476             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4477         16  FILLER                   PIC X(5) VALUE SPACES.
  4478
  4479*    COPY ELCEDITC.
  4480******************************************************************
  4481*                                                                *
  4482*                                                                *
  4483*                            ELCEDITC                            *
  4484*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4485*                            VMOD=2.012                          *
  4486*                                                                *
  4487*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4488*                     EL6313, EL050 AND EL517.                   *
  4489*                                                                *
  4490******************************************************************
  4491******************************************************************
  4492*                   C H A N G E   L O G
  4493*
  4494* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4495*-----------------------------------------------------------------
  4496*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4497* EFFECTIVE    NUMBER
  4498*-----------------------------------------------------------------
  4499* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4500******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  84
* EL050.cbl
  4501
  4502     12  EDIT-CRITERIA-DATA.
  4503         16  EC-CO-MONTH-END-DT       PIC XX.
  4504         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4505         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4506         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4507         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4508         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4509         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4510         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4511         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4512         16  EC-CO-REM-TERM-CALC      PIC X.
  4513               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4514               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4515               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4516               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4517
  4518         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4519               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4520               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4521               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4522               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4523               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4524               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4525               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4526               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4527               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4528               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4529
  4530         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4531               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4532               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4533               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4534               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4535               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4536               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4537               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4538               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4539
  4540         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4541                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4542                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4543
  4544         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4545                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4546                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4547                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4548                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4549                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4550                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4551                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4552                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4553
  4554         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4555               88  EC-BR-REDUCING                   VALUE 'R'.
  4556               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4557
  4558         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  85
* EL050.cbl
  4559         16  EC-BR-LF-DESC             PIC X(10).
  4560         16  EC-BR-AH-DESC             PIC X(10).
  4561         16  EC-BR-LF-COMMENT          PIC X(10).
  4562         16  EC-BR-AH-COMMENT          PIC X(10).
  4563
  4564         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4565               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4566               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4567               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4568               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4569
  4570         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4571               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4572               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4573               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4574               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4575
  4576         16  EC-BR-LF-REFUND-CALC      PIC X.
  4577                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4578                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4579                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4580                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4581                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4582                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4583                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4584
  4585         16  EC-BR-AH-REFUND-CALC      PIC X.
  4586                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4587                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4588                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4589                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4590                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4591                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4592                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4593                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4594
  4595         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4596                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4597                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4598                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4599
  4600         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4601                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4602                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4603                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4604
  4605         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4606         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4607         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4608         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4609
  4610         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4611         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4612                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4613                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4614                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4615                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4616
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  86
* EL050.cbl
  4617         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4618               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4619               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4620               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4621               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4622               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4623
  4624         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4625               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4626               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4627               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4628               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4629               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4630
  4631         16  EC-ST-LF-REFUND-CALC      PIC X.
  4632                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4633                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4634                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4635                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4636                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4637                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4638                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4639                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4640
  4641         16  EC-ST-AH-REFUND-CALC      PIC X.
  4642                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4643                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4644                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4645                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4646                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4647                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4648                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4649                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4650
  4651         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4652         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4653         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4654         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4655         16  EC-AM-EXPIRATION-DT       PIC XX.
  4656         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4657         16  EC-AM-CLASS-CD            PIC XX.
  4658         16  EC-AM-LF-DEVIATION        PIC XXX.
  4659         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4660         16  EC-AM-AH-DEVIATION        PIC XXX.
  4661         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4662         16  EC-AM-PHONE-NO            PIC X(10).
  4663
  4664         16  EC-AM-LF-REFUND-CALC      PIC X.
  4665                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4666                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4667                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4668                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4669                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4670                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4671                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4672
  4673         16  EC-AM-AH-REFUND-CALC      PIC X.
  4674                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  87
* EL050.cbl
  4675                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4676                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4677                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4678                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4679                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4680                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4681
  4682         16  EC-AM-BEN-I-G-CD          PIC X.
  4683                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4684                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4685                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4686
  4687         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4688         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4689         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4690         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4691         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4692         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4693         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4694         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4695         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4696
  4697         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4698         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4699         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4700         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4701         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4702         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4703         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4704         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4705         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4706         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4707         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4708         16  EC-RT-LF-NSP-ST           PIC XX.
  4709         16  EC-RT-AH-NSP-ST           PIC XX.
  4710         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4711         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4712
  4713         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4714             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4715                                             'M' '5' '9' '2'.
  4716             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4717             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4718             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4719             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4720             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4721             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4722             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4723             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4724             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4725             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4726
  4727         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4728             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4729                                             'M' '5' '9' '2'.
  4730             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4731             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4732             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  88
* EL050.cbl
  4733             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4734             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4735             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4736             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4737             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4738             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4739             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4740
  4741         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4742         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4743         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4744         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4745         16  EC-CM-DEATH-DT            PIC XX.
  4746
  4747*DMD CUSTOM CODING FIELDS BELOW
  4748*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4749         16  EC-BR-DMD-RATING-SW       PIC X.
  4750                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4751                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4752                 88  NO-DMD-RATING               VALUE 'N'.
  4753
  4754         16  EC-NEW-CERT               PIC X(11).
  4755         16  EC-NEW-STATE              PIC XX.
  4756         16  FILLER                    PIC X.
  4757*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4758         16  OVER-SHORT-EDIT-FIELDS.
  4759             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4760             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4761             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4762             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4763             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4764             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4765             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4766             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4767             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4768         16  FILLER                    PIC X(71).
  4769******************************************************************
  4770
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  89
* EL050.cbl
  4772*    COPY ELCDIFRD.
  4773******************************************************************
  4774*                                                                *
  4775*                                                                *
  4776*                            ELCDIFRD.                           *
  4777*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4778*                            VMOD=2.004                          *
  4779*                                                                *
  4780*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4781*                                                                *
  4782******************************************************************
  4783*
  4784  01  WS-DIFFERENCE-CALCULATION.
  4785        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4786        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4787        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4788        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4789        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4790        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4791        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4792        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4793        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4794        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4795        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4796
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  90
* EL050.cbl
  4798****************************************************************
  4799*
  4800* Copyright (c) 2007 by Clerity Solutions, Inc.
  4801* All rights reserved.
  4802*
  4803****************************************************************
  4804 01  DFHEIV.
  4805   02  DFHEIV0               PIC X(35).
  4806   02  DFHEIV1               PIC X(08).
  4807   02  DFHEIV2               PIC X(08).
  4808   02  DFHEIV3               PIC X(08).
  4809   02  DFHEIV4               PIC X(06).
  4810   02  DFHEIV5               PIC X(04).
  4811   02  DFHEIV6               PIC X(04).
  4812   02  DFHEIV7               PIC X(02).
  4813   02  DFHEIV8               PIC X(02).
  4814   02  DFHEIV9               PIC X(01).
  4815   02  DFHEIV10              PIC S9(7) COMP-3.
  4816   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4817   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4818   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4819   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4820   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4821   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4822   02  DFHEIV17              PIC X(04).
  4823   02  DFHEIV18              PIC X(04).
  4824   02  DFHEIV19              PIC X(04).
  4825   02  DFHEIV20              USAGE IS POINTER.
  4826   02  DFHEIV21              USAGE IS POINTER.
  4827   02  DFHEIV22              USAGE IS POINTER.
  4828   02  DFHEIV23              USAGE IS POINTER.
  4829   02  DFHEIV24              USAGE IS POINTER.
  4830   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4831   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4832   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4833   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4834   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4835   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4836   02  FILLER                PIC X(02).
  4837   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4838   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4839   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4840   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4841   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4842 LINKAGE  SECTION.
  4843*****************************************************************
  4844*                                                               *
  4845* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4846* All rights reserved.                                          *
  4847*                                                               *
  4848*****************************************************************
  4849 01  dfheiblk.
  4850     02  eibtime          pic s9(7) comp-3.
  4851     02  eibdate          pic s9(7) comp-3.
  4852     02  eibtrnid         pic x(4).
  4853     02  eibtaskn         pic s9(7) comp-3.
  4854     02  eibtrmid         pic x(4).
  4855     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  91
* EL050.cbl
  4856     02  eibcposn         pic s9(4) comp.
  4857     02  eibcalen         pic s9(4) comp.
  4858     02  eibaid           pic x(1).
  4859     02  eibfiller1       pic x(1).
  4860     02  eibfn            pic x(2).
  4861     02  eibfiller2       pic x(2).
  4862     02  eibrcode         pic x(6).
  4863     02  eibfiller3       pic x(2).
  4864     02  eibds            pic x(8).
  4865     02  eibreqid         pic x(8).
  4866     02  eibrsrce         pic x(8).
  4867     02  eibsync          pic x(1).
  4868     02  eibfree          pic x(1).
  4869     02  eibrecv          pic x(1).
  4870     02  eibsend          pic x(1).
  4871     02  eibatt           pic x(1).
  4872     02  eibeoc           pic x(1).
  4873     02  eibfmh           pic x(1).
  4874     02  eibcompl         pic x(1).
  4875     02  eibsig           pic x(1).
  4876     02  eibconf          pic x(1).
  4877     02  eiberr           pic x(1).
  4878     02  eibrldbk         pic x(1).
  4879     02  eiberrcd         pic x(4).
  4880     02  eibsynrb         pic x(1).
  4881     02  eibnodat         pic x(1).
  4882     02  eibfiller5       pic x(2).
  4883     02  eibresp          pic 9(09) comp.
  4884     02  eibresp2         pic 9(09) comp.
  4885     02  dfheigdj         pic s9(4) comp.
  4886     02  dfheigdk         pic s9(4) comp.
  4887
  4888 01  DFHCOMMAREA                   PIC X(1036).
  4889
  4890*01 PARMLIST .
  4891*    02  FILLER                    PIC S9(8)   COMP.
  4892*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4893*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4894*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4895*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4896*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4897*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4898*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4899
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  92
* EL050.cbl
  4901*    COPY ELCCNTL.
  4902******************************************************************
  4903*                                                                *
  4904*                                                                *
  4905*                            ELCCNTL.                            *
  4906*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4907*                            VMOD=2.059                          *
  4908*                                                                *
  4909*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4910*                                                                *
  4911*   FILE TYPE = VSAM,KSDS                                        *
  4912*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4913*                                                                *
  4914*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4915*       ALTERNATE INDEX = NONE                                   *
  4916*                                                                *
  4917*   LOG = YES                                                    *
  4918*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4919******************************************************************
  4920*                   C H A N G E   L O G
  4921*
  4922* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4923*-----------------------------------------------------------------
  4924*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4925* EFFECTIVE    NUMBER
  4926*-----------------------------------------------------------------
  4927* 082503                   PEMA  ADD BENEFIT GROUP
  4928* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4929* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4930* 092705    2005050300006  PEMA  ADD SPP LEASES
  4931* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4932* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4933* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4934* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4935* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4936* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4937* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4938******************************************************************
  4939*
  4940 01  CONTROL-FILE.
  4941     12  CF-RECORD-ID                       PIC XX.
  4942         88  VALID-CF-ID                        VALUE 'CF'.
  4943
  4944     12  CF-CONTROL-PRIMARY.
  4945         16  CF-COMPANY-ID                  PIC XXX.
  4946         16  CF-RECORD-TYPE                 PIC X.
  4947             88  CF-COMPANY-MASTER              VALUE '1'.
  4948             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4949             88  CF-STATE-MASTER                VALUE '3'.
  4950             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4951             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4952             88  CF-CARRIER-MASTER              VALUE '6'.
  4953             88  CF-MORTALITY-MASTER            VALUE '7'.
  4954             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4955             88  CF-TERMINAL-MASTER             VALUE '9'.
  4956             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4957             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4958             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  93
* EL050.cbl
  4959             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4960             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4961             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4962             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4963             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4964             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4965         16  CF-ACCESS-CD-GENL              PIC X(4).
  4966         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4967             20  CF-PROCESSOR               PIC X(4).
  4968         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4969             20  CF-STATE-CODE              PIC XX.
  4970             20  FILLER                     PIC XX.
  4971         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4972             20  FILLER                     PIC XX.
  4973             20  CF-HI-BEN-IN-REC           PIC XX.
  4974         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4975             20  FILLER                     PIC XXX.
  4976             20  CF-CARRIER-CNTL            PIC X.
  4977         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4978             20  FILLER                     PIC XX.
  4979             20  CF-HI-TYPE-IN-REC          PIC 99.
  4980         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4981             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4982                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4983             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4984             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4985         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4986             20  FILLER                     PIC X.
  4987             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4988         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4989             20  FILLER                     PIC XX.
  4990             20  CF-MORTGAGE-PLAN           PIC XX.
  4991         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4992
  4993     12  CF-LAST-MAINT-DT                   PIC XX.
  4994     12  CF-LAST-MAINT-BY                   PIC X(4).
  4995     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4996
  4997     12  CF-RECORD-BODY                     PIC X(728).
  4998
  4999
  5000****************************************************************
  5001*             COMPANY MASTER RECORD                            *
  5002****************************************************************
  5003
  5004     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5005         16  CF-COMPANY-ADDRESS.
  5006             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5007             20  CF-CL-IN-CARE-OF           PIC X(30).
  5008             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5009             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5010             20  CF-CL-CITY-STATE           PIC X(30).
  5011             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5012             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5013         16  CF-COMPANY-CD                  PIC X.
  5014         16  CF-COMPANY-PASSWORD            PIC X(8).
  5015         16  CF-SECURITY-OPTION             PIC X.
  5016             88  ALL-SECURITY                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  94
* EL050.cbl
  5017             88  COMPANY-VERIFY                 VALUE '2'.
  5018             88  PROCESSOR-VERIFY               VALUE '3'.
  5019             88  NO-SECURITY                    VALUE '4'.
  5020             88  ALL-BUT-TERM                   VALUE '5'.
  5021         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5022             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5023         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5024             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5025         16  CF-INFORCE-LOCATION            PIC X.
  5026             88  CERTS-ARE-ONLINE               VALUE '1'.
  5027             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5028             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5029         16  CF-LOWER-CASE-LETTERS          PIC X.
  5030         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5031             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5032             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5033             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5034             88  CF-ACCNT-CNTL                  VALUE '3'.
  5035             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5036
  5037         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5038         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5039
  5040         16  CF-LGX-CREDIT-USER             PIC X.
  5041             88  CO-IS-NOT-USER                 VALUE 'N'.
  5042             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5043
  5044         16 CF-CREDIT-CALC-CODES.
  5045             20  CF-CR-REM-TERM-CALC PIC X.
  5046               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5047               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5048               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5049               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5050               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5051               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5052               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5053             20  CF-CR-R78-METHOD           PIC X.
  5054               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5055               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5056
  5057         16  CF-CLAIM-CONTROL-COUNTS.
  5058             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5059                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5060
  5061             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5062                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5063
  5064             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5065                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5066
  5067             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5068                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5069
  5070         16  CF-CURRENT-MONTH-END           PIC XX.
  5071
  5072         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5073             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5074             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  95
* EL050.cbl
  5075             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5076             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5077                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5078                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5079             20  CF-CO-PREM-REJECT-SW       PIC X.
  5080                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5081                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5082             20  CF-CO-REF-REJECT-SW        PIC X.
  5083                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5084                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5085
  5086         16  CF-CO-REPORTING-DT             PIC XX.
  5087         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5088         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5089           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5090           88  CF-CO-MONTH-END                  VALUE '1'.
  5091
  5092         16  CF-LGX-CLAIM-USER              PIC X.
  5093             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5094             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5095
  5096         16  CF-CREDIT-EDIT-CONTROLS.
  5097             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5098             20  CF-MIN-AGE                 PIC 99.
  5099             20  CF-DEFAULT-AGE             PIC 99.
  5100             20  CF-MIN-TERM                PIC S999      COMP-3.
  5101             20  CF-MAX-TERM                PIC S999      COMP-3.
  5102             20  CF-DEFAULT-SEX             PIC X.
  5103             20  CF-JOINT-AGE-INPUT         PIC X.
  5104                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5105             20  CF-BIRTH-DATE-INPUT        PIC X.
  5106                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5107             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5108                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5109                 88  CF-ZERO-CARRIER            VALUE '1'.
  5110                 88  CF-ZERO-GROUPING           VALUE '2'.
  5111                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5112             20  CF-EDIT-SW                 PIC X.
  5113                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5114             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5115             20  CF-CR-PR-METHOD            PIC X.
  5116               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5117               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5118             20  FILLER                     PIC X.
  5119
  5120         16  CF-CREDIT-MISC-CONTROLS.
  5121             20  CF-REIN-TABLE-SW           PIC X.
  5122                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5123             20  CF-COMP-TABLE-SW           PIC X.
  5124                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5125             20  CF-EXPERIENCE-RETENTION-AGE
  5126                                            PIC S9        COMP-3.
  5127             20  CF-CONVERSION-DT           PIC XX.
  5128             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5129             20  CF-RUN-FREQUENCY-SW        PIC X.
  5130                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5131                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5132
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  96
* EL050.cbl
  5133             20  CF-CR-CHECK-NO-CONTROL.
  5134                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5135                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5136                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5137                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5138                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5139                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5140
  5141                 24  CF-CR-CHECK-COUNT       REDEFINES
  5142                     CF-CR-CHECK-COUNTER      PIC X(4).
  5143
  5144                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5145                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5146
  5147                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5148                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5149                 24  CF-MAIL-PROCESSING       PIC X.
  5150                     88  MAIL-PROCESSING          VALUE 'Y'.
  5151
  5152         16  CF-MISC-SYSTEM-CONTROL.
  5153             20  CF-SYSTEM-C                 PIC X.
  5154                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5155             20  CF-SYSTEM-D                 PIC X.
  5156                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5157             20  CF-SOC-SEC-NO-SW            PIC X.
  5158                 88  SOC-SEC-NO-USED             VALUE '1'.
  5159             20  CF-MEMBER-NO-SW             PIC X.
  5160                 88  MEMBER-NO-USED              VALUE '1'.
  5161             20  CF-TAX-ID-NUMBER            PIC X(11).
  5162             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5163             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5164                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5165                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5166                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5167                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5168             20  CF-SYSTEM-E                 PIC X.
  5169                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5170
  5171         16  CF-LGX-LIFE-USER               PIC X.
  5172             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5173             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5174
  5175         16  CF-CR-MONTH-END-DT             PIC XX.
  5176
  5177         16  CF-FILE-MAINT-DATES.
  5178             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5179                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5180             20  CF-LAST-BATCH       REDEFINES
  5181                 CF-LAST-BATCH-NO               PIC X(4).
  5182             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5183             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5184             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5185             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5186             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5187             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5188             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5189             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5190             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  97
* EL050.cbl
  5191             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5192
  5193         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5194         16  FILLER                         PIC X.
  5195
  5196         16  CF-ALT-MORT-CODE               PIC X(4).
  5197         16  CF-MEMBER-CAPTION              PIC X(10).
  5198
  5199         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5200             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5201             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5202             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5203             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5204             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5205
  5206         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5207
  5208         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5209         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5210         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5211         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5212
  5213         16  CF-AH-OVERRIDE-L1              PIC X.
  5214         16  CF-AH-OVERRIDE-L2              PIC XX.
  5215         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5216         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5217
  5218         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5219         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5220
  5221         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5222         16  CF-AR-LAST-EL860-DT            PIC XX.
  5223         16  CF-MP-MONTH-END-DT             PIC XX.
  5224
  5225         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5226         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5227             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5228
  5229         16  CF-AR-MONTH-END-DT             PIC XX.
  5230
  5231         16  CF-CRDTCRD-USER                PIC X.
  5232             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5233             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5234
  5235         16  CF-CC-MONTH-END-DT             PIC XX.
  5236
  5237         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5238
  5239         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5240             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5241             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5242             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5243         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5244         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5245         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5246         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5247             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5248             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  98
* EL050.cbl
  5249         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5250         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5251         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5252             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5253         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5254
  5255         16  CF-CL-ZIP-CODE.
  5256             20  CF-CL-ZIP-PRIME.
  5257                 24  CF-CL-ZIP-1ST          PIC X.
  5258                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5259                 24  FILLER                 PIC X(4).
  5260             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5261         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5262             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5263             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5264             20  FILLER                     PIC XXX.
  5265
  5266         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5267         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5268         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5269         16  CF-CO-OPTION-START-DATE        PIC XX.
  5270         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5271           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5272                                                      '3' '4'.
  5273           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5274           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5275           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5276           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5277           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5278           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5279
  5280         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5281
  5282         16  CF-PAYMENT-APPROVAL-LEVELS.
  5283             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5284             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5285             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5286             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5287             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5288             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5289
  5290         16  CF-END-USER-REPORTING-USER     PIC X.
  5291             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5292             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5293
  5294         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5295             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5296             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5297
  5298         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5299
  5300         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5301         16  FILLER                         PIC X.
  5302
  5303         16  CF-CREDIT-ARCHIVE-CNTL.
  5304             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5305             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5306             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  99
* EL050.cbl
  5307
  5308         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5309
  5310         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5311             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5312             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5313
  5314         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5315             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5316             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5317
  5318         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5319
  5320         16  CF-CO-ACH-ID-CODE              PIC  X.
  5321             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5322             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5323             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5324         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5325         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5326         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5327         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5328         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5329         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5330         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5331         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5332         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5333                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5334         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5335                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5336
  5337         16  CF-CO-OVER-SHORT.
  5338             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5339             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5340
  5341*         16  FILLER                         PIC X(102).
  5342         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5343             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5344             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5345
  5346         16  CF-AH-APPROVAL-DAYS.
  5347             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5348             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5349             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5350             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5351
  5352         16  FILLER                         PIC X(82).
  5353****************************************************************
  5354*             PROCESSOR/USER RECORD                            *
  5355****************************************************************
  5356
  5357     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5358         16  CF-PROCESSOR-NAME              PIC X(30).
  5359         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5360         16  CF-PROCESSOR-TITLE             PIC X(26).
  5361         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5362                 88  MESSAGE-YES                VALUE 'Y'.
  5363                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5364
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 100
* EL050.cbl
  5365*****************************************************
  5366****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5367****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5368****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5369****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5370*****************************************************
  5371
  5372         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5373             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5374             20  CF-APPLICATION-FORCE       PIC X.
  5375             20  CF-INDIVIDUAL-APP.
  5376                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5377                     28  CF-BROWSE-APP      PIC X.
  5378                     28  CF-UPDATE-APP      PIC X.
  5379
  5380         16  CF-CURRENT-TERM-ON             PIC X(4).
  5381         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5382             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5383             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5384             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5385             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5386             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5387             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5388             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5389         16  CF-PROCESSOR-CARRIER           PIC X.
  5390             88  NO-CARRIER-SECURITY            VALUE ' '.
  5391         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5392             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5393         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5394             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5395         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5396             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5397
  5398         16  CF-PROC-SYS-ACCESS-SW.
  5399             20  CF-PROC-CREDIT-CLAIMS-SW.
  5400                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5401                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5402                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5403                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5404             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5405                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5406                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5407             20  CF-PROC-LIFE-GNRLDGR-SW.
  5408                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5409                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5410                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5411                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5412             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5413                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5414                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5415         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5416             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5417             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5418         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5419
  5420         16  CF-APPROVAL-LEVEL                  PIC X.
  5421             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5422             88  APPROVAL-LEVEL-2                   VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 101
* EL050.cbl
  5423             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5424             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5425
  5426         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5427
  5428         16  CF-LANGUAGE-TYPE                   PIC X.
  5429             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5430             88  CF-LANG-IS-FR                      VALUE 'F'.
  5431
  5432         16  CF-CSR-IND                         PIC X.
  5433         16  FILLER                             PIC X(239).
  5434
  5435****************************************************************
  5436*             PROCESSOR/REMINDERS RECORD                       *
  5437****************************************************************
  5438
  5439     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5440         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5441             20  CF-START-REMIND-DT         PIC XX.
  5442             20  CF-END-REMIND-DT           PIC XX.
  5443             20  CF-REMINDER-TEXT           PIC X(50).
  5444         16  FILLER                         PIC X(296).
  5445
  5446
  5447****************************************************************
  5448*             STATE MASTER RECORD                              *
  5449****************************************************************
  5450
  5451     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5452         16  CF-STATE-ABBREVIATION          PIC XX.
  5453         16  CF-STATE-NAME                  PIC X(25).
  5454         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5455         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5456             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5457             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5458             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5459             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5460                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5461                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5462             20  CF-ST-PREM-REJECT-SW       PIC X.
  5463                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5464                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5465             20  CF-ST-REF-REJECT-SW        PIC X.
  5466                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5467                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5468         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5469         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5470         16  CF-ST-REFUND-RULES.
  5471             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5472             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5473             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5474         16  CF-ST-FST-PMT-EXTENSION.
  5475             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5476             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5477                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5478                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5479                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5480                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 102
* EL050.cbl
  5481         16  CF-ST-STATE-CALL.
  5482             20  CF-ST-CALL-UNEARNED        PIC X.
  5483             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5484             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5485         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5486             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5487             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5488         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5489         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5490         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5491         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5492         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5493         16  FILLER                         PIC X.
  5494         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5495             20  CF-ST-BENEFIT-CD           PIC XX.
  5496             20  CF-ST-BENEFIT-KIND         PIC X.
  5497                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5498                 88  CF-ST-AH-KIND              VALUE 'A'.
  5499             20  CF-ST-REM-TERM-CALC        PIC X.
  5500                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5501                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5502                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5503                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5504                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5505                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5506                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5507                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5508
  5509             20  CF-ST-REFUND-CALC          PIC X.
  5510                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5511                 88  ST-REFD-BY-R78             VALUE '1'.
  5512                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5513                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5514                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5515                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5516                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5517                 88  ST-REFD-UTAH               VALUE '7'.
  5518                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5519                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5520                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5521
  5522             20  CF-ST-EARNING-CALC         PIC X.
  5523                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5524                 88  ST-EARN-BY-R78             VALUE '1'.
  5525                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5526                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5527                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5528                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5529                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5530                 88  ST-EARN-MEAN               VALUE '8'.
  5531                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5532
  5533             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5534                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5535                 88  ST-OVRD-BY-R78             VALUE '1'.
  5536                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5537                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5538                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 103
* EL050.cbl
  5539                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5540                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5541                 88  ST-OVRD-MEAN               VALUE '8'.
  5542                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5543             20  FILLER                     PIC X.
  5544
  5545         16  CF-ST-COMMISSION-CAPS.
  5546             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5547             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5548             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5549             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5550         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5551                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5552
  5553         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5554
  5555         16  CF-ST-STATUTORY-INTEREST.
  5556             20  CF-ST-STAT-DATE-FROM       PIC X.
  5557                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5558                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5559             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5560             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5561             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5562             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5563             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5564
  5565         16  CF-ST-OVER-SHORT.
  5566             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5567             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5568
  5569         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5570
  5571         16  CF-ST-RT-CALC                  PIC X.
  5572
  5573         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5574         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5575         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5576         16  CF-ST-RF-LR-CALC               PIC X.
  5577         16  CF-ST-RF-LL-CALC               PIC X.
  5578         16  CF-ST-RF-LN-CALC               PIC X.
  5579         16  CF-ST-RF-AH-CALC               PIC X.
  5580         16  CF-ST-RF-CP-CALC               PIC X.
  5581*        16  FILLER                         PIC X(206).
  5582*CIDMOD         16  FILLER                         PIC X(192).
  5583         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5584             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5585         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5586         16  CF-ST-VFY-2ND-BENE             PIC X.
  5587         16  CF-ST-CAUSAL-STATE             PIC X.
  5588         16  FILLER                         PIC X(185).
  5589
  5590****************************************************************
  5591*             BENEFIT MASTER RECORD                            *
  5592****************************************************************
  5593
  5594     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5595         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5596             20  CF-BENEFIT-CODE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 104
* EL050.cbl
  5597             20  CF-BENEFIT-NUMERIC  REDEFINES
  5598                 CF-BENEFIT-CODE            PIC XX.
  5599             20  CF-BENEFIT-ALPHA           PIC XXX.
  5600             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5601             20  CF-BENEFIT-COMMENT         PIC X(10).
  5602
  5603             20  CF-LF-COVERAGE-TYPE        PIC X.
  5604                 88  CF-REDUCING                VALUE 'R'.
  5605                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5606
  5607             20  CF-SPECIAL-CALC-CD         PIC X.
  5608                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5609                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5610                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5611                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5612                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5613                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5614                 88  CF-FARM-PLAN               VALUE 'F'.
  5615                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5616                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5617                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5618                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5619                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5620                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5621                 88  CF-PRUDENTIAL              VALUE 'P'.
  5622                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5623                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5624                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5625                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5626                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5627                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5628
  5629             20  CF-JOINT-INDICATOR         PIC X.
  5630                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5631
  5632*            20  FILLER                     PIC X(12).
  5633             20  FILLER                     PIC X(11).
  5634             20  CF-BENEFIT-CATEGORY        PIC X.
  5635             20  CF-LOAN-TYPE               PIC X(8).
  5636
  5637             20  CF-CO-REM-TERM-CALC        PIC X.
  5638                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5639                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5640                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5641                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5642                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5643
  5644             20  CF-CO-EARNINGS-CALC        PIC X.
  5645                 88  CO-EARN-BY-R78             VALUE '1'.
  5646                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5647                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5648                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5649                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5650                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5651                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5652                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5653
  5654             20  CF-CO-REFUND-CALC          PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 105
* EL050.cbl
  5655                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5656                 88  CO-REFD-BY-R78             VALUE '1'.
  5657                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5658                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5659                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5660                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5661                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5662                 88  CO-REFD-MEAN               VALUE '8'.
  5663                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5664                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5665                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5666
  5667             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5668                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5669                 88  CO-OVRD-BY-R78             VALUE '1'.
  5670                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5671                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5672                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5673                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5674                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5675                 88  CO-OVRD-MEAN               VALUE '8'.
  5676                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5677
  5678             20  CF-CO-BEN-I-G-CD           PIC X.
  5679                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5680                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5681                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5682
  5683         16  FILLER                         PIC X(304).
  5684
  5685
  5686****************************************************************
  5687*             CARRIER MASTER RECORD                            *
  5688****************************************************************
  5689
  5690     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5691         16  CF-ADDRESS-DATA.
  5692             20  CF-MAIL-TO-NAME            PIC X(30).
  5693             20  CF-IN-CARE-OF              PIC X(30).
  5694             20  CF-ADDRESS-LINE-1          PIC X(30).
  5695             20  CF-ADDRESS-LINE-2          PIC X(30).
  5696             20  CF-CITY-STATE              PIC X(30).
  5697             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5698             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5699
  5700         16  CF-CLAIM-NO-CONTROL.
  5701             20  CF-CLAIM-NO-METHOD         PIC X.
  5702                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5703                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5704                 88  CLAIM-NO-SEQ               VALUE '3'.
  5705                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5706             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5707                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5708                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5709                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5710
  5711         16  CF-CHECK-NO-CONTROL.
  5712             20  CF-CHECK-NO-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 106
* EL050.cbl
  5713                 88  CHECK-NO-MANUAL            VALUE '1'.
  5714                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5715                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5716                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5717             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5718                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5719
  5720         16  CF-DOMICILE-STATE              PIC XX.
  5721
  5722         16  CF-EXPENSE-CONTROLS.
  5723             20  CF-EXPENSE-METHOD          PIC X.
  5724                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5725                 88  DOLLARS-PER-PMT            VALUE '2'.
  5726                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5727                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5728             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5729             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5730
  5731         16  CF-CORRESPONDENCE-CONTROL.
  5732             20  CF-LETTER-RESEND-OPT       PIC X.
  5733                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5734                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5735             20  FILLER                     PIC X(4).
  5736
  5737         16  CF-RESERVE-CONTROLS.
  5738             20  CF-MANUAL-SW               PIC X.
  5739                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5740             20  CF-FUTURE-SW               PIC X.
  5741                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5742             20  CF-PTC-SW                  PIC X.
  5743                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5744             20  CF-IBNR-SW                 PIC X.
  5745                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5746             20  CF-PTC-LF-SW               PIC X.
  5747                 88  CF-LF-PTC-USED             VALUE '1'.
  5748             20  CF-CDT-ACCESS-METHOD       PIC X.
  5749                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5750                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5751                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5752             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5753
  5754         16  CF-CLAIM-CALC-METHOD           PIC X.
  5755             88  360-PLUS-MONTHS                VALUE '1'.
  5756             88  365-PLUS-MONTHS                VALUE '2'.
  5757             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5758             88  360-DAILY                      VALUE '4'.
  5759             88  365-DAILY                      VALUE '5'.
  5760
  5761         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5762         16  FILLER                         PIC X(11).
  5763
  5764         16  CF-LIMIT-AMOUNTS.
  5765             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5766             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5767             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5768             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5769             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5770             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 107
* EL050.cbl
  5771             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5772             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5773             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5774             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5775
  5776         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5777         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5778         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5779
  5780         16  CF-ZIP-CODE.
  5781             20  CF-ZIP-PRIME.
  5782                 24  CF-ZIP-1ST             PIC X.
  5783                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5784                 24  FILLER                 PIC X(4).
  5785             20  CF-ZIP-PLUS4               PIC X(4).
  5786         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5787             20  CF-CAN-POSTAL-1            PIC XXX.
  5788             20  CF-CAN-POSTAL-2            PIC XXX.
  5789             20  FILLER                     PIC XXX.
  5790
  5791         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5792         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5793         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5794
  5795         16  CF-RATING-SWITCH               PIC X.
  5796             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5797             88  CF-NO-RATING                   VALUE 'N'.
  5798
  5799         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5800
  5801         16  CF-CARRIER-OVER-SHORT.
  5802             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5803             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5804
  5805         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5806         16  CF-SECPAY-SWITCH               PIC X.
  5807             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5808             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5809         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5810         16  FILLER                         PIC X(448).
  5811*        16  FILLER                         PIC X(452).
  5812
  5813
  5814****************************************************************
  5815*             MORTALITY MASTER RECORD                          *
  5816****************************************************************
  5817
  5818     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5819         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5820                                INDEXED BY CF-MORT-NDX.
  5821             20  CF-MORT-TABLE              PIC X(5).
  5822             20  CF-MORT-TABLE-TYPE         PIC X.
  5823                 88  CF-MORT-JOINT              VALUE 'J'.
  5824                 88  CF-MORT-SINGLE             VALUE 'S'.
  5825                 88  CF-MORT-COMBINED           VALUE 'C'.
  5826                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5827                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5828             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 108
* EL050.cbl
  5829             20  CF-MORT-AGE-METHOD         PIC XX.
  5830                 88  CF-AGE-LAST                VALUE 'AL'.
  5831                 88  CF-AGE-NEAR                VALUE 'AN'.
  5832             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5833             20  CF-MORT-ADJUSTMENT-DIRECTION
  5834                                            PIC X.
  5835                 88  CF-MINUS                   VALUE '-'.
  5836                 88  CF-PLUS                    VALUE '+'.
  5837             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5838             20  CF-MORT-JOINT-CODE         PIC X.
  5839                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5840             20  CF-MORT-PC-Q               PIC X.
  5841                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5842             20  CF-MORT-TABLE-CODE         PIC X(4).
  5843             20  CF-MORT-COMMENTS           PIC X(15).
  5844             20  FILLER                     PIC X(14).
  5845
  5846         16  FILLER                         PIC X(251).
  5847
  5848
  5849****************************************************************
  5850*             BUSSINESS TYPE MASTER RECORD                     *
  5851****************************************************************
  5852
  5853     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5854* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5855* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5856* AND RECORD 05 IS TYPES 81-99
  5857         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5858             20  CF-BUSINESS-TITLE          PIC  X(19).
  5859             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5860                                            PIC S9V9(4) COMP-3.
  5861             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5862             20  FILLER                     PIC  X.
  5863         16  FILLER                         PIC  X(248).
  5864
  5865
  5866****************************************************************
  5867*             TERMINAL MASTER RECORD                           *
  5868****************************************************************
  5869
  5870     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5871
  5872         16  CF-COMPANY-TERMINALS.
  5873             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5874                                  PIC X(4).
  5875         16  FILLER               PIC X(248).
  5876
  5877
  5878****************************************************************
  5879*             LIFE EDIT MASTER RECORD                          *
  5880****************************************************************
  5881
  5882     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5883         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5884             20  CF-LIFE-CODE-IN            PIC XX.
  5885             20  CF-LIFE-CODE-OUT           PIC XX.
  5886         16  FILLER                         PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 109
* EL050.cbl
  5887
  5888
  5889****************************************************************
  5890*             AH EDIT MASTER RECORD                            *
  5891****************************************************************
  5892
  5893     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5894         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5895             20  CF-AH-CODE-IN              PIC XXX.
  5896             20  CF-AH-CODE-OUT             PIC XX.
  5897         16  FILLER                         PIC X(248).
  5898
  5899
  5900****************************************************************
  5901*             CREDIBILITY TABLES                               *
  5902****************************************************************
  5903
  5904     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5905         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5906                             INDEXED BY CF-CRDB-NDX.
  5907             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5908             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5909             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5910         16  FILLER                         PIC  X(332).
  5911
  5912
  5913****************************************************************
  5914*             REPORT CUSTOMIZATION RECORD                      *
  5915****************************************************************
  5916
  5917     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5918         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5919             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5920             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5921             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5922**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5923****       A T-TRANSFER.                                   ****
  5924             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5925
  5926         16  FILLER                         PIC XX.
  5927
  5928         16  CF-CARRIER-CNTL-OPT.
  5929             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5930                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5931                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5932             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5933                                            PIC X.
  5934         16  CF-GROUP-CNTL-OPT.
  5935             20  CF-GROUP-OPT-SEQ           PIC 9.
  5936                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5937                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5938             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5939                                            PIC X(6).
  5940         16  CF-STATE-CNTL-OPT.
  5941             20  CF-STATE-OPT-SEQ           PIC 9.
  5942                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5943                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5944             20  CF-STATE-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 110
* EL050.cbl
  5945                                            PIC XX.
  5946         16  CF-ACCOUNT-CNTL-OPT.
  5947             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5948                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5949                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5950             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5951                                            PIC X(10).
  5952         16  CF-BUS-TYP-CNTL-OPT.
  5953             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5954                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5955                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5956             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5957                                            PIC XX.
  5958         16  CF-LF-TYP-CNTL-OPT.
  5959             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5960                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5961                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5962             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5963                                            PIC XX.
  5964         16  CF-AH-TYP-CNTL-OPT.
  5965             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5966                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5967                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5968             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5969                                            PIC XX.
  5970         16  CF-REPTCD1-CNTL-OPT.
  5971             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5972                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5973                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5974             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5975                                            PIC X(10).
  5976         16  CF-REPTCD2-CNTL-OPT.
  5977             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5978                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5979                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5980             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5981                                            PIC X(10).
  5982         16  CF-USER1-CNTL-OPT.
  5983             20  CF-USER1-OPT-SEQ           PIC 9.
  5984                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5985                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5986             20  CF-USER1-SELECT OCCURS 3 TIMES
  5987                                            PIC X(10).
  5988         16  CF-USER2-CNTL-OPT.
  5989             20  CF-USER2-OPT-SEQ           PIC 9.
  5990                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5991                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5992             20  CF-USER2-SELECT OCCURS 3 TIMES
  5993                                            PIC X(10).
  5994         16  CF-USER3-CNTL-OPT.
  5995             20  CF-USER3-OPT-SEQ           PIC 9.
  5996                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5997                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5998             20  CF-USER3-SELECT OCCURS 3 TIMES
  5999                                            PIC X(10).
  6000         16  CF-USER4-CNTL-OPT.
  6001             20  CF-USER4-OPT-SEQ           PIC 9.
  6002                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 111
* EL050.cbl
  6003                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6004             20  CF-USER4-SELECT OCCURS 3 TIMES
  6005                                            PIC X(10).
  6006         16  CF-USER5-CNTL-OPT.
  6007             20  CF-USER5-OPT-SEQ           PIC 9.
  6008                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6009                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6010             20  CF-USER5-SELECT OCCURS 3 TIMES
  6011                                            PIC X(10).
  6012         16  CF-REINS-CNTL-OPT.
  6013             20  CF-REINS-OPT-SEQ           PIC 9.
  6014                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6015                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6016             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6017                 24  CF-REINS-PRIME         PIC XXX.
  6018                 24  CF-REINS-SUB           PIC XXX.
  6019
  6020         16  CF-AGENT-CNTL-OPT.
  6021             20  CF-AGENT-OPT-SEQ           PIC 9.
  6022                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6023                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6024             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6025                                            PIC X(10).
  6026
  6027         16  FILLER                         PIC X(43).
  6028
  6029         16  CF-LOSS-RATIO-SELECT.
  6030             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6031             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6032         16  CF-ENTRY-DATE-SELECT.
  6033             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6034             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6035         16  CF-EFFECTIVE-DATE-SELECT.
  6036             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6037             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6038
  6039         16  CF-EXCEPTION-LIST-IND          PIC X.
  6040             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6041
  6042         16  FILLER                         PIC X(318).
  6043
  6044****************************************************************
  6045*                  EXCEPTION REPORTING RECORD                  *
  6046****************************************************************
  6047
  6048     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6049         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6050             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6051
  6052         16  CF-COMBINED-LIFE-AH-OPT.
  6053             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6054             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6055             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6056             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6057
  6058         16  CF-LIFE-OPT.
  6059             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6060             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 112
* EL050.cbl
  6061             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6062             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6063             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6064             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6065             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6066             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6067             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6068             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6069
  6070         16  CF-AH-OPT.
  6071             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6072             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6073             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6074             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6075             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6076             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6077             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6078             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6079             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6080             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6081
  6082         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6083             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6084             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6085             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6086
  6087         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6088
  6089         16  FILLER                         PIC X(673).
  6090
  6091
  6092****************************************************************
  6093*             MORTGAGE SYSTEM PLAN RECORD                      *
  6094****************************************************************
  6095
  6096     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6097         16  CF-PLAN-TYPE                   PIC X.
  6098             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6099             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6100             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6101         16  CF-PLAN-ABBREV                 PIC XXX.
  6102         16  CF-PLAN-DESCRIPT               PIC X(10).
  6103         16  CF-PLAN-NOTES                  PIC X(20).
  6104         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6105         16  CF-PLAN-UNDERWRITING.
  6106             20  CF-PLAN-TERM-DATA.
  6107                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6108                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6109             20  CF-PLAN-AGE-DATA.
  6110                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6111                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6112                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6113             20  CF-PLAN-BENEFIT-DATA.
  6114                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6115                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6116                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6117                                            PIC S9(7)V99  COMP-3.
  6118         16  CF-PLAN-POLICY-FORMS.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 113
* EL050.cbl
  6119             20  CF-POLICY-FORM             PIC X(12).
  6120             20  CF-MASTER-APPLICATION      PIC X(12).
  6121             20  CF-MASTER-POLICY           PIC X(12).
  6122         16  CF-PLAN-RATING.
  6123             20  CF-RATE-CODE               PIC X(5).
  6124             20  CF-SEX-RATING              PIC X.
  6125                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6126                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6127             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6128             20  CF-SUB-STD-TYPE            PIC X.
  6129                 88  CF-PCT-OF-PREM            VALUE '1'.
  6130                 88  CF-PCT-OF-BENE            VALUE '2'.
  6131         16  CF-PLAN-PREM-TOLERANCES.
  6132             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6133             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6134         16  CF-PLAN-PYMT-TOLERANCES.
  6135             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6136             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6137         16  CF-PLAN-MISC-DATA.
  6138             20  FILLER                     PIC X.
  6139             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6140             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6141         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6142         16  CF-PLAN-IND-GRP                PIC X.
  6143             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6144                                                     '1'.
  6145             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6146                                                     '2'.
  6147         16  CF-MIB-SEARCH-SW               PIC X.
  6148             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6149             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6150             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6151             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6152         16  CF-ALPHA-SEARCH-SW             PIC X.
  6153             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6154             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6155             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6156             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6157             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6158             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6159             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6160             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6161             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6162             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6163                                                     'A' 'B' 'C'
  6164                                                     'X' 'Y' 'Z'.
  6165         16  CF-EFF-DT-RULE-SW              PIC X.
  6166             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6167             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6168             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6169             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6170             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6171         16  FILLER                         PIC X(4).
  6172         16  CF-HEALTH-QUESTIONS            PIC X.
  6173             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6174         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6175         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6176         16  CF-PLAN-SNGL-JNT               PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 114
* EL050.cbl
  6177             88  CF-COMBINED-PLAN              VALUE 'C'.
  6178             88  CF-JNT-PLAN                   VALUE 'J'.
  6179             88  CF-SNGL-PLAN                  VALUE 'S'.
  6180         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6181         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6182         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6183         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6184         16  CF-RERATE-CNTL                 PIC  X.
  6185             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6186             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6187             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6188             88  CF-AUTO-RECALC                 VALUE '4'.
  6189         16  CF-BENEFIT-TYPE                PIC  X.
  6190             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6191             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6192         16  CF-POLICY-FEE                  PIC S999V99
  6193                                                    COMP-3.
  6194         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6195         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6196         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6197         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6198         16  FILLER                         PIC  X(32).
  6199         16  CF-TERMINATION-FORM            PIC  X(04).
  6200         16  FILLER                         PIC  X(08).
  6201         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6202                                                       COMP-3.
  6203         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6204         16  CF-ISSUE-LETTER                PIC  X(4).
  6205         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6206         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6207             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6208             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6209         16  CF-MP-REFUND-CALC              PIC X.
  6210             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6211             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6212             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6213             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6214             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6215             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6216             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6217             88  CF-MP-REFD-MEAN                VALUE '8'.
  6218         16  CF-ALT-RATE-CODE               PIC  X(5).
  6219
  6220
  6221         16  FILLER                         PIC X(498).
  6222****************************************************************
  6223*             MORTGAGE COMPANY MASTER RECORD                   *
  6224****************************************************************
  6225
  6226     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6227         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6228         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6229             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6230             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6231             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6232             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6233             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6234
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 115
* EL050.cbl
  6235         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6236         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6237         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6238         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6239         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6240
  6241         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6242             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6243         16  CF-MP-RECON-USE-IND            PIC X(1).
  6244             88  CF-MP-USE-RECON             VALUE 'Y'.
  6245         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6246             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6247         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6248             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6249             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6250         16  FILLER                         PIC X(1).
  6251         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6252             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6253         16  CF-MORTG-MIB-VERSION           PIC X.
  6254             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6255             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6256             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6257         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6258             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6259                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6260             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6261                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6262             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6263                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6264             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6265                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6266             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6267                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6268             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6269                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6270         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6271         16  FILLER                         PIC X(7).
  6272         16  CF-MORTG-DESTINATION-SYMBOL.
  6273             20  CF-MORTG-MIB-COMM          PIC X(5).
  6274             20  CF-MORTG-MIB-TERM          PIC X(5).
  6275         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6276             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6277         16  FILLER                         PIC X(03).
  6278         16  CF-MP-CHECK-NO-CONTROL.
  6279             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6280                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6281                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6282                                                ' ' LOW-VALUES.
  6283                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6284                                               VALUE '3'.
  6285         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6286         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6287         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6288             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6289                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6290             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6291                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6292             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 116
* EL050.cbl
  6293                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6294             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6295                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6296             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6297                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6298             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6299                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6300         16  CF-MORTG-BILLING-AREA.
  6301             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6302                                            PIC X.
  6303         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6304         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6305         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6306         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6307             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6308             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6309         16  FILLER                         PIC X.
  6310         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6311             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6312             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6313         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6314         16  FILLER                         PIC X(8).
  6315         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6316         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6317         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6318         16  CF-ACH-COMPANY-ID.
  6319             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6320                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6321                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6322                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6323             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6324         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6325             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6326         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6327             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6328             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6329         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6330         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6331         16  FILLER                         PIC X(536).
  6332
  6333****************************************************************
  6334*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6335****************************************************************
  6336
  6337     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6338         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6339             20  CF-FEMALE-HEIGHT.
  6340                 24  CF-FEMALE-FT           PIC 99.
  6341                 24  CF-FEMALE-IN           PIC 99.
  6342             20  CF-FEMALE-MIN-WT           PIC 999.
  6343             20  CF-FEMALE-MAX-WT           PIC 999.
  6344         16  FILLER                         PIC X(428).
  6345
  6346     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6347         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6348             20  CF-MALE-HEIGHT.
  6349                 24  CF-MALE-FT             PIC 99.
  6350                 24  CF-MALE-IN             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 117
* EL050.cbl
  6351             20  CF-MALE-MIN-WT             PIC 999.
  6352             20  CF-MALE-MAX-WT             PIC 999.
  6353         16  FILLER                         PIC X(428).
  6354******************************************************************
  6355*             AUTOMATIC ACTIVITY RECORD                          *
  6356******************************************************************
  6357     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6358         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6359             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6360             20  CF-SYS-LETTER-ID           PIC X(04).
  6361             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6362             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6363             20  CF-SYS-RESET-SW            PIC X(01).
  6364             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6365             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6366
  6367         16  FILLER                         PIC X(50).
  6368
  6369         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6370             20  CF-USER-ACTIVE-SW          PIC X(01).
  6371             20  CF-USER-LETTER-ID          PIC X(04).
  6372             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6373             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6374             20  CF-USER-RESET-SW           PIC X(01).
  6375             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6376             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6377             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6378
  6379         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 118
* EL050.cbl
  6381*    COPY ERCACCT.
  6382******************************************************************
  6383*                                                                *
  6384*                                                                *
  6385*                            ERCACCT                             *
  6386*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6387*                            VMOD=2.031                          *
  6388*                                                                *
  6389*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6390*                                                                *
  6391*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6392*   VSAM ACCOUNT MASTER FILES.                                   *
  6393*                                                                *
  6394*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6395*                                                                *
  6396*   FILE TYPE = VSAM,KSDS                                        *
  6397*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6398*                                                                *
  6399*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6400*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6401*                                                                *
  6402*   LOG = NO                                                     *
  6403*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6404*                                                                *
  6405*                                                                *
  6406******************************************************************
  6407*                   C H A N G E   L O G
  6408*
  6409* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6410*-----------------------------------------------------------------
  6411*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6412* EFFECTIVE    NUMBER
  6413*-----------------------------------------------------------------
  6414* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6415* 092705    2005050300006  PEMA  ADD SPP LEASES
  6416* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6417* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6418* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6419* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6420* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6421******************************************************************
  6422
  6423 01  ACCOUNT-MASTER.
  6424     12  AM-RECORD-ID                      PIC XX.
  6425         88  VALID-AM-ID                      VALUE 'AM'.
  6426
  6427     12  AM-CONTROL-PRIMARY.
  6428         16  AM-COMPANY-CD                 PIC X.
  6429         16  AM-MSTR-CNTRL.
  6430             20  AM-CONTROL-A.
  6431                 24  AM-CARRIER            PIC X.
  6432                 24  AM-GROUPING.
  6433                     28 AM-GROUPING-PREFIX PIC XXX.
  6434                     28 AM-GROUPING-PRIME  PIC XXX.
  6435                 24  AM-STATE              PIC XX.
  6436                 24  AM-ACCOUNT.
  6437                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6438                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 119
* EL050.cbl
  6439             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6440                                           PIC X(19).
  6441             20  AM-CNTRL-B.
  6442                 24  AM-EXPIRATION-DT      PIC XX.
  6443                 24  FILLER                PIC X(4).
  6444             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6445                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6446
  6447     12  AM-CONTROL-BY-VAR-GRP.
  6448         16  AM-COMPANY-CD-A1              PIC X.
  6449         16  AM-VG-CARRIER                 PIC X.
  6450         16  AM-VG-GROUPING                PIC X(6).
  6451         16  AM-VG-STATE                   PIC XX.
  6452         16  AM-VG-ACCOUNT                 PIC X(10).
  6453         16  AM-VG-DATE.
  6454             20  AM-VG-EXPIRATION-DT       PIC XX.
  6455             20  FILLER                    PIC X(4).
  6456         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6457                                           PIC 9(11)      COMP-3.
  6458     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6459         16  FILLER                        PIC X(10).
  6460         16  AM-VG-KEY3.
  6461             20  AM-VG3-ACCOUNT            PIC X(10).
  6462             20  AM-VG3-EXP-DT             PIC XX.
  6463         16  FILLER                        PIC X(4).
  6464     12  AM-MAINT-INFORMATION.
  6465         16  AM-LAST-MAINT-DT              PIC XX.
  6466         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6467         16  AM-LAST-MAINT-USER            PIC X(4).
  6468         16  FILLER                        PIC XX.
  6469
  6470     12  AM-EFFECTIVE-DT                   PIC XX.
  6471     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6472
  6473     12  AM-PREV-DATES  COMP-3.
  6474         16  AM-PREV-EXP-DT                PIC 9(11).
  6475         16  AM-PREV-EFF-DT                PIC 9(11).
  6476
  6477     12  AM-REPORT-CODE-1                  PIC X(10).
  6478     12  AM-REPORT-CODE-2                  PIC X(10).
  6479
  6480     12  AM-CITY-CODE                      PIC X(4).
  6481     12  AM-COUNTY-PARISH                  PIC X(6).
  6482
  6483     12  AM-NAME                           PIC X(30).
  6484     12  AM-PERSON                         PIC X(30).
  6485     12  AM-ADDRS                          PIC X(30).
  6486     12  AM-CITY.
  6487         16  AM-ADDR-CITY                  PIC X(28).
  6488         16  AM-ADDR-STATE                 PIC XX.
  6489     12  AM-ZIP.
  6490         16  AM-ZIP-PRIME.
  6491             20  AM-ZIP-PRI-1ST            PIC X.
  6492                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6493             20  FILLER                    PIC X(4).
  6494         16  AM-ZIP-PLUS4                  PIC X(4).
  6495     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6496         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 120
* EL050.cbl
  6497         16  AM-CAN-POSTAL-2               PIC XXX.
  6498         16  FILLER                        PIC XXX.
  6499     12  AM-TEL-NO.
  6500         16  AM-AREA-CODE                  PIC 999.
  6501         16  AM-TEL-PRE                    PIC 999.
  6502         16  AM-TEL-NBR                    PIC 9(4).
  6503     12  AM-TEL-LOC                        PIC X.
  6504         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6505         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6506
  6507     12  AM-COMM-STRUCTURE.
  6508         16  AM-DEFN-1.
  6509             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6510                 24  AM-AGT.
  6511                     28  AM-AGT-PREFIX     PIC X(4).
  6512                     28  AM-AGT-PRIME      PIC X(6).
  6513                 24  AM-COM-TYP            PIC X.
  6514                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6515                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6516                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6517                 24  AM-RECALC-LV-INDIC    PIC X.
  6518                 24  AM-RETRO-LV-INDIC     PIC X.
  6519                 24  AM-GL-CODES           PIC X.
  6520                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6521                 24  FILLER                PIC X(01).
  6522         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6523             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6524                 24  FILLER                PIC X(11).
  6525                 24  AM-L-COMA             PIC XXX.
  6526                 24  AM-J-COMA             PIC XXX.
  6527                 24  AM-A-COMA             PIC XXX.
  6528                 24  FILLER                PIC X(6).
  6529
  6530     12  AM-COMM-CHANGE-STATUS             PIC X.
  6531         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6532
  6533     12  AM-CSR-CODE                       PIC X(4).
  6534
  6535     12  AM-BILLING-STATUS                 PIC X.
  6536         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6537         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6538     12  AM-AUTO-REFUND-SW                 PIC X.
  6539         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6540         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6541     12  AM-GPCD                           PIC 99.
  6542     12  AM-IG                             PIC X.
  6543         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6544         88  AM-HAS-GROUP                     VALUE '2'.
  6545     12  AM-STATUS                         PIC X.
  6546         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6547         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6548         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6549         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6550         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6551         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6552     12  AM-REMIT-TO                       PIC 99.
  6553     12  AM-ID-NO                          PIC X(11).
  6554
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 121
* EL050.cbl
  6555     12  AM-CAL-TABLE                      PIC XX.
  6556     12  AM-LF-DEVIATION                   PIC XXX.
  6557     12  AM-AH-DEVIATION                   PIC XXX.
  6558     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6559     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6560     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6561     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6562     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6563     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6564
  6565     12  AM-USER-FIELDS.
  6566         16  AM-FLD-1                      PIC XX.
  6567         16  AM-FLD-2                      PIC XX.
  6568         16  AM-FLD-3                      PIC XX.
  6569         16  AM-FLD-4                      PIC XX.
  6570         16  AM-FLD-5                      PIC XX.
  6571
  6572     12  AM-1ST-PROD-DATE.
  6573         16  AM-1ST-PROD-YR                PIC XX.
  6574         16  AM-1ST-PROD-MO                PIC XX.
  6575         16  AM-1ST-PROD-DA                PIC XX.
  6576     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6577     12  AM-CERTS-PURGED-DATE.
  6578         16  AM-PUR-YR                     PIC XX.
  6579         16  AM-PUR-MO                     PIC XX.
  6580         16  AM-PUR-DA                     PIC XX.
  6581     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6582     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6583     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6584     12  AM-INACTIVE-DATE.
  6585         16  AM-INA-MO                     PIC 99.
  6586         16  AM-INA-DA                     PIC 99.
  6587         16  AM-INA-YR                     PIC 99.
  6588     12  AM-AR-HI-CERT-DATE                PIC XX.
  6589
  6590     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6591     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6592
  6593     12  AM-OB-PAYMENT-MODE                PIC X.
  6594         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6595         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6596         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6597         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6598
  6599     12  AM-AH-ONLY-INDICATOR              PIC X.
  6600         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6601         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6602
  6603     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6604
  6605     12  AM-OVER-SHORT.
  6606         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6607         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6608
  6609     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6610     12  AM-DCC-CLP-STATE                  PIC XX.
  6611
  6612     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 122
* EL050.cbl
  6613     12  AM-RECALC-REIN                    PIC X.
  6614
  6615     12  AM-REI-TABLE                      PIC XXX.
  6616     12  AM-REI-ET-LF                      PIC X.
  6617     12  AM-REI-ET-AH                      PIC X.
  6618     12  AM-REI-PE-LF                      PIC X.
  6619     12  AM-REI-PE-AH                      PIC X.
  6620     12  AM-REI-PRT-ST                     PIC X.
  6621     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6622     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6623     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6624     12  AM-REI-GROUP-A                    PIC X(6).
  6625     12  AM-REI-MORT                       PIC X(4).
  6626     12  AM-REI-PRT-OW                     PIC X.
  6627     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6628     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6629     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6630     12  AM-REI-GROUP-B                    PIC X(6).
  6631
  6632     12  AM-TRUST-TYPE                     PIC X(2).
  6633
  6634     12  AM-EMPLOYER-STMT-USED             PIC X.
  6635     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6636
  6637     12  AM-STD-AH-TYPE                    PIC XX.
  6638     12  AM-EARN-METHODS.
  6639         16  AM-EARN-METHOD-R              PIC X.
  6640             88 AM-REF-RL-R78                 VALUE 'R'.
  6641             88 AM-REF-RL-PR                  VALUE 'P'.
  6642             88 AM-REF-RL-MEAN                VALUE 'M'.
  6643             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6644         16  AM-EARN-METHOD-L              PIC X.
  6645             88 AM-REF-LL-R78                 VALUE 'R'.
  6646             88 AM-REF-LL-PR                  VALUE 'P'.
  6647             88 AM-REF-LL-MEAN                VALUE 'M'.
  6648             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6649         16  AM-EARN-METHOD-A              PIC X.
  6650             88 AM-REF-AH-R78                 VALUE 'R'.
  6651             88 AM-REF-AH-PR                  VALUE 'P'.
  6652             88 AM-REF-AH-MEAN                VALUE 'M'.
  6653             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6654             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6655             88 AM-REF-AH-NET                 VALUE 'N'.
  6656
  6657     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6658     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6659     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6660
  6661     12  AM-RET-Y-N                        PIC X.
  6662     12  AM-RET-P-E                        PIC X.
  6663     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6664     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6665     12  AM-RET-GRP                        PIC X(6).
  6666     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6667         16  AM-POOL-PRIME                 PIC XXX.
  6668         16  AM-POOL-SUB                   PIC XXX.
  6669     12  AM-RETRO-EARNINGS.
  6670         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 123
* EL050.cbl
  6671         16  AM-RET-EARN-L                 PIC X.
  6672         16  AM-RET-EARN-A                 PIC X.
  6673     12  AM-RET-ST-TAX-USE                 PIC X.
  6674         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6675         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6676     12  AM-RETRO-BEG-EARNINGS.
  6677         16  AM-RET-BEG-EARN-R             PIC X.
  6678         16  AM-RET-BEG-EARN-L             PIC X.
  6679         16  AM-RET-BEG-EARN-A             PIC X.
  6680     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6681     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6682
  6683     12  AM-USER-SELECT-OPTIONS.
  6684         16  AM-USER-SELECT-1              PIC X(10).
  6685         16  AM-USER-SELECT-2              PIC X(10).
  6686         16  AM-USER-SELECT-3              PIC X(10).
  6687         16  AM-USER-SELECT-4              PIC X(10).
  6688         16  AM-USER-SELECT-5              PIC X(10).
  6689
  6690     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6691
  6692     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6693
  6694     12  AM-RPT045A-SWITCH                 PIC X.
  6695         88  RPT045A-OFF                   VALUE 'N'.
  6696
  6697     12  AM-INSURANCE-LIMITS.
  6698         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6699         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6700
  6701     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6702         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6703
  6704     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6705         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6706         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6707
  6708     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6709
  6710     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6711     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6712     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6713     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6714     12  AM-DCC-UEF-STATE                  PIC XX.
  6715     12  FILLER                            PIC XXX.
  6716     12  AM-REPORT-CODE-3                  PIC X(10).
  6717*    12  FILLER                            PIC X(22).
  6718
  6719     12  AM-RESERVE-DATE.
  6720         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6721         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6722         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6723
  6724     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6725     12  AM-NOTIFICATION-TYPES.
  6726         16  AM-NOTIF-OF-LETTERS           PIC X.
  6727         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6728         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 124
* EL050.cbl
  6729         16  AM-NOTIF-OF-STATUS            PIC X.
  6730
  6731     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6732         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6733         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6734         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6735         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6736
  6737     12  AM-BENEFIT-CONTROLS.
  6738         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6739             20  AM-BENEFIT-CODE           PIC XX.
  6740             20  AM-BENEFIT-TYPE           PIC X.
  6741             20  AM-BENEFIT-REVISION       PIC XXX.
  6742             20  AM-BENEFIT-REM-TERM       PIC X.
  6743             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6744             20  FILLER                    PIC XX.
  6745         16  FILLER                        PIC X(80).
  6746
  6747     12  AM-TRANSFER-DATA.
  6748         16  AM-TRANSFERRED-FROM.
  6749             20  AM-TRNFROM-CARRIER        PIC X.
  6750             20  AM-TRNFROM-GROUPING.
  6751                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6752                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6753             20  AM-TRNFROM-STATE          PIC XX.
  6754             20  AM-TRNFROM-ACCOUNT.
  6755                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6756                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6757             20  AM-TRNFROM-DTE            PIC XX.
  6758         16  AM-TRANSFERRED-TO.
  6759             20  AM-TRNTO-CARRIER          PIC X.
  6760             20  AM-TRNTO-GROUPING.
  6761                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6762                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6763             20  AM-TRNTO-STATE            PIC XX.
  6764             20  AM-TRNTO-ACCOUNT.
  6765                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6766                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6767             20  AM-TRNTO-DTE              PIC XX.
  6768         16  FILLER                        PIC X(10).
  6769
  6770     12  AM-SAVED-REMIT-TO                 PIC 99.
  6771
  6772     12  AM-COMM-STRUCTURE-SAVED.
  6773         16  AM-DEFN-1-SAVED.
  6774             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6775                 24  AM-AGT-SV             PIC X(10).
  6776                 24  AM-COM-TYP-SV         PIC X.
  6777                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6778                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6779                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6780                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6781                 24  FILLER                PIC X.
  6782                 24  AM-GL-CODES-SV        PIC X.
  6783                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6784                 24  FILLER                PIC X.
  6785         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6786             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 125
* EL050.cbl
  6787                 24  FILLER                PIC X(11).
  6788                 24  AM-L-COMA-SV          PIC XXX.
  6789                 24  AM-J-COMA-SV          PIC XXX.
  6790                 24  AM-A-COMA-SV          PIC XXX.
  6791                 24  FILLER                PIC X(6).
  6792
  6793     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6794         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6795            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6796            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6797            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6798
  6799     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6800     12  FILLER                            PIC X(120).
  6801
  6802     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6803         16  AM-CONTROL-NAME               PIC X(30).
  6804         16  AM-EXECUTIVE-ONE.
  6805             20  AM-EXEC1-NAME             PIC X(15).
  6806             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6807                                                          COMP-3.
  6808             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6809                                                          COMP-3.
  6810         16  AM-EXECUTIVE-TWO.
  6811             20  AM-EXEC2-NAME             PIC X(15).
  6812             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6813                                                          COMP-3.
  6814             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6815                                                          COMP-3.
  6816
  6817     12  AM-RETRO-ADDITIONAL-DATA.
  6818         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6819         16  AM-RETRO-PREM-P-E             PIC X.
  6820         16  AM-RETRO-CLMS-P-I             PIC X.
  6821         16  AM-RETRO-RET-BRACKET-LF.
  6822             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6823                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6824                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6825             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6826                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6827                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6828             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6829                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6830                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6831         16  AM-RETRO-RET-BRACKET-AH.
  6832             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6833                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6834                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6835                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6836             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6837                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6838                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6839             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6840                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6841                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6842
  6843     12  AM-COMMENTS.
  6844         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 126
* EL050.cbl
  6845
  6846     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6847         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6848         16  AM-FLI-BILLING-CODE           PIC X.
  6849         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6850         16  AM-FLI-UNITED-IDENT           PIC X.
  6851         16  AM-FLI-INTEREST-LOST-DATA.
  6852             20  AM-FLI-BANK-NO            PIC X(5).
  6853             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6854             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6855             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6856         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6857             20  AM-FLI-AGT                PIC X(9).
  6858             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6859             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6860         16  FILLER                        PIC X(102).
  6861
  6862     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6863         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6864             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6865             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6866             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6867             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6868             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6869         16  FILLER                          PIC X(10).
  6870******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 127
* EL050.cbl
  6872*    COPY ERCREIN.
  6873******************************************************************
  6874*                                                                *
  6875*                            ERCREIN                             *
  6876*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6877*                            VMOD=2.010                          *
  6878*                                                                *
  6879*   ONLINE CREDIT SYSTEM                                         *
  6880*                                                                *
  6881*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6882*                                                                *
  6883*   FILE TYPE = VSAM,KSDS                                        *
  6884*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6885*                                                                *
  6886*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6887*       ALTERNATE PATH = NONE                                    *
  6888*                                                                *
  6889*   LOG = NO                                                     *
  6890*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6891*                                                                *
  6892******************************************************************
  6893*                   C H A N G E   L O G
  6894*
  6895* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6896*-----------------------------------------------------------------
  6897*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6898* EFFECTIVE    NUMBER
  6899*-----------------------------------------------------------------
  6900* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6901* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6902******************************************************************
  6903 01  REINSURANCE-RECORD.
  6904     12  RE-RECORD-ID                      PIC XX.
  6905         88  VALID-RE-ID                      VALUE 'RE'.
  6906
  6907     12  RE-CONTROL-PRIMARY.
  6908         16  RE-COMPANY-CD                 PIC X.
  6909         16  RE-KEY.
  6910             20  RE-CODE                   PIC X.
  6911                 88  RE-TABLE-RECORD          VALUE 'A'.
  6912                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6913             20  RE-TABLE                  PIC XXX.
  6914             20  FILLER                    PIC XXX.
  6915         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6916             20  FILLER                    PIC X.
  6917             20  RE-COMPANY.
  6918                 24  RE-COMP-PRIME         PIC XXX.
  6919                 24  RE-COMP-SUB           PIC XXX.
  6920
  6921     12  RE-MAINT-INFORMATION.
  6922         16  RE-LAST-MAINT-DT              PIC XX.
  6923         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6924         16  RE-LAST-MAINT-USER            PIC X(4).
  6925         16  FILLER                        PIC X(10).
  6926
  6927     12  RE-TABLE-DATA.
  6928         16  RE-100-COMP                   PIC 99.
  6929
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 128
* EL050.cbl
  6930         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6931             20  RE-REI-COMP-NO.
  6932                 24  RE-REI-COMP           PIC XXX.
  6933                 24  RE-REI-COMP-SUB       PIC XXX.
  6934             20  RE-LF-QC                  PIC X.
  6935             20  RE-AH-QC                  PIC X.
  6936             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6937             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6938             20  RE-LFAGE-LO               PIC 99.
  6939             20  RE-LFAGE-HI               PIC 99.
  6940             20  RE-AHAGE-LO               PIC 99.
  6941             20  RE-AHAGE-HI               PIC 99.
  6942             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6943             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6944             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6945             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6946             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6947             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6948             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6949             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6950             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6951             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6952             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6953             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6954             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6955             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6956             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6957             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6958             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6959             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6960             20  RE-LF-BEN-CODE            PIC X.
  6961             20  RE-AH-BEN-CODE            PIC X.
  6962             20  RE-INTERACTIVE            PIC X.
  6963             20  RE-REMAINING              PIC X.
  6964             20  RE-LF-RUNOFF-SW           PIC X.
  6965             20  RE-AH-RUNOFF-SW           PIC X.
  6966             20  FILLER                    PIC X(19).
  6967
  6968         16  RE-COMP-INFO-END              PIC X(6).
  6969         16  RE-NSP-ST-CD-LF               PIC XX.
  6970         16  RE-NSP-ST-CD-AH               PIC XX.
  6971         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6972             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6973
  6974         16  FILLER                        PIC X(27).
  6975
  6976     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6977         16  RE-NAME                       PIC X(30).
  6978         16  RE-LF-PE                      PIC X.
  6979         16  RE-AH-PE                      PIC X.
  6980         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6981         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6982         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6983         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6984         16  RE-PRT-ST                     PIC X.
  6985         16  RE-PRT-OW                     PIC X.
  6986         16  RE-MORT-CODE                  PIC X(4).
  6987         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 129
* EL050.cbl
  6988         16  RE-ZERO-LF-FEE                PIC X.
  6989         16  RE-ZERO-AH-FEE                PIC X.
  6990         16  RE-CEDE-NAME                  PIC X(30).
  6991         16  RE-LF-COMM                    PIC X.
  6992         16  RE-AH-COMM                    PIC X.
  6993         16  RE-LF-TAX                     PIC X.
  6994         16  RE-AH-TAX                     PIC X.
  6995         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6996         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6997         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6998
  6999         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7000             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7001
  7002         16  RE-LF-CEDING-FEE-BRACKETS.
  7003             20  RE-LF-FEE-METHOD          PIC X.
  7004                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7005                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7006                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7007                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7008             20  RE-LF-FEE-BASIS           PIC X.
  7009                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7010                 88  RE-LF-NET-CEDED               VALUE '2'.
  7011                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7012                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7013                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7014                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7015                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7016                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7017             20  FILLER                    PIC XXX.
  7018             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7019                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7020                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7021
  7022         16  RE-AH-CEDING-FEE-BRACKETS.
  7023             20  RE-AH-FEE-METHOD          PIC X.
  7024                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7025                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7026                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7027                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7028             20  RE-AH-FEE-BASIS           PIC X.
  7029                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7030                 88  RE-AH-NET-CEDED               VALUE '2'.
  7031                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7032                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7033                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7034                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7035                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7036                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7037             20  FILLER                    PIC XXX.
  7038             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7039                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7040                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7041
  7042         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7043
  7044         16  RE-OLD-CEDING-STMT            PIC X.
  7045
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 130
* EL050.cbl
  7046         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7047         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7048         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7049         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7050         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7051         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7052         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7053         16  RE-MORT-SW                    PIC X.
  7054         16  RE-CEDING-TYPE-FLAG           PIC X.
  7055             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7056             88  RE-CEDED                          VALUE 'C'.
  7057             88  RE-ASSUMED                        VALUE 'A'.
  7058             88  RE-PHANTOM                        VALUE 'P'.
  7059
  7060         16  RE-CEDING-STMT-OPT-A          PIC X.
  7061             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7062         16  RE-CEDING-STMT-OPT-B          PIC X.
  7063             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7064         16  RE-CEDING-STMT-OPT-C          PIC X.
  7065             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7066         16  RE-CEDING-STMT-OPT-D          PIC X.
  7067             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7068         16  RE-CEDING-STMT-OPT-E          PIC X.
  7069             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7070
  7071         16  RE-PRT-CRSV                   PIC X.
  7072
  7073         16  RE-GL-CENTER                  PIC X(4).
  7074
  7075         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7076
  7077         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7078
  7079         16  RE-EARN-STOP-CODE             PIC X.
  7080             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7081             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7082
  7083         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7084             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7085
  7086         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7087         16  FILLER                        PIC X(2281).
  7088
  7089         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7090
  7091******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 131
* EL050.cbl
  7093*    COPY ERCCTBL.
  7094******************************************************************
  7095*                                                                *
  7096*                                                                *
  7097*                            ERCCTBL                             *
  7098*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7099*                            VMOD=2.003
  7100*                                                                *
  7101*   ONLINE CREDIT SYSTEM                                         *
  7102*                                                                *
  7103*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7104*                                                                *
  7105*   FILE TYPE = VSAM,KSDS                                        *
  7106*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7107*                                                                *
  7108*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7109*       ALTERNATE PATH = NONE                                    *
  7110*                                                                *
  7111*   LOG = NO                                                     *
  7112*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7113*                                                                *
  7114*                                                                *
  7115******************************************************************
  7116
  7117 01  COMM-TABLE-RECORD.
  7118     12  CT-RECORD-ID                      PIC XX.
  7119         88  VALID-CT-ID                      VALUE 'CT'.
  7120
  7121     12  CT-CONTROL-PRIMARY.
  7122         16  CT-COMPANY-CD                 PIC X.
  7123         16  CT-TABLE                      PIC XXX.
  7124         16  CT-CNTRL-2.
  7125             20  CT-BEN-TYPE               PIC X.
  7126             20  CT-BEN-CODE               PIC XX.
  7127
  7128     12  CT-MAINT-INFORMATION.
  7129         16  CT-LAST-MAINT-DT              PIC XX.
  7130         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7131         16  CT-LAST-MAINT-USER            PIC X(4).
  7132         16  FILLER                        PIC X(31).
  7133
  7134     12  CT-LIMITS.
  7135         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7136
  7137         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7138
  7139         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7140
  7141     12  CT-RATES.
  7142         16  CT-RTX          OCCURS 27 TIMES.
  7143             20  CT-RT                     PIC SV9(5)     COMP-3.
  7144             20  CT-RT-R   REDEFINES
  7145                 CT-RT                     PIC XXX.
  7146
  7147     12  FILLER                            PIC  X(42).
  7148
  7149******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 132
* EL050.cbl
  7151*    COPY ERCFORM.
  7152******************************************************************
  7153*                                                                *
  7154*                                                                *
  7155*                            ERCFORM.                            *
  7156*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7157*                            VMOD=2.003                          *
  7158*                                                                *
  7159*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7160*                                                                *
  7161*    FILE TYPE = VSAM,KSDS                                       *
  7162*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7163*                                                                *
  7164*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7165*                                                                *
  7166*    LOG = YES                                                   *
  7167*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7168******************************************************************
  7169 01  FORM-MASTER.
  7170    12  FO-RECORD-ID                 PIC X(02).
  7171        88  VALID-FO-ID                  VALUE 'FO'.
  7172
  7173    12  FO-CONTROL-PRIMARY.
  7174        16  FO-COMPANY-CD            PIC X(01).
  7175        16  FO-STATE                 PIC X(02).
  7176        16  FO-FORM-ID               PIC X(12).
  7177        16  FO-FORM-EXP-DT           PIC X(02).
  7178
  7179    12  FO-POLICY-FORM-DATA.
  7180        16  FO-IND-GRP-CD            PIC X(01).
  7181        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7182        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7183        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7184        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7185        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7186        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7187        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7188        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7189        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7190        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7191        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7192        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7193        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7194        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7195        16  FO-APP-CERT-USE-CD       PIC X(01).
  7196
  7197    12  FILLER                       PIC X(29).
  7198
  7199    12  FO-FORM-PLAN-TABLE.
  7200        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7201            20  FO-PLAN-TYPE         PIC X(01).
  7202            20  FO-PLAN-ID           PIC X(02).
  7203            20  FO-PLAN-TERM         PIC 9(03).
  7204            20  FO-PLAN-REFUND-METHOD
  7205                                     PIC X.
  7206
  7207    12  FILLER                       PIC X(30).
  7208
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 133
* EL050.cbl
  7209    12  FO-COMMENTS-AREA.
  7210        16  FO-COMMENT-LINE-1        PIC X(78).
  7211
  7212    12  FILLER                       PIC X(20).
  7213
  7214    12  FO-MAINT-INFORMATION.
  7215        16  FO-LAST-MAINT-DT         PIC X(02).
  7216        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7217        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 134
* EL050.cbl
  7219*    COPY ELCMSTR.
  7220******************************************************************
  7221*                                                                *
  7222*                            ELCMSTR.                            *
  7223*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7224*                            VMOD=2.012                          *
  7225*                                                                *
  7226*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7227*                                                                *
  7228*   FILE TYPE = VSAM,KSDS                                        *
  7229*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7230*                                                                *
  7231*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7232*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7233*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7234*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7235*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7236*                                                 RKP=75,LEN=21  *
  7237*                                                                *
  7238*   **** NOTE ****                                               *
  7239*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7240*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7241*                                                                *
  7242*   LOG = YES                                                    *
  7243*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7244******************************************************************
  7245*                   C H A N G E   L O G
  7246*
  7247* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7248*-----------------------------------------------------------------
  7249*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7250* EFFECTIVE    NUMBER
  7251*-----------------------------------------------------------------
  7252* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7253* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7254******************************************************************
  7255 01  CLAIM-MASTER.
  7256     12  CL-RECORD-ID                PIC XX.
  7257         88  VALID-CL-ID         VALUE 'CL'.
  7258
  7259     12  CL-CONTROL-PRIMARY.
  7260         16  CL-COMPANY-CD           PIC X.
  7261         16  CL-CARRIER              PIC X.
  7262         16  CL-CLAIM-NO             PIC X(7).
  7263         16  CL-CERT-NO.
  7264             20  CL-CERT-PRIME       PIC X(10).
  7265             20  CL-CERT-SFX         PIC X.
  7266
  7267     12  CL-CONTROL-BY-NAME.
  7268         16  CL-COMPANY-CD-A1        PIC X.
  7269         16  CL-INSURED-LAST-NAME    PIC X(15).
  7270         16  CL-INSURED-NAME.
  7271             20  CL-INSURED-1ST-NAME PIC X(12).
  7272             20  CL-INSURED-MID-INIT PIC X.
  7273
  7274     12  CL-CONTROL-BY-SSN.
  7275         16  CL-COMPANY-CD-A2        PIC X.
  7276         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 135
* EL050.cbl
  7277             20  CL-SSN-STATE        PIC XX.
  7278             20  CL-SSN-ACCOUNT      PIC X(6).
  7279             20  CL-SSN-LN3          PIC X(3).
  7280
  7281     12  CL-CONTROL-BY-CERT-NO.
  7282         16  CL-COMPANY-CD-A4        PIC X.
  7283         16  CL-CERT-NO-A4.
  7284             20  CL-CERT-A4-PRIME    PIC X(10).
  7285             20  CL-CERT-A4-SFX      PIC X.
  7286
  7287     12  CL-CONTROL-BY-CCN.
  7288         16  CL-COMPANY-CD-A5        PIC X.
  7289         16  CL-CCN-A5.
  7290             20  CL-CCN.
  7291                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7292                 24  CL-CCN-PRIME-A5 PIC X(12).
  7293             20  CL-CCN-FILLER-A5    PIC X(4).
  7294
  7295     12  CL-INSURED-PROFILE-DATA.
  7296         16  CL-INSURED-BIRTH-DT     PIC XX.
  7297         16  CL-INSURED-SEX-CD       PIC X.
  7298             88  INSURED-IS-MALE        VALUE 'M'.
  7299             88  INSURED-IS-FEMALE      VALUE 'F'.
  7300             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7301         16  CL-INSURED-OCC-CD       PIC X(6).
  7302         16  FILLER                  PIC X(5).
  7303
  7304     12  CL-PROCESSING-INFO.
  7305         16  CL-PROCESSOR-ID         PIC X(4).
  7306         16  CL-CLAIM-STATUS         PIC X.
  7307             88  CLAIM-IS-OPEN          VALUE 'O'.
  7308             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7309         16  CL-CLAIM-TYPE           PIC X.
  7310*            88  AH-CLAIM               VALUE 'A'.
  7311*            88  LIFE-CLAIM             VALUE 'L'.
  7312*            88  PROPERTY-CLAIM         VALUE 'P'.
  7313*            88  IUI-CLAIM              VALUE 'I'.
  7314*            88  GAP-CLAIM              VALUE 'G'.
  7315         16  CL-CLAIM-PREM-TYPE      PIC X.
  7316             88  SINGLE-PREMIUM         VALUE '1'.
  7317             88  O-B-COVERAGE           VALUE '2'.
  7318             88  OPEN-END-COVERAGE      VALUE '3'.
  7319         16  CL-INCURRED-DT          PIC XX.
  7320         16  CL-REPORTED-DT          PIC XX.
  7321         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7322         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7323         16  CL-LAST-PMT-DT          PIC XX.
  7324         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7325         16  CL-PAID-THRU-DT         PIC XX.
  7326         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7327         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7328         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7329         16  CL-PMT-CALC-METHOD      PIC X.
  7330             88  CL-360-DAY-YR          VALUE '1'.
  7331             88  CL-365-DAY-YR          VALUE '2'.
  7332             88  CL-FULL-MONTHS         VALUE '3'.
  7333         16  CL-CAUSE-CD             PIC X(6).
  7334
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 136
* EL050.cbl
  7335         16  CL-PRIME-CERT-NO.
  7336             20  CL-PRIME-CERT-PRIME PIC X(10).
  7337             20  CL-PRIME-CERT-SFX   PIC X.
  7338
  7339         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7340             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7341             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7342
  7343         16  CL-MICROFILM-NO         PIC X(10).
  7344         16  CL-PROG-FORM-TYPE       PIC X.
  7345         16  CL-LAST-ADD-ON-DT       PIC XX.
  7346
  7347         16  CL-LAST-REOPEN-DT       PIC XX.
  7348         16  CL-LAST-CLOSE-DT        PIC XX.
  7349         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7350             88  FINAL-PAID             VALUE '1'.
  7351             88  CLAIM-DENIED           VALUE '2'.
  7352             88  AUTO-CLOSE             VALUE '3'.
  7353             88  MANUAL-CLOSE           VALUE '4'.
  7354             88  BENEFITS-CHANGED       VALUE 'C'.
  7355             88  SETUP-ERRORS           VALUE 'E'.
  7356         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7357         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7358         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7359             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7360         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7361         16  FILLER                  PIC X.
  7362
  7363     12  CL-CERTIFICATE-DATA.
  7364         16  CL-CERT-ORIGIN          PIC X.
  7365             88  CERT-WAS-ONLINE        VALUE '1'.
  7366             88  CERT-WAS-CREATED       VALUE '2'.
  7367             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7368         16  CL-CERT-KEY-DATA.
  7369             20  CL-CERT-CARRIER     PIC X.
  7370             20  CL-CERT-GROUPING    PIC X(6).
  7371             20  CL-CERT-STATE       PIC XX.
  7372             20  CL-CERT-ACCOUNT.
  7373                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7374                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7375             20  CL-CERT-EFF-DT      PIC XX.
  7376
  7377     12  CL-STATUS-CONTROLS.
  7378         16  CL-PRIORITY-CD          PIC X.
  7379             88  CONFIDENTIAL-DATA      VALUE '8'.
  7380             88  HIGHEST-PRIORITY       VALUE '9'.
  7381         16  CL-SUPV-ATTN-CD         PIC X.
  7382             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7383             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7384         16  CL-PURGED-DT            PIC XX.
  7385         16  CL-RESTORED-DT          PIC XX.
  7386         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7387         16  CL-NEXT-RESEND-DT       PIC XX.
  7388         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7389         16  FILLER                  PIC XX.
  7390         16  CL-LAST-MAINT-DT        PIC XX.
  7391         16  CL-LAST-MAINT-USER      PIC X(4).
  7392         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 137
* EL050.cbl
  7393         16  CL-LAST-MAINT-TYPE      PIC X.
  7394             88  CLAIM-SET-UP           VALUE ' '.
  7395             88  PAYMENT-MADE           VALUE '1'.
  7396             88  LETTER-SENT            VALUE '2'.
  7397             88  MASTER-WAS-ALTERED     VALUE '3'.
  7398             88  MASTER-WAS-RESTORED    VALUE '4'.
  7399             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7400             88  FILE-CONVERTED         VALUE '6'.
  7401             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7402             88  ERROR-CORRECTION       VALUE 'E'.
  7403         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7404         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7405         16  CL-BENEFICIARY          PIC X(10).
  7406         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7407         16  CL-DENIAL-TYPE          PIC X.
  7408             88  CL-TYPE-DENIAL          VALUE '1'.
  7409             88  CL-TYPE-RESCISSION      VALUE '2'.
  7410             88  CL-TYPE-REFORMATION     VALUE '3'.
  7411             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7412             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7413         16  FILLER                  PIC X(5).
  7414
  7415     12  CL-TRAILER-CONTROLS.
  7416         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7417             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7418             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7419             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7420         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7421         16  FILLER                  PIC XX.
  7422         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7423         16  CL-ADDRESS-TRAILER-CNT.
  7424             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7425                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7426             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7427                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7428             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7429                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7430             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7431                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7432             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7433                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7434             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7435                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7436             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7437                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7438
  7439     12  CL-CV-REFERENCE-NO.
  7440         16  CL-CV-REFNO-PRIME       PIC X(18).
  7441         16  CL-CV-REFNO-SFX         PIC XX.
  7442
  7443     12  CL-FILE-LOCATION            PIC X(4).
  7444
  7445     12  CL-PROCESS-ERRORS.
  7446         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7447             88  NO-FATAL-ERRORS        VALUE ZERO.
  7448         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7449             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7450
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 138
* EL050.cbl
  7451     12  CL-PRODUCT-CD               PIC X.
  7452
  7453     12  CL-CURRENT-KEY-DATA.
  7454         16  CL-CURRENT-CARRIER      PIC X.
  7455         16  CL-CURRENT-GROUPING     PIC X(6).
  7456         16  CL-CURRENT-STATE        PIC XX.
  7457         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7458
  7459     12  CL-ASSOCIATES               PIC X.
  7460         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7461         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7462         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7463         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7464
  7465     12  CL-ACTIVITY-CODE            PIC 99.
  7466     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7467     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7468
  7469     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7470     12  CL-LAG-REPORT-CODE          PIC 9.
  7471     12  CL-LOAN-TYPE                PIC XX.
  7472     12  CL-LEGAL-STATE              PIC XX.
  7473
  7474*    12  FILLER                      PIC X(5).
  7475     12  CL-YESNOSW                  PIC X.
  7476     12  FILLER                      PIC X(4).
  7477
  7478 01  PLAN-RECORDS.
  7479     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7480     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7481
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 139
* EL050.cbl
  7483 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7484                          ACCOUNT-MASTER REINSURANCE-RECORD
  7485                          COMM-TABLE-RECORD FORM-MASTER
  7486                          CLAIM-MASTER PLAN-RECORDS.
  7487 0000-DFHEXIT SECTION.
  7488     MOVE '9#                    $   ' TO DFHEIV0.
  7489     MOVE 'EL050' TO DFHEIV1.
  7490     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7491
  7492     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7493
  7494
  7495* EXEC CICS  HANDLE CONDITION
  7496*           ERROR    (9300-ABEND)
  7497*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7498*    END-EXEC.
  7499*    MOVE '"$.J                  ! " #00007490' TO DFHEIV0
  7500     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7501     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7502     MOVE X'2220233030303037343930' TO DFHEIV0(25:11)
  7503     CALL 'kxdfhei1' USING DFHEIV0
  7504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7505
  7506
  7507 0000-COPY-PROCEDURE-DIV.
  7508*                          COPY ELC50PD.
  7509******************************************************************
  7510*                                                                *
  7511*                            ELC50PD                             *
  7512*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7513*                            VMOD=2.188                          *
  7514*                                                                *
  7515******************************************************************
  7516*                   C H A N G E   L O G
  7517*
  7518* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7519*-----------------------------------------------------------------
  7520*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7521* EFFECTIVE    NUMBER
  7522*-----------------------------------------------------------------
  7523* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7524* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7525* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7526*                             2709 AND 2718
  7527* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7528* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7529* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7530* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7531* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7532*                                IS OPEN OR CNC DT < PD THRU
  7533* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7534* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7535* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7536* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7537* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7538* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7539* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7540* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 140
* EL050.cbl
  7541* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7542* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7543* 020906                   PEMA  EXPAND LOAN OFFICER
  7544* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7545* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7546* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7547* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7548* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7549* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7550* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7551* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7552* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7553* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7554* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7555* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7556* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7557* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7558* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7559* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7560* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7561* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7562* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7563* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7564* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7565* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7566* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7567* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7568* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7569*                                UPDATE VIN ON CERT TRAILER
  7570* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7571* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7572* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7573* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7574* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7575* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7576* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7577* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7578* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7579* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7580* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7581* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7582* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7583* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7584* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7585* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7586* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7587* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7588* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7589* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7590* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7591* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7592* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7593* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7594* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7595* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7596* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7597* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7598* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 141
* EL050.cbl
  7599* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7600* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7601* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7602* 032912  CR2011110200001  PEMA  AHL CHANGES
  7603* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7604* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7605* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7606* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7607* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7608* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7609* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7610* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7611* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7612* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7613* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7614* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7615* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7616******************************************************************
  7617************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7618******************************************************************
  7619
  7620     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7621
  7622     MOVE SPACES                 TO PB-FATAL-FLAG
  7623                                    PB-FORCE-ER-CD
  7624                                    PB-WARN-ER-CD
  7625                                    PB-OUT-BAL-CD.
  7626
  7627     MOVE SPACE                  TO WS-IG-OVRD-AH
  7628                                    WS-IG-OVRD-LF
  7629                                    WS-IG-OVRD-AM
  7630                                    WS-IG-OVRD
  7631                                    WS-IG-OVRD-AH-PL
  7632                                    WS-IG-OVRD-LF-PL
  7633                                    WS-IG-OVRD-AH-BEN
  7634                                    WS-IG-OVRD-LF-BEN.
  7635
  7636******************************************************************
  7637*************       INITIALIZE COMMON ERRORS       ***************
  7638******************************************************************
  7639
  7640     MOVE +0                     TO PB-NO-OF-ERRORS.
  7641     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7642
  7643******************************************************************
  7644
  7645     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7646     SET JULIAN-TO-BIN           TO TRUE.
  7647*    MOVE 5                      TO DC-OPTION-CODE.
  7648     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7649     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7650
  7651     MOVE ZERO                   TO  SUB4.
  7652
  7653 0040-INITIALIZE-GA-BILL-DT.
  7654
  7655     ADD +1                      TO  SUB4.
  7656
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 142
* EL050.cbl
  7657     IF  SUB4 GREATER THAN +5
  7658         GO TO 0050-CHECK-CNTL-FOUND.
  7659
  7660     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7661         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7662
  7663     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7664
  7665 0050-CHECK-CNTL-FOUND.
  7666
  7667     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7668        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7669                                         WS-AH-REM-TERM-CALC
  7670                                         EC-CO-REM-TERM-CALC
  7671        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7672        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7673        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7674                                         WS-TOL-AH-CLAIM
  7675        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7676                                         WS-TOL-AH-PREM
  7677                                         EC-CO-TOL-PREM
  7678        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7679                                         WS-TOL-AH-REFUND
  7680                                         EC-CO-TOL-REFUND
  7681        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7682                                         WS-AH-REFUND-OVS-AMT
  7683                                         EC-CO-OVR-SHT-AMT
  7684        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7685                                         WS-TOL-AH-PREM-PCT
  7686                                         EC-CO-TOL-PREM-PCT
  7687        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7688                                         WS-TOL-AH-REFUND-PCT
  7689                                         EC-CO-TOL-REFUND-PCT
  7690        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7691                                         WS-AH-REFUND-OVS-PCT
  7692                                         EC-CO-OVR-SHT-PCT
  7693        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7694        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7695        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7696        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7697        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7698        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7699        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7700        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7701        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7702        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7703        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7704        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7705                                         EC-CO-MONTH-END-DT
  7706        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7707          GO TO 0100-READ-ACCT.
  7708
  7709     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7710     MOVE SPACES                 TO CNTL-ACCESS.
  7711     MOVE '1'                    TO CNTL-REC-TYPE.
  7712     MOVE +0                     TO CNTL-SEQ-NO.
  7713
  7714     MOVE '1' TO RC-SW-1.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 143
* EL050.cbl
  7715     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7716     IF NOT CF-COMPANY-MASTER
  7717         MOVE ZEROS             TO WK-CO-TOL-PREM
  7718                                   WK-CO-TOL-CLAIM
  7719                                   WK-CO-TOL-REFUND
  7720                                   WK-REFUND-OVS-AMT
  7721                                   WK-REFUND-OVS-PCT
  7722                                   WK-CO-TOL-PREM-PCT
  7723                                   WK-CO-TOL-REFUND-PCT
  7724                                   WK-DEFAULT-APR
  7725                                   WK-CO-MAX-CAP
  7726        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7727                                   WK-CR-R78-METHOD
  7728                                   WK-CO-REF-REJECT-SW
  7729                                   WK-CO-PREM-REJECT-SW
  7730                                   WK-REM-TRM-CALC-OPTION
  7731                                   WK-BIRTH-DATE-INPUT
  7732                                   WK-JOINT-AGE-INPUT
  7733        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7734        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7735        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7736        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7737          GO TO 0099-COMPANY-NOT-FOUND.
  7738
  7739     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7740        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7741     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7742        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7743     IF CF-CO-TOL-CAP NOT NUMERIC
  7744        MOVE +0                    TO CF-CO-TOL-CAP.
  7745     IF CF-DEFAULT-APR NOT NUMERIC
  7746        MOVE +0                    TO CF-DEFAULT-APR.
  7747
  7748     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7749     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7750     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7751     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7752     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7753     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7754     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7755     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7756     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7757     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7758     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7759     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7760
  7761     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7762          CF-CO-OVR-SHT-AMT > +0
  7763        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7764
  7765     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7766          CF-CO-OVR-SHT-PCT > +0
  7767        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7768
  7769     IF CF-VALID-REM-TRM-OPTION
  7770         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7771     ELSE
  7772         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 144
* EL050.cbl
  7773
  7774     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7775     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7776     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7777     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7778
  7779     GO TO 0050-CHECK-CNTL-FOUND.
  7780
  7781 0099-COMPANY-NOT-FOUND.
  7782
  7783     MOVE ER-2616                TO WS-ERROR.
  7784     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7785
  7786 0100-READ-ACCT.
  7787
  7788     MOVE SPACES                 TO DATE-RANGE-SW.
  7789
  7790     IF WK-ACCT-ADDR = ZEROS
  7791        GO TO 0102-ACCT-GETMAIN.
  7792
  7793     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7794     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7795     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7796
  7797     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7798        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7799        GO TO 0105-READ-ACCT
  7800     END-IF
  7801
  7802     IF PB-CARRIER NOT = SPACES
  7803        IF PB-CARRIER NOT = AM-VG-CARRIER
  7804           GO TO 0105-READ-ACCT.
  7805
  7806     IF PB-STATE NOT = SPACES
  7807        IF PB-STATE NOT = AM-VG-STATE
  7808           GO TO 0105-READ-ACCT.
  7809
  7810     IF PB-GROUPING NOT = SPACES
  7811        IF PB-GROUPING NOT = AM-VG-GROUPING
  7812           GO TO 0105-READ-ACCT.
  7813
  7814     MOVE 'X'                 TO DATE-RANGE-SW.
  7815
  7816     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7817        MOVE 'X'                 TO DATE-RANGE-SW
  7818        GO TO 0105-READ-ACCT.
  7819
  7820     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7821        GO TO 0105-READ-ACCT.
  7822
  7823     GO TO 0180-ACCOUNT-FOUND.
  7824
  7825 0102-ACCT-GETMAIN.
  7826     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7827     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7828
  7829 0105-READ-ACCT.
  7830     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 145
* EL050.cbl
  7831     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7832     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7833     MOVE PB-STATE               TO ACCT-STATE.
  7834     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7835     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7836
  7837     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7838
  7839     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7840
  7841 0110-FIND-ACCT-TOLERANCES-LOOP.
  7842     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7843
  7844     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7845        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7846        GO TO 0199-ACCT-NOT-FOUND
  7847     END-IF
  7848     IF PB-CARRIER NOT = SPACES
  7849        IF PB-CARRIER NOT = AM-VG-CARRIER
  7850           GO TO 0199-ACCT-NOT-FOUND.
  7851
  7852     IF PB-STATE NOT = SPACES
  7853        IF PB-STATE NOT = AM-VG-STATE
  7854           GO TO 0199-ACCT-NOT-FOUND.
  7855
  7856     IF PB-GROUPING NOT = SPACES
  7857        IF PB-GROUPING NOT = AM-VG-GROUPING
  7858           GO TO 0199-ACCT-NOT-FOUND.
  7859
  7860     MOVE 'X'                    TO DATE-RANGE-SW.
  7861
  7862     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7863        MOVE 'X'                 TO DATE-RANGE-SW
  7864        GO TO 0199-ACCT-NOT-FOUND.
  7865
  7866     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7867        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7868
  7869 0180-ACCOUNT-FOUND.
  7870     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7871     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7872     MOVE AM-STATE               TO PB-SV-STATE.
  7873     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7874
  7875     IF AM-CANCEL-FEE  NOT NUMERIC
  7876        MOVE ZEROS TO AM-CANCEL-FEE.
  7877
  7878     IF AM-MAX-MON-BEN NOT NUMERIC
  7879        MOVE ZEROS TO AM-MAX-MON-BEN.
  7880
  7881     IF AM-MAX-TOT-BEN NOT NUMERIC
  7882        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7883
  7884     IF AM-CLP-TOL-PCT NOT NUMERIC
  7885        MOVE +0                  TO AM-CLP-TOL-PCT
  7886     END-IF
  7887     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7888        MOVE +0                  TO AM-SPP-LEASE-COMM
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 146
* EL050.cbl
  7889     END-IF
  7890     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7891        MOVE ER-2611             TO   WS-ERROR
  7892        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7893
  7894     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7895        MOVE ER-2621             TO   WS-ERROR
  7896        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7897
  7898     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7899        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7900        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7901        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7902         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7903
  7904     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7905     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7906     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7907     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7908     IF AM-CLP-TOL-PCT NOT = ZEROS
  7909        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7910     END-IF
  7911     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7912        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7913     END-IF
  7914*    IF PB-COMPANY-ID = 'DCC'
  7915*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7916*                                   WS-ADMIN-FEES
  7917*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7918*          (SUB5 > +10)
  7919*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7920*             AND (AM-A-COM (SUB5) NUMERIC)
  7921*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7922*                + (AM-A-COM (SUB5) * 1000)
  7923*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7924*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7925*                + (AM-A-COM (SUB5) * 1000)
  7926*             END-IF
  7927*             IF AM-COM-TYP (SUB5) = 'N'
  7928*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7929*                + (AM-A-COM (SUB5) * 1000)
  7930*             END-IF
  7931*          END-IF
  7932*       END-PERFORM
  7933*    END-IF
  7934     IF (PB-COMPANY-ID = 'DCC')
  7935        AND (PB-ISSUE)
  7936        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7937        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7938           (SUB5 > +10)
  7939           MOVE +0 TO WS-WK-RATE
  7940           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7941              IF (AM-A-COM (SUB5) NUMERIC)
  7942                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7943                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7944              ELSE
  7945                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  7946                 IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 147
* EL050.cbl
  7947                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7948                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  7949                 ELSE
  7950                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7951                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  7952                 END-IF
  7953                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  7954                 MOVE ZEROS             TO WS-SUB1
  7955                                           WS-COMMISSION
  7956                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  7957                 MOVE '0530'               TO CTBL-SW
  7958                 MOVE ' '                  TO WS-CTBL-READ-SW
  7959                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7960                 IF FIRST-TIME-THROUGH
  7961                    MOVE 'AA'              TO CTBL-BEN-CODE
  7962                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7963                 END-IF
  7964                 IF CTBL-TABLE-FOUND
  7965                    IF PB-ISSUE
  7966                       COMPUTE WS-COMM-CK-AMT =
  7967                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  7968                    ELSE
  7969                       COMPUTE WS-COMM-CK-AMT =
  7970                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  7971                    END-IF
  7972                    PERFORM 8800-GET-COMP-RATE
  7973                              THRU 8800-EXIT
  7974                 END-IF
  7975              END-IF
  7976              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7977                + (WS-WK-RATE * 1000)
  7978           END-IF
  7979        END-PERFORM
  7980     END-IF
  7981     IF PB-COMPANY-ID EQUAL 'CRI'
  7982         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  7983
  7984     IF PB-COMPANY-ID EQUAL 'NCL'
  7985         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  7986     END-IF
  7987
  7988     GO TO 0200-READ-CERT.
  7989
  7990 0199-ACCT-NOT-FOUND.
  7991
  7992     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  7993
  7994     IF DATE-RANGE-SW NOT = SPACES
  7995        MOVE ER-2601             TO WS-ERROR
  7996        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7997     ELSE
  7998        MOVE ER-2619             TO WS-ERROR
  7999        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8000
  8001     GO TO 9990-RETURN.
  8002
  8003 0200-READ-CERT.
  8004
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 148
* EL050.cbl
  8005     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8006     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8007     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8008     MOVE PB-SV-STATE            TO CERT-STATE.
  8009     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8010     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8011     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8012
  8013     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8014
  8015     IF CERT-WAS-NOT-FOUND
  8016        GO TO 0299-CERT-NOT-FOUND.
  8017
  8018     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8019        MOVE ER-2759             TO WS-ERROR
  8020        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8021        GO TO 0298-UNLOCK-RETURN.
  8022
  8023     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8024         MOVE ER-2758            TO WS-ERROR
  8025         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8026         GO TO 0298-UNLOCK-RETURN.
  8027
  8028     IF PB-ISSUE
  8029        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8030           IF CERT-WAS-CREATED-FOR-CLAIM
  8031              NEXT SENTENCE
  8032            ELSE
  8033              MOVE ER-2626       TO WS-ERROR
  8034              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8035              GO TO 0298-UNLOCK-RETURN.
  8036
  8037     IF NOT PB-CANCELLATION
  8038        GO TO 0300-CONTINUE-EDIT.
  8039
  8040     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8041     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8042     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8043     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8044     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8045     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8046
  8047     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8048     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8049     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8050     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8051     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8052     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8053     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8054     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8055     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8056
  8057     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8058     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8059     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8060     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8061     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8062     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 149
* EL050.cbl
  8063     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8064
  8065     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8066     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8067
  8068     MOVE CM-CREDIT-INTERFACE-SW-1
  8069                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8070     MOVE CM-CREDIT-INTERFACE-SW-2
  8071                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8072
  8073     IF CM-O-B-COVERAGE
  8074         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8075
  8076     IF CM-LIVES NOT NUMERIC
  8077         MOVE ZERO                TO CM-LIVES.
  8078
  8079     IF CM-BILLED NOT NUMERIC
  8080         MOVE ZERO                TO CM-BILLED.
  8081
  8082     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8083         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8084         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8085         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8086         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8087         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8088         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8089         MOVE CM-LIVES             TO PB-CI-LIVES
  8090*The next line causes a problem with my change  I dont think it is
  8091*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8092
  8093     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8094     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8095     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8096     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8097     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8098     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8099
  8100     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8101     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8102     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8103     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8104
  8105     IF CM-LIFE-COMM-PCT NUMERIC
  8106         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8107     ELSE
  8108         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8109
  8110     IF CM-AH-COMM-PCT NUMERIC
  8111         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8112     ELSE
  8113         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8114
  8115     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8116
  8117     IF CM-LOAN-APR       NOT NUMERIC
  8118           MOVE ZERO               TO CM-LOAN-APR.
  8119
  8120     IF CM-PAY-FREQUENCY  NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 150
* EL050.cbl
  8121           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8122
  8123     IF CM-LOAN-TERM      NOT NUMERIC
  8124           MOVE ZERO               TO CM-LOAN-TERM.
  8125
  8126     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8127           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8128
  8129     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8130           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8131
  8132     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8133     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8134     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8135     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8136     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8137     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8138     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8139     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8140     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8141     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8142     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8143     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8144
  8145     IF CM-STATE = CM-SSN-STATE
  8146         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8147
  8148     IF CM-STATE NOT = CM-MEMB-STATE
  8149         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8150
  8151     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8152
  8153     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8154        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8155        IF CM-ADDL-CLP NOT NUMERIC
  8156           MOVE +0               TO CM-ADDL-CLP
  8157        END-IF
  8158        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8159        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8160           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8161        END-IF
  8162     END-IF
  8163     IF PB-COMPANY-ID = 'DCC'
  8164        MOVE +0                  TO WS-ADMIN-FEES
  8165                                    WS-CSO-ADMIN-FEE
  8166                                    WS-COMM-AND-MFEE
  8167                                    WS-1ST-YR-ALLOW
  8168        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8169           (SUB5 > +10)
  8170           MOVE +0 TO WS-WK-RATE
  8171           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8172              IF (AM-A-COM (SUB5) NUMERIC)
  8173                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8174                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8175              ELSE
  8176                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8177                 IF PB-ISSUE
  8178                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 151
* EL050.cbl
  8179                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8180                 ELSE
  8181                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8182                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8183                 END-IF
  8184                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8185                 MOVE ZEROS             TO WS-SUB1
  8186                                           WS-COMMISSION
  8187                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8188                 MOVE '0530'               TO CTBL-SW
  8189                 MOVE ' '                  TO WS-CTBL-READ-SW
  8190                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8191                 IF FIRST-TIME-THROUGH
  8192                    MOVE 'AA'              TO CTBL-BEN-CODE
  8193                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8194                 END-IF
  8195                 IF CTBL-TABLE-FOUND
  8196                    IF PB-ISSUE
  8197                       COMPUTE WS-COMM-CK-AMT =
  8198                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8199                    ELSE
  8200                       COMPUTE WS-COMM-CK-AMT =
  8201                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8202                    END-IF
  8203                    PERFORM 8800-GET-COMP-RATE
  8204                              THRU 8800-EXIT
  8205                 END-IF
  8206              END-IF
  8207              IF AM-COM-TYP (SUB5) = 'I'
  8208                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8209                   + (WS-WK-RATE * 1000)
  8210              END-IF
  8211              IF AM-COM-TYP (SUB5) = 'N'
  8212                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8213                   + (WS-WK-RATE * 1000)
  8214              END-IF
  8215              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8216                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8217                   + (WS-WK-RATE * 1000)
  8218              END-IF
  8219              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8220                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8221                   + (WS-WK-RATE * 1000)
  8222              END-IF
  8223           END-IF
  8224        END-PERFORM
  8225     END-IF
  8226     GO TO 0300-CONTINUE-EDIT.
  8227
  8228 0298-UNLOCK-RETURN.
  8229      PERFORM 9250-UNLOCK-RETURN
  8230      GO TO 9990-RETURN.
  8231
  8232 0299-CERT-NOT-FOUND.
  8233
  8234     MOVE '1'                     TO CERT-STATUS-SW.
  8235
  8236     IF PB-COMPANY-ID = 'UCL'
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 152
* EL050.cbl
  8237         IF WS-ERROR = ER-2799
  8238             GO TO 3000-CONTINUE-EDIT.
  8239
  8240     IF NOT PB-CANCELLATION
  8241         GO TO 0300-CONTINUE-EDIT.
  8242
  8243     MOVE ER-2726                  TO  WS-ERROR.
  8244     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8245     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8246     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8247                                    PB-CI-LF-TERM
  8248                                    PB-C-LF-REM-TERM
  8249                                    PB-CI-AH-TERM
  8250                                    PB-C-AH-REM-TERM
  8251                                    PB-CI-LF-BENEFIT-CD
  8252                                    PB-CI-LF-BENEFIT-AMT
  8253                                    PB-CI-LF-ALT-BENEFIT-AMT
  8254                                    PB-CI-LF-PREMIUM-AMT
  8255                                    PB-CI-LF-ALT-PREMIUM-AMT
  8256                                    PB-CI-AH-BENEFIT-CD
  8257                                    PB-CI-AH-BENEFIT-AMT
  8258                                    PB-CI-AH-PREMIUM-AMT
  8259                                    PB-CI-PAY-FREQUENCY
  8260                                    PB-CI-LOAN-APR
  8261                                    PB-CI-LOAN-TERM
  8262                                    PB-CI-LIFE-COMMISSION
  8263                                    PB-CI-AH-COMMISSION
  8264                                    PB-CI-CURR-SEQ
  8265                                    PB-CI-AH-CANCEL-AMT
  8266                                    PB-CI-LF-CANCEL-AMT
  8267                                    PB-CI-RATE-DEV-PCT-LF
  8268                                    PB-CI-RATE-DEV-PCT-AH
  8269                                    PB-CI-EXTENTION-DAYS
  8270                                    PB-CI-TERM-IN-DAYS
  8271                                    PB-CI-LIVES
  8272                                    PB-CI-LF-CRIT-PER
  8273                                    PB-CI-AH-CRIT-PER
  8274                                    PB-CI-ADDL-CLP
  8275                                    PB-CI-DDF-IU-RATE-UP.
  8276
  8277     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8278                                    PB-CI-AH-SETTLEMENT-DT
  8279                                    PB-CI-DEATH-DT
  8280                                    PB-CI-LF-PRIOR-CANCEL-DT
  8281                                    PB-CI-AH-PRIOR-CANCEL-DT
  8282                                    PB-CI-ENTRY-DT
  8283                                    PB-CI-LF-EXPIRE-DT
  8284                                    PB-CI-AH-EXPIRE-DT
  8285                                    PB-CI-LOAN-1ST-PMT-DT.
  8286
  8287     IF ACCOUNT-MAST-FOUND
  8288        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8289        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8290
  8291     GO TO 3000-CONTINUE-EDIT.
  8292
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 153
* EL050.cbl
  8294
  8295 0300-CONTINUE-EDIT.
  8296
  8297     IF PB-ISSUE
  8298        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8299            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8300
  8301     IF PB-ISSUE
  8302        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8303            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8304
  8305     IF PB-ISSUE
  8306       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8307          (AM-NO-AH-ONLY)
  8308           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8309               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8310                   MOVE ER-2679 TO WS-ERROR
  8311                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8312
  8313     IF PB-ISSUE
  8314        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8315        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8316        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8317     ELSE
  8318        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8319        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8320        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8321
  8322     MOVE 'N'                    TO PLAN-MASTER-SW
  8323                                    PLAN-MASTER-LIFE-SW
  8324                                    FORM-MASTER-SW
  8325                                    WS-APP-CERT-SW.
  8326
  8327     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8328                                    WS-PL-TOL-LF-REFUND
  8329                                    WS-PL-REF-OVS-AMT
  8330                                    WS-PL-TOL-LF-PREM-PCT
  8331                                    WS-PL-TOL-LF-REFUND-PCT
  8332                                    WS-PL-REF-OVS-PCT
  8333                                    WS-PL-TOL-LF-CLAIM.
  8334
  8335     IF PB-COMPANY-ID = 'NCL'
  8336       IF PB-ISSUE
  8337         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8338             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8339             IF FORM-MASTER-FOUND
  8340                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8341
  8342     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8343        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8344
  8345********************** MON CODE **********************
  8346     IF PB-COMPANY-ID = 'MON'
  8347     IF PB-ISSUE
  8348     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8349        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8350             PB-I-LOAN-APR = ZERO)
  8351               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 154
* EL050.cbl
  8352******************************************************
  8353
  8354     IF PB-COMPANY-ID = 'NCL'
  8355       IF PB-ISSUE
  8356           IF FORM-MASTER-FOUND
  8357             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8358                AM-DISMBR-COVERAGE
  8359                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8360                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8361                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8362                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8363                                           PB-I-LIFE-BENEFIT-CD.
  8364
  8365     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8366
  8367     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8368         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8369         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8370         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8371         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8372         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8373           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8374             GO TO 0301-LIFE-BENEFIT-SEARCH
  8375         ELSE
  8376             NEXT SENTENCE
  8377     ELSE
  8378         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8379
  8380     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8381     MOVE '4'                    TO CNTL-REC-TYPE.
  8382     MOVE +0                     TO CNTL-SEQ-NO.
  8383     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8384
  8385     MOVE '1' TO RC-SW-2.
  8386     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8387
  8388     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8389        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8390         GO TO 0305-BENEFIT-NOT-FOUND.
  8391
  8392     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8393
  8394 0301-LIFE-BENEFIT-SEARCH.
  8395
  8396     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8397
  8398     IF NO-BENEFIT-FOUND
  8399        GO TO 0305-BENEFIT-NOT-FOUND.
  8400
  8401     IF WS-BEN-CD = '99'
  8402        GO TO 0305-BENEFIT-NOT-FOUND.
  8403
  8404     IF PB-COMPANY-ID = 'NCL'
  8405         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8406             GO TO 0304-LIFE-BENEFIT-FOUND.
  8407
  8408     MOVE +1                     TO SUB5.
  8409     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 155
* EL050.cbl
  8410
  8411* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8412* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8413     IF PB-COMPANY-ID = 'DMD'
  8414         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8415
  8416 0302-EDIT-ACCT-LF-BENEFITS.
  8417
  8418     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8419        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8420           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8421                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8422           GO TO 03XX-GET-LIFE-ERPLAN.
  8423
  8424     IF SUB5 LESS THAN +20
  8425        ADD +1                   TO SUB5
  8426        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8427
  8428     MOVE +1                     TO SUB5.
  8429
  8430     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8431        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8432
  8433 0303-EDIT-DMD-EXTRA-BENEFITS.
  8434
  8435     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8436        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8437           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8438                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8439           GO TO 03XX-GET-LIFE-ERPLAN.
  8440
  8441     IF SUB5 LESS THAN +30
  8442        ADD +1                   TO SUB5
  8443        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8444
  8445     MOVE +1                     TO SUB5.
  8446
  8447 03XX-EDIT-FOR-NINETY-LF.
  8448
  8449***************************************************************
  8450*                                                             *
  8451*    NINETY BENEFIT PLAN TYPES:                               *
  8452*                                                             *
  8453*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8454*      92 = ALL GROUP REDUCING BENEFITS                       *
  8455*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8456*      94 = ALL GROUP LEVEL BENEFITS                          *
  8457*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8458*           BENEFIT CONTROLS.                                 *
  8459*      99 = ALL BENEFITS                                      *
  8460*                                                             *
  8461***************************************************************
  8462
  8463     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8464                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8465
  8466     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8467       AND
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 156
* EL050.cbl
  8468        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8469        GO TO 03XX-GET-LIFE-ERPLAN.
  8470
  8471     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8472       AND
  8473        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8474        IF CF-REDUCING (SUB3)
  8475           IF (PB-I-INDV-GRP-OVRD = 'I')
  8476              OR
  8477           ((AM-IG = '1') AND
  8478           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8479              OR
  8480           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8481           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8482           (AM-IG NOT = '2'))
  8483              GO TO 03XX-GET-LIFE-ERPLAN.
  8484
  8485     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8486       AND
  8487        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8488        IF CF-REDUCING (SUB3)
  8489           IF (PB-I-INDV-GRP-OVRD = 'G')
  8490              OR
  8491           ((AM-IG = '2') AND
  8492           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8493              OR
  8494           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8495           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8496           (AM-IG NOT = '1'))
  8497              GO TO 03XX-GET-LIFE-ERPLAN.
  8498
  8499     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8500       AND
  8501        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8502        IF CF-LEVEL    (SUB3)
  8503           IF (PB-I-INDV-GRP-OVRD = 'I')
  8504              OR
  8505           ((AM-IG = '1') AND
  8506           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8507              OR
  8508           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8509           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8510            (AM-IG NOT = '2'))
  8511              GO TO 03XX-GET-LIFE-ERPLAN.
  8512
  8513     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8514       AND
  8515        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8516        IF CF-LEVEL    (SUB3)
  8517           IF (PB-I-INDV-GRP-OVRD = 'G')
  8518              OR
  8519           ((AM-IG = '2') AND
  8520           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8521              OR
  8522           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8523           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8524           (AM-IG NOT = '1'))
  8525              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 157
* EL050.cbl
  8526
  8527     IF SUB5 LESS THAN +20
  8528        ADD +1                   TO SUB5
  8529        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8530
  8531     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8532
  8533     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8534        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8535
  8536     MOVE +1                     TO SUB5.
  8537
  8538 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8539
  8540     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8541                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8542
  8543     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8544       AND
  8545        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8546        GO TO 03XX-GET-LIFE-ERPLAN.
  8547
  8548     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8549       AND
  8550        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8551        IF CF-REDUCING (SUB3)
  8552           IF (PB-I-INDV-GRP-OVRD = 'I')
  8553              OR
  8554           ((AM-IG = '1') AND
  8555           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8556              OR
  8557           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8558           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8559           (AM-IG NOT = '2'))
  8560              GO TO 03XX-GET-LIFE-ERPLAN.
  8561
  8562     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8563       AND
  8564        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8565        IF CF-REDUCING (SUB3)
  8566           IF (PB-I-INDV-GRP-OVRD = 'G')
  8567              OR
  8568           ((AM-IG = '2') AND
  8569           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8570              OR
  8571           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8572           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8573           (AM-IG NOT = '1'))
  8574              GO TO 03XX-GET-LIFE-ERPLAN.
  8575
  8576     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8577       AND
  8578        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8579        IF CF-LEVEL    (SUB3)
  8580           IF (PB-I-INDV-GRP-OVRD = 'I')
  8581              OR
  8582           ((AM-IG = '1') AND
  8583           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 158
* EL050.cbl
  8584              OR
  8585           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8586           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8587            (AM-IG NOT = '2'))
  8588              GO TO 03XX-GET-LIFE-ERPLAN.
  8589
  8590     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8591       AND
  8592        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8593        IF CF-LEVEL    (SUB3)
  8594           IF (PB-I-INDV-GRP-OVRD = 'G')
  8595              OR
  8596           ((AM-IG = '2') AND
  8597           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8598              OR
  8599           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8600           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8601           (AM-IG NOT = '1'))
  8602              GO TO 03XX-GET-LIFE-ERPLAN.
  8603
  8604     IF SUB5 LESS THAN +30
  8605        ADD +1                   TO SUB5
  8606        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8607
  8608     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8609
  8610 03XX-EDIT-FOR-NINETY-LF-CONT.
  8611
  8612     MOVE +99                    TO SUB5.
  8613
  8614     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8615        IF PB-ISSUE
  8616           MOVE ER-1924          TO  WS-ERROR
  8617           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8618
  8619     GO TO 0304-LIFE-BENEFIT-FOUND.
  8620
  8621 03XX-GET-LIFE-ERPLAN.
  8622
  8623     IF WK-PLAN-ADDR EQUAL +0
  8624        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8625
  8626     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8627     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8628     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8629     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8630     MOVE 'Y'                    TO PLAN-MASTER-SW
  8631                                    PLAN-MASTER-LIFE-SW.
  8632     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8633
  8634 03XX-ERPLAN-LIFE-GETMAIN.
  8635
  8636     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8637     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8638
  8639 03XX-ERPLAN-LIFE-READ.
  8640
  8641     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 159
* EL050.cbl
  8642     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8643     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8644     MOVE PB-SV-STATE            TO PLAN-STATE.
  8645     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8646     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8647     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8648     MOVE WS-SAVE-BENEFIT-REVISION
  8649                                 TO PLAN-REVISION-NO.
  8650
  8651     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8652     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8653
  8654     IF PB-COMPANY-ID = 'NCL'
  8655       IF NOT LF-PLAN-MASTER-FOUND
  8656         IF NOT PB-POLICY-IS-DECLINED  AND
  8657            NOT PB-POLICY-IS-VOIDED
  8658             MOVE  ER-1921         TO  WS-ERROR
  8659             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8660             GO TO 0304-LIFE-BENEFIT-FOUND.
  8661
  8662     IF NOT LF-PLAN-MASTER-FOUND
  8663        GO TO 0304-LIFE-BENEFIT-FOUND.
  8664
  8665 XXXX-CHECK-LF-PLAN-KEY.
  8666
  8667     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8668        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8669        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8670        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8671        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8672        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8673        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8674        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8675        MOVE 'N'                 TO PLAN-MASTER-SW
  8676          GO TO 03XX-ERPLAN-LIFE-READ.
  8677
  8678     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8679
  8680     IF  PB-CANCELLATION
  8681         GO TO  0303-LF-ACCT-BEN-FOUND.
  8682
  8683     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8684        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8685           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8686           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8687              MOVE ER-2644             TO WS-ERROR
  8688              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8689           ELSE
  8690              NEXT SENTENCE
  8691        ELSE
  8692           IF PB-COMPANY-ID NOT = 'NCL'
  8693              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8694                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8695
  8696 0303-LF-ACCT-BEN-FOUND.
  8697
  8698     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8699
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 160
* EL050.cbl
  8700     IF PL-DEV-CODE NOT = SPACES
  8701        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8702
  8703     IF PL-DEV-PCT NUMERIC AND
  8704        PL-DEV-PCT NOT = ZEROS
  8705        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8706
  8707     IF PL-TOL-PREM-AMT GREATER THAN +0
  8708        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8709
  8710     IF PL-TOL-REF-AMT GREATER THAN +0
  8711        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8712
  8713     IF PL-TOL-PREM-PCT GREATER THAN +0
  8714        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8715
  8716     IF PL-TOL-REF-PCT GREATER THAN +0
  8717        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8718
  8719     IF PL-TOL-CLM-AMT GREATER THAN +0
  8720        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8721
  8722     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8723                          PL-OVER-SHORT-AMT > +0
  8724        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8725
  8726     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8727                          PL-OVER-SHORT-PCT > +0
  8728        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8729
  8730     IF PL-SALES-TAX NUMERIC AND
  8731                          PL-SALES-TAX > +0
  8732         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8733
  8734     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8735        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8736                                    WS-IG-OVRD-AM.
  8737
  8738 0304-LIFE-BENEFIT-FOUND.
  8739
  8740     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8741
  8742     IF PB-ISSUE
  8743        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8744     ELSE
  8745        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8746
  8747     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8748     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8749     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8750     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8751     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8752                                         WS-LF-REFUND-CALC.
  8753
  8754     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8755        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8756
  8757     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 161
* EL050.cbl
  8758        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8759     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8760
  8761     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8762     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8763     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8764     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8765     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8766     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8767
  8768     IF PB-COMPANY-ID = 'NCL'  AND
  8769        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8770         NEXT SENTENCE
  8771     ELSE
  8772         IF SUB5 NOT GREATER THAN +20
  8773            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8774               MOVE WS-SAVE-BENEFIT-REM-TERM
  8775                                      TO WS-AM-LF-BENE-REM-TERM
  8776                                         EC-BR-LF-REM-TERM-CALC.
  8777
  8778     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8779     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8780
  8781     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8782
  8783 0305-BENEFIT-NOT-FOUND.
  8784
  8785     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8786     MOVE ER-2604                TO WS-ERROR.
  8787     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8788
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 162
* EL050.cbl
  8790
  8791 0310-FIND-AH-BENEFIT-RECORD.
  8792
  8793     MOVE 'N'                    TO PLAN-MASTER-SW
  8794                                    PLAN-MASTER-AH-SW.
  8795
  8796     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8797                                    WS-PL-TOL-AH-REFUND
  8798                                    WS-AH-PL-REF-OVS-AMT
  8799                                    WS-PL-TOL-AH-PREM-PCT
  8800                                    WS-PL-TOL-AH-REFUND-PCT
  8801                                    WS-AH-PL-REF-OVS-PCT
  8802                                    WS-PL-TOL-AH-CLAIM.
  8803     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8804
  8805
  8806     if pb-issue
  8807        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8808           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8809        end-if
  8810        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8811           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8812           GO TO 0399-BENEFIT-NOT-FOUND
  8813        end-if
  8814     end-if
  8815
  8816     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8817        GO TO 0400-FIND-CARRIER.
  8818
  8819     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8820
  8821     IF WK-AH-BEN-ADDR NOT = ZEROS
  8822         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8823         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8824         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8825         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8826           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8827             GO TO 0311-AH-BENEFIT-SEARCH
  8828         ELSE
  8829             NEXT SENTENCE
  8830     ELSE
  8831         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8832
  8833     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8834     MOVE '5'                    TO CNTL-REC-TYPE.
  8835     MOVE +0                     TO CNTL-SEQ-NO.
  8836     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8837
  8838     MOVE '2' TO RC-SW-2.
  8839     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8840
  8841     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8842        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8843          GO TO 0399-BENEFIT-NOT-FOUND.
  8844
  8845     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8846
  8847 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 163
* EL050.cbl
  8848
  8849     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8850
  8851     IF NO-BENEFIT-FOUND
  8852         GO TO 0399-BENEFIT-NOT-FOUND.
  8853
  8854     IF WS-BEN-CD = '99'
  8855        GO TO 0399-BENEFIT-NOT-FOUND.
  8856
  8857     IF PB-COMPANY-ID  =  'NCL'
  8858         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8859             GO TO 0314-A-H-BENEFIT-FOUND.
  8860
  8861     MOVE +1                     TO SUB5.
  8862     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8863
  8864* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8865* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8866     IF PB-COMPANY-ID = 'DMD'
  8867         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8868
  8869 0312-EDIT-ACCT-AH-BENEFITS.
  8870
  8871     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8872        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8873           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8874                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8875           GO TO 03XX-GET-AH-ERPLAN.
  8876
  8877     IF SUB5 LESS THAN +20
  8878        ADD +1                   TO SUB5
  8879        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8880
  8881     MOVE +1                     TO SUB5.
  8882
  8883     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8884        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8885
  8886 0313-EDIT-DMD-EXTRA-BENEFITS.
  8887
  8888     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8889        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8890           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8891                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8892           GO TO 03XX-GET-AH-ERPLAN.
  8893
  8894     IF SUB5 LESS THAN +30
  8895        ADD +1                   TO SUB5
  8896        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8897
  8898     MOVE +1                     TO SUB5.
  8899
  8900 03XX-EDIT-FOR-NINETY-AH.
  8901
  8902***************************************************************
  8903*                                                             *
  8904*    NINETY BENEFIT PLAN TYPES:                               *
  8905*                                                             *
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 164
* EL050.cbl
  8906*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8907*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8908*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8909*           BENEFIT CONTROLS.                                 *
  8910*      99 = ALL BENEFITS.                                     *
  8911*                                                             *
  8912***************************************************************
  8913
  8914     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8915                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8916
  8917     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8918       AND
  8919        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8920        GO TO 03XX-GET-AH-ERPLAN.
  8921
  8922     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8923       AND
  8924        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8925           IF (PB-I-INDV-GRP-OVRD = 'I')
  8926              OR
  8927           ((AM-IG = '1') AND
  8928           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8929              OR
  8930           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8931           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8932           (AM-IG NOT = '2'))
  8933              GO TO 03XX-GET-AH-ERPLAN.
  8934
  8935     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8936       AND
  8937        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8938           IF (PB-I-INDV-GRP-OVRD = 'G')
  8939              OR
  8940           ((AM-IG = '2') AND
  8941           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8942              OR
  8943           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8944           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8945           (AM-IG NOT = '1'))
  8946              GO TO 03XX-GET-AH-ERPLAN.
  8947
  8948     IF SUB5 LESS THAN +20
  8949        ADD +1                   TO SUB5
  8950        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8951
  8952     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8953        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  8954
  8955     MOVE +1                    TO SUB5.
  8956
  8957 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8958
  8959     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8960                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8961
  8962     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8963       AND
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 165
* EL050.cbl
  8964        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8965        GO TO 03XX-GET-AH-ERPLAN.
  8966
  8967     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  8968       AND
  8969        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8970           IF (PB-I-INDV-GRP-OVRD = 'I')
  8971              OR
  8972           ((AM-IG = '1') AND
  8973           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8974              OR
  8975           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8976           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8977           (AM-IG NOT = '2'))
  8978              GO TO 03XX-GET-AH-ERPLAN.
  8979
  8980     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  8981       AND
  8982        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8983           IF (PB-I-INDV-GRP-OVRD = 'G')
  8984              OR
  8985           ((AM-IG = '2') AND
  8986           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8987              OR
  8988           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8989           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8990           (AM-IG NOT = '1'))
  8991              GO TO 03XX-GET-AH-ERPLAN.
  8992
  8993     IF SUB5 LESS THAN +30
  8994        ADD +1                   TO SUB5
  8995        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8996
  8997 03XX-EDIT-FOR-NINETY-AH-CONT.
  8998
  8999     MOVE +99                    TO SUB5.
  9000
  9001     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9002
  9003     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9004        IF PB-ISSUE
  9005           MOVE ER-1925          TO  WS-ERROR
  9006           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9007
  9008     GO TO 0314-A-H-BENEFIT-FOUND.
  9009
  9010 03XX-GET-AH-ERPLAN.
  9011
  9012     IF WK-PLAN-ADDR EQUAL +0
  9013         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9014
  9015     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9016     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9017     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9018     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9019     MOVE 'Y'                    TO PLAN-MASTER-SW
  9020                                    PLAN-MASTER-AH-SW.
  9021*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 166
* EL050.cbl
  9022     GO TO 03XX-ERPLAN-AH-READ.
  9023
  9024 03XX-ERPLAN-AH-GETMAIN.
  9025
  9026     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9027     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9028
  9029 03XX-ERPLAN-AH-READ.
  9030
  9031     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9032     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9033     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9034     MOVE PB-SV-STATE            TO PLAN-STATE.
  9035     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9036     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9037     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9038     MOVE WS-SAVE-BENEFIT-REVISION
  9039                                 TO PLAN-REVISION-NO.
  9040
  9041     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9042     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9043
  9044     IF PB-COMPANY-ID = 'NCL'
  9045       IF NOT AH-PLAN-MASTER-FOUND
  9046         IF NOT PB-POLICY-IS-DECLINED  AND
  9047            NOT PB-POLICY-IS-VOIDED
  9048             MOVE  ER-1922         TO  WS-ERROR
  9049             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9050             GO TO 0314-A-H-BENEFIT-FOUND.
  9051
  9052     IF NOT AH-PLAN-MASTER-FOUND
  9053        GO TO 0314-A-H-BENEFIT-FOUND.
  9054
  9055 XXXX-CHECK-AH-PLAN-KEY.
  9056
  9057     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9058        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9059        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9060        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9061        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9062        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9063        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9064        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9065        MOVE 'N'                 TO PLAN-MASTER-SW
  9066          GO TO 03XX-ERPLAN-AH-READ.
  9067
  9068     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9069
  9070     IF  PB-CANCELLATION
  9071         GO TO  0313-AH-ACCT-BEN-FOUND.
  9072
  9073     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9074       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9075          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9076          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9077             MOVE ER-2644             TO WS-ERROR
  9078             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9079          ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 167
* EL050.cbl
  9080             NEXT SENTENCE
  9081       ELSE
  9082          IF PB-COMPANY-ID NOT = 'NCL'
  9083             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9084                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9085
  9086 0313-AH-ACCT-BEN-FOUND.
  9087
  9088     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9089
  9090     IF PL-DEV-CODE NOT = SPACES
  9091        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9092
  9093     IF PL-DEV-PCT NUMERIC AND
  9094        PL-DEV-PCT NOT = ZEROS
  9095        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9096
  9097     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9098        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9099
  9100     IF PL-TOL-REF-AMT NOT EQUAL +0
  9101        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9102
  9103     IF PL-TOL-PREM-PCT GREATER THAN +0
  9104        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9105
  9106     IF PL-TOL-REF-PCT GREATER THAN +0
  9107        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9108
  9109     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9110        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9111
  9112     IF PL-OVER-SHORT-AMT NUMERIC AND
  9113                          PL-OVER-SHORT-AMT > +0
  9114        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9115
  9116     IF PL-OVER-SHORT-PCT NUMERIC AND
  9117                          PL-OVER-SHORT-PCT > +0
  9118        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9119
  9120     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9121        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9122        IF WS-IG-OVRD-AM EQUAL SPACES
  9123            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9124
  9125 0314-A-H-BENEFIT-FOUND.
  9126
  9127     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9128
  9129     IF PB-ISSUE
  9130        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9131       ELSE
  9132        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9133
  9134     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  9135     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9136     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9137     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 168
* EL050.cbl
  9138                                         WS-AH-REFUND-CALC.
  9139
  9140     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9141        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9142
  9143     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9144        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9145     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9146
  9147     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9148     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9149     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9150     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9151     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9152     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9153
  9154     IF PB-COMPANY-ID = 'NCL'  AND
  9155        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9156         NEXT SENTENCE
  9157     ELSE
  9158         IF SUB5 NOT GREATER THAN +20
  9159            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9160                MOVE WS-SAVE-BENEFIT-REM-TERM
  9161                                      TO WS-AM-AH-BENE-REM-TERM
  9162                                         EC-BR-AH-REM-TERM-CALC.
  9163
  9164     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9165     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9166
  9167     GO TO 0400-FIND-CARRIER.
  9168
  9169 0399-BENEFIT-NOT-FOUND.
  9170
  9171     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9172     MOVE ER-2605                TO WS-ERROR.
  9173     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9174
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 169
* EL050.cbl
  9176
  9177 0400-FIND-CARRIER.
  9178
  9179     MOVE PB-SV-CARRIER          TO WS-CARR.
  9180
  9181     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9182     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9183     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9184     MOVE '6'                    TO CNTL-REC-TYPE.
  9185
  9186*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9187     MOVE SPACE                  TO WS-DMD-RATING-SW
  9188                                    EC-BR-DMD-RATING-SW.
  9189
  9190     MOVE '2'                    TO RC-SW-1.
  9191     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9192
  9193     IF NOT CF-CARRIER-MASTER
  9194        GO TO 0400-CARRIER-NOT-FOUND.
  9195
  9196 0400-BUILD-CARR-TOL.
  9197
  9198     IF CF-CR-TOL-PREM NUMERIC AND
  9199        CF-CR-TOL-PREM GREATER THAN +0
  9200        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9201                                    WS-TOL-AH-PREM.
  9202
  9203     IF CF-CR-TOL-REFUND NUMERIC AND
  9204        CF-CR-TOL-REFUND GREATER THAN +0
  9205        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9206                                    WS-TOL-AH-REFUND.
  9207
  9208     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9209        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9210        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9211                                    WS-AH-REFUND-OVS-AMT.
  9212
  9213     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9214        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9215        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9216                                    WS-AH-REFUND-OVS-PCT.
  9217
  9218     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9219        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9220        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9221                                    WS-TOL-AH-PREM-PCT.
  9222
  9223     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9224        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9225        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9226                                     WS-TOL-AH-REFUND-PCT.
  9227
  9228     IF CF-COMPANY-ID EQUAL 'DMD'
  9229         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9230                                    EC-BR-DMD-RATING-SW.
  9231
  9232     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9233     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 170
* EL050.cbl
  9234        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9235     END-IF
  9236     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9237        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9238     END-IF
  9239     IF WS-TOL-CLP-PCT = ZEROS
  9240        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9241     END-IF
  9242
  9243     IF WS-SPP-LEASE-COMM = ZEROS
  9244        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9245     END-IF
  9246     GO TO 0400-FIND-ERPDEF.
  9247
  9248 0400-CARRIER-NOT-FOUND.
  9249
  9250     MOVE ER-2602                TO WS-ERROR.
  9251     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9252
  9253 0400-FIND-ERPDEF.
  9254     IF PB-COMPANY-ID = 'DCC'
  9255        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9256        CONTINUE
  9257     ELSE
  9258        GO TO 0400-FIND-ERCOMP
  9259     END-IF
  9260     MOVE ' '                    TO PDEF-MASTER-SW
  9261     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9262     MOVE PB-STATE               TO ERPDEF-STATE
  9263     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9264     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9265     IF PB-ISSUE
  9266        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9267     ELSE
  9268        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9269     END-IF
  9270     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9271     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9272     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9273     IF PDEF-MASTER-FOUND
  9274        MOVE 'N'                 TO PDEF-MASTER-SW
  9275        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9276        IF PDEF-MASTER-FOUND
  9277           IF (ERPDEF-KEY-SAVE (1:16) =
  9278                        PD-CONTROL-PRIMARY (1:16))
  9279              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9280              CONTINUE
  9281           ELSE
  9282              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9283              IF (ERPDEF-KEY-SAVE (1:16) =
  9284                        PD-CONTROL-PRIMARY (1:16))
  9285                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9286                 CONTINUE
  9287              ELSE
  9288                 MOVE 'N'        TO PDEF-MASTER-SW
  9289              END-IF
  9290           END-IF
  9291        END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 171
* EL050.cbl
  9292        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9293     END-IF
  9294     IF PDEF-MASTER-FOUND
  9295        IF PD-TRUNCATED = 'Y'
  9296           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9297        END-IF
  9298     END-IF
  9299     .
  9300 0400-FIND-ERCOMP.
  9301     IF PB-COMPANY-ID = 'DCC'
  9302        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9303           (WS-SUB1 > +10)
  9304           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9305                 OR 'A' OR 'N'
  9306              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9307              MOVE PB-CARRIER    TO COMP-CARRIER
  9308              MOVE PB-GROUPING   TO COMP-GROUPING
  9309              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9310              MOVE AM-AGT (WS-SUB1)
  9311                                 TO COMP-FIN-RESP
  9312              MOVE 'G'           TO COMP-TYPE
  9313              PERFORM 8582-READ-COMPENSATION-MASTER
  9314                                 THRU 8582-EXIT
  9315              IF COMP-MASTER-FOUND
  9316                 IF CO-GA-INACTIVE
  9317                    MOVE ER-2763 TO WS-ERROR
  9318                    PERFORM 9900-ERROR-FORMAT
  9319                                 THRU 9900-EXIT
  9320                    MOVE +11     TO WS-SUB1
  9321                 END-IF
  9322                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9323                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9324                    MOVE ER-2788 TO WS-ERROR
  9325                    PERFORM 9900-ERROR-FORMAT
  9326                                 THRU 9900-EXIT
  9327                    MOVE +11     TO WS-SUB1
  9328                 END-IF
  9329              END-IF
  9330           END-IF
  9331        END-PERFORM
  9332     END-IF
  9333     IF PB-COMPANY-ID = 'DCC'
  9334        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9335           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9336                                    WS-CLP-STATE
  9337        ELSE
  9338           MOVE SPACES           TO PB-I-CLP-STATE
  9339                                    WS-CLP-STATE
  9340        END-IF
  9341     END-IF
  9342
  9343     IF (PB-COMPANY-ID = 'DCC')
  9344        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9345        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9346        CONTINUE
  9347     ELSE
  9348        GO TO 0400-FIND-STATE-RECORD
  9349     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 172
* EL050.cbl
  9350     MOVE SPACES                 TO WS-CLP-STATE
  9351     MOVE +0                     TO WS-BANK-FEE
  9352                                    WS-BANK-LFEE
  9353                                    WS-BANK-NOCHRGB
  9354
  9355     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9356     IF (PB-ISSUE)
  9357        AND (PB-I-BANK-NUMBER NOT =
  9358            SPACES AND ZEROS AND LOW-VALUES)
  9359        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9360     ELSE
  9361        IF (PB-CANCELLATION)
  9362           AND (PB-CI-BANK-NUMBER NOT =
  9363                SPACES AND ZEROS AND LOW-VALUES)
  9364           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9365        END-IF
  9366     END-IF
  9367     IF COMP-FIN-RESP NOT = LOW-VALUES
  9368        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9369        MOVE PB-CARRIER          TO COMP-CARRIER
  9370        MOVE PB-GROUPING         TO COMP-GROUPING
  9371        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9372        MOVE 'B'                 TO COMP-TYPE
  9373        PERFORM 8582-READ-COMPENSATION-MASTER
  9374                                 THRU 8582-EXIT
  9375        IF COMP-MASTER-FOUND
  9376           IF CO-MAX-BANK-FEE NOT NUMERIC
  9377              MOVE +0            TO CO-MAX-BANK-FEE
  9378           END-IF
  9379           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9380              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9381           END-IF
  9382           IF CO-GA-INACTIVE
  9383              MOVE ER-2763       TO WS-ERROR
  9384              PERFORM 9900-ERROR-FORMAT
  9385                                 THRU 9900-EXIT
  9386           END-IF
  9387           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9388              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9389              MOVE ER-2788 TO WS-ERROR
  9390              PERFORM 9900-ERROR-FORMAT
  9391                                 THRU 9900-EXIT
  9392              MOVE +11     TO WS-SUB1
  9393           END-IF
  9394           IF WS-AH-BEN-CATEGORY = 'G'
  9395              MOVE CO-MAX-BANK-FEE
  9396                                 TO WS-BANK-FEE
  9397                                    PB-I-BANK-FEE
  9398           ELSE
  9399              MOVE CO-MAX-BANK-FEE-LEASE
  9400                                 TO WS-BANK-LFEE
  9401                                    PB-I-BANK-FEE
  9402           END-IF
  9403           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9404              AND (WS-AH-REFUND-CALC = 'G'))
  9405                        OR
  9406              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9407              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 173
* EL050.cbl
  9408              CONTINUE
  9409           ELSE
  9410              MOVE ER-2789 TO WS-ERROR
  9411              PERFORM 9900-ERROR-FORMAT
  9412                                 THRU 9900-EXIT
  9413           END-IF
  9414           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9415                                    PB-I-CLP-STATE
  9416           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9417           MOVE CO-CARRIER       TO BXRF-CARRIER
  9418           MOVE CO-GROUPING      TO BXRF-GROUPING
  9419           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9420           MOVE BXRF-MAX-REC-LENGTH
  9421                                 TO BXRF-REC-LENGTH
  9422           PERFORM 8584-READ-BANK-CROSS-REF
  9423                                 THRU 8584-EXIT
  9424           IF BXRF-MASTER-FOUND
  9425              MOVE ' '           TO BANK-ACCT-SW
  9426              MOVE BK-BANK-POINTER-CNT
  9427                                 TO BK-BANK-POINTER-CNT
  9428              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9429                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9430                 OR (BANK-ACCT-FOUND)
  9431                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9432                    AND (BK-AM-EXP-DT (WS-SUB1)
  9433                                 > PB-CERT-EFF-DT)
  9434                    AND (BK-AM-EFF-DT (WS-SUB1)
  9435                                 NOT > PB-CERT-EFF-DT)
  9436                    SET BANK-ACCT-FOUND TO TRUE
  9437                 END-IF
  9438              END-PERFORM
  9439              IF NOT BANK-ACCT-FOUND
  9440                 MOVE ZEROS      TO WS-BANK-FEE
  9441                                    WS-BANK-LFEE
  9442                 MOVE ER-2869    TO WS-ERROR
  9443                 PERFORM 9900-ERROR-FORMAT
  9444                                 THRU 9900-EXIT
  9445              ELSE
  9446                 PERFORM 5000-PROCESS-REPS
  9447                                 THRU 5000-EXIT
  9448                 IF AGENT-MASTER-FOUND
  9449                    MOVE +0      TO WS-BANK-FEE
  9450                                    WS-BANK-LFEE
  9451*                   MOVE AG-SPP-FEES (1)
  9452*                                TO PB-I-BANK-FEE
  9453*                                   WS-BANK-FEE
  9454                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9455                       (WS-SUB1 > +10)
  9456                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9457                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9458                       END-IF
  9459                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9460                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9461                       END-IF
  9462                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9463                          AG-SPP-FEES (WS-SUB1)
  9464                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9465                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 174
* EL050.cbl
  9466                    END-PERFORM
  9467                    IF WS-AH-BEN-CATEGORY = 'G'
  9468                       MOVE WS-BANK-FEE
  9469                                 TO PB-I-BANK-FEE
  9470                    ELSE
  9471                       MOVE WS-BANK-LFEE
  9472                                 TO PB-I-BANK-FEE
  9473                    END-IF
  9474                 END-IF
  9475              END-IF
  9476           END-IF
  9477        ELSE
  9478           MOVE ER-2879          TO WS-ERROR
  9479           PERFORM 9900-ERROR-FORMAT
  9480                                 THRU 9900-EXIT
  9481        END-IF
  9482     ELSE
  9483        MOVE ER-2879             TO WS-ERROR
  9484        PERFORM 9900-ERROR-FORMAT
  9485                                 THRU 9900-EXIT
  9486     END-IF
  9487     IF WS-AH-BEN-CATEGORY = 'G'
  9488        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9489        + WS-BANK-FEE
  9490     ELSE
  9491        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9492        + WS-BANK-LFEE
  9493     END-IF
  9494     .
  9495 0400-FIND-STATE-RECORD.
  9496
  9497     IF WK-STATE-ADDR NOT = ZEROS
  9498         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9499         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9500         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9501         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9502         IF PB-SV-STATE = CF-STATE-CODE
  9503             GO TO 0405-CONTINUE-EDIT
  9504         ELSE
  9505             NEXT SENTENCE
  9506     ELSE
  9507         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9508
  9509     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9510     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9511     MOVE '3'                    TO CNTL-REC-TYPE.
  9512     MOVE +0                     TO CNTL-SEQ-NO.
  9513
  9514     MOVE '3'                    TO RC-SW-2.
  9515     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9516
  9517     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9518        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9519        PB-SV-STATE   NOT = CF-STATE-CODE)
  9520        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9521                                    WS-TOL-AH-CLAIM
  9522                                    WS-MINIMUM-REFUND
  9523                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 175
* EL050.cbl
  9524                                    WS-TOL-AH-PREM
  9525                                    WS-TOL-LF-REFUND
  9526                                    WS-TOL-AH-REFUND
  9527                                    EC-ST-TOL-PREM-PCT
  9528                                    WS-TOL-LF-PREM-PCT
  9529                                    WS-TOL-AH-PREM-PCT
  9530                                    EC-ST-TOL-REFUND-PCT
  9531                                    WS-TOL-LF-REFUND-PCT
  9532                                    WS-TOL-AH-REFUND-PCT
  9533                                    EC-ST-TOL-PREM
  9534                                    EC-ST-TOL-REFUND
  9535                                    EC-ST-FST-PMT-DAYS-MAX
  9536                                    WS-FREE-LOOK-PERIOD
  9537                                    WS-ST-LF-PREM-TAX
  9538                                    WS-ST-AH-PREM-TAX-I
  9539                                    WS-ST-AH-PREM-TAX-G
  9540                                    WS-BANK-FEE
  9541                                    WS-BANK-LFEE
  9542                                    WS-TOL-CLP-PCT
  9543                                    WS-SPP-LEASE-COMM
  9544        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9545                                    EC-ST-FST-PMT-DAYS-CHG
  9546                                    WS-LF-REM-TERM-CALC
  9547                                    WS-LF-REFUND-CALC
  9548                                    EC-ST-LF-REM-TERM-CALC
  9549                                    EC-ST-LF-REFUND-CALC
  9550                                    WS-AH-REM-TERM-CALC
  9551                                    WS-AH-REFUND-CALC
  9552                                    WS-LF-BEN-CATEGORY
  9553                                    WS-AH-BEN-CATEGORY
  9554                                    WS-CLP-STATE
  9555                                    WS-ST-REFUND-CLAIM-FLAG
  9556                                    EC-ST-AH-REM-TERM-CALC
  9557                                    EC-ST-AH-REFUND-CALC
  9558          GO TO 0499-STATE-NOT-FOUND.
  9559
  9560     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9561
  9562 0405-CONTINUE-EDIT.
  9563
  9564     if pb-company-id = 'AHL'
  9565        continue
  9566     else
  9567        IF PB-CERT-PRIME NOT NUMERIC
  9568           MOVE ER-2722          TO WS-ERROR
  9569           PERFORM 9900-ERROR-FORMAT
  9570                                 THRU 9900-EXIT
  9571        end-if
  9572     END-IF
  9573*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9574*       MOVE +0                  TO SUB3
  9575*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9576*       IF SUB3 > +0
  9577*          MOVE ER-2722          TO WS-ERROR
  9578*          PERFORM 9900-ERROR-FORMAT
  9579*                                THRU 9900-EXIT
  9580*       END-IF
  9581*    END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 176
* EL050.cbl
  9582*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9583*       IF PB-CERT-PRIME NOT NUMERIC
  9584*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9585*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9586*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9587*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9588*
  9589*          MOVE ER-2722          TO WS-ERROR
  9590*          PERFORM 9900-ERROR-FORMAT
  9591*                                THRU 9900-EXIT
  9592*       END-IF
  9593*    END-IF
  9594
  9595     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9596
  9597     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9598        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9599                                    WS-TOL-AH-CLAIM.
  9600
  9601     IF CF-ST-REFUND-MIN NOT NUMERIC
  9602        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9603
  9604     IF CF-ST-REFUND-MIN NOT = ZEROS
  9605        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9606
  9607     IF CF-ST-TOL-PREM  NOT = ZEROS
  9608        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9609                                    WS-TOL-AH-PREM
  9610        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9611
  9612     IF CF-ST-TOL-REFUND NOT = ZEROS
  9613        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9614                                    WS-TOL-AH-REFUND
  9615        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9616
  9617     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9618        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9619        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9620                                    WS-AH-REFUND-OVS-AMT
  9621                                    EC-ST-OVR-SHT-AMT.
  9622
  9623     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9624        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9625        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9626                                    WS-TOL-LF-PREM-PCT
  9627                                    WS-TOL-AH-PREM-PCT.
  9628
  9629     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9630        CF-ST-TOL-REF-PCT GREATER THAN +0
  9631        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9632                                    WS-TOL-LF-REFUND-PCT
  9633                                    WS-TOL-AH-REFUND-PCT.
  9634
  9635     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9636        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9637        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9638                                    WS-AH-REFUND-OVS-PCT
  9639                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 177
* EL050.cbl
  9640
  9641     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9642     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9643
  9644     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9645          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9646
  9647     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9648     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9649     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9650
  9651     IF CF-ST-LF-PREM-TAX NUMERIC
  9652        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9653     END-IF
  9654     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9655        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9656     END-IF
  9657     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9658        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9659     END-IF
  9660
  9661     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9662         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9663     END-IF.
  9664
  9665     IF WS-LF-BENEFIT-CD = ZEROS
  9666        GO TO 0410-CHECK-AH.
  9667
  9668     IF CF-ST-RT-CALC NOT = SPACES
  9669        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9670                                    EC-ST-LF-REM-TERM-CALC
  9671     END-IF
  9672
  9673     IF WS-LF-COVERAGE-TYPE = 'R'
  9674        IF WS-LF-EARNINGS-CALC = '5'
  9675           IF CF-ST-RF-LN-CALC > '0'
  9676              MOVE CF-ST-RF-LN-CALC
  9677                                 TO WS-LF-REFUND-CALC
  9678                                    EC-ST-LF-REFUND-CALC
  9679           END-IF
  9680        ELSE
  9681           IF CF-ST-RF-LR-CALC > '0'
  9682              MOVE CF-ST-RF-LR-CALC
  9683                                 TO WS-LF-REFUND-CALC
  9684                                    EC-ST-LF-REFUND-CALC
  9685           END-IF
  9686        END-IF
  9687     ELSE
  9688        IF CF-ST-RF-LL-CALC > '0'
  9689           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9690                                    EC-ST-LF-REFUND-CALC
  9691        END-IF
  9692     END-IF
  9693
  9694     IF CF-ST-RT-CALC NOT = SPACES
  9695        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9696                                    EC-ST-LF-REM-TERM-CALC
  9697     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 178
* EL050.cbl
  9698
  9699     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9700     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9701
  9702     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9703
  9704     IF NO-BENEFIT-FOUND
  9705        GO TO 0410-CHECK-AH.
  9706
  9707     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9708        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9709                                 TO EC-ST-LF-REM-TERM-CALC
  9710                                    WS-LF-REM-TERM-CALC
  9711     END-IF
  9712
  9713     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9714        MOVE CF-ST-REFUND-CALC (SUB3)
  9715                                 TO WS-LF-REFUND-CALC
  9716                                    EC-ST-LF-REFUND-CALC
  9717     END-IF
  9718*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9719
  9720     .
  9721 0410-CHECK-AH.
  9722
  9723     IF WS-AH-BENEFIT-CD = ZEROS
  9724        GO TO 0500-SET-ACCOUNT.
  9725
  9726     IF CF-ST-RT-CALC NOT = SPACES
  9727        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9728                                    EC-ST-AH-REM-TERM-CALC
  9729     END-IF
  9730
  9731     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9732        IF CF-ST-RF-CP-CALC > '0'
  9733           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9734                                    EC-ST-AH-REFUND-CALC
  9735        END-IF
  9736     ELSE
  9737        IF CF-ST-RF-AH-CALC > '0'
  9738           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9739                                    EC-ST-AH-REFUND-CALC
  9740        END-IF
  9741     END-IF
  9742     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9743     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9744
  9745     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9746
  9747     IF NO-BENEFIT-FOUND
  9748        GO TO 0500-SET-ACCOUNT.
  9749
  9750     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9751        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9752                                 TO WS-AH-REM-TERM-CALC
  9753                                    EC-ST-AH-REM-TERM-CALC
  9754     END-IF
  9755
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 179
* EL050.cbl
  9756     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9757        MOVE CF-ST-REFUND-CALC (SUB3)
  9758                                 TO WS-AH-REFUND-CALC
  9759                                    EC-ST-AH-REFUND-CALC
  9760     END-IF
  9761
  9762*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9763
  9764     GO TO 0500-SET-ACCOUNT.
  9765
  9766 0499-STATE-NOT-FOUND.
  9767
  9768     MOVE ER-2603                TO WS-ERROR.
  9769     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9770
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 180
* EL050.cbl
  9772
  9773 0500-SET-ACCOUNT.
  9774*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9775     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9776        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9777        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9778        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9779        MOVE '3'                 TO CNTL-REC-TYPE
  9780        MOVE +0                  TO CNTL-SEQ-NO
  9781
  9782        MOVE '3'                 TO RC-SW-2
  9783        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9784
  9785        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9786           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9787           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9788           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9789                                    WS-ST-AH-PREM-TAX-I
  9790                                    WS-ST-AH-PREM-TAX-G
  9791        ELSE
  9792           IF CF-ST-LF-PREM-TAX NUMERIC
  9793              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9794           END-IF
  9795           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9796              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9797           END-IF
  9798           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9799              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9800           END-IF
  9801        END-IF
  9802        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9803     END-IF
  9804*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9805*  FOR DCC ONLY
  9806     IF PB-COMPANY-ID = 'DCC'
  9807
  9808     MOVE ' '                    TO STAT-MASTER-SW
  9809     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9810     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9811     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9812     MOVE PB-STATE               TO ELSTAT-STATE
  9813     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9814        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9815     END-IF
  9816
  9817     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9818     SET BIN-TO-GREG             TO TRUE
  9819     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9820     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9821     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9822
  9823     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9824     IF STAT-MASTER-FOUND
  9825        MOVE 'N'                 TO STAT-MASTER-SW
  9826        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9827        IF STAT-MASTER-FOUND
  9828           IF (ELSTAT-KEY-SAVE (1:12) =
  9829                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 181
* EL050.cbl
  9830              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9831                 MOVE 'F'        TO STAT-MASTER-SW
  9832              ELSE
  9833                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9834                 IF (STAT-MASTER-FOUND)
  9835                    AND (ELSTAT-KEY-SAVE (1:12) =
  9836                        SF-CONTROL-PRIMARY (1:12))
  9837                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9838                    MOVE 'F'     TO STAT-MASTER-SW
  9839                 END-IF
  9840              END-IF
  9841           END-IF
  9842        END-IF
  9843     END-IF
  9844
  9845     IF STAT-MASTER-SW = 'F'
  9846        IF SF-ST-LF-PREM-TAX NUMERIC
  9847           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9848        END-IF
  9849        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9850           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9851        END-IF
  9852        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9853           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9854        END-IF
  9855     END-IF
  9856
  9857     END-IF
  9858     IF (PB-COMPANY-ID = 'DCC')
  9859        AND (PB-ISSUE)
  9860        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9861        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9862        AND (AM-GPCD = 06)
  9863        MOVE 'Y'                 TO WS-GOOD-HIN
  9864        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9865           MOVE PB-I-VIN         TO WS-WORK-VIN
  9866           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9867              (V1 > 16)
  9868              IF WS-WORK-VIN (V1:1) NUMERIC
  9869                 MOVE WS-WORK-VIN-N (V1)
  9870                                 TO WS-ROW-B-VAL (V1)
  9871              ELSE
  9872                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9873                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9874                    OR (V2 > 26)
  9875                 END-PERFORM
  9876                 IF V2 < 27
  9877                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9878                 ELSE
  9879                    MOVE 'N'     TO WS-GOOD-HIN
  9880                 END-IF
  9881              END-IF
  9882              COMPUTE WS-ROW-D-VAL (V1) =
  9883                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9884              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9885                 WS-ROW-D-VAL (V1)
  9886           END-PERFORM
  9887           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 182
* EL050.cbl
  9888           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9889             REMAINDER WS-VIN-REMAINDER
  9890           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9891              CONTINUE
  9892           ELSE
  9893              MOVE 'N'           TO WS-GOOD-HIN
  9894           END-IF
  9895        ELSE
  9896           MOVE 'N'              TO WS-GOOD-HIN
  9897        END-IF
  9898        IF WS-GOOD-HIN NOT = 'Y'
  9899           MOVE ER-3826           TO WS-ERROR
  9900           PERFORM 9900-ERROR-FORMAT
  9901                                 THRU 9900-EXIT
  9902        END-IF
  9903     END-IF
  9904     IF (PB-COMPANY-ID = 'DCC')
  9905        AND (PB-ISSUE)
  9906        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9907        AND (AM-GPCD NOT = 06)
  9908        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9909          MOVE PB-I-VIN          TO WS-WORK-VIN
  9910          MOVE +8                TO V2
  9911          MOVE ZEROS             TO WS-VIN-TOTAL
  9912          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9913           (V1 > 17)
  9914             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9915                MOVE ER-3825     TO WS-ERROR
  9916                PERFORM 9900-ERROR-FORMAT
  9917                                 THRU 9900-EXIT
  9918             ELSE
  9919                IF V1 = 8
  9920                   MOVE 10       TO V2
  9921                END-IF
  9922                IF V1 = 9
  9923                   MOVE 0        TO V2
  9924                END-IF
  9925                IF V1 = 10
  9926                   MOVE 9        TO V2
  9927                END-IF
  9928                IF WS-WORK-VIN (V1:1) NUMERIC
  9929                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9930                    + (WS-WORK-VIN-N (V1) * V2)
  9931                ELSE
  9932                   MOVE WS-WORK-VIN (V1:1)
  9933                                 TO WS-HEX-BYTE
  9934                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9935                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9936                    + (WS-NUM (V3) * V2)
  9937                END-IF
  9938                COMPUTE V2 = V2 - 1
  9939             END-IF
  9940          END-PERFORM
  9941          MOVE ZEROS TO WS-VIN-REMAINDER
  9942          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9943             REMAINDER WS-VIN-REMAINDER
  9944          IF ((WS-WORK-VIN (9:1) = 'X')
  9945             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 183
* EL050.cbl
  9946                     OR
  9947             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
  9948             CONTINUE
  9949          ELSE
  9950             MOVE ER-3826        TO WS-ERROR
  9951             PERFORM 9900-ERROR-FORMAT
  9952                                 THRU 9900-EXIT
  9953          END-IF
  9954        ELSE
  9955          MOVE ER-3826           TO WS-ERROR
  9956          PERFORM 9900-ERROR-FORMAT
  9957                                 THRU 9900-EXIT
  9958        END-IF
  9959     END-IF
  9960******************************************************************
  9961******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  9962******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  9963******* METHODS.
  9964******************************************************************
  9965     IF PB-COMPANY-ID EQUAL TO 'NCL'
  9966        IF PB-CANCELLATION
  9967           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  9968              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  9969                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
  9970                IF FORM-MASTER-FOUND
  9971                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
  9972******************************************************************
  9973
  9974     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
  9975     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
  9976
  9977     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
  9978     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
  9979     MOVE AM-STATUS              TO WS-ACCT-STATUS.
  9980     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
  9981
  9982
  9983     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
  9984     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
  9985     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
  9986
  9987     IF AM-LF-OB-RATE NOT NUMERIC
  9988         MOVE ZERO               TO AM-LF-OB-RATE.
  9989
  9990     IF AM-LF-OB-RATE-JNT NOT NUMERIC
  9991         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
  9992
  9993     IF AM-AH-OB-RATE NOT NUMERIC
  9994         MOVE ZERO               TO AM-AH-OB-RATE.
  9995
  9996     IF WS-LF-JOINT-INDICATOR = 'J'
  9997         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
  9998     ELSE
  9999         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10000
 10001     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10002
 10003     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 184
* EL050.cbl
 10004         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10005
 10006     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10007         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10008                                       WS-IG-OVRD
 10009     ELSE
 10010         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10011             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10012                                       WS-IG-OVRD
 10013         ELSE
 10014             MOVE AM-IG             TO WS-IG-OVRD-AH
 10015                                       WS-IG-OVRD.
 10016
 10017     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10018         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10019                                       WS-IG-OVRD
 10020     ELSE
 10021         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10022             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10023                                       WS-IG-OVRD
 10024         ELSE
 10025             MOVE AM-IG             TO WS-IG-OVRD-LF
 10026                                       WS-IG-OVRD.
 10027
 10028     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10029     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10030     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10031     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10032     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10033
 10034     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10035     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10036     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10037     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10038
 10039     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10040     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10041     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10042     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10043     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10044     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10045     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10046
 10047     IF WS-ACCT-AH-DEV-PCT > +0
 10048        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10049     ELSE
 10050        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10051
 10052     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10053        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10054     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10055        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10056
 10057        IF AM-EARN-METHOD-L = 'S'
 10058            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10059                                        WS-LF-REFUND-CALC.
 10060
 10061        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 185
* EL050.cbl
 10062            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10063                                        WS-LF-REFUND-CALC.
 10064
 10065     IF WS-LF-COVERAGE-TYPE = 'R'
 10066         IF AM-EARN-METHOD-R = 'R'
 10067            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10068                                    WS-LF-REFUND-CALC.
 10069     IF WS-LF-COVERAGE-TYPE = 'R'
 10070         IF AM-EARN-METHOD-R = 'P'
 10071            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10072                                    WS-LF-REFUND-CALC.
 10073     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10074         IF AM-EARN-METHOD-L = 'R'
 10075            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10076                                    WS-LF-REFUND-CALC.
 10077     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10078         IF AM-EARN-METHOD-L = 'P'
 10079            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10080                                    WS-LF-REFUND-CALC.
 10081     IF WS-LF-COVERAGE-TYPE = 'R'
 10082         IF AM-EARN-METHOD-R = 'A'
 10083            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10084                                    WS-LF-REFUND-CALC.
 10085     IF WS-LF-COVERAGE-TYPE = 'R'
 10086         IF AM-EARN-METHOD-R = 'M'
 10087            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10088                                    WS-LF-REFUND-CALC.
 10089     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10090         IF AM-EARN-METHOD-L = 'A'
 10091            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10092                                    WS-LF-REFUND-CALC.
 10093     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10094         IF AM-EARN-METHOD-L = 'M'
 10095            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10096                                    WS-LF-REFUND-CALC.
 10097
 10098     IF AM-EARN-METHOD-A = 'R'
 10099        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10100                                    WS-AH-REFUND-CALC.
 10101     IF AM-EARN-METHOD-A = 'P'
 10102        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10103                                    WS-AH-REFUND-CALC.
 10104     IF AM-EARN-METHOD-A = 'C'
 10105        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10106                                    WS-AH-REFUND-CALC.
 10107     IF AM-EARN-METHOD-A = 'A'
 10108        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10109                                    WS-AH-REFUND-CALC.
 10110     IF AM-EARN-METHOD-A = 'M'
 10111        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10112                                    WS-AH-REFUND-CALC.
 10113     IF AM-EARN-METHOD-A = 'N'
 10114        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10115                                    WS-AH-REFUND-CALC.
 10116     IF AM-EARN-METHOD-A = 'S'
 10117        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10118                                    WS-AH-REFUND-CALC.
 10119
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 186
* EL050.cbl
 10120     IF AM-TOL-PREM NOT = ZEROS
 10121        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10122                                    WS-TOL-AH-PREM.
 10123
 10124     IF AM-OVR-SHT-AMT NUMERIC AND
 10125                  AM-OVR-SHT-AMT > 0
 10126        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10127                                    EC-AM-LF-OVR-SHT-AMT
 10128                                    WS-AH-REFUND-OVS-AMT
 10129                                    EC-AM-AH-OVR-SHT-AMT.
 10130
 10131     IF AM-OVR-SHT-PCT NUMERIC AND
 10132                    AM-OVR-SHT-PCT > 0
 10133        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10134                                    EC-AM-LF-OVR-SHT-PCT
 10135                                    WS-AH-REFUND-OVS-PCT
 10136                                    EC-AM-AH-OVR-SHT-PCT.
 10137
 10138     IF AM-TOL-REF-PCT NUMERIC AND
 10139                  AM-TOL-REF-PCT > 0
 10140        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10141                                    WS-TOL-AH-REFUND-PCT.
 10142
 10143     IF AM-TOL-REF  NOT = ZEROS  AND
 10144                  AM-TOL-REF NUMERIC
 10145        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10146                                    EC-AM-LF-TOL-REFUND
 10147                                    WS-TOL-AH-REFUND
 10148                                    EC-AM-AH-TOL-REFUND.
 10149
 10150     IF AM-TOL-CLM  NOT = ZEROS
 10151        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10152                                    WS-TOL-AH-CLAIM.
 10153
 10154     IF AM-CLP-TOL-PCT NOT NUMERIC
 10155        MOVE +0                  TO AM-CLP-TOL-PCT
 10156     END-IF
 10157
 10158     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10159        MOVE +0                  TO AM-SPP-LEASE-COMM
 10160     END-IF
 10161     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10162        MOVE WS-PL-TOL-LF-PREM-PCT
 10163                                 TO WS-TOL-LF-PREM-PCT.
 10164
 10165     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10166        MOVE WS-PL-TOL-AH-PREM-PCT
 10167                                 TO WS-TOL-AH-PREM-PCT.
 10168
 10169     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10170        MOVE WS-PL-TOL-LF-REFUND-PCT
 10171                                 TO WS-TOL-LF-REFUND-PCT.
 10172
 10173     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10174        MOVE WS-PL-TOL-AH-REFUND-PCT
 10175                                 TO WS-TOL-AH-REFUND-PCT.
 10176
 10177     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 187
* EL050.cbl
 10178        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10179
 10180     IF WS-PL-REF-OVS-PCT > +0
 10181        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10182
 10183     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10184        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10185     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10186        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10187     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10188        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10189     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10190        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10191     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10192        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10193     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10194        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10195
 10196     IF WS-AH-PL-REF-OVS-AMT > +0
 10197        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10198
 10199     IF WS-AH-PL-REF-OVS-PCT > +0
 10200        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10201
 10202     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10203     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10204
 10205     IF PB-CANCELLATION
 10206        GO TO 3000-CONTINUE-EDIT.
 10207
 10208     MOVE +1 TO SUB1.
 10209     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10210     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10211
 10212     IF CF-COMPANY-ID = 'DMD'
 10213       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10214         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10215        ELSE
 10216         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10217
 10218  0525-FIND-ACCT-COMM.
 10219     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10220        NEXT SENTENCE
 10221      ELSE
 10222         ADD +1 TO SUB1
 10223         IF SUB1 LESS +11
 10224            GO TO 0525-FIND-ACCT-COMM
 10225          ELSE
 10226             GO TO 0560-EDIT-CONTINUE.
 10227
 10228     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10229     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10230                                    PB-I-LIFE-COMMISSION.
 10231***  IF PB-COMPANY-ID = 'CRI'
 10232     IF PB-PREM-ACCTNG-ONLY
 10233         GO TO 0560-EDIT-CONTINUE.
 10234
 10235     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 188
* EL050.cbl
 10236     MOVE ' '    TO WS-CTBL-READ-SW.
 10237
 10238
 10239 0530-GET-AH-COMP.
 10240     IF NO-AH-COVERAGE  OR
 10241        NO-AH-BENEFIT-MATCH
 10242           GO TO 0540-NEXT-READ-STEP.
 10243
 10244     IF AM-A-COM (SUB1) NUMERIC
 10245        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10246         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10247         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10248         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10249         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10250     ELSE
 10251          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10252          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10253          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10254          MOVE ZEROS             TO WS-SUB1
 10255                                    WS-COMMISSION
 10256          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10257          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10258          IF WS-COMMISSION > ZEROS
 10259             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10260             GO TO 0540-NEXT-READ-STEP
 10261          END-IF
 10262          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10263          IF CTBL-TABLE-FOUND
 10264             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10265                                        PB-I-AH-TERM
 10266             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10267             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10268             GO TO 0540-NEXT-READ-STEP
 10269          ELSE
 10270             IF FIRST-TIME-THROUGH
 10271                 GO TO 0530-GET-AH-COMP
 10272             ELSE
 10273                 MOVE ER-2609                TO WS-ERROR
 10274                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10275
 10276 0540-NEXT-READ-STEP.
 10277     MOVE '0540' TO CTBL-SW.
 10278     MOVE ' '    TO WS-CTBL-READ-SW.
 10279
 10280 0540-GET-LF-COMP.
 10281     IF NO-LIFE-COVERAGE  OR
 10282        NO-LF-BENEFIT-MATCH
 10283           GO TO 0560-EDIT-CONTINUE.
 10284
 10285     IF WS-LF-JOINT-INDICATOR = 'J'
 10286        IF AM-J-COM (SUB1) NUMERIC
 10287           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10288           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10289           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10290           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10291           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10292        ELSE
 10293           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 189
* EL050.cbl
 10294           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10295           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10296           MOVE ZEROS                TO WS-SUB1
 10297                                        WS-COMMISSION
 10298           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10299           IF WS-COMMISSION > ZEROS
 10300              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10301              GO TO 0560-EDIT-CONTINUE
 10302           END-IF
 10303           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10304           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10305           IF CTBL-TABLE-FOUND
 10306              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10307              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10308              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10309              GO TO 0560-EDIT-CONTINUE
 10310           ELSE
 10311              IF FIRST-TIME-THROUGH
 10312                  GO TO 0540-GET-LF-COMP
 10313              ELSE
 10314                  MOVE ER-2609                TO WS-ERROR
 10315                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10316                  GO TO 0560-EDIT-CONTINUE.
 10317
 10318     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10319        IF AM-L-COM (SUB1) NUMERIC
 10320           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10321           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10322           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10323           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10324           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10325        ELSE
 10326           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10327           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10328           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10329           MOVE ZEROS                TO WS-SUB1
 10330                                        WS-COMMISSION
 10331           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10332           IF WS-COMMISSION IS GREATER THAN ZEROS
 10333              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10334              GO TO 0560-EDIT-CONTINUE
 10335           END-IF
 10336           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10337           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10338           IF CTBL-TABLE-FOUND
 10339              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10340              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10341              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10342              GO TO 0560-EDIT-CONTINUE
 10343           ELSE
 10344              IF FIRST-TIME-THROUGH
 10345                  GO TO 0540-GET-LF-COMP
 10346              ELSE
 10347                  MOVE ER-2609                TO WS-ERROR
 10348                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10349
 10350*    GO TO 0560-EDIT-CONTINUE.
 10351
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 190
* EL050.cbl
 10352 0560-EDIT-CONTINUE.
 10353     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10354                                    WS-AH-PMF-COMM
 10355*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10356*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10357     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10358        (SUB1 > +10)
 10359        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10360           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10361           MOVE '0530'           TO CTBL-SW
 10362           MOVE ' '              TO WS-CTBL-READ-SW
 10363           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10364           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10365           MOVE '0540'           TO CTBL-SW
 10366           MOVE ' '              TO WS-CTBL-READ-SW
 10367           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10368        END-IF
 10369     END-PERFORM
 10370     GO TO 0564-EDIT-CONTINUE
 10371     .
 10372 0561-CHECK-AH.
 10373     IF (NO-AH-COVERAGE)
 10374        OR (NO-AH-BENEFIT-MATCH)
 10375        CONTINUE
 10376     ELSE
 10377        IF (AM-A-COM (SUB1) NUMERIC)
 10378           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10379           IF (AM-COM-TYP (SUB1) = 'A')
 10380              AND (WS-AH-PMF-COMM = ZEROS)
 10381              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10382           END-IF
 10383           CONTINUE
 10384        ELSE
 10385           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10386           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10387           MOVE PB-AH-OVERRIDE-L1
 10388                                 TO CTBL-BEN-TYPE
 10389           MOVE ZEROS            TO WS-SUB1
 10390                                    WS-COMMISSION
 10391           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10392           PERFORM 8300-READ-CTBL-TABLE
 10393                                 THRU 8300-EXIT
 10394           IF CTBL-TABLE-FOUND
 10395              IF (AM-COM-TYP (SUB1) = 'A')
 10396                 AND (WS-AH-PMF-COMM = ZEROS)
 10397                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10398                                        PB-I-AH-TERM
 10399                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10400                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10401              END-IF
 10402              CONTINUE
 10403           ELSE
 10404              IF FIRST-TIME-THROUGH
 10405                 GO TO 0561-CHECK-AH
 10406              ELSE
 10407                 MOVE ER-2609    TO WS-ERROR
 10408                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10409              END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 191
* EL050.cbl
 10410           END-IF
 10411        END-IF
 10412     END-IF
 10413     .
 10414 0561-EXIT.
 10415     EXIT.
 10416 0563-CHECK-LF.
 10417     IF (NO-LIFE-COVERAGE)
 10418        OR (NO-LF-BENEFIT-MATCH)
 10419        CONTINUE
 10420     ELSE
 10421        IF WS-LF-JOINT-INDICATOR = 'J'
 10422           IF AM-J-COM (SUB1) NUMERIC
 10423              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10424              IF (AM-COM-TYP (SUB1) = 'A')
 10425                 AND (WS-LF-PMF-COMM = ZEROS)
 10426                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10427              END-IF
 10428              CONTINUE
 10429           ELSE
 10430              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10431              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10432              MOVE PB-LIFE-OVERRIDE-L1
 10433                                 TO CTBL-BEN-TYPE
 10434              MOVE ZEROS         TO WS-SUB1
 10435                                    WS-COMMISSION
 10436              MOVE AM-J-COMA (SUB1)
 10437                                 TO CTBL-TABLE
 10438              PERFORM 8300-READ-CTBL-TABLE
 10439                                 THRU 8300-EXIT
 10440              IF CTBL-TABLE-FOUND
 10441                 IF (AM-COM-TYP (SUB1) = 'A')
 10442                    AND (WS-LF-PMF-COMM = ZEROS)
 10443                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10444                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10445                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10446                 END-IF
 10447                 CONTINUE
 10448              ELSE
 10449                 IF FIRST-TIME-THROUGH
 10450                    GO TO 0563-CHECK-LF
 10451                 ELSE
 10452                    MOVE ER-2609 TO WS-ERROR
 10453                    PERFORM 9900-ERROR-FORMAT
 10454                                 THRU 9900-EXIT
 10455*                   GO TO 0560-EDIT-CONTINUE
 10456                 END-IF
 10457              END-IF
 10458           END-IF
 10459        ELSE
 10460           IF AM-L-COM (SUB1) NUMERIC
 10461              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10462              IF (AM-COM-TYP (SUB1) = 'A')
 10463                 AND (WS-LF-PMF-COMM = ZEROS)
 10464                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10465              END-IF
 10466              CONTINUE
 10467           ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 192
* EL050.cbl
 10468              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10469              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10470              MOVE PB-LIFE-OVERRIDE-L1
 10471                                 TO CTBL-BEN-TYPE
 10472              MOVE ZEROS         TO WS-SUB1
 10473                                    WS-COMMISSION
 10474              MOVE AM-L-COMA (SUB1)
 10475                                 TO CTBL-TABLE
 10476              PERFORM 8300-READ-CTBL-TABLE
 10477                                 THRU 8300-EXIT
 10478              IF CTBL-TABLE-FOUND
 10479                 CONTINUE
 10480              ELSE
 10481                 IF FIRST-TIME-THROUGH
 10482                    GO TO 0563-CHECK-LF
 10483                 ELSE
 10484                    MOVE ER-2609 TO WS-ERROR
 10485                    PERFORM 9900-ERROR-FORMAT
 10486                                 THRU 9900-EXIT
 10487                 END-IF
 10488              END-IF
 10489           END-IF
 10490        END-IF
 10491     END-IF
 10492     .
 10493 0563-EXIT.
 10494     EXIT.
 10495 0564-EDIT-CONTINUE.
 10496
 10497     IF  PB-COMPANY-ID EQUAL 'DMD'
 10498         IF PB-I-NUM-BILLED EQUAL ZEROS
 10499            MOVE ER-8148       TO WS-ERROR
 10500            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10501
 10502*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10503*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10504*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10505*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10506*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10507*         IF NO-CONVERSION-ERROR
 10508*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10509*         ELSE
 10510*             IF PB-COMPANY-ID EQUAL 'HAN'
 10511*                 MOVE ZEROS     TO PB-I-AGE.
 10512     IF PB-I-BIRTHDAY > LOW-VALUES
 10513        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10514        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10515        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10516        PERFORM 8500-DATE-CONVERT
 10517                                 THRU 8500-EXIT
 10518        IF NO-CONVERSION-ERROR
 10519           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10520           IF PB-I-AGE > ZEROS
 10521              IF WS-WORK-AGE NOT = PB-I-AGE
 10522                 MOVE ER-9501    TO WS-ERROR
 10523                 PERFORM 9900-ERROR-FORMAT
 10524                                 THRU 9900-EXIT
 10525              END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 193
* EL050.cbl
 10526           ELSE
 10527              MOVE WS-WORK-AGE   TO PB-I-AGE
 10528           END-IF
 10529        END-IF
 10530     END-IF
 10531     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10532                                   WS-INS-AGE-SET
 10533     IF PB-I-AGE = ZEROS
 10534        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10535           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10536                                   WS-INS-AGE-SET
 10537           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10538
 10539     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10540                                   WS-AH-EDIT-AGE.
 10541
 10542     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10543        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10544        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10545        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10546        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10547        IF NO-CONVERSION-ERROR
 10548           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10549           IF PB-I-JOINT-AGE > 0
 10550              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10551                 MOVE ER-9503    TO WS-ERROR
 10552                 PERFORM 9900-ERROR-FORMAT
 10553                                 THRU 9900-EXIT
 10554              END-IF
 10555           ELSE
 10556              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10557           END-IF
 10558        ELSE
 10559           MOVE ZEROS            TO PB-I-JOINT-AGE
 10560        END-IF
 10561     END-IF
 10562     IF PB-I-JOINT-AGE NOT NUMERIC
 10563        MOVE ZERO               TO PB-I-JOINT-AGE.
 10564
 10565     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10566                                   WS-JNT-AGE-SET
 10567     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10568        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10569           (WS-AH-JOINT-INDICATOR = 'J')
 10570           IF PB-I-JOINT-AGE = ZEROS
 10571               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10572                                          WS-JNT-AGE-SET
 10573               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10574           END-IF
 10575        END-IF
 10576     END-IF
 10577
 10578     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10579     IF WS-LF-JOINT-INDICATOR = 'J'
 10580        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10581        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10582            IF  PB-I-JOINT-AGE = ZERO
 10583                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 194
* EL050.cbl
 10584                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10585            ELSE
 10586                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10587                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10588                    IF PB-COMPANY-ID NOT = 'LBL'
 10589                        MOVE ER-2685    TO WS-ERROR
 10590                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10591
 10592     IF WS-AH-JOINT-INDICATOR = 'J'
 10593        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10594            IF  PB-I-JOINT-AGE = ZERO
 10595                MOVE ER-2686       TO WS-ERROR
 10596                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10597            ELSE
 10598                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10599                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10600                                           WS-EDIT-AGE
 10601                    IF PB-COMPANY-ID NOT = 'LBL'
 10602                        MOVE ER-2685    TO WS-ERROR
 10603                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10604
 10605******************************************************************
 10606*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10607******************************************************************
 10608
 10609     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10610        (WS-AH-SPECIAL-CALC-CD = 'O')
 10611        NEXT SENTENCE
 10612     ELSE
 10613        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10614          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10615           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10616            WS-AH-JOINT-INDICATOR = 'J')  AND
 10617           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10618            MOVE ER-2627             TO WS-ERROR
 10619            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10620
 10621     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10622        (WS-AH-SPECIAL-CALC-CD = 'O')
 10623         NEXT SENTENCE
 10624     ELSE
 10625         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10626            WS-AH-JOINT-INDICATOR = 'J'
 10627             IF PB-I-JOINT-INSURED = SPACES
 10628                 IF PB-COMPANY-ID NOT = 'JAL'
 10629                     MOVE ER-2696    TO WS-ERROR
 10630                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10631
 10632     IF PB-COMPANY-ID NOT = 'BOA'
 10633        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10634           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10635           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10636               PB-I-JOINT-INSURED NOT = SPACES)
 10637                MOVE ER-2691         TO WS-ERROR
 10638                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10639
 10640     IF PB-COMPANY-ID = 'BOA'
 10641        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 195
* EL050.cbl
 10642           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10643            IF PB-I-JOINT-AGE NOT = ZEROS
 10644                MOVE ER-2691         TO WS-ERROR
 10645                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10646
 10647     IF PB-COMPANY-ID = 'CRI'
 10648        IF PB-I-SIG-SW = 'J'
 10649           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10650              WS-AH-JOINT-INDICATOR NOT = 'J'
 10651              MOVE ER-2675       TO WS-ERROR
 10652              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10653
 10654     IF PB-COMPANY-ID = 'CRI'
 10655        IF PB-I-SIG-SW = 'S'
 10656           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10657              WS-AH-JOINT-INDICATOR = 'J'
 10658              MOVE ER-2676       TO WS-ERROR
 10659              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10660
 10661     IF PB-COMPANY-ID = 'CVL'
 10662         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10663            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10664              MOVE ER-2783           TO WS-ERROR
 10665              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10666     IF (WS-LF-JOINT-INDICATOR = 'J')
 10667        AND (WS-AH-JOINT-INDICATOR = 'J')
 10668        AND (PB-I-LF-TERM > 120)
 10669        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10670        MOVE ER-2783             TO WS-ERROR
 10671        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10672     END-IF
 10673     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10674
 10675     IF PB-I-INDV-GRP-OVRD = 'I'
 10676        MOVE ER-2666             TO WS-ERROR
 10677        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10678        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10679
 10680     IF PB-I-INDV-GRP-OVRD = 'G'
 10681        MOVE ER-2666             TO WS-ERROR
 10682        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10683        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10684
 10685     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10686        NEXT SENTENCE
 10687     ELSE
 10688        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10689
 10690     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10691        IF WS-ERROR = ER-2666
 10692           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10693           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10694
 10695     IF PB-COMPANY-ID = 'CID'
 10696        IF PB-STATE = 'UT' OR 'MO'
 10697           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10698                 OR '76' OR '77')
 10699                      OR
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 196
* EL050.cbl
 10700               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10701                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10702                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10703                   OR '2K' OR '2L'))
 10704              AND PB-I-INDV-GRP-CD = 'I'
 10705              MOVE ER-2721             TO WS-ERROR
 10706              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10707           END-IF
 10708        END-IF
 10709     END-IF
 10710
 10711     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10712     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10713        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10714     ELSE
 10715        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10716     END-IF
 10717
 10718*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10719*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10720     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10721                                    ACCOUNT-AH-CK-SW.
 10722
 10723     IF PB-REISSUED-CERT       OR
 10724        PB-REIN-ONLY-CERT      OR
 10725        PB-POLICY-IS-DECLINED  OR
 10726        PB-POLICY-IS-VOIDED
 10727*       OR PB-MONTHLY-CERT
 10728         GO TO 3000-CONTINUE-EDIT.
 10729
 10730     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10731        IF WS-EDIT-AGE           > +65
 10732           MOVE ER-2709          TO WS-ERROR
 10733           PERFORM 9900-ERROR-FORMAT
 10734                                 THRU 9900-EXIT
 10735        ELSE
 10736           IF WS-EDIT-AGE        > +55
 10737              MOVE ER-2718       TO WS-ERROR
 10738              PERFORM 9900-ERROR-FORMAT
 10739                                 THRU 9900-EXIT
 10740           END-IF
 10741        END-IF
 10742     IF PB-COMPANY-ID = 'DCC'
 10743        IF WS-EDIT-AGE           > +65
 10744           MOVE ER-2709          TO WS-ERROR
 10745           PERFORM 9900-ERROR-FORMAT
 10746                                 THRU 9900-EXIT
 10747        END-IF
 10748     END-IF
 10749     .
 10750
 10751 0565-LIFE-PLAN-LIMIT-EDITS.
 10752
 10753     IF NOT LF-PLAN-MASTER-FOUND
 10754        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10755                                    EC-AM-LF-MAX-TOT-BEN
 10756        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10757
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 197
* EL050.cbl
 10758     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10759
 10760     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10761         IF PL-LM-AGE (1) = ZEROS
 10762             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10763
 10764     IF NO-LF-BENEFIT-MATCH          OR
 10765        WS-LF-BENEFIT-CD = ZEROS     OR
 10766        WS-LF-SPECIAL-CALC-CD = 'M'
 10767        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10768
 10769     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10770     MOVE +1                     TO SUB2.
 10771
 10772     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10773        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10774           MOVE +5   TO SUB2
 10775           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10776              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10777              (PL-LM-AGE (SUB2) EQUAL +0)
 10778              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10779              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10780
 10781     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10782
 10783     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10784                               + PB-I-LF-ALT-BENEFIT-AMT.
 10785
 10786 0568-CHECK-LIFE-ATT-AGE.
 10787
 10788     IF PL-ATT-AGE NUMERIC AND
 10789        PL-ATT-AGE > +0
 10790        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10791     END-IF
 10792*    IF PL-ATT-AGE NUMERIC AND
 10793*       PL-ATT-AGE > +0
 10794*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10795*       IF PB-I-BIRTHDAY > LOW-VALUES
 10796*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10797*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10798*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10799*          SET BIN-PLUS-ELAPSED  TO TRUE
 10800*          PERFORM 8500-DATE-CONVERT
 10801*                                THRU 8500-EXIT
 10802*          IF NO-CONVERSION-ERROR
 10803*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10804*             MOVE ER-2669       TO WS-ERROR
 10805*             PERFORM 9900-ERROR-FORMAT
 10806*                                THRU 9900-EXIT
 10807*          END-IF
 10808*       ELSE
 10809*          IF WS-ATT-AGE >= PL-ATT-AGE
 10810*             MOVE ER-2669       TO WS-ERROR
 10811*             PERFORM 9900-ERROR-FORMAT
 10812*                                THRU 9900-EXIT
 10813*          END-IF
 10814*       END-IF
 10815*    END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 198
* EL050.cbl
 10816     .
 10817 0570-CHECK-LIFE-LIMITS.
 10818
 10819     IF PB-COMPANY-ID EQUAL 'CRI'
 10820        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10821           IF SUB2 GREATER THAN +4
 10822              MOVE ER-2637 TO WS-ERROR
 10823              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10824              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10825
 10826     IF PB-COMPANY-ID  =  'NCL'
 10827        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10828            SUB2 GREATER THAN +8
 10829             MOVE 'U'         TO PB-BATCH-ENTRY
 10830             MOVE ER-2637     TO WS-ERROR
 10831             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10832             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10833
 10834     IF SUB2 > +8
 10835        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10836           AND (PB-I-SIG-SW = 'Y')
 10837           CONTINUE
 10838        ELSE
 10839           MOVE ER-2637          TO WS-ERROR
 10840           PERFORM 9900-ERROR-FORMAT
 10841                                 THRU 9900-EXIT
 10842        END-IF
 10843        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10844     END-IF
 10845     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10846     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10847     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10848
 10849     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10850        ADD +1  TO SUB2
 10851        GO TO 0570-CHECK-LIFE-LIMITS.
 10852
 10853     IF PB-COMPANY-ID = 'NCL'
 10854         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10855
 10856     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10857        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10858        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10859           AND (PB-I-SIG-SW = 'Y')
 10860           CONTINUE
 10861        ELSE
 10862           MOVE ER-2637          TO WS-ERROR
 10863           PERFORM 9900-ERROR-FORMAT
 10864                                 THRU 9900-EXIT
 10865        END-IF
 10866     END-IF
 10867     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10868
 10869
 10870 0570-CHECK-NCL-LIFE-LIMITS.
 10871
 10872     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10873        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 199
* EL050.cbl
 10874         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10875
 10876     IF APP-CERT-USED
 10877         IF SUB2  LESS THAN  +5
 10878             MOVE +5          TO SUB2
 10879             GO TO 0570-CHECK-LIFE-LIMITS.
 10880
 10881     MOVE ER-2637             TO WS-ERROR.
 10882     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10883
 10884     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10885
 10886 0575-CHECK-NCL-SIG-SWITCH.
 10887
 10888     IF NOT APP-CERT-USED
 10889         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10890
 10891     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10892        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10893        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10894        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10895         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10896
 10897     IF SUB2 GREATER THAN +4
 10898         IF PL-LM-AGE (5) = ZEROS  AND
 10899            PL-LM-AGE (6) = ZEROS  AND
 10900            PL-LM-AGE (7) = ZEROS  AND
 10901            PL-LM-AGE (8) = ZEROS
 10902             MOVE  ER-1927        TO WS-ERROR
 10903             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10904             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10905         ELSE
 10906             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10907                 MOVE  ER-1920    TO WS-ERROR
 10908                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10909
 10910     IF PB-I-SIG-SW  = 'Y'
 10911       IF NOT PB-I-POLICY-ACCEPTED  AND
 10912          NOT PB-I-POLICY-DECLINED
 10913           MOVE 'U'               TO PB-BATCH-ENTRY
 10914           MOVE  ER-1926          TO WS-ERROR
 10915           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10916
 10917
 10918 0580-AH-PLAN-LIMIT-EDITS.
 10919
 10920     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10921        IF PB-I-AH-BENEFIT-AMT > +1250
 10922           MOVE ER-2702          TO WS-ERROR
 10923           PERFORM 9900-ERROR-FORMAT
 10924                                 THRU 9900-EXIT
 10925        END-IF
 10926     END-IF
 10927
 10928     IF (PB-COMPANY-ID = 'DCC')
 10929        AND (PB-MONTHLY-CERT)
 10930        IF PB-I-AH-BENEFIT-AMT > +3000
 10931           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 200
* EL050.cbl
 10932           PERFORM 9900-ERROR-FORMAT
 10933                                 THRU 9900-EXIT
 10934        END-IF
 10935     END-IF
 10936     IF NOT AH-PLAN-MASTER-FOUND
 10937        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10938        GO TO 3000-CONTINUE-EDIT.
 10939
 10940     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10941
 10942     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10943         IF PL-LM-AGE (1) = ZEROS
 10944             GO TO 3000-CONTINUE-EDIT.
 10945
 10946     IF NO-AH-BENEFIT-MATCH          OR
 10947        WS-AH-BENEFIT-CD = ZEROS     OR
 10948        WS-AH-SPECIAL-CALC-CD = 'M'
 10949        GO TO 3000-CONTINUE-EDIT.
 10950
 10951     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 10952     MOVE +1                     TO SUB2.
 10953
 10954     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10955        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10956           MOVE +5 TO SUB2
 10957           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10958              (PL-LM-MOA (SUB2) EQUAL +0) AND
 10959              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10960              (PL-LM-AGE (SUB2) EQUAL +0)
 10961              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 10962              GO TO 3000-CONTINUE-EDIT.
 10963
 10964     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 10965
 10966 0590-CHECK-AH-ATT-AGE.
 10967
 10968     IF PL-ATT-AGE NUMERIC AND
 10969        PL-ATT-AGE GREATER THAN +0
 10970        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 10971     END-IF
 10972*       IF WS-ATT-AGE >= PL-ATT-AGE
 10973*          MOVE ER-3054          TO WS-ERROR
 10974*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10975     .
 10976 0597-CHECK-AH-LIMITS.
 10977
 10978     IF PB-COMPANY-ID EQUAL 'CRI'
 10979        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10980           IF SUB2 GREATER THAN +4
 10981              MOVE ER-2638       TO WS-ERROR
 10982              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10983              GO TO 3000-CONTINUE-EDIT.
 10984
 10985     IF PB-COMPANY-ID  =  'NCL'
 10986        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10987            SUB2 GREATER THAN +8
 10988             MOVE 'U'            TO PB-BATCH-ENTRY
 10989             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 201
* EL050.cbl
 10990             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10991             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10992
 10993     IF SUB2 > +8
 10994        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10995           AND (PB-I-SIG-SW = 'Y')
 10996           CONTINUE
 10997        ELSE
 10998           MOVE ER-2638          TO WS-ERROR
 10999           PERFORM 9900-ERROR-FORMAT
 11000                                 THRU 9900-EXIT
 11001        END-IF
 11002        GO TO 3000-CONTINUE-EDIT
 11003     END-IF
 11004
 11005     IF PB-COMPANY-ID = 'CRI'
 11006        IF WS-ERROR = ER-2638
 11007           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11008
 11009     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11010     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11011     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11012     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11013
 11014     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11015        ADD +1                   TO SUB2
 11016        GO TO 0597-CHECK-AH-LIMITS.
 11017
 11018     IF PB-COMPANY-ID = 'NCL'
 11019         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11020
 11021     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11022        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11023        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11024                                 > PL-LM-AMT (SUB2))
 11025        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11026           AND (PB-I-SIG-SW = 'Y')
 11027           CONTINUE
 11028        ELSE
 11029           MOVE ER-2638          TO WS-ERROR
 11030           PERFORM 9900-ERROR-FORMAT
 11031                                 THRU 9900-EXIT
 11032        END-IF
 11033     END-IF
 11034
 11035     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11036         IF  WS-ERROR    EQUAL    ER-2638
 11037             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11038                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11039                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11040                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11041                MOVE  ER-1910    TO  WS-ERROR
 11042                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11043
 11044     IF PB-COMPANY-ID = 'CRI'
 11045        IF WS-ERROR = ER-2638
 11046            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11047            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 202
* EL050.cbl
 11048            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11049
 11050     GO TO 3000-CONTINUE-EDIT.
 11051
 11052 0597-CHECK-NCL-AH-LIMITS.
 11053
 11054     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11055        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11056        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11057                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11058         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11059
 11060     IF APP-CERT-USED
 11061         IF SUB2  LESS THAN  +5
 11062             MOVE +5             TO SUB2
 11063             GO TO 0597-CHECK-AH-LIMITS.
 11064
 11065     MOVE ER-2638                TO WS-ERROR.
 11066     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11067
 11068     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11069
 11070 0599-CHECK-NCL-SIG-SWITCH.
 11071
 11072     IF NOT APP-CERT-USED
 11073         GO TO 3000-CONTINUE-EDIT.
 11074
 11075     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11076        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11077        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11078        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11079         GO TO 3000-CONTINUE-EDIT.
 11080
 11081     IF SUB2 GREATER THAN +4
 11082         IF PL-LM-AGE (5) = ZEROS  AND
 11083            PL-LM-AGE (6) = ZEROS  AND
 11084            PL-LM-AGE (7) = ZEROS  AND
 11085            PL-LM-AGE (8) = ZEROS
 11086             MOVE  ER-1927        TO WS-ERROR
 11087             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11088             GO TO 3000-CONTINUE-EDIT
 11089         ELSE
 11090             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11091                 MOVE  ER-1920    TO WS-ERROR
 11092                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11093
 11094     IF PB-I-SIG-SW  = 'Y'
 11095       IF NOT PB-I-POLICY-ACCEPTED  AND
 11096          NOT PB-I-POLICY-DECLINED
 11097           MOVE 'U'               TO PB-BATCH-ENTRY
 11098           MOVE  ER-1926          TO WS-ERROR
 11099           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11100
 11101******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 203
* EL050.cbl
 11103
 11104 3000-CONTINUE-EDIT.
 11105
 11106     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11107     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11108     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11109     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11110     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11111
 11112     IF BROWSE-STARTED
 11113        PERFORM 9990-RETURN THRU 9990-EXIT
 11114        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11115
 11116     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11117        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11118        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11119        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11120*       MOVE 1                   TO DC-OPTION-CODE
 11121        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11122        IF DATE-CONVERSION-ERROR
 11123           MOVE ER-2622          TO WS-ERROR
 11124           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11125        ELSE
 11126           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11127              MOVE ER-2623       TO WS-ERROR
 11128              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11129           ELSE
 11130              MOVE ER-2622       TO WS-ERROR
 11131              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11132
 11133     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11134     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11135     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11136*    MOVE 1                      TO DC-OPTION-CODE.
 11137     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11138     IF DATE-CONVERSION-ERROR
 11139        GO TO 3005-EDIT-CONTINUE
 11140     ELSE
 11141        IF DC-ELAPSED-DAYS GREATER +180
 11142           MOVE ER-2613          TO WS-ERROR
 11143           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11144        ELSE
 11145           IF DC-ELAPSED-DAYS GREATER +90
 11146              MOVE ER-2612       TO WS-ERROR
 11147              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11148           ELSE
 11149             IF DC-ELAPSED-DAYS GREATER +60
 11150                MOVE ER-2614     TO WS-ERROR
 11151                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11152
 11153 3005-EDIT-CONTINUE.
 11154
 11155     IF PB-CANCELLATION
 11156         GO TO 3700-EDIT-CANCEL.
 11157
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 204
* EL050.cbl
 11159******************************************************************
 11160*                  E D I T   I S S U E                           *
 11161******************************************************************
 11162
 11163 3020-EDIT-ISSUE.
 11164
 11165      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11166      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11167      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11168      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11169      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11170
 11171     IF PB-ISSUE-FORCE
 11172        OR PB-ISSUE-DATE-FORCED
 11173        OR PB-FORCE-OFF
 11174        OR PB-OVERCHARGE-FORCE
 11175        CONTINUE
 11176     ELSE
 11177        MOVE ER-2670             TO WS-ERROR
 11178        PERFORM 9900-ERROR-FORMAT
 11179                                 THRU 9900-EXIT
 11180     END-IF
 11181     .
 11182 3022-SET-POLICY-STATUS.
 11183
 11184     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11185
 11186     IF (PB-REISSUED-CERT)
 11187             OR
 11188        ((PB-COMPANY-ID NOT = 'DCC')
 11189         AND (PB-MONTHLY-CERT))
 11190         MOVE '5'                TO PB-I-ENTRY-STATUS
 11191         MOVE 'E'                TO PB-BATCH-ENTRY
 11192     END-IF
 11193
 11194     IF PB-COMPANY-ID = 'DCC'
 11195        IF PB-MONTHLY-CERT
 11196           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11197        END-IF
 11198     END-IF
 11199     IF PB-POLICY-IS-DECLINED
 11200         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11201     IF PB-POLICY-IS-VOIDED
 11202         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11203     IF PB-NEEDS-UNDERWRITING
 11204         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11205     IF PB-REIN-ONLY-CERT
 11206         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11207     IF PB-PREM-ACCTNG-ONLY
 11208         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11209
 11210     MOVE SPACE                  TO PB-I-OB-FLAG.
 11211
 11212     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11213         MOVE ER-2665            TO WS-ERROR
 11214         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11215         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11216
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 205
* EL050.cbl
 11217     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11218        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11219           MOVE 'Z'             TO PB-I-OB-FLAG.
 11220
 11221     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11222        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11223           MOVE 'Z'             TO PB-I-OB-FLAG.
 11224
 11225     IF ACCOUNT-MAST-FOUND
 11226         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11227         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11228         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11229         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11230         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11231         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11232         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11233     END-IF
 11234
 11235     IF ACCOUNT-MAST-FOUND
 11236        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11237         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11238
 11239     IF (ACCOUNT-MAST-FOUND)
 11240        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11241        IF PB-REISSUED-CERT
 11242           CONTINUE
 11243        ELSE
 11244           MOVE ER-2608          TO WS-ERROR
 11245           PERFORM 9900-ERROR-FORMAT
 11246                                 THRU 9900-EXIT
 11247         END-IF
 11248     END-IF
 11249
 11250     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11251        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11252        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11253
 11254**********   DMD CUSTOM CODE FOLLOWS  **********
 11255 3024-EDIT-DMD-FIELDS.
 11256     IF PB-COMPANY-ID NOT = 'DMD'
 11257        GO TO 3025-EDIT-REINSURANCE.
 11258
 11259*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11260*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11261*** ERROR IF THEY ARE NOT EQUAL.
 11262
 11263     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11264     SET BIN-TO-GREG               TO TRUE.
 11265     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11266     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11267**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11268
 11269     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11270     SET BIN-TO-GREG               TO TRUE.
 11271     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11272     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11273**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11274
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 206
* EL050.cbl
 11275     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11276        MOVE ER-8116               TO WS-ERROR
 11277        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11278
 11279     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11280
 11281     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11282                                      WK-FULL-CERT-NO.
 11283     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11284
 11285     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11286
 11287     IF PB-VALID-LIFE
 11288        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11289     ELSE
 11290        IF PB-VALID-AH
 11291          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11292
 11293
 11294     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11295     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11296     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11297                                      DCUA-UNDRWRTR-CODE
 11298                                      DCUA-UNDRWRTR-GROUP-CODE
 11299                                      DCUA-RETURN-CODE.
 11300
 11301****************************************************************
 11302*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11303***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11304***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11305***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11306***   TO THIS RECORD.                                        ***
 11307****************************************************************
 11308     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11309     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11310     IF DCUA-SUCCESSFUL-PROCESS
 11311        GO TO 3024-EDIT-DL7-CONT.
 11312
 11313     IF DCUA-RETURN-CODE EQUAL '01'
 11314        MOVE ER-8110               TO WS-ERROR
 11315        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11316        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11317        GO TO 3024-EDIT-DL7-CONT.
 11318
 11319     IF DCUA-RETURN-CODE EQUAL '02'
 11320        MOVE ER-8111               TO WS-ERROR
 11321        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11322        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11323        GO TO 3024-EDIT-DL7-CONT.
 11324
 11325     IF DCUA-RETURN-CODE EQUAL '03'
 11326        MOVE ER-8074               TO WS-ERROR
 11327        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11328        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11329        GO TO 3024-EDIT-DL7-CONT.
 11330
 11331     IF DCUA-RETURN-CODE EQUAL '04'
 11332        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 207
* EL050.cbl
 11333        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11334        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11335        GO TO 3024-EDIT-DL7-CONT.
 11336
 11337     IF DCUA-RETURN-CODE EQUAL '05'
 11338        MOVE ER-8076               TO WS-ERROR
 11339        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11340        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11341        GO TO 3024-EDIT-DL7-CONT.
 11342
 11343     IF DCUA-RETURN-CODE EQUAL '06'
 11344        MOVE ER-8077               TO WS-ERROR
 11345        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11346        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11347        GO TO 3024-EDIT-DL7-CONT.
 11348
 11349     IF DCUA-RETURN-CODE EQUAL '07'
 11350        MOVE ER-8078               TO WS-ERROR
 11351        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11352        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11353        GO TO 3024-EDIT-DL7-CONT.
 11354
 11355     IF DCUA-RETURN-CODE EQUAL 'E1'
 11356        MOVE ER-8079               TO WS-ERROR
 11357        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11358        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11359        GO TO 3024-EDIT-DL7-CONT.
 11360
 11361     IF DCUA-RETURN-CODE EQUAL 'E2'
 11362        MOVE ER-8080               TO WS-ERROR
 11363        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11364        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11365        GO TO 3024-EDIT-DL7-CONT.
 11366
 11367     IF DCUA-RETURN-CODE EQUAL 'E3'
 11368        MOVE ER-8098               TO WS-ERROR
 11369        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11370        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11371        GO TO 3024-EDIT-DL7-CONT.
 11372
 11373     IF DCUA-RETURN-CODE EQUAL 'C1'
 11374        MOVE ER-8099               TO WS-ERROR
 11375        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11376        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11377        GO TO 3024-EDIT-DL7-CONT.
 11378
 11379     IF DCUA-RETURN-CODE EQUAL 'U1'
 11380        MOVE ER-8109               TO WS-ERROR
 11381        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11382        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11383        GO TO 3024-EDIT-DL7-CONT.
 11384
 11385     IF DCUA-RETURN-CODE EQUAL 'N1'
 11386        MOVE ER-8112               TO WS-ERROR
 11387        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11388        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11389        GO TO 3024-EDIT-DL7-CONT.
 11390
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 208
* EL050.cbl
 11391     IF DCUA-RETURN-CODE EQUAL 'N2'
 11392        MOVE ER-8113               TO WS-ERROR
 11393        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11394        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11395        GO TO 3024-EDIT-DL7-CONT.
 11396
 11397     IF DCUA-RETURN-CODE EQUAL 'N3'
 11398        MOVE ER-8114               TO WS-ERROR
 11399        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11400        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11401        GO TO 3024-EDIT-DL7-CONT.
 11402
 11403     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11404     MOVE ER-8097                  TO WS-ERROR.
 11405     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11406     GO TO 3024-EDIT-DL7-CONT.
 11407
 11408 3024-EDIT-DL7-CONT.
 11409
 11410     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11411     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11412     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11413        NEXT SENTENCE
 11414     ELSE
 11415        MOVE ER-9263               TO WS-ERROR
 11416        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11417
 11418******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11419******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11420     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11421        NEXT SENTENCE
 11422     ELSE
 11423        MOVE ER-8039               TO WS-ERROR
 11424        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11425
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 209
* EL050.cbl
 11427****************************************************************
 11428*** VALIDATE STATE  : DLO022                                 ***
 11429****************************************************************
 11430     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11431     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11432
 11433     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11434     IF DVSC-SUCCESSFUL-EDIT
 11435        GO TO 3024-EDIT-DL22-CONT.
 11436
 11437     IF DVSC-RETURN-CODE EQUAL '01'
 11438        MOVE ER-8300               TO WS-ERROR
 11439        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11440        GO TO 3024-EDIT-DL22-CONT.
 11441
 11442     IF DVSC-RETURN-CODE EQUAL '02'
 11443        MOVE ER-8301               TO WS-ERROR
 11444        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11445        GO TO 3024-EDIT-DL22-CONT.
 11446
 11447     IF DVSC-RETURN-CODE EQUAL '03'
 11448        MOVE ER-8302               TO WS-ERROR
 11449        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11450        GO TO 3024-EDIT-DL22-CONT.
 11451
 11452     IF DVSC-RETURN-CODE EQUAL 'N1'
 11453        MOVE ER-8304               TO WS-ERROR
 11454        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11455        GO TO 3024-EDIT-DL22-CONT.
 11456
 11457     MOVE ER-8303                  TO WS-ERROR
 11458     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11459
 11460 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 210
* EL050.cbl
 11462****************************************************************
 11463*** VALIDATE LOAN OFFICER : DLO021                           ***
 11464****************************************************************
 11465
 11466     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11467     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11468     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11469     IF DVLO-SUCCESSFUL-EDIT
 11470        GO TO 3024-EDIT-DL21-CONT.
 11471
 11472     IF DVLO-RETURN-CODE EQUAL '01'
 11473        MOVE ER-8081               TO WS-ERROR
 11474        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11475        GO TO 3024-EDIT-DL21-CONT.
 11476
 11477     IF DVLO-RETURN-CODE EQUAL '02'
 11478        MOVE ER-8082               TO WS-ERROR
 11479        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11480        GO TO 3024-EDIT-DL21-CONT.
 11481
 11482     IF DVLO-RETURN-CODE EQUAL '03'
 11483        MOVE ER-8083               TO WS-ERROR
 11484        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11485        GO TO 3024-EDIT-DL21-CONT.
 11486
 11487     IF DVLO-RETURN-CODE EQUAL '04'
 11488        MOVE ER-8084               TO WS-ERROR
 11489        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11490        GO TO 3024-EDIT-DL21-CONT.
 11491
 11492     IF DVLO-RETURN-CODE EQUAL '05'
 11493        MOVE ER-8085               TO WS-ERROR
 11494        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11495        GO TO 3024-EDIT-DL21-CONT.
 11496
 11497     MOVE ER-7825                  TO WS-ERROR
 11498     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11499     GO TO 3024-EDIT-DL21-CONT.
 11500
 11501 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 211
* EL050.cbl
 11503
 11504****************************************************************
 11505*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11506****************************************************************
 11507
 11508     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11509     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11510     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11511     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11512     IF DIPF-SUCCESSFUL-EDIT
 11513        GO TO 3024-EDIT-DL02-CONT.
 11514
 11515     IF DIPF-RETURN-CODE EQUAL '01'
 11516        MOVE ER-8086               TO WS-ERROR
 11517        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11518        GO TO 3024-EDIT-DL02-CONT.
 11519
 11520     IF DIPF-RETURN-CODE EQUAL '02'
 11521        MOVE ER-8087               TO WS-ERROR
 11522        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11523        GO TO 3024-EDIT-DL02-CONT.
 11524
 11525     IF DIPF-RETURN-CODE EQUAL '03'
 11526        MOVE ER-8088               TO WS-ERROR
 11527        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11528        GO TO 3024-EDIT-DL02-CONT.
 11529
 11530     MOVE ER-8095                  TO WS-ERROR
 11531     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11532     GO TO 3024-EDIT-DL02-CONT.
 11533
 11534 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 212
* EL050.cbl
 11536
 11537****************************************************************
 11538*** VALIDATE BANK ID : DLO003                                ***
 11539****************************************************************
 11540
 11541     MOVE WK-GREG-CENT           TO WCG-CENT.
 11542     MOVE WK-GREG-YYMM           TO WCG-REST.
 11543     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11544        MOVE ER-8040               TO WS-ERROR
 11545        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11546
 11547     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11548     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11549     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11550     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11551     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11552     IF DVBI-SUCCESSFUL-EDIT
 11553        GO TO 3024-EDIT-DL03-CONT.
 11554
 11555     IF DVBI-RETURN-CODE EQUAL '01'
 11556        MOVE ER-8089               TO WS-ERROR
 11557        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11558        GO TO 3024-EDIT-DL03-CONT.
 11559
 11560     IF DVBI-RETURN-CODE EQUAL '02'
 11561        MOVE ER-8090               TO WS-ERROR
 11562        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11563        GO TO 3024-EDIT-DL03-CONT.
 11564
 11565     IF DVBI-RETURN-CODE EQUAL '03'
 11566        MOVE ER-8091               TO WS-ERROR
 11567        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11568        GO TO 3024-EDIT-DL03-CONT.
 11569
 11570     IF DVBI-RETURN-CODE EQUAL '04'
 11571        MOVE ER-8092               TO WS-ERROR
 11572        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11573        GO TO 3024-EDIT-DL03-CONT.
 11574
 11575     IF DVBI-RETURN-CODE EQUAL '05'
 11576        MOVE ER-8093               TO WS-ERROR
 11577        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11578        GO TO 3024-EDIT-DL03-CONT.
 11579
 11580     IF DVBI-RETURN-CODE EQUAL '06'
 11581        MOVE ER-8094               TO WS-ERROR
 11582        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11583        GO TO 3024-EDIT-DL03-CONT.
 11584
 11585     MOVE ER-8096                  TO WS-ERROR
 11586     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11587     GO TO 3024-EDIT-DL03-CONT.
 11588
 11589 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 213
* EL050.cbl
 11591
 11592     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11593        NEXT SENTENCE
 11594     ELSE
 11595        MOVE ER-8042               TO WS-ERROR
 11596        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11597
 11598     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11599     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11600     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11601
 11602     IF DMPF-RETURN-CODE = '01'
 11603        MOVE ER-8067               TO WS-ERROR
 11604        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11605        GO TO 3024-EDIT-DL01-CONT.
 11606
 11607     IF DMPF-RETURN-CODE = '02'
 11608        MOVE ER-8068               TO WS-ERROR
 11609        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11610        GO TO 3024-EDIT-DL01-CONT.
 11611
 11612     IF DMPF-RETURN-CODE = '03'
 11613        MOVE ER-8069               TO WS-ERROR
 11614        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11615        GO TO 3024-EDIT-DL01-CONT.
 11616
 11617     IF DMPF-RETURN-CODE = 'E1'
 11618        MOVE ER-8070               TO WS-ERROR
 11619        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11620        GO TO 3024-EDIT-DL01-CONT.
 11621
 11622     IF DMPF-RETURN-CODE = 'N1'
 11623        MOVE ER-8071               TO WS-ERROR
 11624        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11625        GO TO 3024-EDIT-DL01-CONT.
 11626
 11627     IF DMPF-RETURN-CODE NOT = 'OK'
 11628        MOVE ER-8072               TO WS-ERROR
 11629        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11630
 11631 3024-EDIT-DL01-CONT.
 11632******************************************************************
 11633***  VALIDATES RATE CODES : DLO017                             ***
 11634******************************************************************
 11635
 11636      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11637      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11638      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11639      IF DVRC-SUCCESSFUL-EDIT
 11640        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11641        GO TO 3024-CHECK-VALID-RATE.
 11642
 11643      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11644
 11645      IF DVRC-RETURN-CODE EQUAL '01'
 11646         MOVE ER-7817                   TO WS-ERROR
 11647         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11648         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 214
* EL050.cbl
 11649
 11650      IF DVRC-RETURN-CODE EQUAL '02'
 11651         MOVE ER-7818                   TO WS-ERROR
 11652         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11653         GO TO 3025-EDIT-REINSURANCE.
 11654
 11655      IF DVRC-RETURN-CODE EQUAL '03'
 11656         MOVE ER-7819                   TO WS-ERROR
 11657         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11658         GO TO 3025-EDIT-REINSURANCE.
 11659
 11660       MOVE ER-7820                     TO WS-ERROR.
 11661       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11662       GO TO 3025-EDIT-REINSURANCE.
 11663
 11664******************************************************************
 11665***  GET PREMIUM RATES : DLO011                                ***
 11666******************************************************************
 11667
 11668 3024-CHECK-VALID-RATE.
 11669
 11670     IF VALID-RATE-CODE
 11671        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11672        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11673        MOVE SPACES                TO DPRB-RETURN-CODE
 11674        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11675     ELSE
 11676         GO TO 3025-EDIT-REINSURANCE.
 11677
 11678      IF DPRB-SUCCESSFUL-PROCESS
 11679         IF PB-VALID-LIFE
 11680             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11681             GO TO 3025-EDIT-REINSURANCE
 11682         ELSE
 11683             IF PB-VALID-AH
 11684                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11685                 GO TO 3025-EDIT-REINSURANCE.
 11686
 11687      IF DPRB-RETURN-CODE EQUAL '01'
 11688         MOVE ER-7812                   TO WS-ERROR
 11689         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11690         GO TO 3025-EDIT-REINSURANCE.
 11691
 11692      IF DPRB-RETURN-CODE EQUAL '02'
 11693         MOVE ER-7813                   TO WS-ERROR
 11694         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11695         GO TO 3025-EDIT-REINSURANCE.
 11696
 11697      IF DPRB-RETURN-CODE EQUAL '03'
 11698         MOVE ER-7814                   TO WS-ERROR
 11699         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11700         GO TO 3025-EDIT-REINSURANCE.
 11701
 11702      IF DPRB-RETURN-CODE EQUAL '04'
 11703         IF NOT DPRB-1ST-TIME
 11704            MOVE ER-7815                   TO WS-ERROR
 11705            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11706            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 215
* EL050.cbl
 11707          ELSE
 11708         IF PB-VALID-LIFE
 11709            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11710          ELSE
 11711            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11712         END-IF
 11713         MOVE SPACES                TO DOCC-RETURN-CODE
 11714         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11715         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11716         IF DOCC-RETURN-CODE = 'OK'
 11717             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11718             GO TO 3024-CHECK-VALID-RATE
 11719           ELSE
 11720             MOVE ER-7823               TO WS-ERROR
 11721             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11722             GO TO 3025-EDIT-REINSURANCE.
 11723
 11724       MOVE ER-7816                     TO WS-ERROR.
 11725       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11726       GO TO 3025-EDIT-REINSURANCE.
 11727
 11728**********   DMD CUSTOM CODE ABOVE    **********
 11729
 11730 3025-EDIT-REINSURANCE.
 11731     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11732         GO TO 3027-EDIT-CONTINUE.
 11733
 11734     MOVE LOW-VALUES               TO ERREIN-KEY.
 11735     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11736     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11737                                      REIN-CODE-2
 11738                                      REIN-CODE-3.
 11739     MOVE 'A'                      TO REIN-TYPE.
 11740
 11741     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11742
 11743     MOVE '3026' TO REIN-SW.
 11744     MOVE ' '                   TO WS-REIN-READ-SW.
 11745
 11746     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11747     IF REIN-TABLE-NOT-FOUND
 11748         GO TO 3026-NO-SPEC-TABLE.
 11749
 11750     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11751     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11752                                   WS-NSP-ST-CD-LF.
 11753     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11754                                   WS-NSP-ST-CD-AH.
 11755
 11756     GO TO 3040-EDIT-CONTINUE.
 11757
 11758 3026-NO-SPEC-TABLE.
 11759
 11760     MOVE ER-2664                TO WS-ERROR.
 11761     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11762     GO TO 3040-EDIT-CONTINUE.
 11763
 11764 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 216
* EL050.cbl
 11765
 11766     IF PB-I-REIN-TABLE = SPACES
 11767       GO TO 3040-EDIT-CONTINUE.
 11768
 11769     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11770          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11771          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11772           GO TO 3040-EDIT-CONTINUE.
 11773
 11774     MOVE LOW-VALUES            TO ERREIN-KEY.
 11775     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11776     MOVE 'A'                   TO REIN-TYPE.
 11777     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11778
 11779     MOVE '3028'                TO REIN-SW.
 11780     MOVE ' '                   TO WS-REIN-READ-SW.
 11781
 11782     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11783     IF REIN-TABLE-NOT-FOUND
 11784         GO TO 3028-NO-REIN-TABLE.
 11785
 11786     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11787     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11788                                   WS-NSP-ST-CD-LF.
 11789     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11790                                   WS-NSP-ST-CD-AH.
 11791
 11792     GO TO 3040-EDIT-CONTINUE.
 11793
 11794 3028-NO-REIN-TABLE.
 11795
 11796     MOVE ER-2615                TO WS-ERROR.
 11797     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11798     GO TO 3040-EDIT-CONTINUE.
 11799
 11800 3040-EDIT-CONTINUE.
 11801
 11802     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11803         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11804
 11805     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11806         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11807
 11808     IF (NOT PB-REISSUED-CERT)
 11809        AND (NOT PB-MONTHLY-CERT)
 11810        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11811            MOVE '001'           TO PB-I-LF-TERM
 11812            MOVE 'M'             TO PB-I-INSURED-SEX.
 11813
 11814     IF (NOT PB-REISSUED-CERT)
 11815        AND (NOT PB-MONTHLY-CERT)
 11816        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11817            MOVE '001'           TO PB-I-AH-TERM
 11818            MOVE 'M'             TO PB-I-INSURED-SEX.
 11819
 11820 3040-EDIT-1ST-PMT-DT.
 11821     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11822     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 217
* EL050.cbl
 11823         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11824
 11825******************************************************************
 11826*                                                                *
 11827*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11828*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11829*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11830*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11831*                                                                *
 11832******************************************************************
 11833
 11834     IF PB-EFF-DT-PROCESSING
 11835        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11836                                    PB-I-LF-EXPIRE-DT
 11837                                    PB-I-AH-EXPIRE-DT
 11838        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11839        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11840        MOVE ZERO                TO DC-ELAPSED-DAYS
 11841        MOVE +1                  TO DC-ELAPSED-MONTHS
 11842        SET BIN-PLUS-ELAPSED     TO TRUE
 11843*       MOVE 6                   TO DC-OPTION-CODE
 11844        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11845        IF NO-CONVERSION-ERROR
 11846           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11847
 11848******************************************************************
 11849*                                                                *
 11850*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11851*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11852*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11853*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11854*                                                                *
 11855******************************************************************
 11856
 11857     IF PB-EXT-DAYS-PROCESSING
 11858          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11859                                         PB-I-LF-EXPIRE-DT
 11860                                         PB-I-AH-EXPIRE-DT
 11861          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11862          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11863          MOVE +1                     TO DC-ELAPSED-MONTHS
 11864          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11865          SET BIN-PLUS-ELAPSED        TO TRUE
 11866*         MOVE 6                      TO DC-OPTION-CODE
 11867          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11868          IF NO-CONVERSION-ERROR
 11869             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11870
 11871******************************************************************
 11872*                                                                *
 11873*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11874*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11875*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11876*        (EXPIRE DATE - (TERM -1))  *  -1.
 11877*                                                                *
 11878******************************************************************
 11879
 11880     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 218
* EL050.cbl
 11881        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11882           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11883              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11884              MOVE PB-I-AH-TERM      TO WS-TERM
 11885           ELSE
 11886              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11887              MOVE PB-I-LF-TERM      TO WS-TERM
 11888        ELSE
 11889           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11890              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11891              MOVE PB-I-LF-TERM      TO WS-TERM
 11892           ELSE
 11893              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11894              MOVE PB-I-AH-TERM      TO WS-TERM.
 11895
 11896     IF PB-EXPIRE-DT-PROCESSING
 11897        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11898        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11899        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11900        MOVE ZERO                TO DC-ELAPSED-DAYS
 11901                                    DC-ODD-DAYS-OVER
 11902          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11903          SET BIN-PLUS-ELAPSED    TO TRUE
 11904*         MOVE 6                  TO DC-OPTION-CODE
 11905          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11906          IF NO-CONVERSION-ERROR
 11907             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11908
 11909******************************************************************
 11910*                                                                *
 11911*            1ST PAYMENT DATE PROCESSING                         *
 11912*                                                                *
 11913******************************************************************
 11914
 11915     IF PB-1ST-PMT-DT-PROCESSING
 11916        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11917                                    PB-I-AH-EXPIRE-DT
 11918        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11919
 11920     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11921         NEXT SENTENCE
 11922     ELSE
 11923         MOVE ER-2680                 TO WS-ERROR
 11924         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11925         GO TO 3060-ORIG-TERM-CHECK.
 11926
 11927     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11928     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11929     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11930*    MOVE 1                      TO DC-OPTION-CODE.
 11931     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11932                                    DC-ELAPSED-DAYS
 11933                                    DC-ODD-DAYS-OVER.
 11934
 11935     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11936
 11937     IF DATE-CONVERSION-ERROR
 11938        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 219
* EL050.cbl
 11939
 11940     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11941     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 11942        AND (WS-LF-COVERAGE-TYPE = 'L')
 11943        IF (DC-ELAPSED-MONTHS > 1)
 11944                      OR
 11945           ((DC-ELAPSED-MONTHS = 1)
 11946           AND (DC-ODD-DAYS-OVER > 0))
 11947           MOVE ER-2882          TO WS-ERROR
 11948           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11949        END-IF
 11950     END-IF
 11951     if dc-elapsed-months > 0
 11952        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 11953        + dc-odd-days-over
 11954     end-if
 11955     IF PB-EXT-DAYS-PROCESSING
 11956        CONTINUE
 11957     ELSE
 11958        IF DC-ELAPSED-MONTHS = +0
 11959           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 11960        ELSE
 11961           IF (WS-LF-EARNINGS-CALC = '4')
 11962              AND (DC-ELAPSED-MONTHS > ZERO)
 11963              AND (DC-ELAPSED-DAYS > ZERO)
 11964              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 11965           ELSE
 11966              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 11967                                 THRU 6499-EXIT
 11968              MOVE WS-ODD-DAYS-OVER
 11969                                 TO PB-I-EXTENTION-DAYS
 11970           END-IF
 11971        END-IF
 11972     END-IF
 11973******************************************************************
 11974*                                                                *
 11975*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 11976*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 11977*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 11978*            AND ANY ODD DAYS.                                   *
 11979*                                                                *
 11980******************************************************************
 11981
 11982     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 11983                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 11984     IF WS-LF-EARNINGS-CALC NOT = '4'
 11985        IF DC-ELAPSED-DAYS > ZEROS
 11986           MOVE ER-2681          TO WS-ERROR
 11987           PERFORM 9900-ERROR-FORMAT
 11988                                 THRU 9900-EXIT
 11989        END-IF
 11990     END-IF
 11991
 11992     IF WS-LF-EARNINGS-CALC NOT = '4'
 11993        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 11994           MOVE ER-2681          TO WS-ERROR
 11995           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11996
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 220
* EL050.cbl
 11997     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 11998        (PB-I-LF-TERM NOT = ZERO) AND
 11999         NOT NO-LIFE-COVERAGE
 12000          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12001          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12002          IF WS-LF-EARNINGS-CALC = '4'
 12003             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12004             PB-I-PAY-FREQUENCY
 12005          END-IF
 12006          MOVE ZERO              TO DC-ELAPSED-DAYS
 12007                                    DC-ODD-DAYS-OVER
 12008          MOVE 1                 TO DC-END-OF-MONTH
 12009          SET BIN-PLUS-ELAPSED        TO TRUE
 12010*         MOVE 6                 TO DC-OPTION-CODE
 12011          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12012          IF NO-CONVERSION-ERROR
 12013             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12014             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12015                (WS-LF-SPECIAL-CALC-CD = 'L')
 12016                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12017                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12018                  MOVE +1             TO DC-ELAPSED-MONTHS
 12019                  SET BIN-PLUS-ELAPSED  TO TRUE
 12020*                 MOVE 6              TO DC-OPTION-CODE
 12021                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12022                  IF NO-CONVERSION-ERROR
 12023                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12024
 12025* okay, i had to move the new att age edit down here because the
 12026* expiration date could get recalculated and i need the exp date
 12027     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12028        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12029        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12030        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12031           AND ZEROS
 12032           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12033           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12034           SET ELAPSED-BETWEEN-BIN TO TRUE
 12035           PERFORM 8500-DATE-CONVERT
 12036                                 THRU 8500-EXIT
 12037           IF NO-CONVERSION-ERROR
 12038              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12039                 MOVE ER-2669       TO WS-ERROR
 12040*                PERFORM 9900-ERROR-FORMAT
 12041*                                THRU 9900-EXIT
 12042              END-IF
 12043           END-IF
 12044        ELSE
 12045           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12046           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12047              MOVE ER-2669       TO WS-ERROR
 12048*             PERFORM 9900-ERROR-FORMAT
 12049*                                THRU 9900-EXIT
 12050           ELSE
 12051              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12052                 MOVE ER-1570    TO WS-ERROR
 12053                 PERFORM 9900-ERROR-FORMAT
 12054                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 221
* EL050.cbl
 12055              END-IF
 12056           END-IF
 12057        END-IF
 12058        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12059           AND ZEROS
 12060           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12061           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12062           SET ELAPSED-BETWEEN-BIN TO TRUE
 12063           PERFORM 8500-DATE-CONVERT
 12064                                 THRU 8500-EXIT
 12065           IF NO-CONVERSION-ERROR
 12066              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12067                 MOVE ER-2669       TO WS-ERROR
 12068*                PERFORM 9900-ERROR-FORMAT
 12069*                                THRU 9900-EXIT
 12070              END-IF
 12071           END-IF
 12072        ELSE
 12073           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12074             (PB-I-LF-TERM / 12)
 12075           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12076              MOVE ER-2669       TO WS-ERROR
 12077*             PERFORM 9900-ERROR-FORMAT
 12078*                                THRU 9900-EXIT
 12079           ELSE
 12080              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12081                 MOVE ER-1571    TO WS-ERROR
 12082                 PERFORM 9900-ERROR-FORMAT
 12083                                 THRU 9900-EXIT
 12084              END-IF
 12085           END-IF
 12086        END-IF
 12087        IF WS-ERROR = ER-2669
 12088           PERFORM 9900-ERROR-FORMAT
 12089                                 THRU 9900-EXIT
 12090        END-IF
 12091     END-IF
 12092     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12093        (PB-I-AH-TERM NOT = ZERO) AND
 12094         NOT NO-AH-COVERAGE
 12095          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12096             AND (PB-COMPANY-ID = 'DCC')
 12097             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12098             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12099          ELSE
 12100             IF WS-LF-EARNINGS-CALC = '4'
 12101                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12102                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12103                PB-I-PAY-FREQUENCY
 12104             ELSE
 12105                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12106                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12107             END-IF
 12108          END-IF
 12109          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12110                                         DC-ODD-DAYS-OVER
 12111          MOVE 1                      TO DC-END-OF-MONTH
 12112          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 222
* EL050.cbl
 12113*         MOVE 6                      TO DC-OPTION-CODE
 12114          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12115          IF NO-CONVERSION-ERROR
 12116             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12117     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12118        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12119        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12120        IF PB-I-BIRTHDAY > LOW-VALUES
 12121           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12122           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12123           SET ELAPSED-BETWEEN-BIN TO TRUE
 12124           PERFORM 8500-DATE-CONVERT
 12125                                 THRU 8500-EXIT
 12126           IF NO-CONVERSION-ERROR
 12127              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12128                 MOVE ER-3054       TO WS-ERROR
 12129*                PERFORM 9900-ERROR-FORMAT
 12130*                                THRU 9900-EXIT
 12131              END-IF
 12132           END-IF
 12133        ELSE
 12134           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12135           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12136              MOVE ER-3054       TO WS-ERROR
 12137*             PERFORM 9900-ERROR-FORMAT
 12138*                                THRU 9900-EXIT
 12139           END-IF
 12140        END-IF
 12141        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12142           AND ZEROS
 12143           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12144           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12145           SET ELAPSED-BETWEEN-BIN TO TRUE
 12146           PERFORM 8500-DATE-CONVERT
 12147                                 THRU 8500-EXIT
 12148           IF NO-CONVERSION-ERROR
 12149              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12150                 MOVE ER-3054       TO WS-ERROR
 12151*                PERFORM 9900-ERROR-FORMAT
 12152*                                THRU 9900-EXIT
 12153              END-IF
 12154           END-IF
 12155        ELSE
 12156           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12157             (PB-I-AH-TERM / 12)
 12158           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12159              MOVE ER-3054       TO WS-ERROR
 12160*             PERFORM 9900-ERROR-FORMAT
 12161*                                THRU 9900-EXIT
 12162           END-IF
 12163        END-IF
 12164        IF WS-ERROR = ER-3054
 12165           PERFORM 9900-ERROR-FORMAT
 12166                                 THRU 9900-EXIT
 12167        END-IF
 12168     END-IF
 12169     MOVE SPACE                       TO DC-END-OF-MONTH.
 12170
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 223
* EL050.cbl
 12171     IF PB-COMPANY-ID = 'NCB'
 12172        GO TO 3040-EDIT-EXTENSION-DAYS.
 12173
 12174     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12175       AND
 12176        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12177        NEXT SENTENCE
 12178     ELSE
 12179        GO TO 3040-EDIT-EXTENSION-DAYS.
 12180
 12181     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12182        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12183        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12184     ELSE
 12185        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12186        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12187
 12188     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12189*    MOVE '1'      TO DC-OPTION-CODE
 12190     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12191     IF (NO-CONVERSION-ERROR)
 12192        AND (DC-ELAPSED-MONTHS > +1)
 12193        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12194        MOVE ER-2668   TO WS-ERROR
 12195        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12196
 12197 3040-EDIT-EXTENSION-DAYS.
 12198
 12199     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12200        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12201         GO TO 3050-EDIT-TERM-IN-DAYS
 12202     ELSE
 12203         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12204
 12205     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12206         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12207     ELSE
 12208        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12209           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12210           MOVE ER-2681         TO WS-ERROR
 12211           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12212
 12213     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12214        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12215        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12216         GO TO 3060-ORIG-TERM-CHECK.
 12217
 12218     GO TO 3060-ORIG-TERM-CHECK.
 12219
 12220 3050-EDIT-TERM-IN-DAYS.
 12221
 12222     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12223
 12224     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12225         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12226     ELSE
 12227         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12228            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 224
* EL050.cbl
 12229            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12230
 12231     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12232                                       REMAINDER WS-WORK-TERM.
 12233     IF WS-WORK-TERM GREATER THAN ZERO
 12234         ADD +1 TO PB-I-LF-TERM.
 12235
 12236     IF NOT NO-AH-COVERAGE
 12237         MOVE ER-2684            TO WS-ERROR
 12238         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12239
 12240
 12241 3060-ORIG-TERM-CHECK.
 12242
 12243******************************************************************
 12244*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12245******************************************************************
 12246
 12247     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12248        NEXT SENTENCE
 12249     ELSE
 12250        IF NOT NO-LIFE-COVERAGE
 12251           IF PB-I-LF-TERM NUMERIC
 12252              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12253              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12254              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12255                  NEXT SENTENCE
 12256           ELSE
 12257              MOVE ER-2647       TO WS-ERROR
 12258              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12259
 12260     IF NOT NO-AH-COVERAGE
 12261         IF PB-I-AH-TERM NUMERIC
 12262            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12263            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12264            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12265             NEXT SENTENCE
 12266          ELSE
 12267              MOVE ER-2658       TO WS-ERROR
 12268              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12269
 12270     IF PB-COMPANY-ID = 'NCB'
 12271        GO TO 3070-LOAN-TERM-CHECK.
 12272
 12273     IF POLICY-HAS-AH
 12274       AND
 12275        POLICY-HAS-LIFE
 12276       AND
 12277        PB-I-LF-TERM NUMERIC
 12278       AND
 12279        PB-I-AH-TERM NUMERIC
 12280        NEXT SENTENCE
 12281     ELSE
 12282        GO TO 3070-LOAN-TERM-CHECK.
 12283
 12284     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12285     IF WS-TEX-FACT-2 LESS THAN +0
 12286        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 225
* EL050.cbl
 12287
 12288     IF WS-TEX-FACT-2 GREATER THAN +1
 12289        MOVE ER-2668             TO WS-ERROR
 12290        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12291
 12292 3070-LOAN-TERM-CHECK.
 12293
 12294     IF (WS-LF-BENEFIT-CD = ZERO)
 12295         OR (NO-LF-BENEFIT-MATCH)
 12296            GO TO 3125-EDIT-PMT-FREQ.
 12297*    IF PB-COMPANY-ID NOT = 'DCC'
 12298*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12299*          AND 'V' AND 'W' AND 'X'
 12300*          GO TO 3125-EDIT-PMT-FREQ
 12301*       END-IF
 12302*    ELSE
 12303*       IF WS-AH-DCC-TRUNC = 'T'
 12304*          CONTINUE
 12305*       ELSE
 12306*          GO TO 3125-EDIT-PMT-FREQ
 12307*       END-IF
 12308*    END-IF
 12309     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12310                    OR
 12311        ((PB-COMPANY-ID = 'DCC')
 12312        AND (WS-AH-DCC-TRUNC = 'T'))
 12313        CONTINUE
 12314     ELSE
 12315        GO TO 3125-EDIT-PMT-FREQ
 12316     END-IF
 12317     IF PB-I-LOAN-TERM NOT NUMERIC
 12318         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12319
 12320     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12321        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12322*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12323        PB-I-LOAN-TERM NOT GREATER THAN +360
 12324         NEXT SENTENCE
 12325     ELSE
 12326         MOVE ER-2648            TO WS-ERROR
 12327         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12328
 12329     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12330        MOVE ER-3058             TO WS-ERROR
 12331        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12332     end-if
 12333
 12334     IF WS-STATE-ABBREVIATION = 'NC'
 12335        IF PB-I-LOAN-TERM > +59
 12336           CONTINUE
 12337        ELSE
 12338           MOVE ER-2792          TO WS-ERROR
 12339           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12340        END-IF
 12341     END-IF
 12342
 12343     .
 12344 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 226
* EL050.cbl
 12345     IF (WS-LF-BENEFIT-CD = ZERO)
 12346         OR (NO-LF-BENEFIT-MATCH)
 12347            GO TO 3127-EDIT-LOAN-OFFICER.
 12348     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12349                    OR
 12350        ((PB-COMPANY-ID = 'DCC')
 12351        AND (WS-AH-DCC-TRUNC = 'T'))
 12352                    OR
 12353         (PB-COMPANY-ID = 'AHL')
 12354        CONTINUE
 12355     ELSE
 12356        IF (PB-I-LOAN-TERM > ZEROS)
 12357           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12358           MOVE ER-1575          TO WS-ERROR
 12359           PERFORM 9900-ERROR-FORMAT
 12360                                 THRU 9900-EXIT
 12361        END-IF
 12362     END-IF
 12363     IF WS-LF-EARNINGS-CALC NOT = '4'
 12364         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12365            MOVE ER-2653         TO WS-ERROR
 12366            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12367            GO TO 3127-EDIT-LOAN-OFFICER
 12368         ELSE
 12369            GO TO 3127-EDIT-LOAN-OFFICER.
 12370
 12371     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12372         MOVE ER-2655            TO WS-ERROR
 12373         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12374         GO TO 3127-EDIT-LOAN-OFFICER.
 12375
 12376     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12377         MOVE ER-2654            TO WS-ERROR
 12378         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12379         GO TO 3127-EDIT-LOAN-OFFICER.
 12380
 12381     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12382         GIVING WS-TEX-FACT-2
 12383             REMAINDER WS-TEX-FACT-3.
 12384
 12385*    IF WS-TEX-FACT-3 NOT = ZERO
 12386*       MOVE ER-2654             TO WS-ERROR
 12387*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12388
 12389
 12390 3127-EDIT-LOAN-OFFICER.
 12391
 12392     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12393        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12394           MOVE ER-2690          TO WS-ERROR
 12395           PERFORM 9900-ERROR-FORMAT
 12396                                 THRU 9900-EXIT
 12397        ELSE
 12398           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12399           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12400           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12401           MOVE PB-SV-STATE      TO LOFC-STATE
 12402           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 227
* EL050.cbl
 12403           MOVE PB-I-LOAN-OFFICER
 12404                                 TO LOFC-CODE
 12405           PERFORM 8586-READ-LOAN-OFFICER
 12406                                 THRU 8586-EXIT
 12407           IF (NOT LOFC-MASTER-FOUND)
 12408              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12409              MOVE ER-3006       TO WS-ERROR
 12410              PERFORM 9900-ERROR-FORMAT
 12411                                 THRU 9900-EXIT
 12412           END-IF
 12413        END-IF
 12414     END-IF
 12415     .
 12416 3129-EDIT-APR.
 12417
 12418     IF (WS-LF-BENEFIT-CD = ZERO)
 12419        OR (NO-LF-BENEFIT-MATCH)
 12420        IF PB-COMPANY-ID NOT = 'DCC'
 12421           GO TO 3130-EDIT-AGE
 12422*       ELSE
 12423*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12424*             GO TO 3130-EDIT-AGE
 12425*          END-IF
 12426        END-IF
 12427     END-IF
 12428
 12429     IF (WS-STATE-ABBREVIATION = 'OH')
 12430         AND (PB-I-RATE-CLASS NOT = 'L ')
 12431         AND (PB-I-LF-TERM GREATER THAN 60)
 12432         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12433         GO TO 3129-APR-CONT.
 12434
 12435     IF (WS-STATE-ABBREVIATION = 'RI')
 12436         AND (PB-I-LF-TERM GREATER THAN 60)
 12437         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12438         GO TO 3129-APR-CONT.
 12439
 12440     IF (WS-STATE-ABBREVIATION = 'UT')
 12441         AND (PB-I-LF-TERM GREATER THAN 62)
 12442         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12443         AND (PB-CERT-EFF-DT LESS WS-830901)
 12444         GO TO 3129-APR-CONT.
 12445
 12446     IF PB-COMPANY-ID = 'LAP'
 12447        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12448           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12449              MOVE ER-2656         TO WS-ERROR
 12450              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12451              GO TO 3130-EDIT-AGE.
 12452
 12453     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12454        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12455        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12456        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12457        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12458        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12459         GO TO 3130-EDIT-AGE.
 12460
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 228
* EL050.cbl
 12461 3129-APR-CONT.
 12462     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12463         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12464         GO TO 3130-EDIT-AGE.
 12465
 12466     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12467         WS-AH-BENEFIT-CD (1:1) = 'S')
 12468        AND (PB-COMPANY-ID = 'DCC')
 12469        AND (PB-I-LOAN-APR = ZERO)
 12470        MOVE ER-2657             TO WS-ERROR
 12471        PERFORM 9900-ERROR-FORMAT
 12472                                 THRU 9900-EXIT
 12473        GO TO 3130-EDIT-AGE
 12474     END-IF
 12475     IF PB-I-LOAN-APR = ZERO
 12476        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12477     END-IF
 12478
 12479     IF PB-I-LOAN-APR = ZERO
 12480        MOVE ER-2656             TO WS-ERROR
 12481        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12482        GO TO 3130-EDIT-AGE.
 12483
 12484*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12485     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000
 12486        MOVE ER-2657             TO WS-ERROR
 12487        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12488
 12489 3130-EDIT-AGE.
 12490
 12491******************************************************************
 12492*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12493******************************************************************
 12494
 12495     IF NOT NO-LIFE-COVERAGE
 12496        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12497           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12498               MOVE ER-2628             TO WS-ERROR
 12499               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12500
 12501     IF NOT NO-AH-COVERAGE
 12502        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12503           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12504               MOVE ER-2628         TO WS-ERROR
 12505               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12506
 12507 3133-SEX-CODE.
 12508     IF PB-I-INSURED-SEX = SPACE OR ZERO
 12509         IF WS-DEFAULT-SEX = 'M'
 12510             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12511          ELSE
 12512             IF WS-DEFAULT-SEX = 'F'
 12513             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12514
 12515     IF PB-I-INSURED-SEX = '1'
 12516         MOVE 'M' TO PB-I-INSURED-SEX.
 12517
 12518     IF PB-I-INSURED-SEX = '2'
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 229
* EL050.cbl
 12519         MOVE 'F' TO PB-I-INSURED-SEX.
 12520
 12521 3134-SIG-SW-EDIT.
 12522     IF PB-I-SIG-SW = SPACE
 12523         MOVE 'N'                TO  PB-I-SIG-SW.
 12524
 12525     IF PB-COMPANY-ID = 'NCL'
 12526         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12527             NEXT SENTENCE
 12528         ELSE
 12529             MOVE ER-1923        TO  WS-ERROR
 12530             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12531     ELSE
 12532     IF PB-COMPANY-ID = 'CRI'
 12533         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12534             NEXT SENTENCE
 12535         ELSE
 12536             MOVE ER-2606        TO  WS-ERROR
 12537             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12538     ELSE
 12539     IF PB-COMPANY-ID = 'TMS'
 12540         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12541             NEXT SENTENCE
 12542         ELSE
 12543             MOVE ER-2689        TO  WS-ERROR
 12544             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12545     ELSE
 12546         IF PB-I-SIG-SW = 'Y' OR 'N'
 12547             NEXT SENTENCE
 12548         ELSE
 12549             MOVE ER-2651        TO  WS-ERROR
 12550             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12551
 12552     IF PB-COMPANY-ID = 'FLA'
 12553         IF (WS-EDIT-AGE GREATER 54  OR
 12554             WS-AH-EDIT-AGE GREATER 54)  AND
 12555            PB-I-SIG-SW = 'N'
 12556            MOVE ER-2651         TO  WS-ERROR
 12557            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12558
 12559 3135-NAME-EDIT.
 12560
 12561     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12562        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12563        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12564           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12565                                 TO PB-I-JOINT-FIRST-NAME
 12566        END-PERFORM
 12567     END-IF
 12568     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12569        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12570        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12571           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12572                                 TO PB-I-JOINT-LAST-NAME
 12573        END-PERFORM
 12574     END-IF
 12575     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12576        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 230
* EL050.cbl
 12577        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12578           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12579                                 TO PB-I-INSURED-FIRST-NAME
 12580        END-PERFORM
 12581     END-IF
 12582     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12583        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12584        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12585           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12586                                 TO PB-I-INSURED-LAST-NAME
 12587        END-PERFORM
 12588     END-IF
 12589     IF PB-I-INSURED-LAST-NAME = SPACES
 12590       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12591       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12592           MOVE ER-2660    TO WS-ERROR
 12593           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12594
 12595 3136-EDIT-SEX.
 12596
 12597******************************************************************
 12598*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12599******************************************************************
 12600
 12601     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12602        (WS-AH-SPECIAL-CALC-CD = 'O')
 12603        NEXT SENTENCE
 12604     ELSE
 12605        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12606           NEXT SENTENCE
 12607        ELSE
 12608           MOVE ER-2629            TO WS-ERROR
 12609           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12610
 12611 3137-EDIT-EFF-DATE.
 12612
 12613     IF PB-REISSUED-CERT       OR
 12614        PB-POLICY-IS-DECLINED  OR
 12615        PB-POLICY-IS-VOIDED
 12616         GO TO 3139-EDIT-COVERAGE-CODES.
 12617
 12618     MOVE SPACE                  TO WS-2671-SW
 12619                                    WS-2672-SW.
 12620
 12621     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12622         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12623             MOVE ER-2703        TO WS-ERROR
 12624             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12625             GO TO 3139-EDIT-COVERAGE-CODES.
 12626
 12627     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12628         GO TO 3139-EDIT-COVERAGE-CODES.
 12629
 12630     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12631     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12632*    MOVE '1'                    TO DC-OPTION-CODE.
 12633     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12634     MOVE +0                     TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 231
* EL050.cbl
 12635                                    DC-ELAPSED-DAYS.
 12636     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12637
 12638     IF DATE-CONVERSION-ERROR
 12639         GO TO 3139-EDIT-COVERAGE-CODES.
 12640
 12641     IF DC-ELAPSED-DAYS GREATER +180
 12642         MOVE ER-2672            TO WS-ERROR
 12643         MOVE 'Y'                TO WS-2672-SW
 12644         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12645     END-IF
 12646
 12647     IF WS-ERROR = ER-2671  AND
 12648        PB-COMPANY-ID  = 'LBL'
 12649        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12650        MOVE SPACE               TO WS-2671-SW
 12651        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12652
 12653     IF PB-ISSUE-DATE-FORCED  AND
 12654      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12655         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12656         MOVE ER-2673            TO WS-ERROR
 12657         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12658         MOVE SPACE              TO WS-2671-SW
 12659                                    WS-2672-SW.
 12660
 12661     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12662         IF PB-ISSUE-DATE-FORCED
 12663             MOVE ER-2600          TO  WS-ERROR
 12664             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12665         ELSE
 12666             MOVE ER-2692          TO  WS-ERROR
 12667             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12668
 12669
 12670 3139-EDIT-COVERAGE-CODES.
 12671
 12672     if pb-company-id not = 'AHL'
 12673        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12674           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12675           MOVE ER-2787          TO WS-ERROR
 12676           PERFORM 9900-ERROR-FORMAT
 12677                                 THRU 9900-EXIT
 12678        END-IF
 12679     end-if
 12680     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12681        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12682                                 > 250000.00
 12683           MOVE ER-2719          TO WS-ERROR
 12684           PERFORM 9900-ERROR-FORMAT
 12685                                 THRU 9900-EXIT
 12686        END-IF
 12687     END-IF
 12688
 12689     IF PB-POLICY-IS-DECLINED  OR
 12690        PB-POLICY-IS-VOIDED
 12691         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12692
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 232
* EL050.cbl
 12693     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12694        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12695         MOVE ER-2630                TO WS-ERROR
 12696         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12697
 12698     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12699        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12700        PB-I-LF-PREMIUM-AMT = ZERO
 12701         GO TO 3140-CHECK-AH-FOR-ZERO.
 12702
 12703     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12704        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12705        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12706         GO TO 3140-CHECK-AH-FOR-ZERO.
 12707
 12708     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12709        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12710        MOVE ER-2631             TO WS-ERROR
 12711        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12712     END-IF
 12713
 12714
 12715******************************************************************
 12716*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12717******************************************************************
 12718
 12719     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12720        NEXT SENTENCE
 12721     ELSE
 12722        IF PB-I-LF-BENEFIT-AMT = ZERO
 12723           MOVE ER-2632             TO WS-ERROR
 12724           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12725
 12726
 12727******************************************************************
 12728*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12729******************************************************************
 12730
 12731     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12732        CONTINUE
 12733     ELSE
 12734        IF PB-I-LF-PREMIUM-AMT = ZERO
 12735           IF (NOT PB-COMP-LF-PREM)
 12736              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12737              MOVE ER-2633       TO WS-ERROR
 12738              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12739           END-IF
 12740        END-IF
 12741     END-IF
 12742     .
 12743 3140-CHECK-AH-FOR-ZERO.
 12744
 12745     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12746        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12747        PB-I-AH-PREMIUM-AMT = ZERO
 12748         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12749
 12750     IF PB-COMPANY-ID = 'CSL'  AND
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 233
* EL050.cbl
 12751        PB-I-AH-BENEFIT-CD = ZERO  AND
 12752        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12753        PB-I-AH-PREMIUM-AMT = ZERO
 12754         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12755
 12756     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12757        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12758        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12759         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12760
 12761     IF PB-I-AH-BENEFIT-CD = ZERO
 12762         MOVE ER-2634            TO WS-ERROR
 12763         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12764
 12765******************************************************************
 12766*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12767******************************************************************
 12768
 12769     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12770        NEXT SENTENCE
 12771     ELSE
 12772        IF PB-I-AH-BENEFIT-AMT = ZERO
 12773           MOVE ER-2635             TO WS-ERROR
 12774           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12775
 12776******************************************************************
 12777*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12778******************************************************************
 12779
 12780     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12781        NEXT SENTENCE
 12782     ELSE
 12783        IF PB-I-AH-PREMIUM-AMT = ZERO
 12784            IF NOT PB-COMP-AH-PREM
 12785                MOVE ER-2636    TO WS-ERROR
 12786                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12787
 12788
 12789 3140-EDIT-MAX-AMT-SIZES.
 12790* CUSTOM CODE FOR CLIENT    'DMD'
 12791     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12792                                     WS-RES-MUNI-TAX
 12793                                     PB-I-STATE-TAX
 12794                                     PB-I-MUNI-TAX.
 12795
 12796     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12797
 12798     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12799        GO TO 3150-RATE-OUTSTAND-BAL.
 12800
 12801     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12802        GO TO 3150-RATE-OUTSTAND-BAL.
 12803
 12804     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12805        GO TO 3150-RATE-OUTSTAND-BAL.
 12806
 12807     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12808                             OR 'RIC')
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 234
* EL050.cbl
 12809        GO TO 3150-RATE-OUTSTAND-BAL.
 12810
 12811     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12812        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12813            GO TO 3150-RATE-OUTSTAND-BAL
 12814        ELSE
 12815           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12816               GO TO 3150-RATE-OUTSTAND-BAL.
 12817
 12818     IF NOT PB-NO-MONTHS-SKIPPED
 12819        GO TO 3150-RATE-OUTSTAND-BAL.
 12820
 12821     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12822        GO TO 3150-RATE-OUTSTAND-BAL.
 12823
 12824     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12825        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12826           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12827             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12828           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12829           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12830              MOVE ER-2693     TO WS-ERROR
 12831              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12832              GO TO 3150-RATE-OUTSTAND-BAL
 12833           ELSE
 12834              GO TO 3150-RATE-OUTSTAND-BAL.
 12835
 12836 3150-RATE-OUTSTAND-BAL.
 12837
 12838* DMD RATING TEST
 12839     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12840         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12841         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12842         MOVE ER-2687                 TO WS-ERROR
 12843         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12844         MOVE 'B'                     TO PB-I-OB-FLAG
 12845         GO TO 3260-EDIT-CONTINUE.
 12846
 12847     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12848         IF  WS-ERROR    EQUAL    ER-2693
 12849             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12850                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12851                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12852                 MOVE  +0            TO  WS-ERROR.
 12853
 12854     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12855         IF  WS-ERROR    EQUAL    ER-2693
 12856             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 12857                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12858                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12859                 MOVE  +0            TO  WS-ERROR.
 12860
 12861     IF PLAN-MASTER-AH-SW = 'Y'
 12862        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12863            IF  WS-ERROR    EQUAL    ER-2693
 12864              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12865                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12866                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 235
* EL050.cbl
 12867                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12868                 MOVE  ER-1910           TO  WS-ERROR
 12869                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12870
 12871     IF PLAN-MASTER-AH-SW = 'Y'
 12872        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12873            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12874               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12875               MOVE  ER-1910           TO  WS-ERROR
 12876               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12877
 12878     IF PLAN-MASTER-AH-SW = 'Y'
 12879        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12880            IF  WS-ERROR    EQUAL    ER-2693
 12881                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12882                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12883                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12884                 MOVE  +0       TO  WS-ERROR.
 12885
 12886     IF WS-ERROR = ER-2693
 12887        IF PB-COMPANY-ID = 'JAL' AND
 12888           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12889           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12890           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12891
 12892     IF WS-ERROR = ER-2693
 12893        IF PB-COMPANY-ID = 'NCL'  AND
 12894           PB-I-AH-BENEFIT-CD = 'OA'
 12895           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12896           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12897
 12898     IF WS-ERROR = ER-2693
 12899        IF PB-COMPANY-ID = 'CNL' AND
 12900           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12901           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12902           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12903
 12904     IF WS-ERROR = ER-2693
 12905        IF PB-COMPANY-ID = 'HER'
 12906           IF WS-LEVEL
 12907              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12908              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12909
 12910     IF ((LF-BENEFIT-FOUND) AND
 12911         (NOT NO-LIFE-COVERAGE)  AND
 12912         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12913       OR   ((AH-BENEFIT-FOUND) AND
 12914             (NOT NO-AH-COVERAGE)    AND
 12915             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12916         NEXT SENTENCE
 12917     ELSE
 12918         GO TO 3215-EDIT-RATES.
 12919
 12920     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12921        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12922           MOVE ER-2674          TO WS-ERROR
 12923           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12924           GO TO 3215-EDIT-RATES.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 236
* EL050.cbl
 12925
 12926     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12927        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12928           MOVE ER-2674          TO WS-ERROR
 12929           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12930           GO TO 3215-EDIT-RATES.
 12931
 12932     MOVE 'B'                    TO PB-I-OB-FLAG.
 12933
 12934     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12935         NEXT SENTENCE
 12936     ELSE
 12937         IF NOT NO-LIFE-COVERAGE
 12938             IF WS-ACCT-LF-OB-RT = ZERO
 12939                MOVE ER-2641    TO WS-ERROR
 12940                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12941
 12942     IF PB-COMPANY-ID = 'CRI'
 12943       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12944         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12945         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12946         IF WS-ERROR = ER-2675
 12947            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12948            MOVE ER-2687              TO WS-ERROR
 12949            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12950         ELSE
 12951            MOVE ER-2687              TO WS-ERROR
 12952            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12953
 12954
 12955     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12956         NEXT SENTENCE
 12957     ELSE
 12958       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 12959            NEXT SENTENCE
 12960       ELSE
 12961         IF NOT NO-AH-COVERAGE
 12962             IF WS-ACCT-AH-OB-RT = ZERO
 12963                MOVE ER-2642    TO WS-ERROR
 12964                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12965
 12966     IF PB-COMPANY-ID = 'CRI'
 12967       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12968         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 12969         IF WS-ERROR = ER-2676
 12970            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12971            MOVE ER-2687              TO WS-ERROR
 12972            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12973         ELSE
 12974            MOVE ER-2687              TO WS-ERROR
 12975            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12976
 12977     IF PB-COMPANY-ID NOT = 'GIC'
 12978         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12979            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 12980     ELSE
 12981         IF PB-I-LF-PREM-CALC = ZEROS
 12982             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 237
* EL050.cbl
 12983                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 12984
 12985     IF PB-COMPANY-ID NOT = 'GIC'
 12986         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12987            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 12988     ELSE
 12989         IF PB-I-AH-PREM-CALC = ZEROS
 12990             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12991                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 12992
 12993     MOVE ZEROS TO PB-I-MORT-CODE.
 12994
 12995     GO TO 3260-EDIT-CONTINUE.
 12996
 12997
 12998 3215-EDIT-RATES.
 12999     IF ACCOUNT-MAST-FOUND
 13000         NEXT SENTENCE
 13001     ELSE
 13002         GO TO 3999-END-EDIT.
 13003
 13004 3220-CHECK-LF-RATES.
 13005
 13006     IF PB-COMPANY-ID = 'DCC'
 13007        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13008        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13009        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13010           AND (NOT WS-LF-CASH))
 13011                           OR
 13012           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13013           AND (NOT WS-AH-CASH)))
 13014                       AND
 13015           (PB-I-ENTRY-STATUS NOT = '5')
 13016           MOVE 'M'              TO PB-BATCH-ENTRY
 13017                                    PB-I-ENTRY-STATUS
 13018        END-IF
 13019     END-IF
 13020     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13021                                    PB-I-AH-PREM-CALC
 13022                                    PB-I-LF-ALT-PREM-CALC
 13023                                    PB-I-LF-ALT-RATE
 13024                                    PB-I-LF-REI-RATE
 13025                                    PB-I-LF-ALT-REI-RATE
 13026                                    PB-I-AH-REI-RATE
 13027                                    PB-I-TOT-FEES-CALC.
 13028
 13029     IF PB-COMPANY-ID EQUAL 'DMD'
 13030        NEXT SENTENCE
 13031     ELSE
 13032        MOVE ZEROS               TO PB-I-LF-RATE
 13033                                    PB-I-AH-RATE.
 13034
 13035     IF PB-I-TOT-FEES NOT NUMERIC
 13036        MOVE ZEROS               TO PB-I-TOT-FEES
 13037     END-IF
 13038     IF PB-I-LIVES NOT NUMERIC
 13039         MOVE ZERO               TO PB-I-LIVES.
 13040
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 238
* EL050.cbl
 13041     IF PB-I-NUM-BILLED NOT NUMERIC
 13042         MOVE ZERO               TO PB-I-NUM-BILLED.
 13043
 13044     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13045        MOVE +0                  TO PB-I-LF-PREM-TAX
 13046     END-IF
 13047
 13048     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13049        MOVE +0                  TO PB-I-AH-PREM-TAX
 13050     END-IF
 13051
 13052     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13053        PB-I-PAY-FREQUENCY = ZEROS
 13054            MOVE 12 TO CP-PAY-FREQUENCY
 13055     ELSE
 13056            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13057
 13058     IF PB-I-STATE-TAX NOT NUMERIC
 13059         MOVE ZEROS               TO PB-I-STATE-TAX.
 13060
 13061     IF PB-I-MUNI-TAX NOT NUMERIC
 13062         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13063
 13064     MOVE SPACES                 TO CP-BEN-CATEGORY
 13065     IF PB-COMPANY-ID  = 'CSL'  AND
 13066        PB-I-LF-TERM NOT = ZERO
 13067        COMPUTE WS-PAYMENT-AMT =
 13068             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13069        COMPUTE WS-CSL-AMT1 =
 13070             PB-I-LF-TERM * AM-MAX-MON-BEN
 13071        COMPUTE WS-CSL-AMT2 =
 13072             WS-PAYMENT-AMT * PB-I-LF-TERM
 13073        IF CP-PAY-FREQUENCY NOT = 12
 13074           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13075           MOVE '8' TO WS-CSL-CALC-CD
 13076        ELSE
 13077           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13078              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13079               AM-MAX-TOT-BEN
 13080               MOVE '6' TO WS-CSL-CALC-CD
 13081           ELSE
 13082              IF (WS-CSL-AMT1  GREATER THAN
 13083                 AM-MAX-TOT-BEN) AND
 13084                 (WS-CSL-AMT2  GREATER THAN
 13085                 AM-MAX-TOT-BEN)
 13086                 MOVE '7' TO WS-CSL-CALC-CD
 13087              ELSE
 13088                 MOVE '5' TO WS-CSL-CALC-CD.
 13089
 13090     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13091         NEXT SENTENCE
 13092     ELSE
 13093         GO TO 3300-CHECK-AH-RATES.
 13094
 13095*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13096
 13097     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13098        IF (PB-I-LF-CRIT-PER    EQUAL +0)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 239
* EL050.cbl
 13099              OR
 13100           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13101           MOVE ER-2618          TO WS-ERROR
 13102           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13103           GO TO 3300-CHECK-AH-RATES.
 13104
 13105     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13106           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13107                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13108
 13109     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13110         MOVE ER-2687             TO WS-ERROR
 13111         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13112         MOVE 'Z000'              TO PB-I-MORT-CODE
 13113         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13114         GO TO 3300-CHECK-AH-RATES.
 13115
 13116     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13117        IF PB-I-LIVES = ZERO
 13118           MOVE ER-2688          TO WS-ERROR
 13119           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13120
 13121     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13122
 13123     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13124     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13125     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13126     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13127     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13128     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13129     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13130     MOVE '3'                    TO CP-PROCESS-TYPE.
 13131     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13132     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13133
 13134******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13135     IF PB-COMPANY-ID EQUAL 'CDL'
 13136         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13137            CP-EARN-AS-NET-PAY)
 13138             IF PB-CERT-EFF-DT GREATER  WS-931231
 13139                 MOVE '1'        TO CP-EARNING-METHOD.
 13140*******
 13141
 13142     MOVE PB-SV-STATE            TO CP-STATE.
 13143     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13144     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13145     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13146     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13147     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13148                                    CP-RATING-BENEFIT-AMT.
 13149     IF CP-STATE-STD-ABBRV = 'OR'
 13150         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13151                                         PB-I-LF-ALT-BENEFIT-AMT.
 13152     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13153     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13154     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13155     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13156     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 240
* EL050.cbl
 13157     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13158     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13159     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13160     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13161                                    CP-REMAINING-TERM
 13162                                    CP-LOAN-TERM.
 13163
 13164     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13165         NEXT SENTENCE
 13166     ELSE
 13167         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13168             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13169                                           PB-I-LF-PREMIUM-AMT.
 13170
 13171     IF PB-COMPANY-ID EQUAL 'CSL'
 13172        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13173           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13174                                         PB-I-LF-PREMIUM-AMT.
 13175
 13176     IF PB-COMPANY-ID EQUAL 'NCB'
 13177         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13178            CP-EARN-AS-NET-PAY
 13179             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13180                 PB-I-LF-PREMIUM-AMT.
 13181
 13182     IF (CP-TRUNCATED-LIFE)
 13183        or ((pb-company-id = 'AHL')
 13184           and (pb-i-loan-term > pb-i-lf-term))
 13185        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13186
 13187     IF PB-COMPANY-ID EQUAL 'CRI'
 13188        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13189
 13190     IF CP-TERM-IS-DAYS
 13191         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13192     ELSE
 13193         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13194     IF PB-COMPANY-ID = 'DCC'
 13195        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13196        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13197        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13198        IF WS-LF-BEN-CATEGORY = 'D'
 13199           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13200           MOVE PB-I-LIFE-COMMISSION
 13201                                 TO CP-DCC-ACT-COMM
 13202           MOVE WS-LF-BEN-CATEGORY
 13203                                 TO CP-BEN-CATEGORY
 13204        END-IF
 13205        IF (CP-BENEFIT-CD (1:1) = 'P')
 13206           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13207           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13208           add pb-i-ah-premium-amt to cp-original-premium
 13209        END-IF
 13210     END-IF
 13211     IF PB-COMPANY-ID = 'CSL'
 13212         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13213         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13214         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 241
* EL050.cbl
 13215
 13216     IF PB-COMPANY-ID = 'CSL'
 13217        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13218
 13219     IF (CP-SPECIAL-CALC-CD = 'H')
 13220        OR (PB-COMPANY-ID = 'DCC')
 13221         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13222                                    TO CP-ALTERNATE-BENEFIT
 13223         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13224
 13225     IF (PB-COMPANY-ID = 'CID')
 13226        AND (WS-LF-EARNINGS-CALC = 'B')
 13227        AND (CP-STATE-STD-ABBRV = 'MN')
 13228        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13229                                 TO CP-ALTERNATE-BENEFIT
 13230        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13231     END-IF
 13232     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13233     MOVE 'R'                   TO CP-RATE-FILE.
 13234     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13235
 13236     IF CP-ERROR-RATE-NOT-FOUND
 13237        MOVE ER-2641            TO WS-ERROR
 13238        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13239        GO TO 3300-CHECK-AH-RATES.
 13240
 13241     IF PB-COMPANY-ID EQUAL 'CRI'
 13242        IF CP-ERROR-NO-LIMITS-CRI
 13243           IF NOT ACCOUNT-LIFE-CHECKED
 13244              MOVE ER-2607      TO WS-ERROR
 13245              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13246
 13247******************************************************************
 13248*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13249*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13250******************************************************************
 13251
 13252* CALC LIFE AGE AT EXPIRATION.
 13253
 13254     COMPUTE WS-AGE-AT-EXPIRE =
 13255          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13256
 13257*    IF PB-STATE = 'CO' OR 'UT'
 13258*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13259*        MOVE 'F'            TO PB-FATAL-FLAG
 13260*        MOVE ER-2709        TO WS-ERROR
 13261*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13262*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13263
 13264*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13265*        MOVE 'X'            TO PB-FATAL-FLAG
 13266*        MOVE ER-2718        TO WS-ERROR
 13267*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13268*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13269
 13270* CALC A & H AGE AT EXPIRATION.
 13271
 13272     COMPUTE WS-AGE-AT-EXPIRE =
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 242
* EL050.cbl
 13273          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13274
 13275*    IF PB-STATE = 'CO' OR 'UT'
 13276*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13277*        MOVE 'F'            TO PB-FATAL-FLAG
 13278*        MOVE ER-2709        TO WS-ERROR
 13279*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13280*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13281
 13282*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13283*        MOVE 'X'            TO PB-FATAL-FLAG
 13284*        MOVE ER-2718        TO WS-ERROR
 13285*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13286*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13287
 13288     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13289        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13290
 13291     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13292        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13293
 13294     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13295        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13296
 13297     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13298         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13299         MOVE ER-2639        TO WS-ERROR
 13300         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13301
 13302
 13303******************************************************************
 13304*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13305******************************************************************
 13306
 13307 PREMIUM-EDITING-IS-BYPASSED.
 13308     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13309        AND (CP-R-MAX-ATT-AGE > +0)
 13310        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13311        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13312           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13313           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13314           MOVE '1'              TO DC-OPTION-CODE
 13315           PERFORM 8500-DATE-CONVERT
 13316                                 THRU 8500-EXIT
 13317           IF NO-CONVERSION-ERROR
 13318              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13319                 MOVE ER-2661       TO WS-ERROR
 13320*                PERFORM 9900-ERROR-FORMAT
 13321*                                THRU 9900-EXIT
 13322              END-IF
 13323           END-IF
 13324        ELSE
 13325           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13326           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13327              MOVE ER-2661       TO WS-ERROR
 13328*             PERFORM 9900-ERROR-FORMAT
 13329*                                THRU 9900-EXIT
 13330           ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 243
* EL050.cbl
 13331              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13332                 MOVE ER-1570    TO WS-ERROR
 13333                 PERFORM 9900-ERROR-FORMAT
 13334                                 THRU 9900-EXIT
 13335              END-IF
 13336           END-IF
 13337        END-IF
 13338        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13339           MOVE PB-I-JOINT-BIRTHDAY
 13340                                 TO DC-BIN-DATE-1
 13341           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13342           MOVE '1'              TO DC-OPTION-CODE
 13343           PERFORM 8500-DATE-CONVERT
 13344                                 THRU 8500-EXIT
 13345           IF NO-CONVERSION-ERROR
 13346              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13347                 MOVE ER-2661       TO WS-ERROR
 13348*                PERFORM 9900-ERROR-FORMAT
 13349*                                THRU 9900-EXIT
 13350              END-IF
 13351           ELSE
 13352              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13353           END-IF
 13354        ELSE
 13355           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13356             (PB-I-LF-TERM / 12)
 13357           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13358              MOVE ER-2661       TO WS-ERROR
 13359*             PERFORM 9900-ERROR-FORMAT
 13360*                                THRU 9900-EXIT
 13361           ELSE
 13362              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13363                 MOVE ER-1571    TO WS-ERROR
 13364                 PERFORM 9900-ERROR-FORMAT
 13365                                 THRU 9900-EXIT
 13366              END-IF
 13367           END-IF
 13368        END-IF
 13369        IF WS-ERROR = ER-2661
 13370           PERFORM 9900-ERROR-FORMAT
 13371                                 THRU 9900-EXIT
 13372        END-IF
 13373     END-IF
 13374*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13375*       MOVE ER-2661             TO WS-ERROR
 13376*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13377
 13378     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13379        MOVE ER-2662             TO WS-ERROR
 13380        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13381
 13382     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13383        MOVE ER-2677             TO WS-ERROR
 13384        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13385
 13386     IF CP-ERROR-LOAN-TERM
 13387        MOVE ER-2648             TO WS-ERROR
 13388        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 244
* EL050.cbl
 13389
 13390 3221-CHECK-ERROR-RATE-OPEN.
 13391
 13392     IF CP-ERROR-RATE-FILE-NOTOPEN
 13393         GO TO 3990-FILES-NOT-OPEN.
 13394
 13395     IF PB-COMPANY-ID NOT = 'DMD'
 13396        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13397     END-IF
 13398     .
 13399 3221-CONTINUE.
 13400     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13401                                    WS-DCC-AH-RATE
 13402     IF PB-COMPANY-ID = 'DCC'
 13403        IF WS-LF-BEN-CATEGORY = 'D'
 13404           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13405              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13406        END-IF
 13407     END-IF
 13408     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13409*   X'A4FF' = 12/31/2009
 13410     IF (PB-COMPANY-ID = 'CID')
 13411        AND (WS-LF-EARNINGS-CALC = 'B')
 13412        AND (CP-STATE-STD-ABBRV = 'MN')
 13413        AND (PB-CERT-EFF-DT > X'A4FF')
 13414        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13415     END-IF
 13416     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13417
 13418     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13419     IF (PB-COMPANY-ID = 'DCC')
 13420        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13421        AND (PB-I-POLICY-IS-MONTHLY)
 13422        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13423        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13424     END-IF
 13425     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13426     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13427     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13428     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13429     IF (PB-COMPANY-ID = 'DCC')
 13430        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13431        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13432        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13433        MOVE ER-2786             TO WS-ERROR
 13434        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13435     END-IF
 13436
 13437     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13438
 13439******************************************************************
 13440*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13441******************************************************************
 13442     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13443        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13444
 13445     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13446        GO TO 3225-CHECK-ALT-LIFE-RATE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 245
* EL050.cbl
 13447     ELSE
 13448       IF PB-I-LF-RATE = ZERO
 13449          MOVE ER-2641          TO WS-ERROR
 13450          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13451
 13452 3225-CHECK-ALT-LIFE-RATE.
 13453
 13454     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13455        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13456        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13457         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13458
 13459     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13460         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13461             AND PB-COMPANY-ID NOT = 'DCC')
 13462                   OR
 13463              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13464              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13465              AND PB-COMPANY-ID NOT = 'DCC')
 13466             MOVE ER-2720        TO  WS-ERROR
 13467             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13468             GO TO 3225-RATING-CONT
 13469         ELSE
 13470             GO TO 3225-RATING-CONT.
 13471     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13472        AND (AM-GPCD = 01 OR 06 OR 15)
 13473        MOVE ER-2798             TO WS-ERROR
 13474        PERFORM 9900-ERROR-FORMAT
 13475                                 THRU 9900-EXIT
 13476*       GO TO 3225-RATING-CONT
 13477     END-IF
 13478     IF (PB-COMPANY-ID = 'CID')
 13479        AND (WS-LF-EARNINGS-CALC = 'B')
 13480        AND (CP-STATE-STD-ABBRV = 'MN')
 13481        AND (PB-CERT-EFF-DT > X'A4FF')
 13482        GO TO 3225-RATING-CONT
 13483     END-IF
 13484     IF PB-COMPANY-ID = 'DCC'
 13485        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13486           AND (PB-I-POLICY-IS-MONTHLY)
 13487           GO TO 3225-RATING-CONT
 13488        END-IF
 13489     END-IF
 13490
 13491     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13492        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13493        CP-EARN-AS-REG-BALLOON
 13494        NEXT SENTENCE
 13495     ELSE
 13496        MOVE '2'                 TO CP-EARNING-METHOD.
 13497
 13498 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13499
 13500     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13501
 13502     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13503        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13504        (CP-SPECIAL-CALC-CD EQUAL 'H')
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 246
* EL050.cbl
 13505         NEXT SENTENCE
 13506     ELSE
 13507         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13508
 13509     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13510     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13511     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13512                                     CP-RATING-BENEFIT-AMT.
 13513     IF CP-STATE-STD-ABBRV = 'OR'
 13514         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13515                                         PB-I-LF-ALT-BENEFIT-AMT.
 13516     IF PB-COMPANY-ID = 'DCC'
 13517        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13518     END-IF
 13519     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13520     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13521     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13522                                    CP-REMAINING-TERM
 13523                                    CP-LOAN-TERM.
 13524     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13525        ADD +1                   TO CP-ORIGINAL-TERM
 13526                                    CP-REMAINING-TERM
 13527                                    CP-LOAN-TERM.
 13528
 13529     MOVE 'R'                   TO CP-RATE-FILE.
 13530     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13531
 13532     IF CP-ERROR-RATE-NOT-FOUND
 13533         MOVE ER-2641            TO WS-ERROR
 13534         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13535         GO TO 3300-CHECK-AH-RATES.
 13536
 13537     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13538     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13539
 13540     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13541         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13542
 13543     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13544                               + PB-I-LF-ALT-BENEFIT-AMT.
 13545
 13546     IF ACCOUNT-LIFE-CHECKED  OR
 13547        PB-POLICY-IS-VOIDED   OR
 13548        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13549        GO TO 3225-CONTINUE.
 13550
 13551     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13552        GO TO 3225-CONTINUE.
 13553
 13554     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13555                             EC-RT-LF-MAX-TOT-BEN
 13556        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13557        MOVE ER-2639       TO WS-ERROR
 13558        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13559
 13560 3225-CONTINUE.
 13561     IF PB-I-LF-ALT-RATE = ZERO
 13562         MOVE ER-2659            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 247
* EL050.cbl
 13563         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13564
 13565     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13566        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13567        MOVE ER-2698             TO WS-ERROR
 13568        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13569
 13570 3225-RATING-CONT.
 13571
 13572     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13573         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13574         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13575         IF (PB-COMPANY-ID = 'DCC')
 13576            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13577            CONTINUE
 13578         ELSE
 13579            MOVE ER-2687         TO WS-ERROR
 13580            PERFORM 9900-ERROR-FORMAT
 13581                                 THRU 9900-EXIT
 13582         END-IF
 13583         GO TO 3290-EDIT-LF-REIN-RATE
 13584     END-IF
 13585
 13586* DMD RATING TEST
 13587     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13588         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13589         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13590         MOVE ER-2687                 TO WS-ERROR
 13591         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13592         GO TO 3290-EDIT-LF-REIN-RATE.
 13593
 13594 3230-CLIENT-MORT-CD-SPECIALS.
 13595
 13596     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13597     SET BIN-TO-GREG          TO TRUE.
 13598*    MOVE ' '                 TO DC-OPTION-CODE.
 13599     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13600     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13601
 13602 C-POS-3230-MORT-CD.
 13603     IF PB-COMPANY-ID = 'POS' AND
 13604        PB-SV-CARRIER = '2'
 13605         NEXT SENTENCE
 13606     ELSE
 13607         GO TO C-POS-3240-MORT-CD.
 13608
 13609     IF PB-SV-GROUPING = '030'
 13610        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13611         MOVE '2350' TO PB-I-MORT-CODE
 13612      ELSE
 13613         MOVE '3300' TO PB-I-MORT-CODE.
 13614
 13615
 13616 C-POS-3240-MORT-CD.
 13617     IF PB-COMPANY-ID = 'POS' AND
 13618        PB-SV-CARRIER = '1'
 13619         NEXT SENTENCE
 13620     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 248
* EL050.cbl
 13621         GO TO 3230-CONTINUE.
 13622
 13623     IF PB-SV-STATE = '45' OR '47'
 13624        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13625         MOVE '5200' TO PB-I-MORT-CODE
 13626     ELSE
 13627         MOVE '8300' TO PB-I-MORT-CODE.
 13628
 13629 3230-CONTINUE.
 13630
 13631     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13632        GO TO 3240-CONTINUE
 13633     END-IF
 13634
 13635     IF PB-CERT-EFF-DT > WS-971231
 13636        GO TO 3240-CONTINUE
 13637     END-IF
 13638
 13639     IF LF-BENEFIT-FOUND AND
 13640        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13641         MOVE 'F250'       TO PB-I-MORT-CODE
 13642     ELSE
 13643         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13644             MOVE '7250'   TO PB-I-MORT-CODE
 13645         ELSE
 13646             MOVE '4251'   TO PB-I-MORT-CODE
 13647         END-IF
 13648     END-IF
 13649
 13650     .
 13651 3240-CONTINUE.
 13652
 13653     IF PB-COMPANY-ID NOT = 'GNL'
 13654         GO TO 3256-CONTINUE.
 13655
 13656     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13657         MOVE 'A300' TO PB-I-MORT-CODE
 13658     ELSE
 13659         MOVE '8350' TO PB-I-MORT-CODE.
 13660
 13661 3256-CONTINUE.
 13662     IF PB-COMPANY-ID NOT = 'ABL'
 13663         GO TO 3260-EDIT-CONTINUE.
 13664
 13665     IF PB-I-LF-TERM GREATER THAN 59
 13666         MOVE 'F550' TO PB-I-MORT-CODE
 13667     ELSE
 13668         MOVE 'E550' TO PB-I-MORT-CODE.
 13669
 13670 3260-EDIT-CONTINUE.
 13671     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13672
 13673 3290-EDIT-LF-REIN-RATE.
 13674     IF LF-REIN-NSP-NOT-USED
 13675         GO TO 3290-RATING-CONT.
 13676
 13677     IF PB-COMPANY-ID = 'DCC'
 13678        GO TO 3290-RATING-CONT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 249
* EL050.cbl
 13679     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13680     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13681     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13682     MOVE '3'                   TO CP-PROCESS-TYPE.
 13683     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13684
 13685******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13686     IF PB-COMPANY-ID EQUAL 'CDL'
 13687         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13688            CP-EARN-AS-NET-PAY)
 13689             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13690*            MOVE SPACE          TO DC-OPTION-CODE
 13691             SET BIN-TO-GREG     TO TRUE
 13692             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13693***  Y2K PROJ 7744
 13694             IF DC-GREG-DATE-CYMD GREATER 19931231
 13695                 MOVE '1'        TO CP-EARNING-METHOD.
 13696***  Y2K PROJ 7744
 13697*******
 13698
 13699     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13700     MOVE PB-SV-STATE           TO CP-STATE.
 13701     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13702     MOVE ZERO                  TO CP-DEVIATION-CODE
 13703                                   CP-RATE-DEV-PCT.
 13704     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13705     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13706                                   CP-RATING-BENEFIT-AMT.
 13707
 13708************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13709     IF PB-COMPANY-ID EQUAL 'NCB'
 13710         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13711            CP-EARN-AS-NET-PAY
 13712             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13713                 PB-I-LF-PREMIUM-AMT.
 13714************
 13715
 13716     IF CP-STATE-STD-ABBRV = 'OR'
 13717         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13718                                         PB-I-LF-ALT-BENEFIT-AMT.
 13719     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13720     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13721     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13722     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13723     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13724     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13725     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13726     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13727                                   CP-REMAINING-TERM
 13728                                   CP-LOAN-TERM.
 13729     IF CP-TRUNCATED-LIFE
 13730        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13731
 13732     IF CP-TERM-IS-DAYS
 13733         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13734     ELSE
 13735         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13736
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 250
* EL050.cbl
 13737     IF PB-COMPANY-ID = 'DCC'
 13738        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13739     END-IF
 13740     IF PB-COMPANY-ID NOT = 'TIC'
 13741          MOVE ZERO          TO CP-CLASS-CODE.
 13742
 13743     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13744
 13745     MOVE 'R'                   TO CP-RATE-FILE.
 13746     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13747
 13748     IF CP-ERROR-RATE-NOT-FOUND
 13749        IF PB-I-OB
 13750           MOVE ER-2625      TO WS-ERROR
 13751           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13752           GO TO 3299-EDIT-CONTINUE
 13753        ELSE
 13754           MOVE ER-2643      TO WS-ERROR
 13755           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13756           GO TO 3299-EDIT-CONTINUE.
 13757
 13758     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13759
 13760     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13761     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13762
 13763     IF PB-I-LF-REI-RATE = ZERO
 13764         MOVE ER-2643        TO WS-ERROR
 13765         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13766
 13767 3290-CHECK-ALT-REIN-RATE.
 13768
 13769     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13770        GO TO 3290-RATING-CONT.
 13771
 13772     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13773     MOVE '2'                    TO CP-EARNING-METHOD.
 13774     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13775     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13776     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13777     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13778                                     CP-RATING-BENEFIT-AMT.
 13779     IF CP-STATE-STD-ABBRV = 'OR'
 13780         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13781                                         PB-I-LF-ALT-BENEFIT-AMT.
 13782     IF PB-COMPANY-ID = 'DCC'
 13783        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13784     END-IF
 13785     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13786     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13787     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13788                                    CP-REMAINING-TERM
 13789                                    CP-LOAN-TERM.
 13790     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13791        ADD +1                   TO CP-ORIGINAL-TERM
 13792                                    CP-REMAINING-TERM
 13793                                    CP-LOAN-TERM.
 13794
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 251
* EL050.cbl
 13795     MOVE 'R'                   TO CP-RATE-FILE.
 13796     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13797
 13798     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13799
 13800     IF PB-I-LF-ALT-REI-RATE = ZERO
 13801         MOVE ER-2643            TO WS-ERROR
 13802         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13803
 13804 3290-RATING-CONT.
 13805
 13806     IF PB-I-OB
 13807*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13808        GO TO 3300-CHECK-AH-RATES.
 13809
 13810 3299-EDIT-CONTINUE.
 13811
 13812     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13813         NEXT SENTENCE
 13814     ELSE
 13815         MOVE ER-2620           TO WS-ERROR
 13816         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13817
 13818 3300-CHECK-AH-RATES.
 13819     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13820         NEXT SENTENCE
 13821     ELSE
 13822         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13823
 13824     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13825        ((CF-COMPANY-ID = 'DMD') AND
 13826                (NO-DMD-RATING))
 13827         IF (PB-COMPANY-ID = 'DCC')
 13828            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13829            CONTINUE
 13830         ELSE
 13831            MOVE ER-2687         TO WS-ERROR
 13832            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13833         END-IF
 13834         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13835         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13836     END-IF
 13837
 13838     IF PB-I-OB
 13839        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13840
 13841     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13842         MOVE ER-2687             TO WS-ERROR
 13843         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13844         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13845         GO TO 3999-END-EDIT.
 13846
 13847*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13848
 13849     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13850        IF PB-I-AH-CRIT-PER = ZERO
 13851           IF PB-COMPANY-ID = 'DCC'
 13852              AND AM-DCC-PRODUCT-CODE = 'DDF'
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 252
* EL050.cbl
 13853              CONTINUE
 13854           ELSE
 13855              MOVE ER-2618       TO WS-ERROR
 13856              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13857              GO TO 3999-END-EDIT
 13858           END-IF
 13859        END-IF
 13860     END-IF
 13861     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13862     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13863     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13864     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13865     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13866     MOVE PB-SV-STATE            TO CP-STATE.
 13867     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13868     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13869     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13870*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13871     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13872     MOVE '3'                    TO CP-PROCESS-TYPE.
 13873     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13874     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13875                                    CP-RATING-BENEFIT-AMT.
 13876     IF PB-COMPANY-ID = 'CID'
 13877               OR
 13878        CP-STATE-STD-ABBRV = 'OR'
 13879         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13880                                         PB-I-AH-TERM.
 13881     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13882        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13883           AND (PB-I-POLICY-IS-MONTHLY)
 13884           MOVE PB-I-LF-BENEFIT-AMT
 13885                                 TO CP-NET-BENEFIT-AMT
 13886           move pb-i-ah-premium-amt to cp-original-premium
 13887           add pb-i-lf-premium-amt to cp-original-premium
 13888        END-IF
 13889     END-IF
 13890     MOVE SPACES                 TO CP-BEN-CATEGORY
 13891     IF PB-COMPANY-ID = 'DCC'
 13892        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13893        EVALUATE TRUE
 13894           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13895              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13896              MOVE PB-I-LF-BENEFIT-AMT
 13897                                 TO CP-RATING-BENEFIT-AMT
 13898              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13899           WHEN WS-AH-BEN-CATEGORY = 'G'
 13900              MOVE PB-I-UNPAID-CASH-PRICE
 13901                                 TO CP-RATING-BENEFIT-AMT
 13902           WHEN WS-AH-BEN-CATEGORY = 'D'
 13903              MOVE WS-AH-PMF-COMM
 13904                                 TO CP-DCC-PMF-COMM
 13905              MOVE PB-I-AH-COMMISSION
 13906                                 TO CP-DCC-ACT-COMM
 13907        END-EVALUATE
 13908     END-IF
 13909     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13910     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 253
* EL050.cbl
 13911     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13912     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13913     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13914     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13915     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13916                                    CP-REMAINING-TERM
 13917                                    WS-WORK-TERM.
 13918     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13919
 13920     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13921     SET BIN-TO-GREG             TO TRUE.
 13922*    MOVE ' '                    TO DC-OPTION-CODE.
 13923     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13924     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13925
 13926     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13927     IF NOT VALID-SKIP-CODE
 13928         MOVE ER-2683            TO WS-ERROR
 13929         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13930         GO TO 3320-RATE-CONTINUE.
 13931
 13932     IF PB-NO-MONTHS-SKIPPED
 13933         GO TO 3320-RATE-CONTINUE.
 13934
 13935     MOVE SPACE TO NUMBER-OF-MONTHS.
 13936
 13937     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 13938         MOVE 'S'                TO SK-MO (6).
 13939     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 13940         MOVE 'S'                TO SK-MO (7).
 13941     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 13942         MOVE 'S'                TO SK-MO (8).
 13943     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 13944         MOVE 'S'                TO SK-MO (9).
 13945     IF PB-I-SKIP-CODE = 'A'
 13946         MOVE 'S'                TO SK-MO (10).
 13947
 13948     MOVE 1                      TO SUB2.
 13949     MOVE PB-I-AH-TERM           TO SUB3.
 13950     MOVE WS-MONTH               TO SUB1.
 13951     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 13952     GO TO 3320-RATE-CONTINUE.
 13953
 13954 3310-GET-SKIP-MO.
 13955     IF SUB1 = 13
 13956         MOVE 1                  TO SUB1.
 13957
 13958     IF SK-MO (SUB1) = 'S'
 13959         SUBTRACT 1 FROM WS-WORK-TERM.
 13960
 13961     ADD 1 TO SUB2
 13962              SUB1.
 13963
 13964 3320-RATE-CONTINUE.
 13965
 13966     IF WS-WORK-TERM = ZERO
 13967         MOVE 1                  TO WS-WORK-TERM.
 13968
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 254
* EL050.cbl
 13969     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 13970                                    CP-LOAN-TERM.
 13971
 13972     IF PB-COMPANY-ID EQUAL 'DMD'
 13973         NEXT SENTENCE
 13974     ELSE
 13975         MOVE ZERO               TO PB-I-AH-RATE
 13976                                    PB-I-AH-REI-RATE.
 13977
 13978
 13979     IF PB-COMPANY-ID EQUAL 'CRI'
 13980        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13981
 13982     IF PB-COMPANY-ID = 'CSL'
 13983         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 13984         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 13985         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13986         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13987
 13988     IF PB-COMPANY-ID = 'DCC'
 13989        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 13990           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 13991              PB-I-RATE-DEV-PCT-LF
 13992        END-IF
 13993        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13994                                 TO CP-ALTERNATE-BENEFIT
 13995        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13996        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13997        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13998     END-IF
 13999     IF (PB-COMPANY-ID = 'CID')
 14000        AND (WS-LF-EARNINGS-CALC = 'B')
 14001        AND (CP-STATE-STD-ABBRV = 'MN')
 14002        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14003     ELSE
 14004        MOVE ' '                 TO CP-AH-BALLOON-SW
 14005     END-IF
 14006     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14007     MOVE 'R'                   TO CP-RATE-FILE.
 14008     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14009
 14010     IF CP-ERROR-RATE-NOT-FOUND
 14011        IF PB-I-OB
 14012           MOVE ER-2624          TO WS-ERROR
 14013           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14014           GO TO 3340-CALCULATE-PREMIUM-AMT
 14015        ELSE
 14016          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14017              NEXT SENTENCE
 14018          ELSE
 14019           MOVE ER-2642          TO WS-ERROR
 14020           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14021           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14022
 14023     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14024        CP-ERROR-DIV-BY-ZERO
 14025           MOVE ER-3782          TO WS-ERROR
 14026           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 255
* EL050.cbl
 14027
 14028     IF PB-COMPANY-ID EQUAL 'CRI'
 14029        IF CP-ERROR-NO-LIMITS-CRI
 14030           IF NOT ACCOUNT-AH-CHECKED
 14031              MOVE ER-2607          TO WS-ERROR
 14032              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14033
 14034     IF ACCOUNT-AH-CHECKED
 14035        NEXT SENTENCE
 14036     ELSE
 14037       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14038          MOVE ER-2640           TO WS-ERROR
 14039          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14040
 14041     IF PB-COMPANY-ID = 'CRI'
 14042         IF WS-ERROR = ER-2640
 14043             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14044     IF ACCOUNT-AH-CHECKED
 14045        CONTINUE
 14046     ELSE
 14047        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14048           AND (CP-R-MAX-ATT-AGE > +0)
 14049           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14050           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14051              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14052              MOVE PB-I-AH-EXPIRE-DT
 14053                                 TO DC-BIN-DATE-2
 14054              MOVE '1'           TO DC-OPTION-CODE
 14055              PERFORM 8500-DATE-CONVERT
 14056                                 THRU 8500-EXIT
 14057              IF NO-CONVERSION-ERROR
 14058                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14059                    MOVE ER-2661       TO WS-ERROR
 14060*                   PERFORM 9900-ERROR-FORMAT
 14061*                                THRU 9900-EXIT
 14062                 END-IF
 14063              END-IF
 14064           ELSE
 14065              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14066              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14067                 MOVE ER-2661    TO WS-ERROR
 14068*                PERFORM 9900-ERROR-FORMAT
 14069*                                THRU 9900-EXIT
 14070              ELSE
 14071                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14072                    MOVE ER-1570 TO WS-ERROR
 14073                    PERFORM 9900-ERROR-FORMAT
 14074                                 THRU 9900-EXIT
 14075                 END-IF
 14076              END-IF
 14077           END-IF
 14078           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14079              MOVE PB-I-JOINT-BIRTHDAY
 14080                                    TO DC-BIN-DATE-1
 14081              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14082              MOVE '1'              TO DC-OPTION-CODE
 14083              PERFORM 8500-DATE-CONVERT
 14084                                    THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 256
* EL050.cbl
 14085              IF NO-CONVERSION-ERROR
 14086                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14087                    MOVE ER-2661       TO WS-ERROR
 14088*                   PERFORM 9900-ERROR-FORMAT
 14089*                                   THRU 9900-EXIT
 14090                 END-IF
 14091              END-IF
 14092           ELSE
 14093              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14094                (PB-I-AH-TERM / 12)
 14095              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14096                 MOVE ER-2661       TO WS-ERROR
 14097*                PERFORM 9900-ERROR-FORMAT
 14098*                                   THRU 9900-EXIT
 14099              ELSE
 14100                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14101                    MOVE ER-1571 TO WS-ERROR
 14102                    PERFORM 9900-ERROR-FORMAT
 14103                                 THRU 9900-EXIT
 14104                 END-IF
 14105              END-IF
 14106           END-IF
 14107           IF WS-ERROR = ER-2661
 14108              PERFORM 9900-ERROR-FORMAT
 14109                                    THRU 9900-EXIT
 14110           END-IF
 14111        END-IF
 14112     END-IF
 14113*    IF ACCOUNT-AH-CHECKED
 14114*       NEXT SENTENCE
 14115*    ELSE
 14116*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14117*          MOVE ER-2661          TO WS-ERROR
 14118*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14119
 14120     IF ACCOUNT-AH-CHECKED
 14121        NEXT SENTENCE
 14122     ELSE
 14123        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14124           MOVE ER-2663          TO WS-ERROR
 14125           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14126
 14127     IF ACCOUNT-AH-CHECKED OR
 14128        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14129         PB-POLICY-IS-VOIDED
 14130        NEXT SENTENCE
 14131     ELSE
 14132        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14133           MOVE ER-2667            TO WS-ERROR
 14134           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14135
 14136     IF PB-COMPANY-ID = 'CRI'
 14137         IF WS-ERROR = ER-2667
 14138             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14139
 14140     IF ACCOUNT-AH-CHECKED
 14141        NEXT SENTENCE
 14142     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 257
* EL050.cbl
 14143        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14144           MOVE ER-2678            TO WS-ERROR
 14145           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14146
 14147     IF CP-ERROR-RATE-FILE-NOTOPEN
 14148         GO TO 3990-FILES-NOT-OPEN.
 14149
 14150 3321-CONTINUE.
 14151     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14152     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14153     IF (PB-COMPANY-ID = 'DCC')
 14154        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14155        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14156                                    PB-I-LF-ALT-PREM-CALC
 14157        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14158        IF WS-AH-BEN-CATEGORY = 'G'
 14159           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14160           + PB-I-ADDL-CLP)
 14161           * (1 + WS-TOL-CLP-PCT)
 14162*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14163        ELSE
 14164           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14165           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14166*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14167        END-IF
 14168        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14169                                 TO PB-I-AH-PREM-CALC
 14170        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14171           MOVE ER-8152          TO WS-ERROR
 14172           PERFORM 9900-ERROR-FORMAT
 14173                                 THRU 9900-EXIT
 14174        ELSE
 14175           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14176                 PB-I-ADDL-CLP)
 14177              MOVE ER-8148       TO WS-ERROR
 14178              PERFORM 9900-ERROR-FORMAT
 14179                                 THRU 9900-EXIT
 14180           END-IF
 14181        END-IF
 14182     END-IF
 14183     IF (PB-COMPANY-ID = 'DCC')
 14184        AND (PB-I-POLICY-IS-MONTHLY)
 14185        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14186        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14187        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14188           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14189        END-IF
 14190     END-IF
 14191     IF (PB-COMPANY-ID = 'DCC')
 14192        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14193        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14194        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14195        MOVE ER-2786             TO WS-ERROR
 14196        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14197     END-IF
 14198     MOVE +0                     TO PB-I-AH-CLP
 14199     IF PB-COMPANY-ID = 'DCC'
 14200        IF WS-AH-BEN-CATEGORY = 'D'
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 258
* EL050.cbl
 14201           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14202              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14203        ELSE
 14204           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14205              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14206           END-IF
 14207        END-IF
 14208     END-IF
 14209     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14210
 14211     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14212         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14213
 14214     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14215         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14216
 14217     IF PB-COMPANY-ID = 'CRI'
 14218         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14219            PB-I-PAYMENT-AMOUNT = ZERO
 14220             NEXT SENTENCE
 14221         ELSE
 14222             COMPUTE PB-I-AH-PREM-CALC =
 14223                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14224                 (CP-PREMIUM-RATE / 100)
 14225             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14226                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14227                                             PB-I-RATE-DEV-PCT-AH.
 14228
 14229     IF PB-I-AH-RATE  = ZERO
 14230       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14231           NEXT SENTENCE
 14232       ELSE
 14233         MOVE ER-2642            TO WS-ERROR
 14234         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14235
 14236     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14237     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14238     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14239     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14240     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14241     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14242
 14243     IF (PB-COMPANY-ID = 'DCC')
 14244        AND (WS-AH-BEN-CATEGORY = 'G')
 14245        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14246        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14247        IF CP-DEVIATION-CODE NOT = '000'
 14248           MOVE '000'            TO CP-DEVIATION-CODE
 14249           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14250           IF NO-CP-ERROR
 14251              COMPUTE PB-I-DDF-IU-RATE-UP =
 14252              PB-I-AH-CLP - CP-CALC-PREMIUM
 14253           ELSE
 14254              MOVE ER-3057        TO WS-ERROR
 14255              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14256           END-IF
 14257        END-IF
 14258     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 259
* EL050.cbl
 14259     .
 14260 3335-EDIT-AH-REIN-NSP-RATE.
 14261     IF AH-REIN-NSP-NOT-USED
 14262         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14263
 14264     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14265     IF PB-COMPANY-ID = 'DCC'
 14266         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14267     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14268     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14269     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14270     MOVE PB-SV-STATE            TO CP-STATE.
 14271     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14272     MOVE ZERO                   TO CP-DEVIATION-CODE
 14273                                    CP-RATE-DEV-PCT.
 14274*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14275     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14276     MOVE '3'                    TO CP-PROCESS-TYPE.
 14277     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14278     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14279                                    CP-RATING-BENEFIT-AMT.
 14280     IF CP-STATE-STD-ABBRV = 'OR'
 14281         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14282                                         PB-I-AH-TERM.
 14283     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14284     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14285     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14286     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14287     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14288     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14289                                    CP-REMAINING-TERM
 14290                                    WS-WORK-TERM.
 14291     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14292     IF PB-COMPANY-ID = 'DCC'
 14293        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14294     END-IF
 14295     IF  PB-COMPANY-ID = 'TIC'
 14296         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14297            MOVE ZERO TO CP-CLASS-CODE.
 14298
 14299     IF PB-COMPANY-ID NOT = 'TIC'
 14300          MOVE ZERO          TO CP-CLASS-CODE.
 14301
 14302     MOVE ZERO               TO CP-DEVIATION-CODE.
 14303
 14304     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14305
 14306     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14307
 14308     MOVE 'R'                   TO CP-RATE-FILE.
 14309     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14310
 14311     IF CP-ERROR-RATE-NOT-FOUND
 14312         MOVE ER-2645        TO WS-ERROR
 14313         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14314         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14315
 14316     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 260
* EL050.cbl
 14317
 14318     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14319     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14320
 14321     IF PB-I-AH-REI-RATE = ZERO
 14322         MOVE ER-2645        TO WS-ERROR
 14323         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14324
 14325
 14326 3340-CALCULATE-PREMIUM-AMT.
 14327
 14328     IF PB-COMPANY-ID = 'NCL'
 14329         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14330             WS-AH-SPECIAL-CALC-CD = 'O')
 14331             GO TO 3999-END-EDIT.
 14332
 14333     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14334                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14335                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14336                         OR 'AHL'
 14337         NEXT SENTENCE
 14338     ELSE
 14339         IF WS-STATE-ABBREVIATION = 'CT'
 14340             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14341                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14342                 COMPUTE PB-I-LF-PREM-CALC =
 14343                                     PB-I-LF-PREM-CALC * .90
 14344                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14345                                     PB-I-LF-ALT-PREM-CALC * .90
 14346                 COMPUTE PB-I-AH-PREM-CALC =
 14347                                     PB-I-AH-PREM-CALC * .90.
 14348
 14349     IF PB-COMP-LF-PREM
 14350        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14351        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14352
 14353     IF PB-COMP-AH-PREM
 14354        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14355
 14356 3340-CHECK-DCC-TOT-FEES.
 14357     IF (PB-COMPANY-ID = 'DCC')
 14358        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14359        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14360        AND (PB-I-POLICY-IS-MONTHLY)
 14361        CONTINUE
 14362     ELSE
 14363        GO TO 3340-EDIT-LF-AH-TOL
 14364     END-IF
 14365     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14366     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14367     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14368        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14369           PB-I-RATE-DEV-PCT-LF
 14370     END-IF
 14371     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14372        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14373           PB-I-RATE-DEV-PCT-AH
 14374     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 261
* EL050.cbl
 14375     MOVE 'N'                    TO CP-BEN-CATEGORY
 14376     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14377
 14378     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14379     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14380     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14381     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14382     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14383     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14384     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14385     MOVE '3'                    TO CP-PROCESS-TYPE.
 14386     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14387     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14388
 14389     MOVE PB-SV-STATE            TO CP-STATE.
 14390     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14391     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14392     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14393     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14394     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14395                                    CP-RATING-BENEFIT-AMT.
 14396     IF CP-STATE-STD-ABBRV = 'OR'
 14397         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14398                                         PB-I-LF-ALT-BENEFIT-AMT.
 14399     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14400     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14401     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14402     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14403     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14404     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14405     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14406     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14407     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14408                                    CP-REMAINING-TERM
 14409                                    CP-LOAN-TERM.
 14410     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 14411         NEXT SENTENCE
 14412     ELSE
 14413         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14414             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14415                                           PB-I-LF-PREMIUM-AMT.
 14416
 14417     IF CP-TRUNCATED-LIFE
 14418        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14419
 14420     IF CP-TERM-IS-DAYS
 14421         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14422     ELSE
 14423         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14424
 14425     IF PB-COMPANY-ID = 'DCC'
 14426        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14427     END-IF
 14428     IF CP-SPECIAL-CALC-CD = 'H'
 14429         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14430                                    TO CP-ALTERNATE-BENEFIT
 14431         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14432     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 262
* EL050.cbl
 14433     MOVE 'R'                    TO CP-RATE-FILE
 14434     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14435     IF NOT CP-ERROR-RATE-NOT-FOUND
 14436        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14437        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14438           AND (CP-BENEFIT-CD (1:1) = 'S')
 14439           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14440                                    PB-I-LF-PREMIUM-AMT
 14441        END-IF
 14442     ELSE
 14443        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14444     END-IF
 14445     .
 14446 3340-EDIT-LF-AH-TOL.
 14447
 14448***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14449***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14450***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14451***
 14452     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14453         PB-I-AH-PREMIUM-AMT
 14454          GIVING WS-CALC-WORK.
 14455
 14456     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14457        AND WS-CALC-WORK NOT = ZERO
 14458         MOVE ER-2649            TO WS-ERROR
 14459         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14460
 14461     SUBTRACT PB-I-LF-PREM-CALC
 14462             FROM PB-I-LF-PREMIUM-AMT
 14463                 GIVING WS-UNSIGN-WRK1.
 14464
 14465     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14466             FROM PB-I-LF-ALT-PREMIUM-AMT
 14467                 GIVING WS-UNSIGN-WRK4.
 14468
 14469     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14470                                + WS-UNSIGN-WRK4.
 14471
 14472     SUBTRACT PB-I-AH-PREM-CALC
 14473             FROM PB-I-AH-PREMIUM-AMT
 14474                 GIVING WS-UNSIGN-WRK2.
 14475
 14476******************************************************************
 14477*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14478******************************************************************
 14479
 14480     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14481         MOVE ZERO TO WS-UNSIGN-WRK1.
 14482
 14483     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14484         MOVE ZERO TO WS-UNSIGN-WRK2.
 14485
 14486     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14487             GIVING WS-UNSIGN-WRK3.
 14488
 14489 3342-CONTINUE.
 14490
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 263
* EL050.cbl
 14491     IF (PB-I-LF-RATE = ZERO  AND
 14492         PB-I-AH-RATE = ZERO)
 14493         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14494            WS-AH-SPECIAL-CALC-CD = 'O'
 14495              NEXT SENTENCE
 14496         ELSE
 14497             GO TO 3345-EDIT-CONTINUE.
 14498
 14499     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14500         NEXT SENTENCE
 14501     ELSE
 14502     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14503        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14504           IF (PB-REISSUED-CERT         OR
 14505               PB-POLICY-IS-DECLINED    OR
 14506               PB-POLICY-IS-VOIDED)
 14507              NEXT SENTENCE
 14508           ELSE
 14509              IF WS-PREM-REJECT-SW = SPACE
 14510                 MOVE ER-2652    TO WS-ERROR
 14511                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14512                 GO TO 3344-CHECK-AH
 14513              ELSE
 14514                 MOVE ER-2650    TO WS-ERROR
 14515                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14516                 GO TO 3344-CHECK-AH.
 14517
 14518***
 14519***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14520***
 14521
 14522     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14523         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14524            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14525             (1 + WS-TOL-LF-PREM-PCT)
 14526         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14527            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14528             (1 - WS-TOL-LF-PREM-PCT)
 14529     ELSE
 14530         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14531         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14532
 14533***
 14534***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14535***
 14536
 14537     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14538         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14539          WS-TOL-LF-PREM.
 14540
 14541     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14542         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14543          WS-TOL-LF-PREM.
 14544
 14545     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14546        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14547
 14548     IF PB-REISSUED-CERT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 264
* EL050.cbl
 14549        or PB-POLICY-IS-DECLINED
 14550        or PB-POLICY-IS-VOIDED
 14551        continue
 14552     ELSE
 14553        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14554              > WS-TOL-LF-HIGH-PREM-AMT)
 14555           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14556              < WS-TOL-LF-LOW-PREM-AMT))
 14557                      or
 14558           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14559              > WS-TOL-LF-HIGH-PREM-PCT)
 14560           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14561              < WS-TOL-LF-LOW-PREM-PCT))
 14562           IF WS-PREM-REJECT-SW = SPACE
 14563              MOVE ER-2652       TO WS-ERROR
 14564              PERFORM 9900-ERROR-FORMAT
 14565                                 THRU 9900-EXIT
 14566           ELSE
 14567              MOVE ER-2650       TO WS-ERROR
 14568              PERFORM 9900-ERROR-FORMAT
 14569                                 THRU 9900-EXIT
 14570           end-if
 14571        end-if
 14572     end-if
 14573
 14574*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14575*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14576*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14577*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14578
 14579     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14580        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14581                      OR
 14582           ((PB-COMPANY-ID = 'DCC')
 14583           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14584           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14585           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14586        END-IF
 14587     END-IF
 14588
 14589     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14590        IF WS-COMP-MAX-CAP GREATER THAN +0
 14591           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14592              IF (PB-REISSUED-CERT         OR
 14593                  PB-POLICY-IS-DECLINED    OR
 14594                  PB-POLICY-IS-VOIDED)
 14595                 NEXT SENTENCE
 14596              ELSE
 14597                  MOVE ER-2646   TO  WS-ERROR
 14598                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14599
 14600 3344-CVL-TOLERANCE-CHECK.
 14601
 14602      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14603          GO TO 3344-CHECK-AH.
 14604
 14605      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14606          GO TO 3344-CHECK-AH.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 265
* EL050.cbl
 14607
 14608      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14609                                     WS-UNSIGN-WRK6.
 14610
 14611      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14612          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14613                                 + PB-I-LF-PREMIUM-AMT
 14614                                 - PB-I-LF-PREM-CALC.
 14615
 14616      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14617          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14618                                 + PB-I-LF-ALT-PREMIUM-AMT
 14619                                 - PB-I-LF-ALT-PREM-CALC.
 14620
 14621      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14622          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14623              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14624                 MOVE ER-2652    TO  WS-ERROR
 14625                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14626              ELSE
 14627                 MOVE ER-2650    TO  WS-ERROR
 14628                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14629
 14630      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14631          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14632              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14633                 MOVE ER-2652    TO  WS-ERROR
 14634                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14635              ELSE
 14636                 MOVE ER-2650    TO  WS-ERROR
 14637                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14638
 14639 3344-CHECK-AH.
 14640
 14641****************************************************************
 14642***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14643***
 14644
 14645     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14646         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14647             (1 + WS-TOL-AH-PREM-PCT)
 14648         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14649             (1 - WS-TOL-AH-PREM-PCT)
 14650     ELSE
 14651         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14652         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14653
 14654***
 14655***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14656***
 14657
 14658     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14659         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14660
 14661     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14662         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14663
 14664     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 266
* EL050.cbl
 14665        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14666
 14667     IF (PB-REISSUED-CERT)
 14668        OR (PB-POLICY-IS-DECLINED)
 14669        OR (PB-POLICY-IS-VOIDED)
 14670        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14671        CONTINUE
 14672     ELSE
 14673        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14674              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14675                          or
 14676           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14677              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14678           IF WS-PREM-REJECT-SW = SPACE
 14679              MOVE ER-3052       TO WS-ERROR
 14680              PERFORM 9900-ERROR-FORMAT
 14681                                 THRU 9900-EXIT
 14682           ELSE
 14683              MOVE ER-3050       TO WS-ERROR
 14684              PERFORM 9900-ERROR-FORMAT
 14685                                 THRU 9900-EXIT
 14686           END-IF
 14687        END-IF
 14688     END-IF
 14689     if (pb-company-id = 'DCC')
 14690        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14691        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14692        and (pb-i-policy-is-monthly)
 14693        compute ws-tol-ah-high-prem-amt =
 14694           pb-i-tot-fees-calc + ws-tol-ah-prem
 14695        compute ws-tol-ah-low-prem-amt =
 14696           pb-i-tot-fees-calc - ws-tol-ah-prem
 14697        if ws-tol-ah-prem-pct > zeros
 14698           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14699              (1 + ws-tol-ah-prem-pct)
 14700           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14701              (1 - ws-tol-ah-prem-pct)
 14702        else
 14703           move +9999999.99      to ws-tol-ah-high-prem-pct
 14704           move +0               to ws-tol-ah-low-prem-pct
 14705        end-if
 14706        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14707            or
 14708           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14709                          or
 14710           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14711           or
 14712           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14713            move er-3049         to ws-error
 14714           perform 9900-error-format
 14715                                 thru 9900-exit
 14716
 14717        end-if
 14718     end-if
 14719     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14720         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14721             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14722             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 267
* EL050.cbl
 14723
 14724     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14725        IF WS-COMP-MAX-CAP GREATER THAN +0
 14726           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14727              IF (PB-REISSUED-CERT         OR
 14728                  PB-POLICY-IS-DECLINED    OR
 14729                  PB-POLICY-IS-VOIDED)
 14730                 NEXT SENTENCE
 14731              ELSE
 14732                  MOVE ER-2646   TO  WS-ERROR
 14733                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14734
 14735     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14736        (WS-COMP-MAX-CAP EQUAL +0)
 14737           GO TO 3345-EDIT-CONTINUE.
 14738
 14739     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14740        GREATER THAN WS-COMP-MAX-CAP
 14741           MOVE ER-2646          TO  WS-ERROR
 14742           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14743
 14744 3345-EDIT-CONTINUE.
 14745
 14746*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14747*       IF PB-ENTRY-BATCH   NUMERIC
 14748*          IF PB-ISSUE
 14749*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14750*          ELSE
 14751*              IF PB-CANCELLATION
 14752*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14753
 14754*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14755*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14756*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14757*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14758*        ELSE
 14759*            MOVE  ER-1909            TO  WS-ERROR
 14760*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14761
 14762     IF PB-I-POLICY-ACCEPTED
 14763        IF PB-POLICY-IS-DECLINED  OR
 14764           PB-REISSUED-CERT  OR
 14765           PB-REIN-ONLY-CERT  OR
 14766           PB-POLICY-IS-VOIDED
 14767            MOVE  ER-1891         TO  WS-ERROR
 14768            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14769        ELSE
 14770            MOVE SPACE            TO  PB-BATCH-ENTRY
 14771            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14772
 14773     IF PB-I-POLICY-DECLINED
 14774        IF PB-REISSUED-CERT  OR
 14775           PB-REIN-ONLY-CERT  OR
 14776           PB-POLICY-IS-VOIDED
 14777            MOVE  ER-1906         TO  WS-ERROR
 14778            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14779        ELSE
 14780            MOVE  'D'             TO  PB-BATCH-ENTRY
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 268
* EL050.cbl
 14781                                      PB-I-ENTRY-STATUS.
 14782
 14783     IF PB-I-NEEDS-UNDERWRITING
 14784        IF PB-POLICY-IS-DECLINED OR
 14785           PB-REISSUED-CERT  OR
 14786           PB-REIN-ONLY-CERT  OR
 14787           PB-POLICY-IS-VOIDED
 14788            MOVE  ER-1907         TO  WS-ERROR
 14789            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14790        ELSE
 14791            MOVE 'U'              TO  PB-BATCH-ENTRY
 14792                                      PB-I-ENTRY-STATUS.
 14793
 14794     IF PB-NEEDS-UNDERWRITING
 14795        MOVE  ER-1901             TO  WS-ERROR
 14796        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14797     IF PB-COMPANY-ID = 'DCC'
 14798        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14799        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14800        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14801           AND (NOT WS-LF-CASH))
 14802                           OR
 14803           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14804           AND (NOT WS-AH-CASH)))
 14805                       AND
 14806           (PB-I-ENTRY-STATUS NOT = '5')
 14807           MOVE 'M'              TO PB-BATCH-ENTRY
 14808                                    PB-I-ENTRY-STATUS
 14809        END-IF
 14810     END-IF
 14811     IF  PB-COMPANY-ID NOT = 'NCL'
 14812         GO TO 3999-END-EDIT.
 14813
 14814     IF PB-REISSUED-CERT  OR
 14815        PB-POLICY-IS-DECLINED  OR
 14816        PB-POLICY-IS-VOIDED  OR
 14817        PB-I-OB
 14818         GO TO 3999-END-EDIT.
 14819
 14820     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14821         MOVE  ER-2644            TO  WS-ERROR
 14822         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14823         GO TO 3999-END-EDIT.
 14824
 14825     MOVE 'N'                     TO  FORM-MASTER-SW.
 14826     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14827
 14828     IF NOT FORM-MASTER-FOUND
 14829         GO TO 3999-END-EDIT.
 14830
 14831     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14832                                      FORM-MASTER-AH-SW.
 14833
 14834     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14835         MOVE  +1                 TO SUB6
 14836         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14837
 14838     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 269
* EL050.cbl
 14839         MOVE  +1                 TO SUB6
 14840         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14841
 14842     IF LF-FORM-MASTER-FOUND  OR
 14843        AH-FORM-MASTER-FOUND
 14844         GO TO 3360-CHECK-FORM-LIMITS
 14845     ELSE
 14846         GO TO 3999-END-EDIT.
 14847
 14848******************************************************************
 14849*                  3350-GET-ERFORM                               *
 14850*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14851*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14852******************************************************************
 14853
 14854 3350-GET-ERFORM.
 14855
 14856     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14857         GO TO  3350-ERFORM-GETMAIN.
 14858
 14859     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14860     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14861     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14862     MOVE 'Y'                     TO FORM-MASTER-SW.
 14863
 14864     IF PB-CANCELLATION
 14865         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14866            PB-SV-STATE          EQUAL   FO-STATE       AND
 14867            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14868              GO TO 3350-EXIT
 14869         ELSE
 14870             NEXT SENTENCE
 14871     ELSE
 14872         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14873            PB-SV-STATE          EQUAL   FO-STATE       AND
 14874            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14875              GO TO 3350-EXIT.
 14876
 14877 3350-ERFORM-GETMAIN.
 14878
 14879     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14880     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14881
 14882 3350-ERFORM-READ.
 14883
 14884     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14885     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14886     IF PB-CANCELLATION
 14887         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14888     ELSE
 14889         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14890     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14891
 14892     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14893
 14894     IF FORM-MASTER-FOUND
 14895       IF PB-CANCELLATION
 14896          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 270
* EL050.cbl
 14897             PB-SV-STATE          EQUAL   FO-STATE       AND
 14898             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14899              GO  TO 3350-EXIT
 14900          ELSE
 14901              NEXT SENTENCE
 14902       ELSE
 14903          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14904             PB-SV-STATE          EQUAL   FO-STATE       AND
 14905             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14906              GO  TO 3350-EXIT.
 14907
 14908     MOVE  'N'                    TO  FORM-MASTER-SW.
 14909     MOVE  ER-1895                TO  WS-ERROR.
 14910     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14911
 14912 3350-EXIT.
 14913      EXIT.
 14914
 14915******************************************************************
 14916*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14917*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14918*   VALID FOR THE POLICY FORM USED.                              *
 14919******************************************************************
 14920
 14921 3355-EDIT-FORM-LF-BENEFITS.
 14922
 14923     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14924        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14925         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14926         GO TO   3355-EXIT.
 14927
 14928     IF  SUB6    LESS THAN   +40
 14929         ADD  +1      TO  SUB6
 14930         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14931
 14932     MOVE  ER-1896         TO  WS-ERROR.
 14933     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14934
 14935 3355-EXIT.
 14936      EXIT.
 14937
 14938******************************************************************
 14939*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14940*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14941*   VALID FOR THE POLICY FORM USED.                              *
 14942******************************************************************
 14943
 14944 3356-EDIT-FORM-AH-BENEFITS.
 14945
 14946     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14947        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14948         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 14949         GO TO  3356-EXIT.
 14950
 14951      IF  SUB6    LESS THAN     +40
 14952          ADD  +1      TO  SUB6
 14953          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 14954
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 271
* EL050.cbl
 14955     MOVE  ER-1897         TO  WS-ERROR.
 14956     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14957
 14958 3356-EXIT.
 14959      EXIT.
 14960
 14961******************************************************************
 14962*                  3357-BENEFIT-SEARCH                           *
 14963*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 14964*   CANCELLATIONS ONLY.                                          *
 14965******************************************************************
 14966 3357-BENEFIT-SEARCH.
 14967     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 14968         MOVE +1                          TO SUB6
 14969         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 14970
 14971     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 14972         MOVE +1                          TO SUB6
 14973         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 14974
 14975 3357-EXIT.
 14976     EXIT.
 14977
 14978******************************************************************
 14979*                  3358-BENEFIT-LIFE-SEARCH                      *
 14980*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 14981*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14982*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14983******************************************************************
 14984 3358-BENEFIT-LIFE-SEARCH.
 14985     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 14986       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 14987         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14988           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14989              IF FO-PLAN-REFUND-METHOD (SUB6)
 14990                     IS GREATER THAN SPACES
 14991                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14992                                          WS-LF-REFUND-CALC
 14993                 GO TO 3358-EXIT.
 14994
 14995     IF SUB6 LESS THAN +40
 14996         ADD +1                 TO SUB6
 14997         GO TO 3358-BENEFIT-LIFE-SEARCH.
 14998
 14999 3358-EXIT.
 15000     EXIT.
 15001******************************************************************
 15002*                  3359-BENEFIT-AH-SEARCH                        *
 15003*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15004*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15005*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15006******************************************************************
 15007 3359-BENEFIT-AH-SEARCH.
 15008     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15009       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15010         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15011           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15012              IF FO-PLAN-REFUND-METHOD (SUB6)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 272
* EL050.cbl
 15013                      IS GREATER THAN SPACES
 15014                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15015                                          WS-AH-REFUND-CALC
 15016                 GO TO 3359-EXIT.
 15017
 15018     IF SUB6 LESS THAN +40
 15019         ADD +1                 TO SUB6
 15020         GO TO 3359-BENEFIT-AH-SEARCH.
 15021
 15022 3359-EXIT.
 15023     EXIT.
 15024
 15025******************************************************************
 15026*                  3360-CHECK-FORM-LIMITS                        *
 15027*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15028*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15029******************************************************************
 15030
 15031 3360-CHECK-FORM-LIMITS.
 15032
 15033     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15034         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15035
 15036     IF NOT LF-FORM-MASTER-FOUND
 15037         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15038
 15039 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15040
 15041     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15042       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15043        WS-LF-JOINT-INDICATOR = 'J'  AND
 15044        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15045         IF PB-COMPANY-ID = 'NCL'
 15046            MOVE  ER-1911          TO  WS-ERROR
 15047            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15048         ELSE
 15049            MOVE  ER-1892          TO  WS-ERROR
 15050            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15051
 15052 3360-CHECK-FORM-LF-ATT-AGE.
 15053
 15054     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15055
 15056     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15057         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15058         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15059            IF PB-COMPANY-ID = 'NCL'
 15060                MOVE  ER-1913      TO  WS-ERROR
 15061                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15062            ELSE
 15063                MOVE  ER-1894      TO  WS-ERROR
 15064                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15065
 15066 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15067
 15068     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15069         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15070         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 273
* EL050.cbl
 15071            IF PB-COMPANY-ID = 'NCL'
 15072                MOVE  ER-1914      TO  WS-ERROR
 15073                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15074            ELSE
 15075                MOVE  ER-1899      TO  WS-ERROR
 15076                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15077
 15078 3360-CHECK-FORM-LF-TERM-BAMT.
 15079
 15080     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15081         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15082         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15083           IF  PB-COMPANY-ID = 'NCL'
 15084               MOVE  ER-1916       TO  WS-ERROR
 15085               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15086           ELSE
 15087               MOVE  ER-1902       TO  WS-ERROR
 15088               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15089
 15090     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15091                                    PB-I-LF-ALT-BENEFIT-AMT.
 15092
 15093     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15094         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15095         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15096             IF  PB-COMPANY-ID = 'NCL'
 15097                 MOVE  ER-1918     TO  WS-ERROR
 15098                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15099             ELSE
 15100                 MOVE  ER-1904     TO  WS-ERROR
 15101                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15102
 15103******************************************************************
 15104*                  3360-CHECK-FORM-AH-LIMITS                     *
 15105*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15106*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15107******************************************************************
 15108
 15109 3360-CHECK-FORM-AH-LIMITS.
 15110
 15111     IF NOT AH-FORM-MASTER-FOUND
 15112         GO TO 3999-END-EDIT.
 15113
 15114 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15115
 15116     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15117       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15118        WS-AH-JOINT-INDICATOR = 'J'  AND
 15119        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15120         IF PB-COMPANY-ID = 'NCL'
 15121            MOVE  ER-1912          TO  WS-ERROR
 15122            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15123         ELSE
 15124            MOVE  ER-1893          TO  WS-ERROR
 15125            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15126
 15127 3360-CHECK-FORM-AH-ATT-AGE.
 15128
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 274
* EL050.cbl
 15129     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15130
 15131     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15132         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15133         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15134            IF PB-COMPANY-ID = 'NCL'
 15135                MOVE  ER-1913      TO  WS-ERROR
 15136                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15137            ELSE
 15138                MOVE  ER-1894      TO  WS-ERROR
 15139                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15140
 15141 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15142
 15143     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15144         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15145         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15146            IF PB-COMPANY-ID = 'NCL'
 15147                MOVE  ER-1915      TO  WS-ERROR
 15148                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15149            ELSE
 15150                MOVE  ER-1900      TO  WS-ERROR
 15151                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15152
 15153 3360-CHECK-FORM-AH-TERM-BAMT.
 15154
 15155     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15156         FO-AH-MAX-TERM    GREATER THAN  +0
 15157         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15158             IF  PB-COMPANY-ID = 'NCL'
 15159                 MOVE  ER-1917     TO  WS-ERROR
 15160                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15161             ELSE
 15162                  MOVE  ER-1903    TO  WS-ERROR
 15163                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15164
 15165     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15166         FO-MAX-AH-AMT    GREATER THAN  +0
 15167         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15168             IF  PB-COMPANY-ID = 'NCL'
 15169                 MOVE  ER-1919     TO  WS-ERROR
 15170                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15171             ELSE
 15172                 MOVE  ER-1905     TO  WS-ERROR
 15173                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15174
 15175     GO TO 3999-END-EDIT.
 15176
 15177******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 275
* EL050.cbl
 15179******************************************************************
 15180*                  E D I T   C A N C E L                         *
 15181******************************************************************
 15182
 15183 3700-EDIT-CANCEL.
 15184     IF PB-COMPANY-ID = 'DMD'
 15185         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15186                                         WS-RES-MUNI-TAX
 15187                                         PB-CI-STATE-TAX
 15188                                         PB-CI-MUNI-TAX
 15189         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15190
 15191*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15192*       IF PB-ENTRY-BATCH  NUMERIC
 15193*          IF PB-CANCELLATION
 15194*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15195*          ELSE
 15196*             IF PB-ISSUE
 15197*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15198
 15199     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15200        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15201     END-IF
 15202*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15203*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15204
 15205     IF CM-ENTRY-STATUS = 'V'
 15206        MOVE ER-2780             TO WS-ERROR
 15207        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15208        GO TO 3999-END-EDIT.
 15209
 15210     IF CM-ENTRY-STATUS = 'D'
 15211        MOVE ER-2781             TO WS-ERROR
 15212        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15213        GO TO 3999-END-EDIT.
 15214
 15215     IF CM-ENTRY-STATUS = 'U'
 15216        MOVE ER-2782             TO WS-ERROR
 15217        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15218
 15219***************************************************************
 15220*                                                             *
 15221*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15222*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15223*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15224*   OF ANOTHER COVERAGE.                                      *
 15225*                                                             *
 15226***************************************************************
 15227
 15228     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15229                                    PB-C-AH-CANCEL-VOID-SW.
 15230
 15231     IF PB-C-LF-CANCEL-AMT = ZERO
 15232        NEXT SENTENCE
 15233     ELSE
 15234        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15235           AND
 15236           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 276
* EL050.cbl
 15237               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15238               MOVE ER-2745           TO WS-ERROR
 15239               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15240
 15241     IF PB-C-AH-CANCEL-AMT = ZERO
 15242        NEXT SENTENCE
 15243     ELSE
 15244        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15245           AND
 15246           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15247               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15248               MOVE ER-2745           TO WS-ERROR
 15249               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15250
 15251     IF WS-LF-EARNINGS-CALC = '4'
 15252        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15253
 15254     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15255     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15256     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15257     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15258     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15259     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15260
 15261     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15262                                      PB-C-AH-REF-CALC.
 15263     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15264
 15265******************************************************************
 15266*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15267*             TO VALIDATE COVERAGE.                              *
 15268******************************************************************
 15269
 15270     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15271        PB-C-LF-CANCEL-AMT = ZEROS
 15272          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15273      ELSE
 15274          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15275
 15276     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15277        PB-C-AH-CANCEL-AMT = ZEROS
 15278          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15279      ELSE
 15280          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15281
 15282     EVALUATE TRUE
 15283         WHEN PB-CANCEL-FORCE             OR
 15284              PB-CANCEL-DATE-FORCED       OR
 15285              PB-FORCE-OFF
 15286                  IF PB-COMPANY-ID = 'ACE'
 15287                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15288                  END-IF
 15289         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15290               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15291              (PB-COMPANY-ID = 'ACE' )
 15292                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15293         WHEN OTHER
 15294              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 277
* EL050.cbl
 15295                 MOVE ER-2794              TO WS-ERROR
 15296              ELSE
 15297                 MOVE ER-2749              TO WS-ERROR
 15298              END-IF
 15299              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15300     END-EVALUATE.
 15301
 15302
 15303*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15304*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15305*            MOVE  ER-1909            TO  WS-ERROR
 15306*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15307*        ELSE
 15308*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15309
 15310     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15311     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15312        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15313     ELSE
 15314        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15315     END-IF
 15316     .
 15317 3705-EDIT-CANCEL-DT.
 15318
 15319     IF LF-COVERAGE-CANCELLED
 15320        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15321         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15322         MOVE WS-CURRENT-MONTH-END
 15323                                 TO DC-BIN-DATE-2
 15324         SET ELAPSED-BETWEEN-BIN TO TRUE
 15325*        MOVE 1                  TO DC-OPTION-CODE
 15326         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15327         IF DATE-CONVERSION-ERROR
 15328            NEXT SENTENCE
 15329          ELSE
 15330             IF DC-ELAPSED-DAYS GREATER +180
 15331                IF PB-CANCEL-DATE-FORCED  OR
 15332                   PB-CANCEL-DATE-FORCED-NO-FEE
 15333                      MOVE ER-2751  TO WS-ERROR
 15334                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15335                 ELSE
 15336                   MOVE ER-2752  TO WS-ERROR
 15337                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15338
 15339     IF AH-COVERAGE-CANCELLED
 15340        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15341         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15342         MOVE WS-CURRENT-MONTH-END
 15343                                 TO DC-BIN-DATE-2
 15344         SET ELAPSED-BETWEEN-BIN TO TRUE
 15345*        MOVE 1                  TO DC-OPTION-CODE
 15346         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15347         IF DATE-CONVERSION-ERROR
 15348            NEXT SENTENCE
 15349          ELSE
 15350             IF DC-ELAPSED-DAYS GREATER +180
 15351                IF PB-CANCEL-DATE-FORCED OR
 15352                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 278
* EL050.cbl
 15353                      MOVE ER-2751  TO WS-ERROR
 15354                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15355                 ELSE
 15356                   MOVE ER-2752  TO WS-ERROR
 15357                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15358
 15359     IF WS-ERROR = ER-2752
 15360        AND (PB-COMPANY-ID = 'ABL'
 15361         OR  PB-COMPANY-ID = 'FGL'
 15362         OR  PB-COMPANY-ID = 'IST'
 15363         OR  PB-COMPANY-ID = 'JHL'
 15364         OR  PB-COMPANY-ID = 'LAP'
 15365         OR  PB-COMPANY-ID = 'LBL'
 15366         OR  PB-COMPANY-ID = 'NCB'
 15367         OR  PB-COMPANY-ID = 'NLI'
 15368         OR  PB-COMPANY-ID = 'OFI'
 15369         OR  PB-COMPANY-ID = 'PLI'
 15370         OR  PB-COMPANY-ID = 'TAO'
 15371         OR  PB-COMPANY-ID = 'TIC'
 15372         OR  PB-COMPANY-ID = 'HER'
 15373         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15374         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15375            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15376            MOVE ER-2762     TO WS-ERROR
 15377            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15378
 15379     IF LF-COVERAGE-CANCELLED
 15380        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15381        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15382             MOVE ER-2733         TO WS-ERROR
 15383             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15384
 15385     IF AH-COVERAGE-CANCELLED
 15386        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15387        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15388              MOVE ER-2733        TO WS-ERROR
 15389              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15390
 15391     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15392        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15393        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15394           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15395            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15396              IF PB-COMPANY-ID NOT = 'LAP'
 15397               MOVE ER-2704            TO WS-ERROR
 15398               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15399
 15400     IF CERT-WAS-NOT-FOUND
 15401         GO TO 3999-END-EDIT.
 15402
 15403     IF PB-COMPANY-ID EQUAL 'CDC'
 15404        IF LF-COVERAGE-CANCELLED
 15405           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15406            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15407            MOVE PB-C-LF-CANCEL-DT
 15408                                 TO DC-BIN-DATE-2
 15409            SET ELAPSED-BETWEEN-BIN TO TRUE
 15410*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 279
* EL050.cbl
 15411            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15412            IF DATE-CONVERSION-ERROR
 15413               NEXT SENTENCE
 15414             ELSE
 15415                IF DC-ELAPSED-DAYS GREATER +60
 15416                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15417
 15418     IF PB-COMPANY-ID EQUAL 'CDC'
 15419        IF AH-COVERAGE-CANCELLED
 15420           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15421            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15422            MOVE PB-C-AH-CANCEL-DT
 15423                                 TO DC-BIN-DATE-2
 15424            MOVE +0              TO DC-ELAPSED-DAYS
 15425                                    DC-ELAPSED-MONTHS
 15426            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15427*           MOVE 1               TO DC-OPTION-CODE
 15428            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15429            IF DATE-CONVERSION-ERROR
 15430               NEXT SENTENCE
 15431             ELSE
 15432                IF DC-ELAPSED-DAYS GREATER +60
 15433                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15434
 15435     MOVE +0                     TO DC-ELAPSED-DAYS
 15436                                    DC-ELAPSED-MONTHS.
 15437
 15438     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15439        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15440          MOVE 'Z'                TO PB-CI-OB-FLAG
 15441          MOVE ER-2767            TO WS-ERROR
 15442          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15443          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15444          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15445          GO TO 3775-OVER-REF-CHK
 15446        ELSE
 15447          MOVE ZEROS              TO PB-CI-LIVES
 15448                                     PB-C-LIVES
 15449          IF PB-CI-OB-FLAG NOT = 'B'
 15450             MOVE SPACE           TO PB-CI-OB-FLAG.
 15451
 15452     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15453         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15454     ELSE
 15455         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15456
 15457     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15458        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15459            MOVE ER-2760         TO WS-ERROR
 15460            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15461
 15462     IF LF-COVERAGE-CANCELLED
 15463        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15464         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15465            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15466               MOVE ER-2774       TO WS-ERROR
 15467               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15468
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 280
* EL050.cbl
 15469     IF AH-COVERAGE-CANCELLED
 15470        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15471         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15472            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15473               MOVE ER-2775       TO WS-ERROR
 15474               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15475
 15476     IF LF-COVERAGE-CANCELLED
 15477        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15478         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15479            MOVE ER-2776         TO WS-ERROR
 15480            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15481
 15482     IF AH-COVERAGE-CANCELLED
 15483        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15484         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15485            MOVE ER-2777         TO WS-ERROR
 15486            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15487
 15488     IF LF-COVERAGE-CANCELLED
 15489        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15490         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15491         MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15492         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15493*        MOVE 6                    TO DC-OPTION-CODE
 15494         SET BIN-PLUS-ELAPSED      TO TRUE
 15495         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15496         IF DATE-CONVERSION-ERROR
 15497            NEXT SENTENCE
 15498          ELSE
 15499            IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15500              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15501                             OR  'FIA'
 15502                 MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15503               ELSE
 15504                MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15505                MOVE ER-2731       TO WS-ERROR
 15506                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15507
 15508 3705-EDIT-AH-CANCEL-DT.
 15509
 15510     IF AH-COVERAGE-CANCELLED
 15511        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15512         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15513         MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15514         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15515*        MOVE 6                    TO DC-OPTION-CODE
 15516         SET BIN-PLUS-ELAPSED      TO TRUE
 15517         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15518         IF DATE-CONVERSION-ERROR
 15519            NEXT SENTENCE
 15520          ELSE
 15521            IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15522              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15523                              OR 'FIA'
 15524                MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15525              ELSE
 15526               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 281
* EL050.cbl
 15527               MOVE ER-2771       TO WS-ERROR
 15528               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15529
 15530 3705-EDIT-CONTINUED.
 15531
 15532*    IF LF-COVERAGE-CANCELLED
 15533*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15534*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15535*            MOVE ER-2727         TO WS-ERROR
 15536*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15537*
 15538*    IF AH-COVERAGE-CANCELLED
 15539*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15540*        IF PB-COMPANY-ID = 'ACE'
 15541*           MOVE ER-2727        TO WS-ERROR
 15542*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15543*        ELSE
 15544*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15545*              MOVE ER-2727     TO WS-ERROR
 15546*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15547
 15548     IF PB-COMPANY-ID = 'ACE'
 15549       IF AH-COVERAGE-CANCELLED
 15550         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15551           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15552              MOVE ER-2732      TO WS-ERROR
 15553              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15554
 15555     IF PB-COMPANY-ID      EQUAL   'HER'
 15556        IF WS-ERROR        EQUAL   ER-2727
 15557            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15558            MOVE  ER-2725          TO  WS-ERROR
 15559            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15560
 15561     IF PB-C-CLAIM-CREATED-CANCEL
 15562            MOVE ER-2748         TO WS-ERROR
 15563            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15564
 15565     IF PB-C-LAST-NAME NOT = SPACES
 15566         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15567            MOVE ER-2747         TO WS-ERROR
 15568            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15569
 15570 3710-EDIT-LUMP-SUM-PRIOR.
 15571
 15572     IF AH-COVERAGE-CANCELLED
 15573         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15574             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15575                MOVE ER-2735    TO WS-ERROR
 15576                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15577
 15578     IF LF-COVERAGE-CANCELLED
 15579         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15580             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15581                MOVE ER-2735    TO WS-ERROR
 15582                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15583
 15584 3710-EDIT-PRIOR-DEATH.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 282
* EL050.cbl
 15585
 15586*    IF LF-COVERAGE-CANCELLED
 15587*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15588*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15589*           (NOT PB-CI-OB)
 15590*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15591*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15592*                   MOVE ER-2732  TO WS-ERROR
 15593*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15594*
 15595*    IF AH-COVERAGE-CANCELLED
 15596*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15597*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15598*           (NOT PB-CI-OB)
 15599*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15600*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15601*                   MOVE ER-2732  TO WS-ERROR
 15602*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15603
 15604     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15605         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15606            (NOT PB-COMP-LF-CANCEL)
 15607             NEXT SENTENCE
 15608         ELSE
 15609           IF PB-C-LF-CANCEL-VOIDED
 15610              NEXT SENTENCE
 15611           ELSE
 15612              MOVE ER-2753      TO WS-ERROR
 15613              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15614
 15615     IF CANCEL-FUTURE-DT
 15616         GO TO 3999-END-EDIT.
 15617
 15618 3715-GET-REMAIN-TERM-LF.
 15619
 15620     IF NO-LF-BENEFIT-MATCH  OR
 15621        WS-LF-BENEFIT-CD = ZEROS
 15622        GO TO 3730-GET-AH-REMAIN-TERM.
 15623
 15624     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15625     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15626     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15627     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15628     MOVE PB-SV-STATE            TO CP-STATE.
 15629     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15630     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15631     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15632     MOVE '2'                    TO CP-PROCESS-TYPE.
 15633     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15634     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15635     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15636     IF (PB-COMPANY-ID = 'CID')
 15637        AND (CP-STATE-STD-ABBRV = 'WI')
 15638        MOVE '7'                 TO CP-REM-TERM-METHOD
 15639        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15640     ELSE
 15641        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15642        MOVE WS-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 283
* EL050.cbl
 15643                                 TO CP-REM-TRM-CALC-OPTION
 15644     END-IF
 15645**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15646     IF (PB-COMPANY-ID = 'CID')
 15647        AND (CP-STATE-STD-ABBRV = 'MO')
 15648        AND (PB-CERT-EFF-DT >= X'9B41')
 15649        AND (PB-CERT-EFF-DT <= X'A2FB')
 15650        MOVE '7'                 TO CP-REM-TERM-METHOD
 15651        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15652     END-IF
 15653     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15654                                    CP-LOAN-TERM.
 15655     IF CP-TRUNCATED-LIFE
 15656        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15657
 15658     IF CP-TERM-IS-DAYS
 15659         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15660     ELSE
 15661         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15662
 15663     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15664
 15665     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15666
 15667     IF LF-COVERAGE-CANCELLED
 15668        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15669        NEXT SENTENCE
 15670      ELSE
 15671          GO TO 3730-GET-AH-REMAIN-TERM.
 15672
 15673 3720-GET-LF-REFUND.
 15674
 15675     IF PB-C-LF-CANCEL-VOIDED OR
 15676        PB-C-AH-CANCEL-VOIDED
 15677        GO TO 3780-UPDATE-CANCEL-CERT.
 15678
 15679     IF PB-COMPANY-ID EQUAL 'BOA'
 15680         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15681         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15682         GO TO 3730-GET-AH-REMAIN-TERM.
 15683
 15684     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15685        (WS-AH-SPECIAL-CALC-CD = 'M')
 15686         MOVE ER-2767            TO WS-ERROR
 15687         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15688         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15689         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15690         GO TO 3780-UPDATE-CANCEL-CERT.
 15691
 15692     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15693
 15694     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15695     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15696     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15697     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15698     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 15699     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15700     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 284
* EL050.cbl
 15701        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15702        IF PDEF-MASTER-FOUND
 15703           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15704              (V1 > +8)
 15705              OR (PD-PROD-CODE (V1) = 'L')
 15706           END-PERFORM
 15707           IF V1 < +9
 15708              MOVE PD-MAX-AMT (V1)
 15709                           TO CP-R-MAX-TOT-BEN
 15710                              EC-AM-LF-MAX-TOT-BEN
 15711           END-IF
 15712        ELSE
 15713        MOVE ' '                 TO PDEF-MASTER-SW
 15714        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15715        MOVE PB-STATE            TO ERPDEF-STATE
 15716        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15717        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15718        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15719        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15720        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15721        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15722        IF PDEF-MASTER-FOUND
 15723           MOVE 'N'              TO PDEF-MASTER-SW
 15724           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15725           IF PDEF-MASTER-FOUND
 15726              IF (ERPDEF-KEY-SAVE (1:16) =
 15727                           PD-CONTROL-PRIMARY (1:16))
 15728                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15729                 CONTINUE
 15730              ELSE
 15731                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15732                 IF (ERPDEF-KEY-SAVE (1:16) =
 15733                           PD-CONTROL-PRIMARY (1:16))
 15734                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15735                    CONTINUE
 15736                 ELSE
 15737                    MOVE 'N'     TO PDEF-MASTER-SW
 15738                 END-IF
 15739              END-IF
 15740              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15741
 15742              IF PDEF-MASTER-FOUND
 15743                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15744                    (V1 > +8)
 15745                    OR (PD-PROD-CODE (V1) = 'L')
 15746                 END-PERFORM
 15747                 IF V1 < +9
 15748                    MOVE PD-MAX-AMT (V1)
 15749                                 TO CP-R-MAX-TOT-BEN
 15750                                    EC-AM-LF-MAX-TOT-BEN
 15751                 END-IF
 15752              END-IF
 15753           END-IF
 15754           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15755        END-IF
 15756        END-IF
 15757     END-IF
 15758     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 285
* EL050.cbl
 15759
 15760     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15761
 15762     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15763                                    PB-C-LF-REM-TERM.
 15764
 15765     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15766     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15767
 15768     IF PB-COMPANY-ID EQUAL 'FLC'
 15769        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15770           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15771           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15772                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15773                    - CM-LF-ITD-DEATH-AMT
 15774           IF PB-C-LF-REF-CALC LESS THAN +0
 15775              MOVE +0            TO PB-C-LF-REF-CALC
 15776              GO TO 3730-GET-AH-REMAIN-TERM
 15777           ELSE
 15778              GO TO 3730-GET-AH-REMAIN-TERM.
 15779
 15780     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15781                            OR '4' OR '5' OR '6' OR '8'
 15782                            OR '9' OR 'G'
 15783        MOVE PB-C-LF-REFUND-OVERRIDE
 15784                                 TO CP-EARNING-METHOD.
 15785
 15786     if pb-company-id = 'AHL'
 15787        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 15788        if cp-class-code = spaces
 15789           move zeros            to cp-class-code
 15790        end-if
 15791     ELSE
 15792        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15793     END-IF
 15794*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15795     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15796     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15797                                    CP-RATING-BENEFIT-AMT.
 15798     IF CP-STATE-STD-ABBRV = 'OR'
 15799         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15800                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15801     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15802     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15803     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15804     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15805     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15806     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15807     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15808     IF WS-DEFAULT-APR NOT NUMERIC
 15809         MOVE ZEROS TO WS-DEFAULT-APR.
 15810****   N O T E   ****
 15811*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15812*      THE OH HARD CODING IN ELCRFNDP
 15813
 15814     IF PB-COMPANY-ID = 'CID'
 15815        IF CP-STATE-STD-ABBRV = 'OH'
 15816           MOVE WS-LF-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 286
* EL050.cbl
 15817                                 TO CP-EARNING-METHOD
 15818        END-IF
 15819     END-IF
 15820
 15821****   N O T E   ****
 15822
 15823     IF CP-EARN-AS-NET-PAY
 15824         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15825            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15826                MOVE WS-DEFAULT-APR
 15827                                 TO  CP-LOAN-APR
 15828                MOVE ER-3780     TO  WS-ERROR
 15829                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15830            ELSE
 15831                MOVE ER-3781     TO  WS-ERROR
 15832                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15833     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15834     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15835
 15836     IF CP-REFUND-TYPE-USED NOT = SPACE
 15837         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15838
 15839     IF CP-ERROR-RATE-IS-ZERO OR
 15840        CP-ERROR-RATE-NOT-FOUND
 15841        MOVE ER-2740             TO WS-ERROR
 15842        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15843
 15844     IF CP-ERROR-RATE-FILE-NOTOPEN
 15845        MOVE ER-2617             TO WS-ERROR
 15846        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15847
 15848     IF PB-COMPANY-ID = 'DCC'
 15849        AND PB-CI-ENTRY-STATUS = 'M'
 15850        MOVE +0                  TO PB-C-LF-REF-CALC
 15851     ELSE
 15852        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15853     END-IF
 15854
 15855     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15856         GO TO 3730-GET-AH-REMAIN-TERM.
 15857
 15858*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15859*       ADD +1                   TO PB-C-LF-REM-TERM
 15860*                                   CP-REMAINING-TERM
 15861*                                   CP-ORIGINAL-TERM.
 15862
 15863     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15864     MOVE '2'                    TO CP-EARNING-METHOD
 15865                                    CP-RATING-METHOD.
 15866     IF PB-COMPANY-ID = 'CID'
 15867        IF (CP-STATE-STD-ABBRV = 'MN')
 15868           AND (PB-CERT-EFF-DT > X'A4FF')
 15869           AND (WS-LF-EARNINGS-CALC = 'B')
 15870           MOVE '5'              TO CP-EARNING-METHOD
 15871           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15872        END-IF
 15873     END-IF
 15874     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 287
* EL050.cbl
 15875                                        CP-REMAINING-BENEFIT
 15876                                        CP-RATING-BENEFIT-AMT.
 15877     IF CP-STATE-STD-ABBRV = 'OR'
 15878         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15879                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15880     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15881     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15882
 15883     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15884
 15885     IF CP-ERROR-RATE-IS-ZERO OR
 15886        CP-ERROR-RATE-NOT-FOUND
 15887        MOVE ER-2740             TO WS-ERROR
 15888        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15889
 15890     IF CP-ERROR-RATE-FILE-NOTOPEN
 15891        MOVE ER-2617             TO WS-ERROR
 15892        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15893
 15894     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 15895
 15896******************************************************************
 15897
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 288
* EL050.cbl
 15899 3730-GET-AH-REMAIN-TERM.
 15900     IF NO-AH-BENEFIT-MATCH  OR
 15901        WS-AH-BENEFIT-CD = ZEROS
 15902         GO TO 3770-CHECK-REFUNDS.
 15903
 15904     IF PB-CI-AH-LUMP-SUM-DISAB
 15905         IF  PB-C-AH-CANCEL-AMT = ZERO
 15906            IF NOT PB-COMP-AH-CANCEL
 15907             GO TO 3770-CHECK-REFUNDS.
 15908
 15909     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15910     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15911     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15912     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 15913     MOVE PB-SV-STATE            TO CP-STATE.
 15914     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15915     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15916     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15917     MOVE '2'                    TO CP-PROCESS-TYPE.
 15918     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15919     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15920     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15921     IF (PB-COMPANY-ID = 'CID')
 15922        AND (CP-STATE-STD-ABBRV = 'WI')
 15923        MOVE '7'                 TO CP-REM-TERM-METHOD
 15924        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15925     ELSE
 15926        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15927        MOVE WS-REM-TRM-CALC-OPTION
 15928                                 TO CP-REM-TRM-CALC-OPTION
 15929     END-IF
 15930     IF (PB-COMPANY-ID = 'CID')
 15931        AND (CP-STATE-STD-ABBRV = 'MO')
 15932        AND (PB-CERT-EFF-DT >= X'9B41')
 15933        AND (PB-CERT-EFF-DT <= X'A2FB')
 15934        MOVE '7'                 TO CP-REM-TERM-METHOD
 15935        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15936     END-IF
 15937     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 15938                                    CP-LOAN-TERM.
 15939     IF NOT CP-TERM-IS-DAYS
 15940         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15941
 15942     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 15943
 15944     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15945
 15946     IF AH-COVERAGE-CANCELLED
 15947        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 15948        NEXT SENTENCE
 15949      ELSE
 15950         GO TO 3770-CHECK-REFUNDS.
 15951
 15952 3740-GET-AH-REFUND.
 15953
 15954     IF PB-C-LF-CANCEL-VOIDED OR
 15955        PB-C-AH-CANCEL-VOIDED
 15956        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 289
* EL050.cbl
 15957
 15958     IF PB-COMPANY-ID = 'BOA'
 15959         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15960         GO TO 3770-CHECK-REFUNDS.
 15961
 15962     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15963*    MOVE ' '                    TO DC-OPTION-CODE
 15964     SET BIN-TO-GREG             TO TRUE
 15965     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 15966     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15967                                    PB-C-AH-REM-TERM.
 15968     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 15969     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 15970
 15971     IF PB-COMPANY-ID EQUAL 'FLC'
 15972        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 15973           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 15974           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 15975                    - CM-AH-ITD-AH-PMT)
 15976           IF PB-C-AH-REF-CALC LESS THAN +0
 15977              MOVE +0            TO PB-C-AH-REF-CALC
 15978              GO TO 3770-CHECK-REFUNDS
 15979           ELSE
 15980              GO TO 3770-CHECK-REFUNDS.
 15981
 15982     IF PB-COMPANY-ID = 'DCC'
 15983        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15984            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 15985           MOVE 'S'              TO CP-EARNING-METHOD
 15986        END-IF
 15987     END-IF
 15988     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15989                            OR '4' OR '5' OR '6' OR '8'
 15990                            OR '9' OR 'G' OR 'S'
 15991        MOVE PB-C-AH-REFUND-OVERRIDE
 15992                                 TO CP-EARNING-METHOD.
 15993
 15994     if pb-company-id = 'AHL'
 15995        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 15996        if cp-class-code = spaces
 15997           move zeros            to cp-class-code
 15998        end-if
 15999     ELSE
 16000        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16001     END-IF
 16002*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16003     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16004     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16005                                    CP-RATING-BENEFIT-AMT.
 16006     IF CP-STATE-STD-ABBRV = 'OR'
 16007         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16008                                         PB-CI-AH-TERM.
 16009     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16010     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16011     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16012     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16013     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16014     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 290
* EL050.cbl
 16015
 16016     IF CP-STATE-STD-ABBRV = 'OH'
 16017        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16018                                AND 'CID' AND 'DCC' AND 'AHL')
 16019           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16020              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16021              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16022              MOVE '6' TO CP-EARNING-METHOD
 16023           END-IF
 16024        END-IF
 16025        IF PB-COMPANY-ID = 'CID'
 16026           IF NO-LIFE-COVERAGE
 16027              IF CP-CRITICAL-PERIOD
 16028                 MOVE '2'       TO CP-EARNING-METHOD
 16029              ELSE
 16030                 MOVE '6'       TO CP-EARNING-METHOD
 16031              END-IF
 16032           ELSE
 16033              IF WS-LF-COVERAGE-TYPE = 'L'
 16034                 MOVE '2'       TO CP-EARNING-METHOD
 16035              ELSE
 16036                 IF (PB-CI-LF-TERM > +60) OR
 16037                    (WS-LF-EARNINGS-CALC = '5')
 16038                    IF CP-CRITICAL-PERIOD
 16039                       MOVE '2'  TO CP-EARNING-METHOD
 16040                    ELSE
 16041                       MOVE '6'  TO CP-EARNING-METHOD
 16042                    END-IF
 16043                 ELSE
 16044                    MOVE '1'     TO CP-EARNING-METHOD
 16045                 END-IF
 16046              END-IF
 16047           END-IF
 16048        END-IF
 16049     END-IF
 16050
 16051*    IF CP-STATE-STD-ABBRV = 'VA'
 16052*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16053*          IF CP-ORIGINAL-TERM GREATER 61
 16054*             MOVE '6' TO CP-EARNING-METHOD
 16055*          ELSE
 16056*             MOVE '1' TO CP-EARNING-METHOD.
 16057
 16058     IF WS-DEFAULT-APR NOT NUMERIC
 16059         MOVE ZEROS TO WS-DEFAULT-APR.
 16060     IF CP-EARN-AS-NET-PAY
 16061         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16062            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16063                MOVE WS-DEFAULT-APR
 16064                                 TO  CP-LOAN-APR
 16065                MOVE ER-3780     TO  WS-ERROR
 16066                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16067            ELSE
 16068                MOVE ER-3781     TO  WS-ERROR
 16069                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16070     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16071     IF PB-COMPANY-ID = 'DCC'
 16072        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 291
* EL050.cbl
 16073        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16074        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16075     END-IF
 16076     IF PB-COMPANY-ID = 'DCC'
 16077        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16078        AND (CP-EARNING-METHOD = 'D')
 16079        AND (CP-CANCEL-REASON NOT = 'R')
 16080        CONTINUE
 16081     ELSE
 16082        GO TO 3750-CONTINUE
 16083     END-IF
 16084     MOVE ' '                    TO DD-IU-SW
 16085     IF NOT PDEF-MASTER-FOUND
 16086        MOVE ' '                 TO PDEF-MASTER-SW
 16087        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16088        MOVE PB-STATE            TO ERPDEF-STATE
 16089        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16090        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16091        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16092        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16093        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16094        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16095        IF PDEF-MASTER-FOUND
 16096           MOVE 'N'              TO PDEF-MASTER-SW
 16097           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16098           IF PDEF-MASTER-FOUND
 16099              IF (ERPDEF-KEY-SAVE (1:16) =
 16100                           PD-CONTROL-PRIMARY (1:16))
 16101                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16102                 CONTINUE
 16103              ELSE
 16104                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16105                 IF (ERPDEF-KEY-SAVE (1:16) =
 16106                           PD-CONTROL-PRIMARY (1:16))
 16107                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16108                    CONTINUE
 16109                 ELSE
 16110                    MOVE ER-2740 TO WS-ERROR
 16111                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16112                    GO TO 3770-CHECK-REFUNDS
 16113                 END-IF
 16114              END-IF
 16115           END-IF
 16116           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16117        END-IF
 16118     END-IF
 16119     IF PDEF-MASTER-FOUND
 16120        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16121           (V1 > +8)
 16122           OR (PD-PROD-CODE (V1) = 'I')
 16123        END-PERFORM
 16124        IF V1 < +9
 16125           SET DD-IU-PRESENT        TO TRUE
 16126        END-IF
 16127        IF WS-AH-DCC-TRUNC = 'T'
 16128           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16129        ELSE
 16130           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 292
* EL050.cbl
 16131        END-IF
 16132        EVALUATE TRUE
 16133           WHEN WS-TERM > +168
 16134              MOVE 15               TO V1
 16135           WHEN WS-TERM > +156
 16136              MOVE 14               TO V1
 16137           WHEN WS-TERM > +144
 16138              MOVE 13               TO V1
 16139           WHEN WS-TERM > +132
 16140              MOVE 12               TO V1
 16141           WHEN WS-TERM > +120
 16142              MOVE 11               TO V1
 16143           WHEN WS-TERM > +108
 16144              MOVE 10               TO V1
 16145           WHEN WS-TERM > +96
 16146              MOVE 9                TO V1
 16147           WHEN WS-TERM > +84
 16148              MOVE 8                TO V1
 16149           WHEN WS-TERM > +72
 16150              MOVE 7                TO V1
 16151           WHEN WS-TERM > +60
 16152              MOVE 6                TO V1
 16153           WHEN WS-TERM > +48
 16154              MOVE 5                TO V1
 16155           WHEN WS-TERM > +36
 16156              MOVE 4                TO V1
 16157           WHEN WS-TERM > +24
 16158              MOVE 3                TO V1
 16159           WHEN WS-TERM > +12
 16160              MOVE 2                TO V1
 16161           WHEN OTHER
 16162              MOVE 1                TO V1
 16163        END-EVALUATE
 16164
 16165        EVALUATE TRUE
 16166*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16167*             < +13)
 16168*             AND (DD-IU-PRESENT)
 16169*             MOVE 2                TO V2
 16170*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16171*             MOVE 1                TO V2
 16172           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16173              MOVE 2                TO V2
 16174           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16175              MOVE 3                TO V2
 16176           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16177              MOVE 4                TO V2
 16178           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16179              MOVE 5                TO V2
 16180           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16181              MOVE 6                TO V2
 16182           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16183              MOVE 7                TO V2
 16184           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16185              MOVE 8                TO V2
 16186           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16187              MOVE 9                TO V2
 16188           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 293
* EL050.cbl
 16189              MOVE 10               TO V2
 16190           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16191              MOVE 11               TO V2
 16192           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16193              MOVE 12               TO V2
 16194           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16195              MOVE 13               TO V2
 16196           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16197              MOVE 14               TO V2
 16198           WHEN OTHER
 16199              MOVE 15               TO V2
 16200        END-EVALUATE
 16201
 16202        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16203                                 TO CP-DDF-LO-FACT
 16204        MOVE PD-UEP-FACTOR (V1 V2)
 16205                                 TO CP-DDF-HI-FACT
 16206
 16207        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16208        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16209        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16210           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16211        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16212        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16213        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16214           + PD-1ST-YR-ADMIN-ALLOW
 16215
 16216        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16217*       IF PI-CLP-YN = 'Y'
 16218*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16219*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16220*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16221*       END-IF
 16222
 16223        IF DD-IU-PRESENT
 16224           MOVE 'I'              TO CP-EARNING-METHOD
 16225        END-IF
 16226        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16227                                     CP-CLP-RATE-UP
 16228        IF CP-IU-RATE-UP NOT = ZEROS
 16229           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16230              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16231           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16232              / (1 - WS-WORK-FACT)
 16233        END-IF
 16234     END-IF
 16235     .
 16236 3750-CONTINUE.
 16237     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16238
 16239     IF CP-REFUND-TYPE-USED NOT = SPACE
 16240         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16241
 16242     IF CP-ERROR-RATE-IS-ZERO OR
 16243        CP-ERROR-RATE-NOT-FOUND
 16244        MOVE ER-2740             TO WS-ERROR
 16245        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16246
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 294
* EL050.cbl
 16247     IF CP-ERROR-RATE-FILE-NOTOPEN
 16248        MOVE ER-2617             TO WS-ERROR
 16249        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16250     IF PB-COMPANY-ID = 'DCC'
 16251        AND PB-CI-ENTRY-STATUS = 'M'
 16252        MOVE +0                  TO PB-C-AH-REF-CALC
 16253     ELSE
 16254        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16255     END-IF
 16256     IF PB-COMPANY-ID = 'DCC'
 16257        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16258        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16259        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16260        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16261        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16262        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16263        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16264        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16265        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16266     END-IF
 16267     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 295
* EL050.cbl
 16269
 16270 3770-CHECK-REFUNDS.
 16271
 16272     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16273        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16274           MOVE ER-2766          TO WS-ERROR
 16275           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16276           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16277           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16278              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16279
 16280     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16281        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16282           MOVE ER-2766          TO WS-ERROR
 16283           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16284           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16285           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16286              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16287
 16288     IF PB-COMP-LF-CANCEL
 16289        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16290        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16291           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16292              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16293
 16294     IF PB-COMP-AH-CANCEL
 16295        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16296        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16297           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16298              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16299
 16300     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16301             GIVING WS-UNSIGN-WRK1
 16302     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16303             GIVING WS-UNSIGN-WRK2.
 16304
 16305     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16306         MOVE ZERO TO WS-UNSIGN-WRK1.
 16307
 16308     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16309         MOVE ZERO TO WS-UNSIGN-WRK2.
 16310
 16311     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16312
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 296
* EL050.cbl
 16314
 16315 3772-CONTINUE.
 16316
 16317**********************************
 16318*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16319*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16320*** DOUBLES THE TOLERANCE AMOUNT.
 16321***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16322**********************************
 16323     IF PB-COMPANY-ID = 'MON'
 16324     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16325         IF WS-REF-REJECT-SW = SPACE
 16326             MOVE ER-2754        TO WS-ERROR
 16327             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16328           ELSE
 16329             MOVE ER-2736        TO WS-ERROR
 16330             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16331**********************************
 16332
 16333 3773-CONTINUE.
 16334
 16335     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16336        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16337           MOVE ER-2723          TO WS-ERROR
 16338           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16339
 16340     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16341        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16342           MOVE ER-2724          TO WS-ERROR
 16343           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16344
 16345     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16346         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16347             (1 + WS-LF-REFUND-OVS-PCT)
 16348     ELSE
 16349         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16350
 16351     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16352         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16353             (1 - WS-TOL-LF-REFUND-PCT)
 16354     ELSE
 16355         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16356
 16357     IF (PB-COMPANY-ID = 'DCC')
 16358        AND (PB-CI-ENTRY-STATUS = 'M')
 16359        AND (PB-C-LF-CANCEL-AMT > +0)
 16360        MOVE ER-3843             TO WS-ERROR
 16361        PERFORM 9900-ERROR-FORMAT
 16362                                 THRU 9900-EXIT
 16363     END-IF
 16364     EVALUATE TRUE
 16365        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16366           CONTINUE
 16367        WHEN PB-C-LF-CANCEL-AMT = +0
 16368                 AND PB-C-LF-REF-CALC > +0
 16369           CONTINUE
 16370        WHEN WS-LF-REFUND-OVS-AMT = 0
 16371                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 297
* EL050.cbl
 16372           CONTINUE
 16373        WHEN OTHER
 16374           IF WS-TOL-LF-REFUND  = +0
 16375              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16376           END-IF
 16377           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16378                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16379                          (PB-C-LF-CANCEL-AMT))
 16380              CONTINUE
 16381           ELSE
 16382              IF WS-LF-REFUND-OVS-AMT = +0
 16383                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16384              END-IF
 16385              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16386                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16387                                       PB-C-LF-CANCEL-AMT)
 16388                 CONTINUE
 16389              ELSE
 16390                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16391                   MOVE ER-2754   TO  WS-ERROR
 16392                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16393                 ELSE
 16394                    MOVE ER-2736   TO  WS-ERROR
 16395                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16396                 END-IF
 16397              END-IF
 16398           END-IF
 16399     END-EVALUATE.
 16400
 16401     EVALUATE TRUE
 16402        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16403           CONTINUE
 16404        WHEN PB-C-LF-CANCEL-AMT = +0
 16405                 AND PB-C-LF-REF-CALC > +0
 16406           CONTINUE
 16407        WHEN OTHER
 16408           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16409               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16410              CONTINUE
 16411           ELSE
 16412              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16413               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16414                CONTINUE
 16415              ELSE
 16416                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16417                     MOVE ER-2754   TO  WS-ERROR
 16418                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16419                 ELSE
 16420                     MOVE ER-2736   TO  WS-ERROR
 16421                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16422                 END-IF
 16423              END-IF
 16424           END-IF
 16425     END-EVALUATE.
 16426
 16427     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16428         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16429             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 298
* EL050.cbl
 16430     ELSE
 16431         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16432
 16433     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16434         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16435             (1 - WS-TOL-AH-REFUND-PCT)
 16436     ELSE
 16437         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16438
 16439     IF (PB-COMPANY-ID = 'DCC')
 16440        AND (PB-CI-ENTRY-STATUS = 'M')
 16441        AND (PB-C-AH-CANCEL-AMT > +0)
 16442        MOVE ER-3843             TO WS-ERROR
 16443        PERFORM 9900-ERROR-FORMAT
 16444                                 THRU 9900-EXIT
 16445     END-IF
 16446     EVALUATE TRUE
 16447        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16448           CONTINUE
 16449*       WHEN PB-C-AH-REF-CALC = +0 AND
 16450*                  PB-C-AH-CANCEL-AMT > +0
 16451        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16452                   PB-C-AH-REF-CALC > +0
 16453           CONTINUE
 16454        WHEN WS-AH-REFUND-OVS-AMT = +0
 16455                AND WS-TOL-AH-REFUND = +0
 16456           CONTINUE
 16457        WHEN OTHER
 16458           IF WS-TOL-AH-REFUND = +0
 16459              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16460           END-IF
 16461           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16462               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16463                                         PB-C-AH-CANCEL-AMT)
 16464              CONTINUE
 16465           ELSE
 16466              IF WS-AH-REFUND-OVS-AMT = +0
 16467                 MOVE +9999999.99 TO
 16468                         WS-AH-REFUND-OVS-AMT
 16469              END-IF
 16470              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16471                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16472                                         PB-C-AH-CANCEL-AMT)
 16473                 CONTINUE
 16474              ELSE
 16475                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16476                    MOVE ER-2754   TO  WS-ERROR
 16477                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16478                 ELSE
 16479                    MOVE ER-2736   TO  WS-ERROR
 16480                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16481                 END-IF
 16482              END-IF
 16483           END-IF
 16484     END-EVALUATE.
 16485
 16486     EVALUATE TRUE
 16487        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 299
* EL050.cbl
 16488           CONTINUE
 16489*       WHEN PB-C-AH-REF-CALC > +0 AND
 16490*                  PB-C-AH-CANCEL-AMT = +0
 16491        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16492                   PB-C-AH-REF-CALC = +0
 16493           CONTINUE
 16494        WHEN OTHER
 16495           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16496               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16497              CONTINUE
 16498           ELSE
 16499              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16500                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16501                 CONTINUE
 16502              ELSE
 16503                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16504                     MOVE ER-2754   TO  WS-ERROR
 16505                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16506                 ELSE
 16507                     MOVE ER-2736   TO  WS-ERROR
 16508                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16509                 END-IF
 16510              END-IF
 16511           END-IF
 16512     END-EVALUATE.
 16513
 16514     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16515        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16516        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16517           AND  PB-C-LF-REF-CALC < +1.00
 16518           AND  PB-C-AH-REF-CALC < +1.00
 16519           CONTINUE
 16520        ELSE
 16521           IF (PB-COMPANY-ID = 'DCC')
 16522              AND (PB-CI-ENTRY-STATUS = 'M')
 16523              CONTINUE
 16524           ELSE
 16525              MOVE ER-2741       TO WS-ERROR
 16526              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16527           END-IF
 16528        END-IF
 16529     END-IF
 16530
 16531     IF (PB-C-LF-CANCEL-AMT = ZERO
 16532        AND WS-LF-BENEFIT-CD NOT = ZERO
 16533        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16534        AND PB-C-LF-REF-CALC NOT = ZERO)
 16535        OR
 16536        (PB-C-LF-CANCEL-AMT = ZERO
 16537        AND WS-LF-BENEFIT-CD NOT = ZERO
 16538        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16539             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16540                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16541                NEXT SENTENCE
 16542             ELSE
 16543                MOVE ER-2739        TO WS-ERROR
 16544                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16545
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 300
* EL050.cbl
 16546     IF (PB-C-AH-CANCEL-AMT = ZERO
 16547        AND WS-AH-BENEFIT-CD NOT = ZERO
 16548        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16549        AND PB-C-AH-REF-CALC NOT = ZERO)
 16550        OR
 16551        (PB-C-AH-CANCEL-AMT = ZERO
 16552        AND WS-AH-BENEFIT-CD NOT = ZERO
 16553        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16554             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16555                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16556                NEXT SENTENCE
 16557             ELSE
 16558                MOVE ER-2738        TO WS-ERROR
 16559                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16560
 16561 3775-OVER-REF-CHK.
 16562
 16563     IF PB-CI-ENTRY-STATUS = '5'
 16564        GO TO 3780-UPDATE-CANCEL-CERT.
 16565
 16566     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16567                              PB-CI-LF-ALT-PREMIUM-AMT.
 16568
 16569     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16570        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16571                                 PB-C-LF-REF-CALC
 16572      ELSE
 16573        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16574                                 PB-C-LF-CANCEL-AMT.
 16575
 16576     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16577        MOVE ER-2755             TO WS-ERROR
 16578        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16579
 16580     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16581
 16582     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16583        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16584                                 PB-C-AH-REF-CALC
 16585      ELSE
 16586        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16587                                 PB-C-AH-CANCEL-AMT.
 16588
 16589     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16590        MOVE ER-2778             TO WS-ERROR
 16591        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16592
 16593     IF PB-CI-OB-FLAG NOT = 'Z'
 16594        NEXT SENTENCE
 16595       ELSE
 16596         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16597            MOVE ER-2757           TO WS-ERROR
 16598            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16599
 16600 3780-UPDATE-CANCEL-CERT.
 16601
 16602     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16603        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 301
* EL050.cbl
 16604        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16605
 16606     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16607         MOVE ER-2729              TO WS-ERROR
 16608         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16609
 16610     IF PB-CI-LF-BENEFIT-CD = ZERO
 16611         GO TO 3780-UPDATE-CONT-1.
 16612
 16613     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16614         GO TO 3780-UPDATE-CONT-1.
 16615
 16616     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16617       AND
 16618        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16619       AND
 16620        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16621       AND
 16622        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16623            NEXT SENTENCE
 16624       ELSE
 16625        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16626          AND
 16627***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16628***       AND
 16629           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16630            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16631               MOVE ER-2730      TO WS-ERROR
 16632               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16633               GO TO 3999-END-EDIT
 16634            ELSE
 16635               GO TO 3999-END-EDIT
 16636        ELSE
 16637            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16638               MOVE ER-2765           TO WS-ERROR
 16639               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16640               GO TO 3785-CHECK-NH.
 16641*              GO TO 3999-END-EDIT.
 16642
 16643 3780-UPDATE-CONT-1.
 16644     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16645
 16646     IF PB-CI-AH-BENEFIT-CD = ZERO
 16647         GO TO 3780-UPDATE-CONT-2.
 16648
 16649     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16650         GO TO 3780-UPDATE-CONT-2.
 16651
 16652     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16653
 16654     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16655       AND
 16656        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16657       AND
 16658        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16659       AND
 16660        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16661            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 302
* EL050.cbl
 16662       ELSE
 16663        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16664          AND
 16665***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16666***       AND
 16667           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16668           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16669            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16670               MOVE ER-2773      TO WS-ERROR
 16671               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16672               GO TO 3999-END-EDIT
 16673            ELSE
 16674               GO TO 3999-END-EDIT
 16675            END-IF
 16676           ELSE
 16677             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16678                MOVE ER-2890 TO WS-ERROR
 16679                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16680                GO TO 3999-END-EDIT
 16681             ELSE
 16682                GO TO 3785-CHECK-NH
 16683             END-IF
 16684           END-IF
 16685          ELSE
 16686            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16687              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16688                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16689                   MOVE ER-2890 TO WS-ERROR
 16690                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16691                   GO TO 3999-END-EDIT
 16692                ELSE
 16693                   MOVE ER-2765 TO WS-ERROR
 16694                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16695                   GO TO 3785-CHECK-NH
 16696                END-IF
 16697              ELSE
 16698               MOVE ER-2765      TO WS-ERROR
 16699               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16700               GO TO 3785-CHECK-NH.
 16701*              GO TO 3999-END-EDIT.
 16702
 16703 3780-UPDATE-CONT-2.
 16704
 16705     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16706        AND WS-LF-BENEFIT-CD = ZERO
 16707           MOVE ER-2743           TO WS-ERROR
 16708           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16709
 16710     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16711        AND WS-AH-BENEFIT-CD = ZERO
 16712           MOVE ER-2744           TO WS-ERROR
 16713           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16714
 16715     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16716        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16717        AND
 16718        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16719         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 303
* EL050.cbl
 16720           MOVE ER-2746           TO WS-ERROR
 16721           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16722
 16723     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16724       AND
 16725        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16726             MOVE ER-2737        TO WS-ERROR
 16727             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16728
 16729     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16730       AND
 16731        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16732             MOVE ER-2737        TO WS-ERROR
 16733             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16734
 16735     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16736         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16737             OR 'CID' OR 'DCC' OR 'AHL'
 16738             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16739         ELSE
 16740             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16741                 MOVE ER-2768    TO WS-ERROR
 16742                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16743             ELSE
 16744                 MOVE ER-2756    TO WS-ERROR
 16745                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16746
 16747     IF CERT-PEND-ISSUE-RETURNED
 16748        MOVE ER-2772             TO WS-ERROR
 16749        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16750 3785-CHECK-NH.
 16751     IF PB-STATE NOT = 'NH'
 16752        GO TO 3999-END-EDIT
 16753     END-IF
 16754
 16755     MOVE ER-2796                TO WS-ERROR
 16756     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16757     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16758        OR (CM-NH-INTERFACE-SW = 'Y')
 16759        MOVE ER-2793             TO WS-ERROR
 16760        PERFORM 9900-ERROR-FORMAT
 16761                                 THRU 9900-EXIT
 16762     END-IF
 16763     MOVE +0                     TO WS-PAYMENT-AMT
 16764     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16765        GO TO 3999-END-EDIT
 16766     END-IF
 16767     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16768        GO TO 3999-END-EDIT
 16769     END-IF
 16770     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16771     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16772     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16773        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16774     END-IF
 16775     MOVE '1'                    TO DC-OPTION-CODE
 16776     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16777     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 304
* EL050.cbl
 16778        IF DC-ELAPSED-DAYS < +16
 16779           GO TO 3999-END-EDIT
 16780        END-IF
 16781     END-IF
 16782     MOVE +0                     TO DC-ELAPSED-DAYS
 16783     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16784     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16785     MOVE '1'                    TO DC-OPTION-CODE
 16786     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16787     IF NO-CONVERSION-ERROR
 16788        IF DC-ELAPSED-DAYS > +30
 16789           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16790        ELSE
 16791           GO TO 3999-END-EDIT
 16792        END-IF
 16793     ELSE
 16794        GO TO 3999-END-EDIT
 16795     END-IF
 16796     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16797        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16798           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16799     IF WS-PAYMENT-AMT < 600.00
 16800        GO TO 3999-END-EDIT
 16801     END-IF
 16802     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16803
 16804     IF (ERMAIL-FOUND = ' ')
 16805         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16806         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16807        GO TO 3999-END-EDIT
 16808     END-IF
 16809     MOVE ER-2795                TO WS-ERROR
 16810     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16811
 16812     GO TO 3999-END-EDIT.
 16813******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 305
* EL050.cbl
 16815 3990-FILES-NOT-OPEN.
 16816
 16817     MOVE ER-2617                TO WS-ERROR.
 16818     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16819     GO TO 9990-RETURN.
 16820
 16821 3999-END-EDIT.
 16822
 16823     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16824
 16825     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16826         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16827         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16828             PERFORM 9250-UNLOCK-RETURN
 16829             GO TO 9990-RETURN
 16830          ELSE
 16831             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16832             GO TO 9990-RETURN.
 16833
 16834     IF PB-CANCELLATION
 16835          GO TO 9990-RETURN.
 16836
 16837     IF CERT-WAS-NOT-FOUND
 16838        MOVE SPACES              TO CERTIFICATE-MASTER.
 16839
 16840     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16841
 16842     IF CERT-WAS-FOUND
 16843         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16844             PERFORM 9250-UNLOCK-RETURN
 16845          ELSE
 16846            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16847      ELSE
 16848         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16849
 16850     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16851        IF PB-COMPANY-ID = 'DCC' AND
 16852           (PB-CARRIER = '2' OR '4' OR '6')
 16853              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16854        END-IF
 16855     END-IF.
 16856
 16857     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 16858         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 16859     END-IF.
 16860
 16861     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16862     IF ((PB-COMPANY-ID = 'DCC')
 16863        AND (WS-NO-SECURE-PAY))
 16864                  OR
 16865        (WS-LF-SPECIAL-CALC-CD = 'O'
 16866        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16867        SET SKIP-ADDR-EDIT       TO TRUE
 16868     END-IF
 16869     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16870        AND (NOT SKIP-ADDR-EDIT)
 16871        MOVE ER-2963             TO WS-ERROR
 16872        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 306
* EL050.cbl
 16873                                 THRU 9900-EXIT
 16874        GO TO 9990-RETURN
 16875     END-IF
 16876     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 16877     IF ERPNDM-FOUND NOT = 'X'
 16878        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16879           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 16880           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 16881           AND (NOT SKIP-ADDR-EDIT)
 16882           MOVE ER-2694          TO WS-ERROR
 16883           PERFORM 9900-ERROR-FORMAT
 16884                                 THRU 9900-EXIT
 16885        END-IF
 16886        MOVE ' '                 TO STATE-RECORD-ERROR
 16887        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16888        MOVE PM-STATE            TO CNTL-ACCESS
 16889        MOVE '3'                 TO CNTL-REC-TYPE
 16890        MOVE +0                  TO CNTL-SEQ-NO
 16891        MOVE '0'                 TO RC-SW-2
 16892        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16893        IF (NO-STATE-RECORD)
 16894           OR (CF-RECORD-TYPE NOT = '3')
 16895           OR (PM-STATE NOT = CF-STATE-CODE)
 16896           IF (PM-STATE = SPACES)
 16897              AND (SKIP-ADDR-EDIT)
 16898              CONTINUE
 16899           ELSE
 16900              MOVE ER-2963       TO WS-ERROR
 16901              PERFORM 9900-ERROR-FORMAT
 16902                                 THRU 9900-EXIT
 16903           END-IF
 16904        END-IF
 16905        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 16906           MOVE ER-2883          TO WS-ERROR
 16907           PERFORM 9900-ERROR-FORMAT
 16908                                 THRU 9900-EXIT
 16909        END-IF
 16910        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 16911           MOVE ' '                 TO STATE-RECORD-ERROR
 16912           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16913           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 16914           MOVE '3'                 TO CNTL-REC-TYPE
 16915           MOVE +0                  TO CNTL-SEQ-NO
 16916           MOVE '0'                 TO RC-SW-2
 16917           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16918           IF NO-STATE-RECORD
 16919              OR (CF-RECORD-TYPE NOT = '3')
 16920              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 16921              MOVE ER-2964          TO WS-ERROR
 16922              PERFORM 9900-ERROR-FORMAT
 16923                                    THRU 9900-EXIT
 16924           END-IF
 16925        END-IF
 16926     ELSE
 16927        IF NOT SKIP-ADDR-EDIT
 16928           MOVE ER-2393          TO WS-ERROR
 16929           PERFORM 9900-ERROR-FORMAT
 16930                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 307
* EL050.cbl
 16931        END-IF
 16932     END-IF
 16933
 16934     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16935
 16936     IF (ERMAIL-FOUND = ' ' AND
 16937        ERPNDM-FOUND = ' ')
 16938        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 16939           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 16940           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 16941          OR
 16942           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 16943          OR
 16944           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 16945           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 16946           GO TO 3999-UNLOCK-ERMAIL.
 16947
 16948     IF ERPNDM-FOUND = 'X'
 16949        GO TO 3999-UNLOCK-ERMAIL.
 16950
 16951     IF PM-INSURED-LAST-NAME      = SPACES
 16952        AND PM-INSURED-FIRST-NAME = SPACES
 16953        AND PM-ADDRESS-LINE-1     = SPACES
 16954        AND PM-ADDRESS-LINE-2     = SPACES
 16955        AND PM-CITY-STATE         = SPACES
 16956        AND PM-CRED-BENE-NAME     = SPACES
 16957        AND PM-CRED-BENE-ADDR     = SPACES
 16958        AND PM-CRED-BENE-CTYST    = SPACES
 16959        GO TO 3999-UNLOCK-ERMAIL
 16960     END-IF
 16961
 16962     MOVE SPACES                 TO MAILING-DATA.
 16963
 16964     MOVE 'MA'                   TO MA-RECORD-ID.
 16965     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 16966     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 16967     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 16968     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 16969     MOVE PB-SV-STATE            TO MA-STATE.
 16970     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 16971     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 16972
 16973     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 16974     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 16975
 16976     IF ERMAIL-FOUND = ' '
 16977        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 16978     ELSE
 16979        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 16980        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 16981        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 16982
 16983     GO TO 9990-RETURN.
 16984
 16985 3999-UNLOCK-ERMAIL.
 16986     IF ERMAIL-FOUND = ' '
 16987        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 16988
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 308
* EL050.cbl
 16989     GO TO 9990-RETURN.
 16990******************************************************************
 16991
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 309
* EL050.cbl
 16993 4000-UPDATE-CANCELLED-CERT.
 16994     IF CERT-WAS-NOT-FOUND
 16995        GO TO 4299-EXIT.
 16996
 16997*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 16998     IF PB-C-NH-INT-ON-REFS > ZEROS
 16999        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17000     END-IF
 17001     IF PB-C-REF-INTERFACE-SW = 'Y'
 17002        MOVE PB-C-REF-INTERFACE-SW
 17003                                 TO CM-NH-INTERFACE-SW
 17004     END-IF
 17005     IF PB-C-POST-CARD-IND = 'Y'
 17006        MOVE +8                  TO SUB
 17007        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17008        IF ERMAIL-FOUND = ' '
 17009           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17010              (SUB > +7)
 17011              OR (MA-MAIL-STATUS (SUB) = '1')
 17012           END-PERFORM
 17013        END-IF
 17014        IF (SUB > +7)
 17015           OR (ERMAIL-FOUND = 'X')
 17016           MOVE ER-3789          TO WS-ERROR
 17017           PERFORM 9900-ERROR-FORMAT
 17018                                 THRU 9900-EXIT
 17019        END-IF
 17020     ELSE
 17021        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17022     END-IF
 17023     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17024
 17025     IF PB-CI-OB-FLAG = 'Z'
 17026        GO TO 4150-SUMMARY-CERT-CANCEL.
 17027
 17028     IF PB-C-LF-CANCEL-VOIDED
 17029         PERFORM 4200-REVERSE-LF-CANCEL.
 17030     IF PB-C-AH-CANCEL-VOIDED
 17031         PERFORM 4200-REVERSE-AH-CANCEL.
 17032
 17033 4100-APPLY-LF-CANCEL.
 17034
 17035     MOVE +0                     TO WS-SUB.
 17036
 17037 4100-CHECK-LF-ERRORS.
 17038
 17039     ADD +1                       TO WS-SUB.
 17040
 17041     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17042        IF LF-COVERAGE-CANCELLED
 17043           GO TO 4100-LF-CANCEL-CONT
 17044        ELSE
 17045           GO TO 4100-UPDATE-LF-COVERAGE.
 17046
 17047     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17048                                   ER-2729 OR
 17049                                   ER-2730 OR
 17050                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 310
* EL050.cbl
 17051                                   ER-2732 OR
 17052                                   ER-2737 OR
 17053                                   ER-2740 OR
 17054                                   ER-2743 OR
 17055                                   ER-2749 OR
 17056                                   ER-2750 OR
 17057                                   ER-2755 OR
 17058                                   ER-2757 OR
 17059                                   ER-2760 OR
 17060                                   ER-2772 OR
 17061                                   ER-2774 OR
 17062                                   ER-2776 OR
 17063                                   ER-2794
 17064        GO TO 4100-UPDATE-LF-COVERAGE.
 17065
 17066     GO TO 4100-CHECK-LF-ERRORS.
 17067
 17068 4100-UPDATE-LF-COVERAGE.
 17069
 17070     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17071     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17072     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17073        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17074     END-IF
 17075     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17076                                      TO CM-CREDIT-INTERFACE-SW-2.
 17077     IF CM-LF-CANCEL-DT = LOW-VALUE
 17078         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17079
 17080     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17081         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17082                                         CM-LF-STATUS-AT-CANCEL.
 17083
 17084     GO TO 4100-APPLY-AH-CANCEL.
 17085
 17086 4100-LF-CANCEL-CONT.
 17087     IF PB-C-LF-CANCEL-VOIDED
 17088         GO TO 4100-APPLY-AH-CANCEL.
 17089
 17090     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17091         GO TO 4100-APPLY-AH-CANCEL.
 17092
 17093     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 17094        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17095           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17096        ELSE
 17097           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17098
 17099     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17100     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17101
 17102     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17103         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17104
 17105     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17106        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17107         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17108         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 311
* EL050.cbl
 17109
 17110     IF PB-RECORD-RETURNED
 17111        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17112      ELSE
 17113        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17114
 17115 4100-APPLY-AH-CANCEL.
 17116
 17117     MOVE +0                      TO WS-SUB.
 17118
 17119 4100-CHECK-AH-ERRORS.
 17120
 17121     ADD +1                       TO WS-SUB.
 17122
 17123     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17124        IF AH-COVERAGE-CANCELLED
 17125           GO TO 4100-AH-CANCEL-CONT
 17126        ELSE
 17127           GO TO 4100-UPDATE-AH-COVERAGE.
 17128
 17129     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17130                                   ER-2729 OR
 17131                                   ER-2732 OR
 17132                                   ER-2737 OR
 17133                                   ER-2740 OR
 17134                                   ER-2744 OR
 17135                                   ER-2749 OR
 17136                                   ER-2750 OR
 17137                                   ER-2755 OR
 17138                                   ER-2757 OR
 17139                                   ER-2760 OR
 17140                                   ER-2771 OR
 17141                                   ER-2772 OR
 17142                                   ER-2773 OR
 17143                                   ER-2775 OR
 17144                                   ER-2777 OR
 17145                                   ER-2794
 17146        GO TO 4100-UPDATE-AH-COVERAGE.
 17147
 17148     GO TO 4100-CHECK-AH-ERRORS.
 17149
 17150 4100-UPDATE-AH-COVERAGE.
 17151
 17152     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17153     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17154     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17155     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17156                                      TO CM-CREDIT-INTERFACE-SW-2.
 17157     IF CM-AH-CANCEL-DT = LOW-VALUE
 17158         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17159
 17160     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17161         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17162                                         CM-AH-STATUS-AT-CANCEL.
 17163
 17164     IF LF-COVERAGE-CANCELLED
 17165         IF PB-RECORD-RETURNED
 17166              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 312
* EL050.cbl
 17167          ELSE
 17168              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17169
 17170     GO TO 4299-EXIT.
 17171
 17172 4100-AH-CANCEL-CONT.
 17173     IF PB-C-AH-CANCEL-VOIDED
 17174         GO TO 4299-EXIT.
 17175
 17176     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17177         GO TO 4299-EXIT.
 17178
 17179     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17180        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17181           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17182        ELSE
 17183           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17184
 17185     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17186     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17187
 17188     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17189         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17190
 17191     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17192         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17193         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17194
 17195     IF PB-RECORD-RETURNED
 17196        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17197      ELSE
 17198        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17199
 17200     GO TO 4299-EXIT.
 17201
 17202 4150-SUMMARY-CERT-CANCEL.
 17203     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17204
 17205     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17206        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17207                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17208     ELSE
 17209        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17210                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17211
 17212     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17213        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17214                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17215     ELSE
 17216        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17217                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17218
 17219     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17220        NEXT SENTENCE
 17221     ELSE
 17222        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17223
 17224     GO TO 4299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 313
* EL050.cbl
 17225
 17226 4200-REVERSE-LF-CANCEL.
 17227     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17228
 17229     IF CM-LF-CANCEL-APPLIED
 17230        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17231        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17232        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17233
 17234     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17235
 17236     IF PB-RECORD-RETURNED
 17237        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17238       ELSE
 17239        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17240
 17241 4200-REVERSE-LF-EXIT.
 17242       EXIT.
 17243
 17244 4200-REVERSE-AH-CANCEL.
 17245     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17246
 17247     IF CM-AH-CANCEL-APPLIED
 17248        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17249        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17250        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17251
 17252     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17253
 17254     IF PB-RECORD-RETURNED
 17255        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17256       ELSE
 17257        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17258
 17259 4200-REVERSE-AH-EXIT.
 17260       EXIT.
 17261
 17262 4299-EXIT.
 17263       EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 314
* EL050.cbl
 17265
 17266 4500-UPDATE-NEW-CERT.
 17267     IF CERT-WAS-FOUND
 17268         NEXT SENTENCE
 17269       ELSE
 17270         GO TO 4520-BUILD-NEW-KEY.
 17271
 17272     IF  CLASIC-CREATED-CERT
 17273         GO TO 4999-EXIT.
 17274
 17275     IF  CERT-WAS-CREATED-FOR-CLAIM
 17276         GO TO 4520-BUILD-NEW-KEY.
 17277
 17278     IF CERT-ADDED-BATCH
 17279        IF CM-RECORD-ID = 'CM'
 17280            GO TO 4999-EXIT.
 17281
 17282 4520-BUILD-NEW-KEY.
 17283* BUILD CONTROL PRIMARY
 17284
 17285     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17286                                       CM-COMPANY-CD-A1
 17287                                       CM-COMPANY-CD-A2
 17288                                       CM-COMPANY-CD-A4
 17289                                       CM-COMPANY-CD-A5.
 17290
 17291     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17292     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17293     MOVE PB-SV-STATE               TO CM-STATE.
 17294     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17295     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17296     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17297     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17298
 17299     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17300
 17301     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17302     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17303     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17304     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17305
 17306     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17307        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17308
 17309     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17310         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17311         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17312         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17313         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17314     ELSE
 17315         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17316
 17317     IF PB-COMPANY-ID   EQUAL  'CRI'
 17318         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17319         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17320         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17321         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17322         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 315
* EL050.cbl
 17323
 17324     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17325        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17326         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17327
 17328     IF PB-COMPANY-ID  = 'LBL'
 17329        IF PB-I-JOINT-COVERAGE
 17330            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17331                                           PB-I-MEMBER-NO
 17332            GO TO 4550-CONT-CERT-PROCESS.
 17333
 17334     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17335        NEXT SENTENCE
 17336     ELSE
 17337        GO TO 4540-BUILD-MEMBER-NO.
 17338
 17339******************************************************************
 17340*                                                                *
 17341*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17342*    FOR 'MON'.                                                  *
 17343*                                                                *
 17344******************************************************************
 17345
 17346     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17347     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17348     MOVE +1                     TO WS-SUB1
 17349                                    WS-SUB2.
 17350
 17351 4530-EDIT-MEMB-NAME.
 17352
 17353     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17354        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17355        ADD +1                       TO WS-SUB2.
 17356
 17357     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17358        ADD +1                       TO WS-SUB1
 17359        GO TO 4530-EDIT-MEMB-NAME.
 17360
 17361     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17362     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17363     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17364*    MOVE SPACE                      TO DC-OPTION-CODE.
 17365     SET  BIN-TO-GREG                TO TRUE.
 17366     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17367     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17368
 17369     GO TO 4550-CONT-CERT-PROCESS.
 17370
 17371******************************************************************
 17372*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17373******************************************************************
 17374
 17375 4540-BUILD-MEMBER-NO.
 17376
 17377     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17378         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17379         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17380         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 316
* EL050.cbl
 17381         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17382     ELSE
 17383         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17384
 17385     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17386        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17387         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17388
 17389 4550-CONT-CERT-PROCESS.
 17390
 17391*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17392*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17393*    ELSE
 17394*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17395
 17396     IF CERT-WAS-CREATED-FOR-CLAIM
 17397        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17398        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17399
 17400     IF CERT-AND-CLAIM-ONLINE
 17401        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17402        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17403
 17404     MOVE 'CM'                     TO CM-RECORD-ID.
 17405     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17406
 17407     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17408        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17409        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17410     ELSE
 17411        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17412        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17413
 17414     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17415     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17416     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17417     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17418     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17419     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17420     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17421                                      CM-LF-ITD-CANCEL-AMT
 17422                                      CM-LF-ITD-DEATH-AMT
 17423                                      CM-AH-ITD-AH-PMT
 17424                                      CM-AH-ITD-LUMP-PMT
 17425                                      CM-AH-ITD-CANCEL-AMT
 17426                                      CM-LF-NSP-PREMIUM-AMT
 17427                                      CM-AH-NSP-PREMIUM-AMT.
 17428*                                     CM-CLAIM-DEDUCT-WITHHELD
 17429*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17430     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
 17431     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17432     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17433     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17434     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
 17435     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17436     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17437     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17438     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 317
* EL050.cbl
 17439     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17440     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17441     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17442
 17443     IF PB-I-LIVES NOT NUMERIC
 17444         MOVE ZERO                 TO PB-I-LIVES.
 17445
 17446     IF PB-I-NUM-BILLED NOT NUMERIC
 17447         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17448
 17449     MOVE PB-I-LIVES               TO CM-LIVES.
 17450     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17451
 17452     IF PB-COMPANY-ID EQUAL  'DMD'
 17453         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17454         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17455
 17456     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17457     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17458     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17459     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17460     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17461     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17462
 17463     IF PB-I-LF-POLICY-FEE NUMERIC
 17464        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17465     ELSE
 17466        MOVE +0                    TO CM-LF-POLICY-FEE.
 17467
 17468     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17469        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17470        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17471     ELSE
 17472        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17473
 17474     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17475     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17476     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17477     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17478     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17479     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17480     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17481     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17482     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17483
 17484     IF PB-I-AH-POLICY-FEE NUMERIC
 17485        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17486     ELSE
 17487        MOVE +0                    TO CM-AH-POLICY-FEE.
 17488
 17489     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17490        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17491     ELSE
 17492        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 17493
 17494     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17495     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17496
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 318
* EL050.cbl
 17497     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17498                                      CM-LF-DEATH-EXIT-DT
 17499                                      CM-AH-SETTLEMENT-EXIT-DT.
 17500
 17501*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17502*                       'TIH' OR 'OFL' OR 'FLA' OR
 17503*                       'TII' OR 'TMS' OR 'CRI' OR
 17504*                       'NCL'
 17505     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17506
 17507     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17508         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17509            MOVE '2'                TO CM-PREMIUM-TYPE.
 17510
 17511     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17512         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17513            MOVE '2'                TO CM-PREMIUM-TYPE.
 17514
 17515     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17516         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17517     ELSE
 17518         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17519         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17520
 17521     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17522     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17523     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17524     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17525     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17526     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17527     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17528     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17529
 17530     IF PB-NO-MONTHS-SKIPPED
 17531         MOVE SPACE                 TO CM-SKIP-CODE
 17532     ELSE
 17533         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17534
 17535     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17536     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17537                                       CM-LF-STATUS-AT-CANCEL.
 17538
 17539     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17540     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17541                                       CM-AH-STATUS-AT-CANCEL.
 17542
 17543     MOVE '1'                       TO CM-ENTRY-STATUS.
 17544
 17545     IF PB-REISSUED-CERT
 17546        MOVE '5'                    TO CM-ENTRY-STATUS.
 17547
 17548     IF PB-MONTHLY-CERT
 17549        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17550
 17551     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17552     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17553     IF PB-POLICY-IS-DECLINED
 17554        MOVE 'D'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 319
* EL050.cbl
 17555
 17556     IF PB-POLICY-IS-VOIDED
 17557        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17558
 17559     IF PB-NEEDS-UNDERWRITING
 17560        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17561
 17562     IF PB-REIN-ONLY-CERT
 17563        MOVE '9'                    TO CM-ENTRY-STATUS.
 17564
 17565     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17566         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17567     ELSE
 17568         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17569
 17570     IF PB-RECORD-RETURNED
 17571        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17572      ELSE
 17573        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17574
 17575     IF PB-I-MAIL-ADDRS-PRESENT
 17576        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17577
 17578     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17579                                       CM-ENTRY-DT.
 17580
 17581 4999-EXIT.
 17582     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 320
* EL050.cbl
 17584
 17585 5000-PROCESS-REPS.
 17586     MOVE ' '                    TO AGTC-MASTER-SW
 17587     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17588     MOVE CO-TYPE                TO AGTC-TYPE
 17589     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17590     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17591     IF (AGTC-MASTER-SW NOT = 'N')
 17592        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17593        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17594        PERFORM 8583-READ-ERAGTC-NEXT
 17595                                 THRU 8583-EXIT
 17596     END-IF
 17597     IF AGTC-MASTER-SW = 'N'
 17598        CONTINUE
 17599     ELSE
 17600        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17601           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17602              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17603              MOVE 'Y'           TO AGTC-MASTER-SW
 17604           END-IF
 17605        END-IF
 17606     END-IF
 17607     .
 17608 5000-EXIT.
 17609     EXIT.
 17610 6370-EDIT-INPUT-LF-CODE.
 17611     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17612        MOVE +1                  TO SUB
 17613        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17614        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17615        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17616        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17617        GO TO 6370-SEARCH-LOOP.
 17618
 17619     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17620
 17621     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17622     MOVE SPACES                 TO CNTL-ACCESS.
 17623*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17624     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17625     MOVE +0                     TO CNTL-SEQ-NO.
 17626     MOVE '4' TO RC-SW-2.
 17627     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17628
 17629     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17630        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17631        GO TO 6370-NO-LF-FOUND.
 17632
 17633     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17634     MOVE +1                     TO SUB.
 17635
 17636 6370-SEARCH-LOOP.
 17637     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17638         GO TO 6370-NO-LF-FOUND.
 17639
 17640     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
 17641         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 321
* EL050.cbl
 17642         GO TO 6370-HER-NET-PAY-CHECK.
 17643
 17644     ADD 1   TO SUB.
 17645*    IF SUB GREATER 120
 17646     IF SUB GREATER 200
 17647         GO TO 6370-NO-LF-FOUND.
 17648
 17649     GO TO 6370-SEARCH-LOOP.
 17650
 17651 6370-NO-LF-FOUND.
 17652
 17653     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17654
 17655 6370-HER-NET-PAY-CHECK.
 17656
 17657     IF PB-COMPANY-ID = 'CID'
 17658        IF PB-SV-STATE = 'CA' OR 'MN'
 17659           IF PB-I-LF-BENEFIT-CD = '02'
 17660              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17661           ELSE
 17662              IF PB-I-LF-BENEFIT-CD = '04'
 17663                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17664              END-IF
 17665           END-IF
 17666        END-IF
 17667     END-IF
 17668
 17669     IF PB-COMPANY-ID NOT = 'HER'
 17670         GO TO 6370-EXIT.
 17671
 17672     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17673         GO TO 6370-EXIT.
 17674
 17675     IF PB-I-LF-TERM NOT NUMERIC
 17676         MOVE ZEROS              TO PB-I-LF-TERM.
 17677
 17678     IF PB-I-LOAN-TERM NOT NUMERIC
 17679         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17680
 17681     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17682         GO TO 6370-EXIT.
 17683
 17684     IF PB-I-LF-BENEFIT-CD = '33'
 17685         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17686
 17687     IF PB-I-LF-BENEFIT-CD = '34'
 17688         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17689
 17690 6370-EXIT.
 17691     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 322
* EL050.cbl
 17693
 17694 6380-EDIT-INPUT-AH-CODE.
 17695     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17696        MOVE +1                  TO SUB
 17697        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17698        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17699        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17700        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17701        GO TO 6380-SEARCH-LOOP.
 17702
 17703     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17704
 17705     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17706     MOVE SPACES                 TO CNTL-ACCESS.
 17707     MOVE 'A'                    TO CNTL-REC-TYPE.
 17708*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17709     MOVE +0                     TO CNTL-SEQ-NO.
 17710     MOVE '5' TO RC-SW-2.
 17711     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17712
 17713     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17714        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17715        GO TO 6380-NO-AH-FOUND.
 17716
 17717     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17718     MOVE +1 TO SUB.
 17719
 17720 6380-SEARCH-LOOP.
 17721     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17722         GO TO 6380-NO-AH-FOUND.
 17723
 17724     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17725         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17726         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17727
 17728     ADD 1   TO SUB.
 17729     IF SUB GREATER THAN 96
 17730*    IF SUB GREATER THAN 300
 17731         GO TO 6380-NO-AH-FOUND.
 17732
 17733     GO TO 6380-SEARCH-LOOP.
 17734
 17735 6380-NO-AH-FOUND.
 17736
 17737     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17738
 17739     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17740         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17741     ELSE
 17742         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17743
 17744 6380-CSO-AH-ONLY-CHECKS.
 17745
 17746     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17747        NEXT SENTENCE
 17748      ELSE
 17749        GO TO 6380-EXIT.
 17750
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 323
* EL050.cbl
 17751     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17752         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17753
 17754
 17755     GO TO 6380-EXIT
 17756     .
 17757 6380-CSO-LIFE-WITH-AH-CHECKS.
 17758
 17759
 17760     .
 17761 6380-EXIT.
 17762     EXIT.
 17763
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 324
* EL050.cbl
 17765
 17766 6400-COMPUTE-EXTENSION-DAYS.
 17767
 17768******************************************************************
 17769*                                                                *
 17770*                   COMPUTE EXTENSION DAYS                       *
 17771*                                                                *
 17772*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17773*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17774*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17775*    THE EXTENSION DAYS.                                         *
 17776*                                                                *
 17777******************************************************************
 17778
 17779     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17780     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17781
 17782******************************************************************
 17783*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17784*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17785******************************************************************
 17786
 17787     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17788        COMPUTE WS-ODD-DAYS-OVER =
 17789               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17790     ELSE
 17791        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17792
 17793     IF WS-ODD-DAYS-OVER = ZEROS
 17794           GO TO 6499-EXIT
 17795     ELSE
 17796        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17797           IF WS-WDF-MONTH = 02
 17798              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17799              ADD 2       TO  WS-ODD-DAYS-OVER
 17800              GO TO 6499-EXIT
 17801           ELSE
 17802              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17803                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17804                 GO TO 6499-EXIT
 17805               ELSE
 17806                 GO TO 6499-EXIT
 17807        ELSE
 17808           GO TO 6499-EXIT.
 17809
 17810 6412-CHECK-TO-DAY.
 17811
 17812        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17813           IF WS-WDT-DAY = 28
 17814              ADD 2              TO WS-ODD-DAYS-OVER
 17815           ELSE
 17816              IF WS-WDT-DAY = 29
 17817                 ADD 1           TO WS-ODD-DAYS-OVER
 17818              ELSE
 17819                 NEXT SENTENCE
 17820        ELSE
 17821           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17822              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 325
* EL050.cbl
 17823
 17824     GO TO 6499-EXIT.
 17825
 17826
 17827 6415-CHECK-LEAP-YEAR.
 17828
 17829     IF DC-DAYS-IN-MONTH = 29
 17830        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17831
 17832 6415-EXIT.
 17833     EXIT.
 17834
 17835 6499-EXIT.
 17836      EXIT.
 17837
 17838 6500-END.
 17839     EXIT.
 17840
 17841
 17842******************************************************************
 17843************* PROCEDURE DIVISION FOR EL050 ***********************
 17844********************** ELC50PD END *******************************
 17845
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 326
* EL050.cbl
 17847
 17848**START***********************************************************
 17849*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17850*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17851******************************************************************
 17852*
 17853 6600-GET-STATE-MUNICIPAL-TAX.
 17854
 17855     IF PB-COMPANY-ID NOT = 'DMD'
 17856         GO TO 6640-EXIT.
 17857
 17858     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17859     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17860     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 17861*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 17862*
 17863***  Y2K PROJ 7744
 17864     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17865     SET BIN-TO-GREG          TO TRUE.
 17866     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17867
 17868     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17869
 17870     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 17871     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 17872
 17873
 17874* EXEC CICS HANDLE CONDITION
 17875*        INVREQ    (6610-START-BROWSE)
 17876*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17877*        NOTFND    (6630-END-OF-FILE)
 17878*    END-EXEC.
 17879*    MOVE '"$8JI                 ! # #00017861' TO DFHEIV0
 17880     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 17881     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17882     MOVE X'2320233030303137383631' TO DFHEIV0(25:11)
 17883     CALL 'kxdfhei1' USING DFHEIV0
 17884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17885
 17886
 17887 6610-START-BROWSE.
 17888
 17889
 17890* EXEC CICS HANDLE CONDITION
 17891*        NOTFND    (6630-END-OF-FILE)
 17892*        DISABLED  (6630-ERRESS-PROBLEM)
 17893*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17894*        ENDFILE   (6630-END-OF-FILE)
 17895*    END-EXEC.
 17896*    MOVE '"$IcJ''                ! $ #00017869' TO DFHEIV0
 17897     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17898     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17899     MOVE X'2420233030303137383639' TO DFHEIV0(25:11)
 17900     CALL 'kxdfhei1' USING DFHEIV0
 17901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17902
 17903
 17904
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 327
* EL050.cbl
 17905* EXEC CICS STARTBR
 17906*        DATASET (FILE-ID-ERRESS)
 17907*        RIDFLD  (WS-ERRESS-KEY)
 17908*        GTEQ
 17909*    END-EXEC.
 17910     MOVE 0
 17911       TO DFHEIV11
 17912*    MOVE '&,         G          &   #00017876' TO DFHEIV0
 17913     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17914     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17915     MOVE X'2020233030303137383736' TO DFHEIV0(25:11)
 17916     CALL 'kxdfhei1' USING DFHEIV0,
 17917           FILE-ID-ERRESS,
 17918           WS-ERRESS-KEY,
 17919           DFHEIV99,
 17920           DFHEIV11,
 17921           DFHEIV99
 17922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17923
 17924
 17925 6620-READ-NEXT-ERRESS-MASTER.
 17926
 17927
 17928* EXEC CICS HANDLE CONDITION
 17929*        NOTFND    (6630-END-OF-FILE)
 17930*        ENDFILE   (6630-END-OF-FILE)
 17931*        DISABLED  (6630-ERRESS-PROBLEM)
 17932*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17933*    END-EXEC.
 17934*    MOVE '"$I''cJ                ! % #00017884' TO DFHEIV0
 17935     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 17936     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17937     MOVE X'2520233030303137383834' TO DFHEIV0(25:11)
 17938     CALL 'kxdfhei1' USING DFHEIV0
 17939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17940
 17941
 17942
 17943* EXEC CICS READNEXT
 17944*        DATASET (FILE-ID-ERRESS)
 17945*        INTO    (RESIDENT-STATE-TAX-MASTER)
 17946*        RIDFLD  (WS-ERRESS-KEY)
 17947*    END-EXEC.
 17948     MOVE LENGTH OF
 17949      RESIDENT-STATE-TAX-MASTER
 17950       TO DFHEIV12
 17951     MOVE 0
 17952       TO DFHEIV11
 17953*    MOVE '&.IL                  )   #00017891' TO DFHEIV0
 17954     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17955     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17956     MOVE X'2020233030303137383931' TO DFHEIV0(25:11)
 17957     CALL 'kxdfhei1' USING DFHEIV0,
 17958           FILE-ID-ERRESS,
 17959           RESIDENT-STATE-TAX-MASTER,
 17960           DFHEIV12,
 17961           WS-ERRESS-KEY,
 17962           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 328
* EL050.cbl
 17963           DFHEIV11,
 17964           DFHEIV99,
 17965           DFHEIV99
 17966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17967
 17968
 17969     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 17970
 17971* EXEC CICS ENDBR
 17972*            DATASET (FILE-ID-ERRESS)
 17973*       END-EXEC
 17974     MOVE 0
 17975       TO DFHEIV11
 17976*    MOVE '&2                    $   #00017898' TO DFHEIV0
 17977     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17978     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17979     MOVE X'2020233030303137383938' TO DFHEIV0(25:11)
 17980     CALL 'kxdfhei1' USING DFHEIV0,
 17981           FILE-ID-ERRESS,
 17982           DFHEIV11,
 17983           DFHEIV99
 17984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17985        GO TO 6630-END-OF-FILE.
 17986
 17987     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 17988        NEXT SENTENCE
 17989      ELSE
 17990        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 17991
 17992*IS IT LIFE(1) OR IS IT P&C(2) ?????
 17993*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 17994*
 17995     MOVE +2                     TO WS-SUB1.
 17996
 17997     IF PB-ISSUE
 17998     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 17999        MOVE +1                  TO WS-SUB1.
 18000
 18001     IF PB-CANCELLATION
 18002     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18003        MOVE +1                  TO WS-SUB1.
 18004*
 18005*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18006*
 18007***  Y2K PROJ 7744
 18008     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18009***  Y2K PROJ 7744
 18010
 18011*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18012* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18013* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18014
 18015     ADD 1                    TO WS-YEAR-YY.
 18016
 18017     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18018         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18019                              TO WS-RES-STATE-TAX
 18020         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 329
* EL050.cbl
 18021                              TO WS-RES-MUNI-TAX
 18022     ELSE
 18023         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18024                              TO WS-RES-STATE-TAX
 18025         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18026                              TO WS-RES-MUNI-TAX.
 18027
 18028*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18029
 18030     IF PB-CANCELLATION
 18031         GO TO 6640-CANCEL-TAX.
 18032
 18033     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18034         COMPUTE PB-I-STATE-TAX ROUNDED =
 18035                                   PB-I-LF-PREMIUM-AMT
 18036                                 * WS-RES-STATE-TAX
 18037         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18038                                   PB-I-LF-PREMIUM-AMT
 18039                                 * WS-RES-MUNI-TAX
 18040     ELSE
 18041     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18042         COMPUTE PB-I-STATE-TAX ROUNDED =
 18043                                   PB-I-AH-PREMIUM-AMT
 18044                                 * WS-RES-STATE-TAX
 18045         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18046                                   PB-I-AH-PREMIUM-AMT
 18047                                 * WS-RES-MUNI-TAX.
 18048
 18049
 18050* EXEC CICS ENDBR
 18051*         DATASET (FILE-ID-ERRESS)
 18052*    END-EXEC.
 18053     MOVE 0
 18054       TO DFHEIV11
 18055*    MOVE '&2                    $   #00017965' TO DFHEIV0
 18056     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18057     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18058     MOVE X'2020233030303137393635' TO DFHEIV0(25:11)
 18059     CALL 'kxdfhei1' USING DFHEIV0,
 18060           FILE-ID-ERRESS,
 18061           DFHEIV11,
 18062           DFHEIV99
 18063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18064
 18065
 18066     GO TO 6640-EXIT.
 18067
 18068 6640-CANCEL-TAX.
 18069     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18070
 18071     IF PB-C-LF-CANCEL-AMT > ZEROS
 18072         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18073                                   PB-C-LF-CANCEL-AMT
 18074                                 * WS-RES-STATE-TAX
 18075         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18076                                   PB-C-LF-CANCEL-AMT
 18077                                *  WS-RES-MUNI-TAX
 18078     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 330
* EL050.cbl
 18079     IF PB-C-AH-CANCEL-AMT > ZEROS
 18080         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18081                                   PB-C-AH-CANCEL-AMT
 18082                                 * WS-RES-STATE-TAX
 18083         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18084                                   PB-C-AH-CANCEL-AMT
 18085                                *  WS-RES-MUNI-TAX.
 18086
 18087
 18088* EXEC CICS ENDBR
 18089*         DATASET (FILE-ID-ERRESS)
 18090*    END-EXEC.
 18091     MOVE 0
 18092       TO DFHEIV11
 18093*    MOVE '&2                    $   #00017990' TO DFHEIV0
 18094     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18095     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18096     MOVE X'2020233030303137393930' TO DFHEIV0(25:11)
 18097     CALL 'kxdfhei1' USING DFHEIV0,
 18098           FILE-ID-ERRESS,
 18099           DFHEIV11,
 18100           DFHEIV99
 18101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18102
 18103
 18104     GO TO 6640-EXIT.
 18105
 18106 6630-END-OF-FILE.
 18107     MOVE ER-8002              TO WS-ERROR.
 18108     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18109
 18110     GO TO 6640-EXIT.
 18111
 18112 6630-ERRESS-PROBLEM.
 18113     MOVE ER-8044              TO WS-ERROR.
 18114     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18115
 18116 6640-EXIT.
 18117     EXIT.
 18118
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 331
* EL050.cbl
 18120 6650-GET-RES-STATE-COMM.
 18121
 18122     IF PB-COMPANY-ID NOT = 'DMD'
 18123         GO TO 6700-COMM-EXIT.
 18124
 18125     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18126     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18127     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18128     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18129     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18130     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18131     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18132
 18133*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18134*
 18135***  Y2K PROJ 7744
 18136     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18137     SET BIN-TO-GREG          TO TRUE.
 18138     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18139
 18140     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18141***  Y2K PROJ 7744
 18142
 18143     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18144
 18145
 18146* EXEC CICS HANDLE CONDITION
 18147*        INVREQ    (6660-START-BROWSE)
 18148*        DISABLED  (6690-ERRESC-PROBLEM)
 18149*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18150*        NOTFND    (6690-END-OF-FILE)
 18151*    END-EXEC.
 18152*    MOVE '"$8cJI                ! & #00018035' TO DFHEIV0
 18153     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18154     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18155     MOVE X'2620233030303138303335' TO DFHEIV0(25:11)
 18156     CALL 'kxdfhei1' USING DFHEIV0
 18157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18158
 18159
 18160
 18161* EXEC CICS RESETBR
 18162*        DATASET (FILE-ID-ERRESC)
 18163*        RIDFLD  (WS-ERRESC-KEY)
 18164*    END-EXEC.
 18165     MOVE 0
 18166       TO DFHEIV11
 18167*    MOVE '&4         G          &   #00018042' TO DFHEIV0
 18168     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18169     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18170     MOVE X'2020233030303138303432' TO DFHEIV0(25:11)
 18171     CALL 'kxdfhei1' USING DFHEIV0,
 18172           FILE-ID-ERRESC,
 18173           WS-ERRESC-KEY,
 18174           DFHEIV99,
 18175           DFHEIV11,
 18176           DFHEIV99
 18177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 332
* EL050.cbl
 18178
 18179
 18180 6660-START-BROWSE.
 18181
 18182
 18183* EXEC CICS HANDLE CONDITION
 18184*        NOTFND    (6690-END-OF-FILE)
 18185*        DISABLED  (6690-ERRESC-PROBLEM)
 18186*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18187*        ENDFILE   (6690-END-OF-FILE)
 18188*    END-EXEC.
 18189*    MOVE '"$IcJ''                ! '' #00018049' TO DFHEIV0
 18190     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18191     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18192     MOVE X'2720233030303138303439' TO DFHEIV0(25:11)
 18193     CALL 'kxdfhei1' USING DFHEIV0
 18194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18195
 18196
 18197
 18198* EXEC CICS STARTBR
 18199*        DATASET (FILE-ID-ERRESC)
 18200*        RIDFLD  (WS-ERRESC-KEY)
 18201*        GTEQ
 18202*    END-EXEC.
 18203     MOVE 0
 18204       TO DFHEIV11
 18205*    MOVE '&,         G          &   #00018056' TO DFHEIV0
 18206     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18207     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18208     MOVE X'2020233030303138303536' TO DFHEIV0(25:11)
 18209     CALL 'kxdfhei1' USING DFHEIV0,
 18210           FILE-ID-ERRESC,
 18211           WS-ERRESC-KEY,
 18212           DFHEIV99,
 18213           DFHEIV11,
 18214           DFHEIV99
 18215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18216
 18217
 18218     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18219
 18220 6670-READ-NEXT-ERRESC-MASTER.
 18221
 18222
 18223* EXEC CICS HANDLE CONDITION
 18224*        NOTFND    (6690-END-OF-FILE)
 18225*        DISABLED  (6690-ERRESC-PROBLEM)
 18226*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18227*        ENDFILE   (6690-END-OF-FILE)
 18228*    END-EXEC.
 18229*    MOVE '"$IcJ''                ! ( #00018066' TO DFHEIV0
 18230     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18231     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18232     MOVE X'2820233030303138303636' TO DFHEIV0(25:11)
 18233     CALL 'kxdfhei1' USING DFHEIV0
 18234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18235
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 333
* EL050.cbl
 18236
 18237
 18238* EXEC CICS READNEXT
 18239*        DATASET (FILE-ID-ERRESC)
 18240*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18241*        RIDFLD  (ERRESC-RECORD-KEY)
 18242*    END-EXEC.
 18243     MOVE LENGTH OF
 18244      ACCOUNT-RESIDENT-ST-COMMISSION
 18245       TO DFHEIV12
 18246     MOVE 0
 18247       TO DFHEIV11
 18248*    MOVE '&.IL                  )   #00018073' TO DFHEIV0
 18249     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18250     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18251     MOVE X'2020233030303138303733' TO DFHEIV0(25:11)
 18252     CALL 'kxdfhei1' USING DFHEIV0,
 18253           FILE-ID-ERRESC,
 18254           ACCOUNT-RESIDENT-ST-COMMISSION,
 18255           DFHEIV12,
 18256           ERRESC-RECORD-KEY,
 18257           DFHEIV99,
 18258           DFHEIV11,
 18259           DFHEIV99,
 18260           DFHEIV99
 18261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18262
 18263
 18264     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18265        NEXT SENTENCE
 18266     ELSE
 18267
 18268* EXEC CICS ENDBR
 18269*            DATASET (FILE-ID-ERRESC)
 18270*       END-EXEC
 18271     MOVE 0
 18272       TO DFHEIV11
 18273*    MOVE '&2                    $   #00018082' TO DFHEIV0
 18274     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18275     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18276     MOVE X'2020233030303138303832' TO DFHEIV0(25:11)
 18277     CALL 'kxdfhei1' USING DFHEIV0,
 18278           FILE-ID-ERRESC,
 18279           DFHEIV11,
 18280           DFHEIV99
 18281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18282        GO TO 6690-END-OF-FILE.
 18283
 18284     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18285
 18286* EXEC CICS ENDBR
 18287*            DATASET (FILE-ID-ERRESC)
 18288*       END-EXEC
 18289     MOVE 0
 18290       TO DFHEIV11
 18291*    MOVE '&2                    $   #00018088' TO DFHEIV0
 18292     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18293     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 334
* EL050.cbl
 18294     MOVE X'2020233030303138303838' TO DFHEIV0(25:11)
 18295     CALL 'kxdfhei1' USING DFHEIV0,
 18296           FILE-ID-ERRESC,
 18297           DFHEIV11,
 18298           DFHEIV99
 18299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18300        GO TO 6690-END-OF-FILE.
 18301
 18302     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18303        NEXT SENTENCE
 18304      ELSE
 18305        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18306
 18307* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18308*
 18309     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18310
 18311     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18312
 18313     IF WS-SUB1 > ZERO
 18314         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18315             PERFORM 6680-SET-COMMISSION
 18316         ELSE
 18317             PERFORM 6680-SET-TABLE-CODE.
 18318
 18319
 18320* EXEC CICS ENDBR
 18321*         DATASET (FILE-ID-ERRESC)
 18322*    END-EXEC.
 18323     MOVE 0
 18324       TO DFHEIV11
 18325*    MOVE '&2                    $   #00018110' TO DFHEIV0
 18326     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18327     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18328     MOVE X'2020233030303138313130' TO DFHEIV0(25:11)
 18329     CALL 'kxdfhei1' USING DFHEIV0,
 18330           FILE-ID-ERRESC,
 18331           DFHEIV11,
 18332           DFHEIV99
 18333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18334
 18335
 18336     GO TO 6700-COMM-EXIT.
 18337
 18338 6680-SET-TABLE-CODE.
 18339     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18340        MOVE ZEROS             TO WS-SUB1
 18341     ELSE
 18342* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18343* TO COMPUTE AH COMMISSION.
 18344        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18345        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18346        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18347        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18348        PERFORM 6680-READ-CTBL-TABLE
 18349        IF WS-CTBL-READ-SW NOT = 'Y'
 18350           MOVE ZEROS          TO WS-SUB1.
 18351
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 335
* EL050.cbl
 18352 6680-READ-CTBL-TABLE.
 18353*
 18354* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18355* TO COMPUTE LIFE COMMISSION
 18356
 18357     IF CTBL-SW = '0540'
 18358        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18359        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18360        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18361
 18362     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18363
 18364     IF CTBL-TABLE-FOUND
 18365        IF CTBL-SW = '0530'
 18366             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18367                                    * PB-I-AH-TERM
 18368             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18369             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18370        ELSE
 18371             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18372             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18373             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18374     ELSE
 18375        IF FIRST-TIME-THROUGH
 18376            GO TO 6680-READ-CTBL-TABLE
 18377        ELSE
 18378            MOVE ZEROS         TO WS-SUB1.
 18379
 18380 6680-SET-COMMISSION.
 18381     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18382           MOVE ZEROS          TO WS-SUB1
 18383       ELSE
 18384           MOVE RESC-COMMISSION-PER (WS-SUB)
 18385                               TO WS-COMMISSION
 18386           IF CTBL-SW = '0530'
 18387               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18388           ELSE
 18389               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18390
 18391 6680-SEARCH-CATEGORY.
 18392     ADD +1                   TO WS-SUB.
 18393     IF WS-SUB > +12
 18394         GO TO 6680-EXIT.
 18395
 18396     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18397          MOVE WS-SUB         TO WS-SUB1
 18398          GO TO 6680-EXIT.
 18399
 18400     GO TO 6680-SEARCH-CATEGORY.
 18401
 18402 6680-EXIT.
 18403     EXIT.
 18404
 18405 6690-END-OF-FILE.
 18406     GO TO 6700-COMM-EXIT.
 18407
 18408 6690-ERRESC-PROBLEM.
 18409      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 336
* EL050.cbl
 18410      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18411
 18412      GO TO 6700-COMM-EXIT.
 18413
 18414 6700-COMM-EXIT.
 18415     EXIT.
 18416
 18417 7000-GET-RATE.
 18418
 18419* EXEC CICS LINK
 18420*        PROGRAM    ('ELRATE')
 18421*        COMMAREA   (CALCULATION-PASS-AREA)
 18422*        LENGTH     (CP-COMM-LENGTH)
 18423*    END-EXEC.
 18424     MOVE 'ELRATE' TO DFHEIV1
 18425*    MOVE '."C                   (   #00018196' TO DFHEIV0
 18426     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18427     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18428     MOVE X'2020233030303138313936' TO DFHEIV0(25:11)
 18429     CALL 'kxdfhei1' USING DFHEIV0,
 18430           DFHEIV1,
 18431           CALCULATION-PASS-AREA,
 18432           CP-COMM-LENGTH,
 18433           DFHEIV99,
 18434           DFHEIV99,
 18435           DFHEIV99,
 18436           DFHEIV99
 18437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18438
 18439
 18440 7000-EXIT.
 18441     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 337
* EL050.cbl
 18443 7100-FIND-BENEFIT-IN-STATE.
 18444     MOVE 'N'                    TO BEN-SEARCH-SW.
 18445
 18446     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18447         VARYING SUB3 FROM 1 BY 1 UNTIL
 18448            ((SUB3 GREATER 50) OR
 18449              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18450               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18451
 18452     IF SUB3 NOT = 51
 18453         MOVE 'Y'                TO BEN-SEARCH-SW.
 18454
 18455     GO TO 7199-EXIT.
 18456
 18457 7100-BENEFIT-DUMMY.
 18458
 18459 7100-DUMMY-EXIT.
 18460     EXIT.
 18461
 18462 7199-EXIT.
 18463     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 338
* EL050.cbl
 18465 7200-FIND-BENEFIT.
 18466     MOVE 'N'                    TO BEN-SEARCH-SW.
 18467
 18468     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18469         VARYING SUB3 FROM 1 BY 1 UNTIL
 18470            ((SUB3 GREATER 8) OR
 18471            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18472
 18473     IF SUB3 NOT = 9
 18474         MOVE 'Y'                TO BEN-SEARCH-SW.
 18475
 18476     GO TO 7200-EXIT.
 18477
 18478 7200-BENEFIT-DUMMY.
 18479
 18480 7200-DUMMY-EXIT.
 18481     EXIT.
 18482
 18483 7200-EXIT.
 18484     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 339
* EL050.cbl
 18486 7250-LOOK-FOR-RESCINDED-CLAIM.
 18487     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18488                                    W-CL-COMP-CD.
 18489     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18490                                    W-CL-CERT-NO.
 18491
 18492
 18493* EXEC CICS HANDLE CONDITION
 18494*        NOTFND  (7250-CONTINUE)
 18495*        ENDFILE (7250-CONTINUE)
 18496*    END-EXEC.
 18497*    MOVE '"$I''                  ! ) #00018254' TO DFHEIV0
 18498     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18499     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18500     MOVE X'2920233030303138323534' TO DFHEIV0(25:11)
 18501     CALL 'kxdfhei1' USING DFHEIV0
 18502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18503
 18504
 18505
 18506* EXEC CICS IGNORE CONDITION
 18507*        DUPKEY
 18508*    END-EXEC.
 18509*    MOVE '"*$                   !   #00018259' TO DFHEIV0
 18510     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18511     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18512     MOVE X'2020233030303138323539' TO DFHEIV0(25:11)
 18513     CALL 'kxdfhei1' USING DFHEIV0
 18514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18515
 18516
 18517
 18518* EXEC CICS STARTBR
 18519*        DATASET   (CLMS-ID)
 18520*        RIDFLD    (ELMSTR-KEY)
 18521*        GENERIC   EQUAL
 18522*        KEYLENGTH (ELMSTR-LENGTH)
 18523*    END-EXEC.
 18524     MOVE 0
 18525       TO DFHEIV11
 18526*    MOVE '&,   KG    E          &   #00018263' TO DFHEIV0
 18527     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18528     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18529     MOVE X'2020233030303138323633' TO DFHEIV0(25:11)
 18530     CALL 'kxdfhei1' USING DFHEIV0,
 18531           CLMS-ID,
 18532           ELMSTR-KEY,
 18533           ELMSTR-LENGTH,
 18534           DFHEIV11,
 18535           DFHEIV99
 18536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18537
 18538
 18539     MOVE 'Y'                    TO W-BROWSE-SW.
 18540
 18541 7250-NEXT-CLAIM.
 18542
 18543
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 340
* EL050.cbl
 18544* EXEC CICS READNEXT
 18545*        DATASET   (CLMS-ID)
 18546*        RIDFLD    (ELMSTR-KEY)
 18547*        SET       (ADDRESS OF CLAIM-MASTER)
 18548*    END-EXEC.
 18549     MOVE 0
 18550       TO DFHEIV11
 18551*    MOVE '&.S                   )   #00018274' TO DFHEIV0
 18552     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18553     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18554     MOVE X'2020233030303138323734' TO DFHEIV0(25:11)
 18555     CALL 'kxdfhei1' USING DFHEIV0,
 18556           CLMS-ID,
 18557           DFHEIV20,
 18558           DFHEIV99,
 18559           ELMSTR-KEY,
 18560           DFHEIV99,
 18561           DFHEIV11,
 18562           DFHEIV99,
 18563           DFHEIV99
 18564     SET ADDRESS OF CLAIM-MASTER TO
 18565         DFHEIV20
 18566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18567
 18568
 18569     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18570        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18571         GO TO 7250-CONTINUE
 18572     END-IF.
 18573
 18574     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18575        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18576        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18577        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18578        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18579         GO TO 7250-NEXT-CLAIM
 18580     END-IF.
 18581
 18582     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18583        OR (CL-CLAIM-TYPE = 'I')
 18584        OR (CL-CLAIM-TYPE = 'G')
 18585          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18586              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18587              GO TO 7250-CONTINUE
 18588          END-IF
 18589     END-IF.
 18590
 18591     GO TO 7250-NEXT-CLAIM.
 18592
 18593 7250-CONTINUE.
 18594
 18595     IF W-BROWSE-SW = 'Y'
 18596
 18597* EXEC CICS ENDBR
 18598*            DATASET   (CLMS-ID)
 18599*        END-EXEC
 18600     MOVE 0
 18601       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 341
* EL050.cbl
 18602*    MOVE '&2                    $   #00018307' TO DFHEIV0
 18603     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18604     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18605     MOVE X'2020233030303138333037' TO DFHEIV0(25:11)
 18606     CALL 'kxdfhei1' USING DFHEIV0,
 18607           CLMS-ID,
 18608           DFHEIV11,
 18609           DFHEIV99
 18610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18611         MOVE 'N' TO W-BROWSE-SW
 18612     END-IF.
 18613
 18614 7250-EXIT.
 18615     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 342
* EL050.cbl
 18617 7300-CHECK-FOR-OPEN-CLMS.
 18618
 18619*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18620*    MOVE SPACES                 TO CNTL-ACCESS.
 18621*    MOVE '1'                    TO CNTL-REC-TYPE.
 18622*    MOVE +0                     TO CNTL-SEQ-NO.
 18623
 18624*    MOVE '3'                    TO RC-SW-1.
 18625*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18626
 18627*    IF NOT CF-COMPANY-MASTER
 18628*         PERFORM 0099-COMPANY-NOT-FOUND
 18629*         GO TO 7300-EXIT.
 18630
 18631     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18632                                    W-CL-COMP-CD.
 18633     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18634                                    W-CL-CERT-NO.
 18635
 18636
 18637* EXEC CICS HANDLE CONDITION
 18638*        NOTFND  (7300-CONTINUE)
 18639*        ENDFILE (7300-CONTINUE)
 18640*    END-EXEC.
 18641*    MOVE '"$I''                  ! * #00018335' TO DFHEIV0
 18642     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18643     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18644     MOVE X'2A20233030303138333335' TO DFHEIV0(25:11)
 18645     CALL 'kxdfhei1' USING DFHEIV0
 18646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18647
 18648
 18649
 18650* EXEC CICS IGNORE CONDITION
 18651*        DUPKEY
 18652*    END-EXEC.
 18653*    MOVE '"*$                   !   #00018340' TO DFHEIV0
 18654     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18655     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18656     MOVE X'2020233030303138333430' TO DFHEIV0(25:11)
 18657     CALL 'kxdfhei1' USING DFHEIV0
 18658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18659
 18660
 18661
 18662* EXEC CICS STARTBR
 18663*        DATASET   (CLMS-ID)
 18664*        RIDFLD    (ELMSTR-KEY)
 18665*        GENERIC   EQUAL
 18666*        KEYLENGTH (ELMSTR-LENGTH)
 18667*    END-EXEC.
 18668     MOVE 0
 18669       TO DFHEIV11
 18670*    MOVE '&,   KG    E          &   #00018344' TO DFHEIV0
 18671     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18672     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18673     MOVE X'2020233030303138333434' TO DFHEIV0(25:11)
 18674     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 343
* EL050.cbl
 18675           CLMS-ID,
 18676           ELMSTR-KEY,
 18677           ELMSTR-LENGTH,
 18678           DFHEIV11,
 18679           DFHEIV99
 18680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18681
 18682
 18683     MOVE 'Y'                    TO W-BROWSE-SW.
 18684
 18685 7300-NEXT-CLAIM.
 18686
 18687
 18688* EXEC CICS READNEXT
 18689*        DATASET   (CLMS-ID)
 18690*        RIDFLD    (ELMSTR-KEY)
 18691*        SET       (ADDRESS OF CLAIM-MASTER)
 18692*    END-EXEC.
 18693     MOVE 0
 18694       TO DFHEIV11
 18695*    MOVE '&.S                   )   #00018355' TO DFHEIV0
 18696     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18697     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18698     MOVE X'2020233030303138333535' TO DFHEIV0(25:11)
 18699     CALL 'kxdfhei1' USING DFHEIV0,
 18700           CLMS-ID,
 18701           DFHEIV20,
 18702           DFHEIV99,
 18703           ELMSTR-KEY,
 18704           DFHEIV99,
 18705           DFHEIV11,
 18706           DFHEIV99,
 18707           DFHEIV99
 18708     SET ADDRESS OF CLAIM-MASTER TO
 18709         DFHEIV20
 18710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18711
 18712
 18713     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18714        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18715         GO TO 7300-CONTINUE.
 18716
 18717     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18718        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18719        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18720        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18721        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18722         GO TO 7300-NEXT-CLAIM.
 18723
 18724*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18725     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18726        OR (CL-CLAIM-TYPE = 'I')
 18727        OR (CL-CLAIM-TYPE = 'G')
 18728        IF CLAIM-IS-OPEN
 18729           EVALUATE TRUE
 18730             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18731                 MOVE ER-2884      TO WS-ERROR
 18732             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 344
* EL050.cbl
 18733                 MOVE ER-2887      TO WS-ERROR
 18734             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18735                 MOVE ER-2886      TO WS-ERROR
 18736             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18737                 MOVE ER-2888      TO WS-ERROR
 18738             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18739                 MOVE ER-2885      TO WS-ERROR
 18740             WHEN OTHER
 18741                 MOVE ER-2768      TO WS-ERROR
 18742           END-EVALUATE
 18743           IF PB-C-AH-CANCEL-VOIDED OR
 18744              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18745                NOT AH-COVERAGE-CANCELLED)
 18746               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18747               MOVE ER-2768      TO WS-ERROR
 18748           END-IF
 18749           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18750           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18751              PB-FORCE-CODE NOT EQUAL '8'
 18752               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18753           END-IF
 18754           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18755           GO TO 7300-CONTINUE
 18756        ELSE
 18757           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18758*****THIS IS A RESCISSION OR REFORMATION
 18759              IF (AH-COVERAGE-CANCELLED AND
 18760                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18761                    MOVE ER-2890 TO WS-ERROR
 18762                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18763                    GO TO 7300-CONTINUE
 18764              END-IF
 18765           ELSE
 18766              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18767               AND PB-C-AH-CANCEL-DT > SPACES
 18768                 MOVE ER-2756        TO WS-ERROR
 18769                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18770                 GO TO 7300-CONTINUE
 18771              END-IF
 18772           END-IF
 18773        END-IF
 18774     ELSE
 18775*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18776        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18777           IF CLAIM-IS-OPEN
 18778              MOVE ER-2889      TO WS-ERROR
 18779              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18780              GO TO 7300-CONTINUE
 18781           ELSE
 18782              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18783*****THIS IS A RESCISSION OR REFORMATION
 18784                 IF (LF-COVERAGE-CANCELLED AND
 18785                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18786                       MOVE ER-2890 TO WS-ERROR
 18787                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18788                       GO TO 7300-CONTINUE
 18789                 END-IF
 18790              ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 345
* EL050.cbl
 18791                 IF (AH-COVERAGE-CANCELLED AND
 18792                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18793                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18794                    (LF-COVERAGE-CANCELLED AND
 18795                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18796                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18797                       MOVE ER-2965 TO WS-ERROR
 18798                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18799                       GO TO 7300-CONTINUE
 18800                 END-IF
 18801                 IF LF-COVERAGE-CANCELLED
 18802                  IF CL-TOTAL-PAID-AMT > 0
 18803                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18804                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18805                        MOVE ER-2891 TO WS-ERROR
 18806                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18807                        GO TO 7300-CONTINUE
 18808                      END-IF
 18809                    ELSE
 18810                      MOVE ER-2892 TO WS-ERROR
 18811                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18812                      GO TO 7300-CONTINUE
 18813                    END-IF
 18814                  END-IF
 18815                 END-IF
 18816              END-IF
 18817           END-IF
 18818        END-IF
 18819     END-IF
 18820
 18821     GO TO 7300-NEXT-CLAIM.
 18822
 18823 7300-CONTINUE.
 18824
 18825     IF W-BROWSE-SW = 'Y'
 18826
 18827* EXEC CICS ENDBR
 18828*            DATASET   (CLMS-ID)
 18829*        END-EXEC.
 18830     MOVE 0
 18831       TO DFHEIV11
 18832*    MOVE '&2                    $   #00018474' TO DFHEIV0
 18833     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18834     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18835     MOVE X'2020233030303138343734' TO DFHEIV0(25:11)
 18836     CALL 'kxdfhei1' USING DFHEIV0,
 18837           CLMS-ID,
 18838           DFHEIV11,
 18839           DFHEIV99
 18840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18841
 18842
 18843 7300-EXIT.
 18844     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 346
* EL050.cbl
 18846
 18847 7400-GET-REMAIN-TERM.
 18848
 18849* EXEC CICS LINK
 18850*        PROGRAM    ('ELRTRM')
 18851*        COMMAREA   (CALCULATION-PASS-AREA)
 18852*        LENGTH     (CP-COMM-LENGTH)
 18853*    END-EXEC.
 18854     MOVE 'ELRTRM' TO DFHEIV1
 18855*    MOVE '."C                   (   #00018483' TO DFHEIV0
 18856     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18857     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18858     MOVE X'2020233030303138343833' TO DFHEIV0(25:11)
 18859     CALL 'kxdfhei1' USING DFHEIV0,
 18860           DFHEIV1,
 18861           CALCULATION-PASS-AREA,
 18862           CP-COMM-LENGTH,
 18863           DFHEIV99,
 18864           DFHEIV99,
 18865           DFHEIV99,
 18866           DFHEIV99
 18867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18868
 18869
 18870 7400-EXIT.
 18871     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 347
* EL050.cbl
 18873
 18874 7500-GET-REMAIN-AMOUNT.
 18875
 18876* EXEC CICS LINK
 18877*        PROGRAM    ('ELRAMT')
 18878*        COMMAREA   (CALCULATION-PASS-AREA)
 18879*        LENGTH     (CP-COMM-LENGTH)
 18880*    END-EXEC.
 18881     MOVE 'ELRAMT' TO DFHEIV1
 18882*    MOVE '."C                   (   #00018494' TO DFHEIV0
 18883     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18884     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18885     MOVE X'2020233030303138343934' TO DFHEIV0(25:11)
 18886     CALL 'kxdfhei1' USING DFHEIV0,
 18887           DFHEIV1,
 18888           CALCULATION-PASS-AREA,
 18889           CP-COMM-LENGTH,
 18890           DFHEIV99,
 18891           DFHEIV99,
 18892           DFHEIV99,
 18893           DFHEIV99
 18894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18895
 18896
 18897 7500-EXIT.
 18898     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 348
* EL050.cbl
 18900
 18901 7600-GET-REFUND.
 18902
 18903* EXEC CICS LINK
 18904*        PROGRAM    ('ELRFND')
 18905*        COMMAREA   (CALCULATION-PASS-AREA)
 18906*        LENGTH     (CP-COMM-LENGTH)
 18907*    END-EXEC.
 18908     MOVE 'ELRFND' TO DFHEIV1
 18909*    MOVE '."C                   (   #00018505' TO DFHEIV0
 18910     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18911     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18912     MOVE X'2020233030303138353035' TO DFHEIV0(25:11)
 18913     CALL 'kxdfhei1' USING DFHEIV0,
 18914           DFHEIV1,
 18915           CALCULATION-PASS-AREA,
 18916           CP-COMM-LENGTH,
 18917           DFHEIV99,
 18918           DFHEIV99,
 18919           DFHEIV99,
 18920           DFHEIV99
 18921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18922
 18923
 18924 7600-EXIT.
 18925     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 349
* EL050.cbl
 18927 7700-CALL-DL1.
 18928
 18929* EXEC CICS LINK
 18930*        PROGRAM    ('DLO001')
 18931*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 18932*        LENGTH     (DLO001-COMM-LENGTH)
 18933*    END-EXEC.
 18934     MOVE 'DLO001' TO DFHEIV1
 18935*    MOVE '."C                   (   #00018515' TO DFHEIV0
 18936     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18937     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18938     MOVE X'2020233030303138353135' TO DFHEIV0(25:11)
 18939     CALL 'kxdfhei1' USING DFHEIV0,
 18940           DFHEIV1,
 18941           WS-DLO-MASTER-POLICY-FORM,
 18942           DLO001-COMM-LENGTH,
 18943           DFHEIV99,
 18944           DFHEIV99,
 18945           DFHEIV99,
 18946           DFHEIV99
 18947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18948
 18949
 18950 7700-EXIT.
 18951     EXIT.
 18952
 18953 7710-CALL-DL2.
 18954
 18955* EXEC CICS LINK
 18956*        PROGRAM    ('DLO002')
 18957*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 18958*        LENGTH     (DLO002-COMM-LENGTH)
 18959*    END-EXEC.
 18960     MOVE 'DLO002' TO DFHEIV1
 18961*    MOVE '."C                   (   #00018525' TO DFHEIV0
 18962     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18963     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18964     MOVE X'2020233030303138353235' TO DFHEIV0(25:11)
 18965     CALL 'kxdfhei1' USING DFHEIV0,
 18966           DFHEIV1,
 18967           WS-DLO-INTERNAL-POLICY-FORM,
 18968           DLO002-COMM-LENGTH,
 18969           DFHEIV99,
 18970           DFHEIV99,
 18971           DFHEIV99,
 18972           DFHEIV99
 18973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18974
 18975
 18976 7710-EXIT.
 18977     EXIT.
 18978
 18979 7720-CALL-DL3.
 18980
 18981* EXEC CICS LINK
 18982*        PROGRAM    ('DLO003')
 18983*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 18984*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 350
* EL050.cbl
 18985*    END-EXEC.
 18986     MOVE 'DLO003' TO DFHEIV1
 18987*    MOVE '."C                   (   #00018535' TO DFHEIV0
 18988     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18989     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18990     MOVE X'2020233030303138353335' TO DFHEIV0(25:11)
 18991     CALL 'kxdfhei1' USING DFHEIV0,
 18992           DFHEIV1,
 18993           WS-DLO-VALID-BANK-ID,
 18994           DLO003-COMM-LENGTH,
 18995           DFHEIV99,
 18996           DFHEIV99,
 18997           DFHEIV99,
 18998           DFHEIV99
 18999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19000
 19001
 19002 7720-EXIT.
 19003     EXIT.
 19004
 19005 7730-CALL-DL7.
 19006
 19007* EXEC CICS LINK
 19008*        PROGRAM    ('DLO007')
 19009*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19010*        LENGTH     (DLO007-COMM-LENGTH)
 19011*    END-EXEC.
 19012     MOVE 'DLO007' TO DFHEIV1
 19013*    MOVE '."C                   (   #00018545' TO DFHEIV0
 19014     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19015     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19016     MOVE X'2020233030303138353435' TO DFHEIV0(25:11)
 19017     CALL 'kxdfhei1' USING DFHEIV0,
 19018           DFHEIV1,
 19019           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19020           DLO007-COMM-LENGTH,
 19021           DFHEIV99,
 19022           DFHEIV99,
 19023           DFHEIV99,
 19024           DFHEIV99
 19025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19026
 19027
 19028 7730-EXIT.
 19029     EXIT.
 19030
 19031 7740-CALL-DL11.
 19032
 19033* EXEC CICS LINK
 19034*        PROGRAM    ('DLO011')
 19035*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19036*        LENGTH     (DLO011-COMM-LENGTH)
 19037*    END-EXEC.
 19038     MOVE 'DLO011' TO DFHEIV1
 19039*    MOVE '."C                   (   #00018555' TO DFHEIV0
 19040     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19041     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19042     MOVE X'2020233030303138353535' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 351
* EL050.cbl
 19043     CALL 'kxdfhei1' USING DFHEIV0,
 19044           DFHEIV1,
 19045           WS-DLO-PREM-RATES-BEN-TYPE,
 19046           DLO011-COMM-LENGTH,
 19047           DFHEIV99,
 19048           DFHEIV99,
 19049           DFHEIV99,
 19050           DFHEIV99
 19051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19052
 19053
 19054 7740-EXIT.
 19055     EXIT.
 19056
 19057 7750-CALL-DL17.
 19058
 19059* EXEC CICS LINK
 19060*        PROGRAM    ('DLO017')
 19061*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19062*        LENGTH     (DLO017-COMM-LENGTH)
 19063*    END-EXEC.
 19064     MOVE 'DLO017' TO DFHEIV1
 19065*    MOVE '."C                   (   #00018565' TO DFHEIV0
 19066     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19067     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19068     MOVE X'2020233030303138353635' TO DFHEIV0(25:11)
 19069     CALL 'kxdfhei1' USING DFHEIV0,
 19070           DFHEIV1,
 19071           WS-DLO-VALID-RATE-CODE,
 19072           DLO017-COMM-LENGTH,
 19073           DFHEIV99,
 19074           DFHEIV99,
 19075           DFHEIV99,
 19076           DFHEIV99
 19077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19078
 19079
 19080 7750-EXIT.
 19081     EXIT.
 19082
 19083 7755-CALL-DL19.
 19084
 19085* EXEC CICS LINK
 19086*        PROGRAM    ('DLO019')
 19087*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19088*        LENGTH     (DLO019-COMM-LENGTH)
 19089*    END-EXEC.
 19090     MOVE 'DLO019' TO DFHEIV1
 19091*    MOVE '."C                   (   #00018575' TO DFHEIV0
 19092     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19093     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19094     MOVE X'2020233030303138353735' TO DFHEIV0(25:11)
 19095     CALL 'kxdfhei1' USING DFHEIV0,
 19096           DFHEIV1,
 19097           WS-DLO-ORIG-COV-CAT,
 19098           DLO019-COMM-LENGTH,
 19099           DFHEIV99,
 19100           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 352
* EL050.cbl
 19101           DFHEIV99,
 19102           DFHEIV99
 19103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19104
 19105
 19106 7755-EXIT.
 19107     EXIT.
 19108
 19109 7760-CALL-DL21.
 19110
 19111* EXEC CICS LINK
 19112*        PROGRAM    ('DLO021')
 19113*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19114*        LENGTH     (DLO021-COMM-LENGTH)
 19115*    END-EXEC.
 19116     MOVE 'DLO021' TO DFHEIV1
 19117*    MOVE '."C                   (   #00018585' TO DFHEIV0
 19118     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19119     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19120     MOVE X'2020233030303138353835' TO DFHEIV0(25:11)
 19121     CALL 'kxdfhei1' USING DFHEIV0,
 19122           DFHEIV1,
 19123           WS-DLO-VALID-LOAN-OFFICER,
 19124           DLO021-COMM-LENGTH,
 19125           DFHEIV99,
 19126           DFHEIV99,
 19127           DFHEIV99,
 19128           DFHEIV99
 19129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19130
 19131
 19132 7760-EXIT.
 19133     EXIT.
 19134
 19135 7770-CALL-DL22.
 19136
 19137* EXEC CICS LINK
 19138*        PROGRAM    ('DLO022')
 19139*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19140*        LENGTH     (DLO022-COMM-LENGTH)
 19141*    END-EXEC.
 19142     MOVE 'DLO022' TO DFHEIV1
 19143*    MOVE '."C                   (   #00018595' TO DFHEIV0
 19144     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19145     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19146     MOVE X'2020233030303138353935' TO DFHEIV0(25:11)
 19147     CALL 'kxdfhei1' USING DFHEIV0,
 19148           DFHEIV1,
 19149           WS-DLO-VALID-STATE-CODE,
 19150           DLO022-COMM-LENGTH,
 19151           DFHEIV99,
 19152           DFHEIV99,
 19153           DFHEIV99,
 19154           DFHEIV99
 19155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19156
 19157
 19158 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 353
* EL050.cbl
 19159     EXIT.
 19160
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 354
* EL050.cbl
 19162
 19163 7800-REWRITE-CERT.
 19164******************************************************************
 19165*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19166*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19167******************************************************************
 19168
 19169     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19170        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19171        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19172        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19173
 19174* EXEC CICS REWRITE
 19175*                  DATASET (CERT-ID)
 19176*                  FROM    (CERTIFICATE-MASTER)
 19177*              END-EXEC
 19178     MOVE LENGTH OF
 19179      CERTIFICATE-MASTER
 19180       TO DFHEIV11
 19181*    MOVE '&& L                  %   #00018616' TO DFHEIV0
 19182     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19183     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19184     MOVE X'2020233030303138363136' TO DFHEIV0(25:11)
 19185     CALL 'kxdfhei1' USING DFHEIV0,
 19186           CERT-ID,
 19187           CERTIFICATE-MASTER,
 19188           DFHEIV11,
 19189           DFHEIV99
 19190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19191        GO TO 7800-EXIT.
 19192
 19193       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19194       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19195
 19196 7800-EXIT.
 19197      EXIT.
 19198
 19199 7900-DELETE-CERT.
 19200
 19201* EXEC CICS DELETE
 19202*        DATASET (CERT-ID)
 19203*    END-EXEC.
 19204*    MOVE '&(                    &   #00018629' TO DFHEIV0
 19205     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19206     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19207     MOVE X'2020233030303138363239' TO DFHEIV0(25:11)
 19208     CALL 'kxdfhei1' USING DFHEIV0,
 19209           CERT-ID,
 19210           DFHEIV99,
 19211           DFHEIV99,
 19212           DFHEIV99,
 19213           DFHEIV99
 19214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19215
 19216
 19217 7900-EXIT.
 19218     EXIT.
 19219
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 355
* EL050.cbl
 19220 8000-WRITE-CERT.
 19221
 19222* EXEC CICS HANDLE CONDITION
 19223*        DUPKEY    (8000-FREE-MAIN)
 19224*    END-EXEC.
 19225*    MOVE '"$$                   ! + #00018637' TO DFHEIV0
 19226     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19227     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19228     MOVE X'2B20233030303138363337' TO DFHEIV0(25:11)
 19229     CALL 'kxdfhei1' USING DFHEIV0
 19230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19231
 19232
 19233
 19234* EXEC CICS WRITE
 19235*        DATASET     (CERT-ID)
 19236*        FROM        (CERTIFICATE-MASTER)
 19237*        RIDFLD      (ELCERT-KEY)
 19238*    END-EXEC.
 19239     MOVE LENGTH OF
 19240      CERTIFICATE-MASTER
 19241       TO DFHEIV11
 19242*    MOVE '&$ L                  ''   #00018641' TO DFHEIV0
 19243     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19244     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19245     MOVE X'2020233030303138363431' TO DFHEIV0(25:11)
 19246     CALL 'kxdfhei1' USING DFHEIV0,
 19247           CERT-ID,
 19248           CERTIFICATE-MASTER,
 19249           DFHEIV11,
 19250           ELCERT-KEY,
 19251           DFHEIV99,
 19252           DFHEIV99
 19253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19254
 19255
 19256 8000-FREE-MAIN.
 19257
 19258 8000-EXIT.
 19259      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 356
* EL050.cbl
 19261
 19262 8100-READ-ERPNDM.
 19263
 19264* EXEC CICS HANDLE CONDITION
 19265*         NOTFND     (8100-NOTFND)
 19266*         ENDFILE    (8100-NOTFND)
 19267*    END-EXEC.
 19268*    MOVE '"$I''                  ! , #00018654' TO DFHEIV0
 19269     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19270     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19271     MOVE X'2C20233030303138363534' TO DFHEIV0(25:11)
 19272     CALL 'kxdfhei1' USING DFHEIV0
 19273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19274
 19275
 19276     MOVE SPACES                 TO ERPNDM-FOUND.
 19277     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19278
 19279
 19280* EXEC CICS READ
 19281*         DATASET   (FILE-ERPNDM)
 19282*         RIDFLD    (PM-CONTROL-PRIMARY)
 19283*         INTO      (PENDING-MAILING-DATA)
 19284*    END-EXEC.
 19285     MOVE LENGTH OF
 19286      PENDING-MAILING-DATA
 19287       TO DFHEIV11
 19288*    MOVE '&"IL       E          (   #00018662' TO DFHEIV0
 19289     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19290     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19291     MOVE X'2020233030303138363632' TO DFHEIV0(25:11)
 19292     CALL 'kxdfhei1' USING DFHEIV0,
 19293           FILE-ERPNDM,
 19294           PENDING-MAILING-DATA,
 19295           DFHEIV11,
 19296           PM-CONTROL-PRIMARY,
 19297           DFHEIV99,
 19298           DFHEIV99,
 19299           DFHEIV99
 19300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19301
 19302
 19303     GO TO 8100-EXIT.
 19304
 19305 8100-NOTFND.
 19306
 19307     MOVE 'X'                    TO ERPNDM-FOUND.
 19308     MOVE ER-2694                TO WS-ERROR.
 19309     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19310     MOVE ER-2883                TO WS-ERROR
 19311     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19312     .
 19313 8100-EXIT.
 19314     EXIT.
 19315
 19316 8110-READ-ERMAIL.
 19317
 19318* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 357
* EL050.cbl
 19319*         NOTFND     (8110-NOTFND)
 19320*         ENDFILE    (8110-NOTFND)
 19321*    END-EXEC.
 19322*    MOVE '"$I''                  ! - #00018682' TO DFHEIV0
 19323     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19324     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19325     MOVE X'2D20233030303138363832' TO DFHEIV0(25:11)
 19326     CALL 'kxdfhei1' USING DFHEIV0
 19327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19328
 19329
 19330     MOVE SPACES                 TO ERMAIL-FOUND.
 19331     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19332     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19333     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19334     MOVE PB-SV-STATE            TO MA-STATE.
 19335
 19336
 19337* EXEC CICS READ
 19338*         UPDATE
 19339*         DATASET   (FILE-ERMAIL)
 19340*         RIDFLD    (MA-CONTROL-PRIMARY)
 19341*         INTO      (MAILING-DATA)
 19342*    END-EXEC.
 19343     MOVE LENGTH OF
 19344      MAILING-DATA
 19345       TO DFHEIV11
 19346*    MOVE '&"IL       EU         (   #00018693' TO DFHEIV0
 19347     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19348     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19349     MOVE X'2020233030303138363933' TO DFHEIV0(25:11)
 19350     CALL 'kxdfhei1' USING DFHEIV0,
 19351           FILE-ERMAIL,
 19352           MAILING-DATA,
 19353           DFHEIV11,
 19354           MA-CONTROL-PRIMARY,
 19355           DFHEIV99,
 19356           DFHEIV99,
 19357           DFHEIV99
 19358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19359
 19360
 19361     GO TO 8110-EXIT.
 19362
 19363 8110-NOTFND.
 19364     MOVE 'X'                    TO ERMAIL-FOUND.
 19365
 19366 8110-EXIT.
 19367     EXIT.
 19368
 19369 8120-REWRITE-ERMAIL.
 19370
 19371* EXEC CICS REWRITE
 19372*         DATASET    (FILE-ERMAIL)
 19373*         FROM       (MAILING-DATA)
 19374*    END-EXEC.
 19375     MOVE LENGTH OF
 19376      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 358
* EL050.cbl
 19377       TO DFHEIV11
 19378*    MOVE '&& L                  %   #00018709' TO DFHEIV0
 19379     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19380     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19381     MOVE X'2020233030303138373039' TO DFHEIV0(25:11)
 19382     CALL 'kxdfhei1' USING DFHEIV0,
 19383           FILE-ERMAIL,
 19384           MAILING-DATA,
 19385           DFHEIV11,
 19386           DFHEIV99
 19387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19388
 19389
 19390 8120-EXIT.
 19391     EXIT.
 19392
 19393 8130-WRITE-ERMAIL.
 19394
 19395* EXEC CICS HANDLE CONDITION
 19396*         DUPKEY   (8130-EXIT)
 19397*    END-EXEC.
 19398*    MOVE '"$$                   ! . #00018718' TO DFHEIV0
 19399     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19400     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19401     MOVE X'2E20233030303138373138' TO DFHEIV0(25:11)
 19402     CALL 'kxdfhei1' USING DFHEIV0
 19403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19404
 19405
 19406
 19407* EXEC CICS WRITE
 19408*         DATASET     (FILE-ERMAIL)
 19409*         RIDFLD      (MA-CONTROL-PRIMARY)
 19410*         FROM        (MAILING-DATA)
 19411*    END-EXEC.
 19412     MOVE LENGTH OF
 19413      MAILING-DATA
 19414       TO DFHEIV11
 19415*    MOVE '&$ L                  ''   #00018722' TO DFHEIV0
 19416     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19417     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19418     MOVE X'2020233030303138373232' TO DFHEIV0(25:11)
 19419     CALL 'kxdfhei1' USING DFHEIV0,
 19420           FILE-ERMAIL,
 19421           MAILING-DATA,
 19422           DFHEIV11,
 19423           MA-CONTROL-PRIMARY,
 19424           DFHEIV99,
 19425           DFHEIV99
 19426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19427
 19428
 19429 8130-EXIT.
 19430     EXIT.
 19431
 19432 8140-UNLOCK-ERMAIL.
 19433
 19434* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 359
* EL050.cbl
 19435*         DATASET   (FILE-ERMAIL)
 19436*    END-EXEC.
 19437*    MOVE '&*                    #   #00018732' TO DFHEIV0
 19438     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19439     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19440     MOVE X'2020233030303138373332' TO DFHEIV0(25:11)
 19441     CALL 'kxdfhei1' USING DFHEIV0,
 19442           FILE-ERMAIL,
 19443           DFHEIV99
 19444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19445
 19446
 19447 8140-EXIT.
 19448     EXIT.
 19449
 19450 8180-UPDATE-VIN-NUMBER.
 19451
 19452* EXEC CICS HANDLE CONDITION
 19453*        NOTFND   (8180-NOTFND)
 19454*    END-EXEC.
 19455*    MOVE '"$I                   ! / #00018740' TO DFHEIV0
 19456     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19457     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19458     MOVE X'2F20233030303138373430' TO DFHEIV0(25:11)
 19459     CALL 'kxdfhei1' USING DFHEIV0
 19460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19461
 19462
 19463     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19464     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19465
 19466
 19467* EXEC CICS READ
 19468*        UPDATE
 19469*        DATASET  (CRTT-ID)
 19470*        RIDFLD   (WS-ELCRTT-KEY)
 19471*        INTO     (CERTIFICATE-TRAILERS)
 19472*    END-EXEC.
 19473     MOVE LENGTH OF
 19474      CERTIFICATE-TRAILERS
 19475       TO DFHEIV11
 19476*    MOVE '&"IL       EU         (   #00018747' TO DFHEIV0
 19477     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19478     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19479     MOVE X'2020233030303138373437' TO DFHEIV0(25:11)
 19480     CALL 'kxdfhei1' USING DFHEIV0,
 19481           CRTT-ID,
 19482           CERTIFICATE-TRAILERS,
 19483           DFHEIV11,
 19484           WS-ELCRTT-KEY,
 19485           DFHEIV99,
 19486           DFHEIV99,
 19487           DFHEIV99
 19488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19489
 19490
 19491     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19492         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 360
* EL050.cbl
 19493
 19494* EXEC CICS REWRITE
 19495*           DATASET  (CRTT-ID)
 19496*           FROM     (CERTIFICATE-TRAILERS)
 19497*        END-EXEC
 19498     MOVE LENGTH OF
 19499      CERTIFICATE-TRAILERS
 19500       TO DFHEIV11
 19501*    MOVE '&& L                  %   #00018756' TO DFHEIV0
 19502     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19503     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19504     MOVE X'2020233030303138373536' TO DFHEIV0(25:11)
 19505     CALL 'kxdfhei1' USING DFHEIV0,
 19506           CRTT-ID,
 19507           CERTIFICATE-TRAILERS,
 19508           DFHEIV11,
 19509           DFHEIV99
 19510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19511     ELSE
 19512
 19513* EXEC CICS UNLOCK
 19514*          DATASET  (CRTT-ID)
 19515*       END-EXEC
 19516*    MOVE '&*                    #   #00018761' TO DFHEIV0
 19517     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19518     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19519     MOVE X'2020233030303138373631' TO DFHEIV0(25:11)
 19520     CALL 'kxdfhei1' USING DFHEIV0,
 19521           CRTT-ID,
 19522           DFHEIV99
 19523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19524     END-IF.
 19525
 19526     GO TO 8180-EXIT.
 19527
 19528 8180-NOTFND.
 19529
 19530     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19531     MOVE 'CS'         TO CS-RECORD-ID.
 19532     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19533     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19534     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19535     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19536
 19537* EXEC CICS WRITE
 19538*       DATASET  (CRTT-ID)
 19539*       RIDFLD   (WS-ELCRTT-KEY)
 19540*       FROM     (CERTIFICATE-TRAILERS)
 19541*    END-EXEC.
 19542     MOVE LENGTH OF
 19543      CERTIFICATE-TRAILERS
 19544       TO DFHEIV11
 19545*    MOVE '&$ L                  ''   #00018776' TO DFHEIV0
 19546     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19547     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19548     MOVE X'2020233030303138373736' TO DFHEIV0(25:11)
 19549     CALL 'kxdfhei1' USING DFHEIV0,
 19550           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 361
* EL050.cbl
 19551           CERTIFICATE-TRAILERS,
 19552           DFHEIV11,
 19553           WS-ELCRTT-KEY,
 19554           DFHEIV99,
 19555           DFHEIV99
 19556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19557
 19558
 19559 8180-EXIT.
 19560     EXIT.
 19561
 19562 8190-UPDATE-REFUND-CLAIM-FLAG.
 19563
 19564* EXEC CICS HANDLE CONDITION
 19565*        NOTFND   (8190-NOTFND)
 19566*    END-EXEC.
 19567*    MOVE '"$I                   ! 0 #00018786' TO DFHEIV0
 19568     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19569     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19570     MOVE X'3020233030303138373836' TO DFHEIV0(25:11)
 19571     CALL 'kxdfhei1' USING DFHEIV0
 19572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19573
 19574
 19575     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19576     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19577
 19578
 19579* EXEC CICS READ
 19580*        UPDATE
 19581*        DATASET  (CRTT-ID)
 19582*        RIDFLD   (WS-ELCRTT-KEY)
 19583*        INTO     (CERTIFICATE-TRAILERS)
 19584*    END-EXEC.
 19585     MOVE LENGTH OF
 19586      CERTIFICATE-TRAILERS
 19587       TO DFHEIV11
 19588*    MOVE '&"IL       EU         (   #00018793' TO DFHEIV0
 19589     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19590     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19591     MOVE X'2020233030303138373933' TO DFHEIV0(25:11)
 19592     CALL 'kxdfhei1' USING DFHEIV0,
 19593           CRTT-ID,
 19594           CERTIFICATE-TRAILERS,
 19595           DFHEIV11,
 19596           WS-ELCRTT-KEY,
 19597           DFHEIV99,
 19598           DFHEIV99,
 19599           DFHEIV99
 19600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19601
 19602
 19603     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19604
 19605* EXEC CICS REWRITE
 19606*       DATASET  (CRTT-ID)
 19607*       FROM     (CERTIFICATE-TRAILERS)
 19608*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 362
* EL050.cbl
 19609     MOVE LENGTH OF
 19610      CERTIFICATE-TRAILERS
 19611       TO DFHEIV11
 19612*    MOVE '&& L                  %   #00018801' TO DFHEIV0
 19613     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19614     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19615     MOVE X'2020233030303138383031' TO DFHEIV0(25:11)
 19616     CALL 'kxdfhei1' USING DFHEIV0,
 19617           CRTT-ID,
 19618           CERTIFICATE-TRAILERS,
 19619           DFHEIV11,
 19620           DFHEIV99
 19621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19622
 19623
 19624     GO TO 8190-EXIT.
 19625
 19626 8190-NOTFND.
 19627
 19628     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19629     MOVE 'CS'         TO CS-RECORD-ID.
 19630     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19631     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19632     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19633     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19634
 19635* EXEC CICS WRITE
 19636*       DATASET  (CRTT-ID)
 19637*       RIDFLD   (WS-ELCRTT-KEY)
 19638*       FROM     (CERTIFICATE-TRAILERS)
 19639*    END-EXEC.
 19640     MOVE LENGTH OF
 19641      CERTIFICATE-TRAILERS
 19642       TO DFHEIV11
 19643*    MOVE '&$ L                  ''   #00018816' TO DFHEIV0
 19644     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19645     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19646     MOVE X'2020233030303138383136' TO DFHEIV0(25:11)
 19647     CALL 'kxdfhei1' USING DFHEIV0,
 19648           CRTT-ID,
 19649           CERTIFICATE-TRAILERS,
 19650           DFHEIV11,
 19651           WS-ELCRTT-KEY,
 19652           DFHEIV99,
 19653           DFHEIV99
 19654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19655
 19656
 19657 8190-EXIT.
 19658     EXIT.
 19659
 19660 8195-UPDATE-AGE-FLAGS.
 19661
 19662* EXEC CICS HANDLE CONDITION
 19663*        NOTFND   (8195-NOTFND)
 19664*    END-EXEC.
 19665*    MOVE '"$I                   ! 1 #00018826' TO DFHEIV0
 19666     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 363
* EL050.cbl
 19667     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19668     MOVE X'3120233030303138383236' TO DFHEIV0(25:11)
 19669     CALL 'kxdfhei1' USING DFHEIV0
 19670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19671
 19672
 19673     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19674     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19675
 19676
 19677* EXEC CICS READ
 19678*        UPDATE
 19679*        DATASET  (CRTT-ID)
 19680*        RIDFLD   (WS-ELCRTT-KEY)
 19681*        INTO     (CERTIFICATE-TRAILERS)
 19682*    END-EXEC.
 19683     MOVE LENGTH OF
 19684      CERTIFICATE-TRAILERS
 19685       TO DFHEIV11
 19686*    MOVE '&"IL       EU         (   #00018833' TO DFHEIV0
 19687     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19688     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19689     MOVE X'2020233030303138383333' TO DFHEIV0(25:11)
 19690     CALL 'kxdfhei1' USING DFHEIV0,
 19691           CRTT-ID,
 19692           CERTIFICATE-TRAILERS,
 19693           DFHEIV11,
 19694           WS-ELCRTT-KEY,
 19695           DFHEIV99,
 19696           DFHEIV99,
 19697           DFHEIV99
 19698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19699
 19700
 19701     IF WS-INS-AGE-SET = 'Y'
 19702        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 19703     END-IF
 19704     IF WS-JNT-AGE-SET = 'Y'
 19705        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 19706     END-IF
 19707
 19708
 19709* EXEC CICS REWRITE
 19710*       DATASET  (CRTT-ID)
 19711*       FROM     (CERTIFICATE-TRAILERS)
 19712*    END-EXEC.
 19713     MOVE LENGTH OF
 19714      CERTIFICATE-TRAILERS
 19715       TO DFHEIV11
 19716*    MOVE '&& L                  %   #00018847' TO DFHEIV0
 19717     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19718     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19719     MOVE X'2020233030303138383437' TO DFHEIV0(25:11)
 19720     CALL 'kxdfhei1' USING DFHEIV0,
 19721           CRTT-ID,
 19722           CERTIFICATE-TRAILERS,
 19723           DFHEIV11,
 19724           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 364
* EL050.cbl
 19725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19726
 19727
 19728     GO TO 8195-EXIT.
 19729
 19730 8195-NOTFND.
 19731
 19732     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19733     MOVE 'CS'         TO CS-RECORD-ID.
 19734     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19735     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19736     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19737     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 19738     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 19739
 19740* EXEC CICS WRITE
 19741*       DATASET  (CRTT-ID)
 19742*       RIDFLD   (WS-ELCRTT-KEY)
 19743*       FROM     (CERTIFICATE-TRAILERS)
 19744*    END-EXEC.
 19745     MOVE LENGTH OF
 19746      CERTIFICATE-TRAILERS
 19747       TO DFHEIV11
 19748*    MOVE '&$ L                  ''   #00018863' TO DFHEIV0
 19749     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19750     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19751     MOVE X'2020233030303138383633' TO DFHEIV0(25:11)
 19752     CALL 'kxdfhei1' USING DFHEIV0,
 19753           CRTT-ID,
 19754           CERTIFICATE-TRAILERS,
 19755           DFHEIV11,
 19756           WS-ELCRTT-KEY,
 19757           DFHEIV99,
 19758           DFHEIV99
 19759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19760
 19761
 19762 8195-EXIT.
 19763     EXIT.
 19764
 19765 8200-READ-REIN-TABLE.
 19766
 19767* EXEC CICS HANDLE CONDITION
 19768*         NOTFND   (8200-NOTFND)
 19769*    END-EXEC.
 19770*    MOVE '"$I                   ! 2 #00018873' TO DFHEIV0
 19771     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19772     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19773     MOVE X'3220233030303138383733' TO DFHEIV0(25:11)
 19774     CALL 'kxdfhei1' USING DFHEIV0
 19775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19776
 19777
 19778
 19779* EXEC CICS READ
 19780*        DATASET     (REIN-ID)
 19781*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19782*        RIDFLD      (ERREIN-KEY)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 365
* EL050.cbl
 19783*    END-EXEC.
 19784*    MOVE '&"S        E          (   #00018877' TO DFHEIV0
 19785     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19786     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19787     MOVE X'2020233030303138383737' TO DFHEIV0(25:11)
 19788     CALL 'kxdfhei1' USING DFHEIV0,
 19789           REIN-ID,
 19790           DFHEIV20,
 19791           DFHEIV99,
 19792           ERREIN-KEY,
 19793           DFHEIV99,
 19794           DFHEIV99,
 19795           DFHEIV99
 19796     SET ADDRESS OF REINSURANCE-RECORD TO
 19797         DFHEIV20
 19798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19799
 19800
 19801     GO TO 8200-EXIT.
 19802
 19803 8200-NOTFND.
 19804     MOVE 'N'             TO WS-REIN-READ-SW.
 19805
 19806 8200-EXIT.
 19807      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 366
* EL050.cbl
 19809
 19810 8300-READ-CTBL-TABLE.
 19811
 19812* EXEC CICS HANDLE CONDITION
 19813*        NOTFND    (8300-NOTFND)
 19814*        DISABLED  (8300-ERRESS-PROBLEM)
 19815*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19816*        ENDFILE   (8300-NOTFND)
 19817*    END-EXEC.
 19818*    MOVE '"$IcJ''                ! 3 #00018893' TO DFHEIV0
 19819     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19820     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19821     MOVE X'3320233030303138383933' TO DFHEIV0(25:11)
 19822     CALL 'kxdfhei1' USING DFHEIV0
 19823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19824
 19825
 19826
 19827* EXEC CICS READ
 19828*        DATASET     (CTBL-ID)
 19829*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19830*        RIDFLD      (ERCTBL-KEY)
 19831*    END-EXEC.
 19832*    MOVE '&"S        E          (   #00018900' TO DFHEIV0
 19833     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19834     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19835     MOVE X'2020233030303138393030' TO DFHEIV0(25:11)
 19836     CALL 'kxdfhei1' USING DFHEIV0,
 19837           CTBL-ID,
 19838           DFHEIV20,
 19839           DFHEIV99,
 19840           ERCTBL-KEY,
 19841           DFHEIV99,
 19842           DFHEIV99,
 19843           DFHEIV99
 19844     SET ADDRESS OF COMM-TABLE-RECORD TO
 19845         DFHEIV20
 19846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19847
 19848
 19849     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19850
 19851     GO TO 8300-EXIT.
 19852
 19853 8300-NOTFND.
 19854
 19855     IF CTBL-SW = '0530'
 19856         MOVE 'AA'                     TO WS-AH-COMP-CD
 19857         MOVE '0550'                   TO CTBL-SW
 19858         MOVE '1'                      TO WS-CTBL-READ-SW
 19859         GO TO 8300-EXIT.
 19860
 19861     IF CTBL-SW = '0540'
 19862         MOVE 'AA'                     TO WS-LF-COMP-CD
 19863         MOVE '0550'                   TO CTBL-SW
 19864         MOVE '1'                      TO WS-CTBL-READ-SW
 19865         GO TO 8300-EXIT.
 19866
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 367
* EL050.cbl
 19867     IF CTBL-SW = '0550'
 19868         MOVE '2'                      TO WS-CTBL-READ-SW
 19869         GO TO 8300-EXIT.
 19870
 19871     GO TO 8300-EXIT.
 19872
 19873 8300-ERRESS-PROBLEM.
 19874
 19875      MOVE ER-8050              TO WS-ERROR.
 19876      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19877
 19878     GO TO 8300-EXIT.
 19879
 19880 8300-EXIT.
 19881      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 368
* EL050.cbl
 19883
 19884
 19885 8400-GETMAIN-ERFORM.
 19886
 19887
 19888* EXEC CICS   GETMAIN
 19889*        LENGTH  (500)
 19890*        SET     (ADDRESS OF FORM-MASTER)
 19891*    END-EXEC.
 19892     MOVE 500
 19893       TO DFHEIV11
 19894*    MOVE '," L                  $   #00018944' TO DFHEIV0
 19895     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19896     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19897     MOVE X'2020233030303138393434' TO DFHEIV0(25:11)
 19898     CALL 'kxdfhei1' USING DFHEIV0,
 19899           DFHEIV20,
 19900           DFHEIV11,
 19901           DFHEIV99
 19902     SET ADDRESS OF FORM-MASTER TO
 19903         DFHEIV20
 19904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19905
 19906
 19907     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 19908
 19909 8400-EXIT.
 19910      EXIT.
 19911
 19912 8450-READ-FORM-MASTER.
 19913
 19914
 19915* EXEC CICS  HANDLE CONDITION
 19916*        NOTFND   (8450-FORM-NOT-FOUND)
 19917*        ENDFILE  (8450-FORM-NOT-FOUND)
 19918*    END-EXEC.
 19919*    MOVE '"$I''                  ! 4 #00018956' TO DFHEIV0
 19920     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19921     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19922     MOVE X'3420233030303138393536' TO DFHEIV0(25:11)
 19923     CALL 'kxdfhei1' USING DFHEIV0
 19924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19925
 19926
 19927
 19928* EXEC CICS   READ
 19929*        DATASET   (FORM-ID)
 19930*        RIDFLD    (ERFORM-KEY)
 19931*        INTO      (FORM-MASTER)
 19932*        GTEQ
 19933*    END-EXEC.
 19934     MOVE LENGTH OF
 19935      FORM-MASTER
 19936       TO DFHEIV11
 19937*    MOVE '&"IL       G          (   #00018961' TO DFHEIV0
 19938     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 19939     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19940     MOVE X'2020233030303138393631' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 369
* EL050.cbl
 19941     CALL 'kxdfhei1' USING DFHEIV0,
 19942           FORM-ID,
 19943           FORM-MASTER,
 19944           DFHEIV11,
 19945           ERFORM-KEY,
 19946           DFHEIV99,
 19947           DFHEIV99,
 19948           DFHEIV99
 19949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19950
 19951
 19952     MOVE  'Y'           TO  FORM-MASTER-SW.
 19953
 19954     GO TO  8450-EXIT.
 19955
 19956 8450-FORM-NOT-FOUND.
 19957
 19958     MOVE  'N'           TO  FORM-MASTER-SW.
 19959
 19960 8450-EXIT.
 19961      EXIT.
 19962
 19963 8500-DATE-CONVERT.
 19964
 19965* EXEC CICS LINK
 19966*        PROGRAM    ('ELDATCV')
 19967*        COMMAREA   (DATE-CONVERSION-DATA)
 19968*        LENGTH     (DC-COMM-LENGTH)
 19969*    END-EXEC.
 19970     MOVE 'ELDATCV' TO DFHEIV1
 19971*    MOVE '."C                   (   #00018980' TO DFHEIV0
 19972     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19973     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19974     MOVE X'2020233030303138393830' TO DFHEIV0(25:11)
 19975     CALL 'kxdfhei1' USING DFHEIV0,
 19976           DFHEIV1,
 19977           DATE-CONVERSION-DATA,
 19978           DC-COMM-LENGTH,
 19979           DFHEIV99,
 19980           DFHEIV99,
 19981           DFHEIV99,
 19982           DFHEIV99
 19983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19984
 19985
 19986 8500-EXIT.
 19987     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 370
* EL050.cbl
 19989
 19990 8555-RELOAD-CONTROL-FILE.
 19991     CONTINUE.
 19992
 19993 8555-EXIT.
 19994     EXIT.
 19995
 19996 8557-GETMAIN-ERPLAN.
 19997
 19998
 19999* EXEC CICS GETMAIN
 20000*        LENGTH    (840)
 20001*        SET       (ADDRESS OF PLAN-RECORDS)
 20002*    END-EXEC.
 20003     MOVE 840
 20004       TO DFHEIV11
 20005*    MOVE '," L                  $   #00018998' TO DFHEIV0
 20006     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20007     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20008     MOVE X'2020233030303138393938' TO DFHEIV0(25:11)
 20009     CALL 'kxdfhei1' USING DFHEIV0,
 20010           DFHEIV20,
 20011           DFHEIV11,
 20012           DFHEIV99
 20013     SET ADDRESS OF PLAN-RECORDS TO
 20014         DFHEIV20
 20015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20016
 20017
 20018     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20019
 20020 8557-EXIT.
 20021     EXIT.
 20022
 20023 8560-GETMAIN.
 20024
 20025* EXEC CICS GETMAIN
 20026*        LENGTH    (2000)
 20027*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20028*    END-EXEC.
 20029     MOVE 2000
 20030       TO DFHEIV11
 20031*    MOVE '," L                  $   #00019009' TO DFHEIV0
 20032     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20033     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20034     MOVE X'2020233030303139303039' TO DFHEIV0(25:11)
 20035     CALL 'kxdfhei1' USING DFHEIV0,
 20036           DFHEIV20,
 20037           DFHEIV11,
 20038           DFHEIV99
 20039     SET ADDRESS OF ACCOUNT-MASTER TO
 20040         DFHEIV20
 20041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20042
 20043
 20044     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20045
 20046 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 371
* EL050.cbl
 20047     EXIT.
 20048
 20049 8570-START-ACCOUNT-MASTER.
 20050
 20051* EXEC CICS HANDLE CONDITION
 20052*        NOTFND    (0199-ACCT-NOT-FOUND)
 20053*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20054*    END-EXEC.
 20055*    MOVE '"$I''                  ! 5 #00019020' TO DFHEIV0
 20056     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20057     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20058     MOVE X'3520233030303139303230' TO DFHEIV0(25:11)
 20059     CALL 'kxdfhei1' USING DFHEIV0
 20060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20061
 20062
 20063
 20064* EXEC CICS STARTBR
 20065*        DATASET    (ACCT-ID)
 20066*        RIDFLD     (ERACCT-KEY)
 20067*        GTEQ
 20068*    END-EXEC.
 20069     MOVE 0
 20070       TO DFHEIV11
 20071*    MOVE '&,         G          &   #00019025' TO DFHEIV0
 20072     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20073     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20074     MOVE X'2020233030303139303235' TO DFHEIV0(25:11)
 20075     CALL 'kxdfhei1' USING DFHEIV0,
 20076           ACCT-ID,
 20077           ERACCT-KEY,
 20078           DFHEIV99,
 20079           DFHEIV11,
 20080           DFHEIV99
 20081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20082
 20083
 20084 8570-EXIT.
 20085     EXIT.
 20086
 20087 8580-READ-ACCOUNT-MASTER.
 20088
 20089* EXEC CICS HANDLE CONDITION
 20090*        NOTFND    (0199-ACCT-NOT-FOUND)
 20091*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20092*    END-EXEC.
 20093*    MOVE '"$I''                  ! 6 #00019035' TO DFHEIV0
 20094     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20095     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20096     MOVE X'3620233030303139303335' TO DFHEIV0(25:11)
 20097     CALL 'kxdfhei1' USING DFHEIV0
 20098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20099
 20100
 20101
 20102* EXEC CICS READNEXT
 20103*        DATASET     (ACCT-ID)
 20104*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 372
* EL050.cbl
 20105*        RIDFLD      (ERACCT-KEY)
 20106*    END-EXEC.
 20107     MOVE LENGTH OF
 20108      ACCOUNT-MASTER
 20109       TO DFHEIV12
 20110     MOVE 0
 20111       TO DFHEIV11
 20112*    MOVE '&.IL                  )   #00019040' TO DFHEIV0
 20113     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20114     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20115     MOVE X'2020233030303139303430' TO DFHEIV0(25:11)
 20116     CALL 'kxdfhei1' USING DFHEIV0,
 20117           ACCT-ID,
 20118           ACCOUNT-MASTER,
 20119           DFHEIV12,
 20120           ERACCT-KEY,
 20121           DFHEIV99,
 20122           DFHEIV11,
 20123           DFHEIV99,
 20124           DFHEIV99
 20125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20126
 20127
 20128 8580-EXIT.
 20129     EXIT.
 20130
 20131 8582-READ-COMPENSATION-MASTER.
 20132
 20133* EXEC CICS HANDLE CONDITION
 20134*        NOTFND    (8582-COMP-NOT-FOUND)
 20135*        ENDFILE   (8582-COMP-NOT-FOUND)
 20136*    END-EXEC.
 20137*    MOVE '"$I''                  ! 7 #00019050' TO DFHEIV0
 20138     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20139     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20140     MOVE X'3720233030303139303530' TO DFHEIV0(25:11)
 20141     CALL 'kxdfhei1' USING DFHEIV0
 20142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20143
 20144
 20145
 20146* EXEC CICS READ
 20147*        DATASET     (COMP-ID)
 20148*        INTO        (COMPENSATION-MASTER)
 20149*        RIDFLD      (ERCOMP-KEY)
 20150*    END-EXEC.
 20151     MOVE LENGTH OF
 20152      COMPENSATION-MASTER
 20153       TO DFHEIV11
 20154*    MOVE '&"IL       E          (   #00019055' TO DFHEIV0
 20155     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20156     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20157     MOVE X'2020233030303139303535' TO DFHEIV0(25:11)
 20158     CALL 'kxdfhei1' USING DFHEIV0,
 20159           COMP-ID,
 20160           COMPENSATION-MASTER,
 20161           DFHEIV11,
 20162           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 373
* EL050.cbl
 20163           DFHEIV99,
 20164           DFHEIV99,
 20165           DFHEIV99
 20166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20167
 20168
 20169     MOVE 'Y'                    TO COMP-MASTER-SW
 20170
 20171     GO TO 8582-EXIT
 20172     .
 20173 8582-COMP-NOT-FOUND.
 20174
 20175     MOVE 'N'                    TO COMP-MASTER-SW.
 20176
 20177 8582-EXIT.
 20178     EXIT.
 20179
 20180 8583-READ-ERAGTC.
 20181
 20182* EXEC CICS HANDLE CONDITION
 20183*        NOTFND    (8583-AGTC-NOT-FOUND)
 20184*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20185*    END-EXEC.
 20186*    MOVE '"$I''                  ! 8 #00019073' TO DFHEIV0
 20187     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20188     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20189     MOVE X'3820233030303139303733' TO DFHEIV0(25:11)
 20190     CALL 'kxdfhei1' USING DFHEIV0
 20191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20192
 20193
 20194
 20195* EXEC CICS STARTBR
 20196*        DATASET    (AGTC-ID)
 20197*        RIDFLD     (ERAGTC-KEY)
 20198*        GTEQ
 20199*    END-EXEC.
 20200     MOVE 0
 20201       TO DFHEIV11
 20202*    MOVE '&,         G          &   #00019078' TO DFHEIV0
 20203     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20204     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20205     MOVE X'2020233030303139303738' TO DFHEIV0(25:11)
 20206     CALL 'kxdfhei1' USING DFHEIV0,
 20207           AGTC-ID,
 20208           ERAGTC-KEY,
 20209           DFHEIV99,
 20210           DFHEIV11,
 20211           DFHEIV99
 20212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20213
 20214
 20215 8583-READ-ERAGTC-NEXT.
 20216
 20217* EXEC CICS READNEXT
 20218*        DATASET     (AGTC-ID)
 20219*        INTO        (AGENT-COMMISSIONS)
 20220*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 374
* EL050.cbl
 20221*    END-EXEC.
 20222     MOVE LENGTH OF
 20223      AGENT-COMMISSIONS
 20224       TO DFHEIV12
 20225     MOVE 0
 20226       TO DFHEIV11
 20227*    MOVE '&.IL                  )   #00019085' TO DFHEIV0
 20228     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20229     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20230     MOVE X'2020233030303139303835' TO DFHEIV0(25:11)
 20231     CALL 'kxdfhei1' USING DFHEIV0,
 20232           AGTC-ID,
 20233           AGENT-COMMISSIONS,
 20234           DFHEIV12,
 20235           ERAGTC-KEY,
 20236           DFHEIV99,
 20237           DFHEIV11,
 20238           DFHEIV99,
 20239           DFHEIV99
 20240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20241
 20242
 20243*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20244
 20245     GO TO 8583-EXIT
 20246     .
 20247 8583-AGTC-NOT-FOUND.
 20248
 20249     MOVE 'N'                    TO AGTC-MASTER-SW.
 20250
 20251 8583-EXIT.
 20252     EXIT.
 20253
 20254 8584-READ-BANK-CROSS-REF.
 20255
 20256* EXEC CICS HANDLE CONDITION
 20257*        NOTFND    (8584-BXRF-NOT-FOUND)
 20258*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20259*    END-EXEC.
 20260*    MOVE '"$I''                  ! 9 #00019103' TO DFHEIV0
 20261     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20262     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20263     MOVE X'3920233030303139313033' TO DFHEIV0(25:11)
 20264     CALL 'kxdfhei1' USING DFHEIV0
 20265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20266
 20267
 20268
 20269* EXEC CICS READ
 20270*        DATASET     (BXRF-ID)
 20271*        INTO        (BANK-CROSS-REFERENCE)
 20272*        RIDFLD      (ERBXRF-KEY)
 20273*        LENGTH      (BXRF-REC-LENGTH)
 20274*    END-EXEC.
 20275*    MOVE '&"IL       E          (   #00019108' TO DFHEIV0
 20276     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20277     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20278     MOVE X'2020233030303139313038' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 375
* EL050.cbl
 20279     CALL 'kxdfhei1' USING DFHEIV0,
 20280           BXRF-ID,
 20281           BANK-CROSS-REFERENCE,
 20282           BXRF-REC-LENGTH,
 20283           ERBXRF-KEY,
 20284           DFHEIV99,
 20285           DFHEIV99,
 20286           DFHEIV99
 20287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20288
 20289
 20290     MOVE 'Y'                    TO BXRF-MASTER-SW
 20291
 20292     GO TO 8584-EXIT
 20293     .
 20294 8584-BXRF-NOT-FOUND.
 20295
 20296     MOVE 'N'                    TO BXRF-MASTER-SW.
 20297
 20298 8584-EXIT.
 20299     EXIT.
 20300
 20301 8585-READ-PLAN-MASTER.
 20302
 20303
 20304* EXEC CICS HANDLE CONDITION
 20305*        NOTFND    (8585-PLAN-NOT-FOUND)
 20306*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20307*    END-EXEC.
 20308*    MOVE '"$I''                  ! : #00019128' TO DFHEIV0
 20309     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20310     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20311     MOVE X'3A20233030303139313238' TO DFHEIV0(25:11)
 20312     CALL 'kxdfhei1' USING DFHEIV0
 20313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20314
 20315
 20316
 20317* EXEC CICS READ
 20318*        DATASET     (PLAN-ID)
 20319*        INTO        (PLAN-MASTER)
 20320*        RIDFLD      (ERPLAN-KEY)
 20321*    END-EXEC.
 20322     MOVE LENGTH OF
 20323      PLAN-MASTER
 20324       TO DFHEIV11
 20325*    MOVE '&"IL       E          (   #00019133' TO DFHEIV0
 20326     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20327     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20328     MOVE X'2020233030303139313333' TO DFHEIV0(25:11)
 20329     CALL 'kxdfhei1' USING DFHEIV0,
 20330           PLAN-ID,
 20331           PLAN-MASTER,
 20332           DFHEIV11,
 20333           ERPLAN-KEY,
 20334           DFHEIV99,
 20335           DFHEIV99,
 20336           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 376
* EL050.cbl
 20337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20338
 20339
 20340     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20341
 20342     GO TO 8585-EXIT.
 20343
 20344 8585-PLAN-NOT-FOUND.
 20345
 20346     MOVE 'N'                    TO PLAN-MASTER-SW.
 20347
 20348 8585-EXIT.
 20349     EXIT.
 20350
 20351 8586-READ-LOAN-OFFICER.
 20352
 20353* EXEC CICS READ
 20354*        DATASET     (LOFC-ID)
 20355*        INTO        (LOAN-OFFICER-MASTER)
 20356*        RIDFLD      (ERLOFC-KEY)
 20357*        RESP        (WS-RESPONSE)
 20358*    END-EXEC
 20359     MOVE LENGTH OF
 20360      LOAN-OFFICER-MASTER
 20361       TO DFHEIV11
 20362*    MOVE '&"IL       E          (  N#00019151' TO DFHEIV0
 20363     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20364     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20365     MOVE X'204E233030303139313531' TO DFHEIV0(25:11)
 20366     CALL 'kxdfhei1' USING DFHEIV0,
 20367           LOFC-ID,
 20368           LOAN-OFFICER-MASTER,
 20369           DFHEIV11,
 20370           ERLOFC-KEY,
 20371           DFHEIV99,
 20372           DFHEIV99,
 20373           DFHEIV99
 20374     MOVE EIBRESP  TO WS-RESPONSE
 20375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20376
 20377     IF WS-RESP-NORMAL
 20378        MOVE 'Y'                 TO LOFC-MASTER-SW
 20379     ELSE
 20380        MOVE 'N'                 TO LOFC-MASTER-SW
 20381     END-IF
 20382     .
 20383 8586-EXIT.
 20384     EXIT.
 20385 8587-START-ERPDEF.
 20386
 20387* EXEC CICS STARTBR
 20388*       DATASET   (PDEF-ID)
 20389*       RIDFLD    (ERPDEF-KEY)
 20390*       GTEQ
 20391*       RESP      (WS-RESPONSE)
 20392*    END-EXEC
 20393     MOVE 0
 20394       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 377
* EL050.cbl
 20395*    MOVE '&,         G          &  N#00019167' TO DFHEIV0
 20396     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20397     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20398     MOVE X'204E233030303139313637' TO DFHEIV0(25:11)
 20399     CALL 'kxdfhei1' USING DFHEIV0,
 20400           PDEF-ID,
 20401           ERPDEF-KEY,
 20402           DFHEIV99,
 20403           DFHEIV11,
 20404           DFHEIV99
 20405     MOVE EIBRESP  TO WS-RESPONSE
 20406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20407     IF WS-RESP-NORMAL
 20408        MOVE 'Y'                 TO PDEF-MASTER-SW
 20409     ELSE
 20410        MOVE 'N'                 TO PDEF-MASTER-SW
 20411     END-IF
 20412     .
 20413 8587-EXIT.
 20414     EXIT.
 20415 8588-READ-ERPDEF.
 20416
 20417* EXEC CICS READNEXT
 20418*       DATASET   (PDEF-ID)
 20419*       RIDFLD    (ERPDEF-KEY)
 20420*       INTO      (PRODUCT-MASTER)
 20421*       RESP      (WS-RESPONSE)
 20422*    END-EXEC
 20423     MOVE LENGTH OF
 20424      PRODUCT-MASTER
 20425       TO DFHEIV12
 20426     MOVE 0
 20427       TO DFHEIV11
 20428*    MOVE '&.IL                  )  N#00019182' TO DFHEIV0
 20429     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20430     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20431     MOVE X'204E233030303139313832' TO DFHEIV0(25:11)
 20432     CALL 'kxdfhei1' USING DFHEIV0,
 20433           PDEF-ID,
 20434           PRODUCT-MASTER,
 20435           DFHEIV12,
 20436           ERPDEF-KEY,
 20437           DFHEIV99,
 20438           DFHEIV11,
 20439           DFHEIV99,
 20440           DFHEIV99
 20441     MOVE EIBRESP  TO WS-RESPONSE
 20442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20443     IF WS-RESP-NORMAL
 20444        MOVE 'Y'                 TO PDEF-MASTER-SW
 20445     ELSE
 20446        MOVE 'N'                 TO PDEF-MASTER-SW
 20447     END-IF
 20448     .
 20449 8588-EXIT.
 20450     EXIT.
 20451 8589-ENDBR-ERPDEF.
 20452
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 378
* EL050.cbl
 20453* EXEC CICS ENDBR
 20454*       DATASET   (PDEF-ID)
 20455*    END-EXEC
 20456     MOVE 0
 20457       TO DFHEIV11
 20458*    MOVE '&2                    $   #00019197' TO DFHEIV0
 20459     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20460     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20461     MOVE X'2020233030303139313937' TO DFHEIV0(25:11)
 20462     CALL 'kxdfhei1' USING DFHEIV0,
 20463           PDEF-ID,
 20464           DFHEIV11,
 20465           DFHEIV99
 20466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20467     .
 20468 8589-EXIT.
 20469     EXIT.
 20470 8590-READ-CERT-MASTER.
 20471     IF PB-COMPANY-ID = 'UCL'
 20472         GO TO 8690-READ-CERT-MASTER-UCL.
 20473
 20474
 20475* EXEC CICS HANDLE CONDITION
 20476*         NOTFND    (0299-CERT-NOT-FOUND)
 20477*    END-EXEC.
 20478*    MOVE '"$I                   ! ; #00019207' TO DFHEIV0
 20479     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20480     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20481     MOVE X'3B20233030303139323037' TO DFHEIV0(25:11)
 20482     CALL 'kxdfhei1' USING DFHEIV0
 20483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20484
 20485
 20486
 20487* EXEC CICS READ
 20488*        DATASET     (CERT-ID)
 20489*        INTO        (CERTIFICATE-MASTER)
 20490*        RIDFLD      (ELCERT-KEY)
 20491*        UPDATE
 20492*    END-EXEC.
 20493     MOVE LENGTH OF
 20494      CERTIFICATE-MASTER
 20495       TO DFHEIV11
 20496*    MOVE '&"IL       EU         (   #00019211' TO DFHEIV0
 20497     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20498     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20499     MOVE X'2020233030303139323131' TO DFHEIV0(25:11)
 20500     CALL 'kxdfhei1' USING DFHEIV0,
 20501           CERT-ID,
 20502           CERTIFICATE-MASTER,
 20503           DFHEIV11,
 20504           ELCERT-KEY,
 20505           DFHEIV99,
 20506           DFHEIV99,
 20507           DFHEIV99
 20508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20509
 20510
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 379
* EL050.cbl
 20511 8590-EXIT.
 20512     EXIT.
 20513
 20514 8690-READ-CERT-MASTER-UCL.
 20515
 20516* EXEC CICS HANDLE CONDITION
 20517*         NOTFND    (8700-READ-CERT-MASTER)
 20518*    END-EXEC.
 20519*    MOVE '"$I                   ! < #00019222' TO DFHEIV0
 20520     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20521     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20522     MOVE X'3C20233030303139323232' TO DFHEIV0(25:11)
 20523     CALL 'kxdfhei1' USING DFHEIV0
 20524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20525
 20526
 20527 8690-READ-CERT-CONT.
 20528
 20529* EXEC CICS READ
 20530*        DATASET     (CERT-ID)
 20531*        INTO        (CERTIFICATE-MASTER)
 20532*        RIDFLD      (ELCERT-KEY)
 20533*        UPDATE
 20534*    END-EXEC.
 20535     MOVE LENGTH OF
 20536      CERTIFICATE-MASTER
 20537       TO DFHEIV11
 20538*    MOVE '&"IL       EU         (   #00019227' TO DFHEIV0
 20539     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20540     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20541     MOVE X'2020233030303139323237' TO DFHEIV0(25:11)
 20542     CALL 'kxdfhei1' USING DFHEIV0,
 20543           CERT-ID,
 20544           CERTIFICATE-MASTER,
 20545           DFHEIV11,
 20546           ELCERT-KEY,
 20547           DFHEIV99,
 20548           DFHEIV99,
 20549           DFHEIV99
 20550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20551
 20552
 20553     GO TO 8590-EXIT.
 20554
 20555 8700-READ-CERT-MASTER.
 20556     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20557     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20558
 20559* EXEC CICS HANDLE CONDITION
 20560*         DUPKEY    (8720-COMP-ACCOUNTS)
 20561*         ENDFILE   (8730-END-BROWSE)
 20562*         NOTFND    (8740-NOT-FOUND)
 20563*    END-EXEC.
 20564*    MOVE '"$$''I                 ! = #00019239' TO DFHEIV0
 20565     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20566     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20567     MOVE X'3D20233030303139323339' TO DFHEIV0(25:11)
 20568     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 380
* EL050.cbl
 20569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20570
 20571
 20572
 20573* EXEC CICS STARTBR
 20574*        DATASET     ('ELCERT5')
 20575*        RIDFLD      (ELCERT2-KEY)
 20576*        EQUAL
 20577*    END-EXEC.
 20578     MOVE 'ELCERT5' TO DFHEIV1
 20579     MOVE 0
 20580       TO DFHEIV11
 20581*    MOVE '&,         E          &   #00019245' TO DFHEIV0
 20582     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20583     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20584     MOVE X'2020233030303139323435' TO DFHEIV0(25:11)
 20585     CALL 'kxdfhei1' USING DFHEIV0,
 20586           DFHEIV1,
 20587           ELCERT2-KEY,
 20588           DFHEIV99,
 20589           DFHEIV11,
 20590           DFHEIV99
 20591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20592
 20593
 20594 8710-READ-NEXT.
 20595
 20596* EXEC CICS READNEXT
 20597*        DATASET     ('ELCERT5')
 20598*        INTO        (CERTIFICATE-MASTER)
 20599*        RIDFLD      (ELCERT2-KEY)
 20600*    END-EXEC.
 20601     MOVE LENGTH OF
 20602      CERTIFICATE-MASTER
 20603       TO DFHEIV12
 20604     MOVE 'ELCERT5' TO DFHEIV1
 20605     MOVE 0
 20606       TO DFHEIV11
 20607*    MOVE '&.IL                  )   #00019252' TO DFHEIV0
 20608     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20609     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20610     MOVE X'2020233030303139323532' TO DFHEIV0(25:11)
 20611     CALL 'kxdfhei1' USING DFHEIV0,
 20612           DFHEIV1,
 20613           CERTIFICATE-MASTER,
 20614           DFHEIV12,
 20615           ELCERT2-KEY,
 20616           DFHEIV99,
 20617           DFHEIV11,
 20618           DFHEIV99,
 20619           DFHEIV99
 20620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20621
 20622
 20623 8720-COMP-ACCOUNTS.
 20624
 20625* EXEC CICS ENTER
 20626*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 381
* EL050.cbl
 20627*         FROM (PB-C-LAST-NAME)
 20628*    END-EXEC.
 20629     MOVE 001
 20630       TO DFHEIV11
 20631*    MOVE ':$F                   %   #00019259' TO DFHEIV0
 20632     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20633     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20634     MOVE X'2020233030303139323539' TO DFHEIV0(25:11)
 20635     CALL 'kxdfhei1' USING DFHEIV0,
 20636           DFHEIV11,
 20637           PB-C-LAST-NAME,
 20638           DFHEIV99,
 20639           DFHEIV99
 20640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20641
 20642
 20643
 20644* EXEC CICS ENTER
 20645*         TRACEID (002)
 20646*         FROM (CM-INSURED-LAST-NAME)
 20647*    END-EXEC.
 20648     MOVE 002
 20649       TO DFHEIV11
 20650*    MOVE ':$F                   %   #00019264' TO DFHEIV0
 20651     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20652     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20653     MOVE X'2020233030303139323634' TO DFHEIV0(25:11)
 20654     CALL 'kxdfhei1' USING DFHEIV0,
 20655           DFHEIV11,
 20656           CM-INSURED-LAST-NAME,
 20657           DFHEIV99,
 20658           DFHEIV99
 20659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20660
 20661
 20662     IF PB-CERT-NO NOT = CM-CERT-NO
 20663         GO TO 8730-END-BROWSE.
 20664
 20665     IF PB-ACCOUNT = CM-ACCOUNT
 20666         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20667             MOVE ER-2799        TO WS-ERROR
 20668             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20669             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20670             GO TO 8730-END-BROWSE.
 20671
 20672     GO TO 8710-READ-NEXT.
 20673
 20674 8730-END-BROWSE.
 20675
 20676* EXEC CICS ENDBR
 20677*         DATASET    ('ELCERT5')
 20678*    END-EXEC.
 20679     MOVE 'ELCERT5' TO DFHEIV1
 20680     MOVE 0
 20681       TO DFHEIV11
 20682*    MOVE '&2                    $   #00019282' TO DFHEIV0
 20683     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20684     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 382
* EL050.cbl
 20685     MOVE X'2020233030303139323832' TO DFHEIV0(25:11)
 20686     CALL 'kxdfhei1' USING DFHEIV0,
 20687           DFHEIV1,
 20688           DFHEIV11,
 20689           DFHEIV99
 20690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20691
 20692
 20693 8740-NOT-FOUND.
 20694     GO TO 0299-CERT-NOT-FOUND.
 20695
 20696 8750-START-ELSTAT.
 20697
 20698* EXEC CICS STARTBR
 20699*       DATASET   (STAT-ID)
 20700*       RIDFLD    (ELSTAT-KEY)
 20701*       GTEQ
 20702*       RESP      (WS-RESPONSE)
 20703*    END-EXEC
 20704     MOVE 0
 20705       TO DFHEIV11
 20706*    MOVE '&,         G          &  N#00019290' TO DFHEIV0
 20707     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20708     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20709     MOVE X'204E233030303139323930' TO DFHEIV0(25:11)
 20710     CALL 'kxdfhei1' USING DFHEIV0,
 20711           STAT-ID,
 20712           ELSTAT-KEY,
 20713           DFHEIV99,
 20714           DFHEIV11,
 20715           DFHEIV99
 20716     MOVE EIBRESP  TO WS-RESPONSE
 20717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20718     IF WS-RESP-NORMAL
 20719        MOVE 'Y'                 TO STAT-MASTER-SW
 20720     ELSE
 20721        MOVE 'N'                 TO STAT-MASTER-SW
 20722     END-IF
 20723     .
 20724 8750-EXIT.
 20725     EXIT.
 20726 8752-READ-ELSTAT.
 20727
 20728* EXEC CICS READNEXT
 20729*       DATASET   (STAT-ID)
 20730*       RIDFLD    (ELSTAT-KEY)
 20731*       INTO      (STATE-FILE)
 20732*       RESP      (WS-RESPONSE)
 20733*    END-EXEC
 20734     MOVE LENGTH OF
 20735      STATE-FILE
 20736       TO DFHEIV12
 20737     MOVE 0
 20738       TO DFHEIV11
 20739*    MOVE '&.IL                  )  N#00019305' TO DFHEIV0
 20740     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20741     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20742     MOVE X'204E233030303139333035' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 383
* EL050.cbl
 20743     CALL 'kxdfhei1' USING DFHEIV0,
 20744           STAT-ID,
 20745           STATE-FILE,
 20746           DFHEIV12,
 20747           ELSTAT-KEY,
 20748           DFHEIV99,
 20749           DFHEIV11,
 20750           DFHEIV99,
 20751           DFHEIV99
 20752     MOVE EIBRESP  TO WS-RESPONSE
 20753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20754     IF WS-RESP-NORMAL
 20755        MOVE 'Y'                 TO STAT-MASTER-SW
 20756     ELSE
 20757        MOVE 'N'                 TO STAT-MASTER-SW
 20758     END-IF
 20759     .
 20760 8752-EXIT.
 20761     EXIT.
 20762 8800-GET-COMP-RATE.
 20763     MOVE +1 TO IB.
 20764     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20765         ADD +9 TO IB
 20766         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20767             ADD +9 TO IB
 20768             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20769                MOVE ZEROS       TO WS-WK-RATE
 20770                GO TO 8800-EXIT.
 20771
 20772     IF PB-I-AGE GREATER CT-AGE (1)
 20773         ADD +3 TO IB
 20774         IF PB-I-AGE GREATER CT-AGE (2)
 20775             ADD +3 TO IB
 20776             IF PB-I-AGE GREATER CT-AGE (3)
 20777                MOVE ZEROS       TO WS-WK-RATE
 20778                GO TO 8800-EXIT.
 20779
 20780     IF WS-WORK-TERM GREATER CT-TRM (1)
 20781         ADD +1 TO IB
 20782         IF WS-WORK-TERM GREATER CT-TRM (2)
 20783             ADD +1 TO IB
 20784             IF WS-WORK-TERM GREATER CT-TRM (3)
 20785                MOVE ZEROS       TO WS-WK-RATE
 20786                GO TO 8800-EXIT.
 20787
 20788     IF CT-RT (IB) NOT NUMERIC
 20789         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20790         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20791         GO TO 8800-GET-COMP-RATE.
 20792
 20793     MOVE CT-RT (IB) TO WS-WK-RATE.
 20794
 20795 8800-EXIT.
 20796     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 384
* EL050.cbl
 20798 8900-ADDRESS-FILE.
 20799     IF ERACCT-FILE-ADDRESSED
 20800         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20801         GO TO 8900-ADDRESS-EXIT.
 20802
 20803     IF ELCNTL-FILE-ADDRESSED
 20804         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20805         GO TO 8900-ADDRESS-EXIT.
 20806
 20807     IF ERPLAN-FILE-ADDRESSED
 20808         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20809         GO TO 8900-ADDRESS-EXIT.
 20810
 20811     IF ERFORM-FILE-ADDRESSED
 20812         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20813         GO TO 8900-ADDRESS-EXIT.
 20814
 20815 8900-ADDRESS-EXIT.
 20816     EXIT.
 20817
 20818 9000-READ-CONTROL.
 20819
 20820* EXEC CICS HANDLE CONDITION
 20821*        NOTFND    (9000-NOTFND)
 20822*    END-EXEC.
 20823*    MOVE '"$I                   ! > #00019376' TO DFHEIV0
 20824     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20825     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20826     MOVE X'3E20233030303139333736' TO DFHEIV0(25:11)
 20827     CALL 'kxdfhei1' USING DFHEIV0
 20828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20829
 20830
 20831
 20832* EXEC CICS READ
 20833*        DATASET     (CNTL-ID)
 20834*        SET         (ADDRESS OF CONTROL-FILE)
 20835*        RIDFLD      (ELCNTL-KEY)
 20836*        GTEQ
 20837*    END-EXEC.
 20838*    MOVE '&"S        G          (   #00019380' TO DFHEIV0
 20839     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20840     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20841     MOVE X'2020233030303139333830' TO DFHEIV0(25:11)
 20842     CALL 'kxdfhei1' USING DFHEIV0,
 20843           CNTL-ID,
 20844           DFHEIV20,
 20845           DFHEIV99,
 20846           ELCNTL-KEY,
 20847           DFHEIV99,
 20848           DFHEIV99,
 20849           DFHEIV99
 20850     SET ADDRESS OF CONTROL-FILE TO
 20851         DFHEIV20
 20852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20853
 20854
 20855     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 385
* EL050.cbl
 20856
 20857 9000-NOTFND.
 20858     IF RC-SW-1 = '1'
 20859        MOVE ER-2616              TO WS-ERROR
 20860        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20861        GO TO 9000-EXIT.
 20862
 20863     IF RC-SW-1 = '2'
 20864        MOVE ER-2602              TO WS-ERROR
 20865        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20866
 20867 9000-EXIT.
 20868      EXIT.
 20869
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 386
* EL050.cbl
 20871 9100-READ-CONTROL.
 20872
 20873* EXEC CICS HANDLE CONDITION
 20874*        NOTFND  (9100-NOTFND)
 20875*        ENDFILE (9100-NOTFND)
 20876*    END-EXEC.
 20877*    MOVE '"$I''                  ! ? #00019404' TO DFHEIV0
 20878     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20879     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20880     MOVE X'3F20233030303139343034' TO DFHEIV0(25:11)
 20881     CALL 'kxdfhei1' USING DFHEIV0
 20882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20883
 20884
 20885
 20886* EXEC CICS READ
 20887*        DATASET     (CNTL-ID)
 20888*        INTO        (CONTROL-FILE)
 20889*        RIDFLD      (ELCNTL-KEY)
 20890*        GTEQ
 20891*    END-EXEC.
 20892     MOVE LENGTH OF
 20893      CONTROL-FILE
 20894       TO DFHEIV11
 20895*    MOVE '&"IL       G          (   #00019409' TO DFHEIV0
 20896     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20897     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20898     MOVE X'2020233030303139343039' TO DFHEIV0(25:11)
 20899     CALL 'kxdfhei1' USING DFHEIV0,
 20900           CNTL-ID,
 20901           CONTROL-FILE,
 20902           DFHEIV11,
 20903           ELCNTL-KEY,
 20904           DFHEIV99,
 20905           DFHEIV99,
 20906           DFHEIV99
 20907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20908
 20909
 20910     GO TO 9100-EXIT.
 20911
 20912 9100-NOTFND.
 20913     IF RC-SW-2 = '0'
 20914        MOVE '1'                  TO STATE-RECORD-ERROR
 20915        GO TO 9100-EXIT
 20916     END-IF
 20917     IF RC-SW-2 = '1'
 20918        MOVE '1'                  TO LF-BENEFIT-ERROR
 20919        MOVE ER-2604              TO WS-ERROR
 20920        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20921        GO TO 9100-EXIT.
 20922
 20923     IF RC-SW-2 = '2'
 20924        MOVE '1'                  TO AH-BENEFIT-ERROR
 20925        MOVE ER-2605              TO WS-ERROR
 20926        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20927        GO TO 9100-EXIT.
 20928
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 387
* EL050.cbl
 20929     IF RC-SW-2 = '3'
 20930         MOVE ER-2603           TO WS-ERROR
 20931         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20932         GO TO 9100-EXIT.
 20933
 20934     IF RC-SW-2 = '4'
 20935         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 20936         GO TO 9100-EXIT.
 20937
 20938     IF RC-SW-2 = '5'
 20939         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 20940         IF WS-AH-INPUT-CD-1 = SPACE
 20941             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 20942         ELSE
 20943             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 20944
 20945 9100-EXIT.
 20946      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 388
* EL050.cbl
 20948 9200-CONTROL-GETMAIN.
 20949
 20950* EXEC CICS GETMAIN
 20951*         LENGTH   (750)
 20952*         SET      (ADDRESS OF CONTROL-FILE)
 20953*    END-EXEC.
 20954     MOVE 750
 20955       TO DFHEIV11
 20956*    MOVE '," L                  $   #00019455' TO DFHEIV0
 20957     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20958     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20959     MOVE X'2020233030303139343535' TO DFHEIV0(25:11)
 20960     CALL 'kxdfhei1' USING DFHEIV0,
 20961           DFHEIV20,
 20962           DFHEIV11,
 20963           DFHEIV99
 20964     SET ADDRESS OF CONTROL-FILE TO
 20965         DFHEIV20
 20966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20967
 20968
 20969     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 20970
 20971 9200-EXIT.
 20972     EXIT.
 20973
 20974 9250-UNLOCK-RETURN.
 20975
 20976* EXEC CICS UNLOCK
 20977*        DATASET   (CERT-ID)
 20978*    END-EXEC.
 20979*    MOVE '&*                    #   #00019466' TO DFHEIV0
 20980     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20981     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20982     MOVE X'2020233030303139343636' TO DFHEIV0(25:11)
 20983     CALL 'kxdfhei1' USING DFHEIV0,
 20984           CERT-ID,
 20985           DFHEIV99
 20986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20987
 20988
 20989 9300-ABEND.
 20990     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 20991
 20992
 20993* EXEC CICS LINK
 20994*        PROGRAM   ('EL004')
 20995*        COMMAREA  (WS-ERROR-LINE)
 20996*        LENGTH    (72)
 20997*    END-EXEC.
 20998     MOVE 'EL004' TO DFHEIV1
 20999     MOVE 72
 21000       TO DFHEIV11
 21001*    MOVE '."C                   (   #00019473' TO DFHEIV0
 21002     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21003     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21004     MOVE X'2020233030303139343733' TO DFHEIV0(25:11)
 21005     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 389
* EL050.cbl
 21006           DFHEIV1,
 21007           WS-ERROR-LINE,
 21008           DFHEIV11,
 21009           DFHEIV99,
 21010           DFHEIV99,
 21011           DFHEIV99,
 21012           DFHEIV99
 21013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21014
 21015
 21016     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21017
 21018
 21019* EXEC CICS ABEND
 21020*        ABCODE ('EL50')
 21021*    END-EXEC.
 21022     MOVE 'EL50' TO DFHEIV5
 21023*    MOVE '.,A                   "   #00019481' TO DFHEIV0
 21024     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21025     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21026     MOVE X'2020233030303139343831' TO DFHEIV0(25:11)
 21027     CALL 'kxdfhei1' USING DFHEIV0,
 21028           DFHEIV5
 21029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21030
 21031
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 390
* EL050.cbl
 21033
 21034******************************************************************
 21035*                                                                *
 21036*            E R R O R   F O R M A T   R O U T I N E             *
 21037*                                                                *
 21038******************************************************************
 21039
 21040 9900-ERROR-FORMAT.
 21041
 21042     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21043                    PB-COMMON-ERROR (2) OR
 21044                    PB-COMMON-ERROR (3) OR
 21045                    PB-COMMON-ERROR (4) OR
 21046                    PB-COMMON-ERROR (5) OR
 21047                    PB-COMMON-ERROR (6) OR
 21048                    PB-COMMON-ERROR (7) OR
 21049                    PB-COMMON-ERROR (8) OR
 21050                    PB-COMMON-ERROR (9) OR
 21051                    PB-COMMON-ERROR (10)
 21052        GO TO 9900-EXIT.
 21053
 21054     IF PB-NO-OF-ERRORS = +10
 21055        GO TO 9900-EXIT.
 21056
 21057     ADD +1  TO PB-NO-OF-ERRORS.
 21058     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21059                                       (PB-NO-OF-ERRORS).
 21060 9900-EXIT.
 21061     EXIT.
 21062
 21063 9990-RETURN.
 21064     IF BROWSE-STARTED
 21065
 21066* EXEC CICS ENDBR
 21067*            DATASET  (ACCT-ID)
 21068*       END-EXEC.
 21069     MOVE 0
 21070       TO DFHEIV11
 21071*    MOVE '&2                    $   #00019518' TO DFHEIV0
 21072     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21073     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21074     MOVE X'2020233030303139353138' TO DFHEIV0(25:11)
 21075     CALL 'kxdfhei1' USING DFHEIV0,
 21076           ACCT-ID,
 21077           DFHEIV11,
 21078           DFHEIV99
 21079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21080
 21081
 21082 9990-EXIT.
 21083     EXIT.
 21084
 21085
 21086****Check for CRTO record, add one if not found.
 21087 9991-CHECK-FOR-ELCRTO.
 21088
 21089* EXEC CICS HANDLE CONDITION
 21090*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 391
* EL050.cbl
 21091*         ENDFILE (9991-CRTO-NOT-FOUND)
 21092*     END-EXEC.
 21093*    MOVE '"$I''                  ! @ #00019528' TO DFHEIV0
 21094     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21095     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21096     MOVE X'4020233030303139353238' TO DFHEIV0(25:11)
 21097     CALL 'kxdfhei1' USING DFHEIV0
 21098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21099
 21100     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21101     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21102     MOVE +0                     TO ELCRTO-SEQ-NO
 21103
 21104
 21105* EXEC CICS READ
 21106*       DATASET   ('ELCRTO')
 21107*       INTO      (ORIGINAL-CERTIFICATE)
 21108*       RIDFLD    (ELCRTO-KEY)
 21109*       GTEQ
 21110*       RESP      (WS-RESPONSE)
 21111*    END-EXEC
 21112     MOVE LENGTH OF
 21113      ORIGINAL-CERTIFICATE
 21114       TO DFHEIV11
 21115     MOVE 'ELCRTO' TO DFHEIV1
 21116*    MOVE '&"IL       G          (  N#00019536' TO DFHEIV0
 21117     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21118     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21119     MOVE X'204E233030303139353336' TO DFHEIV0(25:11)
 21120     CALL 'kxdfhei1' USING DFHEIV0,
 21121           DFHEIV1,
 21122           ORIGINAL-CERTIFICATE,
 21123           DFHEIV11,
 21124           ELCRTO-KEY,
 21125           DFHEIV99,
 21126           DFHEIV99,
 21127           DFHEIV99
 21128     MOVE EIBRESP  TO WS-RESPONSE
 21129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21130
 21131     IF WS-RESP-NORMAL
 21132        AND (OC-CONTROL-PRIMARY (1:33) =
 21133                 PB-CONTROL-BY-ACCOUNT (1:33))
 21134        AND (OC-RECORD-TYPE =  'I')
 21135           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21136               GO TO 9991-CHECK-INDICATORS
 21137           ELSE
 21138               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21139               GO TO 9991-CRTO-ADD-REC
 21140           END-IF
 21141     END-IF.
 21142
 21143 9991-CRTO-NOT-FOUND.
 21144
 21145     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21146     MOVE 'OC'                TO OC-RECORD-ID
 21147     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21148                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 392
* EL050.cbl
 21149     MOVE +4096               TO OC-KEY-SEQ-NO.
 21150
 21151 9991-CRTO-ADD-REC.
 21152
 21153     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21154     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21155     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21156     MOVE 'I'                 TO OC-RECORD-TYPE
 21157     IF PB-ISSUE
 21158         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21159         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21160         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21161         MOVE PB-I-AGE               TO OC-INS-AGE
 21162         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21163         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21164         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21165         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21166         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21167         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21168         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21169         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21170         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21171         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21172         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21173         IF PB-I-JOINT-COMMISSION > +0
 21174             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21175         ELSE
 21176             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21177         END-IF
 21178         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21179         MOVE +0                     TO OC-LF-CANCEL-AMT
 21180                                        OC-LF-ITD-CANCEL-AMT
 21181         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21182         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21183         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21184         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21185         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21186         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21187         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21188         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21189         MOVE +0                     TO OC-AH-CANCEL-AMT
 21190                                        OC-AH-ITD-CANCEL-AMT
 21191         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21192         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21193         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21194     ELSE
 21195         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21196         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21197         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21198         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21199         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21200         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21201         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21202         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21203         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21204          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21205             MOVE SPACES             TO OC-LF-BENCD
 21206             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 393
* EL050.cbl
 21207                                        OC-LF-BEN-AMT
 21208                                        OC-LF-PRM-AMT
 21209                                        OC-LF-ALT-BEN-AMT
 21210                                        OC-LF-ALT-PRM-AMT
 21211                                        OC-LF-COMM-PCT
 21212                                        OC-LF-CANCEL-AMT
 21213             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21214             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21215         ELSE
 21216             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21217             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21218             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21219             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21220             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21221             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21222             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21223             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21224             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21225             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21226         END-IF
 21227         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21228         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21229          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21230             MOVE SPACES             TO OC-AH-BENCD
 21231             MOVE ZEROS              TO OC-AH-TERM
 21232                                        OC-AH-BEN-AMT
 21233                                        OC-AH-PRM-AMT
 21234                                        OC-AH-COMM-PCT
 21235                                        OC-AH-CANCEL-AMT
 21236                                        OC-AH-CP
 21237             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21238             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21239         ELSE
 21240             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21241             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21242             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21243             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21244             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21245             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21246             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21247             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21248             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21249         END-IF
 21250         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21251         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21252         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21253         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21254     END-IF
 21255     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21256
 21257     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21258
 21259
 21260* EXEC CICS READ
 21261*         DATASET   (FILE-ERMAIL)
 21262*         RIDFLD    (MA-CONTROL-PRIMARY)
 21263*         INTO      (MAILING-DATA)
 21264*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 394
* EL050.cbl
 21265*    END-EXEC
 21266     MOVE LENGTH OF
 21267      MAILING-DATA
 21268       TO DFHEIV11
 21269*    MOVE '&"IL       E          (  N#00019672' TO DFHEIV0
 21270     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21271     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21272     MOVE X'204E233030303139363732' TO DFHEIV0(25:11)
 21273     CALL 'kxdfhei1' USING DFHEIV0,
 21274           FILE-ERMAIL,
 21275           MAILING-DATA,
 21276           DFHEIV11,
 21277           MA-CONTROL-PRIMARY,
 21278           DFHEIV99,
 21279           DFHEIV99,
 21280           DFHEIV99
 21281     MOVE EIBRESP  TO WS-RESPONSE
 21282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21283
 21284     IF WS-RESP-NORMAL
 21285         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21286     END-IF.
 21287
 21288     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21289     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21290
 21291
 21292* EXEC CICS READ
 21293*         DATASET  (CRTT-ID)
 21294*         RIDFLD   (WS-ELCRTT-KEY)
 21295*         INTO     (CERTIFICATE-TRAILERS)
 21296*         RESP     (WS-RESPONSE)
 21297*    END-EXEC
 21298     MOVE LENGTH OF
 21299      CERTIFICATE-TRAILERS
 21300       TO DFHEIV11
 21301*    MOVE '&"IL       E          (  N#00019686' TO DFHEIV0
 21302     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21303     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21304     MOVE X'204E233030303139363836' TO DFHEIV0(25:11)
 21305     CALL 'kxdfhei1' USING DFHEIV0,
 21306           CRTT-ID,
 21307           CERTIFICATE-TRAILERS,
 21308           DFHEIV11,
 21309           WS-ELCRTT-KEY,
 21310           DFHEIV99,
 21311           DFHEIV99,
 21312           DFHEIV99
 21313     MOVE EIBRESP  TO WS-RESPONSE
 21314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21315
 21316     IF WS-RESP-NORMAL
 21317         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21318         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21319     END-IF.
 21320
 21321
 21322* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 395
* EL050.cbl
 21323*       DATASET   ('ELCRTO')
 21324*       FROM      (ORIGINAL-CERTIFICATE)
 21325*       RIDFLD    (OC-CONTROL-PRIMARY)
 21326*       RESP      (WS-RESPONSE)
 21327*    END-EXEC.
 21328     MOVE LENGTH OF
 21329      ORIGINAL-CERTIFICATE
 21330       TO DFHEIV11
 21331     MOVE 'ELCRTO' TO DFHEIV1
 21332*    MOVE '&$ L                  ''  N#00019698' TO DFHEIV0
 21333     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21334     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21335     MOVE X'204E233030303139363938' TO DFHEIV0(25:11)
 21336     CALL 'kxdfhei1' USING DFHEIV0,
 21337           DFHEIV1,
 21338           ORIGINAL-CERTIFICATE,
 21339           DFHEIV11,
 21340           OC-CONTROL-PRIMARY,
 21341           DFHEIV99,
 21342           DFHEIV99
 21343     MOVE EIBRESP  TO WS-RESPONSE
 21344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21345
 21346
 21347     GO TO 9991-EXIT.
 21348
 21349 9991-CHECK-INDICATORS.
 21350
 21351     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21352         GO TO 9991-EXIT
 21353     END-IF.
 21354
 21355     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21356         GO TO 9991-EXIT
 21357     END-IF.
 21358
 21359
 21360* EXEC CICS READ
 21361*       DATASET   ('ELCRTO')
 21362*       INTO      (ORIGINAL-CERTIFICATE)
 21363*       RIDFLD    (OC-CONTROL-PRIMARY)
 21364*       UPDATE
 21365*       RESP      (WS-RESPONSE)
 21366*    END-EXEC
 21367     MOVE LENGTH OF
 21368      ORIGINAL-CERTIFICATE
 21369       TO DFHEIV11
 21370     MOVE 'ELCRTO' TO DFHEIV1
 21371*    MOVE '&"IL       EU         (  N#00019717' TO DFHEIV0
 21372     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21373     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21374     MOVE X'204E233030303139373137' TO DFHEIV0(25:11)
 21375     CALL 'kxdfhei1' USING DFHEIV0,
 21376           DFHEIV1,
 21377           ORIGINAL-CERTIFICATE,
 21378           DFHEIV11,
 21379           OC-CONTROL-PRIMARY,
 21380           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 396
* EL050.cbl
 21381           DFHEIV99,
 21382           DFHEIV99
 21383     MOVE EIBRESP  TO WS-RESPONSE
 21384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21385     IF WS-RESP-NORMAL
 21386        IF PB-ISSUE
 21387          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21388          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21389          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21390          MOVE PB-I-AGE               TO OC-INS-AGE
 21391          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21392          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21393          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21394          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21395          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21396          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21397          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21398          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21399          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21400          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21401          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21402          IF PB-I-JOINT-COMMISSION > +0
 21403              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21404          ELSE
 21405              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21406          END-IF
 21407          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21408          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21409          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21410          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21411          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21412          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21413          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21414          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21415          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21416
 21417          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21418
 21419* EXEC CICS READ
 21420*             DATASET   (FILE-ERMAIL)
 21421*             RIDFLD    (MA-CONTROL-PRIMARY)
 21422*             INTO      (MAILING-DATA)
 21423*             RESP      (WS-RESPONSE)
 21424*         END-EXEC
 21425     MOVE LENGTH OF
 21426      MAILING-DATA
 21427       TO DFHEIV11
 21428*    MOVE '&"IL       E          (  N#00019757' TO DFHEIV0
 21429     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21430     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21431     MOVE X'204E233030303139373537' TO DFHEIV0(25:11)
 21432     CALL 'kxdfhei1' USING DFHEIV0,
 21433           FILE-ERMAIL,
 21434           MAILING-DATA,
 21435           DFHEIV11,
 21436           MA-CONTROL-PRIMARY,
 21437           DFHEIV99,
 21438           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 397
* EL050.cbl
 21439           DFHEIV99
 21440     MOVE EIBRESP  TO WS-RESPONSE
 21441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21442          IF WS-RESP-NORMAL
 21443             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21444          END-IF
 21445
 21446          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21447          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21448
 21449* EXEC CICS READ
 21450*             DATASET  (CRTT-ID)
 21451*             RIDFLD   (WS-ELCRTT-KEY)
 21452*             INTO     (CERTIFICATE-TRAILERS)
 21453*             RESP     (WS-RESPONSE)
 21454*         END-EXEC
 21455     MOVE LENGTH OF
 21456      CERTIFICATE-TRAILERS
 21457       TO DFHEIV11
 21458*    MOVE '&"IL       E          (  N#00019769' TO DFHEIV0
 21459     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21460     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21461     MOVE X'204E233030303139373639' TO DFHEIV0(25:11)
 21462     CALL 'kxdfhei1' USING DFHEIV0,
 21463           CRTT-ID,
 21464           CERTIFICATE-TRAILERS,
 21465           DFHEIV11,
 21466           WS-ELCRTT-KEY,
 21467           DFHEIV99,
 21468           DFHEIV99,
 21469           DFHEIV99
 21470     MOVE EIBRESP  TO WS-RESPONSE
 21471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21472          IF WS-RESP-NORMAL
 21473             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21474                               OC-INS-AGE-DEFAULT-FLAG
 21475             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21476                               OC-JNT-AGE-DEFAULT-FLAG
 21477          END-IF
 21478
 21479        ELSE
 21480          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21481             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21482             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21483             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21484          END-IF
 21485          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21486             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21487             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21488             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21489          END-IF
 21490          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21491        END-IF
 21492
 21493* EXEC CICS REWRITE
 21494*          DATASET   ('ELCRTO')
 21495*          FROM      (ORIGINAL-CERTIFICATE)
 21496*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 398
* EL050.cbl
 21497*       END-EXEC
 21498     MOVE LENGTH OF
 21499      ORIGINAL-CERTIFICATE
 21500       TO DFHEIV11
 21501     MOVE 'ELCRTO' TO DFHEIV1
 21502*    MOVE '&& L                  %  N#00019795' TO DFHEIV0
 21503     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21504     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21505     MOVE X'204E233030303139373935' TO DFHEIV0(25:11)
 21506     CALL 'kxdfhei1' USING DFHEIV0,
 21507           DFHEIV1,
 21508           ORIGINAL-CERTIFICATE,
 21509           DFHEIV11,
 21510           DFHEIV99
 21511     MOVE EIBRESP  TO WS-RESPONSE
 21512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21513     END-IF.
 21514
 21515 9991-EXIT.
 21516     EXIT.
 21517
 21518
 21519 9999-RETURN.
 21520     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21521
 21522
 21523* EXEC CICS RETURN
 21524*    END-EXEC.
 21525*    MOVE '.(                    ''   #00019809' TO DFHEIV0
 21526     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21527     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21528     MOVE X'2020233030303139383039' TO DFHEIV0(25:11)
 21529     CALL 'kxdfhei1' USING DFHEIV0,
 21530           DFHEIV99,
 21531           DFHEIV99,
 21532           DFHEIV99,
 21533           DFHEIV99,
 21534           DFHEIV99,
 21535           DFHEIV99
 21536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21537
 21538
 21539
 21540* GOBACK.
 21541     MOVE '9%                    "   ' TO DFHEIV0
 21542     MOVE 'EL050' TO DFHEIV1
 21543     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21544     GOBACK.
 21545
 21546 9999-DFHBACK SECTION.
 21547     MOVE '9%                    "   ' TO DFHEIV0
 21548     MOVE 'EL050' TO DFHEIV1
 21549     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21550     GOBACK.
 21551 9999-DFHEXIT.
 21552     IF DFHEIGDJ EQUAL 0001
 21553         NEXT SENTENCE
 21554     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 399
* EL050.cbl
 21555         GO TO 9300-ABEND,
 21556               3990-FILES-NOT-OPEN
 21557         DEPENDING ON DFHEIGDI
 21558     ELSE IF DFHEIGDJ EQUAL 3
 21559         GO TO 6610-START-BROWSE,
 21560               6630-ERRESS-PROBLEM,
 21561               6630-END-OF-FILE
 21562         DEPENDING ON DFHEIGDI
 21563     ELSE IF DFHEIGDJ EQUAL 4
 21564         GO TO 6630-END-OF-FILE,
 21565               6630-ERRESS-PROBLEM,
 21566               6630-ERRESS-PROBLEM,
 21567               6630-END-OF-FILE
 21568         DEPENDING ON DFHEIGDI
 21569     ELSE IF DFHEIGDJ EQUAL 5
 21570         GO TO 6630-END-OF-FILE,
 21571               6630-END-OF-FILE,
 21572               6630-ERRESS-PROBLEM,
 21573               6630-ERRESS-PROBLEM
 21574         DEPENDING ON DFHEIGDI
 21575     ELSE IF DFHEIGDJ EQUAL 6
 21576         GO TO 6660-START-BROWSE,
 21577               6690-ERRESC-PROBLEM,
 21578               6690-ERRESC-PROBLEM,
 21579               6690-END-OF-FILE
 21580         DEPENDING ON DFHEIGDI
 21581     ELSE IF DFHEIGDJ EQUAL 7
 21582         GO TO 6690-END-OF-FILE,
 21583               6690-ERRESC-PROBLEM,
 21584               6690-ERRESC-PROBLEM,
 21585               6690-END-OF-FILE
 21586         DEPENDING ON DFHEIGDI
 21587     ELSE IF DFHEIGDJ EQUAL 8
 21588         GO TO 6690-END-OF-FILE,
 21589               6690-ERRESC-PROBLEM,
 21590               6690-ERRESC-PROBLEM,
 21591               6690-END-OF-FILE
 21592         DEPENDING ON DFHEIGDI
 21593     ELSE IF DFHEIGDJ EQUAL 9
 21594         GO TO 7250-CONTINUE,
 21595               7250-CONTINUE
 21596         DEPENDING ON DFHEIGDI
 21597     ELSE IF DFHEIGDJ EQUAL 10
 21598         GO TO 7300-CONTINUE,
 21599               7300-CONTINUE
 21600         DEPENDING ON DFHEIGDI
 21601     ELSE IF DFHEIGDJ EQUAL 11
 21602         GO TO 8000-FREE-MAIN
 21603         DEPENDING ON DFHEIGDI
 21604     ELSE IF DFHEIGDJ EQUAL 12
 21605         GO TO 8100-NOTFND,
 21606               8100-NOTFND
 21607         DEPENDING ON DFHEIGDI
 21608     ELSE IF DFHEIGDJ EQUAL 13
 21609         GO TO 8110-NOTFND,
 21610               8110-NOTFND
 21611         DEPENDING ON DFHEIGDI
 21612     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 400
* EL050.cbl
 21613         GO TO 8130-EXIT
 21614         DEPENDING ON DFHEIGDI
 21615     ELSE IF DFHEIGDJ EQUAL 15
 21616         GO TO 8180-NOTFND
 21617         DEPENDING ON DFHEIGDI
 21618     ELSE IF DFHEIGDJ EQUAL 16
 21619         GO TO 8190-NOTFND
 21620         DEPENDING ON DFHEIGDI
 21621     ELSE IF DFHEIGDJ EQUAL 17
 21622         GO TO 8195-NOTFND
 21623         DEPENDING ON DFHEIGDI
 21624     ELSE IF DFHEIGDJ EQUAL 18
 21625         GO TO 8200-NOTFND
 21626         DEPENDING ON DFHEIGDI
 21627     ELSE IF DFHEIGDJ EQUAL 19
 21628         GO TO 8300-NOTFND,
 21629               8300-ERRESS-PROBLEM,
 21630               8300-ERRESS-PROBLEM,
 21631               8300-NOTFND
 21632         DEPENDING ON DFHEIGDI
 21633     ELSE IF DFHEIGDJ EQUAL 20
 21634         GO TO 8450-FORM-NOT-FOUND,
 21635               8450-FORM-NOT-FOUND
 21636         DEPENDING ON DFHEIGDI
 21637     ELSE IF DFHEIGDJ EQUAL 21
 21638         GO TO 0199-ACCT-NOT-FOUND,
 21639               0199-ACCT-NOT-FOUND
 21640         DEPENDING ON DFHEIGDI
 21641     ELSE IF DFHEIGDJ EQUAL 22
 21642         GO TO 0199-ACCT-NOT-FOUND,
 21643               0199-ACCT-NOT-FOUND
 21644         DEPENDING ON DFHEIGDI
 21645     ELSE IF DFHEIGDJ EQUAL 23
 21646         GO TO 8582-COMP-NOT-FOUND,
 21647               8582-COMP-NOT-FOUND
 21648         DEPENDING ON DFHEIGDI
 21649     ELSE IF DFHEIGDJ EQUAL 24
 21650         GO TO 8583-AGTC-NOT-FOUND,
 21651               8583-AGTC-NOT-FOUND
 21652         DEPENDING ON DFHEIGDI
 21653     ELSE IF DFHEIGDJ EQUAL 25
 21654         GO TO 8584-BXRF-NOT-FOUND,
 21655               8584-BXRF-NOT-FOUND
 21656         DEPENDING ON DFHEIGDI
 21657     ELSE IF DFHEIGDJ EQUAL 26
 21658         GO TO 8585-PLAN-NOT-FOUND,
 21659               8585-PLAN-NOT-FOUND
 21660         DEPENDING ON DFHEIGDI
 21661     ELSE IF DFHEIGDJ EQUAL 27
 21662         GO TO 0299-CERT-NOT-FOUND
 21663         DEPENDING ON DFHEIGDI
 21664     ELSE IF DFHEIGDJ EQUAL 28
 21665         GO TO 8700-READ-CERT-MASTER
 21666         DEPENDING ON DFHEIGDI
 21667     ELSE IF DFHEIGDJ EQUAL 29
 21668         GO TO 8720-COMP-ACCOUNTS,
 21669               8730-END-BROWSE,
 21670               8740-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 401
* EL050.cbl
 21671         DEPENDING ON DFHEIGDI
 21672     ELSE IF DFHEIGDJ EQUAL 30
 21673         GO TO 9000-NOTFND
 21674         DEPENDING ON DFHEIGDI
 21675     ELSE IF DFHEIGDJ EQUAL 31
 21676         GO TO 9100-NOTFND,
 21677               9100-NOTFND
 21678         DEPENDING ON DFHEIGDI
 21679     ELSE IF DFHEIGDJ EQUAL 32
 21680         GO TO 9991-CRTO-NOT-FOUND,
 21681               9991-CRTO-NOT-FOUND
 21682         DEPENDING ON DFHEIGDI.
 21683     MOVE '9%                    "   ' TO DFHEIV0
 21684     MOVE 'EL050' TO DFHEIV1
 21685     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21686     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       39992     Code:       87704
