* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   1
* EL154.cbl
* Options: int("EL154.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL154.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL154.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL154.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL154.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 11/21/94 15:39:26.
     7*                            VMOD=2.022
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   2
* EL154.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.    TRANSACTION - EX28 - SET-UP AUTOMATIC PAYMENTS.
    26*        USED TO CREATE NEW AUTOMATIC PAYMENT SCHEDULES AND/OR
    27*        SIGN-OFF CURRENT SCHEDULES.  ONCE A SCHEDULE HAS BEEN
    28*        CREATED IT MAY ONLY BY REPLACED - NOT CHANGED
    29*        OR DELETED.
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 090108    2007041300006  AJRA  ENTER LETTER FORM NUMBER ON SET U
    39* 031809    2009031600001  AJRA  ALLOW IU PAYMENT PAST EXP DATE
    40* 070909    2009060400001  AJRA  ADD AUTO PAY STOP LETTER
    41* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    42* 100713  IR2013092400001  PEMA  USE EXP DT IF NO CRIT PER - DCC
    43* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    44******************************************************************
    45
    46 ENVIRONMENT DIVISION.
    47
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   3
* EL154.cbl
    49 DATA DIVISION.
    50 WORKING-STORAGE SECTION.
    51 01  DFH-START PIC X(04).
    52 77  FILLER  PIC X(32)  VALUE '********************************'.
    53 77  FILLER  PIC X(32)  VALUE '*    EL154 WORKING STORAGE     *'.
    54 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.022 *********'.
    55 77  P1                          PIC S999 COMP-3 VALUE +0.
    56 77  P2                          PIC S999 COMP-3 VALUE +0.
    57 77  s1                          PIC S999 COMP-3 VALUE +0.
    58 77  s2                          PIC S999 COMP-3 VALUE +0.
    59 77  ws-benefit-expiration-dt    pic xx value low-values.
    60
    61*                            COPY ELCSCTM.
    62******************************************************************
    63*                                                                *
    64*                                                                *
    65*                            ELCSCTM                             *
    66*                            VMOD=2.001                          *
    67*                                                                *
    68*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    69*                                                                *
    70******************************************************************
    71 01  SECURITY-MESSAGE.
    72     12  FILLER                          PIC X(30)
    73            VALUE '** LOGIC SECURITY VIOLATION -'.
    74     12  SM-READ                         PIC X(6).
    75     12  FILLER                          PIC X(5)
    76            VALUE ' PGM='.
    77     12  SM-PGM                          PIC X(6).
    78     12  FILLER                          PIC X(5)
    79            VALUE ' OPR='.
    80     12  SM-PROCESSOR-ID                 PIC X(4).
    81     12  FILLER                          PIC X(6)
    82            VALUE ' TERM='.
    83     12  SM-TERMID                       PIC X(4).
    84     12  FILLER                          PIC XX   VALUE SPACE.
    85     12  SM-JUL-DATE                     PIC 9(5).
    86     12  FILLER                          PIC X    VALUE SPACE.
    87     12  SM-TIME                         PIC 99.99.
    88
    89
    90*                            COPY ELCSCRTY.
    91******************************************************************
    92*                                                                *
    93*                                                                *
    94*                            ELCSCRTY                            *
    95*                            VMOD=2.001                          *
    96*                                                                *
    97*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    98*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    99*        SAVED IN PI-SECURITY-ADDRESS.                           *
   100*                                                                *
   101******************************************************************
   102 01  SECURITY-CONTROL.
   103     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   104     12  FILLER                       PIC XX    VALUE 'SC'.
   105     12  SC-CREDIT-CODES.
   106         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   4
* EL154.cbl
   107             20  SC-CREDIT-DISPLAY    PIC X.
   108             20  SC-CREDIT-UPDATE     PIC X.
   109     12  SC-CLAIMS-CODES.
   110         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   111             20  SC-CLAIMS-DISPLAY    PIC X.
   112             20  SC-CLAIMS-UPDATE     PIC X.
   113
   114 01  WS-DATE-AREA.
   115     05  CURRENT-GREG-DATE   PIC X(8)    VALUE SPACES.
   116     05  CURRENT-BIN-DATE    PIC X(2)    VALUE SPACES.
   117     05  RETRO-ELIM-DATE     PIC XX      VALUE LOW-VALUES.
   118
   119 01  ws-dcc-product-code         pic xxx value spaces.
   120 01  ws-ah-benefit-cd            pic xx  value '00'.
   121 01  ws-edit-1st-pmt-amt         pic s9(9)v99 comp-3 value +0.
   122 01  ws-monthly-benefit          pic s9(9)v99 comp-3 value +0.
   123 01  ws-max-benefit-amt          pic s9(9)v99 comp-3 value +0.
   124 01  ws-max-benefit-pmts         pic s999 comp-3 value +0.
   125 01  ws-benefits-prev-paid       pic s999 comp-3 value +0.
   126 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   127     88  PDEF-FOUND                   VALUE 'Y'.
   128 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   129     88  ACCT-FOUND                   VALUE 'Y'.
   130 01  ws-cert-trlr-sw             PIC X  VALUE ' '.
   131     88  cert-trlr-found              VALUE 'Y'.
   132 01  STANDARD-AREAS.
   133     12  WS-RESPONSE             PIC S9(8)   COMP.
   134         88  WS-RESP-NORMAL        VALUE +00.
   135         88  WS-RESP-ERROR         VALUE +01.
   136         88  WS-RESP-NOTFND        VALUE +13.
   137         88  WS-RESP-DUPREC        VALUE +14.
   138         88  WS-RESP-ENDFILE       VALUE +20.
   139     12  SC-ITEM             PIC S9(4)   VALUE +1  COMP.
   140     12  SUB-1               PIC S9(4)   VALUE +0  COMP.
   141     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   142     12  MAP-NAME.
   143         16  MAP-PRE         PIC XX      VALUE 'EL'.
   144         16  MAP-NUMBER      PIC X(4)    VALUE '154A'.
   145         16  FILLER          PIC XX      VALUE SPACES.
   146     12  MAPSET-NAME         PIC X(8)    VALUE 'EL154S'.
   147     12  TRANS-ID            PIC X(4)    VALUE 'EX28'.
   148     12  LGXX-ID             PIC X(4)    VALUE 'LGXX'.
   149     12  PGM-NAME            PIC X(8).
   150     12  TIME-IN             PIC S9(7).
   151     12  TIME-OUT-R  REDEFINES TIME-IN.
   152         16  FILLER          PIC X.
   153         16  TIME-OUT        PIC 99V99.
   154         16  FILLER          PIC X(2).
   155     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   156     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   157     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   158
   159     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   160     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   161     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   162     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   163     12  THIS-PGM            PIC X(8)    VALUE 'EL154'.
   164
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   5
* EL154.cbl
   165     12  DEEDIT-FIELD            PIC X(15).
   166     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD   PIC S9(15).
   167
   168     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   169     12  NEFFDTE-SAVE            PIC XX       VALUE LOW-VALUES.
   170     12  NFSTPMT-SAVE            PIC XX       VALUE LOW-VALUES.
   171     12  NLSTPMT-SAVE            PIC XX       VALUE LOW-VALUES.
   172     12  NFSTAMT-SAVE            PIC S9(7)V99 VALUE +0   COMP-3.
   173     12  NREGPMT-SAVE            PIC S9(7)V99 VALUE +0   COMP-3.
   174     12  CURRENT-SAVE            PIC XX       VALUE LOW-VALUES.
   175     12  LETTDTE-SAVE            PIC X(10)    VALUE SPACES.
   176     12  WS-WORK                 PIC S9(5)    VALUE ZERO COMP-3.
   177     12  WS-REMAINDER            PIC S9(5)    VALUE ZERO COMP-3.
   178     12  WS-DAYS-MINUS-TOL       PIC S9(5)    VALUE ZERO COMP-3.
   179     12  WS-DAYS-PLUS-TOL        PIC S9(5)    VALUE ZERO COMP-3.
   180     12  WS-DAILY-BEN-AMT        PIC S9(5)V99 VALUE ZERO COMP-3.
   181     12  WS-AMT-MINUS-TOL        PIC S9(7)V99 VALUE ZERO COMP-3.
   182     12  WS-AMT-PLUS-TOL         PIC S9(7)V99 VALUE ZERO COMP-3.
   183     12  WS-AMT-TOL              PIC S9(5)V99 VALUE ZERO COMP-3.
   184     12  WS-DAY-TOL              PIC S9(05)   VALUE ZERO COMP-3.
   185     12  WS-MAX-AUTO-PMT         PIC S9(7)V99 VALUE ZERO COMP-3.
   186     12  WS-MAX-AUTO-MOS         PIC S999     VALUE ZERO COMP-3.
   187     12  WS-ELAPSED-DAYS         PIC S9(04)   VALUE +0   COMP.
   188     12  WS-REG-PMT              PIC S9(7)V99 VALUE ZERO COMP-3.
   189     12  WS-EXP-DT               PIC XX       VALUE LOW-VALUES.
   190     12  WS-EXP-DT-PLUS7         PIC XX       VALUE LOW-VALUES.
   191     12  WS-CALC-METHOD          PIC X.
   192     12  WS-DAILY-RATE           PIC S9(3)V99.
   193     12  WS-CONFIRM-NEEDED       PIC X.
   194     12  WS-ELIMINATION-SW       PIC X        VALUE SPACES.
   195         88  NO-EFFDTE-ENTERED   VALUE 'N'.
   196     12  WS-BENEFIT-FOUND-SW     PIC X        VALUE SPACES.
   197         88  BENEFIT-FOUND       VALUE 'Y'.
   198     12  WS-ACT-REC-FOUND-SW     PIC X(01)    VALUE 'N'.
   199     12  WS-LETTER-SW            PIC X(01)    VALUE 'N'.
   200     12  WS-LETTER-FORM-NUM      PIC X(04)    VALUE SPACES.
   201     12  WS-END-LETTER-FORM-NUM  PIC X(04)    VALUE SPACES.
   202     12  WS-RESET-SW             PIC X(01)    VALUE 'N'.
   203     12  WS-PAYEE-CODE.
   204         16  WS-PAYEE-CD         PIC X(01).
   205         16  WS-PAYEE-SEQ        PIC X(01).
   206         16  WS-PAYEE-SEQ-NUM REDEFINES
   207             WS-PAYEE-SEQ        PIC 9(01).
   208     12  WS-ACCESS.
   209         16  FILLER              PIC XX       VALUE SPACES.
   210         16  WS-BEN-CD           PIC XX.
   211
   212     12  MISC-HEADING-AREAS.
   213         16  FIRST-PMT-HD1       PIC X(23)    VALUE
   214             'FIRST PAY THRU DATE   :'.
   215         16  FIRST-PMT-HD2       PIC X(23)    VALUE
   216             'FIRST PAY-TO DATE     :'.
   217         16  FIRST-PMT-HD3       PIC X(26)    VALUE
   218             '   FIRST PAY-THRU DATE   :'.
   219         16  FIRST-PMT-HD4       PIC X(26)    VALUE
   220             '   FIRST PAY-TO DATE     :'.
   221         16  LAST-PMT-HD1        PIC X(24)    VALUE
   222             'LAST PAY-THRU DATE     :'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   6
* EL154.cbl
   223         16  LAST-PMT-HD2        PIC X(24)    VALUE
   224             'LAST PAY-TO DATE       :'.
   225         16  LAST-PMT-HD3        PIC X(23)    VALUE
   226             'LAST PAY-THRU DATE    :'.
   227         16  LAST-PMT-HD4        PIC X(23)    VALUE
   228             'LAST PAY-TO DATE      :'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   7
* EL154.cbl
   230 01  ERROR-MESSAGES.
   231     12  ER-0000                 PIC X(4)     VALUE '0000'.
   232     12  ER-0004                 PIC X(4)     VALUE '0004'.
   233     12  ER-0008                 PIC X(4)     VALUE '0008'.
   234     12  ER-0029                 PIC X(4)     VALUE '0029'.
   235     12  ER-0042                 PIC X(4)     VALUE '0042'.
   236     12  ER-0050                 PIC X(4)     VALUE '0050'.
   237     12  ER-0070                 PIC X(4)     VALUE '0070'.
   238     12  ER-0130                 PIC X(4)     VALUE '0130'.
   239     12  ER-0154                 PIC X(4)     VALUE '0154'.
   240     12  ER-0169                 PIC X(4)     VALUE '0169'.
   241     12  ER-0172                 PIC X(4)     VALUE '0172'.
   242     12  ER-0186                 PIC X(4)     VALUE '0186'.
   243     12  ER-0206                 PIC X(4)     VALUE '0206'.
   244     12  ER-0283                 PIC X(4)     VALUE '0283'.
   245     12  ER-0346                 PIC X(4)     VALUE '0346'.
   246     12  ER-0347                 PIC X(4)     VALUE '0347'.
   247     12  ER-0348                 PIC X(4)     VALUE '0348'.
   248     12  ER-0349                 PIC X(4)     VALUE '0349'.
   249     12  ER-0350                 PIC X(4)     VALUE '0350'.
   250     12  ER-0351                 PIC X(4)     VALUE '0351'.
   251     12  ER-0352                 PIC X(4)     VALUE '0352'.
   252     12  ER-0353                 PIC X(4)     VALUE '0353'.
   253     12  ER-0354                 PIC X(4)     VALUE '0354'.
   254     12  ER-0357                 PIC X(4)     VALUE '0357'.
   255     12  ER-0358                 PIC X(4)     VALUE '0358'.
   256     12  ER-0372                 PIC X(4)     VALUE '0372'.
   257     12  ER-0396                 PIC X(4)     VALUE '0396'.
   258     12  ER-0397                 PIC X(4)     VALUE '0397'.
   259     12  ER-0398                 PIC X(4)     VALUE '0398'.
   260     12  ER-0399                 PIC X(4)     VALUE '0399'.
   261     12  ER-0401                 PIC X(4)     VALUE '0401'.
   262     12  ER-0402                 PIC X(4)     VALUE '0402'.
   263     12  ER-0403                 PIC X(4)     VALUE '0403'.
   264     12  ER-0404                 PIC X(4)     VALUE '0404'.
   265     12  ER-0450                 PIC X(4)     VALUE '0450'.
   266     12  ER-0541                 PIC X(4)     VALUE '0541'.
   267     12  ER-0559                 PIC X(4)     VALUE '0559'.
   268     12  ER-0563                 PIC X(4)     VALUE '0563'.
   269     12  ER-0597                 PIC X(4)     VALUE '0597'.
   270     12  ER-0632                 PIC X(4)     VALUE '0632'.
   271     12  ER-0670                 PIC X(4)     VALUE '0670'.
   272     12  ER-0802                 PIC X(4)     VALUE '0802'.
   273     12  ER-0803                 PIC X(4)     VALUE '0803'.
   274     12  ER-0815                 PIC X(4)     VALUE '0815'.
   275     12  ER-0826                 PIC X(4)     VALUE '0826'.
   276     12  ER-0839                 PIC X(4)     VALUE '0839'.
   277     12  ER-1599                 PIC X(4)     VALUE '1599'.
   278     12  er-1657                 pic x(4)     value '1657'.
   279     12  er-1658                 pic x(4)     value '1658'.
   280     12  er-1672                 pic x(4)     value '1672'.
   281     12  er-1674                 pic x(4)     value '1674'.
   282     12  ER-3396                 PIC X(4)     VALUE '3396'.
   283     12  ER-3397                 PIC X(4)     VALUE '3397'.
   284     12  ER-3537                 PIC X(4)     VALUE '3537'.
   285     12  ER-3801                 PIC X(4)     VALUE '3801'.
   286     12  ER-8200                 PIC X(4)     VALUE '8200'.
   287     12  ER-9483                 PIC X(4)     VALUE '9483'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   8
* EL154.cbl
   288     12  ER-9883                 PIC X(4)     VALUE '9883'.
   289
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   9
* EL154.cbl
   291 01  ACCESS-KEYS.
   292     12  CNTL-ID                  PIC X(8)    VALUE 'ELCNTL'.
   293     12  CLAM-ID                  PIC X(8)    VALUE 'ELMSTR'.
   294     12  ACTV-ID                  PIC X(8)    VALUE 'ELTRLR'.
   295     12  CERT-ID                  PIC X(8)    VALUE 'ELCERT'.
   296     12  BENE-ID                  PIC X(8)    VALUE 'ELBENE'.
   297     12  EMPLCY-ID                PIC X(8)    VALUE 'MPPLCY'.
   298
   299     12  CNTL-KEY.
   300         16  CNTL-CO              PIC X(3).
   301         16  CNTL-RECORD-TYPE     PIC X       VALUE '1'.
   302         16  CNTL-GENL.
   303           18 CNTL-GEN1           PIC X(2)    VALUE SPACES.
   304           18 CNTL-GEN2.
   305             20 CNTL-GEN3         PIC X       VALUE SPACES.
   306             20 CNTL-GEN4         PIC X       VALUE SPACES.
   307         16  CNTL-SEQ             PIC S9(4)   VALUE +0    COMP.
   308
   309     12  ELTRLR-KEY.
   310         16  TRLR-COMP-CD        PIC X.
   311         16  TRLR-CARRIER        PIC X.
   312         16  TRLR-CLAIM-NO       PIC X(7).
   313         16  TRLR-CERT-NO        PIC X(11).
   314         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   315     12  CLAM-KEY.
   316         16  CLAM-CO              PIC X.
   317         16  CLAM-CARRIER         PIC X.
   318         16  CLAM-CLAIM           PIC X(7).
   319         16  CLAM-CERT-NUM        PIC X(11).
   320
   321     12  CLAIM-SAVE-KEY           PIC X(20).
   322
   323     12  ACTV-KEY.
   324         16  ACTV-PARTIAL-KEY.
   325             20  ACTV-CO          PIC X.
   326             20  ACTV-CARRIER     PIC X.
   327             20  ACTV-CLAIM       PIC X(7).
   328             20  ACTV-CERT-NUM    PIC X(11).
   329         16  ACTV-SEQ             PIC S9(4)  COMP.
   330
   331     12  CERT-KEY.
   332         16  CERT-CO             PIC X.
   333         16  CERT-CARRIER        PIC X.
   334         16  CERT-GROUPING       PIC X(6).
   335         16  CERT-STATE          PIC XX.
   336         16  CERT-ACCOUNT        PIC X(10).
   337         16  CERT-EFF-DT         PIC XX.
   338         16  CERT-CERT-NUM       PIC X(11).
   339
   340     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   341     12  ERACCT-KEY.
   342         16  ERACCT-PARTIAL-KEY.
   343             20  ACCT-COMP-CD    PIC X.
   344             20  ACCT-CARRIER    PIC X.
   345             20  ACCT-GROUPING   PIC X(6).
   346             20  ACCT-STATE      PIC XX.
   347             20  ACCT-ACCOUNT    PIC X(10).
   348         16  ACCT-EXP-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  10
* EL154.cbl
   349         16  FILLER              PIC X(4) VALUE SPACES.
   350     12  EMPLCY-KEY.
   351         16  EMPLCY-COMPANY-CD   PIC X(01).
   352         16  EMPLCY-CARRIER      PIC X(01).
   353         16  EMPLCY-GROUPING     PIC X(06).
   354         16  EMPLCY-STATE        PIC X(02).
   355         16  EMPLCY-PRODUCER     PIC X(10).
   356         16  EMPLCY-EFF-DT       PIC X(02).
   357         16  EMPLCY-REFERENCE-NO PIC X(20).
   358
   359     12  BENE-KEY.
   360         16  BENE-CO             PIC X(01).
   361         16  BENE-REC-TYPE       PIC X(01).
   362         16  BENE-CODE           PIC X(10).
   363 01  ERPDEF-KEY-SAVE             PIC X(18).
   364 01  ERPDEF-KEY.
   365     12  ERPDEF-COMPANY-CD       PIC X.
   366     12  ERPDEF-STATE            PIC XX.
   367     12  ERPDEF-PROD-CD          PIC XXX.
   368     12  F                       PIC X(7).
   369     12  ERPDEF-BEN-TYPE         PIC X.
   370     12  ERPDEF-BEN-CODE         PIC XX.
   371     12  ERPDEF-EXP-DT           PIC XX.
   372
   373 01  ELCRTT-KEY.
   374     05  CTRLR-COMP-CD       PIC X.
   375     05  CTRLR-CARRIER       PIC X.
   376     05  CTRLR-GROUPING      PIC X(6).
   377     05  CTRLR-STATE         PIC X(2).
   378     05  CTRLR-ACCOUNT       PIC X(10).
   379     05  CTRLR-EFF-DT        PIC XX.
   380     05  CTRLR-CERT-NO       PIC X(11).
   381     05  CTRLR-REC-TYPE      PIC X.
   382*                            COPY ELCCALC.
   383******************************************************************
   384*                                                                *
   385*                           ELCCALC.                            *
   386*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   387*                            VMOD=2.025                          *
   388*                                                                *
   389*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   390*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   391*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   392*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   393*                                                                *
   394*  PASSED TO ELRTRM                                              *
   395*  -----------------                                             *
   396*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   397*  ORIGINAL TERM                                                 *
   398*  BEGINNING DATE                                                *
   399*  ENDING DATE                                                   *
   400*  COMPANY I.D.                                                  *
   401*  ACCOUNT MASTER USER FIELD                                     *
   402*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   403*  FREE LOOK DAYS                                                *
   404*                                                                *
   405*  RETURNED FROM ELRTRM                                          *
   406*  ---------------------                                         *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  11
* EL154.cbl
   407*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   408*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   409*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   410*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   411*----------------------------------------------------------------*
   412*  PASSED TO ELRAMT                                              *
   413*  ----------------                                              *
   414*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   415*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   416*  ORIGINAL AMOUNT                                               *
   417*  ALTERNATE BENEFIT (BALLON)                                    *
   418*  A.P.R. - NET PAY ONLY                                         *
   419*  METHOD
   420*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   421*  COMPANY I.D.                                                  *
   422*  BENEFIT TYPE                                                  *
   423*                                                                *
   424*  RETURNED FROM ELRAMT                                          *
   425*  --------------------                                          *
   426*  REMAINING AMOUNT 1 - CURRENT                                  *
   427*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   428*  REMAINING AMOUNT FACTOR
   429*----------------------------------------------------------------*
   430*  PASSED TO ELRESV                                              *
   431*  -----------------                                             *
   432*  CERTIFICATE EFFECTIVE DATE                                    *
   433*  VALUATION DATE                                                *
   434*  PAID THRU DATE                                                *
   435*  BENEFIT                                                       *
   436*  INCURRED DATE                                                 *
   437*  REPORTED DATE                                                 *
   438*  ISSUE AGE                                                     *
   439*  TERM                                                          *
   440*  CDT PERCENT                                                   *
   441*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   442* *CLAIM TYPE (LIFE, A/H)                                        *
   443* *REMAINING BENEFIT (FROM ELRAMT)                               *
   444* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   445*                                                                *
   446*  RETURNED FROM ELRESV                                          *
   447*  --------------------                                          *
   448*  CDT TABLE USED                                                *
   449*  CDT FACTOR USED                                               *
   450*  PAY TO CURRENT RESERVE                                        *
   451*  I.B.N.R. - A/H ONLY                                           *
   452*  FUTURE (ACCRUED) AH ONLY                                      *
   453*----------------------------------------------------------------*
   454*  PASSED TO ELRATE                                              *
   455*  ----------------                                              *
   456*  CERT ISSUE DATE                                               *
   457*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   458*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   459*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   460*  STATE CODE (CLIENT DEFINED)                                   *
   461*  STATE CODE (STANDARD P.O. ABBRV)                              *
   462*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   463*  DEVIATION CODE                                                *
   464*  ISSUE AGE                                                     *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  12
* EL154.cbl
   465*  ORIGINAL BENEFIT AMOUNT                                       *
   466*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   467*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   468*  BENEFIT KIND (LIFE OR A/H)                                    *
   469*  A.P.R.                                                        *
   470*  METHOD
   471*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   472*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   473*  COMPANY I.D. (3 CHARACTER)                                    *
   474*  BENEFIT CODE                                                  *
   475*  BENEFIT OVERRIDE CODE                                         *
   476*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   477*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   478*  JOINT INDICATOR (CSL ONLY)                                    *
   479*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   480*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   481*                                                                *
   482*  RETURNED FROM ELRATE                                          *
   483*  --------------------                                          *
   484*  CALCULATED PREMIUM                                            *
   485*  PREMIUM RATE                                                  *
   486*  MORTALITY CODE                                                *
   487*  MAX ATTAINED AGE                                              *
   488*  MAX AGE                                                       *
   489*  MAX TERM                                                      *
   490*  MAX MONTHLY BENEFIT                                           *
   491*  MAX TOTAL BENIFIT                                             *
   492*  COMPOSITE RATE (OPEN-END ONLY)                                *
   493*----------------------------------------------------------------*
   494*  PASSED TO ELRFND                                              *
   495*  ----------------                                              *
   496*  CERT ISSUE DATE                                               *
   497*  REFUND DATE                                                   *
   498*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   499*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   500*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   501*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   502*  STATE CODE (CLIENT DEFINED)                                   *
   503*  STATE CODE (STANDARD P.O. ABBRV)                              *
   504*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   505*  DEVIATION CODE                                                *
   506*  ISSUE AGE                                                     *
   507*  ORIGINAL BENEFIT AMOUNT                                       *
   508*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   509*  PROCESS TYPE (CANCEL)                                         *
   510*  BENEFIT KIND (LIFE OR A/H)                                    *
   511*  A.P.R.                                                        *
   512*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   513*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   514*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   515*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   516*  COMPANY I.D. (3 CHARACTER)                                    *
   517*  BENEFIT CODE                                                  *
   518*  BENEFIT OVERRIDE CODE                                         *
   519*                                                                *
   520*  RETURNED FROM ELRFND                                          *
   521*  --------------------                                          *
   522*  CALCULATED REFUND                                             *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  13
* EL154.cbl
   523*----------------------------------------------------------------*
   524*  PASSED TO ELEARN                                              *
   525*  ----------------                                              *
   526*  CERT ISSUE DATE                                               *
   527*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   528*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   529*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   530*  STATE CODE (CLIENT DEFINED)                                   *
   531*  STATE CODE (STANDARD P.O. ABBRV)                              *
   532*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   533*  DEVIATION CODE                                                *
   534*  ISSUE AGE                                                     *
   535*  ORIGINAL BENEFIT AMOUNT                                       *
   536*  BENEFIT KIND (LIFE OR A/H)                                    *
   537*  A.P.R.                                                        *
   538*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   539*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   540*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   541*  COMPANY I.D. (3 CHARACTER)                                    *
   542*  BENEFIT CODE                                                  *
   543*  BENEFIT OVERRIDE CODE                                         *
   544*                                                                *
   545*  RETURNED FROM ELEARN                                          *
   546*  --------------------                                          *
   547*  INDICATED  EARNINGS                                           *
   548*----------------------------------------------------------------*
   549*                 LENGTH = 450                                   *
   550*                                                                *
   551******************************************************************
   552******************************************************************
   553*                   C H A N G E   L O G
   554*
   555* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   556*-----------------------------------------------------------------
   557*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   558* EFFECTIVE    NUMBER
   559*-----------------------------------------------------------------
   560* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   561* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   562* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   563* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   564* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   565* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   566* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   567* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   568* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   569******************************************************************
   570
   571 01  CALCULATION-PASS-AREA.
   572     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   573                                     COMP.
   574
   575     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   576       88  NO-CP-ERROR                             VALUE ZERO.
   577       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   578                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   579       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   580       88  CP-ERROR-IN-DATES                       VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  14
* EL154.cbl
   581       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   582       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   583       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   584       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   585       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   586       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   587       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   588       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   589       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   590       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   591       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   592       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   593       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   594       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   595       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   596
   597     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   598       88  NO-CP-ERROR-2                           VALUE ZERO.
   599***********************  INPUT AREAS ****************************
   600
   601     12  CP-CALCULATION-AREA.
   602         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   603         16  CP-CERT-EFF-DT        PIC XX.
   604         16  CP-VALUATION-DT       PIC XX.
   605         16  CP-PAID-THRU-DT       PIC XX.
   606         16  CP-BENEFIT-TYPE       PIC X.
   607           88  CP-AH                               VALUE 'A' 'D'
   608                                                   'I' 'U'.
   609           88  CP-REDUCING-LIFE                    VALUE 'R'.
   610           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   611         16  CP-INCURRED-DT        PIC XX.
   612         16  CP-REPORTED-DT        PIC XX.
   613         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
   614         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   615         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   616                                     COMP-3.
   617         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   618                                     COMP-3.
   619         16  CP-CDT-METHOD         PIC X.
   620           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   621           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   622           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   623         16  CP-CLAIM-TYPE         PIC X.
   624           88  CP-AH-CLAIM                         VALUE 'A'.
   625           88  CP-LIFE-CLAIM                       VALUE 'L'.
   626         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   627                                     COMP-3.
   628         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   629                                     COMP-3.
   630         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   631                                     COMP-3.
   632         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   633                                     COMP-3.
   634         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   635                                     COMP-3.
   636         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   637                                     COMP-3.
   638         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  15
* EL154.cbl
   639                                     COMP-3.
   640         16  CP-REM-TERM-METHOD    PIC X.
   641           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   642           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   643           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   644           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   645           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   646           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   647           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   648         16  CP-EARNING-METHOD     PIC X.
   649           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   650           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   651           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   652           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   653           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   654           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   655           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   656           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   657           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   658           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   659           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   660           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   661           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   662           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   663         16  CP-PROCESS-TYPE       PIC X.
   664           88  CP-CLAIM                            VALUE '1'.
   665           88  CP-CANCEL                           VALUE '2'.
   666           88  CP-ISSUE                            VALUE '3'.
   667         16  CP-SPECIAL-CALC-CD    PIC X.
   668           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   669           88  CP-1-MTH-INTEREST               VALUE ' '.
   670           88  CP-0-MTH-INTEREST               VALUE 'A'.
   671           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
   672           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   673           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   674           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   675           88  CP-FARM-PLAN                    VALUE 'F'.
   676           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   677           88  CP-2-MTH-INTEREST               VALUE 'I'.
   678           88  CP-3-MTH-INTEREST               VALUE 'J'.
   679           88  CP-4-MTH-INTEREST               VALUE 'K'.
   680           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   681           88  CP-MORTGAGE-REC                 VALUE 'M'.
   682           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   683           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   684           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   685           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   686                                                     'W' 'X'.
   687           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   688           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   689           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   690           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   691           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   692           88  CP-SUMMARY-REC                  VALUE 'Z'.
   693           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   694           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   695           88  CP-AD-D-BENEFIT                 VALUE '4'.
   696           88  CP-CSL-METH-1                   VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  16
* EL154.cbl
   697           88  CP-CSL-METH-2                   VALUE '6'.
   698           88  CP-CSL-METH-3                   VALUE '7'.
   699           88  CP-CSL-METH-4                   VALUE '8'.
   700
   701         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   702                                     COMP-3.
   703         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   704         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   705         16  CP-STATE              PIC XX          VALUE SPACE.
   706         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   707         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   708           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   709               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   710         16  CP-R78-OPTION         PIC X.
   711           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   712           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   713
   714         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   715         16  CP-IBNR-RESERVE-SW    PIC X.
   716         16  CP-CLAIM-STATUS       PIC X.
   717         16  CP-RATE-FILE          PIC X.
   718         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   719                                     COMP-3.
   720
   721         16  CP-LIFE-OVERRIDE-CODE PIC X.
   722         16  CP-AH-OVERRIDE-CODE   PIC X.
   723
   724         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   725                                     COMP-3.
   726         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   727                                   PIC S9(5)V99 COMP-3.
   728         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   729                                     COMP-3.
   730         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   731                                     COMP-3.
   732         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   733                                     COMP-3.
   734         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   735                                  PIC S9(7)V99 COMP-3.
   736
   737         16  CP-PAID-FROM-DATE     PIC X(02).
   738         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   739         16  CP-EXT-DAYS-CALC      PIC X.
   740           88  CP-EXT-NO-CHG                   VALUE ' '.
   741           88  CP-EXT-CHG-LF                   VALUE '1'.
   742           88  CP-EXT-CHG-AH                   VALUE '2'.
   743           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   744         16  CP-DOMICILE-STATE     PIC XX.
   745         16  CP-CARRIER            PIC X.
   746         16  CP-REIN-FLAG          PIC X.
   747         16  CP-REM-TRM-CALC-OPTION PIC X.
   748           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   749                      '2' '3' '4' '5'.
   750           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   751           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   752           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   753           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   754           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  17
* EL154.cbl
   755           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   756           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   757           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   758         16  CP-SIG-SWITCH         PIC X.
   759         16  CP-RATING-METHOD      PIC X.
   760           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   761           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   762           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   763           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   764           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   765           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   766           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   767           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   768           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   769         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   770                                     COMP-3.
   771         16  CP-BEN-CATEGORY       PIC X.
   772         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   773         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   774                                   PIC S99V9(5) COMP-3.
   775         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   776         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   777                                   PIC S99V9(5) COMP-3.
   778         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   779         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   780         16  CP-EXPIRE-DT          PIC XX.
   781         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   782         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   783         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   784         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   785         16  CP-DDF-SPEC-CALC      PIC X.
   786             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   787             88  CP-CALC-CLP              VALUE 'C'.
   788         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   789         16  CP-CANCEL-REASON      PIC X.
   790         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   791         16  CP-PMT-MODE           PIC X.
   792         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   793         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   794         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   795         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   796         16  FILLER                PIC X.
   797
   798***************    OUTPUT FROM ELRESV   ************************
   799
   800         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   801
   802         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   803                                     COMP-3.
   804         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   805                                     COMP-3.
   806         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   807                                     COMP-3.
   808         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   809                                     COMP-3.
   810         16  FILLER                PIC X(09).
   811***************    OUTPUT FROM ELRTRM   *************************
   812
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  18
* EL154.cbl
   813         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   814                                     COMP-3.
   815         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   816                                     COMP-3.
   817         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   818                                     COMP-3.
   819         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   820                                     COMP-3.
   821         16  FILLER                PIC X(12).
   822
   823***************    OUTPUT FROM ELRAMT   *************************
   824
   825         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   826                                     COMP-3.
   827         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   828                                     COMP-3.
   829         16  FILLER                PIC X(12).
   830
   831***************    OUTPUT FROM ELRATE   *************************
   832
   833         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
   834                                     COMP-3.
   835         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
   836                                     COMP-3.
   837         16  CP-MORTALITY-CODE     PIC X(4).
   838         16  CP-RATE-EDIT-FLAG     PIC X.
   839             88  CP-RATES-NEED-APR                  VALUE '1'.
   840         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
   841                                     COMP-3.
   842         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
   843         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   844         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   845                                   PIC S9(7)V99 COMP-3.
   846         16  FILLER                PIC X(07).
   847
   848***************    OUTPUT FROM ELRFND   *************************
   849
   850         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
   851                                     COMP-3.
   852         16  CP-REFUND-TYPE-USED   PIC X.
   853           88  CP-R-AS-R78                         VALUE '1'.
   854           88  CP-R-AS-PRORATA                     VALUE '2'.
   855           88  CP-R-AS-CALIF                       VALUE '3'.
   856           88  CP-R-AS-TEXAS                       VALUE '4'.
   857           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
   858           88  CP-R-AS-NET-PAY                     VALUE '5'.
   859           88  CP-R-AS-ANTICIPATION                VALUE '6'.
   860           88  CP-R-AS-MEAN                        VALUE '8'.
   861           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
   862           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   863           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   864           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   865           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   866           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   867         16  FILLER                PIC X(12).
   868
   869***************    OUTPUT FROM ELEARN   *************************
   870
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  19
* EL154.cbl
   871         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
   872                                     COMP-3.
   873         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
   874                                     COMP-3.
   875         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
   876                                     COMP-3.
   877         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
   878                                     COMP-3.
   879         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
   880                                     COMP-3.
   881         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
   882                                     COMP-3.
   883         16  CP-EARNING-TYPE-USED  PIC X.
   884           88  CP-E-AS-SPECIAL                     VALUE 'S'.
   885           88  CP-E-AS-R78                         VALUE '1'.
   886           88  CP-E-AS-PRORATA                     VALUE '2'.
   887           88  CP-E-AS-TEXAS                       VALUE '4'.
   888           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
   889           88  CP-E-AS-NET-PAY                     VALUE '5'.
   890           88  CP-E-AS-ANTICIPATION                VALUE '6'.
   891           88  CP-E-AS-MEAN                        VALUE '8'.
   892           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
   893         16  FILLER                PIC X(12).
   894
   895***************    OUTPUT FROM ELPMNT   *************************
   896
   897         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
   898                                     COMP-3.
   899         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
   900                                     COMP-3.
   901         16  FILLER                PIC X(12).
   902
   903***************   MISC WORK AREAS    *****************************
   904         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
   905                                     COMP-3.
   906         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
   907                                     COMP-3.
   908         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
   909                                     COMP-3.
   910         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
   911                                     COMP-3.
   912         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
   913                                     COMP-3.
   914         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
   915                                     COMP-3.
   916         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
   917             88  OPEN-RATE-FILE                   VALUE 'O'.
   918             88  CLOSE-RATE-FILE                  VALUE 'C'.
   919             88  IO-ERROR                         VALUE 'E'.
   920
   921         16  CP-FIRST-PAY-DATE     PIC XX.
   922
   923         16  CP-JOINT-INDICATOR    PIC X.
   924
   925         16  CP-RESERVE-REMAINING-TERM
   926                                   PIC S9(4)V9    VALUE ZERO
   927                                     COMP-3.
   928
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  20
* EL154.cbl
   929         16  CP-INSURED-BIRTH-DT   PIC XX.
   930
   931         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
   932                                     COMP-3.
   933
   934         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
   935                                     COMP-3.
   936
   937         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
   938                                     COMP-3.
   939
   940         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
   941                                     COMP-3.
   942
   943         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
   944                                     COMP-3.
   945
   946         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
   947                                     COMP-3.
   948
   949         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
   950                                     COMP-3.
   951
   952         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
   953             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
   954
   955         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
   956                                     COMP-3.
   957         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
   958                                     COMP-3.
   959         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
   960         16  FILLER                PIC X(15).
   961******************************************************************
   962
   963
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  21
* EL154.cbl
   965*                            COPY ELCDATE.
   966******************************************************************
   967*                                                                *
   968*                                                                *
   969*                            ELCDATE.                            *
   970*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   971*                            VMOD=2.003
   972*                                                                *
   973*                                                                *
   974*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   975*                 LENGTH = 200                                   *
   976******************************************************************
   977
   978 01  DATE-CONVERSION-DATA.
   979     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   980     12  DC-OPTION-CODE                PIC X.
   981         88  BIN-TO-GREG                VALUE ' '.
   982         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   983         88  EDIT-GREG-TO-BIN           VALUE '2'.
   984         88  YMD-GREG-TO-BIN            VALUE '3'.
   985         88  MDY-GREG-TO-BIN            VALUE '4'.
   986         88  JULIAN-TO-BIN              VALUE '5'.
   987         88  BIN-PLUS-ELAPSED           VALUE '6'.
   988         88  FIND-CENTURY               VALUE '7'.
   989         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   990         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   991         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   992         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   993         88  JULIAN-TO-BIN-3            VALUE 'C'.
   994         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   995         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   996         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   997         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   998         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   999         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1000         88  BIN-3-TO-GREG              VALUE 'I'.
  1001         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1002         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1003         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1004         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1005         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1006         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1007         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1008         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1009         88  THREE-CHARACTER-BIN
  1010                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1011         88  GREGORIAN-TO-BIN
  1012                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1013         88  BIN-TO-GREGORIAN
  1014                  VALUES ' ' '1' 'I' '8' 'G'.
  1015         88  JULIAN-TO-BINARY
  1016                  VALUES '5' 'C' 'E' 'F'.
  1017     12  DC-ERROR-CODE                 PIC X.
  1018         88  NO-CONVERSION-ERROR        VALUE ' '.
  1019         88  DATE-CONVERSION-ERROR
  1020                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1021         88  DATE-IS-ZERO               VALUE '1'.
  1022         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  22
* EL154.cbl
  1023         88  DATE-IS-INVALID            VALUE '3'.
  1024         88  DATE1-GREATER-DATE2        VALUE '4'.
  1025         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1026         88  DATE-INVALID-OPTION        VALUE '9'.
  1027         88  INVALID-CENTURY            VALUE 'A'.
  1028         88  ONLY-CENTURY               VALUE 'B'.
  1029         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1030         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1031     12  DC-END-OF-MONTH               PIC X.
  1032         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1033     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1034         88  USE-NORMAL-PROCESS         VALUE ' '.
  1035         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1036         88  ADJUST-UP-100-YRS          VALUE '2'.
  1037     12  FILLER                        PIC X.
  1038     12  DC-CONVERSION-DATES.
  1039         16  DC-BIN-DATE-1             PIC XX.
  1040         16  DC-BIN-DATE-2             PIC XX.
  1041         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1042         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1043                       DC-GREG-DATE-1-EDIT.
  1044             20  DC-EDIT1-MONTH        PIC 99.
  1045             20  SLASH1-1              PIC X.
  1046             20  DC-EDIT1-DAY          PIC 99.
  1047             20  SLASH1-2              PIC X.
  1048             20  DC-EDIT1-YEAR         PIC 99.
  1049         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1050         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1051                     DC-GREG-DATE-2-EDIT.
  1052             20  DC-EDIT2-MONTH        PIC 99.
  1053             20  SLASH2-1              PIC X.
  1054             20  DC-EDIT2-DAY          PIC 99.
  1055             20  SLASH2-2              PIC X.
  1056             20  DC-EDIT2-YEAR         PIC 99.
  1057         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1058         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1059                     DC-GREG-DATE-1-YMD.
  1060             20  DC-YMD-YEAR           PIC 99.
  1061             20  DC-YMD-MONTH          PIC 99.
  1062             20  DC-YMD-DAY            PIC 99.
  1063         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1064         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1065                      DC-GREG-DATE-1-MDY.
  1066             20  DC-MDY-MONTH          PIC 99.
  1067             20  DC-MDY-DAY            PIC 99.
  1068             20  DC-MDY-YEAR           PIC 99.
  1069         16  DC-GREG-DATE-1-ALPHA.
  1070             20  DC-ALPHA-MONTH        PIC X(10).
  1071             20  DC-ALPHA-DAY          PIC 99.
  1072             20  FILLER                PIC XX.
  1073             20  DC-ALPHA-CENTURY.
  1074                 24 DC-ALPHA-CEN-N     PIC 99.
  1075             20  DC-ALPHA-YEAR         PIC 99.
  1076         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1077         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1078         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1079         16  DC-JULIAN-DATE            PIC 9(05).
  1080         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  23
* EL154.cbl
  1081                                       PIC 9(05).
  1082         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1083             20  DC-JULIAN-YEAR        PIC 99.
  1084             20  DC-JULIAN-DAYS        PIC 999.
  1085         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1086         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1087         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1088     12  DATE-CONVERSION-VARIBLES.
  1089         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1090         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1091             20  FILLER                PIC 9(3).
  1092             20  HOLD-CEN-1-CCYY.
  1093                 24  HOLD-CEN-1-CC     PIC 99.
  1094                 24  HOLD-CEN-1-YY     PIC 99.
  1095             20  HOLD-CEN-1-MO         PIC 99.
  1096             20  HOLD-CEN-1-DA         PIC 99.
  1097         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1098             20  HOLD-CEN-1-R-MO       PIC 99.
  1099             20  HOLD-CEN-1-R-DA       PIC 99.
  1100             20  HOLD-CEN-1-R-CCYY.
  1101                 24  HOLD-CEN-1-R-CC   PIC 99.
  1102                 24  HOLD-CEN-1-R-YY   PIC 99.
  1103             20  FILLER                PIC 9(3).
  1104         16  HOLD-CENTURY-1-X.
  1105             20  FILLER                PIC X(3)  VALUE SPACES.
  1106             20  HOLD-CEN-1-X-CCYY.
  1107                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1108                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1109             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1110             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1111         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1112             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1113             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1114             20  HOLD-CEN-1-R-X-CCYY.
  1115                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1116                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1117             20  FILLER                PIC XXX.
  1118         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1119         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1120         16  DC-JULIAN-DATE-1          PIC 9(07).
  1121         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1122             20  DC-JULIAN-1-CCYY.
  1123                 24  DC-JULIAN-1-CC    PIC 99.
  1124                 24  DC-JULIAN-1-YR    PIC 99.
  1125             20  DC-JULIAN-DA-1        PIC 999.
  1126         16  DC-JULIAN-DATE-2          PIC 9(07).
  1127         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1128             20  DC-JULIAN-2-CCYY.
  1129                 24  DC-JULIAN-2-CC    PIC 99.
  1130                 24  DC-JULIAN-2-YR    PIC 99.
  1131             20  DC-JULIAN-DA-2        PIC 999.
  1132         16  DC-GREG-DATE-A-EDIT.
  1133             20  DC-EDITA-MONTH        PIC 99.
  1134             20  SLASHA-1              PIC X VALUE '/'.
  1135             20  DC-EDITA-DAY          PIC 99.
  1136             20  SLASHA-2              PIC X VALUE '/'.
  1137             20  DC-EDITA-CCYY.
  1138                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  24
* EL154.cbl
  1139                 24  DC-EDITA-YEAR     PIC 99.
  1140         16  DC-GREG-DATE-B-EDIT.
  1141             20  DC-EDITB-MONTH        PIC 99.
  1142             20  SLASHB-1              PIC X VALUE '/'.
  1143             20  DC-EDITB-DAY          PIC 99.
  1144             20  SLASHB-2              PIC X VALUE '/'.
  1145             20  DC-EDITB-CCYY.
  1146                 24  DC-EDITB-CENT     PIC 99.
  1147                 24  DC-EDITB-YEAR     PIC 99.
  1148         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1149         16  DC-GREG-DATE-CYMD-R REDEFINES
  1150                              DC-GREG-DATE-CYMD.
  1151             20  DC-CYMD-CEN           PIC 99.
  1152             20  DC-CYMD-YEAR          PIC 99.
  1153             20  DC-CYMD-MONTH         PIC 99.
  1154             20  DC-CYMD-DAY           PIC 99.
  1155         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1156         16  DC-GREG-DATE-MDCY-R REDEFINES
  1157                              DC-GREG-DATE-MDCY.
  1158             20  DC-MDCY-MONTH         PIC 99.
  1159             20  DC-MDCY-DAY           PIC 99.
  1160             20  DC-MDCY-CEN           PIC 99.
  1161             20  DC-MDCY-YEAR          PIC 99.
  1162    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1163        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1164    12  DC-EL310-DATE                  PIC X(21).
  1165    12  FILLER                         PIC X(28).
  1166
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  25
* EL154.cbl
  1168*                            COPY ELCLOGOF.
  1169******************************************************************
  1170*                                                                *
  1171*                                                                *
  1172*                            ELCLOGOF.                           *
  1173*                            VMOD=2.001                          *
  1174*                                                                *
  1175*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1176*                                                                *
  1177******************************************************************
  1178 01  CLASIC-LOGOFF.
  1179     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1180     12  LOGOFF-TEXT.
  1181         16  FILLER          PIC X(5)    VALUE SPACES.
  1182         16  LOGOFF-MSG.
  1183             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1184             20  FILLER      PIC X       VALUE SPACES.
  1185             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1186         16  FILLER          PIC X(80)
  1187           VALUE '* YOU ARE NOW LOGGED OFF'.
  1188         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1189         16  FILLER          PIC X       VALUE QUOTE.
  1190         16  LOGOFF-SYS-MSG  PIC X(17)
  1191           VALUE 'S CLAS-IC SYSTEM '.
  1192     12  TEXT-MESSAGES.
  1193         16  UNACCESS-MSG    PIC X(29)
  1194             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1195         16  PGMIDERR-MSG    PIC X(17)
  1196             VALUE 'PROGRAM NOT FOUND'.
  1197
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  26
* EL154.cbl
  1199*                            COPY ELCATTR.
  1200******************************************************************
  1201*                                                                *
  1202*                            ELCATTR.                            *
  1203*                            VMOD=2.001                          *
  1204*                                                                *
  1205*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1206*                                                                *
  1207*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1208*                                                                *
  1209*                   POS 1   P=PROTECTED                          *
  1210*                           U=UNPROTECTED                        *
  1211*                           S=ASKIP                              *
  1212*                   POS 2   A=ALPHA/NUMERIC                      *
  1213*                           N=NUMERIC                            *
  1214*                   POS 3   N=NORMAL                             *
  1215*                           B=BRIGHT                             *
  1216*                           D=DARK                               *
  1217*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1218*                           OF=MODIFIED DATA TAG OFF             *
  1219*                                                                *
  1220*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1221******************************************************************
  1222 01  ATTRIBUTE-LIST.
  1223     12  AL-PABOF            PIC X       VALUE 'Y'.
  1224     12  AL-PABON            PIC X       VALUE 'Z'.
  1225     12  AL-PADOF            PIC X       VALUE '%'.
  1226     12  AL-PADON            PIC X       VALUE '_'.
  1227     12  AL-PANOF            PIC X       VALUE '-'.
  1228     12  AL-PANON            PIC X       VALUE '/'.
  1229     12  AL-SABOF            PIC X       VALUE '8'.
  1230     12  AL-SABON            PIC X       VALUE '9'.
  1231     12  AL-SADOF            PIC X       VALUE '@'.
  1232     12  AL-SADON            PIC X       VALUE QUOTE.
  1233     12  AL-SANOF            PIC X       VALUE '0'.
  1234     12  AL-SANON            PIC X       VALUE '1'.
  1235     12  AL-UABOF            PIC X       VALUE 'H'.
  1236     12  AL-UABON            PIC X       VALUE 'I'.
  1237     12  AL-UADOF            PIC X       VALUE '<'.
  1238     12  AL-UADON            PIC X       VALUE '('.
  1239     12  AL-UANOF            PIC X       VALUE ' '.
  1240     12  AL-UANON            PIC X       VALUE 'A'.
  1241     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1242     12  AL-UNBON            PIC X       VALUE 'R'.
  1243     12  AL-UNDOF            PIC X       VALUE '*'.
  1244     12  AL-UNDON            PIC X       VALUE ')'.
  1245     12  AL-UNNOF            PIC X       VALUE '&'.
  1246     12  AL-UNNON            PIC X       VALUE 'J'.
  1247
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  27
* EL154.cbl
  1249*                            COPY ELCEMIB.
  1250******************************************************************
  1251*                                                                *
  1252*                                                                *
  1253*                            ELCEMIB.                            *
  1254*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1255*                            VMOD=2.005                          *
  1256*                                                                *
  1257*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1258*                                                                *
  1259******************************************************************
  1260 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1261     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1262     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1263     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1264     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1265     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1266     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1267     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1268     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1269     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1270         88  EMI-NO-ERRORS                    VALUE '1'.
  1271         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1272         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1273     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1274         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1275     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1276         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1277         88  EMI-AREA1-FULL                   VALUE '2'.
  1278     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1279         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1280         88  EMI-AREA2-FULL                   VALUE '2'.
  1281     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1282         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1283         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1284         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1285         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1286         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1287     12  EMI-ERROR-LINES.
  1288         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1289         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1290         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1291         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1292             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1293                 24  EMI-ERR-NUM         PIC X(4).
  1294                 24  EMI-FILLER          PIC X.
  1295                 24  EMI-SEV             PIC X.
  1296                 24  FILLER              PIC X.
  1297             20  FILLER                  PIC X(02).
  1298     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1299         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1300             20  EMI-ERROR-NUMBER    PIC X(4).
  1301             20  EMI-FILL            PIC X.
  1302             20  EMI-SEVERITY        PIC X.
  1303             20  FILLER              PIC X.
  1304             20  EMI-ERROR-TEXT.
  1305                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1306                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  28
* EL154.cbl
  1307     12  EMI-SEVERITY-SAVE           PIC X.
  1308         88  EMI-NOTE                    VALUE 'N'.
  1309         88  EMI-WARNING                 VALUE 'W'.
  1310         88  EMI-FORCABLE                VALUE 'F'.
  1311         88  EMI-FATAL                   VALUE 'X'.
  1312     12  EMI-MESSAGE-FLAG            PIC X.
  1313         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1314         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1315     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1316     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1317         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1318         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1319         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1320     12  emi-claim-no                pic x(7).
  1321     12  emi-claim-type              pic x(6).
  1322     12  FILLER                      PIC X(124)  VALUE SPACES.
  1323     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1324     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1325     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1326     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  29
* EL154.cbl
  1328*                            COPY ELCLNKLT.
  1329******************************************************************
  1330*                                                                *
  1331*                                                                *
  1332*                           ELCLNKLT                             *
  1333*                            VMOD=2.003                          *
  1334*                                                                *
  1335*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1336*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1337*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1338*                                                                *
  1339*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1340*   COMPLETING THE REQUIRED FIELDS.                              *
  1341*                                                                *
  1342*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1343*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1344*                              9999 INDICATES AN UNKNOWN ABEND   *
  1345*                                   WAS DETECTED.                *
  1346*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1347*                              CODES FOUND IN THE ERROR FILE.    *
  1348******************************************************************
  1349 01  W-1523-LINKDATA.
  1350     12  W-1523-COMMON-PI-DATA.
  1351         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1352         16  FILLER              PIC  X(67).
  1353         16  W-1523-COMPANY-CD   PIC  X(01).
  1354         16  FILLER              PIC  X(10).
  1355         16  W-1523-CONTROL-IN-PROGRESS.
  1356             20  W-1523-CARRIER  PIC  X(01).
  1357             20  W-1523-GROUPING PIC  X(06).
  1358             20  W-1523-STATE    PIC  X(02).
  1359             20  W-1523-ACCOUNT  PIC  X(10).
  1360             20  W-1523-CLAIM-CERT-GRP.
  1361                 24  W-1523-CLAIM-NO
  1362                                 PIC  X(07).
  1363                 24  W-1523-CERT-NO.
  1364                     28  W-1523-CERT-PRIME
  1365                                 PIC  X(10).
  1366                     28  W-1523-CERT-SFX
  1367                                 PIC  X(01).
  1368                 24  W-1523-CERT-EFF-DT
  1369                                 PIC  X(02).
  1370         16  FILLER              PIC X(265).
  1371
  1372     12  W-1523-WORK-AREA.
  1373         16  W-1523-FORM-NUMBER  PIC  X(04).
  1374         16  W-1523-NUMBER-COPIES
  1375                                 PIC  9(01).
  1376         16  W-1523-ADDR-TYPE    PIC  X(02).
  1377         16  W-1523-FOLLOW-UP-DATE
  1378                                 PIC  X(02).
  1379         16  W-1523-RESEND-DATE  PIC  X(02).
  1380         16  W-1523-ERROR-CODE   PIC  9(04).
  1381             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1382             88  W-1523-FATAL-ERROR
  1383                                    VALUES  0006 0013 0042
  1384                                            0154 0168 0169
  1385                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  30
* EL154.cbl
  1386                                            0179 0186 0281
  1387                                            0332 2055 3697
  1388                                            3698 3699 3770
  1389                                            3771 3772 7675
  1390                                            9106 9808 9883
  1391                                            9887.
  1392             88  W-1523-STOP-ERRORS
  1393                                    VALUES  0013 0042 0154
  1394                                            0168 0169 0172
  1395                                            0281 0332 2055
  1396                                            3698 3699 7675
  1397                                            9106 9808 9883
  1398                                            9999.
  1399         16  W-1523-REASON       PIC  X(70).
  1400         16  W-1523-ARCHIVE-NUMBER
  1401                                 PIC  9(08).
  1402     12  W-1523-POINTER-AREA.
  1403         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1404         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  1405         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  1406         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  1407         16  W-1523-PROD-POINTER PIC S9(08) COMP.
  1408
  1409     12  W-1523-LETTER-DATE       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  31
* EL154.cbl
  1411*                            COPY ELCINTF.
  1412******************************************************************
  1413*                                                                *
  1414*                                                                *
  1415*                            ELCINTF.                            *
  1416*                            VMOD=2.017                          *
  1417*                                                                *
  1418*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1419*                                                                *
  1420*       LENGTH = 1024                                            *
  1421*                                                                *
  1422******************************************************************
  1423*                   C H A N G E   L O G
  1424*
  1425* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1426*-----------------------------------------------------------------
  1427*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1428* EFFECTIVE    NUMBER
  1429*-----------------------------------------------------------------
  1430* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1431******************************************************************
  1432 01  PROGRAM-INTERFACE-BLOCK.
  1433     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1434     12  PI-CALLING-PROGRAM              PIC X(8).
  1435     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1436     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1437     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1438     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1439     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1440     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1441     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1442     12  PI-COMPANY-ID                   PIC XXX.
  1443     12  PI-COMPANY-CD                   PIC X.
  1444
  1445     12  PI-COMPANY-PASSWORD             PIC X(8).
  1446
  1447     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1448
  1449     12  PI-CONTROL-IN-PROGRESS.
  1450         16  PI-CARRIER                  PIC X.
  1451         16  PI-GROUPING                 PIC X(6).
  1452         16  PI-STATE                    PIC XX.
  1453         16  PI-ACCOUNT                  PIC X(10).
  1454         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1455                                         PIC X(10).
  1456         16  PI-CLAIM-CERT-GRP.
  1457             20  PI-CLAIM-NO             PIC X(7).
  1458             20  PI-CERT-NO.
  1459                 25  PI-CERT-PRIME       PIC X(10).
  1460                 25  PI-CERT-SFX         PIC X.
  1461             20  PI-CERT-EFF-DT          PIC XX.
  1462         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1463             20  PI-PLAN-CODE            PIC X(2).
  1464             20  PI-REVISION-NUMBER      PIC X(3).
  1465             20  PI-PLAN-EFF-DT          PIC X(2).
  1466             20  PI-PLAN-EXP-DT          PIC X(2).
  1467             20  FILLER                  PIC X(11).
  1468         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  32
* EL154.cbl
  1469             20  PI-OE-REFERENCE-1.
  1470                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1471                 25  PI-OE-REF-1-SUFF    PIC XX.
  1472
  1473     12  PI-SESSION-IN-PROGRESS          PIC X.
  1474         88  CLAIM-SESSION                   VALUE '1'.
  1475         88  CREDIT-SESSION                  VALUE '2'.
  1476         88  WARRANTY-SESSION                VALUE '3'.
  1477         88  MORTGAGE-SESSION                VALUE '4'.
  1478         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1479
  1480
  1481*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1482
  1483     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1484     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1485
  1486     12  PI-CREDIT-USER                  PIC X.
  1487         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1488         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1489
  1490     12  PI-CLAIM-USER                   PIC X.
  1491         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1492         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1493
  1494     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1495         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1496         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1497         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1498         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1499         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1500
  1501     12  PI-PROCESSOR-ID                 PIC X(4).
  1502
  1503     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1504
  1505     12  PI-MEMBER-CAPTION               PIC X(10).
  1506
  1507     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1508         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1509
  1510     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1511     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1512     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1513     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1514
  1515     12  PI-AH-OVERRIDE-L1               PIC X.
  1516     12  PI-AH-OVERRIDE-L2               PIC XX.
  1517     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1518     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1519
  1520     12  PI-NEW-SYSTEM                   PIC X(2).
  1521
  1522     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1523     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1524         88  PI-USES-PAID-TO                 VALUE '1'.
  1525     12  PI-CRDTCRD-SYSTEM.
  1526         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  33
* EL154.cbl
  1527             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1528             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1529         16  PI-CC-MONTH-END-DT          PIC XX.
  1530     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1531
  1532     12  PI-OE-REFERENCE-2.
  1533         16  PI-OE-REF-2-PRIME           PIC X(10).
  1534         16  PI-OE-REF-2-SUFF            PIC X.
  1535
  1536     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1537
  1538     12  PI-LANGUAGE-TYPE                PIC X.
  1539             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1540             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1541             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1542
  1543     12  PI-POLICY-LINKAGE-IND           PIC X.
  1544         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1545         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1546                                                   LOW-VALUES.
  1547
  1548     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1549     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1550         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1551         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1552
  1553     12  PI-PROCESSOR-CSR-IND            PIC X.
  1554         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1555         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1556
  1557     12  FILLER                          PIC X(3).
  1558
  1559     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1560
  1561     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1562         PI-SYSTEM-LEVEL.
  1563
  1564         16  PI-ENTRY-CODES.
  1565             20  PI-ENTRY-CD-1           PIC X.
  1566             20  PI-ENTRY-CD-2           PIC X.
  1567
  1568         16  PI-RETURN-CODES.
  1569             20  PI-RETURN-CD-1          PIC X.
  1570             20  PI-RETURN-CD-2          PIC X.
  1571
  1572         16  PI-UPDATE-STATUS-SAVE.
  1573             20  PI-UPDATE-BY            PIC X(4).
  1574             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1575
  1576         16  PI-LOWER-CASE-LETTERS       PIC X.
  1577             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1578
  1579*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1580*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1581*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1582
  1583         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1584             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  34
* EL154.cbl
  1585             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1586             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1587             88  ACCNT-CNTL                  VALUE '3'.
  1588             88  CARR-ACCNT-CNTL             VALUE '4'.
  1589
  1590         16  PI-PROCESSOR-CAP-LIST.
  1591             20  PI-SYSTEM-CONTROLS.
  1592                24 PI-SYSTEM-DISPLAY     PIC X.
  1593                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1594                24 PI-SYSTEM-MODIFY      PIC X.
  1595                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1596             20  FILLER                  PIC XX.
  1597             20  PI-DISPLAY-CAP          PIC X.
  1598                 88  DISPLAY-CAP             VALUE 'Y'.
  1599             20  PI-MODIFY-CAP           PIC X.
  1600                 88  MODIFY-CAP              VALUE 'Y'.
  1601             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1602                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1603             20  PI-FORCE-CAP            PIC X.
  1604                 88  FORCE-CAP               VALUE 'Y'.
  1605
  1606         16  PI-PROGRAM-CONTROLS.
  1607             20  PI-PGM-PRINT-OPT        PIC X.
  1608             20  PI-PGM-FORMAT-OPT       PIC X.
  1609             20  PI-PGM-PROCESS-OPT      PIC X.
  1610             20  PI-PGM-TOTALS-OPT       PIC X.
  1611
  1612         16  PI-HELP-INTERFACE.
  1613             20  PI-LAST-ERROR-NO        PIC X(4).
  1614             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1615
  1616         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1617             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1618
  1619         16  PI-CR-CONTROL-IN-PROGRESS.
  1620             20  PI-CR-CARRIER           PIC X.
  1621             20  PI-CR-GROUPING          PIC X(6).
  1622             20  PI-CR-STATE             PIC XX.
  1623             20  PI-CR-ACCOUNT           PIC X(10).
  1624             20  PI-CR-FIN-RESP          PIC X(10).
  1625             20  PI-CR-TYPE              PIC X.
  1626
  1627         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1628
  1629         16  PI-CR-MONTH-END-DT          PIC XX.
  1630
  1631         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1632             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1633             88  PI-ZERO-CARRIER             VALUE '1'.
  1634             88  PI-ZERO-GROUPING            VALUE '2'.
  1635             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1636
  1637         16  PI-CARRIER-SECURITY         PIC X.
  1638             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1639
  1640         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1641             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1642             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  35
* EL154.cbl
  1643
  1644         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1645             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1646                                         INDEXED BY PI-ACCESS-NDX
  1647                                         PIC X.
  1648
  1649         16  PI-GA-BILLING-CONTROL       PIC X.
  1650             88  PI-GA-BILLING               VALUE '1'.
  1651
  1652         16  PI-MAIL-PROCESSING          PIC X.
  1653             88  PI-MAIL-YES                 VALUE 'Y'.
  1654
  1655         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1656
  1657         16  PI-AR-SYSTEM.
  1658             20  PI-AR-PROCESSING-CNTL   PIC X.
  1659                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1660             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1661             20  PI-AR-MONTH-END-DT      PIC XX.
  1662
  1663         16  PI-MP-SYSTEM.
  1664             20  PI-MORTGAGE-USER            PIC X.
  1665                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1666                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1667             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1668                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1669                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1670                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1671                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1672                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1673             20  PI-MP-MONTH-END-DT          PIC XX.
  1674             20  PI-MP-REFERENCE-NO.
  1675                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1676                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1677
  1678         16  PI-LABEL-CONTROL            PIC X(01).
  1679             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1680             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1681
  1682         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1683             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1684
  1685         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1686             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1687             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1688
  1689         16  FILLER                      PIC X(14).
  1690
  1691     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1692******************************************************************
  1693     12  PI-REDEF       REDEFINES PI-PROGRAM-WORK-AREA.
  1694         16  PI-BENEFIT-SAVE.
  1695             18  PI-BEN-DAYS      PIC 99.
  1696             18  PI-BEN-TYPE      PIC X.
  1697*00269   16  FILLER               PIC X(637).
  1698         16  PI-AUTO-END-LETTER   PIC X(04).
  1699         16  FILLER               PIC X(633).
  1700
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  36
* EL154.cbl
  1702*                            COPY ELCAID.
  1703******************************************************************
  1704*                                                                *
  1705*                            ELCAID.                             *
  1706*                            VMOD=2.001                          *
  1707*                                                                *
  1708*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1709*                                                                *
  1710*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1711*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1712******************************************************************
  1713
  1714 01  DFHAID.
  1715   02  DFHNULL   PIC  X  VALUE  ' '.
  1716   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1717   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1718   02  DFHPEN    PIC  X  VALUE  '='.
  1719   02  DFHOPID   PIC  X  VALUE  'W'.
  1720   02  DFHPA1    PIC  X  VALUE  '%'.
  1721   02  DFHPA2    PIC  X  VALUE  '>'.
  1722   02  DFHPA3    PIC  X  VALUE  ','.
  1723   02  DFHPF1    PIC  X  VALUE  '1'.
  1724   02  DFHPF2    PIC  X  VALUE  '2'.
  1725   02  DFHPF3    PIC  X  VALUE  '3'.
  1726   02  DFHPF4    PIC  X  VALUE  '4'.
  1727   02  DFHPF5    PIC  X  VALUE  '5'.
  1728   02  DFHPF6    PIC  X  VALUE  '6'.
  1729   02  DFHPF7    PIC  X  VALUE  '7'.
  1730   02  DFHPF8    PIC  X  VALUE  '8'.
  1731   02  DFHPF9    PIC  X  VALUE  '9'.
  1732   02  DFHPF10   PIC  X  VALUE  ':'.
  1733   02  DFHPF11   PIC  X  VALUE  '#'.
  1734   02  DFHPF12   PIC  X  VALUE  '@'.
  1735   02  DFHPF13   PIC  X  VALUE  'A'.
  1736   02  DFHPF14   PIC  X  VALUE  'B'.
  1737   02  DFHPF15   PIC  X  VALUE  'C'.
  1738   02  DFHPF16   PIC  X  VALUE  'D'.
  1739   02  DFHPF17   PIC  X  VALUE  'E'.
  1740   02  DFHPF18   PIC  X  VALUE  'F'.
  1741   02  DFHPF19   PIC  X  VALUE  'G'.
  1742   02  DFHPF20   PIC  X  VALUE  'H'.
  1743   02  DFHPF21   PIC  X  VALUE  'I'.
  1744*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1745   02  DFHPF22   PIC  X  VALUE  '['.
  1746   02  DFHPF23   PIC  X  VALUE  '.'.
  1747   02  DFHPF24   PIC  X  VALUE  '<'.
  1748   02  DFHMSRE   PIC  X  VALUE  'X'.
  1749   02  DFHSTRF   PIC  X  VALUE  'h'.
  1750   02  DFHTRIG   PIC  X  VALUE  '"'.
  1751 01  FILLER    REDEFINES DFHAID.
  1752     12  FILLER              PIC X(8).
  1753     12  PF-VALUES           PIC X       OCCURS 2.
  1754
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  37
* EL154.cbl
  1756*                            COPY EL154S.
  1757 01  EL154AI.
  1758     05  FILLER            PIC  X(0012).
  1759*    -------------------------------
  1760     05  RUNDTEL PIC S9(0004) COMP.
  1761     05  RUNDTEF PIC  X(0001).
  1762     05  FILLER REDEFINES RUNDTEF.
  1763         10  RUNDTEA PIC  X(0001).
  1764     05  RUNDTEI PIC  X(0008).
  1765*    -------------------------------
  1766     05  RUNTIMEL PIC S9(0004) COMP.
  1767     05  RUNTIMEF PIC  X(0001).
  1768     05  FILLER REDEFINES RUNTIMEF.
  1769         10  RUNTIMEA PIC  X(0001).
  1770     05  RUNTIMEI PIC  X(0005).
  1771*    -------------------------------
  1772     05  CLAIML PIC S9(0004) COMP.
  1773     05  CLAIMF PIC  X(0001).
  1774     05  FILLER REDEFINES CLAIMF.
  1775         10  CLAIMA PIC  X(0001).
  1776     05  CLAIMI PIC  X(0007).
  1777*    -------------------------------
  1778     05  CARRL PIC S9(0004) COMP.
  1779     05  CARRF PIC  X(0001).
  1780     05  FILLER REDEFINES CARRF.
  1781         10  CARRA PIC  X(0001).
  1782     05  CARRI PIC  X(0001).
  1783*    -------------------------------
  1784     05  CERTL PIC S9(0004) COMP.
  1785     05  CERTF PIC  X(0001).
  1786     05  FILLER REDEFINES CERTF.
  1787         10  CERTA PIC  X(0001).
  1788     05  CERTI PIC  X(0010).
  1789*    -------------------------------
  1790     05  SUFFIXL PIC S9(0004) COMP.
  1791     05  SUFFIXF PIC  X(0001).
  1792     05  FILLER REDEFINES SUFFIXF.
  1793         10  SUFFIXA PIC  X(0001).
  1794     05  SUFFIXI PIC  X(0001).
  1795*    -------------------------------
  1796     05  CESTDTEL PIC S9(0004) COMP.
  1797     05  CESTDTEF PIC  X(0001).
  1798     05  FILLER REDEFINES CESTDTEF.
  1799         10  CESTDTEA PIC  X(0001).
  1800     05  CESTDTEI PIC  X(0008).
  1801*    -------------------------------
  1802     05  CESTBYL PIC S9(0004) COMP.
  1803     05  CESTBYF PIC  X(0001).
  1804     05  FILLER REDEFINES CESTBYF.
  1805         10  CESTBYA PIC  X(0001).
  1806     05  CESTBYI PIC  X(0004).
  1807*    -------------------------------
  1808     05  FSTHD1L PIC S9(0004) COMP.
  1809     05  FSTHD1F PIC  X(0001).
  1810     05  FILLER REDEFINES FSTHD1F.
  1811         10  FSTHD1A PIC  X(0001).
  1812     05  FSTHD1I PIC  X(0023).
  1813*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  38
* EL154.cbl
  1814     05  CFSTPMTL PIC S9(0004) COMP.
  1815     05  CFSTPMTF PIC  X(0001).
  1816     05  FILLER REDEFINES CFSTPMTF.
  1817         10  CFSTPMTA PIC  X(0001).
  1818     05  CFSTPMTI PIC  X(0008).
  1819*    -------------------------------
  1820     05  CMONTHSL PIC S9(0004) COMP.
  1821     05  CMONTHSF PIC  X(0001).
  1822     05  FILLER REDEFINES CMONTHSF.
  1823         10  CMONTHSA PIC  X(0001).
  1824     05  CMONTHSI PIC  X(0002).
  1825*    -------------------------------
  1826     05  CFSTAMTL PIC S9(0004) COMP.
  1827     05  CFSTAMTF PIC  X(0001).
  1828     05  FILLER REDEFINES CFSTAMTF.
  1829         10  CFSTAMTA PIC  X(0001).
  1830     05  CFSTAMTI PIC  X(0009).
  1831*    -------------------------------
  1832     05  LSTHD1L PIC S9(0004) COMP.
  1833     05  LSTHD1F PIC  X(0001).
  1834     05  FILLER REDEFINES LSTHD1F.
  1835         10  LSTHD1A PIC  X(0001).
  1836     05  LSTHD1I PIC  X(0024).
  1837*    -------------------------------
  1838     05  CLSTPMTL PIC S9(0004) COMP.
  1839     05  CLSTPMTF PIC  X(0001).
  1840     05  FILLER REDEFINES CLSTPMTF.
  1841         10  CLSTPMTA PIC  X(0001).
  1842     05  CLSTPMTI PIC  X(0008).
  1843*    -------------------------------
  1844     05  CLASTL PIC S9(0004) COMP.
  1845     05  CLASTF PIC  X(0001).
  1846     05  FILLER REDEFINES CLASTF.
  1847         10  CLASTA PIC  X(0001).
  1848     05  CLASTI PIC  X(0001).
  1849*    -------------------------------
  1850     05  CREGPMTL PIC S9(0004) COMP.
  1851     05  CREGPMTF PIC  X(0001).
  1852     05  FILLER REDEFINES CREGPMTF.
  1853         10  CREGPMTA PIC  X(0001).
  1854     05  CREGPMTI PIC  X(0009).
  1855*    -------------------------------
  1856     05  CDAYSFL PIC S9(0004) COMP.
  1857     05  CDAYSFF PIC  X(0001).
  1858     05  FILLER REDEFINES CDAYSFF.
  1859         10  CDAYSFA PIC  X(0001).
  1860     05  CDAYSFI PIC  X(0003).
  1861*    -------------------------------
  1862     05  CPAYEEL PIC S9(0004) COMP.
  1863     05  CPAYEEF PIC  X(0001).
  1864     05  FILLER REDEFINES CPAYEEF.
  1865         10  CPAYEEA PIC  X(0001).
  1866     05  CPAYEEI PIC  X(0008).
  1867*    -------------------------------
  1868     05  DAY2PAYL PIC S9(0004) COMP.
  1869     05  DAY2PAYF PIC  X(0001).
  1870     05  FILLER REDEFINES DAY2PAYF.
  1871         10  DAY2PAYA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  39
* EL154.cbl
  1872     05  DAY2PAYI PIC  99.
  1873*    -------------------------------
  1874     05  CEFFDTEL PIC S9(0004) COMP.
  1875     05  CEFFDTEF PIC  X(0001).
  1876     05  FILLER REDEFINES CEFFDTEF.
  1877         10  CEFFDTEA PIC  X(0001).
  1878     05  CEFFDTEI PIC  X(0008).
  1879*    -------------------------------
  1880     05  TERML PIC S9(0004) COMP.
  1881     05  TERMF PIC  X(0001).
  1882     05  FILLER REDEFINES TERMF.
  1883         10  TERMA PIC  X(0001).
  1884     05  TERMI PIC  X(0001).
  1885*    -------------------------------
  1886     05  CINDCTRL PIC S9(0004) COMP.
  1887     05  CINDCTRF PIC  X(0001).
  1888     05  FILLER REDEFINES CINDCTRF.
  1889         10  CINDCTRA PIC  X(0001).
  1890     05  CINDCTRI PIC  X(0001).
  1891*    -------------------------------
  1892     05  PRINTL PIC S9(0004) COMP.
  1893     05  PRINTF PIC  X(0001).
  1894     05  FILLER REDEFINES PRINTF.
  1895         10  PRINTA PIC  X(0001).
  1896     05  PRINTI PIC  X(0004).
  1897*    -------------------------------
  1898     05  FSTHD2L PIC S9(0004) COMP.
  1899     05  FSTHD2F PIC  X(0001).
  1900     05  FILLER REDEFINES FSTHD2F.
  1901         10  FSTHD2A PIC  X(0001).
  1902     05  FSTHD2I PIC  X(0023).
  1903*    -------------------------------
  1904     05  NFSTPMTL PIC S9(0004) COMP.
  1905     05  NFSTPMTF PIC  X(0001).
  1906     05  FILLER REDEFINES NFSTPMTF.
  1907         10  NFSTPMTA PIC  X(0001).
  1908     05  NFSTPMTI PIC  X(0008).
  1909*    -------------------------------
  1910     05  NFSTAMTL PIC S9(0004) COMP.
  1911     05  NFSTAMTF PIC  X(0001).
  1912     05  FILLER REDEFINES NFSTAMTF.
  1913         10  NFSTAMTA PIC  X(0001).
  1914     05  NFSTAMTI PIC  S9(8)V99.
  1915*    -------------------------------
  1916     05  LSTHD2L PIC S9(0004) COMP.
  1917     05  LSTHD2F PIC  X(0001).
  1918     05  FILLER REDEFINES LSTHD2F.
  1919         10  LSTHD2A PIC  X(0001).
  1920     05  LSTHD2I PIC  X(0023).
  1921*    -------------------------------
  1922     05  NLSTPMTL PIC S9(0004) COMP.
  1923     05  NLSTPMTF PIC  X(0001).
  1924     05  FILLER REDEFINES NLSTPMTF.
  1925         10  NLSTPMTA PIC  X(0001).
  1926     05  NLSTPMTI PIC  X(0008).
  1927*    -------------------------------
  1928     05  NEFFDTEL PIC S9(0004) COMP.
  1929     05  NEFFDTEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  40
* EL154.cbl
  1930     05  FILLER REDEFINES NEFFDTEF.
  1931         10  NEFFDTEA PIC  X(0001).
  1932     05  NEFFDTEI PIC  X(0008).
  1933*    -------------------------------
  1934     05  NMONTHSL PIC S9(0004) COMP.
  1935     05  NMONTHSF PIC  X(0001).
  1936     05  FILLER REDEFINES NMONTHSF.
  1937         10  NMONTHSA PIC  X(0001).
  1938     05  NMONTHSI PIC  99.
  1939*    -------------------------------
  1940     05  NDAYSFL PIC S9(0004) COMP.
  1941     05  NDAYSFF PIC  X(0001).
  1942     05  FILLER REDEFINES NDAYSFF.
  1943         10  NDAYSFA PIC  X(0001).
  1944     05  NDAYSFI PIC  999.
  1945*    -------------------------------
  1946     05  NPAYEEL PIC S9(0004) COMP.
  1947     05  NPAYEEF PIC  X(0001).
  1948     05  FILLER REDEFINES NPAYEEF.
  1949         10  NPAYEEA PIC  X(0001).
  1950     05  NPAYEEI PIC  X(0002).
  1951*    -------------------------------
  1952     05  NREGAMTL PIC S9(0004) COMP.
  1953     05  NREGAMTF PIC  X(0001).
  1954     05  FILLER REDEFINES NREGAMTF.
  1955         10  NREGAMTA PIC  X(0001).
  1956     05  NREGAMTI PIC  X(0010).
  1957*    -------------------------------
  1958     05  NLASTL PIC S9(0004) COMP.
  1959     05  NLASTF PIC  X(0001).
  1960     05  FILLER REDEFINES NLASTF.
  1961         10  NLASTA PIC  X(0001).
  1962     05  NLASTI PIC  X(0001).
  1963*    -------------------------------
  1964     05  NINDCTRL PIC S9(0004) COMP.
  1965     05  NINDCTRF PIC  X(0001).
  1966     05  FILLER REDEFINES NINDCTRF.
  1967         10  NINDCTRA PIC  X(0001).
  1968     05  NINDCTRI PIC  X(0001).
  1969*    -------------------------------
  1970     05  DAYPAYL PIC S9(0004) COMP.
  1971     05  DAYPAYF PIC  X(0001).
  1972     05  FILLER REDEFINES DAYPAYF.
  1973         10  DAYPAYA PIC  X(0001).
  1974     05  DAYPAYI PIC  99.
  1975*    -------------------------------
  1976     05  NPRINTL PIC S9(0004) COMP.
  1977     05  NPRINTF PIC  X(0001).
  1978     05  FILLER REDEFINES NPRINTF.
  1979         10  NPRINTA PIC  X(0001).
  1980     05  NPRINTI PIC  X(0004).
  1981*    -------------------------------
  1982     05  LETTDTEL PIC S9(0004) COMP.
  1983     05  LETTDTEF PIC  X(0001).
  1984     05  FILLER REDEFINES LETTDTEF.
  1985         10  LETTDTEA PIC  X(0001).
  1986     05  LETTDTEI PIC  X(0008).
  1987*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  41
* EL154.cbl
  1988     05  ENDLETTL PIC S9(0004) COMP.
  1989     05  ENDLETTF PIC  X(0001).
  1990     05  FILLER REDEFINES ENDLETTF.
  1991         10  ENDLETTA PIC  X(0001).
  1992     05  ENDLETTI PIC  X(0004).
  1993*    -------------------------------
  1994     05  ERRMSG1L PIC S9(0004) COMP.
  1995     05  ERRMSG1F PIC  X(0001).
  1996     05  FILLER REDEFINES ERRMSG1F.
  1997         10  ERRMSG1A PIC  X(0001).
  1998     05  ERRMSG1I PIC  X(0079).
  1999*    -------------------------------
  2000     05  ERRMSG2L PIC S9(0004) COMP.
  2001     05  ERRMSG2F PIC  X(0001).
  2002     05  FILLER REDEFINES ERRMSG2F.
  2003         10  ERRMSG2A PIC  X(0001).
  2004     05  ERRMSG2I PIC  X(0079).
  2005*    -------------------------------
  2006     05  ENTERPFL PIC S9(0004) COMP.
  2007     05  ENTERPFF PIC  X(0001).
  2008     05  FILLER REDEFINES ENTERPFF.
  2009         10  ENTERPFA PIC  X(0001).
  2010     05  ENTERPFI PIC  99.
  2011 01  EL154AO REDEFINES EL154AI.
  2012     05  FILLER            PIC  X(0012).
  2013*    -------------------------------
  2014     05  FILLER            PIC  X(0003).
  2015     05  RUNDTEO PIC  X(0008).
  2016*    -------------------------------
  2017     05  FILLER            PIC  X(0003).
  2018     05  RUNTIMEO PIC  99.99.
  2019*    -------------------------------
  2020     05  FILLER            PIC  X(0003).
  2021     05  CLAIMO PIC  X(0007).
  2022*    -------------------------------
  2023     05  FILLER            PIC  X(0003).
  2024     05  CARRO PIC  X(0001).
  2025*    -------------------------------
  2026     05  FILLER            PIC  X(0003).
  2027     05  CERTO PIC  X(0010).
  2028*    -------------------------------
  2029     05  FILLER            PIC  X(0003).
  2030     05  SUFFIXO PIC  X(0001).
  2031*    -------------------------------
  2032     05  FILLER            PIC  X(0003).
  2033     05  CESTDTEO PIC  X(0008).
  2034*    -------------------------------
  2035     05  FILLER            PIC  X(0003).
  2036     05  CESTBYO PIC  X(0004).
  2037*    -------------------------------
  2038     05  FILLER            PIC  X(0003).
  2039     05  FSTHD1O PIC  X(0023).
  2040*    -------------------------------
  2041     05  FILLER            PIC  X(0003).
  2042     05  CFSTPMTO PIC  X(0008).
  2043*    -------------------------------
  2044     05  FILLER            PIC  X(0003).
  2045     05  CMONTHSO PIC  99.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  42
* EL154.cbl
  2046*    -------------------------------
  2047     05  FILLER            PIC  X(0003).
  2048     05  CFSTAMTO PIC  ZZ,ZZ9.99.
  2049*    -------------------------------
  2050     05  FILLER            PIC  X(0003).
  2051     05  LSTHD1O PIC  X(0024).
  2052*    -------------------------------
  2053     05  FILLER            PIC  X(0003).
  2054     05  CLSTPMTO PIC  X(0008).
  2055*    -------------------------------
  2056     05  FILLER            PIC  X(0003).
  2057     05  CLASTO PIC  X(0001).
  2058*    -------------------------------
  2059     05  FILLER            PIC  X(0003).
  2060     05  CREGPMTO PIC  ZZ,ZZ9.99.
  2061*    -------------------------------
  2062     05  FILLER            PIC  X(0003).
  2063     05  CDAYSFO PIC  ZZ9.
  2064*    -------------------------------
  2065     05  FILLER            PIC  X(0003).
  2066     05  CPAYEEO PIC  X(0008).
  2067*    -------------------------------
  2068     05  FILLER            PIC  X(0003).
  2069     05  DAY2PAYO PIC  X(0002).
  2070*    -------------------------------
  2071     05  FILLER            PIC  X(0003).
  2072     05  CEFFDTEO PIC  X(0008).
  2073*    -------------------------------
  2074     05  FILLER            PIC  X(0003).
  2075     05  TERMO PIC  X(0001).
  2076*    -------------------------------
  2077     05  FILLER            PIC  X(0003).
  2078     05  CINDCTRO PIC  X(0001).
  2079*    -------------------------------
  2080     05  FILLER            PIC  X(0003).
  2081     05  PRINTO PIC  X(0004).
  2082*    -------------------------------
  2083     05  FILLER            PIC  X(0003).
  2084     05  FSTHD2O PIC  X(0023).
  2085*    -------------------------------
  2086     05  FILLER            PIC  X(0003).
  2087     05  NFSTPMTO PIC  99B99B99.
  2088*    -------------------------------
  2089     05  FILLER            PIC  X(0003).
  2090     05  NFSTAMTO PIC  ZZ,ZZZ.99-.
  2091*    -------------------------------
  2092     05  FILLER            PIC  X(0003).
  2093     05  LSTHD2O PIC  X(0023).
  2094*    -------------------------------
  2095     05  FILLER            PIC  X(0003).
  2096     05  NLSTPMTO PIC  99B99B99.
  2097*    -------------------------------
  2098     05  FILLER            PIC  X(0003).
  2099     05  NEFFDTEO PIC  99B99B99.
  2100*    -------------------------------
  2101     05  FILLER            PIC  X(0003).
  2102     05  NMONTHSO PIC  X(0002).
  2103*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  43
* EL154.cbl
  2104     05  FILLER            PIC  X(0003).
  2105     05  NDAYSFO PIC  X(0003).
  2106*    -------------------------------
  2107     05  FILLER            PIC  X(0003).
  2108     05  NPAYEEO PIC  X(0002).
  2109*    -------------------------------
  2110     05  FILLER            PIC  X(0003).
  2111     05  NREGAMTO PIC  ZZ,ZZZ.99-.
  2112*    -------------------------------
  2113     05  FILLER            PIC  X(0003).
  2114     05  NLASTO PIC  X(0001).
  2115*    -------------------------------
  2116     05  FILLER            PIC  X(0003).
  2117     05  NINDCTRO PIC  X(0001).
  2118*    -------------------------------
  2119     05  FILLER            PIC  X(0003).
  2120     05  DAYPAYO PIC  X(0002).
  2121*    -------------------------------
  2122     05  FILLER            PIC  X(0003).
  2123     05  NPRINTO PIC  X(0004).
  2124*    -------------------------------
  2125     05  FILLER            PIC  X(0003).
  2126     05  LETTDTEO PIC  99B99B99.
  2127*    -------------------------------
  2128     05  FILLER            PIC  X(0003).
  2129     05  ENDLETTO PIC  X(0004).
  2130*    -------------------------------
  2131     05  FILLER            PIC  X(0003).
  2132     05  ERRMSG1O PIC  X(0079).
  2133*    -------------------------------
  2134     05  FILLER            PIC  X(0003).
  2135     05  ERRMSG2O PIC  X(0079).
  2136*    -------------------------------
  2137     05  FILLER            PIC  X(0003).
  2138     05  ENTERPFO PIC  X(0002).
  2139*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  44
* EL154.cbl
  2141****************************************************************
  2142*
  2143* Copyright (c) 2007 by Clerity Solutions, Inc.
  2144* All rights reserved.
  2145*
  2146****************************************************************
  2147 01  DFHEIV.
  2148   02  DFHEIV0               PIC X(35).
  2149   02  DFHEIV1               PIC X(08).
  2150   02  DFHEIV2               PIC X(08).
  2151   02  DFHEIV3               PIC X(08).
  2152   02  DFHEIV4               PIC X(06).
  2153   02  DFHEIV5               PIC X(04).
  2154   02  DFHEIV6               PIC X(04).
  2155   02  DFHEIV7               PIC X(02).
  2156   02  DFHEIV8               PIC X(02).
  2157   02  DFHEIV9               PIC X(01).
  2158   02  DFHEIV10              PIC S9(7) COMP-3.
  2159   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2160   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2161   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2162   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2163   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2164   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2165   02  DFHEIV17              PIC X(04).
  2166   02  DFHEIV18              PIC X(04).
  2167   02  DFHEIV19              PIC X(04).
  2168   02  DFHEIV20              USAGE IS POINTER.
  2169   02  DFHEIV21              USAGE IS POINTER.
  2170   02  DFHEIV22              USAGE IS POINTER.
  2171   02  DFHEIV23              USAGE IS POINTER.
  2172   02  DFHEIV24              USAGE IS POINTER.
  2173   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2174   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2175   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2176   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2177   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2178   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2179   02  FILLER                PIC X(02).
  2180   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2181   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2182   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2183   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2184   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2185 LINKAGE  SECTION.
  2186*****************************************************************
  2187*                                                               *
  2188* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2189* All rights reserved.                                          *
  2190*                                                               *
  2191*****************************************************************
  2192 01  dfheiblk.
  2193     02  eibtime          pic s9(7) comp-3.
  2194     02  eibdate          pic s9(7) comp-3.
  2195     02  eibtrnid         pic x(4).
  2196     02  eibtaskn         pic s9(7) comp-3.
  2197     02  eibtrmid         pic x(4).
  2198     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  45
* EL154.cbl
  2199     02  eibcposn         pic s9(4) comp.
  2200     02  eibcalen         pic s9(4) comp.
  2201     02  eibaid           pic x(1).
  2202     02  eibfiller1       pic x(1).
  2203     02  eibfn            pic x(2).
  2204     02  eibfiller2       pic x(2).
  2205     02  eibrcode         pic x(6).
  2206     02  eibfiller3       pic x(2).
  2207     02  eibds            pic x(8).
  2208     02  eibreqid         pic x(8).
  2209     02  eibrsrce         pic x(8).
  2210     02  eibsync          pic x(1).
  2211     02  eibfree          pic x(1).
  2212     02  eibrecv          pic x(1).
  2213     02  eibsend          pic x(1).
  2214     02  eibatt           pic x(1).
  2215     02  eibeoc           pic x(1).
  2216     02  eibfmh           pic x(1).
  2217     02  eibcompl         pic x(1).
  2218     02  eibsig           pic x(1).
  2219     02  eibconf          pic x(1).
  2220     02  eiberr           pic x(1).
  2221     02  eibrldbk         pic x(1).
  2222     02  eiberrcd         pic x(4).
  2223     02  eibsynrb         pic x(1).
  2224     02  eibnodat         pic x(1).
  2225     02  eibfiller5       pic x(2).
  2226     02  eibresp          pic 9(09) comp.
  2227     02  eibresp2         pic 9(09) comp.
  2228     02  dfheigdj         pic s9(4) comp.
  2229     02  dfheigdk         pic s9(4) comp.
  2230 01  DFHCOMMAREA             PIC X(1024).
  2231
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  46
* EL154.cbl
  2233*                            COPY ELCCNTL.
  2234******************************************************************
  2235*                                                                *
  2236*                                                                *
  2237*                            ELCCNTL.                            *
  2238*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2239*                            VMOD=2.059                          *
  2240*                                                                *
  2241*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2242*                                                                *
  2243*   FILE TYPE = VSAM,KSDS                                        *
  2244*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2245*                                                                *
  2246*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2247*       ALTERNATE INDEX = NONE                                   *
  2248*                                                                *
  2249*   LOG = YES                                                    *
  2250*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2251******************************************************************
  2252*                   C H A N G E   L O G
  2253*
  2254* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2255*-----------------------------------------------------------------
  2256*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2257* EFFECTIVE    NUMBER
  2258*-----------------------------------------------------------------
  2259* 082503                   PEMA  ADD BENEFIT GROUP
  2260* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2261* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2262* 092705    2005050300006  PEMA  ADD SPP LEASES
  2263* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2264* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2265* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2266* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2267* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2268* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2269* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2270* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2271* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2272* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2273******************************************************************
  2274*
  2275 01  CONTROL-FILE.
  2276     12  CF-RECORD-ID                       PIC XX.
  2277         88  VALID-CF-ID                        VALUE 'CF'.
  2278
  2279     12  CF-CONTROL-PRIMARY.
  2280         16  CF-COMPANY-ID                  PIC XXX.
  2281         16  CF-RECORD-TYPE                 PIC X.
  2282             88  CF-COMPANY-MASTER              VALUE '1'.
  2283             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2284             88  CF-STATE-MASTER                VALUE '3'.
  2285             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2286             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2287             88  CF-CARRIER-MASTER              VALUE '6'.
  2288             88  CF-MORTALITY-MASTER            VALUE '7'.
  2289             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2290             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  47
* EL154.cbl
  2291             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2292             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2293             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2294             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2295             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2296             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2297             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2298             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2299             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2300         16  CF-ACCESS-CD-GENL              PIC X(4).
  2301         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2302             20  CF-PROCESSOR               PIC X(4).
  2303         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2304             20  CF-STATE-CODE              PIC XX.
  2305             20  FILLER                     PIC XX.
  2306         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2307             20  FILLER                     PIC XX.
  2308             20  CF-HI-BEN-IN-REC           PIC XX.
  2309         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2310             20  FILLER                     PIC XXX.
  2311             20  CF-CARRIER-CNTL            PIC X.
  2312         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2313             20  FILLER                     PIC XX.
  2314             20  CF-HI-TYPE-IN-REC          PIC 99.
  2315         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2316             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2317                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2318             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2319             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2320         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2321             20  FILLER                     PIC X.
  2322             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2323         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2324             20  FILLER                     PIC XX.
  2325             20  CF-MORTGAGE-PLAN           PIC XX.
  2326         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2327
  2328     12  CF-LAST-MAINT-DT                   PIC XX.
  2329     12  CF-LAST-MAINT-BY                   PIC X(4).
  2330     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2331
  2332     12  CF-RECORD-BODY                     PIC X(728).
  2333
  2334
  2335****************************************************************
  2336*             COMPANY MASTER RECORD                            *
  2337****************************************************************
  2338
  2339     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2340         16  CF-COMPANY-ADDRESS.
  2341             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2342             20  CF-CL-IN-CARE-OF           PIC X(30).
  2343             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2344             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2345             20  CF-CL-CITY-STATE           PIC X(30).
  2346             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2347             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2348         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  48
* EL154.cbl
  2349         16  CF-COMPANY-PASSWORD            PIC X(8).
  2350         16  CF-SECURITY-OPTION             PIC X.
  2351             88  ALL-SECURITY                   VALUE '1'.
  2352             88  COMPANY-VERIFY                 VALUE '2'.
  2353             88  PROCESSOR-VERIFY               VALUE '3'.
  2354             88  NO-SECURITY                    VALUE '4'.
  2355             88  ALL-BUT-TERM                   VALUE '5'.
  2356         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2357             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2358         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2359             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2360         16  CF-INFORCE-LOCATION            PIC X.
  2361             88  CERTS-ARE-ONLINE               VALUE '1'.
  2362             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2363             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2364         16  CF-LOWER-CASE-LETTERS          PIC X.
  2365         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2366             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2367             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2368             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2369             88  CF-ACCNT-CNTL                  VALUE '3'.
  2370             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2371
  2372         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2373         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2374
  2375         16  CF-LGX-CREDIT-USER             PIC X.
  2376             88  CO-IS-NOT-USER                 VALUE 'N'.
  2377             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2378
  2379         16 CF-CREDIT-CALC-CODES.
  2380             20  CF-CR-REM-TERM-CALC PIC X.
  2381               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2382               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2383               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2384               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2385               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2386               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2387               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2388             20  CF-CR-R78-METHOD           PIC X.
  2389               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2390               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2391
  2392         16  CF-CLAIM-CONTROL-COUNTS.
  2393             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2394                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2395
  2396             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2397                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2398
  2399             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2400                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2401
  2402             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2403                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2404
  2405         16  CF-CURRENT-MONTH-END           PIC XX.
  2406
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  49
* EL154.cbl
  2407         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2408             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2409             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2410             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2411             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2412                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2413                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2414             20  CF-CO-PREM-REJECT-SW       PIC X.
  2415                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2416                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2417             20  CF-CO-REF-REJECT-SW        PIC X.
  2418                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2419                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2420
  2421         16  CF-CO-REPORTING-DT             PIC XX.
  2422         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2423         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2424           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2425           88  CF-CO-MONTH-END                  VALUE '1'.
  2426
  2427         16  CF-LGX-CLAIM-USER              PIC X.
  2428             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2429             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2430
  2431         16  CF-CREDIT-EDIT-CONTROLS.
  2432             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2433             20  CF-MIN-AGE                 PIC 99.
  2434             20  CF-DEFAULT-AGE             PIC 99.
  2435             20  CF-MIN-TERM                PIC S999      COMP-3.
  2436             20  CF-MAX-TERM                PIC S999      COMP-3.
  2437             20  CF-DEFAULT-SEX             PIC X.
  2438             20  CF-JOINT-AGE-INPUT         PIC X.
  2439                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2440             20  CF-BIRTH-DATE-INPUT        PIC X.
  2441                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2442             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2443                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2444                 88  CF-ZERO-CARRIER            VALUE '1'.
  2445                 88  CF-ZERO-GROUPING           VALUE '2'.
  2446                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2447             20  CF-EDIT-SW                 PIC X.
  2448                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2449             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2450             20  CF-CR-PR-METHOD            PIC X.
  2451               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2452               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2453             20  FILLER                     PIC X.
  2454
  2455         16  CF-CREDIT-MISC-CONTROLS.
  2456             20  CF-REIN-TABLE-SW           PIC X.
  2457                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2458             20  CF-COMP-TABLE-SW           PIC X.
  2459                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2460             20  CF-EXPERIENCE-RETENTION-AGE
  2461                                            PIC S9        COMP-3.
  2462             20  CF-CONVERSION-DT           PIC XX.
  2463             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2464             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  50
* EL154.cbl
  2465                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2466                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2467
  2468             20  CF-CR-CHECK-NO-CONTROL.
  2469                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2470                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2471                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2472                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2473                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2474                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2475
  2476                 24  CF-CR-CHECK-COUNT       REDEFINES
  2477                     CF-CR-CHECK-COUNTER      PIC X(4).
  2478
  2479                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2480                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2481
  2482                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2483                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2484                 24  CF-MAIL-PROCESSING       PIC X.
  2485                     88  MAIL-PROCESSING          VALUE 'Y'.
  2486
  2487         16  CF-MISC-SYSTEM-CONTROL.
  2488             20  CF-SYSTEM-C                 PIC X.
  2489                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2490             20  CF-SYSTEM-D                 PIC X.
  2491                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2492             20  CF-SOC-SEC-NO-SW            PIC X.
  2493                 88  SOC-SEC-NO-USED             VALUE '1'.
  2494             20  CF-MEMBER-NO-SW             PIC X.
  2495                 88  MEMBER-NO-USED              VALUE '1'.
  2496             20  CF-TAX-ID-NUMBER            PIC X(11).
  2497             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2498             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2499                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2500                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2501                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2502                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2503             20  CF-SYSTEM-E                 PIC X.
  2504                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2505
  2506         16  CF-LGX-LIFE-USER               PIC X.
  2507             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2508             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2509
  2510         16  CF-CR-MONTH-END-DT             PIC XX.
  2511
  2512         16  CF-FILE-MAINT-DATES.
  2513             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2514                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2515             20  CF-LAST-BATCH       REDEFINES
  2516                 CF-LAST-BATCH-NO               PIC X(4).
  2517             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2518             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2519             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2520             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2521             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2522             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  51
* EL154.cbl
  2523             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2524             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2525             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2526             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2527
  2528         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2529         16  FILLER                         PIC X.
  2530
  2531         16  CF-ALT-MORT-CODE               PIC X(4).
  2532         16  CF-MEMBER-CAPTION              PIC X(10).
  2533
  2534         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2535             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2536             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2537             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2538             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2539             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2540
  2541         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2542
  2543         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2544         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2545         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2546         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2547
  2548         16  CF-AH-OVERRIDE-L1              PIC X.
  2549         16  CF-AH-OVERRIDE-L2              PIC XX.
  2550         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2551         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2552
  2553         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2554         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2555
  2556         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2557         16  CF-AR-LAST-EL860-DT            PIC XX.
  2558         16  CF-MP-MONTH-END-DT             PIC XX.
  2559
  2560         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2561         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2562             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2563
  2564         16  CF-AR-MONTH-END-DT             PIC XX.
  2565
  2566         16  CF-CRDTCRD-USER                PIC X.
  2567             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2568             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2569
  2570         16  CF-CC-MONTH-END-DT             PIC XX.
  2571
  2572         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2573
  2574         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2575             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2576             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2577             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2578         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2579         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2580         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  52
* EL154.cbl
  2581         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2582             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2583             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2584         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2585         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2586         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2587             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2588         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2589
  2590         16  CF-CL-ZIP-CODE.
  2591             20  CF-CL-ZIP-PRIME.
  2592                 24  CF-CL-ZIP-1ST          PIC X.
  2593                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2594                 24  FILLER                 PIC X(4).
  2595             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2596         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2597             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2598             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2599             20  FILLER                     PIC XXX.
  2600
  2601         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2602         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2603         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2604         16  CF-CO-OPTION-START-DATE        PIC XX.
  2605         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2606           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2607                                                      '3' '4'.
  2608           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2609           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2610           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2611           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2612           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2613           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2614
  2615         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2616
  2617         16  CF-PAYMENT-APPROVAL-LEVELS.
  2618             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2619             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2620             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2621             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2622             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2623             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2624
  2625         16  CF-END-USER-REPORTING-USER     PIC X.
  2626             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2627             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2628
  2629         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2630             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2631             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2632
  2633         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2634
  2635         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2636         16  FILLER                         PIC X.
  2637
  2638         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  53
* EL154.cbl
  2639             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2640             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2641             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2642
  2643         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2644
  2645         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2646             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2647             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2648
  2649         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2650             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2651             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2652
  2653         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2654
  2655         16  CF-CO-ACH-ID-CODE              PIC  X.
  2656             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2657             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2658             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2659         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2660         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2661         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2662         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2663         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2664         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2665         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2666         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2667         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2668                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2669         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2670                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2671
  2672         16  CF-CO-OVER-SHORT.
  2673             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2674             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2675
  2676*         16  FILLER                         PIC X(102).
  2677         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2678             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2679             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2680
  2681         16  CF-AH-APPROVAL-DAYS.
  2682             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2683             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2684             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2685             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2686
  2687         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2688
  2689         16  CF-APPROV-LEV-5.
  2690             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2691             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2692             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2693
  2694         16  FILLER                         PIC X(68).
  2695****************************************************************
  2696*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  54
* EL154.cbl
  2697****************************************************************
  2698
  2699     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2700         16  CF-PROCESSOR-NAME              PIC X(30).
  2701         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2702         16  CF-PROCESSOR-TITLE             PIC X(26).
  2703         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2704                 88  MESSAGE-YES                VALUE 'Y'.
  2705                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2706
  2707*****************************************************
  2708****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2709****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2710****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2711****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2712*****************************************************
  2713
  2714         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2715             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2716             20  CF-APPLICATION-FORCE       PIC X.
  2717             20  CF-INDIVIDUAL-APP.
  2718                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2719                     28  CF-BROWSE-APP      PIC X.
  2720                     28  CF-UPDATE-APP      PIC X.
  2721
  2722         16  CF-CURRENT-TERM-ON             PIC X(4).
  2723         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2724             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2725             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2726             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2727             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2728             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2729             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2730             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2731         16  CF-PROCESSOR-CARRIER           PIC X.
  2732             88  NO-CARRIER-SECURITY            VALUE ' '.
  2733         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2734             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2735         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2736             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2737         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2738             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2739
  2740         16  CF-PROC-SYS-ACCESS-SW.
  2741             20  CF-PROC-CREDIT-CLAIMS-SW.
  2742                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2743                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2744                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2745                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2746             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2747                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2748                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2749             20  CF-PROC-LIFE-GNRLDGR-SW.
  2750                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2751                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2752                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2753                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2754             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  55
* EL154.cbl
  2755                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2756                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2757         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2758             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2759             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2760         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2761
  2762         16  CF-APPROVAL-LEVEL                  PIC X.
  2763             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2764             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2765             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2766             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2767             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2768
  2769         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2770
  2771         16  CF-LANGUAGE-TYPE                   PIC X.
  2772             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2773             88  CF-LANG-IS-FR                      VALUE 'F'.
  2774
  2775         16  CF-CSR-IND                         PIC X.
  2776         16  FILLER                             PIC X(239).
  2777
  2778****************************************************************
  2779*             PROCESSOR/REMINDERS RECORD                       *
  2780****************************************************************
  2781
  2782     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2783         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2784             20  CF-START-REMIND-DT         PIC XX.
  2785             20  CF-END-REMIND-DT           PIC XX.
  2786             20  CF-REMINDER-TEXT           PIC X(50).
  2787         16  FILLER                         PIC X(296).
  2788
  2789
  2790****************************************************************
  2791*             STATE MASTER RECORD                              *
  2792****************************************************************
  2793
  2794     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2795         16  CF-STATE-ABBREVIATION          PIC XX.
  2796         16  CF-STATE-NAME                  PIC X(25).
  2797         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2798         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2799             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2800             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2801             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2802             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2803                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2804                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2805             20  CF-ST-PREM-REJECT-SW       PIC X.
  2806                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2807                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2808             20  CF-ST-REF-REJECT-SW        PIC X.
  2809                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2810                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2811         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2812         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  56
* EL154.cbl
  2813         16  CF-ST-REFUND-RULES.
  2814             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2815             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2816             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2817         16  CF-ST-FST-PMT-EXTENSION.
  2818             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2819             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2820                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2821                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2822                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2823                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2824         16  CF-ST-STATE-CALL.
  2825             20  CF-ST-CALL-UNEARNED        PIC X.
  2826             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2827             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2828         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2829             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2830             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2831         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2832         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2833         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2834         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2835         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2836         16  FILLER                         PIC X.
  2837         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2838             20  CF-ST-BENEFIT-CD           PIC XX.
  2839             20  CF-ST-BENEFIT-KIND         PIC X.
  2840                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2841                 88  CF-ST-AH-KIND              VALUE 'A'.
  2842             20  CF-ST-REM-TERM-CALC        PIC X.
  2843                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2844                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2845                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2846                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2847                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2848                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2849                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2850                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2851
  2852             20  CF-ST-REFUND-CALC          PIC X.
  2853                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2854                 88  ST-REFD-BY-R78             VALUE '1'.
  2855                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2856                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2857                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2858                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2859                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2860                 88  ST-REFD-UTAH               VALUE '7'.
  2861                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2862                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2863                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2864
  2865             20  CF-ST-EARNING-CALC         PIC X.
  2866                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2867                 88  ST-EARN-BY-R78             VALUE '1'.
  2868                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2869                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2870                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  57
* EL154.cbl
  2871                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2872                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2873                 88  ST-EARN-MEAN               VALUE '8'.
  2874                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2875
  2876             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2877                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2878                 88  ST-OVRD-BY-R78             VALUE '1'.
  2879                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2880                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2881                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2882                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2883                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2884                 88  ST-OVRD-MEAN               VALUE '8'.
  2885                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2886             20  FILLER                     PIC X.
  2887
  2888         16  CF-ST-COMMISSION-CAPS.
  2889             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2890             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2891             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2892             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2893         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2894                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2895
  2896         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2897
  2898         16  CF-ST-STATUTORY-INTEREST.
  2899             20  CF-ST-STAT-DATE-FROM       PIC X.
  2900                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2901                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2902             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2903             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2904             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2905             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2906             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2907
  2908         16  CF-ST-OVER-SHORT.
  2909             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2910             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2911
  2912         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2913
  2914         16  CF-ST-RT-CALC                  PIC X.
  2915
  2916         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2917         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2918         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2919         16  CF-ST-RF-LR-CALC               PIC X.
  2920         16  CF-ST-RF-LL-CALC               PIC X.
  2921         16  CF-ST-RF-LN-CALC               PIC X.
  2922         16  CF-ST-RF-AH-CALC               PIC X.
  2923         16  CF-ST-RF-CP-CALC               PIC X.
  2924*        16  FILLER                         PIC X(206).
  2925*CIDMOD         16  FILLER                         PIC X(192).
  2926         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2927             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2928         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  58
* EL154.cbl
  2929         16  CF-ST-VFY-2ND-BENE             PIC X.
  2930         16  CF-ST-CAUSAL-STATE             PIC X.
  2931         16  FILLER                         PIC X(185).
  2932
  2933****************************************************************
  2934*             BENEFIT MASTER RECORD                            *
  2935****************************************************************
  2936
  2937     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2938         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2939             20  CF-BENEFIT-CODE            PIC XX.
  2940             20  CF-BENEFIT-NUMERIC  REDEFINES
  2941                 CF-BENEFIT-CODE            PIC XX.
  2942             20  CF-BENEFIT-ALPHA           PIC XXX.
  2943             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2944             20  CF-BENEFIT-COMMENT         PIC X(10).
  2945
  2946             20  CF-LF-COVERAGE-TYPE        PIC X.
  2947                 88  CF-REDUCING                VALUE 'R'.
  2948                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2949
  2950             20  CF-SPECIAL-CALC-CD         PIC X.
  2951                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2952                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2953                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2954                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2955                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2956                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2957                 88  CF-FARM-PLAN               VALUE 'F'.
  2958                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2959                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2960                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2961                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2962                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2963                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2964                 88  CF-PRUDENTIAL              VALUE 'P'.
  2965                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2966                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2967                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2968                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2969                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2970                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2971
  2972             20  CF-JOINT-INDICATOR         PIC X.
  2973                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2974
  2975*            20  FILLER                     PIC X(12).
  2976             20  cf-maximum-benefits        pic s999 comp-3.
  2977             20  FILLER                     PIC X(09).
  2978             20  CF-BENEFIT-CATEGORY        PIC X.
  2979             20  CF-LOAN-TYPE               PIC X(8).
  2980
  2981             20  CF-CO-REM-TERM-CALC        PIC X.
  2982                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2983                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2984                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2985                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2986                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  59
* EL154.cbl
  2987
  2988             20  CF-CO-EARNINGS-CALC        PIC X.
  2989                 88  CO-EARN-BY-R78             VALUE '1'.
  2990                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2991                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2992                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2993                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2994                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2995                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2996                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2997
  2998             20  CF-CO-REFUND-CALC          PIC X.
  2999                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3000                 88  CO-REFD-BY-R78             VALUE '1'.
  3001                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3002                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3003                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3004                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3005                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3006                 88  CO-REFD-MEAN               VALUE '8'.
  3007                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3008                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3009                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3010
  3011             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3012                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3013                 88  CO-OVRD-BY-R78             VALUE '1'.
  3014                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3015                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3016                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3017                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3018                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3019                 88  CO-OVRD-MEAN               VALUE '8'.
  3020                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3021
  3022             20  CF-CO-BEN-I-G-CD           PIC X.
  3023                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3024                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3025                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3026
  3027         16  FILLER                         PIC X(304).
  3028
  3029
  3030****************************************************************
  3031*             CARRIER MASTER RECORD                            *
  3032****************************************************************
  3033
  3034     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3035         16  CF-ADDRESS-DATA.
  3036             20  CF-MAIL-TO-NAME            PIC X(30).
  3037             20  CF-IN-CARE-OF              PIC X(30).
  3038             20  CF-ADDRESS-LINE-1          PIC X(30).
  3039             20  CF-ADDRESS-LINE-2          PIC X(30).
  3040             20  CF-CITY-STATE              PIC X(30).
  3041             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3042             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3043
  3044         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  60
* EL154.cbl
  3045             20  CF-CLAIM-NO-METHOD         PIC X.
  3046                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3047                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3048                 88  CLAIM-NO-SEQ               VALUE '3'.
  3049                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3050             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3051                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3052                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3053                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3054
  3055         16  CF-CHECK-NO-CONTROL.
  3056             20  CF-CHECK-NO-METHOD         PIC X.
  3057                 88  CHECK-NO-MANUAL            VALUE '1'.
  3058                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3059                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3060                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3061             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3062                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3063
  3064         16  CF-DOMICILE-STATE              PIC XX.
  3065
  3066         16  CF-EXPENSE-CONTROLS.
  3067             20  CF-EXPENSE-METHOD          PIC X.
  3068                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3069                 88  DOLLARS-PER-PMT            VALUE '2'.
  3070                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3071                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3072             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3073             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3074
  3075         16  CF-CORRESPONDENCE-CONTROL.
  3076             20  CF-LETTER-RESEND-OPT       PIC X.
  3077                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3078                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3079             20  FILLER                     PIC X(4).
  3080
  3081         16  CF-RESERVE-CONTROLS.
  3082             20  CF-MANUAL-SW               PIC X.
  3083                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3084             20  CF-FUTURE-SW               PIC X.
  3085                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3086             20  CF-PTC-SW                  PIC X.
  3087                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3088             20  CF-IBNR-SW                 PIC X.
  3089                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3090             20  CF-PTC-LF-SW               PIC X.
  3091                 88  CF-LF-PTC-USED             VALUE '1'.
  3092             20  CF-CDT-ACCESS-METHOD       PIC X.
  3093                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3094                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3095                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3096             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3097
  3098         16  CF-CLAIM-CALC-METHOD           PIC X.
  3099             88  360-PLUS-MONTHS                VALUE '1'.
  3100             88  365-PLUS-MONTHS                VALUE '2'.
  3101             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3102             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  61
* EL154.cbl
  3103             88  365-DAILY                      VALUE '5'.
  3104
  3105         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3106         16  FILLER                         PIC X(11).
  3107
  3108         16  CF-LIMIT-AMOUNTS.
  3109             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3110             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3111             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3112             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3113             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3114             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3115             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3116             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3117             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3118             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3119
  3120         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3121         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3122         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3123
  3124         16  CF-ZIP-CODE.
  3125             20  CF-ZIP-PRIME.
  3126                 24  CF-ZIP-1ST             PIC X.
  3127                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3128                 24  FILLER                 PIC X(4).
  3129             20  CF-ZIP-PLUS4               PIC X(4).
  3130         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3131             20  CF-CAN-POSTAL-1            PIC XXX.
  3132             20  CF-CAN-POSTAL-2            PIC XXX.
  3133             20  FILLER                     PIC XXX.
  3134
  3135         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3136         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3137         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3138
  3139         16  CF-RATING-SWITCH               PIC X.
  3140             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3141             88  CF-NO-RATING                   VALUE 'N'.
  3142
  3143         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3144
  3145         16  CF-CARRIER-OVER-SHORT.
  3146             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3147             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3148
  3149         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3150         16  CF-SECPAY-SWITCH               PIC X.
  3151             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3152             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3153         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3154         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3155         16  FILLER                         PIC X(444).
  3156*        16  FILLER                         PIC X(452).
  3157
  3158
  3159****************************************************************
  3160*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  62
* EL154.cbl
  3161****************************************************************
  3162
  3163     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3164         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3165                                INDEXED BY CF-MORT-NDX.
  3166             20  CF-MORT-TABLE              PIC X(5).
  3167             20  CF-MORT-TABLE-TYPE         PIC X.
  3168                 88  CF-MORT-JOINT              VALUE 'J'.
  3169                 88  CF-MORT-SINGLE             VALUE 'S'.
  3170                 88  CF-MORT-COMBINED           VALUE 'C'.
  3171                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3172                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3173             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3174             20  CF-MORT-AGE-METHOD         PIC XX.
  3175                 88  CF-AGE-LAST                VALUE 'AL'.
  3176                 88  CF-AGE-NEAR                VALUE 'AN'.
  3177             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3178             20  CF-MORT-ADJUSTMENT-DIRECTION
  3179                                            PIC X.
  3180                 88  CF-MINUS                   VALUE '-'.
  3181                 88  CF-PLUS                    VALUE '+'.
  3182             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3183             20  CF-MORT-JOINT-CODE         PIC X.
  3184                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3185             20  CF-MORT-PC-Q               PIC X.
  3186                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3187             20  CF-MORT-TABLE-CODE         PIC X(4).
  3188             20  CF-MORT-COMMENTS           PIC X(15).
  3189             20  FILLER                     PIC X(14).
  3190
  3191         16  FILLER                         PIC X(251).
  3192
  3193
  3194****************************************************************
  3195*             BUSSINESS TYPE MASTER RECORD                     *
  3196****************************************************************
  3197
  3198     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3199* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3200* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3201* AND RECORD 05 IS TYPES 81-99
  3202         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3203             20  CF-BUSINESS-TITLE          PIC  X(19).
  3204             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3205                                            PIC S9V9(4) COMP-3.
  3206             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3207             20  FILLER                     PIC  X.
  3208         16  FILLER                         PIC  X(248).
  3209
  3210
  3211****************************************************************
  3212*             TERMINAL MASTER RECORD                           *
  3213****************************************************************
  3214
  3215     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3216
  3217         16  CF-COMPANY-TERMINALS.
  3218             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  63
* EL154.cbl
  3219                                  PIC X(4).
  3220         16  FILLER               PIC X(248).
  3221
  3222
  3223****************************************************************
  3224*             LIFE EDIT MASTER RECORD                          *
  3225****************************************************************
  3226
  3227     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3228         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3229             20  CF-LIFE-CODE-IN            PIC XX.
  3230             20  CF-LIFE-CODE-OUT           PIC XX.
  3231         16  FILLER                         PIC X(248).
  3232
  3233
  3234****************************************************************
  3235*             AH EDIT MASTER RECORD                            *
  3236****************************************************************
  3237
  3238     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3239         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3240             20  CF-AH-CODE-IN              PIC XXX.
  3241             20  CF-AH-CODE-OUT             PIC XX.
  3242         16  FILLER                         PIC X(248).
  3243
  3244
  3245****************************************************************
  3246*             CREDIBILITY TABLES                               *
  3247****************************************************************
  3248
  3249     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3250         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3251                             INDEXED BY CF-CRDB-NDX.
  3252             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3253             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3254             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3255         16  FILLER                         PIC  X(332).
  3256
  3257
  3258****************************************************************
  3259*             REPORT CUSTOMIZATION RECORD                      *
  3260****************************************************************
  3261
  3262     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3263         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3264             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3265             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3266             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3267**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3268****       A T-TRANSFER.                                   ****
  3269             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3270
  3271         16  FILLER                         PIC XX.
  3272
  3273         16  CF-CARRIER-CNTL-OPT.
  3274             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3275                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3276                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  64
* EL154.cbl
  3277             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3278                                            PIC X.
  3279         16  CF-GROUP-CNTL-OPT.
  3280             20  CF-GROUP-OPT-SEQ           PIC 9.
  3281                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3282                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3283             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3284                                            PIC X(6).
  3285         16  CF-STATE-CNTL-OPT.
  3286             20  CF-STATE-OPT-SEQ           PIC 9.
  3287                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3288                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3289             20  CF-STATE-SELECT OCCURS 3 TIMES
  3290                                            PIC XX.
  3291         16  CF-ACCOUNT-CNTL-OPT.
  3292             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3293                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3294                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3295             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3296                                            PIC X(10).
  3297         16  CF-BUS-TYP-CNTL-OPT.
  3298             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3299                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3300                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3301             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3302                                            PIC XX.
  3303         16  CF-LF-TYP-CNTL-OPT.
  3304             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3305                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3306                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3307             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3308                                            PIC XX.
  3309         16  CF-AH-TYP-CNTL-OPT.
  3310             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3311                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3312                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3313             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3314                                            PIC XX.
  3315         16  CF-REPTCD1-CNTL-OPT.
  3316             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3317                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3318                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3319             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3320                                            PIC X(10).
  3321         16  CF-REPTCD2-CNTL-OPT.
  3322             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3323                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3324                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3325             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3326                                            PIC X(10).
  3327         16  CF-USER1-CNTL-OPT.
  3328             20  CF-USER1-OPT-SEQ           PIC 9.
  3329                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3330                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3331             20  CF-USER1-SELECT OCCURS 3 TIMES
  3332                                            PIC X(10).
  3333         16  CF-USER2-CNTL-OPT.
  3334             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  65
* EL154.cbl
  3335                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3336                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3337             20  CF-USER2-SELECT OCCURS 3 TIMES
  3338                                            PIC X(10).
  3339         16  CF-USER3-CNTL-OPT.
  3340             20  CF-USER3-OPT-SEQ           PIC 9.
  3341                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3342                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3343             20  CF-USER3-SELECT OCCURS 3 TIMES
  3344                                            PIC X(10).
  3345         16  CF-USER4-CNTL-OPT.
  3346             20  CF-USER4-OPT-SEQ           PIC 9.
  3347                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3348                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3349             20  CF-USER4-SELECT OCCURS 3 TIMES
  3350                                            PIC X(10).
  3351         16  CF-USER5-CNTL-OPT.
  3352             20  CF-USER5-OPT-SEQ           PIC 9.
  3353                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3354                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3355             20  CF-USER5-SELECT OCCURS 3 TIMES
  3356                                            PIC X(10).
  3357         16  CF-REINS-CNTL-OPT.
  3358             20  CF-REINS-OPT-SEQ           PIC 9.
  3359                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3360                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3361             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3362                 24  CF-REINS-PRIME         PIC XXX.
  3363                 24  CF-REINS-SUB           PIC XXX.
  3364
  3365         16  CF-AGENT-CNTL-OPT.
  3366             20  CF-AGENT-OPT-SEQ           PIC 9.
  3367                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3368                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3369             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3370                                            PIC X(10).
  3371
  3372         16  FILLER                         PIC X(43).
  3373
  3374         16  CF-LOSS-RATIO-SELECT.
  3375             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3376             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3377         16  CF-ENTRY-DATE-SELECT.
  3378             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3379             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3380         16  CF-EFFECTIVE-DATE-SELECT.
  3381             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3382             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3383
  3384         16  CF-EXCEPTION-LIST-IND          PIC X.
  3385             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3386
  3387         16  FILLER                         PIC X(318).
  3388
  3389****************************************************************
  3390*                  EXCEPTION REPORTING RECORD                  *
  3391****************************************************************
  3392
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  66
* EL154.cbl
  3393     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3394         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3395             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3396
  3397         16  CF-COMBINED-LIFE-AH-OPT.
  3398             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3399             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3400             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3401             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3402
  3403         16  CF-LIFE-OPT.
  3404             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3405             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3406             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3407             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3408             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3409             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3410             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3411             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3412             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3413             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3414
  3415         16  CF-AH-OPT.
  3416             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3417             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3418             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3419             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3420             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3421             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3422             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3423             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3424             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3425             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3426
  3427         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3428             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3429             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3430             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3431
  3432         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3433
  3434         16  FILLER                         PIC X(673).
  3435
  3436
  3437****************************************************************
  3438*             MORTGAGE SYSTEM PLAN RECORD                      *
  3439****************************************************************
  3440
  3441     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3442         16  CF-PLAN-TYPE                   PIC X.
  3443             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3444             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3445             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3446         16  CF-PLAN-ABBREV                 PIC XXX.
  3447         16  CF-PLAN-DESCRIPT               PIC X(10).
  3448         16  CF-PLAN-NOTES                  PIC X(20).
  3449         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3450         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  67
* EL154.cbl
  3451             20  CF-PLAN-TERM-DATA.
  3452                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3453                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3454             20  CF-PLAN-AGE-DATA.
  3455                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3456                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3457                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3458             20  CF-PLAN-BENEFIT-DATA.
  3459                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3460                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3461                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3462                                            PIC S9(7)V99  COMP-3.
  3463         16  CF-PLAN-POLICY-FORMS.
  3464             20  CF-POLICY-FORM             PIC X(12).
  3465             20  CF-MASTER-APPLICATION      PIC X(12).
  3466             20  CF-MASTER-POLICY           PIC X(12).
  3467         16  CF-PLAN-RATING.
  3468             20  CF-RATE-CODE               PIC X(5).
  3469             20  CF-SEX-RATING              PIC X.
  3470                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3471                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3472             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3473             20  CF-SUB-STD-TYPE            PIC X.
  3474                 88  CF-PCT-OF-PREM            VALUE '1'.
  3475                 88  CF-PCT-OF-BENE            VALUE '2'.
  3476         16  CF-PLAN-PREM-TOLERANCES.
  3477             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3478             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3479         16  CF-PLAN-PYMT-TOLERANCES.
  3480             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3481             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3482         16  CF-PLAN-MISC-DATA.
  3483             20  FILLER                     PIC X.
  3484             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3485             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3486         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3487         16  CF-PLAN-IND-GRP                PIC X.
  3488             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3489                                                     '1'.
  3490             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3491                                                     '2'.
  3492         16  CF-MIB-SEARCH-SW               PIC X.
  3493             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3494             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3495             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3496             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3497         16  CF-ALPHA-SEARCH-SW             PIC X.
  3498             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3499             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3500             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3501             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3502             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3503             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3504             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3505             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3506             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3507             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3508                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  68
* EL154.cbl
  3509                                                     'X' 'Y' 'Z'.
  3510         16  CF-EFF-DT-RULE-SW              PIC X.
  3511             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3512             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3513             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3514             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3515             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3516         16  FILLER                         PIC X(4).
  3517         16  CF-HEALTH-QUESTIONS            PIC X.
  3518             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3519         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3520         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3521         16  CF-PLAN-SNGL-JNT               PIC X.
  3522             88  CF-COMBINED-PLAN              VALUE 'C'.
  3523             88  CF-JNT-PLAN                   VALUE 'J'.
  3524             88  CF-SNGL-PLAN                  VALUE 'S'.
  3525         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3526         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3527         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3528         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3529         16  CF-RERATE-CNTL                 PIC  X.
  3530             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3531             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3532             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3533             88  CF-AUTO-RECALC                 VALUE '4'.
  3534         16  CF-BENEFIT-TYPE                PIC  X.
  3535             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3536             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3537         16  CF-POLICY-FEE                  PIC S999V99
  3538                                                    COMP-3.
  3539         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3540         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3541         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3542         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3543         16  FILLER                         PIC  X(32).
  3544         16  CF-TERMINATION-FORM            PIC  X(04).
  3545         16  FILLER                         PIC  X(08).
  3546         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3547                                                       COMP-3.
  3548         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3549         16  CF-ISSUE-LETTER                PIC  X(4).
  3550         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3551         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3552             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3553             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3554         16  CF-MP-REFUND-CALC              PIC X.
  3555             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3556             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3557             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3558             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3559             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3560             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3561             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3562             88  CF-MP-REFD-MEAN                VALUE '8'.
  3563         16  CF-ALT-RATE-CODE               PIC  X(5).
  3564
  3565
  3566         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  69
* EL154.cbl
  3567****************************************************************
  3568*             MORTGAGE COMPANY MASTER RECORD                   *
  3569****************************************************************
  3570
  3571     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3572         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3573         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3574             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3575             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3576             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3577             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3578             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3579
  3580         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3581         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3582         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3583         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3584         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3585
  3586         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3587             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3588         16  CF-MP-RECON-USE-IND            PIC X(1).
  3589             88  CF-MP-USE-RECON             VALUE 'Y'.
  3590         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3591             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3592         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3593             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3594             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3595         16  FILLER                         PIC X(1).
  3596         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3597             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3598         16  CF-MORTG-MIB-VERSION           PIC X.
  3599             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3600             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3601             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3602         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3603             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3604                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3605             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3606                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3607             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3608                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3609             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3610                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3611             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3612                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3613             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3614                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3615         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3616         16  FILLER                         PIC X(7).
  3617         16  CF-MORTG-DESTINATION-SYMBOL.
  3618             20  CF-MORTG-MIB-COMM          PIC X(5).
  3619             20  CF-MORTG-MIB-TERM          PIC X(5).
  3620         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3621             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3622         16  FILLER                         PIC X(03).
  3623         16  CF-MP-CHECK-NO-CONTROL.
  3624             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  70
* EL154.cbl
  3625                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3626                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3627                                                ' ' LOW-VALUES.
  3628                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3629                                               VALUE '3'.
  3630         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3631         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3632         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3633             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3634                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3635             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3636                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3637             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3638                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3639             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3640                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3641             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3642                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3643             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3644                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3645         16  CF-MORTG-BILLING-AREA.
  3646             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3647                                            PIC X.
  3648         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3649         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3650         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3651         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3652             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3653             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3654         16  FILLER                         PIC X.
  3655         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3656             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3657             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3658         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3659         16  FILLER                         PIC X(8).
  3660         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3661         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3662         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3663         16  CF-ACH-COMPANY-ID.
  3664             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3665                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3666                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3667                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3668             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3669         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3670             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3671         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3672             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3673             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3674         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3675         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3676         16  FILLER                         PIC X(536).
  3677
  3678****************************************************************
  3679*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3680****************************************************************
  3681
  3682     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  71
* EL154.cbl
  3683         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3684             20  CF-FEMALE-HEIGHT.
  3685                 24  CF-FEMALE-FT           PIC 99.
  3686                 24  CF-FEMALE-IN           PIC 99.
  3687             20  CF-FEMALE-MIN-WT           PIC 999.
  3688             20  CF-FEMALE-MAX-WT           PIC 999.
  3689         16  FILLER                         PIC X(428).
  3690
  3691     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3692         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3693             20  CF-MALE-HEIGHT.
  3694                 24  CF-MALE-FT             PIC 99.
  3695                 24  CF-MALE-IN             PIC 99.
  3696             20  CF-MALE-MIN-WT             PIC 999.
  3697             20  CF-MALE-MAX-WT             PIC 999.
  3698         16  FILLER                         PIC X(428).
  3699******************************************************************
  3700*             AUTOMATIC ACTIVITY RECORD                          *
  3701******************************************************************
  3702     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3703         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3704             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3705             20  CF-SYS-LETTER-ID           PIC X(04).
  3706             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3707             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3708             20  CF-SYS-RESET-SW            PIC X(01).
  3709             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3710             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3711
  3712         16  FILLER                         PIC X(50).
  3713
  3714         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3715             20  CF-USER-ACTIVE-SW          PIC X(01).
  3716             20  CF-USER-LETTER-ID          PIC X(04).
  3717             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3718             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3719             20  CF-USER-RESET-SW           PIC X(01).
  3720             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3721             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3722             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3723
  3724         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  72
* EL154.cbl
  3726*                            COPY ELCMSTR.
  3727******************************************************************
  3728*                                                                *
  3729*                            ELCMSTR.                            *
  3730*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3731*                            VMOD=2.012                          *
  3732*                                                                *
  3733*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3734*                                                                *
  3735*   FILE TYPE = VSAM,KSDS                                        *
  3736*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3737*                                                                *
  3738*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3739*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3740*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3741*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3742*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3743*                                                 RKP=75,LEN=21  *
  3744*                                                                *
  3745*   **** NOTE ****                                               *
  3746*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3747*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3748*                                                                *
  3749*   LOG = YES                                                    *
  3750*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3751******************************************************************
  3752*                   C H A N G E   L O G
  3753*
  3754* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3755*-----------------------------------------------------------------
  3756*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3757* EFFECTIVE    NUMBER
  3758*-----------------------------------------------------------------
  3759* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3760* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3761* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3762* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3763******************************************************************
  3764 01  CLAIM-MASTER.
  3765     12  CL-RECORD-ID                PIC XX.
  3766         88  VALID-CL-ID         VALUE 'CL'.
  3767
  3768     12  CL-CONTROL-PRIMARY.
  3769         16  CL-COMPANY-CD           PIC X.
  3770         16  CL-CARRIER              PIC X.
  3771         16  CL-CLAIM-NO             PIC X(7).
  3772         16  CL-CERT-NO.
  3773             20  CL-CERT-PRIME       PIC X(10).
  3774             20  CL-CERT-SFX         PIC X.
  3775
  3776     12  CL-CONTROL-BY-NAME.
  3777         16  CL-COMPANY-CD-A1        PIC X.
  3778         16  CL-INSURED-LAST-NAME    PIC X(15).
  3779         16  CL-INSURED-NAME.
  3780             20  CL-INSURED-1ST-NAME PIC X(12).
  3781             20  CL-INSURED-MID-INIT PIC X.
  3782
  3783     12  CL-CONTROL-BY-SSN.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  73
* EL154.cbl
  3784         16  CL-COMPANY-CD-A2        PIC X.
  3785         16  CL-SOC-SEC-NO.
  3786             20  CL-SSN-STATE        PIC XX.
  3787             20  CL-SSN-ACCOUNT      PIC X(6).
  3788             20  CL-SSN-LN3          PIC X(3).
  3789
  3790     12  CL-CONTROL-BY-CERT-NO.
  3791         16  CL-COMPANY-CD-A4        PIC X.
  3792         16  CL-CERT-NO-A4.
  3793             20  CL-CERT-A4-PRIME    PIC X(10).
  3794             20  CL-CERT-A4-SFX      PIC X.
  3795
  3796     12  CL-CONTROL-BY-CCN.
  3797         16  CL-COMPANY-CD-A5        PIC X.
  3798         16  CL-CCN-A5.
  3799             20  CL-CCN.
  3800                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3801                 24  CL-CCN-PRIME-A5 PIC X(12).
  3802             20  CL-CCN-FILLER-A5    PIC X(4).
  3803
  3804     12  CL-INSURED-PROFILE-DATA.
  3805         16  CL-INSURED-BIRTH-DT     PIC XX.
  3806         16  CL-INSURED-SEX-CD       PIC X.
  3807             88  INSURED-IS-MALE        VALUE 'M'.
  3808             88  INSURED-IS-FEMALE      VALUE 'F'.
  3809             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3810         16  CL-INSURED-OCC-CD       PIC X(6).
  3811         16  FILLER                  PIC X(5).
  3812
  3813     12  CL-PROCESSING-INFO.
  3814         16  CL-PROCESSOR-ID         PIC X(4).
  3815         16  CL-CLAIM-STATUS         PIC X.
  3816             88  CLAIM-IS-OPEN          VALUE 'O'.
  3817             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3818         16  CL-CLAIM-TYPE           PIC X.
  3819*            88  AH-CLAIM               VALUE 'A'.
  3820*            88  LIFE-CLAIM             VALUE 'L'.
  3821*            88  PROPERTY-CLAIM         VALUE 'P'.
  3822*            88  IUI-CLAIM              VALUE 'I'.
  3823*            88  GAP-CLAIM              VALUE 'G'.
  3824         16  CL-CLAIM-PREM-TYPE      PIC X.
  3825             88  SINGLE-PREMIUM         VALUE '1'.
  3826             88  O-B-COVERAGE           VALUE '2'.
  3827             88  OPEN-END-COVERAGE      VALUE '3'.
  3828         16  CL-INCURRED-DT          PIC XX.
  3829         16  CL-REPORTED-DT          PIC XX.
  3830         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3831         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3832         16  CL-LAST-PMT-DT          PIC XX.
  3833         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3834         16  CL-PAID-THRU-DT         PIC XX.
  3835         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3836         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3837         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3838         16  CL-PMT-CALC-METHOD      PIC X.
  3839             88  CL-360-DAY-YR          VALUE '1'.
  3840             88  CL-365-DAY-YR          VALUE '2'.
  3841             88  CL-FULL-MONTHS         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  74
* EL154.cbl
  3842         16  CL-CAUSE-CD             PIC X(6).
  3843
  3844         16  CL-PRIME-CERT-NO.
  3845             20  CL-PRIME-CERT-PRIME PIC X(10).
  3846             20  CL-PRIME-CERT-SFX   PIC X.
  3847
  3848         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3849             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3850             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3851
  3852         16  CL-MICROFILM-NO         PIC X(10).
  3853         16  FILLER REDEFINES CL-MICROFILM-NO.
  3854             20  CL-BENEFIT-PERIOD   PIC 99.
  3855             20  FILLER              PIC X(8).
  3856         16  CL-PROG-FORM-TYPE       PIC X.
  3857         16  CL-LAST-ADD-ON-DT       PIC XX.
  3858
  3859         16  CL-LAST-REOPEN-DT       PIC XX.
  3860         16  CL-LAST-CLOSE-DT        PIC XX.
  3861         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3862             88  FINAL-PAID             VALUE '1'.
  3863             88  CLAIM-DENIED           VALUE '2'.
  3864             88  AUTO-CLOSE             VALUE '3'.
  3865             88  MANUAL-CLOSE           VALUE '4'.
  3866             88  BENEFITS-CHANGED       VALUE 'C'.
  3867             88  SETUP-ERRORS           VALUE 'E'.
  3868         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3869         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3870         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3871             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3872         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3873         16  FILLER                  PIC X.
  3874
  3875     12  CL-CERTIFICATE-DATA.
  3876         16  CL-CERT-ORIGIN          PIC X.
  3877             88  CERT-WAS-ONLINE        VALUE '1'.
  3878             88  CERT-WAS-CREATED       VALUE '2'.
  3879             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3880         16  CL-CERT-KEY-DATA.
  3881             20  CL-CERT-CARRIER     PIC X.
  3882             20  CL-CERT-GROUPING    PIC X(6).
  3883             20  CL-CERT-STATE       PIC XX.
  3884             20  CL-CERT-ACCOUNT.
  3885                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3886                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3887             20  CL-CERT-EFF-DT      PIC XX.
  3888
  3889     12  CL-STATUS-CONTROLS.
  3890         16  CL-PRIORITY-CD          PIC X.
  3891             88  CONFIDENTIAL-DATA      VALUE '8'.
  3892             88  HIGHEST-PRIORITY       VALUE '9'.
  3893         16  CL-SUPV-ATTN-CD         PIC X.
  3894             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3895             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3896         16  CL-PURGED-DT            PIC XX.
  3897         16  CL-RESTORED-DT          PIC XX.
  3898         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3899         16  CL-NEXT-RESEND-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  75
* EL154.cbl
  3900         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3901         16  CL-CRITICAL-PERIOD      PIC 99.
  3902*        16  FILLER                  PIC XX.
  3903         16  CL-LAST-MAINT-DT        PIC XX.
  3904         16  CL-LAST-MAINT-USER      PIC X(4).
  3905         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3906         16  CL-LAST-MAINT-TYPE      PIC X.
  3907             88  CLAIM-SET-UP           VALUE ' '.
  3908             88  PAYMENT-MADE           VALUE '1'.
  3909             88  LETTER-SENT            VALUE '2'.
  3910             88  MASTER-WAS-ALTERED     VALUE '3'.
  3911             88  MASTER-WAS-RESTORED    VALUE '4'.
  3912             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3913             88  FILE-CONVERTED         VALUE '6'.
  3914             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3915             88  ERROR-CORRECTION       VALUE 'E'.
  3916         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3917         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3918         16  CL-BENEFICIARY          PIC X(10).
  3919         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3920         16  CL-DENIAL-TYPE          PIC X.
  3921             88  CL-TYPE-DENIAL          VALUE '1'.
  3922             88  CL-TYPE-RESCISSION      VALUE '2'.
  3923             88  CL-TYPE-REFORMATION     VALUE '3'.
  3924             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3925             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3926         16  filler                  pic x(5).
  3927*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3928*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3929*        16  CL-RTW-DT               PIC XX.
  3930
  3931     12  CL-TRAILER-CONTROLS.
  3932         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3933             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3934             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3935             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3936         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3937         16  FILLER                  PIC XX.
  3938         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3939         16  CL-ADDRESS-TRAILER-CNT.
  3940             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3941                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3942             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3943                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3944             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3945                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3946             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3947                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3948             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3949                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3950             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3951                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3952             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3953                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3954
  3955     12  CL-CV-REFERENCE-NO.
  3956         16  CL-CV-REFNO-PRIME       PIC X(18).
  3957         16  CL-CV-REFNO-SFX         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  76
* EL154.cbl
  3958
  3959     12  CL-FILE-LOCATION            PIC X(4).
  3960
  3961     12  CL-PROCESS-ERRORS.
  3962         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3963             88  NO-FATAL-ERRORS        VALUE ZERO.
  3964         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3965             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3966
  3967     12  CL-PRODUCT-CD               PIC X.
  3968
  3969     12  CL-CURRENT-KEY-DATA.
  3970         16  CL-CURRENT-CARRIER      PIC X.
  3971         16  CL-CURRENT-GROUPING     PIC X(6).
  3972         16  CL-CURRENT-STATE        PIC XX.
  3973         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3974
  3975     12  CL-ASSOCIATES               PIC X.
  3976         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3977         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3978         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3979         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3980
  3981     12  CL-ACTIVITY-CODE            PIC 99.
  3982     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3983     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3984
  3985     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3986     12  CL-LAG-REPORT-CODE          PIC 9.
  3987     12  CL-LOAN-TYPE                PIC XX.
  3988     12  CL-LEGAL-STATE              PIC XX.
  3989
  3990     12  CL-YESNOSW                  PIC X.
  3991     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3992         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3993         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3994         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3995     12  cl-insured-type             pic x.
  3996         88  cl-claim-on-primary         value 'P'.
  3997         88  cl-claim-on-co-borrower     value 'C'.
  3998     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  77
* EL154.cbl
  4000*                            COPY ELCTRLR.
  4001******************************************************************
  4002*                                                                *
  4003*                            ELCTRLR.                            *
  4004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4005*                            VMOD=2.014                          *
  4006*                                                                *
  4007*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4008*                                                                *
  4009*   FILE TYPE = VSAM,KSDS                                        *
  4010*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4011*                                                                *
  4012*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4013*       ALTERNATE INDEX = NONE                                   *
  4014*                                                                *
  4015*   LOG = YES                                                    *
  4016*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4017******************************************************************
  4018*                   C H A N G E   L O G
  4019*
  4020* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4021*-----------------------------------------------------------------
  4022*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4023* EFFECTIVE    NUMBER
  4024*-----------------------------------------------------------------
  4025* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4026* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4027* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4028* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4029* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4030* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4031* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4032* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4033* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4034* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4035* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4036* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4037* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4038* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4039* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4040* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4041* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  4042* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  4043* 040814    2014030500002  AJRA  ADD ICD CODES
  4044******************************************************************
  4045 01  ACTIVITY-TRAILERS.
  4046     12  AT-RECORD-ID                    PIC XX.
  4047         88  VALID-AT-ID                       VALUE 'AT'.
  4048
  4049     12  AT-CONTROL-PRIMARY.
  4050         16  AT-COMPANY-CD               PIC X.
  4051         16  AT-CARRIER                  PIC X.
  4052         16  AT-CLAIM-NO                 PIC X(7).
  4053         16  AT-CERT-NO.
  4054             20  AT-CERT-PRIME           PIC X(10).
  4055             20  AT-CERT-SFX             PIC X.
  4056         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4057             88  AT-1ST-TRL-AVAIL             VALUE +4095.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  78
* EL154.cbl
  4058             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4059             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4060             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4061             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4062             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4063             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4064             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4065             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4066             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4067             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4068             88  AT-BENEFICIARY-TRL           VALUE +91.
  4069             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4070             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4071             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4072             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4073
  4074     12  AT-TRAILER-TYPE                 PIC X.
  4075         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4076         88  PAYMENT-TR                       VALUE '2'.
  4077         88  AUTO-PAY-TR                      VALUE '3'.
  4078         88  CORRESPONDENCE-TR                VALUE '4'.
  4079         88  ADDRESS-TR                       VALUE '5'.
  4080         88  GENERAL-INFO-TR                  VALUE '6'.
  4081         88  AUTO-PROMPT-TR                   VALUE '7'.
  4082         88  DENIAL-TR                        VALUE '8'.
  4083         88  INCURRED-CHG-TR                  VALUE '9'.
  4084         88  FORM-CONTROL-TR                  VALUE 'A'.
  4085
  4086     12  AT-RECORDED-DT                  PIC XX.
  4087     12  AT-RECORDED-BY                  PIC X(4).
  4088     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4089
  4090     12  AT-TRAILER-BODY                 PIC X(165).
  4091
  4092     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4093         16  AT-RESERVE-CONTROLS.
  4094             20  AT-MANUAL-SW            PIC X.
  4095                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4096             20  AT-FUTURE-SW            PIC X.
  4097                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4098             20  AT-PTC-SW               PIC X.
  4099                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4100             20  AT-IBNR-SW              PIC X.
  4101                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4102             20  AT-PTC-LF-SW            PIC X.
  4103                 88  AT-LF-PTC-USED          VALUE '1'.
  4104             20  AT-CDT-ACCESS-METHOD    PIC X.
  4105                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4106                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4107                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4108             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4109         16  AT-LAST-COMPUTED-DT         PIC XX.
  4110         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4111         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4112         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4113         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4114         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4115         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  79
* EL154.cbl
  4116         16  AT-EXPENSE-CONTROLS.
  4117             20  AT-EXPENSE-METHOD       PIC X.
  4118                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4119                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4120                 88  PERCENT-OF-PMT           VALUE '3'.
  4121                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4122             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4123             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4124         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4125         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4126
  4127         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4128         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4129
  4130*        16  FILLER                      PIC X(53).
  4131         16  FILLER                      PIC X(47).
  4132
  4133         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4134         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4135
  4136         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4137             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4138             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4139*                    C = CLOSED
  4140*                    O = OPEN
  4141             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4142*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4143
  4144     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4145         16  AT-PAYMENT-TYPE             PIC X.
  4146             88  PARTIAL-PAYMENT                VALUE '1'.
  4147             88  FINAL-PAYMENT                  VALUE '2'.
  4148             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4149             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4150             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4151             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4152             88  VOIDED-PAYMENT                 VALUE '9'.
  4153             88  TRANSFER                       VALUE 'T'.
  4154             88  LIFE-INTEREST                  VALUE 'I'.
  4155
  4156         16  AT-CLAIM-TYPE               PIC X.
  4157             88  PAID-FOR-AH                    VALUE 'A'.
  4158             88  PAID-FOR-LIFE                  VALUE 'L'.
  4159             88  PAID-FOR-IUI                   VALUE 'I'.
  4160             88  PAID-FOR-GAP                   VALUE 'G'.
  4161         16  AT-CLAIM-PREM-TYPE          PIC X.
  4162             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4163             88  AT-O-B-COVERAGE                VALUE '2'.
  4164             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4165         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4166         16  AT-CHECK-NO                 PIC X(7).
  4167         16  AT-PAID-FROM-DT             PIC XX.
  4168         16  AT-PAID-THRU-DT             PIC XX.
  4169         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4170         16  FILLER                      PIC X.
  4171         16  AT-PAYEES-NAME              PIC X(30).
  4172         16  AT-PAYMENT-ORIGIN           PIC X.
  4173             88  ONLINE-MANUAL-PMT              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  80
* EL154.cbl
  4174             88  ONLINE-AUTO-PMT                VALUE '2'.
  4175             88  OFFLINE-PMT                    VALUE '3'.
  4176         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4177         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4178         16  AT-VOID-DATA.
  4179             20  AT-VOID-DT              PIC XX.
  4180*00144       20  AT-VOID-REASON          PIC X(30).
  4181             20  AT-VOID-REASON          PIC X(26).
  4182         16  AT-PMT-APPROVED-BY          PIC X(04).
  4183         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4184         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4185         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4186                                         PIC S99V9(5)  COMP-3.
  4187         16  AT-CREDIT-INTERFACE.
  4188             20  AT-PMT-SELECT-DT        PIC XX.
  4189                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4190             20  AT-PMT-ACCEPT-DT        PIC XX.
  4191                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4192             20  AT-VOID-SELECT-DT       PIC XX.
  4193                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4194             20  AT-VOID-ACCEPT-DT       PIC XX.
  4195                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4196
  4197         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4198                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4199                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4200         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4201
  4202         16  AT-FORCE-CONTROL            PIC X.
  4203             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4204         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4205         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4206         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4207         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4208         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4209         16  AT-BENEFIT-TYPE             PIC X.
  4210
  4211         16  AT-EXPENSE-TYPE             PIC X.
  4212         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4213
  4214         16  AT-PAYEE-TYPE-CD.
  4215             20  AT-PAYEE-TYPE           PIC X.
  4216                 88  INSURED-PAID           VALUE 'I'.
  4217                 88  BENEFICIARY-PAID       VALUE 'B'.
  4218                 88  ACCOUNT-PAID           VALUE 'A'.
  4219                 88  OTHER-1-PAID           VALUE 'O'.
  4220                 88  OTHER-2-PAID           VALUE 'Q'.
  4221                 88  DOCTOR-PAID            VALUE 'P'.
  4222                 88  EMPLOYER-PAID          VALUE 'E'.
  4223             20  AT-PAYEE-SEQ            PIC X.
  4224
  4225         16  AT-CASH-PAYMENT             PIC X.
  4226         16  AT-GROUPED-PAYMENT          PIC X.
  4227         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4228         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4229         16  AT-APPROVED-LEVEL           PIC X.
  4230         16  AT-VOID-TYPE                PIC X.
  4231             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  81
* EL154.cbl
  4232             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4233         16  AT-AIG-UNEMP-IND            PIC X.
  4234             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4235         16  AT-ASSOCIATES               PIC X.
  4236             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4237             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4238
  4239         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4240         16  AT-CV-PMT-CODE              PIC X.
  4241             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4242             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4243             88  FULL-ADD-PAYMENT           VALUE '3'.
  4244             88  HALF-ADD-PAYMENT           VALUE '4'.
  4245             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4246             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4247             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4248             88  ADDL-PAYMENT               VALUE '8'.
  4249
  4250         16  AT-EOB-CODE1                PIC XXX.
  4251         16  AT-EOB-CODE2                PIC XXX.
  4252         16  AT-EOB-CODE3                PIC XXX.
  4253         16  FILLER REDEFINES AT-EOB-CODE3.
  4254             20  AT-PRINT-CLM-FORM       PIC X.
  4255             20  AT-PRINT-SURVEY         PIC X.
  4256             20  AT-SPECIAL-RELEASE      PIC X.
  4257         16  AT-EOB-CODE4                PIC XXX.
  4258         16  FILLER REDEFINES AT-EOB-CODE4.
  4259             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4260             20  FILLER                  PIC X.
  4261         16  AT-EOB-CODE5                PIC XXX.
  4262         16  FILLER REDEFINES AT-EOB-CODE5.
  4263             20  AT-PMT-PROOF-DT         PIC XX.
  4264             20  FILLER                  PIC X.
  4265
  4266         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4267             88  AT-PRINT-EOB            VALUE 'Y'.
  4268
  4269         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4270         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4271
  4272     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4273         16  AT-SCHEDULE-START-DT        PIC XX.
  4274         16  AT-SCHEDULE-END-DT          PIC XX.
  4275         16  AT-TERMINATED-DT            PIC XX.
  4276         16  AT-LAST-PMT-TYPE            PIC X.
  4277             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4278             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4279         16  AT-FIRST-PMT-DATA.
  4280             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4281             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4282             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4283         16  AT-REGULAR-PMT-DATA.
  4284             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4285             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4286             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4287         16  AT-AUTO-PAYEE-CD.
  4288             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4289                 88  INSURED-PAID-AUTO      VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  82
* EL154.cbl
  4290                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4291                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4292                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4293                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4294             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4295         16  AT-AUTO-PAY-DAY             PIC 99.
  4296         16  AT-AUTO-CASH                PIC X.
  4297             88  AT-CASH                      VALUE 'Y'.
  4298             88  AT-NON-CASH                  VALUE 'N'.
  4299*        16  FILLER                      PIC X(129).
  4300         16  AT-AUTO-END-LETTER          PIC X(4).
  4301         16  FILLER                      PIC X(125).
  4302
  4303         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4304         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4305
  4306     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4307         16  AT-LETTER-SENT-DT           PIC XX.
  4308         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4309         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4310         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4311         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4312         16  AT-LETTER-ORIGIN            PIC X.
  4313             88  ONLINE-CREATION              VALUE '1' '3'.
  4314             88  OFFLINE-CREATION             VALUE '2' '4'.
  4315             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4316             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4317         16  AT-STD-LETTER-FORM          PIC X(4).
  4318         16  AT-REASON-TEXT              PIC X(70).
  4319         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4320         16  AT-ADDRESEE-TYPE            PIC X.
  4321              88  INSURED-ADDRESEE            VALUE 'I'.
  4322              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4323              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4324              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4325              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4326              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4327              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4328         16  AT-ADDRESSEE-NAME           PIC X(30).
  4329         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4330         16  AT-RESEND-PRINT-DATE        PIC XX.
  4331         16  AT-CORR-SOL-UNSOL           PIC X.
  4332         16  AT-LETTER-PURGED-DT         PIC XX.
  4333*
  4334*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4335*
  4336         16  AT-CSO-REDEFINITION.
  4337             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4338             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4339             20  AT-LETTER-TO-BENE       PIC X(1).
  4340             20  AT-STOP-LETTER-DT       PIC X(2).
  4341             20  FILLER                  PIC X(19).
  4342*             20  FILLER                  PIC X(27).
  4343             20  AT-CSO-LETTER-STATUS    PIC X.
  4344                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4345                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4346                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4347             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  83
* EL154.cbl
  4348             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4349*
  4350*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4351*
  4352*        16  FILLER                      PIC X(26).
  4353*
  4354*        16  AT-DMD-BSR-CODE             PIC X.
  4355*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4356*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4357*
  4358*        16  AT-DMD-LETTER-STATUS        PIC X.
  4359*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4360*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4361*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4362*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4363*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4364
  4365         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4366         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4367
  4368     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4369         16  AT-ADDRESS-TYPE             PIC X.
  4370             88  INSURED-ADDRESS               VALUE 'I'.
  4371             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4372             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4373             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4374             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4375             88  OTHER-ADDRESS-1               VALUE 'O'.
  4376             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4377         16  AT-MAIL-TO-NAME             PIC X(30).
  4378         16  AT-ADDRESS-LINE-1           PIC X(30).
  4379         16  AT-ADDRESS-LINE-2           PIC X(30).
  4380         16  AT-CITY-STATE.
  4381             20  AT-CITY                 PIC X(28).
  4382             20  AT-STATE                PIC XX.
  4383         16  AT-ZIP.
  4384             20  AT-ZIP-CODE.
  4385                 24  AT-ZIP-1ST          PIC X.
  4386                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4387                 24  FILLER              PIC X(4).
  4388             20  AT-ZIP-PLUS4            PIC X(4).
  4389         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4390             20  AT-CAN-POSTAL-1         PIC XXX.
  4391             20  AT-CAN-POSTAL-2         PIC XXX.
  4392             20  FILLER                  PIC XXX.
  4393         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4394*         16  FILLER                      PIC X(23).
  4395         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4396         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4397         16  FILLER                      PIC X(13).
  4398         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4399         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4400
  4401     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4402         16  AT-INFO-LINE-1              PIC X(60).
  4403         16  FILLER REDEFINES AT-INFO-LINE-1.
  4404             20  AT-NOTE-ERROR-NO OCCURS 15
  4405                                         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  84
* EL154.cbl
  4406         16  AT-INFO-LINE-2              PIC X(60).
  4407         16  FILLER REDEFINES AT-INFO-LINE-2.
  4408             20  AT-ICD-CODE-1           PIC X(8).
  4409             20  AT-ICD-CODE-2           PIC X(8).
  4410             20  FILLER                  PIC X(44).
  4411         16  AT-INFO-TRAILER-TYPE        PIC X.
  4412             88  AT-ERRORS-NOTE          VALUE 'E'.
  4413             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4414             88  AT-CALL-NOTE            VALUE 'C'.
  4415             88  AT-MAINT-NOTE           VALUE 'M'.
  4416             88  AT-CERT-CHANGE          VALUE 'X'.
  4417             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4418             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4419             88  AT-CERT-CANCELLED       VALUE 'T'.
  4420         16  AT-CALL-TYPE                PIC X.
  4421             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4422             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4423         16  AT-NOTE-CONTINUATION        PIC X.
  4424             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4425         16  AT-EOB-CODES-EXIST          PIC X.
  4426             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4427         16  FILLER                      PIC X(35).
  4428         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4429         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4430
  4431     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4432         16  AT-PROMPT-LINE-1            PIC X(60).
  4433         16  AT-PROMPT-LINE-2            PIC X(60).
  4434         16  AT-PROMPT-START-DT          PIC XX.
  4435         16  AT-PROMPT-END-DT            PIC XX.
  4436         16  FILLER                      PIC X(35).
  4437         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4438         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4439
  4440     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4441         16  AT-DENIAL-INFO-1            PIC X(60).
  4442         16  AT-DENIAL-INFO-2            PIC X(60).
  4443         16  AT-DENIAL-DT                PIC XX.
  4444         16  AT-RETRACTION-DT            PIC XX.
  4445         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4446*         16  FILLER                      PIC X(31).
  4447         16  AT-DENIAL-PROOF-DT          PIC XX.
  4448         16  FILLER                      PIC X(29).
  4449         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4450         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4451
  4452     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4453         16  AT-OLD-INCURRED-DT          PIC XX.
  4454         16  AT-OLD-REPORTED-DT          PIC XX.
  4455         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4456         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4457         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4458         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4459         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4460         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4461         16  FILLER                      PIC X(26).
  4462         16  AT-OLD-DIAG-CODE            PIC X(6).
  4463         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  85
* EL154.cbl
  4464         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4465         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4466         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4467         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4468         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4469         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4470         16  AT-OLD-ICD-CODE-1           PIC X(8).
  4471         16  AT-OLD-ICD-CODE-2           PIC X(8).
  4472         16  FILLER                      PIC X(9).
  4473         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4474
  4475     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4476         16  AT-FORM-SEND-ON-DT          PIC XX.
  4477         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4478         16  AT-FORM-RE-SEND-DT          PIC XX.
  4479         16  AT-FORM-ANSWERED-DT         PIC XX.
  4480         16  AT-FORM-PRINTED-DT          PIC XX.
  4481         16  AT-FORM-REPRINT-DT          PIC XX.
  4482         16  AT-FORM-TYPE                PIC X.
  4483             88  INITIAL-FORM                  VALUE '1'.
  4484             88  PROGRESS-FORM                 VALUE '2'.
  4485         16  AT-INSTRUCT-LN-1            PIC X(28).
  4486         16  AT-INSTRUCT-LN-2            PIC X(28).
  4487         16  AT-INSTRUCT-LN-3            PIC X(28).
  4488         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4489         16  AT-FORM-ADDRESS             PIC X.
  4490             88  FORM-TO-INSURED              VALUE 'I'.
  4491             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4492             88  FORM-TO-OTHER-1              VALUE 'O'.
  4493             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4494         16  AT-RELATED-1.
  4495             20 AT-REL-CARR-1            PIC X.
  4496             20 AT-REL-CLAIM-1           PIC X(7).
  4497             20 AT-REL-CERT-1            PIC X(11).
  4498         16  AT-RELATED-2.
  4499             20 AT-REL-CARR-2            PIC X.
  4500             20 AT-REL-CLAIM-2           PIC X(7).
  4501             20 AT-REL-CERT-2            PIC X(11).
  4502         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4503         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4504         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4505         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4506         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4507         16  AT-STOP-FORM-DT             PIC X(2).
  4508
  4509         16  FILLER                      PIC X(09).
  4510         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4511         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4512******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  86
* EL154.cbl
  4514*                            COPY ELCCERT.
  4515******************************************************************
  4516*                                                                *
  4517*                            ELCCERT.                            *
  4518*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4519*                            VMOD=2.013                          *
  4520*                                                                *
  4521*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4522*                                                                *
  4523*   FILE TYPE = VSAM,KSDS                                        *
  4524*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4525*                                                                *
  4526*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4527*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4528*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4529*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4530*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4531*                                                                *
  4532*   LOG = YES                                                    *
  4533*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4534******************************************************************
  4535*                   C H A N G E   L O G
  4536*
  4537* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4538*-----------------------------------------------------------------
  4539*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4540* EFFECTIVE    NUMBER
  4541*-----------------------------------------------------------------
  4542* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4543* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4544* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4545* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4546* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4547* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4548* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4549* 032612  CR2011110200001  PEMA  AHL CHANGES
  4550******************************************************************
  4551
  4552 01  CERTIFICATE-MASTER.
  4553     12  CM-RECORD-ID                      PIC XX.
  4554         88  VALID-CM-ID                      VALUE 'CM'.
  4555
  4556     12  CM-CONTROL-PRIMARY.
  4557         16  CM-COMPANY-CD                 PIC X.
  4558         16  CM-CARRIER                    PIC X.
  4559         16  CM-GROUPING.
  4560             20  CM-GROUPING-PREFIX        PIC X(3).
  4561             20  CM-GROUPING-PRIME         PIC X(3).
  4562         16  CM-STATE                      PIC XX.
  4563         16  CM-ACCOUNT.
  4564             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4565             20  CM-ACCOUNT-PRIME          PIC X(6).
  4566         16  CM-CERT-EFF-DT                PIC XX.
  4567         16  CM-CERT-NO.
  4568             20  CM-CERT-PRIME             PIC X(10).
  4569             20  CM-CERT-SFX               PIC X.
  4570
  4571     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  87
* EL154.cbl
  4572         16  CM-COMPANY-CD-A1              PIC X.
  4573         16  CM-INSURED-LAST-NAME          PIC X(15).
  4574         16  CM-INSURED-INITIALS.
  4575             20  CM-INSURED-INITIAL1       PIC X.
  4576             20  CM-INSURED-INITIAL2       PIC X.
  4577
  4578     12  CM-CONTROL-BY-SSN.
  4579         16  CM-COMPANY-CD-A2              PIC X.
  4580         16  CM-SOC-SEC-NO.
  4581             20  CM-SSN-STATE              PIC XX.
  4582             20  CM-SSN-ACCOUNT            PIC X(6).
  4583             20  CM-SSN-LN3.
  4584                 25  CM-INSURED-INITIALS-A2.
  4585                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4586                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4587                 25 CM-PART-LAST-NAME-A2         PIC X.
  4588
  4589     12  CM-CONTROL-BY-CERT-NO.
  4590         16  CM-COMPANY-CD-A4              PIC X.
  4591         16  CM-CERT-NO-A4                 PIC X(11).
  4592
  4593     12  CM-CONTROL-BY-MEMB.
  4594         16  CM-COMPANY-CD-A5              PIC X.
  4595         16  CM-MEMBER-NO.
  4596             20  CM-MEMB-STATE             PIC XX.
  4597             20  CM-MEMB-ACCOUNT           PIC X(6).
  4598             20  CM-MEMB-LN4.
  4599                 25  CM-INSURED-INITIALS-A5.
  4600                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4601                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4602                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4603
  4604     12  CM-INSURED-PROFILE-DATA.
  4605         16  CM-INSURED-FIRST-NAME.
  4606             20  CM-INSURED-1ST-INIT       PIC X.
  4607             20  FILLER                    PIC X(9).
  4608         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4609         16  CM-INSURED-SEX                PIC X.
  4610             88  CM-SEX-MALE                  VALUE 'M'.
  4611             88  CM-SEX-FEMAL                 VALUE 'F'.
  4612         16  CM-INSURED-JOINT-AGE          PIC 99.
  4613         16  CM-JOINT-INSURED-NAME.
  4614             20  CM-JT-LAST-NAME           PIC X(15).
  4615             20  CM-JT-FIRST-NAME.
  4616                 24  CM-JT-1ST-INIT        PIC X.
  4617                 24  FILLER                PIC X(9).
  4618             20  CM-JT-INITIAL             PIC X.
  4619
  4620     12  CM-LIFE-DATA.
  4621         16  CM-LF-BENEFIT-CD              PIC XX.
  4622         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4623         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4624         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4625         16  CM-LF-DEV-CODE                PIC XXX.
  4626         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4627         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4628         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4629         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  88
* EL154.cbl
  4630         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4631         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4632         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4633         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4634         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4635         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4636         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4637         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4638         16  FILLER                        PIC XX.
  4639
  4640     12  CM-AH-DATA.
  4641         16  CM-AH-BENEFIT-CD              PIC XX.
  4642         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4643         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4644         16  CM-AH-DEV-CODE                PIC XXX.
  4645         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4646         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4647         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4648         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4649         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4650         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4651         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4652         16  CM-AH-PAID-THRU-DT            PIC XX.
  4653             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4654         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4655         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4656         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4657         16  FILLER                        PIC X.
  4658
  4659     12  CM-LOAN-INFORMATION.
  4660         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4661         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4662                                           PIC S9(5)V99  COMP-3.
  4663         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4664         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4665         16  CM-PAY-FREQUENCY              PIC S99.
  4666         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4667         16  CM-RATE-CLASS                 PIC XX.
  4668         16  CM-BENEFICIARY                PIC X(25).
  4669         16  CM-POLICY-FORM-NO             PIC X(12).
  4670         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4671         16  CM-LAST-ADD-ON-DT             PIC XX.
  4672         16  CM-DEDUCTIBLE-AMOUNTS.
  4673             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4674             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4675         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4676             20  CM-RESIDENT-STATE         PIC XX.
  4677             20  CM-RATE-CODE              PIC X(4).
  4678             20  FILLER                    PIC XX.
  4679         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4680             20  CM-LOAN-OFFICER           PIC X(5).
  4681             20  FILLER                    PIC XXX.
  4682         16  CM-CSR-CODE                   PIC XXX.
  4683         16  CM-UNDERWRITING-CODE          PIC X.
  4684             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4685         16  CM-POST-CARD-IND              PIC X.
  4686         16  CM-NH-INTERFACE-SW            PIC X.
  4687         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  89
* EL154.cbl
  4688             88  CM-SING-PRM                  VALUE '1'.
  4689             88  CM-O-B-COVERAGE              VALUE '2'.
  4690             88  CM-OPEN-END                  VALUE '3'.
  4691         16  CM-IND-GRP-TYPE               PIC X.
  4692             88  CM-INDIVIDUAL                VALUE 'I'.
  4693             88  CM-GROUP                     VALUE 'G'.
  4694         16  CM-SKIP-CODE                  PIC X.
  4695             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4696             88  SKIP-JULY                    VALUE '1'.
  4697             88  SKIP-AUGUST                  VALUE '2'.
  4698             88  SKIP-SEPTEMBER               VALUE '3'.
  4699             88  SKIP-JULY-AUG                VALUE '4'.
  4700             88  SKIP-AUG-SEPT                VALUE '5'.
  4701             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4702             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4703             88  SKIP-JUNE                    VALUE '8'.
  4704             88  SKIP-JUNE-JULY               VALUE '9'.
  4705             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4706             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4707         16  CM-PAYMENT-MODE               PIC X.
  4708             88  PAY-MONTHLY                  VALUE SPACE.
  4709             88  PAY-WEEKLY                   VALUE '1'.
  4710             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4711             88  PAY-BI-WEEKLY                VALUE '3'.
  4712             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4713         16  CM-LOAN-NUMBER                PIC X(8).
  4714         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4715         16  CM-OLD-LOF                    PIC XXX.
  4716*        16  CM-LOAN-OFFICER               PIC XXX.
  4717         16  CM-REIN-TABLE                 PIC XXX.
  4718         16  CM-SPECIAL-REIN-CODE          PIC X.
  4719         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4720         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4721         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4722
  4723     12  CM-STATUS-DATA.
  4724         16  CM-ENTRY-STATUS               PIC X.
  4725         16  CM-ENTRY-DT                   PIC XX.
  4726
  4727         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4728         16  CM-LF-CANCEL-DT               PIC XX.
  4729         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4730
  4731         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4732         16  CM-LF-DEATH-DT                PIC XX.
  4733         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4734
  4735         16  CM-LF-CURRENT-STATUS          PIC X.
  4736             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4737                                                'M' '4' '5' '9'.
  4738             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4739             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4740             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4741             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4742             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4743             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4744             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4745             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  90
* EL154.cbl
  4746             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4747             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4748             88  CM-LF-DECLINED               VALUE 'D'.
  4749             88  CM-LF-VOIDED                 VALUE 'V'.
  4750
  4751         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4752         16  CM-AH-CANCEL-DT               PIC XX.
  4753         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4754
  4755         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4756         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4757         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4758
  4759         16  CM-AH-CURRENT-STATUS          PIC X.
  4760             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4761                                                'M' '4' '5' '9'.
  4762             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4763             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4764             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4765             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4766             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4767             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4768             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4769             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4770             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4771             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4772             88  CM-AH-DECLINED               VALUE 'D'.
  4773             88  CM-AH-VOIDED                 VALUE 'V'.
  4774
  4775         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4776             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4777             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4778             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4779         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4780
  4781         16  CM-ENTRY-BATCH                PIC X(6).
  4782         16  CM-LF-EXIT-BATCH              PIC X(6).
  4783         16  CM-AH-EXIT-BATCH              PIC X(6).
  4784         16  CM-LAST-MONTH-END             PIC XX.
  4785
  4786     12  CM-NOTE-SW                        PIC X.
  4787         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4788         88  CERT-NOTES-PRESENT               VALUE '1'.
  4789         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4790         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4791         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4792         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4793         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4794         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4795     12  CM-COMP-EXCP-SW                   PIC X.
  4796         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4797         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4798     12  CM-INSURED-ADDRESS-SW             PIC X.
  4799         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4800         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4801
  4802*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4803     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  91
* EL154.cbl
  4804     12  FILLER                            PIC X.
  4805
  4806*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4807     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4808     12  FILLER                            PIC X.
  4809*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4810     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4811
  4812     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4813         88  CERT-ADDED-BATCH                 VALUE ' '.
  4814         88  CERT-ADDED-ONLINE                VALUE '1'.
  4815         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4816         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4817         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4818     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4819         88  CERT-AS-LOADED                   VALUE ' '.
  4820         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4821         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4822         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4823         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4824         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4825         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4826         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4827
  4828     12  CM-ACCOUNT-COMM-PCTS.
  4829         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4830         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4831
  4832     12  CM-USER-FIELD                     PIC X.
  4833     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4834     12  CM-CLP-STATE                      PIC XX.
  4835     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4836     12  CM-USER-RESERVED                  PIC XXX.
  4837     12  FILLER REDEFINES CM-USER-RESERVED.
  4838         16  CM-AH-CLASS-CD                PIC XX.
  4839         16  F                             PIC X.
  4840******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  92
* EL154.cbl
  4842*                            COPY ELCBENE.
  4843******************************************************************
  4844*                                                                *
  4845*                            ELCBENE.                            *
  4846*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4847*                            VMOD=2.006                          *
  4848*                                                                *
  4849*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  4850*                                                                *
  4851*   FILE TYPE = VSAM,KSDS                                        *
  4852*   RECORD SIZE = 500   RECFORM = FIX                            *
  4853*                                                                *
  4854*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  4855*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  4856*                                                                *
  4857*   LOG = YES                                                    *
  4858*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4859*                                                                *
  4860*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  4861******************************************************************
  4862
  4863 01  BENEFICIARY-MASTER.
  4864     12  BE-RECORD-ID                PIC XX.
  4865         88  VALID-BE-ID                VALUE 'BE'.
  4866
  4867     12  BE-CONTROL-PRIMARY.
  4868         16  BE-COMPANY-CD           PIC X.
  4869         16  BE-RECORD-TYPE          PIC X.
  4870             88  BENEFICIARY-RECORD  VALUE 'B'.
  4871             88  ADJUSTOR-RECORD     VALUE 'A'.
  4872         16  BE-BENEFICIARY          PIC X(10).
  4873     12  BE-CONTROL-BY-NAME.
  4874         16  BE-COMPANY-CD-A1        PIC X.
  4875         16  BE-RECORD-TYPE-A1       PIC X.
  4876         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  4877         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  4878
  4879     12  BE-LAST-MAINT-DT            PIC XX.
  4880     12  BE-LAST-MAINT-BY            PIC X(4).
  4881     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4882
  4883     12  BE-ADDRESS-DATA.
  4884         16  BE-MAIL-TO-NAME         PIC X(30).
  4885         16  BE-ADDRESS-LINE-1       PIC X(30).
  4886         16  BE-ADDRESS-LINE-2       PIC X(30).
  4887         16  BE-ADDRESS-LINE-3       PIC X(30).
  4888         16  BE-CITY-STATE.
  4889             20  BE-CITY             PIC X(28).
  4890             20  BE-STATE            PIC XX.
  4891         16  BE-ZIP-CODE.
  4892             20  BE-ZIP-PRIME.
  4893                 24  BE-ZIP-1ST      PIC X.
  4894                     88  BE-CANADIAN-POST-CODE
  4895                                         VALUE 'A' THRU 'Z'.
  4896                 24  FILLER          PIC X(4).
  4897             20  BE-ZIP-PLUS4        PIC X(4).
  4898         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  4899             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  93
* EL154.cbl
  4900             20  BE-CAN-POSTAL-2     PIC XXX.
  4901             20  FILLER              PIC XXX.
  4902         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  4903         16  BE-GROUP-CHECKS-Y-N     PIC X.
  4904
  4905******************************************************************
  4906*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  4907*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  4908******************************************************************
  4909     12  BE-CARRIER                  PIC X.
  4910
  4911     12  BE-ADDRESS-DATA2.
  4912         16  BE-MAIL-TO-NAME2        PIC X(30).
  4913         16  BE-ADDRESS-LINE-12      PIC X(30).
  4914         16  BE-ADDRESS-LINE-22      PIC X(30).
  4915         16  BE-ADDRESS-LINE-32      PIC X(30).
  4916         16  BE-CITY-STATE2.
  4917             20  BE-CITY2            PIC X(28).
  4918             20  BE-STATE2           PIC XX.
  4919         16  BE-ZIP-CODE2.
  4920             20  BE-ZIP-PRIME2.
  4921                 24  BE-ZIP-1ST2     PIC X.
  4922                     88  BE-CANADIAN-POST-CODE2
  4923                                         VALUE 'A' THRU 'Z'.
  4924                 24  FILLER          PIC X(4).
  4925             20  BE-ZIP-PLUS42       PIC X(4).
  4926         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  4927             20  BE-CAN-POSTAL-12    PIC XXX.
  4928             20  BE-CAN-POSTAL-22    PIC XXX.
  4929             20  FILLER              PIC XXX.
  4930         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  4931         16  BE-BILLING-STMT-DATA.
  4932             20  BE-BSR              PIC X.
  4933                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  4934                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  4935             20  BE-BSR-FROM         PIC X(30).
  4936             20  BE-BSR-DEPT         PIC X(30).
  4937             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  4938             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  4939             20  BE-OUTPUT-TYPE      PIC X.
  4940                 88  BE-FAX-OUTPUT         VALUE 'F'.
  4941                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  4942
  4943     12  FILLER                      PIC X(28).
  4944******************************************************************
  4945*                            COPY ERCACCT.
  4946******************************************************************
  4947*                                                                *
  4948*                                                                *
  4949*                            ERCACCT                             *
  4950*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4951*                            VMOD=2.031                          *
  4952*                                                                *
  4953*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4954*                                                                *
  4955*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4956*   VSAM ACCOUNT MASTER FILES.                                   *
  4957*                                                                *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  94
* EL154.cbl
  4958*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4959*                                                                *
  4960*   FILE TYPE = VSAM,KSDS                                        *
  4961*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4962*                                                                *
  4963*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4964*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4965*                                                                *
  4966*   LOG = NO                                                     *
  4967*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4968*                                                                *
  4969*                                                                *
  4970******************************************************************
  4971*                   C H A N G E   L O G
  4972*
  4973* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4974*-----------------------------------------------------------------
  4975*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4976* EFFECTIVE    NUMBER
  4977*-----------------------------------------------------------------
  4978* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4979* 092705    2005050300006  PEMA  ADD SPP LEASES
  4980* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4981* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4982* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4983* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4984* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4985******************************************************************
  4986
  4987 01  ACCOUNT-MASTER.
  4988     12  AM-RECORD-ID                      PIC XX.
  4989         88  VALID-AM-ID                      VALUE 'AM'.
  4990
  4991     12  AM-CONTROL-PRIMARY.
  4992         16  AM-COMPANY-CD                 PIC X.
  4993         16  AM-MSTR-CNTRL.
  4994             20  AM-CONTROL-A.
  4995                 24  AM-CARRIER            PIC X.
  4996                 24  AM-GROUPING.
  4997                     28 AM-GROUPING-PREFIX PIC XXX.
  4998                     28 AM-GROUPING-PRIME  PIC XXX.
  4999                 24  AM-STATE              PIC XX.
  5000                 24  AM-ACCOUNT.
  5001                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5002                     28  AM-ACCOUNT-PRIME  PIC X(6).
  5003             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5004                                           PIC X(19).
  5005             20  AM-CNTRL-B.
  5006                 24  AM-EXPIRATION-DT      PIC XX.
  5007                 24  FILLER                PIC X(4).
  5008             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5009                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5010
  5011     12  AM-CONTROL-BY-VAR-GRP.
  5012         16  AM-COMPANY-CD-A1              PIC X.
  5013         16  AM-VG-CARRIER                 PIC X.
  5014         16  AM-VG-GROUPING                PIC X(6).
  5015         16  AM-VG-STATE                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  95
* EL154.cbl
  5016         16  AM-VG-ACCOUNT                 PIC X(10).
  5017         16  AM-VG-DATE.
  5018             20  AM-VG-EXPIRATION-DT       PIC XX.
  5019             20  FILLER                    PIC X(4).
  5020         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5021                                           PIC 9(11)      COMP-3.
  5022     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5023         16  FILLER                        PIC X(10).
  5024         16  AM-VG-KEY3.
  5025             20  AM-VG3-ACCOUNT            PIC X(10).
  5026             20  AM-VG3-EXP-DT             PIC XX.
  5027         16  FILLER                        PIC X(4).
  5028     12  AM-MAINT-INFORMATION.
  5029         16  AM-LAST-MAINT-DT              PIC XX.
  5030         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5031         16  AM-LAST-MAINT-USER            PIC X(4).
  5032         16  FILLER                        PIC XX.
  5033
  5034     12  AM-EFFECTIVE-DT                   PIC XX.
  5035     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5036
  5037     12  AM-PREV-DATES  COMP-3.
  5038         16  AM-PREV-EXP-DT                PIC 9(11).
  5039         16  AM-PREV-EFF-DT                PIC 9(11).
  5040
  5041     12  AM-REPORT-CODE-1                  PIC X(10).
  5042     12  AM-REPORT-CODE-2                  PIC X(10).
  5043
  5044     12  AM-CITY-CODE                      PIC X(4).
  5045     12  AM-COUNTY-PARISH                  PIC X(6).
  5046
  5047     12  AM-NAME                           PIC X(30).
  5048     12  AM-PERSON                         PIC X(30).
  5049     12  AM-ADDRS                          PIC X(30).
  5050     12  AM-CITY.
  5051         16  AM-ADDR-CITY                  PIC X(28).
  5052         16  AM-ADDR-STATE                 PIC XX.
  5053     12  AM-ZIP.
  5054         16  AM-ZIP-PRIME.
  5055             20  AM-ZIP-PRI-1ST            PIC X.
  5056                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5057             20  FILLER                    PIC X(4).
  5058         16  AM-ZIP-PLUS4                  PIC X(4).
  5059     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5060         16  AM-CAN-POSTAL-1               PIC XXX.
  5061         16  AM-CAN-POSTAL-2               PIC XXX.
  5062         16  FILLER                        PIC XXX.
  5063     12  AM-TEL-NO.
  5064         16  AM-AREA-CODE                  PIC 999.
  5065         16  AM-TEL-PRE                    PIC 999.
  5066         16  AM-TEL-NBR                    PIC 9(4).
  5067     12  AM-TEL-LOC                        PIC X.
  5068         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5069         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5070
  5071     12  AM-COMM-STRUCTURE.
  5072         16  AM-DEFN-1.
  5073             20  AM-AGT-COMMS       OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  96
* EL154.cbl
  5074                 24  AM-AGT.
  5075                     28  AM-AGT-PREFIX     PIC X(4).
  5076                     28  AM-AGT-PRIME      PIC X(6).
  5077                 24  AM-COM-TYP            PIC X.
  5078                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5079                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5080                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5081                 24  AM-RECALC-LV-INDIC    PIC X.
  5082                 24  AM-RETRO-LV-INDIC     PIC X.
  5083                 24  AM-GL-CODES           PIC X.
  5084                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5085                 24  FILLER                PIC X(01).
  5086         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5087             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5088                 24  FILLER                PIC X(11).
  5089                 24  AM-L-COMA             PIC XXX.
  5090                 24  AM-J-COMA             PIC XXX.
  5091                 24  AM-A-COMA             PIC XXX.
  5092                 24  FILLER                PIC X(6).
  5093
  5094     12  AM-COMM-CHANGE-STATUS             PIC X.
  5095         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5096
  5097     12  AM-CSR-CODE                       PIC X(4).
  5098
  5099     12  AM-BILLING-STATUS                 PIC X.
  5100         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5101         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5102     12  AM-AUTO-REFUND-SW                 PIC X.
  5103         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5104         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5105     12  AM-GPCD                           PIC 99.
  5106     12  AM-IG                             PIC X.
  5107         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5108         88  AM-HAS-GROUP                     VALUE '2'.
  5109     12  AM-STATUS                         PIC X.
  5110         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5111         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5112         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5113         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5114         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5115         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5116     12  AM-REMIT-TO                       PIC 99.
  5117     12  AM-ID-NO                          PIC X(11).
  5118
  5119     12  AM-CAL-TABLE                      PIC XX.
  5120     12  AM-LF-DEVIATION                   PIC XXX.
  5121     12  AM-AH-DEVIATION                   PIC XXX.
  5122     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5123     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5124     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5125     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5126     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5127     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5128
  5129     12  AM-USER-FIELDS.
  5130         16  AM-FLD-1                      PIC XX.
  5131         16  AM-FLD-2                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  97
* EL154.cbl
  5132         16  AM-FLD-3                      PIC XX.
  5133         16  AM-FLD-4                      PIC XX.
  5134         16  AM-FLD-5                      PIC XX.
  5135
  5136     12  AM-1ST-PROD-DATE.
  5137         16  AM-1ST-PROD-YR                PIC XX.
  5138         16  AM-1ST-PROD-MO                PIC XX.
  5139         16  AM-1ST-PROD-DA                PIC XX.
  5140     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5141     12  AM-CERTS-PURGED-DATE.
  5142         16  AM-PUR-YR                     PIC XX.
  5143         16  AM-PUR-MO                     PIC XX.
  5144         16  AM-PUR-DA                     PIC XX.
  5145     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5146     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5147     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5148     12  AM-INACTIVE-DATE.
  5149         16  AM-INA-MO                     PIC 99.
  5150         16  AM-INA-DA                     PIC 99.
  5151         16  AM-INA-YR                     PIC 99.
  5152     12  AM-AR-HI-CERT-DATE                PIC XX.
  5153
  5154     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5155     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5156
  5157     12  AM-OB-PAYMENT-MODE                PIC X.
  5158         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5159         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5160         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5161         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5162
  5163     12  AM-AH-ONLY-INDICATOR              PIC X.
  5164         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5165         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5166
  5167     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5168
  5169     12  AM-OVER-SHORT.
  5170         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5171         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5172
  5173     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5174     12  AM-DCC-CLP-STATE                  PIC XX.
  5175
  5176     12  AM-RECALC-COMM                    PIC X.
  5177     12  AM-RECALC-REIN                    PIC X.
  5178
  5179     12  AM-REI-TABLE                      PIC XXX.
  5180     12  AM-REI-ET-LF                      PIC X.
  5181     12  AM-REI-ET-AH                      PIC X.
  5182     12  AM-REI-PE-LF                      PIC X.
  5183     12  AM-REI-PE-AH                      PIC X.
  5184     12  AM-REI-PRT-ST                     PIC X.
  5185     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5186     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5187     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5188     12  AM-REI-GROUP-A                    PIC X(6).
  5189     12  AM-REI-MORT                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  98
* EL154.cbl
  5190     12  AM-REI-PRT-OW                     PIC X.
  5191     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5192     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5193     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5194     12  AM-REI-GROUP-B                    PIC X(6).
  5195
  5196     12  AM-TRUST-TYPE                     PIC X(2).
  5197
  5198     12  AM-EMPLOYER-STMT-USED             PIC X.
  5199     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5200
  5201     12  AM-STD-AH-TYPE                    PIC XX.
  5202     12  AM-EARN-METHODS.
  5203         16  AM-EARN-METHOD-R              PIC X.
  5204             88 AM-REF-RL-R78                 VALUE 'R'.
  5205             88 AM-REF-RL-PR                  VALUE 'P'.
  5206             88 AM-REF-RL-MEAN                VALUE 'M'.
  5207             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5208         16  AM-EARN-METHOD-L              PIC X.
  5209             88 AM-REF-LL-R78                 VALUE 'R'.
  5210             88 AM-REF-LL-PR                  VALUE 'P'.
  5211             88 AM-REF-LL-MEAN                VALUE 'M'.
  5212             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5213         16  AM-EARN-METHOD-A              PIC X.
  5214             88 AM-REF-AH-R78                 VALUE 'R'.
  5215             88 AM-REF-AH-PR                  VALUE 'P'.
  5216             88 AM-REF-AH-MEAN                VALUE 'M'.
  5217             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5218             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5219             88 AM-REF-AH-NET                 VALUE 'N'.
  5220
  5221     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5222     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5223     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5224
  5225     12  AM-RET-Y-N                        PIC X.
  5226     12  AM-RET-P-E                        PIC X.
  5227     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5228     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5229     12  AM-RET-GRP                        PIC X(6).
  5230     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5231         16  AM-POOL-PRIME                 PIC XXX.
  5232         16  AM-POOL-SUB                   PIC XXX.
  5233     12  AM-RETRO-EARNINGS.
  5234         16  AM-RET-EARN-R                 PIC X.
  5235         16  AM-RET-EARN-L                 PIC X.
  5236         16  AM-RET-EARN-A                 PIC X.
  5237     12  AM-RET-ST-TAX-USE                 PIC X.
  5238         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5239         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5240     12  AM-RETRO-BEG-EARNINGS.
  5241         16  AM-RET-BEG-EARN-R             PIC X.
  5242         16  AM-RET-BEG-EARN-L             PIC X.
  5243         16  AM-RET-BEG-EARN-A             PIC X.
  5244     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5245     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5246
  5247     12  AM-USER-SELECT-OPTIONS.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  99
* EL154.cbl
  5248         16  AM-USER-SELECT-1              PIC X(10).
  5249         16  AM-USER-SELECT-2              PIC X(10).
  5250         16  AM-USER-SELECT-3              PIC X(10).
  5251         16  AM-USER-SELECT-4              PIC X(10).
  5252         16  AM-USER-SELECT-5              PIC X(10).
  5253
  5254     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5255
  5256     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5257
  5258     12  AM-RPT045A-SWITCH                 PIC X.
  5259         88  RPT045A-OFF                   VALUE 'N'.
  5260
  5261     12  AM-INSURANCE-LIMITS.
  5262         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5263         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5264
  5265     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5266         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5267
  5268     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5269         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5270         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5271
  5272     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5273
  5274     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5275     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5276     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5277     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5278     12  AM-DCC-UEF-STATE                  PIC XX.
  5279     12  FILLER                            PIC XXX.
  5280     12  AM-REPORT-CODE-3                  PIC X(10).
  5281*    12  FILLER                            PIC X(22).
  5282
  5283     12  AM-RESERVE-DATE.
  5284         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5285         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5286         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5287
  5288     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5289     12  AM-NOTIFICATION-TYPES.
  5290         16  AM-NOTIF-OF-LETTERS           PIC X.
  5291         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5292         16  AM-NOTIF-OF-REPORTS           PIC X.
  5293         16  AM-NOTIF-OF-STATUS            PIC X.
  5294
  5295     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5296         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5297         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5298         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5299         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5300
  5301     12  AM-BENEFIT-CONTROLS.
  5302         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5303             20  AM-BENEFIT-CODE           PIC XX.
  5304             20  AM-BENEFIT-TYPE           PIC X.
  5305             20  AM-BENEFIT-REVISION       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 100
* EL154.cbl
  5306             20  AM-BENEFIT-REM-TERM       PIC X.
  5307             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5308             20  FILLER                    PIC XX.
  5309         16  FILLER                        PIC X(80).
  5310
  5311     12  AM-TRANSFER-DATA.
  5312         16  AM-TRANSFERRED-FROM.
  5313             20  AM-TRNFROM-CARRIER        PIC X.
  5314             20  AM-TRNFROM-GROUPING.
  5315                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5316                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5317             20  AM-TRNFROM-STATE          PIC XX.
  5318             20  AM-TRNFROM-ACCOUNT.
  5319                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5320                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5321             20  AM-TRNFROM-DTE            PIC XX.
  5322         16  AM-TRANSFERRED-TO.
  5323             20  AM-TRNTO-CARRIER          PIC X.
  5324             20  AM-TRNTO-GROUPING.
  5325                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5326                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5327             20  AM-TRNTO-STATE            PIC XX.
  5328             20  AM-TRNTO-ACCOUNT.
  5329                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5330                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5331             20  AM-TRNTO-DTE              PIC XX.
  5332         16  FILLER                        PIC X(10).
  5333
  5334     12  AM-SAVED-REMIT-TO                 PIC 99.
  5335
  5336     12  AM-COMM-STRUCTURE-SAVED.
  5337         16  AM-DEFN-1-SAVED.
  5338             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5339                 24  AM-AGT-SV             PIC X(10).
  5340                 24  AM-COM-TYP-SV         PIC X.
  5341                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5342                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5343                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5344                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5345                 24  FILLER                PIC X.
  5346                 24  AM-GL-CODES-SV        PIC X.
  5347                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5348                 24  FILLER                PIC X.
  5349         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5350             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  5351                 24  FILLER                PIC X(11).
  5352                 24  AM-L-COMA-SV          PIC XXX.
  5353                 24  AM-J-COMA-SV          PIC XXX.
  5354                 24  AM-A-COMA-SV          PIC XXX.
  5355                 24  FILLER                PIC X(6).
  5356
  5357     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5358         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5359            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5360            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5361            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5362
  5363     12  AM-ORIG-DEALER-NO                 PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 101
* EL154.cbl
  5364     12  FILLER                            PIC X(120).
  5365
  5366     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5367         16  AM-CONTROL-NAME               PIC X(30).
  5368         16  AM-EXECUTIVE-ONE.
  5369             20  AM-EXEC1-NAME             PIC X(15).
  5370             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5371                                                          COMP-3.
  5372             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5373                                                          COMP-3.
  5374         16  AM-EXECUTIVE-TWO.
  5375             20  AM-EXEC2-NAME             PIC X(15).
  5376             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5377                                                          COMP-3.
  5378             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5379                                                          COMP-3.
  5380
  5381     12  AM-RETRO-ADDITIONAL-DATA.
  5382         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5383         16  AM-RETRO-PREM-P-E             PIC X.
  5384         16  AM-RETRO-CLMS-P-I             PIC X.
  5385         16  AM-RETRO-RET-BRACKET-LF.
  5386             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5387                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5388                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5389             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5390                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5391                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5392             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5393                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5394                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5395         16  AM-RETRO-RET-BRACKET-AH.
  5396             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5397                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5398                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5399                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5400             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5401                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5402                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5403             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5404                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5405                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5406
  5407     12  AM-COMMENTS.
  5408         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  5409
  5410     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5411         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5412         16  AM-FLI-BILLING-CODE           PIC X.
  5413         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5414         16  AM-FLI-UNITED-IDENT           PIC X.
  5415         16  AM-FLI-INTEREST-LOST-DATA.
  5416             20  AM-FLI-BANK-NO            PIC X(5).
  5417             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5418             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5419             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5420         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5421             20  AM-FLI-AGT                PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 102
* EL154.cbl
  5422             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5423             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5424         16  FILLER                        PIC X(102).
  5425
  5426     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5427         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5428             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5429             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5430             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5431             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5432             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5433         16  FILLER                          PIC X(10).
  5434******************************************************************
  5435*                            COPY ERCPDEF.
  5436******************************************************************
  5437*                                                                *
  5438*                                                                *
  5439*                            ERCPDEF.                            *
  5440*                                                                *
  5441*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5442*                                                                *
  5443*    FILE TYPE = VSAM,KSDS                                       *
  5444*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5445*                                                                *
  5446*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5447*                                                                *
  5448*    LOG = YES                                                   *
  5449*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5450******************************************************************
  5451*                   C H A N G E   L O G
  5452*
  5453* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5454*-----------------------------------------------------------------
  5455*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5456* EFFECTIVE    NUMBER
  5457*-----------------------------------------------------------------
  5458* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5459******************************************************************
  5460 01  PRODUCT-MASTER.
  5461    12  PD-RECORD-ID                 PIC X(02).
  5462        88  VALID-PD-ID                  VALUE 'PD'.
  5463    12  PD-CONTROL-PRIMARY.
  5464        16  PD-COMPANY-CD            PIC X.
  5465        16  PD-STATE                 PIC XX.
  5466        16  PD-PRODUCT-CD            PIC XXX.
  5467        16  PD-FILLER                PIC X(7).
  5468        16  PD-BEN-TYPE              PIC X.
  5469        16  PD-BEN-CODE              PIC XX.
  5470        16  PD-PROD-EXP-DT           PIC XX.
  5471    12  FILLER                       PIC X(50).
  5472    12  PD-PRODUCT-DATA OCCURS 8.
  5473        16  PD-PROD-CODE             PIC X.
  5474            88  PD-PROD-LIFE           VALUE 'L'.
  5475            88  PD-PROD-PROP           VALUE 'P'.
  5476            88  PD-PROD-AH             VALUE 'A'.
  5477            88  PD-PROD-IU             VALUE 'I'.
  5478            88  PD-PROD-GAP            VALUE 'G'.
  5479            88  PD-PROD-FMLA           VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 103
* EL154.cbl
  5480        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5481        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5482        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5483        16  PD-MAX-TERM              PIC S999        COMP-3.
  5484        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5485        16  FILLER                   PIC X.
  5486        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5487        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5488        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5489        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5490        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5491        16  PD-REC-CRIT-PERIOD       PIC 99.
  5492        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  5493            20  PD-RECURRING-YN      PIC X.
  5494            20  FILLER               PIC X.
  5495        16  PD-RTW-MOS               PIC 99.
  5496        16  PD-MAX-EXTENSION         PIC 99.
  5497        16  FILLER                   PIC XX.
  5498    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5499    12  PD-TERM-LIMITS OCCURS 15.
  5500        16  PD-LOW-TERM              PIC S999        COMP-3.
  5501        16  PD-HI-TERM               PIC S999        COMP-3.
  5502*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5503    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5504        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5505        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5506    12  PD-EARN-FACTORS.
  5507        16  FILLER OCCURS 15.
  5508            20  FILLER OCCURS 15.
  5509                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5510    12  PD-PRODUCT-DESC              PIC X(80).
  5511    12  PD-TRUNCATED                 PIC X.
  5512    12  FILLER                       PIC X(59).
  5513    12  PD-MAINT-INFORMATION.
  5514        16  PD-LAST-MAINT-DT         PIC X(02).
  5515        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5516        16  PD-LAST-MAINT-BY         PIC X(04).
  5517*                            copy ELCCRTT.
  5518******************************************************************
  5519*                                                                *
  5520*                            ELCCRTT.                            *
  5521*                                                                *
  5522*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5523*                                                                *
  5524*   FILE TYPE = VSAM,KSDS                                        *
  5525*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5526*                                                                *
  5527*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5528*                                                                *
  5529*   LOG = YES                                                    *
  5530*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5531******************************************************************
  5532*                   C H A N G E   L O G
  5533*
  5534* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5535*-----------------------------------------------------------------
  5536*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5537* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 104
* EL154.cbl
  5538*-----------------------------------------------------------------
  5539* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5540* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5541* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5542* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5543* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5544* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5545******************************************************************
  5546
  5547 01  CERTIFICATE-TRAILERS.
  5548     12  CS-RECORD-ID                      PIC XX.
  5549         88  VALID-CS-ID                      VALUE 'CS'.
  5550
  5551     12  CS-CONTROL-PRIMARY.
  5552         16  CS-COMPANY-CD                 PIC X.
  5553         16  CS-CARRIER                    PIC X.
  5554         16  CS-GROUPING                   PIC X(6).
  5555         16  CS-STATE                      PIC XX.
  5556         16  CS-ACCOUNT                    PIC X(10).
  5557         16  CS-CERT-EFF-DT                PIC XX.
  5558         16  CS-CERT-NO.
  5559             20  CS-CERT-PRIME             PIC X(10).
  5560             20  CS-CERT-SFX               PIC X.
  5561         16  CS-TRAILER-TYPE               PIC X.
  5562             88  COMM-TRLR           VALUE 'A'.
  5563             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5564             88  CERT-DATA-TRLR      VALUE 'C'.
  5565
  5566     12  CS-DATA-AREA                      PIC X(516).
  5567
  5568     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5569         16  CS-BANK-COMMISSION-AREA.
  5570             20  CS-BANK-COMMS       OCCURS 10.
  5571                 24  CS-AGT                PIC X(10).
  5572                 24  CS-COM-TYP            PIC X.
  5573                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5574                 24  CS-RECALC-LV-INDIC    PIC X.
  5575                 24  FILLER                PIC X(10).
  5576         16  FILLER                        PIC X(256).
  5577
  5578     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5579****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5580         16  CS-MB-CLAIM-DATA OCCURS 24.
  5581             20  CS-CLAIM-NO               PIC X(7).
  5582             20  CS-CLAIM-TYPE             PIC X.
  5583                 88  CS-AH-CLM               VALUE 'A'.
  5584                 88  CS-IU-CLM               VALUE 'I'.
  5585                 88  CS-GP-CLM               VALUE 'G'.
  5586                 88  CS-LF-CLM               VALUE 'L'.
  5587                 88  CS-PR-CLM               VALUE 'P'.
  5588             20  CS-INSURED-TYPE           PIC X.
  5589                 88  CS-PRIM-INSURED          VALUE 'P'.
  5590                 88  CS-CO-BORROWER           VALUE 'C'.
  5591             20  CS-BENEFIT-PERIOD         PIC 99.
  5592             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5593             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5594             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5595         16  FILLER                        PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 105
* EL154.cbl
  5596     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5597         16  CS-VIN-NUMBER                 PIC X(17).
  5598         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5599         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5600         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5601         16  FILLER                        PIC X(496).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 106
* EL154.cbl
  5603*                            COPY MPCPLCY.
  5604******************************************************************
  5605*                                                                *
  5606*                           MPCPLCY                              *
  5607*                            VMOD=1.024                          *
  5608*                                                                *
  5609*   FILE DESCRIPTION = POLICY MASTER                             *
  5610*                                                                *
  5611*   FILE TYPE = VSAM,KSDS                                        *
  5612*   RECORD SIZE = 1200 RECFORM = FIXED                           *
  5613*                                                                *
  5614*   BASE CLUSTER = MPPLCY                         RKP=2,LEN=42   *
  5615*       ALTERNATE PATH2 = ** NOT USED **                         *
  5616*       ALTERNATE PATH3 = MPPLCY3 (BY INSD SS NO) RKP=44,LEN=16  *
  5617*       ALTERNATE PATH4 = MPPLCY4 (BY REF. NO.)   RKP=60,LEN=25  *
  5618*       ALTERNATE PATH5 = MPPLCY5 (BY ACCOUNT )   RKP=85,LEN=27  *
  5619*       ALTERNATE PATH6 = MPPLCY6 (BY TRANSIT )   RKP=112,LEN=15 *
  5620*       ALTERNATE PATH7 = MPPLCY7 (BY LOAN NO.)   RKP=127,LEN=27 *
  5621*                                                                *
  5622*   LOG = YES                                                    *
  5623*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5624******************************************************************
  5625**WARNING*********************************************************
  5626**ANY CHANGES TO THIS COPY BOOK MAY NEED CORRESPONDING CHANGES****
  5627**TO THE FOLLOWING COPY BOOKS: MPCPOLUP                          *
  5628**                             MPCPHSTD                          *
  5629**                             MPCPHSTC                          *
  5630**                             MPCPHSTT                          *
  5631**                                                               *
  5632******************************************************************
  5633
  5634 01  POLICY-MASTER.
  5635     12  PM-RECORD-ID                      PIC XX.
  5636         88  VALID-PM-ID                      VALUE 'PM'.
  5637
  5638******************************************************************
  5639*   BASE CLUSTER = MPPLCY         (BASE KEY)      RKP=2,LEN=42   *
  5640******************************************************************
  5641
  5642     12  PM-CONTROL-PRIMARY.
  5643         16  PM-PRODUCER-PRIMARY.
  5644             20  PM-PROD-PRIMARY.
  5645                 24  PM-COMPANY-CD         PIC X.
  5646                 24  PM-CGSP-KEY.
  5647                     28  PM-CARRIER        PIC X.
  5648                     28  PM-GROUPING.
  5649                         32  PM-GROUPING-PREFIX
  5650                                           PIC X(3).
  5651                         32  PM-GROUPING-PRIME
  5652                                           PIC X(3).
  5653                     28  PM-STATE          PIC X(2).
  5654                     28  PM-PRODUCER.
  5655                         32  PM-PRODUCER-PREFIX
  5656                                           PIC X(4).
  5657                         32  PM-PRODUCER-PRIME
  5658                                           PIC X(6).
  5659             20  PM-POLICY-EFF-DT              PIC XX.
  5660         16  PM-REFERENCE-NUMBER.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 107
* EL154.cbl
  5661             20  PM-REFNO-PRIME            PIC X(18).
  5662             20  PM-REFNO-SFX              PIC XX.
  5663
  5664******************************************************************
  5665*       ALTERNATE PATH3 = MPPLCY3 (BY INSD SS NO) RKP=44,LEN=16  *
  5666******************************************************************
  5667
  5668     12  PM-CONTROL-BY-SSN.
  5669         16  PM-COMPANY-CD-A3              PIC X.
  5670         16  PM-SOC-SEC-NO.
  5671             20  PM-SSN-STATE              PIC XX.
  5672             20  PM-SSN-PRODUCER           PIC X(6).
  5673             20  PM-SSN-LN3.
  5674                 25  PM-INSURED-INITIALS-A3.
  5675                     30 PM-INSURED-INITIAL1-A3 PIC X.
  5676                     30 PM-INSURED-INITIAL2-A3 PIC X.
  5677                 25 PM-PART-LAST-NAME-A3         PIC X.
  5678         16  PM-DATE-A3                     PIC XX.
  5679         16  PM-TIME-A3                     PIC S9(04)   COMP.
  5680
  5681******************************************************************
  5682*       ALTERNATE PATH4 = MPPLCY4 (BY REFRENCE)   RKP=60,LEN=25  *
  5683******************************************************************
  5684
  5685     12  PM-CONTROL-BY-POLICY-NO.
  5686         16  PM-COMPANY-CD-A4              PIC X.
  5687         16  PM-POLICY-NO-A4.
  5688             20  PM-POLICY-PRIME-A4        PIC X(18).
  5689             20  PM-POLICY-SFX-A4          PIC XX.
  5690         16  PM-DATE-A4                    PIC XX.
  5691         16  PM-TIME-A4                    PIC S9(04)   COMP.
  5692
  5693******************************************************************
  5694*       ALTERNATE PATH5 = MPPLCY5 (BY ACCOUNT NO) RKP=85,LEN=27  *
  5695******************************************************************
  5696
  5697     12  PM-CONTROL-BY-ACCOUNT.
  5698         16  PM-COMPANY-CD-A5              PIC X.
  5699         16  PM-BANK-ACCOUNT-NUMBER        PIC X(20).
  5700         16  PM-DATE-A5                    PIC XX.
  5701         16  PM-TIME-A5                    PIC S9(07)   COMP.
  5702
  5703******************************************************************
  5704*       ALTERNATE PATH6 = MPPLCY6 (BY TRANSIT NO) RKP=112,LEN=15 *
  5705******************************************************************
  5706
  5707     12  PM-CONTROL-BY-TRANSIT.
  5708         16  PM-COMPANY-CD-A6              PIC X.
  5709         16  PM-BANK-TRANSIT-NUMBER.
  5710             20  PM-FEDERAL-NUMBER         PIC X(4).
  5711             20  PM-BANK-NUMBER            PIC X(4).
  5712         16  PM-DATE-A6                    PIC XX.
  5713         16  PM-TIME-A6                    PIC S9(07)   COMP.
  5714
  5715******************************************************************
  5716*       ALTERNATE PATH7 = MPPLCY7 (BY LOAN NO)    RKP=127,LEN=27 *
  5717******************************************************************
  5718
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 108
* EL154.cbl
  5719     12  PM-CONTROL-BY-LOAN-NO.
  5720         16  PM-COMPANY-CD-A7              PIC X.
  5721         16  PM-LOAN-NUMBER                PIC X(20).
  5722         16  PM-DATE-A7                    PIC XX.
  5723         16  PM-TIME-A7                    PIC S9(07)   COMP.
  5724
  5725******************************************************************
  5726*                 FILE SYNCHRONIZATION DATA                      *
  5727******************************************************************
  5728
  5729     12  FILLER                            PIC X(05).
  5730     12  PM-FILE-SYNCH-DATA.
  5731         16  PM-LAST-CHANGE-DT             PIC XX.
  5732         16  PM-LAST-CHANGE-TIME           PIC S9(7)    COMP.
  5733         16  PM-LAST-CHANGE-PROCESSOR      PIC X(4).
  5734     12  FILLER                            PIC X(05).
  5735
  5736******************************************************************
  5737*                    INSUREDS PROFILE DATA                       *
  5738******************************************************************
  5739
  5740     12  PM-INSURED-PROFILE-DATA.
  5741         16  PM-INSURED-NAME.
  5742             20  PM-INSURED-LAST-NAME     PIC X(15).
  5743             20  PM-INSURED-FIRST-NAME.
  5744                 24  PM-INSURED-1ST-INIT PIC X.
  5745                 24  FILLER               PIC X(9).
  5746             20  PM-INSURED-MIDDLE-INIT PIC X.
  5747         16  PM-INSURED-ADDRESS.
  5748             20  PM-ADDRESS-LINE-1         PIC X(30).
  5749             20  PM-ADDRESS-LINE-2         PIC X(30).
  5750             20  PM-CITY                   PIC X(25).
  5751             20  PM-RESIDENT-STATE         PIC XX.
  5752             20  PM-ZIP-CD.
  5753                 24  PM-ZIP-FIRST-FIVE     PIC X(5).
  5754                 24  PM-ZIP-PLUS-FOUR      PIC X(4).
  5755         16  PM-INSURED-PERSONAL.
  5756             20  PM-INSURED-OCC-CLASS      PIC X.
  5757                 88  PM-PREFERRED            VALUE '1'.
  5758                 88  PM-STANDARD             VALUE '2'.
  5759                 88  PM-HAZARDOUS            VALUE '3'.
  5760                 88  PM-VERY-HAZARDOUS       VALUE '4'.
  5761                 88  PM-EXTREME-HAZARDOUS VALUE '5'.
  5762                 88  PM-NOT-OCC              VALUE '6'.
  5763                 88  PM-OCC-UNKNOWN          VALUE '9'.
  5764             20  PM-INSURED-OCC-CD         PIC X(3).
  5765             20  PM-INSURED-OCC-CD-NUM REDEFINES
  5766                 PM-INSURED-OCC-CD         PIC 9(3).
  5767             20  PM-INSURED-SEX            PIC X.
  5768                 88  PM-INSURED-SEX-MALE      VALUE 'M'.
  5769                 88  PM-INSURED-SEX-FEMALE VALUE 'F'.
  5770             20  PM-INSURED-BIRTH-DT       PIC XX.
  5771             20  PM-INSURED-ISSUE-AGE      PIC S9(3)     COMP-3.
  5772             20  PM-INSURED-HEIGHT-FT      PIC S9(3)     COMP-3.
  5773             20  PM-INSURED-HEIGHT-IN      PIC S9(3)     COMP-3.
  5774             20  PM-INSURED-WEIGHT         PIC S9(3)     COMP-3.
  5775             20  PM-INSURED-BIRTH-STATE PIC XX.
  5776             20  PM-INSURED-PHONE-NO       PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 109
* EL154.cbl
  5777             20  PM-INSURED-RATED-AGE      PIC S9(3)     COMP-3.
  5778         16  PM-INS-LANGUAGE-IND           PIC X(01).
  5779             88  PM-ENGLISH                           VALUE 'E'.
  5780             88  PM-FRENCH                            VALUE 'F'.
  5781             88  PM-SPANISH                           VALUE 'S'.
  5782         16  PM-INSURED-TOT-BENEFIT        PIC S9(7)V99  COMP-3.
  5783
  5784         16  PM-INSURED-AGE-IND            PIC X(01).
  5785             88  PM-INSURED-AGE-75-REACHED            VALUE 'Y'.
  5786     12  FILLER                            PIC X(13).
  5787
  5788******************************************************************
  5789*                JOINT INSUREDS PROFILE DATA                     *
  5790******************************************************************
  5791
  5792     12  PM-JOINT-PROFILE-DATA.
  5793         16  PM-JOINT-NAME.
  5794             20  PM-JOINT-LAST-NAME        PIC X(15).
  5795             20  PM-JOINT-FIRST-NAME.
  5796                 24  PM-JOINT-1ST-INIT     PIC X.
  5797                 24  FILLER                PIC X(9).
  5798             20  PM-JOINT-MIDDLE-INIT      PIC X.
  5799         16  PM-JOINT-SOC-SEC-NO.
  5800             20  PM-JT-SSN-STATE           PIC XX.
  5801             20  PM-JT-SSN-PRODUCER        PIC X(6).
  5802             20  PM-JT-SSN-LN3.
  5803                 25  PM-JT-INSURED-INITIALS-A3.
  5804                     30 PM-JT-INSURED-INITIAL1-A3 PIC X.
  5805                     30 PM-JT-INSURED-INITIAL2-A3 PIC X.
  5806                 25 PM-JT-PART-LAST-NAME-A3        PIC X.
  5807         16  PM-JOINT-PERSONAL.
  5808             20  PM-JOINT-OCC-CLASS        PIC X.
  5809                 88 PM-JNT-PREFERRED          VALUE '1'.
  5810                 88 PM-JNT-STANDARD           VALUE '2'.
  5811                 88 PM-JNT-HAZARDOUS          VALUE '3'.
  5812                 88 PM-JNT-VERY-HAZARDOUS     VALUE '4'.
  5813                 88 PM-JNT-EXTREME-HAZARDOUS VALUE '5'.
  5814                 88 PM-JNT-NOT-OCC            VALUE '6'.
  5815                 88 PM-JNT-OCC-UNKNOWN        VALUE '9'.
  5816             20  PM-JOINT-OCC-CD           PIC X(3).
  5817             20  PM-JOINT-SEX              PIC X.
  5818                 88  PM-JOINT-SEX-MALE        VALUE 'M'.
  5819                 88  PM-JOINT-SEX-FEMALE      VALUE 'F'.
  5820             20  PM-JOINT-BIRTH-DT         PIC XX.
  5821             20  PM-JOINT-ISSUE-AGE        PIC S9(3)     COMP-3.
  5822             20  PM-JOINT-HEIGHT-FT        PIC S9(3)     COMP-3.
  5823             20  PM-JOINT-HEIGHT-IN        PIC S9(3)     COMP-3.
  5824             20  PM-JOINT-WEIGHT           PIC S9(3)     COMP-3.
  5825             20  PM-JOINT-BIRTH-STATE      PIC XX.
  5826             20  PM-JOINT-RATED-AGE        PIC S9(3)     COMP-3.
  5827         16  PM-JOINT-TOT-BENEFIT          PIC S9(7)V99  COMP-3.
  5828         16  PM-JOINT-AGE-IND              PIC X(01).
  5829             88  PM-JOINT-AGE-75-REACHED              VALUE 'Y'.
  5830
  5831     12  FILLER                            PIC X(12).
  5832
  5833******************************************************************
  5834*                  INSURANCE COVERAGE DATA                       *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 110
* EL154.cbl
  5835******************************************************************
  5836
  5837     12  PM-INS-COVERAGE-DATA.
  5838         16  PM-FREE-PERIOD                PIC S9(03)    COMP-3.
  5839         16  PM-LOAN-TERM                  PIC S9(3)     COMP-3.
  5840         16  PM-LOAN-APR                   PIC S9V9999   COMP-3.
  5841         16  PM-LOAN-DT                    PIC XX.
  5842         16  PM-LOAN-PYMT                  PIC S9(5)V99  COMP-3.
  5843         16  PM-LOAN-BALC                  PIC S9(7)V99  COMP-3.
  5844         16  PM-INS-BENEFIT-MONTHS         PIC S9(3)     COMP-3.
  5845         16  PM-INS-MONTH-BENEFIT          PIC S9(7)V99  COMP-3.
  5846         16  PM-INS-TOTAL-BENEFIT          PIC S9(7)V99  COMP-3.
  5847         16  PM-INS-PLAN-TYPE              PIC X.
  5848             88  PM-AH-MORT-PLAN              VALUE 'A'.
  5849             88  PM-AD-D-MORT-PLAN            VALUE 'E'.
  5850             88  PM-DISMEM-MORT-PLAN          VALUE 'D'.
  5851             88  PM-LIFE-MORT-PLAN            VALUE 'L'.
  5852         16  PM-INS-PLAN-CD                PIC XX.
  5853         16  PM-INS-PLAN-REVISION          PIC X(3).
  5854         16  PM-INS-POLICY-FORM            PIC X(12).
  5855         16  PM-INS-MSTR-POLICY.
  5856             20  PM-FREE-TYPE              PIC X(04).
  5857             20  FILLER                    PIC X(08).
  5858         16  PM-INS-MSTR-APP.
  5859             20  FILLER                    PIC X(11).
  5860             20  PM-INS-B-C-TYPE           PIC X(01).
  5861         16  PM-INS-RATE-CD                PIC X(5).
  5862         16  PM-INS-SEX-RATING             PIC X.
  5863             88  PM-NOT-SEX-RATED              VALUE '1'.
  5864             88  PM-SEX-RATED                  VALUE '2'.
  5865         16  PM-INS-SUBSTANDARD-PCT        PIC S9V9999   COMP-3.
  5866         16  PM-INS-SUBSTANDARD-TYPE       PIC X.
  5867         16  PM-INS-TERMINATION-DT         PIC XX.
  5868         16  PM-INS-MONTH-PREMIUM      PIC S9(5)V999999  COMP-3.
  5869         16  PM-INS-CALC-MO-PREM       PIC S9(5)V999999  COMP-3.
  5870         16  PM-REINSURANCE-TABLE          PIC X(3).
  5871         16  PM-MORTALITY-CD               PIC X(4).
  5872         16  PM-INS-TYPE                   PIC X.
  5873             88  PM-INDIVIDUAL                VALUES ARE '1' 'I'.
  5874             88  PM-GROUP                     VALUES ARE '2' 'G'.
  5875         16  PM-LOAN-OFFICER               PIC X(5).
  5876         16  PM-POLICY-FEE                 PIC S9(3)V99 COMP-3.
  5877         16  PM-DEPENDENT-COUNT            PIC S99      COMP-3.
  5878         16  PM-CWA-AMOUNT                 PIC S9(5)V99  COMP-3.
  5879         16  PM-LAST-AUTO-RERATE-DT        PIC XX.
  5880         16  PM-PREM-FINANCED-SW           PIC X.
  5881             88  PM-PREM-FINANCED              VALUE 'Y'.
  5882             88  PM-PREM-NOT-FINANCED          VALUE 'N'.
  5883
  5884         16  PM-INS-TERM-LETTER-IND        PIC X.
  5885             88  PM-TERM-INITIALIZED           VALUE 'Y'.
  5886         16  PM-INS-UNDERWRITER-MAX-BEN PIC S9(7)V99     COMP-3.
  5887     12  FILLER                            PIC X(11).
  5888
  5889******************************************************************
  5890*                    POLICY BILLING DATA                         *
  5891******************************************************************
  5892
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 111
* EL154.cbl
  5893     12  PM-BILLING-DATA.
  5894         16  PM-BILLING-MODE               PIC X(1).
  5895             88  PM-ANNUAL                    VALUE '1'.
  5896             88  PM-SEMI-ANNUAL               VALUE '2'.
  5897             88  PM-QUARTERLY                 VALUE '3'.
  5898             88  PM-MONTHLY                   VALUE '4'.
  5899             88  PM-BI-MONTHLY                VALUE '5'.
  5900             88  PM-SINGLE-PREM               VALUE '6'.
  5901         16  PM-BILLING-SCHEDULE           PIC X(1).
  5902         16  PM-BILLING-SW                 PIC X(1).
  5903             88  PM-FIRST-BILLING             VALUE 'Y'.
  5904             88  PM-PAID-IN-ADVANCE           VALUE 'A'.
  5905             88  PM-POLICY-FEE-REFUNDED       VALUE 'F'.
  5906         16  PM-BILLING-TYPE               PIC X(1).
  5907             88  PM-LIST-BILL                 VALUE '1'.
  5908             88  PM-TAPE-BILL                 VALUE '2'.
  5909             88  PM-TAPE-LIST-BILL            VALUE '3'.
  5910             88  PM-GROUP-BILL          VALUE ARE '1' '2' '3'.
  5911             88  PM-DIRECT-BILL               VALUE '4'.
  5912             88  PM-PAC-BILL            VALUE ARE '5' 'C' 'S'.
  5913             88  PM-CHARGE-CARD-BILL          VALUE '6'.
  5914             88  PM-INDIV-BILL
  5915                                  VALUE ARE '4' '5' '6' 'C' 'S'.
  5916             88  PM-GRP-PLCY-BILL             VALUE '7'.
  5917             88  PM-GRP-PLCY-PAC              VALUE '8'.
  5918             88  PM-GRP-PLCY-CR-CRD           VALUE '9'.
  5919             88  PM-GRP-PLCY            VALUE ARE '7' '8' '9'.
  5920             88  PM-GRP-PROD                  VALUE 'A'.
  5921             88  PM-EFT-CHECKING              VALUE 'C'.
  5922             88  PM-EFT-SAVINGS               VALUE 'S'.
  5923         16  PM-PAYMENT-AMT                PIC S9(5)V99  COMP-3.
  5924         16  PM-OVER-SHORT-AMT             PIC S9(5)V99  COMP-3.
  5925         16  PM-LAST-BILL-DT               PIC XX.
  5926         16  PM-LAST-BILL-AMT              PIC S9(5)V99  COMP-3.
  5927         16  PM-BILL-TO-DT                 PIC XX.
  5928         16  PM-LAST-PYMT-DT               PIC XX.
  5929         16  PM-PAID-TO-DT                 PIC XX.
  5930         16  PM-PYMT-INVOICE-NUMBER        PIC X(6).
  5931         16  PM-MONTHS-PAID                PIC S9(3)     COMP-3.
  5932         16  PM-TOTAL-PREM-RECVD           PIC S9(7)V99  COMP-3.
  5933         16  PM-BILLING-GROUPING-CODE      PIC X(6).
  5934         16  PM-CHARGE-CARD-EXP-DT         PIC X(2).
  5935         16  PM-CHARGE-CARD-TYPE           PIC X(2).
  5936             88  PM-VISA                      VALUE 'VI'.
  5937             88  PM-MSTR-CARD                 VALUE 'MC'.
  5938             88  PM-DINERS-CLUB               VALUE 'DN'.
  5939             88  PM-DISCOVER                  VALUE 'DS'.
  5940             88  PM-CARTE-BLANCHE             VALUE 'CB'.
  5941             88  PM-AMERICAN-EXPRESS          VALUE 'AE'.
  5942         16  PM-BILL-INVOICE-NUMBER        PIC X(6).
  5943         16  PM-BILL-DAY                   PIC S99       COMP-3.
  5944         16  PM-RES-PREM-TAX           PIC S9(3)V999999  COMP-3.
  5945     12  FILLER                            PIC X(15).
  5946
  5947******************************************************************
  5948*                     CLAIM PAYMENT DATA                         *
  5949******************************************************************
  5950
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 112
* EL154.cbl
  5951     12  PM-CLAIM-PAYMENT-DATA.
  5952         16  PM-CLAIM-BENEFICIARY-NAME     PIC X(25).
  5953         16  PM-CLAIM-INTERFACE-SW         PIC X.
  5954             88  PM-NO-CLAIM-ATTACHED         VALUE SPACE.
  5955             88  PM-POLICY-AND-CLAIM-ONLINE VALUE '1'.
  5956             88  PM-POLICY-CREATED-FOR-CLAIM VALUE '2'.
  5957             88  PM-CLAIM-CLOSED              VALUE '3'.
  5958             88  PM-ACTIVE-CLAIM              VALUE '1' '2'.
  5959             88  PM-CLAIM-ATTACHED            VALUE '1' '2' '3'.
  5960         16  PM-CLAIM-INCURRED-DT          PIC XX.
  5961         16  PM-CLAIM-PAID-TO-DT           PIC XX.
  5962         16  PM-CLAIM-PAYMENT-CNT          PIC S9(3)     COMP-3.
  5963         16  PM-CLAIM-LAST-PAYMENT-AMT     PIC S9(7)V99  COMP-3.
  5964         16  PM-CLAIM-EXPENSES-ITD         PIC S9(7)V99  COMP-3.
  5965         16  PM-CLAIM-PAYMENTS-ITD         PIC S9(7)V99  COMP-3.
  5966         16  PM-CLAIM-ACCUMULATOR          PIC S9(7)V99  COMP-3.
  5967         16  PM-CLAIM-ATTACH-CNT           PIC S9(3)     COMP-3.
  5968         16  PM-CLAIM-LIFE-ITD             PIC S9(7)V99  COMP-3.
  5969         16  PM-CLAIM-AH-ITD               PIC S9(7)V99  COMP-3.
  5970         16  PM-CLAIM-RIDER-ITD            PIC S9(7)V99  COMP-3.
  5971
  5972     12  FILLER                            PIC X(03).
  5973
  5974******************************************************************
  5975*                POLICY STATUS AND DISPOSITION                   *
  5976******************************************************************
  5977
  5978     12  PM-STATUS-DISPOSITION-DATA.
  5979         16  PM-ISSUE-EOM-DT               PIC XX.
  5980         16  PM-REPLACEMENT-SWITCH         PIC X.
  5981         16  PM-APPL-SIGN-DT               PIC XX.
  5982         16  PM-UNDERWRITER                PIC X(3).
  5983         16  PM-ENTRY-PROCESSOR            PIC X(4).
  5984         16  PM-ENTRY-STATUS               PIC X.
  5985             88  PM-NORMAL                    VALUE '1'.
  5986             88  PM-TAKE-OVER                 VALUE '2'.
  5987             88  PM-CONVERSION                VALUE '4'.
  5988             88  PM-RE-ISSUE                  VALUE '5'.
  5989             88  PM-REINSURANCE-ONLY          VALUE '9'.
  5990         16  PM-ENTRY-DT                   PIC XX.
  5991         16  PM-ENTRY-TIME                 PIC S9(7) COMP-3.
  5992         16  PM-EXIT-DT                    PIC XX.
  5993         16  PM-CURRENT-STATUS             PIC X.
  5994             88  PM-LAPSE                     VALUE '0'.
  5995             88  PM-ACTIVE                    VALUE '1'.
  5996             88  PM-PENDING-ISSUE             VALUE '2'.
  5997             88  PM-DECLINED                  VALUE '3'.
  5998             88  PM-PENDING-CANCEL            VALUE '4'.
  5999             88  PM-PENDING-ISSUE-ERROR       VALUE '5'.
  6000             88  PM-CLAIM-APPLIED             VALUE '6'.
  6001             88  PM-CANCEL                    VALUE '7'.
  6002             88  PM-PENDING-UNWTR-REVW        VALUE '8'.
  6003             88  PM-PENDING-CANCEL-ERROR      VALUE '9'.
  6004             88  PM-CANCEL-TRANSFER           VALUE 'C'.
  6005             88  PM-CLAIM-SETTLEMENT          VALUE 'F'.
  6006             88  PM-TERMINATE                 VALUE 'T'.
  6007** NOTE TYPE 1 IS ANYTHING THAT IS OR HAS BEEN ACTIVE.  TYPE 2 IS
  6008** EVERYTHING ELSE.  IF YOU ADD A STATUS ADD THE VALUE TO ONE OF
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 113
* EL154.cbl
  6009** THESE GROUPS.
  6010             88  PM-TYPE-STAT-1
  6011                     VALUES ARE '0' '1' '4' '6' '7' '9'
  6012                                'C' 'F' 'T'.
  6013             88  PM-TYPE-STAT-2
  6014                     VALUES ARE '2' '3' '5' '8'.
  6015             88  PM-BILLABLE-STATUS VALUES ARE '0' '1' '6'.
  6016             88  PM-PENDING-STATUS
  6017                                VALUES ARE '2' '4' '5' '8' '9'.
  6018             88  PM-PENDING-ISSUE-STATUS
  6019                                VALUES ARE '2' '5' '8'.
  6020             88  PM-CANCEL-STATUS
  6021                                VALUES ARE '4' '7' '9' 'C'.
  6022         16  PM-CANCEL-CAUSE-CD            PIC X(3).
  6023         16  PM-CANCEL-DT                  PIC XX.
  6024         16  PM-REFUND-AMT                 PIC S9(5)V99  COMP-3.
  6025         16  PM-CALC-REFUND-AMT            PIC S9(5)V99  COMP-3.
  6026         16  PM-DECLINE-CD                 PIC X(3).
  6027         16  PM-DECLINE-DT                 PIC XX.
  6028         16  PM-LAST-LAPSE-DT              PIC XX.
  6029         16  PM-LAST-REINSTATE-DT          PIC XX.
  6030         16  PM-SECURITY-ACCESS-CODE       PIC X.
  6031         16  PM-PREV-CONTROL-PRIMARY.
  6032             20  PM-PREV-COMPANY-CD             PIC X.
  6033             20  PM-PREV-CARRIER                PIC X.
  6034             20  PM-PREV-GROUPING.
  6035                 24  PM-PREV-GROUPING-PREFIX PIC X(3).
  6036                 24  PM-PREV-GROUPING-PRIME     PIC X(3).
  6037             20  PM-PREV-STATE                  PIC XX.
  6038             20  PM-PREV-PRODUCER.
  6039                 24  PM-PREV-PRODUCER-PREFIX PIC X(4).
  6040                 24  PM-PREV-PRODUCER-PRIME     PIC X(6).
  6041             20  PM-PREV-POLICY-EFF-DT          PIC XX.
  6042             20  PM-PREV-REFERENCE-NUMBER.
  6043                 24  PM-PREV-REFNO-PRIME        PIC X(18).
  6044                 24  PM-PREV-REFNO-SFX          PIC XX.
  6045         16  PM-ACTION-DT                  PIC XX.
  6046         16  PM-ACTION-CODE                PIC X(3).
  6047         16  PM-ACTION-DT-2                PIC XX.
  6048         16  PM-ACTION-CODE-2              PIC X(3).
  6049         16  PM-ACTION-DT-3                PIC XX.
  6050         16  PM-ACTION-CODE-3              PIC X(3).
  6051         16  PM-ACTION-DT-4                PIC XX.
  6052         16  PM-ACTION-CODE-4              PIC X(3).
  6053         16  PM-ACTION-DT-5                PIC XX.
  6054         16  PM-ACTION-CODE-5              PIC X(3).
  6055
  6056         16  PM-KEY-CHANGE                 PIC X.
  6057                 88  PM-NO-KEY-CHG      VALUES ARE ' ' 'N'.
  6058                 88  PM-KEY-CHG              VALUE 'Y'.
  6059         16  PM-KEY-CHANGE-DT              PIC XX.
  6060
  6061         16  PM-RTI-INDICATOR              PIC X.
  6062         16  PM-REASON-CODE                PIC X(3).
  6063         16  PM-IN-OUT-PROCESSING-IND      PIC X(1).
  6064             88  PM-IN-OUT-PROCESSING      VALUE 'Y'.
  6065             88  PM-NOT-IN-OUT-PROCESSING  VALUE SPACES.
  6066
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 114
* EL154.cbl
  6067     12  FILLER                            PIC X(12).
  6068
  6069******************************************************************
  6070*                 AGENT AND COMMISSION DATA                      *
  6071******************************************************************
  6072
  6073     12  PM-COMMISSION-DATA.
  6074         16  PM-REMIT-TO                   PIC S9(3) COMP-3.
  6075         16  PM-COMM-CHANGE-SW             PIC X.
  6076                 88  PM-COMMISSION-CHANGE     VALUE 'Y'.
  6077         16  PM-AGENT-INFORMATION OCCURS     5 TIMES.
  6078             20  PM-AGENT-NUMBER           PIC X(10).
  6079             20  PM-AGENT-TYPE             PIC X.
  6080                 88  PM-PRODUCER-LEVEL-AGENT
  6081                                              VALUES ARE 'C' 'D'.
  6082                 88  PM-AGENT-GROSS           VALUE 'C'.
  6083                 88  PM-AGENT-REINS           VALUE 'R'.
  6084                 88  PM-AGENT-GROSS-REINS     VALUE 'D'.
  6085                 88  PM-OVERWRITE-GROSS       VALUE 'O'.
  6086                 88  PM-OVERWRITE-GROSS-REINS VALUE 'P'.
  6087                 88  PM-OVERWRITE-REINS       VALUE 'T'.
  6088                 88  PM-REINS-ONLY            VALUE 'W'.
  6089             20  PM-COMMISSION-BILL-PAID PIC X(1).
  6090                 88  PM-GENERATE-BILL         VALUE 'B'.
  6091                 88  PM-GENERATE-PAID         VALUE 'P'.
  6092             20  PM-AGENT-COMP-1ST-YEAR PIC S99V999.
  6093             20  PM-COMP-1ST-YEAR-TYPE     PIC X(1).
  6094                 88  PM-COMP-1ST-YEAR-PERCENT VALUE '1'.
  6095                 88  PM-COMP-1ST-YEAR-DOLLARS VALUE '2'.
  6096                 88  PM-COMP-1ST-YEAR-NOT-USED VALUE '3'.
  6097             20  PM-RENEWAL-DATA.
  6098                 24  PM-AGENT-RENEWAL-DATA OCCURS 6 TIMES.
  6099                     28  PM-RENEW-MONTHS     PIC S999    COMP-3.
  6100                     28  PM-RENEW-COMMISSION
  6101                                             PIC S99V999 COMP-3.
  6102                     28  PM-RENEW-TYPE       PIC X(1).
  6103                         88  PM-COMP-RENEW-PERCENT      VALUE '1'.
  6104                         88  PM-COMP-RENEW-DOLLARS      VALUE '2'.
  6105                         88  PM-COMP-RENEW-NOT-USED     VALUE '3'.
  6106             20  PM-COMP-RECALC-FLAG       PIC X(1).
  6107                 88  PM-BYPASS-RECALC         VALUE 'N'.
  6108     12  FILLER                            PIC X(20).
  6109******************************************************************
  6110*             CUSTOMER DATA                                      *
  6111******************************************************************
  6112     12  PM-CUSTOMER-ID                    PIC X(20).
  6113******************************************************************
  6114     12  FILLER                            PIC X(43).
  6115******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 115
* EL154.cbl
  6117 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  6118                          CLAIM-MASTER ACTIVITY-TRAILERS
  6119                          CERTIFICATE-MASTER BENEFICIARY-MASTER
  6120                          ACCOUNT-MASTER PRODUCT-MASTER
  6121                          CERTIFICATE-TRAILERS POLICY-MASTER.
  6122 0000-DFHEXIT SECTION.
  6123     MOVE '9#                    $   ' TO DFHEIV0.
  6124     MOVE 'EL154' TO DFHEIV1.
  6125     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6126     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  6127     MOVE '5'                   TO DC-OPTION-CODE.
  6128     PERFORM 9700-DATE-LINK.
  6129     MOVE DC-GREG-DATE-1-EDIT   TO  CURRENT-GREG-DATE.
  6130     MOVE DC-BIN-DATE-1         TO  CURRENT-BIN-DATE.
  6131
  6132
  6133     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  6134     MOVE 2 TO EMI-NUMBER-OF-LINES.
  6135     IF EIBCALEN = 0
  6136         GO TO 8800-UNAUTHORIZED-ACCESS.
  6137
  6138     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  6139         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  6140             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  6141             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  6142             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  6143             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  6144             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  6145             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  6146             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  6147             MOVE THIS-PGM  TO PI-CALLING-PROGRAM
  6148             MOVE LOW-VALUES TO EL154AO
  6149             GO TO 7000-BUILD-SCREEN.
  6150
  6151
  6152* EXEC CICS HANDLE CONDITION
  6153*        NOTOPEN(8860-CLAM-NOT-OPEN)
  6154*        PGMIDERR(9600-PGMID-ERROR)
  6155*        ERROR(9990-ABEND)
  6156*        END-EXEC.
  6157*    MOVE '"$JL.                 ! " #00006147' TO DFHEIV0
  6158     MOVE X'22244A4C2E20202020202020' TO DFHEIV0(1:12)
  6159     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6160     MOVE X'2220233030303036313437' TO DFHEIV0(25:11)
  6161     CALL 'kxdfhei1' USING DFHEIV0
  6162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6163
  6164
  6165     IF EIBAID = DFHCLEAR
  6166         GO TO 9400-CLEAR.
  6167
  6168     IF PI-PROCESSOR-ID = 'LGXX'
  6169         GO TO 0200-RECEIVE.
  6170
  6171
  6172* EXEC CICS READQ TS
  6173*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6174*        INTO    (SECURITY-CONTROL)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 116
* EL154.cbl
  6175*        LENGTH  (SC-COMM-LENGTH)
  6176*        ITEM    (SC-ITEM)
  6177*    END-EXEC.
  6178*    MOVE '*$II   L              ''   #00006159' TO DFHEIV0
  6179     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6180     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6181     MOVE X'2020233030303036313539' TO DFHEIV0(25:11)
  6182     CALL 'kxdfhei1' USING DFHEIV0,
  6183           PI-SECURITY-TEMP-STORE-ID,
  6184           SECURITY-CONTROL,
  6185           SC-COMM-LENGTH,
  6186           SC-ITEM,
  6187           DFHEIV99,
  6188           DFHEIV99
  6189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6190
  6191
  6192     MOVE SC-CLAIMS-DISPLAY (9)   TO  PI-DISPLAY-CAP.
  6193     MOVE SC-CLAIMS-UPDATE  (9)   TO  PI-MODIFY-CAP.
  6194
  6195     IF NOT MODIFY-CAP
  6196         MOVE 'UPDATE'            TO  SM-READ
  6197         PERFORM 9995-SECURITY-VIOLATION
  6198         MOVE ER-0070             TO  EMI-ERROR
  6199         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6200         GO TO 8100-SEND-INITIAL-MAP.
  6201
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 117
* EL154.cbl
  6203 0200-RECEIVE.
  6204     MOVE LOW-VALUES TO EL154AI.
  6205     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  6206         MOVE ER-0008 TO EMI-ERROR
  6207         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6208         GO TO 8200-SEND-DATAONLY.
  6209
  6210
  6211* EXEC CICS RECEIVE
  6212*        MAP(MAP-NAME)
  6213*        MAPSET(MAPSET-NAME)
  6214*        INTO(EL154AI)
  6215*        END-EXEC.
  6216     MOVE LENGTH OF
  6217      EL154AI
  6218       TO DFHEIV11
  6219*    MOVE '8"T I  L              ''   #00006184' TO DFHEIV0
  6220     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6221     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6222     MOVE X'2020233030303036313834' TO DFHEIV0(25:11)
  6223     CALL 'kxdfhei1' USING DFHEIV0,
  6224           MAP-NAME,
  6225           EL154AI,
  6226           DFHEIV11,
  6227           MAPSET-NAME,
  6228           DFHEIV99,
  6229           DFHEIV99
  6230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6231
  6232
  6233     IF ENTERPFL = 0
  6234         GO TO 0300-CHECK-PFKEYS.
  6235     IF EIBAID NOT = DFHENTER
  6236         MOVE ER-0004 TO EMI-ERROR
  6237         GO TO 0320-INPUT-ERROR.
  6238
  6239     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  6240         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  6241     ELSE
  6242         MOVE ER-0029 TO EMI-ERROR
  6243         GO TO 0320-INPUT-ERROR.
  6244
  6245 0300-CHECK-PFKEYS.
  6246
  6247     IF EIBAID = DFHPF23
  6248         GO TO 8810-PF23.
  6249     IF EIBAID = DFHPF24
  6250         GO TO 9200-RETURN-MAIN-MENU.
  6251     IF EIBAID = DFHPF12
  6252         GO TO 9500-PF12.
  6253     IF EIBAID EQUAL DFHPF1
  6254        GO TO 0400-PAGE-FORWARD.
  6255     IF EIBAID EQUAL DFHPF2
  6256        GO TO 0700-PAGE-BACKWARD.
  6257     IF EIBAID EQUAL DFHPF3
  6258        MOVE CURRENT-BIN-DATE TO CURRENT-SAVE
  6259        IF TERMI = 'A'
  6260            GO TO 2000-ADD-ONLY
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 118
* EL154.cbl
  6261        ELSE
  6262        IF TERMI = 'N'
  6263            GO TO 3000-TERMINATE-AND-GENERATE.
  6264     IF (TERML NOT = 0) AND (EIBAID NOT = DFHENTER)
  6265         MOVE ER-0050 TO EMI-ERROR
  6266         GO TO 0320-INPUT-ERROR.
  6267     IF EIBAID = DFHENTER
  6268         GO TO 0330-EDIT-DATA.
  6269
  6270     MOVE ER-0029 TO EMI-ERROR.
  6271 0320-INPUT-ERROR.
  6272     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6273     MOVE AL-UNBON TO ENTERPFA.
  6274     IF ENTERPFL = 0
  6275         MOVE -1 TO TERML
  6276     ELSE
  6277         MOVE -1 TO ENTERPFL.
  6278
  6279     GO TO 8200-SEND-DATAONLY.
  6280
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 119
* EL154.cbl
  6282 0330-EDIT-DATA.
  6283     IF NOT MODIFY-CAP
  6284           MOVE ER-0070          TO EMI-ERROR
  6285           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6286           MOVE LOW-VALUES       TO EL154AO
  6287           GO TO 8100-SEND-INITIAL-MAP.
  6288
  6289     MOVE CURRENT-BIN-DATE       TO CURRENT-SAVE
  6290
  6291     IF TERMI = 'Y'
  6292         GO TO 1000-DELETE-CURRENT.
  6293     IF TERMI = 'A'
  6294         GO TO 2000-ADD-ONLY.
  6295     IF TERMI = 'N'
  6296         GO TO 3000-TERMINATE-AND-GENERATE.
  6297     MOVE ER-0347                TO EMI-ERROR.
  6298     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6299     MOVE -1                     TO TERML.
  6300     MOVE AL-UABON               TO TERMA.
  6301     GO TO 8200-SEND-DATAONLY.
  6302
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 120
* EL154.cbl
  6304 0400-PAGE-FORWARD.
  6305
  6306* EXEC CICS HANDLE CONDITION
  6307*         NOTFND    (8850-CLAM-END-FILE)
  6308*         ENDFILE   (8850-CLAM-END-FILE)
  6309*    END-EXEC.
  6310*    MOVE '"$I''                  ! # #00006262' TO DFHEIV0
  6311     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6312     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6313     MOVE X'2320233030303036323632' TO DFHEIV0(25:11)
  6314     CALL 'kxdfhei1' USING DFHEIV0
  6315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6316
  6317
  6318     MOVE PI-CARRIER      TO CLAM-CARRIER
  6319     MOVE PI-COMPANY-CD   TO CLAM-CO
  6320     MOVE PI-CLAIM-NO     TO CLAM-CLAIM
  6321     MOVE PI-CERT-NO      TO CLAM-CERT-NUM
  6322     MOVE CLAM-KEY        TO CLAIM-SAVE-KEY.
  6323
  6324
  6325* EXEC CICS STARTBR
  6326*         DATASET   ('ELMSTR')
  6327*         RIDFLD    (CLAM-KEY)
  6328*    END-EXEC.
  6329     MOVE 'ELMSTR' TO DFHEIV1
  6330     MOVE 0
  6331       TO DFHEIV11
  6332*    MOVE '&,         G          &   #00006273' TO DFHEIV0
  6333     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6334     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6335     MOVE X'2020233030303036323733' TO DFHEIV0(25:11)
  6336     CALL 'kxdfhei1' USING DFHEIV0,
  6337           DFHEIV1,
  6338           CLAM-KEY,
  6339           DFHEIV99,
  6340           DFHEIV11,
  6341           DFHEIV99
  6342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6343
  6344
  6345 0450-READ-NEXT-CLAIM.
  6346
  6347
  6348* EXEC CICS READNEXT
  6349*         DATASET   ('ELMSTR')
  6350*         RIDFLD    (CLAM-KEY)
  6351*         SET       (ADDRESS OF CLAIM-MASTER)
  6352*    END-EXEC.
  6353     MOVE 'ELMSTR' TO DFHEIV1
  6354     MOVE 0
  6355       TO DFHEIV11
  6356*    MOVE '&.S                   )   #00006280' TO DFHEIV0
  6357     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6358     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6359     MOVE X'2020233030303036323830' TO DFHEIV0(25:11)
  6360     CALL 'kxdfhei1' USING DFHEIV0,
  6361           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 121
* EL154.cbl
  6362           DFHEIV20,
  6363           DFHEIV99,
  6364           CLAM-KEY,
  6365           DFHEIV99,
  6366           DFHEIV11,
  6367           DFHEIV99,
  6368           DFHEIV99
  6369     SET ADDRESS OF CLAIM-MASTER TO
  6370         DFHEIV20
  6371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6372
  6373
  6374     IF PI-COMPANY-CD NOT EQUAL CLAM-CO
  6375        GO TO 8850-CLAM-END-FILE.
  6376
  6377     IF CLAM-KEY EQUAL CLAIM-SAVE-KEY
  6378        GO TO 0450-READ-NEXT-CLAIM.
  6379
  6380     IF PI-CARRIER-SECURITY GREATER SPACES
  6381         IF CL-CERT-CARRIER NOT = PI-CARRIER-SECURITY
  6382             GO TO 0450-READ-NEXT-CLAIM.
  6383
  6384     IF PI-ACCOUNT-SECURITY GREATER SPACES
  6385         IF CL-CERT-ACCOUNT NOT = PI-ACCOUNT-SECURITY
  6386             GO TO 0450-READ-NEXT-CLAIM.
  6387
  6388     IF CL-CLAIM-TYPE IS EQUAL TO PI-LIFE-OVERRIDE-L1
  6389         GO TO 0450-READ-NEXT-CLAIM.
  6390
  6391     MOVE CL-CLAIM-NO         TO PI-CLAIM-NO.
  6392     MOVE CL-CERT-CARRIER     TO PI-CARRIER
  6393     MOVE CL-CERT-GROUPING    TO PI-GROUPING
  6394     MOVE CL-CERT-STATE       TO PI-STATE
  6395     MOVE CL-CERT-ACCOUNT     TO PI-ACCOUNT
  6396     MOVE CL-CERT-EFF-DT      TO PI-CERT-EFF-DT
  6397     MOVE CL-CERT-NO          TO PI-CERT-NO
  6398
  6399     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  6400         MOVE CL-CV-REFERENCE-NO TO  PI-MP-REFERENCE-NO.
  6401
  6402
  6403* EXEC CICS ENDBR
  6404*         DATASET    ('ELMSTR')
  6405*    END-EXEC.
  6406     MOVE 'ELMSTR' TO DFHEIV1
  6407     MOVE 0
  6408       TO DFHEIV11
  6409*    MOVE '&2                    $   #00006314' TO DFHEIV0
  6410     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6411     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6412     MOVE X'2020233030303036333134' TO DFHEIV0(25:11)
  6413     CALL 'kxdfhei1' USING DFHEIV0,
  6414           DFHEIV1,
  6415           DFHEIV11,
  6416           DFHEIV99
  6417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6418
  6419
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 122
* EL154.cbl
  6420     MOVE LOW-VALUES TO EL154AO.
  6421     GO TO 7000-BUILD-SCREEN.
  6422
  6423 0700-PAGE-BACKWARD.
  6424
  6425
  6426* EXEC CICS HANDLE CONDITION
  6427*         NOTFND    (8850-CLAM-END-FILE)
  6428*         ENDFILE   (8850-CLAM-END-FILE)
  6429*    END-EXEC.
  6430*    MOVE '"$I''                  ! $ #00006323' TO DFHEIV0
  6431     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6432     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6433     MOVE X'2420233030303036333233' TO DFHEIV0(25:11)
  6434     CALL 'kxdfhei1' USING DFHEIV0
  6435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6436
  6437
  6438     MOVE PI-CARRIER      TO CLAM-CARRIER
  6439     MOVE PI-COMPANY-CD   TO CLAM-CO
  6440     MOVE PI-CLAIM-NO     TO CLAM-CLAIM
  6441     MOVE PI-CERT-NO      TO CLAM-CERT-NUM
  6442     MOVE CLAM-KEY        TO CLAIM-SAVE-KEY.
  6443
  6444
  6445* EXEC CICS STARTBR
  6446*         DATASET   ('ELMSTR')
  6447*         RIDFLD    (CLAM-KEY)
  6448*    END-EXEC.
  6449     MOVE 'ELMSTR' TO DFHEIV1
  6450     MOVE 0
  6451       TO DFHEIV11
  6452*    MOVE '&,         G          &   #00006334' TO DFHEIV0
  6453     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6454     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6455     MOVE X'2020233030303036333334' TO DFHEIV0(25:11)
  6456     CALL 'kxdfhei1' USING DFHEIV0,
  6457           DFHEIV1,
  6458           CLAM-KEY,
  6459           DFHEIV99,
  6460           DFHEIV11,
  6461           DFHEIV99
  6462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6463
  6464
  6465 0750-READ-PREV-CLAIM.
  6466
  6467
  6468* EXEC CICS READPREV
  6469*         DATASET   ('ELMSTR')
  6470*         RIDFLD    (CLAM-KEY)
  6471*         SET       (ADDRESS OF CLAIM-MASTER)
  6472*    END-EXEC.
  6473     MOVE 'ELMSTR' TO DFHEIV1
  6474     MOVE 0
  6475       TO DFHEIV11
  6476*    MOVE '&0S                   )   #00006341' TO DFHEIV0
  6477     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 123
* EL154.cbl
  6478     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6479     MOVE X'2020233030303036333431' TO DFHEIV0(25:11)
  6480     CALL 'kxdfhei1' USING DFHEIV0,
  6481           DFHEIV1,
  6482           DFHEIV20,
  6483           DFHEIV99,
  6484           CLAM-KEY,
  6485           DFHEIV99,
  6486           DFHEIV11,
  6487           DFHEIV99,
  6488           DFHEIV99
  6489     SET ADDRESS OF CLAIM-MASTER TO
  6490         DFHEIV20
  6491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6492
  6493
  6494     IF PI-COMPANY-CD NOT EQUAL CLAM-CO
  6495        GO TO 8850-CLAM-END-FILE.
  6496
  6497     IF CLAM-KEY EQUAL CLAIM-SAVE-KEY
  6498        GO TO 0750-READ-PREV-CLAIM.
  6499
  6500     IF PI-CARRIER-SECURITY GREATER SPACES
  6501         IF CL-CERT-CARRIER NOT = PI-CARRIER-SECURITY
  6502             GO TO 0750-READ-PREV-CLAIM.
  6503
  6504     IF PI-ACCOUNT-SECURITY GREATER SPACES
  6505         IF CL-CERT-ACCOUNT NOT = PI-ACCOUNT-SECURITY
  6506             GO TO 0750-READ-PREV-CLAIM.
  6507
  6508     IF CL-CLAIM-TYPE IS EQUAL TO PI-LIFE-OVERRIDE-L1
  6509         GO TO 0750-READ-PREV-CLAIM.
  6510
  6511     MOVE CL-CLAIM-NO         TO PI-CLAIM-NO.
  6512     MOVE CL-CERT-CARRIER     TO PI-CARRIER
  6513     MOVE CL-CERT-GROUPING    TO PI-GROUPING
  6514     MOVE CL-CERT-STATE       TO PI-STATE
  6515     MOVE CL-CERT-ACCOUNT     TO PI-ACCOUNT
  6516     MOVE CL-CERT-EFF-DT      TO PI-CERT-EFF-DT
  6517     MOVE CL-CERT-NO          TO PI-CERT-NO
  6518
  6519     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  6520         MOVE CL-CV-REFERENCE-NO TO  PI-MP-REFERENCE-NO.
  6521
  6522
  6523* EXEC CICS ENDBR
  6524*         DATASET    ('ELMSTR')
  6525*    END-EXEC.
  6526     MOVE 'ELMSTR' TO DFHEIV1
  6527     MOVE 0
  6528       TO DFHEIV11
  6529*    MOVE '&2                    $   #00006375' TO DFHEIV0
  6530     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6531     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6532     MOVE X'2020233030303036333735' TO DFHEIV0(25:11)
  6533     CALL 'kxdfhei1' USING DFHEIV0,
  6534           DFHEIV1,
  6535           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 124
* EL154.cbl
  6536           DFHEIV99
  6537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6538
  6539
  6540     MOVE LOW-VALUES TO EL154AO.
  6541     GO TO 7000-BUILD-SCREEN.
  6542
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 125
* EL154.cbl
  6544 1000-DELETE-CURRENT.
  6545     PERFORM 6900-SET-CODES THRU 6999-EXIT.
  6546     PERFORM 5000-READ-CLAIM THRU 5099-EXIT.
  6547
  6548     MOVE CL-AUTO-PAY-SEQ        TO ACTV-SEQ.
  6549     PERFORM 4000-DELETE-AUTO-PAY THRU 4099-EXIT.
  6550     MOVE ZEROS                  TO CL-AUTO-PAY-SEQ.
  6551     MOVE LOW-VALUES             TO CL-NEXT-AUTO-PAY-DT.
  6552
  6553     PERFORM 7100-CHECK-AUTO-ACTIVITY THRU 7100-EXIT.
  6554
  6555     PERFORM 5200-REWRITE THRU 5299-EXIT.
  6556
  6557     MOVE SPACES TO WS-END-LETTER-FORM-NUM.
  6558*    IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6559     IF PRINTL IS GREATER THAN +0
  6560         MOVE PRINTI   TO PI-AUTO-END-LETTER
  6561     END-IF.
  6562     IF PI-AUTO-END-LETTER IS GREATER THAN SPACES
  6563         IF PI-AUTO-END-LETTER IS EQUAL TO 'N   '
  6564             GO TO 1000-FINISH-DELETE
  6565         ELSE
  6566             MOVE PI-AUTO-END-LETTER TO WS-END-LETTER-FORM-NUM
  6567             MOVE 'Y'    TO WS-ACT-REC-FOUND-SW
  6568                            WS-LETTER-SW
  6569         END-IF
  6570     END-IF.
  6571
  6572     IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6573         IF WS-LETTER-SW IS EQUAL TO 'Y'
  6574             PERFORM 7150-CREATE-AUTO-LETTER THRU 7150-EXIT.
  6575
  6576 1000-FINISH-DELETE.
  6577
  6578     IF EMI-NO-ERRORS
  6579         GO TO 8200-SEND-DATAONLY.
  6580
  6581     MOVE LOW-VALUES             TO EL154AO.
  6582     MOVE -1                     TO TERML.
  6583     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 126
* EL154.cbl
  6585 2000-ADD-ONLY.
  6586     PERFORM 6900-SET-CODES THRU 6999-EXIT.
  6587     PERFORM 5900-VERIFY-ALL-FIELDS THRU 5999-EXIT.
  6588     IF NOT EMI-NO-ERRORS
  6589        GO TO 8200-SEND-DATAONLY.
  6590
  6591     PERFORM 5000-READ-CLAIM THRU 5099-EXIT.
  6592     PERFORM 6000-EDIT-INPUT-DATA THRU 6300-EXIT.
  6593     IF NOT EMI-NO-ERRORS
  6594         GO TO 8200-SEND-DATAONLY.
  6595
  6596     IF CL-AUTO-PAY-SEQ  NOT = ZEROS
  6597        MOVE ER-0372             TO EMI-ERROR
  6598        MOVE -1                  TO NEFFDTEL
  6599        MOVE AL-UABON            TO NEFFDTEA
  6600        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6601        GO TO 8200-SEND-DATAONLY.
  6602
  6603     PERFORM 6400-PAYMENT-CALCULATION  THRU 6499-EXIT.
  6604
  6605     IF NFSTAMT-SAVE IS EQUAL TO +0
  6606         MOVE ER-0350            TO  EMI-ERROR
  6607         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6608         MOVE -1                 TO  NFSTAMTL
  6609         MOVE AL-UNBON           TO  NFSTAMTA
  6610         GO TO 8200-SEND-DATAONLY.
  6611
  6612     IF EIBAID NOT = DFHPF3
  6613         GO TO 3500-CONFIRM-DATA.
  6614
  6615
  6616* EXEC CICS HANDLE CONDITION
  6617*        NOTOPEN(8870-ACTV-NOT-OPEN)
  6618*        END-EXEC.
  6619*    MOVE '"$J                   ! % #00006454' TO DFHEIV0
  6620     MOVE X'22244A202020202020202020' TO DFHEIV0(1:12)
  6621     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6622     MOVE X'2520233030303036343534' TO DFHEIV0(25:11)
  6623     CALL 'kxdfhei1' USING DFHEIV0
  6624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6625
  6626
  6627     PERFORM 4100-BUILD-AUTO-PAY THRU 4199-EXIT.
  6628
  6629     PERFORM 7100-CHECK-AUTO-ACTIVITY THRU 7100-EXIT.
  6630
  6631     PERFORM 5200-REWRITE THRU 5299-EXIT.
  6632
  6633     MOVE SPACES TO WS-LETTER-FORM-NUM.
  6634*     IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6635         IF NPRINTL IS GREATER THAN +0
  6636            IF NPRINTI IS EQUAL TO 'N   '
  6637                GO TO 2000-FINISH-ADD
  6638            ELSE
  6639                MOVE NPRINTI TO WS-LETTER-FORM-NUM
  6640                MOVE 'Y' TO WS-ACT-REC-FOUND-SW
  6641                            WS-LETTER-SW.
  6642
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 127
* EL154.cbl
  6643     IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6644         IF WS-LETTER-SW IS EQUAL TO 'Y'
  6645             PERFORM 7150-CREATE-AUTO-LETTER THRU 7150-EXIT.
  6646
  6647 2000-FINISH-ADD.
  6648
  6649     IF EMI-NO-ERRORS
  6650         GO TO 8200-SEND-DATAONLY.
  6651
  6652     MOVE LOW-VALUES             TO EL154AO.
  6653     GO TO 7000-BUILD-SCREEN.
  6654
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 128
* EL154.cbl
  6656 3000-TERMINATE-AND-GENERATE.
  6657     PERFORM 6900-SET-CODES THRU 6999-EXIT.
  6658     PERFORM 5900-VERIFY-ALL-FIELDS THRU 5999-EXIT.
  6659     IF NOT EMI-NO-ERRORS
  6660         GO TO 8200-SEND-DATAONLY.
  6661
  6662     PERFORM 5000-READ-CLAIM THRU 5099-EXIT.
  6663     PERFORM 6000-EDIT-INPUT-DATA THRU 6300-EXIT.
  6664     IF NOT EMI-NO-ERRORS
  6665         GO TO 8200-SEND-DATAONLY.
  6666
  6667     PERFORM 6400-PAYMENT-CALCULATION THRU 6499-EXIT.
  6668
  6669     IF EIBAID NOT = DFHPF3
  6670         GO TO 3500-CONFIRM-DATA.
  6671
  6672     MOVE CL-AUTO-PAY-SEQ        TO ACTV-SEQ.
  6673     PERFORM 4000-DELETE-AUTO-PAY THRU 4099-EXIT.
  6674
  6675     PERFORM 4100-BUILD-AUTO-PAY  THRU 4199-EXIT.
  6676
  6677     PERFORM 5200-REWRITE THRU 5299-EXIT.
  6678
  6679     IF EMI-NO-ERRORS
  6680         GO TO 8200-SEND-DATAONLY.
  6681
  6682     MOVE LOW-VALUES TO EL154AO.
  6683     GO TO 7000-BUILD-SCREEN.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 129
* EL154.cbl
  6685 3500-CONFIRM-DATA.
  6686
  6687     MOVE -1                     TO  ENTERPFL.
  6688     MOVE ER-0670                TO  EMI-ERROR.
  6689     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6690     GO TO 8200-SEND-DATAONLY.
  6691
  6692 4000-DELETE-AUTO-PAY.
  6693
  6694* EXEC CICS HANDLE CONDITION
  6695*        NOTOPEN(8870-ACTV-NOT-OPEN)
  6696*        NOTFND(4099-EXIT)
  6697*        END-EXEC.
  6698*    MOVE '"$JI                  ! & #00006524' TO DFHEIV0
  6699     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  6700     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6701     MOVE X'2620233030303036353234' TO DFHEIV0(25:11)
  6702     CALL 'kxdfhei1' USING DFHEIV0
  6703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6704
  6705
  6706
  6707* EXEC CICS READ
  6708*        UPDATE
  6709*        DATASET(ACTV-ID)
  6710*        SET(ADDRESS OF ACTIVITY-TRAILERS)
  6711*        RIDFLD(ACTV-KEY)
  6712*        END-EXEC.
  6713*    MOVE '&"S        EU         (   #00006529' TO DFHEIV0
  6714     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6715     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6716     MOVE X'2020233030303036353239' TO DFHEIV0(25:11)
  6717     CALL 'kxdfhei1' USING DFHEIV0,
  6718           ACTV-ID,
  6719           DFHEIV20,
  6720           DFHEIV99,
  6721           ACTV-KEY,
  6722           DFHEIV99,
  6723           DFHEIV99,
  6724           DFHEIV99
  6725     SET ADDRESS OF ACTIVITY-TRAILERS TO
  6726         DFHEIV20
  6727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6728
  6729
  6730     IF PRINTL > ZEROS
  6731         MOVE PRINTI             TO AT-AUTO-END-LETTER
  6732     END-IF.
  6733
  6734     MOVE CURRENT-SAVE           TO AT-TERMINATED-DT
  6735                                    AT-AUTO-PAY-LAST-MAINT-DT
  6736     MOVE PI-PROCESSOR-ID        TO AT-AUTO-PAY-LAST-UPDATED-BY
  6737     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  6738
  6739* EXEC CICS REWRITE
  6740*        DATASET(ACTV-ID)
  6741*        FROM(ACTIVITY-TRAILERS)
  6742*        END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 130
* EL154.cbl
  6743     MOVE LENGTH OF
  6744      ACTIVITY-TRAILERS
  6745       TO DFHEIV11
  6746*    MOVE '&& L                  %   #00006544' TO DFHEIV0
  6747     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6748     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6749     MOVE X'2020233030303036353434' TO DFHEIV0(25:11)
  6750     CALL 'kxdfhei1' USING DFHEIV0,
  6751           ACTV-ID,
  6752           ACTIVITY-TRAILERS,
  6753           DFHEIV11,
  6754           DFHEIV99
  6755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6756
  6757
  6758 4099-EXIT.
  6759      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 131
* EL154.cbl
  6761 4100-BUILD-AUTO-PAY.
  6762******************************************************************
  6763*               CREATE AUTO PAY TRAILER
  6764******************************************************************
  6765
  6766     SUBTRACT 1                  FROM CL-TRAILER-SEQ-CNT.
  6767     MOVE CL-TRAILER-SEQ-CNT     TO ACTV-SEQ
  6768                                    CL-AUTO-PAY-SEQ.
  6769
  6770* EXEC CICS GETMAIN
  6771*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  6772*         LENGTH    (TRLR-LENGTH)
  6773*         INITIMG   (GETMAIN-SPACE)
  6774*    END-EXEC.
  6775*    MOVE ',"IL                  $   #00006560' TO DFHEIV0
  6776     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6777     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6778     MOVE X'2020233030303036353630' TO DFHEIV0(25:11)
  6779     CALL 'kxdfhei1' USING DFHEIV0,
  6780           DFHEIV20,
  6781           TRLR-LENGTH,
  6782           GETMAIN-SPACE
  6783     SET ADDRESS OF ACTIVITY-TRAILERS TO
  6784         DFHEIV20
  6785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6786
  6787
  6788     MOVE ZEROS                  TO AT-DAYS-IN-REG-PMT.
  6789     MOVE NEFFDTE-SAVE           TO AT-SCHEDULE-START-DT.
  6790     MOVE NFSTPMT-SAVE           TO AT-1ST-PAY-THRU-DT
  6791                                    CL-NEXT-AUTO-PAY-DT.
  6792     MOVE DAYPAYI                TO AT-AUTO-PAY-DAY.
  6793     MOVE NLSTPMT-SAVE           TO AT-SCHEDULE-END-DT.
  6794     MOVE NFSTAMT-SAVE           TO AT-FIRST-PMT-AMT.
  6795     MOVE NDAYSFI                TO AT-DAYS-IN-1ST-PMT.
  6796
  6797*    IF PI-USES-PAID-TO
  6798*        MOVE NFSTPMT-SAVE       TO  DC-BIN-DATE-1
  6799*        MOVE '6'                TO  DC-OPTION-CODE
  6800*        MOVE -1                 TO  DC-ELAPSED-DAYS
  6801*        MOVE +0                 TO  DC-ELAPSED-MONTHS
  6802*        PERFORM 9700-DATE-LINK
  6803*        IF NO-CONVERSION-ERROR
  6804*            MOVE DC-BIN-DATE-2  TO  AT-1ST-PAY-THRU-DT
  6805*                                    CL-NEXT-AUTO-PAY-DT
  6806*        ELSE
  6807*            MOVE LOW-VALUES     TO  AT-1ST-PAY-THRU-DT
  6808*                                    CL-NEXT-AUTO-PAY-DT
  6809*    ELSE
  6810*        MOVE NFSTPMT-SAVE       TO  AT-1ST-PAY-THRU-DT
  6811*                                    CL-NEXT-AUTO-PAY-DT.
  6812
  6813*    IF PI-USES-PAID-TO
  6814*        MOVE NLSTPMT-SAVE       TO  DC-BIN-DATE-1
  6815*        MOVE '6'                TO  DC-OPTION-CODE
  6816*        MOVE -1                 TO  DC-ELAPSED-DAYS
  6817*        MOVE +0                 TO  DC-ELAPSED-MONTHS
  6818*        PERFORM 9700-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 132
* EL154.cbl
  6819*        IF NO-CONVERSION-ERROR
  6820*            MOVE DC-BIN-DATE-2  TO  AT-SCHEDULE-END-DT
  6821*        ELSE
  6822*            MOVE LOW-VALUES     TO  AT-SCHEDULE-END-DT
  6823*    ELSE
  6824*        MOVE NLSTPMT-SAVE       TO  AT-SCHEDULE-END-DT.
  6825
  6826     IF NLASTI = 'Y'
  6827        MOVE 'F'                 TO AT-LAST-PMT-TYPE
  6828     ELSE
  6829        MOVE 'P'                 TO AT-LAST-PMT-TYPE.
  6830
  6831     MOVE NMONTHSI               TO AT-INTERVAL-MONTHS.
  6832     MOVE NREGPMT-SAVE           TO AT-REGULAR-PMT-AMT.
  6833
  6834     MOVE WS-PAYEE-CODE          TO AT-AUTO-PAYEE-CD.
  6835
  6836     IF NINDCTRI    IS EQUAL TO  'N'
  6837         MOVE 'N'                TO AT-AUTO-CASH
  6838     ELSE
  6839         MOVE 'Y'                TO AT-AUTO-CASH.
  6840
  6841     MOVE ENDLETTI               TO AT-AUTO-END-LETTER.
  6842
  6843     IF PI-COMPANY-ID = 'CSL'
  6844        IF PI-CARRIER = 'A' OR 'B' OR 'C' OR '1' OR '2' OR
  6845                        '3' OR '4'
  6846         INSPECT AT-AUTO-PAYEE-CD CONVERTING 'IBA' TO 'IOA'.
  6847
  6848     MOVE LOW-VALUE              TO AT-TERMINATED-DT.
  6849     MOVE 'AT'                   TO AT-RECORD-ID.
  6850     MOVE  3                     TO AT-TRAILER-TYPE.
  6851     MOVE CURRENT-SAVE           TO AT-RECORDED-DT
  6852                                    AT-AUTO-PAY-LAST-MAINT-DT
  6853     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  6854                                    AT-AUTO-PAY-LAST-UPDATED-BY
  6855     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  6856     MOVE ACTV-KEY               TO AT-CONTROL-PRIMARY.
  6857
  6858
  6859* EXEC CICS WRITE
  6860*         DATASET(ACTV-ID)
  6861*         FROM   (ACTIVITY-TRAILERS)
  6862*         RIDFLD (AT-CONTROL-PRIMARY)
  6863*         END-EXEC.
  6864     MOVE LENGTH OF
  6865      ACTIVITY-TRAILERS
  6866       TO DFHEIV11
  6867*    MOVE '&$ L                  ''   #00006636' TO DFHEIV0
  6868     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6869     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6870     MOVE X'2020233030303036363336' TO DFHEIV0(25:11)
  6871     CALL 'kxdfhei1' USING DFHEIV0,
  6872           ACTV-ID,
  6873           ACTIVITY-TRAILERS,
  6874           DFHEIV11,
  6875           AT-CONTROL-PRIMARY,
  6876           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 133
* EL154.cbl
  6877           DFHEIV99
  6878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6879
  6880
  6881 4199-EXIT.
  6882      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 134
* EL154.cbl
  6884 5000-READ-CLAIM.
  6885
  6886* EXEC CICS READ
  6887*        UPDATE
  6888*        DATASET(CLAM-ID)
  6889*        SET    (ADDRESS OF CLAIM-MASTER)
  6890*        RIDFLD (CLAM-KEY)
  6891*        END-EXEC.
  6892*    MOVE '&"S        EU         (   #00006646' TO DFHEIV0
  6893     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6894     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6895     MOVE X'2020233030303036363436' TO DFHEIV0(25:11)
  6896     CALL 'kxdfhei1' USING DFHEIV0,
  6897           CLAM-ID,
  6898           DFHEIV20,
  6899           DFHEIV99,
  6900           CLAM-KEY,
  6901           DFHEIV99,
  6902           DFHEIV99,
  6903           DFHEIV99
  6904     SET ADDRESS OF CLAIM-MASTER TO
  6905         DFHEIV20
  6906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6907
  6908
  6909 5099-EXIT.
  6910      EXIT.
  6911
  6912 5200-REWRITE.
  6913
  6914* EXEC CICS HANDLE CONDITION
  6915*        DUPKEY
  6916*        END-EXEC.
  6917*    MOVE '"$                   ! '' #00006657' TO DFHEIV0
  6918     MOVE X'222494202020202020202020' TO DFHEIV0(1:12)
  6919     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6920     MOVE X'2720233030303036363537' TO DFHEIV0(25:11)
  6921     CALL 'kxdfhei1' USING DFHEIV0
  6922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6923
  6924
  6925     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
  6926     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
  6927     MOVE CURRENT-SAVE           TO CL-LAST-MAINT-DT.
  6928
  6929* EXEC CICS REWRITE
  6930*        DATASET(CLAM-ID)
  6931*        FROM   (CLAIM-MASTER)
  6932*        END-EXEC.
  6933     MOVE LENGTH OF
  6934      CLAIM-MASTER
  6935       TO DFHEIV11
  6936*    MOVE '&& L                  %   #00006664' TO DFHEIV0
  6937     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6938     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6939     MOVE X'2020233030303036363634' TO DFHEIV0(25:11)
  6940     CALL 'kxdfhei1' USING DFHEIV0,
  6941           CLAM-ID,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 135
* EL154.cbl
  6942           CLAIM-MASTER,
  6943           DFHEIV11,
  6944           DFHEIV99
  6945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6946
  6947
  6948*    MOVE 1                      TO EMI-NUMBER-OF-LINES.
  6949     MOVE ER-0000                TO EMI-ERROR.
  6950     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6951
  6952 5299-EXIT.
  6953      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 136
* EL154.cbl
  6955 5900-VERIFY-ALL-FIELDS.
  6956******************************************************************
  6957*       PRELIMINARY EDITS TO VERIFY THAT THE REQUIRED FIELDS     *
  6958*       HAVE DATA ENTERED IN THEM                                *
  6959******************************************************************
  6960
  6961     IF DAYPAYL EQUAL +0
  6962        MOVE ZEROS TO DAYPAYI.
  6963
  6964     IF NEFFDTEL EQUAL +0
  6965        MOVE LOW-VALUES TO NEFFDTEI.
  6966
  6967     IF NFSTAMTL EQUAL +0
  6968        MOVE ZEROS TO NFSTAMTI
  6969                      NFSTAMTO.
  6970
  6971     IF NDAYSFL EQUAL +0
  6972        MOVE ZEROS TO NDAYSFI.
  6973
  6974     IF NFSTAMTL EQUAL +0
  6975        IF NDAYSFL NOT EQUAL +0
  6976           MOVE +0        TO NDAYSFL
  6977           MOVE ZEROS     TO NDAYSFI.
  6978
  6979     IF NMONTHSL = ZEROS
  6980        MOVE -1                  TO NMONTHSL
  6981        GO TO 5910-REQUIRED-ERROR.
  6982
  6983     IF NFSTPMTL = ZEROS
  6984        MOVE -1                  TO NFSTPMTL
  6985        GO TO 5910-REQUIRED-ERROR.
  6986
  6987     IF NLSTPMTL = ZEROS
  6988        MOVE -1                  TO NLSTPMTL
  6989        GO TO 5910-REQUIRED-ERROR.
  6990
  6991     IF NLASTL = ZEROS
  6992        MOVE -1                  TO NLASTL
  6993        GO TO 5910-REQUIRED-ERROR.
  6994
  6995     IF NPAYEEL = ZEROS
  6996        MOVE -1                  TO NPAYEEL
  6997        GO TO 5910-REQUIRED-ERROR.
  6998
  6999     IF LETTDTEL EQUAL +0
  7000        MOVE LOW-VALUES TO LETTDTEI.
  7001
  7002     IF (PI-COMPANY-ID  =  'AIG' OR  'AUK') AND
  7003        (NINDCTRL =  ZEROS)
  7004           MOVE -1               TO NINDCTRL
  7005           GO TO 5910-REQUIRED-ERROR.
  7006
  7007     GO TO 5999-EXIT.
  7008
  7009 5910-REQUIRED-ERROR.
  7010     MOVE ER-0358                TO EMI-ERROR.
  7011     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7012
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 137
* EL154.cbl
  7013 5999-EXIT.
  7014      EXIT.
  7015
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 138
* EL154.cbl
  7017 6000-EDIT-INPUT-DATA.
  7018******************************************************
  7019*    IF THE EFFECTIVE OR "PAID FROM" WAS NOT         *
  7020*    ENTERED, THEN USE THE INCURRED OR LAST PAID     *
  7021*    THRU DATE                                       *
  7022******************************************************
  7023
  7024     MOVE SPACES TO WS-ELIMINATION-SW.
  7025
  7026     IF NEFFDTEL NOT = ZEROS
  7027        MOVE NEFFDTEI            TO DEEDIT-FIELD
  7028        PERFORM 8600-DEEDIT
  7029        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7030        MOVE '4'                 TO DC-OPTION-CODE
  7031        PERFORM 9700-DATE-LINK
  7032        IF DATE-CONVERSION-ERROR
  7033           MOVE ER-0348          TO EMI-ERROR
  7034           MOVE -1               TO NEFFDTEL
  7035           MOVE AL-UABON         TO NEFFDTEA
  7036           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7037        ELSE
  7038           MOVE DEEDIT-FIELD-V0  TO NEFFDTEO
  7039           INSPECT NEFFDTEI CONVERTING SPACES TO '/'
  7040           MOVE AL-UANON         TO NEFFDTEA
  7041           MOVE DC-BIN-DATE-1    TO NEFFDTE-SAVE
  7042     ELSE
  7043        IF CL-PAID-THRU-DT EQUAL LOW-VALUES
  7044           MOVE 'N' TO WS-ELIMINATION-SW
  7045           MOVE CL-INCURRED-DT TO NEFFDTE-SAVE
  7046                                  DC-BIN-DATE-1
  7047           MOVE ' ' TO DC-OPTION-CODE
  7048           PERFORM 9700-DATE-LINK
  7049           IF NO-CONVERSION-ERROR
  7050              MOVE DC-GREG-DATE-1-MDY  TO NEFFDTEO
  7051              INSPECT NEFFDTEI CONVERTING SPACES TO '/'
  7052           ELSE
  7053              MOVE LOW-VALUES TO NEFFDTE-SAVE
  7054        ELSE
  7055           MOVE CL-PAID-THRU-DT TO DC-BIN-DATE-1
  7056           MOVE +1 TO DC-ELAPSED-DAYS
  7057           MOVE +0 TO DC-ELAPSED-MONTHS
  7058           MOVE '6' TO DC-OPTION-CODE
  7059           PERFORM 9700-DATE-LINK
  7060           IF NO-CONVERSION-ERROR
  7061              MOVE DC-BIN-DATE-2 TO NEFFDTE-SAVE
  7062              MOVE DC-GREG-DATE-1-MDY  TO NEFFDTEO
  7063              INSPECT NEFFDTEI CONVERTING SPACES TO '/'
  7064           ELSE
  7065              MOVE LOW-VALUES TO NEFFDTE-SAVE.
  7066
  7067******************************************************************
  7068*       EDIT FIRST PAY THRU/TO DATE.  IF THE "PAY TO" OPTION ON
  7069*       THE COMPANY CONTROL IS SET, THE FIRST PAYMENT SAVE DATE
  7070*       IS SET BACK MINUS 1 DAY FOR PROCESSING.
  7071******************************************************************
  7072
  7073     IF NFSTPMTL NOT = ZEROS
  7074        MOVE NFSTPMTI            TO DEEDIT-FIELD
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 139
* EL154.cbl
  7075        PERFORM 8600-DEEDIT
  7076        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7077        MOVE '4'                 TO DC-OPTION-CODE
  7078        PERFORM 9700-DATE-LINK
  7079        IF DATE-CONVERSION-ERROR
  7080           MOVE ER-0349          TO EMI-ERROR
  7081           MOVE -1               TO NFSTPMTL
  7082           MOVE AL-UABON         TO NFSTPMTA
  7083           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7084          ELSE
  7085           MOVE DEEDIT-FIELD-V0  TO NFSTPMTO
  7086           INSPECT NFSTPMTI CONVERTING SPACES TO '/'
  7087           MOVE AL-UANON         TO NFSTPMTA.
  7088*          MOVE DC-BIN-DATE-1    TO NFSTPMT-SAVE.
  7089
  7090     IF PI-USES-PAID-TO
  7091         MOVE '6'                TO  DC-OPTION-CODE
  7092         MOVE -1                 TO  DC-ELAPSED-DAYS
  7093         MOVE +0                 TO  DC-ELAPSED-MONTHS
  7094         PERFORM 9700-DATE-LINK
  7095         IF NO-CONVERSION-ERROR
  7096             MOVE DC-BIN-DATE-2  TO  NFSTPMT-SAVE
  7097         ELSE
  7098             MOVE ER-0349        TO  EMI-ERROR
  7099             MOVE -1             TO  NFSTPMTL
  7100             MOVE AL-UABON       TO  NFSTPMTA
  7101             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7102     ELSE
  7103         MOVE DC-BIN-DATE-1      TO  NFSTPMT-SAVE.
  7104
  7105******************************************************************
  7106*       EDIT LAST PAY THRU/TO DATE.  IF THE "PAY TO" OPTION ON
  7107*       THE COMPANY CONTROL IS SET, THE FIRST PAYMENT SAVE DATE
  7108*       IS SET BACK MINUS 1 DAY FOR PROCESSING.
  7109******************************************************************
  7110
  7111     IF NLSTPMTL NOT = ZEROS
  7112        MOVE NLSTPMTI            TO DEEDIT-FIELD
  7113        PERFORM 8600-DEEDIT
  7114        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7115        MOVE '4'                 TO DC-OPTION-CODE
  7116        PERFORM 9700-DATE-LINK
  7117        IF DATE-CONVERSION-ERROR
  7118           MOVE ER-0354          TO EMI-ERROR
  7119           MOVE -1               TO NLSTPMTL
  7120           MOVE AL-UABON         TO NLSTPMTA
  7121           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7122          ELSE
  7123           MOVE DEEDIT-FIELD-V0  TO NLSTPMTO
  7124           INSPECT NLSTPMTI CONVERTING SPACES TO '/'
  7125           MOVE AL-UANON         TO NLSTPMTA.
  7126
  7127     IF PI-USES-PAID-TO
  7128         MOVE '6'                TO  DC-OPTION-CODE
  7129         MOVE -1                 TO  DC-ELAPSED-DAYS
  7130         MOVE +0                 TO  DC-ELAPSED-MONTHS
  7131         PERFORM 9700-DATE-LINK
  7132         IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 140
* EL154.cbl
  7133             MOVE DC-BIN-DATE-2  TO  NLSTPMT-SAVE
  7134         ELSE
  7135             MOVE ER-0354        TO  EMI-ERROR
  7136             MOVE -1             TO  NLSTPMTL
  7137             MOVE AL-UABON       TO  NLSTPMTA
  7138             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7139     ELSE
  7140         MOVE DC-BIN-DATE-1      TO  NLSTPMT-SAVE.
  7141
  7142******************************************************************
  7143*       EDIT FIRST PAYMENT AMOUNT
  7144******************************************************************
  7145
  7146     IF NFSTAMTL NOT = ZEROS
  7147
  7148* EXEC CICS BIF DEEDIT
  7149*          FIELD (NFSTAMTI)
  7150*          LENGTH(10)
  7151*       END-EXEC
  7152     MOVE 10
  7153       TO DFHEIV11
  7154*    MOVE '@"L                   #   #00006868' TO DFHEIV0
  7155     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7156     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7157     MOVE X'2020233030303036383638' TO DFHEIV0(25:11)
  7158     CALL 'kxdfhei1' USING DFHEIV0,
  7159           NFSTAMTI,
  7160           DFHEIV11
  7161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7162        IF NFSTAMTI NOT NUMERIC
  7163           MOVE ER-0350          TO EMI-ERROR
  7164           MOVE -1               TO NFSTAMTL
  7165           MOVE AL-UNBON         TO NFSTAMTA
  7166           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7167        ELSE
  7168           MOVE NFSTAMTI         TO NFSTAMT-SAVE
  7169                                    NFSTAMTO
  7170           MOVE AL-UNNON         TO NFSTAMTA
  7171        end-if
  7172     end-if
  7173******************************************************************
  7174*       EDIT DAY TO PAY
  7175******************************************************************
  7176
  7177     IF DAYPAYL NOT EQUAL +0
  7178        IF DAYPAYI NUMERIC AND
  7179           DAYPAYI LESS THAN 32
  7180           MOVE AL-UNNON         TO DAYPAYA
  7181        ELSE
  7182           MOVE ER-0632          TO EMI-ERROR
  7183           MOVE -1               TO DAYPAYL
  7184           MOVE AL-UNBON         TO DAYPAYA
  7185           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7186
  7187******************************************************************
  7188*       EDIT NUMBER OF DAYS IN FIRST PAYMENT PERIOD
  7189******************************************************************
  7190
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 141
* EL154.cbl
  7191     IF NDAYSFL NOT = ZEROS
  7192        IF NDAYSFI NOT NUMERIC
  7193           MOVE ER-0351          TO EMI-ERROR
  7194           MOVE -1               TO NDAYSFL
  7195           MOVE AL-UNBON         TO NDAYSFA
  7196           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7197        ELSE
  7198           MOVE AL-UNNON         TO NDAYSFA.
  7199
  7200******************************************************************
  7201*       EDIT NUMBER OF MONTHS BETWEEN PAYMENTS
  7202******************************************************************
  7203
  7204     IF NMONTHSL EQUAL +0
  7205        MOVE +1                  TO NMONTHSL
  7206        MOVE 1                   TO NMONTHSI.
  7207
  7208     IF NMONTHSL NOT = ZEROS
  7209        IF NMONTHSI NOT NUMERIC
  7210           MOVE ER-0353          TO EMI-ERROR
  7211           MOVE -1               TO NMONTHSL
  7212           MOVE AL-UNBON         TO NMONTHSA
  7213           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7214        ELSE
  7215           IF NMONTHSI NOT GREATER THAN ZERO
  7216              MOVE ER-0353          TO EMI-ERROR
  7217              MOVE -1               TO NMONTHSL
  7218              MOVE AL-UNBON         TO NMONTHSA
  7219              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7220              ELSE
  7221              MOVE AL-UNNON         TO NMONTHSA.
  7222
  7223******************************************************************
  7224*       EDIT PAYEE CODE
  7225******************************************************************
  7226
  7227     MOVE NPAYEEI TO WS-PAYEE-CODE.
  7228
  7229     IF WS-PAYEE-SEQ NOT NUMERIC
  7230        MOVE ER-0357          TO EMI-ERROR
  7231        MOVE -1               TO NPAYEEL
  7232        MOVE AL-UNBON         TO NPAYEEA
  7233        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7234        GO TO 6300-EXIT.
  7235
  7236     IF WS-PAYEE-CD EQUAL 'I' AND
  7237        WS-PAYEE-SEQ-NUM EQUAL 0
  7238        MOVE ER-0357          TO EMI-ERROR
  7239        MOVE -1               TO NPAYEEL
  7240        MOVE AL-UNBON         TO NPAYEEA
  7241        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7242
  7243     IF WS-PAYEE-SEQ-NUM GREATER THAN 9
  7244        MOVE ER-0357          TO EMI-ERROR
  7245        MOVE -1               TO NPAYEEL
  7246        MOVE AL-UNBON         TO NPAYEEA
  7247        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7248
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 142
* EL154.cbl
  7249     IF NPAYEEL NOT EQUAL +0
  7250        IF WS-PAYEE-CD = ('I' OR 'B' OR 'A')
  7251           MOVE AL-UNNON         TO NPAYEEA
  7252        ELSE
  7253           MOVE ER-0357          TO EMI-ERROR
  7254           MOVE -1               TO NPAYEEL
  7255           MOVE AL-UNBON         TO NPAYEEA
  7256           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7257
  7258******************************************************************
  7259*       EDIT LAST PAYMENT TYPE
  7260******************************************************************
  7261
  7262     IF NLASTL NOT = ZEROS
  7263        IF NLASTI = 'Y' OR 'N'
  7264           MOVE AL-UANON         TO NLASTA
  7265        ELSE
  7266           MOVE ER-0352          TO EMI-ERROR
  7267           MOVE -1               TO NLASTL
  7268           MOVE AL-UABON         TO NLASTA
  7269           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7270
  7271******************************************************************
  7272*       EDIT CASH / NON CASH INDICATOR
  7273******************************************************************
  7274
  7275     IF NINDCTRL NOT =  ZEROS
  7276        IF NINDCTRI  = 'Y' OR 'N'
  7277           MOVE AL-UANON         TO NINDCTRA
  7278        ELSE
  7279           MOVE ER-0815          TO EMI-ERROR
  7280           MOVE -1               TO NINDCTRL
  7281           MOVE AL-UABON         TO NINDCTRA
  7282           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7283
  7284     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  7285         IF (CL-ASSOCIATES IS EQUAL TO 'A' OR 'N')
  7286             IF NINDCTRI IS EQUAL TO 'N'
  7287                 MOVE ER-3537    TO  EMI-ERROR
  7288                 MOVE -1         TO  NINDCTRL
  7289                 MOVE AL-UABON   TO  NINDCTRA
  7290                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7291
  7292******************************************************************
  7293*       EDIT LETTER PRINT INDICATOR FOR AUTO ACTIVITY
  7294******************************************************************
  7295
  7296     IF NPRINTL IS NOT EQUAL TO +0
  7297*01157         IF NPRINTI IS EQUAL TO 'N'
  7298           MOVE AL-UANON         TO  NPRINTA
  7299*01159         ELSE
  7300*01160            MOVE ER-0826          TO  EMI-ERROR
  7301*01161            MOVE -1               TO  NPRINTL
  7302*01162            MOVE AL-UABON         TO  NPRINTA
  7303*01163            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7304     END-IF.
  7305
  7306******************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 143
* EL154.cbl
  7307*    IF THE AUTO LETTER DATE IS ENTERED IT IS USED   *
  7308*    TO RESOLVE VAIABLE @@AUTOPYDT IN THE LETTER     *
  7309*    FORM THAT IS ENTERED IN THE PRINT LETTER FIELD. *
  7310******************************************************
  7311
  7312     IF LETTDTEL NOT = ZEROS
  7313        MOVE LETTDTEI            TO DEEDIT-FIELD
  7314        PERFORM 8600-DEEDIT
  7315        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7316        MOVE '4'                 TO DC-OPTION-CODE
  7317        PERFORM 9700-DATE-LINK
  7318        IF DATE-CONVERSION-ERROR
  7319           MOVE ER-3801          TO EMI-ERROR
  7320           MOVE -1               TO LETTDTEL
  7321           MOVE AL-UABON         TO LETTDTEA
  7322           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7323        ELSE
  7324           MOVE DEEDIT-FIELD-V0  TO LETTDTEO
  7325           INSPECT LETTDTEI CONVERTING SPACES TO '/'
  7326           MOVE AL-UANON         TO LETTDTEA
  7327           MOVE DC-GREG-DATE-A-EDIT TO LETTDTE-SAVE
  7328        END-IF
  7329     ELSE
  7330         MOVE SPACES TO LETTDTE-SAVE
  7331     END-IF.
  7332
  7333******************************************************************
  7334*       EDIT END LETTER PRINT INDICATOR FOR AUTO ACTIVITY
  7335******************************************************************
  7336     IF ENDLETTL NOT = ZEROS
  7337             MOVE AL-UANON          TO ENDLETTA
  7338     ELSE
  7339         IF NPRINTL NOT = ZEROS
  7340             IF NPRINTI NOT = 'N   '
  7341                 MOVE ER-3397    TO EMI-ERROR
  7342                 MOVE -1         TO ENDLETTL
  7343                 MOVE AL-UABON   TO ENDLETTA
  7344                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7345             END-IF
  7346         END-IF
  7347     END-IF.
  7348
  7349     IF NOT EMI-NO-ERRORS
  7350        GO TO 6300-EXIT.
  7351
  7352     IF PI-PROCESSOR-ID  =  LGXX-ID
  7353        GO TO 6150-READ-CARRIER.
  7354
  7355******************************************************************
  7356*       READ PROCESSOR RECORD ON THE CONTROL FILE TO GET THE
  7357*       PROCESSOR LIMITS
  7358******************************************************************
  7359
  7360
  7361* EXEC CICS HANDLE CONDITION
  7362*         NOTFND (6150-READ-CARRIER)
  7363*         NOTOPEN(8890-CNTL-NOT-OPEN)
  7364*         END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 144
* EL154.cbl
  7365*    MOVE '"$IJ                  ! ( #00007070' TO DFHEIV0
  7366     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  7367     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7368     MOVE X'2820233030303037303730' TO DFHEIV0(25:11)
  7369     CALL 'kxdfhei1' USING DFHEIV0
  7370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7371
  7372
  7373
  7374* EXEC CICS READ
  7375*         DATASET(CNTL-ID)
  7376*         RIDFLD (CNTL-KEY)
  7377*         SET    (ADDRESS OF CONTROL-FILE)
  7378*         END-EXEC.
  7379*    MOVE '&"S        E          (   #00007075' TO DFHEIV0
  7380     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7381     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7382     MOVE X'2020233030303037303735' TO DFHEIV0(25:11)
  7383     CALL 'kxdfhei1' USING DFHEIV0,
  7384           CNTL-ID,
  7385           DFHEIV20,
  7386           DFHEIV99,
  7387           CNTL-KEY,
  7388           DFHEIV99,
  7389           DFHEIV99,
  7390           DFHEIV99
  7391     SET ADDRESS OF CONTROL-FILE TO
  7392         DFHEIV20
  7393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7394
  7395
  7396     MOVE CF-PROC-CALC-AMT-TOL       TO WS-AMT-TOL.
  7397     MOVE CF-PROC-CALC-DAYS-TOL      TO WS-DAY-TOL.
  7398     MOVE CF-PROC-MAX-AUTO-PMT       TO WS-MAX-AUTO-PMT.
  7399     MOVE CF-PROC-MAX-AUTO-MOS       TO WS-MAX-AUTO-MOS.
  7400     MOVE CF-PROC-MAX-REG-PMT        TO WS-REG-PMT.
  7401
  7402  6150-READ-CARRIER.
  7403******************************************************************
  7404*       READ THE CARRIER RECORD TO GET PAYMENT TOLERANCES
  7405******************************************************************
  7406
  7407     MOVE '6'                    TO CNTL-RECORD-TYPE.
  7408     MOVE SPACES                 TO CNTL-GENL.
  7409
  7410     IF CONTROL-IS-ACTUAL-CARRIER
  7411         MOVE PI-CARRIER                 TO CNTL-GEN4
  7412     ELSE
  7413         MOVE PI-CARRIER-CONTROL-LEVEL   TO CNTL-GEN4.
  7414
  7415
  7416* EXEC CICS HANDLE CONDITION
  7417*         NOTFND(6180-READ-CERT)
  7418*         END-EXEC.
  7419*    MOVE '"$I                   ! ) #00007100' TO DFHEIV0
  7420     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7421     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7422     MOVE X'2920233030303037313030' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 145
* EL154.cbl
  7423     CALL 'kxdfhei1' USING DFHEIV0
  7424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7425
  7426
  7427
  7428* EXEC CICS READ
  7429*         DATASET(CNTL-ID)
  7430*         RIDFLD (CNTL-KEY)
  7431*         SET    (ADDRESS OF CONTROL-FILE)
  7432*         END-EXEC.
  7433*    MOVE '&"S        E          (   #00007104' TO DFHEIV0
  7434     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7435     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7436     MOVE X'2020233030303037313034' TO DFHEIV0(25:11)
  7437     CALL 'kxdfhei1' USING DFHEIV0,
  7438           CNTL-ID,
  7439           DFHEIV20,
  7440           DFHEIV99,
  7441           CNTL-KEY,
  7442           DFHEIV99,
  7443           DFHEIV99,
  7444           DFHEIV99
  7445     SET ADDRESS OF CONTROL-FILE TO
  7446         DFHEIV20
  7447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7448
  7449
  7450     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
  7451
  7452     IF WS-AMT-TOL = ZERO
  7453        MOVE CF-CALC-AMT-TOL     TO WS-AMT-TOL.
  7454
  7455     IF WS-DAY-TOL = ZEROS
  7456        MOVE CF-CALC-DAYS-TOL    TO WS-DAY-TOL.
  7457
  7458     IF WS-MAX-AUTO-PMT = ZEROS
  7459        MOVE CF-MAX-AUTO-PMT     TO WS-MAX-AUTO-PMT.
  7460
  7461     IF WS-MAX-AUTO-MOS = ZEROS
  7462        MOVE CF-MAX-AUTO-MOS     TO WS-MAX-AUTO-MOS.
  7463
  7464     IF WS-REG-PMT = ZEROS
  7465        MOVE CF-MAX-REG-PMT      TO WS-REG-PMT.
  7466
  7467 6180-READ-CERT.
  7468
  7469     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  7470         GO TO 6190-READ-EMPLCY.
  7471
  7472
  7473* EXEC CICS HANDLE CONDITION
  7474*         NOTOPEN   (8880-CERT-NOT-OPEN)
  7475*         NOTFND    (6185-CERT-NOT-FOUND)
  7476*         END-EXEC.
  7477*    MOVE '"$JI                  ! * #00007132' TO DFHEIV0
  7478     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  7479     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7480     MOVE X'2A20233030303037313332' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 146
* EL154.cbl
  7481     CALL 'kxdfhei1' USING DFHEIV0
  7482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7483
  7484
  7485
  7486* EXEC CICS READ
  7487*         DATASET(CERT-ID)
  7488*         RIDFLD (CERT-KEY)
  7489*         SET    (ADDRESS OF CERTIFICATE-MASTER)
  7490*         END-EXEC.
  7491*    MOVE '&"S        E          (   #00007137' TO DFHEIV0
  7492     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7493     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7494     MOVE X'2020233030303037313337' TO DFHEIV0(25:11)
  7495     CALL 'kxdfhei1' USING DFHEIV0,
  7496           CERT-ID,
  7497           DFHEIV20,
  7498           DFHEIV99,
  7499           CERT-KEY,
  7500           DFHEIV99,
  7501           DFHEIV99,
  7502           DFHEIV99
  7503     SET ADDRESS OF CERTIFICATE-MASTER TO
  7504         DFHEIV20
  7505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7506
  7507
  7508     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  7509         MOVE CM-LOAN-1ST-PMT-DT     TO  DC-BIN-DATE-1
  7510         MOVE '6'                    TO  DC-OPTION-CODE
  7511         MOVE '1'                    TO  DC-END-OF-MONTH
  7512         MOVE +0                     TO  DC-ELAPSED-DAYS
  7513                                         DC-ODD-DAYS-OVER
  7514         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1
  7515         PERFORM 9700-DATE-LINK
  7516         IF NO-CONVERSION-ERROR
  7517             MOVE DC-BIN-DATE-2      TO  WS-EXP-DT
  7518         ELSE
  7519             MOVE LOW-VALUES         TO  WS-EXP-DT
  7520     ELSE
  7521         MOVE CM-AH-LOAN-EXPIRE-DT   TO  WS-EXP-DT.
  7522
  7523     move cm-ah-benefit-amt      to ws-monthly-benefit
  7524     move cm-ah-benefit-cd       to ws-ah-benefit-cd
  7525     GO TO 6200-START-FINAL-EDITS.
  7526
  7527 6185-CERT-NOT-FOUND.
  7528     MOVE ER-0206                TO EMI-ERROR.
  7529     MOVE -1                     TO NEFFDTEL.
  7530     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7531     GO TO 6300-EXIT.
  7532
  7533 6190-READ-EMPLCY.
  7534
  7535
  7536* EXEC CICS HANDLE CONDITION
  7537*        NOTOPEN   (8885-EMPLCY-NOT-OPEN)
  7538*        NOTFND    (6195-EMPLCY-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 147
* EL154.cbl
  7539*    END-EXEC.
  7540*    MOVE '"$JI                  ! + #00007170' TO DFHEIV0
  7541     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  7542     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7543     MOVE X'2B20233030303037313730' TO DFHEIV0(25:11)
  7544     CALL 'kxdfhei1' USING DFHEIV0
  7545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7546
  7547
  7548     MOVE CL-CV-REFERENCE-NO     TO  EMPLCY-REFERENCE-NO.
  7549
  7550
  7551* EXEC CICS READ
  7552*        DATASET   (EMPLCY-ID)
  7553*        RIDFLD    (EMPLCY-KEY)
  7554*        SET       (ADDRESS OF POLICY-MASTER)
  7555*    END-EXEC.
  7556*    MOVE '&"S        E          (   #00007177' TO DFHEIV0
  7557     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7558     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7559     MOVE X'2020233030303037313737' TO DFHEIV0(25:11)
  7560     CALL 'kxdfhei1' USING DFHEIV0,
  7561           EMPLCY-ID,
  7562           DFHEIV20,
  7563           DFHEIV99,
  7564           EMPLCY-KEY,
  7565           DFHEIV99,
  7566           DFHEIV99,
  7567           DFHEIV99
  7568     SET ADDRESS OF POLICY-MASTER TO
  7569         DFHEIV20
  7570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7571
  7572
  7573     MOVE PM-INS-TERMINATION-DT  TO  WS-EXP-DT.
  7574     GO TO 6200-START-FINAL-EDITS.
  7575
  7576 6195-EMPLCY-NOT-FOUND.
  7577
  7578     MOVE ER-9483                TO  EMI-ERROR.
  7579     MOVE -1                     TO  NEFFDTEL.
  7580     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7581     GO TO 6300-EXIT.
  7582
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 148
* EL154.cbl
  7584 6200-START-FINAL-EDITS.
  7585
  7586******************************************************************
  7587****** VERIFY ELIMINATION PERIOD
  7588******************************************************************
  7589
  7590     IF CL-PAID-THRU-DT NOT EQUAL LOW-VALUES
  7591          GO TO 6225-CONTINUE-EDIT.
  7592
  7593     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  7594         GO TO 6225-CONTINUE-EDIT.
  7595
  7596     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
  7597     MOVE WS-ACCESS              TO CNTL-GENL.
  7598     MOVE PI-COMPANY-ID          TO CNTL-CO.
  7599     MOVE '5'                    TO CNTL-RECORD-TYPE.
  7600     MOVE ZEROS                  TO CNTL-SEQ.
  7601
  7602     IF WS-BEN-CD = ZEROS
  7603         MOVE ER-0283            TO EMI-ERROR
  7604         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7605         MOVE -1                 TO NFSTPMTL
  7606         MOVE AL-UNBON           TO NFSTPMTA
  7607         GO TO 6300-EXIT.
  7608
  7609     PERFORM 7200-LOCATE-BENEFIT THRU 7200-EXIT.
  7610
  7611     IF NOT BENEFIT-FOUND
  7612         MOVE ER-0283            TO EMI-ERROR
  7613         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7614         MOVE -1                 TO NFSTPMTL
  7615         MOVE AL-UNBON           TO NFSTPMTA
  7616         GO TO 6300-EXIT.
  7617
  7618     MOVE CF-BENEFIT-ALPHA (SUB-1) TO PI-BENEFIT-SAVE.
  7619
  7620     IF PI-BEN-DAYS NOT NUMERIC
  7621        MOVE ZEROS               TO PI-BEN-DAYS.
  7622
  7623     IF PI-BEN-TYPE = 'R'
  7624         IF PI-BEN-DAYS IS EQUAL TO ZEROS
  7625             NEXT SENTENCE
  7626         ELSE
  7627             SUBTRACT 1 FROM PI-BEN-DAYS.
  7628
  7629     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
  7630     MOVE PI-BEN-DAYS            TO DC-ELAPSED-DAYS.
  7631     MOVE +0                     TO DC-ELAPSED-MONTHS.
  7632     MOVE '6'                    TO DC-OPTION-CODE.
  7633     PERFORM 9700-DATE-LINK.
  7634     MOVE DC-BIN-DATE-2          TO RETRO-ELIM-DATE.
  7635     IF NO-EFFDTE-ENTERED
  7636        IF PI-BEN-TYPE EQUAL 'E'
  7637          MOVE  SPACES              TO  WS-ELIMINATION-SW
  7638          MOVE  DC-BIN-DATE-2       TO  NEFFDTE-SAVE
  7639          MOVE  DC-GREG-DATE-1-MDY  TO  NEFFDTEO
  7640          INSPECT NEFFDTEI CONVERTING SPACES TO '/'.
  7641
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 149
* EL154.cbl
  7642     IF PI-BEN-TYPE = 'E'
  7643         IF RETRO-ELIM-DATE GREATER THAN NEFFDTE-SAVE
  7644             MOVE ER-0541            TO EMI-ERROR
  7645             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7646             MOVE -1                 TO NEFFDTEL
  7647             MOVE AL-UNBON           TO NEFFDTEA.
  7648
  7649     IF PI-BEN-TYPE = 'R'
  7650         IF RETRO-ELIM-DATE GREATER THAN NFSTPMT-SAVE
  7651             MOVE ER-0541            TO EMI-ERROR
  7652             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7653             MOVE -1                 TO NEFFDTEL
  7654             MOVE AL-UNBON           TO NEFFDTEA.
  7655
  7656
  7657 6225-CONTINUE-EDIT.
  7658******************************************************
  7659*VERIFY THAT THE LAST PAYMENT DATE IS NOT BEYOND     *
  7660*THE EXPIRATION DATE.                                *
  7661******************************************************
  7662* FOR BIU ALLOW PAYMENT PAST EXP + 7 MONTHS
  7663     MOVE WS-EXP-DT TO DC-BIN-DATE-1.
  7664     MOVE 6         TO DC-OPTION-CODE.
  7665     MOVE 0         TO DC-ELAPSED-DAYS.
  7666     MOVE 7         TO DC-ELAPSED-MONTHS.
  7667     PERFORM 9700-DATE-LINK.
  7668     IF NO-CONVERSION-ERROR
  7669         MOVE DC-BIN-DATE-2 TO WS-EXP-DT-PLUS7
  7670     ELSE
  7671         MOVE WS-EXP-DT     TO WS-EXP-DT-PLUS7
  7672     END-IF.
  7673
  7674     IF NLSTPMT-SAVE GREATER THAN WS-EXP-DT
  7675       IF CL-CERT-ACCOUNT (9:2) = 'BI' AND
  7676                      NLSTPMT-SAVE <= WS-EXP-DT-PLUS7
  7677         IF PI-LAST-ERROR-NO EQUAL ER-3396 OR ER-0670
  7678             CONTINUE
  7679         ELSE
  7680             MOVE ER-3396             TO EMI-ERROR
  7681             MOVE AL-UABON            TO NLSTPMTA
  7682             MOVE -1                  TO NLSTPMTL
  7683             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7684         END-IF
  7685       ELSE
  7686        MOVE ER-0396             TO EMI-ERROR
  7687        MOVE AL-UABON            TO NLSTPMTA
  7688        MOVE -1                  TO NLSTPMTL
  7689        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7690        GO TO 6300-EXIT.
  7691
  7692******************************************************
  7693*VERIFY THAT THE LAST PAYMENT DATE IS GREATER THAN   *
  7694*THE FIRST PAYMENT DATE.                             *
  7695******************************************************
  7696
  7697     IF NLSTPMT-SAVE NOT GREATER THAN NFSTPMT-SAVE
  7698        MOVE ER-0559             TO EMI-ERROR
  7699        MOVE AL-UABON            TO NLSTPMTA
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 150
* EL154.cbl
  7700        MOVE -1                  TO NLSTPMTL
  7701        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7702        GO TO 6300-EXIT.
  7703
  7704******************************************************
  7705*    MAKE SURE THE DIFFERENCE BETWEEN THE FIRST      *
  7706*    PAYMENT DATE AND LAST PAYMENT DATE IS           *
  7707*    DIVISABLE BY THE INTERVAL OF MONTHS,            *
  7708*    AND THE DURATION IS IN FULL MONTH PMTS.         *
  7709******************************************************
  7710     MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-1.
  7711     MOVE NLSTPMT-SAVE           TO DC-BIN-DATE-2.
  7712     MOVE '1'                    TO DC-OPTION-CODE.
  7713     PERFORM 9700-DATE-LINK.
  7714     DIVIDE DC-ELAPSED-MONTHS BY NMONTHSI GIVING WS-WORK
  7715            REMAINDER WS-REMAINDER.
  7716     IF WS-REMAINDER NOT = 0
  7717        MOVE ER-0397             TO EMI-ERROR
  7718        MOVE -1                  TO NMONTHSL
  7719        MOVE AL-UNBON            TO NMONTHSA
  7720        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  7721        GO TO 6300-EXIT.
  7722
  7723     IF DC-ODD-DAYS-OVER GREATER THAN +0
  7724        MOVE ER-0597             TO EMI-ERROR
  7725        MOVE -1                  TO NLSTPMTL
  7726        MOVE AL-UNBON            TO NLSTPMTA
  7727                                    NFSTPMTA
  7728        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  7729        GO TO 6300-EXIT.
  7730
  7731******************************************************
  7732*    VERIFY THAT FIRST PAYMENT DATE IS NOT LESS      *
  7733*    THAN THE CURRENT DATE.                          *
  7734******************************************************
  7735     IF NFSTPMT-SAVE LESS THAN CURRENT-SAVE
  7736        MOVE ER-0563             TO EMI-ERROR
  7737        MOVE -1                  TO NFSTPMTL
  7738        MOVE AL-UNBON            TO NFSTPMTA
  7739        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7740        GO TO 6300-EXIT.
  7741
  7742******************************************************
  7743*                                                    *
  7744*    EDIT THE NUMBER OF DAYS IN FIRST PAYMENT        *
  7745*                                                    *
  7746******************************************************
  7747
  7748     MOVE NEFFDTE-SAVE       TO DC-BIN-DATE-1
  7749     MOVE -1                 TO DC-ELAPSED-DAYS
  7750     MOVE +0                 TO DC-ELAPSED-MONTHS
  7751     MOVE '6'                TO DC-OPTION-CODE
  7752     PERFORM 9700-DATE-LINK
  7753     IF NO-CONVERSION-ERROR
  7754        MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1.
  7755
  7756     MOVE NFSTPMT-SAVE       TO DC-BIN-DATE-2
  7757     MOVE +0                 TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 151
* EL154.cbl
  7758                                DC-ELAPSED-DAYS
  7759     MOVE '1'                TO DC-OPTION-CODE
  7760     PERFORM 9700-DATE-LINK
  7761     IF NO-CONVERSION-ERROR
  7762        MOVE DC-ELAPSED-DAYS  TO WS-ELAPSED-DAYS.
  7763
  7764     IF NDAYSFL EQUAL +0
  7765       OR
  7766        NDAYSFI NOT NUMERIC
  7767       OR
  7768        NDAYSFI EQUAL ZEROS
  7769        MOVE DC-ELAPSED-DAYS  TO NDAYSFI.
  7770
  7771     IF DATE1-GREATER-DATE2
  7772        MOVE ER-0450 TO EMI-ERROR
  7773        MOVE -1      TO NEFFDTEL
  7774        MOVE AL-UABON TO NEFFDTEA
  7775        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7776        GO TO 6300-EXIT.
  7777
  7778     ADD WS-DAY-TOL    NDAYSFI GIVING WS-DAYS-PLUS-TOL
  7779     SUBTRACT WS-DAY-TOL FROM NDAYSFI GIVING WS-DAYS-MINUS-TOL
  7780     IF WS-ELAPSED-DAYS  LESS THAN WS-DAYS-MINUS-TOL  OR
  7781        WS-ELAPSED-DAYS GREATER THAN WS-DAYS-PLUS-TOL OR
  7782        NDAYSFI = ZEROS
  7783         MOVE ER-0398             TO EMI-ERROR
  7784         MOVE -1                  TO NDAYSFL
  7785         MOVE AL-UNBON            TO NDAYSFA
  7786         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7787         GO TO 6300-EXIT.
  7788
  7789******************************************************
  7790*                                                    *
  7791*    VERIFY OR CALCULATE THE FIRST PAYMENT AMOUNT    *
  7792*                                                    *
  7793******************************************************
  7794
  7795     MOVE PI-COMPANY-ID         TO CP-COMPANY-ID.
  7796     MOVE NEFFDTE-SAVE          TO CP-PAID-FROM-DATE.
  7797     MOVE NFSTPMT-SAVE          TO CP-PAID-THRU-DT.
  7798     MOVE WS-CALC-METHOD        TO CP-CLAIM-CALC-METHOD.
  7799
  7800     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  7801         MOVE PM-PRODUCER           TO CP-ACCOUNT-NUMBER
  7802         MOVE PM-INS-MONTH-BENEFIT  TO  CP-ORIGINAL-BENEFIT
  7803     ELSE
  7804         MOVE CM-AH-BENEFIT-AMT     TO CP-ORIGINAL-BENEFIT
  7805         MOVE CM-ACCOUNT            TO CP-ACCOUNT-NUMBER.
  7806
  7807
  7808* EXEC CICS LINK
  7809*         PROGRAM   ('ELPMNT')
  7810*         COMMAREA  (CALCULATION-PASS-AREA)
  7811*         LENGTH    (CP-COMM-LENGTH)
  7812*    END-EXEC.
  7813     MOVE 'ELPMNT' TO DFHEIV1
  7814*    MOVE '."C                   (   #00007417' TO DFHEIV0
  7815     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 152
* EL154.cbl
  7816     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7817     MOVE X'2020233030303037343137' TO DFHEIV0(25:11)
  7818     CALL 'kxdfhei1' USING DFHEIV0,
  7819           DFHEIV1,
  7820           CALCULATION-PASS-AREA,
  7821           CP-COMM-LENGTH,
  7822           DFHEIV99,
  7823           DFHEIV99,
  7824           DFHEIV99,
  7825           DFHEIV99
  7826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7827
  7828
  7829     IF CP-CLAIM-PAYMENT NOT NUMERIC
  7830        MOVE +0 TO CP-CLAIM-PAYMENT.
  7831
  7832     IF CP-ACTUAL-DAYS NOT NUMERIC
  7833        MOVE +0 TO CP-ACTUAL-DAYS.
  7834
  7835     IF NFSTAMT-SAVE EQUAL +0
  7836        MOVE CP-CLAIM-PAYMENT TO NFSTAMT-SAVE
  7837                                 NFSTAMTO.
  7838
  7839     IF NDAYSFI EQUAL ZEROS
  7840        MOVE CP-ACTUAL-DAYS   TO NDAYSFI.
  7841
  7842
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 153
* EL154.cbl
  7844******************************************************
  7845*    VERIFY THAT DAYS IN FIRST PAY PERIOD IS REALLY  *
  7846*    THE DIFFERENCE BETWEEN THE IST PAYMENT DATE     *
  7847*    AND THE EFFECTIVE DATE                          *
  7848******************************************************
  7849*    MOVE NEFFDTE-SAVE           TO DC-BIN-DATE-1.
  7850*    MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-2.
  7851*    MOVE '1'                    TO DC-OPTION-CODE.
  7852*    PERFORM 9700-DATE-LINK.
  7853*    IF DATE1-GREATER-DATE2
  7854*       MOVE ER-0450 TO EMI-ERROR
  7855*       MOVE -1      TO NEFFDTEL
  7856*       MOVE AL-UABON TO NEFFDTEA
  7857*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7858*       GO TO 6300-EXIT.
  7859*
  7860*    ADD WS-DAY-TOL    NDAYSFI GIVING WS-DAYS-PLUS-TOL.
  7861*    SUBTRACT WS-DAY-TOL FROM NDAYSFI GIVING WS-DAYS-MINUS-TOL.
  7862*    IF DC-ELAPSED-DAYS  LESS THAN WS-DAYS-MINUS-TOL  OR
  7863*       DC-ELAPSED-DAYS GREATER THAN WS-DAYS-PLUS-TOL OR
  7864*       NDAYSFI = ZEROS
  7865*        MOVE ER-0398             TO EMI-ERROR
  7866*        MOVE -1                  TO NDAYSFL
  7867*        MOVE AL-UNBON            TO NDAYSFA
  7868*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7869*        GO TO 6300-EXIT.
  7870*
  7871******************************************************
  7872*   VERIFY THAT THE FIRST PAYMENT AMOUNT IS WITHIN   *
  7873*   THE TOLERANCE OF THE DAILY BENEFITS              *
  7874******************************************************
  7875*    IF CL-PMT-CALC-METHOD = '2' OR '5'
  7876*       COMPUTE WS-DAILY-BEN-AMT = CM-AH-BENEFIT-AMT * 12  / 365
  7877*    ELSE
  7878*       COMPUTE WS-DAILY-BEN-AMT = CM-AH-BENEFIT-AMT * 12  / 360.
  7879
  7880     IF WS-AMT-TOL NOT = ZEROS
  7881        COMPUTE WS-AMT-PLUS-TOL = (NFSTAMT-SAVE + WS-AMT-TOL)
  7882        COMPUTE WS-AMT-MINUS-TOL = (NFSTAMT-SAVE - WS-AMT-TOL)
  7883        IF CP-CLAIM-PAYMENT LESS THAN WS-AMT-MINUS-TOL OR
  7884           CP-CLAIM-PAYMENT GREATER THAN WS-AMT-PLUS-TOL OR
  7885           NFSTAMT-SAVE = +0
  7886           MOVE ER-0399          TO EMI-ERROR
  7887           MOVE -1               TO NFSTAMTL
  7888           MOVE AL-UNBON         TO NFSTAMTA
  7889           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7890           GO TO 6300-EXIT.
  7891
  7892******************************************************
  7893*   VERIFY THERE IS AN ADDR TRAILER AVAILABLE        *
  7894*   FOR THE PAYEE CODE SPECIFIED                     *
  7895******************************************************
  7896     IF (WS-PAYEE-CD EQUAL 'I' AND
  7897        WS-PAYEE-SEQ-NUM GREATER THAN CL-INSURED-ADDR-CNT)
  7898       OR
  7899        (WS-PAYEE-CD EQUAL 'B' AND
  7900        WS-PAYEE-SEQ-NUM GREATER THAN CL-BENIF-ADDR-CNT)
  7901       OR
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 154
* EL154.cbl
  7902        (WS-PAYEE-CD EQUAL 'A' AND
  7903        WS-PAYEE-SEQ-NUM GREATER THAN CL-ACCOUNT-ADDR-CNT)
  7904        GO TO 6250-ADDR-ERROR.
  7905
  7906     IF (WS-PAYEE-CD EQUAL 'I')
  7907       OR
  7908        ((WS-PAYEE-CD EQUAL 'B' OR 'A') AND
  7909        (WS-PAYEE-SEQ-NUM GREATER THAN 0))
  7910        GO TO 6260-CONT.
  7911
  7912     IF WS-PAYEE-CD EQUAL 'A'
  7913        GO TO 6260-CONT.
  7914
  7915     IF (WS-PAYEE-CD EQUAL 'B' AND
  7916        CL-BENEFICIARY EQUAL SPACES)
  7917        GO TO 6250-ADDR-ERROR.
  7918
  7919     MOVE PI-COMPANY-CD          TO BENE-CO.
  7920     MOVE 'B'                    TO BENE-REC-TYPE.
  7921     MOVE CL-BENEFICIARY         TO BENE-CODE.
  7922
  7923
  7924* EXEC CICS HANDLE CONDITION
  7925*         NOTFND   (6250-ADDR-ERROR)
  7926*         END-EXEC.
  7927*    MOVE '"$I                   ! , #00007517' TO DFHEIV0
  7928     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7929     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7930     MOVE X'2C20233030303037353137' TO DFHEIV0(25:11)
  7931     CALL 'kxdfhei1' USING DFHEIV0
  7932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7933
  7934
  7935
  7936* EXEC CICS READ
  7937*         DATASET     (BENE-ID)
  7938*         SET         (ADDRESS OF BENEFICIARY-MASTER)
  7939*         RIDFLD      (BENE-KEY)
  7940*         END-EXEC.
  7941*    MOVE '&"S        E          (   #00007521' TO DFHEIV0
  7942     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7943     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7944     MOVE X'2020233030303037353231' TO DFHEIV0(25:11)
  7945     CALL 'kxdfhei1' USING DFHEIV0,
  7946           BENE-ID,
  7947           DFHEIV20,
  7948           DFHEIV99,
  7949           BENE-KEY,
  7950           DFHEIV99,
  7951           DFHEIV99,
  7952           DFHEIV99
  7953     SET ADDRESS OF BENEFICIARY-MASTER TO
  7954         DFHEIV20
  7955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7956
  7957
  7958     GO TO 6260-CONT.
  7959
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 155
* EL154.cbl
  7960 6250-ADDR-ERROR.
  7961     IF (PI-COMPANY-ID EQUAL 'AIG' OR 'AUK' OR 'CIG' OR 'CUK')
  7962         IF (WS-PAYEE-CD EQUAL 'B')   AND
  7963            (WS-PAYEE-SEQ-NUM EQUAL 9)
  7964             GO TO 6260-CONT.
  7965
  7966     MOVE ER-0401         TO EMI-ERROR.
  7967     MOVE -1              TO NPAYEEL.
  7968     MOVE AL-UNBON        TO NPAYEEA.
  7969     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7970
  7971 6260-CONT.
  7972******************************************************
  7973*   VERIFY THAT THE EFFECTIVE DATE IS NOT            *
  7974*   BEFORE THE INCURRED DATE                         *
  7975******************************************************
  7976     IF NEFFDTE-SAVE LESS THAN CL-INCURRED-DT
  7977        MOVE ER-0402             TO EMI-ERROR
  7978        MOVE -1                  TO NEFFDTEL
  7979        MOVE AL-UABON            TO NEFFDTEA
  7980        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7981
  7982******************************************************
  7983*   VERIFY THAT THE CLAIM HAS NOT BEEN CLOSED.       *
  7984******************************************************
  7985     IF CLAIM-IS-CLOSED
  7986        MOVE ER-1599            TO EMI-ERROR
  7987        MOVE -1                  TO TERML
  7988        MOVE AL-UABON            TO TERMA
  7989        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7990
  7991******************************************************
  7992*  VERIFY THAT THE EFFECTIVE DATE IS                 *
  7993*  SUBSEQUENT TO THE PAID-THRU DATE                  *
  7994******************************************************
  7995     IF NEFFDTE-SAVE NOT GREATER THAN CL-PAID-THRU-DT
  7996        MOVE ER-0403             TO EMI-ERROR
  7997        MOVE -1                  TO NEFFDTEL
  7998        MOVE AL-UABON            TO NEFFDTEA
  7999        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8000
  8001******************************************************
  8002*  VERIFY THAT THE NUMBER OF MONTHS BETWEEN          *
  8003*  THE EFFECTIVE DATE AND THE LAST PAYMENT DATE      *
  8004*  IS NOT GREATER THAN THE MAXIMUM ALLOWED           *
  8005******************************************************
  8006     IF WS-MAX-AUTO-MOS NOT = ZEROS
  8007        MOVE NEFFDTE-SAVE        TO DC-BIN-DATE-1
  8008        MOVE NLSTPMT-SAVE        TO DC-BIN-DATE-2
  8009        MOVE '1'                 TO DC-OPTION-CODE
  8010        PERFORM 9700-DATE-LINK
  8011        IF DC-ELAPSED-MONTHS GREATER THAN WS-MAX-AUTO-MOS
  8012           MOVE ER-0404             TO EMI-ERROR
  8013           MOVE -1                  TO NEFFDTEL
  8014           MOVE AL-UABON            TO NEFFDTEA NLSTPMTA
  8015           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8016
  8017******************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 156
* EL154.cbl
  8018*  VERIFY THAT THE CERTIFICATE DOES NOT HAVE A       *
  8019*  CURRENT STATUS OF '8' (CANCEL APPLIED)            *
  8020******************************************************
  8021
  8022     IF PI-COMPANY-ID IS EQUAL TO 'HAN' OR 'LGX'
  8023         IF CM-AH-CANCEL-APPLIED
  8024             MOVE ER-0839            TO  EMI-ERROR
  8025             MOVE -1                 TO  ENTERPFL
  8026             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8027******************************************************************
  8028*   check to see if the pd thru dates are past the benefit exp dt
  8029******************************************************************
  8030
  8031     if pi-company-id not = 'DCC'
  8032        GO TO 6300-EXIT
  8033     END-IF
  8034
  8035     move zeros                  to ws-max-benefit-amt
  8036                                    ws-max-benefit-pmts
  8037     perform 6320-read-acct      thru 6320-exit
  8038     if ws-dcc-product-code not = spaces
  8039        perform 6340-GET-DDF-LIMITS
  8040                                 thru 6340-exit
  8041        if pdef-found
  8042           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  8043              (P1 > +8)
  8044              OR (PD-PROD-CODE (P1) = cl-claim-type)
  8045           END-PERFORM
  8046           IF P1 < +9
  8047              MOVE PD-MAX-AMT (P1)
  8048                                 TO ws-max-benefit-amt
  8049              move pd-crit-period (p1)
  8050                                 to ws-max-benefit-pmts
  8051           else
  8052              move er-1674       to emi-error
  8053              PERFORM 9900-ERROR-FORMAT
  8054                                 THRU 9900-EXIT
  8055           END-IF
  8056        else
  8057           move er-1672          to emi-error
  8058           PERFORM 9900-ERROR-FORMAT
  8059                                 THRU 9900-EXIT
  8060        END-IF
  8061     end-if
  8062     if (ws-max-benefit-amt not = zeros)
  8063        and (ws-max-benefit-amt < ws-monthly-benefit)
  8064        move ws-max-benefit-amt  to ws-monthly-benefit
  8065     end-if
  8066     perform 6350-get-cert-trlr  thru 6350-exit
  8067
  8068     if (nfstamt-save = zeros)
  8069        or (nfstamt-save = cp-claim-payment)
  8070        move ws-monthly-benefit  to nfstamt-save
  8071                                    nfstamto
  8072     end-if
  8073
  8074     compute ws-edit-1st-pmt-amt rounded =
  8075        ws-monthly-benefit * (ndaysfi / 30)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 157
* EL154.cbl
  8076     if nfstamt-save > ws-edit-1st-pmt-amt
  8077        move er-1657             to emi-error
  8078        move -1                  to nfstamtl
  8079        move al-unbon            to nfstamta
  8080        perform 9900-error-format
  8081                                 thru 9900-exit
  8082     end-if
  8083
  8084     if nfstamt-save = zeros
  8085        move ws-monthly-benefit to nfstamt-save
  8086     end-if
  8087
  8088     move cm-ah-loan-expire-dt   to ws-benefit-expiration-dt
  8089     IF CL-CRITICAL-PERIOD NOT = ZEROS and spaces
  8090        move cl-critical-period  to dc-elapsed-months
  8091        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
  8092        MOVE ZEROS               TO DC-ELAPSED-DAYS
  8093        MOVE '6'                 TO DC-OPTION-CODE
  8094        PERFORM 9700-DATE-LINK
  8095        MOVE DC-BIN-DATE-2       TO ws-BENEFIT-EXPIRATION-DT
  8096     END-IF
  8097
  8098     if nlstpmt-save > ws-benefit-expiration-dt
  8099        move er-1658             to emi-error
  8100        move -1                  to nlstpmtl
  8101        move al-uabon            to nlstpmta
  8102        perform 9900-error-format thru 9900-exit
  8103     end-if
  8104
  8105     MOVE cl-control-primary     TO ELTRLR-KEY
  8106     MOVE +95                    TO TRLR-SEQ-NO
  8107
  8108* EXEC CICS READ
  8109*       DATASET  ('ELTRLR')
  8110*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8111*       RIDFLD   (ELTRLR-KEY)
  8112*       RESP     (WS-RESPONSE)
  8113*    END-EXEC
  8114     MOVE 'ELTRLR' TO DFHEIV1
  8115*    MOVE '&"S        E          (  N#00007676' TO DFHEIV0
  8116     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8117     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8118     MOVE X'204E233030303037363736' TO DFHEIV0(25:11)
  8119     CALL 'kxdfhei1' USING DFHEIV0,
  8120           DFHEIV1,
  8121           DFHEIV20,
  8122           DFHEIV99,
  8123           ELTRLR-KEY,
  8124           DFHEIV99,
  8125           DFHEIV99,
  8126           DFHEIV99
  8127     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8128         DFHEIV20
  8129     MOVE EIBRESP  TO WS-RESPONSE
  8130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8131
  8132     if ws-resp-normal
  8133        perform varying s1 from +1 by +1 until
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 158
* EL154.cbl
  8134           at-note-error-no (s1) = spaces
  8135           if at-note-error-no (s1) not = '1661' and '1662'
  8136           move at-note-error-no (s1)
  8137                                 to emi-error
  8138           if at-note-error-no (s1) = '1653'
  8139              evaluate true
  8140                 when cl-claim-type = 'L'
  8141                    move '  LF  '
  8142                                 to emi-claim-type
  8143                 when cl-claim-type = 'I'
  8144                    move '  IU  '
  8145                                 to emi-claim-type
  8146                 when other
  8147                    move '  AH  '
  8148                                 to emi-claim-type
  8149              end-evaluate
  8150           end-if
  8151           move -1               to nlstpmtl
  8152           PERFORM 9900-ERROR-FORMAT
  8153                                 THRU 9900-EXIT
  8154           end-if
  8155        end-perform
  8156     end-if
  8157
  8158     .
  8159 6300-EXIT.
  8160      EXIT.
  8161 6320-read-acct.
  8162
  8163     move spaces              to WS-ACCT-RECORD-SW
  8164                                 ws-dcc-product-code
  8165
  8166     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
  8167     MOVE PI-CARRIER          TO ACCT-CARRIER
  8168     MOVE PI-GROUPING         TO ACCT-GROUPING
  8169     MOVE PI-STATE            TO ACCT-STATE
  8170     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
  8171     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
  8172     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
  8173
  8174
  8175* EXEC CICS READ
  8176*       DATASET ('ERACCT')
  8177*       RIDFLD  (ERACCT-KEY)
  8178*       SET     (ADDRESS OF ACCOUNT-MASTER)
  8179*       GTEQ
  8180*       resp    (WS-RESPONSE)
  8181*    END-EXEC
  8182     MOVE 'ERACCT' TO DFHEIV1
  8183*    MOVE '&"S        G          (  N#00007725' TO DFHEIV0
  8184     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8185     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8186     MOVE X'204E233030303037373235' TO DFHEIV0(25:11)
  8187     CALL 'kxdfhei1' USING DFHEIV0,
  8188           DFHEIV1,
  8189           DFHEIV20,
  8190           DFHEIV99,
  8191           ERACCT-KEY,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 159
* EL154.cbl
  8192           DFHEIV99,
  8193           DFHEIV99,
  8194           DFHEIV99
  8195     SET ADDRESS OF ACCOUNT-MASTER TO
  8196         DFHEIV20
  8197     MOVE EIBRESP  TO WS-RESPONSE
  8198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8199     IF WS-RESP-NORMAL
  8200        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
  8201        and pi-cert-eff-dt < am-expiration-dt
  8202        and pi-cert-eff-dt >= am-effective-dt
  8203        move am-dcc-product-code to ws-dcc-product-code
  8204        set acct-found           to true
  8205     end-if
  8206
  8207     .
  8208 6320-exit.
  8209     exit.
  8210
  8211 6340-GET-DDF-LIMITS.
  8212
  8213     MOVE ' '                    TO WS-PDEF-RECORD-SW
  8214     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  8215     MOVE pi-state               TO ERPDEF-STATE
  8216     MOVE WS-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  8217     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  8218     MOVE ws-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  8219     MOVE pi-CERT-EFF-DT         TO ERPDEF-EXP-DT
  8220
  8221     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  8222
  8223
  8224* EXEC CICS STARTBR
  8225*        DATASET  ('ERPDEF')
  8226*        RIDFLD   (ERPDEF-KEY)
  8227*        GTEQ
  8228*        RESP     (WS-RESPONSE)
  8229*    END-EXEC
  8230     MOVE 'ERPDEF' TO DFHEIV1
  8231     MOVE 0
  8232       TO DFHEIV11
  8233*    MOVE '&,         G          &  N#00007756' TO DFHEIV0
  8234     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8235     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8236     MOVE X'204E233030303037373536' TO DFHEIV0(25:11)
  8237     CALL 'kxdfhei1' USING DFHEIV0,
  8238           DFHEIV1,
  8239           ERPDEF-KEY,
  8240           DFHEIV99,
  8241           DFHEIV11,
  8242           DFHEIV99
  8243     MOVE EIBRESP  TO WS-RESPONSE
  8244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8245
  8246     IF NOT WS-RESP-NORMAL
  8247        GO TO 6340-EXIT
  8248     END-IF
  8249
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 160
* EL154.cbl
  8250     .
  8251 6340-READNEXT.
  8252
  8253
  8254* EXEC CICS READNEXT
  8255*       DATASET  ('ERPDEF')
  8256*       SET      (ADDRESS OF PRODUCT-MASTER)
  8257*       RIDFLD   (ERPDEF-KEY)
  8258*       RESP     (WS-RESPONSE)
  8259*    END-EXEC
  8260     MOVE 'ERPDEF' TO DFHEIV1
  8261     MOVE 0
  8262       TO DFHEIV11
  8263*    MOVE '&.S                   )  N#00007770' TO DFHEIV0
  8264     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8265     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8266     MOVE X'204E233030303037373730' TO DFHEIV0(25:11)
  8267     CALL 'kxdfhei1' USING DFHEIV0,
  8268           DFHEIV1,
  8269           DFHEIV20,
  8270           DFHEIV99,
  8271           ERPDEF-KEY,
  8272           DFHEIV99,
  8273           DFHEIV11,
  8274           DFHEIV99,
  8275           DFHEIV99
  8276     SET ADDRESS OF PRODUCT-MASTER TO
  8277         DFHEIV20
  8278     MOVE EIBRESP  TO WS-RESPONSE
  8279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8280
  8281     IF NOT WS-RESP-NORMAL
  8282        GO TO 6340-ENDBR
  8283     END-IF
  8284
  8285     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  8286        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  8287           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  8288        ELSE
  8289           GO TO 6340-READNEXT
  8290        END-IF
  8291     ELSE
  8292        GO TO 6340-ENDBR
  8293     END-IF
  8294     .
  8295 6340-ENDBR.
  8296
  8297
  8298* EXEC CICS ENDBR
  8299*       DATASET  ('ERPDEF')
  8300*    END-EXEC
  8301     MOVE 'ERPDEF' TO DFHEIV1
  8302     MOVE 0
  8303       TO DFHEIV11
  8304*    MOVE '&2                    $   #00007793' TO DFHEIV0
  8305     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8306     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8307     MOVE X'2020233030303037373933' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 161
* EL154.cbl
  8308     CALL 'kxdfhei1' USING DFHEIV0,
  8309           DFHEIV1,
  8310           DFHEIV11,
  8311           DFHEIV99
  8312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8313
  8314     .
  8315 6340-EXIT.
  8316     EXIT.
  8317
  8318 6350-get-cert-trlr.
  8319
  8320     move spaces                 to ws-cert-trlr-sw
  8321     move zeros                  to ws-benefits-prev-paid
  8322     move cl-cert-key-data       to elcrtt-key (2:21)
  8323     move cl-company-cd          to ctrlr-comp-cd
  8324     move cl-cert-no             to ctrlr-cert-no
  8325     move 'B'                    to ctrlr-rec-type
  8326
  8327
  8328* EXEC CICS READ
  8329*       DATASET  ('ELCRTT')
  8330*       set      (address of CERTIFICATE-TRAILERS)
  8331*       RIDFLD   (ELCRTT-KEY)
  8332*       RESP     (WS-RESPONSE)
  8333*    END-EXEC
  8334     MOVE 'ELCRTT' TO DFHEIV1
  8335*    MOVE '&"S        E          (  N#00007810' TO DFHEIV0
  8336     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8337     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8338     MOVE X'204E233030303037383130' TO DFHEIV0(25:11)
  8339     CALL 'kxdfhei1' USING DFHEIV0,
  8340           DFHEIV1,
  8341           DFHEIV20,
  8342           DFHEIV99,
  8343           ELCRTT-KEY,
  8344           DFHEIV99,
  8345           DFHEIV99,
  8346           DFHEIV99
  8347     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  8348         DFHEIV20
  8349     MOVE EIBRESP  TO WS-RESPONSE
  8350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8351     IF not WS-RESP-NORMAL
  8352        go to 6350-exit
  8353     end-if
  8354
  8355     set cert-trlr-found         to true
  8356     perform varying s1 from +1 by +1 until
  8357        (s1 > +24)
  8358        or (cs-claim-no (s1) = spaces)
  8359        if (cs-benefit-period (s2) = cl-benefit-period)
  8360           and (cs-claim-type (s2) = cl-claim-type)
  8361           and (cs-insured-type (s2) = cl-insured-type)
  8362           compute ws-benefits-prev-paid =
  8363              ws-benefits-prev-paid + cs-total-paid (s2)
  8364        end-if
  8365     end-perform
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 162
* EL154.cbl
  8366     compute ws-benefits-prev-paid =
  8367        (ws-benefits-prev-paid / ws-monthly-benefit)
  8368     .
  8369 6350-exit.
  8370     exit.
  8371 6400-PAYMENT-CALCULATION.
  8372
  8373     IF WS-CALC-METHOD = '1' OR '2' OR '3' OR '4' OR '5' OR '6'
  8374         IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  8375             COMPUTE NREGPMT-SAVE ROUNDED =
  8376                 (PM-INS-MONTH-BENEFIT * NMONTHSI)
  8377             MOVE NREGPMT-SAVE   TO  NREGAMTO
  8378             GO TO 6499-EXIT
  8379         ELSE
  8380             COMPUTE NREGPMT-SAVE ROUNDED =
  8381                 (ws-monthly-benefit * NMONTHSI)
  8382             MOVE NREGPMT-SAVE   TO  NREGAMTO
  8383             GO TO 6499-EXIT.
  8384
  8385     MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-1.
  8386     MOVE +0                     TO DC-ELAPSED-DAYS.
  8387     MOVE NMONTHSI               TO DC-ELAPSED-MONTHS.
  8388     MOVE '6'                    TO DC-OPTION-CODE.
  8389     PERFORM 9700-DATE-LINK.
  8390
  8391     MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-1.
  8392     MOVE '1'                    TO DC-OPTION-CODE.
  8393     PERFORM 9700-DATE-LINK.
  8394
  8395     IF (PI-COMPANY-ID  = 'FIA' AND
  8396        CL-CERT-ACCOUNT = '0000011043')
  8397        COMPUTE WS-DAILY-RATE ROUNDED =
  8398                             (CM-AH-BENEFIT-AMT * 13) / 365
  8399        COMPUTE NREGPMT-SAVE ROUNDED =
  8400                             WS-DAILY-RATE * DC-ELAPSED-DAYS
  8401        MOVE NREGPMT-SAVE  TO  NREGAMTO
  8402        GO TO 6499-EXIT.
  8403
  8404*    IF WS-CALC-METHOD = '4'
  8405*       COMPUTE WS-DAILY-RATE ROUNDED =
  8406*                            (CM-AH-BENEFIT-AMT / 30)
  8407*       COMPUTE NREGPMT-SAVE ROUNDED =
  8408*                            WS-DAILY-RATE * DC-ELAPSED-DAYS.
  8409*
  8410*    IF WS-CALC-METHOD = '5'
  8411*       COMPUTE WS-DAILY-RATE ROUNDED =
  8412*                            (CM-AH-BENEFIT-AMT * 12) / 365
  8413*       COMPUTE NREGPMT-SAVE ROUNDED =
  8414*                            WS-DAILY-RATE * DC-ELAPSED-DAYS.
  8415
  8416 6499-EXIT.
  8417      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 163
* EL154.cbl
  8419 6900-SET-CODES.
  8420     MOVE PI-CLAIM-NO            TO CLAM-CLAIM
  8421                                    ACTV-CLAIM.
  8422
  8423     MOVE PI-COMPANY-ID          TO CNTL-CO.
  8424
  8425     MOVE PI-COMPANY-CD          TO CLAM-CO
  8426                                    ACTV-CO
  8427                                    CERT-CO
  8428                                    EMPLCY-COMPANY-CD.
  8429
  8430     MOVE PI-CARRIER             TO CLAM-CARRIER
  8431                                    ACTV-CARRIER
  8432                                    CERT-CARRIER
  8433                                    EMPLCY-CARRIER.
  8434
  8435     MOVE PI-CERT-NO             TO CLAM-CERT-NUM
  8436                                    ACTV-CERT-NUM
  8437                                    CERT-CERT-NUM.
  8438
  8439     MOVE PI-GROUPING            TO CERT-GROUPING
  8440                                    EMPLCY-GROUPING.
  8441     MOVE PI-STATE               TO CERT-STATE
  8442                                    EMPLCY-STATE.
  8443     MOVE PI-ACCOUNT             TO CERT-ACCOUNT
  8444                                    EMPLCY-PRODUCER.
  8445     MOVE PI-CERT-EFF-DT         TO CERT-EFF-DT
  8446                                    EMPLCY-EFF-DT.
  8447     MOVE '2'                    TO CNTL-RECORD-TYPE.
  8448     MOVE PI-PROCESSOR-ID        TO CNTL-GENL.
  8449     MOVE ZEROS                  TO CNTL-SEQ.
  8450
  8451 6999-EXIT.
  8452      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 164
* EL154.cbl
  8454 7000-BUILD-SCREEN.
  8455     PERFORM 6900-SET-CODES.
  8456
  8457
  8458* EXEC CICS HANDLE CONDITION
  8459*         NOTOPEN(8860-CLAM-NOT-OPEN)
  8460*         NOTFND (7090-CLAIM-NOT-FOUND)
  8461*         END-EXEC.
  8462*    MOVE '"$JI                  ! - #00007922' TO DFHEIV0
  8463     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8464     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8465     MOVE X'2D20233030303037393232' TO DFHEIV0(25:11)
  8466     CALL 'kxdfhei1' USING DFHEIV0
  8467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8468
  8469
  8470
  8471* EXEC CICS READ
  8472*         DATASET(CLAM-ID)
  8473*         SET    (ADDRESS OF CLAIM-MASTER)
  8474*         RIDFLD (CLAM-KEY)
  8475*         END-EXEC.
  8476*    MOVE '&"S        E          (   #00007927' TO DFHEIV0
  8477     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8478     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8479     MOVE X'2020233030303037393237' TO DFHEIV0(25:11)
  8480     CALL 'kxdfhei1' USING DFHEIV0,
  8481           CLAM-ID,
  8482           DFHEIV20,
  8483           DFHEIV99,
  8484           CLAM-KEY,
  8485           DFHEIV99,
  8486           DFHEIV99,
  8487           DFHEIV99
  8488     SET ADDRESS OF CLAIM-MASTER TO
  8489         DFHEIV20
  8490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8491
  8492
  8493     MOVE CL-CLAIM-NO            TO CLAIMO
  8494     MOVE CL-CERT-PRIME          TO CERTO
  8495     MOVE CL-CERT-SFX            TO SUFFIXO
  8496     MOVE CL-CARRIER             TO CARRO
  8497     MOVE CL-AUTO-PAY-SEQ        TO ACTV-SEQ.
  8498
  8499     IF ACTV-SEQ = ZEROS
  8500        GO TO 7080-NO-TRAILER.
  8501
  8502
  8503* EXEC CICS HANDLE CONDITION
  8504*         NOTOPEN(8870-ACTV-NOT-OPEN)
  8505*         NOTFND (7080-NO-TRAILER)
  8506*         END-EXEC.
  8507*    MOVE '"$JI                  ! . #00007942' TO DFHEIV0
  8508     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8509     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8510     MOVE X'2E20233030303037393432' TO DFHEIV0(25:11)
  8511     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 165
* EL154.cbl
  8512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8513
  8514
  8515
  8516* EXEC CICS READ
  8517*         DATASET(ACTV-ID)
  8518*         SET    (ADDRESS OF ACTIVITY-TRAILERS)
  8519*         RIDFLD (ACTV-KEY)
  8520*    END-EXEC.
  8521*    MOVE '&"S        E          (   #00007947' TO DFHEIV0
  8522     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8523     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8524     MOVE X'2020233030303037393437' TO DFHEIV0(25:11)
  8525     CALL 'kxdfhei1' USING DFHEIV0,
  8526           ACTV-ID,
  8527           DFHEIV20,
  8528           DFHEIV99,
  8529           ACTV-KEY,
  8530           DFHEIV99,
  8531           DFHEIV99,
  8532           DFHEIV99
  8533     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8534         DFHEIV20
  8535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8536
  8537
  8538     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
  8539     MOVE SPACE                  TO DC-OPTION-CODE.
  8540     PERFORM 9700-DATE-LINK.
  8541     MOVE DC-GREG-DATE-1-EDIT    TO CESTDTEI.
  8542
  8543
  8544     MOVE AT-SCHEDULE-START-DT   TO DC-BIN-DATE-1.
  8545     MOVE SPACE                  TO DC-OPTION-CODE.
  8546     PERFORM 9700-DATE-LINK.
  8547     MOVE DC-GREG-DATE-1-EDIT    TO CEFFDTEI.
  8548
  8549     IF AT-AUTO-PAY-DAY NUMERIC
  8550         MOVE AT-AUTO-PAY-DAY    TO DAY2PAYI
  8551     ELSE
  8552         MOVE ZEROS              TO DAY2PAYI.
  8553
  8554     IF PI-USES-PAID-TO
  8555         MOVE AT-1ST-PAY-THRU-DT      TO  DC-BIN-DATE-1
  8556         MOVE '6'                     TO  DC-OPTION-CODE
  8557         MOVE +1                      TO  DC-ELAPSED-DAYS
  8558         MOVE +0                      TO  DC-ELAPSED-MONTHS
  8559         PERFORM 9700-DATE-LINK
  8560         IF NO-CONVERSION-ERROR
  8561             MOVE DC-GREG-DATE-1-EDIT TO  CFSTPMTI
  8562         ELSE
  8563             MOVE LOW-VALUES          TO  CFSTPMTI
  8564     ELSE
  8565         MOVE AT-1ST-PAY-THRU-DT      TO  DC-BIN-DATE-1
  8566         MOVE SPACE                   TO  DC-OPTION-CODE
  8567         PERFORM 9700-DATE-LINK
  8568         IF NO-CONVERSION-ERROR
  8569             MOVE DC-GREG-DATE-1-EDIT TO  CFSTPMTI
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 166
* EL154.cbl
  8570         ELSE
  8571             MOVE LOW-VALUES          TO  CFSTPMTI.
  8572
  8573     IF PI-USES-PAID-TO
  8574         MOVE AT-SCHEDULE-END-DT      TO  DC-BIN-DATE-1
  8575         MOVE '6'                     TO  DC-OPTION-CODE
  8576         MOVE +1                      TO  DC-ELAPSED-DAYS
  8577         MOVE +0                      TO  DC-ELAPSED-MONTHS
  8578         PERFORM 9700-DATE-LINK
  8579         IF NO-CONVERSION-ERROR
  8580             MOVE DC-GREG-DATE-1-EDIT TO  CLSTPMTI
  8581         ELSE
  8582             MOVE LOW-VALUES          TO  CLSTPMTI
  8583     ELSE
  8584         MOVE AT-SCHEDULE-END-DT      TO  DC-BIN-DATE-1
  8585         MOVE SPACE                   TO  DC-OPTION-CODE
  8586         MOVE +0                      TO  DC-ELAPSED-DAYS
  8587                                          DC-ELAPSED-MONTHS
  8588         PERFORM 9700-DATE-LINK
  8589         IF NO-CONVERSION-ERROR
  8590             MOVE DC-GREG-DATE-1-EDIT TO  CLSTPMTI
  8591         ELSE
  8592             MOVE LOW-VALUES          TO  CLSTPMTI.
  8593
  8594     MOVE AT-FIRST-PMT-AMT       TO CFSTAMTO.
  8595     MOVE AT-DAYS-IN-1ST-PMT     TO CDAYSFO.
  8596
  8597     IF AT-LAST-PMT-TYPE = 'F'
  8598        MOVE 'Y'                 TO CLASTO
  8599     ELSE
  8600        MOVE 'N'                 TO CLASTO.
  8601
  8602     MOVE AT-RECORDED-BY         TO CESTBYO.
  8603     MOVE AT-REGULAR-PMT-AMT     TO CREGPMTO.
  8604     MOVE AT-AUTO-CASH           TO CINDCTRO.
  8605
  8606     MOVE AT-AUTO-END-LETTER     TO PRINTI
  8607                                    PI-AUTO-END-LETTER.
  8608
  8609     IF AT-AUTO-PAYEE-TYPE EQUAL 'I'
  8610        MOVE 'INSURED'           TO CPAYEEO
  8611     ELSE
  8612     IF AT-AUTO-PAYEE-TYPE EQUAL 'B'
  8613        MOVE 'BENEFIC'           TO CPAYEEO
  8614     ELSE
  8615     IF AT-AUTO-PAYEE-TYPE EQUAL 'A'
  8616        MOVE 'ACCOUNT'           TO CPAYEEO.
  8617
  8618     MOVE AT-INTERVAL-MONTHS     TO CMONTHSO.
  8619     MOVE -1                     TO TERML.
  8620     GO TO 8100-SEND-INITIAL-MAP.
  8621
  8622 7080-NO-TRAILER.
  8623     MOVE 'A'                    TO TERMI.
  8624     MOVE AL-PADON               TO TERMA
  8625                                    PRINTA.
  8626     MOVE -1                     TO NFSTPMTL.
  8627     MOVE ER-0346                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 167
* EL154.cbl
  8628     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8629     GO TO 8100-SEND-INITIAL-MAP.
  8630
  8631 7090-CLAIM-NOT-FOUND.
  8632     MOVE ER-0186                TO EMI-ERROR.
  8633     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8634     GO TO 8100-SEND-INITIAL-MAP.
  8635
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 168
* EL154.cbl
  8637 7100-CHECK-AUTO-ACTIVITY.
  8638
  8639
  8640* EXEC CICS HANDLE CONDITION
  8641*        NOTFND   (7100-NOT-FOUND)
  8642*    END-EXEC.
  8643*    MOVE '"$I                   ! / #00008054' TO DFHEIV0
  8644     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8645     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8646     MOVE X'2F20233030303038303534' TO DFHEIV0(25:11)
  8647     CALL 'kxdfhei1' USING DFHEIV0
  8648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8649
  8650
  8651     MOVE PI-COMPANY-ID          TO  CNTL-CO.
  8652     MOVE 'T'                    TO  CNTL-RECORD-TYPE.
  8653     MOVE SPACES                 TO  CNTL-GENL.
  8654     MOVE +0                     TO  CNTL-SEQ.
  8655
  8656
  8657* EXEC CICS READ
  8658*        DATASET   (CNTL-ID)
  8659*        RIDFLD    (CNTL-KEY)
  8660*        SET       (ADDRESS OF CONTROL-FILE)
  8661*    END-EXEC.
  8662*    MOVE '&"S        E          (   #00008063' TO DFHEIV0
  8663     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8664     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8665     MOVE X'2020233030303038303633' TO DFHEIV0(25:11)
  8666     CALL 'kxdfhei1' USING DFHEIV0,
  8667           CNTL-ID,
  8668           DFHEIV20,
  8669           DFHEIV99,
  8670           CNTL-KEY,
  8671           DFHEIV99,
  8672           DFHEIV99,
  8673           DFHEIV99
  8674     SET ADDRESS OF CONTROL-FILE TO
  8675         DFHEIV20
  8676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8677
  8678
  8679     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
  8680
  8681 7100-CHECK-SYSTEM-ACTIVITY.
  8682
  8683     IF CL-ACTIVITY-CODE IS NOT EQUAL TO ZEROS
  8684         MOVE CL-ACTIVITY-CODE             TO  SUB-1
  8685         IF SUB-1 IS GREATER THAN +9
  8686             SUBTRACT +9 FROM SUB-1
  8687             MOVE CF-USER-RESET-SW (SUB-1) TO  WS-RESET-SW
  8688         ELSE
  8689             MOVE CF-SYS-RESET-SW  (SUB-1) TO  WS-RESET-SW
  8690     ELSE
  8691         MOVE 'Y'                          TO  WS-RESET-SW.
  8692
  8693     IF TERMI IS EQUAL TO 'A'
  8694         IF (CF-SYS-ACTIVE-SW (5) IS EQUAL TO 'N' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 169
* EL154.cbl
  8695             MOVE 'N'                TO  WS-LETTER-SW
  8696                                         WS-RESET-SW
  8697             GO TO 7100-EXIT.
  8698
  8699     IF TERMI IS EQUAL TO 'A'
  8700         IF (CF-SYS-LETTER-ID (5) EQUAL SPACES OR LOW-VALUES)
  8701             MOVE 'N'                TO  WS-LETTER-SW
  8702         ELSE
  8703             MOVE 'Y'                TO  WS-LETTER-SW.
  8704
  8705     IF TERMI IS EQUAL TO 'Y'
  8706         IF (CF-SYS-ACTIVE-SW (6) IS EQUAL TO 'N' OR ' ')
  8707             MOVE 'N'                TO  WS-LETTER-SW
  8708                                         WS-RESET-SW
  8709             GO TO 7100-EXIT.
  8710
  8711     IF TERMI IS EQUAL TO 'Y'
  8712         IF (CF-SYS-LETTER-ID (6) EQUAL SPACES OR LOW-VALUES)
  8713             MOVE 'N'                TO  WS-LETTER-SW
  8714         ELSE
  8715             MOVE 'Y'                TO  WS-LETTER-SW.
  8716
  8717     IF CL-ACTIVITY-CODE IS EQUAL TO 09
  8718         GO TO 7100-EXIT.
  8719
  8720     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK') AND
  8721        (CL-ACTIVITY-CODE IS EQUAL TO 11)
  8722         GO TO 7100-EXIT.
  8723
  8724     IF WS-RESET-SW IS EQUAL TO 'N'
  8725         GO TO 7100-EXIT.
  8726
  8727     MOVE CURRENT-BIN-DATE           TO  CL-ACTIVITY-MAINT-DT.
  8728
  8729     IF TERMI IS EQUAL TO 'A'
  8730         MOVE 05                     TO  CL-ACTIVITY-CODE
  8731         MOVE 'AUTO'                 TO  CL-ACTIVITY-MAINT-TYPE
  8732     ELSE
  8733         MOVE 06                     TO  CL-ACTIVITY-CODE
  8734         MOVE 'TERM'                 TO  CL-ACTIVITY-MAINT-TYPE.
  8735
  8736     GO TO 7100-EXIT.
  8737
  8738 7100-NOT-FOUND.
  8739
  8740     MOVE 'N'                        TO  WS-ACT-REC-FOUND-SW
  8741                                         WS-LETTER-SW.
  8742
  8743 7100-EXIT.
  8744     EXIT.
  8745
  8746 7150-CREATE-AUTO-LETTER.
  8747
  8748     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
  8749     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
  8750
  8751     IF TERMI IS EQUAL TO 'A'
  8752         IF WS-LETTER-FORM-NUM > SPACES
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 170
* EL154.cbl
  8753            MOVE WS-LETTER-FORM-NUM     TO  W-1523-FORM-NUMBER
  8754         ELSE
  8755         MOVE CF-SYS-LETTER-ID (5)   TO  W-1523-FORM-NUMBER
  8756         END-IF
  8757     ELSE
  8758         IF WS-END-LETTER-FORM-NUM > SPACES
  8759             MOVE WS-END-LETTER-FORM-NUM TO W-1523-FORM-NUMBER
  8760         ELSE
  8761         MOVE CF-SYS-LETTER-ID (6)   TO  W-1523-FORM-NUMBER.
  8762
  8763     IF TERMI IS EQUAL TO 'A'
  8764       IF CF-SYS-RESEND-DAYS (5) IS NOT EQUAL TO ZEROS
  8765         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  8766         MOVE '6'                    TO  DC-OPTION-CODE
  8767         MOVE CF-SYS-RESEND-DAYS (5) TO  DC-ELAPSED-DAYS
  8768         MOVE +0                     TO  DC-ELAPSED-MONTHS
  8769         PERFORM 9700-DATE-LINK
  8770         IF NO-CONVERSION-ERROR
  8771             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
  8772         ELSE
  8773             MOVE LOW-VALUES         TO  W-1523-RESEND-DATE.
  8774
  8775
  8776     IF TERMI IS EQUAL TO 'A'
  8777       IF CF-SYS-FOLLOW-UP-DAYS (5) IS NOT EQUAL TO ZEROS
  8778         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  8779         MOVE '6'                    TO  DC-OPTION-CODE
  8780         MOVE CF-SYS-FOLLOW-UP-DAYS (5)  TO  DC-ELAPSED-DAYS
  8781         MOVE +0                     TO  DC-ELAPSED-MONTHS
  8782         PERFORM 9700-DATE-LINK
  8783         IF NO-CONVERSION-ERROR
  8784             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
  8785         ELSE
  8786             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
  8787
  8788     IF TERMI IS EQUAL TO 'Y'
  8789       IF CF-SYS-RESEND-DAYS (6) IS NOT EQUAL TO ZEROS
  8790         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  8791         MOVE '6'                    TO  DC-OPTION-CODE
  8792         MOVE CF-SYS-RESEND-DAYS (6) TO  DC-ELAPSED-DAYS
  8793         MOVE +0                     TO  DC-ELAPSED-MONTHS
  8794         PERFORM 9700-DATE-LINK
  8795         IF NO-CONVERSION-ERROR
  8796             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
  8797         ELSE
  8798             MOVE LOW-VALUES         TO  W-1523-RESEND-DATE.
  8799
  8800
  8801     IF TERMI IS EQUAL TO 'Y'
  8802       IF CF-SYS-FOLLOW-UP-DAYS (6) IS NOT EQUAL TO ZEROS
  8803         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  8804         MOVE '6'                    TO  DC-OPTION-CODE
  8805         MOVE CF-SYS-FOLLOW-UP-DAYS (6)  TO  DC-ELAPSED-DAYS
  8806         MOVE +0                     TO  DC-ELAPSED-MONTHS
  8807         PERFORM 9700-DATE-LINK
  8808         IF NO-CONVERSION-ERROR
  8809             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
  8810         ELSE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 171
* EL154.cbl
  8811             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
  8812
  8813     MOVE LETTDTE-SAVE               TO W-1523-LETTER-DATE.
  8814
  8815
  8816* EXEC CICS LINK
  8817*        PROGRAM    (LINK-1523)
  8818*        COMMAREA   (W-1523-LINKDATA)
  8819*        LENGTH     (W-1523-COMM-LENGTH)
  8820*    END-EXEC.
  8821*    MOVE '."C                   (   #00008205' TO DFHEIV0
  8822     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8823     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8824     MOVE X'2020233030303038323035' TO DFHEIV0(25:11)
  8825     CALL 'kxdfhei1' USING DFHEIV0,
  8826           LINK-1523,
  8827           W-1523-LINKDATA,
  8828           W-1523-COMM-LENGTH,
  8829           DFHEIV99,
  8830           DFHEIV99,
  8831           DFHEIV99,
  8832           DFHEIV99
  8833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8834
  8835
  8836     IF W-1523-ERROR-CODE IS EQUAL TO ZEROS
  8837         GO TO 7150-EXIT.
  8838
  8839     IF W-1523-FATAL-ERROR
  8840         MOVE ER-0802                TO  EMI-ERROR
  8841         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8842         GO TO 7150-EXIT.
  8843
  8844     IF W-1523-ERROR-CODE IS EQUAL TO 0191
  8845         MOVE ER-0803                TO  EMI-ERROR
  8846         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8847
  8848 7150-EXIT.
  8849     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 172
* EL154.cbl
  8851 7200-LOCATE-BENEFIT.
  8852     MOVE SPACES TO WS-BENEFIT-FOUND-SW.
  8853
  8854
  8855* EXEC CICS HANDLE CONDITION
  8856*        ENDFILE(7200-EXIT)
  8857*        NOTFND(7200-EXIT)
  8858*        END-EXEC.
  8859*    MOVE '"$''I                  ! 0 #00008229' TO DFHEIV0
  8860     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8861     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8862     MOVE X'3020233030303038323239' TO DFHEIV0(25:11)
  8863     CALL 'kxdfhei1' USING DFHEIV0
  8864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8865
  8866
  8867
  8868* EXEC CICS READ
  8869*        DATASET(CNTL-ID)
  8870*        SET(ADDRESS OF CONTROL-FILE)
  8871*        RIDFLD(CNTL-KEY)
  8872*        GTEQ
  8873*        END-EXEC.
  8874*    MOVE '&"S        G          (   #00008234' TO DFHEIV0
  8875     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8876     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8877     MOVE X'2020233030303038323334' TO DFHEIV0(25:11)
  8878     CALL 'kxdfhei1' USING DFHEIV0,
  8879           CNTL-ID,
  8880           DFHEIV20,
  8881           DFHEIV99,
  8882           CNTL-KEY,
  8883           DFHEIV99,
  8884           DFHEIV99,
  8885           DFHEIV99
  8886     SET ADDRESS OF CONTROL-FILE TO
  8887         DFHEIV20
  8888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8889
  8890
  8891     IF (CNTL-CO NOT = CF-COMPANY-ID)   OR
  8892        (CNTL-RECORD-TYPE NOT = CF-RECORD-TYPE)
  8893           GO TO 7200-EXIT.
  8894
  8895     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
  8896         VARYING SUB-1 FROM 1 BY 1 UNTIL
  8897            ((SUB-1 GREATER 8) OR
  8898            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
  8899
  8900     IF SUB-1 NOT = 9
  8901         MOVE 'Y' TO WS-BENEFIT-FOUND-SW.
  8902
  8903     GO TO 7200-EXIT.
  8904
  8905 7200-BENEFIT-DUMMY.
  8906
  8907 7200-DUMMY-EXIT.
  8908     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 173
* EL154.cbl
  8909
  8910 7200-EXIT.
  8911     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 174
* EL154.cbl
  8913 8100-SEND-INITIAL-MAP.
  8914     MOVE CURRENT-GREG-DATE      TO RUNDTEO.
  8915     MOVE EIBTIME                TO TIME-IN.
  8916     MOVE TIME-OUT               TO RUNTIMEO.
  8917     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  8918     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  8919
  8920     IF PI-USES-PAID-TO
  8921         MOVE FIRST-PMT-HD2      TO  FSTHD1O
  8922                                     FSTHD2O
  8923         MOVE LAST-PMT-HD2       TO  LSTHD1O
  8924         MOVE LAST-PMT-HD4       TO  LSTHD2O
  8925     ELSE
  8926         MOVE FIRST-PMT-HD1      TO  FSTHD1O
  8927                                     FSTHD2O
  8928         MOVE LAST-PMT-HD1       TO  LSTHD1O
  8929         MOVE LAST-PMT-HD3       TO  LSTHD2O.
  8930
  8931
  8932* EXEC CICS SEND
  8933*        MAP(MAP-NAME)
  8934*        MAPSET(MAPSET-NAME)
  8935*        FROM(EL154AO)
  8936*        ERASE
  8937*        CURSOR
  8938*        END-EXEC.
  8939     MOVE LENGTH OF
  8940      EL154AO
  8941       TO DFHEIV12
  8942     MOVE -1
  8943       TO DFHEIV11
  8944*    MOVE '8$     CT  E    H L F ,   #00008281' TO DFHEIV0
  8945     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8946     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8947     MOVE X'2020233030303038323831' TO DFHEIV0(25:11)
  8948     CALL 'kxdfhei1' USING DFHEIV0,
  8949           MAP-NAME,
  8950           EL154AO,
  8951           DFHEIV12,
  8952           MAPSET-NAME,
  8953           DFHEIV99,
  8954           DFHEIV99,
  8955           DFHEIV99,
  8956           DFHEIV11,
  8957           DFHEIV99,
  8958           DFHEIV99,
  8959           DFHEIV99
  8960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8961
  8962
  8963     MOVE 'EL154   ' TO PI-CALLING-PROGRAM.
  8964     GO TO 9100-RETURN-TRAN.
  8965
  8966 8200-SEND-DATAONLY.
  8967     MOVE CURRENT-GREG-DATE TO RUNDTEO.
  8968     MOVE EIBTIME           TO TIME-IN.
  8969     MOVE TIME-OUT          TO RUNTIMEO.
  8970     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 175
* EL154.cbl
  8971     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  8972
  8973     IF PI-USES-PAID-TO
  8974         MOVE FIRST-PMT-HD2      TO  FSTHD1O
  8975                                     FSTHD2O
  8976         MOVE LAST-PMT-HD2       TO  LSTHD1O
  8977         MOVE LAST-PMT-HD4       TO  LSTHD2O
  8978     ELSE
  8979         MOVE FIRST-PMT-HD1      TO  FSTHD1O
  8980                                     FSTHD2O
  8981         MOVE LAST-PMT-HD1       TO  LSTHD1O
  8982         MOVE LAST-PMT-HD3       TO  LSTHD2O.
  8983
  8984
  8985* EXEC CICS SEND
  8986*        MAP(MAP-NAME)
  8987*        MAPSET(MAPSET-NAME)
  8988*        FROM(EL154AO)
  8989*        DATAONLY
  8990*        ERASEAUP
  8991*        CURSOR
  8992*        END-EXEC.
  8993     MOVE LENGTH OF
  8994      EL154AO
  8995       TO DFHEIV12
  8996     MOVE -1
  8997       TO DFHEIV11
  8998*    MOVE '8$D    CT  A    H L F ,   #00008310' TO DFHEIV0
  8999     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  9000     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9001     MOVE X'2020233030303038333130' TO DFHEIV0(25:11)
  9002     CALL 'kxdfhei1' USING DFHEIV0,
  9003           MAP-NAME,
  9004           EL154AO,
  9005           DFHEIV12,
  9006           MAPSET-NAME,
  9007           DFHEIV99,
  9008           DFHEIV99,
  9009           DFHEIV99,
  9010           DFHEIV11,
  9011           DFHEIV99,
  9012           DFHEIV99,
  9013           DFHEIV99
  9014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9015
  9016
  9017     GO TO 9100-RETURN-TRAN.
  9018
  9019 8300-SEND-TEXT.
  9020
  9021* EXEC CICS SEND TEXT
  9022*        FROM(LOGOFF-TEXT)
  9023*        LENGTH(LOGOFF-LENGTH)
  9024*        ERASE
  9025*        FREEKB
  9026*        END-EXEC.
  9027*    MOVE '8&      T  E F  H   F -   #00008322' TO DFHEIV0
  9028     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 176
* EL154.cbl
  9029     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9030     MOVE X'2020233030303038333232' TO DFHEIV0(25:11)
  9031     CALL 'kxdfhei1' USING DFHEIV0,
  9032           LOGOFF-TEXT,
  9033           LOGOFF-LENGTH,
  9034           DFHEIV99,
  9035           DFHEIV99,
  9036           DFHEIV99,
  9037           DFHEIV99,
  9038           DFHEIV99,
  9039           DFHEIV99,
  9040           DFHEIV99,
  9041           DFHEIV99,
  9042           DFHEIV99,
  9043           DFHEIV99
  9044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9045
  9046
  9047
  9048* EXEC CICS RETURN
  9049*        END-EXEC.
  9050*    MOVE '.(                    ''   #00008329' TO DFHEIV0
  9051     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9052     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9053     MOVE X'2020233030303038333239' TO DFHEIV0(25:11)
  9054     CALL 'kxdfhei1' USING DFHEIV0,
  9055           DFHEIV99,
  9056           DFHEIV99,
  9057           DFHEIV99,
  9058           DFHEIV99,
  9059           DFHEIV99,
  9060           DFHEIV99
  9061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9062
  9063
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 177
* EL154.cbl
  9065 8600-DEEDIT.
  9066
  9067* EXEC CICS BIF DEEDIT
  9068*         FIELD(DEEDIT-FIELD)
  9069*         LENGTH(15)
  9070*         END-EXEC.
  9071     MOVE 15
  9072       TO DFHEIV11
  9073*    MOVE '@"L                   #   #00008334' TO DFHEIV0
  9074     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9075     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9076     MOVE X'2020233030303038333334' TO DFHEIV0(25:11)
  9077     CALL 'kxdfhei1' USING DFHEIV0,
  9078           DEEDIT-FIELD,
  9079           DFHEIV11
  9080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9081
  9082
  9083 8800-UNAUTHORIZED-ACCESS.
  9084     MOVE UNACCESS-MSG TO LOGOFF-MSG.
  9085     GO TO 8300-SEND-TEXT.
  9086
  9087 8810-PF23.
  9088     MOVE EIBAID TO PI-ENTRY-CD-1.
  9089     MOVE XCTL-005 TO PGM-NAME.
  9090     GO TO 9300-XCTL.
  9091
  9092
  9093 8850-CLAM-END-FILE.
  9094     MOVE -1                     TO  ENTERPFL.
  9095     MOVE ER-0130 TO EMI-ERROR.
  9096     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9097     GO TO 8200-SEND-DATAONLY.
  9098
  9099 8860-CLAM-NOT-OPEN.
  9100     MOVE -1                     TO  ENTERPFL.
  9101     MOVE ER-0154 TO EMI-ERROR.
  9102     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9103     GO TO 8200-SEND-DATAONLY.
  9104
  9105 8870-ACTV-NOT-OPEN.
  9106     MOVE -1                     TO  ENTERPFL.
  9107     MOVE ER-0172 TO EMI-ERROR.
  9108     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9109     GO TO 8200-SEND-DATAONLY.
  9110
  9111 8880-CERT-NOT-OPEN.
  9112     MOVE -1                     TO  ENTERPFL.
  9113     MOVE ER-0169                TO EMI-ERROR.
  9114     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9115     GO TO 8200-SEND-DATAONLY.
  9116
  9117 8885-EMPLCY-NOT-OPEN.
  9118     MOVE -1                     TO  ENTERPFL.
  9119     MOVE ER-9883                TO  EMI-ERROR.
  9120     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9121     GO TO 8200-SEND-DATAONLY.
  9122
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 178
* EL154.cbl
  9123 8890-CNTL-NOT-OPEN.
  9124     MOVE -1                     TO  ENTERPFL.
  9125     MOVE ER-0042                TO EMI-ERROR.
  9126     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9127     GO TO 8200-SEND-DATAONLY.
  9128
  9129 9000-RETURN-CICS.
  9130
  9131* EXEC CICS RETURN
  9132*        END-EXEC.
  9133*    MOVE '.(                    ''   #00008386' TO DFHEIV0
  9134     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9135     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9136     MOVE X'2020233030303038333836' TO DFHEIV0(25:11)
  9137     CALL 'kxdfhei1' USING DFHEIV0,
  9138           DFHEIV99,
  9139           DFHEIV99,
  9140           DFHEIV99,
  9141           DFHEIV99,
  9142           DFHEIV99,
  9143           DFHEIV99
  9144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9145
  9146
  9147 9100-RETURN-TRAN.
  9148     MOVE    EMI-ERROR-NUMBER (1) TO PI-LAST-ERROR-NO.
  9149     MOVE '154A' TO PI-CURRENT-SCREEN-NO.
  9150
  9151* EXEC CICS RETURN
  9152*        TRANSID(TRANS-ID)
  9153*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  9154*        LENGTH(PI-COMM-LENGTH)
  9155*        END-EXEC.
  9156*    MOVE '.(CT                  ''   #00008392' TO DFHEIV0
  9157     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9158     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9159     MOVE X'2020233030303038333932' TO DFHEIV0(25:11)
  9160     CALL 'kxdfhei1' USING DFHEIV0,
  9161           TRANS-ID,
  9162           PROGRAM-INTERFACE-BLOCK,
  9163           PI-COMM-LENGTH,
  9164           DFHEIV99,
  9165           DFHEIV99,
  9166           DFHEIV99
  9167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9168
  9169
  9170 9200-RETURN-MAIN-MENU.
  9171     MOVE XCTL-126 TO PGM-NAME.
  9172     GO TO 9300-XCTL.
  9173
  9174 9300-XCTL.
  9175
  9176* EXEC CICS XCTL
  9177*        PROGRAM(PGM-NAME)
  9178*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  9179*        LENGTH(PI-COMM-LENGTH)
  9180*        END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 179
* EL154.cbl
  9181*    MOVE '.$C                   %   #00008403' TO DFHEIV0
  9182     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9183     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9184     MOVE X'2020233030303038343033' TO DFHEIV0(25:11)
  9185     CALL 'kxdfhei1' USING DFHEIV0,
  9186           PGM-NAME,
  9187           PROGRAM-INTERFACE-BLOCK,
  9188           PI-COMM-LENGTH,
  9189           DFHEIV99
  9190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9191
  9192
  9193 9400-CLEAR.
  9194     MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME.
  9195     GO TO 9300-XCTL.
  9196
  9197 9500-PF12.
  9198     MOVE XCTL-010 TO PGM-NAME.
  9199     GO TO 9300-XCTL.
  9200
  9201 9600-PGMID-ERROR.
  9202
  9203* EXEC CICS HANDLE CONDITION
  9204*        PGMIDERR(8300-SEND-TEXT)
  9205*        END-EXEC.
  9206*    MOVE '"$L                   ! 1 #00008418' TO DFHEIV0
  9207     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  9208     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9209     MOVE X'3120233030303038343138' TO DFHEIV0(25:11)
  9210     CALL 'kxdfhei1' USING DFHEIV0
  9211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9212
  9213
  9214     MOVE PGM-NAME     TO PI-CALLING-PROGRAM.
  9215     MOVE ' '          TO PI-ENTRY-CD-1.
  9216     MOVE XCTL-005     TO PGM-NAME.
  9217     MOVE PGM-NAME     TO LOGOFF-PGM.
  9218     MOVE PGMIDERR-MSG TO LOGOFF-FILL.
  9219     GO TO 9300-XCTL.
  9220
  9221 9700-DATE-LINK.
  9222     MOVE LINK-ELDATCV TO PGM-NAME
  9223
  9224* EXEC CICS LINK
  9225*        PROGRAM    (PGM-NAME)
  9226*        COMMAREA   (DATE-CONVERSION-DATA)
  9227*        LENGTH     (DC-COMM-LENGTH)
  9228*        END-EXEC.
  9229*    MOVE '."C                   (   #00008431' TO DFHEIV0
  9230     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9231     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9232     MOVE X'2020233030303038343331' TO DFHEIV0(25:11)
  9233     CALL 'kxdfhei1' USING DFHEIV0,
  9234           PGM-NAME,
  9235           DATE-CONVERSION-DATA,
  9236           DC-COMM-LENGTH,
  9237           DFHEIV99,
  9238           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 180
* EL154.cbl
  9239           DFHEIV99,
  9240           DFHEIV99
  9241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9242
  9243
  9244 9900-ERROR-FORMAT.
  9245     IF NOT EMI-ERRORS-COMPLETE
  9246         MOVE LINK-001 TO PGM-NAME
  9247
  9248* EXEC CICS LINK
  9249*            PROGRAM(PGM-NAME)
  9250*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  9251*            LENGTH(EMI-COMM-LENGTH)
  9252*            END-EXEC.
  9253*    MOVE '."C                   (   #00008440' TO DFHEIV0
  9254     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9255     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9256     MOVE X'2020233030303038343430' TO DFHEIV0(25:11)
  9257     CALL 'kxdfhei1' USING DFHEIV0,
  9258           PGM-NAME,
  9259           ERROR-MESSAGE-INTERFACE-BLOCK,
  9260           EMI-COMM-LENGTH,
  9261           DFHEIV99,
  9262           DFHEIV99,
  9263           DFHEIV99,
  9264           DFHEIV99
  9265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9266
  9267
  9268 9900-EXIT.
  9269     EXIT.
  9270
  9271 9990-ABEND.
  9272     MOVE LINK-004 TO PGM-NAME.
  9273     MOVE DFHEIBLK TO EMI-LINE1.
  9274
  9275* EXEC CICS LINK
  9276*        PROGRAM(PGM-NAME)
  9277*        COMMAREA(EMI-LINE1)
  9278*        LENGTH(72)
  9279*        END-EXEC.
  9280     MOVE 72
  9281       TO DFHEIV11
  9282*    MOVE '."C                   (   #00008452' TO DFHEIV0
  9283     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9284     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9285     MOVE X'2020233030303038343532' TO DFHEIV0(25:11)
  9286     CALL 'kxdfhei1' USING DFHEIV0,
  9287           PGM-NAME,
  9288           EMI-LINE1,
  9289           DFHEIV11,
  9290           DFHEIV99,
  9291           DFHEIV99,
  9292           DFHEIV99,
  9293           DFHEIV99
  9294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9295
  9296
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 181
* EL154.cbl
  9297     GO TO 8200-SEND-DATAONLY.
  9298
  9299* GOBACK.
  9300     MOVE '9%                    "   ' TO DFHEIV0
  9301     MOVE 'EL154' TO DFHEIV1
  9302     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9303     GOBACK.
  9304
  9305 9995-SECURITY-VIOLATION.
  9306*                            COPY ELCSCTP.
  9307******************************************************************
  9308*                                                                *
  9309*                            ELCSCTP                             *
  9310*                            VMOD=2.001                          *
  9311*                                                                *
  9312*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  9313******************************************************************
  9314
  9315
  9316     MOVE EIBDATE          TO SM-JUL-DATE.
  9317     MOVE EIBTRMID         TO SM-TERMID.
  9318     MOVE THIS-PGM         TO SM-PGM.
  9319     MOVE EIBTIME          TO TIME-IN.
  9320     MOVE TIME-OUT         TO SM-TIME.
  9321     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  9322
  9323
  9324* EXEC CICS LINK
  9325*         PROGRAM  ('EL003')
  9326*         COMMAREA (SECURITY-MESSAGE)
  9327*         LENGTH   (80)
  9328*    END-EXEC.
  9329     MOVE 'EL003' TO DFHEIV1
  9330     MOVE 80
  9331       TO DFHEIV11
  9332*    MOVE '."C                   (   #00008479' TO DFHEIV0
  9333     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9334     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9335     MOVE X'2020233030303038343739' TO DFHEIV0(25:11)
  9336     CALL 'kxdfhei1' USING DFHEIV0,
  9337           DFHEIV1,
  9338           SECURITY-MESSAGE,
  9339           DFHEIV11,
  9340           DFHEIV99,
  9341           DFHEIV99,
  9342           DFHEIV99,
  9343           DFHEIV99
  9344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9345
  9346
  9347******************************************************************
  9348
  9349
  9350 9995-EXIT.
  9351     EXIT.
  9352
  9353
  9354 9999-DFHBACK SECTION.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 182
* EL154.cbl
  9355     MOVE '9%                    "   ' TO DFHEIV0
  9356     MOVE 'EL154' TO DFHEIV1
  9357     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9358     GOBACK.
  9359 9999-DFHEXIT.
  9360     IF DFHEIGDJ EQUAL 0001
  9361         NEXT SENTENCE
  9362     ELSE IF DFHEIGDJ EQUAL 2
  9363         GO TO 8860-CLAM-NOT-OPEN,
  9364               9600-PGMID-ERROR,
  9365               9990-ABEND
  9366         DEPENDING ON DFHEIGDI
  9367     ELSE IF DFHEIGDJ EQUAL 3
  9368         GO TO 8850-CLAM-END-FILE,
  9369               8850-CLAM-END-FILE
  9370         DEPENDING ON DFHEIGDI
  9371     ELSE IF DFHEIGDJ EQUAL 4
  9372         GO TO 8850-CLAM-END-FILE,
  9373               8850-CLAM-END-FILE
  9374         DEPENDING ON DFHEIGDI
  9375     ELSE IF DFHEIGDJ EQUAL 5
  9376         GO TO 8870-ACTV-NOT-OPEN
  9377         DEPENDING ON DFHEIGDI
  9378     ELSE IF DFHEIGDJ EQUAL 6
  9379         GO TO 8870-ACTV-NOT-OPEN,
  9380               4099-EXIT
  9381         DEPENDING ON DFHEIGDI
  9382     ELSE IF DFHEIGDJ EQUAL 7
  9383         GO TO 9999-DFHBACK
  9384         DEPENDING ON DFHEIGDI
  9385     ELSE IF DFHEIGDJ EQUAL 8
  9386         GO TO 6150-READ-CARRIER,
  9387               8890-CNTL-NOT-OPEN
  9388         DEPENDING ON DFHEIGDI
  9389     ELSE IF DFHEIGDJ EQUAL 9
  9390         GO TO 6180-READ-CERT
  9391         DEPENDING ON DFHEIGDI
  9392     ELSE IF DFHEIGDJ EQUAL 10
  9393         GO TO 8880-CERT-NOT-OPEN,
  9394               6185-CERT-NOT-FOUND
  9395         DEPENDING ON DFHEIGDI
  9396     ELSE IF DFHEIGDJ EQUAL 11
  9397         GO TO 8885-EMPLCY-NOT-OPEN,
  9398               6195-EMPLCY-NOT-FOUND
  9399         DEPENDING ON DFHEIGDI
  9400     ELSE IF DFHEIGDJ EQUAL 12
  9401         GO TO 6250-ADDR-ERROR
  9402         DEPENDING ON DFHEIGDI
  9403     ELSE IF DFHEIGDJ EQUAL 13
  9404         GO TO 8860-CLAM-NOT-OPEN,
  9405               7090-CLAIM-NOT-FOUND
  9406         DEPENDING ON DFHEIGDI
  9407     ELSE IF DFHEIGDJ EQUAL 14
  9408         GO TO 8870-ACTV-NOT-OPEN,
  9409               7080-NO-TRAILER
  9410         DEPENDING ON DFHEIGDI
  9411     ELSE IF DFHEIGDJ EQUAL 15
  9412         GO TO 7100-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 183
* EL154.cbl
  9413         DEPENDING ON DFHEIGDI
  9414     ELSE IF DFHEIGDJ EQUAL 16
  9415         GO TO 7200-EXIT,
  9416               7200-EXIT
  9417         DEPENDING ON DFHEIGDI
  9418     ELSE IF DFHEIGDJ EQUAL 17
  9419         GO TO 8300-SEND-TEXT
  9420         DEPENDING ON DFHEIGDI.
  9421     MOVE '9%                    "   ' TO DFHEIV0
  9422     MOVE 'EL154' TO DFHEIV1
  9423     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9424     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5980     Code:       19061
