* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page   1
* ELRATE.cbl
* Options: int("ELRATE.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("ELRATE.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRATE.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRATE.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRATE.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:20:51.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.012
     9
    10*AUTHOR.     LOGIC, INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page   2
* ELRATE.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25******************************************************************
    26*  REMARKS   *                                                   *
    27*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    28*            *    OPTION SPECIFIED, COMPUTE PREMIUM AMOUNTS      *
    29*            *    AND RATES.                                     *
    30******************************************************************
    31
    32
    33******************************************************************
    34*                                                                *
    35*              INPUT FIELDS USED                                 *
    36*                                                                *
    37******************************************************************
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM    (RATING TERM)          *
    39*  CLASS CODE       - CP-CLASS-CODE                              *
    40*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    41*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    42*  RATING BENEFIT   - CP-RATING-BENEFIT-AMT (TOT BEN ON BALLOON) *
    43*  BENEFIT TYPE     - CP-BENEFIT-TYPE                            *
    44*  STATE CODE (NUM) - CP-STATE                                   *
    45*  STATE CODE       - CP-STATE-STD-ABBV                          *
    46*  COMPANY I.D.     - CP-COMPANY-ID                              *
    47*  COMPANY CD (NUM) - CP-COMPANY-CD                              *
    48*  INSURED AGE      - CP-ISSUE-AGE                               *
    49*  RATING METHOD    - CP-EARNING-METHOD                          *
    50*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    51*  A.P.R.           - CP-LOAN-APR                                *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    54*  TERM OR EXT DAYS - CP-TERM-OR-EXT-DAYS                        *
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page   3
* ELRATE.cbl
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  ELRATE  WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '***********VMOD 2.012 **********'.
    65
    66***  Y2K PROJ 7744
    67 01  WS-HOLD-RATE-EXP.
    68     05  WS-HOLD-RATE-EXP-AL PIC X(11).
    69     05  WS-HOLD-RATE-EXP-DT REDEFINES
    70         WS-HOLD-RATE-EXP-AL PIC 9(11).
    71***  Y2K PROJ 7744
    72
    73*                            COPY ELCRATWS.
    74******************************************************************
    75*                                                                *
    76*                                                                *
    77*                            ELCRATWS.                           *
    78*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    79*                            VMOD=2.010                          *
    80*                                                                *
    81******************************************************************
    82
    83 01  STANDARD-AREAS.
    84     12  ER-STATUS               PIC XX.
    85     12  WS-BROWSE-SW            PIC X       VALUE SPACE.
    86         88 WS-BROWSE-STARTED                VALUE 'Y'.
    87     12  WS-PREMIUM-RATE         PIC S99V9(5) COMP-3 VALUE ZERO.
    88     12  WS-FARM-TERM            PIC S9(3)    COMP-3 VALUE ZERO.
    89     12  OERATE-FILE-ID          PIC X(8)    VALUE 'OERATE'.
    90     12  ERRATE-FILE-ID          PIC X(8)    VALUE 'ERRATE'.
    91     12  ERRATE-KEY.
    92         16  RATE-COMPANY-CD     PIC X        VALUE SPACE.
    93         16  RATE-STATE-CODE.
    94             20  RATE-ST-CODE    PIC  XX      VALUE SPACES.
    95             20  RATE-ST-CLASS   PIC  XX      VALUE SPACES.
    96             20  RATE-ST-DEV     PIC  XXX     VALUE SPACES.
    97         16  RATE-L-AH-CODE.
    98             20  RATE-L-AH       PIC  X       VALUE SPACE.
    99             20  RATE-LAH-NUM    PIC  XX      VALUE ZEROS.
   100         16  RATE-LIMITS.
   101             20  RATE-HIGH-AGE   PIC  99      VALUE ZEROS.
   102             20  RATE-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   103             20  RATE-FUTURE     PIC  XX      VALUE SPACES.
   104             20  RATE-SEX        PIC  X       VALUE '9'.
   105         16  RATE-EXPIRY-DATE    PIC 9(11)    COMP-3.
   106
   107     12  SAVE-ERRATE-KEY.
   108         16  SVRT-COMPANY-CD     PIC X        VALUE SPACE.
   109         16  SVRT-STATE-CODE.
   110             20  SVRT-ST-CODE    PIC  XX      VALUE SPACES.
   111             20  SVRT-ST-CLASS   PIC  XX      VALUE SPACES.
   112             20  SVRT-ST-DEV     PIC  XXX     VALUE SPACES.
   113         16  SVRT-L-AH-CODE.
   114             20  SVRT-L-AH       PIC  X       VALUE SPACE.
   115             20  SVRT-LAH-NUM    PIC  XX      VALUE ZEROS.
   116         16  SVRT-LIMITS.
   117             20  SVRT-HIGH-AGE   PIC  99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page   4
* ELRATE.cbl
   118             20  SVRT-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   119             20  SVRT-FUTURE     PIC  XX      VALUE SPACES.
   120             20  SVRT-SEX        PIC  X       VALUE '9'.
   121         16  SVRT-EXPIRY-DATE    PIC  9(11)   COMP-3.
   122
   123     12  WS-SIN-PREM-RATE        PIC S99V9(07) VALUE +0.
   124     12  WS-TERM-MINUS-ONE       PIC S9(5)    COMP-3 VALUE +0.
   125
   126 01  CSL-WORK-AREAS          COMP-3.
   127     12  WK-C                PIC S9(3)V9(9)     VALUE ZEROS.
   128     12  WK-D                PIC S9(4)V9(9)     VALUE ZEROS.
   129     12  WK-J                PIC S999           VALUE ZEROS.
   130     12  WK-K                PIC S999           VALUE ZEROS.
   131     12  WK-L                PIC S99V9(9)       VALUE ZEROS.
   132     12  WK-S                PIC S999V9(4)      VALUE ZEROS.
   133     12  WK-T                PIC S999           VALUE ZEROS.
   134     12  WK-T1               PIC S999           VALUE ZEROS.
   135     12  WK-U                PIC S99V9(9)       VALUE ZEROS.
   136     12  WK-PREM             PIC S9(6)V999      VALUE ZEROS.
   137     12  WK-PAY-AMT          PIC S9(7)V99       VALUE ZEROS.
   138     12  WK-LEV-RATE         PIC S99V9(7)       VALUE ZEROS.
   139     12  WK-RED-RATE         PIC S99V9(7)       VALUE ZEROS.
   140     12  WK-DAILY-RATE       PIC S99V9(7)       VALUE ZEROS.
   141     12  WK-MONTHLY-RATE     PIC S99V9(7)       VALUE ZEROS.
   142     12  WK-MONTHLY-RATE-T   PIC S99V9(7)       VALUE ZEROS.
   143     12  WK-MONTHLY-RATE-J   PIC S99V9(7)       VALUE ZEROS.
   144     12  WS-MAX-TOT-BEN      PIC S9(7)V99       VALUE ZEROS.
   145     12  WS-MAX-MON-BEN      PIC S9(7)V99       VALUE ZEROS.
   146     12  WS-NUM-PAYMTS       PIC S9(5)          VALUE ZEROS.
   147     12  WS-PAY-SCH          PIC S99            VALUE ZEROS.
   148
   149 01  TEXAS-REG-WORK-AREAS.
   150     12  TEX-FACT-1          PIC S9(7)V99    COMP-3.
   151     12  TEX-FACT-2          PIC S9(3)       COMP-3.
   152     12  TEX-FACT-3          PIC S9(3)       COMP-3.
   153     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   154     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   155     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   156     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   157     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   158     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   159
   160 01  NET-PAY-INTERFACE.
   161     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   162     12  N-P-ORIG            PIC S9(3)       COMP-3.
   163     12  N-P-REM             PIC S9(3)       COMP-3.
   164     12  N-P-OPT             PIC X.
   165     12  N-P-LOAN            PIC S9(3)       COMP-3.
   166     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   167
   168
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page   5
* ELRATE.cbl
   170*                            COPY ERCNETWS.
   171*****************************************************************
   172*                                                               *
   173*                                                               *
   174*                            ERCNETWS                           *
   175*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   176*                            VMOD=2.014                         *
   177*                                                               *
   178*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS *
   179*                                                               *
   180*****************************************************************.
   181*                   C H A N G E   L O G
   182*
   183* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   184*-----------------------------------------------------------------
   185*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   186* EFFECTIVE    NUMBER
   187*-----------------------------------------------------------------
   188* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   189* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   190* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   191* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   192******************************************************************
   193
   194 01  NET-PAY-WORK-AREA.
   195     12  OPTION-SW               PIC X   VALUE 'X'.
   196        88  NPO-STD         VALUE SPACE.
   197        88  NPO-ALT         VALUE 'A'.
   198        88  NPO-SIMPLE      VALUE 'S'.
   199        88  NPO-2MO         VALUE 'I'.
   200        88  NPO-3MO         VALUE 'J'.
   201        88  NPO-4MO         VALUE 'K'.
   202        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.
   203        88  NPO-TRUNC-0     VALUE 'T'.
   204        88  NPO-TRUNC-1     VALUE 'U'.
   205        88  NPO-TRUNC-2     VALUE 'V'.
   206        88  NPO-TRUNC-3     VALUE 'W'.
   207        88  NPO-TRUNC-4     VALUE 'X'.
   208        88  NPO-REFUND      VALUE 'R'.
   209        88  NPO-PRUDENTIAL  VALUE 'P'.
   210
   211     12  TYPE-SW             PIC X   VALUE 'N'.
   212        88  NET-STD             VALUE 'N'.
   213        88  NET-SMP             VALUE 'S'.
   214
   215     12  NP-PROCESS-SW       PIC X   VALUE '1'.
   216        88  NP-RATING           VALUE '1'.
   217        88  NP-REFUND           VALUE '2'.
   218        88  NP-REMAIN-AMT       VALUE '3'.
   219
   220     12  COMP-3-WORK-AREA         COMP-3.
   221         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.
   222         16  V               PIC SV9(13)       VALUE +.0.
   223         16  J               PIC SV9(9)        VALUE +0.
   224         16  K               PIC SV9(9)        VALUE +0.
   225         16  I               PIC SV9(10)       VALUE +.0.
   226         16  D               PIC S9(5)         VALUE +.0.
   227         16  APR100          PIC SV9(9)        VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page   6
* ELRATE.cbl
   228         16  RA              PIC S9(6)V9(9)    VALUE +.0.
   229         16  WK1             PIC S9(4)V9(13)   VALUE +.0.
   230         16  WK2             PIC S9(4)V9(13)   VALUE +.0.
   231         16  WK3             PIC S9(7)V9(10)   VALUE +.0.
   232         16  WK4             PIC S9(7)V9(8)    VALUE +.0.
   233         16  WK5             PIC S9(5)V9(13)   VALUE +.0.
   234         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.
   235         16  WK6             PIC S9(7)V9(10)   VALUE +.0.
   236         16  WK7             PIC S9(7)V9(10)   VALUE +.0.
   237         16  WK8             PIC S9(3)V9(10)   VALUE +.0.
   238         16  WK9             PIC S9(3)V9(10)   VALUE +.0.
   239         16  GR              PIC S9(7)V9(10)   VALUE +.0.
   240         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.
   241         16  ODF             PIC S9(3)V9(10)   VALUE +.0.
   242         16  OD              PIC S9(3)V9(10)   VALUE +.0.
   243         16  FM              PIC S9(3)V9(10)   VALUE +.0.
   244         16  FN              PIC S9(3)V9(10)   VALUE +.0.
   245         16  FNM             PIC S9(3)V9(10)   VALUE +.0.
   246         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.
   247         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.
   248         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.
   249         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.
   250         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.
   251         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.
   252         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.
   253         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.
   254         16  K1              PIC S999          VALUE +1.
   255         16  K12             PIC S999          VALUE +12.
   256         16  K100            PIC S999          VALUE +100.
   257         16  K1000           PIC S9(7)         VALUE +1000.
   258         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.
   259         16  Y REDEFINES NC-LR
   260                             PIC S99V9(5).
   261         16  TI              PIC S999V9(5)     VALUE +0.
   262         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.
   263         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.
   264         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.
   265         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.
   266         16  NC-BIG-D        PIC S9(3)         VALUE +030.
   267         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.
   268         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.
   269         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.
   270
   271         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.
   272         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.
   273         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.
   274         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.
   275         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.
   276         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.
   277         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.
   278         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.
   279         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.
   280         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.
   281         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.
   282         16  GTL-IA-SGN      PIC S9            VALUE +.0.
   283         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.
   284
   285         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page   7
* ELRATE.cbl
   286
   287         16  ORIGINAL-TERM   PIC S999.
   288         16  M              REDEFINES ORIGINAL-TERM
   289                             PIC S999.
   290
   291         16  REMAINING-TERM  PIC S999.
   292         16  R              REDEFINES REMAINING-TERM
   293                             PIC S999.
   294
   295         16  LOAN-TERM       PIC S999.
   296         16  N              REDEFINES LOAN-TERM
   297                             PIC S999.
   298
   299         16  EXPIRED-TERM    PIC S999.
   300         16  E              REDEFINES EXPIRED-TERM
   301                             PIC S999.
   302
   303         16  PRUDENTIAL-WORK-AMT
   304                             PIC S9(7)V9(8).
   305         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT
   306                             PIC S9(7)V9(8).
   307
   308         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.
   309         16  VX              PIC S9V9(13)      VALUE +0.0.
   310         16  SV              PIC S9V9(13)      VALUE +0.0.
   311         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.
   312         16  SX              PIC S9V9(13)      VALUE +0.0.
   313         16  SE              PIC S9V9(10)      VALUE +0.0.
   314         16  N2              PIC S9(7)         VALUE +0.
   315         16  N3              PIC S9(7)         VALUE +0.
   316         16  K-I             PIC S9V9(8)       VALUE +0.0.
   317
   318     12  BINARY-WORK-AREA        COMP.
   319         16  X1              PIC S999        VALUE +0.
   320         16  X2              PIC S999        VALUE +0.
   321         16  MAX-X           PIC S9(5)       VALUE +0.
   322         16  B1              PIC S9(5)       VALUE +1.
   323         16  LINDX           PIC S999        VALUE ZEROS.
   324         16  AHNDX           PIC S999        VALUE ZEROS.
   325
   326     12  CSO-RATE-WORK-AREAS.
   327         16  C-PMTS-PER-YEAR     PIC S999 COMP-3 VALUE ZEROS.
   328         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   329         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   330     12  WS-WORK-MISC.
   331         16  NET-BEN             PIC S9(9)V9999   COMP-3.
   332         16  WS-RATE-TERM        PIC S9(3)        COMP-3.
   333*        16  WS-AGE              PIC 99           VALUE ZEROS.
   334         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
   335         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.
   336         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.
   337         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.
   338         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.
   339         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.
   340         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.
   341         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   342         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   343         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page   8
* ELRATE.cbl
   344         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0.
   345         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0.
   346******************************************************************
   347
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page   9
* ELRATE.cbl
   349*                            COPY ELCDATE.
   350******************************************************************
   351*                                                                *
   352*                                                                *
   353*                            ELCDATE.                            *
   354*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   355*                            VMOD=2.003
   356*                                                                *
   357*                                                                *
   358*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   359*                 LENGTH = 200                                   *
   360******************************************************************
   361
   362 01  DATE-CONVERSION-DATA.
   363     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   364     12  DC-OPTION-CODE                PIC X.
   365         88  BIN-TO-GREG                VALUE ' '.
   366         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   367         88  EDIT-GREG-TO-BIN           VALUE '2'.
   368         88  YMD-GREG-TO-BIN            VALUE '3'.
   369         88  MDY-GREG-TO-BIN            VALUE '4'.
   370         88  JULIAN-TO-BIN              VALUE '5'.
   371         88  BIN-PLUS-ELAPSED           VALUE '6'.
   372         88  FIND-CENTURY               VALUE '7'.
   373         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   374         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   375         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   376         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   377         88  JULIAN-TO-BIN-3            VALUE 'C'.
   378         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   379         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   380         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   381         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   382         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   383         88  CHECK-LEAP-YEAR            VALUE 'H'.
   384         88  BIN-3-TO-GREG              VALUE 'I'.
   385         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   386         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   387         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   388         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   389         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   390         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   391         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   392         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   393         88  THREE-CHARACTER-BIN
   394                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   395         88  GREGORIAN-TO-BIN
   396                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   397         88  BIN-TO-GREGORIAN
   398                  VALUES ' ' '1' 'I' '8' 'G'.
   399         88  JULIAN-TO-BINARY
   400                  VALUES '5' 'C' 'E' 'F'.
   401     12  DC-ERROR-CODE                 PIC X.
   402         88  NO-CONVERSION-ERROR        VALUE ' '.
   403         88  DATE-CONVERSION-ERROR
   404                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   405         88  DATE-IS-ZERO               VALUE '1'.
   406         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  10
* ELRATE.cbl
   407         88  DATE-IS-INVALID            VALUE '3'.
   408         88  DATE1-GREATER-DATE2        VALUE '4'.
   409         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   410         88  DATE-INVALID-OPTION        VALUE '9'.
   411         88  INVALID-CENTURY            VALUE 'A'.
   412         88  ONLY-CENTURY               VALUE 'B'.
   413         88  ONLY-LEAP-YEAR             VALUE 'C'.
   414         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   415     12  DC-END-OF-MONTH               PIC X.
   416         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   417     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   418         88  USE-NORMAL-PROCESS         VALUE ' '.
   419         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   420         88  ADJUST-UP-100-YRS          VALUE '2'.
   421     12  FILLER                        PIC X.
   422     12  DC-CONVERSION-DATES.
   423         16  DC-BIN-DATE-1             PIC XX.
   424         16  DC-BIN-DATE-2             PIC XX.
   425         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   426         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   427                       DC-GREG-DATE-1-EDIT.
   428             20  DC-EDIT1-MONTH        PIC 99.
   429             20  SLASH1-1              PIC X.
   430             20  DC-EDIT1-DAY          PIC 99.
   431             20  SLASH1-2              PIC X.
   432             20  DC-EDIT1-YEAR         PIC 99.
   433         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   434         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   435                     DC-GREG-DATE-2-EDIT.
   436             20  DC-EDIT2-MONTH        PIC 99.
   437             20  SLASH2-1              PIC X.
   438             20  DC-EDIT2-DAY          PIC 99.
   439             20  SLASH2-2              PIC X.
   440             20  DC-EDIT2-YEAR         PIC 99.
   441         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   442         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   443                     DC-GREG-DATE-1-YMD.
   444             20  DC-YMD-YEAR           PIC 99.
   445             20  DC-YMD-MONTH          PIC 99.
   446             20  DC-YMD-DAY            PIC 99.
   447         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   448         16  DC-GREG-DATE-1-MDY-R REDEFINES
   449                      DC-GREG-DATE-1-MDY.
   450             20  DC-MDY-MONTH          PIC 99.
   451             20  DC-MDY-DAY            PIC 99.
   452             20  DC-MDY-YEAR           PIC 99.
   453         16  DC-GREG-DATE-1-ALPHA.
   454             20  DC-ALPHA-MONTH        PIC X(10).
   455             20  DC-ALPHA-DAY          PIC 99.
   456             20  FILLER                PIC XX.
   457             20  DC-ALPHA-CENTURY.
   458                 24 DC-ALPHA-CEN-N     PIC 99.
   459             20  DC-ALPHA-YEAR         PIC 99.
   460         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   461         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   462         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   463         16  DC-JULIAN-DATE            PIC 9(05).
   464         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  11
* ELRATE.cbl
   465                                       PIC 9(05).
   466         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   467             20  DC-JULIAN-YEAR        PIC 99.
   468             20  DC-JULIAN-DAYS        PIC 999.
   469         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   470         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   471         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   472     12  DATE-CONVERSION-VARIBLES.
   473         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   474         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   475             20  FILLER                PIC 9(3).
   476             20  HOLD-CEN-1-CCYY.
   477                 24  HOLD-CEN-1-CC     PIC 99.
   478                 24  HOLD-CEN-1-YY     PIC 99.
   479             20  HOLD-CEN-1-MO         PIC 99.
   480             20  HOLD-CEN-1-DA         PIC 99.
   481         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   482             20  HOLD-CEN-1-R-MO       PIC 99.
   483             20  HOLD-CEN-1-R-DA       PIC 99.
   484             20  HOLD-CEN-1-R-CCYY.
   485                 24  HOLD-CEN-1-R-CC   PIC 99.
   486                 24  HOLD-CEN-1-R-YY   PIC 99.
   487             20  FILLER                PIC 9(3).
   488         16  HOLD-CENTURY-1-X.
   489             20  FILLER                PIC X(3)  VALUE SPACES.
   490             20  HOLD-CEN-1-X-CCYY.
   491                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   492                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   493             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   494             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   495         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   496             20  HOLD-CEN-1-R-X-MO     PIC XX.
   497             20  HOLD-CEN-1-R-X-DA     PIC XX.
   498             20  HOLD-CEN-1-R-X-CCYY.
   499                 24  HOLD-CEN-1-R-X-CC PIC XX.
   500                 24  HOLD-CEN-1-R-X-YY PIC XX.
   501             20  FILLER                PIC XXX.
   502         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   503         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   504         16  DC-JULIAN-DATE-1          PIC 9(07).
   505         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   506             20  DC-JULIAN-1-CCYY.
   507                 24  DC-JULIAN-1-CC    PIC 99.
   508                 24  DC-JULIAN-1-YR    PIC 99.
   509             20  DC-JULIAN-DA-1        PIC 999.
   510         16  DC-JULIAN-DATE-2          PIC 9(07).
   511         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   512             20  DC-JULIAN-2-CCYY.
   513                 24  DC-JULIAN-2-CC    PIC 99.
   514                 24  DC-JULIAN-2-YR    PIC 99.
   515             20  DC-JULIAN-DA-2        PIC 999.
   516         16  DC-GREG-DATE-A-EDIT.
   517             20  DC-EDITA-MONTH        PIC 99.
   518             20  SLASHA-1              PIC X VALUE '/'.
   519             20  DC-EDITA-DAY          PIC 99.
   520             20  SLASHA-2              PIC X VALUE '/'.
   521             20  DC-EDITA-CCYY.
   522                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  12
* ELRATE.cbl
   523                 24  DC-EDITA-YEAR     PIC 99.
   524         16  DC-GREG-DATE-B-EDIT.
   525             20  DC-EDITB-MONTH        PIC 99.
   526             20  SLASHB-1              PIC X VALUE '/'.
   527             20  DC-EDITB-DAY          PIC 99.
   528             20  SLASHB-2              PIC X VALUE '/'.
   529             20  DC-EDITB-CCYY.
   530                 24  DC-EDITB-CENT     PIC 99.
   531                 24  DC-EDITB-YEAR     PIC 99.
   532         16  DC-GREG-DATE-CYMD         PIC 9(08).
   533         16  DC-GREG-DATE-CYMD-R REDEFINES
   534                              DC-GREG-DATE-CYMD.
   535             20  DC-CYMD-CEN           PIC 99.
   536             20  DC-CYMD-YEAR          PIC 99.
   537             20  DC-CYMD-MONTH         PIC 99.
   538             20  DC-CYMD-DAY           PIC 99.
   539         16  DC-GREG-DATE-MDCY         PIC 9(08).
   540         16  DC-GREG-DATE-MDCY-R REDEFINES
   541                              DC-GREG-DATE-MDCY.
   542             20  DC-MDCY-MONTH         PIC 99.
   543             20  DC-MDCY-DAY           PIC 99.
   544             20  DC-MDCY-CEN           PIC 99.
   545             20  DC-MDCY-YEAR          PIC 99.
   546    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   547        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   548    12  DC-EL310-DATE                  PIC X(21).
   549    12  FILLER                         PIC X(28).
   550
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  13
* ELRATE.cbl
   552*                            COPY ELCCALC.
   553******************************************************************
   554*                                                                *
   555*                           ELCCALC.                            *
   556*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   557*                            VMOD=2.025                          *
   558*                                                                *
   559*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   560*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   561*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   562*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   563*                                                                *
   564*  PASSED TO ELRTRM                                              *
   565*  -----------------                                             *
   566*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   567*  ORIGINAL TERM                                                 *
   568*  BEGINNING DATE                                                *
   569*  ENDING DATE                                                   *
   570*  COMPANY I.D.                                                  *
   571*  ACCOUNT MASTER USER FIELD                                     *
   572*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   573*  FREE LOOK DAYS                                                *
   574*                                                                *
   575*  RETURNED FROM ELRTRM                                          *
   576*  ---------------------                                         *
   577*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   578*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   579*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   580*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   581*----------------------------------------------------------------*
   582*  PASSED TO ELRAMT                                              *
   583*  ----------------                                              *
   584*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   585*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   586*  ORIGINAL AMOUNT                                               *
   587*  ALTERNATE BENEFIT (BALLON)                                    *
   588*  A.P.R. - NET PAY ONLY                                         *
   589*  METHOD
   590*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   591*  COMPANY I.D.                                                  *
   592*  BENEFIT TYPE                                                  *
   593*                                                                *
   594*  RETURNED FROM ELRAMT                                          *
   595*  --------------------                                          *
   596*  REMAINING AMOUNT 1 - CURRENT                                  *
   597*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   598*  REMAINING AMOUNT FACTOR
   599*----------------------------------------------------------------*
   600*  PASSED TO ELRESV                                              *
   601*  -----------------                                             *
   602*  CERTIFICATE EFFECTIVE DATE                                    *
   603*  VALUATION DATE                                                *
   604*  PAID THRU DATE                                                *
   605*  BENEFIT                                                       *
   606*  INCURRED DATE                                                 *
   607*  REPORTED DATE                                                 *
   608*  ISSUE AGE                                                     *
   609*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  14
* ELRATE.cbl
   610*  CDT PERCENT                                                   *
   611*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   612* *CLAIM TYPE (LIFE, A/H)                                        *
   613* *REMAINING BENEFIT (FROM ELRAMT)                               *
   614* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   615*                                                                *
   616*  RETURNED FROM ELRESV                                          *
   617*  --------------------                                          *
   618*  CDT TABLE USED                                                *
   619*  CDT FACTOR USED                                               *
   620*  PAY TO CURRENT RESERVE                                        *
   621*  I.B.N.R. - A/H ONLY                                           *
   622*  FUTURE (ACCRUED) AH ONLY                                      *
   623*----------------------------------------------------------------*
   624*  PASSED TO ELRATE                                              *
   625*  ----------------                                              *
   626*  CERT ISSUE DATE                                               *
   627*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   628*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   629*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   630*  STATE CODE (CLIENT DEFINED)                                   *
   631*  STATE CODE (STANDARD P.O. ABBRV)                              *
   632*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   633*  DEVIATION CODE                                                *
   634*  ISSUE AGE                                                     *
   635*  ORIGINAL BENEFIT AMOUNT                                       *
   636*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   637*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   638*  BENEFIT KIND (LIFE OR A/H)                                    *
   639*  A.P.R.                                                        *
   640*  METHOD
   641*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   642*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   643*  COMPANY I.D. (3 CHARACTER)                                    *
   644*  BENEFIT CODE                                                  *
   645*  BENEFIT OVERRIDE CODE                                         *
   646*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   647*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   648*  JOINT INDICATOR (CSL ONLY)                                    *
   649*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   650*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   651*                                                                *
   652*  RETURNED FROM ELRATE                                          *
   653*  --------------------                                          *
   654*  CALCULATED PREMIUM                                            *
   655*  PREMIUM RATE                                                  *
   656*  MORTALITY CODE                                                *
   657*  MAX ATTAINED AGE                                              *
   658*  MAX AGE                                                       *
   659*  MAX TERM                                                      *
   660*  MAX MONTHLY BENEFIT                                           *
   661*  MAX TOTAL BENIFIT                                             *
   662*  COMPOSITE RATE (OPEN-END ONLY)                                *
   663*----------------------------------------------------------------*
   664*  PASSED TO ELRFND                                              *
   665*  ----------------                                              *
   666*  CERT ISSUE DATE                                               *
   667*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  15
* ELRATE.cbl
   668*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   669*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   670*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   671*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   672*  STATE CODE (CLIENT DEFINED)                                   *
   673*  STATE CODE (STANDARD P.O. ABBRV)                              *
   674*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   675*  DEVIATION CODE                                                *
   676*  ISSUE AGE                                                     *
   677*  ORIGINAL BENEFIT AMOUNT                                       *
   678*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   679*  PROCESS TYPE (CANCEL)                                         *
   680*  BENEFIT KIND (LIFE OR A/H)                                    *
   681*  A.P.R.                                                        *
   682*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   683*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   684*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   685*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   686*  COMPANY I.D. (3 CHARACTER)                                    *
   687*  BENEFIT CODE                                                  *
   688*  BENEFIT OVERRIDE CODE                                         *
   689*                                                                *
   690*  RETURNED FROM ELRFND                                          *
   691*  --------------------                                          *
   692*  CALCULATED REFUND                                             *
   693*----------------------------------------------------------------*
   694*  PASSED TO ELEARN                                              *
   695*  ----------------                                              *
   696*  CERT ISSUE DATE                                               *
   697*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   698*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   699*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   700*  STATE CODE (CLIENT DEFINED)                                   *
   701*  STATE CODE (STANDARD P.O. ABBRV)                              *
   702*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   703*  DEVIATION CODE                                                *
   704*  ISSUE AGE                                                     *
   705*  ORIGINAL BENEFIT AMOUNT                                       *
   706*  BENEFIT KIND (LIFE OR A/H)                                    *
   707*  A.P.R.                                                        *
   708*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   709*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   710*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   711*  COMPANY I.D. (3 CHARACTER)                                    *
   712*  BENEFIT CODE                                                  *
   713*  BENEFIT OVERRIDE CODE                                         *
   714*                                                                *
   715*  RETURNED FROM ELEARN                                          *
   716*  --------------------                                          *
   717*  INDICATED  EARNINGS                                           *
   718*----------------------------------------------------------------*
   719*                 LENGTH = 450                                   *
   720*                                                                *
   721******************************************************************
   722******************************************************************
   723*                   C H A N G E   L O G
   724*
   725* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  16
* ELRATE.cbl
   726*-----------------------------------------------------------------
   727*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   728* EFFECTIVE    NUMBER
   729*-----------------------------------------------------------------
   730* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   731* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   732* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   733* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   734* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   735* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   736* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   737* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   738* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   739******************************************************************
   740
   741 01  CALCULATION-PASS-AREA.
   742     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   743                                     COMP.
   744
   745     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   746       88  NO-CP-ERROR                             VALUE ZERO.
   747       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   748                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   749       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   750       88  CP-ERROR-IN-DATES                       VALUE '2'.
   751       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   752       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   753       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   754       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   755       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   756       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   757       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   758       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   759       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   760       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   761       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   762       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   763       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   764       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   765       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   766
   767     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   768       88  NO-CP-ERROR-2                           VALUE ZERO.
   769***********************  INPUT AREAS ****************************
   770
   771     12  CP-CALCULATION-AREA.
   772         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   773         16  CP-CERT-EFF-DT        PIC XX.
   774         16  CP-VALUATION-DT       PIC XX.
   775         16  CP-PAID-THRU-DT       PIC XX.
   776         16  CP-BENEFIT-TYPE       PIC X.
   777           88  CP-AH                               VALUE 'A' 'D'
   778                                                   'I' 'U'.
   779           88  CP-REDUCING-LIFE                    VALUE 'R'.
   780           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   781         16  CP-INCURRED-DT        PIC XX.
   782         16  CP-REPORTED-DT        PIC XX.
   783         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  17
* ELRATE.cbl
   784         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   785         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   786                                     COMP-3.
   787         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   788                                     COMP-3.
   789         16  CP-CDT-METHOD         PIC X.
   790           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   791           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   792           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   793         16  CP-CLAIM-TYPE         PIC X.
   794           88  CP-AH-CLAIM                         VALUE 'A'.
   795           88  CP-LIFE-CLAIM                       VALUE 'L'.
   796         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   797                                     COMP-3.
   798         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   799                                     COMP-3.
   800         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   801                                     COMP-3.
   802         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   803                                     COMP-3.
   804         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   805                                     COMP-3.
   806         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   807                                     COMP-3.
   808         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   809                                     COMP-3.
   810         16  CP-REM-TERM-METHOD    PIC X.
   811           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   812           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   813           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   814           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   815           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   816           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   817           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   818         16  CP-EARNING-METHOD     PIC X.
   819           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   820           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   821           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   822           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   823           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   824           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   825           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   826           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   827           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   828           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   829           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   830           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   831           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   832           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   833         16  CP-PROCESS-TYPE       PIC X.
   834           88  CP-CLAIM                            VALUE '1'.
   835           88  CP-CANCEL                           VALUE '2'.
   836           88  CP-ISSUE                            VALUE '3'.
   837         16  CP-SPECIAL-CALC-CD    PIC X.
   838           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   839           88  CP-1-MTH-INTEREST               VALUE ' '.
   840           88  CP-0-MTH-INTEREST               VALUE 'A'.
   841           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  18
* ELRATE.cbl
   842           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   843           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   844           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   845           88  CP-FARM-PLAN                    VALUE 'F'.
   846           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   847           88  CP-2-MTH-INTEREST               VALUE 'I'.
   848           88  CP-3-MTH-INTEREST               VALUE 'J'.
   849           88  CP-4-MTH-INTEREST               VALUE 'K'.
   850           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   851           88  CP-MORTGAGE-REC                 VALUE 'M'.
   852           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   853           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   854           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   855           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   856                                                     'W' 'X'.
   857           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   858           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   859           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   860           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   861           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   862           88  CP-SUMMARY-REC                  VALUE 'Z'.
   863           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   864           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   865           88  CP-AD-D-BENEFIT                 VALUE '4'.
   866           88  CP-CSL-METH-1                   VALUE '5'.
   867           88  CP-CSL-METH-2                   VALUE '6'.
   868           88  CP-CSL-METH-3                   VALUE '7'.
   869           88  CP-CSL-METH-4                   VALUE '8'.
   870
   871         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   872                                     COMP-3.
   873         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   874         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   875         16  CP-STATE              PIC XX          VALUE SPACE.
   876         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   877         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   878           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   879               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   880         16  CP-R78-OPTION         PIC X.
   881           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   882           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   883
   884         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   885         16  CP-IBNR-RESERVE-SW    PIC X.
   886         16  CP-CLAIM-STATUS       PIC X.
   887         16  CP-RATE-FILE          PIC X.
   888         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   889                                     COMP-3.
   890
   891         16  CP-LIFE-OVERRIDE-CODE PIC X.
   892         16  CP-AH-OVERRIDE-CODE   PIC X.
   893
   894         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   895                                     COMP-3.
   896         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   897                                   PIC S9(5)V99 COMP-3.
   898         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   899                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  19
* ELRATE.cbl
   900         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   901                                     COMP-3.
   902         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   903                                     COMP-3.
   904         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   905                                  PIC S9(7)V99 COMP-3.
   906
   907         16  CP-PAID-FROM-DATE     PIC X(02).
   908         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   909         16  CP-EXT-DAYS-CALC      PIC X.
   910           88  CP-EXT-NO-CHG                   VALUE ' '.
   911           88  CP-EXT-CHG-LF                   VALUE '1'.
   912           88  CP-EXT-CHG-AH                   VALUE '2'.
   913           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   914         16  CP-DOMICILE-STATE     PIC XX.
   915         16  CP-CARRIER            PIC X.
   916         16  CP-REIN-FLAG          PIC X.
   917         16  CP-REM-TRM-CALC-OPTION PIC X.
   918           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   919                      '2' '3' '4' '5'.
   920           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   921           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   922           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   923           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   924           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   925           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   926           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   927           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   928         16  CP-SIG-SWITCH         PIC X.
   929         16  CP-RATING-METHOD      PIC X.
   930           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   931           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   932           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   933           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   934           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   935           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   936           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   937           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   938           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   939         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   940                                     COMP-3.
   941         16  CP-BEN-CATEGORY       PIC X.
   942         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   943         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   944                                   PIC S99V9(5) COMP-3.
   945         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   946         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   947                                   PIC S99V9(5) COMP-3.
   948         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   949         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   950         16  CP-EXPIRE-DT          PIC XX.
   951         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   952         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   953         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   954         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   955         16  CP-DDF-SPEC-CALC      PIC X.
   956             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   957             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  20
* ELRATE.cbl
   958         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   959         16  CP-CANCEL-REASON      PIC X.
   960         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   961         16  CP-PMT-MODE           PIC X.
   962         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   963         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   964         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   965         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   966         16  FILLER                PIC X.
   967
   968***************    OUTPUT FROM ELRESV   ************************
   969
   970         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   971
   972         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   973                                     COMP-3.
   974         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   975                                     COMP-3.
   976         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   977                                     COMP-3.
   978         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   979                                     COMP-3.
   980         16  FILLER                PIC X(09).
   981***************    OUTPUT FROM ELRTRM   *************************
   982
   983         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   984                                     COMP-3.
   985         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   986                                     COMP-3.
   987         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   988                                     COMP-3.
   989         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   990                                     COMP-3.
   991         16  FILLER                PIC X(12).
   992
   993***************    OUTPUT FROM ELRAMT   *************************
   994
   995         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   996                                     COMP-3.
   997         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   998                                     COMP-3.
   999         16  FILLER                PIC X(12).
  1000
  1001***************    OUTPUT FROM ELRATE   *************************
  1002
  1003         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1004                                     COMP-3.
  1005         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1006                                     COMP-3.
  1007         16  CP-MORTALITY-CODE     PIC X(4).
  1008         16  CP-RATE-EDIT-FLAG     PIC X.
  1009             88  CP-RATES-NEED-APR                  VALUE '1'.
  1010         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1011                                     COMP-3.
  1012         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1013         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1014         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1015                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  21
* ELRATE.cbl
  1016         16  FILLER                PIC X(07).
  1017
  1018***************    OUTPUT FROM ELRFND   *************************
  1019
  1020         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1021                                     COMP-3.
  1022         16  CP-REFUND-TYPE-USED   PIC X.
  1023           88  CP-R-AS-R78                         VALUE '1'.
  1024           88  CP-R-AS-PRORATA                     VALUE '2'.
  1025           88  CP-R-AS-CALIF                       VALUE '3'.
  1026           88  CP-R-AS-TEXAS                       VALUE '4'.
  1027           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1028           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1029           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1030           88  CP-R-AS-MEAN                        VALUE '8'.
  1031           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1032           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1033           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1034           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1035           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1036           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1037         16  FILLER                PIC X(12).
  1038
  1039***************    OUTPUT FROM ELEARN   *************************
  1040
  1041         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1042                                     COMP-3.
  1043         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1044                                     COMP-3.
  1045         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1046                                     COMP-3.
  1047         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1048                                     COMP-3.
  1049         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1050                                     COMP-3.
  1051         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1052                                     COMP-3.
  1053         16  CP-EARNING-TYPE-USED  PIC X.
  1054           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1055           88  CP-E-AS-R78                         VALUE '1'.
  1056           88  CP-E-AS-PRORATA                     VALUE '2'.
  1057           88  CP-E-AS-TEXAS                       VALUE '4'.
  1058           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1059           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1060           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1061           88  CP-E-AS-MEAN                        VALUE '8'.
  1062           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1063         16  FILLER                PIC X(12).
  1064
  1065***************    OUTPUT FROM ELPMNT   *************************
  1066
  1067         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1068                                     COMP-3.
  1069         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1070                                     COMP-3.
  1071         16  FILLER                PIC X(12).
  1072
  1073***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  22
* ELRATE.cbl
  1074         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1075                                     COMP-3.
  1076         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1077                                     COMP-3.
  1078         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1079                                     COMP-3.
  1080         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1081                                     COMP-3.
  1082         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1083                                     COMP-3.
  1084         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1085                                     COMP-3.
  1086         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1087             88  OPEN-RATE-FILE                   VALUE 'O'.
  1088             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1089             88  IO-ERROR                         VALUE 'E'.
  1090
  1091         16  CP-FIRST-PAY-DATE     PIC XX.
  1092
  1093         16  CP-JOINT-INDICATOR    PIC X.
  1094
  1095         16  CP-RESERVE-REMAINING-TERM
  1096                                   PIC S9(4)V9    VALUE ZERO
  1097                                     COMP-3.
  1098
  1099         16  CP-INSURED-BIRTH-DT   PIC XX.
  1100
  1101         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1102                                     COMP-3.
  1103
  1104         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1105                                     COMP-3.
  1106
  1107         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1108                                     COMP-3.
  1109
  1110         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1111                                     COMP-3.
  1112
  1113         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1114                                     COMP-3.
  1115
  1116         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1117                                     COMP-3.
  1118
  1119         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1120                                     COMP-3.
  1121
  1122         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1123             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1124
  1125         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1126                                     COMP-3.
  1127         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1128                                     COMP-3.
  1129         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1130         16  FILLER                PIC X(15).
  1131******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  23
* ELRATE.cbl
  1132
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  24
* ELRATE.cbl
  1134****************************************************************
  1135*
  1136* Copyright (c) 2007 by Clerity Solutions, Inc.
  1137* All rights reserved.
  1138*
  1139****************************************************************
  1140 01  DFHEIV.
  1141   02  DFHEIV0               PIC X(35).
  1142   02  DFHEIV1               PIC X(08).
  1143   02  DFHEIV2               PIC X(08).
  1144   02  DFHEIV3               PIC X(08).
  1145   02  DFHEIV4               PIC X(06).
  1146   02  DFHEIV5               PIC X(04).
  1147   02  DFHEIV6               PIC X(04).
  1148   02  DFHEIV7               PIC X(02).
  1149   02  DFHEIV8               PIC X(02).
  1150   02  DFHEIV9               PIC X(01).
  1151   02  DFHEIV10              PIC S9(7) COMP-3.
  1152   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1153   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1154   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1155   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1156   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1157   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1158   02  DFHEIV17              PIC X(04).
  1159   02  DFHEIV18              PIC X(04).
  1160   02  DFHEIV19              PIC X(04).
  1161   02  DFHEIV20              USAGE IS POINTER.
  1162   02  DFHEIV21              USAGE IS POINTER.
  1163   02  DFHEIV22              USAGE IS POINTER.
  1164   02  DFHEIV23              USAGE IS POINTER.
  1165   02  DFHEIV24              USAGE IS POINTER.
  1166   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1167   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1168   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1169   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1170   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1171   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1172   02  FILLER                PIC X(02).
  1173   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1174   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1175   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1176   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1177   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1178 LINKAGE  SECTION.
  1179*****************************************************************
  1180*                                                               *
  1181* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1182* All rights reserved.                                          *
  1183*                                                               *
  1184*****************************************************************
  1185 01  dfheiblk.
  1186     02  eibtime          pic s9(7) comp-3.
  1187     02  eibdate          pic s9(7) comp-3.
  1188     02  eibtrnid         pic x(4).
  1189     02  eibtaskn         pic s9(7) comp-3.
  1190     02  eibtrmid         pic x(4).
  1191     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  25
* ELRATE.cbl
  1192     02  eibcposn         pic s9(4) comp.
  1193     02  eibcalen         pic s9(4) comp.
  1194     02  eibaid           pic x(1).
  1195     02  eibfiller1       pic x(1).
  1196     02  eibfn            pic x(2).
  1197     02  eibfiller2       pic x(2).
  1198     02  eibrcode         pic x(6).
  1199     02  eibfiller3       pic x(2).
  1200     02  eibds            pic x(8).
  1201     02  eibreqid         pic x(8).
  1202     02  eibrsrce         pic x(8).
  1203     02  eibsync          pic x(1).
  1204     02  eibfree          pic x(1).
  1205     02  eibrecv          pic x(1).
  1206     02  eibsend          pic x(1).
  1207     02  eibatt           pic x(1).
  1208     02  eibeoc           pic x(1).
  1209     02  eibfmh           pic x(1).
  1210     02  eibcompl         pic x(1).
  1211     02  eibsig           pic x(1).
  1212     02  eibconf          pic x(1).
  1213     02  eiberr           pic x(1).
  1214     02  eibrldbk         pic x(1).
  1215     02  eiberrcd         pic x(4).
  1216     02  eibsynrb         pic x(1).
  1217     02  eibnodat         pic x(1).
  1218     02  eibfiller5       pic x(2).
  1219     02  eibresp          pic 9(09) comp.
  1220     02  eibresp2         pic 9(09) comp.
  1221     02  dfheigdj         pic s9(4) comp.
  1222     02  dfheigdk         pic s9(4) comp.
  1223 01  DFHCOMMAREA             PIC X(450).
  1224
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  26
* ELRATE.cbl
  1226*01 PARMLIST              COMP.
  1227*    02  FILLER              PIC S9(8).
  1228*    02  ERRATE-POINTER      PIC S9(8).
  1229
  1230*                                COPY ERCRATE.
  1231******************************************************************
  1232*                                                                *
  1233*                                                                *
  1234*                            ERCRATE                             *
  1235*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1236*                            VMOD=2.008                          *
  1237*                                                                *
  1238*   ONLINE CREDIT SYSTEM                                         *
  1239*                                                                *
  1240*   FILE DESCRIPTION = RATES MASTER FILE                         *
  1241*                                                                *
  1242*   FILE TYPE = VSAM,KSDS                                        *
  1243*   RECORD SIZE = 1765  RECFORM = FIXED                          *
  1244*                                                                *
  1245*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *
  1246*       ALTERNATE PATH = NONE                                    *
  1247*                                                                *
  1248*   LOG = NO                                                     *
  1249*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1250*                                                                *
  1251******************************************************************
  1252
  1253 01  RATE-RECORD.
  1254     12  RT-RECORD-ID                      PIC XX.
  1255         88  VALID-RT-ID                      VALUE 'RT'.
  1256
  1257     12  RT-CONTROL-PRIMARY.
  1258         16  RT-COMPANY-CD                 PIC X.
  1259         16  RT-STATE-CODE.
  1260             20  RT-ST-CODE                PIC XX.
  1261             20  RT-ST-CLASS               PIC XX.
  1262             20  RT-ST-DEV                 PIC XXX.
  1263         16  RT-L-AH-CODE.
  1264             20  RT-L-AH                   PIC X.
  1265             20  RT-LAH-NUM                PIC XX.
  1266         16  RT-LIMITS.
  1267             20  RT-HIGH-AGE               PIC 99.
  1268             20  RT-HIGH-AMT               PIC 9(6).
  1269             20  RT-FUTURE                 PIC XX.
  1270             20  RT-SEX                    PIC X.
  1271         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.
  1272
  1273     12  RT-MAINT-INFORMATION.
  1274         16  RT-LAST-MAINT-DT              PIC XX.
  1275         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1276         16  RT-LAST-MAINT-USER            PIC X(4).
  1277         16  FILLER                        PIC X(10).
  1278
  1279     12  RT-STRUCTURE-COMMENT              PIC X(50).
  1280     12  RT-RATE-COMMENT                   PIC X(50).
  1281
  1282     12  CSL-RESERVED                      PIC X(10).
  1283     12  FILLER                            PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  27
* ELRATE.cbl
  1284
  1285     12  RT-MAX-AGE                        PIC 99.
  1286
  1287     12  RT-LIFE-LIMS-FLDS.
  1288         16  RT-LIFE-MORT-CODE             PIC X(4).
  1289         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.
  1290             20  RT-L-EX-AGE               PIC 99.
  1291             20  RT-L-EX-TERM              PIC S999       COMP-3.
  1292             20  RT-L-EX-FACE              PIC S9(7)      COMP-3.
  1293         16  FILLER                        PIC X(20).
  1294
  1295     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.
  1296         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.
  1297             20  RT-AH-AGE                 PIC 99.
  1298             20  RT-AH-TERM                PIC S999       COMP-3.
  1299             20  RT-AH-BEN-M               PIC S9(5)      COMP-3.
  1300             20  RT-AH-BEN-F               PIC S9(7)      COMP-3.
  1301
  1302     12  RT-LIFE-RATES.
  1303         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3.
  1304
  1305     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.
  1306         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3.
  1307
  1308     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.
  1309
  1310     12  RT-DISCOUNT-OPTION                PIC X.
  1311         88  RT-DO-NOT-USE                     VALUE ' '.
  1312         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.
  1313         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.
  1314
  1315     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.
  1316     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.
  1317
  1318     12  RT-COMPOSITE-OPTION               PIC X.
  1319         88  RT-NO-COMPOSITE                   VALUE ' '.
  1320         88  RT-USE-COMPOSITE-RATE             VALUE '1'.
  1321
  1322     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.
  1323
  1324     12  RT-POLICY-FEE                     PIC S9(3)V99   COMP-3.
  1325     12  FILLER                            PIC X(13).
  1326
  1327     12  RT-TYPE-RATE                      PIC X.
  1328         88  RT-IS-STND                        VALUE ' ' 'S'.
  1329         88  RT-IS-OB                          VALUE 'O'.
  1330
  1331     12  RT-SRT-ALPHA                      PIC X.
  1332
  1333     12  RT-CONTROL-2.
  1334         16  RTC-1                         PIC X(7).
  1335         16  RTC-3                         PIC X(11).
  1336         16  RTC-4                         PIC 9(11) COMP-3.
  1337         16  RTC-2                         PIC X(3).
  1338******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  28
* ELRATE.cbl
  1340 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA RATE-RECORD.
  1341 0000-DFHEXIT SECTION.
  1342     MOVE '9#                    $   ' TO DFHEIV0.
  1343     MOVE 'ELRATE' TO DFHEIV1.
  1344     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1345
  1346     MOVE DFHCOMMAREA            TO  CALCULATION-PASS-AREA.
  1347
  1348 000-START-PREMIUM-CALC.
  1349     MOVE ZERO                   TO CP-RETURN-CODE
  1350                                    CP-CALC-PREMIUM
  1351                                    CP-PREMIUM-RATE
  1352                                    CP-POLICY-FEE.
  1353
  1354     MOVE SPACES                 TO CP-MORTALITY-CODE.
  1355     MOVE ALL '9'                TO ERRATE-KEY.
  1356
  1357*    IF CP-RATE-FILE = 'O'
  1358*        MOVE OERATE-FILE-ID     TO ERRATE-FILE-ID.
  1359
  1360     MOVE CP-COMPANY-CD          TO RATE-COMPANY-CD.
  1361     MOVE CP-STATE               TO RATE-ST-CODE.
  1362     MOVE CP-CLASS-CODE          TO RATE-ST-CLASS.
  1363     MOVE CP-DEVIATION-CODE      TO RATE-ST-DEV.
  1364     MOVE CP-ISSUE-AGE           TO RATE-HIGH-AGE.
  1365
  1366     IF CP-RATING-BENEFIT-AMT NOT NUMERIC  OR
  1367        CP-RATING-BENEFIT-AMT = ZEROS
  1368         MOVE CP-ORIGINAL-BENEFIT    TO RATE-HIGH-AMT
  1369     ELSE
  1370         MOVE CP-RATING-BENEFIT-AMT  TO RATE-HIGH-AMT.
  1371
  1372     IF CP-AH
  1373         MOVE CP-AH-OVERRIDE-CODE     TO RATE-L-AH
  1374     ELSE
  1375         MOVE CP-LIFE-OVERRIDE-CODE   TO RATE-L-AH.
  1376
  1377     MOVE CP-BENEFIT-CD          TO RATE-LAH-NUM.
  1378     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1379     MOVE SPACE                  TO DC-OPTION-CODE.
  1380
  1381     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1382
  1383*** Y2K, PROJ 7744
  1384     IF NO-CONVERSION-ERROR
  1385         MOVE ZEROS                 TO RATE-EXPIRY-DATE
  1386                                       WS-HOLD-RATE-EXP-DT
  1387         MOVE DC-GREG-DATE-CYMD     TO WS-HOLD-RATE-EXP-AL(4:8)
  1388         MOVE WS-HOLD-RATE-EXP-DT   TO RATE-EXPIRY-DATE
  1389         MOVE ERRATE-KEY            TO SAVE-ERRATE-KEY
  1390     ELSE
  1391         MOVE '2'                   TO CP-RETURN-CODE
  1392         GO TO 9999-CALC-RATE-PREM-X
  1393     END-IF.
  1394*** Y2K, PROJ 7744
  1395
  1396
  1397* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  29
* ELRATE.cbl
  1398*        NOTFND   (9999-RATE-NOTFND)
  1399*        NOTOPEN  (9999-RATE-NOTOPEN)
  1400*        ENDFILE  (9999-RATE-NOTFND)
  1401*    END-EXEC.
  1402*    MOVE '"$IJ''                 ! " #00001392' TO DFHEIV0
  1403     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  1404     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1405     MOVE X'2220233030303031333932' TO DFHEIV0(25:11)
  1406     CALL 'kxdfhei1' USING DFHEIV0
  1407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1408
  1409
  1410 0050-RATE-START-BROWSE.
  1411
  1412* EXEC CICS STARTBR
  1413*        DATASET  (ERRATE-FILE-ID)
  1414*        RIDFLD   (ERRATE-KEY)
  1415*        GTEQ
  1416*    END-EXEC.
  1417     MOVE 0
  1418       TO DFHEIV11
  1419*    MOVE '&,         G          &   #00001399' TO DFHEIV0
  1420     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1421     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1422     MOVE X'2020233030303031333939' TO DFHEIV0(25:11)
  1423     CALL 'kxdfhei1' USING DFHEIV0,
  1424           ERRATE-FILE-ID,
  1425           ERRATE-KEY,
  1426           DFHEIV99,
  1427           DFHEIV11,
  1428           DFHEIV99
  1429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1430
  1431
  1432     MOVE 'Y'                  TO WS-BROWSE-SW.
  1433
  1434 0100-READ-RATE-LOOP.
  1435
  1436* EXEC CICS READNEXT
  1437*        DATASET  (ERRATE-FILE-ID)
  1438*        SET      (ADDRESS OF RATE-RECORD)
  1439*        RIDFLD   (ERRATE-KEY)
  1440*    END-EXEC.
  1441     MOVE 0
  1442       TO DFHEIV11
  1443*    MOVE '&.S                   )   #00001408' TO DFHEIV0
  1444     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1445     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1446     MOVE X'2020233030303031343038' TO DFHEIV0(25:11)
  1447     CALL 'kxdfhei1' USING DFHEIV0,
  1448           ERRATE-FILE-ID,
  1449           DFHEIV20,
  1450           DFHEIV99,
  1451           ERRATE-KEY,
  1452           DFHEIV99,
  1453           DFHEIV11,
  1454           DFHEIV99,
  1455           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  30
* ELRATE.cbl
  1456     SET ADDRESS OF RATE-RECORD TO
  1457         DFHEIV20
  1458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1459
  1460
  1461 0110-CHECK-KEYS.
  1462*                            COPY ELCRATPD.
  1463******************************************************************
  1464*                                                                *
  1465*                                                                *
  1466*                            ELCRATPD                            *
  1467*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1468*                            VMOD=2.061                          *
  1469*                                                                *
  1470******************************************************************
  1471******************************************************************
  1472*                   C H A N G E   L O G
  1473*
  1474* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1475*-----------------------------------------------------------------
  1476*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1477* EFFECTIVE    NUMBER
  1478*-----------------------------------------------------------------
  1479* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  1480* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  1481* 032603                   PEMA  ADD SPECIAL AZ CALC
  1482* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  1483* 120403                   PEMA  ADD SPECIAL TX CALC
  1484* 092205                   PEMA  FIX CRIT PER FOR DCC
  1485* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  1486* 021207                   PEMA  ADD PA NP
  1487* 022107                   PEMA  ADD NH NP AND NP TRUNC
  1488* 032807                   PEMA  ADD VT NP PLUS 2
  1489* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  1490* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  1491* 060909    2008042300002  PEMA  ADD NEW FARM PLAN CALC
  1492* 010410    2008021200005  PEMA  ADD MN NET PAY BALLOON
  1493* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1494* 040610  CR2010010400006  PEMA  ADD IN TO VT CODE
  1495* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1496* 071211    2010012700001  PEMA  ADD SPPDD
  1497* 071511    2011021500001  PEMA  ADD CODE FOR DCC 10C
  1498* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  1499* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1500* 032612  CR2011110200001  PEMA  AHL CHANGES
  1501* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  1502******************************************************************
  1503
  1504 0110-CHECK-KEY.
  1505     IF SVRT-COMPANY-CD = RT-COMPANY-CD  AND
  1506        SVRT-ST-CODE    = RT-ST-CODE     AND
  1507        SVRT-ST-CLASS   = RT-ST-CLASS    AND
  1508        SVRT-ST-DEV     = RT-ST-DEV      AND
  1509        SVRT-L-AH       = RT-L-AH        AND
  1510        SVRT-LAH-NUM    = RT-LAH-NUM
  1511         NEXT SENTENCE
  1512     ELSE
  1513         GO TO 9999-RATE-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  31
* ELRATE.cbl
  1514
  1515     IF  SVRT-HIGH-AGE GREATER RT-HIGH-AGE
  1516         GO TO 9999-RATE-NOTFND.
  1517
  1518     IF SVRT-HIGH-AMT NOT LESS THAN RT-HIGH-AMT
  1519        GO TO 0100-READ-RATE-LOOP.
  1520
  1521     IF SVRT-EXPIRY-DATE GREATER RT-EXPIRY-DATE
  1522         GO TO 0100-READ-RATE-LOOP.
  1523
  1524     IF SVRT-EXPIRY-DATE = RT-EXPIRY-DATE
  1525         GO TO 0100-READ-RATE-LOOP.
  1526
  1527     IF RT-MAX-AGE = ZEROS
  1528         NEXT SENTENCE
  1529     ELSE
  1530         COMPUTE WS-AGE =
  1531             (CP-ISSUE-AGE + (CP-ORIGINAL-TERM / 12))
  1532         IF WS-AGE >= RT-MAX-AGE
  1533             MOVE 'B'               TO CP-RETURN-CODE.
  1534
  1535     IF CP-LOAN-TERM NOT NUMERIC
  1536         MOVE +0                    TO CP-LOAN-TERM.
  1537
  1538     IF CP-LOAN-TERM = ZERO
  1539         MOVE CP-ORIGINAL-TERM      TO CP-LOAN-TERM.
  1540
  1541     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1542         MOVE +0                    TO CP-TERM-OR-EXT-DAYS.
  1543
  1544     MOVE CP-R-MAX-MON-BEN          TO WS-MAX-MON-BEN.
  1545     MOVE CP-R-MAX-TOT-BEN          TO WS-MAX-TOT-BEN.
  1546
  1547     IF CP-AH
  1548         GO TO 2000-TYPE-IS-AH.
  1549
  1550     IF ((RT-IS-OB)
  1551        AND (CP-COMPANY-ID NOT EQUAL 'CID'))
  1552                      OR
  1553        ((CP-COMPANY-ID = 'DCC')
  1554        AND (CP-BENEFIT-CD (1:1) = 'P'))
  1555        MOVE CP-LOAN-TERM        TO WS-RATE-TERM
  1556     ELSE
  1557        MOVE CP-ORIGINAL-TERM TO WS-RATE-TERM
  1558     END-IF
  1559
  1560     MOVE CP-CERT-EFF-DT            TO DC-BIN-DATE-1.
  1561     MOVE SPACE                     TO DC-OPTION-CODE.
  1562
  1563     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1564
  1565 1000-TYPE-IS-LIFE.
  1566     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  1567
  1568     MOVE ZERO                      TO CP-R-MAX-AGE
  1569                                       CP-R-MAX-TERM
  1570                                       CP-R-MAX-MON-BEN
  1571                                       CP-R-MAX-TOT-BEN.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  32
* ELRATE.cbl
  1572
  1573     MOVE RT-LIFE-MORT-CODE         TO CP-MORTALITY-CODE.
  1574
  1575     IF RT-POLICY-FEE NUMERIC
  1576        MOVE RT-POLICY-FEE          TO CP-POLICY-FEE.
  1577
  1578     MOVE RT-DISCOUNT-OPTION     TO WS-DISCOUNT-OPTION.
  1579
  1580     IF (RT-DISCOUNT-OPTION EQUAL
  1581                     '1' OR '2' OR '3' OR '4' OR '5') AND
  1582        (RT-DISCOUNT-OB-RATE NUMERIC)         AND
  1583        (RT-DISCOUNT-OB-RATE GREATER THAN +0)
  1584         NEXT SENTENCE
  1585     ELSE
  1586         IF (RT-DISCOUNT-OPTION EQUAL '6') AND
  1587            (CP-STATE-STD-ABBRV EQUAL 'CA')
  1588             IF RT-DISCOUNT-RATE GREATER THAN ZERO
  1589                 COMPUTE CA-DISCOUNT = RT-DISCOUNT-RATE / 100
  1590                 GO TO 1050-REGULAR-RATES
  1591             ELSE
  1592                 GO TO 1050-REGULAR-RATES
  1593         ELSE
  1594             GO TO 1050-REGULAR-RATES.
  1595
  1596*    display ' discount option ' rt-discount-option
  1597     IF RT-DISCOUNT-RATE NOT NUMERIC
  1598        MOVE +0                  TO RT-DISCOUNT-RATE.
  1599
  1600     IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1601        NEXT SENTENCE
  1602     ELSE
  1603        MOVE +0                  TO CP-PREMIUM-RATE
  1604                                    CP-COMPOSITE-RATE
  1605                                    CP-CALC-PREMIUM
  1606         MOVE '4'                TO CP-RETURN-CODE
  1607         GO TO 9999-CALC-RATE-PREM-X.
  1608
  1609     IF RT-DISCOUNT-OPTION = '1' OR '3' OR '5'
  1610        MOVE RT-DISCOUNT-RATE TO WS-WORK-DIS-RATE
  1611     ELSE
  1612        MOVE CP-LOAN-APR TO WS-WORK-DIS-RATE.
  1613
  1614*    IF RT-DISCOUNT-OPTION EQUAL '4'
  1615*       MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1616*       GO TO 1075-BYPASS-REGULAR-RATE.
  1617
  1618     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  1619        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1620        COMPUTE WS-WORK-DIS-RATE EQUAL
  1621                WS-WORK-DIS-RATE / +100
  1622        GO TO 1075-BYPASS-REGULAR-RATE.
  1623
  1624     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  1625        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  1626        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1627        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1628        GO TO 1075-BYPASS-REGULAR-RATE.
  1629
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  33
* ELRATE.cbl
  1630     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1631        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  1632        (CP-TRUNCATED-LIFE)
  1633        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1634        GO TO 1075-BYPASS-REGULAR-RATE.
  1635
  1636     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1637        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  1638        (CP-EARN-AS-NET-PAY)
  1639*       (CP-TRUNCATED-LIFE)
  1640        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1641        GO TO 1075-BYPASS-REGULAR-RATE.
  1642
  1643     IF ((CP-COMPANY-ID EQUAL 'GTL') AND
  1644        (CP-STATE-STD-ABBRV EQUAL 'RI'))
  1645                   AND
  1646        ((CP-EARN-AS-NET-PAY)
  1647               OR
  1648        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  1649        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1650        GO TO 1075-BYPASS-REGULAR-RATE.
  1651
  1652     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1653        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  1654        (CP-EARN-AS-NET-PAY) AND
  1655        (CP-SPECIAL-CALC-CD EQUAL 'H')
  1656        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1657        GO TO 1075-BYPASS-REGULAR-RATE.
  1658
  1659     IF (CP-COMPANY-ID = 'CID')
  1660        AND (CP-STATE-STD-ABBRV = 'MN')
  1661        AND (RT-DISCOUNT-OPTION = '1')
  1662        AND ((CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1663                     OR
  1664            (CP-LEVEL-LIFE OR CP-EARN-AS-FARM-PLAN)
  1665            AND (CP-CERT-EFF-DT > X'A4FF'))
  1666        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1667        GO TO 1075-BYPASS-REGULAR-RATE
  1668     END-IF
  1669     IF (CP-COMPANY-ID EQUAL 'CID')
  1670        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  1671                      OR
  1672            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  1673        AND (CP-EARN-AS-NET-PAY)
  1674        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1675        GO TO 1075-BYPASS-REGULAR-RATE
  1676     END-IF
  1677     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  1678        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1679        (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  1680         MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1681         GO TO 1075-BYPASS-REGULAR-RATE.
  1682
  1683     IF CP-COMPANY-ID = 'CID' or 'AHL'
  1684        CONTINUE
  1685     ELSE
  1686        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1687           (CP-EARN-AS-NET-PAY ) AND
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  34
* ELRATE.cbl
  1688           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  1689            GO TO 1075-BYPASS-REGULAR-RATE
  1690        END-IF
  1691     END-IF
  1692     IF (CP-COMPANY-ID = 'CID') AND
  1693        (CP-EARN-AS-NET-PAY) AND
  1694        (CP-LEVEL-LIFE) AND
  1695        (CP-STATE-STD-ABBRV = 'CA') AND
  1696        (CP-STATE-STD-ABBRV = CP-STATE)
  1697        COMPUTE WS-WORK-DIS-RATE =
  1698             RT-DISCOUNT-RATE / +100
  1699        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1700        GO TO 1075-BYPASS-REGULAR-RATE
  1701     END-IF
  1702
  1703     IF (CP-COMPANY-ID = 'CID')
  1704        AND (CP-EARN-AS-NET-PAY)
  1705        AND (CP-STATE-STD-ABBRV = 'ME')
  1706        COMPUTE WS-WORK-DIS-RATE =
  1707             RT-DISCOUNT-RATE / +100
  1708        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1709        GO TO 1075-BYPASS-REGULAR-RATE
  1710     END-IF
  1711     IF (CP-COMPANY-ID = 'CID')
  1712        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  1713           OR 'IN' OR 'AZ' OR 'WA')
  1714        AND (CP-FARM-PLAN)
  1715        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1716        GO TO 1075-BYPASS-REGULAR-RATE
  1717     END-IF
  1718     IF (CP-COMPANY-ID = 'DCC')
  1719        AND (CP-BEN-CATEGORY = 'D')
  1720        AND (CP-EARN-AS-NET-PAY)
  1721        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1722        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  1723           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  1724*       DISPLAY ' ACT COMM ' CP-DCC-ACT-COMM
  1725*       DISPLAY ' PMF COMM ' CP-DCC-PMF-COMM
  1726*       DISPLAY ' OB RATE  ' RT-DISCOUNT-OB-RATE
  1727*       DISPLAY ' NEW RATE ' CP-PREMIUM-RATE
  1728        GO TO 1075-BYPASS-REGULAR-RATE
  1729     END-IF
  1730     IF (CP-COMPANY-ID = 'CID') AND
  1731        (CP-EARN-AS-NET-PAY) AND
  1732        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  1733                            OR 'VT')
  1734                   OR
  1735        ((CP-STATE-STD-ABBRV = 'IN') AND
  1736        (CP-CERT-EFF-DT > X'9A7F'))
  1737                   OR
  1738        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  1739        (CP-CERT-EFF-DT > X'9ADF'))) AND
  1740        (CP-STATE-STD-ABBRV = CP-STATE)
  1741        COMPUTE WS-WORK-DIS-RATE =
  1742             RT-DISCOUNT-RATE / +100
  1743        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1744        GO TO 1075-BYPASS-REGULAR-RATE
  1745     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  35
* ELRATE.cbl
  1746
  1747     IF (CP-COMPANY-ID = 'CID') AND
  1748        (CP-EARN-AS-NET-PAY) AND
  1749        (CP-STATE-STD-ABBRV = 'TX') AND
  1750        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1751        (WS-DISCOUNT-OPTION NOT = ' ')
  1752        COMPUTE WS-WORK-DIS-RATE =
  1753             RT-DISCOUNT-RATE / +100
  1754        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1755        GO TO 1075-BYPASS-REGULAR-RATE
  1756     END-IF
  1757
  1758     IF (CP-COMPANY-ID = 'CID') AND
  1759        (CP-EARN-AS-NET-PAY) AND
  1760        (CP-TRUNCATED-LIFE) AND
  1761        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  1762        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1763        (WS-DISCOUNT-OPTION NOT = ' ')
  1764        COMPUTE WS-WORK-DIS-RATE =
  1765             RT-DISCOUNT-RATE / +100
  1766        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1767        GO TO 1075-BYPASS-REGULAR-RATE
  1768     END-IF
  1769
  1770     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1771        IF WS-WORK-DIS-RATE NOT EQUAL +0
  1772           COMPUTE WS-WORK-DIS-RATE EQUAL
  1773                   WS-WORK-DIS-RATE / +100.
  1774
  1775     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1776        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1777           IF CP-MONTHLY-PAYMENT EQUAL +0
  1778            IF CP-LOAN-APR GREATER THAN +2
  1779              COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1780              CP-ORIGINAL-BENEFIT /
  1781               ((1 - (1 + (CP-LOAN-APR / +1200)) **
  1782               (WS-RATE-TERM * -1)) / (CP-LOAN-APR / +1200))
  1783            ELSE
  1784             COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1785               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  1786
  1787     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1788        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1789          IF WS-WORK-DIS-RATE GREATER THAN +0
  1790           COMPUTE WK1 ROUNDED EQUAL
  1791           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1792                              (WS-RATE-TERM - +1)) /
  1793                        (WS-WORK-DIS-RATE / +12)
  1794           COMPUTE WK2 ROUNDED EQUAL
  1795           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1796                              (WS-RATE-TERM)) /
  1797                        (WS-WORK-DIS-RATE / +12)
  1798           COMPUTE WK3 EQUAL
  1799                RT-DISCOUNT-OB-RATE *
  1800                (1 + WS-WORK-DIS-RATE / +12)
  1801                MOVE WK3 TO CP-PREMIUM-RATE
  1802                COMPUTE WK5 EQUAL WK3 / +1000
  1803           GO TO 1075-BYPASS-REGULAR-RATE.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  36
* ELRATE.cbl
  1804*               (RT-DISCOUNT-OB-RATE / +1000) *
  1805*               (1 + WS-WORK-DIS-RATE / +12)
  1806*          GO TO 1075-BYPASS-REGULAR-RATE.
  1807
  1808     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1809        IF RT-DISCOUNT-OB-RATE GREATER THAN +0
  1810           COMPUTE WK3 EQUAL
  1811           RT-DISCOUNT-OB-RATE *
  1812           (24 / (24 + WS-WORK-DIS-RATE * WS-RATE-TERM))
  1813           MOVE WK3 TO CP-PREMIUM-RATE
  1814           COMPUTE WK5 EQUAL WK3 / +1000
  1815           GO TO 1075-BYPASS-REGULAR-RATE.
  1816
  1817     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  1818        (CP-STATE-STD-ABBRV EQUAL 'VT' OR 'MA')
  1819        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1820        GO TO 1075-BYPASS-REGULAR-RATE.
  1821
  1822     COMPUTE WS-SIN-PREM-RATE =
  1823             (RT-DISCOUNT-OB-RATE / +1000) *
  1824             ((WS-RATE-TERM + +1) / +2).
  1825
  1826     COMPUTE CP-PREMIUM-RATE =
  1827             WS-SIN-PREM-RATE /
  1828             (+1 + (((WS-WORK-DIS-RATE / +100) *
  1829             WS-RATE-TERM) / +24)).
  1830
  1831     IF CP-PREMIUM-RATE NOT = +0
  1832        MULTIPLY +100 BY CP-PREMIUM-RATE
  1833        MOVE CP-PREMIUM-RATE TO WS-PREMIUM-RATE
  1834        GO TO 1075-BYPASS-REGULAR-RATE.
  1835
  1836 1050-REGULAR-RATES.
  1837
  1838     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1839        COMPUTE WK5 EQUAL
  1840        ((WS-RATE-TERM * RT-L-RATE (+12)) / +100) /
  1841        (6 * (WS-RATE-TERM + 1))
  1842        MOVE WK5 TO CP-PREMIUM-RATE
  1843        GO TO 1075-BYPASS-REGULAR-RATE.
  1844
  1845     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  1846        (CP-CSL-VALID-NP-BENEFIT-CD)
  1847        IF CP-JOINT-INDICATOR EQUAL 'J'
  1848           MOVE RT-L-RATE (3) TO CP-PREMIUM-RATE
  1849           GO TO 1075-BYPASS-REGULAR-RATE
  1850        ELSE
  1851           MOVE RT-L-RATE (1) TO CP-PREMIUM-RATE
  1852           GO TO 1075-BYPASS-REGULAR-RATE.
  1853
  1854     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  1855        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  1856        (CP-EARN-AS-NET-PAY )
  1857        MOVE RT-L-RATE (12)      TO CP-PREMIUM-RATE
  1858        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  1859        MOVE CP-FIRST-PAY-DATE   TO DC-BIN-DATE-2
  1860        MOVE '1'                 TO DC-OPTION-CODE
  1861        PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  37
* ELRATE.cbl
  1862        IF DATE-CONVERSION-ERROR
  1863            MOVE '2'                TO CP-RETURN-CODE
  1864            GO TO 9999-CALC-RATE-PREM-X
  1865        ELSE
  1866            COMPUTE CP-ODD-DAYS-TO-PMT = DC-ELAPSED-MONTHS * 30 +
  1867                                         DC-ODD-DAYS-OVER
  1868            GO TO 1075-BYPASS-REGULAR-RATE.
  1869
  1870     IF RT-COMPOSITE-RATE NOT NUMERIC
  1871         MOVE ZEROS                        TO RT-COMPOSITE-RATE.
  1872
  1873*    IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1874     IF WS-RATE-TERM GREATER ZERO AND LESS 361
  1875         MOVE RT-L-RATE (WS-RATE-TERM)     TO CP-PREMIUM-RATE
  1876                                              WS-PREMIUM-RATE
  1877         MOVE RT-COMPOSITE-RATE            TO CP-COMPOSITE-RATE
  1878     ELSE
  1879         MOVE +0                           TO CP-PREMIUM-RATE
  1880                                              CP-COMPOSITE-RATE
  1881                                              CP-CALC-PREMIUM
  1882         GO TO 9999-CALC-RATE-PREM-X.
  1883     IF (CP-COMPANY-ID EQUAL 'CID')
  1884        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  1885        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  1886        AND (CP-EARN-AS-NET-PAY)
  1887        GO TO 1075-BYPASS-REGULAR-RATE
  1888     END-IF
  1889******************************************************
  1890*    IF CP-COMPANY-ID NOT = 'LBL'
  1891     IF CP-COMPANY-ID NOT = 'LBL' AND 'CID'
  1892         GO TO 1075-BYPASS-REGULAR-RATE.
  1893
  1894     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1895     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2.
  1896     MOVE '1'                    TO DC-OPTION-CODE.
  1897     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1898     IF DATE-CONVERSION-ERROR
  1899         MOVE '2'                TO CP-RETURN-CODE
  1900         GO TO 9999-CALC-RATE-PREM-X
  1901       ELSE
  1902         MOVE DC-ELAPSED-MONTHS  TO CP-MNTHS-TO-FIRST-PMT
  1903         MOVE DC-ODD-DAYS-OVER   TO CP-ODD-DAYS-TO-PMT.
  1904
  1905     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN 1
  1906        COMPUTE CP-ODD-DAYS-TO-PMT EQUAL CP-ODD-DAYS-TO-PMT +
  1907        ((CP-MNTHS-TO-FIRST-PMT - 1) * +30).
  1908
  1909     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH)
  1910        IF (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1911           NEXT SENTENCE
  1912         ELSE
  1913           GO TO 1075-BYPASS-REGULAR-RATE
  1914       ELSE
  1915        IF (CP-MNTHS-TO-FIRST-PMT = ZERO) AND
  1916           (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1917           NEXT SENTENCE
  1918         ELSE
  1919           GO TO 1075-BYPASS-REGULAR-RATE.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  38
* ELRATE.cbl
  1920
  1921     IF CP-MNTHS-TO-FIRST-PMT GREATER ZERO
  1922        COMPUTE CP-PREMIUM-RATE =
  1923        ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1924         * (CP-ORIGINAL-TERM + 1)) - CP-PREMIUM-RATE)
  1925         * (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  1926
  1927     IF CP-MNTHS-TO-FIRST-PMT = ZEROS
  1928        COMPUTE CP-PREMIUM-RATE =
  1929        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  1930        CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - 1))) *
  1931        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  1932        (CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1933         * (CP-ORIGINAL-TERM - 1)).
  1934******************************************************
  1935
  1936 1075-BYPASS-REGULAR-RATE.
  1937
  1938     MOVE CP-LOAN-TERM              TO WS-RATE-TERM.
  1939
  1940     MOVE +1 TO LINDX.
  1941
  1942     IF CP-COMPANY-ID EQUAL 'CRI'
  1943        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  1944           MOVE +5               TO LINDX
  1945           IF RT-L-EX-AGE (LINDX) EQUAL ZERO
  1946              MOVE 'F'           TO CP-RETURN-CODE
  1947              GO TO 1200-CALCULATE-PREMIUMS.
  1948
  1949     IF RT-L-EX-AGE (LINDX) = ZERO
  1950          GO TO 1200-CALCULATE-PREMIUMS.
  1951
  1952 1100-SEARCH-LIFE-LIMITS.
  1953
  1954     IF CP-COMPANY-ID EQUAL 'CRI'
  1955        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  1956           IF LINDX GREATER THAN +4
  1957              MOVE 'A'           TO CP-RETURN-CODE
  1958              GO TO 1200-CALCULATE-PREMIUMS.
  1959
  1960     IF LINDX GREATER +8
  1961         MOVE 'A'                TO CP-RETURN-CODE
  1962         GO TO 1200-CALCULATE-PREMIUMS.
  1963
  1964     IF CP-ISSUE-AGE GREATER RT-L-EX-AGE (LINDX)
  1965         IF RT-L-EX-AGE (LINDX) = ZEROS
  1966             ADD +1              TO LINDX
  1967             GO TO 1100-SEARCH-LIFE-LIMITS
  1968         ELSE
  1969             MOVE RT-L-EX-AGE (LINDX)
  1970                                 TO CP-R-MAX-AGE
  1971             MOVE RT-L-EX-TERM (LINDX)
  1972                                 TO CP-R-MAX-TERM
  1973             MOVE RT-L-EX-FACE (LINDX)
  1974                                 TO CP-R-MAX-TOT-BEN
  1975             ADD +1              TO LINDX
  1976             GO TO 1100-SEARCH-LIFE-LIMITS
  1977     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  39
* ELRATE.cbl
  1978         MOVE RT-L-EX-AGE (LINDX)
  1979                                 TO CP-R-MAX-AGE
  1980         MOVE RT-L-EX-TERM (LINDX)
  1981                                 TO CP-R-MAX-TERM
  1982         MOVE RT-L-EX-FACE (LINDX)
  1983                                 TO CP-R-MAX-TOT-BEN.
  1984
  1985     IF CP-ORIGINAL-TERM GREATER RT-L-EX-TERM (LINDX)
  1986         MOVE '9'                TO CP-RETURN-CODE.
  1987
  1988     IF CP-ORIGINAL-BENEFIT GREATER RT-L-EX-FACE (LINDX)
  1989         MOVE '8'                TO CP-RETURN-CODE.
  1990
  1991 1200-CALCULATE-PREMIUMS.
  1992
  1993     IF CP-COMPANY-ID = 'CSL'
  1994        IF CP-CSL-VALID-NP-BENEFIT-CD
  1995           GO TO 1240-NET-PAY-CONT
  1996        ELSE
  1997           GO TO 1250-CSL-CALC.
  1998
  1999     IF CP-COMPANY-ID = 'WDS'
  2000        IF CP-STATE-STD-ABBRV = 'MN' OR 'NC'
  2001           IF CP-EARN-AS-REG-BALLOON
  2002              GO TO 1240-NET-PAY-CONT.
  2003
  2004     IF (CP-COMPANY-ID = 'CID')
  2005        AND (CP-STATE-STD-ABBRV = 'MN')
  2006        AND (CP-EARN-AS-REG-BALLOON OR CP-EARN-AS-FARM-PLAN)
  2007        AND (CP-CERT-EFF-DT > X'A4FF')
  2008        GO TO 1240-NET-PAY-CONT
  2009     END-IF
  2010     IF (CP-COMPANY-ID = 'CID')
  2011        AND (CP-STATE-STD-ABBRV = 'WA')
  2012        AND (CP-FARM-PLAN)
  2013        GO TO 1240-NET-PAY-CONT
  2014     END-IF
  2015     IF (CP-COMPANY-ID = 'CID')
  2016        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2017           OR 'IN' OR 'AZ')
  2018        AND (CP-FARM-PLAN)
  2019***  OK, I DID THIS SO ERCNETP WOULDN'T ERROR OUT
  2020***  THE APR ISN'T EVEN USED IN THE ROUTINE, SO SUE ME :)
  2021        MOVE +1.0                TO CP-LOAN-APR
  2022        GO TO 1240-NET-PAY-CONT
  2023     END-IF
  2024     IF CP-RATE-AS-STANDARD
  2025         GO TO 1210-REGULAR-RATE.
  2026
  2027     IF CP-CRITICAL-PERIOD
  2028         GO TO 1220-CRITICAL-PERIOD-LF-CONT.
  2029
  2030     IF CP-EARN-AS-TEXAS
  2031         GO TO 1230-TEXAS-CONT.
  2032
  2033     IF CP-EARN-AS-NET-PAY
  2034        IF CP-STATE-STD-ABBRV = 'MD'
  2035          IF CP-COMPANY-ID = 'MON'
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  40
* ELRATE.cbl
  2036            IF CP-BENEFIT-CD = '11' OR '12' OR '13' OR
  2037                               '14' OR '26' OR '47'
  2038              GO TO 1210-REGULAR-RATE.
  2039
  2040     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2041        IF CP-MONTHLY-PAYMENT EQUAL +0
  2042           COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2043                CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2044
  2045     IF CP-COMPANY-ID EQUAL 'GTL'
  2046        NEXT SENTENCE
  2047     ELSE
  2048     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2049        IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2050           COMPUTE WK3 ROUNDED EQUAL
  2051           CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2052           CP-MONTHLY-PAYMENT
  2053           COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2054           COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2055           CP-ALTERNATE-BENEFIT)
  2056           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2057           WK3 * WK5
  2058           GO TO 9999-CALC-RATE-PREM-X
  2059        ELSE
  2060           COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2061           (CP-ORIGINAL-TERM - 1 - WK1)) /
  2062           (WS-WORK-DIS-RATE / +12)
  2063           COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2064           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2065                               WK5
  2066           GO TO 9999-CALC-RATE-PREM-X.
  2067
  2068     IF CP-COMPANY-ID EQUAL 'GTL' AND
  2069        CP-STATE-STD-ABBRV EQUAL 'RI' AND
  2070        CP-SPECIAL-CALC-CD EQUAL 'H' AND
  2071        CP-ORIGINAL-TERM LESS THAN +61
  2072        COMPUTE CP-CALC-PREMIUM EQUAL
  2073                        (CP-ORIGINAL-BENEFIT *
  2074           (CP-ORIGINAL-TERM + 1) * CP-PREMIUM-RATE) /
  2075           (20 * (1 + .0019 * CP-ORIGINAL-TERM) * 100)
  2076        COMPUTE CP-CALC-PREMIUM EQUAL
  2077                CP-CALC-PREMIUM +
  2078              (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE *
  2079        (CP-ORIGINAL-TERM + 1)) /
  2080        (10 * (1 + .0027 * (CP-ORIGINAL-TERM + 1)) * 100)
  2081        GO TO 9999-CALC-RATE-PREM-X.
  2082
  2083     IF CP-COMPANY-ID = 'GTL'     AND
  2084        CP-STATE-STD-ABBRV = 'PA' AND
  2085        CP-SPECIAL-CALC-CD = 'H'
  2086         GO TO 1260-GTL-PA-LEASE.
  2087
  2088     IF (CP-EARN-AS-NET-PAY)
  2089        AND (CP-LOAN-APR > ZEROS)
  2090        GO TO 1240-NET-PAY-CONT
  2091     END-IF
  2092
  2093     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  41
* ELRATE.cbl
  2094         GO TO 1210-REGULAR-RATE.
  2095
  2096**** CHECK TO SEE IF THE LEVEL PORTION OF A BALLOON IS BEING
  2097**** RATED AND BYPASS NET-PAY CHECK IF NO APR HAS BEEN ENTERED.
  2098****
  2099     IF CP-DEVIATION-CODE = 'LEV' AND
  2100        CP-LOAN-APR = ZEROS
  2101         GO TO 1210-REGULAR-RATE.
  2102
  2103     IF (CP-STATE-STD-ABBRV = 'OH')
  2104        AND (CP-CLASS-CODE NOT = 'L ')
  2105        AND (CP-ORIGINAL-TERM > 60)
  2106        AND (DC-GREG-DATE-CYMD > 19831031)
  2107        AND (CP-LOAN-APR > ZEROS)
  2108        GO TO 1240-NET-PAY-CONT
  2109     END-IF
  2110
  2111     IF (CP-STATE-STD-ABBRV = 'UT')
  2112        AND (CP-ORIGINAL-TERM > 62)
  2113        AND (DC-GREG-DATE-CYMD > 19810831)
  2114        AND (DC-GREG-DATE-CYMD < 19830901)
  2115        AND (CP-LOAN-APR > ZEROS)
  2116        GO TO 1240-NET-PAY-CONT
  2117     END-IF
  2118
  2119     IF (CP-STATE-STD-ABBRV = 'RI')
  2120        AND (CP-ORIGINAL-TERM > 60)
  2121        AND (DC-GREG-DATE-CYMD > 19831231)
  2122        AND (CP-LOAN-APR > ZEROS)
  2123        GO TO 1240-NET-PAY-CONT
  2124     END-IF
  2125     .
  2126 1210-REGULAR-RATE.
  2127
  2128     IF (CP-COMPANY-ID = 'CID')
  2129        AND (CP-EARN-AS-NET-PAY)
  2130        AND (CP-LOAN-APR = 0)
  2131        IF RT-L-RATE (WS-RATE-TERM) = 0
  2132           COMPUTE WS-SIN-PREM-RATE =
  2133              (RT-DISCOUNT-OB-RATE / +1000) *
  2134              ((WS-RATE-TERM + +1) / +2)
  2135           COMPUTE CP-PREMIUM-RATE =
  2136              WS-SIN-PREM-RATE /
  2137              (+1 + (((WS-WORK-DIS-RATE / +100) *
  2138              WS-RATE-TERM) / +24))
  2139        ELSE
  2140           MOVE RT-L-RATE (WS-RATE-TERM) TO CP-PREMIUM-RATE
  2141        END-IF
  2142     END-IF
  2143*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2144*       IF CP-MONTHLY-PAYMENT EQUAL +0
  2145*          COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2146*               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2147*
  2148*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2149*       IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2150*          COMPUTE WK3 ROUNDED EQUAL
  2151*          CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  42
* ELRATE.cbl
  2152*          CP-MONTHLY-PAYMENT
  2153*          COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2154*          COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2155*          CP-ALTERNATE-BENEFIT)
  2156*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2157*          WK3 * WK5
  2158*          GO TO 9999-CALC-RATE-PREM-X
  2159*       ELSE
  2160*          COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2161*          (CP-ORIGINAL-TERM - 1 - WK1)) /
  2162*          (WS-WORK-DIS-RATE / +12)
  2163*          COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2164*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2165*                              WK5
  2166*          GO TO 9999-CALC-RATE-PREM-X.
  2167
  2168     IF CP-TERM-IS-DAYS
  2169         COMPUTE CP-PREMIUM-RATE ROUNDED =
  2170             ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM) * 12) / +365
  2171         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2172             ((CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE)
  2173                          * CP-TERM-OR-EXT-DAYS
  2174           GO TO 9999-CALC-RATE-PREM-X.
  2175
  2176     if (cp-company-id = 'AHL')
  2177        and (cp-loan-term > cp-original-term)
  2178        continue
  2179     else
  2180        IF NOT CP-TRUNCATED-LIFE
  2181           GO TO 1212-GROSS-NOT-TRUNCATED
  2182        end-if
  2183     end-if
  2184
  2185****  GROSS TRUNCATED CALCULATION
  2186
  2187     IF CP-LOAN-TERM NOT GREATER THAN CP-ORIGINAL-TERM
  2188         MOVE 'H'                TO  CP-RETURN-CODE
  2189         GO TO 9999-CALC-RATE-PREM-X.
  2190     if cp-company-id = 'AHL'
  2191        if (cp-state = 'AZ' OR 'GA' OR 'IN' OR 'MT' OR 'NH'
  2192           OR 'NJ' OR 'OH' OR 'PA' OR 'TX' OR 'VA')
  2193           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2194           cp-original-term) * (cp-loan-term - cp-original-term
  2195            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2196            cp-premium-rate / 100 * cp-original-term /
  2197            cp-loan-term * cp-original-benefit
  2198        else
  2199           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2200           cp-original-term) * (cp-loan-term - cp-original-term
  2201            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2202            cp-premium-rate * cp-original-benefit / 100
  2203        end-if
  2204        go to 9999-calc-rate-prem-x
  2205     end-if
  2206
  2207     IF CP-COMPANY-ID = 'NCL'
  2208         COMPUTE WK-MONTHLY-RATE =
  2209               ((((CP-LOAN-TERM * (CP-LOAN-TERM + 1) -
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  43
* ELRATE.cbl
  2210                  (CP-LOAN-TERM - CP-ORIGINAL-TERM) *
  2211                  (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1))
  2212                                 /
  2213                  (CP-LOAN-TERM * (CP-LOAN-TERM + 1))))
  2214                                 *
  2215                  ((RT-L-RATE (12) * CP-LOAN-TERM / 12)))
  2216         COMPUTE CP-CALC-PREMIUM =
  2217                 WK-MONTHLY-RATE * CP-ORIGINAL-BENEFIT / 100
  2218     ELSE
  2219         COMPUTE CP-R-MAX-TERM = CP-LOAN-TERM -
  2220                                 CP-ORIGINAL-TERM
  2221         COMPUTE CP-CALC-PREMIUM = CP-ORIGINAL-BENEFIT *
  2222                     ((RT-L-RATE (CP-LOAN-TERM)  -
  2223                     (1 - (CP-ORIGINAL-TERM / CP-LOAN-TERM)) *
  2224                     RT-L-RATE (CP-R-MAX-TERM)) / 100)
  2225     END-IF
  2226     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2227        COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2228           (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2229           CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS)
  2230     END-IF
  2231     GO TO 9999-CALC-RATE-PREM-X
  2232     .
  2233 1212-GROSS-NOT-TRUNCATED.
  2234*    DISPLAY ' ELCRATPD '
  2235*    DISPLAY ' MADE IT TO 1212-GROSS-NOT '
  2236*    display ' premium rate ' cp-premium-rate
  2237
  2238     IF (CP-COMPANY-ID = 'CID')
  2239        AND (CP-STATE-STD-ABBRV = 'VT' OR 'MA'
  2240           OR 'IN')
  2241        AND (CP-BENEFIT-CD = '55' OR '56')
  2242        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2243          (CP-ORIGINAL-BENEFIT / (CP-ORIGINAL-TERM)) *
  2244          (CP-ORIGINAL-TERM) *
  2245          ((CP-ORIGINAL-TERM) / 12) *
  2246          ((6.5 * RT-DISCOUNT-OB-RATE) / 1000)
  2247          GO TO 9999-CALC-RATE-PREM-X
  2248     END-IF
  2249     IF (CP-COMPANY-ID = 'CID')
  2250        AND (CP-STATE-STD-ABBRV = 'GA')
  2251        AND (CP-BENEFIT-CD = '55' OR '56' OR '2M' OR '2N')
  2252        COMPUTE WK3 ROUNDED =
  2253          CP-ORIGINAL-BENEFIT *
  2254          ((CP-ORIGINAL-TERM + 1) / 2) *
  2255          (RT-DISCOUNT-OB-RATE / 1000)
  2256          MOVE WK3 TO CP-CALC-PREMIUM
  2257          GO TO 9999-CALC-RATE-PREM-X
  2258     END-IF
  2259     IF (CP-COMPANY-ID EQUAL 'CID')
  2260        AND (CP-STATE-STD-ABBRV = 'MN')
  2261        AND (CP-LEVEL-LIFE)
  2262        AND (CP-CERT-EFF-DT > X'A4FF')
  2263        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  2264        MOVE CP-EXPIRE-DT        TO DC-BIN-DATE-2
  2265        MOVE '1'                 TO DC-OPTION-CODE
  2266        PERFORM 9100-CONVERT-DATE
  2267                                 THRU 9100-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  44
* ELRATE.cbl
  2268        IF DATE-CONVERSION-ERROR
  2269           MOVE '2'              TO CP-RETURN-CODE
  2270           MOVE ZEROS            TO FACTOR
  2271                                 CP-CALC-PREMIUM
  2272           GO TO 9999-CALC-RATE-PREM-X
  2273        END-IF
  2274        MOVE DC-ELAPSED-DAYS     TO D
  2275        COMPUTE CP-MONTHLY-PAYMENT = CP-ORIGINAL-BENEFIT /
  2276           (1 / (1 + (CP-LOAN-APR / 100) * D / 360) -
  2277           (CP-PREMIUM-RATE * 12 / 365 * D / 1000))
  2278        COMPUTE CP-CALC-PREMIUM = CP-MONTHLY-PAYMENT *
  2279           CP-PREMIUM-RATE * 12 / 365 * D / 1000
  2280        GO TO 9999-CALC-RATE-PREM-X
  2281     END-IF
  2282     IF (CP-COMPANY-ID = 'CID')
  2283        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2284        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2285           (CP-ORIGINAL-BENEFIT / 1000) * CP-PREMIUM-RATE
  2286     ELSE
  2287        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2288                 (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE
  2289     END-IF
  2290*    display ' calc premium ' cp-calc-premium
  2291
  2292*    IF CP-COMPANY-ID = 'LBL'
  2293     IF (CP-COMPANY-ID = 'LBL' OR 'CID')
  2294        AND (NOT CP-EARN-AS-NET-PAY)
  2295        GO TO 9999-CALC-RATE-PREM-X
  2296     END-IF
  2297
  2298*    display ' fell through to ext days '
  2299     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2300         GO TO 9999-CALC-RATE-PREM-X.
  2301
  2302     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2303         COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2304            (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2305               CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS).
  2306
  2307     GO TO 9999-CALC-RATE-PREM-X.
  2308
  2309 1220-CRITICAL-PERIOD-LF-CONT.
  2310     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2311               (CP-ORIGINAL-BENEFIT / +100) * CP-PREMIUM-RATE.
  2312
  2313     GO TO 9999-CALC-RATE-PREM-X.
  2314
  2315 1230-TEXAS-CONT.
  2316     IF CP-FARM-PLAN
  2317         GO TO 1235-TEXAS-FARM-CONT.
  2318
  2319     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2320               (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2321
  2322     COMPUTE TEX-FACT-9 =
  2323                 (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY) /
  2324                 (CP-ORIGINAL-TERM + 1).
  2325
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  45
* ELRATE.cbl
  2326     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2327                 CP-CALC-PREMIUM * TEX-FACT-9.
  2328
  2329     GO TO 9999-CALC-RATE-PREM-X.
  2330
  2331 1235-TEXAS-FARM-CONT.
  2332     COMPUTE WS-FARM-TERM =
  2333               (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY).
  2334
  2335     COMPUTE WS-PREMIUM-RATE = RT-L-RATE (WS-FARM-TERM) / 2.
  2336     MOVE WS-PREMIUM-RATE         TO CP-PREMIUM-RATE.
  2337
  2338
  2339     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2340              (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2341
  2342     GO TO 9999-CALC-RATE-PREM-X.
  2343
  2344 1240-NET-PAY-CONT.
  2345
  2346     MOVE CP-LOAN-APR             TO N-P-APR.
  2347     MOVE CP-ORIGINAL-TERM        TO N-P-ORIG
  2348                                     N-P-REM
  2349                                     N-P-LOAN.
  2350
  2351     MOVE CP-SPECIAL-CALC-CD      TO N-P-OPT.
  2352
  2353     IF CP-TRUNCATED-LIFE
  2354         MOVE CP-LOAN-TERM        TO N-P-LOAN.
  2355
  2356     IF CP-COMPANY-ID EQUAL 'NCL'
  2357        NEXT SENTENCE
  2358     ELSE
  2359        GO TO 1241-NET-PAY-CONT.
  2360
  2361     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  2362     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2
  2363     MOVE '1'                    TO DC-OPTION-CODE
  2364     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2365     IF DATE-CONVERSION-ERROR
  2366         MOVE '2'                TO CP-RETURN-CODE
  2367         GO TO 9999-CALC-RATE-PREM-X
  2368     ELSE
  2369        MOVE DC-ELAPSED-MONTHS   TO CP-MNTHS-TO-FIRST-PMT
  2370        MOVE DC-ODD-DAYS-OVER    TO CP-ODD-DAYS-TO-PMT.
  2371
  2372     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2373        (CP-ODD-DAYS-TO-PMT NOT EQUAL ZEROS)
  2374        NEXT SENTENCE
  2375     ELSE
  2376        MOVE +1                  TO ODF
  2377        GO TO 1241-NET-PAY-CONT.
  2378
  2379     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN ZERO
  2380        COMPUTE CP-PREMIUM-RATE EQUAL
  2381        ((CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN + 1)) -
  2382        CP-PREMIUM-RATE) *
  2383        (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  46
* ELRATE.cbl
  2384
  2385     IF CP-MNTHS-TO-FIRST-PMT EQUAL ZEROS
  2386        COMPUTE CP-PREMIUM-RATE EQUAL
  2387        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  2388        N-P-LOAN * (N-P-LOAN - 1))) *
  2389        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  2390        (CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN - 1)).
  2391
  2392     COMPUTE ODF EQUAL
  2393     ((1 + (N-P-APR / +1200)) ** (1 - CP-MNTHS-TO-FIRST-PMT)) /
  2394     ((1 + (CP-ODD-DAYS-TO-PMT * 12 / 36500))).
  2395
  2396 1241-NET-PAY-CONT.
  2397
  2398     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2399
  2400*    IF CP-RETURN-CODE EQUAL '0' OR '8'
  2401     IF CP-RETURN-CODE EQUAL '0' OR '8' OR '9' OR 'B'
  2402        NEXT SENTENCE
  2403     ELSE
  2404        GO TO 9999-CALC-RATE-PREM-X.
  2405
  2406     IF RT-DISCOUNT-OPTION EQUAL '6'
  2407         GO TO 9999-CALC-RATE-PREM-X.
  2408
  2409     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2410        (CP-STATE-STD-ABBRV EQUAL 'IA')
  2411        GO TO 9999-CALC-RATE-PREM-X.
  2412
  2413     MOVE N-P-FACTOR              TO CP-CDT-FACTOR.
  2414
  2415     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  2416        GO TO 9999-CALC-RATE-PREM-X.
  2417
  2418     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2419        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2420        (CP-TRUNCATED-LIFE)
  2421        GO TO 9999-CALC-RATE-PREM-X.
  2422
  2423     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2424        (CP-CSL-VALID-NP-BENEFIT-CD)
  2425        GO TO 9999-CALC-RATE-PREM-X.
  2426
  2427     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  2428        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  2429        (CP-EARN-AS-NET-PAY)
  2430        GO TO 9999-CALC-RATE-PREM-X.
  2431
  2432*    IF (CP-COMPANY-ID EQUAL 'CID') AND
  2433*       (CP-STATE-STD-ABBRV EQUAL 'NV') AND
  2434*       (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  2435*       GO TO 9999-CALC-RATE-PREM-X.
  2436
  2437     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  2438        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2439        (CP-EARN-AS-NET-PAY)
  2440        GO TO 9999-CALC-RATE-PREM-X.
  2441
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  47
* ELRATE.cbl
  2442     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  2443        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  2444        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  2445        GO TO 9999-CALC-RATE-PREM-X.
  2446
  2447     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2448        (CP-EARN-AS-NET-PAY)
  2449        GO TO 9999-CALC-RATE-PREM-X.
  2450
  2451     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2452        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  2453        (CP-TRUNCATED-LIFE)
  2454        GO TO 9999-CALC-RATE-PREM-X.
  2455
  2456     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2457        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  2458        (CP-EARN-AS-NET-PAY)
  2459*       (CP-TRUNCATED-LIFE)
  2460        GO TO 9999-CALC-RATE-PREM-X.
  2461
  2462     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2463        (CP-STATE-STD-ABBRV EQUAL 'RI')
  2464                   AND
  2465        ((CP-EARN-AS-NET-PAY)
  2466               OR
  2467        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  2468        GO TO 9999-CALC-RATE-PREM-X.
  2469
  2470     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2471        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  2472        (CP-EARN-AS-NET-PAY) AND
  2473        (CP-SPECIAL-CALC-CD EQUAL 'H')
  2474        GO TO 9999-CALC-RATE-PREM-X.
  2475
  2476     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2477        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  2478        (CP-EARN-AS-NET-PAY)
  2479        GO TO 9999-CALC-RATE-PREM-X.
  2480
  2481     IF CP-COMPANY-ID = 'CID' or 'AHL'
  2482        CONTINUE
  2483     ELSE
  2484        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2485           (CP-EARN-AS-NET-PAY) AND
  2486           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  2487           GO TO 9999-CALC-RATE-PREM-X
  2488        END-IF
  2489     END-IF
  2490
  2491     IF (CP-COMPANY-ID = 'CID')
  2492        AND (CP-EARN-AS-NET-PAY)
  2493        AND (CP-STATE-STD-ABBRV = 'ME')
  2494        GO TO 9999-CALC-RATE-PREM-X
  2495     END-IF
  2496     IF (CP-COMPANY-ID = 'DCC')
  2497        AND (CP-BEN-CATEGORY = 'D')
  2498        AND (CP-EARN-AS-NET-PAY)
  2499        GO TO 9999-CALC-RATE-PREM-X
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  48
* ELRATE.cbl
  2500     END-IF
  2501     IF (CP-COMPANY-ID = 'CID')
  2502        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2503           OR 'IN' OR 'AZ' OR 'WA')
  2504        AND (CP-FARM-PLAN)
  2505        GO TO 9999-CALC-RATE-PREM-X
  2506     END-IF
  2507     IF (CP-COMPANY-ID = 'CID') AND
  2508        (CP-EARN-AS-NET-PAY) AND
  2509        (CP-LEVEL-LIFE) AND
  2510        (CP-STATE-STD-ABBRV = 'CA' OR 'MN') AND
  2511        (CP-STATE-STD-ABBRV = CP-STATE)
  2512        GO TO 9999-CALC-RATE-PREM-X
  2513     END-IF
  2514
  2515     IF (CP-COMPANY-ID = 'CID') AND
  2516        (CP-EARN-AS-NET-PAY) AND
  2517        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  2518                            OR 'VT')
  2519                   OR
  2520        ((CP-STATE-STD-ABBRV = 'IN') AND
  2521        (CP-CERT-EFF-DT > X'9A7F'))
  2522                   OR
  2523        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  2524        (CP-CERT-EFF-DT > X'9ADF'))) AND
  2525        (CP-STATE-STD-ABBRV = CP-STATE)
  2526        GO TO 9999-CALC-RATE-PREM-X
  2527     END-IF
  2528
  2529     IF (CP-COMPANY-ID = 'CID') AND
  2530        (CP-EARN-AS-NET-PAY) AND
  2531        (CP-STATE-STD-ABBRV = 'TX') AND
  2532        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2533        (WS-DISCOUNT-OPTION NOT = ' ')
  2534        GO TO 9999-CALC-RATE-PREM-X
  2535     END-IF
  2536
  2537     IF (CP-COMPANY-ID = 'CID')
  2538        AND (CP-STATE-STD-ABBRV = 'MN')
  2539        AND (RT-DISCOUNT-OPTION = '1')
  2540        AND (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON OR
  2541           CP-EARN-AS-FARM-PLAN)
  2542        GO TO 9999-CALC-RATE-PREM-X
  2543     END-IF
  2544     IF (CP-COMPANY-ID = 'CID')
  2545        AND (CP-EARN-AS-NET-PAY)
  2546        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  2547                      OR
  2548            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  2549        GO TO 9999-CALC-RATE-PREM-X
  2550     END-IF
  2551     IF (CP-COMPANY-ID = 'CID')
  2552        AND (CP-EARN-AS-NET-PAY)
  2553        AND (CP-STATE-STD-ABBRV = 'SC')
  2554        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  2555        GO TO 9999-CALC-RATE-PREM-X
  2556     END-IF
  2557     IF (CP-COMPANY-ID = 'CID') AND
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  49
* ELRATE.cbl
  2558        (CP-EARN-AS-NET-PAY) AND
  2559        (CP-TRUNCATED-LIFE) AND
  2560        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  2561        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2562        (WS-DISCOUNT-OPTION NOT = ' ')
  2563        GO TO 9999-CALC-RATE-PREM-X
  2564     END-IF
  2565
  2566     IF (CP-COMPANY-ID EQUAL 'DCC') AND
  2567        (CP-EARN-AS-NET-PAY)
  2568        MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE
  2569        GO TO 9999-CALC-RATE-PREM-X
  2570     END-IF
  2571
  2572     IF (CP-COMPANY-ID EQUAL 'CID')
  2573        AND (CP-EARN-AS-NET-PAY)
  2574        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2575        GO TO 9999-CALC-RATE-PREM-X
  2576     END-IF
  2577
  2578     IF (RT-IS-OB) AND
  2579        (CP-COMPANY-ID NOT EQUAL 'CID')
  2580        COMPUTE CP-PREMIUM-RATE ROUNDED =
  2581               (CP-PREMIUM-RATE * 12) / CP-LOAN-TERM
  2582      ELSE
  2583         IF (CP-COMPANY-ID = 'DCC')
  2584            AND (CP-RATE-DEV-PCT NOT = ZEROS)
  2585            COMPUTE CP-CALC-PREMIUM ROUNDED =
  2586*           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2587             (CP-PREMIUM-RATE * CP-RATE-DEV-PCT * 12) /
  2588               CP-ORIGINAL-TERM
  2589             MOVE CP-CALC-PREMIUM TO CP-PREMIUM-RATE
  2590             MOVE ZEROS          TO CP-RATE-DEV-PCT
  2591        ELSE
  2592           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2593               (CP-PREMIUM-RATE * 12) / CP-ORIGINAL-TERM
  2594        END-IF
  2595     END-IF
  2596
  2597     IF CP-ROA-PREM-AT-REFUND
  2598         COMPUTE NET-BEN ROUNDED =
  2599             (CP-REMAINING-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000
  2600     ELSE
  2601         COMPUTE NET-BEN ROUNDED =
  2602              (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000.
  2603
  2604     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2605        (CP-TERM-OR-EXT-DAYS NOT = ZERO)
  2606          COMPUTE NET-BEN ROUNDED =
  2607              NET-BEN * (1 + (CP-LOAN-APR / 1200) *
  2608                         (CP-TERM-OR-EXT-DAYS / 30)).
  2609
  2610     IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'CID' OR 'MON' OR 'HAN'
  2611*       OR 'DCC'
  2612*    IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'MON' OR 'HAN'
  2613     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2614       (N-P-FACTOR * CP-PREMIUM-RATE * CP-ORIGINAL-TERM / 1200) /
  2615       (1 - (N-P-FACTOR * CP-PREMIUM-RATE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  50
* ELRATE.cbl
  2616                        * CP-ORIGINAL-TERM / 1200))
  2617     ELSE
  2618     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2619       (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200) /
  2620       (1 - (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200)).
  2621
  2622****** THE BELOW VERSION OF THE NET PAY FORMULA IS USED WHEN NO
  2623****** INTEREST IS CHARGED ON PREMIUM.
  2624
  2625*    IF CP-STATE-STD-ABBRV = 'MI'
  2626*         COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2627*          (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200).
  2628
  2629     MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE.
  2630
  2631     GO TO 9999-CALC-RATE-PREM-X.
  2632
  2633******
  2634****** BELOW ARE PREMIUM CALCULATIONS FOR CSL
  2635******
  2636
  2637 1250-CSL-CALC.
  2638     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2639     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  2640     MOVE '1' TO DC-OPTION-CODE.
  2641     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2642
  2643     IF DATE-CONVERSION-ERROR
  2644         MOVE '2' TO CP-RETURN-CODE
  2645         GO TO 9999-CALC-RATE-PREM-X.
  2646
  2647     IF CP-JOINT-INDICATOR = 'J'
  2648         MOVE RT-L-RATE (3) TO WK-RED-RATE
  2649     ELSE
  2650         MOVE RT-L-RATE (1) TO WK-RED-RATE.
  2651
  2652     MOVE WK-RED-RATE TO CP-PREMIUM-RATE.
  2653     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  2654
  2655     IF CP-PAY-FREQUENCY = 12
  2656         MOVE 01               TO WS-PAY-SCH.
  2657     IF CP-PAY-FREQUENCY = 04
  2658         MOVE 03               TO WS-PAY-SCH.
  2659     IF CP-PAY-FREQUENCY = 02
  2660         MOVE 06               TO WS-PAY-SCH.
  2661     IF CP-PAY-FREQUENCY = 01
  2662         MOVE 12               TO WS-PAY-SCH.
  2663
  2664     COMPUTE WS-NUM-PAYMTS = CP-ORIGINAL-TERM / WS-PAY-SCH.
  2665     IF CP-PAY-FREQUENCY NOT = 12
  2666         COMPUTE WK-PAY-AMT = CP-REMAINING-BENEFIT /
  2667                                WS-NUM-PAYMTS.
  2668
  2669     IF CP-STATE = 'SC'  AND
  2670       (CP-BENEFIT-CD = '07'  OR  '08')
  2671         GO TO 1250-CSL-CALC-LIFE-6.
  2672
  2673     IF CP-CSL-METH-1
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  51
* ELRATE.cbl
  2674         GO TO 1250-CSL-CALC-LIFE-1.
  2675
  2676     IF CP-CSL-METH-2
  2677         IF (WK-PAY-AMT * CP-LOAN-TERM) GREATER THAN
  2678                          WS-MAX-TOT-BEN
  2679             GO TO 1250-CSL-CALC-LIFE-2
  2680         ELSE
  2681             GO TO 1250-CSL-CALC-LIFE-1.
  2682
  2683     IF CP-CSL-METH-3
  2684         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  2685             GO TO 1250-CSL-CALC-LIFE-2
  2686         ELSE
  2687             GO TO 1250-CSL-CALC-LIFE-3.
  2688
  2689     IF CP-CSL-METH-4
  2690         IF (WK-PAY-AMT * WS-NUM-PAYMTS) GREATER THAN
  2691                          WS-MAX-TOT-BEN
  2692             GO TO 1250-CSL-CALC-LIFE-5
  2693         ELSE
  2694             GO TO 1250-CSL-CALC-LIFE-4.
  2695
  2696 1250-CSL-CALC-LIFE-1.
  2697     IF CP-JOINT-INDICATOR = 'J'
  2698         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2699     ELSE
  2700         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2701
  2702     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY) /
  2703                    365) - 1) * 365 / 12.
  2704     COMPUTE WK-S ROUNDED = ((144 * WK-D * WK-LEV-RATE) +
  2705                    (365 * WS-NUM-PAYMTS * WK-RED-RATE)) /
  2706                    4380.
  2707     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PAY-AMT *
  2708                    WS-NUM-PAYMTS * WK-S.
  2709
  2710     GO TO 9999-CALC-RATE-PREM-X.
  2711
  2712 1250-CSL-CALC-LIFE-2.
  2713     IF CP-JOINT-INDICATOR = 'J'
  2714         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2715     ELSE
  2716         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2717
  2718     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2719     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2720     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2721                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2722                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2723     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2724                    WK-S) + WK-D.
  2725
  2726     GO TO 9999-CALC-RATE-PREM-X.
  2727
  2728 1250-CSL-CALC-LIFE-3.
  2729     IF CP-JOINT-INDICATOR = 'J'
  2730         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2731     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  52
* ELRATE.cbl
  2732         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2733
  2734     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2735     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2736     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2737                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2738                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2739     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2740                    WK-S) + WK-D.
  2741
  2742     GO TO 9999-CALC-RATE-PREM-X.
  2743
  2744 1250-CSL-CALC-LIFE-4.
  2745     IF CP-JOINT-INDICATOR = 'J'
  2746         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2747     ELSE
  2748         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2749
  2750     COMPUTE WK-D = DC-ELAPSED-DAYS * 12 / 365.
  2751     COMPUTE WK-S ROUNDED =
  2752                    (((6 * (WS-NUM-PAYMTS - 1)) + (WK-D *
  2753                    CP-PAY-FREQUENCY)) * WK-LEV-RATE) /
  2754                    CP-PAY-FREQUENCY.
  2755     COMPUTE CP-CALC-PREMIUM ROUNDED =  WK-PAY-AMT *
  2756                    WS-NUM-PAYMTS * WK-S.
  2757
  2758     GO TO 9999-CALC-RATE-PREM-X.
  2759
  2760 1250-CSL-CALC-LIFE-5.
  2761     IF CP-JOINT-INDICATOR = 'J'
  2762         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2763     ELSE
  2764         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2765
  2766     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2767     COMPUTE WK-S ROUNDED = (6 * (WK-K + 1) * WK-LEV-RATE) /
  2768                    CP-PAY-FREQUENCY.
  2769     COMPUTE WK-U = ((((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2770                    - 1) + WS-NUM-PAYMTS) * 12) /
  2771                    CP-PAY-FREQUENCY.
  2772     COMPUTE WK-L = WK-U - (12 * WK-K / CP-PAY-FREQUENCY).
  2773     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-L * WK-LEV-RATE *
  2774                    WS-MAX-TOT-BEN) + (WK-K * WK-PAY-AMT * WK-S).
  2775
  2776     GO TO 9999-CALC-RATE-PREM-X.
  2777
  2778 1250-CSL-CALC-LIFE-6.
  2779
  2780     COMPUTE CP-PREMIUM-RATE ROUNDED =
  2781                (CP-PREMIUM-RATE * CP-ORIGINAL-TERM) / 12.
  2782
  2783     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2784                    CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE.
  2785
  2786     GO TO 9999-CALC-RATE-PREM-X.
  2787
  2788******
  2789****** END OF PREMIUM CALCULATIONS FOR CSL
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  53
* ELRATE.cbl
  2790******
  2791
  2792 1260-GTL-PA-LEASE.
  2793
  2794     IF CP-REDUCING-LIFE
  2795         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2796                                 TO  CP-PREMIUM-RATE
  2797         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2798                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / +100
  2799     ELSE
  2800         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2801                                 TO  CP-PREMIUM-RATE
  2802         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2803                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE *
  2804                 (+1 + CP-SALES-TAX) / +100.
  2805
  2806     GO TO 9999-CALC-RATE-PREM-X.
  2807
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  54
* ELRATE.cbl
  2809******************************************************************
  2810 2000-TYPE-IS-AH.
  2811     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  2812
  2813     MOVE ZERO                      TO CP-R-MAX-AGE
  2814                                       CP-R-MAX-TERM
  2815                                       CP-R-MAX-MON-BEN
  2816                                       CP-R-MAX-TOT-BEN.
  2817
  2818     IF RT-POLICY-FEE NUMERIC
  2819        MOVE RT-POLICY-FEE          TO CP-POLICY-FEE.
  2820
  2821     IF RT-COMPOSITE-RATE NOT NUMERIC
  2822        MOVE ZEROS                          TO RT-COMPOSITE-RATE.
  2823
  2824     IF CP-ORIGINAL-TERM > ZERO AND < 361
  2825        MOVE RT-AH-RATE (CP-ORIGINAL-TERM)
  2826                                 TO CP-PREMIUM-RATE
  2827                                    WS-PREMIUM-RATE
  2828        MOVE RT-COMPOSITE-RATE   TO CP-COMPOSITE-RATE
  2829     ELSE
  2830         MOVE +0                 TO CP-PREMIUM-RATE
  2831                                    CP-CALC-PREMIUM
  2832         GO TO 9999-CALC-RATE-PREM-X
  2833     END-IF
  2834
  2835     IF (CP-COMPANY-ID = 'DCC')
  2836        AND ((CP-BENEFIT-CD (1:1) = 'P')
  2837        OR (CP-DDF-SPEC-CALC = 'T'))
  2838        AND (CP-LOAN-TERM > ZERO AND < 361)
  2839        MOVE RT-AH-RATE (CP-LOAN-TERM)
  2840                                 TO CP-PREMIUM-RATE
  2841                                    WS-PREMIUM-RATE
  2842     END-IF
  2843     MOVE +1 TO AHNDX.
  2844
  2845     IF CP-COMPANY-ID EQUAL 'CRI'
  2846        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  2847           MOVE +5               TO AHNDX
  2848           IF RT-AH-AGE (AHNDX) EQUAL ZERO
  2849              MOVE 'F'           TO CP-RETURN-CODE
  2850              GO TO 2200-CALCULATE-PREMIUMS.
  2851
  2852     IF RT-AH-AGE (AHNDX) = ZERO
  2853          GO TO 2200-CALCULATE-PREMIUMS.
  2854
  2855 2100-SEARCH-AH-LIMITS.
  2856
  2857     IF CP-COMPANY-ID EQUAL 'CRI'
  2858        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  2859           IF AHNDX GREATER THAN +4
  2860              MOVE 'A'             TO CP-RETURN-CODE
  2861              GO TO 2200-CALCULATE-PREMIUMS.
  2862
  2863     IF AHNDX GREATER +8
  2864         MOVE 'A'                TO CP-RETURN-CODE
  2865         GO TO 2200-CALCULATE-PREMIUMS.
  2866
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  55
* ELRATE.cbl
  2867     IF CP-ISSUE-AGE GREATER RT-AH-AGE (AHNDX)
  2868         IF RT-AH-AGE (AHNDX) = ZEROS
  2869             ADD +1               TO AHNDX
  2870             GO TO 2100-SEARCH-AH-LIMITS
  2871         ELSE
  2872             MOVE RT-AH-AGE (AHNDX)
  2873                                 TO CP-R-MAX-AGE
  2874             MOVE RT-AH-TERM (AHNDX)
  2875                                 TO CP-R-MAX-TERM
  2876             MOVE RT-AH-BEN-M (AHNDX)
  2877                                 TO CP-R-MAX-MON-BEN
  2878             ADD +1               TO AHNDX
  2879             GO TO 2100-SEARCH-AH-LIMITS
  2880     ELSE
  2881         MOVE RT-AH-AGE  (AHNDX) TO CP-R-MAX-AGE
  2882         MOVE RT-AH-TERM (AHNDX) TO CP-R-MAX-TERM
  2883         MOVE RT-AH-BEN-M (AHNDX)
  2884                                 TO CP-R-MAX-MON-BEN.
  2885
  2886     IF CP-ORIGINAL-TERM GREATER RT-AH-TERM (AHNDX)
  2887         MOVE '9'                 TO CP-RETURN-CODE.
  2888
  2889     IF CP-ORIGINAL-BENEFIT GREATER RT-AH-BEN-M (AHNDX)
  2890         MOVE '8'                 TO CP-RETURN-CODE.
  2891
  2892     MULTIPLY CP-ORIGINAL-BENEFIT BY CP-ORIGINAL-TERM
  2893         GIVING WS-AH-FACE-BENEFIT.
  2894
  2895     IF WS-AH-FACE-BENEFIT GREATER RT-AH-BEN-F (AHNDX)
  2896         MOVE 'C'                 TO CP-RETURN-CODE.
  2897
  2898 2200-CALCULATE-PREMIUMS.
  2899
  2900     IF CP-COMPANY-ID = 'CSL'
  2901         GO TO 2250-CSL-CALC.
  2902
  2903*    IF CP-CRITICAL-PERIOD
  2904*       GO TO 2200-CRITICAL-PERIOD-AH-CONT.
  2905
  2906     IF CP-CRITICAL-PERIOD
  2907        IF (CP-COMPANY-ID = 'DCC')
  2908           AND ((CP-BENEFIT-CD (1:1) = 'N' OR 'M' OR 'H'
  2909               OR 'S' OR 'P')
  2910                          OR
  2911                (CP-BEN-CATEGORY = 'G' OR 'L'))
  2912           CONTINUE
  2913        ELSE
  2914           GO TO 2200-CRITICAL-PERIOD-AH-CONT
  2915        END-IF
  2916     END-IF
  2917
  2918     IF (CP-COMPANY-ID = 'DCC')
  2919        AND (CP-BEN-CATEGORY = 'D')
  2920        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  2921           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  2922     END-IF
  2923     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2924        COMPUTE WS-TERM-MINUS-ONE EQUAL CP-ORIGINAL-TERM - +1
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  56
* ELRATE.cbl
  2925        MOVE RT-AH-RATE (WS-TERM-MINUS-ONE) TO
  2926                                     CP-PREMIUM-RATE
  2927        COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2928        (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM - +1) *
  2929        CP-PREMIUM-RATE) / +100
  2930     ELSE
  2931        IF (CP-COMPANY-ID = 'DCC')
  2932           AND (CP-BEN-CATEGORY NOT = 'G' AND 'L')
  2933           MOVE CP-PREMIUM-RATE  TO WK-S
  2934*          MOVE CP-PREMIUM-RATE  TO CP-CALC-PREMIUM
  2935           IF CP-RATE-DEV-PCT NOT = ZEROS
  2936              COMPUTE WK-S ROUNDED =
  2937                 (CP-PREMIUM-RATE * CP-RATE-DEV-PCT)
  2938           END-IF
  2939           IF CP-BENEFIT-CD (1:1) = 'M'
  2940              COMPUTE CP-CALC-PREMIUM ROUNDED =
  2941              CP-ORIGINAL-BENEFIT * WK-S / 100
  2942           ELSE
  2943              IF CP-BENEFIT-CD (1:1) = 'H'
  2944                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  2945                    (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  2946                    WK-S) / 1000
  2947              ELSE
  2948                 IF CP-BENEFIT-CD (1:1) = 'N' OR 'S'
  2949                    GO TO 2300-CALC-DCC-MOB-NET-AH
  2950                 ELSE
  2951                    IF CP-BEN-CATEGORY = 'D'
  2952                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  2953                        CP-ORIGINAL-BENEFIT *
  2954                        CP-ORIGINAL-TERM * WK-S / 100
  2955                    ELSE
  2956                      IF CP-BENEFIT-CD (1:1) = 'P'
  2957                         GO TO 2300-CALC-DCC-BEN-P-AH
  2958                      ELSE
  2959                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  2960                        (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  2961                        WK-S) / 100
  2962                      END-IF
  2963                    END-IF
  2964                 END-IF
  2965              END-IF
  2966           END-IF
  2967           MOVE ZEROS            TO CP-RATE-DEV-PCT
  2968        ELSE
  2969           IF CP-BENEFIT-CD (1:1) = 'M'
  2970              COMPUTE CP-CALC-PREMIUM ROUNDED =
  2971                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 100
  2972           ELSE
  2973              IF CP-BENEFIT-CD (1:1) = 'N' OR 'H'
  2974                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  2975                    (CP-NET-BENEFIT-AMT *
  2976                    CP-PREMIUM-RATE) / 1000
  2977              ELSE
  2978                 IF CP-AH-BALLOON-SW = 'Y'
  2979                    COMPUTE CP-CALC-PREMIUM ROUNDED =
  2980                      (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM) *
  2981                      CP-PREMIUM-RATE) / 100
  2982                 ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  57
* ELRATE.cbl
  2983                   COMPUTE CP-CALC-PREMIUM ROUNDED =
  2984                    (CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM *
  2985                    CP-PREMIUM-RATE) / 100
  2986                 END-IF
  2987              END-IF
  2988           END-IF
  2989        END-IF
  2990     END-IF
  2991
  2992     IF (CP-COMPANY-ID = 'DCC')
  2993        AND (CP-BEN-CATEGORY = 'G' OR 'L')
  2994        COMPUTE CP-CALC-PREMIUM = CP-PREMIUM-RATE * +1000
  2995     END-IF
  2996     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2997         GO TO 9999-CALC-RATE-PREM-X.
  2998
  2999     IF CP-EXT-CHG-AH OR CP-EXT-CHG-LF-AH
  3000         COMPUTE CP-CALC-PREMIUM ROUNDED =
  3001             CP-CALC-PREMIUM +
  3002                 (((CP-CALC-PREMIUM / CP-ORIGINAL-TERM) / 30)
  3003                                       * CP-TERM-OR-EXT-DAYS).
  3004
  3005     GO TO 9999-CALC-RATE-PREM-X.
  3006
  3007 2200-CRITICAL-PERIOD-AH-CONT.
  3008
  3009     IF CP-COMPANY-ID = 'WDS'
  3010         IF CP-ORIGINAL-TERM GREATER THAN 60
  3011             MOVE 60              TO CP-LOAN-TERM.
  3012
  3013     IF CP-COMPANY-ID EQUAL 'CVL'
  3014         COMPUTE CP-CALC-PREMIUM ROUNDED =
  3015           ((CP-ORIGINAL-BENEFIT * CP-CRITICAL-MONTHS) / +100)
  3016                                       * CP-PREMIUM-RATE
  3017         GO TO 9999-CALC-RATE-PREM-X.
  3018
  3019     COMPUTE CP-CALC-PREMIUM ROUNDED =
  3020           ((CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM) / +100)
  3021                                       * CP-PREMIUM-RATE.
  3022
  3023     GO TO 9999-CALC-RATE-PREM-X.
  3024
  3025 2250-CSL-CALC.
  3026
  3027     IF RT-DAILY-RATE NOT NUMERIC OR
  3028        RT-DAILY-RATE = ZEROS
  3029            MOVE ZEROS TO CP-CALC-PREMIUM
  3030            MOVE '7' TO CP-RETURN-CODE
  3031            GO TO 9999-CALC-RATE-PREM-X.
  3032
  3033     COMPUTE WK-DAILY-RATE = RT-DAILY-RATE / 100.
  3034     COMPUTE WK-MONTHLY-RATE =
  3035          RT-AH-RATE (CP-ORIGINAL-TERM) / 100.
  3036
  3037     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3038     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  3039     MOVE '1' TO DC-OPTION-CODE.
  3040     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  58
* ELRATE.cbl
  3041     IF DATE-CONVERSION-ERROR
  3042         MOVE '2' TO CP-RETURN-CODE
  3043         GO TO 9999-CALC-RATE-PREM-X.
  3044
  3045     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  3046     IF CP-CSL-METH-1
  3047         GO TO 2250-CSL-CALC-AH-1.
  3048     IF CP-CSL-METH-2
  3049         GO TO 2250-CSL-CALC-AH-2.
  3050     IF CP-CSL-METH-3
  3051         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  3052             GO TO 2250-CSL-CALC-AH-4
  3053         ELSE
  3054             GO TO 2250-CSL-CALC-AH-3.
  3055
  3056 2250-CSL-CALC-AH-1.
  3057
  3058     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3059     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3060                    + WK-MONTHLY-RATE.
  3061     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-MONTHLY-PAYMENT *
  3062                    CP-ORIGINAL-TERM * WK-D.
  3063
  3064     GO TO 9999-CALC-RATE-PREM-X.
  3065
  3066
  3067 2250-CSL-CALC-AH-2.
  3068     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3069     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3070                    + WK-MONTHLY-RATE.
  3071     COMPUTE CP-CALC-PREMIUM ROUNDED = WS-MAX-MON-BEN *
  3072                    CP-ORIGINAL-TERM * WK-D.
  3073
  3074     GO TO 9999-CALC-RATE-PREM-X.
  3075
  3076 2250-CSL-CALC-AH-3.
  3077
  3078     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3079     COMPUTE WK-T = WK-K + 1.
  3080     COMPUTE WK-MONTHLY-RATE-T =
  3081          RT-AH-RATE (WK-T) / 100.
  3082     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3083
  3084     COMPUTE WK-T1 = WK-K * (CP-ORIGINAL-TERM - WK-T).
  3085     IF WK-T1 EQUAL ZEROS
  3086         MOVE ZEROS TO CP-CALC-PREMIUM
  3087         MOVE 'G' TO CP-RETURN-CODE
  3088         GO TO 9999-CALC-RATE-PREM-X.
  3089
  3090     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3091                    WK-MONTHLY-RATE)) / (WK-K * (CP-ORIGINAL-TERM
  3092                    - WK-T)).
  3093     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3094     COMPUTE WK-PREM = ((CP-ORIGINAL-TERM -
  3095                       (WK-K + 1) + (WK-D - 1))) * (WK-C *
  3096                       WS-MAX-TOT-BEN).
  3097     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * (WK-K + 1) *
  3098                    WK-MONTHLY-RATE-T) + WK-PREM.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  59
* ELRATE.cbl
  3099
  3100     GO TO 9999-CALC-RATE-PREM-X.
  3101
  3102 2250-CSL-CALC-AH-4.
  3103     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3104     COMPUTE WK-J = WS-MAX-TOT-BEN / WS-MAX-MON-BEN.
  3105     COMPUTE WK-MONTHLY-RATE-J =
  3106          RT-AH-RATE (WK-J) / 100.
  3107     COMPUTE WK-T = WK-J + 1.
  3108     COMPUTE WK-MONTHLY-RATE-T =
  3109          RT-AH-RATE (WK-T) / 100.
  3110     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3111     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3112                    WK-MONTHLY-RATE)) / ((WK-T - 1) *
  3113                    (CP-ORIGINAL-TERM - WK-T)).
  3114     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3115     COMPUTE WK-PREM = (CP-ORIGINAL-TERM -
  3116                       (WK-J + 1) + (WK-D - 1)) * (WK-C *
  3117                       WS-MAX-TOT-BEN).
  3118     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PREM + ((WK-J + 1) *
  3119                   (WS-MAX-MON-BEN * WK-MONTHLY-RATE-T)).
  3120
  3121     GO TO 9999-CALC-RATE-PREM-X.
  3122
  3123 2300-CALC-DCC-BEN-P-AH.
  3124     IF CP-NO-OF-PMTS NOT NUMERIC
  3125        MOVE +0                  TO CP-NO-OF-PMTS
  3126     END-IF
  3127     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  3128        AND ' ' AND 'M'
  3129        MOVE ' '                 TO CP-PMT-MODE
  3130     END-IF
  3131     EVALUATE CP-PMT-MODE
  3132        WHEN 'W'
  3133           MOVE +7               TO C-DAYS-IN-PMT-PER
  3134           MOVE +52              TO C-PMTS-PER-YEAR
  3135           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3136        WHEN 'B'
  3137           MOVE +14              TO C-DAYS-IN-PMT-PER
  3138           MOVE +26              TO C-PMTS-PER-YEAR
  3139           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3140        WHEN OTHER
  3141           MOVE +30              TO C-DAYS-IN-PMT-PER
  3142           MOVE +12              TO C-PMTS-PER-YEAR
  3143           MOVE CP-LOAN-TERM     TO C-TOT-PMTS
  3144     END-EVALUATE
  3145     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3146     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3147        C-DAYS-IN-PMT-PER)) / (1 + I)
  3148     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  3149     COMPUTE ANGLEN-1 = ANGLEN / Y
  3150     COMPUTE WK3 = CP-NET-BENEFIT-AMT / ANGLEN-1
  3151     if cp-net-benefit-amt = zeros
  3152        compute wk3 = cp-original-benefit - cp-original-premium
  3153     end-if
  3154     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * WK-S
  3155     GO TO 9999-CALC-RATE-PREM-X
  3156     .
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  60
* ELRATE.cbl
  3157 2300-CALC-DCC-MOB-NET-AH.
  3158     IF CP-ALTERNATE-BENEFIT = ZEROS
  3159        CONTINUE
  3160     ELSE
  3161        GO TO 2300-CALC-DCC-MOB-BAL-AH
  3162     END-IF
  3163     MOVE CP-ORIGINAL-TERM       TO M
  3164     MOVE CP-LOAN-TERM           TO N
  3165     IF N = ZEROS
  3166        MOVE M                   TO N
  3167     END-IF
  3168     COMPUTE I = CP-LOAN-APR / +1200
  3169     IF CP-BENEFIT-CD (1:1) = 'S'
  3170        COMPUTE OD = CP-DAYS-TO-1ST-PMT - 30
  3171        COMPUTE WK3 = CP-ORIGINAL-BENEFIT *
  3172        ((M * (M + 1) / 2) + (M * OD / 30)) *
  3173          (WK-S / 1000)
  3174          * 1
  3175        MOVE WK3                 TO CP-CALC-PREMIUM
  3176        GO TO 9999-CALC-RATE-PREM-X
  3177     END-IF
  3178     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3179        / (1 + I)
  3180     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3181          ** ((N - M) * -1))) / I)
  3182     COMPUTE ANGLEN-M = ANGLEN-M / OD
  3183     COMPUTE J = I + (WK-S / +1000)
  3184     COMPUTE WK2 = (1 + J) ** (M * -1)
  3185     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3186     COMPUTE ANGLEM = ((1 - ((1 + J)
  3187          ** (M * -1))) / J) / OD
  3188     IF CP-NET-BENEFIT-AMT = ZEROS
  3189        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3190           * ANGLEM
  3191     END-IF
  3192     COMPUTE RA = CP-NET-BENEFIT-AMT / (ANGLEM + ANGLEN-M)
  3193     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3194          ** ((N - M) * -1))) / I)
  3195     MOVE +0                     TO WK3
  3196     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3197        (WS-COUNTER > M)
  3198        COMPUTE ANGLEM = (1 - ((1 + J)
  3199          ** ((M - WS-COUNTER + 1) * -1))) / J
  3200        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  3201        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  3202        COMPUTE WK3 = WK3 + (WK5-CSL * WK-S / +1000)
  3203     END-PERFORM
  3204     MOVE WK3                    TO CP-CALC-PREMIUM
  3205     GO TO 9999-CALC-RATE-PREM-X
  3206     .
  3207 2300-CALC-DCC-MOB-BAL-AH.
  3208     IF CP-BENEFIT-CD (1:1) = 'S'
  3209        GO TO 2300-CALC-DCC-MOB-BAL-AHSUM
  3210     END-IF
  3211     MOVE CP-ORIGINAL-TERM       TO M
  3212     MOVE CP-LOAN-TERM           TO N
  3213     IF N = ZEROS
  3214        MOVE M                   TO N
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  61
* ELRATE.cbl
  3215     END-IF
  3216     COMPUTE I = CP-LOAN-APR / +1200
  3217     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3218        / (1 + I)
  3219     COMPUTE ANGLEN-M = (WK5 / I) / OD
  3220     COMPUTE J = I + (WK-S / +1000)
  3221     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  3222     MOVE I TO K
  3223     COMPUTE WK2 = (1 + J) ** (M * -1)
  3224     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3225     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  3226          ** ((M - 1) * -1))) / J)
  3227     COMPUTE ANGLEM = ((1 - ((1 + J)
  3228          ** (M * -1))) / J) / OD
  3229     IF CP-NET-BENEFIT-AMT = ZEROS
  3230        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3231           * ANGLEM
  3232     END-IF
  3233     COMPUTE RA = (CP-NET-BENEFIT-AMT * OD -
  3234        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  3235        / ANGLEM-1
  3236     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3237          ** ((N - M) * -1))) / I)
  3238     MOVE +0                     TO WK3
  3239     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3240        (WS-COUNTER > M)
  3241        COMPUTE ANGLEM = (1 - ((1 + J)
  3242          ** ((M - WS-COUNTER) * -1))) / J
  3243        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  3244        COMPUTE WK5-CSL = (RA * ANGLEM)
  3245        + (CP-ALTERNATE-BENEFIT * WK2)
  3246        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  3247          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  3248          (WK-S / 1000)
  3249     END-PERFORM
  3250     MOVE WK3                    TO CP-CALC-PREMIUM
  3251     GO TO 9999-CALC-RATE-PREM-X
  3252     .
  3253 2300-CALC-DCC-MOB-BAL-AHSUM.
  3254     MOVE CP-ORIGINAL-TERM       TO M
  3255     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3256        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  3257        * WK-S / 1000
  3258*    COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3259*       + (M - 1) * ((CP-TERM-OR-EXT-DAYS + 30) - 30) / 30)
  3260*       * WK-S / 1000
  3261     MOVE WK3                    TO CP-CALC-PREMIUM
  3262     GO TO 9999-CALC-RATE-PREM-X
  3263     .
  3264 9999-RATE-NOTFND.
  3265     MOVE '6'                    TO CP-RETURN-CODE.
  3266     GO TO 9999-CALC-RATE-PREM-X.
  3267
  3268 9999-RATE-NOTOPEN.
  3269     MOVE 'D'                    TO CP-RETURN-CODE.
  3270     GO TO 9999-CALC-RATE-PREM-X.
  3271
  3272 9999-CALC-RATE-PREM-X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  62
* ELRATE.cbl
  3273     IF (CP-COMPANY-ID = 'DCC')
  3274        AND (CP-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
  3275        CONTINUE
  3276     ELSE
  3277        IF CP-RATE-DEV-PCT NOT = ZERO
  3278           COMPUTE CP-CALC-PREMIUM =
  3279              CP-CALC-PREMIUM * CP-RATE-DEV-PCT.
  3280
  3281
  3282     MOVE CALCULATION-PASS-AREA  TO  DFHCOMMAREA.
  3283
  3284     IF WS-BROWSE-STARTED
  3285
  3286* EXEC CICS ENDBR
  3287*            DATASET  (ERRATE-FILE-ID)
  3288*       END-EXEC.
  3289     MOVE 0
  3290       TO DFHEIV11
  3291*    MOVE '&2                    $   #00003238' TO DFHEIV0
  3292     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3293     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3294     MOVE X'2020233030303033323338' TO DFHEIV0(25:11)
  3295     CALL 'kxdfhei1' USING DFHEIV0,
  3296           ERRATE-FILE-ID,
  3297           DFHEIV11,
  3298           DFHEIV99
  3299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3300
  3301
  3302
  3303* EXEC CICS RETURN
  3304*    END-EXEC.
  3305*    MOVE '.(                    ''   #00003242' TO DFHEIV0
  3306     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3307     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3308     MOVE X'2020233030303033323432' TO DFHEIV0(25:11)
  3309     CALL 'kxdfhei1' USING DFHEIV0,
  3310           DFHEIV99,
  3311           DFHEIV99,
  3312           DFHEIV99,
  3313           DFHEIV99,
  3314           DFHEIV99,
  3315           DFHEIV99
  3316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3317
  3318
  3319 9100-CONVERT-DATE.
  3320
  3321* EXEC CICS LINK
  3322*        PROGRAM  ('ELDATCV')
  3323*        COMMAREA (DATE-CONVERSION-DATA)
  3324*        LENGTH   (DC-COMM-LENGTH)
  3325*    END-EXEC.
  3326     MOVE 'ELDATCV' TO DFHEIV1
  3327*    MOVE '."C                   (   #00003246' TO DFHEIV0
  3328     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3329     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3330     MOVE X'2020233030303033323436' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  63
* ELRATE.cbl
  3331     CALL 'kxdfhei1' USING DFHEIV0,
  3332           DFHEIV1,
  3333           DATE-CONVERSION-DATA,
  3334           DC-COMM-LENGTH,
  3335           DFHEIV99,
  3336           DFHEIV99,
  3337           DFHEIV99,
  3338           DFHEIV99
  3339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3340
  3341
  3342 9100-EXIT.
  3343     EXIT.
  3344
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  64
* ELRATE.cbl
  3346 10000-NET-TERM SECTION.
  3347*                         COPY ERCNETP.
  3348*****************************************************************
  3349*                                                               *
  3350*                            ERCNETP                            *
  3351*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3352*                            VMOD=2.029                         *
  3353*                                                               *
  3354*****************************************************************.
  3355*
  3356*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS
  3357*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)
  3358*                                   ORIGINAL TERM (S999)
  3359*                                   REMAINING TERM (S999)
  3360*                                   NET PAY OPTION (X)
  3361*                                   LOAN TERM (S999)
  3362*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))
  3363*
  3364*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING
  3365*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,
  3366*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT
  3367*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE
  3368*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE
  3369*    CHARGED.
  3370*
  3371*    OPTIONS - S = NET SIMPLE
  3372*          SPACE = NET PAY  (1 MO. INTEREST)
  3373*              A = NET PAY  (0 MO. INTEREST)
  3374*              I = NET PAY  (2 MO. INTEREST)
  3375*              J = NET PAY  (3 MO. INTEREST)
  3376*              K = NET PAY  (4 MO. INTEREST)
  3377*              T = TRUNCATED  (0 MO. INTEREST)
  3378*              U = TRUNCATED  (1 MO. INTEREST)
  3379*              V = TRUNCATED  (2 MO. INTEREST)
  3380*              W = TRUNCATED  (3 MO. INTEREST)
  3381*              X = TRUNCATED  (4 MO. INTEREST)
  3382*              R = REFUNDS (REGULAR OR TRUNCATED)
  3383******************************************************************
  3384*                   C H A N G E   L O G
  3385*
  3386* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3387*-----------------------------------------------------------------
  3388*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3389* EFFECTIVE    NUMBER
  3390*-----------------------------------------------------------------
  3391* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  3392* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  3393* 120403                   PEMA  ADD SPECIAL TX CALC
  3394* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3395* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3396* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  3397* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  3398* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  3399* 021207                   PEMA  ADD PA NP
  3400* 022107                   PEMA  ADD NH NP AND NP TRUNC
  3401* 032807                   PEMA  ADD VT NP PLUS 2
  3402* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  3403* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  65
* ELRATE.cbl
  3404* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  3405* 110207      TO 'AL' NET PAY CALC
  3406* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  3407* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  3408* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  3409* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  3410* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  3411* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  3412* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  3413* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3414* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  3415* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3416* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  3417* 032612  CR2011110200001  PEMA  AHL CHANGES
  3418* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  3419******************************************************************
  3420
  3421     MOVE N-P-APR     TO ANNUAL-INT-RATE.
  3422     MOVE N-P-ORIG    TO ORIGINAL-TERM.
  3423     MOVE N-P-LOAN    TO LOAN-TERM.
  3424     MOVE N-P-REM     TO REMAINING-TERM.
  3425     MOVE N-P-OPT     TO OPTION-SW.
  3426
  3427     MOVE +0 TO FACTOR.
  3428
  3429     IF ANNUAL-INT-RATE = ZERO
  3430         GO TO 99000-ERROR.
  3431     IF ORIGINAL-TERM = ZERO
  3432         GO TO 99999-RETURN.
  3433     IF REMAINING-TERM = ZERO
  3434         GO TO 99999-RETURN.
  3435     IF REMAINING-TERM GREATER ORIGINAL-TERM
  3436         GO TO 99000-ERROR.
  3437     IF LOAN-TERM = ZERO
  3438         GO TO 99999-RETURN.
  3439     IF LOAN-TERM LESS ORIGINAL-TERM
  3440         GO TO 99000-ERROR.
  3441
  3442*    IF ANNUAL-INT-RATE LESS +2
  3443*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3444*    IF ANNUAL-INT-RATE LESS +2
  3445*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3446*    IF ANNUAL-INT-RATE LESS +2
  3447*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3448
  3449     IF NPO-REFUND
  3450         MOVE '2' TO NP-PROCESS-SW
  3451       ELSE
  3452         IF ORIGINAL-TERM = REMAINING-TERM
  3453            MOVE '1'   TO NP-PROCESS-SW
  3454           ELSE
  3455            MOVE '3'   TO NP-PROCESS-SW.
  3456
  3457     IF NPO-SIMPLE
  3458         MOVE 'S' TO TYPE-SW
  3459     ELSE
  3460         MOVE 'N' TO TYPE-SW.
  3461
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  66
* ELRATE.cbl
  3462     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.
  3463
  3464     COMPUTE V ROUNDED = K1 / (K1 + I).
  3465
  3466     MOVE V     TO VX
  3467                   SV.
  3468
  3469     MOVE +1    TO X1
  3470                   SX.
  3471
  3472     MOVE LOAN-TERM TO MAX-X.
  3473
  3474     COMPUTE X2 = MAX-X - ORIGINAL-TERM.
  3475
  3476     IF MAX-X = +1
  3477        GO TO 10700-COMPUTE-REMAINING-FACTOR.
  3478
  3479     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.
  3480
  3481     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  3482         OR 'DCC'        OR 'NCL') AND
  3483        (NOT NP-REFUND)
  3484        NEXT SENTENCE
  3485     ELSE
  3486     IF LOAN-TERM NOT = ORIGINAL-TERM
  3487        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.
  3488
  3489     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.
  3490
  3491 10500-VX-LOOP.
  3492
  3493***  VX = AMORT. LOAN TERM.
  3494***  SV = AMORT. INSURANCE TERM.
  3495***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.
  3496***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED.
  3497***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)
  3498
  3499     IF X2 = 1
  3500        MOVE V         TO SX
  3501     END-IF
  3502     COMPUTE VX ROUNDED = VX * V.
  3503
  3504     ADD B1 TO X1.
  3505
  3506     IF X1 = REMAINING-TERM
  3507          MOVE VX    TO SV.
  3508
  3509     IF X1 EQUAL SV-MINUS-ONE
  3510        MOVE VX      TO SV-MINUS-ONE.
  3511
  3512     IF X1 = X2
  3513          MOVE VX    TO SX.
  3514
  3515     IF X1 NOT = MAX-X
  3516          GO TO 10500-VX-LOOP.
  3517
  3518 10700-COMPUTE-REMAINING-FACTOR.
  3519*****  WK1 = LOAN TERM AMORT
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  67
* ELRATE.cbl
  3520     COMPUTE WK1 = K1 - VX.
  3521*****  WK2 = INS TERM AMORT
  3522     COMPUTE WK2 = K1 - SV.
  3523*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  3524     COMPUTE WK5 = K1 - SX.
  3525*****  WK6 = INS TERM - 1
  3526     COMPUTE WK6 = K1 - SV-MINUS-ONE.
  3527
  3528     IF NP-RATING
  3529         GO TO 12000-PREMIUM-RATE.
  3530
  3531     IF NP-REFUND
  3532         GO TO 11000-REFUND-CALC.
  3533
  3534     IF NET-STD
  3535         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.
  3536
  3537     IF NET-SMP
  3538         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)
  3539         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)
  3540         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)
  3541         COMPUTE WK3 ROUNDED = WK3 * 1000.
  3542
  3543     IF REMAINING-TERM LESS THAN X2
  3544         MOVE +0 TO WK3.
  3545
  3546     MOVE WK3 TO FACTOR.
  3547
  3548     GO TO 99999-RETURN.
  3549
  3550 11000-REFUND-CALC.
  3551     IF REMAINING-TERM NOT LESS MAX-X
  3552        MOVE +1 TO FACTOR
  3553        GO TO 99999-RETURN.
  3554
  3555     IF REMAINING-TERM LESS +1
  3556        MOVE 0 TO FACTOR
  3557        GO TO 99999-RETURN.
  3558
  3559     COMPUTE WK2 ROUNDED = WK2 / I.
  3560     COMPUTE WK5 ROUNDED = WK5 / I.
  3561     COMPUTE WK1 ROUNDED = WK1 / I.
  3562
  3563     IF (CP-COMPANY-ID EQUAL 'CID')
  3564        AND (CP-STATE-STD-ABBRV = 'MN')
  3565        AND (CP-CERT-EFF-DT > X'A4FF')
  3566        AND (CP-RATE-AS-REG-BALLOON)
  3567        AND (CP-EARN-AS-NET-PAY)
  3568        AND (CP-DEVIATION-CODE NOT = 'LEV')
  3569        CONTINUE
  3570     ELSE
  3571        GO TO 11000-CHECK-MN-LEV-BALLOON
  3572     END-IF
  3573
  3574     COMPUTE R = M - E
  3575     COMPUTE FACTOR = (R - WK2 + WK5) /
  3576        (M - WK1 + WK5)
  3577
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  68
* ELRATE.cbl
  3578     GO TO 99999-RETURN
  3579
  3580      .
  3581 11000-CHECK-MN-LEV-BALLOON.
  3582
  3583     IF (CP-COMPANY-ID EQUAL 'CID')
  3584        AND (CP-STATE-STD-ABBRV = 'MN')
  3585        AND (CP-CERT-EFF-DT > X'A4FF')
  3586        AND (CP-RATE-AS-REG-BALLOON)
  3587        AND (CP-EARN-AS-NET-PAY)
  3588        AND (CP-DEVIATION-CODE = 'LEV')
  3589        CONTINUE
  3590     ELSE
  3591        GO TO 11000-CONTINUE-REFUND
  3592     END-IF
  3593
  3594     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3595     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  3596        ** (M - E)) / I
  3597
  3598     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  3599
  3600     GO TO 99999-RETURN
  3601
  3602     .
  3603 11000-CONTINUE-REFUND.
  3604*    IF CP-GAP-ACTUARIAL
  3605*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  3606*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3607*       COMPUTE WK3 = WK2 / ANGLEN
  3608*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  3609     IF CP-GAP-ACTUARIAL
  3610        COMPUTE ANGLEN = WK1 / ((1 + I) **
  3611           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3612        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  3613     ELSE
  3614        COMPUTE WK3 ROUNDED =
  3615          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  3616     END-IF
  3617
  3618     MOVE WK3  TO FACTOR.
  3619
  3620     GO TO 99999-RETURN.
  3621
  3622 12000-PREMIUM-RATE.
  3623*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST
  3624*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I
  3625*      OPTION - A OR T           = 0 MO,  SO K-I = 1
  3626*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I
  3627*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I
  3628*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I
  3629
  3630     COMPUTE K-I = K1 + I.
  3631     MOVE K-I TO ONE-PLUS-I.
  3632
  3633     IF NPO-ALT OR NPO-TRUNC-0
  3634         MOVE K1 TO K-I.
  3635
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  69
* ELRATE.cbl
  3636     IF NPO-2MO OR NPO-TRUNC-2
  3637         COMPUTE K-I = K1 + (2 * I).
  3638
  3639     IF NPO-3MO OR NPO-TRUNC-3
  3640         COMPUTE K-I = K1 + (3 * I).
  3641
  3642     IF NPO-4MO OR NPO-TRUNC-4
  3643         COMPUTE K-I = K1 + (4 * I).
  3644
  3645     COMPUTE RA ROUNDED = 1 -
  3646             ((X2 * (X2 + 1)) /
  3647              (N *  (N  + 1))).
  3648
  3649     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  3650        (CP-CSL-VALID-NP-BENEFIT-CD)
  3651        NEXT SENTENCE
  3652     ELSE
  3653        GO TO XXXX-CHECK-DISCOUNT-5.
  3654
  3655     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3656     MOVE ' ' TO DC-OPTION-CODE.
  3657     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3658
  3659     IF DATE-CONVERSION-ERROR
  3660        MOVE '2'                 TO CP-RETURN-CODE
  3661        MOVE ZEROS               TO FACTOR
  3662                                    CP-CALC-PREMIUM
  3663         GO TO 99999-RETURN.
  3664
  3665     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE
  3666     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1
  3667     MOVE ' ' TO DC-OPTION-CODE
  3668     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3669
  3670     IF DATE-CONVERSION-ERROR
  3671        MOVE '2'                 TO CP-RETURN-CODE
  3672        MOVE ZEROS               TO FACTOR
  3673                                    CP-CALC-PREMIUM
  3674         GO TO 99999-RETURN.
  3675
  3676     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.
  3677
  3678     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).
  3679
  3680     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30
  3681        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *
  3682        CP-PAY-FREQUENCY / 365) * I
  3683     ELSE
  3684        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *
  3685        CP-PAY-FREQUENCY / 365) * I.
  3686
  3687     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /
  3688     13).
  3689
  3690     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *
  3691     (N - ( ANGLEN-1 / WK3)).
  3692
  3693     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  70
* ELRATE.cbl
  3694
  3695     COMPUTE WS-CALC-FREQ-RATE EQUAL
  3696       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.
  3697
  3698     COMPUTE WS-Y-X-FACTOR EQUAL
  3699       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /
  3700       WS-CALC-FREQ-RATE).
  3701
  3702     COMPUTE WS-ODD-DAY-UNITS EQUAL
  3703       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.
  3704
  3705     COMPUTE WS-X-Y-FACTOR EQUAL
  3706       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).
  3707
  3708     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *
  3709       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *
  3710       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).
  3711
  3712     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.
  3713
  3714     GO TO 99999-RETURN.
  3715
  3716 XXXX-CHECK-DISCOUNT-5.
  3717
  3718     IF WS-DISCOUNT-OPTION EQUAL '5'
  3719        NEXT SENTENCE
  3720     ELSE
  3721        GO TO 12000-CHECK-CLIENT.
  3722
  3723      COMPUTE ANGLEN EQUAL WK1 / I.
  3724
  3725      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  3726
  3727      COMPUTE WK3 EQUAL
  3728        (12 *
  3729        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -
  3730        CP-ORIGINAL-BENEFIT)) /
  3731        APR100.
  3732
  3733     COMPUTE WK3 EQUAL
  3734        (WK3 * CP-PREMIUM-RATE) / +1000.
  3735
  3736     COMPUTE WK3 EQUAL
  3737        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).
  3738
  3739      MOVE WK3 TO CP-CALC-PREMIUM.
  3740
  3741     GO TO 99999-RETURN.
  3742
  3743 12000-CHECK-CLIENT.
  3744
  3745     IF (CP-COMPANY-ID EQUAL 'MON') AND
  3746        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3747        (CP-TRUNCATED-LIFE)
  3748        NEXT SENTENCE
  3749     ELSE
  3750        GO TO 12000-CHECK-NEXT.
  3751
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  71
* ELRATE.cbl
  3752     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3753
  3754     COMPUTE ANGLEN EQUAL WK1 / I.
  3755     COMPUTE ANGLEM EQUAL WK2 / I.
  3756
  3757     COMPUTE FM EQUAL
  3758                    (((ONE-PLUS-I ** M) * I * M) /
  3759                    ((ONE-PLUS-I ** M) - 1))
  3760                    - 1.
  3761
  3762     COMPUTE FN EQUAL
  3763                    (((ONE-PLUS-I ** N) * I * N) /
  3764                    ((ONE-PLUS-I ** N) - 1))
  3765                    - 1.
  3766
  3767     COMPUTE FNM EQUAL
  3768                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /
  3769                    ((ONE-PLUS-I ** (N - M)) - 1))
  3770                    - 1.
  3771
  3772     COMPUTE GR EQUAL
  3773                    (WS-WORK-RATE * ANGLEM * I) /
  3774                    (M - ANGLEM).
  3775
  3776     COMPUTE ODF EQUAL
  3777                     (1 +
  3778                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /
  3779                     360)) /
  3780                     ONE-PLUS-I.
  3781
  3782     COMPUTE OD EQUAL
  3783                    (1 + (ODF * (FN / I - 1))) +
  3784                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).
  3785
  3786     COMPUTE WK3 EQUAL
  3787*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /
  3788                    ((1 + FN) * ODF *
  3789                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /
  3790                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *
  3791                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).
  3792
  3793     COMPUTE TRUNC-PMT EQUAL WK3 / N.
  3794     COMPUTE WK3 EQUAL TRUNC-PMT * N.
  3795
  3796     COMPUTE WK3 EQUAL
  3797                    (WK3 / (ODF * (1 + FN))) -
  3798*                   CP-ORIGINAL-BENEFIT.
  3799                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).
  3800
  3801      MOVE WK3 TO CP-CALC-PREMIUM.
  3802
  3803     GO TO 99999-RETURN.
  3804
  3805 12000-CHECK-NEXT.
  3806
  3807     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'
  3808        NEXT SENTENCE
  3809     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  72
* ELRATE.cbl
  3810        GO TO 12000-CHECK-PA-TRUNC.
  3811
  3812      IF WS-WORK-DIS-RATE EQUAL +0
  3813         MOVE '7'                TO CP-RETURN-CODE
  3814         MOVE ZEROS              TO FACTOR
  3815                                    CP-CALC-PREMIUM
  3816         GO TO 99999-RETURN.
  3817
  3818      COMPUTE ANGLEN EQUAL WK1 / I.
  3819
  3820      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  3821
  3822      IF WS-WORK-DIS-RATE EQUAL APR100
  3823         ADD .00001 TO APR100.
  3824
  3825      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).
  3826      COMPUTE WK9 EQUAL 12 / (12 + APR100).
  3827
  3828     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3829        / (1 + I)
  3830     COMPUTE ANGLEN-1 = ANGLEN / Y
  3831      IF CP-COMPANY-ID EQUAL 'CDL'
  3832         COMPUTE WK3 EQUAL
  3833
  3834          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *
  3835          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *
  3836
  3837          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  3838
  3839          ((WK8 ** N) /
  3840          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  3841
  3842          ((WK9 ** N) /
  3843          (APR100 * (APR100 - WS-WORK-DIS-RATE))))
  3844
  3845      ELSE
  3846         COMPUTE WK3 EQUAL
  3847
  3848          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  3849          (12 + WS-WORK-DIS-RATE) * 12) *
  3850
  3851          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  3852
  3853          ((WK8 ** N) /
  3854          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  3855
  3856          ((WK9 ** N) /
  3857          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).
  3858
  3859      COMPUTE WK3 EQUAL
  3860          (WK3 * CP-PREMIUM-RATE) / +1000.
  3861
  3862      MOVE WK3 TO CP-CALC-PREMIUM.
  3863
  3864     GO TO 99999-RETURN.
  3865
  3866 12000-CHECK-PA-TRUNC.
  3867
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  73
* ELRATE.cbl
  3868     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3869        (CP-STATE-STD-ABBRV EQUAL 'PA') AND
  3870        (CP-EARN-AS-NET-PAY) AND
  3871        (CP-TRUNCATED-LIFE)
  3872        NEXT SENTENCE
  3873     ELSE
  3874        GO TO 12000-CHECK-MD-TRUNC.
  3875
  3876     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3877
  3878     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3879     COMPUTE ANGLEN EQUAL WK1 / I.
  3880
  3881     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3882
  3883     COMPUTE WK3 EQUAL
  3884        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *
  3885        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).
  3886
  3887     MOVE WK3 TO CP-CALC-PREMIUM.
  3888
  3889     GO TO 99999-RETURN.
  3890
  3891 12000-CHECK-MD-TRUNC.
  3892
  3893     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3894        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3895        (CP-EARN-AS-NET-PAY) AND
  3896        (CP-TRUNCATED-LIFE)
  3897        NEXT SENTENCE
  3898     ELSE
  3899        GO TO 12000-CHECK-MD.
  3900
  3901     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3902
  3903     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3904     COMPUTE ANGLEM EQUAL WK2 / I.
  3905     COMPUTE ANGLEN EQUAL WK1 / I.
  3906
  3907     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3908
  3909     COMPUTE WK3 EQUAL
  3910        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  3911        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /
  3912        (ANGLEN-1 * (M - ANGLEM))).
  3913
  3914     MOVE WK3 TO CP-CALC-PREMIUM.
  3915
  3916     GO TO 99999-RETURN.
  3917
  3918 12000-CHECK-MD.
  3919
  3920     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3921        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3922        (CP-EARN-AS-NET-PAY)
  3923        NEXT SENTENCE
  3924     ELSE
  3925        GO TO 12000-CHECK-ME-TRUNC.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  74
* ELRATE.cbl
  3926
  3927     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3928
  3929     COMPUTE WK3 EQUAL
  3930        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.
  3931
  3932     MOVE WK3 TO CP-CALC-PREMIUM.
  3933
  3934     GO TO 99999-RETURN.
  3935
  3936 12000-CHECK-ME-TRUNC.
  3937
  3938     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  3939        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3940        AND (CP-EARN-AS-NET-PAY)
  3941        AND (CP-TRUNCATED-LIFE)
  3942        CONTINUE
  3943     ELSE
  3944        GO TO 12000-CHECK-CID-WA-FARMPLAN
  3945     END-IF
  3946
  3947     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3948     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3949     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3950     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3951     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3952     COMPUTE ANGLEN-1 = ANGLEN / Y
  3953     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3954     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3955     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  3956     COMPUTE WK3
  3957        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  3958        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  3959            * (1 / (1.0635 ** (M / 12))))
  3960*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).
  3961*    COMPUTE WK9 EQUAL
  3962*       1 / (1 + (.045 * (N - M) / 24))
  3963*    COMPUTE WK7 EQUAL
  3964*       WS-WORK-RATE * 20 / (M + 1).
  3965*    COMPUTE WK3 EQUAL
  3966*       ((( N - ANGLEN) * WK7 * WK8) /
  3967*       (10 * ANGLEN-1 * I)) -
  3968*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /
  3969*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).
  3970*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  3971*
  3972     MOVE WK3 TO CP-CALC-PREMIUM.
  3973
  3974     GO TO 99999-RETURN
  3975      .
  3976 12000-CHECK-CID-WA-FARMPLAN.
  3977
  3978     IF (CP-COMPANY-ID EQUAL 'CID')
  3979        AND (CP-STATE-STD-ABBRV = 'WA')
  3980        AND (CP-FARM-PLAN)
  3981        CONTINUE
  3982     ELSE
  3983        GO TO 12000-CHECK-CID-FARMPLAN
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  75
* ELRATE.cbl
  3984     END-IF
  3985
  3986     move cp-original-term       to n
  3987     move cp-no-of-pmts          TO C-TOT-PMTS
  3988     compute c-pmts-per-year = 12 / cp-pay-frequency
  3989     move cp-pay-frequency       to m
  3990     compute c-days-in-pmt-per = 365 / c-pmts-per-year
  3991     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3992     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  3993
  3994     COMPUTE Y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  3995        (m * 30))) / (1 + I)
  3996     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3997        ** CP-PAY-FREQUENCY) - 1
  3998     COMPUTE TI = (cp-days-to-1st-pmt - (M * 30)) / 30
  3999     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4000        ** TI) / WS-WORK-DIS-RATE
  4001     COMPUTE WK2 = (1 - (1 / (1 + J)) ** c-tot-pmts) / J
  4002     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (c-tot-pmts - 1)) / J
  4003     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4004        ** m) / WS-WORK-DIS-RATE
  4005     COMPUTE WK2 = WK2 * (1 + J)
  4006     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  4007     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  4008     COMPUTE WK3 = WK3 * (1 + J)
  4009     COMPUTE WK5 = (WK3 - (c-tot-pmts - 1) * (1 / (1 + J)
  4010        ** (c-tot-pmts - 1))) / J
  4011     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4012        ((c-tot-pmts * WK2) - WK5)) + (c-tot-pmts * WK1)) *
  4013        (CP-PREMIUM-RATE / 1000)
  4014     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / (anglen / y)
  4015     COMPUTE WK6 = (WK7 * GR)
  4016
  4017     MOVE WK6 TO CP-CALC-PREMIUM
  4018
  4019     GO TO 99999-RETURN
  4020
  4021     .
  4022 12000-CHECK-CID-FARMPLAN.
  4023     IF (CP-COMPANY-ID EQUAL 'CID')
  4024        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  4025           OR 'IN' OR 'AZ')
  4026        AND (CP-FARM-PLAN)
  4027        CONTINUE
  4028     ELSE
  4029        GO TO 12000-CHECK-SC-CID
  4030     END-IF
  4031     COMPUTE N = M / CP-PAY-FREQUENCY
  4032     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4033     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  4034        ** CP-PAY-FREQUENCY) - 1
  4035     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  4036     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4037        ** TI) / WS-WORK-DIS-RATE
  4038     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  4039     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  4040     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4041        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  76
* ELRATE.cbl
  4042     COMPUTE WK2 = WK2 * (1 + J)
  4043     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  4044     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  4045     COMPUTE WK3 = WK3 * (1 + J)
  4046     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  4047        ** (N - 1))) / J
  4048     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4049        ((N * WK2) - WK5)) + (N * WK1)) *
  4050        (CP-PREMIUM-RATE / 1000)
  4051     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  4052     COMPUTE WK6 = (WK7 * GR)
  4053     MOVE WK6 TO CP-CALC-PREMIUM
  4054     GO TO 99999-RETURN
  4055     .
  4056 12000-CHECK-SC-CID.
  4057     IF (CP-COMPANY-ID EQUAL 'CID')
  4058        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  4059        AND (CP-EARN-AS-NET-PAY)
  4060        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  4061        CONTINUE
  4062     ELSE
  4063        GO TO 12000-CHECK-AL-CID
  4064     END-IF
  4065     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4066     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4067     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4068     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4069     COMPUTE ANGLEN-1 = ANGLEN / Y
  4070     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  4071        / 12)) / ((M + 1) / 2)
  4072     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4073     COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  4074        + 6 * M) * (WK2 / 100) * (1 + I)
  4075     MOVE WK3 TO CP-CALC-PREMIUM
  4076     GO TO 99999-RETURN
  4077     .
  4078 12000-CHECK-AL-CID.
  4079     IF (CP-COMPANY-ID EQUAL 'CID')
  4080        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  4081        AND (CP-EARN-AS-NET-PAY)
  4082        CONTINUE
  4083     ELSE
  4084        GO TO 12000-CHECK-NH-CID
  4085     END-IF
  4086     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4087     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4088     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4089     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4090                   / (1 + I)
  4091     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4092     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4093     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  4094        (CP-PREMIUM-RATE / 1000)
  4095     MOVE WK3 TO CP-CALC-PREMIUM
  4096     GO TO 99999-RETURN
  4097     .
  4098 12000-CHECK-NH-CID.
  4099     IF (CP-COMPANY-ID EQUAL 'CID')
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  77
* ELRATE.cbl
  4100        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  4101        AND (CP-EARN-AS-NET-PAY)
  4102        CONTINUE
  4103     ELSE
  4104        GO TO 12000-CHECK-PA-CID
  4105     END-IF
  4106     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4107     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4108     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4109                   / (1 + I)
  4110     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4111     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4112     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4113        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  4114     MOVE WK3 TO CP-CALC-PREMIUM
  4115     GO TO 99999-RETURN
  4116     .
  4117 12000-CHECK-PA-CID.
  4118     IF (CP-COMPANY-ID EQUAL 'CID')
  4119        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  4120        AND (CP-EARN-AS-NET-PAY)
  4121        CONTINUE
  4122     ELSE
  4123        GO TO 12000-CHECK-ME-CID
  4124     END-IF
  4125
  4126     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4127     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4128     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4129     COMPUTE ANGLEN-1 = ANGLEN / Y
  4130     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  4131     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4132     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  4133     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4134        * WK5
  4135     MOVE WK3 TO CP-CALC-PREMIUM
  4136     GO TO 99999-RETURN
  4137     .
  4138 12000-CHECK-ME-CID.
  4139     IF (CP-COMPANY-ID EQUAL 'CID')
  4140        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  4141        AND (CP-EARN-AS-NET-PAY)
  4142        CONTINUE
  4143     ELSE
  4144        GO TO 12000-CHECK-VT-TRUNC
  4145     END-IF
  4146     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4147     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4148     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4149     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4150     COMPUTE ANGLEN-1 = ANGLEN / Y
  4151     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4152     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4153     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4154        * WK5
  4155     MOVE WK3 TO CP-CALC-PREMIUM
  4156     GO TO 99999-RETURN
  4157     .
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  78
* ELRATE.cbl
  4158 12000-CHECK-VT-TRUNC.
  4159
  4160     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4161        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4162        (CP-EARN-AS-NET-PAY) AND
  4163        (CP-TRUNCATED-LIFE)
  4164        NEXT SENTENCE
  4165     ELSE
  4166        GO TO 12000-CHECK-VT.
  4167
  4168      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4169
  4170      COMPUTE ANGLEN EQUAL WK1 / I.
  4171
  4172      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4173
  4174      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.
  4175      COMPUTE WK9 EQUAL
  4176        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /
  4177        ((.0054 - I) / (1 + I)).
  4178      COMPUTE WK7 EQUAL
  4179        (1 - (1 / 1.0054) ** (M - 1)) / .0054.
  4180      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  4181        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).
  4182
  4183      MOVE WK3 TO CP-CALC-PREMIUM.
  4184
  4185     GO TO 99999-RETURN.
  4186
  4187 12000-CHECK-VT.
  4188
  4189     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4190        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4191        (CP-EARN-AS-NET-PAY)
  4192        NEXT SENTENCE
  4193     ELSE
  4194        GO TO 12000-CHECK-MINN-WDS.
  4195
  4196      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4197
  4198      COMPUTE ANGLEN EQUAL WK1 / I.
  4199
  4200      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4201
  4202      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /
  4203                        (ANGLEN-1 * I)) *
  4204
  4205                        (((1.0054 ** N - 1) /
  4206                        (1.0054 ** (N - 1) * .0054)) -
  4207
  4208                        ((V * (1 - 1.0054 ** N * VX)) /
  4209                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))).
  4210
  4211      MOVE WK3 TO CP-CALC-PREMIUM.
  4212
  4213     GO TO 99999-RETURN.
  4214
  4215 12000-CHECK-MINN-WDS.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  79
* ELRATE.cbl
  4216
  4217     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4218        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4219        (CP-EARN-AS-NET-PAY)
  4220        NEXT SENTENCE
  4221     ELSE
  4222        GO TO 12000-CHECK-MINN-BALL-LEV.
  4223
  4224     COMPUTE ANGLEN EQUAL WK1 / I.
  4225     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *
  4226              (N / +12) * (2 / (N + 1)).
  4227     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *
  4228         WK3 * ((N - ANGLEN) / I).
  4229
  4230      MOVE WK3 TO CP-CALC-PREMIUM.
  4231
  4232     GO TO 99999-RETURN.
  4233
  4234 12000-CHECK-MINN-BALL-LEV.
  4235
  4236     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4237        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4238        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  4239        (CP-EARN-AS-REG-BALLOON)
  4240        NEXT SENTENCE
  4241     ELSE
  4242        GO TO 12000-CHECK-MINN-BALL.
  4243
  4244     COMPUTE ANGLEN EQUAL WK1 / I.
  4245
  4246     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.
  4247
  4248     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4249        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).
  4250
  4251     MOVE WK3 TO CP-CALC-PREMIUM.
  4252
  4253     GO TO 99999-RETURN.
  4254
  4255 12000-CHECK-MINN-BALL.
  4256
  4257     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4258        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4259        (CP-EARN-AS-REG-BALLOON)
  4260        NEXT SENTENCE
  4261     ELSE
  4262        GO TO 12000-CHECK-CID-MN-BALL.
  4263
  4264     COMPUTE ANGLEN EQUAL WK1 / I.
  4265     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4266
  4267     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4268     / +100 * (N - 1) / 12 * 2 / N *
  4269     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).
  4270
  4271      MOVE WK3 TO CP-CALC-PREMIUM.
  4272
  4273     GO TO 99999-RETURN.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  80
* ELRATE.cbl
  4274
  4275 12000-CHECK-CID-MN-BALL.
  4276     IF (CP-COMPANY-ID EQUAL 'CID')
  4277        AND (CP-STATE-STD-ABBRV = 'MN')
  4278        AND (CP-CERT-EFF-DT > X'A4FF')
  4279        AND (CP-EARN-AS-REG-BALLOON)
  4280        CONTINUE
  4281     ELSE
  4282        GO TO 12000-CHECK-CID-MN-FARM
  4283     END-IF
  4284     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4285     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4286     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  4287     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4288     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4289     COMPUTE V = 1 / (1 + I)
  4290     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4291     COMPUTE Y = (1 + (D * I) / +30)
  4292        / (1 + I)
  4293     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  4294        * CP-PREMIUM-RATE / 1000
  4295*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  4296*       MOVE CP-MONTHLY-PAYMENT  TO GR
  4297*    ELSE
  4298*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  4299*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  4300*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  4301*       DISPLAY ' BALLOON TOP ' WK6
  4302*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  4303*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  4304*          / 100
  4305*       DISPLAY ' BALLOON BOTTOM ' WK7
  4306*       COMPUTE GR = WK6 / WK7
  4307*       DISPLAY ' BALLOON PAYMENT ' GR
  4308*    END-IF
  4309     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  4310     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  4311        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  4312     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  4313     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  4314        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  4315           (CP-ALTERNATE-BENEFIT * (M + 1)))
  4316           * CP-PREMIUM-RATE / 1000
  4317     MOVE WK3                    TO CP-CALC-PREMIUM
  4318     GO TO 99999-RETURN.
  4319     .
  4320 12000-CHECK-CID-MN-FARM.
  4321
  4322     IF (CP-COMPANY-ID EQUAL 'CID')
  4323        AND (CP-STATE-STD-ABBRV = 'MN')
  4324        AND (CP-CERT-EFF-DT > X'A4FF')
  4325        AND (CP-EARN-AS-FARM-PLAN)
  4326        CONTINUE
  4327     ELSE
  4328        GO TO 12000-CHECK-NC-WDS
  4329     END-IF
  4330
  4331     EVALUATE CP-PMT-MODE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  81
* ELRATE.cbl
  4332        WHEN 'B'
  4333           MOVE +14              TO C-DAYS-IN-PMT-PER
  4334           MOVE +26              TO C-PMTS-PER-YEAR
  4335           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4336        WHEN 'S'
  4337           MOVE +15              TO C-DAYS-IN-PMT-PER
  4338           MOVE +24              TO C-PMTS-PER-YEAR
  4339           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4340        WHEN 'T'
  4341           MOVE +360             TO C-DAYS-IN-PMT-PER
  4342           MOVE +1               TO C-PMTS-PER-YEAR
  4343           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4344        WHEN 'W'
  4345           MOVE +7               TO C-DAYS-IN-PMT-PER
  4346           MOVE +52              TO C-PMTS-PER-YEAR
  4347           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4348        WHEN 'B'
  4349           MOVE +14              TO C-DAYS-IN-PMT-PER
  4350           MOVE +26              TO C-PMTS-PER-YEAR
  4351           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4352        WHEN OTHER
  4353           move cp-no-of-pmts    to c-tot-pmts
  4354           if cp-pay-frequency > zeros
  4355              compute c-pmts-per-year =
  4356                 12 / cp-pay-frequency
  4357              compute c-days-in-pmt-per = 360 / c-pmts-per-year
  4358           else
  4359              MOVE +30           TO C-DAYS-IN-PMT-PER
  4360              MOVE +12           TO C-PMTS-PER-YEAR
  4361              MOVE CP-LOAN-TERM  TO C-TOT-PMTS
  4362           end-if
  4363     END-EVALUATE
  4364
  4365     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4366
  4367     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  4368        C-DAYS-IN-PMT-PER)) / (1 + I)
  4369
  4370     compute cp-premium-rate =
  4371        cp-premium-rate * 12 / c-pmts-per-year
  4372     move c-tot-pmts to n m
  4373     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4374     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4375     COMPUTE ANGLEN-1 = ANGLEN / Y
  4376     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4377
  4378     compute wk3 = wk3 * ((m - (anglen - anglen-m)) / i) *
  4379        (cp-premium-rate / 100)
  4380
  4381
  4382     MOVE WK3                    TO CP-CALC-PREMIUM
  4383
  4384     GO TO 99999-RETURN.
  4385
  4386     .
  4387 12000-CHECK-NC-WDS.
  4388
  4389     IF (CP-COMPANY-ID EQUAL 'WDS') AND
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  82
* ELRATE.cbl
  4390        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4391        (CP-EARN-AS-NET-PAY)
  4392        NEXT SENTENCE
  4393     ELSE
  4394        GO TO 12000-CHECK-NC-BALL-LEV.
  4395
  4396     COMPUTE WK4 EQUAL N * (1 + I * 2).
  4397     COMPUTE ANGLEN EQUAL WK1 / I.
  4398     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4399              CP-PREMIUM-RATE / +100 *
  4400              N / +12 * 2 / (N + 1) *
  4401              (WK4 - ANGLEN) / (I * ANGLEN).
  4402
  4403      MOVE WK3 TO CP-CALC-PREMIUM.
  4404
  4405     GO TO 99999-RETURN.
  4406
  4407 12000-CHECK-NC-BALL-LEV.
  4408
  4409     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4410        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4411        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  4412        (CP-EARN-AS-REG-BALLOON)
  4413        NEXT SENTENCE
  4414     ELSE
  4415        GO TO 12000-CHECK-NC-BALL.
  4416
  4417     COMPUTE ANGLEN EQUAL WK1 / I.
  4418
  4419**** VX = 1 / (1 + I)**N.
  4420
  4421     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4422        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).
  4423
  4424     MOVE WK3 TO CP-CALC-PREMIUM.
  4425
  4426     GO TO 99999-RETURN.
  4427
  4428 12000-CHECK-NC-BALL.
  4429
  4430     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4431        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4432        (CP-EARN-AS-REG-BALLOON)
  4433        NEXT SENTENCE
  4434     ELSE
  4435        GO TO 12000-CHECK-MINN-TRUNC.
  4436
  4437     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).
  4438     COMPUTE ANGLEN EQUAL WK1 / I.
  4439     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4440**** VX = 1 / (1 + I)**N.
  4441
  4442     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4443     / +100 * (N - 1) / 12 * 2 / N *
  4444     (WK4 - ANGLEN-1) / (I * ANGLEN-1).
  4445
  4446      MOVE WK3 TO CP-CALC-PREMIUM.
  4447
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  83
* ELRATE.cbl
  4448     GO TO 99999-RETURN.
  4449
  4450 12000-CHECK-MINN-TRUNC.
  4451
  4452     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4453        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4454        (M GREATER THAN +63) AND
  4455        (CP-EARN-AS-NET-PAY) AND
  4456        (CP-TRUNCATED-LIFE)
  4457        NEXT SENTENCE
  4458     ELSE
  4459        GO TO 12000-CHECK-MINN.
  4460
  4461      COMPUTE ANGLEN EQUAL WK1 / I.
  4462      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4463
  4464      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4465
  4466      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4467       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4468       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).
  4469
  4470      MOVE WK3 TO CP-CALC-PREMIUM.
  4471
  4472     GO TO 99999-RETURN.
  4473
  4474 12000-CHECK-MINN.
  4475
  4476     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4477        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4478        (M GREATER THAN +63) AND
  4479        (CP-EARN-AS-NET-PAY)
  4480        NEXT SENTENCE
  4481     ELSE
  4482        GO TO 12000-CHECK-MONTANA-TRUNC.
  4483
  4484      COMPUTE ANGLEN EQUAL WK1 / I.
  4485
  4486      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4487
  4488      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4489       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4490       (((N - ANGLEN) / I) + (2 * N)).
  4491
  4492      MOVE WK3 TO CP-CALC-PREMIUM.
  4493
  4494     GO TO 99999-RETURN.
  4495
  4496 12000-CHECK-MONTANA-TRUNC.
  4497
  4498     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4499        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4500        (M GREATER THAN +63) AND
  4501        (CP-EARN-AS-NET-PAY) AND
  4502        (CP-TRUNCATED-LIFE)
  4503        NEXT SENTENCE
  4504     ELSE
  4505        GO TO 12000-CHECK-MONTANA.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  84
* ELRATE.cbl
  4506
  4507      COMPUTE ANGLEN EQUAL WK1 / I.
  4508      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4509
  4510      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4511
  4512      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4513      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4514       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).
  4515
  4516      MOVE WK3 TO CP-CALC-PREMIUM.
  4517
  4518     GO TO 99999-RETURN.
  4519
  4520 12000-CHECK-MONTANA.
  4521
  4522     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4523        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4524        (M GREATER THAN +63) AND
  4525        (CP-EARN-AS-NET-PAY)
  4526        NEXT SENTENCE
  4527     ELSE
  4528        GO TO 12001-CONTINUE-NCL-TRUNC.
  4529
  4530      COMPUTE ANGLEN EQUAL WK1 / I.
  4531
  4532      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4533
  4534      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4535       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4536       (((N - ANGLEN) / I) + (4 * N)).
  4537
  4538      MOVE WK3 TO CP-CALC-PREMIUM.
  4539
  4540     GO TO 99999-RETURN.
  4541
  4542 12001-CONTINUE-NCL-TRUNC.
  4543
  4544     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4545        (CP-EARN-AS-NET-PAY) AND
  4546        (CP-TRUNCATED-LIFE)
  4547        NEXT SENTENCE
  4548     ELSE
  4549        GO TO 12001-CONTINUE-NCL.
  4550
  4551      COMPUTE ANGLEN EQUAL WK1 / I.
  4552      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4553
  4554      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4555
  4556      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *
  4557      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /
  4558      (ANGLEN-1 * (N + 1) * I).
  4559
  4560      MOVE WK3 TO CP-CALC-PREMIUM.
  4561
  4562     GO TO 99999-RETURN.
  4563
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  85
* ELRATE.cbl
  4564 12001-CONTINUE-NCL.
  4565
  4566     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4567        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4568        (CP-EARN-AS-NET-PAY)
  4569        GO TO 12001-CHECK-NC-NET-PLUS3.
  4570
  4571     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4572        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4573        (CP-EARN-AS-NET-PAY)
  4574        GO TO 12001-CHECK-CA.
  4575
  4576     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4577        (CP-EARN-AS-NET-PAY)
  4578        NEXT SENTENCE
  4579     ELSE
  4580        GO TO 12000-CONTINUE-NET.
  4581
  4582      COMPUTE ANGLEN EQUAL WK1 / I.
  4583      MOVE ANGLEN                TO ANGLEN-1.
  4584
  4585      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4586
  4587      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4588       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4589       ((N - ANGLEN) / I).
  4590
  4591      MOVE WK3 TO CP-CALC-PREMIUM.
  4592
  4593     GO TO 99999-RETURN.
  4594
  4595 12000-CONTINUE-NET.
  4596
  4597     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  4598        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  4599        (CP-EARN-AS-NET-PAY)
  4600        NEXT SENTENCE
  4601     ELSE
  4602        GO TO 12001-CONTINUE-MINN.
  4603
  4604      COMPUTE ANGLEN EQUAL WK6 / I.
  4605      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).
  4606
  4607      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).
  4608      COMPUTE WK3 EQUAL (M  * WK7) - 1.
  4609      COMPUTE WK3 EQUAL (WK3 / I) *
  4610       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).
  4611
  4612      IF CP-R-MAX-TOT-BEN NOT NUMERIC
  4613         MOVE +0 TO CP-R-MAX-TOT-BEN.
  4614
  4615      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)
  4616
  4617      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND
  4618         (CP-R-MAX-TOT-BEN NOT EQUAL +0)
  4619         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).
  4620
  4621      MOVE WK3 TO CP-CALC-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  86
* ELRATE.cbl
  4622
  4623     GO TO 99999-RETURN.
  4624
  4625 12001-CONTINUE-MINN.
  4626
  4627     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4628        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  4629        (CP-TRUNCATED-LIFE)
  4630        NEXT SENTENCE
  4631     ELSE
  4632        GO TO 12001-CHECK-RI-GTL.
  4633
  4634      COMPUTE ANGLEN EQUAL WK1 / I.
  4635      COMPUTE ANGLEM EQUAL WK2 / I.
  4636
  4637      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /
  4638       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE
  4639       * M / 2400) * 1000 + .5) / 1000000.
  4640
  4641      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT
  4642       - CP-ORIGINAL-PREMIUM) / (1 - WK3).
  4643
  4644     GO TO 99999-RETURN.
  4645
  4646 12001-CHECK-RI-GTL.
  4647
  4648     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4649        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  4650        (CP-EARN-AS-NET-PAY)
  4651        NEXT SENTENCE
  4652     ELSE
  4653        GO TO 12001-CHECK-RI-LEASE-GTL.
  4654
  4655      COMPUTE ANGLEN EQUAL WK1 / I.
  4656*     COMPUTE ANGLEM EQUAL WK2 / I.
  4657
  4658      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *
  4659               (1 + WS-WORK-DIS-RATE * N).
  4660      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *
  4661         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.
  4662
  4663
  4664     GO TO 99999-RETURN.
  4665
  4666 12001-CHECK-RI-LEASE-GTL.
  4667
  4668     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4669        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  4670        (CP-SPECIAL-CALC-CD EQUAL 'H')
  4671        NEXT SENTENCE
  4672     ELSE
  4673        GO TO 12001-CHECK-OR-GTL.
  4674
  4675     COMPUTE ANGLEN EQUAL WK1 / I.
  4676
  4677     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *
  4678        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))
  4679                        /
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  87
* ELRATE.cbl
  4680        (1000 * I * (1 + .0021 * N)).
  4681     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +
  4682       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))
  4683                            /
  4684       (1000 * (1 + .0027 * (N + 1))).
  4685
  4686     GO TO 99999-RETURN.
  4687
  4688 12001-CHECK-OR-GTL.
  4689
  4690     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4691        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  4692        (CP-EARN-AS-NET-PAY)
  4693        NEXT SENTENCE
  4694     ELSE
  4695        GO TO 12001-CHECK-GA-GTL.
  4696
  4697     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4698     COMPUTE ANGLEN EQUAL WK1 / I.
  4699
  4700     IF M LESS THAN +64
  4701        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  4702         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))
  4703                   /
  4704         (I * ANGLEN * (N - (N - M) + 1) * 600)
  4705        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT
  4706     ELSE
  4707        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  4708        CP-PREMIUM-RATE * (1 + I))
  4709                  /
  4710        (+1000 * I * ANGLEN)
  4711        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  4712*    MOVE WK3 TO CP-CALC-PREMIUM.
  4713     GO TO 99999-RETURN.
  4714
  4715 12001-CHECK-GA-GTL.
  4716
  4717     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4718        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  4719        (CP-EARN-AS-NET-PAY)
  4720*       (CP-TRUNCATED-LIFE)
  4721        NEXT SENTENCE
  4722     ELSE
  4723        GO TO 12001-CHECK-MA-GTL.
  4724
  4725     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4726     COMPUTE ANGLEN EQUAL WK1 / I.
  4727
  4728     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.
  4729     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *
  4730      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).
  4731     MOVE WK3 TO CP-CALC-PREMIUM.
  4732
  4733     GO TO 99999-RETURN.
  4734
  4735 12001-CHECK-MA-GTL.
  4736
  4737     IF (CP-COMPANY-ID EQUAL 'GTL') AND
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  88
* ELRATE.cbl
  4738        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  4739        (CP-EARN-AS-NET-PAY) AND
  4740        (CP-SPECIAL-CALC-CD EQUAL 'H')
  4741        NEXT SENTENCE
  4742     ELSE
  4743        GO TO 12001-CHECK-NV-NET.
  4744
  4745     COMPUTE ANGLEN EQUAL WK1 / I.
  4746
  4747     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *
  4748      CP-ALTERNATE-BENEFIT * N.
  4749
  4750     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /
  4751     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).
  4752
  4753     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *
  4754     WK7 * (N - ANGLEN) / I.
  4755     MOVE WK3 TO CP-CALC-PREMIUM.
  4756
  4757     GO TO 99999-RETURN.
  4758
  4759 12001-CHECK-NV-NET.
  4760     IF (CP-COMPANY-ID EQUAL 'CID')
  4761        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  4762        AND (CP-EARN-AS-NET-PAY)
  4763        CONTINUE
  4764     ELSE
  4765        GO TO 12001-CHECK-MN-NET
  4766     END-IF
  4767     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4768     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4769     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4770                   / (1 + I)
  4771     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4772     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4773     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4774        (CP-PREMIUM-RATE * K-I / 1000)
  4775     MOVE WK3                    TO CP-CALC-PREMIUM
  4776     GO TO 99999-RETURN
  4777      .
  4778 12001-CHECK-MN-NET.
  4779     IF (CP-COMPANY-ID EQUAL 'CID')
  4780        AND (CP-STATE-STD-ABBRV = 'MN')
  4781        AND (CP-EARN-AS-NET-PAY)
  4782        AND (NOT CP-LEVEL-LIFE)
  4783        AND (WS-DISCOUNT-OPTION = '1')
  4784        CONTINUE
  4785     ELSE
  4786        GO TO 12001-CHECK-NC-NET
  4787     END-IF
  4788     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4789     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4790     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4791                   / (1 + I)
  4792     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4793     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4794     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4795        (CP-PREMIUM-RATE / 1000) * (1 + I)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  89
* ELRATE.cbl
  4796     MOVE WK3                    TO CP-CALC-PREMIUM
  4797     GO TO 99999-RETURN
  4798      .
  4799 12001-CHECK-NC-NET.
  4800
  4801     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND
  4802        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4803        (CP-EARN-AS-NET-PAY)
  4804        NEXT SENTENCE
  4805     ELSE
  4806        GO TO 12001-CHECK-NC-NET-PLUS3.
  4807
  4808      COMPUTE ANGLEN EQUAL WK1 / I.
  4809      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4810
  4811      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /
  4812          (ANGLEN - (CP-PREMIUM-RATE / 1000) *
  4813          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -
  4814          N * (CP-PREMIUM-RATE / 1000)).
  4815
  4816      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *
  4817          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).
  4818
  4819      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *
  4820          ((N - ANGLEN) / I + 3) / ANGLEN) /
  4821          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /
  4822          (ANGLEN * 2))
  4823
  4824      COMPUTE WK7 ROUNDED = WK7 * N - 3.
  4825
  4826      IF ANGLEN IS NOT LESS THAN WK7
  4827          COMPUTE CP-PREMIUM-RATE ROUNDED =
  4828              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)
  4829          COMPUTE WK3 ROUNDED =
  4830              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).
  4831
  4832     MOVE WK3 TO CP-CALC-PREMIUM.
  4833
  4834     GO TO 99999-RETURN.
  4835
  4836 12001-CHECK-NC-NET-PLUS3.
  4837
  4838     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4839        (CP-EARN-AS-NET-PAY) AND
  4840        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL')
  4841        NEXT SENTENCE
  4842     ELSE
  4843        GO TO 12001-CHECK-CA.
  4844
  4845     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  4846     MOVE ' ' TO DC-OPTION-CODE.
  4847     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  4848
  4849     IF DATE-CONVERSION-ERROR
  4850        MOVE '2'                 TO CP-RETURN-CODE
  4851        MOVE ZEROS               TO FACTOR
  4852                                    CP-CALC-PREMIUM
  4853         GO TO 99999-RETURN.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  90
* ELRATE.cbl
  4854
  4855     IF DC-GREG-DATE-CYMD GREATER THAN 19931231
  4856        NEXT SENTENCE
  4857     ELSE
  4858        GO TO 12001-CONTINUE-NET.
  4859
  4860     COMPUTE ANGLEN EQUAL WK1 / I.
  4861     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4862
  4863     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).
  4864
  4865     COMPUTE NC-R = 20 *
  4866                    ((NC-LR * ORIGINAL-TERM) / 12)
  4867                          / (ORIGINAL-TERM + 1).
  4868
  4869     COMPUTE NC-OB = NC-R / 1000.
  4870
  4871     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +
  4872                    (NC-OB * ORIGINAL-TERM * 3).
  4873
  4874     IF CP-EXT-CHG-LF
  4875         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30
  4876     ELSE
  4877         MOVE 30                 TO  NC-BIG-D.
  4878
  4879     COMPUTE NC-LITTLE-D = (1 + I) /
  4880             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).
  4881
  4882     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /
  4883             (ANGLEN * NC-LITTLE-D ).
  4884
  4885     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.
  4886
  4887     GO TO 99999-RETURN.
  4888
  4889 12001-CHECK-CA.
  4890
  4891     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4892        (WS-DISCOUNT-OPTION = '6')
  4893        NEXT SENTENCE
  4894     ELSE
  4895        GO TO 12001-CHECK-GTL-IA.
  4896
  4897     COMPUTE CA-J = CA-DISCOUNT / 12.
  4898     COMPUTE ANGLEN EQUAL WK1 / I.
  4899     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.
  4900     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.
  4901     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.
  4902     COMPUTE CA-VI = (1 + I)** -1.
  4903     COMPUTE CP-CALC-PREMIUM =
  4904         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *
  4905         ((1 + CA-J) / I) *
  4906         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *
  4907         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /
  4908         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).
  4909
  4910     GO TO 99999-RETURN.
  4911
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  91
* ELRATE.cbl
  4912 12001-CHECK-GTL-IA.
  4913
  4914     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  4915        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  4916        (CP-EARN-AS-NET-PAY)
  4917        NEXT SENTENCE
  4918     ELSE
  4919        GO TO 12001-CHECK-CID-TRN-VA.
  4920
  4921***************************************************************
  4922
  4923     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.
  4924
  4925     IF GTL-IA-ODD-DAYS = ZEROS
  4926         MOVE ZERO               TO  GTL-IA-SGN
  4927     ELSE
  4928         IF GTL-IA-ODD-DAYS GREATER THAN ZERO
  4929             MOVE +1             TO  GTL-IA-SGN
  4930         ELSE
  4931             MOVE -1             TO  GTL-IA-SGN.
  4932
  4933     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.
  4934     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.
  4935
  4936     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **
  4937                          GTL-IA-SGN.
  4938
  4939     COMPUTE ANGLEN EQUAL WK1 / I.
  4940     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4941
  4942     IF GTL-IA-ODF NOT = ZERO
  4943         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF
  4944         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.
  4945
  4946     COMPUTE GTL-IA-DIVIDEND =
  4947           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -
  4948                             (ANGLEN - ANGLEN-M))) *
  4949           ((K1 + I) * CP-PREMIUM-RATE *
  4950                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).
  4951
  4952     COMPUTE GTL-IA-DIVISOR =
  4953      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.
  4954
  4955     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.
  4956
  4957     COMPUTE CP-CALC-PREMIUM =
  4958                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.
  4959     GO TO 99999-RETURN.
  4960
  4961
  4962 12001-CHECK-CID-TRN-VA.
  4963
  4964     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4965        (CP-STATE-STD-ABBRV EQUAL 'VA') AND
  4966        (CP-EARN-AS-NET-PAY) AND
  4967        (CP-TRUNCATED-LIFE) AND
  4968        (CP-STATE-STD-ABBRV = CP-STATE)
  4969        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  92
* ELRATE.cbl
  4970     ELSE
  4971        GO TO 12001-CHECK-CID-TX
  4972     END-IF
  4973
  4974     COMPUTE ANGLEN EQUAL WK1 / I
  4975     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4976     IF WS-WORK-DIS-RATE = ZEROS
  4977        CONTINUE
  4978     ELSE
  4979        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4980        COMPUTE WK7 = (1 / I) *
  4981              (((WK4 ** M - 1) / (WK4 - 1)) -
  4982              ((WK4 ** M * SX - VX) /
  4983              (WK4 * (1 + I) - 1))) *
  4984              (CP-PREMIUM-RATE / 1000)
  4985        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4986        COMPUTE WK8 = WK7 * 100 / ANGLEN
  4987        COMPUTE CP-CALC-PREMIUM =
  4988           WK8 *  ((WK4 * ANGLEN) / 100)
  4989     END-IF
  4990
  4991     GO TO 99999-RETURN
  4992
  4993     .
  4994
  4995 12001-CHECK-CID-TX.
  4996     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4997        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  4998        (CP-EARN-AS-NET-PAY) AND
  4999        (WS-WORK-DIS-RATE > ZEROS) AND
  5000        (CP-STATE-STD-ABBRV = CP-STATE)
  5001        CONTINUE
  5002     ELSE
  5003        GO TO 12001-CHECK-CID-LEV-MN-NEW
  5004     END-IF
  5005* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  5006     COMPUTE K-I = 1 + (1 * I)
  5007     COMPUTE ANGLEN EQUAL WK1 / I
  5008     COMPUTE ANGLEM EQUAL WK2 / I
  5009     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5010     IF WS-WORK-DIS-RATE = ZEROS
  5011        CONTINUE
  5012     ELSE
  5013        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5014        COMPUTE WK7 = (K-I / I) *
  5015              (((WK4 ** M - 1) / (WK4 - 1)) -
  5016*             ((WK4 ** M * SX - VX) /
  5017              ((WK4 ** M * SX) - VX) /
  5018*             (WK4 * (1 + I) - 1))) *
  5019              (WK4 * (1 + I) - 1)) *
  5020              (CP-PREMIUM-RATE / 1000)
  5021        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5022        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * K-I)
  5023        COMPUTE CP-CALC-PREMIUM =
  5024           WK8 *  ((WK4 * ANGLEN * K-I) / 100)
  5025     END-IF
  5026
  5027     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  93
* ELRATE.cbl
  5028     .
  5029 12001-CHECK-CID-LEV-MN-NEW.
  5030*    IF (CP-COMPANY-ID EQUAL 'CID')
  5031*       AND (CP-STATE-STD-ABBRV = 'MN')
  5032*       AND (CP-EARN-AS-NET-PAY)
  5033*       AND (CP-LEVEL-LIFE)
  5034*       AND (CP-CERT-EFF-DT > X'A4FF')
  5035*       CONTINUE
  5036*    ELSE
  5037*       GO TO 12001-CHECK-CID-LEV-MN
  5038*    END-IF
  5039*
  5040*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  5041*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  5042*    MOVE '1'                    TO DC-OPTION-CODE
  5043*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  5044*
  5045*    IF DATE-CONVERSION-ERROR
  5046*       MOVE '2'                 TO CP-RETURN-CODE
  5047*       MOVE ZEROS               TO FACTOR
  5048*                                   CP-CALC-PREMIUM
  5049*       GO TO 99999-RETURN
  5050*    END-IF
  5051*
  5052*    COMPUTE I = CP-LOAN-APR / 100
  5053*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  5054*
  5055*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  5056*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  5057*      * 12 / 360 * D)
  5058*
  5059*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  5060*       * 12 / 360 * D
  5061*
  5062*    GO TO 99999-RETURN
  5063      .
  5064 12001-CHECK-CID-LEV-MN.
  5065
  5066     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5067        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  5068        (CP-EARN-AS-NET-PAY) AND
  5069        (CP-LEVEL-LIFE) AND
  5070        (CP-STATE-STD-ABBRV = CP-STATE)
  5071        CONTINUE
  5072     ELSE
  5073        GO TO 12001-CHECK-CID-LEV-CA
  5074     END-IF
  5075
  5076     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  5077         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  5078         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  5079
  5080     GO TO 99999-RETURN
  5081
  5082      .
  5083 12001-CHECK-CID-LEV-CA.
  5084
  5085     IF (CP-COMPANY-ID EQUAL 'CID')     AND
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  94
* ELRATE.cbl
  5086        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  5087        (CP-EARN-AS-NET-PAY) AND
  5088        (CP-LEVEL-LIFE) AND
  5089        (CP-STATE-STD-ABBRV = CP-STATE)
  5090        CONTINUE
  5091     ELSE
  5092        GO TO 12001-CHECK-CID-TRN-CA
  5093     END-IF
  5094
  5095     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  5096     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  5097     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  5098     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  5099     COMPUTE CP-CALC-PREMIUM =
  5100          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  5101          (CP-PREMIUM-RATE / 1000)) /
  5102          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  5103
  5104     GO TO 99999-RETURN
  5105
  5106      .
  5107 12001-CHECK-CID-TRN-CA.
  5108
  5109     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5110        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  5111        (CP-EARN-AS-NET-PAY) AND
  5112        (CP-TRUNCATED-LIFE) AND
  5113        (CP-STATE-STD-ABBRV = CP-STATE) AND
  5114        (WS-DISCOUNT-OPTION NOT = ' ')
  5115        CONTINUE
  5116     ELSE
  5117        GO TO 12001-CHECK-CID-TRN-MT
  5118     END-IF
  5119
  5120     COMPUTE ANGLEN EQUAL WK1 / I
  5121     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5122     IF WS-WORK-DIS-RATE = ZEROS
  5123        CONTINUE
  5124     ELSE
  5125        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5126        COMPUTE WK7 = (1 / I) *
  5127              (((WK4 ** M - 1) / (WK4 - 1)) -
  5128              ((WK4 ** M * SX - VX) /
  5129              (WK4 * (1 + I) - 1))) *
  5130              (CP-PREMIUM-RATE / 1000)
  5131        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5132        COMPUTE CP-CALC-PREMIUM =
  5133           WK4 *  WK7
  5134     END-IF
  5135
  5136     GO TO 99999-RETURN
  5137
  5138      .
  5139 12001-CHECK-CID-TRN-MT.
  5140
  5141     IF (CP-COMPANY-ID EQUAL 'CID') AND
  5142        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  5143                   OR
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  95
* ELRATE.cbl
  5144        ((CP-STATE-STD-ABBRV = 'IN') AND
  5145        (CP-CERT-EFF-DT > X'9A7F'))
  5146                   OR
  5147        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5148        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5149        (CP-EARN-AS-NET-PAY) AND
  5150        (CP-TRUNCATED-LIFE) AND
  5151        (CP-STATE-STD-ABBRV = CP-STATE)
  5152        CONTINUE
  5153     ELSE
  5154        GO TO 12001-CHECK-CID-MT
  5155     END-IF
  5156
  5157* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5158     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5159        MOVE 0                   TO K-I
  5160     ELSE
  5161        MOVE 2                   TO K-I
  5162     END-IF
  5163     COMPUTE CP-TERM-OR-EXT-DAYS =
  5164           CP-TERM-OR-EXT-DAYS + 30
  5165
  5166     COMPUTE ANGLEN EQUAL WK1 / I
  5167     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5168     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5169                   / (1 + I)
  5170     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5171     IF WS-WORK-DIS-RATE = ZEROS
  5172        CONTINUE
  5173     ELSE
  5174        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5175*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5176        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5177              (((WK4 ** M - 1) / (WK4 - 1)) -
  5178              ((WK4 ** M * SX - VX) /
  5179              (WK4 * (1 + I) - 1))) *
  5180              (CP-PREMIUM-RATE / 1000)
  5181        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5182*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5183        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5184        COMPUTE CP-CALC-PREMIUM =
  5185           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5186*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5187     END-IF
  5188
  5189     GO TO 99999-RETURN
  5190
  5191     .
  5192 12001-CHECK-CID-MT.
  5193
  5194     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5195        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  5196                                OR 'VT')
  5197                   OR
  5198        ((CP-STATE-STD-ABBRV = 'IN') AND
  5199        (CP-CERT-EFF-DT > X'9A7F'))
  5200                   OR
  5201        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  96
* ELRATE.cbl
  5202        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5203        (CP-EARN-AS-NET-PAY) AND
  5204        (CP-STATE-STD-ABBRV = CP-STATE)
  5205        CONTINUE
  5206     ELSE
  5207        GO TO 12001-CHECK-DCC-DD
  5208     END-IF
  5209
  5210     COMPUTE CP-TERM-OR-EXT-DAYS =
  5211           CP-TERM-OR-EXT-DAYS + 30
  5212
  5213* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5214     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5215        MOVE 0                   TO K-I
  5216     ELSE
  5217        IF CP-STATE-STD-ABBRV = 'NJ'
  5218           MOVE 1                TO K-I
  5219        ELSE
  5220           MOVE 2                TO K-I
  5221        END-IF
  5222     END-IF
  5223     COMPUTE ANGLEN EQUAL WK1 / I
  5224     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5225     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5226                   / (1 + I)
  5227     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5228     IF WS-WORK-DIS-RATE = ZEROS
  5229        CONTINUE
  5230     ELSE
  5231        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5232*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5233        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5234              (((WK4 ** N - 1) / (WK4 - 1)) -
  5235              ((WK4 ** N - SV) /
  5236              (WK4 * (1 + I) - 1))) *
  5237              (CP-PREMIUM-RATE / 1000)
  5238        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5239*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5240        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5241        COMPUTE CP-CALC-PREMIUM =
  5242           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5243*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5244     END-IF
  5245
  5246     GO TO 99999-RETURN
  5247
  5248     .
  5249 12001-CHECK-DCC-DD.
  5250     IF (CP-COMPANY-ID EQUAL 'DCC')
  5251        AND (CP-EARN-AS-NET-PAY)
  5252        AND (CP-BEN-CATEGORY = 'D')
  5253        CONTINUE
  5254     ELSE
  5255        GO TO 12001-CHECK-DCC-NET
  5256     END-IF
  5257
  5258     COMPUTE CP-TERM-OR-EXT-DAYS =
  5259           CP-TERM-OR-EXT-DAYS + 30
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  97
* ELRATE.cbl
  5260
  5261     COMPUTE ANGLEN EQUAL WK1 / I.
  5262     COMPUTE ANGLEM EQUAL WK2 / I.
  5263     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5264
  5265     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5266           / (1 + I)
  5267     COMPUTE GR     = ANGLEN / ODF
  5268*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  5269*      CP-RATE-DEV-PCT
  5270     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5271     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5272       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  5273     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5274     MOVE WK3                    TO CP-CALC-PREMIUM
  5275
  5276     GO TO 99999-RETURN
  5277
  5278     .
  5279 12001-CHECK-DCC-NET.
  5280
  5281     IF (CP-COMPANY-ID EQUAL 'DCC')
  5282        AND (CP-EARN-AS-NET-PAY)
  5283        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  5284             AND 'H' AND 'S' AND 'P')
  5285        CONTINUE
  5286     ELSE
  5287        GO TO 12001-CHECK-DCC-PNET
  5288     END-IF
  5289
  5290     COMPUTE CP-TERM-OR-EXT-DAYS =
  5291           CP-TERM-OR-EXT-DAYS + 30
  5292
  5293     COMPUTE ANGLEN EQUAL WK1 / I.
  5294     COMPUTE ANGLEM EQUAL WK2 / I.
  5295     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5296
  5297     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5298           / (1 + I)
  5299     COMPUTE GR     = ANGLEN / ODF
  5300     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  5301     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  5302       CP-RATE-DEV-PCT
  5303     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  5304*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  5305
  5306     COMPUTE WK8 = CP-PREMIUM-RATE *
  5307        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  5308     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  5309     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5310     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5311       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  5312     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5313     MOVE WK3                    TO CP-CALC-PREMIUM
  5314
  5315     GO TO 99999-RETURN
  5316
  5317     .
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  98
* ELRATE.cbl
  5318 12001-CHECK-DCC-PNET.
  5319     IF (CP-COMPANY-ID EQUAL 'DCC')
  5320        AND (CP-EARN-AS-NET-PAY)
  5321        AND (CP-BENEFIT-CD (1:1) = 'P')
  5322        CONTINUE
  5323     ELSE
  5324        GO TO 12001-CHECK-DCC-MNET
  5325     END-IF
  5326     IF CP-NO-OF-PMTS NOT NUMERIC
  5327        MOVE +0                  TO CP-NO-OF-PMTS
  5328     END-IF
  5329     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  5330        AND ' ' AND 'M'
  5331        MOVE ' '                 TO CP-PMT-MODE
  5332     END-IF
  5333     EVALUATE CP-PMT-MODE
  5334        WHEN 'W'
  5335           MOVE +7               TO C-DAYS-IN-PMT-PER
  5336           MOVE +52              TO C-PMTS-PER-YEAR
  5337           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  5338        WHEN 'B'
  5339           MOVE +14              TO C-DAYS-IN-PMT-PER
  5340           MOVE +26              TO C-PMTS-PER-YEAR
  5341           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  5342        WHEN OTHER
  5343           MOVE +30              TO C-DAYS-IN-PMT-PER
  5344           MOVE +12              TO C-PMTS-PER-YEAR
  5345           MOVE CP-LOAN-TERM     TO C-TOT-PMTS
  5346     END-EVALUATE
  5347     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  5348     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  5349        C-DAYS-IN-PMT-PER)) / (1 + I)
  5350     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  5351     COMPUTE ANGLEN-1 = ANGLEN / Y
  5352     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5353     IF CP-RATE-DEV-PCT NOT = ZEROS
  5354        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5355           CP-PREMIUM-RATE
  5356     END-IF
  5357     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  5358     GO TO 99999-RETURN
  5359     .
  5360 12001-CHECK-DCC-MNET.
  5361
  5362     IF (CP-COMPANY-ID EQUAL 'DCC')
  5363        AND (CP-EARN-AS-NET-PAY)
  5364        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  5365        CONTINUE
  5366     ELSE
  5367        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  5368     END-IF
  5369
  5370*    COMPUTE ANGLEN EQUAL WK1 / I.
  5371*    COMPUTE ANGLEM EQUAL WK2 / I.
  5372*    COMPUTE ANGLEN-M EQUAL WK5 / I.
  5373
  5374     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  5375     MOVE WK3                    TO CP-CALC-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page  99
* ELRATE.cbl
  5376
  5377     GO TO 99999-RETURN
  5378
  5379     .
  5380 12001-CHECK-DCC-MNET-LF-BAL.
  5381
  5382     IF (CP-COMPANY-ID EQUAL 'DCC')
  5383        AND (CP-EARN-AS-NET-PAY)
  5384        AND (CP-BENEFIT-CD (1:1) = 'N')
  5385        AND (CP-BEN-CATEGORY NOT = 'N')
  5386        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5387        CONTINUE
  5388     ELSE
  5389        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  5390     END-IF
  5391
  5392     IF CP-RATE-DEV-PCT NOT = ZEROS
  5393        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5394           CP-PREMIUM-RATE
  5395     END-IF
  5396*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5397     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5398        / (1 + I)
  5399     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5400     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5401     COMPUTE WK2 = (1 + J) ** (M * -1)
  5402     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5403     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5404          ** ((M - 1) * -1))) / J)
  5405     COMPUTE ANGLEM = ((1 - ((1 + J)
  5406          ** (M * -1))) / J) / OD
  5407     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5408        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  5409        / ANGLEM-1
  5410     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5411          ** ((N - M) * -1))) / I)
  5412     MOVE +0                     TO WK3
  5413     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5414        (WS-COUNTER > M)
  5415        COMPUTE ANGLEM = (1 - ((1 + J)
  5416          ** ((M - WS-COUNTER) * -1))) / J
  5417        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5418        COMPUTE WK5-CSL = (RA * ANGLEM)
  5419        + (CP-ALTERNATE-BENEFIT * WK2)
  5420        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5421     END-PERFORM
  5422     MOVE WK3                    TO CP-CALC-PREMIUM
  5423
  5424     GO TO 99999-RETURN
  5425
  5426     .
  5427 12001-CHECK-DCC-MNET-LFSUM-BAL.
  5428
  5429     IF (CP-COMPANY-ID EQUAL 'DCC')
  5430        AND (CP-EARN-AS-NET-PAY)
  5431        AND (CP-BENEFIT-CD (1:1) = 'S')
  5432        AND (CP-BEN-CATEGORY NOT = 'N')
  5433        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page 100
* ELRATE.cbl
  5434        CONTINUE
  5435     ELSE
  5436        GO TO 12001-CHECK-DCC-MNET-LF
  5437     END-IF
  5438
  5439     IF CP-RATE-DEV-PCT NOT = ZEROS
  5440        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5441           CP-PREMIUM-RATE
  5442     END-IF
  5443     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5444     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5445          ** ((M - 1) * -1))) / K)
  5446     COMPUTE ANGLEM = ((1 - ((1 + K)
  5447          ** (M * -1))) / K)
  5448     MOVE CP-MONTHLY-PAYMENT     TO RA
  5449     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5450        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  5451        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5452        CP-PREMIUM-RATE / 1000
  5453     MOVE WK3                    TO CP-CALC-PREMIUM
  5454
  5455     GO TO 99999-RETURN
  5456
  5457     .
  5458 12001-CHECK-DCC-MNET-LF.
  5459
  5460     IF (CP-COMPANY-ID EQUAL 'DCC')
  5461        AND (CP-EARN-AS-NET-PAY)
  5462        AND (CP-BENEFIT-CD (1:1) = 'N')
  5463        AND (CP-BEN-CATEGORY NOT = 'N')
  5464        CONTINUE
  5465     ELSE
  5466        GO TO 12001-CHECK-DCC-MNET-SUMLF
  5467     END-IF
  5468
  5469     IF CP-RATE-DEV-PCT NOT = ZEROS
  5470        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5471           CP-PREMIUM-RATE
  5472     END-IF
  5473*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5474     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5475        / (1 + I)
  5476     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5477     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5478     COMPUTE WK2 = (1 + J) ** (M * -1)
  5479     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5480     COMPUTE ANGLEM = ((1 - ((1 + J)
  5481          ** (M * -1))) / J) / OD
  5482     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5483     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5484          ** ((N - M) * -1))) / I)
  5485     MOVE +0                     TO WK3
  5486     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5487        (WS-COUNTER > M)
  5488        COMPUTE ANGLEM = (1 - ((1 + J)
  5489          ** ((M - WS-COUNTER + 1) * -1))) / J
  5490        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5491        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page 101
* ELRATE.cbl
  5492        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5493     END-PERFORM
  5494     MOVE WK3                    TO CP-CALC-PREMIUM
  5495
  5496     GO TO 99999-RETURN
  5497
  5498     .
  5499 12001-CHECK-DCC-MNET-SUMLF.
  5500
  5501     IF (CP-COMPANY-ID EQUAL 'DCC')
  5502        AND (CP-EARN-AS-NET-PAY)
  5503        AND (CP-BENEFIT-CD (1:1) = 'S')
  5504        AND (CP-BEN-CATEGORY NOT = 'N')
  5505        CONTINUE
  5506     ELSE
  5507        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  5508     END-IF
  5509
  5510     IF CP-RATE-DEV-PCT NOT = ZEROS
  5511        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5512           CP-PREMIUM-RATE
  5513     END-IF
  5514     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5515     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5516        / (1 + K)
  5517     COMPUTE ANGLEN-M = (WK5 / I)
  5518     COMPUTE WK2 = (1 + K) ** (M * -1)
  5519     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5520     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5521     COMPUTE ANGLEM = ((1 - ((1 + K)
  5522          ** (M * -1))) / K) / Y
  5523     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5524     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  5525        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5526        - 1)) / K) * RA
  5527     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5528        + (CP-DAYS-TO-1ST-PMT - +30)
  5529        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5530        +0 / 1000 * 12 / 12)
  5531     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  5532        * (12 / 12)
  5533     MOVE WK3                    TO CP-CALC-PREMIUM
  5534
  5535     GO TO 99999-RETURN
  5536
  5537     .
  5538 12001-CHECK-DCC-MNET-TOT-BAL-N.
  5539
  5540     IF (CP-COMPANY-ID EQUAL 'DCC')
  5541        AND (CP-EARN-AS-NET-PAY)
  5542        AND (CP-BENEFIT-CD (1:1) = 'N')
  5543        AND (CP-BEN-CATEGORY = 'N')
  5544        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5545        CONTINUE
  5546     ELSE
  5547        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  5548     END-IF
  5549
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page 102
* ELRATE.cbl
  5550*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5551     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5552        / (1 + I)
  5553     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5554     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  5555     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5556     COMPUTE WK2 = (1 + J) ** (M * -1)
  5557     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5558     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5559          ** ((M - 1) * -1))) / J)
  5560     COMPUTE ANGLEM = ((1 - ((1 + J)
  5561          ** (M * -1))) / J) / OD
  5562     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5563        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  5564        / ANGLEM-1
  5565     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5566          ** ((N - M) * -1))) / I)
  5567     MOVE +0                     TO WK3
  5568     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5569        (WS-COUNTER > M)
  5570        COMPUTE ANGLEM = (1 - ((1 + J)
  5571          ** ((M - WS-COUNTER) * -1))) / J
  5572        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  5573        COMPUTE WK5-CSL = (RA * ANGLEM)
  5574        + (CP-ALTERNATE-BENEFIT * WK2)
  5575        COMPUTE WK3 = WK3 +
  5576         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  5577        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  5578          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  5579          (CP-DCC-AH-RATE / 1000)
  5580     END-PERFORM
  5581     MOVE WK3                    TO CP-CALC-PREMIUM
  5582
  5583     GO TO 99999-RETURN
  5584
  5585     .
  5586 12001-CHECK-DCC-MNET-TOT-BAL-S.
  5587
  5588     IF (CP-COMPANY-ID EQUAL 'DCC')
  5589        AND (CP-EARN-AS-NET-PAY)
  5590        AND (CP-BENEFIT-CD (1:1) = 'S')
  5591        AND (CP-BEN-CATEGORY = 'N')
  5592        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5593        CONTINUE
  5594     ELSE
  5595        GO TO 12001-CHECK-DCC-MNET-TOT-N
  5596     END-IF
  5597
  5598     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5599     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5600          ** ((M - 1) * -1))) / K)
  5601     COMPUTE ANGLEM = ((1 - ((1 + K)
  5602          ** (M * -1))) / K)
  5603     MOVE CP-MONTHLY-PAYMENT     TO RA
  5604     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5605        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  5606        * CP-DCC-AH-RATE / 1000))
  5607        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page 103
* ELRATE.cbl
  5608        CP-DCC-LF-RATE / 1000
  5609     MOVE WK3                    TO CP-LF-PREM
  5610     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  5611        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  5612        * CP-DCC-AH-RATE / 1000
  5613     COMPUTE WK3 = WK3 + WK5-CSL
  5614     MOVE WK3                    TO CP-CALC-PREMIUM
  5615
  5616     GO TO 99999-RETURN
  5617      .
  5618 12001-CHECK-DCC-MNET-TOT-N.
  5619
  5620     IF (CP-COMPANY-ID EQUAL 'DCC')
  5621        AND (CP-EARN-AS-NET-PAY)
  5622        AND (CP-BENEFIT-CD (1:1) = 'N')
  5623        AND (CP-BEN-CATEGORY = 'N')
  5624        CONTINUE
  5625     ELSE
  5626        GO TO 12001-CHECK-DCC-MNET-TOT-S
  5627     END-IF
  5628
  5629*    I = APR/1200
  5630*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  5631*    RA = PAYMENT AMOUNT
  5632*    WK5-CSL = THE BALANCE (PAY OFF )
  5633*    WK3 = THE ACCUMULATED PREMIUM
  5634*    WK2 = (1 + I) ^ (m * -1)
  5635*    OD  = GAMMA
  5636*
  5637*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5638     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5639        / (1 + I)
  5640     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5641     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  5642        (CP-DCC-AH-RATE / +1000)
  5643     COMPUTE WK2 = (1 + J) ** (M * -1)
  5644     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5645     COMPUTE ANGLEM = ((1 - ((1 + J)
  5646          ** (M * -1))) / J) / OD
  5647     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5648     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5649          ** ((N - M) * -1))) / I)
  5650     MOVE +0                     TO WK3
  5651     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5652        (WS-COUNTER > M)
  5653        COMPUTE ANGLEM = (1 - ((1 + J)
  5654          ** ((M - WS-COUNTER + 1) * -1))) / J
  5655        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5656        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5657        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  5658           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  5659     END-PERFORM
  5660     MOVE WK3                    TO CP-CALC-PREMIUM
  5661
  5662     GO TO 99999-RETURN
  5663
  5664     .
  5665 12001-CHECK-DCC-MNET-TOT-S.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page 104
* ELRATE.cbl
  5666
  5667     IF (CP-COMPANY-ID EQUAL 'DCC')
  5668        AND (CP-EARN-AS-NET-PAY)
  5669        AND (CP-BENEFIT-CD (1:1) = 'S')
  5670        AND (CP-BEN-CATEGORY = 'N')
  5671        CONTINUE
  5672     ELSE
  5673        GO TO 12001-CONTINUE-NET
  5674     END-IF
  5675
  5676*    I = APR/1200
  5677*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  5678*    RA = PAYMENT AMOUNT
  5679*    WK5-CSL = THE BALANCE (PAY OFF )
  5680*    WK3 = THE ACCUMULATED PREMIUM
  5681*    WK2 = (1 + I) ^ (m * -1)
  5682*    OD  = GAMMA
  5683*
  5684     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  5685     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  5686        / (1 + J)
  5687     COMPUTE ANGLEM = ((1 - ((1 + J)
  5688          ** (M * -1))) / J) / OD
  5689     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5690          ** ((N - M) * -1))) / I)
  5691          * (1 + J) ** (-1 * M)
  5692     COMPUTE ANGLEN-M = ANGLEN-M / OD
  5693     MOVE CP-MONTHLY-PAYMENT     TO RA
  5694     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  5695        / +30)
  5696     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  5697        ** (WK1) - 1)) / J) * RA
  5698     COMPUTE WK5 = (((((M * (M + 1) / 2)
  5699        + (CP-DAYS-TO-1ST-PMT - +30)
  5700        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  5701        CP-DCC-AH-RATE / +1000 * 12 / 12)
  5702     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  5703        (12 / 12)
  5704     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  5705        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  5706        (CP-DCC-AH-RATE / +1000) * 12 / 12
  5707     COMPUTE WK3 = WK3 + WK5-CSL
  5708     MOVE WK3                    TO CP-CALC-PREMIUM
  5709     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5710     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5711        / (1 + K)
  5712     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5713          ** ((N - M) * -1))) / I)
  5714     COMPUTE WK2 = (1 + K) ** (M * -1)
  5715     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5716     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5717     COMPUTE ANGLEM = ((1 - ((1 + K)
  5718          ** (M * -1))) / K) / Y
  5719*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5720     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  5721        ((1 + K) ** (M + 1 / Y
  5722        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5723        - 1)) / K) * RA
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page 105
* ELRATE.cbl
  5724     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5725        + (CP-DAYS-TO-1ST-PMT - +30)
  5726        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5727        CP-DCC-AH-RATE / 1000 * 12 / 12)
  5728     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  5729        * (12 / 12)
  5730     MOVE WK3                    TO CP-LF-PREM
  5731
  5732     GO TO 99999-RETURN
  5733
  5734     .
  5735 12001-CONTINUE-NET.
  5736
  5737     IF NET-STD
  5738        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  5739*          OR 'DCC'
  5740         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  5741         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  5742         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  5743         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  5744                               * ((1 + N) / (1 + M))
  5745        ELSE
  5746         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  5747         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  5748         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  5749         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.
  5750
  5751     IF NET-SMP
  5752         COMPUTE N2 = N * N
  5753         COMPUTE N3 = N2 * N
  5754         COMPUTE WK3 ROUNDED = 2 * N2 * WK1
  5755         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)
  5756         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)
  5757         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10
  5758         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).
  5759
  5760     IF NPO-PRUDENTIAL
  5761       PERFORM 12100-PRU-CALC THRU 12199-EXIT
  5762           VARYING WS-COUNTER FROM 1 BY 1
  5763               UNTIL WS-COUNTER = N
  5764       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1
  5765       COMPUTE WK3 ROUNDED = WK3 / (I * 12).
  5766
  5767     MOVE WK3 TO FACTOR.
  5768
  5769     GO TO 99999-RETURN.
  5770
  5771 12100-PRU-CALC.
  5772     IF WS-COUNTER = 1
  5773         COMPUTE PWK = (I + 1)
  5774     ELSE
  5775         COMPUTE PWK = PWK * (I + 1).
  5776
  5777 12199-EXIT.
  5778      EXIT.
  5779
  5780 99000-ERROR.
  5781     MOVE +9999.999999999 TO N-P-FACTOR.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:16 Page 106
* ELRATE.cbl
  5782     MOVE '4'             TO CP-RETURN-CODE.
  5783
  5784     GO TO 99999-EXIT.
  5785
  5786 99999-RETURN.
  5787     MOVE FACTOR          TO N-P-FACTOR.
  5788
  5789 99999-EXIT.
  5790      EXIT.
  5791 99999-DUMMY-STOP-RUN.
  5792
  5793* GOBACK.
  5794     MOVE '9%                    "   ' TO DFHEIV0
  5795     MOVE 'ELRATE' TO DFHEIV1
  5796     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5797     GOBACK.
  5798
  5799
  5800 9999-DFHBACK SECTION.
  5801     MOVE '9%                    "   ' TO DFHEIV0
  5802     MOVE 'ELRATE' TO DFHEIV1
  5803     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5804     GOBACK.
  5805 9999-DFHEXIT.
  5806     IF DFHEIGDJ EQUAL 0001
  5807         NEXT SENTENCE
  5808     ELSE IF DFHEIGDJ EQUAL 2
  5809         GO TO 9999-RATE-NOTFND,
  5810               9999-RATE-NOTOPEN,
  5811               9999-RATE-NOTFND
  5812         DEPENDING ON DFHEIGDI.
  5813     MOVE '9%                    "   ' TO DFHEIV0
  5814     MOVE 'ELRATE' TO DFHEIV1
  5815     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5816     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2556     Code:       51808
