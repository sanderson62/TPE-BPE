* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   1
* EL1278.cbl
* Options: int("EL1278.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1278.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1278.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1278.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1278.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/21/94 14:09:26.
     7*                            VMOD=2.030.
     8*
     9*
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   2
* EL1278.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXXA - CANCELLATION QUOTE.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101201    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37* 070105    2005063000003  PEMA  COMMENT OUT CODE THAT ADDS 1
    38*         TO THE TERM AND REMAINING TERM
    39* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    40* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    41* 111907  CR2004020600011  PEMA  FORCE FP TO REFUND AS FP
    42* 022608  CR2008010200006  PEMA  CHANGE MO RTERM MTHOD
    43* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
    44* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
    45* 021710  IR2010021000002  PEMA  ADD CANCEL DATE EDIT
    46* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
    47* 042011  CR2010030900001  PEMA ADD CLM PROCESSING ON QUOTES
    48* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    49* 010412  CR2011022800001  AJRA  NAPERSOFT CANCEL PROCESSING
    50* 032912  CR2011110200001  PEMA  AHL CHANGES
    51* 062712  CR2011022800001  AJRA NAPERSOFT
    52* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    53* 102212  CR2012013100001  PEMA  ALLOW MN OVERRIDE RF
    54* 112612  CR2012101700002  AJRA  FIX CANCEL WHEN DEATH CLAIM
    55* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    56* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    57******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   3
* EL1278.cbl
    59 ENVIRONMENT DIVISION.
    60 DATA DIVISION.
    61 WORKING-STORAGE SECTION.
    62 01  DFH-START PIC X(04).
    63 77  FILLER  PIC  X(32) VALUE '********************************'.
    64 77  FILLER  PIC  X(32) VALUE '*    EL1278 WORKING STORAGE    *'.
    65 77  FILLER  PIC  X(32) VALUE '*********** VMOD=2.030 *********'.
    66 77  S1                          PIC S999 COMP-3 VALUE +0.
    67 77  P1                          PIC S999 COMP-3 VALUE +0.
    68 77  P2                          PIC S999 COMP-3 VALUE +0.
    69 77  C0                          PIC S999 COMP-3 VALUE +0.
    70 77  C1                          PIC S999 COMP-3 VALUE +0.
    71 77  C2                          PIC S999 COMP-3 VALUE +0.
    72 77  C3                          PIC S999 COMP-3 VALUE +0.
    73 77  WS-STOP-SW                  PIC X  VALUE ' '.
    74     88  I-SAY-TO-STOP      VALUE 'Y'.
    75 77  WS-OPEN-LF-CLAIM            PIC X  VALUE ' '.
    76     88  OPEN-LF-CLAIM              VALUE 'Y'.
    77 77  WS-CLOSED-LF-CLAIM          PIC X  VALUE ' '.
    78     88  CLOSED-LF-CLAIM            VALUE 'Y'.
    79 77  WS-OPEN-AH-CLAIM            PIC X  VALUE ' '.
    80     88  OPEN-AH-CLAIM              VALUE 'Y'.
    81 77  WS-CLOSED-AH-CLAIM          PIC X  VALUE ' '.
    82     88  CLOSED-AH-CLAIM            VALUE 'Y'.
    83 77  WS-FOUND-A-CLAIM            PIC X  VALUE ' '.
    84     88  FOUND-A-CLAIM              VALUE 'Y'.
    85 77  WS-ST-REF-IND               PIC X.
    86 77  WS-LF-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    87 77  WS-AH-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    88 77  WS-AH-PAID-THRU-DT          PIC XX  VALUE LOW-VALUES.
    89 77  WS-LF-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    90 77  WS-AH-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    91 77  DD-IU-SW                    PIC X   VALUE ' '.
    92     88  DD-IU-PRESENT                 VALUE 'Y'.
    93 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    94 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    95 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    96 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    97 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    98 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    99 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   100 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   101 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
   102     88  NO-CERT-RW                 VALUE 'N'.
   103     88  CERT-RW                    VALUE 'Y'.
   104 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   105     88  ERMAIL-FOUND                 VALUE 'Y'.
   106 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE ZERO.
   107
   108*                            COPY ELCSCTM.
   109******************************************************************
   110*                                                                *
   111*                                                                *
   112*                            ELCSCTM                             *
   113*                            VMOD=2.001                          *
   114*                                                                *
   115*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   116*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   4
* EL1278.cbl
   117******************************************************************
   118 01  SECURITY-MESSAGE.
   119     12  FILLER                          PIC X(30)
   120            VALUE '** LOGIC SECURITY VIOLATION -'.
   121     12  SM-READ                         PIC X(6).
   122     12  FILLER                          PIC X(5)
   123            VALUE ' PGM='.
   124     12  SM-PGM                          PIC X(6).
   125     12  FILLER                          PIC X(5)
   126            VALUE ' OPR='.
   127     12  SM-PROCESSOR-ID                 PIC X(4).
   128     12  FILLER                          PIC X(6)
   129            VALUE ' TERM='.
   130     12  SM-TERMID                       PIC X(4).
   131     12  FILLER                          PIC XX   VALUE SPACE.
   132     12  SM-JUL-DATE                     PIC 9(5).
   133     12  FILLER                          PIC X    VALUE SPACE.
   134     12  SM-TIME                         PIC 99.99.
   135
   136
   137*                            COPY ELCSCRTY.
   138******************************************************************
   139*                                                                *
   140*                                                                *
   141*                            ELCSCRTY                            *
   142*                            VMOD=2.001                          *
   143*                                                                *
   144*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   145*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   146*        SAVED IN PI-SECURITY-ADDRESS.                           *
   147*                                                                *
   148******************************************************************
   149 01  SECURITY-CONTROL.
   150     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   151     12  FILLER                       PIC XX    VALUE 'SC'.
   152     12  SC-CREDIT-CODES.
   153         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   154             20  SC-CREDIT-DISPLAY    PIC X.
   155             20  SC-CREDIT-UPDATE     PIC X.
   156     12  SC-CLAIMS-CODES.
   157         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   158             20  SC-CLAIMS-DISPLAY    PIC X.
   159             20  SC-CLAIMS-UPDATE     PIC X.
   160
   161 01  FILLER          COMP-3.
   162     12  WS-BALLOON-RTRM         PIC S9(03)      VALUE ZERO.
   163     12  WS-ELAPSED-MONTHS       PIC S9(03)      VALUE ZERO.
   164     12  WS-TOT-AH-PREM          PIC S9(9)V99    VALUE ZERO.
   165     12  WS-TOT-LF-PREM          PIC S9(9)V99    VALUE ZERO.
   166     12  WS-TOT-AH-RFND          PIC S9(9)V99    VALUE ZERO.
   167     12  WS-TOT-LF-RFND          PIC S9(9)V99    VALUE ZERO.
   168     12  WS-TOT-PREM             PIC S9(9)V99    VALUE ZERO.
   169     12  WS-TOT-RFND             PIC S9(9)V99    VALUE ZERO.
   170     12  WS-TOT-ITDR             PIC S9(9)V99    VALUE ZERO.
   171
   172 01  WS-DATE-AREA.
   173     12  SAVE-DATE               PIC  X(08)      VALUE SPACES.
   174     12  SAVE-BIN-DATE           PIC  X(02)      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   5
* EL1278.cbl
   175     12  WS-LF-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   176     12  WS-AH-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   177     12  WS-LF-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   178     12  WS-AH-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   179
   180 01  ERPDEF-KEY-SAVE             PIC X(18).
   181 01  ERPDEF-KEY.
   182     12  ERPDEF-COMPANY-CD       PIC X.
   183     12  ERPDEF-STATE            PIC XX.
   184     12  ERPDEF-PROD-CD          PIC XXX.
   185     12  F                       PIC X(7).
   186     12  ERPDEF-BEN-TYPE         PIC X.
   187     12  ERPDEF-BEN-CODE         PIC XX.
   188     12  ERPDEF-EXP-DT           PIC XX.
   189 01  ELMSTR-KEY.
   190     12  ELMSTR-COMP-CD          PIC X.
   191     12  ELMSTR-CERT-NO          PIC X(11).
   192 01  ELCRTT-KEY.
   193     12  ELCRTT-PRIMARY          PIC X(33).
   194     12  ELCRTT-REC-TYPE         PIC X(1).
   195
   196 01  ELCRTO-KEY.
   197     05  ELCRTO-COMPANY-CD       PIC X.
   198     05  ELCRTO-CARRIER          PIC X.
   199     05  ELCRTO-GROUPING         PIC X(6).
   200     05  ELCRTO-STATE            PIC XX.
   201     05  ELCRTO-ACCOUNT          PIC X(10).
   202     05  ELCRTO-CERT-EFF-DT      PIC XX.
   203     05  ELCRTO-CERT-NO.
   204         10  ELCRTO-CERT-PRIME   PIC X(10).
   205         10  ELCRTO-CERT-SFX     PIC X.
   206     05  ELCRTO-RECORD-TYPE      PIC X.
   207     05  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   208
   209 01  STANDARD-AREAS.
   210     12  SC-ITEM                 PIC S9(04) COMP VALUE +0001.
   211     12  SUB3                    PIC S9(04) COMP VALUE +0.
   212     12  SUB4                    PIC S9(04) COMP VALUE +0.
   213     12  GETMAIN-SPACE           PIC  X(01)      VALUE SPACE.
   214     12  MAP-NAME                PIC  X(08)      VALUE 'EL127H'.
   215     12  MAPSET-NAME             PIC  X(08)      VALUE 'EL1278S'.
   216     12  SCREEN-NUMBER           PIC  X(04)      VALUE '127H'.
   217     12  TRANS-ID                PIC  X(04)      VALUE 'EXXA'.
   218     12  THIS-PGM                PIC  X(08)      VALUE 'EL1278'.
   219     12  PGM-NAME                PIC  X(08).
   220     12  TIME-IN                 PIC S9(07).
   221     12  TIME-OUT-R  REDEFINES  TIME-IN.
   222         16  FILLER              PIC  X(01).
   223         16  TIME-OUT            PIC  9(02)V99.
   224         16  FILLER              PIC  X(02).
   225     12  XCTL-005                PIC  X(08)      VALUE 'EL005'.
   226     12  XCTL-010                PIC  X(08)      VALUE 'EL010'.
   227     12  XCTL-126                PIC  X(08)      VALUE 'EL126'.
   228     12  LINK-001                PIC  X(08)      VALUE 'EL001'.
   229     12  LINK-004                PIC  X(08)      VALUE 'EL004'.
   230     12  LINK-ELDATCV            PIC  X(08)      VALUE 'ELDATCV'.
   231     12  ELRTRM-ID               PIC  X(08)      VALUE 'ELRTRM'.
   232     12  ELRAMT-ID               PIC  X(08)      VALUE 'ELRAMT'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   6
* EL1278.cbl
   233     12  ELRFND-ID               PIC  X(08)      VALUE 'ELRFND'.
   234     12  ELCNTL-ID               PIC  X(08)      VALUE 'ELCNTL'.
   235     12  ERACCT-ID               PIC  X(08)      VALUE 'ERACCT'.
   236     12  ELCERT-ID               PIC  X(08)      VALUE 'ELCERT'.
   237     12  ERMAIL-ID               PIC  X(08)      VALUE 'ERMAIL'.
   238     12  ERFORM-ID               PIC  X(08)      VALUE 'ERFORM'.
   239     12  ERNOTE-ID               PIC  X(08)      VALUE 'ERCNOT'.
   240     12  ELCRTT-ID               PIC  X(08)      VALUE 'ELCRTT'.
   241     12  DATE-RANGE-SW           PIC  X(01)      VALUE SPACE.
   242     12  WS-REFUND-SEARCH-SW     PIC  X(01)      VALUE ' '.
   243         88  LIFE-REFUND-SEARCH                  VALUE 'L'.
   244     12  WS-BROWSE-STARTED-SW    PIC  X(01)      VALUE SPACE.
   245         88  BROWSE-STARTED                      VALUE 'Y'.
   246     12  WS-FORM-RECORD-SW       PIC  X(01)      VALUE SPACE.
   247         88  FORM-FOUND                          VALUE 'Y'.
   248     12  BEN-SEARCH-SW           PIC  X(01)      VALUE SPACE.
   249         88  NO-BENEFIT-FOUND                    VALUE 'N'.
   250     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   251         88  WS-REDUCING                         VALUE 'R'.
   252         88  WS-LEVEL                            VALUE 'L'  'P'.
   253     12  WS-NEW-LF-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   254         88  WS-NEW-LF-CANCEL                    VALUE 'Y'.
   255     12  WS-NEW-AH-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   256         88  WS-NEW-AH-CANCEL                    VALUE 'Y'.
   257     12  WS-BENEFIT-DESCRIP      PIC  X(10)      VALUE SPACES.
   258     12  WS-PMT-DESCRIP          PIC  X(10)      VALUE
   259         'CLAIM PMTS'.
   260     12  WS-REFUND-DESCRIP       PIC  X(10)      VALUE
   261         'ITD REFUND'.
   262     12  WS-ACCESS.
   263         16  FILLER              PIC  X(02).
   264         16  WS-BEN-CD           PIC  X(02).
   265     12  WS-KIND                 PIC  X(03)      VALUE SPACES.
   266     12  WS-LF-KIND              PIC  X(03)      VALUE SPACES.
   267     12  WS-AH-KIND              PIC  X(03)      VALUE SPACES.
   268     12  WS-LOOKUP-TYPE          PIC  X(01).
   269     12  WS-BENEFIT-NO           PIC  X(02)      VALUE ZERO.
   270     12  WS-STATE-ABBREVIATION   PIC  X(02)      VALUE SPACES.
   271     12  WS-CALC-CD              PIC  X(01).
   272     12  DEEDIT-FIELD            PIC  X(15).
   273     12  DEEDIT-FIELD-V0  REDEFINES
   274         DEEDIT-FIELD            PIC S9(15).
   275     12  WS-CURRENT-DATE         PIC  X(02)  VALUE LOW-VALUES.
   276     12  RETURN-FROM             PIC  X(08).
   277     12  QID.
   278         16  QID-TERM            PIC  X(04).
   279         16  FILLER              PIC  X(04)      VALUE '127H'.
   280     12  WS-FIRST-ENTRY-SW       PIC  X(01)      VALUE SPACE.
   281         88  FIRST-ENTRY                         VALUE 'Y'.
   282     12  WS-PDEF-RECORD-SW       PIC X           VALUE ' '.
   283         88  PDEF-FOUND                          VALUE 'Y'.
   284     12  WS-CERT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   285         88  CERT-FOUND                          VALUE 'Y'.
   286         88  CERT-NOT-FOUND                      VALUE 'N'.
   287     12  WS-CNTL-RECORD-SW       PIC  X(01)      VALUE SPACE.
   288         88  CNTL-FOUND                          VALUE 'Y'.
   289         88  CNTL-NOT-FOUND                      VALUE 'N'.
   290     12  WS-BEN-RECORD-SW        PIC  X(01)      VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   7
* EL1278.cbl
   291         88  BEN-FOUND                           VALUE 'Y'.
   292     12  WS-STATE-RECORD-SW      PIC  X(01)      VALUE SPACE.
   293         88  STATE-FOUND                         VALUE 'Y'.
   294     12  WS-ST-BEN-RECORD-SW     PIC  X(01)      VALUE SPACE.
   295         88  ST-BEN-FOUND                        VALUE 'Y'.
   296     12  WS-ACCT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   297         88  ACCT-FOUND                          VALUE 'Y'.
   298     12  WS-DUPREC-SW            PIC  X(01)      VALUE SPACE.
   299         88  DUPLICATE-RECORD-FOUND              VALUE 'Y'.
   300     12  WS-NOT-FOUND            PIC S9(01) COMP-3
   301                                                 VALUE ZERO.
   302         88  BENEFIT-FOUND                       VALUE +1.
   303     12  WS-CALC-REFUND          PIC S9(07)V99 COMP-3
   304                                                 VALUE ZERO.
   305     12  WS-LIFE-PREMIUM         PIC S9(07)V99 COMP-3
   306                                                 VALUE ZERO.
   307     12  WS-INDEX                PIC S9(04) COMP VALUE ZERO.
   308     12  WS-SUB1                 PIC S99    COMP.
   309     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   310     12  WS-CF-DEFAULT-APR       PIC  S9(03)V9(04) COMP-3.
   311     12  WS-CF-CR-R78-METHOD     PIC  X(01)      VALUE SPACE.
   312     12  WS-CF-CR-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   313     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   314     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   315     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   316     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   317     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   318     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   319     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   320     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   321     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   322     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   323     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   324     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   325     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   326     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   327     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   328     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   329     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   330     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   331     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   332     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   333     12  ERROR-MESSAGES.
   334         16  ER-0000             PIC  X(04)      VALUE '0000'.
   335         16  ER-0004             PIC  X(04)      VALUE '0004'.
   336         16  ER-0008             PIC  X(04)      VALUE '0008'.
   337         16  ER-0028             PIC  X(04)      VALUE '0028'.
   338         16  ER-0029             PIC  X(04)      VALUE '0029'.
   339         16  ER-0070             PIC  X(04)      VALUE '0070'.
   340         16  ER-0142             PIC  X(04)      VALUE '0142'.
   341         16  ER-0214             PIC  X(04)      VALUE '0214'.
   342         16  ER-0681             PIC  X(04)      VALUE '0681'.
   343         16  ER-0682             PIC  X(04)      VALUE '0682'.
   344         16  ER-0683             PIC  X(04)      VALUE '0683'.
   345         16  ER-0684             PIC  X(04)      VALUE '0684'.
   346         16  ER-2227             PIC  X(04)      VALUE '2227'.
   347         16  ER-2601             PIC  X(04)      VALUE '2601'.
   348         16  ER-2616             PIC  X(04)      VALUE '2616'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   8
* EL1278.cbl
   349         16  ER-2617             PIC  X(04)      VALUE '2617'.
   350         16  ER-2619             PIC  X(04)      VALUE '2619'.
   351         16  ER-2740             PIC  X(04)      VALUE '2740'.
   352         16  ER-2756             PIC  X(04)      VALUE '2756'.
   353         16  ER-2768             PIC  X(04)      VALUE '2768'.
   354         16  ER-2774             PIC  X(04)      VALUE '2774'.
   355         16  ER-2775             PIC  X(04)      VALUE '2775'.
   356         16  ER-2965             PIC  X(04)      VALUE '2965'.
   357         16  ER-2966             PIC  X(04)      VALUE '2966'.
   358         16  ER-2967             PIC  X(04)      VALUE '2967'.
   359         16  ER-2968             PIC  X(04)      VALUE '2968'.
   360         16  ER-2969             PIC  X(04)      VALUE '2969'.
   361         16  ER-3037             PIC  X(04)      VALUE '3037'.
   362         16  ER-3038             PIC  X(04)      VALUE '3038'.
   363         16  ER-3039             PIC  X(04)      VALUE '3039'.
   364         16  ER-3780             PIC  X(04)      VALUE '3780'.
   365         16  ER-3781             PIC  X(04)      VALUE '3781'.
   366         16  ER-3830             PIC  X(04)      VALUE '3830'.
   367         16  ER-8160             PIC  X(04)      VALUE '8160'.
   368         16  ER-8161             PIC  X(04)      VALUE '8161'.
   369         16  ER-9999             PIC  X(04)      VALUE '9999'.
   370     12  WS-CF-LIFE-OVERRIDE-L1  PIC  X(01).
   371     12  WS-CF-LIFE-OVERRIDE-L2  PIC  X(02).
   372     12  WS-CF-AH-OVERRIDE-L1    PIC  X(01).
   373     12  WS-CF-AH-OVERRIDE-L2    PIC  X(02).
   374
   375     12  WS-RESPONSE             PIC S9(8)       COMP.
   376         88  WS-RESP-NORMAL                      VALUE +00.
   377         88  WS-RESP-NOTFND                      VALUE +13.
   378         88  WS-RESP-DUPREC                      VALUE +14.
   379         88  WS-RESP-DUPKEY                      VALUE +15.
   380         88  WS-RESP-NOTOPEN                     VALUE +19.
   381         88  WS-RESP-ENDFILE                     VALUE +20.
   382
   383     12  WS-01-CANCEL-ERR        PIC X(25)
   384         VALUE 'CANCEL DATE ERROR'.
   385     12  WS-02-CANCEL-ERR        PIC X(25)
   386         VALUE 'CERT NOT FOUND'.
   387     12  WS-04-CANCEL-ERR        PIC X(25)
   388         VALUE 'CANCEL AMOUNT ERROR'.
   389     12  WS-05-CANCEL-ERR        PIC X(25)
   390         VALUE 'CANCEL OPTION ERROR'.
   391     12  WS-06-CANCEL-ERR        PIC X(25)
   392         VALUE 'PREVIOUSLY CANCELLED'.
   393     12  WS-07-CANCEL-ERR        PIC X(25)
   394         VALUE 'INVALID DATA'.
   395     12  WS-08-CANCEL-ERR        PIC X(25)
   396         VALUE 'NO ACCOUNT MASTER'.
   397     12  WS-09-CANCEL-ERR        PIC X(25)
   398         VALUE 'SUFFIX ALREADY EXISTS'.
   399     12  WS-99-CANCEL-ERR        PIC X(25)
   400         VALUE 'MISC CANCEL ERROR'.
   401
   402 01  WS-SAVE-ALLOWABLE-BENEFIT.
   403     16  WS-SAVE-BENEFIT-CODE      PIC XX.
   404     16  WS-SAVE-BENEFIT-TYPE      PIC X.
   405     16  WS-SAVE-BENEFIT-REVISION  PIC XXX.
   406     16  WS-SAVE-BENEFIT-REM-TERM  PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   9
* EL1278.cbl
   407     16  WS-SAVE-BENEFIT-RETRO-Y-N PIC X.
   408     16  FILLER                    PIC XX.
   409 01  CTBL-KEY-SAVE               PIC X(5).
   410 01  CTBL-KEY.
   411     05  CTBL-COMPANY-CD         PIC X.
   412     05  CTBL-TABLE              PIC XXX.
   413     05  CTBL-BEN-TYPE           PIC X.
   414     05  CTBL-BEN-CODE           PIC XX.
   415 01  CANCEL-GEN-PASS-AREA.
   416     05  CG-OPTION-CODE          PIC X.
   417         88  CG-VALID-OPTION       VALUE '1' '2' '3'.
   418         88  CG-FLAT-CANCEL        VALUE '1'.
   419         88  CG-CANCEL             VALUE '2'.
   420         88  CG-CANCEL-REISSUE     VALUE '3'.
   421     05  CG-ERROR-CODE           PIC 99.
   422         88  CG-SUCCESS            VALUE 00.
   423         88  CG-DATE-ERROR         VALUE 01.
   424         88  CG-CERT-NOT-FOUND     VALUE 02.
   425         88  CG-AMOUNT-ERROR       VALUE 04.
   426         88  CG-OPTION-ERROR       VALUE 05.
   427         88  CG-PREV-CAN           VALUE 06.
   428         88  CG-INVALID-DATA       VALUE 07.
   429         88  CG-NO-ACCT-MSTR       VALUE 08.
   430         88  CG-SFX-A-EXIST        VALUE 09.
   431         88  CG-MISC-ERROR         VALUE 99.
   432     05  CG-COMPANY-ID           PIC XXX.
   433     05  CG-PROC-ID              PIC XXXX.
   434     05  CG-CURRENT-DT           PIC XX.
   435     05  CG-MONTH-END-DT         PIC XX.
   436     05  CG-CERT-KEY.
   437         10  CG-CERT-COMPANY-CD  PIC X.
   438         10  CG-CERT-CARRIER     PIC X.
   439         10  CG-CERT-GROUP       PIC X(6).
   440         10  CG-CERT-STATE       PIC XX.
   441         10  CG-CERT-ACCOUNT     PIC X(10).
   442         10  CG-CERT-EFF-DT      PIC XX.
   443         10  CG-CERT-CERT-NO     PIC X(11).
   444     05  CG-LF-CAN-DATA.
   445         10  CG-LF-CAN-DT        PIC XX.
   446         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   447     05  CG-AH-CAN-DATA.
   448         10  CG-AH-CAN-DT        PIC XX.
   449         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   450     05  CG-CERT-PROFILE-DATA.
   451         10  CG-INS-LNAME        PIC X(15).
   452         10  CG-INS-FNAME        PIC X(10).
   453         10  CG-INS-MID-INIT     PIC X.
   454         10  CG-INS-AGE          PIC 99.
   455         10  CG-JNT-LNAME        PIC X(15).
   456         10  CG-JNT-FNAME        PIC X(10).
   457         10  CG-JNT-MID-INIT     PIC X.
   458         10  CG-JNT-AGE          PIC 99.
   459     05  CG-LF-ISS-DATA.
   460         10  CG-LF-BENCD         PIC XX.
   461         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   462         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   463     05  CG-AH-ISS-DATA.
   464         10  CG-AH-BENCD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  10
* EL1278.cbl
   465         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   466     05  CG-BATCH-NO             PIC X(6).
   467     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   468     05  FILLER                  PIC X(306).
   469 01  WS-CAN-QUOTE-NOTE.
   470     12  WS-CN-DT-QUOTED         PIC  X(09).
   471     12  FILLER                  PIC  X(10)      VALUE
   472         'RF QUOTE: '.
   473     12  WS-CN-LIFE-AMT-RF       PIC  Z,ZZ9.99.
   474     12  FILLER                  PIC  X(4)       VALUE
   475         ' LF '.
   476     12  WS-CN-LF-REF-METH       PIC  X.
   477     12  FILLER                  PIC  X          VALUE ','.
   478     12  WS-CN-AH-AMT-RF         PIC  Z,ZZ9.99.
   479     12  FILLER                  PIC  X(5)       VALUE
   480         ' AH '.
   481     12  WS-CN-AH-REF-METH       PIC  X.
   482     12  FILLER                  PIC  XX         VALUE ','.
   483     12  FILLER                  PIC  X(6)       VALUE
   484         'TOTAL '.
   485     12  WS-CN-TOTAL-RF          PIC  Z,ZZ9.99.
   486     12  FILLER                  PIC  X(01)      VALUE ' '.
   487     12  WS-CN-CANCEL-DT         PIC  X(08).
   488     12  FILLER                  PIC  X(01)      VALUE ';'.
   489     12  WS-CN-PROCESSOR-ID      PIC  X(04).
   490
   491 01  WS-CM-CONTROL-PRIMARY.
   492     12  WS-CM-COMPANY-CD        PIC  X(01).
   493     12  WS-CM-CARRIER           PIC  X(01).
   494     12  WS-CM-GROUPING          PIC  X(06).
   495     12  WS-CM-STATE             PIC  X(02).
   496     12  WS-CM-ACCOUNT           PIC  X(10).
   497     12  WS-CM-CERT-EFF-DT       PIC  X(02).
   498     12  WS-CM-CERT-NO.
   499         16  WS-CM-CERT-PRIME    PIC  X(10).
   500         16  WS-CM-CERT-SFX      PIC  X(01).
   501
   502 01  WS-MA-CONTROL-PRIMARY.
   503     12  WS-MA-COMPANY-CD        PIC  X(01).
   504     12  WS-MA-CARRIER           PIC  X(01).
   505     12  WS-MA-GROUPING          PIC  X(06).
   506     12  WS-MA-STATE             PIC  X(02).
   507     12  WS-MA-ACCOUNT           PIC  X(10).
   508     12  WS-MA-CERT-EFF-DT       PIC  X(02).
   509     12  WS-MA-CERT-NO.
   510         16  WS-MA-CERT-PRIME    PIC  X(10).
   511         16  WS-MA-CERT-SFX      PIC  X(01).
   512 01  WS-CF-CONTROL-PRIMARY.
   513     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   514     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   515*        88  COMPANY-MASTER                      VALUE '1'.
   516*        88  STATE-MASTER                        VALUE '3'.
   517*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   518*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   519     12  WS-CF-ACCESS.
   520         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   521         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   522             20  FILLER          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  11
* EL1278.cbl
   523             20  WS-CF-CARRIER   PIC  X(01).
   524     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   525
   526 01  WS-AM-CONTROL-PRIMARY.
   527     12  WS-AM-COMPANY-CD        PIC  X(01).
   528     12  WS-AM-CARRIER           PIC  X(01).
   529     12  WS-AM-GROUPING          PIC  X(06).
   530     12  WS-AM-STATE             PIC  X(02).
   531     12  WS-AM-ACCOUNT           PIC  X(10).
   532     12  WS-AM-EXPIRATION-DT     PIC  X(02).
   533     12  WS-AM-FILLER            PIC  X(04).
   534
   535 01  WS-CN-CONTROL-PRIMARY.
   536     12  WS-CN-COMPANY-CD        PIC  X(01).
   537     12  WS-CN-CARRIER           PIC  X(01).
   538     12  WS-CN-GROUPING          PIC  X(06).
   539     12  WS-CN-STATE             PIC  X(02).
   540     12  WS-CN-ACCOUNT           PIC  X(10).
   541     12  WS-CN-CERT-EFF-DT       PIC  X(02).
   542     12  WS-CN-CERT-NO.
   543         16  WS-CN-CERT-PRIME    PIC  X(10).
   544         16  WS-CN-CERT-SFX      PIC  X.
   545     12  WS-CN-REC-TYPE          PIC X.
   546     12  WS-CN-SEQ-NO            PIC 9(4) BINARY.
   547
   548 01  WS-FO-CONTROL-PRIMARY.
   549     12  WS-FO-COMPANY-CD        PIC  X(01).
   550     12  WS-FO-STATE             PIC  X(02).
   551     12  WS-FO-FORM-ID           PIC  X(12).
   552     12  WS-FO-EXP-DT            PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  12
* EL1278.cbl
   554*                            COPY ERCCNOT.
   555******************************************************************
   556*                                                                *
   557*                            ERCCNOT                             *
   558*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   559*                            VMOD=2.003                          *
   560*                                                                *
   561*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
   562*                                                                *
   563*        FILE TYPE= VSAM,KSDS                                    *
   564*        RECORD SIZE = 150    RECFORM = FIXED                    *
   565*                                                                *
   566*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
   567*                                                                *
   568*        LOG = YES                                               *
   569*        SERVREQ = DELETE,UPDATE,NEWREC                          *
   570*                                                                *
   571******************************************************************
   572*                   C H A N G E   L O G
   573*
   574* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   575*-----------------------------------------------------------------
   576*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   577* EFFECTIVE    NUMBER
   578*-----------------------------------------------------------------
   579* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
   580******************************************************************
   581
   582 01  CERT-NOTE-FILE.
   583     12  CZ-RECORD-ID                PIC  XX.
   584         88  VALID-CZ-ID                  VALUE 'CZ'.
   585
   586     12  CZ-CONTROL-PRIMARY.
   587         16  CZ-COMPANY-CD           PIC X.
   588         16  CZ-CARRIER              PIC X.
   589         16  CZ-GROUPING.
   590             20 CZ-GROUPING-PREFIX   PIC XXX.
   591             20 CZ-GROUPING-PRIME    PIC XXX.
   592         16  CZ-STATE                PIC XX.
   593         16  CZ-ACCOUNT.
   594             20 CZ-ACCOUNT-PREFIX    PIC X(4).
   595             20 CZ-ACCOUNT-PRIME     PIC X(6).
   596         16  CZ-CERT-EFF-DT          PIC XX.
   597         16  CZ-CERT-NO.
   598             20  CZ-CERT-PRIME       PIC X(10).
   599             20  CZ-CERT-SFX         PIC X.
   600         16  CZ-RECORD-TYPE          PIC X.
   601             88  CERT-NOTE           VALUE '1'.
   602             88  CLAIM-CERT-NOTE     VALUE '2'.
   603         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
   604
   605     12  CZ-LAST-MAINT-DT            PIC XX.
   606     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
   607     12  CZ-LAST-MAINT-USER          PIC X(4).
   608
   609     12  CZ-NOTE-INFORMATION.
   610         16  CZ-NOTE                 PIC X(63).
   611         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  13
* EL1278.cbl
   612******************************************************************
   613*                            COPY ELCDATE.
   614******************************************************************
   615*                                                                *
   616*                                                                *
   617*                            ELCDATE.                            *
   618*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   619*                            VMOD=2.003
   620*                                                                *
   621*                                                                *
   622*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   623*                 LENGTH = 200                                   *
   624******************************************************************
   625
   626 01  DATE-CONVERSION-DATA.
   627     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   628     12  DC-OPTION-CODE                PIC X.
   629         88  BIN-TO-GREG                VALUE ' '.
   630         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   631         88  EDIT-GREG-TO-BIN           VALUE '2'.
   632         88  YMD-GREG-TO-BIN            VALUE '3'.
   633         88  MDY-GREG-TO-BIN            VALUE '4'.
   634         88  JULIAN-TO-BIN              VALUE '5'.
   635         88  BIN-PLUS-ELAPSED           VALUE '6'.
   636         88  FIND-CENTURY               VALUE '7'.
   637         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   638         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   639         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   640         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   641         88  JULIAN-TO-BIN-3            VALUE 'C'.
   642         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   643         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   644         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   645         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   646         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   647         88  CHECK-LEAP-YEAR            VALUE 'H'.
   648         88  BIN-3-TO-GREG              VALUE 'I'.
   649         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   650         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   651         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   652         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   653         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   654         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   655         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   656         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   657         88  THREE-CHARACTER-BIN
   658                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   659         88  GREGORIAN-TO-BIN
   660                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   661         88  BIN-TO-GREGORIAN
   662                  VALUES ' ' '1' 'I' '8' 'G'.
   663         88  JULIAN-TO-BINARY
   664                  VALUES '5' 'C' 'E' 'F'.
   665     12  DC-ERROR-CODE                 PIC X.
   666         88  NO-CONVERSION-ERROR        VALUE ' '.
   667         88  DATE-CONVERSION-ERROR
   668                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   669         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  14
* EL1278.cbl
   670         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   671         88  DATE-IS-INVALID            VALUE '3'.
   672         88  DATE1-GREATER-DATE2        VALUE '4'.
   673         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   674         88  DATE-INVALID-OPTION        VALUE '9'.
   675         88  INVALID-CENTURY            VALUE 'A'.
   676         88  ONLY-CENTURY               VALUE 'B'.
   677         88  ONLY-LEAP-YEAR             VALUE 'C'.
   678         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   679     12  DC-END-OF-MONTH               PIC X.
   680         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   681     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   682         88  USE-NORMAL-PROCESS         VALUE ' '.
   683         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   684         88  ADJUST-UP-100-YRS          VALUE '2'.
   685     12  FILLER                        PIC X.
   686     12  DC-CONVERSION-DATES.
   687         16  DC-BIN-DATE-1             PIC XX.
   688         16  DC-BIN-DATE-2             PIC XX.
   689         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   690         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   691                       DC-GREG-DATE-1-EDIT.
   692             20  DC-EDIT1-MONTH        PIC 99.
   693             20  SLASH1-1              PIC X.
   694             20  DC-EDIT1-DAY          PIC 99.
   695             20  SLASH1-2              PIC X.
   696             20  DC-EDIT1-YEAR         PIC 99.
   697         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   698         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   699                     DC-GREG-DATE-2-EDIT.
   700             20  DC-EDIT2-MONTH        PIC 99.
   701             20  SLASH2-1              PIC X.
   702             20  DC-EDIT2-DAY          PIC 99.
   703             20  SLASH2-2              PIC X.
   704             20  DC-EDIT2-YEAR         PIC 99.
   705         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   706         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   707                     DC-GREG-DATE-1-YMD.
   708             20  DC-YMD-YEAR           PIC 99.
   709             20  DC-YMD-MONTH          PIC 99.
   710             20  DC-YMD-DAY            PIC 99.
   711         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   712         16  DC-GREG-DATE-1-MDY-R REDEFINES
   713                      DC-GREG-DATE-1-MDY.
   714             20  DC-MDY-MONTH          PIC 99.
   715             20  DC-MDY-DAY            PIC 99.
   716             20  DC-MDY-YEAR           PIC 99.
   717         16  DC-GREG-DATE-1-ALPHA.
   718             20  DC-ALPHA-MONTH        PIC X(10).
   719             20  DC-ALPHA-DAY          PIC 99.
   720             20  FILLER                PIC XX.
   721             20  DC-ALPHA-CENTURY.
   722                 24 DC-ALPHA-CEN-N     PIC 99.
   723             20  DC-ALPHA-YEAR         PIC 99.
   724         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   725         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   726         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   727         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  15
* EL1278.cbl
   728         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   729                                       PIC 9(05).
   730         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   731             20  DC-JULIAN-YEAR        PIC 99.
   732             20  DC-JULIAN-DAYS        PIC 999.
   733         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   734         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   735         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   736     12  DATE-CONVERSION-VARIBLES.
   737         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   738         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   739             20  FILLER                PIC 9(3).
   740             20  HOLD-CEN-1-CCYY.
   741                 24  HOLD-CEN-1-CC     PIC 99.
   742                 24  HOLD-CEN-1-YY     PIC 99.
   743             20  HOLD-CEN-1-MO         PIC 99.
   744             20  HOLD-CEN-1-DA         PIC 99.
   745         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   746             20  HOLD-CEN-1-R-MO       PIC 99.
   747             20  HOLD-CEN-1-R-DA       PIC 99.
   748             20  HOLD-CEN-1-R-CCYY.
   749                 24  HOLD-CEN-1-R-CC   PIC 99.
   750                 24  HOLD-CEN-1-R-YY   PIC 99.
   751             20  FILLER                PIC 9(3).
   752         16  HOLD-CENTURY-1-X.
   753             20  FILLER                PIC X(3)  VALUE SPACES.
   754             20  HOLD-CEN-1-X-CCYY.
   755                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   756                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   757             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   758             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   759         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   760             20  HOLD-CEN-1-R-X-MO     PIC XX.
   761             20  HOLD-CEN-1-R-X-DA     PIC XX.
   762             20  HOLD-CEN-1-R-X-CCYY.
   763                 24  HOLD-CEN-1-R-X-CC PIC XX.
   764                 24  HOLD-CEN-1-R-X-YY PIC XX.
   765             20  FILLER                PIC XXX.
   766         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   767         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   768         16  DC-JULIAN-DATE-1          PIC 9(07).
   769         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   770             20  DC-JULIAN-1-CCYY.
   771                 24  DC-JULIAN-1-CC    PIC 99.
   772                 24  DC-JULIAN-1-YR    PIC 99.
   773             20  DC-JULIAN-DA-1        PIC 999.
   774         16  DC-JULIAN-DATE-2          PIC 9(07).
   775         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   776             20  DC-JULIAN-2-CCYY.
   777                 24  DC-JULIAN-2-CC    PIC 99.
   778                 24  DC-JULIAN-2-YR    PIC 99.
   779             20  DC-JULIAN-DA-2        PIC 999.
   780         16  DC-GREG-DATE-A-EDIT.
   781             20  DC-EDITA-MONTH        PIC 99.
   782             20  SLASHA-1              PIC X VALUE '/'.
   783             20  DC-EDITA-DAY          PIC 99.
   784             20  SLASHA-2              PIC X VALUE '/'.
   785             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  16
* EL1278.cbl
   786                 24  DC-EDITA-CENT     PIC 99.
   787                 24  DC-EDITA-YEAR     PIC 99.
   788         16  DC-GREG-DATE-B-EDIT.
   789             20  DC-EDITB-MONTH        PIC 99.
   790             20  SLASHB-1              PIC X VALUE '/'.
   791             20  DC-EDITB-DAY          PIC 99.
   792             20  SLASHB-2              PIC X VALUE '/'.
   793             20  DC-EDITB-CCYY.
   794                 24  DC-EDITB-CENT     PIC 99.
   795                 24  DC-EDITB-YEAR     PIC 99.
   796         16  DC-GREG-DATE-CYMD         PIC 9(08).
   797         16  DC-GREG-DATE-CYMD-R REDEFINES
   798                              DC-GREG-DATE-CYMD.
   799             20  DC-CYMD-CEN           PIC 99.
   800             20  DC-CYMD-YEAR          PIC 99.
   801             20  DC-CYMD-MONTH         PIC 99.
   802             20  DC-CYMD-DAY           PIC 99.
   803         16  DC-GREG-DATE-MDCY         PIC 9(08).
   804         16  DC-GREG-DATE-MDCY-R REDEFINES
   805                              DC-GREG-DATE-MDCY.
   806             20  DC-MDCY-MONTH         PIC 99.
   807             20  DC-MDCY-DAY           PIC 99.
   808             20  DC-MDCY-CEN           PIC 99.
   809             20  DC-MDCY-YEAR          PIC 99.
   810    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   811        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   812    12  DC-EL310-DATE                  PIC X(21).
   813    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  17
* EL1278.cbl
   815*                            COPY ELCLOGOF.
   816******************************************************************
   817*                                                                *
   818*                                                                *
   819*                            ELCLOGOF.                           *
   820*                            VMOD=2.001                          *
   821*                                                                *
   822*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   823*                                                                *
   824******************************************************************
   825 01  CLASIC-LOGOFF.
   826     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   827     12  LOGOFF-TEXT.
   828         16  FILLER          PIC X(5)    VALUE SPACES.
   829         16  LOGOFF-MSG.
   830             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   831             20  FILLER      PIC X       VALUE SPACES.
   832             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   833         16  FILLER          PIC X(80)
   834           VALUE '* YOU ARE NOW LOGGED OFF'.
   835         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   836         16  FILLER          PIC X       VALUE QUOTE.
   837         16  LOGOFF-SYS-MSG  PIC X(17)
   838           VALUE 'S CLAS-IC SYSTEM '.
   839     12  TEXT-MESSAGES.
   840         16  UNACCESS-MSG    PIC X(29)
   841             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   842         16  PGMIDERR-MSG    PIC X(17)
   843             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  18
* EL1278.cbl
   845*                            COPY ELCATTR.
   846******************************************************************
   847*                                                                *
   848*                            ELCATTR.                            *
   849*                            VMOD=2.001                          *
   850*                                                                *
   851*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   852*                                                                *
   853*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   854*                                                                *
   855*                   POS 1   P=PROTECTED                          *
   856*                           U=UNPROTECTED                        *
   857*                           S=ASKIP                              *
   858*                   POS 2   A=ALPHA/NUMERIC                      *
   859*                           N=NUMERIC                            *
   860*                   POS 3   N=NORMAL                             *
   861*                           B=BRIGHT                             *
   862*                           D=DARK                               *
   863*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   864*                           OF=MODIFIED DATA TAG OFF             *
   865*                                                                *
   866*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   867******************************************************************
   868 01  ATTRIBUTE-LIST.
   869     12  AL-PABOF            PIC X       VALUE 'Y'.
   870     12  AL-PABON            PIC X       VALUE 'Z'.
   871     12  AL-PADOF            PIC X       VALUE '%'.
   872     12  AL-PADON            PIC X       VALUE '_'.
   873     12  AL-PANOF            PIC X       VALUE '-'.
   874     12  AL-PANON            PIC X       VALUE '/'.
   875     12  AL-SABOF            PIC X       VALUE '8'.
   876     12  AL-SABON            PIC X       VALUE '9'.
   877     12  AL-SADOF            PIC X       VALUE '@'.
   878     12  AL-SADON            PIC X       VALUE QUOTE.
   879     12  AL-SANOF            PIC X       VALUE '0'.
   880     12  AL-SANON            PIC X       VALUE '1'.
   881     12  AL-UABOF            PIC X       VALUE 'H'.
   882     12  AL-UABON            PIC X       VALUE 'I'.
   883     12  AL-UADOF            PIC X       VALUE '<'.
   884     12  AL-UADON            PIC X       VALUE '('.
   885     12  AL-UANOF            PIC X       VALUE ' '.
   886     12  AL-UANON            PIC X       VALUE 'A'.
   887     12  AL-UNBOF            PIC X       VALUE 'Q'.
   888     12  AL-UNBON            PIC X       VALUE 'R'.
   889     12  AL-UNDOF            PIC X       VALUE '*'.
   890     12  AL-UNDON            PIC X       VALUE ')'.
   891     12  AL-UNNOF            PIC X       VALUE '&'.
   892     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  19
* EL1278.cbl
   894*                            COPY ELCEMIB.
   895******************************************************************
   896*                                                                *
   897*                                                                *
   898*                            ELCEMIB.                            *
   899*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   900*                            VMOD=2.005                          *
   901*                                                                *
   902*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   903*                                                                *
   904******************************************************************
   905 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   906     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   907     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   908     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   909     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   910     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   911     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   912     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   913     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   914     12  EMI-SWITCH1             PIC X        VALUE '1'.
   915         88  EMI-NO-ERRORS                    VALUE '1'.
   916         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   917         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   918     12  EMI-SWITCH2             PIC X        VALUE '1'.
   919         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   920     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   921         88  EMI-AREA1-EMPTY                  VALUE '1'.
   922         88  EMI-AREA1-FULL                   VALUE '2'.
   923     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   924         88  EMI-AREA2-EMPTY                  VALUE '1'.
   925         88  EMI-AREA2-FULL                   VALUE '2'.
   926     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   927         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   928         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   929         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   930         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   931         88  EMI-BYPASS-FATALS                VALUE 'X'.
   932     12  EMI-ERROR-LINES.
   933         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   934         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   935         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   936         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   937             20  EMI-ERR-CODES OCCURS 10 TIMES.
   938                 24  EMI-ERR-NUM         PIC X(4).
   939                 24  EMI-FILLER          PIC X.
   940                 24  EMI-SEV             PIC X.
   941                 24  FILLER              PIC X.
   942             20  FILLER                  PIC X(02).
   943     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   944         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   945             20  EMI-ERROR-NUMBER    PIC X(4).
   946             20  EMI-FILL            PIC X.
   947             20  EMI-SEVERITY        PIC X.
   948             20  FILLER              PIC X.
   949             20  EMI-ERROR-TEXT.
   950                 24  EMI-TEXT-VARIABLE   PIC X(10).
   951                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  20
* EL1278.cbl
   952     12  EMI-SEVERITY-SAVE           PIC X.
   953         88  EMI-NOTE                    VALUE 'N'.
   954         88  EMI-WARNING                 VALUE 'W'.
   955         88  EMI-FORCABLE                VALUE 'F'.
   956         88  EMI-FATAL                   VALUE 'X'.
   957     12  EMI-MESSAGE-FLAG            PIC X.
   958         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   959         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   960     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   961     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   962         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   963         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   964         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   965     12  FILLER                      PIC X(137)  VALUE SPACES.
   966     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   967     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   968     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   969     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  21
* EL1278.cbl
   971 01  WS-PASS-631.
   972     12  WS-PASS-WORK-AREA         PIC X(384).
   973     12  WS-PASS-PROGRAM-WORK-AREA PIC X(640).
   974     12  FILLER REDEFINES WS-PASS-PROGRAM-WORK-AREA.
   975*        COPY ELC631PI.
   976******************************************************************
   977*                                                                *
   978*                                                                *
   979*                            ELC631PI                            *
   980*                            VMOD=2.012                          *
   981*                                                                *
   982*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   983*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
   984*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   985*                                                                *
   986*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   987*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   988*    BETWEEN PROGRAMS.                                           *
   989*                                                                *
   990*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
   991*                                                                *
   992*               EL631 - EL6311 - EL6312 - EL6313                 *
   993*                                                                *
   994******************************************************************
   995
   996         16  PI-631-DATA.
   997             20  PI-ERPNDB-KEY.
   998                 24  PI-PB-COMPANY-CD     PIC X.
   999                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  1000                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  1001                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  1002
  1003             20  PI-ERPNDB-ALT-KEY.
  1004                 24  PI-PB-COMPANY-CD-A1  PIC X.
  1005                 24  PI-PB-CARRIER        PIC X.
  1006                 24  PI-PB-GROUPING       PIC X(6).
  1007                 24  PI-PB-STATE          PIC XX.
  1008                 24  PI-PB-ACCOUNT        PIC X(10).
  1009                 24  PI-PB-CERT-EFF-DT    PIC XX.
  1010                 24  PI-PB-CERT-NO.
  1011                     28  PI-PB-CERT-PRIME PIC X(10).
  1012                     28  PI-PB-CERT-SFX   PIC X.
  1013                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  1014                 24  PI-PB-RECORD-TYPE    PIC X.
  1015
  1016             20  PI-ERPNDB-CSR-KEY.
  1017                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  1018                 24  PI-PB-CSR-ID             PIC X(4).
  1019                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  1020                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  1021                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  1022
  1023             20  PI-BROWSE-TYPE               PIC X.
  1024                 88  PI-FILE-BROWSE             VALUE ' '.
  1025                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  1026                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  1027                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  1028                 88  PI-CSR-BROWSE              VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  22
* EL1278.cbl
  1029
  1030             20  PI-MAINT-FUNCTION            PIC X.
  1031                 88  PI-ADD-FUNCTION            VALUE 'A'.
  1032                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  1033                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  1034                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  1035                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  1036                 88  PI-PF5-FUNCTION            VALUE '5'.
  1037                 88  PI-PF6-FUNCTION            VALUE '6'.
  1038
  1039             20  PI-FILE-SWITCHES.
  1040                 24  PI-ALL-ISSUES-SW         PIC X.
  1041                     88  ALL-ISSUES             VALUE 'Y'.
  1042                 24  PI-ALL-CANCELS-SW        PIC X.
  1043                     88  ALL-CANCELS            VALUE 'Y'.
  1044                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  1045                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  1046                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  1047                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  1048                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  1049                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  1050                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  1051                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  1052                 24  PI-HOLD-REC-SW           PIC X.
  1053                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  1054                 24  PI-CHANGE-REC-SW         PIC X.
  1055                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  1056                 24  PI-CHK-REQ-REC-SW        PIC X.
  1057                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  1058                 24  PI-ISSUE-WARNING-SW      PIC X.
  1059                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  1060                 24  PI-CANCEL-WARNING-SW     PIC X.
  1061                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  1062             20  PI-DISPLAY-SCREEN-SW         PIC X.
  1063                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  1064             20  PI-ORIGINAL-BATCH-SW         PIC X.
  1065                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  1066
  1067             20  PI-MAP-NAME                  PIC X(8).
  1068
  1069             20  PI-CURSOR                    PIC S9(4) COMP.
  1070
  1071             20  PI-PREV-ALT-KEY              PIC X(36).
  1072             20  PI-PREV-CSR-KEY              PIC X(15).
  1073             20  PI-PREV-KEY.
  1074                 24  PI-PREV-COMPANY-CD       PIC X.
  1075                 24  PI-PREV-BATCH            PIC X(6).
  1076                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  1077                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  1078             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  1079             20  PI-BROWSE-SW                 PIC X.
  1080                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  1081                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  1082             20  PI-SV-CARRIER                PIC X.
  1083             20  PI-SV-GROUPING               PIC X(6).
  1084             20  PI-SV-STATE                  PIC XX.
  1085             20  PI-EDIT-SW                   PIC X.
  1086             20  PI-DISPLAY-SW                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  23
* EL1278.cbl
  1087                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
  1088                 88 PI-DISPLAY-AH          VALUE 'AH'.
  1089             20  PI-CRITERIA-DATA             PIC X(350).
  1090             20  PI-BMODE                     PIC X.
  1091             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  1092             20  PI-BPMTS                     PIC S999     COMP-3.
  1093             20  PI-BTYPE                     PIC XXX OCCURS 2.
  1094             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  1095             20  PI-CSR-SESSION-SW            PIC X.
  1096                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  1097             20  PI-ERRORS-SW                 PIC X.
  1098                 88  FATAL-ERRORS               VALUE 'X'.
  1099*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  1100             20  FILLER                       PIC X(5).
  1101
  1102         16  FILLER                PIC X(94).
  1103
  1104
  1105*                            COPY ELCINTF.
  1106******************************************************************
  1107*                                                                *
  1108*                                                                *
  1109*                            ELCINTF.                            *
  1110*                            VMOD=2.017                          *
  1111*                                                                *
  1112*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1113*                                                                *
  1114*       LENGTH = 1024                                            *
  1115*                                                                *
  1116******************************************************************
  1117*                   C H A N G E   L O G
  1118*
  1119* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1120*-----------------------------------------------------------------
  1121*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1122* EFFECTIVE    NUMBER
  1123*-----------------------------------------------------------------
  1124* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1125******************************************************************
  1126 01  PROGRAM-INTERFACE-BLOCK.
  1127     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1128     12  PI-CALLING-PROGRAM              PIC X(8).
  1129     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1130     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1131     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1132     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1133     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1134     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1135     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1136     12  PI-COMPANY-ID                   PIC XXX.
  1137     12  PI-COMPANY-CD                   PIC X.
  1138
  1139     12  PI-COMPANY-PASSWORD             PIC X(8).
  1140
  1141     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1142
  1143     12  PI-CONTROL-IN-PROGRESS.
  1144         16  PI-CARRIER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  24
* EL1278.cbl
  1145         16  PI-GROUPING                 PIC X(6).
  1146         16  PI-STATE                    PIC XX.
  1147         16  PI-ACCOUNT                  PIC X(10).
  1148         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1149                                         PIC X(10).
  1150         16  PI-CLAIM-CERT-GRP.
  1151             20  PI-CLAIM-NO             PIC X(7).
  1152             20  PI-CERT-NO.
  1153                 25  PI-CERT-PRIME       PIC X(10).
  1154                 25  PI-CERT-SFX         PIC X.
  1155             20  PI-CERT-EFF-DT          PIC XX.
  1156         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1157             20  PI-PLAN-CODE            PIC X(2).
  1158             20  PI-REVISION-NUMBER      PIC X(3).
  1159             20  PI-PLAN-EFF-DT          PIC X(2).
  1160             20  PI-PLAN-EXP-DT          PIC X(2).
  1161             20  FILLER                  PIC X(11).
  1162         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1163             20  PI-OE-REFERENCE-1.
  1164                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1165                 25  PI-OE-REF-1-SUFF    PIC XX.
  1166
  1167     12  PI-SESSION-IN-PROGRESS          PIC X.
  1168         88  CLAIM-SESSION                   VALUE '1'.
  1169         88  CREDIT-SESSION                  VALUE '2'.
  1170         88  WARRANTY-SESSION                VALUE '3'.
  1171         88  MORTGAGE-SESSION                VALUE '4'.
  1172         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1173
  1174
  1175*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1176
  1177     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1178     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1179
  1180     12  PI-CREDIT-USER                  PIC X.
  1181         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1182         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1183
  1184     12  PI-CLAIM-USER                   PIC X.
  1185         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1186         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1187
  1188     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1189         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1190         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1191         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1192         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1193         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1194
  1195     12  PI-PROCESSOR-ID                 PIC X(4).
  1196
  1197     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1198
  1199     12  PI-MEMBER-CAPTION               PIC X(10).
  1200
  1201     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1202         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  25
* EL1278.cbl
  1203
  1204     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1205     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1206     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1207     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1208
  1209     12  PI-AH-OVERRIDE-L1               PIC X.
  1210     12  PI-AH-OVERRIDE-L2               PIC XX.
  1211     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1212     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1213
  1214     12  PI-NEW-SYSTEM                   PIC X(2).
  1215
  1216     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1217     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1218         88  PI-USES-PAID-TO                 VALUE '1'.
  1219     12  PI-CRDTCRD-SYSTEM.
  1220         16  PI-CRDTCRD-USER             PIC X.
  1221             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1222             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1223         16  PI-CC-MONTH-END-DT          PIC XX.
  1224     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1225
  1226     12  PI-OE-REFERENCE-2.
  1227         16  PI-OE-REF-2-PRIME           PIC X(10).
  1228         16  PI-OE-REF-2-SUFF            PIC X.
  1229
  1230     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1231
  1232     12  PI-LANGUAGE-TYPE                PIC X.
  1233             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1234             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1235             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1236
  1237     12  PI-POLICY-LINKAGE-IND           PIC X.
  1238         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1239         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1240                                                   LOW-VALUES.
  1241
  1242     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1243     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1244         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1245         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1246
  1247     12  PI-PROCESSOR-CSR-IND            PIC X.
  1248         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1249         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1250
  1251     12  FILLER                          PIC X(3).
  1252
  1253     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1254
  1255     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1256         PI-SYSTEM-LEVEL.
  1257
  1258         16  PI-ENTRY-CODES.
  1259             20  PI-ENTRY-CD-1           PIC X.
  1260             20  PI-ENTRY-CD-2           PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  26
* EL1278.cbl
  1261
  1262         16  PI-RETURN-CODES.
  1263             20  PI-RETURN-CD-1          PIC X.
  1264             20  PI-RETURN-CD-2          PIC X.
  1265
  1266         16  PI-UPDATE-STATUS-SAVE.
  1267             20  PI-UPDATE-BY            PIC X(4).
  1268             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1269
  1270         16  PI-LOWER-CASE-LETTERS       PIC X.
  1271             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1272
  1273*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1274*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1275*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1276
  1277         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1278             88  ST-ACCNT-CNTL               VALUE ' '.
  1279             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1280             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1281             88  ACCNT-CNTL                  VALUE '3'.
  1282             88  CARR-ACCNT-CNTL             VALUE '4'.
  1283
  1284         16  PI-PROCESSOR-CAP-LIST.
  1285             20  PI-SYSTEM-CONTROLS.
  1286                24 PI-SYSTEM-DISPLAY     PIC X.
  1287                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1288                24 PI-SYSTEM-MODIFY      PIC X.
  1289                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1290             20  FILLER                  PIC XX.
  1291             20  PI-DISPLAY-CAP          PIC X.
  1292                 88  DISPLAY-CAP             VALUE 'Y'.
  1293             20  PI-MODIFY-CAP           PIC X.
  1294                 88  MODIFY-CAP              VALUE 'Y'.
  1295             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1296                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1297             20  PI-FORCE-CAP            PIC X.
  1298                 88  FORCE-CAP               VALUE 'Y'.
  1299
  1300         16  PI-PROGRAM-CONTROLS.
  1301             20  PI-PGM-PRINT-OPT        PIC X.
  1302             20  PI-PGM-FORMAT-OPT       PIC X.
  1303             20  PI-PGM-PROCESS-OPT      PIC X.
  1304             20  PI-PGM-TOTALS-OPT       PIC X.
  1305
  1306         16  PI-HELP-INTERFACE.
  1307             20  PI-LAST-ERROR-NO        PIC X(4).
  1308             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1309
  1310         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1311             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1312
  1313         16  PI-CR-CONTROL-IN-PROGRESS.
  1314             20  PI-CR-CARRIER           PIC X.
  1315             20  PI-CR-GROUPING          PIC X(6).
  1316             20  PI-CR-STATE             PIC XX.
  1317             20  PI-CR-ACCOUNT           PIC X(10).
  1318             20  PI-CR-FIN-RESP          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  27
* EL1278.cbl
  1319             20  PI-CR-TYPE              PIC X.
  1320
  1321         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1322
  1323         16  PI-CR-MONTH-END-DT          PIC XX.
  1324
  1325         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1326             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1327             88  PI-ZERO-CARRIER             VALUE '1'.
  1328             88  PI-ZERO-GROUPING            VALUE '2'.
  1329             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1330
  1331         16  PI-CARRIER-SECURITY         PIC X.
  1332             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1333
  1334         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1335             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1336             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1337
  1338         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1339             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1340                                         INDEXED BY PI-ACCESS-NDX
  1341                                         PIC X.
  1342
  1343         16  PI-GA-BILLING-CONTROL       PIC X.
  1344             88  PI-GA-BILLING               VALUE '1'.
  1345
  1346         16  PI-MAIL-PROCESSING          PIC X.
  1347             88  PI-MAIL-YES                 VALUE 'Y'.
  1348
  1349         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1350
  1351         16  PI-AR-SYSTEM.
  1352             20  PI-AR-PROCESSING-CNTL   PIC X.
  1353                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1354             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1355             20  PI-AR-MONTH-END-DT      PIC XX.
  1356
  1357         16  PI-MP-SYSTEM.
  1358             20  PI-MORTGAGE-USER            PIC X.
  1359                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1360                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1361             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1362                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1363                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1364                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1365                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1366                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1367             20  PI-MP-MONTH-END-DT          PIC XX.
  1368             20  PI-MP-REFERENCE-NO.
  1369                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1370                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1371
  1372         16  PI-LABEL-CONTROL            PIC X(01).
  1373             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1374             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1375
  1376         16  PI-BILL-GROUPING-CODE       PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  28
* EL1278.cbl
  1377             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1378
  1379         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1380             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1381             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1382
  1383         16  FILLER                      PIC X(14).
  1384
  1385     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1386******************************************************************
  1387     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
  1388         16  FILLER                PIC  X(500).
  1389         16  PI-PEND-SW            PIC  X(01).
  1390         16  PI-LF-CANCEL-DATE     PIC  X(02).
  1391         16  PI-AH-CANCEL-DATE     PIC  X(02).
  1392         16  PI-LF-CANCEL-DATE-ED  PIC  X(08).
  1393         16  PI-AH-CANCEL-DATE-ED  PIC  X(08).
  1394         16  PI-EARNING-METHOD-LF  PIC  X.
  1395         16  PI-EARNING-METHOD-AH  PIC  X.
  1396         16  PI-LF-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1397         16  PI-LF-REFUND-METH     PIC  X.
  1398         16  PI-AH-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1399         16  PI-AH-REFUND-METH     PIC  X.
  1400         16  PI-TOTAL-REFUND-AMT   PIC  S9(7)V99 COMP-3.
  1401         16  PI-MODIFY-CERT-CAP    PIC  X.
  1402             88 MODIFY-CERT-CAP    VALUE 'Y'.
  1403         16  PI-CLP-YN             PIC X.
  1404         16  PI-CANCEL-REASON      PIC X.
  1405         16  FILLER                PIC  X(97).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  29
* EL1278.cbl
  1407*                            COPY ELCAID.
  1408******************************************************************
  1409*                                                                *
  1410*                            ELCAID.                             *
  1411*                            VMOD=2.001                          *
  1412*                                                                *
  1413*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1414*                                                                *
  1415*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1416*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1417******************************************************************
  1418
  1419 01  DFHAID.
  1420   02  DFHNULL   PIC  X  VALUE  ' '.
  1421   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1422   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1423   02  DFHPEN    PIC  X  VALUE  '='.
  1424   02  DFHOPID   PIC  X  VALUE  'W'.
  1425   02  DFHPA1    PIC  X  VALUE  '%'.
  1426   02  DFHPA2    PIC  X  VALUE  '>'.
  1427   02  DFHPA3    PIC  X  VALUE  ','.
  1428   02  DFHPF1    PIC  X  VALUE  '1'.
  1429   02  DFHPF2    PIC  X  VALUE  '2'.
  1430   02  DFHPF3    PIC  X  VALUE  '3'.
  1431   02  DFHPF4    PIC  X  VALUE  '4'.
  1432   02  DFHPF5    PIC  X  VALUE  '5'.
  1433   02  DFHPF6    PIC  X  VALUE  '6'.
  1434   02  DFHPF7    PIC  X  VALUE  '7'.
  1435   02  DFHPF8    PIC  X  VALUE  '8'.
  1436   02  DFHPF9    PIC  X  VALUE  '9'.
  1437   02  DFHPF10   PIC  X  VALUE  ':'.
  1438   02  DFHPF11   PIC  X  VALUE  '#'.
  1439   02  DFHPF12   PIC  X  VALUE  '@'.
  1440   02  DFHPF13   PIC  X  VALUE  'A'.
  1441   02  DFHPF14   PIC  X  VALUE  'B'.
  1442   02  DFHPF15   PIC  X  VALUE  'C'.
  1443   02  DFHPF16   PIC  X  VALUE  'D'.
  1444   02  DFHPF17   PIC  X  VALUE  'E'.
  1445   02  DFHPF18   PIC  X  VALUE  'F'.
  1446   02  DFHPF19   PIC  X  VALUE  'G'.
  1447   02  DFHPF20   PIC  X  VALUE  'H'.
  1448   02  DFHPF21   PIC  X  VALUE  'I'.
  1449*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1450   02  DFHPF22   PIC  X  VALUE  '['.
  1451   02  DFHPF23   PIC  X  VALUE  '.'.
  1452   02  DFHPF24   PIC  X  VALUE  '<'.
  1453   02  DFHMSRE   PIC  X  VALUE  'X'.
  1454   02  DFHSTRF   PIC  X  VALUE  'h'.
  1455   02  DFHTRIG   PIC  X  VALUE  '"'.
  1456
  1457 01  FILLER  REDEFINES  DFHAID.
  1458     12  FILLER                  PIC  X(08).
  1459     12  PF-VALUES               PIC  X(01)      OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  30
* EL1278.cbl
  1461*                            COPY EL1278S.
  1462 01  EL127HI.
  1463     05  FILLER            PIC  X(0012).
  1464*    -------------------------------
  1465     05  HDATEL PIC S9(0004) COMP.
  1466     05  HDATEF PIC  X(0001).
  1467     05  FILLER REDEFINES HDATEF.
  1468         10  HDATEA PIC  X(0001).
  1469     05  HDATEI PIC  X(0008).
  1470*    -------------------------------
  1471     05  HTIMEL PIC S9(0004) COMP.
  1472     05  HTIMEF PIC  X(0001).
  1473     05  FILLER REDEFINES HTIMEF.
  1474         10  HTIMEA PIC  X(0001).
  1475     05  HTIMEI PIC  999V99.
  1476*    -------------------------------
  1477     05  CMPNYIDL PIC S9(0004) COMP.
  1478     05  CMPNYIDF PIC  X(0001).
  1479     05  FILLER REDEFINES CMPNYIDF.
  1480         10  CMPNYIDA PIC  X(0001).
  1481     05  CMPNYIDI PIC  X(0003).
  1482*    -------------------------------
  1483     05  USERIDL PIC S9(0004) COMP.
  1484     05  USERIDF PIC  X(0001).
  1485     05  FILLER REDEFINES USERIDF.
  1486         10  USERIDA PIC  X(0001).
  1487     05  USERIDI PIC  X(0004).
  1488*    -------------------------------
  1489     05  HCARIERL PIC S9(0004) COMP.
  1490     05  HCARIERF PIC  X(0001).
  1491     05  FILLER REDEFINES HCARIERF.
  1492         10  HCARIERA PIC  X(0001).
  1493     05  HCARIERI PIC  X(0001).
  1494*    -------------------------------
  1495     05  HGROUPL PIC S9(0004) COMP.
  1496     05  HGROUPF PIC  X(0001).
  1497     05  FILLER REDEFINES HGROUPF.
  1498         10  HGROUPA PIC  X(0001).
  1499     05  HGROUPI PIC  X(0006).
  1500*    -------------------------------
  1501     05  HSTATEL PIC S9(0004) COMP.
  1502     05  HSTATEF PIC  X(0001).
  1503     05  FILLER REDEFINES HSTATEF.
  1504         10  HSTATEA PIC  X(0001).
  1505     05  HSTATEI PIC  X(0002).
  1506*    -------------------------------
  1507     05  HACCTNOL PIC S9(0004) COMP.
  1508     05  HACCTNOF PIC  X(0001).
  1509     05  FILLER REDEFINES HACCTNOF.
  1510         10  HACCTNOA PIC  X(0001).
  1511     05  HACCTNOI PIC  X(0010).
  1512*    -------------------------------
  1513     05  HEFFDTL PIC S9(0004) COMP.
  1514     05  HEFFDTF PIC  X(0001).
  1515     05  FILLER REDEFINES HEFFDTF.
  1516         10  HEFFDTA PIC  X(0001).
  1517     05  HEFFDTI PIC  X(0008).
  1518*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  31
* EL1278.cbl
  1519     05  HCERTNOL PIC S9(0004) COMP.
  1520     05  HCERTNOF PIC  X(0001).
  1521     05  FILLER REDEFINES HCERTNOF.
  1522         10  HCERTNOA PIC  X(0001).
  1523     05  HCERTNOI PIC  X(0010).
  1524*    -------------------------------
  1525     05  HCRTSFXL PIC S9(0004) COMP.
  1526     05  HCRTSFXF PIC  X(0001).
  1527     05  FILLER REDEFINES HCRTSFXF.
  1528         10  HCRTSFXA PIC  X(0001).
  1529     05  HCRTSFXI PIC  X(0001).
  1530*    -------------------------------
  1531     05  HLNAMEL PIC S9(0004) COMP.
  1532     05  HLNAMEF PIC  X(0001).
  1533     05  FILLER REDEFINES HLNAMEF.
  1534         10  HLNAMEA PIC  X(0001).
  1535     05  HLNAMEI PIC  X(0015).
  1536*    -------------------------------
  1537     05  HFNAMEL PIC S9(0004) COMP.
  1538     05  HFNAMEF PIC  X(0001).
  1539     05  FILLER REDEFINES HFNAMEF.
  1540         10  HFNAMEA PIC  X(0001).
  1541     05  HFNAMEI PIC  X(0010).
  1542*    -------------------------------
  1543     05  HINITL PIC S9(0004) COMP.
  1544     05  HINITF PIC  X(0001).
  1545     05  FILLER REDEFINES HINITF.
  1546         10  HINITA PIC  X(0001).
  1547     05  HINITI PIC  X(0001).
  1548*    -------------------------------
  1549     05  LCLMDTHL PIC S9(0004) COMP.
  1550     05  LCLMDTHF PIC  X(0001).
  1551     05  FILLER REDEFINES LCLMDTHF.
  1552         10  LCLMDTHA PIC  X(0001).
  1553     05  LCLMDTHI PIC  X(0022).
  1554*    -------------------------------
  1555     05  LCLMDTL PIC S9(0004) COMP.
  1556     05  LCLMDTF PIC  X(0001).
  1557     05  FILLER REDEFINES LCLMDTF.
  1558         10  LCLMDTA PIC  X(0001).
  1559     05  LCLMDTI PIC  X(0008).
  1560*    -------------------------------
  1561     05  HPCYNL PIC S9(0004) COMP.
  1562     05  HPCYNF PIC  X(0001).
  1563     05  FILLER REDEFINES HPCYNF.
  1564         10  HPCYNA PIC  X(0001).
  1565     05  HPCYNI PIC  X(0001).
  1566*    -------------------------------
  1567     05  ACLMDTHL PIC S9(0004) COMP.
  1568     05  ACLMDTHF PIC  X(0001).
  1569     05  FILLER REDEFINES ACLMDTHF.
  1570         10  ACLMDTHA PIC  X(0001).
  1571     05  ACLMDTHI PIC  X(0023).
  1572*    -------------------------------
  1573     05  ACLMDTL PIC S9(0004) COMP.
  1574     05  ACLMDTF PIC  X(0001).
  1575     05  FILLER REDEFINES ACLMDTF.
  1576         10  ACLMDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  32
* EL1278.cbl
  1577     05  ACLMDTI PIC  X(0008).
  1578*    -------------------------------
  1579     05  PMTHDL PIC S9(0004) COMP.
  1580     05  PMTHDF PIC  X(0001).
  1581     05  FILLER REDEFINES PMTHDF.
  1582         10  PMTHDA PIC  X(0001).
  1583     05  PMTHDI PIC  X(0010).
  1584*    -------------------------------
  1585     05  CNCDTHDL PIC S9(0004) COMP.
  1586     05  CNCDTHDF PIC  X(0001).
  1587     05  FILLER REDEFINES CNCDTHDF.
  1588         10  CNCDTHDA PIC  X(0001).
  1589     05  CNCDTHDI PIC  X(0007).
  1590*    -------------------------------
  1591     05  HLKINDL PIC S9(0004) COMP.
  1592     05  HLKINDF PIC  X(0001).
  1593     05  FILLER REDEFINES HLKINDF.
  1594         10  HLKINDA PIC  X(0001).
  1595     05  HLKINDI PIC  X(0002).
  1596*    -------------------------------
  1597     05  HLCDL PIC S9(0004) COMP.
  1598     05  HLCDF PIC  X(0001).
  1599     05  FILLER REDEFINES HLCDF.
  1600         10  HLCDA PIC  X(0001).
  1601     05  HLCDI PIC  X(0002).
  1602*    -------------------------------
  1603     05  HLEDESCL PIC S9(0004) COMP.
  1604     05  HLEDESCF PIC  X(0001).
  1605     05  FILLER REDEFINES HLEDESCF.
  1606         10  HLEDESCA PIC  X(0001).
  1607     05  HLEDESCI PIC  X(0003).
  1608*    -------------------------------
  1609     05  HLTERML PIC S9(0004) COMP.
  1610     05  HLTERMF PIC  X(0001).
  1611     05  FILLER REDEFINES HLTERMF.
  1612         10  HLTERMA PIC  X(0001).
  1613     05  HLTERMI PIC  9(3).
  1614*    -------------------------------
  1615     05  HLREML PIC S9(0004) COMP.
  1616     05  HLREMF PIC  X(0001).
  1617     05  FILLER REDEFINES HLREMF.
  1618         10  HLREMA PIC  X(0001).
  1619     05  HLREMI PIC  X(0003).
  1620*    -------------------------------
  1621     05  HLPREML PIC S9(0004) COMP.
  1622     05  HLPREMF PIC  X(0001).
  1623     05  FILLER REDEFINES HLPREMF.
  1624         10  HLPREMA PIC  X(0001).
  1625     05  HLPREMI PIC  X(0011).
  1626*    -------------------------------
  1627     05  HLITDRL PIC S9(0004) COMP.
  1628     05  HLITDRF PIC  X(0001).
  1629     05  FILLER REDEFINES HLITDRF.
  1630         10  HLITDRA PIC  X(0001).
  1631     05  HLITDRI PIC  X(0011).
  1632*    -------------------------------
  1633     05  HLREFNDL PIC S9(0004) COMP.
  1634     05  HLREFNDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  33
* EL1278.cbl
  1635     05  FILLER REDEFINES HLREFNDF.
  1636         10  HLREFNDA PIC  X(0001).
  1637     05  HLREFNDI PIC  X(0011).
  1638*    -------------------------------
  1639     05  HLCANCL PIC S9(0004) COMP.
  1640     05  HLCANCF PIC  X(0001).
  1641     05  FILLER REDEFINES HLCANCF.
  1642         10  HLCANCA PIC  X(0001).
  1643     05  HLCANCI PIC  X(0008).
  1644*    -------------------------------
  1645     05  HLCAL1L PIC S9(0004) COMP.
  1646     05  HLCAL1F PIC  X(0001).
  1647     05  FILLER REDEFINES HLCAL1F.
  1648         10  HLCAL1A PIC  X(0001).
  1649     05  HLCAL1I PIC  X(0001).
  1650*    -------------------------------
  1651     05  HLCALCL PIC S9(0004) COMP.
  1652     05  HLCALCF PIC  X(0001).
  1653     05  FILLER REDEFINES HLCALCF.
  1654         10  HLCALCA PIC  X(0001).
  1655     05  HLCALCI PIC  X(0012).
  1656*    -------------------------------
  1657     05  HAKINDL PIC S9(0004) COMP.
  1658     05  HAKINDF PIC  X(0001).
  1659     05  FILLER REDEFINES HAKINDF.
  1660         10  HAKINDA PIC  X(0001).
  1661     05  HAKINDI PIC  X(0002).
  1662*    -------------------------------
  1663     05  HACDL PIC S9(0004) COMP.
  1664     05  HACDF PIC  X(0001).
  1665     05  FILLER REDEFINES HACDF.
  1666         10  HACDA PIC  X(0001).
  1667     05  HACDI PIC  X(0002).
  1668*    -------------------------------
  1669     05  HAEDESCL PIC S9(0004) COMP.
  1670     05  HAEDESCF PIC  X(0001).
  1671     05  FILLER REDEFINES HAEDESCF.
  1672         10  HAEDESCA PIC  X(0001).
  1673     05  HAEDESCI PIC  X(0003).
  1674*    -------------------------------
  1675     05  HATERML PIC S9(0004) COMP.
  1676     05  HATERMF PIC  X(0001).
  1677     05  FILLER REDEFINES HATERMF.
  1678         10  HATERMA PIC  X(0001).
  1679     05  HATERMI PIC  9(3).
  1680*    -------------------------------
  1681     05  HAREML PIC S9(0004) COMP.
  1682     05  HAREMF PIC  X(0001).
  1683     05  FILLER REDEFINES HAREMF.
  1684         10  HAREMA PIC  X(0001).
  1685     05  HAREMI PIC  X(0003).
  1686*    -------------------------------
  1687     05  HAPREML PIC S9(0004) COMP.
  1688     05  HAPREMF PIC  X(0001).
  1689     05  FILLER REDEFINES HAPREMF.
  1690         10  HAPREMA PIC  X(0001).
  1691     05  HAPREMI PIC  X(0011).
  1692*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  34
* EL1278.cbl
  1693     05  HAITDRL PIC S9(0004) COMP.
  1694     05  HAITDRF PIC  X(0001).
  1695     05  FILLER REDEFINES HAITDRF.
  1696         10  HAITDRA PIC  X(0001).
  1697     05  HAITDRI PIC  X(0011).
  1698*    -------------------------------
  1699     05  HAREFNDL PIC S9(0004) COMP.
  1700     05  HAREFNDF PIC  X(0001).
  1701     05  FILLER REDEFINES HAREFNDF.
  1702         10  HAREFNDA PIC  X(0001).
  1703     05  HAREFNDI PIC  X(0011).
  1704*    -------------------------------
  1705     05  HACANCL PIC S9(0004) COMP.
  1706     05  HACANCF PIC  X(0001).
  1707     05  FILLER REDEFINES HACANCF.
  1708         10  HACANCA PIC  X(0001).
  1709     05  HACANCI PIC  X(0008).
  1710*    -------------------------------
  1711     05  HACAL1L PIC S9(0004) COMP.
  1712     05  HACAL1F PIC  X(0001).
  1713     05  FILLER REDEFINES HACAL1F.
  1714         10  HACAL1A PIC  X(0001).
  1715     05  HACAL1I PIC  X(0001).
  1716*    -------------------------------
  1717     05  HACALCL PIC S9(0004) COMP.
  1718     05  HACALCF PIC  X(0001).
  1719     05  FILLER REDEFINES HACALCF.
  1720         10  HACALCA PIC  X(0001).
  1721     05  HACALCI PIC  X(0012).
  1722*    -------------------------------
  1723     05  TOPREML PIC S9(0004) COMP.
  1724     05  TOPREMF PIC  X(0001).
  1725     05  FILLER REDEFINES TOPREMF.
  1726         10  TOPREMA PIC  X(0001).
  1727     05  TOPREMI PIC  X(0011).
  1728*    -------------------------------
  1729     05  TOITDRL PIC S9(0004) COMP.
  1730     05  TOITDRF PIC  X(0001).
  1731     05  FILLER REDEFINES TOITDRF.
  1732         10  TOITDRA PIC  X(0001).
  1733     05  TOITDRI PIC  X(0011).
  1734*    -------------------------------
  1735     05  TORFNDL PIC S9(0004) COMP.
  1736     05  TORFNDF PIC  X(0001).
  1737     05  FILLER REDEFINES TORFNDF.
  1738         10  TORFNDA PIC  X(0001).
  1739     05  TORFNDI PIC  X(0011).
  1740*    -------------------------------
  1741     05  CANREAHL PIC S9(0004) COMP.
  1742     05  CANREAHF PIC  X(0001).
  1743     05  FILLER REDEFINES CANREAHF.
  1744         10  CANREAHA PIC  X(0001).
  1745     05  CANREAHI PIC  X(0015).
  1746*    -------------------------------
  1747     05  CANREAL PIC S9(0004) COMP.
  1748     05  CANREAF PIC  X(0001).
  1749     05  FILLER REDEFINES CANREAF.
  1750         10  CANREAA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  35
* EL1278.cbl
  1751     05  CANREAI PIC  X(0001).
  1752*    -------------------------------
  1753     05  CLPYNHL PIC S9(0004) COMP.
  1754     05  CLPYNHF PIC  X(0001).
  1755     05  FILLER REDEFINES CLPYNHF.
  1756         10  CLPYNHA PIC  X(0001).
  1757     05  CLPYNHI PIC  X(0005).
  1758*    -------------------------------
  1759     05  CLPYNL PIC S9(0004) COMP.
  1760     05  CLPYNF PIC  X(0001).
  1761     05  FILLER REDEFINES CLPYNF.
  1762         10  CLPYNA PIC  X(0001).
  1763     05  CLPYNI PIC  X(0001).
  1764*    -------------------------------
  1765     05  HLREDL PIC S9(0004) COMP.
  1766     05  HLREDF PIC  X(0001).
  1767     05  FILLER REDEFINES HLREDF.
  1768         10  HLREDA PIC  X(0001).
  1769     05  HLREDI PIC  X(0014).
  1770*    -------------------------------
  1771     05  FREMTRML PIC S9(0004) COMP.
  1772     05  FREMTRMF PIC  X(0001).
  1773     05  FILLER REDEFINES FREMTRMF.
  1774         10  FREMTRMA PIC  X(0001).
  1775     05  FREMTRMI PIC  X(0003).
  1776*    -------------------------------
  1777     05  HERMSG1L PIC S9(0004) COMP.
  1778     05  HERMSG1F PIC  X(0001).
  1779     05  FILLER REDEFINES HERMSG1F.
  1780         10  HERMSG1A PIC  X(0001).
  1781     05  HERMSG1I PIC  X(0079).
  1782*    -------------------------------
  1783     05  HERMSG2L PIC S9(0004) COMP.
  1784     05  HERMSG2F PIC  X(0001).
  1785     05  FILLER REDEFINES HERMSG2F.
  1786         10  HERMSG2A PIC  X(0001).
  1787     05  HERMSG2I PIC  X(0079).
  1788*    -------------------------------
  1789     05  HPFKEYL PIC S9(0004) COMP.
  1790     05  HPFKEYF PIC  X(0001).
  1791     05  FILLER REDEFINES HPFKEYF.
  1792         10  HPFKEYA PIC  X(0001).
  1793     05  HPFKEYI PIC  99.
  1794*    -------------------------------
  1795     05  PFKEY11L PIC S9(0004) COMP.
  1796     05  PFKEY11F PIC  X(0001).
  1797     05  FILLER REDEFINES PFKEY11F.
  1798         10  PFKEY11A PIC  X(0001).
  1799     05  PFKEY11I PIC  X(0034).
  1800 01  EL127HO REDEFINES EL127HI.
  1801     05  FILLER            PIC  X(0012).
  1802*    -------------------------------
  1803     05  FILLER            PIC  X(0003).
  1804     05  HDATEO PIC  X(0008).
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  HTIMEO PIC  99.99.
  1808*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  36
* EL1278.cbl
  1809     05  FILLER            PIC  X(0003).
  1810     05  CMPNYIDO PIC  X(0003).
  1811*    -------------------------------
  1812     05  FILLER            PIC  X(0003).
  1813     05  USERIDO PIC  X(0004).
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
  1816     05  HCARIERO PIC  X(0001).
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
  1819     05  HGROUPO PIC  X(0006).
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  HSTATEO PIC  X(0002).
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  HACCTNOO PIC  X(0010).
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  HEFFDTO PIC  X(0008).
  1829*    -------------------------------
  1830     05  FILLER            PIC  X(0003).
  1831     05  HCERTNOO PIC  X(0010).
  1832*    -------------------------------
  1833     05  FILLER            PIC  X(0003).
  1834     05  HCRTSFXO PIC  X(0001).
  1835*    -------------------------------
  1836     05  FILLER            PIC  X(0003).
  1837     05  HLNAMEO PIC  X(0015).
  1838*    -------------------------------
  1839     05  FILLER            PIC  X(0003).
  1840     05  HFNAMEO PIC  X(0010).
  1841*    -------------------------------
  1842     05  FILLER            PIC  X(0003).
  1843     05  HINITO PIC  X(0001).
  1844*    -------------------------------
  1845     05  FILLER            PIC  X(0003).
  1846     05  LCLMDTHO PIC  X(0022).
  1847*    -------------------------------
  1848     05  FILLER            PIC  X(0003).
  1849     05  LCLMDTO PIC  X(0008).
  1850*    -------------------------------
  1851     05  FILLER            PIC  X(0003).
  1852     05  HPCYNO PIC  X(0001).
  1853*    -------------------------------
  1854     05  FILLER            PIC  X(0003).
  1855     05  ACLMDTHO PIC  X(0023).
  1856*    -------------------------------
  1857     05  FILLER            PIC  X(0003).
  1858     05  ACLMDTO PIC  X(0008).
  1859*    -------------------------------
  1860     05  FILLER            PIC  X(0003).
  1861     05  PMTHDO PIC  X(0010).
  1862*    -------------------------------
  1863     05  FILLER            PIC  X(0003).
  1864     05  CNCDTHDO PIC  X(0007).
  1865*    -------------------------------
  1866     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  37
* EL1278.cbl
  1867     05  HLKINDO PIC  X(0002).
  1868*    -------------------------------
  1869     05  FILLER            PIC  X(0003).
  1870     05  HLCDO PIC  X(0002).
  1871*    -------------------------------
  1872     05  FILLER            PIC  X(0003).
  1873     05  HLEDESCO PIC  X(0003).
  1874*    -------------------------------
  1875     05  FILLER            PIC  X(0003).
  1876     05  HLTERMO PIC  ZZ9.
  1877*    -------------------------------
  1878     05  FILLER            PIC  X(0003).
  1879     05  HLREMO PIC  ZZ9.
  1880*    -------------------------------
  1881     05  FILLER            PIC  X(0003).
  1882     05  HLPREMO PIC  ZZZZ,ZZ9.99.
  1883*    -------------------------------
  1884     05  FILLER            PIC  X(0003).
  1885     05  HLITDRO PIC  ZZZZ,ZZ9.99.
  1886*    -------------------------------
  1887     05  FILLER            PIC  X(0003).
  1888     05  HLREFNDO PIC  ZZZZ,ZZ9.99.
  1889*    -------------------------------
  1890     05  FILLER            PIC  X(0003).
  1891     05  HLCANCO PIC  X(0008).
  1892*    -------------------------------
  1893     05  FILLER            PIC  X(0003).
  1894     05  HLCAL1O PIC  X(0001).
  1895*    -------------------------------
  1896     05  FILLER            PIC  X(0003).
  1897     05  HLCALCO PIC  X(0012).
  1898*    -------------------------------
  1899     05  FILLER            PIC  X(0003).
  1900     05  HAKINDO PIC  X(0002).
  1901*    -------------------------------
  1902     05  FILLER            PIC  X(0003).
  1903     05  HACDO PIC  X(0002).
  1904*    -------------------------------
  1905     05  FILLER            PIC  X(0003).
  1906     05  HAEDESCO PIC  X(0003).
  1907*    -------------------------------
  1908     05  FILLER            PIC  X(0003).
  1909     05  HATERMO PIC  ZZ9.
  1910*    -------------------------------
  1911     05  FILLER            PIC  X(0003).
  1912     05  HAREMO PIC  ZZ9.
  1913*    -------------------------------
  1914     05  FILLER            PIC  X(0003).
  1915     05  HAPREMO PIC  ZZZZ,ZZ9.99.
  1916*    -------------------------------
  1917     05  FILLER            PIC  X(0003).
  1918     05  HAITDRO PIC  ZZZZ,ZZ9.99.
  1919*    -------------------------------
  1920     05  FILLER            PIC  X(0003).
  1921     05  HAREFNDO PIC  ZZZZ,ZZ9.99.
  1922*    -------------------------------
  1923     05  FILLER            PIC  X(0003).
  1924     05  HACANCO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  38
* EL1278.cbl
  1925*    -------------------------------
  1926     05  FILLER            PIC  X(0003).
  1927     05  HACAL1O PIC  X(0001).
  1928*    -------------------------------
  1929     05  FILLER            PIC  X(0003).
  1930     05  HACALCO PIC  X(0012).
  1931*    -------------------------------
  1932     05  FILLER            PIC  X(0003).
  1933     05  TOPREMO PIC  ZZZZ,ZZ9.99.
  1934*    -------------------------------
  1935     05  FILLER            PIC  X(0003).
  1936     05  TOITDRO PIC  ZZZZ,ZZ9.99.
  1937*    -------------------------------
  1938     05  FILLER            PIC  X(0003).
  1939     05  TORFNDO PIC  ZZZZ,ZZ9.99.
  1940*    -------------------------------
  1941     05  FILLER            PIC  X(0003).
  1942     05  CANREAHO PIC  X(0015).
  1943*    -------------------------------
  1944     05  FILLER            PIC  X(0003).
  1945     05  CANREAO PIC  X(0001).
  1946*    -------------------------------
  1947     05  FILLER            PIC  X(0003).
  1948     05  CLPYNHO PIC  X(0005).
  1949*    -------------------------------
  1950     05  FILLER            PIC  X(0003).
  1951     05  CLPYNO PIC  X(0001).
  1952*    -------------------------------
  1953     05  FILLER            PIC  X(0003).
  1954     05  HLREDO PIC  ZZZ,ZZZ,ZZ9.99.
  1955*    -------------------------------
  1956     05  FILLER            PIC  X(0003).
  1957     05  FREMTRMO PIC  ZZ9.
  1958*    -------------------------------
  1959     05  FILLER            PIC  X(0003).
  1960     05  HERMSG1O PIC  X(0079).
  1961*    -------------------------------
  1962     05  FILLER            PIC  X(0003).
  1963     05  HERMSG2O PIC  X(0079).
  1964*    -------------------------------
  1965     05  FILLER            PIC  X(0003).
  1966     05  HPFKEYO PIC  99.
  1967*    -------------------------------
  1968     05  FILLER            PIC  X(0003).
  1969     05  PFKEY11O PIC  X(0034).
  1970*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  39
* EL1278.cbl
  1972*                            COPY ELCCALC.
  1973******************************************************************
  1974*                                                                *
  1975*                           ELCCALC.                            *
  1976*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1977*                            VMOD=2.025                          *
  1978*                                                                *
  1979*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1980*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1981*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1982*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1983*                                                                *
  1984*  PASSED TO ELRTRM                                              *
  1985*  -----------------                                             *
  1986*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1987*  ORIGINAL TERM                                                 *
  1988*  BEGINNING DATE                                                *
  1989*  ENDING DATE                                                   *
  1990*  COMPANY I.D.                                                  *
  1991*  ACCOUNT MASTER USER FIELD                                     *
  1992*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1993*  FREE LOOK DAYS                                                *
  1994*                                                                *
  1995*  RETURNED FROM ELRTRM                                          *
  1996*  ---------------------                                         *
  1997*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1998*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1999*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2000*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2001*----------------------------------------------------------------*
  2002*  PASSED TO ELRAMT                                              *
  2003*  ----------------                                              *
  2004*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2005*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2006*  ORIGINAL AMOUNT                                               *
  2007*  ALTERNATE BENEFIT (BALLON)                                    *
  2008*  A.P.R. - NET PAY ONLY                                         *
  2009*  METHOD
  2010*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2011*  COMPANY I.D.                                                  *
  2012*  BENEFIT TYPE                                                  *
  2013*                                                                *
  2014*  RETURNED FROM ELRAMT                                          *
  2015*  --------------------                                          *
  2016*  REMAINING AMOUNT 1 - CURRENT                                  *
  2017*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2018*  REMAINING AMOUNT FACTOR
  2019*----------------------------------------------------------------*
  2020*  PASSED TO ELRESV                                              *
  2021*  -----------------                                             *
  2022*  CERTIFICATE EFFECTIVE DATE                                    *
  2023*  VALUATION DATE                                                *
  2024*  PAID THRU DATE                                                *
  2025*  BENEFIT                                                       *
  2026*  INCURRED DATE                                                 *
  2027*  REPORTED DATE                                                 *
  2028*  ISSUE AGE                                                     *
  2029*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  40
* EL1278.cbl
  2030*  CDT PERCENT                                                   *
  2031*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2032* *CLAIM TYPE (LIFE, A/H)                                        *
  2033* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2034* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2035*                                                                *
  2036*  RETURNED FROM ELRESV                                          *
  2037*  --------------------                                          *
  2038*  CDT TABLE USED                                                *
  2039*  CDT FACTOR USED                                               *
  2040*  PAY TO CURRENT RESERVE                                        *
  2041*  I.B.N.R. - A/H ONLY                                           *
  2042*  FUTURE (ACCRUED) AH ONLY                                      *
  2043*----------------------------------------------------------------*
  2044*  PASSED TO ELRATE                                              *
  2045*  ----------------                                              *
  2046*  CERT ISSUE DATE                                               *
  2047*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2048*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2049*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2050*  STATE CODE (CLIENT DEFINED)                                   *
  2051*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2052*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2053*  DEVIATION CODE                                                *
  2054*  ISSUE AGE                                                     *
  2055*  ORIGINAL BENEFIT AMOUNT                                       *
  2056*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2057*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2058*  BENEFIT KIND (LIFE OR A/H)                                    *
  2059*  A.P.R.                                                        *
  2060*  METHOD
  2061*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2062*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2063*  COMPANY I.D. (3 CHARACTER)                                    *
  2064*  BENEFIT CODE                                                  *
  2065*  BENEFIT OVERRIDE CODE                                         *
  2066*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2067*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2068*  JOINT INDICATOR (CSL ONLY)                                    *
  2069*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2070*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2071*                                                                *
  2072*  RETURNED FROM ELRATE                                          *
  2073*  --------------------                                          *
  2074*  CALCULATED PREMIUM                                            *
  2075*  PREMIUM RATE                                                  *
  2076*  MORTALITY CODE                                                *
  2077*  MAX ATTAINED AGE                                              *
  2078*  MAX AGE                                                       *
  2079*  MAX TERM                                                      *
  2080*  MAX MONTHLY BENEFIT                                           *
  2081*  MAX TOTAL BENIFIT                                             *
  2082*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2083*----------------------------------------------------------------*
  2084*  PASSED TO ELRFND                                              *
  2085*  ----------------                                              *
  2086*  CERT ISSUE DATE                                               *
  2087*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  41
* EL1278.cbl
  2088*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2089*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2090*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2091*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2092*  STATE CODE (CLIENT DEFINED)                                   *
  2093*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2094*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2095*  DEVIATION CODE                                                *
  2096*  ISSUE AGE                                                     *
  2097*  ORIGINAL BENEFIT AMOUNT                                       *
  2098*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2099*  PROCESS TYPE (CANCEL)                                         *
  2100*  BENEFIT KIND (LIFE OR A/H)                                    *
  2101*  A.P.R.                                                        *
  2102*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2103*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2104*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2105*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2106*  COMPANY I.D. (3 CHARACTER)                                    *
  2107*  BENEFIT CODE                                                  *
  2108*  BENEFIT OVERRIDE CODE                                         *
  2109*                                                                *
  2110*  RETURNED FROM ELRFND                                          *
  2111*  --------------------                                          *
  2112*  CALCULATED REFUND                                             *
  2113*----------------------------------------------------------------*
  2114*  PASSED TO ELEARN                                              *
  2115*  ----------------                                              *
  2116*  CERT ISSUE DATE                                               *
  2117*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2118*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2119*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2120*  STATE CODE (CLIENT DEFINED)                                   *
  2121*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2122*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2123*  DEVIATION CODE                                                *
  2124*  ISSUE AGE                                                     *
  2125*  ORIGINAL BENEFIT AMOUNT                                       *
  2126*  BENEFIT KIND (LIFE OR A/H)                                    *
  2127*  A.P.R.                                                        *
  2128*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2129*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2130*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2131*  COMPANY I.D. (3 CHARACTER)                                    *
  2132*  BENEFIT CODE                                                  *
  2133*  BENEFIT OVERRIDE CODE                                         *
  2134*                                                                *
  2135*  RETURNED FROM ELEARN                                          *
  2136*  --------------------                                          *
  2137*  INDICATED  EARNINGS                                           *
  2138*----------------------------------------------------------------*
  2139*                 LENGTH = 450                                   *
  2140*                                                                *
  2141******************************************************************
  2142******************************************************************
  2143*                   C H A N G E   L O G
  2144*
  2145* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  42
* EL1278.cbl
  2146*-----------------------------------------------------------------
  2147*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2148* EFFECTIVE    NUMBER
  2149*-----------------------------------------------------------------
  2150* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2151* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2152* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2153* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2154* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2155* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2156* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2157* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2158* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2159******************************************************************
  2160
  2161 01  CALCULATION-PASS-AREA.
  2162     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2163                                     COMP.
  2164
  2165     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2166       88  NO-CP-ERROR                             VALUE ZERO.
  2167       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2168                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2169       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2170       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2171       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2172       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2173       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2174       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2175       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2176       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2177       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2178       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2179       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2180       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2181       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2182       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2183       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2184       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2185       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2186
  2187     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2188       88  NO-CP-ERROR-2                           VALUE ZERO.
  2189***********************  INPUT AREAS ****************************
  2190
  2191     12  CP-CALCULATION-AREA.
  2192         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2193         16  CP-CERT-EFF-DT        PIC XX.
  2194         16  CP-VALUATION-DT       PIC XX.
  2195         16  CP-PAID-THRU-DT       PIC XX.
  2196         16  CP-BENEFIT-TYPE       PIC X.
  2197           88  CP-AH                               VALUE 'A' 'D'
  2198                                                   'I' 'U'.
  2199           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2200           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2201         16  CP-INCURRED-DT        PIC XX.
  2202         16  CP-REPORTED-DT        PIC XX.
  2203         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  43
* EL1278.cbl
  2204         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2205         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2206                                     COMP-3.
  2207         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2208                                     COMP-3.
  2209         16  CP-CDT-METHOD         PIC X.
  2210           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2211           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2212           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2213         16  CP-CLAIM-TYPE         PIC X.
  2214           88  CP-AH-CLAIM                         VALUE 'A'.
  2215           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2216         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2217                                     COMP-3.
  2218         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2219                                     COMP-3.
  2220         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2221                                     COMP-3.
  2222         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2223                                     COMP-3.
  2224         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2225                                     COMP-3.
  2226         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2227                                     COMP-3.
  2228         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2229                                     COMP-3.
  2230         16  CP-REM-TERM-METHOD    PIC X.
  2231           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2232           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2233           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2234           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2235           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2236           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2237           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2238         16  CP-EARNING-METHOD     PIC X.
  2239           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2240           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2241           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2242           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2243           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2244           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2245           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2246           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2247           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2248           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2249           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2250           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2251           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2252           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2253         16  CP-PROCESS-TYPE       PIC X.
  2254           88  CP-CLAIM                            VALUE '1'.
  2255           88  CP-CANCEL                           VALUE '2'.
  2256           88  CP-ISSUE                            VALUE '3'.
  2257         16  CP-SPECIAL-CALC-CD    PIC X.
  2258           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2259           88  CP-1-MTH-INTEREST               VALUE ' '.
  2260           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2261           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  44
* EL1278.cbl
  2262           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2263           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2264           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2265           88  CP-FARM-PLAN                    VALUE 'F'.
  2266           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2267           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2268           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2269           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2270           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2271           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2272           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2273           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2274           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2275           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2276                                                     'W' 'X'.
  2277           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2278           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2279           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2280           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2281           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2282           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2283           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2284           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2285           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2286           88  CP-CSL-METH-1                   VALUE '5'.
  2287           88  CP-CSL-METH-2                   VALUE '6'.
  2288           88  CP-CSL-METH-3                   VALUE '7'.
  2289           88  CP-CSL-METH-4                   VALUE '8'.
  2290
  2291         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2292                                     COMP-3.
  2293         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2294         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2295         16  CP-STATE              PIC XX          VALUE SPACE.
  2296         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2297         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2298           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2299               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2300         16  CP-R78-OPTION         PIC X.
  2301           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2302           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2303
  2304         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2305         16  CP-IBNR-RESERVE-SW    PIC X.
  2306         16  CP-CLAIM-STATUS       PIC X.
  2307         16  CP-RATE-FILE          PIC X.
  2308         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2309                                     COMP-3.
  2310
  2311         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2312         16  CP-AH-OVERRIDE-CODE   PIC X.
  2313
  2314         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2315                                     COMP-3.
  2316         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2317                                   PIC S9(5)V99 COMP-3.
  2318         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2319                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  45
* EL1278.cbl
  2320         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2321                                     COMP-3.
  2322         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2323                                     COMP-3.
  2324         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2325                                  PIC S9(7)V99 COMP-3.
  2326
  2327         16  CP-PAID-FROM-DATE     PIC X(02).
  2328         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2329         16  CP-EXT-DAYS-CALC      PIC X.
  2330           88  CP-EXT-NO-CHG                   VALUE ' '.
  2331           88  CP-EXT-CHG-LF                   VALUE '1'.
  2332           88  CP-EXT-CHG-AH                   VALUE '2'.
  2333           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2334         16  CP-DOMICILE-STATE     PIC XX.
  2335         16  CP-CARRIER            PIC X.
  2336         16  CP-REIN-FLAG          PIC X.
  2337         16  CP-REM-TRM-CALC-OPTION PIC X.
  2338           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2339                      '2' '3' '4' '5'.
  2340           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2341           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2342           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2343           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2344           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2345           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2346           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2347           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2348         16  CP-SIG-SWITCH         PIC X.
  2349         16  CP-RATING-METHOD      PIC X.
  2350           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2351           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2352           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2353           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2354           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2355           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2356           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2357           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2358           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2359         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2360                                     COMP-3.
  2361         16  CP-BEN-CATEGORY       PIC X.
  2362         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2363         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2364                                   PIC S99V9(5) COMP-3.
  2365         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2366         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2367                                   PIC S99V9(5) COMP-3.
  2368         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2369         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2370         16  CP-EXPIRE-DT          PIC XX.
  2371         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2372         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2373         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2374         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2375         16  CP-DDF-SPEC-CALC      PIC X.
  2376             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2377             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  46
* EL1278.cbl
  2378         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2379         16  CP-CANCEL-REASON      PIC X.
  2380         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2381         16  CP-PMT-MODE           PIC X.
  2382         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2383         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2384         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2385         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2386         16  FILLER                PIC X.
  2387
  2388***************    OUTPUT FROM ELRESV   ************************
  2389
  2390         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2391
  2392         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2393                                     COMP-3.
  2394         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2395                                     COMP-3.
  2396         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2397                                     COMP-3.
  2398         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2399                                     COMP-3.
  2400         16  FILLER                PIC X(09).
  2401***************    OUTPUT FROM ELRTRM   *************************
  2402
  2403         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2404                                     COMP-3.
  2405         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2406                                     COMP-3.
  2407         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2408                                     COMP-3.
  2409         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2410                                     COMP-3.
  2411         16  FILLER                PIC X(12).
  2412
  2413***************    OUTPUT FROM ELRAMT   *************************
  2414
  2415         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2416                                     COMP-3.
  2417         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2418                                     COMP-3.
  2419         16  FILLER                PIC X(12).
  2420
  2421***************    OUTPUT FROM ELRATE   *************************
  2422
  2423         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2424                                     COMP-3.
  2425         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2426                                     COMP-3.
  2427         16  CP-MORTALITY-CODE     PIC X(4).
  2428         16  CP-RATE-EDIT-FLAG     PIC X.
  2429             88  CP-RATES-NEED-APR                  VALUE '1'.
  2430         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2431                                     COMP-3.
  2432         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2433         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2434         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2435                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  47
* EL1278.cbl
  2436         16  FILLER                PIC X(07).
  2437
  2438***************    OUTPUT FROM ELRFND   *************************
  2439
  2440         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2441                                     COMP-3.
  2442         16  CP-REFUND-TYPE-USED   PIC X.
  2443           88  CP-R-AS-R78                         VALUE '1'.
  2444           88  CP-R-AS-PRORATA                     VALUE '2'.
  2445           88  CP-R-AS-CALIF                       VALUE '3'.
  2446           88  CP-R-AS-TEXAS                       VALUE '4'.
  2447           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2448           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2449           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2450           88  CP-R-AS-MEAN                        VALUE '8'.
  2451           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2452           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2453           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2454           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2455           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2456           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2457         16  FILLER                PIC X(12).
  2458
  2459***************    OUTPUT FROM ELEARN   *************************
  2460
  2461         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2462                                     COMP-3.
  2463         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2464                                     COMP-3.
  2465         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2466                                     COMP-3.
  2467         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2468                                     COMP-3.
  2469         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2470                                     COMP-3.
  2471         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2472                                     COMP-3.
  2473         16  CP-EARNING-TYPE-USED  PIC X.
  2474           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2475           88  CP-E-AS-R78                         VALUE '1'.
  2476           88  CP-E-AS-PRORATA                     VALUE '2'.
  2477           88  CP-E-AS-TEXAS                       VALUE '4'.
  2478           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2479           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2480           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2481           88  CP-E-AS-MEAN                        VALUE '8'.
  2482           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2483         16  FILLER                PIC X(12).
  2484
  2485***************    OUTPUT FROM ELPMNT   *************************
  2486
  2487         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2488                                     COMP-3.
  2489         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2490                                     COMP-3.
  2491         16  FILLER                PIC X(12).
  2492
  2493***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  48
* EL1278.cbl
  2494         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2495                                     COMP-3.
  2496         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2497                                     COMP-3.
  2498         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2499                                     COMP-3.
  2500         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2501                                     COMP-3.
  2502         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2503                                     COMP-3.
  2504         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2505                                     COMP-3.
  2506         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2507             88  OPEN-RATE-FILE                   VALUE 'O'.
  2508             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2509             88  IO-ERROR                         VALUE 'E'.
  2510
  2511         16  CP-FIRST-PAY-DATE     PIC XX.
  2512
  2513         16  CP-JOINT-INDICATOR    PIC X.
  2514
  2515         16  CP-RESERVE-REMAINING-TERM
  2516                                   PIC S9(4)V9    VALUE ZERO
  2517                                     COMP-3.
  2518
  2519         16  CP-INSURED-BIRTH-DT   PIC XX.
  2520
  2521         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2522                                     COMP-3.
  2523
  2524         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2525                                     COMP-3.
  2526
  2527         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2528                                     COMP-3.
  2529
  2530         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2531                                     COMP-3.
  2532
  2533         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2534                                     COMP-3.
  2535
  2536         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2537                                     COMP-3.
  2538
  2539         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2540                                     COMP-3.
  2541
  2542         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2543             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2544
  2545         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2546                                     COMP-3.
  2547         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2548                                     COMP-3.
  2549         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2550         16  FILLER                PIC X(15).
  2551******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  49
* EL1278.cbl
  2553*                            COPY ERCNOTE.
  2554******************************************************************
  2555*                                                                *
  2556*                                                                *
  2557*                            ERCNOTE                             *
  2558*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2559*                            VMOD=2.003                          *
  2560*                                                                *
  2561*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  2562*                                                                *
  2563*        FILE TYPE= VSAM,KSDS                                    *
  2564*        RECORD SIZE = 825    RECFORM = FIXED                    *
  2565*                                                                *
  2566*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  2567*                                                                *
  2568*        LOG = YES                                               *
  2569*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  2570*                                                                *
  2571******************************************************************
  2572*                   C H A N G E   L O G
  2573*
  2574* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2575*-----------------------------------------------------------------
  2576*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2577* EFFECTIVE    NUMBER
  2578*-----------------------------------------------------------------
  2579* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  2580*                                FILE WILL CONTAIN BILLING NOTES O
  2581******************************************************************
  2582
  2583 01  CERTIFICATE-NOTE.
  2584     12  CN-RECORD-ID                PIC  XX.
  2585         88  VALID-CN-ID                  VALUE 'CN'.
  2586
  2587     12  CN-CONTROL-PRIMARY.
  2588         16  CN-COMPANY-CD           PIC X.
  2589         16  CN-CARRIER              PIC X.
  2590         16  CN-GROUPING.
  2591             20 CN-GROUPING-PREFIX   PIC XXX.
  2592             20 CN-GROUPING-PRIME    PIC XXX.
  2593         16  CN-STATE                PIC XX.
  2594         16  CN-ACCOUNT.
  2595             20 CN-ACCOUNT-PREFIX    PIC X(4).
  2596             20 CN-ACCOUNT-PRIME     PIC X(6).
  2597         16  CN-CERT-EFF-DT          PIC XX.
  2598         16  CN-CERT-NO.
  2599             20  CN-CERT-PRIME       PIC X(10).
  2600             20  CN-CERT-SFX         PIC X.
  2601
  2602     12  CN-BILLING-START-LINE-NO    PIC 99.
  2603     12  CN-BILLING-END-LINE-NO      PIC 99.
  2604
  2605     12  CN-LINES.
  2606         16  CN-LINE OCCURS 10       PIC X(77).
  2607
  2608     12  CN-LAST-MAINT-DT            PIC XX.
  2609     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  2610     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  50
* EL1278.cbl
  2611     12  FILLER                      PIC X(6).
  2612******************************************************************
  2613*                            COPY ERCCTBL.
  2614******************************************************************
  2615*                                                                *
  2616*                                                                *
  2617*                            ERCCTBL                             *
  2618*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2619*                            VMOD=2.003
  2620*                                                                *
  2621*   ONLINE CREDIT SYSTEM                                         *
  2622*                                                                *
  2623*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  2624*                                                                *
  2625*   FILE TYPE = VSAM,KSDS                                        *
  2626*   RECORD SIZE = 200   RECFORM = FIXED                          *
  2627*                                                                *
  2628*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  2629*       ALTERNATE PATH = NONE                                    *
  2630*                                                                *
  2631*   LOG = NO                                                     *
  2632*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2633*                                                                *
  2634*                                                                *
  2635******************************************************************
  2636
  2637 01  COMM-TABLE-RECORD.
  2638     12  CT-RECORD-ID                      PIC XX.
  2639         88  VALID-CT-ID                      VALUE 'CT'.
  2640
  2641     12  CT-CONTROL-PRIMARY.
  2642         16  CT-COMPANY-CD                 PIC X.
  2643         16  CT-TABLE                      PIC XXX.
  2644         16  CT-CNTRL-2.
  2645             20  CT-BEN-TYPE               PIC X.
  2646             20  CT-BEN-CODE               PIC XX.
  2647
  2648     12  CT-MAINT-INFORMATION.
  2649         16  CT-LAST-MAINT-DT              PIC XX.
  2650         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2651         16  CT-LAST-MAINT-USER            PIC X(4).
  2652         16  FILLER                        PIC X(31).
  2653
  2654     12  CT-LIMITS.
  2655         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  2656
  2657         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  2658
  2659         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  2660
  2661     12  CT-RATES.
  2662         16  CT-RTX          OCCURS 27 TIMES.
  2663             20  CT-RT                     PIC SV9(5)     COMP-3.
  2664             20  CT-RT-R   REDEFINES
  2665                 CT-RT                     PIC XXX.
  2666
  2667     12  FILLER                            PIC  X(42).
  2668
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  51
* EL1278.cbl
  2669******************************************************************
  2670
  2671****************************************************************
  2672*
  2673* Copyright (c) 2007 by Clerity Solutions, Inc.
  2674* All rights reserved.
  2675*
  2676****************************************************************
  2677 01  DFHEIV.
  2678   02  DFHEIV0               PIC X(35).
  2679   02  DFHEIV1               PIC X(08).
  2680   02  DFHEIV2               PIC X(08).
  2681   02  DFHEIV3               PIC X(08).
  2682   02  DFHEIV4               PIC X(06).
  2683   02  DFHEIV5               PIC X(04).
  2684   02  DFHEIV6               PIC X(04).
  2685   02  DFHEIV7               PIC X(02).
  2686   02  DFHEIV8               PIC X(02).
  2687   02  DFHEIV9               PIC X(01).
  2688   02  DFHEIV10              PIC S9(7) COMP-3.
  2689   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2690   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2691   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2692   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2693   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2694   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2695   02  DFHEIV17              PIC X(04).
  2696   02  DFHEIV18              PIC X(04).
  2697   02  DFHEIV19              PIC X(04).
  2698   02  DFHEIV20              USAGE IS POINTER.
  2699   02  DFHEIV21              USAGE IS POINTER.
  2700   02  DFHEIV22              USAGE IS POINTER.
  2701   02  DFHEIV23              USAGE IS POINTER.
  2702   02  DFHEIV24              USAGE IS POINTER.
  2703   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2704   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2705   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2706   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2707   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2708   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2709   02  FILLER                PIC X(02).
  2710   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2711   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2712   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2713   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2714   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2715 LINKAGE  SECTION.
  2716*****************************************************************
  2717*                                                               *
  2718* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2719* All rights reserved.                                          *
  2720*                                                               *
  2721*****************************************************************
  2722 01  dfheiblk.
  2723     02  eibtime          pic s9(7) comp-3.
  2724     02  eibdate          pic s9(7) comp-3.
  2725     02  eibtrnid         pic x(4).
  2726     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  52
* EL1278.cbl
  2727     02  eibtrmid         pic x(4).
  2728     02  dfheigdi         pic s9(4) comp.
  2729     02  eibcposn         pic s9(4) comp.
  2730     02  eibcalen         pic s9(4) comp.
  2731     02  eibaid           pic x(1).
  2732     02  eibfiller1       pic x(1).
  2733     02  eibfn            pic x(2).
  2734     02  eibfiller2       pic x(2).
  2735     02  eibrcode         pic x(6).
  2736     02  eibfiller3       pic x(2).
  2737     02  eibds            pic x(8).
  2738     02  eibreqid         pic x(8).
  2739     02  eibrsrce         pic x(8).
  2740     02  eibsync          pic x(1).
  2741     02  eibfree          pic x(1).
  2742     02  eibrecv          pic x(1).
  2743     02  eibsend          pic x(1).
  2744     02  eibatt           pic x(1).
  2745     02  eibeoc           pic x(1).
  2746     02  eibfmh           pic x(1).
  2747     02  eibcompl         pic x(1).
  2748     02  eibsig           pic x(1).
  2749     02  eibconf          pic x(1).
  2750     02  eiberr           pic x(1).
  2751     02  eibrldbk         pic x(1).
  2752     02  eiberrcd         pic x(4).
  2753     02  eibsynrb         pic x(1).
  2754     02  eibnodat         pic x(1).
  2755     02  eibfiller5       pic x(2).
  2756     02  eibresp          pic 9(09) comp.
  2757     02  eibresp2         pic 9(09) comp.
  2758     02  dfheigdj         pic s9(4) comp.
  2759     02  dfheigdk         pic s9(4) comp.
  2760
  2761 01  DFHCOMMAREA                 PIC  X(1024).
  2762
  2763*01 PARMLIST .
  2764*    12  FILLER                  PIC S9(08)      COMP.
  2765*    12  ELCNTL-POINTER          PIC S9(08)      COMP.
  2766*    12  ELACCT-POINTER          PIC S9(08)      COMP.
  2767*    12  ELCERT-POINTER          PIC S9(08)      COMP.
  2768*                            COPY ELCCNTL.
  2769******************************************************************
  2770*                                                                *
  2771*                                                                *
  2772*                            ELCCNTL.                            *
  2773*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2774*                            VMOD=2.059                          *
  2775*                                                                *
  2776*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2777*                                                                *
  2778*   FILE TYPE = VSAM,KSDS                                        *
  2779*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2780*                                                                *
  2781*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2782*       ALTERNATE INDEX = NONE                                   *
  2783*                                                                *
  2784*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  53
* EL1278.cbl
  2785*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2786******************************************************************
  2787*                   C H A N G E   L O G
  2788*
  2789* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2790*-----------------------------------------------------------------
  2791*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2792* EFFECTIVE    NUMBER
  2793*-----------------------------------------------------------------
  2794* 082503                   PEMA  ADD BENEFIT GROUP
  2795* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2796* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2797* 092705    2005050300006  PEMA  ADD SPP LEASES
  2798* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2799* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2800* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2801* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2802* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2803* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2804******************************************************************
  2805*
  2806 01  CONTROL-FILE.
  2807     12  CF-RECORD-ID                       PIC XX.
  2808         88  VALID-CF-ID                        VALUE 'CF'.
  2809
  2810     12  CF-CONTROL-PRIMARY.
  2811         16  CF-COMPANY-ID                  PIC XXX.
  2812         16  CF-RECORD-TYPE                 PIC X.
  2813             88  CF-COMPANY-MASTER              VALUE '1'.
  2814             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2815             88  CF-STATE-MASTER                VALUE '3'.
  2816             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2817             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2818             88  CF-CARRIER-MASTER              VALUE '6'.
  2819             88  CF-MORTALITY-MASTER            VALUE '7'.
  2820             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2821             88  CF-TERMINAL-MASTER             VALUE '9'.
  2822             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2823             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2824             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2825             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2826             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2827             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2828             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2829             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2830             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2831         16  CF-ACCESS-CD-GENL              PIC X(4).
  2832         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2833             20  CF-PROCESSOR               PIC X(4).
  2834         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2835             20  CF-STATE-CODE              PIC XX.
  2836             20  FILLER                     PIC XX.
  2837         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2838             20  FILLER                     PIC XX.
  2839             20  CF-HI-BEN-IN-REC           PIC XX.
  2840         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2841             20  FILLER                     PIC XXX.
  2842             20  CF-CARRIER-CNTL            PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  54
* EL1278.cbl
  2843         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2844             20  FILLER                     PIC XX.
  2845             20  CF-HI-TYPE-IN-REC          PIC 99.
  2846         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2847             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2848                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2849             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2850             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2851         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2852             20  FILLER                     PIC X.
  2853             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2854         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2855             20  FILLER                     PIC XX.
  2856             20  CF-MORTGAGE-PLAN           PIC XX.
  2857         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2858
  2859     12  CF-LAST-MAINT-DT                   PIC XX.
  2860     12  CF-LAST-MAINT-BY                   PIC X(4).
  2861     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2862
  2863     12  CF-RECORD-BODY                     PIC X(728).
  2864
  2865
  2866****************************************************************
  2867*             COMPANY MASTER RECORD                            *
  2868****************************************************************
  2869
  2870     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2871         16  CF-COMPANY-ADDRESS.
  2872             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2873             20  CF-CL-IN-CARE-OF           PIC X(30).
  2874             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2875             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2876             20  CF-CL-CITY-STATE           PIC X(30).
  2877             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2878             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2879         16  CF-COMPANY-CD                  PIC X.
  2880         16  CF-COMPANY-PASSWORD            PIC X(8).
  2881         16  CF-SECURITY-OPTION             PIC X.
  2882             88  ALL-SECURITY                   VALUE '1'.
  2883             88  COMPANY-VERIFY                 VALUE '2'.
  2884             88  PROCESSOR-VERIFY               VALUE '3'.
  2885             88  NO-SECURITY                    VALUE '4'.
  2886             88  ALL-BUT-TERM                   VALUE '5'.
  2887         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2888             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2889         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2890             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2891         16  CF-INFORCE-LOCATION            PIC X.
  2892             88  CERTS-ARE-ONLINE               VALUE '1'.
  2893             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2894             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2895         16  CF-LOWER-CASE-LETTERS          PIC X.
  2896         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2897             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2898             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2899             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2900             88  CF-ACCNT-CNTL                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  55
* EL1278.cbl
  2901             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2902
  2903         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2904         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2905
  2906         16  CF-LGX-CREDIT-USER             PIC X.
  2907             88  CO-IS-NOT-USER                 VALUE 'N'.
  2908             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2909
  2910         16 CF-CREDIT-CALC-CODES.
  2911             20  CF-CR-REM-TERM-CALC PIC X.
  2912               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2913               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2914               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2915               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2916               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2917               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2918               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2919             20  CF-CR-R78-METHOD           PIC X.
  2920               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2921               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2922
  2923         16  CF-CLAIM-CONTROL-COUNTS.
  2924             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2925                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2926
  2927             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2928                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2929
  2930             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2931                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2932
  2933             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2934                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2935
  2936         16  CF-CURRENT-MONTH-END           PIC XX.
  2937
  2938         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2939             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2940             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2941             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2942             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2943                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2944                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2945             20  CF-CO-PREM-REJECT-SW       PIC X.
  2946                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2947                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2948             20  CF-CO-REF-REJECT-SW        PIC X.
  2949                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2950                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2951
  2952         16  CF-CO-REPORTING-DT             PIC XX.
  2953         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2954         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2955           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2956           88  CF-CO-MONTH-END                  VALUE '1'.
  2957
  2958         16  CF-LGX-CLAIM-USER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  56
* EL1278.cbl
  2959             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2960             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2961
  2962         16  CF-CREDIT-EDIT-CONTROLS.
  2963             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2964             20  CF-MIN-AGE                 PIC 99.
  2965             20  CF-DEFAULT-AGE             PIC 99.
  2966             20  CF-MIN-TERM                PIC S999      COMP-3.
  2967             20  CF-MAX-TERM                PIC S999      COMP-3.
  2968             20  CF-DEFAULT-SEX             PIC X.
  2969             20  CF-JOINT-AGE-INPUT         PIC X.
  2970                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2971             20  CF-BIRTH-DATE-INPUT        PIC X.
  2972                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2973             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2974                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2975                 88  CF-ZERO-CARRIER            VALUE '1'.
  2976                 88  CF-ZERO-GROUPING           VALUE '2'.
  2977                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2978             20  CF-EDIT-SW                 PIC X.
  2979                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2980             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2981             20  CF-CR-PR-METHOD            PIC X.
  2982               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2983               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2984             20  FILLER                     PIC X.
  2985
  2986         16  CF-CREDIT-MISC-CONTROLS.
  2987             20  CF-REIN-TABLE-SW           PIC X.
  2988                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2989             20  CF-COMP-TABLE-SW           PIC X.
  2990                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2991             20  CF-EXPERIENCE-RETENTION-AGE
  2992                                            PIC S9        COMP-3.
  2993             20  CF-CONVERSION-DT           PIC XX.
  2994             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2995             20  CF-RUN-FREQUENCY-SW        PIC X.
  2996                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2997                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2998
  2999             20  CF-CR-CHECK-NO-CONTROL.
  3000                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3001                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3002                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3003                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3004                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3005                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3006
  3007                 24  CF-CR-CHECK-COUNT       REDEFINES
  3008                     CF-CR-CHECK-COUNTER      PIC X(4).
  3009
  3010                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3011                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3012
  3013                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3014                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3015                 24  CF-MAIL-PROCESSING       PIC X.
  3016                     88  MAIL-PROCESSING          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  57
* EL1278.cbl
  3017
  3018         16  CF-MISC-SYSTEM-CONTROL.
  3019             20  CF-SYSTEM-C                 PIC X.
  3020                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3021             20  CF-SYSTEM-D                 PIC X.
  3022                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3023             20  CF-SOC-SEC-NO-SW            PIC X.
  3024                 88  SOC-SEC-NO-USED             VALUE '1'.
  3025             20  CF-MEMBER-NO-SW             PIC X.
  3026                 88  MEMBER-NO-USED              VALUE '1'.
  3027             20  CF-TAX-ID-NUMBER            PIC X(11).
  3028             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3029             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3030                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3031                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3032                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3033                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3034             20  CF-SYSTEM-E                 PIC X.
  3035                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3036
  3037         16  CF-LGX-LIFE-USER               PIC X.
  3038             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3039             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3040
  3041         16  CF-CR-MONTH-END-DT             PIC XX.
  3042
  3043         16  CF-FILE-MAINT-DATES.
  3044             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3045                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3046             20  CF-LAST-BATCH       REDEFINES
  3047                 CF-LAST-BATCH-NO               PIC X(4).
  3048             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3049             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3050             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3051             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3052             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3053             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3054             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3055             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3056             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3057             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3058
  3059         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3060         16  FILLER                         PIC X.
  3061
  3062         16  CF-ALT-MORT-CODE               PIC X(4).
  3063         16  CF-MEMBER-CAPTION              PIC X(10).
  3064
  3065         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3066             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3067             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3068             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3069             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3070             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3071
  3072         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3073
  3074         16  CF-LIFE-OVERRIDE-L1            PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  58
* EL1278.cbl
  3075         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3076         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3077         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3078
  3079         16  CF-AH-OVERRIDE-L1              PIC X.
  3080         16  CF-AH-OVERRIDE-L2              PIC XX.
  3081         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3082         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3083
  3084         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3085         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3086
  3087         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3088         16  CF-AR-LAST-EL860-DT            PIC XX.
  3089         16  CF-MP-MONTH-END-DT             PIC XX.
  3090
  3091         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3092         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3093             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3094
  3095         16  CF-AR-MONTH-END-DT             PIC XX.
  3096
  3097         16  CF-CRDTCRD-USER                PIC X.
  3098             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3099             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3100
  3101         16  CF-CC-MONTH-END-DT             PIC XX.
  3102
  3103         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3104
  3105         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3106             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3107             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3108             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3109         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3110         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3111         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3112         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3113             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3114             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3115         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3116         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3117         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3118             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3119         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3120
  3121         16  CF-CL-ZIP-CODE.
  3122             20  CF-CL-ZIP-PRIME.
  3123                 24  CF-CL-ZIP-1ST          PIC X.
  3124                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3125                 24  FILLER                 PIC X(4).
  3126             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3127         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3128             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3129             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3130             20  FILLER                     PIC XXX.
  3131
  3132         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  59
* EL1278.cbl
  3133         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3134         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3135         16  CF-CO-OPTION-START-DATE        PIC XX.
  3136         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3137           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3138                                                      '3' '4'.
  3139           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3140           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3141           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3142           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3143           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3144           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3145
  3146         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3147
  3148         16  CF-PAYMENT-APPROVAL-LEVELS.
  3149             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3150             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3151             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3152             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3153             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3154             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3155
  3156         16  CF-END-USER-REPORTING-USER     PIC X.
  3157             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3158             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3159
  3160         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3161             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3162             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3163
  3164         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3165
  3166         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3167         16  FILLER                         PIC X.
  3168
  3169         16  CF-CREDIT-ARCHIVE-CNTL.
  3170             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3171             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3172             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3173
  3174         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3175
  3176         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3177             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3178             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3179
  3180         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3181             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3182             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3183
  3184         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3185
  3186         16  CF-CO-ACH-ID-CODE              PIC  X.
  3187             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3188             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3189             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3190         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  60
* EL1278.cbl
  3191         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3192         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3193         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3194         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3195         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3196         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3197         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3198         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3199                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3200         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3201                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3202
  3203         16  CF-CO-OVER-SHORT.
  3204             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3205             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3206
  3207*         16  FILLER                         PIC X(102).
  3208         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3209             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3210             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3211
  3212         16  CF-AH-APPROVAL-DAYS.
  3213             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3214             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3215             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3216             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3217
  3218         16  FILLER                         PIC X(82).
  3219****************************************************************
  3220*             PROCESSOR/USER RECORD                            *
  3221****************************************************************
  3222
  3223     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3224         16  CF-PROCESSOR-NAME              PIC X(30).
  3225         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3226         16  CF-PROCESSOR-TITLE             PIC X(26).
  3227         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3228                 88  MESSAGE-YES                VALUE 'Y'.
  3229                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3230
  3231*****************************************************
  3232****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3233****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3234****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3235****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3236*****************************************************
  3237
  3238         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3239             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3240             20  CF-APPLICATION-FORCE       PIC X.
  3241             20  CF-INDIVIDUAL-APP.
  3242                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3243                     28  CF-BROWSE-APP      PIC X.
  3244                     28  CF-UPDATE-APP      PIC X.
  3245
  3246         16  CF-CURRENT-TERM-ON             PIC X(4).
  3247         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3248             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  61
* EL1278.cbl
  3249             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3250             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3251             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3252             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3253             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3254             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3255         16  CF-PROCESSOR-CARRIER           PIC X.
  3256             88  NO-CARRIER-SECURITY            VALUE ' '.
  3257         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3258             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3259         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3260             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3261         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3262             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3263
  3264         16  CF-PROC-SYS-ACCESS-SW.
  3265             20  CF-PROC-CREDIT-CLAIMS-SW.
  3266                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3267                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3268                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3269                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3270             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3271                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3272                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3273             20  CF-PROC-LIFE-GNRLDGR-SW.
  3274                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3275                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3276                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3277                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3278             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3279                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3280                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3281         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3282             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3283             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3284         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3285
  3286         16  CF-APPROVAL-LEVEL                  PIC X.
  3287             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3288             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3289             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3290             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3291
  3292         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3293
  3294         16  CF-LANGUAGE-TYPE                   PIC X.
  3295             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3296             88  CF-LANG-IS-FR                      VALUE 'F'.
  3297
  3298         16  CF-CSR-IND                         PIC X.
  3299         16  FILLER                             PIC X(239).
  3300
  3301****************************************************************
  3302*             PROCESSOR/REMINDERS RECORD                       *
  3303****************************************************************
  3304
  3305     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3306         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  62
* EL1278.cbl
  3307             20  CF-START-REMIND-DT         PIC XX.
  3308             20  CF-END-REMIND-DT           PIC XX.
  3309             20  CF-REMINDER-TEXT           PIC X(50).
  3310         16  FILLER                         PIC X(296).
  3311
  3312
  3313****************************************************************
  3314*             STATE MASTER RECORD                              *
  3315****************************************************************
  3316
  3317     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3318         16  CF-STATE-ABBREVIATION          PIC XX.
  3319         16  CF-STATE-NAME                  PIC X(25).
  3320         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3321         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3322             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3323             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3324             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3325             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3326                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3327                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3328             20  CF-ST-PREM-REJECT-SW       PIC X.
  3329                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3330                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3331             20  CF-ST-REF-REJECT-SW        PIC X.
  3332                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3333                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3334         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3335         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3336         16  CF-ST-REFUND-RULES.
  3337             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3338             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3339             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3340         16  CF-ST-FST-PMT-EXTENSION.
  3341             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3342             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3343                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3344                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3345                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3346                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3347         16  CF-ST-STATE-CALL.
  3348             20  CF-ST-CALL-UNEARNED        PIC X.
  3349             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3350             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3351         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3352             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3353             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3354         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3355         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3356         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3357         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3358         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3359         16  FILLER                         PIC X.
  3360         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3361             20  CF-ST-BENEFIT-CD           PIC XX.
  3362             20  CF-ST-BENEFIT-KIND         PIC X.
  3363                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3364                 88  CF-ST-AH-KIND              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  63
* EL1278.cbl
  3365             20  CF-ST-REM-TERM-CALC        PIC X.
  3366                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3367                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3368                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3369                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3370                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3371                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3372                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3373                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3374
  3375             20  CF-ST-REFUND-CALC          PIC X.
  3376                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3377                 88  ST-REFD-BY-R78             VALUE '1'.
  3378                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3379                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3380                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3381                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3382                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3383                 88  ST-REFD-UTAH               VALUE '7'.
  3384                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3385                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3386                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3387
  3388             20  CF-ST-EARNING-CALC         PIC X.
  3389                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3390                 88  ST-EARN-BY-R78             VALUE '1'.
  3391                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3392                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3393                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3394                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3395                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3396                 88  ST-EARN-MEAN               VALUE '8'.
  3397                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3398
  3399             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3400                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3401                 88  ST-OVRD-BY-R78             VALUE '1'.
  3402                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3403                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3404                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3405                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3406                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3407                 88  ST-OVRD-MEAN               VALUE '8'.
  3408                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3409             20  FILLER                     PIC X.
  3410
  3411         16  CF-ST-COMMISSION-CAPS.
  3412             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3413             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3414             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3415             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3416         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3417                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3418
  3419         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3420
  3421         16  CF-ST-STATUTORY-INTEREST.
  3422             20  CF-ST-STAT-DATE-FROM       PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  64
* EL1278.cbl
  3423                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3424                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3425             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3426             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3427             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3428             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3429             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3430
  3431         16  CF-ST-OVER-SHORT.
  3432             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3433             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3434
  3435         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3436
  3437         16  CF-ST-RT-CALC                  PIC X.
  3438
  3439         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3440         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3441         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3442         16  CF-ST-RF-LR-CALC               PIC X.
  3443         16  CF-ST-RF-LL-CALC               PIC X.
  3444         16  CF-ST-RF-LN-CALC               PIC X.
  3445         16  CF-ST-RF-AH-CALC               PIC X.
  3446         16  CF-ST-RF-CP-CALC               PIC X.
  3447*        16  FILLER                         PIC X(206).
  3448*CIDMOD         16  FILLER                         PIC X(192).
  3449         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3450             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3451         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3452         16  CF-ST-VFY-2ND-BENE             PIC X.
  3453         16  FILLER                         PIC X(186).
  3454
  3455****************************************************************
  3456*             BENEFIT MASTER RECORD                            *
  3457****************************************************************
  3458
  3459     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3460         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3461             20  CF-BENEFIT-CODE            PIC XX.
  3462             20  CF-BENEFIT-NUMERIC  REDEFINES
  3463                 CF-BENEFIT-CODE            PIC XX.
  3464             20  CF-BENEFIT-ALPHA           PIC XXX.
  3465             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3466             20  CF-BENEFIT-COMMENT         PIC X(10).
  3467
  3468             20  CF-LF-COVERAGE-TYPE        PIC X.
  3469                 88  CF-REDUCING                VALUE 'R'.
  3470                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3471
  3472             20  CF-SPECIAL-CALC-CD         PIC X.
  3473                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3474                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3475                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3476                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3477                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3478                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3479                 88  CF-FARM-PLAN               VALUE 'F'.
  3480                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  65
* EL1278.cbl
  3481                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3482                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3483                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3484                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3485                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3486                 88  CF-PRUDENTIAL              VALUE 'P'.
  3487                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3488                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3489                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3490                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3491                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3492                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3493
  3494             20  CF-JOINT-INDICATOR         PIC X.
  3495                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3496
  3497*            20  FILLER                     PIC X(12).
  3498             20  FILLER                     PIC X(11).
  3499             20  CF-BENEFIT-CATEGORY        PIC X.
  3500             20  CF-LOAN-TYPE               PIC X(8).
  3501
  3502             20  CF-CO-REM-TERM-CALC        PIC X.
  3503                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3504                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3505                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3506                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3507                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3508
  3509             20  CF-CO-EARNINGS-CALC        PIC X.
  3510                 88  CO-EARN-BY-R78             VALUE '1'.
  3511                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3512                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3513                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3514                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3515                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3516                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3517                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3518
  3519             20  CF-CO-REFUND-CALC          PIC X.
  3520                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3521                 88  CO-REFD-BY-R78             VALUE '1'.
  3522                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3523                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3524                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3525                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3526                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3527                 88  CO-REFD-MEAN               VALUE '8'.
  3528                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3529                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3530                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3531
  3532             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3533                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3534                 88  CO-OVRD-BY-R78             VALUE '1'.
  3535                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3536                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3537                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3538                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  66
* EL1278.cbl
  3539                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3540                 88  CO-OVRD-MEAN               VALUE '8'.
  3541                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3542
  3543             20  CF-CO-BEN-I-G-CD           PIC X.
  3544                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3545                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3546                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3547
  3548         16  FILLER                         PIC X(304).
  3549
  3550
  3551****************************************************************
  3552*             CARRIER MASTER RECORD                            *
  3553****************************************************************
  3554
  3555     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3556         16  CF-ADDRESS-DATA.
  3557             20  CF-MAIL-TO-NAME            PIC X(30).
  3558             20  CF-IN-CARE-OF              PIC X(30).
  3559             20  CF-ADDRESS-LINE-1          PIC X(30).
  3560             20  CF-ADDRESS-LINE-2          PIC X(30).
  3561             20  CF-CITY-STATE              PIC X(30).
  3562             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3563             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3564
  3565         16  CF-CLAIM-NO-CONTROL.
  3566             20  CF-CLAIM-NO-METHOD         PIC X.
  3567                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3568                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3569                 88  CLAIM-NO-SEQ               VALUE '3'.
  3570                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3571             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3572                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3573                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3574                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3575
  3576         16  CF-CHECK-NO-CONTROL.
  3577             20  CF-CHECK-NO-METHOD         PIC X.
  3578                 88  CHECK-NO-MANUAL            VALUE '1'.
  3579                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3580                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3581                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3582             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3583                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3584
  3585         16  CF-DOMICILE-STATE              PIC XX.
  3586
  3587         16  CF-EXPENSE-CONTROLS.
  3588             20  CF-EXPENSE-METHOD          PIC X.
  3589                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3590                 88  DOLLARS-PER-PMT            VALUE '2'.
  3591                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3592                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3593             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3594             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3595
  3596         16  CF-CORRESPONDENCE-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  67
* EL1278.cbl
  3597             20  CF-LETTER-RESEND-OPT       PIC X.
  3598                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3599                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3600             20  FILLER                     PIC X(4).
  3601
  3602         16  CF-RESERVE-CONTROLS.
  3603             20  CF-MANUAL-SW               PIC X.
  3604                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3605             20  CF-FUTURE-SW               PIC X.
  3606                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3607             20  CF-PTC-SW                  PIC X.
  3608                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3609             20  CF-IBNR-SW                 PIC X.
  3610                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3611             20  CF-PTC-LF-SW               PIC X.
  3612                 88  CF-LF-PTC-USED             VALUE '1'.
  3613             20  CF-CDT-ACCESS-METHOD       PIC X.
  3614                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3615                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3616                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3617             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3618
  3619         16  CF-CLAIM-CALC-METHOD           PIC X.
  3620             88  360-PLUS-MONTHS                VALUE '1'.
  3621             88  365-PLUS-MONTHS                VALUE '2'.
  3622             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3623             88  360-DAILY                      VALUE '4'.
  3624             88  365-DAILY                      VALUE '5'.
  3625
  3626         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3627         16  FILLER                         PIC X(11).
  3628
  3629         16  CF-LIMIT-AMOUNTS.
  3630             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3631             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3632             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3633             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3634             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3635             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3636             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3637             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3638             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3639             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3640
  3641         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3642         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3643         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3644
  3645         16  CF-ZIP-CODE.
  3646             20  CF-ZIP-PRIME.
  3647                 24  CF-ZIP-1ST             PIC X.
  3648                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3649                 24  FILLER                 PIC X(4).
  3650             20  CF-ZIP-PLUS4               PIC X(4).
  3651         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3652             20  CF-CAN-POSTAL-1            PIC XXX.
  3653             20  CF-CAN-POSTAL-2            PIC XXX.
  3654             20  FILLER                     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  68
* EL1278.cbl
  3655
  3656         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3657         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3658         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3659
  3660         16  CF-RATING-SWITCH               PIC X.
  3661             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3662             88  CF-NO-RATING                   VALUE 'N'.
  3663
  3664         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3665
  3666         16  CF-CARRIER-OVER-SHORT.
  3667             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3668             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3669
  3670         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3671         16  CF-SECPAY-SWITCH               PIC X.
  3672             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3673             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3674         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3675         16  FILLER                         PIC X(448).
  3676*        16  FILLER                         PIC X(452).
  3677
  3678
  3679****************************************************************
  3680*             MORTALITY MASTER RECORD                          *
  3681****************************************************************
  3682
  3683     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3684         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3685                                INDEXED BY CF-MORT-NDX.
  3686             20  CF-MORT-TABLE              PIC X(5).
  3687             20  CF-MORT-TABLE-TYPE         PIC X.
  3688                 88  CF-MORT-JOINT              VALUE 'J'.
  3689                 88  CF-MORT-SINGLE             VALUE 'S'.
  3690                 88  CF-MORT-COMBINED           VALUE 'C'.
  3691                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3692                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3693             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3694             20  CF-MORT-AGE-METHOD         PIC XX.
  3695                 88  CF-AGE-LAST                VALUE 'AL'.
  3696                 88  CF-AGE-NEAR                VALUE 'AN'.
  3697             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3698             20  CF-MORT-ADJUSTMENT-DIRECTION
  3699                                            PIC X.
  3700                 88  CF-MINUS                   VALUE '-'.
  3701                 88  CF-PLUS                    VALUE '+'.
  3702             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3703             20  CF-MORT-JOINT-CODE         PIC X.
  3704                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3705             20  CF-MORT-PC-Q               PIC X.
  3706                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3707             20  CF-MORT-TABLE-CODE         PIC X(4).
  3708             20  CF-MORT-COMMENTS           PIC X(15).
  3709             20  FILLER                     PIC X(14).
  3710
  3711         16  FILLER                         PIC X(251).
  3712
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  69
* EL1278.cbl
  3713
  3714****************************************************************
  3715*             BUSSINESS TYPE MASTER RECORD                     *
  3716****************************************************************
  3717
  3718     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3719* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3720* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3721* AND RECORD 05 IS TYPES 81-99
  3722         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3723             20  CF-BUSINESS-TITLE          PIC  X(19).
  3724             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3725                                            PIC S9V9(4) COMP-3.
  3726             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3727             20  FILLER                     PIC  X.
  3728         16  FILLER                         PIC  X(248).
  3729
  3730
  3731****************************************************************
  3732*             TERMINAL MASTER RECORD                           *
  3733****************************************************************
  3734
  3735     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3736
  3737         16  CF-COMPANY-TERMINALS.
  3738             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3739                                  PIC X(4).
  3740         16  FILLER               PIC X(248).
  3741
  3742
  3743****************************************************************
  3744*             LIFE EDIT MASTER RECORD                          *
  3745****************************************************************
  3746
  3747     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3748         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3749             20  CF-LIFE-CODE-IN            PIC XX.
  3750             20  CF-LIFE-CODE-OUT           PIC XX.
  3751         16  FILLER                         PIC X(248).
  3752
  3753
  3754****************************************************************
  3755*             AH EDIT MASTER RECORD                            *
  3756****************************************************************
  3757
  3758     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3759         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3760             20  CF-AH-CODE-IN              PIC XXX.
  3761             20  CF-AH-CODE-OUT             PIC XX.
  3762         16  FILLER                         PIC X(248).
  3763
  3764
  3765****************************************************************
  3766*             CREDIBILITY TABLES                               *
  3767****************************************************************
  3768
  3769     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3770         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  70
* EL1278.cbl
  3771                             INDEXED BY CF-CRDB-NDX.
  3772             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3773             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3774             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3775         16  FILLER                         PIC  X(332).
  3776
  3777
  3778****************************************************************
  3779*             REPORT CUSTOMIZATION RECORD                      *
  3780****************************************************************
  3781
  3782     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3783         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3784             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3785             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3786             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3787**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3788****       A T-TRANSFER.                                   ****
  3789             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3790
  3791         16  FILLER                         PIC XX.
  3792
  3793         16  CF-CARRIER-CNTL-OPT.
  3794             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3795                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3796                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3797             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3798                                            PIC X.
  3799         16  CF-GROUP-CNTL-OPT.
  3800             20  CF-GROUP-OPT-SEQ           PIC 9.
  3801                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3802                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3803             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3804                                            PIC X(6).
  3805         16  CF-STATE-CNTL-OPT.
  3806             20  CF-STATE-OPT-SEQ           PIC 9.
  3807                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3808                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3809             20  CF-STATE-SELECT OCCURS 3 TIMES
  3810                                            PIC XX.
  3811         16  CF-ACCOUNT-CNTL-OPT.
  3812             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3813                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3814                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3815             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3816                                            PIC X(10).
  3817         16  CF-BUS-TYP-CNTL-OPT.
  3818             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3819                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3820                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3821             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3822                                            PIC XX.
  3823         16  CF-LF-TYP-CNTL-OPT.
  3824             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3825                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3826                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3827             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3828                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  71
* EL1278.cbl
  3829         16  CF-AH-TYP-CNTL-OPT.
  3830             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3831                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3832                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3833             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3834                                            PIC XX.
  3835         16  CF-REPTCD1-CNTL-OPT.
  3836             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3837                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3838                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3839             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3840                                            PIC X(10).
  3841         16  CF-REPTCD2-CNTL-OPT.
  3842             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3843                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3844                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3845             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3846                                            PIC X(10).
  3847         16  CF-USER1-CNTL-OPT.
  3848             20  CF-USER1-OPT-SEQ           PIC 9.
  3849                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3850                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3851             20  CF-USER1-SELECT OCCURS 3 TIMES
  3852                                            PIC X(10).
  3853         16  CF-USER2-CNTL-OPT.
  3854             20  CF-USER2-OPT-SEQ           PIC 9.
  3855                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3856                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3857             20  CF-USER2-SELECT OCCURS 3 TIMES
  3858                                            PIC X(10).
  3859         16  CF-USER3-CNTL-OPT.
  3860             20  CF-USER3-OPT-SEQ           PIC 9.
  3861                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3862                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3863             20  CF-USER3-SELECT OCCURS 3 TIMES
  3864                                            PIC X(10).
  3865         16  CF-USER4-CNTL-OPT.
  3866             20  CF-USER4-OPT-SEQ           PIC 9.
  3867                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3868                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3869             20  CF-USER4-SELECT OCCURS 3 TIMES
  3870                                            PIC X(10).
  3871         16  CF-USER5-CNTL-OPT.
  3872             20  CF-USER5-OPT-SEQ           PIC 9.
  3873                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3874                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3875             20  CF-USER5-SELECT OCCURS 3 TIMES
  3876                                            PIC X(10).
  3877         16  CF-REINS-CNTL-OPT.
  3878             20  CF-REINS-OPT-SEQ           PIC 9.
  3879                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3880                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3881             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3882                 24  CF-REINS-PRIME         PIC XXX.
  3883                 24  CF-REINS-SUB           PIC XXX.
  3884
  3885         16  CF-AGENT-CNTL-OPT.
  3886             20  CF-AGENT-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  72
* EL1278.cbl
  3887                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3888                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3889             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3890                                            PIC X(10).
  3891
  3892         16  FILLER                         PIC X(43).
  3893
  3894         16  CF-LOSS-RATIO-SELECT.
  3895             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3896             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3897         16  CF-ENTRY-DATE-SELECT.
  3898             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3899             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3900         16  CF-EFFECTIVE-DATE-SELECT.
  3901             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3902             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3903
  3904         16  CF-EXCEPTION-LIST-IND          PIC X.
  3905             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3906
  3907         16  FILLER                         PIC X(318).
  3908
  3909****************************************************************
  3910*                  EXCEPTION REPORTING RECORD                  *
  3911****************************************************************
  3912
  3913     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3914         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3915             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3916
  3917         16  CF-COMBINED-LIFE-AH-OPT.
  3918             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3919             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3920             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3921             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3922
  3923         16  CF-LIFE-OPT.
  3924             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3925             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3926             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3927             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3928             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3929             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3930             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3931             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3932             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3933             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3934
  3935         16  CF-AH-OPT.
  3936             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3937             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3938             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3939             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3940             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3941             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3942             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3943             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3944             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  73
* EL1278.cbl
  3945             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3946
  3947         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3948             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3949             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3950             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3951
  3952         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3953
  3954         16  FILLER                         PIC X(673).
  3955
  3956
  3957****************************************************************
  3958*             MORTGAGE SYSTEM PLAN RECORD                      *
  3959****************************************************************
  3960
  3961     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3962         16  CF-PLAN-TYPE                   PIC X.
  3963             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3964             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3965             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3966         16  CF-PLAN-ABBREV                 PIC XXX.
  3967         16  CF-PLAN-DESCRIPT               PIC X(10).
  3968         16  CF-PLAN-NOTES                  PIC X(20).
  3969         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3970         16  CF-PLAN-UNDERWRITING.
  3971             20  CF-PLAN-TERM-DATA.
  3972                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3973                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3974             20  CF-PLAN-AGE-DATA.
  3975                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3976                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3977                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3978             20  CF-PLAN-BENEFIT-DATA.
  3979                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3980                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3981                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3982                                            PIC S9(7)V99  COMP-3.
  3983         16  CF-PLAN-POLICY-FORMS.
  3984             20  CF-POLICY-FORM             PIC X(12).
  3985             20  CF-MASTER-APPLICATION      PIC X(12).
  3986             20  CF-MASTER-POLICY           PIC X(12).
  3987         16  CF-PLAN-RATING.
  3988             20  CF-RATE-CODE               PIC X(5).
  3989             20  CF-SEX-RATING              PIC X.
  3990                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3991                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3992             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3993             20  CF-SUB-STD-TYPE            PIC X.
  3994                 88  CF-PCT-OF-PREM            VALUE '1'.
  3995                 88  CF-PCT-OF-BENE            VALUE '2'.
  3996         16  CF-PLAN-PREM-TOLERANCES.
  3997             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3998             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3999         16  CF-PLAN-PYMT-TOLERANCES.
  4000             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4001             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4002         16  CF-PLAN-MISC-DATA.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  74
* EL1278.cbl
  4003             20  FILLER                     PIC X.
  4004             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4005             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4006         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4007         16  CF-PLAN-IND-GRP                PIC X.
  4008             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4009                                                     '1'.
  4010             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4011                                                     '2'.
  4012         16  CF-MIB-SEARCH-SW               PIC X.
  4013             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4014             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4015             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4016             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4017         16  CF-ALPHA-SEARCH-SW             PIC X.
  4018             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4019             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4020             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4021             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4022             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4023             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4024             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4025             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4026             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4027             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4028                                                     'A' 'B' 'C'
  4029                                                     'X' 'Y' 'Z'.
  4030         16  CF-EFF-DT-RULE-SW              PIC X.
  4031             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4032             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4033             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4034             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4035             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4036         16  FILLER                         PIC X(4).
  4037         16  CF-HEALTH-QUESTIONS            PIC X.
  4038             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4039         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4040         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4041         16  CF-PLAN-SNGL-JNT               PIC X.
  4042             88  CF-COMBINED-PLAN              VALUE 'C'.
  4043             88  CF-JNT-PLAN                   VALUE 'J'.
  4044             88  CF-SNGL-PLAN                  VALUE 'S'.
  4045         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4046         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4047         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4048         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4049         16  CF-RERATE-CNTL                 PIC  X.
  4050             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4051             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4052             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4053             88  CF-AUTO-RECALC                 VALUE '4'.
  4054         16  CF-BENEFIT-TYPE                PIC  X.
  4055             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4056             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4057         16  CF-POLICY-FEE                  PIC S999V99
  4058                                                    COMP-3.
  4059         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4060         16  CF-2ND-NOTICE-FORM             PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  75
* EL1278.cbl
  4061         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4062         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4063         16  FILLER                         PIC  X(32).
  4064         16  CF-TERMINATION-FORM            PIC  X(04).
  4065         16  FILLER                         PIC  X(08).
  4066         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4067                                                       COMP-3.
  4068         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4069         16  CF-ISSUE-LETTER                PIC  X(4).
  4070         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4071         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4072             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4073             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4074         16  CF-MP-REFUND-CALC              PIC X.
  4075             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4076             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4077             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4078             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4079             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4080             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4081             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4082             88  CF-MP-REFD-MEAN                VALUE '8'.
  4083         16  CF-ALT-RATE-CODE               PIC  X(5).
  4084
  4085
  4086         16  FILLER                         PIC X(498).
  4087****************************************************************
  4088*             MORTGAGE COMPANY MASTER RECORD                   *
  4089****************************************************************
  4090
  4091     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4092         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4093         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4094             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4095             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4096             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4097             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4098             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4099
  4100         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4101         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4102         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4103         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4104         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4105
  4106         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4107             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4108         16  CF-MP-RECON-USE-IND            PIC X(1).
  4109             88  CF-MP-USE-RECON             VALUE 'Y'.
  4110         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4111             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4112         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4113             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4114             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4115         16  FILLER                         PIC X(1).
  4116         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4117             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4118         16  CF-MORTG-MIB-VERSION           PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  76
* EL1278.cbl
  4119             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4120             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4121             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4122         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4123             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4124                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4125             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4126                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4127             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4128                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4129             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4130                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4131             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4132                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4133             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4134                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4135         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4136         16  FILLER                         PIC X(7).
  4137         16  CF-MORTG-DESTINATION-SYMBOL.
  4138             20  CF-MORTG-MIB-COMM          PIC X(5).
  4139             20  CF-MORTG-MIB-TERM          PIC X(5).
  4140         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4141             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4142         16  FILLER                         PIC X(03).
  4143         16  CF-MP-CHECK-NO-CONTROL.
  4144             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4145                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4146                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4147                                                ' ' LOW-VALUES.
  4148                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4149                                               VALUE '3'.
  4150         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4151         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4152         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4153             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4154                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4155             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4156                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4157             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4158                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4159             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4160                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4161             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4162                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4163             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4164                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4165         16  CF-MORTG-BILLING-AREA.
  4166             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4167                                            PIC X.
  4168         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4169         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4170         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4171         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4172             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4173             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4174         16  FILLER                         PIC X.
  4175         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4176             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  77
* EL1278.cbl
  4177             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4178         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4179         16  FILLER                         PIC X(8).
  4180         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4181         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4182         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4183         16  CF-ACH-COMPANY-ID.
  4184             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4185                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4186                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4187                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4188             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4189         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4190             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4191         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4192             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4193             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4194         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4195         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4196         16  FILLER                         PIC X(536).
  4197
  4198****************************************************************
  4199*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4200****************************************************************
  4201
  4202     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4203         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4204             20  CF-FEMALE-HEIGHT.
  4205                 24  CF-FEMALE-FT           PIC 99.
  4206                 24  CF-FEMALE-IN           PIC 99.
  4207             20  CF-FEMALE-MIN-WT           PIC 999.
  4208             20  CF-FEMALE-MAX-WT           PIC 999.
  4209         16  FILLER                         PIC X(428).
  4210
  4211     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4212         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4213             20  CF-MALE-HEIGHT.
  4214                 24  CF-MALE-FT             PIC 99.
  4215                 24  CF-MALE-IN             PIC 99.
  4216             20  CF-MALE-MIN-WT             PIC 999.
  4217             20  CF-MALE-MAX-WT             PIC 999.
  4218         16  FILLER                         PIC X(428).
  4219******************************************************************
  4220*             AUTOMATIC ACTIVITY RECORD                          *
  4221******************************************************************
  4222     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4223         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4224             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4225             20  CF-SYS-LETTER-ID           PIC X(04).
  4226             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4227             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4228             20  CF-SYS-RESET-SW            PIC X(01).
  4229             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4230             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4231
  4232         16  FILLER                         PIC X(50).
  4233
  4234         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  78
* EL1278.cbl
  4235             20  CF-USER-ACTIVE-SW          PIC X(01).
  4236             20  CF-USER-LETTER-ID          PIC X(04).
  4237             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4238             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4239             20  CF-USER-RESET-SW           PIC X(01).
  4240             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4241             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4242             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4243
  4244         16  FILLER                         PIC X(246).
  4245*                            COPY ERCACCT.
  4246******************************************************************
  4247*                                                                *
  4248*                                                                *
  4249*                            ERCACCT                             *
  4250*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4251*                            VMOD=2.031                          *
  4252*                                                                *
  4253*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4254*                                                                *
  4255*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4256*   VSAM ACCOUNT MASTER FILES.                                   *
  4257*                                                                *
  4258*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4259*                                                                *
  4260*   FILE TYPE = VSAM,KSDS                                        *
  4261*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4262*                                                                *
  4263*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4264*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4265*                                                                *
  4266*   LOG = NO                                                     *
  4267*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4268*                                                                *
  4269*                                                                *
  4270******************************************************************
  4271*                   C H A N G E   L O G
  4272*
  4273* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4274*-----------------------------------------------------------------
  4275*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4276* EFFECTIVE    NUMBER
  4277*-----------------------------------------------------------------
  4278* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4279* 092705    2005050300006  PEMA  ADD SPP LEASES
  4280* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4281* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4282* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4283* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4284* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4285******************************************************************
  4286
  4287 01  ACCOUNT-MASTER.
  4288     12  AM-RECORD-ID                      PIC XX.
  4289         88  VALID-AM-ID                      VALUE 'AM'.
  4290
  4291     12  AM-CONTROL-PRIMARY.
  4292         16  AM-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  79
* EL1278.cbl
  4293         16  AM-MSTR-CNTRL.
  4294             20  AM-CONTROL-A.
  4295                 24  AM-CARRIER            PIC X.
  4296                 24  AM-GROUPING.
  4297                     28 AM-GROUPING-PREFIX PIC XXX.
  4298                     28 AM-GROUPING-PRIME  PIC XXX.
  4299                 24  AM-STATE              PIC XX.
  4300                 24  AM-ACCOUNT.
  4301                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4302                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4303             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4304                                           PIC X(19).
  4305             20  AM-CNTRL-B.
  4306                 24  AM-EXPIRATION-DT      PIC XX.
  4307                 24  FILLER                PIC X(4).
  4308             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4309                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4310
  4311     12  AM-CONTROL-BY-VAR-GRP.
  4312         16  AM-COMPANY-CD-A1              PIC X.
  4313         16  AM-VG-CARRIER                 PIC X.
  4314         16  AM-VG-GROUPING                PIC X(6).
  4315         16  AM-VG-STATE                   PIC XX.
  4316         16  AM-VG-ACCOUNT                 PIC X(10).
  4317         16  AM-VG-DATE.
  4318             20  AM-VG-EXPIRATION-DT       PIC XX.
  4319             20  FILLER                    PIC X(4).
  4320         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4321                                           PIC 9(11)      COMP-3.
  4322     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4323         16  FILLER                        PIC X(10).
  4324         16  AM-VG-KEY3.
  4325             20  AM-VG3-ACCOUNT            PIC X(10).
  4326             20  AM-VG3-EXP-DT             PIC XX.
  4327         16  FILLER                        PIC X(4).
  4328     12  AM-MAINT-INFORMATION.
  4329         16  AM-LAST-MAINT-DT              PIC XX.
  4330         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4331         16  AM-LAST-MAINT-USER            PIC X(4).
  4332         16  FILLER                        PIC XX.
  4333
  4334     12  AM-EFFECTIVE-DT                   PIC XX.
  4335     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4336
  4337     12  AM-PREV-DATES  COMP-3.
  4338         16  AM-PREV-EXP-DT                PIC 9(11).
  4339         16  AM-PREV-EFF-DT                PIC 9(11).
  4340
  4341     12  AM-REPORT-CODE-1                  PIC X(10).
  4342     12  AM-REPORT-CODE-2                  PIC X(10).
  4343
  4344     12  AM-CITY-CODE                      PIC X(4).
  4345     12  AM-COUNTY-PARISH                  PIC X(6).
  4346
  4347     12  AM-NAME                           PIC X(30).
  4348     12  AM-PERSON                         PIC X(30).
  4349     12  AM-ADDRS                          PIC X(30).
  4350     12  AM-CITY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  80
* EL1278.cbl
  4351         16  AM-ADDR-CITY                  PIC X(28).
  4352         16  AM-ADDR-STATE                 PIC XX.
  4353     12  AM-ZIP.
  4354         16  AM-ZIP-PRIME.
  4355             20  AM-ZIP-PRI-1ST            PIC X.
  4356                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4357             20  FILLER                    PIC X(4).
  4358         16  AM-ZIP-PLUS4                  PIC X(4).
  4359     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4360         16  AM-CAN-POSTAL-1               PIC XXX.
  4361         16  AM-CAN-POSTAL-2               PIC XXX.
  4362         16  FILLER                        PIC XXX.
  4363     12  AM-TEL-NO.
  4364         16  AM-AREA-CODE                  PIC 999.
  4365         16  AM-TEL-PRE                    PIC 999.
  4366         16  AM-TEL-NBR                    PIC 9(4).
  4367     12  AM-TEL-LOC                        PIC X.
  4368         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4369         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4370
  4371     12  AM-COMM-STRUCTURE.
  4372         16  AM-DEFN-1.
  4373             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4374                 24  AM-AGT.
  4375                     28  AM-AGT-PREFIX     PIC X(4).
  4376                     28  AM-AGT-PRIME      PIC X(6).
  4377                 24  AM-COM-TYP            PIC X.
  4378                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4379                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4380                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4381                 24  AM-RECALC-LV-INDIC    PIC X.
  4382                 24  AM-RETRO-LV-INDIC     PIC X.
  4383                 24  AM-GL-CODES           PIC X.
  4384                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4385                 24  FILLER                PIC X(01).
  4386         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4387             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4388                 24  FILLER                PIC X(11).
  4389                 24  AM-L-COMA             PIC XXX.
  4390                 24  AM-J-COMA             PIC XXX.
  4391                 24  AM-A-COMA             PIC XXX.
  4392                 24  FILLER                PIC X(6).
  4393
  4394     12  AM-COMM-CHANGE-STATUS             PIC X.
  4395         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4396
  4397     12  AM-CSR-CODE                       PIC X(4).
  4398
  4399     12  AM-BILLING-STATUS                 PIC X.
  4400         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4401         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4402     12  AM-AUTO-REFUND-SW                 PIC X.
  4403         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4404         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4405     12  AM-GPCD                           PIC 99.
  4406     12  AM-IG                             PIC X.
  4407         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4408         88  AM-HAS-GROUP                     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  81
* EL1278.cbl
  4409     12  AM-STATUS                         PIC X.
  4410         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4411         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4412         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4413         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4414         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4415         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4416     12  AM-REMIT-TO                       PIC 99.
  4417     12  AM-ID-NO                          PIC X(11).
  4418
  4419     12  AM-CAL-TABLE                      PIC XX.
  4420     12  AM-LF-DEVIATION                   PIC XXX.
  4421     12  AM-AH-DEVIATION                   PIC XXX.
  4422     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4423     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4424     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4425     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4426     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4427     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4428
  4429     12  AM-USER-FIELDS.
  4430         16  AM-FLD-1                      PIC XX.
  4431         16  AM-FLD-2                      PIC XX.
  4432         16  AM-FLD-3                      PIC XX.
  4433         16  AM-FLD-4                      PIC XX.
  4434         16  AM-FLD-5                      PIC XX.
  4435
  4436     12  AM-1ST-PROD-DATE.
  4437         16  AM-1ST-PROD-YR                PIC XX.
  4438         16  AM-1ST-PROD-MO                PIC XX.
  4439         16  AM-1ST-PROD-DA                PIC XX.
  4440     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4441     12  AM-CERTS-PURGED-DATE.
  4442         16  AM-PUR-YR                     PIC XX.
  4443         16  AM-PUR-MO                     PIC XX.
  4444         16  AM-PUR-DA                     PIC XX.
  4445     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4446     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4447     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4448     12  AM-INACTIVE-DATE.
  4449         16  AM-INA-MO                     PIC 99.
  4450         16  AM-INA-DA                     PIC 99.
  4451         16  AM-INA-YR                     PIC 99.
  4452     12  AM-AR-HI-CERT-DATE                PIC XX.
  4453
  4454     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4455     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4456
  4457     12  AM-OB-PAYMENT-MODE                PIC X.
  4458         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4459         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4460         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4461         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4462
  4463     12  AM-AH-ONLY-INDICATOR              PIC X.
  4464         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4465         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4466
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  82
* EL1278.cbl
  4467     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4468
  4469     12  AM-OVER-SHORT.
  4470         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4471         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4472
  4473     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4474     12  AM-DCC-CLP-STATE                  PIC XX.
  4475
  4476     12  AM-RECALC-COMM                    PIC X.
  4477     12  AM-RECALC-REIN                    PIC X.
  4478
  4479     12  AM-REI-TABLE                      PIC XXX.
  4480     12  AM-REI-ET-LF                      PIC X.
  4481     12  AM-REI-ET-AH                      PIC X.
  4482     12  AM-REI-PE-LF                      PIC X.
  4483     12  AM-REI-PE-AH                      PIC X.
  4484     12  AM-REI-PRT-ST                     PIC X.
  4485     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4486     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4487     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4488     12  AM-REI-GROUP-A                    PIC X(6).
  4489     12  AM-REI-MORT                       PIC X(4).
  4490     12  AM-REI-PRT-OW                     PIC X.
  4491     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4492     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4493     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4494     12  AM-REI-GROUP-B                    PIC X(6).
  4495
  4496     12  AM-TRUST-TYPE                     PIC X(2).
  4497
  4498     12  AM-EMPLOYER-STMT-USED             PIC X.
  4499     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4500
  4501     12  AM-STD-AH-TYPE                    PIC XX.
  4502     12  AM-EARN-METHODS.
  4503         16  AM-EARN-METHOD-R              PIC X.
  4504             88 AM-REF-RL-R78                 VALUE 'R'.
  4505             88 AM-REF-RL-PR                  VALUE 'P'.
  4506             88 AM-REF-RL-MEAN                VALUE 'M'.
  4507             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4508         16  AM-EARN-METHOD-L              PIC X.
  4509             88 AM-REF-LL-R78                 VALUE 'R'.
  4510             88 AM-REF-LL-PR                  VALUE 'P'.
  4511             88 AM-REF-LL-MEAN                VALUE 'M'.
  4512             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4513         16  AM-EARN-METHOD-A              PIC X.
  4514             88 AM-REF-AH-R78                 VALUE 'R'.
  4515             88 AM-REF-AH-PR                  VALUE 'P'.
  4516             88 AM-REF-AH-MEAN                VALUE 'M'.
  4517             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4518             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4519             88 AM-REF-AH-NET                 VALUE 'N'.
  4520
  4521     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4522     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4523     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4524
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  83
* EL1278.cbl
  4525     12  AM-RET-Y-N                        PIC X.
  4526     12  AM-RET-P-E                        PIC X.
  4527     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4528     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4529     12  AM-RET-GRP                        PIC X(6).
  4530     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4531         16  AM-POOL-PRIME                 PIC XXX.
  4532         16  AM-POOL-SUB                   PIC XXX.
  4533     12  AM-RETRO-EARNINGS.
  4534         16  AM-RET-EARN-R                 PIC X.
  4535         16  AM-RET-EARN-L                 PIC X.
  4536         16  AM-RET-EARN-A                 PIC X.
  4537     12  AM-RET-ST-TAX-USE                 PIC X.
  4538         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4539         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4540     12  AM-RETRO-BEG-EARNINGS.
  4541         16  AM-RET-BEG-EARN-R             PIC X.
  4542         16  AM-RET-BEG-EARN-L             PIC X.
  4543         16  AM-RET-BEG-EARN-A             PIC X.
  4544     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4545     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4546
  4547     12  AM-USER-SELECT-OPTIONS.
  4548         16  AM-USER-SELECT-1              PIC X(10).
  4549         16  AM-USER-SELECT-2              PIC X(10).
  4550         16  AM-USER-SELECT-3              PIC X(10).
  4551         16  AM-USER-SELECT-4              PIC X(10).
  4552         16  AM-USER-SELECT-5              PIC X(10).
  4553
  4554     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4555
  4556     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4557
  4558     12  AM-RPT045A-SWITCH                 PIC X.
  4559         88  RPT045A-OFF                   VALUE 'N'.
  4560
  4561     12  AM-INSURANCE-LIMITS.
  4562         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4563         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4564
  4565     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4566         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4567
  4568     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4569         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4570         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4571
  4572     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4573
  4574     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4575     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4576     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4577     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4578     12  AM-DCC-UEF-STATE                  PIC XX.
  4579     12  FILLER                            PIC XXX.
  4580     12  AM-REPORT-CODE-3                  PIC X(10).
  4581*    12  FILLER                            PIC X(22).
  4582
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  84
* EL1278.cbl
  4583     12  AM-RESERVE-DATE.
  4584         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4585         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4586         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4587
  4588     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4589     12  AM-NOTIFICATION-TYPES.
  4590         16  AM-NOTIF-OF-LETTERS           PIC X.
  4591         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4592         16  AM-NOTIF-OF-REPORTS           PIC X.
  4593         16  AM-NOTIF-OF-STATUS            PIC X.
  4594
  4595     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4596         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4597         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4598         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4599         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4600
  4601     12  AM-BENEFIT-CONTROLS.
  4602         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4603             20  AM-BENEFIT-CODE           PIC XX.
  4604             20  AM-BENEFIT-TYPE           PIC X.
  4605             20  AM-BENEFIT-REVISION       PIC XXX.
  4606             20  AM-BENEFIT-REM-TERM       PIC X.
  4607             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4608             20  FILLER                    PIC XX.
  4609         16  FILLER                        PIC X(80).
  4610
  4611     12  AM-TRANSFER-DATA.
  4612         16  AM-TRANSFERRED-FROM.
  4613             20  AM-TRNFROM-CARRIER        PIC X.
  4614             20  AM-TRNFROM-GROUPING.
  4615                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4616                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4617             20  AM-TRNFROM-STATE          PIC XX.
  4618             20  AM-TRNFROM-ACCOUNT.
  4619                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4620                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4621             20  AM-TRNFROM-DTE            PIC XX.
  4622         16  AM-TRANSFERRED-TO.
  4623             20  AM-TRNTO-CARRIER          PIC X.
  4624             20  AM-TRNTO-GROUPING.
  4625                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4626                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4627             20  AM-TRNTO-STATE            PIC XX.
  4628             20  AM-TRNTO-ACCOUNT.
  4629                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4630                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4631             20  AM-TRNTO-DTE              PIC XX.
  4632         16  FILLER                        PIC X(10).
  4633
  4634     12  AM-SAVED-REMIT-TO                 PIC 99.
  4635
  4636     12  AM-COMM-STRUCTURE-SAVED.
  4637         16  AM-DEFN-1-SAVED.
  4638             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4639                 24  AM-AGT-SV             PIC X(10).
  4640                 24  AM-COM-TYP-SV         PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  85
* EL1278.cbl
  4641                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4642                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4643                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4644                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4645                 24  FILLER                PIC X.
  4646                 24  AM-GL-CODES-SV        PIC X.
  4647                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4648                 24  FILLER                PIC X.
  4649         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4650             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4651                 24  FILLER                PIC X(11).
  4652                 24  AM-L-COMA-SV          PIC XXX.
  4653                 24  AM-J-COMA-SV          PIC XXX.
  4654                 24  AM-A-COMA-SV          PIC XXX.
  4655                 24  FILLER                PIC X(6).
  4656
  4657     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4658         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4659            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4660            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4661            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4662
  4663     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4664     12  FILLER                            PIC X(120).
  4665
  4666     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4667         16  AM-CONTROL-NAME               PIC X(30).
  4668         16  AM-EXECUTIVE-ONE.
  4669             20  AM-EXEC1-NAME             PIC X(15).
  4670             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4671                                                          COMP-3.
  4672             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4673                                                          COMP-3.
  4674         16  AM-EXECUTIVE-TWO.
  4675             20  AM-EXEC2-NAME             PIC X(15).
  4676             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4677                                                          COMP-3.
  4678             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4679                                                          COMP-3.
  4680
  4681     12  AM-RETRO-ADDITIONAL-DATA.
  4682         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4683         16  AM-RETRO-PREM-P-E             PIC X.
  4684         16  AM-RETRO-CLMS-P-I             PIC X.
  4685         16  AM-RETRO-RET-BRACKET-LF.
  4686             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4687                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4688                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4689             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4690                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4691                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4692             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4693                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4694                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4695         16  AM-RETRO-RET-BRACKET-AH.
  4696             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4697                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4698                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  86
* EL1278.cbl
  4699                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4700             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4701                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4702                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4703             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4704                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4705                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4706
  4707     12  AM-COMMENTS.
  4708         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4709
  4710     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4711         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4712         16  AM-FLI-BILLING-CODE           PIC X.
  4713         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4714         16  AM-FLI-UNITED-IDENT           PIC X.
  4715         16  AM-FLI-INTEREST-LOST-DATA.
  4716             20  AM-FLI-BANK-NO            PIC X(5).
  4717             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4718             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4719             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4720         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4721             20  AM-FLI-AGT                PIC X(9).
  4722             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4723             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4724         16  FILLER                        PIC X(102).
  4725
  4726     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4727         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4728             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4729             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4730             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4731             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4732             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4733         16  FILLER                          PIC X(10).
  4734******************************************************************
  4735*                            COPY ELCCERT.
  4736******************************************************************
  4737*                                                                *
  4738*                            ELCCERT.                            *
  4739*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4740*                            VMOD=2.013                          *
  4741*                                                                *
  4742*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4743*                                                                *
  4744*   FILE TYPE = VSAM,KSDS                                        *
  4745*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4746*                                                                *
  4747*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4748*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4749*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4750*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4751*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4752*                                                                *
  4753*   LOG = YES                                                    *
  4754*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4755******************************************************************
  4756*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  87
* EL1278.cbl
  4757*
  4758* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4759*-----------------------------------------------------------------
  4760*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4761* EFFECTIVE    NUMBER
  4762*-----------------------------------------------------------------
  4763* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4764* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4765* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4766* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4767* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4768* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4769* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4770* 032612  CR2011110200001  PEMA  AHL CHANGES
  4771******************************************************************
  4772
  4773 01  CERTIFICATE-MASTER.
  4774     12  CM-RECORD-ID                      PIC XX.
  4775         88  VALID-CM-ID                      VALUE 'CM'.
  4776
  4777     12  CM-CONTROL-PRIMARY.
  4778         16  CM-COMPANY-CD                 PIC X.
  4779         16  CM-CARRIER                    PIC X.
  4780         16  CM-GROUPING.
  4781             20  CM-GROUPING-PREFIX        PIC X(3).
  4782             20  CM-GROUPING-PRIME         PIC X(3).
  4783         16  CM-STATE                      PIC XX.
  4784         16  CM-ACCOUNT.
  4785             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4786             20  CM-ACCOUNT-PRIME          PIC X(6).
  4787         16  CM-CERT-EFF-DT                PIC XX.
  4788         16  CM-CERT-NO.
  4789             20  CM-CERT-PRIME             PIC X(10).
  4790             20  CM-CERT-SFX               PIC X.
  4791
  4792     12  CM-CONTROL-BY-NAME.
  4793         16  CM-COMPANY-CD-A1              PIC X.
  4794         16  CM-INSURED-LAST-NAME          PIC X(15).
  4795         16  CM-INSURED-INITIALS.
  4796             20  CM-INSURED-INITIAL1       PIC X.
  4797             20  CM-INSURED-INITIAL2       PIC X.
  4798
  4799     12  CM-CONTROL-BY-SSN.
  4800         16  CM-COMPANY-CD-A2              PIC X.
  4801         16  CM-SOC-SEC-NO.
  4802             20  CM-SSN-STATE              PIC XX.
  4803             20  CM-SSN-ACCOUNT            PIC X(6).
  4804             20  CM-SSN-LN3.
  4805                 25  CM-INSURED-INITIALS-A2.
  4806                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4807                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4808                 25 CM-PART-LAST-NAME-A2         PIC X.
  4809
  4810     12  CM-CONTROL-BY-CERT-NO.
  4811         16  CM-COMPANY-CD-A4              PIC X.
  4812         16  CM-CERT-NO-A4                 PIC X(11).
  4813
  4814     12  CM-CONTROL-BY-MEMB.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  88
* EL1278.cbl
  4815         16  CM-COMPANY-CD-A5              PIC X.
  4816         16  CM-MEMBER-NO.
  4817             20  CM-MEMB-STATE             PIC XX.
  4818             20  CM-MEMB-ACCOUNT           PIC X(6).
  4819             20  CM-MEMB-LN4.
  4820                 25  CM-INSURED-INITIALS-A5.
  4821                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4822                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4823                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4824
  4825     12  CM-INSURED-PROFILE-DATA.
  4826         16  CM-INSURED-FIRST-NAME.
  4827             20  CM-INSURED-1ST-INIT       PIC X.
  4828             20  FILLER                    PIC X(9).
  4829         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4830         16  CM-INSURED-SEX                PIC X.
  4831             88  CM-SEX-MALE                  VALUE 'M'.
  4832             88  CM-SEX-FEMAL                 VALUE 'F'.
  4833         16  CM-INSURED-JOINT-AGE          PIC 99.
  4834         16  CM-JOINT-INSURED-NAME.
  4835             20  CM-JT-LAST-NAME           PIC X(15).
  4836             20  CM-JT-FIRST-NAME.
  4837                 24  CM-JT-1ST-INIT        PIC X.
  4838                 24  FILLER                PIC X(9).
  4839             20  CM-JT-INITIAL             PIC X.
  4840
  4841     12  CM-LIFE-DATA.
  4842         16  CM-LF-BENEFIT-CD              PIC XX.
  4843         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4844         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4845         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4846         16  CM-LF-DEV-CODE                PIC XXX.
  4847         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4848         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4849         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4850         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4851         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4852         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4853         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4854         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4855         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4856         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4857         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4858         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4859         16  FILLER                        PIC XX.
  4860
  4861     12  CM-AH-DATA.
  4862         16  CM-AH-BENEFIT-CD              PIC XX.
  4863         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4864         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4865         16  CM-AH-DEV-CODE                PIC XXX.
  4866         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4867         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4868         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4869         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4870         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4871         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4872         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  89
* EL1278.cbl
  4873         16  CM-AH-PAID-THRU-DT            PIC XX.
  4874             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4875         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4876         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4877         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4878         16  FILLER                        PIC X.
  4879
  4880     12  CM-LOAN-INFORMATION.
  4881         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4882         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4883                                           PIC S9(5)V99  COMP-3.
  4884         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4885         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4886         16  CM-PAY-FREQUENCY              PIC S99.
  4887         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4888         16  CM-RATE-CLASS                 PIC XX.
  4889         16  CM-BENEFICIARY                PIC X(25).
  4890         16  CM-POLICY-FORM-NO             PIC X(12).
  4891         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4892         16  CM-LAST-ADD-ON-DT             PIC XX.
  4893         16  CM-DEDUCTIBLE-AMOUNTS.
  4894             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4895             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4896         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4897             20  CM-RESIDENT-STATE         PIC XX.
  4898             20  CM-RATE-CODE              PIC X(4).
  4899             20  FILLER                    PIC XX.
  4900         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4901             20  CM-LOAN-OFFICER           PIC X(5).
  4902             20  FILLER                    PIC XXX.
  4903         16  CM-CSR-CODE                   PIC XXX.
  4904         16  CM-UNDERWRITING-CODE          PIC X.
  4905             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4906         16  CM-POST-CARD-IND              PIC X.
  4907         16  CM-NH-INTERFACE-SW            PIC X.
  4908         16  CM-PREMIUM-TYPE               PIC X.
  4909             88  CM-SING-PRM                  VALUE '1'.
  4910             88  CM-O-B-COVERAGE              VALUE '2'.
  4911             88  CM-OPEN-END                  VALUE '3'.
  4912         16  CM-IND-GRP-TYPE               PIC X.
  4913             88  CM-INDIVIDUAL                VALUE 'I'.
  4914             88  CM-GROUP                     VALUE 'G'.
  4915         16  CM-SKIP-CODE                  PIC X.
  4916             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4917             88  SKIP-JULY                    VALUE '1'.
  4918             88  SKIP-AUGUST                  VALUE '2'.
  4919             88  SKIP-SEPTEMBER               VALUE '3'.
  4920             88  SKIP-JULY-AUG                VALUE '4'.
  4921             88  SKIP-AUG-SEPT                VALUE '5'.
  4922             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4923             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4924             88  SKIP-JUNE                    VALUE '8'.
  4925             88  SKIP-JUNE-JULY               VALUE '9'.
  4926             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4927             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4928         16  CM-PAYMENT-MODE               PIC X.
  4929             88  PAY-MONTHLY                  VALUE SPACE.
  4930             88  PAY-WEEKLY                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  90
* EL1278.cbl
  4931             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4932             88  PAY-BI-WEEKLY                VALUE '3'.
  4933             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4934         16  CM-LOAN-NUMBER                PIC X(8).
  4935         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4936         16  CM-OLD-LOF                    PIC XXX.
  4937*        16  CM-LOAN-OFFICER               PIC XXX.
  4938         16  CM-REIN-TABLE                 PIC XXX.
  4939         16  CM-SPECIAL-REIN-CODE          PIC X.
  4940         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4941         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4942         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4943
  4944     12  CM-STATUS-DATA.
  4945         16  CM-ENTRY-STATUS               PIC X.
  4946         16  CM-ENTRY-DT                   PIC XX.
  4947
  4948         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4949         16  CM-LF-CANCEL-DT               PIC XX.
  4950         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4951
  4952         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4953         16  CM-LF-DEATH-DT                PIC XX.
  4954         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4955
  4956         16  CM-LF-CURRENT-STATUS          PIC X.
  4957             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4958                                                'M' '4' '5' '9'.
  4959             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4960             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4961             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4962             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4963             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4964             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4965             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4966             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4967             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4968             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4969             88  CM-LF-DECLINED               VALUE 'D'.
  4970             88  CM-LF-VOIDED                 VALUE 'V'.
  4971
  4972         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4973         16  CM-AH-CANCEL-DT               PIC XX.
  4974         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4975
  4976         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4977         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4978         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4979
  4980         16  CM-AH-CURRENT-STATUS          PIC X.
  4981             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4982                                                'M' '4' '5' '9'.
  4983             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4984             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4985             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4986             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4987             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4988             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  91
* EL1278.cbl
  4989             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4990             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4991             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4992             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4993             88  CM-AH-DECLINED               VALUE 'D'.
  4994             88  CM-AH-VOIDED                 VALUE 'V'.
  4995
  4996         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4997             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4998             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4999             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5000         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5001
  5002         16  CM-ENTRY-BATCH                PIC X(6).
  5003         16  CM-LF-EXIT-BATCH              PIC X(6).
  5004         16  CM-AH-EXIT-BATCH              PIC X(6).
  5005         16  CM-LAST-MONTH-END             PIC XX.
  5006
  5007     12  CM-NOTE-SW                        PIC X.
  5008         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5009         88  CERT-NOTES-PRESENT               VALUE '1'.
  5010         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5011         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5012         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5013         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5014         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5015         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5016     12  CM-COMP-EXCP-SW                   PIC X.
  5017         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5018         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5019     12  CM-INSURED-ADDRESS-SW             PIC X.
  5020         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5021         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5022
  5023*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5024     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5025     12  FILLER                            PIC X.
  5026
  5027*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5028     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5029     12  FILLER                            PIC X.
  5030*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5031     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5032
  5033     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5034         88  CERT-ADDED-BATCH                 VALUE ' '.
  5035         88  CERT-ADDED-ONLINE                VALUE '1'.
  5036         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5037         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5038         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5039     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5040         88  CERT-AS-LOADED                   VALUE ' '.
  5041         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5042         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5043         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5044         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5045         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5046         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  92
* EL1278.cbl
  5047         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5048
  5049     12  CM-ACCOUNT-COMM-PCTS.
  5050         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5051         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5052
  5053     12  CM-USER-FIELD                     PIC X.
  5054     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5055     12  CM-CLP-STATE                      PIC XX.
  5056     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5057     12  CM-USER-RESERVED                  PIC XXX.
  5058     12  FILLER REDEFINES CM-USER-RESERVED.
  5059         16  CM-AH-CLASS-CD                PIC XX.
  5060         16  F                             PIC X.
  5061******************************************************************
  5062*                            COPY ERCMAIL.
  5063******************************************************************
  5064*                                                                *
  5065*                                                                *
  5066*                            ERCMAIL                             *
  5067*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5068*                            VMOD=2.003                          *
  5069*                                                                *
  5070*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5071*                                                                *
  5072*   FILE TYPE = VSAM,KSDS                                        *
  5073*   RECORD SIZE = 374   RECFORM = FIX                            *
  5074*                                                                *
  5075*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5076*   ALTERNATE PATH    = NOT USED                                 *
  5077*                                                                *
  5078*   LOG = YES                                                    *
  5079*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5080******************************************************************
  5081*                   C H A N G E   L O G
  5082*
  5083* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5084*-----------------------------------------------------------------
  5085*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5086* EFFECTIVE    NUMBER
  5087*-----------------------------------------------------------------
  5088* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5089* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5090* 111108                   PEMA  ADD CRED BENE ADDR2
  5091******************************************************************
  5092
  5093 01  MAILING-DATA.
  5094     12  MA-RECORD-ID                      PIC XX.
  5095         88  VALID-MA-ID                       VALUE 'MA'.
  5096
  5097     12  MA-CONTROL-PRIMARY.
  5098         16  MA-COMPANY-CD                 PIC X.
  5099         16  MA-CARRIER                    PIC X.
  5100         16  MA-GROUPING.
  5101             20  MA-GROUPING-PREFIX        PIC XXX.
  5102             20  MA-GROUPING-PRIME         PIC XXX.
  5103         16  MA-STATE                      PIC XX.
  5104         16  MA-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  93
* EL1278.cbl
  5105             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5106             20  MA-ACCOUNT-PRIME          PIC X(6).
  5107         16  MA-CERT-EFF-DT                PIC XX.
  5108         16  MA-CERT-NO.
  5109             20  MA-CERT-PRIME             PIC X(10).
  5110             20  MA-CERT-SFX               PIC X.
  5111
  5112     12  FILLER                            PIC XX.
  5113
  5114     12  MA-ACCESS-CONTROL.
  5115         16  MA-SOURCE-SYSTEM              PIC XX.
  5116             88  MA-FROM-CREDIT                VALUE 'CR'.
  5117             88  MA-FROM-VSI                   VALUE 'VS'.
  5118             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5119             88  MA-FROM-OTHER                 VALUE 'OT'.
  5120         16  MA-RECORD-ADD-DT              PIC XX.
  5121         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5122         16  MA-LAST-MAINT-DT              PIC XX.
  5123         16  MA-LAST-MAINT-BY              PIC XXXX.
  5124         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5125
  5126     12  MA-PROFILE-INFO.
  5127         16  MA-QUALIFY-CODE-1             PIC XX.
  5128         16  MA-QUALIFY-CODE-2             PIC XX.
  5129         16  MA-QUALIFY-CODE-3             PIC XX.
  5130         16  MA-QUALIFY-CODE-4             PIC XX.
  5131         16  MA-QUALIFY-CODE-5             PIC XX.
  5132
  5133         16  MA-INSURED-LAST-NAME          PIC X(15).
  5134         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5135         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5136         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5137         16  MA-INSURED-BIRTH-DT           PIC XX.
  5138         16  MA-INSURED-SEX                PIC X.
  5139             88  MA-SEX-MALE                   VALUE 'M'.
  5140             88  MA-SEX-FEMALE                 VALUE 'F'.
  5141         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5142
  5143         16  MA-ADDRESS-CORRECTED          PIC X.
  5144         16  MA-JOINT-BIRTH-DT             PIC XX.
  5145*        16  FILLER                        PIC X(12).
  5146
  5147         16  MA-ADDRESS-LINE-1             PIC X(30).
  5148         16  MA-ADDRESS-LINE-2             PIC X(30).
  5149         16  MA-CITY-STATE.
  5150             20  MA-CITY                   PIC X(28).
  5151             20  MA-ADDR-STATE             PIC XX.
  5152         16  MA-ZIP.
  5153             20  MA-ZIP-CODE.
  5154                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5155                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5156                 24  FILLER                PIC X(4).
  5157             20  MA-ZIP-PLUS4              PIC X(4).
  5158         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5159             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5160             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5161             20  FILLER                    PIC X(3).
  5162
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  94
* EL1278.cbl
  5163         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5164
  5165         16  FILLER                        PIC XXX.
  5166*        16  FILLER                        PIC X(10).
  5167
  5168     12  MA-CRED-BENE-INFO.
  5169         16  MA-CRED-BENE-NAME                 PIC X(25).
  5170         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5171         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5172         16  MA-CRED-BENE-CTYST.
  5173             20  MA-CRED-BENE-CITY             PIC X(28).
  5174             20  MA-CRED-BENE-STATE            PIC XX.
  5175         16  MA-CRED-BENE-ZIP.
  5176             20  MA-CB-ZIP-CODE.
  5177                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5178                     88  MA-CB-CANADIAN-POST-CODE
  5179                                           VALUE 'A' THRU 'Z'.
  5180                 24  FILLER                    PIC X(4).
  5181             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5182         16  MA-CB-CANADIAN-POSTAL-CODE
  5183                            REDEFINES MA-CRED-BENE-ZIP.
  5184             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5185             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5186             20  FILLER                        PIC X(3).
  5187     12  MA-POST-CARD-MAIL-DATA.
  5188         16  MA-MAIL-DATA OCCURS 7.
  5189             20  MA-MAIL-TYPE              PIC X.
  5190                 88  MA-12MO-MAILING           VALUE '1'.
  5191                 88  MA-EXP-MAILING            VALUE '2'.
  5192             20  MA-MAIL-STATUS            PIC X.
  5193                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5194                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5195                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5196             20  MA-MAIL-DATE              PIC XX.
  5197     12  FILLER                            PIC XX.
  5198     12  FILLER                            PIC XX.
  5199*    12  FILLER                            PIC X(30).
  5200******************************************************************
  5201*                            COPY ELCCRTO.
  5202******************************************************************
  5203*                                                                *
  5204*                            ELCCRTO.                            *
  5205*                                                                *
  5206*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  5207*                                                                *
  5208*   FILE TYPE = VSAM,KSDS                                        *
  5209*   RECORD SIZE = 524  RECFORM = FIXED                           *
  5210*                                                                *
  5211*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  5212*                                                                *
  5213*   LOG = YES                                                    *
  5214*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5215******************************************************************
  5216*                   C H A N G E   L O G
  5217*
  5218* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5219*-----------------------------------------------------------------
  5220*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  95
* EL1278.cbl
  5221* EFFECTIVE    NUMBER
  5222*-----------------------------------------------------------------
  5223* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  5224* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  5225* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  5226* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5227* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  5228******************************************************************
  5229 01  ORIGINAL-CERTIFICATE.
  5230     12  OC-RECORD-ID                      PIC XX.
  5231         88  VALID-OC-ID                      VALUE 'OC'.
  5232     12  OC-CONTROL-PRIMARY.
  5233         16  OC-COMPANY-CD                 PIC X.
  5234         16  OC-CARRIER                    PIC X.
  5235         16  OC-GROUPING                   PIC X(6).
  5236         16  OC-STATE                      PIC XX.
  5237         16  OC-ACCOUNT                    PIC X(10).
  5238         16  OC-CERT-EFF-DT                PIC XX.
  5239         16  OC-CERT-NO.
  5240             20  OC-CERT-PRIME             PIC X(10).
  5241             20  OC-CERT-SFX               PIC X.
  5242         16  OC-RECORD-TYPE                PIC X.
  5243         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  5244     12  OC-LAST-MAINT-DT                  PIC XX.
  5245     12  OC-LAST-MAINT-BY                  PIC X(4).
  5246     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  5247     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  5248     12  FILLER                            PIC X(49).
  5249     12  OC-ORIG-REC.
  5250         16  OC-INS-LAST-NAME              PIC X(15).
  5251         16  OC-INS-FIRST-NAME             PIC X(10).
  5252         16  OC-INS-MIDDLE-INIT            PIC X.
  5253         16  OC-INS-AGE                    PIC S999     COMP-3.
  5254         16  OC-JNT-LAST-NAME              PIC X(15).
  5255         16  OC-JNT-FIRST-NAME             PIC X(10).
  5256         16  OC-JNT-MIDDLE-INIT            PIC X.
  5257         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5258         16  OC-LF-BENCD                   PIC XX.
  5259         16  OC-LF-TERM                    PIC S999      COMP-3.
  5260         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5261         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5262         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5263         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5264         16  OC-LF-EXP-DT                  PIC XX.
  5265         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5266         16  OC-LF-CANCEL-DT               PIC XX.
  5267         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5268         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5269         16  OC-AH-BENCD                   PIC XX.
  5270         16  OC-AH-TERM                    PIC S999      COMP-3.
  5271         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5272         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5273         16  OC-AH-EXP-DT                  PIC XX.
  5274         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5275         16  OC-AH-CP                      PIC 99.
  5276         16  OC-AH-CANCEL-DT               PIC XX.
  5277         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5278         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  96
* EL1278.cbl
  5279         16  OC-CRED-BENE-NAME             PIC X(25).
  5280         16  OC-1ST-PMT-DT                 PIC XX.
  5281         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  5282         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  5283         16  OC-ISSUE-TRAN-IND             PIC X.
  5284         16  OC-CANCEL-TRAN-IND            PIC X.
  5285         16  FILLER                        PIC X(211).
  5286
  5287     12  FILLER                            PIC X(50).
  5288******************************************************************
  5289*                            COPY ERCFORM.
  5290******************************************************************
  5291*                                                                *
  5292*                                                                *
  5293*                            ERCFORM.                            *
  5294*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5295*                            VMOD=2.003                          *
  5296*                                                                *
  5297*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  5298*                                                                *
  5299*    FILE TYPE = VSAM,KSDS                                       *
  5300*    RECORD SIZE = 500  RECFORM = FIXED                          *
  5301*                                                                *
  5302*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  5303*                                                                *
  5304*    LOG = YES                                                   *
  5305*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5306******************************************************************
  5307 01  FORM-MASTER.
  5308    12  FO-RECORD-ID                 PIC X(02).
  5309        88  VALID-FO-ID                  VALUE 'FO'.
  5310
  5311    12  FO-CONTROL-PRIMARY.
  5312        16  FO-COMPANY-CD            PIC X(01).
  5313        16  FO-STATE                 PIC X(02).
  5314        16  FO-FORM-ID               PIC X(12).
  5315        16  FO-FORM-EXP-DT           PIC X(02).
  5316
  5317    12  FO-POLICY-FORM-DATA.
  5318        16  FO-IND-GRP-CD            PIC X(01).
  5319        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  5320        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5321        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5322        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  5323        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  5324        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  5325        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  5326        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  5327        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  5328        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  5329        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5330        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5331        16  FO-DIS-DEF-TYPE          PIC 9(02).
  5332        16  FO-DISMEMBERMENT-CD      PIC X(01).
  5333        16  FO-APP-CERT-USE-CD       PIC X(01).
  5334
  5335    12  FILLER                       PIC X(29).
  5336
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  97
* EL1278.cbl
  5337    12  FO-FORM-PLAN-TABLE.
  5338        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  5339            20  FO-PLAN-TYPE         PIC X(01).
  5340            20  FO-PLAN-ID           PIC X(02).
  5341            20  FO-PLAN-TERM         PIC 9(03).
  5342            20  FO-PLAN-REFUND-METHOD
  5343                                     PIC X.
  5344
  5345    12  FILLER                       PIC X(30).
  5346
  5347    12  FO-COMMENTS-AREA.
  5348        16  FO-COMMENT-LINE-1        PIC X(78).
  5349
  5350    12  FILLER                       PIC X(20).
  5351
  5352    12  FO-MAINT-INFORMATION.
  5353        16  FO-LAST-MAINT-DT         PIC X(02).
  5354        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5355        16  FO-LAST-MAINT-BY         PIC X(04).
  5356*                            COPY ELCMSTR.
  5357******************************************************************
  5358*                                                                *
  5359*                            ELCMSTR.                            *
  5360*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5361*                            VMOD=2.012                          *
  5362*                                                                *
  5363*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  5364*                                                                *
  5365*   FILE TYPE = VSAM,KSDS                                        *
  5366*   RECORD SIZE = 350  RECFORM = FIXED                           *
  5367*                                                                *
  5368*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  5369*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  5370*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  5371*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  5372*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  5373*                                                 RKP=75,LEN=21  *
  5374*                                                                *
  5375*   **** NOTE ****                                               *
  5376*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  5377*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  5378*                                                                *
  5379*   LOG = YES                                                    *
  5380*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5381******************************************************************
  5382*                   C H A N G E   L O G
  5383*
  5384* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5385*-----------------------------------------------------------------
  5386*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5387* EFFECTIVE    NUMBER
  5388*-----------------------------------------------------------------
  5389* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5390* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  5391******************************************************************
  5392 01  CLAIM-MASTER.
  5393     12  CL-RECORD-ID                PIC XX.
  5394         88  VALID-CL-ID         VALUE 'CL'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  98
* EL1278.cbl
  5395
  5396     12  CL-CONTROL-PRIMARY.
  5397         16  CL-COMPANY-CD           PIC X.
  5398         16  CL-CARRIER              PIC X.
  5399         16  CL-CLAIM-NO             PIC X(7).
  5400         16  CL-CERT-NO.
  5401             20  CL-CERT-PRIME       PIC X(10).
  5402             20  CL-CERT-SFX         PIC X.
  5403
  5404     12  CL-CONTROL-BY-NAME.
  5405         16  CL-COMPANY-CD-A1        PIC X.
  5406         16  CL-INSURED-LAST-NAME    PIC X(15).
  5407         16  CL-INSURED-NAME.
  5408             20  CL-INSURED-1ST-NAME PIC X(12).
  5409             20  CL-INSURED-MID-INIT PIC X.
  5410
  5411     12  CL-CONTROL-BY-SSN.
  5412         16  CL-COMPANY-CD-A2        PIC X.
  5413         16  CL-SOC-SEC-NO.
  5414             20  CL-SSN-STATE        PIC XX.
  5415             20  CL-SSN-ACCOUNT      PIC X(6).
  5416             20  CL-SSN-LN3          PIC X(3).
  5417
  5418     12  CL-CONTROL-BY-CERT-NO.
  5419         16  CL-COMPANY-CD-A4        PIC X.
  5420         16  CL-CERT-NO-A4.
  5421             20  CL-CERT-A4-PRIME    PIC X(10).
  5422             20  CL-CERT-A4-SFX      PIC X.
  5423
  5424     12  CL-CONTROL-BY-CCN.
  5425         16  CL-COMPANY-CD-A5        PIC X.
  5426         16  CL-CCN-A5.
  5427             20  CL-CCN.
  5428                 24  CL-CCN-PREFIX-A5 PIC X(4).
  5429                 24  CL-CCN-PRIME-A5 PIC X(12).
  5430             20  CL-CCN-FILLER-A5    PIC X(4).
  5431
  5432     12  CL-INSURED-PROFILE-DATA.
  5433         16  CL-INSURED-BIRTH-DT     PIC XX.
  5434         16  CL-INSURED-SEX-CD       PIC X.
  5435             88  INSURED-IS-MALE        VALUE 'M'.
  5436             88  INSURED-IS-FEMALE      VALUE 'F'.
  5437             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  5438         16  CL-INSURED-OCC-CD       PIC X(6).
  5439         16  FILLER                  PIC X(5).
  5440
  5441     12  CL-PROCESSING-INFO.
  5442         16  CL-PROCESSOR-ID         PIC X(4).
  5443         16  CL-CLAIM-STATUS         PIC X.
  5444             88  CLAIM-IS-OPEN          VALUE 'O'.
  5445             88  CLAIM-IS-CLOSED        VALUE 'C'.
  5446         16  CL-CLAIM-TYPE           PIC X.
  5447*            88  AH-CLAIM               VALUE 'A'.
  5448*            88  LIFE-CLAIM             VALUE 'L'.
  5449*            88  PROPERTY-CLAIM         VALUE 'P'.
  5450*            88  IUI-CLAIM              VALUE 'I'.
  5451*            88  GAP-CLAIM              VALUE 'G'.
  5452         16  CL-CLAIM-PREM-TYPE      PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  99
* EL1278.cbl
  5453             88  SINGLE-PREMIUM         VALUE '1'.
  5454             88  O-B-COVERAGE           VALUE '2'.
  5455             88  OPEN-END-COVERAGE      VALUE '3'.
  5456         16  CL-INCURRED-DT          PIC XX.
  5457         16  CL-REPORTED-DT          PIC XX.
  5458         16  CL-FILE-ESTABLISH-DT    PIC XX.
  5459         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  5460         16  CL-LAST-PMT-DT          PIC XX.
  5461         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  5462         16  CL-PAID-THRU-DT         PIC XX.
  5463         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  5464         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  5465         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  5466         16  CL-PMT-CALC-METHOD      PIC X.
  5467             88  CL-360-DAY-YR          VALUE '1'.
  5468             88  CL-365-DAY-YR          VALUE '2'.
  5469             88  CL-FULL-MONTHS         VALUE '3'.
  5470         16  CL-CAUSE-CD             PIC X(6).
  5471
  5472         16  CL-PRIME-CERT-NO.
  5473             20  CL-PRIME-CERT-PRIME PIC X(10).
  5474             20  CL-PRIME-CERT-SFX   PIC X.
  5475
  5476         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  5477             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  5478             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  5479
  5480         16  CL-MICROFILM-NO         PIC X(10).
  5481         16  CL-PROG-FORM-TYPE       PIC X.
  5482         16  CL-LAST-ADD-ON-DT       PIC XX.
  5483
  5484         16  CL-LAST-REOPEN-DT       PIC XX.
  5485         16  CL-LAST-CLOSE-DT        PIC XX.
  5486         16  CL-LAST-CLOSE-REASON    PIC X(01).
  5487             88  FINAL-PAID             VALUE '1'.
  5488             88  CLAIM-DENIED           VALUE '2'.
  5489             88  AUTO-CLOSE             VALUE '3'.
  5490             88  MANUAL-CLOSE           VALUE '4'.
  5491             88  BENEFITS-CHANGED       VALUE 'C'.
  5492             88  SETUP-ERRORS           VALUE 'E'.
  5493         16  CL-ASSOC-CERT-SEQU      PIC S99.
  5494         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  5495         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  5496             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  5497         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  5498         16  FILLER                  PIC X.
  5499
  5500     12  CL-CERTIFICATE-DATA.
  5501         16  CL-CERT-ORIGIN          PIC X.
  5502             88  CERT-WAS-ONLINE        VALUE '1'.
  5503             88  CERT-WAS-CREATED       VALUE '2'.
  5504             88  COVERAGE-WAS-ADDED     VALUE '3'.
  5505         16  CL-CERT-KEY-DATA.
  5506             20  CL-CERT-CARRIER     PIC X.
  5507             20  CL-CERT-GROUPING    PIC X(6).
  5508             20  CL-CERT-STATE       PIC XX.
  5509             20  CL-CERT-ACCOUNT.
  5510                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 100
* EL1278.cbl
  5511                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  5512             20  CL-CERT-EFF-DT      PIC XX.
  5513
  5514     12  CL-STATUS-CONTROLS.
  5515         16  CL-PRIORITY-CD          PIC X.
  5516             88  CONFIDENTIAL-DATA      VALUE '8'.
  5517             88  HIGHEST-PRIORITY       VALUE '9'.
  5518         16  CL-SUPV-ATTN-CD         PIC X.
  5519             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  5520             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  5521         16  CL-PURGED-DT            PIC XX.
  5522         16  CL-RESTORED-DT          PIC XX.
  5523         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  5524         16  CL-NEXT-RESEND-DT       PIC XX.
  5525         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  5526         16  FILLER                  PIC XX.
  5527         16  CL-LAST-MAINT-DT        PIC XX.
  5528         16  CL-LAST-MAINT-USER      PIC X(4).
  5529         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  5530         16  CL-LAST-MAINT-TYPE      PIC X.
  5531             88  CLAIM-SET-UP           VALUE ' '.
  5532             88  PAYMENT-MADE           VALUE '1'.
  5533             88  LETTER-SENT            VALUE '2'.
  5534             88  MASTER-WAS-ALTERED     VALUE '3'.
  5535             88  MASTER-WAS-RESTORED    VALUE '4'.
  5536             88  INCURRED-DATE-CHANGED  VALUE '5'.
  5537             88  FILE-CONVERTED         VALUE '6'.
  5538             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  5539             88  ERROR-CORRECTION       VALUE 'E'.
  5540         16  CL-RELATED-CLAIM-NO     PIC X(7).
  5541         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  5542         16  CL-BENEFICIARY          PIC X(10).
  5543         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  5544         16  CL-DENIAL-TYPE          PIC X.
  5545             88  CL-TYPE-DENIAL          VALUE '1'.
  5546             88  CL-TYPE-RESCISSION      VALUE '2'.
  5547             88  CL-TYPE-REFORMATION     VALUE '3'.
  5548             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  5549             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  5550         16  FILLER                  PIC X(5).
  5551
  5552     12  CL-TRAILER-CONTROLS.
  5553         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  5554             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  5555             88  CL-LAST-TRL-AVAIL      VALUE +100.
  5556             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  5557         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  5558         16  FILLER                  PIC XX.
  5559         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  5560         16  CL-ADDRESS-TRAILER-CNT.
  5561             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  5562                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  5563             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  5564                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  5565             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  5566                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  5567             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  5568                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 101
* EL1278.cbl
  5569             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  5570                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  5571             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  5572                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  5573             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  5574                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  5575
  5576     12  CL-CV-REFERENCE-NO.
  5577         16  CL-CV-REFNO-PRIME       PIC X(18).
  5578         16  CL-CV-REFNO-SFX         PIC XX.
  5579
  5580     12  CL-FILE-LOCATION            PIC X(4).
  5581
  5582     12  CL-PROCESS-ERRORS.
  5583         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  5584             88  NO-FATAL-ERRORS        VALUE ZERO.
  5585         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  5586             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  5587
  5588     12  CL-PRODUCT-CD               PIC X.
  5589
  5590     12  CL-CURRENT-KEY-DATA.
  5591         16  CL-CURRENT-CARRIER      PIC X.
  5592         16  CL-CURRENT-GROUPING     PIC X(6).
  5593         16  CL-CURRENT-STATE        PIC XX.
  5594         16  CL-CURRENT-ACCOUNT      PIC X(10).
  5595
  5596     12  CL-ASSOCIATES               PIC X.
  5597         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  5598         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  5599         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  5600         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  5601
  5602     12  CL-ACTIVITY-CODE            PIC 99.
  5603     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  5604     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  5605
  5606     12  CL-LAPSE-REPORT-CODE        PIC 9.
  5607     12  CL-LAG-REPORT-CODE          PIC 9.
  5608     12  CL-LOAN-TYPE                PIC XX.
  5609     12  CL-LEGAL-STATE              PIC XX.
  5610
  5611*    12  FILLER                      PIC X(5).
  5612     12  CL-YESNOSW                  PIC X.
  5613     12  FILLER                      PIC X(4).
  5614*                            COPY ERCPDEF.
  5615******************************************************************
  5616*                                                                *
  5617*                                                                *
  5618*                            ERCPDEF.                            *
  5619*                                                                *
  5620*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5621*                                                                *
  5622*    FILE TYPE = VSAM,KSDS                                       *
  5623*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5624*                                                                *
  5625*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5626*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 102
* EL1278.cbl
  5627*    LOG = YES                                                   *
  5628*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5629******************************************************************
  5630 01  PRODUCT-MASTER.
  5631    12  PD-RECORD-ID                 PIC X(02).
  5632        88  VALID-PD-ID                  VALUE 'PD'.
  5633    12  PD-CONTROL-PRIMARY.
  5634        16  PD-COMPANY-CD            PIC X.
  5635        16  PD-STATE                 PIC XX.
  5636        16  PD-PRODUCT-CD            PIC XXX.
  5637        16  PD-FILLER                PIC X(7).
  5638        16  PD-BEN-TYPE              PIC X.
  5639        16  PD-BEN-CODE              PIC XX.
  5640        16  PD-PROD-EXP-DT           PIC XX.
  5641    12  FILLER                       PIC X(50).
  5642    12  PD-PRODUCT-DATA OCCURS 8.
  5643        16  PD-PROD-CODE             PIC X.
  5644            88  PD-PROD-LIFE           VALUE 'L'.
  5645            88  PD-PROD-PROP           VALUE 'P'.
  5646            88  PD-PROD-AH             VALUE 'A'.
  5647            88  PD-PROD-IU             VALUE 'I'.
  5648            88  PD-PROD-GAP            VALUE 'G'.
  5649        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5650        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5651        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5652        16  PD-MAX-TERM              PIC S999        COMP-3.
  5653        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5654        16  FILLER                   PIC X.
  5655        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5656        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5657        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5658        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5659        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5660        16  PD-REC-CRIT-PERIOD       PIC X.
  5661        16  PD-RTW-MOS               PIC 99.
  5662        16  FILLER                   PIC X(5).
  5663    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5664    12  PD-TERM-LIMITS OCCURS 15.
  5665        16  PD-LOW-TERM              PIC S999        COMP-3.
  5666        16  PD-HI-TERM               PIC S999        COMP-3.
  5667*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5668    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5669        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5670        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5671    12  PD-EARN-FACTORS.
  5672        16  FILLER OCCURS 15.
  5673            20  FILLER OCCURS 15.
  5674                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5675    12  PD-PRODUCT-DESC              PIC X(80).
  5676    12  PD-TRUNCATED                 PIC X.
  5677    12  FILLER                       PIC X(59).
  5678    12  PD-MAINT-INFORMATION.
  5679        16  PD-LAST-MAINT-DT         PIC X(02).
  5680        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5681        16  PD-LAST-MAINT-BY         PIC X(04).
  5682*                            COPY ELCCRTT.
  5683******************************************************************
  5684*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 103
* EL1278.cbl
  5685*                            ELCCRTT.                            *
  5686*                                                                *
  5687*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5688*                                                                *
  5689*   FILE TYPE = VSAM,KSDS                                        *
  5690*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5691*                                                                *
  5692*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5693*                                                                *
  5694*   LOG = YES                                                    *
  5695*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5696******************************************************************
  5697*                   C H A N G E   L O G
  5698*
  5699* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5700*-----------------------------------------------------------------
  5701*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5702* EFFECTIVE    NUMBER
  5703*-----------------------------------------------------------------
  5704* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5705* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5706* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5707* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5708******************************************************************
  5709
  5710 01  CERTIFICATE-TRAILERS.
  5711     12  CS-RECORD-ID                      PIC XX.
  5712         88  VALID-CS-ID                      VALUE 'CS'.
  5713
  5714     12  CS-CONTROL-PRIMARY.
  5715         16  CS-COMPANY-CD                 PIC X.
  5716         16  CS-CARRIER                    PIC X.
  5717         16  CS-GROUPING                   PIC X(6).
  5718         16  CS-STATE                      PIC XX.
  5719         16  CS-ACCOUNT                    PIC X(10).
  5720         16  CS-CERT-EFF-DT                PIC XX.
  5721         16  CS-CERT-NO.
  5722             20  CS-CERT-PRIME             PIC X(10).
  5723             20  CS-CERT-SFX               PIC X.
  5724         16  CS-TRAILER-TYPE               PIC X.
  5725             88  COMM-TRLR           VALUE 'A'.
  5726             88  FUTURE-TRLR         VALUE 'B'.
  5727             88  CERT-DATA-TRLR      VALUE 'C'.
  5728
  5729     12  CS-DATA-AREA                      PIC X(516).
  5730
  5731     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5732         16  CS-BANK-COMMISSION-AREA.
  5733             20  CS-BANK-COMMS       OCCURS 10.
  5734                 24  CS-AGT                PIC X(10).
  5735                 24  CS-COM-TYP            PIC X.
  5736                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5737                 24  CS-RECALC-LV-INDIC    PIC X.
  5738                 24  FILLER                PIC X(10).
  5739         16  FILLER                        PIC X(256).
  5740
  5741     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5742         16  CS-VIN-NUMBER                 PIC X(17).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 104
* EL1278.cbl
  5743         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5744         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5745         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5746         16  FILLER                        PIC X(496).
  5747******************************************************************
  5748 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  5749                          ACCOUNT-MASTER CERTIFICATE-MASTER
  5750                          MAILING-DATA ORIGINAL-CERTIFICATE
  5751                          FORM-MASTER CLAIM-MASTER
  5752                          PRODUCT-MASTER CERTIFICATE-TRAILERS.
  5753 0000-DFHEXIT SECTION.
  5754     MOVE '9#                    $   ' TO DFHEIV0.
  5755     MOVE 'EL1278' TO DFHEIV1.
  5756     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5757*    SERVICE RELOAD PARMLIST.
  5758
  5759     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5760     MOVE '5'                    TO  DC-OPTION-CODE.
  5761
  5762     PERFORM 9600-DATE-LINK.
  5763
  5764     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5765     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5766     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5767     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5768     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  5769     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  5770     MOVE EIBTRMID               TO  QID-TERM.
  5771
  5772     IF EIBCALEN  IS EQUAL TO  ZERO
  5773         GO TO 8700-UNAUTHORIZED-ACCESS.
  5774
  5775     IF PI-CALLING-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5776         IF PI-RETURN-TO-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5777             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  5778             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  5779             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  5780             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  5781             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  5782             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  5783             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  5784             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  5785         ELSE
  5786             MOVE PI-CALLING-PROGRAM    TO  RETURN-FROM
  5787             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  5788             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  5789             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  5790             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  5791             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  5792             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  5793             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  5794             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  5795
  5796     IF EIBAID  IS EQUAL TO  DFHCLEAR
  5797         GO TO 9300-CLEAR.
  5798
  5799     IF PI-PROCESSOR-ID  IS EQUAL TO  'LGXX'
  5800         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 105
* EL1278.cbl
  5801     ELSE
  5802
  5803* EXEC CICS READQ TS
  5804*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  5805*            INTO    (SECURITY-CONTROL)
  5806*            LENGTH  (SC-COMM-LENGTH)
  5807*            ITEM    (SC-ITEM)
  5808*        END-EXEC
  5809*    MOVE '*$II   L              ''   #00005798' TO DFHEIV0
  5810     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5811     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5812     MOVE X'2020233030303035373938' TO DFHEIV0(25:11)
  5813     CALL 'kxdfhei1' USING DFHEIV0,
  5814           PI-SECURITY-TEMP-STORE-ID,
  5815           SECURITY-CONTROL,
  5816           SC-COMM-LENGTH,
  5817           SC-ITEM,
  5818           DFHEIV99,
  5819           DFHEIV99
  5820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5821         MOVE SC-CREDIT-DISPLAY (33)
  5822                                 TO  PI-DISPLAY-CAP
  5823         MOVE SC-CREDIT-UPDATE  (33)
  5824                                 TO  PI-MODIFY-CAP
  5825         MOVE SC-CREDIT-UPDATE  (32)
  5826                                 TO  PI-MODIFY-CERT-CAP
  5827         IF NOT  DISPLAY-CAP
  5828             MOVE 'READ'         TO  SM-READ
  5829             PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  5830             MOVE ER-0070        TO  EMI-ERROR
  5831             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5832             GO TO 8100-SEND-INITIAL-MAP.
  5833
  5834     IF EIBTRNID  IS NOT EQUAL TO  TRANS-ID
  5835         MOVE 'Y' TO WS-FIRST-ENTRY-SW
  5836         MOVE LOW-VALUES         TO  EL127HI
  5837         MOVE SAVE-BIN-DATE      TO  WS-LF-CANCEL-DATE
  5838                                     PI-LF-CANCEL-DATE
  5839                                     WS-AH-CANCEL-DATE
  5840                                     PI-AH-CANCEL-DATE
  5841         MOVE SAVE-DATE          TO  WS-LF-CANCEL-DATE-ED
  5842                                     PI-LF-CANCEL-DATE-ED
  5843                                     WS-AH-CANCEL-DATE-ED
  5844                                     PI-AH-CANCEL-DATE-ED
  5845         MOVE SPACES             TO  PI-EARNING-METHOD-LF
  5846                                     PI-EARNING-METHOD-AH
  5847         PERFORM 0500-FORMAT-SCREEN
  5848         GO TO 8100-SEND-INITIAL-MAP.
  5849
  5850     IF NOT  MODIFY-CAP
  5851         MOVE 'UPDATE'           TO  SM-READ
  5852         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  5853         MOVE ER-0070            TO  EMI-ERROR
  5854         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5855         GO TO 8100-SEND-INITIAL-MAP.
  5856
  5857
  5858* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 106
* EL1278.cbl
  5859*        PGMIDERR  (9500-PGMID-ERROR)
  5860*        ERROR     (9900-ABEND)
  5861*    END-EXEC.
  5862*    MOVE '"$L.                  ! " #00005840' TO DFHEIV0
  5863     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5864     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5865     MOVE X'2220233030303035383430' TO DFHEIV0(25:11)
  5866     CALL 'kxdfhei1' USING DFHEIV0
  5867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5868
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 107
* EL1278.cbl
  5870 0200-RECEIVE.
  5871     IF EIBAID  IS EQUAL TO  DFHPA1  OR  DFHPA2  OR  DFHPA3
  5872         MOVE ER-0008            TO  EMI-ERROR
  5873         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5874         MOVE -1                 TO  HLCANCL
  5875         GO TO 8200-SEND-DATAONLY.
  5876
  5877
  5878* EXEC CICS RECEIVE
  5879*        MAP     (MAP-NAME)
  5880*        MAPSET  (MAPSET-NAME)
  5881*        INTO    (EL127HI)
  5882*    END-EXEC.
  5883     MOVE LENGTH OF
  5884      EL127HI
  5885       TO DFHEIV11
  5886*    MOVE '8"T I  L              ''   #00005852' TO DFHEIV0
  5887     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5888     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5889     MOVE X'2020233030303035383532' TO DFHEIV0(25:11)
  5890     CALL 'kxdfhei1' USING DFHEIV0,
  5891           MAP-NAME,
  5892           EL127HI,
  5893           DFHEIV11,
  5894           MAPSET-NAME,
  5895           DFHEIV99,
  5896           DFHEIV99
  5897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5898
  5899
  5900     IF HPFKEYL  IS EQUAL TO  ZERO
  5901         GO TO 0300-CHECK-PFKEYS.
  5902
  5903     IF EIBAID  IS NOT EQUAL TO  DFHENTER
  5904         MOVE ER-0004            TO  EMI-ERROR
  5905         GO TO 0320-INPUT-ERROR.
  5906
  5907     IF HPFKEYI NUMERIC
  5908         IF HPFKEYI  IS EQUAL TO  '12'  OR  '23'  OR  '24' OR '11'
  5909             MOVE PF-VALUES (HPFKEYI)
  5910                                 TO  EIBAID
  5911         ELSE
  5912             MOVE ER-0029        TO  EMI-ERROR
  5913             GO TO 0320-INPUT-ERROR.
  5914
  5915 0300-CHECK-PFKEYS.
  5916     IF EIBAID  IS EQUAL TO  DFHPF23
  5917         GO TO 8800-PF23.
  5918
  5919     IF EIBAID  IS EQUAL TO  DFHPF24
  5920         GO TO 9100-RETURN-MAIN-MENU.
  5921
  5922     IF EIBAID = DFHPF11
  5923        GO TO 1700-WRITE-CERT-NOTE
  5924     END-IF
  5925
  5926     IF EIBAID  IS EQUAL TO  DFHPF12
  5927         GO TO 9400-PF12.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 108
* EL1278.cbl
  5928
  5929     IF EIBAID = DFHENTER OR DFHPF10
  5930        GO TO 0400-EDIT-INPUT-DATA
  5931     END-IF
  5932
  5933     MOVE ER-0029                TO  EMI-ERROR.
  5934
  5935 0320-INPUT-ERROR.
  5936     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  5937
  5938     MOVE AL-UNBON               TO  HPFKEYA.
  5939
  5940     IF HPFKEYL  IS EQUAL TO  ZERO
  5941         MOVE -1                 TO  HLCANCL
  5942     ELSE
  5943         MOVE -1                 TO  HPFKEYL.
  5944
  5945     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 109
* EL1278.cbl
  5947 0400-EDIT-INPUT-DATA.
  5948     MOVE 'N'                    TO  WS-NEW-AH-CANCEL-SW
  5949                                     WS-NEW-LF-CANCEL-SW.
  5950
  5951     IF (HPCYNL > 0)
  5952        AND (HPCYNI = 'Y' OR 'N')
  5953        PERFORM 1800-READ-ELCERT-UPDATE
  5954                                 THRU 1800-EXIT
  5955        IF WS-RESP-NORMAL
  5956           MOVE HPCYNI           TO CM-POST-CARD-IND
  5957           PERFORM 1810-REWRITE-ELCERT
  5958                                 THRU 1810-EXIT
  5959        END-IF
  5960     END-IF
  5961     IF HLCAL1L GREATER ZERO
  5962         MOVE HLCAL1I              TO  PI-EARNING-METHOD-LF.
  5963     IF CLPYNI = 'Y'
  5964        MOVE 'Y'                   TO PI-CLP-YN
  5965        MOVE AL-UANON              TO CLPYNA
  5966     ELSE
  5967        MOVE ' '                   TO PI-CLP-YN
  5968        MOVE AL-UANON              TO CLPYNA
  5969     END-IF
  5970     IF CANREAI = 'R'
  5971        MOVE 'R'                 TO PI-CANCEL-REASON
  5972        MOVE AL-UANON            TO CANREAA
  5973     ELSE
  5974        MOVE ' '                 TO PI-CANCEL-REASON
  5975        MOVE AL-UANON            TO CANREAA
  5976     END-IF
  5977
  5978     IF HLCANCL  IS EQUAL TO  ZERO
  5979       AND HACANCL  IS EQUAL TO  ZERO
  5980         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  5981         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  5982         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  5983         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  5984         GO TO 0420-CHECK-ERRORS.
  5985
  5986     IF HLCANCL  IS EQUAL TO  ZERO
  5987         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  5988         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  5989         GO TO 0410-CHECK-AH-DATE.
  5990
  5991     IF HLCANCI = SPACES
  5992        MOVE LOW-VALUES            TO PI-LF-CANCEL-DATE
  5993                                      WS-LF-CANCEL-DATE
  5994        MOVE SPACES                TO PI-LF-CANCEL-DATE-ED
  5995                                      WS-LF-CANCEL-DATE-ED
  5996                                      PI-LF-REFUND-METH
  5997        MOVE +0                    TO PI-LF-REFUND-AMT
  5998        GO TO 0410-CHECK-AH-DATE
  5999     END-IF
  6000
  6001     MOVE AL-UNNON               TO  HLCANCA.
  6002     MOVE HLCANCI                TO  DEEDIT-FIELD.
  6003     MOVE 'Y'                    TO  WS-NEW-LF-CANCEL-SW.
  6004
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 110
* EL1278.cbl
  6005     PERFORM 8600-DEEDIT.
  6006
  6007     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  6008     MOVE '4'                    TO  DC-OPTION-CODE.
  6009
  6010     PERFORM 9600-DATE-LINK.
  6011
  6012     IF DATE-CONVERSION-ERROR
  6013         MOVE -1                 TO  HLCANCL
  6014         MOVE AL-UABON           TO  HLCANCA
  6015         MOVE ER-2227            TO  EMI-ERROR
  6016         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6017     ELSE
  6018        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  6019           MOVE -1               TO  HACANCL
  6020           MOVE AL-UABON         TO  HACANCA
  6021           MOVE ER-2774          TO  EMI-ERROR
  6022           PERFORM 9700-ERROR-FORMAT
  6023                                 THRU  9799-EXIT
  6024        ELSE
  6025           MOVE DC-BIN-DATE-1    TO WS-LF-CANCEL-DATE
  6026                                    PI-LF-CANCEL-DATE
  6027           MOVE DC-GREG-DATE-1-EDIT
  6028                                 TO HLCANCO
  6029                                    WS-LF-CANCEL-DATE-ED
  6030                                    PI-LF-CANCEL-DATE-ED
  6031        END-IF
  6032     END-IF
  6033     .
  6034 0410-CHECK-AH-DATE.
  6035     IF HACAL1L GREATER ZERO
  6036         MOVE HACAL1I              TO  PI-EARNING-METHOD-AH.
  6037
  6038     IF HACANCL  IS EQUAL TO  ZERO
  6039         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  6040         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  6041         GO TO 0420-CHECK-ERRORS.
  6042     IF HACANCI = SPACES
  6043        MOVE LOW-VALUES            TO PI-AH-CANCEL-DATE
  6044                                      WS-AH-CANCEL-DATE
  6045        MOVE SPACES                TO PI-AH-CANCEL-DATE-ED
  6046                                      WS-AH-CANCEL-DATE-ED
  6047                                      PI-AH-REFUND-METH
  6048        MOVE +0                    TO PI-AH-REFUND-AMT
  6049        GO TO 0420-CHECK-ERRORS
  6050     END-IF
  6051
  6052     MOVE AL-UNNON               TO  HACANCA.
  6053     MOVE HACANCI                TO  DEEDIT-FIELD.
  6054     MOVE 'Y'                    TO  WS-NEW-AH-CANCEL-SW.
  6055
  6056     PERFORM 8600-DEEDIT.
  6057
  6058     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  6059     MOVE '4'                    TO  DC-OPTION-CODE.
  6060
  6061     PERFORM 9600-DATE-LINK.
  6062
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 111
* EL1278.cbl
  6063     IF DATE-CONVERSION-ERROR
  6064         MOVE -1                 TO  HACANCL
  6065         MOVE AL-UABON           TO  HACANCA
  6066         MOVE ER-2227            TO  EMI-ERROR
  6067         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6068     ELSE
  6069        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  6070           MOVE -1               TO  HACANCL
  6071           MOVE AL-UABON         TO  HACANCA
  6072           MOVE ER-2775          TO  EMI-ERROR
  6073           PERFORM 9700-ERROR-FORMAT
  6074                                 THRU  9799-EXIT
  6075        ELSE
  6076           MOVE DC-BIN-DATE-1    TO WS-AH-CANCEL-DATE
  6077                                    PI-AH-CANCEL-DATE
  6078           MOVE DC-GREG-DATE-1-EDIT
  6079                                 TO HACANCO
  6080                                    WS-AH-CANCEL-DATE-ED
  6081                                    PI-AH-CANCEL-DATE-ED
  6082        END-IF
  6083     END-IF
  6084     .
  6085 0420-CHECK-ERRORS.
  6086     IF EMI-ERROR  IS EQUAL TO  ZEROS
  6087         NEXT SENTENCE
  6088     ELSE
  6089         GO TO 8200-SEND-DATAONLY.
  6090
  6091     PERFORM 0500-FORMAT-SCREEN.
  6092     IF EIBAID = DFHPF10
  6093        perform 4000-GEN-CANCEL-TRANS
  6094                                 thru 4000-exit
  6095        MOVE PROGRAM-INTERFACE-BLOCK TO WS-PASS-631
  6096        MOVE LOW-VALUES     TO WS-PASS-PROGRAM-WORK-AREA
  6097        MOVE PI-COMPANY-CD  TO PI-PB-COMPANY-CD
  6098        MOVE CG-BATCH-NO    TO PI-PB-ENTRY-BATCH
  6099        MOVE 1              TO PI-PB-BATCH-SEQ-NO
  6100        MOVE 'Y'            TO PI-ALL-ISSUES-SW
  6101                               PI-ALL-CANCELS-SW
  6102        IF PI-PROCESSOR-IS-CSR
  6103            MOVE 'Y'        TO PI-CSR-SESSION-SW
  6104        ELSE
  6105            MOVE ' '        TO PI-CSR-SESSION-SW
  6106        END-IF
  6107        MOVE 'N'            TO PI-ISSUES-IN-ERROR-SW
  6108                               PI-CANCELS-IN-ERROR-SW
  6109                               PI-ONLY-BATCH-HEADERS-SW
  6110                               PI-ALL-OUT-OF-BAL-SW
  6111                               PI-HOLD-REC-SW
  6112                               PI-CHANGE-REC-SW
  6113                               PI-CHK-REQ-REC-SW
  6114                               PI-ISSUE-WARNING-SW
  6115                               PI-CANCEL-WARNING-SW
  6116        MOVE '1'            TO PI-BROWSE-TYPE
  6117        MOVE DFHENTER       TO  EIBAID
  6118
  6119
  6120* EXEC CICS XCTL
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 112
* EL1278.cbl
  6121*           PROGRAM    ('EL6311')
  6122*           COMMAREA   (WS-PASS-631)
  6123*           LENGTH     (1300)
  6124*       END-EXEC
  6125     MOVE 'EL6311' TO DFHEIV1
  6126     MOVE 1300
  6127       TO DFHEIV11
  6128*    MOVE '.$C                   %   #00006077' TO DFHEIV0
  6129     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  6130     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6131     MOVE X'2020233030303036303737' TO DFHEIV0(25:11)
  6132     CALL 'kxdfhei1' USING DFHEIV0,
  6133           DFHEIV1,
  6134           WS-PASS-631,
  6135           DFHEIV11,
  6136           DFHEIV99
  6137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6138
  6139*        PERFORM 0500-FORMAT-SCREEN
  6140     END-IF
  6141     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 113
* EL1278.cbl
  6143 0500-FORMAT-SCREEN  SECTION.
  6144     MOVE LOW-VALUES             TO  EL127HO.
  6145     MOVE PI-CARRIER             TO  HCARIERO.
  6146     MOVE PI-GROUPING            TO  HGROUPO.
  6147     MOVE PI-STATE               TO  HSTATEO.
  6148     MOVE PI-ACCOUNT             TO  HACCTNOO.
  6149     MOVE ' '                    TO  DC-OPTION-CODE.
  6150     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6151
  6152     PERFORM 9600-DATE-LINK.
  6153
  6154     MOVE DC-GREG-DATE-1-EDIT    TO  HEFFDTO.
  6155     MOVE PI-CERT-PRIME          TO  HCERTNOO.
  6156     MOVE PI-CERT-SFX            TO  HCRTSFXO.
  6157     MOVE PI-CLP-YN              TO  CLPYNO
  6158     MOVE PI-CANCEL-REASON       TO  CANREAO
  6159     .
  6160 0510-GET-CERT.
  6161     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  6162     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  6163     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  6164     MOVE PI-STATE               TO  WS-CM-STATE.
  6165     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  6166     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  6167     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  6168     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  6169
  6170     PERFORM 0900-READ-CERT-FILE.
  6171
  6172     IF CERT-NOT-FOUND
  6173         MOVE -1                 TO  HLCANCL
  6174         MOVE AL-SANON           TO  HLCANCA
  6175         MOVE ER-0214            TO  EMI-ERROR
  6176         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6177         GO TO 8100-SEND-INITIAL-MAP.
  6178
  6179     IF CM-CLAIM-ATTACHED-COUNT = +0
  6180        GO TO 0510-SKIP-CLAIM-CHECK
  6181     END-IF
  6182*    DISPLAY ' STARTING CLAIM TEST '
  6183     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  6184     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  6185
  6186* EXEC CICS STARTBR
  6187*       DATASET     ('ELMSTR5')
  6188*       RIDFLD      (ELMSTR-KEY)
  6189*       RESP        (WS-RESPONSE)
  6190*    END-EXEC
  6191     MOVE 'ELMSTR5' TO DFHEIV1
  6192     MOVE 0
  6193       TO DFHEIV11
  6194*    MOVE '&,         G          &  N#00006129' TO DFHEIV0
  6195     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6196     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6197     MOVE X'204E233030303036313239' TO DFHEIV0(25:11)
  6198     CALL 'kxdfhei1' USING DFHEIV0,
  6199           DFHEIV1,
  6200           ELMSTR-KEY,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 114
* EL1278.cbl
  6201           DFHEIV99,
  6202           DFHEIV11,
  6203           DFHEIV99
  6204     MOVE EIBRESP  TO WS-RESPONSE
  6205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6206     IF WS-RESP-NORMAL
  6207     PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  6208
  6209* EXEC CICS READNEXT
  6210*          DATASET   ('ELMSTR5')
  6211*          RIDFLD    (ELMSTR-KEY)
  6212*          SET       (ADDRESS OF CLAIM-MASTER)
  6213*          RESP      (WS-RESPONSE)
  6214*       END-EXEC
  6215     MOVE 'ELMSTR5' TO DFHEIV1
  6216     MOVE 0
  6217       TO DFHEIV11
  6218*    MOVE '&.S                   )  N#00006136' TO DFHEIV0
  6219     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6220     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6221     MOVE X'204E233030303036313336' TO DFHEIV0(25:11)
  6222     CALL 'kxdfhei1' USING DFHEIV0,
  6223           DFHEIV1,
  6224           DFHEIV20,
  6225           DFHEIV99,
  6226           ELMSTR-KEY,
  6227           DFHEIV99,
  6228           DFHEIV11,
  6229           DFHEIV99,
  6230           DFHEIV99
  6231     SET ADDRESS OF CLAIM-MASTER TO
  6232         DFHEIV20
  6233     MOVE EIBRESP  TO WS-RESPONSE
  6234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6235        IF (WS-RESP-NORMAL OR WS-RESP-DUPKEY)
  6236           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6237           AND (CM-CERT-NO = CL-CERT-NO)
  6238           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6239              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6240              SET FOUND-A-CLAIM  TO TRUE
  6241              IF CL-CLAIM-TYPE = 'L'
  6242                 IF CL-INCURRED-DT > WS-LF-INCUR-DT
  6243                    MOVE CL-INCURRED-DT TO WS-LF-INCUR-DT
  6244                 END-IF
  6245                 IF CLAIM-IS-OPEN
  6246                    SET OPEN-LF-CLAIM TO TRUE
  6247                 ELSE
  6248                    IF CL-LAST-CLOSE-DT > WS-LF-LAST-CLOSE-DT
  6249                       MOVE CL-LAST-CLOSE-DT
  6250                                 TO WS-LF-LAST-CLOSE-DT
  6251                    END-IF
  6252                    SET CLOSED-LF-CLAIM TO TRUE
  6253                 END-IF
  6254              ELSE
  6255                 IF CLAIM-IS-OPEN
  6256                    MOVE CL-PAID-THRU-DT
  6257                                 TO WS-AH-PAID-THRU-DT
  6258                    SET OPEN-AH-CLAIM TO TRUE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 115
* EL1278.cbl
  6259                 ELSE
  6260                    IF CL-PAID-THRU-DT > WS-AH-PAID-THRU-DT
  6261                       MOVE CL-PAID-THRU-DT
  6262                                 TO WS-AH-PAID-THRU-DT
  6263                    END-IF
  6264                    IF CL-LAST-CLOSE-DT > WS-AH-LAST-CLOSE-DT
  6265                       MOVE CL-LAST-CLOSE-DT
  6266                                 TO WS-AH-LAST-CLOSE-DT
  6267                    END-IF
  6268                    SET CLOSED-AH-CLAIM TO TRUE
  6269                 END-IF
  6270              END-IF
  6271           END-IF
  6272        ELSE
  6273           SET I-SAY-TO-STOP TO TRUE
  6274        END-IF
  6275     END-PERFORM
  6276     END-IF
  6277     IF FOUND-A-CLAIM
  6278        IF WS-LF-INCUR-DT NOT = LOW-VALUES
  6279           MOVE WS-LF-INCUR-DT   TO DC-BIN-DATE-1
  6280           MOVE ' '              TO DC-OPTION-CODE
  6281           PERFORM 9600-DATE-LINK
  6282           IF NO-CONVERSION-ERROR
  6283              MOVE DC-GREG-DATE-1-EDIT TO LCLMDTO
  6284              MOVE AL-SANOF      TO LCLMDTHA
  6285           END-IF
  6286        END-IF
  6287        IF WS-AH-PAID-THRU-DT NOT = LOW-VALUES
  6288           MOVE WS-AH-PAID-THRU-DT TO DC-BIN-DATE-1
  6289           MOVE ' '              TO DC-OPTION-CODE
  6290           PERFORM 9600-DATE-LINK
  6291           IF NO-CONVERSION-ERROR
  6292              MOVE DC-GREG-DATE-1-EDIT TO ACLMDTO
  6293              MOVE AL-SANOF      TO ACLMDTHA
  6294           END-IF
  6295        END-IF
  6296        MOVE PI-COMPANY-ID       TO WS-CF-COMPANY-ID
  6297        MOVE '3'                 TO WS-CF-RECORD-TYPE
  6298        MOVE CM-STATE            TO WS-CF-ACCESS
  6299        MOVE +0                  TO WS-CF-SEQUENCE-NO
  6300
  6301* EXEC CICS READ
  6302*          DATASET  (ELCNTL-ID)
  6303*          SET      (ADDRESS OF CONTROL-FILE)
  6304*          RIDFLD   (WS-CF-CONTROL-PRIMARY)
  6305*          RESP     (WS-RESPONSE)
  6306*       END-EXEC
  6307*    MOVE '&"S        E          (  N#00006207' TO DFHEIV0
  6308     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6309     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6310     MOVE X'204E233030303036323037' TO DFHEIV0(25:11)
  6311     CALL 'kxdfhei1' USING DFHEIV0,
  6312           ELCNTL-ID,
  6313           DFHEIV20,
  6314           DFHEIV99,
  6315           WS-CF-CONTROL-PRIMARY,
  6316           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 116
* EL1278.cbl
  6317           DFHEIV99,
  6318           DFHEIV99
  6319     SET ADDRESS OF CONTROL-FILE TO
  6320         DFHEIV20
  6321     MOVE EIBRESP  TO WS-RESPONSE
  6322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6323        IF WS-RESP-NORMAL
  6324           MOVE CF-ST-REF-AH-DEATH-IND
  6325                                 TO WS-ST-REF-IND
  6326        END-IF
  6327     END-IF
  6328     .
  6329 0510-SKIP-CLAIM-CHECK.
  6330     MOVE CM-INSURED-LAST-NAME   TO  HLNAMEO.
  6331     MOVE CM-INSURED-FIRST-NAME  TO  HFNAMEO.
  6332     MOVE CM-INSURED-INITIAL2    TO  HINITO.
  6333     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  6334
  6335* EXEC CICS READ
  6336*        DATASET  (ERMAIL-ID)
  6337*        RIDFLD   (WS-MA-CONTROL-PRIMARY)
  6338*        SET      (ADDRESS OF MAILING-DATA)
  6339*        RESP     (WS-RESPONSE)
  6340*    END-EXEC.
  6341*    MOVE '&"S        E          (  N#00006224' TO DFHEIV0
  6342     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6343     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6344     MOVE X'204E233030303036323234' TO DFHEIV0(25:11)
  6345     CALL 'kxdfhei1' USING DFHEIV0,
  6346           ERMAIL-ID,
  6347           DFHEIV20,
  6348           DFHEIV99,
  6349           WS-MA-CONTROL-PRIMARY,
  6350           DFHEIV99,
  6351           DFHEIV99,
  6352           DFHEIV99
  6353     SET ADDRESS OF MAILING-DATA TO
  6354         DFHEIV20
  6355     MOVE EIBRESP  TO WS-RESPONSE
  6356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6357
  6358     IF WS-RESP-NORMAL
  6359        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6360           (S1 > +7)
  6361           OR (MA-MAIL-STATUS (S1) = '1')
  6362        END-PERFORM
  6363        IF S1 > +7
  6364           MOVE AL-SANOF         TO HPCYNA
  6365        END-IF
  6366     END-IF
  6367     IF CM-POST-CARD-IND = 'Y'
  6368        MOVE 'Y'                 TO HPCYNO
  6369     ELSE
  6370        MOVE 'N'                 TO HPCYNO
  6371     END-IF
  6372     IF ('8' NOT = CM-LF-CURRENT-STATUS AND CM-AH-CURRENT-STATUS)
  6373        OR (NOT CERT-AS-LOADED)
  6374        MOVE AL-SANOF            TO HPCYNA
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 117
* EL1278.cbl
  6375     END-IF
  6376*    IF (CERT-ADDED-BATCH)
  6377*       CONTINUE
  6378*    ELSE
  6379*       MOVE AL-SANOF            TO HPCYNA
  6380*    END-IF
  6381     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  6382     MOVE '5'                    TO  DC-OPTION-CODE.
  6383
  6384     PERFORM 9600-DATE-LINK.
  6385
  6386     MOVE DC-BIN-DATE-1          TO  DC-BIN-DATE-2.
  6387     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6388     MOVE '1'                    TO  DC-OPTION-CODE.
  6389
  6390     PERFORM 9600-DATE-LINK.
  6391
  6392     MOVE DC-ELAPSED-MONTHS      TO  WS-ELAPSED-MONTHS.
  6393
  6394     MOVE ZEROS TO WS-TOT-ITDR.
  6395     MOVE WS-REFUND-DESCRIP TO PMTHDO.
  6396
  6397 0510-CHECK-LF-STATUS.
  6398
  6399     IF (CM-LF-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6400         MOVE LOW-VALUES         TO WS-LF-CANCEL-DATE
  6401                                    PI-LF-CANCEL-DATE
  6402         MOVE SPACES             TO WS-LF-CANCEL-DATE-ED
  6403                                    PI-LF-CANCEL-DATE-ED
  6404                                    PI-LF-REFUND-METH
  6405         MOVE ZEROS              TO PI-LF-REFUND-AMT
  6406         GO TO 0510-CHECK-AH-STATUS.
  6407
  6408     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '8') AND
  6409        (CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6410          MOVE CM-LF-ITD-CANCEL-AMT TO HLITDRO
  6411          ADD  CM-LF-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6412          IF FIRST-ENTRY
  6413              MOVE CM-LF-CANCEL-DT      TO DC-BIN-DATE-1
  6414              MOVE SPACES               TO DC-OPTION-CODE
  6415              PERFORM 9600-DATE-LINK
  6416              IF NOT DATE-CONVERSION-ERROR
  6417                   MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6418                                            PI-LF-CANCEL-DATE-ED
  6419                                            WS-LF-CANCEL-DATE-ED
  6420                   MOVE CM-LF-CANCEL-DT TO  PI-LF-CANCEL-DATE
  6421                                            WS-LF-CANCEL-DATE.
  6422
  6423     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '7')  AND
  6424        (CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES)
  6425          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6426          MOVE CM-LF-ITD-DEATH-AMT  TO HLITDRO
  6427          ADD  CM-LF-ITD-DEATH-AMT TO WS-TOT-ITDR
  6428        IF FIRST-ENTRY
  6429            MOVE CM-LF-DEATH-DT       TO DC-BIN-DATE-1
  6430            MOVE SPACES               TO DC-OPTION-CODE
  6431            PERFORM 9600-DATE-LINK
  6432            IF NOT DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 118
* EL1278.cbl
  6433                 MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6434                                          PI-LF-CANCEL-DATE-ED
  6435                                          WS-LF-CANCEL-DATE-ED
  6436                 MOVE CM-LF-DEATH-DT  TO  PI-LF-CANCEL-DATE
  6437                                          WS-LF-CANCEL-DATE.
  6438
  6439 0510-CHECK-AH-STATUS.
  6440
  6441     IF (CM-AH-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6442         MOVE LOW-VALUES         TO WS-AH-CANCEL-DATE
  6443                                    PI-AH-CANCEL-DATE
  6444         MOVE SPACES             TO WS-AH-CANCEL-DATE-ED
  6445                                    PI-AH-CANCEL-DATE-ED
  6446                                    PI-AH-REFUND-METH
  6447         MOVE ZEROS              TO PI-AH-REFUND-AMT
  6448         GO TO 0510-CONT.
  6449
  6450     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '8')  AND
  6451        (CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6452          MOVE CM-AH-ITD-CANCEL-AMT TO HAITDRO
  6453          ADD  CM-AH-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6454        IF FIRST-ENTRY
  6455            MOVE CM-AH-CANCEL-DT      TO DC-BIN-DATE-1
  6456            MOVE SPACES               TO DC-OPTION-CODE
  6457            PERFORM 9600-DATE-LINK
  6458            IF NOT DATE-CONVERSION-ERROR
  6459                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6460                                            PI-AH-CANCEL-DATE-ED
  6461                                            WS-AH-CANCEL-DATE-ED
  6462                 MOVE CM-AH-CANCEL-DT  TO   PI-AH-CANCEL-DATE
  6463                                            WS-AH-CANCEL-DATE.
  6464
  6465     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '6' OR '7')   AND
  6466        (CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES)
  6467          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6468          MOVE CM-AH-ITD-LUMP-PMT   TO HAITDRO
  6469          ADD  CM-AH-ITD-LUMP-PMT   TO WS-TOT-ITDR
  6470         IF FIRST-ENTRY
  6471             MOVE CM-AH-SETTLEMENT-DT  TO DC-BIN-DATE-1
  6472             MOVE SPACES               TO DC-OPTION-CODE
  6473             PERFORM 9600-DATE-LINK
  6474             IF NOT DATE-CONVERSION-ERROR
  6475                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6476                                            PI-AH-CANCEL-DATE-ED
  6477                                            WS-AH-CANCEL-DATE-ED
  6478                MOVE CM-AH-SETTLEMENT-DT TO PI-AH-CANCEL-DATE
  6479                                            WS-AH-CANCEL-DATE.
  6480
  6481     IF CM-AH-CURRENT-STATUS IS EQUAL TO '8'
  6482         MOVE 'CANC DT'              TO  CNCDTHDO
  6483         GO TO 0510-CONT.
  6484
  6485     IF CM-LF-CURRENT-STATUS IS EQUAL TO '7'
  6486         MOVE 'DTH DT '              TO  CNCDTHDO
  6487         IF FIRST-ENTRY
  6488             MOVE CM-LF-DEATH-DT     TO  DC-BIN-DATE-1
  6489             MOVE ' '                TO  DC-OPTION-CODE
  6490             PERFORM 9600-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 119
* EL1278.cbl
  6491             IF NOT DATE-CONVERSION-ERROR
  6492                 MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6493                                             PI-AH-CANCEL-DATE-ED
  6494                                             WS-AH-CANCEL-DATE-ED
  6495                 MOVE CM-LF-DEATH-DT      TO PI-AH-CANCEL-DATE
  6496                                             WS-AH-CANCEL-DATE.
  6497
  6498 0510-CONT.
  6499
  6500     IF WS-TOT-ITDR GREATER THAN ZEROS
  6501         MOVE WS-TOT-ITDR TO TOITDRO.
  6502
  6503 0520-GET-COMPANY-RECORD.
  6504     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6505     MOVE '1'                    TO  WS-CF-RECORD-TYPE.
  6506     MOVE SPACES                 TO  WS-CF-ACCESS.
  6507     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6508
  6509     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6510
  6511     IF CNTL-NOT-FOUND
  6512         MOVE -1                 TO  HLCANCL
  6513         MOVE AL-SANON           TO  HLCANCA
  6514         MOVE ER-2616            TO  EMI-ERROR
  6515         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6516         GO TO 8100-SEND-INITIAL-MAP.
  6517
  6518     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6519       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6520         MOVE CF-LIFE-OVERRIDE-L1
  6521                                 TO  WS-CF-LIFE-OVERRIDE-L1
  6522         MOVE CF-LIFE-OVERRIDE-L2
  6523                                 TO  WS-CF-LIFE-OVERRIDE-L2
  6524         MOVE CF-AH-OVERRIDE-L1  TO  WS-CF-AH-OVERRIDE-L1
  6525         MOVE CF-AH-OVERRIDE-L2  TO  WS-CF-AH-OVERRIDE-L2
  6526         MOVE CF-CR-REM-TERM-CALC
  6527                                 TO  WS-CF-CR-REM-TERM-CALC
  6528         MOVE CF-CR-R78-METHOD   TO  WS-CF-CR-R78-METHOD
  6529         IF CF-DEFAULT-APR NUMERIC
  6530             MOVE CF-DEFAULT-APR     TO  WS-CF-DEFAULT-APR
  6531             GO TO 0525-GET-LF-BENEFIT
  6532         ELSE
  6533             MOVE ZEROS              TO  WS-CF-DEFAULT-APR
  6534             GO TO 0525-GET-LF-BENEFIT.
  6535
  6536     MOVE -1                     TO  HLCANCL.
  6537     MOVE AL-SANON               TO  HLCANCA.
  6538     MOVE ER-2616                TO  EMI-ERROR.
  6539
  6540     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6541
  6542     GO TO 8100-SEND-INITIAL-MAP.
  6543
  6544 0525-GET-LF-BENEFIT.
  6545
  6546     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  6547        GO TO 0527-GET-AH-BENEFIT
  6548     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 120
* EL1278.cbl
  6549
  6550     MOVE '4'                    TO  WS-CF-RECORD-TYPE.
  6551     MOVE CM-LF-BENEFIT-CD       TO  WS-BENEFIT-NO
  6552                                     HLCDO.
  6553     MOVE WS-CF-LIFE-OVERRIDE-L2
  6554                                 TO  HLKINDO.
  6555
  6556     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6557
  6558     IF BENEFIT-FOUND
  6559         NEXT SENTENCE
  6560     ELSE
  6561         MOVE -1                 TO  HLCDL
  6562         MOVE AL-SANON           TO  HLCDA
  6563         MOVE ER-0028            TO  EMI-ERROR
  6564         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6565         GO TO 8100-SEND-INITIAL-MAP.
  6566
  6567     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6568         MOVE AL-UNNOF           TO  HLTERMA.
  6569
  6570*****MOVE WS-BENEFIT-DESCRIP     TO  HLDESCO.
  6571     MOVE WS-KIND                TO WS-LF-KIND
  6572     MOVE CF-LF-COVERAGE-TYPE (WS-INDEX)
  6573                                 TO  WS-CF-LF-COVERAGE-TYPE.
  6574
  6575     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6576         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6577                                 TO  WS-LF-CO-REM-TERM-CALC.
  6578
  6579     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6580         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6581                                 TO  WS-LF-CO-EARNINGS-CALC
  6582                                     WS-LF-CO-REFUND-CALC.
  6583
  6584     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6585         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6586                                 TO  WS-LF-SPECIAL-CALC-CD.
  6587
  6588     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6589         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6590                                 TO  WS-LF-CO-REFUND-CALC.
  6591
  6592 0527-GET-AH-BENEFIT.
  6593
  6594     IF CM-AH-BENEFIT-CD = '00' OR '  '
  6595        GO TO 0530-GET-STATE-RECORD
  6596     END-IF
  6597
  6598     MOVE '5'                    TO  WS-CF-RECORD-TYPE.
  6599     MOVE CM-AH-BENEFIT-CD       TO  WS-BENEFIT-NO
  6600                                     HACDO.
  6601     MOVE WS-CF-AH-OVERRIDE-L2   TO  HAKINDO.
  6602
  6603     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6604
  6605     IF BENEFIT-FOUND
  6606         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 121
* EL1278.cbl
  6607     ELSE
  6608         MOVE -1                 TO  HACDL
  6609         MOVE AL-SANON           TO  HACDA
  6610         MOVE ER-0028            TO  EMI-ERROR
  6611         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6612         GO TO 8100-SEND-INITIAL-MAP.
  6613
  6614     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6615         MOVE AL-UNNOF           TO  HATERMA.
  6616
  6617*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  6618     MOVE WS-KIND                TO  WS-AH-KIND
  6619
  6620     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6621         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6622                                 TO  WS-AH-CO-REM-TERM-CALC.
  6623
  6624     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6625         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6626                                 TO  WS-AH-CO-EARNINGS-CALC
  6627                                     WS-AH-CO-REFUND-CALC.
  6628
  6629     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6630         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6631                                 TO  WS-AH-SPECIAL-CALC-CD.
  6632
  6633     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6634         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6635                                 TO  WS-AH-CO-REFUND-CALC.
  6636     IF CF-BENEFIT-CATEGORY (WS-INDEX) > ' '
  6637        MOVE CF-BENEFIT-CATEGORY (WS-INDEX)
  6638                                 TO WS-AH-BEN-CATEGORY
  6639     END-IF
  6640     .
  6641 0530-GET-STATE-RECORD.
  6642     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6643     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  6644     MOVE CM-STATE               TO  WS-CF-ACCESS.
  6645     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6646
  6647     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6648
  6649     IF CNTL-NOT-FOUND
  6650         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6651                                     WS-LF-ST-REM-TERM-CALC
  6652         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6653         GO TO 0560-FIND-ACCOUNT.
  6654
  6655     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6656       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6657       AND CM-STATE  IS EQUAL TO  CF-STATE-CODE
  6658         MOVE 'Y'                TO  WS-STATE-RECORD-SW
  6659     ELSE
  6660         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6661                                     WS-LF-ST-REM-TERM-CALC
  6662         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6663         GO TO 0560-FIND-ACCOUNT.
  6664
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 122
* EL1278.cbl
  6665     MOVE CF-STATE-ABBREVIATION  TO  WS-STATE-ABBREVIATION.
  6666     MOVE CF-ST-FST-PMT-DAYS-CHG TO  WS-STATE-EXT-DAYS-CHG
  6667
  6668     IF CM-LF-BENEFIT-CD  = '00'
  6669         GO TO 0550-GET-AH-BEN-IN-STATE.
  6670
  6671 0540-GET-LF-BEN-IN-STATE.
  6672     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  6673     MOVE PI-LIFE-OVERRIDE-L1    TO  WS-LOOKUP-TYPE.
  6674
  6675     MOVE '0'                    TO WS-LF-ST-REM-TERM-CALC
  6676     IF CF-ST-RT-CALC NOT = SPACES
  6677        MOVE CF-ST-RT-CALC       TO WS-LF-ST-REM-TERM-CALC
  6678     END-IF
  6679
  6680     IF WS-CF-LF-COVERAGE-TYPE = 'R'
  6681        IF CF-ST-RF-LR-CALC > '0'
  6682           MOVE CF-ST-RF-LR-CALC TO WS-LF-ST-REFUND-CALC
  6683        END-IF
  6684        IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  6685           IF CF-ST-RF-LN-CALC > '0'
  6686              MOVE CF-ST-RF-LN-CALC
  6687                                 TO WS-LF-ST-REFUND-CALC
  6688           END-IF
  6689        END-IF
  6690     ELSE
  6691        IF CF-ST-RF-LL-CALC > '0'
  6692           MOVE CF-ST-RF-LL-CALC TO WS-LF-ST-REFUND-CALC
  6693        END-IF
  6694     END-IF
  6695
  6696     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6697
  6698     IF NO-BENEFIT-FOUND
  6699*        MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6700         GO TO 0550-GET-AH-BEN-IN-STATE.
  6701
  6702     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6703         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6704                                 TO  WS-LF-ST-REM-TERM-CALC.
  6705
  6706     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6707         MOVE CF-ST-REFUND-CALC (SUB3)
  6708                                 TO  WS-LF-ST-REFUND-CALC.
  6709
  6710 0550-GET-AH-BEN-IN-STATE.
  6711     IF CM-AH-BENEFIT-CD  = '00'
  6712         GO TO 0560-FIND-ACCOUNT.
  6713
  6714     MOVE '0'                    TO WS-AH-ST-REM-TERM-CALC
  6715     IF CF-ST-RT-CALC NOT = SPACES
  6716        MOVE CF-ST-RT-CALC       TO WS-AH-ST-REM-TERM-CALC
  6717     END-IF
  6718
  6719     IF CF-ST-RF-AH-CALC > '0'
  6720        MOVE CF-ST-RF-AH-CALC    TO WS-AH-ST-REFUND-CALC
  6721     END-IF
  6722     IF WS-AH-SPECIAL-CALC-CD = 'C'
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 123
* EL1278.cbl
  6723        IF CF-ST-RF-CP-CALC > '0'
  6724           MOVE CF-ST-RF-CP-CALC TO WS-AH-ST-REFUND-CALC
  6725        END-IF
  6726     END-IF
  6727
  6728     MOVE CM-AH-BENEFIT-CD       TO  WS-BEN-CD.
  6729     MOVE PI-AH-OVERRIDE-L1      TO  WS-LOOKUP-TYPE.
  6730
  6731     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6732
  6733     IF NO-BENEFIT-FOUND
  6734*        MOVE '0'                TO  WS-AH-ST-REFUND-CALC
  6735         GO TO 0560-FIND-ACCOUNT.
  6736
  6737     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6738         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6739                                 TO  WS-AH-ST-REM-TERM-CALC.
  6740
  6741     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6742         MOVE CF-ST-REFUND-CALC (SUB3)
  6743                                 TO  WS-AH-ST-REFUND-CALC.
  6744
  6745 0560-FIND-ACCOUNT.
  6746     MOVE CM-COMPANY-CD          TO  WS-AM-COMPANY-CD.
  6747     MOVE CM-CARRIER             TO  WS-AM-CARRIER.
  6748     MOVE CM-GROUPING            TO  WS-AM-GROUPING.
  6749     MOVE CM-STATE               TO  WS-AM-STATE.
  6750     MOVE CM-ACCOUNT             TO  WS-AM-ACCOUNT.
  6751     MOVE CM-CERT-EFF-DT         TO  WS-AM-EXPIRATION-DT.
  6752     MOVE LOW-VALUES             TO  WS-AM-FILLER.
  6753
  6754     PERFORM 1200-START-ACCOUNT-MASTER  THRU  1299-EXIT.
  6755
  6756     IF ACCT-FOUND
  6757         NEXT SENTENCE
  6758     ELSE
  6759         GO TO 0585-NO-ACCT.
  6760
  6761 0570-READ-NEXT-RANGE.
  6762     PERFORM 1300-READ-ACCOUNT-MASTER  THRU  1399-EXIT.
  6763
  6764     IF ACCT-FOUND
  6765         NEXT SENTENCE
  6766     ELSE
  6767         GO TO 0580-ACCT-NOT-FOUND.
  6768
  6769     IF CM-COMPANY-CD  IS EQUAL TO  AM-COMPANY-CD
  6770       AND CM-CARRIER  IS EQUAL TO  AM-CARRIER
  6771       AND CM-GROUPING  IS EQUAL TO  AM-GROUPING
  6772       AND CM-STATE  IS EQUAL TO  AM-STATE
  6773       AND CM-ACCOUNT  IS EQUAL TO  AM-ACCOUNT
  6774         NEXT SENTENCE
  6775     ELSE
  6776         GO TO 0580-ACCT-NOT-FOUND.
  6777
  6778     MOVE 'X'                    TO  DATE-RANGE-SW.
  6779
  6780     IF CM-CERT-EFF-DT  IS LESS THAN  AM-EFFECTIVE-DT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 124
* EL1278.cbl
  6781         MOVE 'X'                TO  DATE-RANGE-SW
  6782         GO TO 0580-ACCT-NOT-FOUND.
  6783
  6784     IF CM-CERT-EFF-DT  IS NOT LESS THAN  AM-EXPIRATION-DT
  6785         GO TO 0570-READ-NEXT-RANGE.
  6786
  6787     IF WS-BROWSE-STARTED-SW = 'Y'
  6788
  6789* EXEC CICS ENDBR
  6790*          DATASET    ('ERACCT')
  6791*       END-EXEC
  6792     MOVE 'ERACCT' TO DFHEIV1
  6793     MOVE 0
  6794       TO DFHEIV11
  6795*    MOVE '&2                    $   #00006660' TO DFHEIV0
  6796     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6797     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6798     MOVE X'2020233030303036363630' TO DFHEIV0(25:11)
  6799     CALL 'kxdfhei1' USING DFHEIV0,
  6800           DFHEIV1,
  6801           DFHEIV11,
  6802           DFHEIV99
  6803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6804        MOVE SPACES             TO  WS-BROWSE-STARTED-SW
  6805     END-IF
  6806     MOVE ' '                    TO  DATE-RANGE-SW.
  6807     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  6808
  6809     GO TO 0590-SET-ACCOUNT.
  6810
  6811 0580-ACCT-NOT-FOUND.
  6812     IF DATE-RANGE-SW  IS NOT EQUAL TO  SPACES
  6813         MOVE ER-2601            TO  EMI-ERROR
  6814     ELSE
  6815         MOVE ER-2619            TO  EMI-ERROR.
  6816
  6817     MOVE 'N'                    TO  WS-ACCT-RECORD-SW.
  6818
  6819     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6820
  6821 0585-NO-ACCT.
  6822     MOVE SPACES                 TO  WS-ACCT-USER-FLD-5.
  6823     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  6824                                     WS-AM-EARN-METHOD-R
  6825                                     WS-AM-EARN-METHOD-A
  6826                                     WS-LF-AM-REM-TERM-CALC
  6827                                     WS-AH-AM-REM-TERM-CALC.
  6828
  6829     GO TO 0600-CHECK-FOR-LIFE.
  6830
  6831 0590-SET-ACCOUNT.
  6832******************************************************************
  6833******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  6834******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  6835******* METHODS.
  6836******************************************************************
  6837     MOVE SPACES              TO WS-LF-FO-REFUND-CALC.
  6838     MOVE SPACES              TO WS-AH-FO-REFUND-CALC.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 125
* EL1278.cbl
  6839     IF PI-COMPANY-ID EQUAL TO 'NCL'
  6840          IF ((CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  6841                 OR (CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  6842                  PERFORM 7000-GET-ERFORM THRU 7000-EXIT
  6843                  IF FORM-FOUND
  6844                      PERFORM 7100-BENEFIT-SEARCH THRU 7100-EXIT.
  6845******************************************************************
  6846
  6847     MOVE AM-FLD-5               TO  WS-ACCT-USER-FLD-5.
  6848     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  6849                                     WS-AM-EARN-METHOD-R
  6850                                     WS-AM-EARN-METHOD-A.
  6851
  6852*    EVALUATE AM-EARN-METHOD-R
  6853*       WHEN 'R'
  6854*           MOVE '1'                TO  WS-AM-EARN-METHOD-R
  6855*       WHEN 'P'
  6856*           MOVE '2'                TO  WS-AM-EARN-METHOD-R
  6857*       WHEN 'C'
  6858*           MOVE '3'                TO  WS-AM-EARN-METHOD-R
  6859*       WHEN 'A'
  6860*           MOVE '6'                TO  WS-AM-EARN-METHOD-R
  6861*       WHEN 'M'
  6862*           MOVE '8'                TO  WS-AM-EARN-METHOD-R
  6863*       WHEN 'S'
  6864*           MOVE '9'                TO  WS-AM-EARN-METHOD-R
  6865*    END-EVALUATE.
  6866
  6867*    EVALUATE AM-EARN-METHOD-L
  6868*       WHEN 'R'
  6869*           MOVE '1'                TO  WS-AM-EARN-METHOD-L
  6870*       WHEN 'P'
  6871*           MOVE '2'                TO  WS-AM-EARN-METHOD-L
  6872*       WHEN 'C'
  6873*           MOVE '3'                TO  WS-AM-EARN-METHOD-L
  6874*       WHEN 'A'
  6875*           MOVE '6'                TO  WS-AM-EARN-METHOD-L
  6876*       WHEN 'M'
  6877*           MOVE '8'                 TO  WS-AM-EARN-METHOD-L
  6878*       WHEN 'S'
  6879*           MOVE '9'                 TO  WS-AM-EARN-METHOD-L
  6880*    END-EVALUATE.
  6881
  6882*    EVALUATE AM-EARN-METHOD-A
  6883*       WHEN 'R'
  6884*           MOVE '1'                TO  WS-AM-EARN-METHOD-A
  6885*       WHEN 'P'
  6886*           MOVE '2'                TO  WS-AM-EARN-METHOD-A
  6887*       WHEN 'C'
  6888*           MOVE '3'                TO  WS-AM-EARN-METHOD-A
  6889*       WHEN 'A'
  6890*           MOVE '6'                TO  WS-AM-EARN-METHOD-A
  6891*       WHEN 'M'
  6892*           MOVE '8'                TO  WS-AM-EARN-METHOD-A
  6893*       WHEN 'N'
  6894*           MOVE '5'                TO  WS-AM-EARN-METHOD-A
  6895*       WHEN 'S'
  6896*           MOVE '9'                TO  WS-AM-EARN-METHOD-A
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 126
* EL1278.cbl
  6897*    END-EVALUATE.
  6898
  6899     MOVE ZEROS                  TO  WS-TOT-AH-PREM
  6900                                     WS-TOT-LF-PREM
  6901                                     WS-TOT-AH-RFND
  6902                                     WS-TOT-LF-RFND.
  6903
  6904 0600-CHECK-FOR-LIFE.
  6905     IF CM-LF-BENEFIT-CD  = '00'
  6906         GO TO 0640-AH-BENEFIT.
  6907
  6908 0610-GET-LIFE-BENEFIT.
  6909
  6910     IF ACCT-FOUND
  6911         MOVE +1                 TO SUB3
  6912         PERFORM 5000-GET-LF-AM-REM-TERM THRU 5900-EXIT.
  6913     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  6914     MOVE WS-LF-KIND             TO  HLEDESCO.
  6915     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  6916     IF WS-LF-CO-EARNINGS-CALC = 'B'
  6917        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  6918                             + CM-LF-ALT-PREMIUM-AMT
  6919     ELSE
  6920        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  6921     END-IF
  6922
  6923     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  6924     EVALUATE TRUE
  6925        WHEN ((OPEN-LF-CLAIM)
  6926           OR (CLOSED-LF-CLAIM))
  6927           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  6928           MOVE ZEROS            TO HLREFNDO  WS-CALC-REFUND
  6929                                    WS-TOT-LF-RFND
  6930                                    PI-LF-REFUND-AMT
  6931           IF CM-AH-BENEFIT-CD NOT = '00'
  6932              MOVE ZEROS         TO HAREFNDO
  6933                                    WS-TOT-AH-RFND
  6934                                    PI-AH-REFUND-AMT
  6935              MOVE SPACES        TO PI-AH-REFUND-METH
  6936           END-IF
  6937           MOVE ER-2965          TO EMI-ERROR
  6938           PERFORM 9700-ERROR-FORMAT
  6939                                 THRU  9799-EXIT
  6940           GO TO 0640-AH-BENEFIT
  6941        WHEN OPEN-LF-CLAIM
  6942           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6943           AND WS-ST-REF-IND = '4'
  6944           MOVE ER-2966          TO EMI-ERROR
  6945           PERFORM 9700-ERROR-FORMAT
  6946                                 THRU  9799-EXIT
  6947        WHEN OPEN-LF-CLAIM
  6948           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6949           AND WS-ST-REF-IND NOT = '4'
  6950           MOVE ER-2967          TO EMI-ERROR
  6951           PERFORM 9700-ERROR-FORMAT
  6952                                 THRU  9799-EXIT
  6953           GO TO 0640-AH-BENEFIT
  6954        WHEN CLOSED-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 127
* EL1278.cbl
  6955           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6956           AND WS-ST-REF-IND = '4'
  6957           MOVE ER-2968          TO EMI-ERROR
  6958           PERFORM 9700-ERROR-FORMAT
  6959                                 THRU  9799-EXIT
  6960        WHEN CLOSED-LF-CLAIM
  6961           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6962           AND WS-ST-REF-IND NOT = '4'
  6963           MOVE ER-2969          TO EMI-ERROR
  6964           PERFORM 9700-ERROR-FORMAT
  6965                                 THRU  9799-EXIT
  6966           GO TO 0640-AH-BENEFIT
  6967        WHEN OTHER
  6968           CONTINUE
  6969     END-EVALUATE
  6970     .
  6971 0620-GET-REM-TERM.
  6972     MOVE WS-CF-LIFE-OVERRIDE-L1
  6973                                 TO  CP-LIFE-OVERRIDE-CODE.
  6974     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  6975     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  6976     MOVE WS-LF-CANCEL-DATE      TO  CP-VALUATION-DT.
  6977     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  6978     MOVE CM-STATE               TO  CP-STATE.
  6979     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  6980     MOVE WS-CF-LF-COVERAGE-TYPE
  6981                                 TO  CP-BENEFIT-TYPE.
  6982     MOVE WS-LF-KIND             TO  HLEDESCO.
  6983     MOVE WS-LF-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  6984     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  6985     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  6986     MOVE '2'                    TO  CP-PROCESS-TYPE.
  6987     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  6988     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  6989     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  6990     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  6991     MOVE WS-CF-CR-REM-TERM-CALC
  6992                                 TO  CP-REM-TERM-METHOD.
  6993
  6994     IF WS-LF-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  6995         MOVE WS-LF-CO-REM-TERM-CALC
  6996                                 TO  CP-REM-TERM-METHOD.
  6997
  6998     IF WS-LF-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  6999         MOVE WS-LF-ST-REM-TERM-CALC
  7000                                 TO  CP-REM-TERM-METHOD.
  7001
  7002     IF WS-LF-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  7003         MOVE WS-LF-AM-REM-TERM-CALC
  7004                                 TO  CP-REM-TERM-METHOD.
  7005
  7006     IF (PI-COMPANY-ID = 'CID')
  7007        AND (CP-STATE-STD-ABBRV = 'WI')
  7008        MOVE '7'                 TO CP-REM-TERM-METHOD
  7009        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7010     END-IF
  7011     IF (PI-COMPANY-ID = 'CID')
  7012        AND (CP-STATE-STD-ABBRV = 'MO')
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 128
* EL1278.cbl
  7013        AND (CM-CERT-EFF-DT >= X'9B41')
  7014        AND (CM-CERT-EFF-DT <= X'A2FB')
  7015        MOVE '7'                 TO CP-REM-TERM-METHOD
  7016        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7017     END-IF
  7018     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  7019                                     CP-ORIGINAL-TERM
  7020                                     CP-LOAN-TERM.
  7021
  7022     IF CP-TRUNCATED-LIFE
  7023         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  7024
  7025     IF CP-TERM-IS-DAYS
  7026         IF CM-LF-TERM-IN-DAYS  IS NUMERIC
  7027             MOVE CM-LF-TERM-IN-DAYS
  7028                                 TO  CP-TERM-OR-EXT-DAYS
  7029         ELSE
  7030             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS
  7031     ELSE
  7032         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  7033             MOVE CM-PMT-EXTENSION-DAYS
  7034                                 TO  CP-TERM-OR-EXT-DAYS
  7035         ELSE
  7036             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  7037
  7038*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  7039     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  7040     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  7041     MOVE CM-STATE               TO  WS-CF-ACCESS.
  7042     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  7043
  7044
  7045* EXEC CICS READ
  7046*        DATASET  (ELCNTL-ID)
  7047*        SET      (ADDRESS OF CONTROL-FILE)
  7048*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  7049*        RESP     (WS-RESPONSE)
  7050*    END-EXEC.
  7051*    MOVE '&"S        E          (  N#00006903' TO DFHEIV0
  7052     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7053     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7054     MOVE X'204E233030303036393033' TO DFHEIV0(25:11)
  7055     CALL 'kxdfhei1' USING DFHEIV0,
  7056           ELCNTL-ID,
  7057           DFHEIV20,
  7058           DFHEIV99,
  7059           WS-CF-CONTROL-PRIMARY,
  7060           DFHEIV99,
  7061           DFHEIV99,
  7062           DFHEIV99
  7063     SET ADDRESS OF CONTROL-FILE TO
  7064         DFHEIV20
  7065     MOVE EIBRESP  TO WS-RESPONSE
  7066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7067
  7068
  7069     IF WS-RESP-NOTOPEN
  7070         MOVE ER-2617            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 129
* EL1278.cbl
  7071         GO TO 0320-INPUT-ERROR.
  7072
  7073     IF WS-RESP-NOTFND
  7074         MOVE ZERO               TO  CP-FREE-LOOK
  7075     ELSE
  7076         MOVE CF-ST-FREE-LOOK-PERIOD
  7077                                 TO CP-FREE-LOOK.
  7078
  7079     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7080        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7081        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  7082     END-IF
  7083
  7084     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  7085
  7086     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7087        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7088        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  7089        COMPUTE CP-REMAINING-TERM-1 =
  7090                CP-REMAINING-TERM-1 - +1
  7091        COMPUTE CP-REMAINING-TERM-2 =
  7092                CP-REMAINING-TERM-2 - +1
  7093     END-IF
  7094
  7095     IF CP-REMAINING-TERM-1 NEGATIVE
  7096        MOVE ZEROS               TO CP-REMAINING-TERM-1
  7097     END-IF
  7098     IF CP-REMAINING-TERM-2 NEGATIVE
  7099        MOVE ZEROS               TO CP-REMAINING-TERM-2
  7100     END-IF
  7101     MOVE CP-REMAINING-TERM-1    TO  HLREMO.
  7102
  7103     IF PI-LF-CANCEL-DATE = LOW-VALUES
  7104         GO TO 0640-AH-BENEFIT.
  7105*    IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-LF-ORIG-TERM
  7106*        MOVE CM-LF-ORIG-TERM    TO  HLREMO.
  7107
  7108     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '8'
  7109         IF CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7110             MOVE ER-0681        TO  EMI-ERROR
  7111             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7112
  7113     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '7'
  7114         IF CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES
  7115             MOVE ER-0682        TO  EMI-ERROR
  7116             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7117
  7118 0630-CONTINUE-LIFE.
  7119
  7120     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7121        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7122        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7123                                    FREMTRMO
  7124     ELSE
  7125        MOVE CP-REMAINING-TERM-2 TO  CP-REMAINING-TERM
  7126                                     FREMTRMO
  7127     END-IF
  7128     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 130
* EL1278.cbl
  7129     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  7130     if pi-company-id = 'AHL'
  7131        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7132        if cp-class-code = spaces
  7133           move zeros            to cp-class-code
  7134        end-if
  7135     ELSE
  7136        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7137     END-IF
  7138     IF (PI-COMPANY-ID = 'DCC')
  7139        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  7140        MOVE ' '                 TO WS-PDEF-RECORD-SW
  7141        PERFORM 0730-GET-DDF-FACTORS
  7142                                 THRU 0730-EXIT
  7143        IF PDEF-FOUND
  7144           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7145              (P1 > +8)
  7146              OR (PD-PROD-CODE (P1) = 'L')
  7147           END-PERFORM
  7148           IF P1 < +9
  7149              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  7150           END-IF
  7151        END-IF
  7152     END-IF
  7153     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT.
  7154
  7155     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
  7156
  7157     IF WS-LF-CO-EARNINGS-CALC = 'B'
  7158        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  7159                             + CM-LF-ALT-PREMIUM-AMT
  7160     ELSE
  7161        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  7162     END-IF
  7163
  7164     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  7165                                     WS-TOT-LF-PREM.
  7166
  7167     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7168        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7169        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7170     ELSE
  7171        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  7172     END-IF
  7173
  7174     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7175     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7176
  7177     IF WS-LF-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7178         MOVE WS-LF-ST-REFUND-CALC
  7179                                 TO  CP-EARNING-METHOD.
  7180
  7181     IF WS-LF-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7182         MOVE WS-LF-FO-REFUND-CALC
  7183                                 TO  CP-EARNING-METHOD.
  7184
  7185     if (pi-company-id = 'CID')
  7186        and (cp-state-std-abbrv = 'MN' OR 'WA')
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 131
* EL1278.cbl
  7187        continue
  7188     else
  7189        IF CP-RATING-METHOD = '4'
  7190           MOVE '4'              TO CP-EARNING-METHOD
  7191        END-IF
  7192     end-if
  7193*    IF WS-CF-LF-COVERAGE-TYPE = 'R'
  7194*        IF WS-AM-EARN-METHOD-R  IS GREATER THAN  ZERO
  7195*            MOVE WS-AM-EARN-METHOD-R
  7196*                                TO  CP-EARNING-METHOD
  7197*        END-IF
  7198*    ELSE
  7199*        IF WS-AM-EARN-METHOD-L  IS GREATER THAN  ZERO
  7200*            MOVE WS-AM-EARN-METHOD-L
  7201*                                TO  CP-EARNING-METHOD.
  7202
  7203     if pi-company-id = 'AHL'
  7204        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7205        if cp-class-code = spaces
  7206           move zeros            to cp-class-code
  7207        end-if
  7208     ELSE
  7209        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7210     END-IF
  7211     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7212     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7213                                     CP-RATING-BENEFIT-AMT.
  7214     IF CP-STATE-STD-ABBRV = 'OR'
  7215         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7216                                         CM-LF-ALT-BENEFIT-AMT.
  7217****   N O T E   ****
  7218*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  7219*      THE OH HARD CODING IN ELCRFNDP
  7220
  7221     IF PI-COMPANY-ID = 'CID'
  7222        IF CP-STATE-STD-ABBRV = 'OH'
  7223           MOVE WS-LF-CO-EARNINGS-CALC
  7224                                 TO CP-EARNING-METHOD
  7225        END-IF
  7226     END-IF
  7227
  7228****   N O T E   ****
  7229
  7230****   MN   NOTE  ****  CID HAS THE STATE REFUND METHOD SET AS
  7231****      R78 BUT THEY WANT THE BALLOONS REFUNDED WITH A
  7232****      CUSTOM FORMULA THAT IS IN ELRFND SO I AM SETTING
  7233****     THE APPROPRIATE OPTIONS HERE
  7234*    IF PI-COMPANY-ID = 'CID'
  7235*       IF (CP-STATE-STD-ABBRV = 'MN')
  7236*          AND (CM-CERT-EFF-DT > X'A4FF')
  7237*          AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7238*          MOVE '5'              TO CP-EARNING-METHOD
  7239*       END-IF
  7240*    END-IF
  7241     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7242     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7243     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  7244     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 132
* EL1278.cbl
  7245     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7246     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7247
  7248*    IF CP-EARN-AS-NET-PAY
  7249*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7250*           IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7251*               MOVE WS-CF-DEFAULT-APR
  7252*                                TO  CP-LOAN-APR
  7253*               MOVE ER-3780     TO  EMI-ERROR
  7254*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7255*           ELSE
  7256*               MOVE ER-3781     TO  EMI-ERROR
  7257*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7258
  7259*    DISPLAY ' 1278 REM AMT      ' CP-REMAINING-BENEFIT
  7260*    DISPLAY ' 1278 REM TRM      ' CP-REMAINING-TERM
  7261*    DISPLAY ' 1278 EARN METH    ' CP-EARNING-METHOD
  7262*    DISPLAY ' 1278 RATE METH    ' CP-RATING-METHOD
  7263*    DISPLAY ' 1278 CLASS        ' CP-CLASS-CODE
  7264*    DISPLAY ' 1278 BENE CODE    ' CP-BENEFIT-CD
  7265*    DISPLAY ' 1278 ORIG BENE    ' CP-ORIGINAL-BENEFIT
  7266*    DISPLAY ' 1278 RATE BENE    ' CP-RATING-BENEFIT-AMT
  7267*    DISPLAY ' 1278 ORIG PREM    ' CP-ORIGINAL-PREMIUM
  7268*    DISPLAY ' 1278 ISS AGE      ' CP-ISSUE-AGE
  7269*    DISPLAY ' 1278 DEV CODE     ' CP-DEVIATION-CODE
  7270*    DISPLAY ' 1278 DEV PCT      ' CP-RATE-DEV-PCT
  7271*    DISPLAY ' 1278 APR          ' CP-LOAN-APR
  7272*    DISPLAY ' 1278 EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  7273*    DISPLAY ' 1278 LOAN TERM    ' CP-LOAN-TERM
  7274*    DISPLAY ' 1278 SPEC CALC    ' CP-SPECIAL-CALC-CD
  7275*    DISPLAY ' 1278 ST STD ABB   ' CP-STATE-STD-ABBRV
  7276     MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  7277     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7278
  7279     MOVE 'L'                    TO  WS-REFUND-SEARCH-SW.
  7280
  7281     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7282
  7283     IF CP-ERROR-RATE-IS-ZERO
  7284       OR CP-ERROR-RATE-NOT-FOUND
  7285         MOVE ER-2740            TO  EMI-ERROR
  7286         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7287
  7288     IF CP-ERROR-RATE-FILE-NOTOPEN
  7289         MOVE ER-2617            TO  EMI-ERROR
  7290         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7291
  7292     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7293     MOVE CP-CALC-REFUND         TO  HLREFNDO  WS-CALC-REFUND
  7294                                     WS-TOT-LF-RFND
  7295                                     PI-LF-REFUND-AMT.
  7296     MOVE CP-REMAINING-AMT       TO  HLREDO.
  7297
  7298     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  7299
  7300     IF WS-LF-CO-EARNINGS-CALC  IS NOT EQUAL TO  'B'
  7301         GO TO 0640-AH-BENEFIT.
  7302
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 133
* EL1278.cbl
  7303*    IF WS-LF-SPECIAL-CALC-CD = 'L'
  7304*        ADD +1                  TO  CP-REMAINING-TERM
  7305*                                    CP-ORIGINAL-TERM.
  7306
  7307     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  7308     MOVE '2'                    TO  CP-EARNING-METHOD
  7309                                     CP-RATING-METHOD.
  7310     IF PI-COMPANY-ID = 'CID'
  7311        IF (CP-STATE-STD-ABBRV = 'MN')
  7312           AND (CM-CERT-EFF-DT > X'A4FF')
  7313           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7314           MOVE '5'              TO CP-EARNING-METHOD
  7315           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  7316        END-IF
  7317     END-IF
  7318     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  7319                                     CP-REMAINING-BENEFIT
  7320                                     CP-RATING-BENEFIT-AMT.
  7321     IF CP-STATE-STD-ABBRV = 'OR'
  7322         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7323                                         CM-LF-ALT-BENEFIT-AMT.
  7324     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  7325     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  7326
  7327     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7328
  7329     IF CP-ERROR-RATE-IS-ZERO
  7330       OR CP-ERROR-RATE-NOT-FOUND
  7331         MOVE ER-2740            TO  EMI-ERROR
  7332         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7333
  7334     IF CP-ERROR-RATE-FILE-NOTOPEN
  7335         MOVE ER-2617            TO  EMI-ERROR
  7336         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7337
  7338     ADD CP-CALC-REFUND          TO  WS-CALC-REFUND.
  7339
  7340     MOVE WS-CALC-REFUND         TO  HLREFNDO
  7341                                     WS-TOT-LF-RFND
  7342                                     PI-LF-REFUND-AMT.
  7343
  7344     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  7345
  7346 0640-AH-BENEFIT.
  7347     IF CM-AH-BENEFIT-CD = '00'
  7348         GO TO 0680-CONTINUE.
  7349
  7350 0650-GET-AH-BENEFIT.
  7351     IF ACCT-FOUND
  7352         MOVE +1                 TO SUB3
  7353         PERFORM 6000-GET-AH-AM-REM-TERM THRU 6900-EXIT.
  7354     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7355     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7356     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7357     MOVE WS-AH-KIND             TO  HAEDESCO.
  7358     EVALUATE TRUE
  7359        WHEN ((OPEN-LF-CLAIM)
  7360           OR (CLOSED-LF-CLAIM))
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 134
* EL1278.cbl
  7361           AND (WS-AH-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7362           MOVE ZEROS            TO HAREFNDO  WS-CALC-REFUND
  7363                                    WS-TOT-AH-RFND
  7364                                    PI-AH-REFUND-AMT
  7365           MOVE SPACES           TO PI-AH-REFUND-METH
  7366           MOVE ER-2965          TO EMI-ERROR
  7367           PERFORM 9700-ERROR-FORMAT
  7368                                 THRU  9799-EXIT
  7369           GO TO 0680-CONTINUE
  7370        WHEN (CM-LF-BENEFIT-CD NOT = '00')
  7371           AND ((OPEN-LF-CLAIM) OR (CLOSED-LF-CLAIM))
  7372           AND (EMI-ERROR = ER-2965)
  7373           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7374           MOVE ZEROS            TO HAREFNDO
  7375                                    WS-TOT-AH-RFND
  7376                                    PI-AH-REFUND-AMT
  7377           MOVE SPACES           TO PI-AH-REFUND-METH
  7378           GO TO 0680-CONTINUE
  7379        WHEN (OPEN-AH-CLAIM)
  7380           AND (WS-ST-REF-IND = '1')
  7381           MOVE ZEROS            TO HAREFNDO
  7382                                    WS-TOT-AH-RFND
  7383                                    PI-AH-REFUND-AMT
  7384           MOVE ER-3039          TO EMI-ERROR
  7385           PERFORM 9700-ERROR-FORMAT
  7386                                 THRU  9799-EXIT
  7387           GO TO 0680-CONTINUE
  7388        WHEN (OPEN-AH-CLAIM)
  7389           AND (WS-ST-REF-IND = '2' OR '3' OR '4')
  7390           MOVE ER-3037          TO EMI-ERROR
  7391           PERFORM 9700-ERROR-FORMAT
  7392                                 THRU  9799-EXIT
  7393*          CONTINUE
  7394        WHEN (OPEN-AH-CLAIM)
  7395           AND (WS-ST-REF-IND = '5')
  7396           MOVE ER-3038          TO EMI-ERROR
  7397           PERFORM 9700-ERROR-FORMAT
  7398                                 THRU  9799-EXIT
  7399*          CONTINUE
  7400        WHEN (OPEN-AH-CLAIM)
  7401           AND (WS-ST-REF-IND = ' ')
  7402           MOVE ER-2768          TO EMI-ERROR
  7403           PERFORM 9700-ERROR-FORMAT
  7404                                 THRU  9799-EXIT
  7405        WHEN (CLOSED-AH-CLAIM)
  7406           AND (WS-AH-CANCEL-DATE <= WS-AH-PAID-THRU-DT)
  7407           MOVE ZEROS            TO HAREFNDO
  7408                                    WS-TOT-AH-RFND
  7409                                    PI-AH-REFUND-AMT
  7410           MOVE ER-2756          TO EMI-ERROR
  7411           PERFORM 9700-ERROR-FORMAT
  7412                                 THRU  9799-EXIT
  7413           IF WS-TOT-LF-RFND > 0
  7414              MOVE ZEROS         TO HLREFNDO
  7415                                    WS-TOT-LF-RFND
  7416                                    PI-LF-REFUND-AMT
  7417              MOVE SPACES        TO PI-LF-REFUND-METH
  7418           END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 135
* EL1278.cbl
  7419           GO TO 0680-CONTINUE
  7420*       WHEN OTHER
  7421*          CONTINUE
  7422     END-EVALUATE
  7423     .
  7424 0660-GET-REM-TERM.
  7425     MOVE WS-CF-AH-OVERRIDE-L1   TO  CP-AH-OVERRIDE-CODE.
  7426     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  7427     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  7428     MOVE WS-AH-CANCEL-DATE      TO  CP-VALUATION-DT.
  7429     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7430*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  7431     MOVE WS-AH-KIND             TO  HAEDESCO.
  7432     MOVE CM-STATE               TO  CP-STATE.
  7433     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  7434     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  7435     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  7436     MOVE '2'                    TO  CP-PROCESS-TYPE.
  7437     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  7438     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  7439     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  7440     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  7441     MOVE WS-CF-CR-REM-TERM-CALC
  7442                                 TO  CP-REM-TERM-METHOD.
  7443
  7444     IF WS-AH-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  7445         MOVE WS-AH-CO-REM-TERM-CALC
  7446                                 TO  CP-REM-TERM-METHOD.
  7447
  7448     IF WS-AH-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  7449         MOVE WS-AH-ST-REM-TERM-CALC
  7450                                 TO  CP-REM-TERM-METHOD.
  7451
  7452     IF WS-AH-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  7453         MOVE WS-AH-AM-REM-TERM-CALC
  7454                                 TO  CP-REM-TERM-METHOD.
  7455     IF (PI-COMPANY-ID = 'CID')
  7456        AND (CP-STATE-STD-ABBRV = 'WI')
  7457        MOVE '7'                 TO CP-REM-TERM-METHOD
  7458        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7459     END-IF
  7460     IF (PI-COMPANY-ID = 'CID')
  7461        AND (CP-STATE-STD-ABBRV = 'MO')
  7462        AND (CM-CERT-EFF-DT >= X'9B41')
  7463        AND (CM-CERT-EFF-DT <= X'A2FB')
  7464        MOVE '7'                 TO CP-REM-TERM-METHOD
  7465        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7466     END-IF
  7467
  7468     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7469                                     CP-ORIGINAL-TERM
  7470                                     CP-LOAN-TERM.
  7471
  7472     IF  NOT  CP-TERM-IS-DAYS
  7473         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  7474             MOVE CM-PMT-EXTENSION-DAYS
  7475                                 TO  CP-TERM-OR-EXT-DAYS
  7476         ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 136
* EL1278.cbl
  7477             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  7478
  7479*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  7480     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  7481     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  7482     MOVE CM-STATE               TO  WS-CF-ACCESS.
  7483     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  7484
  7485
  7486* EXEC CICS READ
  7487*        DATASET  (ELCNTL-ID)
  7488*        SET      (ADDRESS OF CONTROL-FILE)
  7489*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  7490*        RESP     (WS-RESPONSE)
  7491*    END-EXEC.
  7492*    MOVE '&"S        E          (  N#00007326' TO DFHEIV0
  7493     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7494     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7495     MOVE X'204E233030303037333236' TO DFHEIV0(25:11)
  7496     CALL 'kxdfhei1' USING DFHEIV0,
  7497           ELCNTL-ID,
  7498           DFHEIV20,
  7499           DFHEIV99,
  7500           WS-CF-CONTROL-PRIMARY,
  7501           DFHEIV99,
  7502           DFHEIV99,
  7503           DFHEIV99
  7504     SET ADDRESS OF CONTROL-FILE TO
  7505         DFHEIV20
  7506     MOVE EIBRESP  TO WS-RESPONSE
  7507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7508
  7509
  7510     IF WS-RESP-NOTOPEN
  7511         MOVE ER-2617            TO  EMI-ERROR
  7512         GO TO 0320-INPUT-ERROR.
  7513
  7514     IF WS-RESP-NOTFND
  7515         MOVE ZERO               TO CP-FREE-LOOK
  7516     ELSE
  7517         MOVE CF-ST-FREE-LOOK-PERIOD
  7518                                 TO CP-FREE-LOOK.
  7519
  7520     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  7521
  7522     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7523
  7524     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '8'
  7525         IF CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7526             MOVE ER-0683        TO  EMI-ERROR
  7527             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7528
  7529     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '6'  OR  '7'
  7530         IF CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES
  7531             MOVE ER-0684        TO  EMI-ERROR
  7532             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7533
  7534 0670-CONTINUE-AH.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 137
* EL1278.cbl
  7535     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7536                                     WS-TOT-AH-PREM.
  7537     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7538
  7539     IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-AH-ORIG-TERM
  7540         MOVE CM-AH-ORIG-TERM    TO  HAREMO.
  7541
  7542     IF PI-AH-CANCEL-DATE = LOW-VALUES
  7543        GO TO 0680-CONTINUE.
  7544     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM.
  7545     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7546     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7547
  7548     IF WS-AH-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7549         MOVE WS-AH-ST-REFUND-CALC
  7550                                 TO  CP-EARNING-METHOD.
  7551
  7552     IF WS-AH-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7553         MOVE WS-AH-FO-REFUND-CALC
  7554                                 TO  CP-EARNING-METHOD.
  7555
  7556*    IF WS-AM-EARN-METHOD-A  IS GREATER THAN  ZERO
  7557*        MOVE WS-AM-EARN-METHOD-A
  7558*                                TO  CP-EARNING-METHOD.
  7559
  7560     if pi-company-id = 'AHL'
  7561        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
  7562        if cp-class-code = spaces
  7563           move zeros            to cp-class-code
  7564        end-if
  7565     ELSE
  7566        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7567     END-IF
  7568     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7569     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7570                                     CP-RATING-BENEFIT-AMT.
  7571     IF CP-STATE-STD-ABBRV = 'OR'
  7572         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  7573                                         CM-AH-ORIG-TERM.
  7574     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7575     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  7576     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7577     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  7578     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  7579     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  7580
  7581     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7582     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  7583     MOVE ' '                    TO  DC-OPTION-CODE.
  7584
  7585     PERFORM 9600-DATE-LINK.
  7586
  7587     IF CP-STATE-STD-ABBRV = 'OH'
  7588        IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7589         IF (CP-ORIGINAL-TERM  IS GREATER THAN  60)
  7590           AND (DC-GREG-DATE-1-YMD  IS GREATER THAN  '831101')
  7591           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  7592             MOVE '6'            TO  CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 138
* EL1278.cbl
  7593         END-IF
  7594        END-IF
  7595        IF PI-COMPANY-ID = 'CID'
  7596           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  7597                           LOW-VALUES)
  7598              IF CP-CRITICAL-PERIOD
  7599                 MOVE '2'       TO CP-EARNING-METHOD
  7600              ELSE
  7601                 MOVE '6'       TO CP-EARNING-METHOD
  7602              END-IF
  7603           ELSE
  7604              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  7605                 MOVE '2'       TO CP-EARNING-METHOD
  7606              ELSE
  7607                 IF ((CM-LF-ORIG-TERM > 60) AND
  7608                    (CM-RATE-CLASS NOT = 'L '))
  7609                               OR
  7610                    (WS-LF-CO-EARNINGS-CALC = '5')
  7611                    IF CP-CRITICAL-PERIOD
  7612                       MOVE '2'  TO CP-EARNING-METHOD
  7613                    ELSE
  7614                       MOVE '6'  TO CP-EARNING-METHOD
  7615                    END-IF
  7616                 ELSE
  7617                    MOVE '1'     TO CP-EARNING-METHOD
  7618                 END-IF
  7619              END-IF
  7620           END-IF
  7621        END-IF
  7622     END-IF
  7623
  7624     IF CP-STATE-STD-ABBRV = 'VA'
  7625       IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7626         IF DC-GREG-DATE-1-YMD  IS GREATER THAN  '921231'
  7627            IF CP-ORIGINAL-TERM  IS GREATER THAN  61
  7628                MOVE '6'            TO  CP-EARNING-METHOD
  7629            ELSE
  7630                MOVE '1'            TO  CP-EARNING-METHOD.
  7631
  7632     IF CP-EARN-AS-NET-PAY
  7633         IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7634            IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7635                MOVE WS-CF-DEFAULT-APR
  7636                                 TO  CP-LOAN-APR
  7637                MOVE ER-3780     TO  EMI-ERROR
  7638                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7639            ELSE
  7640                MOVE ER-3781     TO  EMI-ERROR
  7641                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7642     IF PI-COMPANY-ID = 'DCC'
  7643        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  7644           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  7645           MOVE 'S'              TO CP-EARNING-METHOD
  7646        END-IF
  7647     END-IF
  7648     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7649     IF (PI-COMPANY-ID = 'DCC')
  7650        AND (CP-EARNING-METHOD = 'D')
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 139
* EL1278.cbl
  7651        MOVE +0                  TO WS-DDF-ADMIN-FEES
  7652                                    WS-DDF-CSO-ADMIN-FEE
  7653                                    WS-DDF-1ST-YR-TOT-EXP
  7654                                    WS-DDF-COMM-AND-MFEE
  7655        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  7656           S1 > +10
  7657           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  7658              IF (AM-A-COM (S1) NUMERIC)
  7659                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  7660                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  7661              ELSE
  7662                 MOVE +0         TO WS-COMM-PCT C0
  7663                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  7664                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  7665              END-IF
  7666              IF AM-COM-TYP (S1) = 'L' OR 'N'
  7667                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  7668                    + WS-COMM-PCT
  7669              END-IF
  7670              IF AM-COM-TYP (S1) = 'N'
  7671                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  7672                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  7673              END-IF
  7674              IF AM-COM-TYP (S1) = 'J' OR 'L'
  7675                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  7676                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  7677              END-IF
  7678              IF AM-COM-TYP (S1) = 'I'
  7679                 COMPUTE WS-DDF-COMM-AND-MFEE
  7680                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  7681              END-IF
  7682           END-IF
  7683        END-PERFORM
  7684        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  7685        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  7686        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  7687           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  7688     END-IF
  7689     IF (PI-COMPANY-ID = 'DCC')
  7690        AND (CP-EARNING-METHOD = 'D')
  7691        AND (PI-CANCEL-REASON NOT = 'R')
  7692        PERFORM 0730-GET-DDF-FACTORS
  7693                                 THRU 0730-EXIT
  7694        IF NOT PDEF-FOUND
  7695           MOVE ER-9999          TO EMI-ERROR
  7696           PERFORM 9700-ERROR-FORMAT
  7697                                 THRU 9799-EXIT
  7698           GO TO 8200-SEND-DATAONLY
  7699        END-IF
  7700        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  7701                                 TO CP-DDF-LO-FACT
  7702        MOVE PD-UEP-FACTOR (P1 P2)
  7703                                 TO CP-DDF-HI-FACT
  7704        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  7705        MOVE CM-AH-CLP           TO CP-DDF-CLP
  7706        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  7707        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  7708           + PD-1ST-YR-ADMIN-ALLOW
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 140
* EL1278.cbl
  7709        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  7710        IF PI-CLP-YN = 'Y'
  7711           MOVE 'C'              TO CP-DDF-SPEC-CALC
  7712           MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  7713                                    CP-DDF-CLP
  7714           MOVE ZEROS            TO CP-1ST-YR-ALLOW
  7715        END-IF
  7716        IF DD-IU-PRESENT
  7717           MOVE 'I'              TO CP-EARNING-METHOD
  7718        END-IF
  7719        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  7720                                    CP-CLP-RATE-UP
  7721        IF (CP-CALC-GROSS-FEE)
  7722           AND (CP-IU-RATE-UP NOT = ZEROS)
  7723           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  7724              / CP-ORIGINAL-PREMIUM)
  7725           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  7726              / (1 - TEX-FACT-8)
  7727        END-IF
  7728     END-IF
  7729     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT
  7730
  7731     MOVE ' '                    TO  WS-REFUND-SEARCH-SW.
  7732
  7733     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7734
  7735     IF CP-ERROR-RATE-IS-ZERO
  7736       OR CP-ERROR-RATE-NOT-FOUND
  7737         MOVE ER-2740            TO  EMI-ERROR
  7738         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7739
  7740     IF CP-ERROR-RATE-FILE-NOTOPEN
  7741         MOVE ER-2617            TO  EMI-ERROR
  7742         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7743
  7744     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7745     MOVE CP-CALC-REFUND         TO  HAREFNDO  WS-CALC-REFUND
  7746                                     WS-TOT-AH-RFND
  7747                                     PI-AH-REFUND-AMT.
  7748
  7749     MOVE CP-REFUND-TYPE-USED    TO  PI-AH-REFUND-METH.
  7750
  7751     MOVE AL-UANON               TO  HACANCA.
  7752
  7753 0680-CONTINUE.
  7754     IF BROWSE-STARTED
  7755         PERFORM 1500-END-BROWSE  THRU  1599-EXIT
  7756         MOVE SPACES             TO  WS-BROWSE-STARTED-SW.
  7757
  7758     IF CM-LF-BENEFIT-CD = '00'
  7759         MOVE -1                 TO  HACANCL
  7760     ELSE
  7761         MOVE -1                 TO  HLCANCL.
  7762
  7763     ADD WS-TOT-LF-PREM    WS-TOT-AH-PREM GIVING
  7764                           WS-TOT-PREM.
  7765     ADD WS-TOT-LF-RFND    WS-TOT-AH-RFND GIVING
  7766                           WS-TOT-RFND.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 141
* EL1278.cbl
  7767
  7768     MOVE WS-TOT-PREM            TO  TOPREMO.
  7769     MOVE WS-TOT-RFND            TO  TORFNDO.
  7770
  7771 0680-EXIT.
  7772     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 142
* EL1278.cbl
  7774 0700-LINK-REM-TERM SECTION.
  7775
  7776* EXEC CICS LINK
  7777*        PROGRAM   (ELRTRM-ID)
  7778*        COMMAREA  (CALCULATION-PASS-AREA)
  7779*        LENGTH    (CP-COMM-LENGTH)
  7780*    END-EXEC.
  7781*    MOVE '."C                   (   #00007598' TO DFHEIV0
  7782     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7783     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7784     MOVE X'2020233030303037353938' TO DFHEIV0(25:11)
  7785     CALL 'kxdfhei1' USING DFHEIV0,
  7786           ELRTRM-ID,
  7787           CALCULATION-PASS-AREA,
  7788           CP-COMM-LENGTH,
  7789           DFHEIV99,
  7790           DFHEIV99,
  7791           DFHEIV99,
  7792           DFHEIV99
  7793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7794
  7795
  7796 0700-EXIT.
  7797     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 143
* EL1278.cbl
  7799 0710-LINK-REM-AMOUNT SECTION.
  7800
  7801* EXEC CICS LINK
  7802*        PROGRAM   (ELRAMT-ID)
  7803*        COMMAREA  (CALCULATION-PASS-AREA)
  7804*        LENGTH    (CP-COMM-LENGTH)
  7805*    END-EXEC.
  7806*    MOVE '."C                   (   #00007608' TO DFHEIV0
  7807     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7808     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7809     MOVE X'2020233030303037363038' TO DFHEIV0(25:11)
  7810     CALL 'kxdfhei1' USING DFHEIV0,
  7811           ELRAMT-ID,
  7812           CALCULATION-PASS-AREA,
  7813           CP-COMM-LENGTH,
  7814           DFHEIV99,
  7815           DFHEIV99,
  7816           DFHEIV99,
  7817           DFHEIV99
  7818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7819
  7820
  7821 0710-EXIT.
  7822     EXIT.
  7823 0730-GET-DDF-FACTORS.
  7824     MOVE ' '                    TO WS-PDEF-RECORD-SW
  7825     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  7826     MOVE CM-STATE               TO ERPDEF-STATE
  7827     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  7828     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  7829     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  7830     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  7831     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  7832
  7833* EXEC CICS STARTBR
  7834*        DATASET  ('ERPDEF')
  7835*        RIDFLD   (ERPDEF-KEY)
  7836*        GTEQ
  7837*        RESP     (WS-RESPONSE)
  7838*    END-EXEC
  7839     MOVE 'ERPDEF' TO DFHEIV1
  7840     MOVE 0
  7841       TO DFHEIV11
  7842*    MOVE '&,         G          &  N#00007625' TO DFHEIV0
  7843     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7844     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7845     MOVE X'204E233030303037363235' TO DFHEIV0(25:11)
  7846     CALL 'kxdfhei1' USING DFHEIV0,
  7847           DFHEIV1,
  7848           ERPDEF-KEY,
  7849           DFHEIV99,
  7850           DFHEIV11,
  7851           DFHEIV99
  7852     MOVE EIBRESP  TO WS-RESPONSE
  7853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7854     IF NOT WS-RESP-NORMAL
  7855        GO TO 0730-EXIT
  7856     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 144
* EL1278.cbl
  7857     .
  7858 0730-READNEXT.
  7859
  7860* EXEC CICS READNEXT
  7861*       DATASET  ('ERPDEF')
  7862*       SET      (ADDRESS OF PRODUCT-MASTER)
  7863*       RIDFLD   (ERPDEF-KEY)
  7864*       RESP     (WS-RESPONSE)
  7865*    END-EXEC
  7866     MOVE 'ERPDEF' TO DFHEIV1
  7867     MOVE 0
  7868       TO DFHEIV11
  7869*    MOVE '&.S                   )  N#00007636' TO DFHEIV0
  7870     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7871     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7872     MOVE X'204E233030303037363336' TO DFHEIV0(25:11)
  7873     CALL 'kxdfhei1' USING DFHEIV0,
  7874           DFHEIV1,
  7875           DFHEIV20,
  7876           DFHEIV99,
  7877           ERPDEF-KEY,
  7878           DFHEIV99,
  7879           DFHEIV11,
  7880           DFHEIV99,
  7881           DFHEIV99
  7882     SET ADDRESS OF PRODUCT-MASTER TO
  7883         DFHEIV20
  7884     MOVE EIBRESP  TO WS-RESPONSE
  7885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7886     IF NOT WS-RESP-NORMAL
  7887        GO TO 0730-ENDBR
  7888     END-IF
  7889     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  7890        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  7891           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  7892        ELSE
  7893           GO TO 0730-READNEXT
  7894        END-IF
  7895     ELSE
  7896        GO TO 0730-ENDBR
  7897     END-IF
  7898     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7899        (P1 > +8)
  7900        OR (PD-PROD-CODE (P1) = 'I')
  7901     END-PERFORM
  7902     IF P1 < +9
  7903        SET DD-IU-PRESENT        TO TRUE
  7904     END-IF
  7905     IF CM-LOAN-TERM = ZEROS
  7906        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  7907     END-IF
  7908     IF PD-TRUNCATED = 'Y'
  7909        MOVE CM-LOAN-TERM        TO WS-TERM
  7910     ELSE
  7911        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  7912     END-IF
  7913     EVALUATE TRUE
  7914        WHEN WS-TERM > +168
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 145
* EL1278.cbl
  7915           MOVE 15               TO P1
  7916        WHEN WS-TERM > +156
  7917           MOVE 14               TO P1
  7918        WHEN WS-TERM > +144
  7919           MOVE 13               TO P1
  7920        WHEN WS-TERM > +132
  7921           MOVE 12               TO P1
  7922        WHEN WS-TERM > +120
  7923           MOVE 11               TO P1
  7924        WHEN WS-TERM > +108
  7925           MOVE 10               TO P1
  7926        WHEN WS-TERM > +96
  7927           MOVE 9                TO P1
  7928        WHEN WS-TERM > +84
  7929           MOVE 8                TO P1
  7930        WHEN WS-TERM > +72
  7931           MOVE 7                TO P1
  7932        WHEN WS-TERM > +60
  7933           MOVE 6                TO P1
  7934        WHEN WS-TERM > +48
  7935           MOVE 5                TO P1
  7936        WHEN WS-TERM > +36
  7937           MOVE 4                TO P1
  7938        WHEN WS-TERM > +24
  7939           MOVE 3                TO P1
  7940        WHEN WS-TERM > +12
  7941           MOVE 2                TO P1
  7942        WHEN OTHER
  7943           MOVE 1                TO P1
  7944     END-EVALUATE
  7945     EVALUATE TRUE
  7946*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  7947*          AND (DD-IU-PRESENT)
  7948*          MOVE 2                TO P2
  7949*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  7950*          MOVE 1                TO P2
  7951        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  7952           MOVE 2                TO P2
  7953        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  7954           MOVE 3                TO P2
  7955        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  7956           MOVE 4                TO P2
  7957        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  7958           MOVE 5                TO P2
  7959        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  7960           MOVE 6                TO P2
  7961        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  7962           MOVE 7                TO P2
  7963        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  7964           MOVE 8                TO P2
  7965        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  7966           MOVE 9                TO P2
  7967        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  7968           MOVE 10               TO P2
  7969        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  7970           MOVE 11               TO P2
  7971        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  7972           MOVE 12               TO P2
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 146
* EL1278.cbl
  7973        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  7974           MOVE 13               TO P2
  7975        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  7976           MOVE 14               TO P2
  7977        WHEN OTHER
  7978           MOVE 15               TO P2
  7979     END-EVALUATE
  7980     .
  7981 0730-ENDBR.
  7982
  7983* EXEC CICS ENDBR
  7984*       DATASET  ('ERPDEF')
  7985*    END-EXEC
  7986     MOVE 'ERPDEF' TO DFHEIV1
  7987     MOVE 0
  7988       TO DFHEIV11
  7989*    MOVE '&2                    $   #00007738' TO DFHEIV0
  7990     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7991     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7992     MOVE X'2020233030303037373338' TO DFHEIV0(25:11)
  7993     CALL 'kxdfhei1' USING DFHEIV0,
  7994           DFHEIV1,
  7995           DFHEIV11,
  7996           DFHEIV99
  7997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7998     .
  7999 0730-EXIT.
  8000     EXIT.
  8001 0740-GET-ERCTBL.
  8002     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  8003     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  8004     MOVE 'A'                    TO CTBL-BEN-TYPE
  8005     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  8006     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  8007     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  8008     IF WS-RESP-NORMAL
  8009        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  8010     ELSE
  8011        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  8012        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  8013        MOVE 'A'                    TO CTBL-BEN-TYPE
  8014        MOVE 'AA'                   TO CTBL-BEN-CODE
  8015        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  8016        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  8017        IF WS-RESP-NORMAL
  8018           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  8019        END-IF
  8020     END-IF
  8021     .
  8022 0740-EXIT.
  8023     EXIT.
  8024 0750-READ-ERCTBL.
  8025
  8026* EXEC CICS READ
  8027*         INTO    (COMM-TABLE-RECORD)
  8028*         DATASET ('ERCTBL')
  8029*         RIDFLD  (CTBL-KEY)
  8030*         RESP    (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 147
* EL1278.cbl
  8031*    END-EXEC
  8032     MOVE LENGTH OF
  8033      COMM-TABLE-RECORD
  8034       TO DFHEIV11
  8035     MOVE 'ERCTBL' TO DFHEIV1
  8036*    MOVE '&"IL       E          (  N#00007768' TO DFHEIV0
  8037     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8038     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8039     MOVE X'204E233030303037373638' TO DFHEIV0(25:11)
  8040     CALL 'kxdfhei1' USING DFHEIV0,
  8041           DFHEIV1,
  8042           COMM-TABLE-RECORD,
  8043           DFHEIV11,
  8044           CTBL-KEY,
  8045           DFHEIV99,
  8046           DFHEIV99,
  8047           DFHEIV99
  8048     MOVE EIBRESP  TO WS-RESPONSE
  8049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8050     .
  8051 0750-EXIT.
  8052     EXIT.
  8053 0760-FIND-COMM.
  8054     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  8055        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  8056        OR (C1 > +3)
  8057     END-PERFORM
  8058     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  8059        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  8060        OR (C2 > +3)
  8061     END-PERFORM
  8062     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  8063        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  8064        OR (C3 > +3)
  8065     END-PERFORM
  8066     IF C1 > +3
  8067        MOVE +1                  TO C1
  8068     END-IF
  8069     IF C2 > +3
  8070        MOVE +1                  TO C2
  8071     END-IF
  8072     IF C3 > +3
  8073        MOVE +1                  TO C3
  8074     END-IF
  8075     IF C1 = +3
  8076        MOVE +18                 TO C0
  8077     ELSE
  8078        IF C1 = +2
  8079           MOVE +9               TO C0
  8080        END-IF
  8081     END-IF
  8082     IF C2 = +3
  8083        ADD +6                   TO C0
  8084     ELSE
  8085        IF C2 = +2
  8086           ADD +3                TO C0
  8087        END-IF
  8088     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 148
* EL1278.cbl
  8089     ADD C3                      TO C0
  8090     MOVE CT-RT (C0)             TO WS-COMM-PCT
  8091     .
  8092 0760-EXIT.
  8093     EXIT.
  8094 0800-LINK-REFUND SECTION.
  8095     IF CP-AH
  8096       IF PI-EARNING-METHOD-AH NOT = SPACES
  8097         MOVE PI-EARNING-METHOD-AH   TO CP-EARNING-METHOD
  8098        ELSE
  8099         NEXT SENTENCE
  8100      ELSE
  8101       IF PI-EARNING-METHOD-LF NOT = SPACES
  8102         MOVE PI-EARNING-METHOD-LF   TO CP-EARNING-METHOD.
  8103
  8104
  8105* EXEC CICS LINK
  8106*        PROGRAM   (ELRFND-ID)
  8107*        COMMAREA  (CALCULATION-PASS-AREA)
  8108*        LENGTH    (CP-COMM-LENGTH)
  8109*    END-EXEC.
  8110*    MOVE '."C                   (   #00007828' TO DFHEIV0
  8111     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8112     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8113     MOVE X'2020233030303037383238' TO DFHEIV0(25:11)
  8114     CALL 'kxdfhei1' USING DFHEIV0,
  8115           ELRFND-ID,
  8116           CALCULATION-PASS-AREA,
  8117           CP-COMM-LENGTH,
  8118           DFHEIV99,
  8119           DFHEIV99,
  8120           DFHEIV99,
  8121           DFHEIV99
  8122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8123
  8124
  8125 0899-EXIT.
  8126     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 149
* EL1278.cbl
  8128 0900-READ-CERT-FILE  SECTION.
  8129
  8130* EXEC CICS HANDLE CONDITION
  8131*        NOTFND  (0910-NOT-FOUND)
  8132*    END-EXEC.
  8133*    MOVE '"$I                   ! # #00007838' TO DFHEIV0
  8134     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8135     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8136     MOVE X'2320233030303037383338' TO DFHEIV0(25:11)
  8137     CALL 'kxdfhei1' USING DFHEIV0
  8138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8139
  8140
  8141
  8142* EXEC CICS READ
  8143*        DATASET  (ELCERT-ID)
  8144*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8145*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8146*    END-EXEC.
  8147*    MOVE '&"S        E          (   #00007842' TO DFHEIV0
  8148     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8149     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8150     MOVE X'2020233030303037383432' TO DFHEIV0(25:11)
  8151     CALL 'kxdfhei1' USING DFHEIV0,
  8152           ELCERT-ID,
  8153           DFHEIV20,
  8154           DFHEIV99,
  8155           WS-CM-CONTROL-PRIMARY,
  8156           DFHEIV99,
  8157           DFHEIV99,
  8158           DFHEIV99
  8159     SET ADDRESS OF CERTIFICATE-MASTER TO
  8160         DFHEIV20
  8161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8162
  8163
  8164*    SERVICE RELOAD CERTIFICATE-MASTER.
  8165
  8166     GO TO 0999-EXIT.
  8167
  8168 0910-NOT-FOUND.
  8169     MOVE 'N'                    TO  WS-CERT-RECORD-SW.
  8170
  8171 0999-EXIT.
  8172     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 150
* EL1278.cbl
  8174 1000-READ-CONTROL  SECTION.
  8175
  8176* EXEC CICS HANDLE CONDITION
  8177*        NOTFND   (1010-NOTFND)
  8178*        NOTOPEN  (1020-NOTOPEN)
  8179*    END-EXEC.
  8180*    MOVE '"$IJ                  ! $ #00007859' TO DFHEIV0
  8181     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8182     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8183     MOVE X'2420233030303037383539' TO DFHEIV0(25:11)
  8184     CALL 'kxdfhei1' USING DFHEIV0
  8185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8186
  8187
  8188
  8189* EXEC CICS READ
  8190*        DATASET  (ELCNTL-ID)
  8191*        SET      (ADDRESS OF CONTROL-FILE)
  8192*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8193*        GTEQ
  8194*    END-EXEC.
  8195*    MOVE '&"S        G          (   #00007864' TO DFHEIV0
  8196     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8197     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8198     MOVE X'2020233030303037383634' TO DFHEIV0(25:11)
  8199     CALL 'kxdfhei1' USING DFHEIV0,
  8200           ELCNTL-ID,
  8201           DFHEIV20,
  8202           DFHEIV99,
  8203           WS-CF-CONTROL-PRIMARY,
  8204           DFHEIV99,
  8205           DFHEIV99,
  8206           DFHEIV99
  8207     SET ADDRESS OF CONTROL-FILE TO
  8208         DFHEIV20
  8209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8210
  8211
  8212*    SERVICE RELOAD CONTROL-FILE.
  8213
  8214     GO TO 1099-EXIT.
  8215
  8216 1010-NOTFND.
  8217     MOVE 'N'                    TO  WS-CNTL-RECORD-SW.
  8218
  8219     GO TO 1099-EXIT.
  8220
  8221 1020-NOTOPEN.
  8222     MOVE ER-2617                TO  EMI-ERROR.
  8223
  8224     GO TO 0320-INPUT-ERROR.
  8225
  8226 1099-EXIT.
  8227     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 151
* EL1278.cbl
  8229 1100-FIND-BENEFIT-IN-STATE  SECTION.
  8230     MOVE 'N'                    TO  BEN-SEARCH-SW.
  8231
  8232     PERFORM 1110-BENEFIT-DUMMY  THRU  1119-EXIT
  8233         VARYING  SUB3  FROM  1  BY  1
  8234             UNTIL  ((SUB3  IS GREATER THAN  50)
  8235               OR ((CF-ST-BENEFIT-CD (SUB3)
  8236                      IS EQUAL TO  WS-BEN-CD)
  8237               AND (WS-LOOKUP-TYPE
  8238                      IS EQUAL TO  CF-ST-BENEFIT-KIND (SUB3)))).
  8239
  8240     IF SUB3  IS NOT EQUAL TO  51
  8241         MOVE 'Y'                TO  BEN-SEARCH-SW.
  8242
  8243     GO TO 1199-EXIT.
  8244
  8245 1110-BENEFIT-DUMMY.
  8246
  8247 1119-EXIT.
  8248     EXIT.
  8249
  8250 1199-EXIT.
  8251     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 152
* EL1278.cbl
  8253 1200-START-ACCOUNT-MASTER  SECTION.
  8254
  8255* EXEC CICS HANDLE CONDITION
  8256*        NOTFND   (1290-ACCT-NOT-FOUND)
  8257*        ENDFILE  (1290-ACCT-NOT-FOUND)
  8258*    END-EXEC.
  8259*    MOVE '"$I''                  ! % #00007913' TO DFHEIV0
  8260     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8261     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8262     MOVE X'2520233030303037393133' TO DFHEIV0(25:11)
  8263     CALL 'kxdfhei1' USING DFHEIV0
  8264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8265
  8266
  8267     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8268
  8269
  8270* EXEC CICS STARTBR
  8271*        DATASET  (ERACCT-ID)
  8272*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8273*        GTEQ
  8274*    END-EXEC.
  8275     MOVE 0
  8276       TO DFHEIV11
  8277*    MOVE '&,         G          &   #00007920' TO DFHEIV0
  8278     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8279     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8280     MOVE X'2020233030303037393230' TO DFHEIV0(25:11)
  8281     CALL 'kxdfhei1' USING DFHEIV0,
  8282           ERACCT-ID,
  8283           WS-AM-CONTROL-PRIMARY,
  8284           DFHEIV99,
  8285           DFHEIV11,
  8286           DFHEIV99
  8287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8288
  8289
  8290     MOVE 'Y'                    TO  WS-BROWSE-STARTED-SW.
  8291     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  8292
  8293     GO TO 1299-EXIT.
  8294
  8295 1290-ACCT-NOT-FOUND.
  8296     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8297
  8298 1299-EXIT.
  8299     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 153
* EL1278.cbl
  8301 1300-READ-ACCOUNT-MASTER  SECTION.
  8302
  8303* EXEC CICS HANDLE CONDITION
  8304*        NOTFND   (0580-ACCT-NOT-FOUND)
  8305*        ENDFILE  (0580-ACCT-NOT-FOUND)
  8306*    END-EXEC.
  8307*    MOVE '"$I''                  ! & #00007938' TO DFHEIV0
  8308     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8309     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8310     MOVE X'2620233030303037393338' TO DFHEIV0(25:11)
  8311     CALL 'kxdfhei1' USING DFHEIV0
  8312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8313
  8314
  8315
  8316* EXEC CICS READNEXT
  8317*        DATASET  (ERACCT-ID)
  8318*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8319*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8320*    END-EXEC.
  8321     MOVE 0
  8322       TO DFHEIV11
  8323*    MOVE '&.S                   )   #00007943' TO DFHEIV0
  8324     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8325     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8326     MOVE X'2020233030303037393433' TO DFHEIV0(25:11)
  8327     CALL 'kxdfhei1' USING DFHEIV0,
  8328           ERACCT-ID,
  8329           DFHEIV20,
  8330           DFHEIV99,
  8331           WS-AM-CONTROL-PRIMARY,
  8332           DFHEIV99,
  8333           DFHEIV11,
  8334           DFHEIV99,
  8335           DFHEIV99
  8336     SET ADDRESS OF ACCOUNT-MASTER TO
  8337         DFHEIV20
  8338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8339
  8340
  8341*    SERVICE RELOAD ACCOUNT-MASTER.
  8342
  8343 1399-EXIT.
  8344     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 154
* EL1278.cbl
  8346 1400-GET-REFUND-TYPE  SECTION.
  8347     IF LIFE-REFUND-SEARCH
  8348         NEXT SENTENCE
  8349     ELSE
  8350         GO TO 1410-AH-REFUND-TYPE.
  8351
  8352     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8353         MOVE SPACES             TO  HLCALCO
  8354                                     HLCAL1O
  8355         GO TO 1499-EXIT.
  8356
  8357     MOVE CP-REFUND-TYPE-USED    TO  HLCAL1O.
  8358
  8359     EVALUATE TRUE
  8360        WHEN CP-R-AS-REPOSSESSION
  8361           MOVE 'REPOSSESSION'     TO  HLCALCO
  8362        WHEN CP-R-AS-R78
  8363           MOVE 'RULE 78'          TO  HLCALCO
  8364        WHEN  CP-R-AS-PRORATA
  8365           MOVE 'PRO RATA'         TO  HLCALCO
  8366        WHEN CP-R-AS-CALIF
  8367           MOVE 'CALIF'            TO  HLCALCO
  8368        WHEN CP-R-AS-TEXAS
  8369           MOVE 'IRREG'            TO  HLCALCO
  8370        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  8371           MOVE 'UTAH'             TO  HLCALCO
  8372        WHEN CP-R-AS-FARM-PLAN
  8373           MOVE 'FARM PLAN'        TO  HLCALCO
  8374        WHEN CP-R-AS-NET-PAY
  8375           MOVE 'NET PAY'          TO  HLCALCO
  8376        WHEN CP-R-AS-ANTICIPATION
  8377           MOVE 'ANTICIPATION'     TO  HLCALCO
  8378        WHEN CP-R-AS-MEAN
  8379           MOVE 'MEAN'             TO  HLCALCO
  8380        WHEN CP-R-AS-SUM-OF-DIGITS
  8381           MOVE 'SUM OF DIGIT'     TO  HLCALCO
  8382        WHEN OTHER
  8383           MOVE 'UNDEFINED'        TO  HLCALCO
  8384     END-EVALUATE.
  8385
  8386     GO TO 1499-EXIT.
  8387
  8388 1410-AH-REFUND-TYPE.
  8389     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8390         MOVE SPACES             TO  HACALCO
  8391                                     HACAL1O
  8392         GO TO 1499-EXIT.
  8393
  8394     MOVE CP-REFUND-TYPE-USED    TO  HACAL1O.
  8395
  8396     EVALUATE TRUE
  8397        WHEN CP-R-AS-REPOSSESSION
  8398           MOVE 'REPOSSESSION'     TO HACALCO
  8399        WHEN CP-R-AS-R78
  8400           MOVE 'RULE 78'          TO HACALCO
  8401        WHEN CP-R-AS-PRORATA
  8402           MOVE 'PRO RATA'         TO HACALCO
  8403        WHEN CP-REFUND-TYPE-USED = '3'
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 155
* EL1278.cbl
  8404           MOVE 'CALIF'            TO HACALCO
  8405        WHEN CP-R-AS-TEXAS
  8406           MOVE 'IRREG'            TO HACALCO
  8407        WHEN CP-R-AS-FARM-PLAN
  8408           MOVE 'FARM PLAN'        TO HACALCO
  8409        WHEN CP-R-AS-NET-PAY
  8410           MOVE 'NET PAY'          TO HACALCO
  8411        WHEN CP-R-AS-ANTICIPATION
  8412           MOVE 'ANTICIPATION'     TO HACALCO
  8413        WHEN CP-R-AS-MEAN
  8414           MOVE 'MEAN'             TO HACALCO
  8415        WHEN CP-R-AS-SUM-OF-DIGITS
  8416           MOVE 'SUM OF DIGIT'     TO HACALCO
  8417        WHEN CP-GAP-ACTUARIAL
  8418           MOVE 'SP ACTUARIAL'     TO HACALCO
  8419        WHEN CP-R-AS-SPP-DDF
  8420           MOVE 'SPEC DDF'         TO HACALCO
  8421        WHEN CP-R-AS-SPP-DDF-IU
  8422           MOVE 'SPEC DDF IU'      TO HACALCO
  8423        WHEN OTHER
  8424           MOVE 'UNKNOWN'          TO HLCALCO
  8425     END-EVALUATE
  8426     .
  8427 1499-EXIT.
  8428     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 156
* EL1278.cbl
  8430 1500-END-BROWSE  SECTION.
  8431     IF BROWSE-STARTED
  8432
  8433* EXEC CICS ENDBR
  8434*            DATASET  (ERACCT-ID)
  8435*        END-EXEC.
  8436     MOVE 0
  8437       TO DFHEIV11
  8438*    MOVE '&2                    $   #00008040' TO DFHEIV0
  8439     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8440     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8441     MOVE X'2020233030303038303430' TO DFHEIV0(25:11)
  8442     CALL 'kxdfhei1' USING DFHEIV0,
  8443           ERACCT-ID,
  8444           DFHEIV11,
  8445           DFHEIV99
  8446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8447
  8448
  8449 1599-EXIT.
  8450     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 157
* EL1278.cbl
  8452 1600-LOCATE-BENEFIT  SECTION.
  8453
  8454* EXEC CICS HANDLE CONDITION
  8455*        NOTFND  (1699-EXIT)
  8456*    END-EXEC.
  8457*    MOVE '"$I                   ! '' #00008048' TO DFHEIV0
  8458     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8459     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8460     MOVE X'2720233030303038303438' TO DFHEIV0(25:11)
  8461     CALL 'kxdfhei1' USING DFHEIV0
  8462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8463
  8464
  8465     MOVE SPACES                 TO  WS-KIND.
  8466     MOVE ZERO                   TO  WS-NOT-FOUND.
  8467     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  8468     MOVE SPACES                 TO  WS-CF-STATE.
  8469     MOVE WS-BENEFIT-NO          TO  WS-CF-BENEFIT-NO.
  8470
  8471
  8472* EXEC CICS READ
  8473*        DATASET  (ELCNTL-ID)
  8474*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8475*        SET      (ADDRESS OF CONTROL-FILE)
  8476*        GTEQ
  8477*    END-EXEC.
  8478*    MOVE '&"S        G          (   #00008058' TO DFHEIV0
  8479     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8480     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8481     MOVE X'2020233030303038303538' TO DFHEIV0(25:11)
  8482     CALL 'kxdfhei1' USING DFHEIV0,
  8483           ELCNTL-ID,
  8484           DFHEIV20,
  8485           DFHEIV99,
  8486           WS-CF-CONTROL-PRIMARY,
  8487           DFHEIV99,
  8488           DFHEIV99,
  8489           DFHEIV99
  8490     SET ADDRESS OF CONTROL-FILE TO
  8491         DFHEIV20
  8492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8493
  8494
  8495*    SERVICE RELOAD CONTROL-FILE.
  8496
  8497     IF WS-CF-COMPANY-ID  IS NOT EQUAL TO  CF-COMPANY-ID
  8498       OR WS-CF-RECORD-TYPE  IS NOT EQUAL TO  CF-RECORD-TYPE
  8499         GO TO 1699-EXIT.
  8500
  8501     MOVE +1                     TO  WS-INDEX.
  8502
  8503 1610-LOOKUP-BENEFIT.
  8504     IF WS-BENEFIT-NO  IS EQUAL TO  CF-BENEFIT-CODE (WS-INDEX)
  8505         MOVE CF-BENEFIT-ALPHA (WS-INDEX)
  8506                                 TO  WS-KIND
  8507         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  8508                                 TO  WS-CALC-CD
  8509         MOVE CF-BENEFIT-DESCRIP (WS-INDEX)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 158
* EL1278.cbl
  8510                                 TO  WS-BENEFIT-DESCRIP
  8511         MOVE +1                 TO  WS-NOT-FOUND
  8512         GO TO 1699-EXIT.
  8513
  8514     IF CF-BENEFIT-CODE (WS-INDEX)
  8515             IS NOT LESS THAN  CF-HI-BEN-IN-REC
  8516         GO TO 1699-EXIT.
  8517
  8518     IF WS-INDEX  IS LESS THAN  +8
  8519         ADD +1                  TO  WS-INDEX
  8520         GO TO 1610-LOOKUP-BENEFIT.
  8521
  8522 1699-EXIT.
  8523     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 159
* EL1278.cbl
  8525 1700-WRITE-CERT-NOTE      SECTION.
  8526     IF NOT MODIFY-CERT-CAP
  8527         MOVE 'UPDATE'           TO  SM-READ
  8528         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  8529         MOVE ER-0070            TO  EMI-ERROR
  8530         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  8531         GO TO 8200-SEND-DATAONLY.
  8532
  8533**MOVE CANCEL QUOTE NOTE INFO
  8534     IF PI-LF-REFUND-AMT NUMERIC
  8535        MOVE PI-LF-REFUND-AMT    TO WS-CN-LIFE-AMT-RF
  8536        MOVE PI-LF-REFUND-METH   TO WS-CN-LF-REF-METH
  8537     ELSE
  8538        MOVE ZERO                TO WS-CN-LIFE-AMT-RF
  8539                                    PI-LF-REFUND-AMT
  8540        MOVE SPACE               TO WS-CN-LF-REF-METH
  8541                                    PI-LF-REFUND-METH.
  8542
  8543     IF PI-AH-REFUND-AMT NUMERIC
  8544        MOVE PI-AH-REFUND-AMT    TO WS-CN-AH-AMT-RF
  8545        MOVE PI-AH-REFUND-METH   TO WS-CN-AH-REF-METH
  8546     ELSE
  8547        MOVE ZERO                TO WS-CN-AH-AMT-RF
  8548                                    PI-AH-REFUND-AMT
  8549        MOVE SPACE               TO WS-CN-AH-REF-METH
  8550                                    PI-AH-REFUND-METH.
  8551
  8552     COMPUTE PI-TOTAL-REFUND-AMT = PI-LF-REFUND-AMT +
  8553                                   PI-AH-REFUND-AMT.
  8554
  8555     MOVE PI-TOTAL-REFUND-AMT    TO WS-CN-TOTAL-RF.
  8556
  8557     MOVE SAVE-DATE              TO WS-CN-DT-QUOTED.
  8558     MOVE PI-PROCESSOR-ID        TO WS-CN-PROCESSOR-ID.
  8559     IF PI-LF-CANCEL-DATE-ED NOT EQUAL SPACE
  8560        MOVE PI-LF-CANCEL-DATE-ED
  8561                                 TO WS-CN-CANCEL-DT
  8562     ELSE
  8563        MOVE PI-AH-CANCEL-DATE-ED
  8564                                 TO WS-CN-CANCEL-DT
  8565     END-IF
  8566     MOVE 'CZ'                   TO CERT-NOTE-FILE
  8567     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD
  8568     MOVE PI-CARRIER             TO CZ-CARRIER
  8569     MOVE PI-GROUPING            TO CZ-GROUPING
  8570     MOVE PI-STATE               TO CZ-STATE
  8571     MOVE PI-ACCOUNT             TO CZ-ACCOUNT
  8572     MOVE PI-CERT-EFF-DT         TO CZ-CERT-EFF-DT
  8573     MOVE PI-CERT-PRIME          TO CZ-CERT-PRIME
  8574     MOVE PI-CERT-SFX            TO CZ-CERT-SFX
  8575     MOVE '1'                    TO CZ-RECORD-TYPE
  8576     MOVE +1                     TO CZ-NOTE-SEQUENCE
  8577     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER
  8578     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS
  8579     MOVE SAVE-BIN-DATE          TO CZ-LAST-MAINT-DT
  8580     MOVE WS-CAN-QUOTE-NOTE      TO CZ-NOTE-INFORMATION
  8581     MOVE ' '                    TO WS-STOP-SW
  8582     PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 160
* EL1278.cbl
  8583
  8584* EXEC CICS WRITE
  8585*           FROM      (CERT-NOTE-FILE)
  8586*           DATASET   (ERNOTE-ID)
  8587*           RIDFLD    (CZ-CONTROL-PRIMARY)
  8588*           RESP      (WS-RESPONSE)
  8589*       END-EXEC
  8590     MOVE LENGTH OF
  8591      CERT-NOTE-FILE
  8592       TO DFHEIV11
  8593*    MOVE '&$ L                  ''  N#00008153' TO DFHEIV0
  8594     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8595     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8596     MOVE X'204E233030303038313533' TO DFHEIV0(25:11)
  8597     CALL 'kxdfhei1' USING DFHEIV0,
  8598           ERNOTE-ID,
  8599           CERT-NOTE-FILE,
  8600           DFHEIV11,
  8601           CZ-CONTROL-PRIMARY,
  8602           DFHEIV99,
  8603           DFHEIV99
  8604     MOVE EIBRESP  TO WS-RESPONSE
  8605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8606        IF WS-RESP-DUPREC
  8607           ADD +1                TO CZ-NOTE-SEQUENCE
  8608        ELSE
  8609           SET I-SAY-TO-STOP     TO TRUE
  8610        END-IF
  8611     END-PERFORM
  8612     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8613     IF WS-RESP-NORMAL
  8614        EVALUATE CM-NOTE-SW
  8615           WHEN '1'
  8616           WHEN '3'
  8617           WHEN '5'
  8618           WHEN '7'
  8619              SET NO-CERT-RW     TO TRUE
  8620           WHEN ' '
  8621              MOVE '1'           TO CM-NOTE-SW
  8622           WHEN '2'
  8623              MOVE '3'           TO CM-NOTE-SW
  8624           WHEN '4'
  8625              MOVE '5'           TO CM-NOTE-SW
  8626           WHEN '6'
  8627              MOVE '7'           TO CM-NOTE-SW
  8628        END-EVALUATE
  8629     END-IF
  8630     IF NOT NO-CERT-RW
  8631        PERFORM 1810-REWRITE-ELCERT
  8632                                 THRU 1810-EXIT
  8633     ELSE
  8634
  8635* EXEC CICS UNLOCK
  8636*          DATASET    (ELCERT-ID)
  8637*       END-EXEC
  8638*    MOVE '&*                    #   #00008187' TO DFHEIV0
  8639     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8640     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 161
* EL1278.cbl
  8641     MOVE X'2020233030303038313837' TO DFHEIV0(25:11)
  8642     CALL 'kxdfhei1' USING DFHEIV0,
  8643           ELCERT-ID,
  8644           DFHEIV99
  8645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8646     END-IF
  8647     MOVE ER-8160                TO EMI-ERROR.
  8648     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  8649     GO TO 8200-SEND-DATAONLY.
  8650
  8651 1799-EXIT.
  8652     EXIT.
  8653 1800-READ-ELCERT-UPDATE.
  8654     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  8655     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  8656     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  8657     MOVE PI-STATE               TO  WS-CM-STATE.
  8658     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  8659     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  8660     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  8661     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  8662
  8663* EXEC CICS READ
  8664*        UPDATE
  8665*        DATASET  (ELCERT-ID)
  8666*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8667*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8668*        RESP     (WS-RESPONSE)
  8669*    END-EXEC
  8670*    MOVE '&"S        EU         (  N#00008206' TO DFHEIV0
  8671     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8672     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8673     MOVE X'204E233030303038323036' TO DFHEIV0(25:11)
  8674     CALL 'kxdfhei1' USING DFHEIV0,
  8675           ELCERT-ID,
  8676           DFHEIV20,
  8677           DFHEIV99,
  8678           WS-CM-CONTROL-PRIMARY,
  8679           DFHEIV99,
  8680           DFHEIV99,
  8681           DFHEIV99
  8682     SET ADDRESS OF CERTIFICATE-MASTER TO
  8683         DFHEIV20
  8684     MOVE EIBRESP  TO WS-RESPONSE
  8685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8686     .
  8687 1800-EXIT.
  8688     EXIT.
  8689 1810-REWRITE-ELCERT.
  8690
  8691* EXEC CICS REWRITE
  8692*        FROM      (CERTIFICATE-MASTER)
  8693*        DATASET   (ELCERT-ID)
  8694*        RESP     (WS-RESPONSE)
  8695*    END-EXEC.
  8696     MOVE LENGTH OF
  8697      CERTIFICATE-MASTER
  8698       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 162
* EL1278.cbl
  8699*    MOVE '&& L                  %  N#00008217' TO DFHEIV0
  8700     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8701     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8702     MOVE X'204E233030303038323137' TO DFHEIV0(25:11)
  8703     CALL 'kxdfhei1' USING DFHEIV0,
  8704           ELCERT-ID,
  8705           CERTIFICATE-MASTER,
  8706           DFHEIV11,
  8707           DFHEIV99
  8708     MOVE EIBRESP  TO WS-RESPONSE
  8709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8710
  8711     .
  8712 1810-EXIT.
  8713     EXIT.
  8714 4000-GEN-CANCEL-TRANS.
  8715     IF PI-LF-REFUND-AMT NOT NUMERIC
  8716         MOVE +0 TO PI-LF-REFUND-AMT
  8717     END-IF
  8718     IF PI-AH-REFUND-AMT NOT NUMERIC
  8719         MOVE +0 TO PI-AH-REFUND-AMT
  8720     END-IF
  8721
  8722     PERFORM 4400-ADD-ORIG-REC THRU 4400-EXIT
  8723
  8724     MOVE '2'                    TO CG-OPTION-CODE
  8725     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
  8726     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
  8727     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
  8728     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
  8729     MOVE PI-CARRIER             TO CG-CERT-CARRIER
  8730     MOVE PI-GROUPING            TO CG-CERT-GROUP
  8731     MOVE PI-STATE               TO CG-CERT-STATE
  8732     MOVE PI-ACCOUNT             TO CG-CERT-ACCOUNT
  8733     MOVE PI-CERT-EFF-DT         TO CG-CERT-EFF-DT
  8734     MOVE PI-CERT-NO             TO CG-CERT-CERT-NO
  8735     MOVE SAVE-BIN-DATE          TO CG-CURRENT-DT
  8736     MOVE ZEROS                  TO CG-LF-BENCD
  8737                                    CG-AH-BENCD
  8738                                    CG-LF-CAN-AMT
  8739                                    CG-AH-CAN-AMT
  8740     MOVE LOW-VALUES             TO CG-LF-CAN-DT
  8741                                    CG-AH-CAN-DT
  8742     MOVE SPACES                 TO CG-BATCH-NO
  8743     IF CM-LF-BENEFIT-CD NOT = '00' AND '  ' AND 'DD'
  8744       AND (CM-LF-CANCEL-DT = LOW-VALUES OR SPACES)
  8745        IF (PI-LF-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  8746           MOVE CM-LF-BENEFIT-CD  TO CG-LF-BENCD
  8747           MOVE PI-LF-REFUND-AMT  TO CG-LF-CAN-AMT
  8748           MOVE PI-LF-CANCEL-DATE TO CG-LF-CAN-DT
  8749        END-IF
  8750     END-IF
  8751     IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  8752       AND (CM-AH-CANCEL-DT = LOW-VALUES OR SPACES)
  8753        IF (PI-AH-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  8754           MOVE CM-AH-BENEFIT-CD  TO CG-AH-BENCD
  8755           MOVE PI-AH-REFUND-AMT  TO CG-AH-CAN-AMT
  8756           MOVE PI-AH-CANCEL-DATE TO CG-AH-CAN-DT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 163
* EL1278.cbl
  8757        END-IF
  8758     END-IF
  8759
  8760* EXEC CICS LINK
  8761*        PROGRAM  ('ELCANC')
  8762*        COMMAREA (CANCEL-GEN-PASS-AREA)
  8763*    END-EXEC
  8764     MOVE LENGTH OF
  8765      CANCEL-GEN-PASS-AREA
  8766       TO DFHEIV11
  8767     MOVE 'ELCANC' TO DFHEIV1
  8768*    MOVE '."C                   (   #00008270' TO DFHEIV0
  8769     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8770     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8771     MOVE X'2020233030303038323730' TO DFHEIV0(25:11)
  8772     CALL 'kxdfhei1' USING DFHEIV0,
  8773           DFHEIV1,
  8774           CANCEL-GEN-PASS-AREA,
  8775           DFHEIV11,
  8776           DFHEIV99,
  8777           DFHEIV99,
  8778           DFHEIV99,
  8779           DFHEIV99
  8780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8781     IF CG-SUCCESS
  8782        CONTINUE
  8783     ELSE
  8784        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
  8785        move '3'                 to emi-switch1
  8786        MOVE CG-ERROR-CODE       TO EMI-TEXT-VARIABLE (1)
  8787        EVALUATE TRUE
  8788           WHEN CG-DATE-ERROR
  8789             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8790           WHEN CG-CERT-NOT-FOUND
  8791             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8792           WHEN CG-AMOUNT-ERROR
  8793             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8794           WHEN CG-OPTION-ERROR
  8795             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8796           WHEN CG-PREV-CAN
  8797             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8798           WHEN CG-INVALID-DATA
  8799             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8800           WHEN CG-NO-ACCT-MSTR
  8801             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8802           WHEN CG-SFX-A-EXIST
  8803             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8804           WHEN CG-MISC-ERROR
  8805             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8806           WHEN OTHER
  8807             move ' error - elcanc - return '
  8808                                 to emi-error-text (1) (12:25)
  8809        END-EVALUATE
  8810        go to 8200-send-dataonly
  8811     end-if
  8812     .
  8813 4000-exit.
  8814     exit.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 164
* EL1278.cbl
  8815
  8816 4400-ADD-ORIG-REC.
  8817
  8818     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  8819     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  8820     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  8821     MOVE PI-STATE               TO  WS-CM-STATE.
  8822     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  8823     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  8824     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  8825     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  8826
  8827
  8828* EXEC CICS READ
  8829*        DATASET  (ELCERT-ID)
  8830*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8831*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8832*        RESP     (WS-RESPONSE)
  8833*    END-EXEC
  8834*    MOVE '&"S        E          (  N#00008320' TO DFHEIV0
  8835     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8836     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8837     MOVE X'204E233030303038333230' TO DFHEIV0(25:11)
  8838     CALL 'kxdfhei1' USING DFHEIV0,
  8839           ELCERT-ID,
  8840           DFHEIV20,
  8841           DFHEIV99,
  8842           WS-CM-CONTROL-PRIMARY,
  8843           DFHEIV99,
  8844           DFHEIV99,
  8845           DFHEIV99
  8846     SET ADDRESS OF CERTIFICATE-MASTER TO
  8847         DFHEIV20
  8848     MOVE EIBRESP  TO WS-RESPONSE
  8849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8850     IF WS-RESP-NORMAL
  8851         CONTINUE
  8852     ELSE
  8853        MOVE ER-0142                TO EMI-ERROR
  8854        PERFORM 9700-ERROR-FORMAT THRU 9799-EXIT
  8855        GO TO 8100-SEND-INITIAL-MAP
  8856     END-IF
  8857
  8858******************************************************************
  8859*            A D D   O R I G   C E R T   I N F O                 *
  8860******************************************************************
  8861
  8862     display ' made it to add orig cert ' WS-CM-CONTROL-PRIMARY
  8863
  8864     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  8865     MOVE ' '                    TO WS-ERMAIL-SW
  8866
  8867
  8868* EXEC CICS READ
  8869*       DATASET   ('ERMAIL')
  8870*       SET       (ADDRESS OF MAILING-DATA)
  8871*       RIDFLD    (WS-MA-CONTROL-PRIMARY)
  8872*       RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 165
* EL1278.cbl
  8873*    END-EXEC
  8874     MOVE 'ERMAIL' TO DFHEIV1
  8875*    MOVE '&"S        E          (  N#00008343' TO DFHEIV0
  8876     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8877     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8878     MOVE X'204E233030303038333433' TO DFHEIV0(25:11)
  8879     CALL 'kxdfhei1' USING DFHEIV0,
  8880           DFHEIV1,
  8881           DFHEIV20,
  8882           DFHEIV99,
  8883           WS-MA-CONTROL-PRIMARY,
  8884           DFHEIV99,
  8885           DFHEIV99,
  8886           DFHEIV99
  8887     SET ADDRESS OF MAILING-DATA TO
  8888         DFHEIV20
  8889     MOVE EIBRESP  TO WS-RESPONSE
  8890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8891
  8892     IF WS-RESP-NORMAL
  8893        SET ERMAIL-FOUND TO TRUE
  8894     END-IF
  8895
  8896     MOVE WS-CM-CONTROL-PRIMARY TO ELCRTT-PRIMARY
  8897     MOVE 'C'                   TO ELCRTT-REC-TYPE
  8898     MOVE +0                    TO WS-CERT-TRL-REC-NOT-FOUND
  8899
  8900
  8901* EXEC CICS READ
  8902*         DATASET  (ELCRTT-ID)
  8903*         RIDFLD   (ELCRTT-KEY)
  8904*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  8905*         RESP     (WS-RESPONSE)
  8906*    END-EXEC
  8907*    MOVE '&"S        E          (  N#00008358' TO DFHEIV0
  8908     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8909     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8910     MOVE X'204E233030303038333538' TO DFHEIV0(25:11)
  8911     CALL 'kxdfhei1' USING DFHEIV0,
  8912           ELCRTT-ID,
  8913           DFHEIV20,
  8914           DFHEIV99,
  8915           ELCRTT-KEY,
  8916           DFHEIV99,
  8917           DFHEIV99,
  8918           DFHEIV99
  8919     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  8920         DFHEIV20
  8921     MOVE EIBRESP  TO WS-RESPONSE
  8922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8923
  8924     IF NOT WS-RESP-NORMAL
  8925        MOVE +1               TO WS-CERT-TRL-REC-NOT-FOUND
  8926     END-IF
  8927
  8928     MOVE WS-CM-CONTROL-PRIMARY TO ELCRTO-KEY (1:33)
  8929     MOVE 'I'                 TO ELCRTO-RECORD-TYPE
  8930     MOVE +0                  TO ELCRTO-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 166
* EL1278.cbl
  8931
  8932
  8933* EXEC CICS READ
  8934*       DATASET   ('ELCRTO')
  8935*       SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  8936*       RIDFLD    (ELCRTO-KEY)
  8937*       GTEQ
  8938*       RESP      (WS-RESPONSE)
  8939*    END-EXEC
  8940     MOVE 'ELCRTO' TO DFHEIV1
  8941*    MOVE '&"S        G          (  N#00008373' TO DFHEIV0
  8942     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8943     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8944     MOVE X'204E233030303038333733' TO DFHEIV0(25:11)
  8945     CALL 'kxdfhei1' USING DFHEIV0,
  8946           DFHEIV1,
  8947           DFHEIV20,
  8948           DFHEIV99,
  8949           ELCRTO-KEY,
  8950           DFHEIV99,
  8951           DFHEIV99,
  8952           DFHEIV99
  8953     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  8954         DFHEIV20
  8955     MOVE EIBRESP  TO WS-RESPONSE
  8956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8957
  8958     IF WS-RESP-NORMAL
  8959        AND (OC-CONTROL-PRIMARY (1:33) =
  8960                 WS-CM-CONTROL-PRIMARY)
  8961        AND (OC-RECORD-TYPE = 'I')
  8962        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
  8963
  8964* EXEC CICS READ
  8965*             DATASET   ('ELCRTO')
  8966*             SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  8967*             RIDFLD    (OC-CONTROL-PRIMARY)
  8968*             UPDATE
  8969*             RESP      (WS-RESPONSE)
  8970*          END-EXEC
  8971     MOVE 'ELCRTO' TO DFHEIV1
  8972*    MOVE '&"S        EU         (  N#00008386' TO DFHEIV0
  8973     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8974     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8975     MOVE X'204E233030303038333836' TO DFHEIV0(25:11)
  8976     CALL 'kxdfhei1' USING DFHEIV0,
  8977           DFHEIV1,
  8978           DFHEIV20,
  8979           DFHEIV99,
  8980           OC-CONTROL-PRIMARY,
  8981           DFHEIV99,
  8982           DFHEIV99,
  8983           DFHEIV99
  8984     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  8985         DFHEIV20
  8986     MOVE EIBRESP  TO WS-RESPONSE
  8987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8988           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 167
* EL1278.cbl
  8989           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  8990           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  8991           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  8992           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  8993           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  8994           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  8995           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  8996           IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  8997            (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  8998               MOVE SPACES             TO OC-LF-BENCD
  8999               MOVE ZEROS              TO OC-LF-TERM
  9000                                          OC-LF-BEN-AMT
  9001                                          OC-LF-PRM-AMT
  9002                                          OC-LF-ALT-BEN-AMT
  9003                                          OC-LF-ALT-PRM-AMT
  9004                                          OC-LF-COMM-PCT
  9005                                          OC-LF-CANCEL-AMT
  9006               MOVE LOW-VALUES         TO OC-LF-EXP-DT
  9007               MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  9008           ELSE
  9009               MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
  9010               MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
  9011               MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
  9012               MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
  9013               MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
  9014               MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
  9015               MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
  9016               MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
  9017               MOVE PI-LF-REFUND-AMT       TO OC-LF-CANCEL-AMT
  9018               MOVE PI-LF-CANCEL-DATE      TO OC-LF-CANCEL-DT
  9019           END-IF
  9020           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  9021           IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9022            (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9023               MOVE SPACES             TO OC-AH-BENCD
  9024               MOVE ZEROS              TO OC-AH-TERM
  9025                                          OC-AH-BEN-AMT
  9026                                          OC-AH-PRM-AMT
  9027                                          OC-AH-COMM-PCT
  9028                                          OC-AH-CANCEL-AMT
  9029                                          OC-AH-CP
  9030               MOVE LOW-VALUES         TO OC-AH-EXP-DT
  9031               MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9032           ELSE
  9033               MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  9034               MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  9035               MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  9036               MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  9037               MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  9038               MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  9039               MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  9040               MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  9041               MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  9042           END-IF
  9043           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  9044           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  9045           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
  9046           MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 168
* EL1278.cbl
  9047           MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  9048           MOVE EIBDATE                TO DC-JULIAN-YYDDD
  9049           MOVE '5'                    TO DC-OPTION-CODE
  9050           PERFORM 9600-DATE-LINK
  9051           MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  9052           IF ERMAIL-FOUND
  9053               MOVE MA-CRED-BENE-NAME
  9054                           TO OC-CRED-BENE-NAME
  9055           END-IF
  9056           IF WS-CERT-TRL-REC-NOT-FOUND = ZERO
  9057               MOVE CS-INS-AGE-DEFAULT-FLAG TO
  9058                                  OC-INS-AGE-DEFAULT-FLAG
  9059               MOVE CS-JNT-AGE-DEFAULT-FLAG TO
  9060                                  OC-JNT-AGE-DEFAULT-FLAG
  9061           END-IF
  9062
  9063
  9064* EXEC CICS REWRITE
  9065*             DATASET   ('ELCRTO')
  9066*             FROM      (ORIGINAL-CERTIFICATE)
  9067*             RESP      (WS-RESPONSE)
  9068*          END-EXEC
  9069     MOVE LENGTH OF
  9070      ORIGINAL-CERTIFICATE
  9071       TO DFHEIV11
  9072     MOVE 'ELCRTO' TO DFHEIV1
  9073*    MOVE '&& L                  %  N#00008468' TO DFHEIV0
  9074     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9075     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9076     MOVE X'204E233030303038343638' TO DFHEIV0(25:11)
  9077     CALL 'kxdfhei1' USING DFHEIV0,
  9078           DFHEIV1,
  9079           ORIGINAL-CERTIFICATE,
  9080           DFHEIV11,
  9081           DFHEIV99
  9082     MOVE EIBRESP  TO WS-RESPONSE
  9083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9084           IF NOT WS-RESP-NORMAL
  9085              MOVE ER-3830          TO EMI-ERROR
  9086              PERFORM 9700-ERROR-FORMAT
  9087                                 THRU 9799-EXIT
  9088              GO TO 8200-SEND-DATAONLY
  9089           END-IF
  9090
  9091           GO TO 4400-EXIT
  9092
  9093        ELSE
  9094           SUBTRACT +1 FROM OC-KEY-SEQ-NO
  9095        END-IF
  9096     ELSE
  9097        MOVE SPACES              TO ORIGINAL-CERTIFICATE
  9098        MOVE 'OC'                TO OC-RECORD-ID
  9099        MOVE WS-CM-CONTROL-PRIMARY TO OC-CONTROL-PRIMARY (1:33)
  9100        MOVE 'I'                 TO OC-RECORD-TYPE
  9101        MOVE +4096               TO OC-KEY-SEQ-NO
  9102     END-IF
  9103
  9104     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 169
* EL1278.cbl
  9105     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  9106     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  9107     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  9108     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  9109     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  9110     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  9111     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  9112     IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9113      (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9114         MOVE SPACES             TO OC-LF-BENCD
  9115         MOVE ZEROS              TO OC-LF-TERM
  9116                                    OC-LF-BEN-AMT
  9117                                    OC-LF-PRM-AMT
  9118                                    OC-LF-ALT-BEN-AMT
  9119                                    OC-LF-ALT-PRM-AMT
  9120                                    OC-LF-COMM-PCT
  9121                                    OC-LF-CANCEL-AMT
  9122         MOVE LOW-VALUES         TO OC-LF-EXP-DT
  9123         MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  9124     ELSE
  9125         MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
  9126         MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
  9127         MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
  9128         MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
  9129         MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
  9130         MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
  9131         MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
  9132         MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
  9133         MOVE PI-LF-REFUND-AMT   TO OC-LF-CANCEL-AMT
  9134         MOVE PI-LF-CANCEL-DATE  TO OC-LF-CANCEL-DT
  9135     END-IF
  9136     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  9137     IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9138      (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9139         MOVE SPACES             TO OC-AH-BENCD
  9140         MOVE ZEROS              TO OC-AH-TERM
  9141                                    OC-AH-BEN-AMT
  9142                                    OC-AH-PRM-AMT
  9143                                    OC-AH-COMM-PCT
  9144                                    OC-AH-CANCEL-AMT
  9145                                    OC-AH-CP
  9146         MOVE LOW-VALUES         TO OC-AH-EXP-DT
  9147         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9148     ELSE
  9149         MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  9150         MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  9151         MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  9152         MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  9153         MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  9154         MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  9155         MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  9156         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9157         MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  9158         MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  9159     END-IF
  9160     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  9161     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  9162     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 170
* EL1278.cbl
  9163     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
  9164     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  9165     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  9166     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  9167     MOVE '5'                    TO DC-OPTION-CODE
  9168     PERFORM 9600-DATE-LINK
  9169     MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  9170     IF ERMAIL-FOUND
  9171         MOVE MA-CRED-BENE-NAME
  9172                     TO OC-CRED-BENE-NAME
  9173     END-IF
  9174     IF WS-CERT-TRL-REC-NOT-FOUND = ZERO
  9175         MOVE CS-INS-AGE-DEFAULT-FLAG TO
  9176                            OC-INS-AGE-DEFAULT-FLAG
  9177         MOVE CS-JNT-AGE-DEFAULT-FLAG TO
  9178                            OC-JNT-AGE-DEFAULT-FLAG
  9179     END-IF
  9180
  9181     MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
  9182     .
  9183 4400-WRITE-ELCRTO.
  9184
  9185
  9186* EXEC CICS WRITE
  9187*       DATASET   ('ELCRTO')
  9188*       FROM      (ORIGINAL-CERTIFICATE)
  9189*       RIDFLD    (OC-CONTROL-PRIMARY)
  9190*       RESP      (WS-RESPONSE)
  9191*    END-EXEC
  9192     MOVE LENGTH OF
  9193      ORIGINAL-CERTIFICATE
  9194       TO DFHEIV11
  9195     MOVE 'ELCRTO' TO DFHEIV1
  9196*    MOVE '&$ L                  ''  N#00008574' TO DFHEIV0
  9197     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9198     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9199     MOVE X'204E233030303038353734' TO DFHEIV0(25:11)
  9200     CALL 'kxdfhei1' USING DFHEIV0,
  9201           DFHEIV1,
  9202           ORIGINAL-CERTIFICATE,
  9203           DFHEIV11,
  9204           OC-CONTROL-PRIMARY,
  9205           DFHEIV99,
  9206           DFHEIV99
  9207     MOVE EIBRESP  TO WS-RESPONSE
  9208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9209
  9210    IF WS-RESP-DUPKEY OR WS-RESP-DUPREC
  9211        SUBTRACT +1    FROM OC-KEY-SEQ-NO
  9212        GO TO 4400-WRITE-ELCRTO
  9213    ELSE
  9214        IF NOT WS-RESP-NORMAL
  9215           MOVE ER-3830          TO EMI-ERROR
  9216           PERFORM 9700-ERROR-FORMAT
  9217                                 THRU 9799-EXIT
  9218           GO TO 8200-SEND-DATAONLY
  9219        END-IF
  9220    END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 171
* EL1278.cbl
  9221
  9222     .
  9223 4400-EXIT.
  9224    EXIT.
  9225
  9226
  9227 5000-GET-LF-AM-REM-TERM.
  9228     MOVE +1                     TO SUB3.
  9229
  9230 5100-GET-LF-AM-REM-TERM.
  9231     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9232        IF CM-LF-BENEFIT-CD = AM-BENEFIT-CODE (SUB3)
  9233           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9234                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9235           GO TO 5300-MOVE-LF-REM-TERM.
  9236
  9237     IF SUB3 LESS THAN +20
  9238        ADD +1                   TO SUB3
  9239        GO TO 5100-GET-LF-AM-REM-TERM.
  9240
  9241     MOVE +1                     TO SUB3.
  9242
  9243     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9244         GO TO 5200-EDIT-FOR-NINETY-LF.
  9245
  9246 5100-GET-LF-DMD-AM-REM-TERM.
  9247
  9248     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9249        IF CM-LF-BENEFIT-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9250           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9251                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9252           GO TO 5300-MOVE-LF-REM-TERM.
  9253
  9254     IF SUB3 LESS THAN +30
  9255        ADD +1                   TO SUB3
  9256        GO TO 5100-GET-LF-DMD-AM-REM-TERM.
  9257
  9258     MOVE +1                     TO SUB3.
  9259
  9260 5200-EDIT-FOR-NINETY-LF.
  9261
  9262***************************************************************
  9263*                                                             *
  9264*    NINETY BENEFIT PLAN TYPES:                               *
  9265*                                                             *
  9266*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9267*      92 = ALL GROUP REDUCING BENEFITS                       *
  9268*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  9269*      94 = ALL GROUP LEVEL BENEFITS                          *
  9270*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9271*           BENEFIT CONTROLS.                                 *
  9272*      99 = ALL BENEFITS                                      *
  9273*                                                             *
  9274***************************************************************
  9275
  9276     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9277                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9278
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 172
* EL1278.cbl
  9279     IF (AM-BENEFIT-CODE (SUB3) = '99')
  9280       AND
  9281        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9282           GO TO 5300-MOVE-LF-REM-TERM.
  9283
  9284     IF (AM-BENEFIT-CODE (SUB3) = '91')
  9285       AND
  9286        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9287        IF CF-REDUCING (WS-INDEX)
  9288           IF CM-INDIVIDUAL
  9289               GO TO 5300-MOVE-LF-REM-TERM.
  9290
  9291     IF (AM-BENEFIT-CODE (SUB3) = '92')
  9292       AND
  9293        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9294        IF CF-REDUCING (WS-INDEX)
  9295           IF CM-GROUP
  9296               GO TO 5300-MOVE-LF-REM-TERM.
  9297
  9298     IF (AM-BENEFIT-CODE (SUB3) = '93')
  9299       AND
  9300        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9301        IF CF-LEVEL (WS-INDEX)
  9302           IF CM-INDIVIDUAL
  9303               GO TO 5300-MOVE-LF-REM-TERM.
  9304
  9305     IF (AM-BENEFIT-CODE (SUB3) = '94')
  9306       AND
  9307        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9308        IF CF-LEVEL (WS-INDEX)
  9309           IF CM-GROUP
  9310               GO TO 5300-MOVE-LF-REM-TERM.
  9311
  9312     IF (AM-BENEFIT-CODE (SUB3) = '98')
  9313       AND
  9314        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9315            GO TO 5300-MOVE-LF-REM-TERM.
  9316
  9317     IF SUB3 LESS THAN +20
  9318        ADD +1           TO SUB3
  9319          GO TO 5200-EDIT-FOR-NINETY-LF.
  9320
  9321     MOVE SPACES         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9322
  9323     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9324         MOVE '0'                 TO WS-LF-AM-REM-TERM-CALC
  9325         GO TO 5900-EXIT.
  9326
  9327     MOVE 1                       TO SUB3.
  9328
  9329 5200-EDIT-FOR-DMD-NINETY-LF.
  9330
  9331     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9332                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9333
  9334     IF (AM-BENEFIT-DMD-CODE (SUB3) = '99')
  9335       AND
  9336        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 173
* EL1278.cbl
  9337           GO TO 5300-MOVE-LF-REM-TERM.
  9338
  9339     IF (AM-BENEFIT-DMD-CODE (SUB3) = '91')
  9340       AND
  9341        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9342        IF CF-REDUCING (WS-INDEX)
  9343           IF CM-INDIVIDUAL
  9344               GO TO 5300-MOVE-LF-REM-TERM.
  9345
  9346     IF (AM-BENEFIT-DMD-CODE (SUB3) = '92')
  9347       AND
  9348        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9349        IF CF-REDUCING (WS-INDEX)
  9350           IF CM-GROUP
  9351               GO TO 5300-MOVE-LF-REM-TERM.
  9352
  9353     IF (AM-BENEFIT-DMD-CODE (SUB3) = '93')
  9354       AND
  9355        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9356        IF CF-LEVEL (WS-INDEX)
  9357           IF CM-INDIVIDUAL
  9358               GO TO 5300-MOVE-LF-REM-TERM.
  9359
  9360     IF (AM-BENEFIT-DMD-CODE (SUB3) = '94')
  9361       AND
  9362        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9363        IF CF-LEVEL (WS-INDEX)
  9364           IF CM-GROUP
  9365               GO TO 5300-MOVE-LF-REM-TERM.
  9366
  9367     IF (AM-BENEFIT-DMD-CODE (SUB3) = '98')
  9368       AND
  9369        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9370            GO TO 5300-MOVE-LF-REM-TERM.
  9371
  9372     IF SUB3 LESS THAN +30
  9373        ADD +1                   TO SUB3
  9374          GO TO 5200-EDIT-FOR-DMD-NINETY-LF.
  9375
  9376     MOVE '0'                    TO WS-LF-AM-REM-TERM-CALC.
  9377
  9378     GO TO 5900-EXIT.
  9379
  9380 5300-MOVE-LF-REM-TERM.
  9381     MOVE WS-SAVE-BENEFIT-REM-TERM
  9382                                 TO WS-LF-AM-REM-TERM-CALC.
  9383
  9384 5900-EXIT.
  9385      EXIT.
  9386
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 174
* EL1278.cbl
  9388
  9389 6000-GET-AH-AM-REM-TERM.
  9390     MOVE +1                     TO SUB3.
  9391
  9392 6100-GET-AH-AM-REM-TERM.
  9393
  9394     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9395        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB3)
  9396           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9397                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9398           GO TO 6300-MOVE-AH-REM-TERM.
  9399
  9400     IF SUB3 LESS THAN +20
  9401        ADD +1                   TO SUB3
  9402        GO TO 6100-GET-AH-AM-REM-TERM.
  9403
  9404     MOVE +1                     TO SUB3.
  9405
  9406     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9407         GO TO 6200-EDIT-FOR-NINETY-AH.
  9408
  9409 6100-GET-AH-AM-DMD-REM-TERM.
  9410     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9411        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9412           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9413                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9414           GO TO 6300-MOVE-AH-REM-TERM.
  9415
  9416     IF SUB3 LESS THAN +30
  9417        ADD +1                   TO SUB3
  9418        GO TO 6100-GET-AH-AM-DMD-REM-TERM.
  9419
  9420     MOVE +1                     TO SUB3.
  9421
  9422 6200-EDIT-FOR-NINETY-AH.
  9423
  9424***************************************************************
  9425*                                                             *
  9426*    NINETY BENEFIT PLAN TYPES:                               *
  9427*                                                             *
  9428*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9429*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9430*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9431*           BENEFIT CONTROLS.                                 *
  9432*      99 = ALL BENEFITS.                                     *
  9433*                                                             *
  9434***************************************************************
  9435
  9436     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9437                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9438
  9439     IF AM-BENEFIT-CODE (SUB3) = '99'
  9440       AND
  9441        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9442           GO TO 6300-MOVE-AH-REM-TERM.
  9443
  9444     IF AM-BENEFIT-CODE (SUB3) = '91'
  9445       AND
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 175
* EL1278.cbl
  9446        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9447           IF CM-INDIVIDUAL
  9448               GO TO 6300-MOVE-AH-REM-TERM.
  9449
  9450     IF AM-BENEFIT-CODE (SUB3) = '92'
  9451       AND
  9452        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9453           IF CM-GROUP
  9454               GO TO 6300-MOVE-AH-REM-TERM.
  9455
  9456     IF AM-BENEFIT-CODE (SUB3) = '98'
  9457       AND
  9458        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9459           GO TO 6300-MOVE-AH-REM-TERM.
  9460
  9461     IF SUB3 LESS THAN +20
  9462        ADD +1                    TO SUB3
  9463        GO TO 6200-EDIT-FOR-NINETY-AH.
  9464
  9465     MOVE +1                      TO SUB3.
  9466
  9467     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9468         MOVE '0'                 TO WS-AH-AM-REM-TERM-CALC
  9469         GO TO 6900-EXIT.
  9470
  9471 6200-EDIT-FOR-DMD-NINETY-AH.
  9472
  9473     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9474                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9475
  9476     IF AM-BENEFIT-DMD-CODE (SUB3) = '99'
  9477       AND
  9478        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9479           GO TO 6300-MOVE-AH-REM-TERM.
  9480
  9481     IF AM-BENEFIT-DMD-CODE (SUB3) = '91'
  9482       AND
  9483        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9484           IF CM-INDIVIDUAL
  9485               GO TO 6300-MOVE-AH-REM-TERM.
  9486
  9487     IF AM-BENEFIT-DMD-CODE (SUB3) = '92'
  9488       AND
  9489        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9490           IF CM-GROUP
  9491               GO TO 6300-MOVE-AH-REM-TERM.
  9492
  9493     IF AM-BENEFIT-DMD-CODE (SUB3) = '98'
  9494       AND
  9495        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9496           GO TO 6300-MOVE-AH-REM-TERM.
  9497
  9498     IF SUB3 LESS THAN +30
  9499        ADD +1                   TO SUB3
  9500        GO TO 6200-EDIT-FOR-DMD-NINETY-AH.
  9501
  9502     MOVE '0'                    TO WS-AH-AM-REM-TERM-CALC.
  9503
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 176
* EL1278.cbl
  9504     GO TO 6900-EXIT.
  9505
  9506 6300-MOVE-AH-REM-TERM.
  9507
  9508     MOVE WS-SAVE-BENEFIT-REM-TERM
  9509                                 TO WS-AH-AM-REM-TERM-CALC.
  9510
  9511 6900-EXIT.
  9512      EXIT.
  9513
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 177
* EL1278.cbl
  9515 7000-GET-ERFORM     SECTION.
  9516
  9517* EXEC CICS HANDLE CONDITION
  9518*        NOTFND  (7000-EXIT)
  9519*    END-EXEC.
  9520*    MOVE '"$I                   ! ( #00008887' TO DFHEIV0
  9521     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9522     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9523     MOVE X'2820233030303038383837' TO DFHEIV0(25:11)
  9524     CALL 'kxdfhei1' USING DFHEIV0
  9525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9526
  9527
  9528     MOVE ' '                    TO  WS-FORM-RECORD-SW.
  9529     MOVE PI-COMPANY-CD          TO  WS-FO-COMPANY-CD.
  9530     MOVE PI-STATE               TO  WS-FO-STATE.
  9531     MOVE CM-POLICY-FORM-NO      TO  WS-FO-FORM-ID.
  9532     MOVE CM-CERT-EFF-DT         TO  WS-FO-EXP-DT.
  9533
  9534
  9535* EXEC CICS READ
  9536*        DATASET  (ERFORM-ID)
  9537*        RIDFLD   (WS-FO-CONTROL-PRIMARY)
  9538*        SET      (ADDRESS OF FORM-MASTER)
  9539*        GTEQ
  9540*    END-EXEC.
  9541*    MOVE '&"S        G          (   #00008897' TO DFHEIV0
  9542     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9543     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9544     MOVE X'2020233030303038383937' TO DFHEIV0(25:11)
  9545     CALL 'kxdfhei1' USING DFHEIV0,
  9546           ERFORM-ID,
  9547           DFHEIV20,
  9548           DFHEIV99,
  9549           WS-FO-CONTROL-PRIMARY,
  9550           DFHEIV99,
  9551           DFHEIV99,
  9552           DFHEIV99
  9553     SET ADDRESS OF FORM-MASTER TO
  9554         DFHEIV20
  9555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9556
  9557
  9558     IF PI-COMPANY-CD     EQUAL FO-COMPANY-CD AND
  9559        PI-STATE          EQUAL FO-STATE      AND
  9560        CM-POLICY-FORM-NO EQUAL FO-FORM-ID
  9561         MOVE 'Y'  TO WS-FORM-RECORD-SW
  9562         GO TO 7000-EXIT.
  9563 7000-EXIT.
  9564     EXIT.
  9565 7100-BENEFIT-SEARCH SECTION.
  9566
  9567     IF CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES
  9568        MOVE +1                  TO  SUB4
  9569        PERFORM 7150-BENEFIT-LIFE-SEARCH THRU 7150-EXIT.
  9570
  9571     IF CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES
  9572        MOVE +1                  TO  SUB4
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 178
* EL1278.cbl
  9573        PERFORM 7250-BENEFIT-AH-SEARCH THRU 7250-EXIT.
  9574 7100-EXIT.
  9575     EXIT.
  9576 7150-BENEFIT-LIFE-SEARCH.
  9577     IF PI-LIFE-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9578       IF CM-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9579         IF (CM-LF-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9580          OR CM-LF-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9581            IF FO-PLAN-REFUND-METHOD (SUB4)
  9582                    IS GREATER THAN SPACES
  9583               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9584                                    WS-LF-FO-REFUND-CALC
  9585               GO TO 7150-EXIT.
  9586
  9587     IF SUB4 LESS THAN +40
  9588         ADD +1              TO SUB4
  9589         GO TO 7150-BENEFIT-LIFE-SEARCH.
  9590
  9591 7150-EXIT.
  9592     EXIT.
  9593 7250-BENEFIT-AH-SEARCH.
  9594     IF PI-AH-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9595       IF CM-AH-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9596         IF (CM-AH-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9597          OR CM-AH-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9598            IF FO-PLAN-REFUND-METHOD (SUB4)
  9599                    IS GREATER THAN SPACES
  9600               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9601                                    WS-AH-FO-REFUND-CALC
  9602               GO TO 7250-EXIT.
  9603
  9604     IF SUB4 LESS THAN +40
  9605         ADD +1              TO SUB4
  9606         GO TO 7250-BENEFIT-AH-SEARCH.
  9607
  9608 7250-EXIT.
  9609     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 179
* EL1278.cbl
  9611
  9612 8100-SEND-INITIAL-MAP  SECTION.
  9613     MOVE SAVE-DATE              TO  HDATEO.
  9614     MOVE EIBTIME                TO  TIME-IN.
  9615     MOVE TIME-OUT               TO  HTIMEO.
  9616     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9617     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9618     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  9619     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  9620
  9621     IF CM-LF-BENEFIT-CD = '00'
  9622         MOVE -1                 TO  HACANCL
  9623     ELSE
  9624         MOVE -1                 TO  HLCANCL.
  9625
  9626     IF PI-COMPANY-ID NOT = 'DCC'
  9627        MOVE AL-SADOF            TO CANREAHA
  9628                                    CLPYNHA
  9629                                    CANREAA
  9630                                    CLPYNA
  9631     END-IF
  9632
  9633
  9634* EXEC CICS SEND
  9635*        FROM    (EL127HO)
  9636*        MAPSET  (MAPSET-NAME)
  9637*        MAP     (MAP-NAME)
  9638*        CURSOR
  9639*        ERASE
  9640*    END-EXEC.
  9641     MOVE LENGTH OF
  9642      EL127HO
  9643       TO DFHEIV12
  9644     MOVE -1
  9645       TO DFHEIV11
  9646*    MOVE '8$     CT  E    H L F ,   #00008979' TO DFHEIV0
  9647     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9648     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9649     MOVE X'2020233030303038393739' TO DFHEIV0(25:11)
  9650     CALL 'kxdfhei1' USING DFHEIV0,
  9651           MAP-NAME,
  9652           EL127HO,
  9653           DFHEIV12,
  9654           MAPSET-NAME,
  9655           DFHEIV99,
  9656           DFHEIV99,
  9657           DFHEIV99,
  9658           DFHEIV11,
  9659           DFHEIV99,
  9660           DFHEIV99,
  9661           DFHEIV99
  9662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9663
  9664
  9665     GO TO 9000-RETURN-TRAN.
  9666
  9667 8200-SEND-DATAONLY  SECTION.
  9668     IF FIRST-ENTRY
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 180
* EL1278.cbl
  9669         GO TO 8100-SEND-INITIAL-MAP.
  9670
  9671     MOVE SAVE-DATE              TO  HDATEO.
  9672     MOVE EIBTIME                TO  TIME-IN.
  9673     MOVE TIME-OUT               TO  HTIMEO.
  9674     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9675     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9676     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  9677     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  9678     MOVE -1                     TO  HLCANCL.
  9679
  9680
  9681* EXEC CICS SEND DATAONLY
  9682*        FROM    (EL127HO)
  9683*        MAPSET  (MAPSET-NAME)
  9684*        MAP     (MAP-NAME)
  9685*        CURSOR
  9686*    END-EXEC.
  9687     MOVE LENGTH OF
  9688      EL127HO
  9689       TO DFHEIV12
  9690     MOVE -1
  9691       TO DFHEIV11
  9692*    MOVE '8$D    CT       H L F ,   #00009002' TO DFHEIV0
  9693     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  9694     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9695     MOVE X'2020233030303039303032' TO DFHEIV0(25:11)
  9696     CALL 'kxdfhei1' USING DFHEIV0,
  9697           MAP-NAME,
  9698           EL127HO,
  9699           DFHEIV12,
  9700           MAPSET-NAME,
  9701           DFHEIV99,
  9702           DFHEIV99,
  9703           DFHEIV99,
  9704           DFHEIV11,
  9705           DFHEIV99,
  9706           DFHEIV99,
  9707           DFHEIV99
  9708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9709
  9710
  9711     GO TO 9000-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 181
* EL1278.cbl
  9713 8300-SEND-TEXT  SECTION.
  9714
  9715* EXEC CICS SEND TEXT
  9716*        FROM    (LOGOFF-TEXT)
  9717*        LENGTH  (LOGOFF-LENGTH)
  9718*        ERASE
  9719*        FREEKB
  9720*    END-EXEC.
  9721*    MOVE '8&      T  E F  H   F -   #00009012' TO DFHEIV0
  9722     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9723     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9724     MOVE X'2020233030303039303132' TO DFHEIV0(25:11)
  9725     CALL 'kxdfhei1' USING DFHEIV0,
  9726           LOGOFF-TEXT,
  9727           LOGOFF-LENGTH,
  9728           DFHEIV99,
  9729           DFHEIV99,
  9730           DFHEIV99,
  9731           DFHEIV99,
  9732           DFHEIV99,
  9733           DFHEIV99,
  9734           DFHEIV99,
  9735           DFHEIV99,
  9736           DFHEIV99,
  9737           DFHEIV99
  9738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9739
  9740
  9741
  9742* EXEC CICS RETURN
  9743*    END-EXEC.
  9744*    MOVE '.(                    ''   #00009019' TO DFHEIV0
  9745     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9746     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9747     MOVE X'2020233030303039303139' TO DFHEIV0(25:11)
  9748     CALL 'kxdfhei1' USING DFHEIV0,
  9749           DFHEIV99,
  9750           DFHEIV99,
  9751           DFHEIV99,
  9752           DFHEIV99,
  9753           DFHEIV99,
  9754           DFHEIV99
  9755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9756
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 182
* EL1278.cbl
  9758 8600-DEEDIT  SECTION.
  9759
  9760* EXEC CICS BIF DEEDIT
  9761*        FIELD   (DEEDIT-FIELD)
  9762*        LENGTH  (15)
  9763*    END-EXEC.
  9764     MOVE 15
  9765       TO DFHEIV11
  9766*    MOVE '@"L                   #   #00009023' TO DFHEIV0
  9767     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9768     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9769     MOVE X'2020233030303039303233' TO DFHEIV0(25:11)
  9770     CALL 'kxdfhei1' USING DFHEIV0,
  9771           DEEDIT-FIELD,
  9772           DFHEIV11
  9773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9774
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 183
* EL1278.cbl
  9776 8700-UNAUTHORIZED-ACCESS  SECTION.
  9777     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  9778
  9779     GO TO 8300-SEND-TEXT.
  9780
  9781 8800-PF23  SECTION.
  9782     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  9783     MOVE XCTL-005               TO  PGM-NAME.
  9784
  9785     GO TO 9200-XCTL.
  9786
  9787 8900-RETURN-CICS  SECTION.
  9788
  9789* EXEC CICS RETURN
  9790*    END-EXEC.
  9791*    MOVE '.(                    ''   #00009040' TO DFHEIV0
  9792     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9793     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9794     MOVE X'2020233030303039303430' TO DFHEIV0(25:11)
  9795     CALL 'kxdfhei1' USING DFHEIV0,
  9796           DFHEIV99,
  9797           DFHEIV99,
  9798           DFHEIV99,
  9799           DFHEIV99,
  9800           DFHEIV99,
  9801           DFHEIV99
  9802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9803
  9804
  9805 9000-RETURN-TRAN  SECTION.
  9806     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  9807     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  9808
  9809
  9810* EXEC CICS RETURN
  9811*        TRANSID   (TRANS-ID)
  9812*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  9813*        LENGTH    (PI-COMM-LENGTH)
  9814*    END-EXEC.
  9815*    MOVE '.(CT                  ''   #00009047' TO DFHEIV0
  9816     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9817     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9818     MOVE X'2020233030303039303437' TO DFHEIV0(25:11)
  9819     CALL 'kxdfhei1' USING DFHEIV0,
  9820           TRANS-ID,
  9821           PROGRAM-INTERFACE-BLOCK,
  9822           PI-COMM-LENGTH,
  9823           DFHEIV99,
  9824           DFHEIV99,
  9825           DFHEIV99
  9826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9827
  9828
  9829 9100-RETURN-MAIN-MENU  SECTION.
  9830     MOVE XCTL-126               TO  PGM-NAME.
  9831
  9832     GO TO 9200-XCTL.
  9833
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 184
* EL1278.cbl
  9834 9200-XCTL  SECTION.
  9835
  9836* EXEC CICS XCTL
  9837*        PROGRAM   (PGM-NAME)
  9838*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  9839*        LENGTH    (PI-COMM-LENGTH)
  9840*    END-EXEC.
  9841*    MOVE '.$C                   %   #00009059' TO DFHEIV0
  9842     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9843     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9844     MOVE X'2020233030303039303539' TO DFHEIV0(25:11)
  9845     CALL 'kxdfhei1' USING DFHEIV0,
  9846           PGM-NAME,
  9847           PROGRAM-INTERFACE-BLOCK,
  9848           PI-COMM-LENGTH,
  9849           DFHEIV99
  9850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9851
  9852
  9853 9300-CLEAR  SECTION.
  9854     MOVE ' '                    TO  PI-PEND-SW.
  9855     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  9856
  9857     GO TO 9200-XCTL.
  9858
  9859 9400-PF12  SECTION.
  9860     MOVE XCTL-010               TO  PGM-NAME.
  9861
  9862     GO TO 9200-XCTL.
  9863
  9864 9500-PGMID-ERROR  SECTION.
  9865
  9866* EXEC CICS HANDLE CONDITION
  9867*        PGMIDERR  (8300-SEND-TEXT)
  9868*    END-EXEC.
  9869*    MOVE '"$L                   ! ) #00009077' TO DFHEIV0
  9870     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  9871     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9872     MOVE X'2920233030303039303737' TO DFHEIV0(25:11)
  9873     CALL 'kxdfhei1' USING DFHEIV0
  9874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9875
  9876
  9877     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  9878     MOVE ' '                    TO  PI-ENTRY-CD-1.
  9879     MOVE XCTL-005               TO  PGM-NAME.
  9880     MOVE PGM-NAME               TO  LOGOFF-PGM.
  9881     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  9882
  9883     GO TO 9200-XCTL.
  9884
  9885 9600-DATE-LINK  SECTION.
  9886     MOVE LINK-ELDATCV           TO  PGM-NAME
  9887
  9888
  9889* EXEC CICS LINK
  9890*        PROGRAM   (PGM-NAME)
  9891*        COMMAREA  (DATE-CONVERSION-DATA)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 185
* EL1278.cbl
  9892*        LENGTH    (DC-COMM-LENGTH)
  9893*    END-EXEC.
  9894*    MOVE '."C                   (   #00009092' TO DFHEIV0
  9895     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9896     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9897     MOVE X'2020233030303039303932' TO DFHEIV0(25:11)
  9898     CALL 'kxdfhei1' USING DFHEIV0,
  9899           PGM-NAME,
  9900           DATE-CONVERSION-DATA,
  9901           DC-COMM-LENGTH,
  9902           DFHEIV99,
  9903           DFHEIV99,
  9904           DFHEIV99,
  9905           DFHEIV99
  9906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9907
  9908
  9909
  9910 9700-ERROR-FORMAT  SECTION.
  9911     IF NOT EMI-ERRORS-COMPLETE
  9912         MOVE LINK-001               TO  PGM-NAME
  9913
  9914* EXEC CICS LINK
  9915*            PROGRAM   (PGM-NAME)
  9916*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  9917*            LENGTH    (EMI-COMM-LENGTH)
  9918*        END-EXEC.
  9919*    MOVE '."C                   (   #00009102' TO DFHEIV0
  9920     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9921     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9922     MOVE X'2020233030303039313032' TO DFHEIV0(25:11)
  9923     CALL 'kxdfhei1' USING DFHEIV0,
  9924           PGM-NAME,
  9925           ERROR-MESSAGE-INTERFACE-BLOCK,
  9926           EMI-COMM-LENGTH,
  9927           DFHEIV99,
  9928           DFHEIV99,
  9929           DFHEIV99,
  9930           DFHEIV99
  9931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9932
  9933
  9934 9799-EXIT.
  9935     EXIT.
  9936
  9937 9800-SECURITY-VIOLATION  SECTION.
  9938*                            COPY ELCSCTP.
  9939******************************************************************
  9940*                                                                *
  9941*                            ELCSCTP                             *
  9942*                            VMOD=2.001                          *
  9943*                                                                *
  9944*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  9945******************************************************************
  9946
  9947
  9948     MOVE EIBDATE          TO SM-JUL-DATE.
  9949     MOVE EIBTRMID         TO SM-TERMID.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 186
* EL1278.cbl
  9950     MOVE THIS-PGM         TO SM-PGM.
  9951     MOVE EIBTIME          TO TIME-IN.
  9952     MOVE TIME-OUT         TO SM-TIME.
  9953     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  9954
  9955
  9956* EXEC CICS LINK
  9957*         PROGRAM  ('EL003')
  9958*         COMMAREA (SECURITY-MESSAGE)
  9959*         LENGTH   (80)
  9960*    END-EXEC.
  9961     MOVE 'EL003' TO DFHEIV1
  9962     MOVE 80
  9963       TO DFHEIV11
  9964*    MOVE '."C                   (   #00009129' TO DFHEIV0
  9965     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9966     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9967     MOVE X'2020233030303039313239' TO DFHEIV0(25:11)
  9968     CALL 'kxdfhei1' USING DFHEIV0,
  9969           DFHEIV1,
  9970           SECURITY-MESSAGE,
  9971           DFHEIV11,
  9972           DFHEIV99,
  9973           DFHEIV99,
  9974           DFHEIV99,
  9975           DFHEIV99
  9976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9977
  9978
  9979******************************************************************
  9980
  9981
  9982 9899-EXIT.
  9983     EXIT.
  9984
  9985 9900-ABEND  SECTION.
  9986     MOVE LINK-004               TO  PGM-NAME.
  9987     MOVE DFHEIBLK               TO  EMI-LINE1.
  9988
  9989
  9990* EXEC CICS LINK
  9991*        PROGRAM   (PGM-NAME)
  9992*        COMMAREA  (EMI-LINE1)
  9993*        LENGTH    (72)
  9994*    END-EXEC.
  9995     MOVE 72
  9996       TO DFHEIV11
  9997*    MOVE '."C                   (   #00009145' TO DFHEIV0
  9998     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9999     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10000     MOVE X'2020233030303039313435' TO DFHEIV0(25:11)
 10001     CALL 'kxdfhei1' USING DFHEIV0,
 10002           PGM-NAME,
 10003           EMI-LINE1,
 10004           DFHEIV11,
 10005           DFHEIV99,
 10006           DFHEIV99,
 10007           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 187
* EL1278.cbl
 10008           DFHEIV99
 10009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10010
 10011
 10012     MOVE -1                     TO  HLCANCL.
 10013
 10014     GO TO 8200-SEND-DATAONLY.
 10015
 10016 9999-LAST-PARAGRAPH.
 10017
 10018* GOBACK.
 10019     MOVE '9%                    "   ' TO DFHEIV0
 10020     MOVE 'EL1278' TO DFHEIV1
 10021     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10022     GOBACK.
 10023
 10024 9999-DFHBACK SECTION.
 10025     MOVE '9%                    "   ' TO DFHEIV0
 10026     MOVE 'EL1278' TO DFHEIV1
 10027     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10028     GOBACK.
 10029 9999-DFHEXIT.
 10030     IF DFHEIGDJ EQUAL 0001
 10031         NEXT SENTENCE
 10032     ELSE IF DFHEIGDJ EQUAL 2
 10033         GO TO 9500-PGMID-ERROR,
 10034               9900-ABEND
 10035         DEPENDING ON DFHEIGDI
 10036     ELSE IF DFHEIGDJ EQUAL 3
 10037         GO TO 0910-NOT-FOUND
 10038         DEPENDING ON DFHEIGDI
 10039     ELSE IF DFHEIGDJ EQUAL 4
 10040         GO TO 1010-NOTFND,
 10041               1020-NOTOPEN
 10042         DEPENDING ON DFHEIGDI
 10043     ELSE IF DFHEIGDJ EQUAL 5
 10044         GO TO 1290-ACCT-NOT-FOUND,
 10045               1290-ACCT-NOT-FOUND
 10046         DEPENDING ON DFHEIGDI
 10047     ELSE IF DFHEIGDJ EQUAL 6
 10048         GO TO 0580-ACCT-NOT-FOUND,
 10049               0580-ACCT-NOT-FOUND
 10050         DEPENDING ON DFHEIGDI
 10051     ELSE IF DFHEIGDJ EQUAL 7
 10052         GO TO 1699-EXIT
 10053         DEPENDING ON DFHEIGDI
 10054     ELSE IF DFHEIGDJ EQUAL 8
 10055         GO TO 7000-EXIT
 10056         DEPENDING ON DFHEIGDI
 10057     ELSE IF DFHEIGDJ EQUAL 9
 10058         GO TO 8300-SEND-TEXT
 10059         DEPENDING ON DFHEIGDI.
 10060     MOVE '9%                    "   ' TO DFHEIV0
 10061     MOVE 'EL1278' TO DFHEIV1
 10062     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10063     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 188
* EL1278.cbl
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        8608     Code:       26305
