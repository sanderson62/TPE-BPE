* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page   1
* EL6318.cbl
* Options: int("EL6318.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6318.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6318.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6318.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6318.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page   2
* EL6318.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24*          2011022800001  PEMA  NEW PROGRAM
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 060612   2011022800001  AJRA  NAPERSOFT
    27* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    28* 072312   2011022800001  AJRA  NAPERSOFT MISC
    29* 102212   2012101700002  AJRA  SCREEN ID
    30* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    31* 110612   2012101700002  AJRA  ADD NEW FIELDS
    32* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    33* 121012   2012101700002  AJRA  HIGHLIGHT REASON CODES
    34* 121112   2012101700002  AJRA  CHANGE PF1, PF2 TO PF3, PF4
    35* 121212   2012101700002  AJRA  CHG LAST 2 CERT NOTES TO BILLING N
    36* 121712   2012101700002  AJRA  ADD DEFAULT AGE FLAG
    37* 122712   2012122700001  AJRA  FIX CERT PRINT FLAG
    38* 011413 IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    39* 091913   2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
    40* 120313   2013090300001  AJRA  NAPERSOFT PHASE 2
    41* 121713   2013090300001  AJRA  ADD ENCLOSURE CODE TO SCREEN
    42* 091615 CR2015082000001  PEMA  ADD XFR TO EL677
    43*-----------------------------------------------------------------
    44*REMARKS.
    45*        TRANSACTION - EXBE - GENERAL CHANGE ENDORSEMENT
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page   3
* EL6318.cbl
    47 ENVIRONMENT DIVISION.
    48 DATA DIVISION.
    49 WORKING-STORAGE SECTION.
    50 01  DFH-START PIC X(04).
    51 77  FILLER  PIC X(32)  VALUE '********************************'.
    52 77  FILLER  PIC X(32)  VALUE '*    EL6318 WORKING STORAGE    *'.
    53 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    54 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    55 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    56 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    57 77  s1                          pic s999 comp-3 value +0.
    58 77  s2                          pic s999 comp-3 value +0.
    59 77  W-ARCH-NUMBER               PIC S9(08)      COMP value +0.
    60 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    61     88  ACCT-FOUND                 VALUE 'Y'.
    62 77  WS-CHGBACK                 PIC 99  VALUE ZEROS.
    63 77  WS-CSO-PORTION              PIC S9(5)V99 COMP-3 VALUE +0.
    64 77  WS-ACCT-PORTION             PIC S9(5)V99 COMP-3 VALUE +0.
    65 77  WS-DIFF                     PIC 99 VALUE ZEROS.
    66 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    67 77  WS-DUE-BORROWER             PIC S9(7)V99 COMP-3 VALUE +0.
    68 77  WS-REASON-SW                PIC X  VALUE ' '.
    69     88  REASONS-FOUND                  VALUE 'Y'.
    70     88  REASONS-NOT-FOUND              VALUE 'N'.
    71 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    72     88  NO-CERT-RW                 VALUE 'N'.
    73     88  CERT-RW                    VALUE 'Y'.
    74 77  ws-el677-check-cut         pic x value 'N'.
    75 77  ws-el677-check-type        pic x value 'N'.
    76 01  P pointer.
    77 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    78 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    79 01  var-ptr pointer.
    80 01  env-var-len                 pic 9(4)  binary.
    81 01  rc                          pic 9(9)  binary.
    82 01  WS-KIXHOST                  PIC X(10).
    83 01  WS-KIXSYS.
    84     05  WS-KIX-FIL1             PIC X(10).
    85     05  WS-KIX-APPS             PIC X(10).
    86     05  WS-KIX-ENV              PIC X(10).
    87     05  WS-KIX-MYENV            PIC X(10).
    88     05  WS-KIX-SYS              PIC X(10).
    89*                                COPY ELCSCTM.
    90******************************************************************
    91*                                                                *
    92*                                                                *
    93*                            ELCSCTM                             *
    94*                            VMOD=2.001                          *
    95*                                                                *
    96*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    97*                                                                *
    98******************************************************************
    99 01  SECURITY-MESSAGE.
   100     12  FILLER                          PIC X(30)
   101            VALUE '** LOGIC SECURITY VIOLATION -'.
   102     12  SM-READ                         PIC X(6).
   103     12  FILLER                          PIC X(5)
   104            VALUE ' PGM='.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page   4
* EL6318.cbl
   105     12  SM-PGM                          PIC X(6).
   106     12  FILLER                          PIC X(5)
   107            VALUE ' OPR='.
   108     12  SM-PROCESSOR-ID                 PIC X(4).
   109     12  FILLER                          PIC X(6)
   110            VALUE ' TERM='.
   111     12  SM-TERMID                       PIC X(4).
   112     12  FILLER                          PIC XX   VALUE SPACE.
   113     12  SM-JUL-DATE                     PIC 9(5).
   114     12  FILLER                          PIC X    VALUE SPACE.
   115     12  SM-TIME                         PIC 99.99.
   116
   117*                                COPY ELCSCRTY.
   118******************************************************************
   119*                                                                *
   120*                                                                *
   121*                            ELCSCRTY                            *
   122*                            VMOD=2.001                          *
   123*                                                                *
   124*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   125*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   126*        SAVED IN PI-SECURITY-ADDRESS.                           *
   127*                                                                *
   128******************************************************************
   129 01  SECURITY-CONTROL.
   130     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   131     12  FILLER                       PIC XX    VALUE 'SC'.
   132     12  SC-CREDIT-CODES.
   133         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   134             20  SC-CREDIT-DISPLAY    PIC X.
   135             20  SC-CREDIT-UPDATE     PIC X.
   136     12  SC-CLAIMS-CODES.
   137         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   138             20  SC-CLAIMS-DISPLAY    PIC X.
   139             20  SC-CLAIMS-UPDATE     PIC X.
   140 01 srch-commarea.
   141*                                copy ELCADLTRSPI.
   142******************************************************************
   143*                   C H A N G E   L O G
   144*
   145* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   146*-----------------------------------------------------------------
   147*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   148* EFFECTIVE    NUMBER
   149*-----------------------------------------------------------------
   150* 060611    2011022800001  PEMA  NEW COPYBOOK
   151* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   152* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   153******************************************************************
   154****************************************
   155*  commarea for NaperSoft On Demand Admin services letters
   156*  (business logic input & output)
   157****************************************
   158     03  BL-INPUT.
   159         05  BL-DATA-SRCE        PIC X.
   160         05  BL-LETTER-ID        PIC XXXX.
   161         05  BL-CARRIER          PIC X.
   162         05  BL-GROUP            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page   5
* EL6318.cbl
   163         05  BL-STATE            PIC XX.
   164         05  BL-ACCOUNT          PIC X(10).
   165         05  BL-EFF-DT           PIC X(10).
   166         05  BL-CERT-NO          PIC X(11).
   167         05  BL-BATCH-NO         PIC X(6).
   168         05  BL-BATCH-SEQ        PIC 9(8).
   169         05  BL-RESP-NO          PIC X(10).
   170         05  BL-NO-OF-COPIES     PIC 99.
   171         05  BL-PROC-ID          PIC XXXX.
   172         05  BL-COMP-ID          PIC XXX.
   173         05  BL-PRINT-NOW-SW     PIC X.
   174         05  BL-ENC-CD           PIC XXX.
   175         05  BL-RESEND-DT        PIC X(10).
   176         05  BL-FOLLOW-UP-DT     PIC X(10).
   177         05  BL-ARCHIVE-NO       PIC 9(8).
   178         05  BL-FUNC             PIC X(8).
   179         05  BL-COMMENTS         PIC X(100).
   180         05  FILLER REDEFINES BL-COMMENTS.
   181             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   182             10  BL-LETTER-TO-ACCT PIC X.
   183             10  BL-LETTER-TO-BENE PIC X.
   184             10  BL-WRITE-ERARCH   PIC X.
   185                 88  ERARCH-QWS      VALUE 'Q'.
   186                 88  ERARCH-BATCH    VALUE 'B'.
   187                 88  ERARCH-TEMP     VALUE 'T'.
   188             10  BL-PROCESS-TYPE PIC X(07).
   189             10  BL-CERT-FORM-ID PIC X(05).
   190             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   191             10  BL-SOURCE-SCREEN PIC X(8).
   192             10  FILLER          PIC X(25).
   193     03  BL-OUTPUT.
   194         05  BL-STATUS                   PIC X.
   195             88  BL-OK                      VALUE "P".
   196             88  BL-FAIL                  VALUE "F".
   197         05  BL-MESSAGE          PIC X(50).
   198     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   199     03  FILLER                  PIC X(31).
   200
   201*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   202*                                COPY ELCZREC.
   203******************************************************************
   204*                                                                *
   205*                                                                *
   206*                            ELCZREC.                            *
   207*                                                                *
   208*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   209*                                                                *
   210******************************************************************
   211*-----------------------------------------------------------------
   212*                   C H A N G E   L O G
   213*
   214* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   215*-----------------------------------------------------------------
   216*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   217* EFFECTIVE    NUMBER
   218*-----------------------------------------------------------------
   219* 122011    2011022800001  AJRA  NEW FILE
   220* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page   6
* EL6318.cbl
   221* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   222* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   223* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   224*-----------------------------------------------------------------
   225 01  W-Z-CONTROL-DATA.
   226     05  W-NUMBER-OF-COPIES      PIC  9.
   227     05  FILLER                  PIC  X.
   228     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   229     05  FILLER                  PIC  X.
   230     05  W-DAYS-TO-RESEND        PIC  999.
   231     05  FILLER                  PIC  X.
   232     05  W-FORM-TO-RESEND        PIC  X(4).
   233     05  W-ADD-BAR-CODE          PIC  X.
   234     05  W-PROMPT-LETTER         PIC  X.
   235     05  W-HAS-RETURN-ENV        PIC  X.
   236     05  W-ENCLOSURE-CD          PIC  XXX.
   237     05  W-SIG-FLAG-DEFAULT      PIC  X.
   238     05  W-AUTO-CLOSE-IND        PIC  X.
   239     05  FILLER                  PIC  X.
   240     05  W-LETTER-TO-BENE        PIC  X.
   241     05  FILLER                  PIC  X.
   242     05  W-LETTER-TO-ACCT        PIC  X.
   243     05  FILLER                  PIC  X.
   244     05  W-LETTER-TYPE           PIC  X.
   245     05  FILLER                  PIC  X.
   246     05  W-PRINT-CERTIFICATE     PIC  X.
   247     05  FILLER                  PIC  X.
   248     05  W-REFUND-REQUIRED       PIC  X.
   249     05  FILLER                  PIC  X.
   250     05  W-ONBASE-CODE           PIC  XX.
   251     05  FILLER                  PIC  X.
   252     05  W-ACCT-SUMM             PIC  X.
   253     05  FILLER                  PIC  X.
   254     05  W-CSO-SUMM              PIC  X.
   255     05  FILLER                  PIC  X.
   256     05  W-REASONS-REQUIRED      PIC  X.
   257     05  FILLER                  PIC  X(29).
   258 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   259 01  STANDARD-AREAS.
   260     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   261     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   262                                 PIC  X(08).
   263     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
   264     12  QID.
   265         16  QID-TERM        PIC X(4)    VALUE SPACES.
   266         16  FILLER          PIC X(4)    VALUE '631K'.
   267     12  MAP-LENGTH          PIC 9(4)   VALUE 359 BINARY.
   268     12  TIME-MT                 PIC S9(7).
   269     12  TIME-MT-R  REDEFINES TIME-MT.
   270         16  FILLER              PIC X.
   271         16  TIME-LMT            PIC 99V99.
   272         16  FILLER              PIC X(2).
   273     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   274     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   275     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   276     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   277     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   278     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page   7
* EL6318.cbl
   279     12  ELCRTT-LENGTH           PIC S9(4) COMP VALUE +552.
   280     12  ELENCC-LENGTH           PIC S9(04) VALUE +400 COMP.
   281     12  W-CNTL-KEY.
   282         16  W-CNTL-COMPANY-ID   PIC  X(03).
   283         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   284         16  W-CNTL-GENL.
   285             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   286             20  W-CNTL-GEN2.
   287                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   288                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   289         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   290     12  WS-ELCERT-KEY.
   291         16  W-CERT-COMPANY-CD   PIC X.
   292         16  W-CERT-CARRIER      PIC X.
   293         16  W-CERT-GROUPING     PIC X(6).
   294         16  W-CERT-STATE        PIC XX.
   295         16  W-CERT-ACCOUNT      PIC X(10).
   296         16  W-CERT-CERT-EFF-DT  PIC XX.
   297         16  W-CERT-CERT-PRIME   PIC X(10).
   298         16  W-CERT-CERT-SFX     PIC X.
   299     12  WS-ELEOBC-KEY.
   300         16  WS-EOBC-COMPANY-CD  PIC X.
   301         16  WS-EOBC-REC-TYPE    PIC X.
   302         16  WS-EOBC-CODE        PIC X(4).
   303         16  FILLER              PIC X(9).
   304     12  WS-ERNOTE-KEY.
   305         16  W-NOTE-COMPANY-CD   PIC X.
   306         16  W-NOTE-CARRIER      PIC X.
   307         16  W-NOTE-GROUPING     PIC X(6).
   308         16  W-NOTE-STATE        PIC XX.
   309         16  W-NOTE-ACCOUNT      PIC X(10).
   310         16  W-NOTE-CERT-EFF-DT  PIC XX.
   311         16  W-NOTE-CERT-PRIME   PIC X(10).
   312         16  W-NOTE-CERT-SFX     PIC X.
   313     12  ELLETR-KEY.
   314         16  LETR-PART-KEY.
   315             20  LETR-COMPANY-CD PIC X.
   316             20  LETR-LETTER-ID  PIC X(4).
   317         16  LETR-FILLER         PIC X(8).
   318         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   319     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   320     12  ERPNDB2-KEY.
   321         16  PNDB2-COMPANY-CD    PIC X.
   322         16  PNDB2-CARRIER       PIC X.
   323         16  PNDB2-GROUPING      PIC X(6).
   324         16  PNDB2-STATE         PIC XX.
   325         16  PNDB2-ACCOUNT       PIC X(10).
   326         16  PNDB2-CERT-EFF-DT   PIC XX.
   327         16  PNDB2-CERT-PRIME    PIC X(10).
   328         16  PNDB2-CERT-SFX      PIC X.
   329         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   330         16  PNDB2-RECORD-TYPE   PIC X.
   331     12  ERPNDB-KEY.
   332         16  PNDB-COMPANY-CD     PIC X.
   333         16  PNDB-BATCH-NO       PIC X(6).
   334         16  PNDB-BATCH-SEQ-NO   PIC 9(4) BINARY.
   335         16  PNDB-CHG-SEQ-NO     PIC 9(4) BINARY.
   336     12  ERENDT-KEY.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page   8
* EL6318.cbl
   337         16  ENDT-COMPANY-CD       PIC X.
   338         16  ENDT-CARRIER          PIC X.
   339         16  ENDT-GROUPING         PIC X(6).
   340         16  ENDT-STATE            PIC XX.
   341         16  ENDT-ACCOUNT          PIC X(10).
   342         16  ENDT-CERT-EFF-DT      PIC XX.
   343         16  ENDT-CERT-PRIME       PIC X(10).
   344         16  ENDT-CERT-SFX         PIC X.
   345         16  ENDT-RECORD-TYPE      PIC X.
   346         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   347     12  ELCRTO-KEY.
   348         16  CRTO-COMPANY-CD     PIC X.
   349         16  CRTO-CARRIER        PIC X.
   350         16  CRTO-GROUPING       PIC X(6).
   351         16  CRTO-STATE          PIC XX.
   352         16  CRTO-ACCOUNT        PIC X(10).
   353         16  CRTO-CERT-EFF-DT    PIC XX.
   354         16  CRTO-CERT-PRIME     PIC X(10).
   355         16  CRTO-CERT-SFX       PIC X.
   356         16  CRTO-RECORD-TYPE    PIC X.
   357         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   358     12  WS-ELCRTT-KEY.
   359         16  WS-ELCRTT-PRIMARY   PIC X(33).
   360         16  WS-ELCRTT-REC-TYPE  PIC X(1).
   361     12  WS-ERMAIL-KEY.
   362         16  MAIL-COMPANY-CD     PIC X.
   363         16  MAIL-CARRIER        PIC X.
   364         16  MAIL-GROUPING       PIC X(6).
   365         16  MAIL-STATE          PIC XX.
   366         16  MAIL-ACCOUNT        PIC X(10).
   367         16  MAIL-CERT-EFF-DT    PIC XX.
   368         16  MAIL-CERT-PRIME     PIC X(10).
   369         16  MAIL-CERT-SFX       PIC X.
   370
   371     12  WS-ELENCC-KEY.
   372         16  WS-ENCC-COMPANY-CD  PIC X.
   373         16  WS-ENCC-REC-TYPE    PIC X.
   374         16  WS-ENCC-ENC-CODE    PIC X(5).
   375         16  FILLER              PIC X(09).
   376
   377     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   378     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   379     12  WS-CURRENT-DT.
   380         16  FILLER              PIC X(6)    VALUE SPACES.
   381         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   382     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   383     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   384         88  CANCEL-REC            VALUE 'C'.
   385         88  ISSUE-REC             VALUE 'I'.
   386     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   387     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   388     12  ELCNTL-KEY.
   389         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   390         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   391         16  CNTL-ACCESS.
   392             20  CNTL-STATE      PIC XX    VALUE SPACES.
   393             20  FILLER          PIC X     VALUE SPACES.
   394             20  CNTL-CARRIER    PIC X     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page   9
* EL6318.cbl
   395         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   396     12  WS-ERACCT-KEY.
   397         16  ACCT-COMPANY-CD     PIC X.
   398         16  ACCT-CARRIER        PIC X.
   399         16  ACCT-GROUPING       PIC X(6).
   400         16  ACCT-STATE          PIC XX.
   401         16  ACCT-ACCOUNT        PIC X(10).
   402         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   403         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   404     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
   405     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   406     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   407     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   408     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   409     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   410     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   411     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   412     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   413     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   414     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   415     12  WS-ELCRTT-FILE-ID       PIC X(8) VALUE 'ELCRTT'.
   416     12  WS-ELENCC-FILE-ID       PIC X(8) VALUE 'ELENCC'.
   417     12  WS-RESPONSE             PIC S9(8)   COMP.
   418         88  RESP-NORMAL                  VALUE +00.
   419         88  RESP-NOTFND                  VALUE +13.
   420         88  RESP-DUPREC                  VALUE +14.
   421         88  RESP-DUPKEY                  VALUE +15.
   422         88  RESP-NOTOPEN                 VALUE +19.
   423         88  RESP-ENDFILE                 VALUE +20.
   424     12  MAP-NAME            PIC X(8)    VALUE 'EL631K'.
   425     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6318S'.
   426     12  SCREEN-NUMBER       PIC X(4)    VALUE '631K'.
   427     12  TRANS-ID            PIC X(4)    VALUE 'EXBE'.
   428     12  THIS-PGM            PIC X(8)    VALUE 'EL6318'.
   429     12  PGM-NAME            PIC X(8).
   430     12  TIME-IN             PIC S9(7).
   431     12  TIME-OUT-R  REDEFINES TIME-IN.
   432         16  FILLER          PIC X.
   433         16  TIME-OUT        PIC 99V99.
   434         16  FILLER          PIC X(2).
   435     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   436     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   437     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   438     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   439     12  XCTL-677            PIC X(8)    VALUE 'EL677'.
   440     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   441     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   442     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   443     12  WS-PHONE.
   444         16  WS-PH1              PIC XXX.
   445         16  WS-PH2              PIC XXX.
   446         16  WS-PH3              PIC XXXX.
   447     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   448     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   449
   450     12  WS-BILLING-NOTE.
   451         16  WS-BN-NOTE          PIC X(25).
   452         16  WS-BN-LTRID         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  10
* EL6318.cbl
   453         16  FILLER              PIC X(3).
   454         16  WS-BN-DATE          PIC X(8).
   455         16  FILLER              PIC X(3).
   456         16  WS-BN-USERID        PIC X(4).
   457         16  FILLER              PIC X(30).
   458     12  WS-MANUAL-BILL-NOTE REDEFINES WS-BILLING-NOTE.
   459         16  WS-MAN-BN-NOTE      PIC X(63).
   460         16  FILLER              PIC X(14).
   461     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   462
   463     12  WS-SAVE-REASON-CODE-IND PIC X(26).
   464
   465 01  NEW-ELCRTO-REC.
   466     12  NEW-ELCRTO-KEY.
   467         16  NCRTO-COMPANY-CD      PIC X.
   468         16  NCRTO-CARRIER         PIC X.
   469         16  NCRTO-GROUPING        PIC X(6).
   470         16  NCRTO-STATE           PIC XX.
   471         16  NCRTO-ACCOUNT         PIC X(10).
   472         16  NCRTO-CERT-EFF-DT     PIC XX.
   473         16  NCRTO-CERT-PRIME      PIC X(10).
   474         16  NCRTO-CERT-SFX        PIC X.
   475         16  NCRTO-RECORD-TYPE     PIC X.
   476         16  NCRTO-SEQ-NO          PIC 9(4) BINARY.
   477     12  NEW-ORIG-REC.
   478         16  NCRTO-INS-LAST-NAME   PIC X(15).
   479         16  NCRTO-INS-FIRST-NAME  PIC X(10).
   480         16  NCRTO-INS-MIDDLE-INIT PIC X.
   481         16  NCRTO-INS-AGE         PIC S999     COMP-3.
   482         16  NCRTO-JNT-LAST-NAME   PIC X(15).
   483         16  NCRTO-JNT-FIRST-NAME  PIC X(10).
   484         16  NCRTO-JNT-MIDDLE-INIT PIC X.
   485         16  NCRTO-JNT-AGE         PIC S999     COMP-3.
   486         16  NCRTO-LF-BENCD        PIC XX.
   487         16  NCRTO-LF-TERM         PIC S999      COMP-3.
   488         16  NCRTO-LF-BEN-AMT      PIC S9(9)V99  COMP-3.
   489         16  NCRTO-LF-PRM-AMT      PIC S9(7)V99  COMP-3.
   490         16  NCRTO-LF-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
   491         16  NCRTO-LF-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
   492         16  NCRTO-LF-EXP-DT       PIC XX.
   493         16  NCRTO-LF-COMM-PCT     PIC SV9(5)    COMP-3.
   494         16  NCRTO-LF-CANCEL-DT    PIC XX.
   495         16  NCRTO-LF-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   496         16  NCRTO-LF-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   497         16  NCRTO-AH-BENCD        PIC XX.
   498         16  NCRTO-AH-TERM         PIC S999      COMP-3.
   499         16  NCRTO-AH-BEN-AMT      PIC S9(9)V99  COMP-3.
   500         16  NCRTO-AH-PRM-AMT      PIC S9(7)V99  COMP-3.
   501         16  NCRTO-AH-EXP-DT       PIC XX.
   502         16  NCRTO-AH-COMM-PCT     PIC SV9(5)    COMP-3.
   503         16  NCRTO-AH-CP           PIC 99.
   504         16  NCRTO-AH-CANCEL-DT    PIC XX.
   505         16  NCRTO-AH-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   506         16  NCRTO-AH-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   507         16  NCRTO-CRED-BENE-NAME  PIC X(25).
   508         16  NCRTO-1ST-PMT-DT      PIC XX.
   509         16  NCRTO-INS-AGE-DEFAULT-FLAG PIC X.
   510         16  NCRTO-JNT-AGE-DEFAULT-FLAG PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  11
* EL6318.cbl
   511         16  NCRTO-ISSUE-TRAN-IND  PIC X.
   512         16  NCRTO-CANCEL-TRAN-IND PIC X.
   513         16  FILLER                PIC X(235).
   514
   515 01  CERT-NOTE-ENTRIES.
   516     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   517         16  CERT-NT-TEXT                PIC X(63).
   518         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   519         16  CERT-NT-LAST-MAINT-DT       PIC XX.
   520         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   521
   522 01  ERCNOT-AREA.
   523     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   524     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   525     12  ERCNOT-KEY.
   526         16  ERCNOT-PARTIAL-KEY.
   527             20 ERCNOT-COMPANY-CD    PIC X.
   528             20 ERCNOT-CARRIER       PIC X.
   529             20 ERCNOT-GROUPING      PIC X(06).
   530             20 ERCNOT-STATE         PIC XX.
   531             20 ERCNOT-ACCOUNT       PIC X(10).
   532             20 ERCNOT-EFF-DT        PIC XX.
   533             20 ERCNOT-CERT-NO.
   534                25 ERCNOT-CERT-PRIME PIC X(10).
   535                25 ERCNOT-CERT-SFX   PIC X.
   536             20 ERCNOT-REC-TYP       PIC X.
   537         16 ERCNOT-SEQ           PIC S9(4) COMP.
   538     12  SV-PARTIAL-KEY.
   539         20 SV-COMPANY-CD            PIC X.
   540         20 SV-CARRIER               PIC X.
   541         20 SV-GROUPING              PIC X(06).
   542         20 SV-STATE                 PIC XX.
   543         20 SV-ACCOUNT               PIC X(10).
   544         20 SV-EFF-DT                PIC XX.
   545         20 SV-CERT-NO.
   546            25 SV-CERT-PRIME         PIC X(10).
   547            25 SV-CERT-SFX           PIC X(1).
   548         20 SV-REC-TYP               PIC X.
   549 01  ERROR-MESSAGES.
   550     12  ER-0000                 PIC X(4)  VALUE '0000'.
   551     12  ER-0004                 PIC X(4)  VALUE '0004'.
   552     12  ER-0008                 PIC X(4)  VALUE '0008'.
   553     12  ER-0023                 PIC X(4)  VALUE '0023'.
   554     12  ER-0029                 PIC X(4)  VALUE '0029'.
   555     12  ER-0068                 PIC X(4)  VALUE '0068'.
   556     12  ER-0132                 PIC X(4)  VALUE '0132'.
   557     12  ER-0142                 PIC X(4)  VALUE '0142'.
   558     12  ER-0148                 PIC X(4)  VALUE '0148'.
   559     12  ER-0215                 PIC X(4)  VALUE '0215'.
   560     12  ER-0280                 PIC X(4)  VALUE '0280'.
   561     12  ER-0348                 PIC X(4)  VALUE '0348'.
   562     12  ER-0419                 PIC X(4)  VALUE '0419'.
   563     12  ER-0715                 PIC X(4)  VALUE '0715'.
   564     12  ER-0894                 PIC X(4)  VALUE '0894'.
   565     12  ER-1101                 PIC X(4)  VALUE '1101'.
   566     12  ER-1236                 PIC X(4)  VALUE '1236'.
   567     12  ER-1560                 PIC X(4)  VALUE '1560'.
   568     12  ER-1664                 PIC X(4)  VALUE '1664'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  12
* EL6318.cbl
   569     12  ER-1778                 PIC X(4)  VALUE '1778'.
   570     12  ER-1818                 PIC X(4)  VALUE '1818'.
   571     12  ER-1820                 PIC X(4)  VALUE '1820'.
   572     12  ER-1821                 PIC X(4)  VALUE '1821'.
   573     12  ER-2056                 PIC X(4)  VALUE '2056'.
   574     12  ER-2079                 PIC X(4)  VALUE '2079'.
   575     12  ER-2208                 PIC X(4)  VALUE '2208'.
   576     12  ER-2209                 PIC X(4)  VALUE '2209'.
   577     12  ER-2237                 PIC X(4)  VALUE '2237'.
   578     12  ER-2238                 PIC X(4)  VALUE '2238'.
   579     12  ER-2253                 PIC X(4)  VALUE '2253'.
   580     12  ER-2619                 PIC X(4)  VALUE '2619'.
   581     12  ER-2651                 PIC X(4)  VALUE '2651'.
   582     12  ER-2784                 PIC X(4)  VALUE '2784'.
   583     12  ER-2785                 PIC X(4)  VALUE '2785'.
   584     12  ER-2786                 PIC X(4)  VALUE '2786'.
   585     12  ER-2791                 PIC X(4)  VALUE '2791'.
   586     12  ER-2845                 PIC X(4)  VALUE '2845'.
   587     12  ER-2848                 PIC X(4)  VALUE '2848'.
   588     12  ER-2851                 PIC X(4)  VALUE '2851'.
   589     12  ER-3830                 PIC X(4)  VALUE '3830'.
   590     12  ER-3833                 PIC X(4)  VALUE '3833'.
   591     12  ER-3844                 PIC X(4)  VALUE '3844'.
   592     12  ER-3845                 PIC X(4)  VALUE '3845'.
   593     12  ER-7345                 PIC X(4)  VALUE '7345'.
   594     12  ER-7638                 PIC X(4)  VALUE '7638'.
   595     12  ER-8888                 PIC X(4)  VALUE '8888'.
   596     12  ER-9999                 PIC X(4)  VALUE '9999'.
   597*    COPY ELCDATE.
   598******************************************************************
   599*                                                                *
   600*                                                                *
   601*                            ELCDATE.                            *
   602*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   603*                            VMOD=2.003
   604*                                                                *
   605*                                                                *
   606*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   607*                 LENGTH = 200                                   *
   608******************************************************************
   609
   610 01  DATE-CONVERSION-DATA.
   611     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   612     12  DC-OPTION-CODE                PIC X.
   613         88  BIN-TO-GREG                VALUE ' '.
   614         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   615         88  EDIT-GREG-TO-BIN           VALUE '2'.
   616         88  YMD-GREG-TO-BIN            VALUE '3'.
   617         88  MDY-GREG-TO-BIN            VALUE '4'.
   618         88  JULIAN-TO-BIN              VALUE '5'.
   619         88  BIN-PLUS-ELAPSED           VALUE '6'.
   620         88  FIND-CENTURY               VALUE '7'.
   621         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   622         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   623         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   624         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   625         88  JULIAN-TO-BIN-3            VALUE 'C'.
   626         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  13
* EL6318.cbl
   627         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   628         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   629         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   630         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   631         88  CHECK-LEAP-YEAR            VALUE 'H'.
   632         88  BIN-3-TO-GREG              VALUE 'I'.
   633         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   634         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   635         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   636         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   637         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   638         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   639         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   640         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   641         88  THREE-CHARACTER-BIN
   642                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   643         88  GREGORIAN-TO-BIN
   644                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   645         88  BIN-TO-GREGORIAN
   646                  VALUES ' ' '1' 'I' '8' 'G'.
   647         88  JULIAN-TO-BINARY
   648                  VALUES '5' 'C' 'E' 'F'.
   649     12  DC-ERROR-CODE                 PIC X.
   650         88  NO-CONVERSION-ERROR        VALUE ' '.
   651         88  DATE-CONVERSION-ERROR
   652                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   653         88  DATE-IS-ZERO               VALUE '1'.
   654         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   655         88  DATE-IS-INVALID            VALUE '3'.
   656         88  DATE1-GREATER-DATE2        VALUE '4'.
   657         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   658         88  DATE-INVALID-OPTION        VALUE '9'.
   659         88  INVALID-CENTURY            VALUE 'A'.
   660         88  ONLY-CENTURY               VALUE 'B'.
   661         88  ONLY-LEAP-YEAR             VALUE 'C'.
   662         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   663     12  DC-END-OF-MONTH               PIC X.
   664         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   665     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   666         88  USE-NORMAL-PROCESS         VALUE ' '.
   667         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   668         88  ADJUST-UP-100-YRS          VALUE '2'.
   669     12  FILLER                        PIC X.
   670     12  DC-CONVERSION-DATES.
   671         16  DC-BIN-DATE-1             PIC XX.
   672         16  DC-BIN-DATE-2             PIC XX.
   673         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   674         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   675                       DC-GREG-DATE-1-EDIT.
   676             20  DC-EDIT1-MONTH        PIC 99.
   677             20  SLASH1-1              PIC X.
   678             20  DC-EDIT1-DAY          PIC 99.
   679             20  SLASH1-2              PIC X.
   680             20  DC-EDIT1-YEAR         PIC 99.
   681         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   682         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   683                     DC-GREG-DATE-2-EDIT.
   684             20  DC-EDIT2-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  14
* EL6318.cbl
   685             20  SLASH2-1              PIC X.
   686             20  DC-EDIT2-DAY          PIC 99.
   687             20  SLASH2-2              PIC X.
   688             20  DC-EDIT2-YEAR         PIC 99.
   689         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   690         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   691                     DC-GREG-DATE-1-YMD.
   692             20  DC-YMD-YEAR           PIC 99.
   693             20  DC-YMD-MONTH          PIC 99.
   694             20  DC-YMD-DAY            PIC 99.
   695         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   696         16  DC-GREG-DATE-1-MDY-R REDEFINES
   697                      DC-GREG-DATE-1-MDY.
   698             20  DC-MDY-MONTH          PIC 99.
   699             20  DC-MDY-DAY            PIC 99.
   700             20  DC-MDY-YEAR           PIC 99.
   701         16  DC-GREG-DATE-1-ALPHA.
   702             20  DC-ALPHA-MONTH        PIC X(10).
   703             20  DC-ALPHA-DAY          PIC 99.
   704             20  FILLER                PIC XX.
   705             20  DC-ALPHA-CENTURY.
   706                 24 DC-ALPHA-CEN-N     PIC 99.
   707             20  DC-ALPHA-YEAR         PIC 99.
   708         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   709         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   710         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   711         16  DC-JULIAN-DATE            PIC 9(05).
   712         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   713                                       PIC 9(05).
   714         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   715             20  DC-JULIAN-YEAR        PIC 99.
   716             20  DC-JULIAN-DAYS        PIC 999.
   717         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   718         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   719         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   720     12  DATE-CONVERSION-VARIBLES.
   721         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   722         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   723             20  FILLER                PIC 9(3).
   724             20  HOLD-CEN-1-CCYY.
   725                 24  HOLD-CEN-1-CC     PIC 99.
   726                 24  HOLD-CEN-1-YY     PIC 99.
   727             20  HOLD-CEN-1-MO         PIC 99.
   728             20  HOLD-CEN-1-DA         PIC 99.
   729         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   730             20  HOLD-CEN-1-R-MO       PIC 99.
   731             20  HOLD-CEN-1-R-DA       PIC 99.
   732             20  HOLD-CEN-1-R-CCYY.
   733                 24  HOLD-CEN-1-R-CC   PIC 99.
   734                 24  HOLD-CEN-1-R-YY   PIC 99.
   735             20  FILLER                PIC 9(3).
   736         16  HOLD-CENTURY-1-X.
   737             20  FILLER                PIC X(3)  VALUE SPACES.
   738             20  HOLD-CEN-1-X-CCYY.
   739                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   740                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   741             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   742             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  15
* EL6318.cbl
   743         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   744             20  HOLD-CEN-1-R-X-MO     PIC XX.
   745             20  HOLD-CEN-1-R-X-DA     PIC XX.
   746             20  HOLD-CEN-1-R-X-CCYY.
   747                 24  HOLD-CEN-1-R-X-CC PIC XX.
   748                 24  HOLD-CEN-1-R-X-YY PIC XX.
   749             20  FILLER                PIC XXX.
   750         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   751         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   752         16  DC-JULIAN-DATE-1          PIC 9(07).
   753         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   754             20  DC-JULIAN-1-CCYY.
   755                 24  DC-JULIAN-1-CC    PIC 99.
   756                 24  DC-JULIAN-1-YR    PIC 99.
   757             20  DC-JULIAN-DA-1        PIC 999.
   758         16  DC-JULIAN-DATE-2          PIC 9(07).
   759         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   760             20  DC-JULIAN-2-CCYY.
   761                 24  DC-JULIAN-2-CC    PIC 99.
   762                 24  DC-JULIAN-2-YR    PIC 99.
   763             20  DC-JULIAN-DA-2        PIC 999.
   764         16  DC-GREG-DATE-A-EDIT.
   765             20  DC-EDITA-MONTH        PIC 99.
   766             20  SLASHA-1              PIC X VALUE '/'.
   767             20  DC-EDITA-DAY          PIC 99.
   768             20  SLASHA-2              PIC X VALUE '/'.
   769             20  DC-EDITA-CCYY.
   770                 24  DC-EDITA-CENT     PIC 99.
   771                 24  DC-EDITA-YEAR     PIC 99.
   772         16  DC-GREG-DATE-B-EDIT.
   773             20  DC-EDITB-MONTH        PIC 99.
   774             20  SLASHB-1              PIC X VALUE '/'.
   775             20  DC-EDITB-DAY          PIC 99.
   776             20  SLASHB-2              PIC X VALUE '/'.
   777             20  DC-EDITB-CCYY.
   778                 24  DC-EDITB-CENT     PIC 99.
   779                 24  DC-EDITB-YEAR     PIC 99.
   780         16  DC-GREG-DATE-CYMD         PIC 9(08).
   781         16  DC-GREG-DATE-CYMD-R REDEFINES
   782                              DC-GREG-DATE-CYMD.
   783             20  DC-CYMD-CEN           PIC 99.
   784             20  DC-CYMD-YEAR          PIC 99.
   785             20  DC-CYMD-MONTH         PIC 99.
   786             20  DC-CYMD-DAY           PIC 99.
   787         16  DC-GREG-DATE-MDCY         PIC 9(08).
   788         16  DC-GREG-DATE-MDCY-R REDEFINES
   789                              DC-GREG-DATE-MDCY.
   790             20  DC-MDCY-MONTH         PIC 99.
   791             20  DC-MDCY-DAY           PIC 99.
   792             20  DC-MDCY-CEN           PIC 99.
   793             20  DC-MDCY-YEAR          PIC 99.
   794    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   795        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   796    12  DC-EL310-DATE                  PIC X(21).
   797    12  FILLER                         PIC X(28).
   798*    COPY ELCTEXT.
   799******************************************************************
   800*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  16
* EL6318.cbl
   801*                                                                *
   802*                            ELCTEXT.                            *
   803*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   804*                            VMOD=2.008                          *
   805*                                                                *
   806*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   807*                                     FORM LETTERS,              *
   808*                                     CERT FORM DISPLAY.
   809*                                                                *
   810*   FILE TYPE = VSAM,KSDS                                        *
   811*   RECORD SIZE = 100   RECFORM = FIXED                          *
   812*                                                                *
   813*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   814*       ALTERNATE INDEX = NONE                                   *
   815*                                                                *
   816*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   817*       ALTERNATE INDEX = NONE                                   *
   818*                                                                *
   819*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   820*       ALTERNATE INDEX = NONE                                   *
   821*                                                                *
   822*   LOG = NO                                                     *
   823*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   824******************************************************************
   825 01  TEXT-FILES.
   826     12  TEXT-FILE-ID                PIC XX.
   827         88  FORMS-FILE-TEXT            VALUE 'TF'.
   828         88  LETTER-FILE-TEXT           VALUE 'TL'.
   829         88  HELP-FILE-TEXT             VALUE 'TH'.
   830
   831     12  TX-CONTROL-PRIMARY.
   832         16  TX-COMPANY-CD           PIC X.
   833             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   834         16  TX-ACCESS-CD-GENL       PIC X(12).
   835
   836         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   837             20  TX-LETTER-NO        PIC X(4).
   838             20  FILLER              PIC X(8).
   839
   840         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   841             20  TX-FORM-NO          PIC X(12).
   842
   843         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   844             20  TX-HELP-TYPE        PIC X.
   845                 88  HELP-FOR-GENERAL   VALUE ' '.
   846                 88  HELP-BY-SCREEN     VALUE 'S'.
   847                 88  HELP-BY-ERROR      VALUE 'E'.
   848             20  TX-SCREEN-OR-ERROR  PIC X(4).
   849                 88  GENERAL-INFO-HELP  VALUE '0000'.
   850             20  TX-HELP-FOR-COMPANY  PIC XXX.
   851                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   852             20  FILLER              PIC X(4).
   853
   854         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   855
   856     12  TX-PROCESS-CONTROL          PIC XX.
   857         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   858
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  17
* EL6318.cbl
   859     12  TX-TEXT-LINE                PIC X(70).
   860
   861     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   862         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   863         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   864         88  TX-VALID-FORM-SQUEEZE-VALUE
   865                                        VALUE 'Y' ' '.
   866
   867     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   868         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   869         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   870         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   871         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   872         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   873         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   874         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   875                                              'K' 'N' ' '
   876                                              'Z'.
   877
   878     12  TX-ARCHIVE-SW               PIC X.
   879         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   880         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   881         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   882
   883     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   884     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   885
   886     12  TX-BSR-CODE                 PIC X.
   887         88  TX-BSR-LETTER              VALUE 'B'.
   888         88  TX-NON-BSR-LETTER          VALUE ' '.
   889
   890     12  FILLER                      PIC X.
   891*****************************************************************
   892*    COPY ELCLOGOF.
   893******************************************************************
   894*                                                                *
   895*                                                                *
   896*                            ELCLOGOF.                           *
   897*                            VMOD=2.001                          *
   898*                                                                *
   899*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   900*                                                                *
   901******************************************************************
   902 01  CLASIC-LOGOFF.
   903     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   904     12  LOGOFF-TEXT.
   905         16  FILLER          PIC X(5)    VALUE SPACES.
   906         16  LOGOFF-MSG.
   907             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   908             20  FILLER      PIC X       VALUE SPACES.
   909             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   910         16  FILLER          PIC X(80)
   911           VALUE '* YOU ARE NOW LOGGED OFF'.
   912         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   913         16  FILLER          PIC X       VALUE QUOTE.
   914         16  LOGOFF-SYS-MSG  PIC X(17)
   915           VALUE 'S CLAS-IC SYSTEM '.
   916     12  TEXT-MESSAGES.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  18
* EL6318.cbl
   917         16  UNACCESS-MSG    PIC X(29)
   918             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   919         16  PGMIDERR-MSG    PIC X(17)
   920             VALUE 'PROGRAM NOT FOUND'.
   921*    COPY ELCATTR.
   922******************************************************************
   923*                                                                *
   924*                            ELCATTR.                            *
   925*                            VMOD=2.001                          *
   926*                                                                *
   927*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   928*                                                                *
   929*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   930*                                                                *
   931*                   POS 1   P=PROTECTED                          *
   932*                           U=UNPROTECTED                        *
   933*                           S=ASKIP                              *
   934*                   POS 2   A=ALPHA/NUMERIC                      *
   935*                           N=NUMERIC                            *
   936*                   POS 3   N=NORMAL                             *
   937*                           B=BRIGHT                             *
   938*                           D=DARK                               *
   939*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   940*                           OF=MODIFIED DATA TAG OFF             *
   941*                                                                *
   942*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   943******************************************************************
   944 01  ATTRIBUTE-LIST.
   945     12  AL-PABOF            PIC X       VALUE 'Y'.
   946     12  AL-PABON            PIC X       VALUE 'Z'.
   947     12  AL-PADOF            PIC X       VALUE '%'.
   948     12  AL-PADON            PIC X       VALUE '_'.
   949     12  AL-PANOF            PIC X       VALUE '-'.
   950     12  AL-PANON            PIC X       VALUE '/'.
   951     12  AL-SABOF            PIC X       VALUE '8'.
   952     12  AL-SABON            PIC X       VALUE '9'.
   953     12  AL-SADOF            PIC X       VALUE '@'.
   954     12  AL-SADON            PIC X       VALUE QUOTE.
   955     12  AL-SANOF            PIC X       VALUE '0'.
   956     12  AL-SANON            PIC X       VALUE '1'.
   957     12  AL-UABOF            PIC X       VALUE 'H'.
   958     12  AL-UABON            PIC X       VALUE 'I'.
   959     12  AL-UADOF            PIC X       VALUE '<'.
   960     12  AL-UADON            PIC X       VALUE '('.
   961     12  AL-UANOF            PIC X       VALUE ' '.
   962     12  AL-UANON            PIC X       VALUE 'A'.
   963     12  AL-UNBOF            PIC X       VALUE 'Q'.
   964     12  AL-UNBON            PIC X       VALUE 'R'.
   965     12  AL-UNDOF            PIC X       VALUE '*'.
   966     12  AL-UNDON            PIC X       VALUE ')'.
   967     12  AL-UNNOF            PIC X       VALUE '&'.
   968     12  AL-UNNON            PIC X       VALUE 'J'.
   969*    COPY ELCEMIB.
   970******************************************************************
   971*                                                                *
   972*                                                                *
   973*                            ELCEMIB.                            *
   974*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  19
* EL6318.cbl
   975*                            VMOD=2.005                          *
   976*                                                                *
   977*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   978*                                                                *
   979******************************************************************
   980 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   981     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   982     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   983     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   984     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   985     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   986     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   987     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   988     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   989     12  EMI-SWITCH1             PIC X        VALUE '1'.
   990         88  EMI-NO-ERRORS                    VALUE '1'.
   991         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   992         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   993     12  EMI-SWITCH2             PIC X        VALUE '1'.
   994         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   995     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   996         88  EMI-AREA1-EMPTY                  VALUE '1'.
   997         88  EMI-AREA1-FULL                   VALUE '2'.
   998     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   999         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1000         88  EMI-AREA2-FULL                   VALUE '2'.
  1001     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1002         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1003         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1004         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1005         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1006         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1007     12  EMI-ERROR-LINES.
  1008         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1009         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1010         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1011         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1012             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1013                 24  EMI-ERR-NUM         PIC X(4).
  1014                 24  EMI-FILLER          PIC X.
  1015                 24  EMI-SEV             PIC X.
  1016                 24  FILLER              PIC X.
  1017             20  FILLER                  PIC X(02).
  1018     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1019         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1020             20  EMI-ERROR-NUMBER    PIC X(4).
  1021             20  EMI-FILL            PIC X.
  1022             20  EMI-SEVERITY        PIC X.
  1023             20  FILLER              PIC X.
  1024             20  EMI-ERROR-TEXT.
  1025                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1026                 24  FILLER          PIC X(55).
  1027     12  EMI-SEVERITY-SAVE           PIC X.
  1028         88  EMI-NOTE                    VALUE 'N'.
  1029         88  EMI-WARNING                 VALUE 'W'.
  1030         88  EMI-FORCABLE                VALUE 'F'.
  1031         88  EMI-FATAL                   VALUE 'X'.
  1032     12  EMI-MESSAGE-FLAG            PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  20
* EL6318.cbl
  1033         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1034         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1035     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1036     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1037         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1038         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1039         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1040     12  emi-claim-no                pic x(7).
  1041     12  emi-claim-type              pic x(6).
  1042     12  FILLER                      PIC X(124)  VALUE SPACES.
  1043     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1044     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1045     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1046     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1047*    COPY ELCINTF.
  1048******************************************************************
  1049*                                                                *
  1050*                                                                *
  1051*                            ELCINTF.                            *
  1052*                            VMOD=2.017                          *
  1053*                                                                *
  1054*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1055*                                                                *
  1056*       LENGTH = 1024                                            *
  1057*                                                                *
  1058******************************************************************
  1059*                   C H A N G E   L O G
  1060*
  1061* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1062*-----------------------------------------------------------------
  1063*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1064* EFFECTIVE    NUMBER
  1065*-----------------------------------------------------------------
  1066* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1067******************************************************************
  1068 01  PROGRAM-INTERFACE-BLOCK.
  1069     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1070     12  PI-CALLING-PROGRAM              PIC X(8).
  1071     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1072     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1073     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1074     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1075     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1076     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1077     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1078     12  PI-COMPANY-ID                   PIC XXX.
  1079     12  PI-COMPANY-CD                   PIC X.
  1080
  1081     12  PI-COMPANY-PASSWORD             PIC X(8).
  1082
  1083     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1084
  1085     12  PI-CONTROL-IN-PROGRESS.
  1086         16  PI-CARRIER                  PIC X.
  1087         16  PI-GROUPING                 PIC X(6).
  1088         16  PI-STATE                    PIC XX.
  1089         16  PI-ACCOUNT                  PIC X(10).
  1090         16  PI-PRODUCER REDEFINES PI-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  21
* EL6318.cbl
  1091                                         PIC X(10).
  1092         16  PI-CLAIM-CERT-GRP.
  1093             20  PI-CLAIM-NO             PIC X(7).
  1094             20  PI-CERT-NO.
  1095                 25  PI-CERT-PRIME       PIC X(10).
  1096                 25  PI-CERT-SFX         PIC X.
  1097             20  PI-CERT-EFF-DT          PIC XX.
  1098         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1099             20  PI-PLAN-CODE            PIC X(2).
  1100             20  PI-REVISION-NUMBER      PIC X(3).
  1101             20  PI-PLAN-EFF-DT          PIC X(2).
  1102             20  PI-PLAN-EXP-DT          PIC X(2).
  1103             20  FILLER                  PIC X(11).
  1104         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1105             20  PI-OE-REFERENCE-1.
  1106                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1107                 25  PI-OE-REF-1-SUFF    PIC XX.
  1108
  1109     12  PI-SESSION-IN-PROGRESS          PIC X.
  1110         88  CLAIM-SESSION                   VALUE '1'.
  1111         88  CREDIT-SESSION                  VALUE '2'.
  1112         88  WARRANTY-SESSION                VALUE '3'.
  1113         88  MORTGAGE-SESSION                VALUE '4'.
  1114         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1115
  1116
  1117*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1118
  1119     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1120     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1121
  1122     12  PI-CREDIT-USER                  PIC X.
  1123         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1124         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1125
  1126     12  PI-CLAIM-USER                   PIC X.
  1127         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1128         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1129
  1130     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1131         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1132         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1133         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1134         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1135         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1136
  1137     12  PI-PROCESSOR-ID                 PIC X(4).
  1138
  1139     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1140
  1141     12  PI-MEMBER-CAPTION               PIC X(10).
  1142
  1143     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1144         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1145
  1146     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1147     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1148     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  22
* EL6318.cbl
  1149     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1150
  1151     12  PI-AH-OVERRIDE-L1               PIC X.
  1152     12  PI-AH-OVERRIDE-L2               PIC XX.
  1153     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1154     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1155
  1156     12  PI-NEW-SYSTEM                   PIC X(2).
  1157
  1158     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1159     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1160         88  PI-USES-PAID-TO                 VALUE '1'.
  1161     12  PI-CRDTCRD-SYSTEM.
  1162         16  PI-CRDTCRD-USER             PIC X.
  1163             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1164             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1165         16  PI-CC-MONTH-END-DT          PIC XX.
  1166     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1167
  1168     12  PI-OE-REFERENCE-2.
  1169         16  PI-OE-REF-2-PRIME           PIC X(10).
  1170         16  PI-OE-REF-2-SUFF            PIC X.
  1171
  1172     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1173
  1174     12  PI-LANGUAGE-TYPE                PIC X.
  1175             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1176             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1177             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1178
  1179     12  PI-POLICY-LINKAGE-IND           PIC X.
  1180         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1181         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1182                                                   LOW-VALUES.
  1183
  1184     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1185     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1186         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1187         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1188
  1189     12  PI-PROCESSOR-CSR-IND            PIC X.
  1190         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1191         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1192
  1193     12  FILLER                          PIC X(3).
  1194
  1195     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1196
  1197     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1198         PI-SYSTEM-LEVEL.
  1199
  1200         16  PI-ENTRY-CODES.
  1201             20  PI-ENTRY-CD-1           PIC X.
  1202             20  PI-ENTRY-CD-2           PIC X.
  1203
  1204         16  PI-RETURN-CODES.
  1205             20  PI-RETURN-CD-1          PIC X.
  1206             20  PI-RETURN-CD-2          PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  23
* EL6318.cbl
  1207
  1208         16  PI-UPDATE-STATUS-SAVE.
  1209             20  PI-UPDATE-BY            PIC X(4).
  1210             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1211
  1212         16  PI-LOWER-CASE-LETTERS       PIC X.
  1213             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1214
  1215*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1216*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1217*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1218
  1219         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1220             88  ST-ACCNT-CNTL               VALUE ' '.
  1221             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1222             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1223             88  ACCNT-CNTL                  VALUE '3'.
  1224             88  CARR-ACCNT-CNTL             VALUE '4'.
  1225
  1226         16  PI-PROCESSOR-CAP-LIST.
  1227             20  PI-SYSTEM-CONTROLS.
  1228                24 PI-SYSTEM-DISPLAY     PIC X.
  1229                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1230                24 PI-SYSTEM-MODIFY      PIC X.
  1231                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1232             20  FILLER                  PIC XX.
  1233             20  PI-DISPLAY-CAP          PIC X.
  1234                 88  DISPLAY-CAP             VALUE 'Y'.
  1235             20  PI-MODIFY-CAP           PIC X.
  1236                 88  MODIFY-CAP              VALUE 'Y'.
  1237             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1238                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1239             20  PI-FORCE-CAP            PIC X.
  1240                 88  FORCE-CAP               VALUE 'Y'.
  1241
  1242         16  PI-PROGRAM-CONTROLS.
  1243             20  PI-PGM-PRINT-OPT        PIC X.
  1244             20  PI-PGM-FORMAT-OPT       PIC X.
  1245             20  PI-PGM-PROCESS-OPT      PIC X.
  1246             20  PI-PGM-TOTALS-OPT       PIC X.
  1247
  1248         16  PI-HELP-INTERFACE.
  1249             20  PI-LAST-ERROR-NO        PIC X(4).
  1250             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1251
  1252         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1253             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1254
  1255         16  PI-CR-CONTROL-IN-PROGRESS.
  1256             20  PI-CR-CARRIER           PIC X.
  1257             20  PI-CR-GROUPING          PIC X(6).
  1258             20  PI-CR-STATE             PIC XX.
  1259             20  PI-CR-ACCOUNT           PIC X(10).
  1260             20  PI-CR-FIN-RESP          PIC X(10).
  1261             20  PI-CR-TYPE              PIC X.
  1262
  1263         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1264
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  24
* EL6318.cbl
  1265         16  PI-CR-MONTH-END-DT          PIC XX.
  1266
  1267         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1268             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1269             88  PI-ZERO-CARRIER             VALUE '1'.
  1270             88  PI-ZERO-GROUPING            VALUE '2'.
  1271             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1272
  1273         16  PI-CARRIER-SECURITY         PIC X.
  1274             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1275
  1276         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1277             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1278             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1279
  1280         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1281             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1282                                         INDEXED BY PI-ACCESS-NDX
  1283                                         PIC X.
  1284
  1285         16  PI-GA-BILLING-CONTROL       PIC X.
  1286             88  PI-GA-BILLING               VALUE '1'.
  1287
  1288         16  PI-MAIL-PROCESSING          PIC X.
  1289             88  PI-MAIL-YES                 VALUE 'Y'.
  1290
  1291         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1292
  1293         16  PI-AR-SYSTEM.
  1294             20  PI-AR-PROCESSING-CNTL   PIC X.
  1295                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1296             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1297             20  PI-AR-MONTH-END-DT      PIC XX.
  1298
  1299         16  PI-MP-SYSTEM.
  1300             20  PI-MORTGAGE-USER            PIC X.
  1301                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1302                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1303             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1304                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1305                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1306                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1307                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1308                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1309             20  PI-MP-MONTH-END-DT          PIC XX.
  1310             20  PI-MP-REFERENCE-NO.
  1311                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1312                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1313
  1314         16  PI-LABEL-CONTROL            PIC X(01).
  1315             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1316             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1317
  1318         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1319             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1320
  1321         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1322             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  25
* EL6318.cbl
  1323             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1324
  1325         16  FILLER                      PIC X(14).
  1326
  1327     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1328******************************************************************
  1329     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1330        16  PI-ISS-CAN-SW           PIC X.
  1331        16  PI-ERENDT-KEY.  *>  36
  1332            20  PI-ENDT-COMPANY-CD  PIC X.
  1333            20  PI-ENDT-CARRIER     PIC X.
  1334            20  PI-ENDT-GROUPING    PIC X(6).
  1335            20  PI-ENDT-STATE       PIC XX.
  1336            20  PI-ENDT-ACCOUNT     PIC X(10).
  1337            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1338            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1339            20  PI-ENDT-CERT-SFX    PIC X.
  1340            20  PI-ENDT-RECORD-TYPE PIC X.
  1341            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1342        16  PI-ELCRTO-KEY.  *> 36
  1343            20  PI-CRTO-COMPANY-CD  PIC X.
  1344            20  PI-CRTO-CARRIER     PIC X.
  1345            20  PI-CRTO-GROUPING    PIC X(6).
  1346            20  PI-CRTO-STATE       PIC XX.
  1347            20  PI-CRTO-ACCOUNT     PIC X(10).
  1348            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1349            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1350            20  PI-CRTO-CERT-SFX    PIC X.
  1351            20  PI-CRTO-RECORD-TYPE PIC X.
  1352            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1353        16  PI-ERPNDB-KEY           PIC X(11).
  1354        16  PI-DOCUMENT-PROCESSED   PIC X.
  1355            88  PI-VERI-PROCESSED      VALUE 'V'.
  1356            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1357        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1358        16  PI-RES-REF-CLM-TYPE     PIC X.
  1359        16  PI-CLM-REFORM-IND       PIC X.
  1360            88  PI-CLAIM-REFORMATION   VALUE 'Y'.
  1361        16  PI-CLEAR-ERROR-SW       PIC X.
  1362            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1363        16  PI-PRINT-CERTIFICATE    PIC X.
  1364        16  PI-ENTERED.  *> 233
  1365            20  PI-PRTSW-ENTERED    PIC X.
  1366            20  PI-SIGREQ-ENTERED   PIC X.
  1367            20  PI-LTRID-ENTERED    PIC X(4).
  1368            20  PI-VOUCHER-ENTERED  PIC X.
  1369            20  PI-HLTHAPP-ENTERED  PIC X.
  1370            20  PI-PAYEE-ENTERED    PIC X(10).
  1371            20  PI-CERTID-ENTERED   PIC X(5).
  1372            20  PI-REASONS-ENTERED  PIC X(84).
  1373            20  PI-CERTNT1-ENTERED  PIC X(63).
  1374            20  PI-CERTNT2-ENTERED  PIC X(63).
  1375        16  PI-FINALIZED-IND        PIC X.
  1376        16  PI-CERTNT3-ENTERED      PIC X(63).
  1377        16  PI-CERTNT4-ENTERED      PIC X(63).
  1378        16  PI-BILLNT1-ENTERED      PIC X(63).
  1379        16  PI-BILLNT2-ENTERED      PIC X(63).
  1380        16  PI-REASON-CODE-IND      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  26
* EL6318.cbl
  1381        16  PI-ENCCODE              PIC X(3).
  1382    12  pi-el677-work-area redefines pi-program-work-area.
  1383        16  filler                  pic x(318).
  1384        16  pi-el677-prm-diff       pic s9(7)v99 comp-3.
  1385        16  pi-el677-com-diff       pic s9(5)v99 comp-3.
  1386        16  pi-el677-check-type     pic x.
  1387        16  pi-el677-check-cut      pic x.
  1388        16  filler                  pic x(311).
  1389    12  pi-endt-prm-diff            pic s9(7)v99 comp-3.
  1390    12  pi-endt-com-diff            pic s9(5)v99 comp-3.
  1391    12  pi-check-cut                pic x.
  1392    12  pi-check-type               pic x.
  1393    12  FILLER                      PIC X(265). *> was 276
  1394*    COPY ELCAID.
  1395******************************************************************
  1396*                                                                *
  1397*                            ELCAID.                             *
  1398*                            VMOD=2.001                          *
  1399*                                                                *
  1400*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1401*                                                                *
  1402*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1403*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1404******************************************************************
  1405
  1406 01  DFHAID.
  1407   02  DFHNULL   PIC  X  VALUE  ' '.
  1408   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1409   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1410   02  DFHPEN    PIC  X  VALUE  '='.
  1411   02  DFHOPID   PIC  X  VALUE  'W'.
  1412   02  DFHPA1    PIC  X  VALUE  '%'.
  1413   02  DFHPA2    PIC  X  VALUE  '>'.
  1414   02  DFHPA3    PIC  X  VALUE  ','.
  1415   02  DFHPF1    PIC  X  VALUE  '1'.
  1416   02  DFHPF2    PIC  X  VALUE  '2'.
  1417   02  DFHPF3    PIC  X  VALUE  '3'.
  1418   02  DFHPF4    PIC  X  VALUE  '4'.
  1419   02  DFHPF5    PIC  X  VALUE  '5'.
  1420   02  DFHPF6    PIC  X  VALUE  '6'.
  1421   02  DFHPF7    PIC  X  VALUE  '7'.
  1422   02  DFHPF8    PIC  X  VALUE  '8'.
  1423   02  DFHPF9    PIC  X  VALUE  '9'.
  1424   02  DFHPF10   PIC  X  VALUE  ':'.
  1425   02  DFHPF11   PIC  X  VALUE  '#'.
  1426   02  DFHPF12   PIC  X  VALUE  '@'.
  1427   02  DFHPF13   PIC  X  VALUE  'A'.
  1428   02  DFHPF14   PIC  X  VALUE  'B'.
  1429   02  DFHPF15   PIC  X  VALUE  'C'.
  1430   02  DFHPF16   PIC  X  VALUE  'D'.
  1431   02  DFHPF17   PIC  X  VALUE  'E'.
  1432   02  DFHPF18   PIC  X  VALUE  'F'.
  1433   02  DFHPF19   PIC  X  VALUE  'G'.
  1434   02  DFHPF20   PIC  X  VALUE  'H'.
  1435   02  DFHPF21   PIC  X  VALUE  'I'.
  1436*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1437   02  DFHPF22   PIC  X  VALUE  '['.
  1438   02  DFHPF23   PIC  X  VALUE  '.'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  27
* EL6318.cbl
  1439   02  DFHPF24   PIC  X  VALUE  '<'.
  1440   02  DFHMSRE   PIC  X  VALUE  'X'.
  1441   02  DFHSTRF   PIC  X  VALUE  'h'.
  1442   02  DFHTRIG   PIC  X  VALUE  '"'.
  1443 01  FILLER    REDEFINES DFHAID.
  1444     12  FILLER              PIC X(8).
  1445     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1446     12  FILLER              PIC X(3).
  1447*   COPY EL6318S.
  1448 01  EL631KI.
  1449     05  FILLER            PIC  X(0012).
  1450*    -------------------------------
  1451     05  DATEL PIC S9(0004) COMP.
  1452     05  DATEF PIC  X(0001).
  1453     05  FILLER REDEFINES DATEF.
  1454         10  DATEA PIC  X(0001).
  1455     05  DATEI PIC  X(0008).
  1456*    -------------------------------
  1457     05  TIMEL PIC S9(0004) COMP.
  1458     05  TIMEF PIC  X(0001).
  1459     05  FILLER REDEFINES TIMEF.
  1460         10  TIMEA PIC  X(0001).
  1461     05  TIMEI PIC  X(0005).
  1462*    -------------------------------
  1463     05  PROCIDL PIC S9(0004) COMP.
  1464     05  PROCIDF PIC  X(0001).
  1465     05  FILLER REDEFINES PROCIDF.
  1466         10  PROCIDA PIC  X(0001).
  1467     05  PROCIDI PIC  X(0004).
  1468*    -------------------------------
  1469     05  HOSTL PIC S9(0004) COMP.
  1470     05  HOSTF PIC  X(0001).
  1471     05  FILLER REDEFINES HOSTF.
  1472         10  HOSTA PIC  X(0001).
  1473     05  HOSTI PIC  X(0009).
  1474*    -------------------------------
  1475     05  SYSL PIC S9(0004) COMP.
  1476     05  SYSF PIC  X(0001).
  1477     05  FILLER REDEFINES SYSF.
  1478         10  SYSA PIC  X(0001).
  1479     05  SYSI PIC  X(0005).
  1480*    -------------------------------
  1481     05  COMPANYL PIC S9(0004) COMP.
  1482     05  COMPANYF PIC  X(0001).
  1483     05  FILLER REDEFINES COMPANYF.
  1484         10  COMPANYA PIC  X(0001).
  1485     05  COMPANYI PIC  X(0003).
  1486*    -------------------------------
  1487     05  DATASORL PIC S9(0004) COMP.
  1488     05  DATASORF PIC  X(0001).
  1489     05  FILLER REDEFINES DATASORF.
  1490         10  DATASORA PIC  X(0001).
  1491     05  DATASORI PIC  X(0001).
  1492*    -------------------------------
  1493     05  BATCHNOL PIC S9(0004) COMP.
  1494     05  BATCHNOF PIC  X(0001).
  1495     05  FILLER REDEFINES BATCHNOF.
  1496         10  BATCHNOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  28
* EL6318.cbl
  1497     05  BATCHNOI PIC  X(0006).
  1498*    -------------------------------
  1499     05  BSEQNOL PIC S9(0004) COMP.
  1500     05  BSEQNOF PIC  X(0001).
  1501     05  FILLER REDEFINES BSEQNOF.
  1502         10  BSEQNOA PIC  X(0001).
  1503     05  BSEQNOI PIC  X(0008).
  1504*    -------------------------------
  1505     05  ARCHNOL PIC S9(0004) COMP.
  1506     05  ARCHNOF PIC  X(0001).
  1507     05  FILLER REDEFINES ARCHNOF.
  1508         10  ARCHNOA PIC  X(0001).
  1509     05  ARCHNOI PIC  X(0008).
  1510*    -------------------------------
  1511     05  PRTSWL PIC S9(0004) COMP.
  1512     05  PRTSWF PIC  X(0001).
  1513     05  FILLER REDEFINES PRTSWF.
  1514         10  PRTSWA PIC  X(0001).
  1515     05  PRTSWI PIC  X(0001).
  1516*    -------------------------------
  1517     05  CARRL PIC S9(0004) COMP.
  1518     05  CARRF PIC  X(0001).
  1519     05  FILLER REDEFINES CARRF.
  1520         10  CARRA PIC  X(0001).
  1521     05  CARRI PIC  X(0001).
  1522*    -------------------------------
  1523     05  GROUPL PIC S9(0004) COMP.
  1524     05  GROUPF PIC  X(0001).
  1525     05  FILLER REDEFINES GROUPF.
  1526         10  GROUPA PIC  X(0001).
  1527     05  GROUPI PIC  X(0006).
  1528*    -------------------------------
  1529     05  STATEL PIC S9(0004) COMP.
  1530     05  STATEF PIC  X(0001).
  1531     05  FILLER REDEFINES STATEF.
  1532         10  STATEA PIC  X(0001).
  1533     05  STATEI PIC  X(0002).
  1534*    -------------------------------
  1535     05  ACCTL PIC S9(0004) COMP.
  1536     05  ACCTF PIC  X(0001).
  1537     05  FILLER REDEFINES ACCTF.
  1538         10  ACCTA PIC  X(0001).
  1539     05  ACCTI PIC  X(0010).
  1540*    -------------------------------
  1541     05  EFFDTL PIC S9(0004) COMP.
  1542     05  EFFDTF PIC  X(0001).
  1543     05  FILLER REDEFINES EFFDTF.
  1544         10  EFFDTA PIC  X(0001).
  1545     05  EFFDTI PIC  X(0008).
  1546*    -------------------------------
  1547     05  CERTNOL PIC S9(0004) COMP.
  1548     05  CERTNOF PIC  X(0001).
  1549     05  FILLER REDEFINES CERTNOF.
  1550         10  CERTNOA PIC  X(0001).
  1551     05  CERTNOI PIC  X(0010).
  1552*    -------------------------------
  1553     05  CRTSFXL PIC S9(0004) COMP.
  1554     05  CRTSFXF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  29
* EL6318.cbl
  1555     05  FILLER REDEFINES CRTSFXF.
  1556         10  CRTSFXA PIC  X(0001).
  1557     05  CRTSFXI PIC  X(0001).
  1558*    -------------------------------
  1559     05  SEQNOL PIC S9(0004) COMP.
  1560     05  SEQNOF PIC  X(0001).
  1561     05  FILLER REDEFINES SEQNOF.
  1562         10  SEQNOA PIC  X(0001).
  1563     05  SEQNOI PIC  X(0006).
  1564*    -------------------------------
  1565     05  SIGREQL PIC S9(0004) COMP.
  1566     05  SIGREQF PIC  X(0001).
  1567     05  FILLER REDEFINES SIGREQF.
  1568         10  SIGREQA PIC  X(0001).
  1569     05  SIGREQI PIC  X(0001).
  1570*    -------------------------------
  1571     05  LTRIDL PIC S9(0004) COMP.
  1572     05  LTRIDF PIC  X(0001).
  1573     05  FILLER REDEFINES LTRIDF.
  1574         10  LTRIDA PIC  X(0001).
  1575     05  LTRIDI PIC  X(0004).
  1576*    -------------------------------
  1577     05  HLTHAPPL PIC S9(0004) COMP.
  1578     05  HLTHAPPF PIC  X(0001).
  1579     05  FILLER REDEFINES HLTHAPPF.
  1580         10  HLTHAPPA PIC  X(0001).
  1581     05  HLTHAPPI PIC  X(0001).
  1582*    -------------------------------
  1583     05  VOUCHL PIC S9(0004) COMP.
  1584     05  VOUCHF PIC  X(0001).
  1585     05  FILLER REDEFINES VOUCHF.
  1586         10  VOUCHA PIC  X(0001).
  1587     05  VOUCHI PIC  X(0001).
  1588*    -------------------------------
  1589     05  PAYEEL PIC S9(0004) COMP.
  1590     05  PAYEEF PIC  X(0001).
  1591     05  FILLER REDEFINES PAYEEF.
  1592         10  PAYEEA PIC  X(0001).
  1593     05  PAYEEI PIC  X(0010).
  1594*    -------------------------------
  1595     05  CERTIDL PIC S9(0004) COMP.
  1596     05  CERTIDF PIC  X(0001).
  1597     05  FILLER REDEFINES CERTIDF.
  1598         10  CERTIDA PIC  X(0001).
  1599     05  CERTIDI PIC  X(0005).
  1600*    -------------------------------
  1601     05  ENCCODEL PIC S9(0004) COMP.
  1602     05  ENCCODEF PIC  X(0001).
  1603     05  FILLER REDEFINES ENCCODEF.
  1604         10  ENCCODEA PIC  X(0001).
  1605     05  ENCCODEI PIC  X(0003).
  1606*    -------------------------------
  1607     05  RCD01L PIC S9(0004) COMP.
  1608     05  RCD01F PIC  X(0001).
  1609     05  FILLER REDEFINES RCD01F.
  1610         10  RCD01A PIC  X(0001).
  1611     05  RCD01I PIC  X(0004).
  1612*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  30
* EL6318.cbl
  1613     05  RCD02L PIC S9(0004) COMP.
  1614     05  RCD02F PIC  X(0001).
  1615     05  FILLER REDEFINES RCD02F.
  1616         10  RCD02A PIC  X(0001).
  1617     05  RCD02I PIC  X(0004).
  1618*    -------------------------------
  1619     05  RCD03L PIC S9(0004) COMP.
  1620     05  RCD03F PIC  X(0001).
  1621     05  FILLER REDEFINES RCD03F.
  1622         10  RCD03A PIC  X(0001).
  1623     05  RCD03I PIC  X(0004).
  1624*    -------------------------------
  1625     05  RCD04L PIC S9(0004) COMP.
  1626     05  RCD04F PIC  X(0001).
  1627     05  FILLER REDEFINES RCD04F.
  1628         10  RCD04A PIC  X(0001).
  1629     05  RCD04I PIC  X(0004).
  1630*    -------------------------------
  1631     05  RCD05L PIC S9(0004) COMP.
  1632     05  RCD05F PIC  X(0001).
  1633     05  FILLER REDEFINES RCD05F.
  1634         10  RCD05A PIC  X(0001).
  1635     05  RCD05I PIC  X(0004).
  1636*    -------------------------------
  1637     05  RCD06L PIC S9(0004) COMP.
  1638     05  RCD06F PIC  X(0001).
  1639     05  FILLER REDEFINES RCD06F.
  1640         10  RCD06A PIC  X(0001).
  1641     05  RCD06I PIC  X(0004).
  1642*    -------------------------------
  1643     05  RCD07L PIC S9(0004) COMP.
  1644     05  RCD07F PIC  X(0001).
  1645     05  FILLER REDEFINES RCD07F.
  1646         10  RCD07A PIC  X(0001).
  1647     05  RCD07I PIC  X(0004).
  1648*    -------------------------------
  1649     05  RCD08L PIC S9(0004) COMP.
  1650     05  RCD08F PIC  X(0001).
  1651     05  FILLER REDEFINES RCD08F.
  1652         10  RCD08A PIC  X(0001).
  1653     05  RCD08I PIC  X(0004).
  1654*    -------------------------------
  1655     05  RCD09L PIC S9(0004) COMP.
  1656     05  RCD09F PIC  X(0001).
  1657     05  FILLER REDEFINES RCD09F.
  1658         10  RCD09A PIC  X(0001).
  1659     05  RCD09I PIC  X(0004).
  1660*    -------------------------------
  1661     05  RCD10L PIC S9(0004) COMP.
  1662     05  RCD10F PIC  X(0001).
  1663     05  FILLER REDEFINES RCD10F.
  1664         10  RCD10A PIC  X(0001).
  1665     05  RCD10I PIC  X(0004).
  1666*    -------------------------------
  1667     05  RCD11L PIC S9(0004) COMP.
  1668     05  RCD11F PIC  X(0001).
  1669     05  FILLER REDEFINES RCD11F.
  1670         10  RCD11A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  31
* EL6318.cbl
  1671     05  RCD11I PIC  X(0004).
  1672*    -------------------------------
  1673     05  RCD12L PIC S9(0004) COMP.
  1674     05  RCD12F PIC  X(0001).
  1675     05  FILLER REDEFINES RCD12F.
  1676         10  RCD12A PIC  X(0001).
  1677     05  RCD12I PIC  X(0004).
  1678*    -------------------------------
  1679     05  CRTNT1L PIC S9(0004) COMP.
  1680     05  CRTNT1F PIC  X(0001).
  1681     05  FILLER REDEFINES CRTNT1F.
  1682         10  CRTNT1A PIC  X(0001).
  1683     05  CRTNT1I PIC  X(0063).
  1684*    -------------------------------
  1685     05  CRTNT2L PIC S9(0004) COMP.
  1686     05  CRTNT2F PIC  X(0001).
  1687     05  FILLER REDEFINES CRTNT2F.
  1688         10  CRTNT2A PIC  X(0001).
  1689     05  CRTNT2I PIC  X(0063).
  1690*    -------------------------------
  1691     05  CRTNT3L PIC S9(0004) COMP.
  1692     05  CRTNT3F PIC  X(0001).
  1693     05  FILLER REDEFINES CRTNT3F.
  1694         10  CRTNT3A PIC  X(0001).
  1695     05  CRTNT3I PIC  X(0063).
  1696*    -------------------------------
  1697     05  CRTNT4L PIC S9(0004) COMP.
  1698     05  CRTNT4F PIC  X(0001).
  1699     05  FILLER REDEFINES CRTNT4F.
  1700         10  CRTNT4A PIC  X(0001).
  1701     05  CRTNT4I PIC  X(0063).
  1702*    -------------------------------
  1703     05  BILNT1L PIC S9(0004) COMP.
  1704     05  BILNT1F PIC  X(0001).
  1705     05  FILLER REDEFINES BILNT1F.
  1706         10  BILNT1A PIC  X(0001).
  1707     05  BILNT1I PIC  X(0063).
  1708*    -------------------------------
  1709     05  BILNT2L PIC S9(0004) COMP.
  1710     05  BILNT2F PIC  X(0001).
  1711     05  FILLER REDEFINES BILNT2F.
  1712         10  BILNT2A PIC  X(0001).
  1713     05  BILNT2I PIC  X(0063).
  1714*    -------------------------------
  1715     05  ERRMSG1L PIC S9(0004) COMP.
  1716     05  ERRMSG1F PIC  X(0001).
  1717     05  FILLER REDEFINES ERRMSG1F.
  1718         10  ERRMSG1A PIC  X(0001).
  1719     05  ERRMSG1I PIC  X(0075).
  1720*    -------------------------------
  1721     05  ERRMSG2L PIC S9(0004) COMP.
  1722     05  ERRMSG2F PIC  X(0001).
  1723     05  FILLER REDEFINES ERRMSG2F.
  1724         10  ERRMSG2A PIC  X(0001).
  1725     05  ERRMSG2I PIC  X(0075).
  1726*    -------------------------------
  1727     05  PFENTRL PIC S9(0004) COMP.
  1728     05  PFENTRF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  32
* EL6318.cbl
  1729     05  FILLER REDEFINES PFENTRF.
  1730         10  PFENTRA PIC  X(0001).
  1731     05  PFENTRI PIC  9(2).
  1732 01  EL631KO REDEFINES EL631KI.
  1733     05  FILLER            PIC  X(0012).
  1734*    -------------------------------
  1735     05  FILLER            PIC  X(0003).
  1736     05  DATEO PIC  X(0008).
  1737*    -------------------------------
  1738     05  FILLER            PIC  X(0003).
  1739     05  TIMEO PIC  99.99.
  1740*    -------------------------------
  1741     05  FILLER            PIC  X(0003).
  1742     05  PROCIDO PIC  X(0004).
  1743*    -------------------------------
  1744     05  FILLER            PIC  X(0003).
  1745     05  HOSTO PIC  X(0009).
  1746*    -------------------------------
  1747     05  FILLER            PIC  X(0003).
  1748     05  SYSO PIC  X(0005).
  1749*    -------------------------------
  1750     05  FILLER            PIC  X(0003).
  1751     05  COMPANYO PIC  X(0003).
  1752*    -------------------------------
  1753     05  FILLER            PIC  X(0003).
  1754     05  DATASORO PIC  X(0001).
  1755*    -------------------------------
  1756     05  FILLER            PIC  X(0003).
  1757     05  BATCHNOO PIC  X(0006).
  1758*    -------------------------------
  1759     05  FILLER            PIC  X(0003).
  1760     05  BSEQNOO PIC  X(0008).
  1761*    -------------------------------
  1762     05  FILLER            PIC  X(0003).
  1763     05  ARCHNOO PIC  X(0008).
  1764*    -------------------------------
  1765     05  FILLER            PIC  X(0003).
  1766     05  PRTSWO PIC  X(0001).
  1767*    -------------------------------
  1768     05  FILLER            PIC  X(0003).
  1769     05  CARRO PIC  X(0001).
  1770*    -------------------------------
  1771     05  FILLER            PIC  X(0003).
  1772     05  GROUPO PIC  X(0006).
  1773*    -------------------------------
  1774     05  FILLER            PIC  X(0003).
  1775     05  STATEO PIC  X(0002).
  1776*    -------------------------------
  1777     05  FILLER            PIC  X(0003).
  1778     05  ACCTO PIC  X(0010).
  1779*    -------------------------------
  1780     05  FILLER            PIC  X(0003).
  1781     05  EFFDTO PIC  X(0008).
  1782*    -------------------------------
  1783     05  FILLER            PIC  X(0003).
  1784     05  CERTNOO PIC  X(0010).
  1785*    -------------------------------
  1786     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  33
* EL6318.cbl
  1787     05  CRTSFXO PIC  X(0001).
  1788*    -------------------------------
  1789     05  FILLER            PIC  X(0003).
  1790     05  SEQNOO PIC  999999.
  1791*    -------------------------------
  1792     05  FILLER            PIC  X(0003).
  1793     05  SIGREQO PIC  X(0001).
  1794*    -------------------------------
  1795     05  FILLER            PIC  X(0003).
  1796     05  LTRIDO PIC  X(0004).
  1797*    -------------------------------
  1798     05  FILLER            PIC  X(0003).
  1799     05  HLTHAPPO PIC  X(0001).
  1800*    -------------------------------
  1801     05  FILLER            PIC  X(0003).
  1802     05  VOUCHO PIC  X(0001).
  1803*    -------------------------------
  1804     05  FILLER            PIC  X(0003).
  1805     05  PAYEEO PIC  X(0010).
  1806*    -------------------------------
  1807     05  FILLER            PIC  X(0003).
  1808     05  CERTIDO PIC  X(0005).
  1809*    -------------------------------
  1810     05  FILLER            PIC  X(0003).
  1811     05  ENCCODEO PIC  X(0003).
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  RCD01O PIC  X(0004).
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  RCD02O PIC  X(0004).
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  RCD03O PIC  X(0004).
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  RCD04O PIC  X(0004).
  1824*    -------------------------------
  1825     05  FILLER            PIC  X(0003).
  1826     05  RCD05O PIC  X(0004).
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  RCD06O PIC  X(0004).
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  RCD07O PIC  X(0004).
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  RCD08O PIC  X(0004).
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  RCD09O PIC  X(0004).
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  RCD10O PIC  X(0004).
  1842*    -------------------------------
  1843     05  FILLER            PIC  X(0003).
  1844     05  RCD11O PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  34
* EL6318.cbl
  1845*    -------------------------------
  1846     05  FILLER            PIC  X(0003).
  1847     05  RCD12O PIC  X(0004).
  1848*    -------------------------------
  1849     05  FILLER            PIC  X(0003).
  1850     05  CRTNT1O PIC  X(0063).
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  CRTNT2O PIC  X(0063).
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  CRTNT3O PIC  X(0063).
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
  1859     05  CRTNT4O PIC  X(0063).
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  BILNT1O PIC  X(0063).
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  BILNT2O PIC  X(0063).
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
  1868     05  ERRMSG1O PIC  X(0075).
  1869*    -------------------------------
  1870     05  FILLER            PIC  X(0003).
  1871     05  ERRMSG2O PIC  X(0075).
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  PFENTRO PIC  X(0002).
  1875*    -------------------------------
  1876 01  FILLER REDEFINES EL631KI.
  1877     12  FILLER             PIC X(217).
  1878     12  REASONCDS.
  1879         16  FILLER OCCURS 12.
  1880           20  REACDL       PIC S9(4) COMP.
  1881           20  REACDA       PIC X.
  1882           20  REACD-IN     PIC X(4).
  1883     12  FILLER             PIC X(557).
  1884****************************************************************
  1885*
  1886* Copyright (c) 2007 by Clerity Solutions, Inc.
  1887* All rights reserved.
  1888*
  1889****************************************************************
  1890 01  DFHEIV.
  1891   02  DFHEIV0               PIC X(35).
  1892   02  DFHEIV1               PIC X(08).
  1893   02  DFHEIV2               PIC X(08).
  1894   02  DFHEIV3               PIC X(08).
  1895   02  DFHEIV4               PIC X(06).
  1896   02  DFHEIV5               PIC X(04).
  1897   02  DFHEIV6               PIC X(04).
  1898   02  DFHEIV7               PIC X(02).
  1899   02  DFHEIV8               PIC X(02).
  1900   02  DFHEIV9               PIC X(01).
  1901   02  DFHEIV10              PIC S9(7) COMP-3.
  1902   02  DFHEIV11              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  35
* EL6318.cbl
  1903   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1904   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1905   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1906   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1907   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1908   02  DFHEIV17              PIC X(04).
  1909   02  DFHEIV18              PIC X(04).
  1910   02  DFHEIV19              PIC X(04).
  1911   02  DFHEIV20              USAGE IS POINTER.
  1912   02  DFHEIV21              USAGE IS POINTER.
  1913   02  DFHEIV22              USAGE IS POINTER.
  1914   02  DFHEIV23              USAGE IS POINTER.
  1915   02  DFHEIV24              USAGE IS POINTER.
  1916   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1917   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1918   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1919   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1920   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1921   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1922   02  FILLER                PIC X(02).
  1923   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1924   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1925   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1926   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1927   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1928 LINKAGE  SECTION.
  1929*****************************************************************
  1930*                                                               *
  1931* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1932* All rights reserved.                                          *
  1933*                                                               *
  1934*****************************************************************
  1935 01  dfheiblk.
  1936     02  eibtime          pic s9(7) comp-3.
  1937     02  eibdate          pic s9(7) comp-3.
  1938     02  eibtrnid         pic x(4).
  1939     02  eibtaskn         pic s9(7) comp-3.
  1940     02  eibtrmid         pic x(4).
  1941     02  dfheigdi         pic s9(4) comp.
  1942     02  eibcposn         pic s9(4) comp.
  1943     02  eibcalen         pic s9(4) comp.
  1944     02  eibaid           pic x(1).
  1945     02  eibfiller1       pic x(1).
  1946     02  eibfn            pic x(2).
  1947     02  eibfiller2       pic x(2).
  1948     02  eibrcode         pic x(6).
  1949     02  eibfiller3       pic x(2).
  1950     02  eibds            pic x(8).
  1951     02  eibreqid         pic x(8).
  1952     02  eibrsrce         pic x(8).
  1953     02  eibsync          pic x(1).
  1954     02  eibfree          pic x(1).
  1955     02  eibrecv          pic x(1).
  1956     02  eibsend          pic x(1).
  1957     02  eibatt           pic x(1).
  1958     02  eibeoc           pic x(1).
  1959     02  eibfmh           pic x(1).
  1960     02  eibcompl         pic x(1).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  36
* EL6318.cbl
  1961     02  eibsig           pic x(1).
  1962     02  eibconf          pic x(1).
  1963     02  eiberr           pic x(1).
  1964     02  eibrldbk         pic x(1).
  1965     02  eiberrcd         pic x(4).
  1966     02  eibsynrb         pic x(1).
  1967     02  eibnodat         pic x(1).
  1968     02  eibfiller5       pic x(2).
  1969     02  eibresp          pic 9(09) comp.
  1970     02  eibresp2         pic 9(09) comp.
  1971     02  dfheigdj         pic s9(4) comp.
  1972     02  dfheigdk         pic s9(4) comp.
  1973 01  DFHCOMMAREA                 PIC X(1300).
  1974 01  var  pic x(30).
  1975*                                COPY ERCACCT.
  1976******************************************************************
  1977*                                                                *
  1978*                                                                *
  1979*                            ERCACCT                             *
  1980*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1981*                            VMOD=2.031                          *
  1982*                                                                *
  1983*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1984*                                                                *
  1985*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1986*   VSAM ACCOUNT MASTER FILES.                                   *
  1987*                                                                *
  1988*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1989*                                                                *
  1990*   FILE TYPE = VSAM,KSDS                                        *
  1991*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1992*                                                                *
  1993*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1994*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1995*                                                                *
  1996*   LOG = NO                                                     *
  1997*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1998*                                                                *
  1999*                                                                *
  2000******************************************************************
  2001*                   C H A N G E   L O G
  2002*
  2003* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2004*-----------------------------------------------------------------
  2005*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2006* EFFECTIVE    NUMBER
  2007*-----------------------------------------------------------------
  2008* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2009* 092705    2005050300006  PEMA  ADD SPP LEASES
  2010* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2011* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2012* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2013* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2014* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2015******************************************************************
  2016
  2017 01  ACCOUNT-MASTER.
  2018     12  AM-RECORD-ID                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  37
* EL6318.cbl
  2019         88  VALID-AM-ID                      VALUE 'AM'.
  2020
  2021     12  AM-CONTROL-PRIMARY.
  2022         16  AM-COMPANY-CD                 PIC X.
  2023         16  AM-MSTR-CNTRL.
  2024             20  AM-CONTROL-A.
  2025                 24  AM-CARRIER            PIC X.
  2026                 24  AM-GROUPING.
  2027                     28 AM-GROUPING-PREFIX PIC XXX.
  2028                     28 AM-GROUPING-PRIME  PIC XXX.
  2029                 24  AM-STATE              PIC XX.
  2030                 24  AM-ACCOUNT.
  2031                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2032                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2033             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2034                                           PIC X(19).
  2035             20  AM-CNTRL-B.
  2036                 24  AM-EXPIRATION-DT      PIC XX.
  2037                 24  FILLER                PIC X(4).
  2038             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2039                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2040
  2041     12  AM-CONTROL-BY-VAR-GRP.
  2042         16  AM-COMPANY-CD-A1              PIC X.
  2043         16  AM-VG-CARRIER                 PIC X.
  2044         16  AM-VG-GROUPING                PIC X(6).
  2045         16  AM-VG-STATE                   PIC XX.
  2046         16  AM-VG-ACCOUNT                 PIC X(10).
  2047         16  AM-VG-DATE.
  2048             20  AM-VG-EXPIRATION-DT       PIC XX.
  2049             20  FILLER                    PIC X(4).
  2050         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2051                                           PIC 9(11)      COMP-3.
  2052     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2053         16  FILLER                        PIC X(10).
  2054         16  AM-VG-KEY3.
  2055             20  AM-VG3-ACCOUNT            PIC X(10).
  2056             20  AM-VG3-EXP-DT             PIC XX.
  2057         16  FILLER                        PIC X(4).
  2058     12  AM-MAINT-INFORMATION.
  2059         16  AM-LAST-MAINT-DT              PIC XX.
  2060         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2061         16  AM-LAST-MAINT-USER            PIC X(4).
  2062         16  FILLER                        PIC XX.
  2063
  2064     12  AM-EFFECTIVE-DT                   PIC XX.
  2065     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2066
  2067     12  AM-PREV-DATES  COMP-3.
  2068         16  AM-PREV-EXP-DT                PIC 9(11).
  2069         16  AM-PREV-EFF-DT                PIC 9(11).
  2070
  2071     12  AM-REPORT-CODE-1                  PIC X(10).
  2072     12  AM-REPORT-CODE-2                  PIC X(10).
  2073
  2074     12  AM-CITY-CODE                      PIC X(4).
  2075     12  AM-COUNTY-PARISH                  PIC X(6).
  2076
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  38
* EL6318.cbl
  2077     12  AM-NAME                           PIC X(30).
  2078     12  AM-PERSON                         PIC X(30).
  2079     12  AM-ADDRS                          PIC X(30).
  2080     12  AM-CITY.
  2081         16  AM-ADDR-CITY                  PIC X(28).
  2082         16  AM-ADDR-STATE                 PIC XX.
  2083     12  AM-ZIP.
  2084         16  AM-ZIP-PRIME.
  2085             20  AM-ZIP-PRI-1ST            PIC X.
  2086                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2087             20  FILLER                    PIC X(4).
  2088         16  AM-ZIP-PLUS4                  PIC X(4).
  2089     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2090         16  AM-CAN-POSTAL-1               PIC XXX.
  2091         16  AM-CAN-POSTAL-2               PIC XXX.
  2092         16  FILLER                        PIC XXX.
  2093     12  AM-TEL-NO.
  2094         16  AM-AREA-CODE                  PIC 999.
  2095         16  AM-TEL-PRE                    PIC 999.
  2096         16  AM-TEL-NBR                    PIC 9(4).
  2097     12  AM-TEL-LOC                        PIC X.
  2098         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2099         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2100
  2101     12  AM-COMM-STRUCTURE.
  2102         16  AM-DEFN-1.
  2103             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2104                 24  AM-AGT.
  2105                     28  AM-AGT-PREFIX     PIC X(4).
  2106                     28  AM-AGT-PRIME      PIC X(6).
  2107                 24  AM-COM-TYP            PIC X.
  2108                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2109                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2110                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2111                 24  AM-RECALC-LV-INDIC    PIC X.
  2112                 24  AM-RETRO-LV-INDIC     PIC X.
  2113                 24  AM-GL-CODES           PIC X.
  2114                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2115                 24  FILLER                PIC X(01).
  2116         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2117             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2118                 24  FILLER                PIC X(11).
  2119                 24  AM-L-COMA             PIC XXX.
  2120                 24  AM-J-COMA             PIC XXX.
  2121                 24  AM-A-COMA             PIC XXX.
  2122                 24  FILLER                PIC X(6).
  2123
  2124     12  AM-COMM-CHANGE-STATUS             PIC X.
  2125         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2126
  2127     12  AM-CSR-CODE                       PIC X(4).
  2128
  2129     12  AM-BILLING-STATUS                 PIC X.
  2130         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2131         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2132     12  AM-AUTO-REFUND-SW                 PIC X.
  2133         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2134         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  39
* EL6318.cbl
  2135     12  AM-GPCD                           PIC 99.
  2136     12  AM-IG                             PIC X.
  2137         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2138         88  AM-HAS-GROUP                     VALUE '2'.
  2139     12  AM-STATUS                         PIC X.
  2140         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2141         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2142         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2143         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2144         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2145         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2146     12  AM-REMIT-TO                       PIC 99.
  2147     12  AM-ID-NO                          PIC X(11).
  2148
  2149     12  AM-CAL-TABLE                      PIC XX.
  2150     12  AM-LF-DEVIATION                   PIC XXX.
  2151     12  AM-AH-DEVIATION                   PIC XXX.
  2152     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2153     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2154     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2155     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2156     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2157     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2158
  2159     12  AM-USER-FIELDS.
  2160         16  AM-FLD-1                      PIC XX.
  2161         16  AM-FLD-2                      PIC XX.
  2162         16  AM-FLD-3                      PIC XX.
  2163         16  AM-FLD-4                      PIC XX.
  2164         16  AM-FLD-5                      PIC XX.
  2165
  2166     12  AM-1ST-PROD-DATE.
  2167         16  AM-1ST-PROD-YR                PIC XX.
  2168         16  AM-1ST-PROD-MO                PIC XX.
  2169         16  AM-1ST-PROD-DA                PIC XX.
  2170     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2171     12  AM-CERTS-PURGED-DATE.
  2172         16  AM-PUR-YR                     PIC XX.
  2173         16  AM-PUR-MO                     PIC XX.
  2174         16  AM-PUR-DA                     PIC XX.
  2175     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2176     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2177     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2178     12  AM-INACTIVE-DATE.
  2179         16  AM-INA-MO                     PIC 99.
  2180         16  AM-INA-DA                     PIC 99.
  2181         16  AM-INA-YR                     PIC 99.
  2182     12  AM-AR-HI-CERT-DATE                PIC XX.
  2183
  2184     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2185     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2186
  2187     12  AM-OB-PAYMENT-MODE                PIC X.
  2188         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2189         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2190         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2191         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2192
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  40
* EL6318.cbl
  2193     12  AM-AH-ONLY-INDICATOR              PIC X.
  2194         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2195         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2196
  2197     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2198
  2199     12  AM-OVER-SHORT.
  2200         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2201         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2202
  2203     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2204     12  AM-DCC-CLP-STATE                  PIC XX.
  2205
  2206     12  AM-RECALC-COMM                    PIC X.
  2207     12  AM-RECALC-REIN                    PIC X.
  2208
  2209     12  AM-REI-TABLE                      PIC XXX.
  2210     12  AM-REI-ET-LF                      PIC X.
  2211     12  AM-REI-ET-AH                      PIC X.
  2212     12  AM-REI-PE-LF                      PIC X.
  2213     12  AM-REI-PE-AH                      PIC X.
  2214     12  AM-REI-PRT-ST                     PIC X.
  2215     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2216     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2217     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2218     12  AM-REI-GROUP-A                    PIC X(6).
  2219     12  AM-REI-MORT                       PIC X(4).
  2220     12  AM-REI-PRT-OW                     PIC X.
  2221     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2222     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2223     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2224     12  AM-REI-GROUP-B                    PIC X(6).
  2225
  2226     12  AM-TRUST-TYPE                     PIC X(2).
  2227
  2228     12  AM-EMPLOYER-STMT-USED             PIC X.
  2229     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2230
  2231     12  AM-STD-AH-TYPE                    PIC XX.
  2232     12  AM-EARN-METHODS.
  2233         16  AM-EARN-METHOD-R              PIC X.
  2234             88 AM-REF-RL-R78                 VALUE 'R'.
  2235             88 AM-REF-RL-PR                  VALUE 'P'.
  2236             88 AM-REF-RL-MEAN                VALUE 'M'.
  2237             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2238         16  AM-EARN-METHOD-L              PIC X.
  2239             88 AM-REF-LL-R78                 VALUE 'R'.
  2240             88 AM-REF-LL-PR                  VALUE 'P'.
  2241             88 AM-REF-LL-MEAN                VALUE 'M'.
  2242             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2243         16  AM-EARN-METHOD-A              PIC X.
  2244             88 AM-REF-AH-R78                 VALUE 'R'.
  2245             88 AM-REF-AH-PR                  VALUE 'P'.
  2246             88 AM-REF-AH-MEAN                VALUE 'M'.
  2247             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2248             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2249             88 AM-REF-AH-NET                 VALUE 'N'.
  2250
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  41
* EL6318.cbl
  2251     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2252     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2253     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2254
  2255     12  AM-RET-Y-N                        PIC X.
  2256     12  AM-RET-P-E                        PIC X.
  2257     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2258     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2259     12  AM-RET-GRP                        PIC X(6).
  2260     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2261         16  AM-POOL-PRIME                 PIC XXX.
  2262         16  AM-POOL-SUB                   PIC XXX.
  2263     12  AM-RETRO-EARNINGS.
  2264         16  AM-RET-EARN-R                 PIC X.
  2265         16  AM-RET-EARN-L                 PIC X.
  2266         16  AM-RET-EARN-A                 PIC X.
  2267     12  AM-RET-ST-TAX-USE                 PIC X.
  2268         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2269         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2270     12  AM-RETRO-BEG-EARNINGS.
  2271         16  AM-RET-BEG-EARN-R             PIC X.
  2272         16  AM-RET-BEG-EARN-L             PIC X.
  2273         16  AM-RET-BEG-EARN-A             PIC X.
  2274     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2275     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2276
  2277     12  AM-USER-SELECT-OPTIONS.
  2278         16  AM-USER-SELECT-1              PIC X(10).
  2279         16  AM-USER-SELECT-2              PIC X(10).
  2280         16  AM-USER-SELECT-3              PIC X(10).
  2281         16  AM-USER-SELECT-4              PIC X(10).
  2282         16  AM-USER-SELECT-5              PIC X(10).
  2283
  2284     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2285
  2286     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2287
  2288     12  AM-RPT045A-SWITCH                 PIC X.
  2289         88  RPT045A-OFF                   VALUE 'N'.
  2290
  2291     12  AM-INSURANCE-LIMITS.
  2292         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2293         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2294
  2295     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2296         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2297
  2298     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2299         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2300         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2301
  2302     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2303
  2304     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2305     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2306     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2307     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2308     12  AM-DCC-UEF-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  42
* EL6318.cbl
  2309     12  FILLER                            PIC XXX.
  2310     12  AM-REPORT-CODE-3                  PIC X(10).
  2311*    12  FILLER                            PIC X(22).
  2312
  2313     12  AM-RESERVE-DATE.
  2314         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2315         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2316         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2317
  2318     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2319     12  AM-NOTIFICATION-TYPES.
  2320         16  AM-NOTIF-OF-LETTERS           PIC X.
  2321         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2322         16  AM-NOTIF-OF-REPORTS           PIC X.
  2323         16  AM-NOTIF-OF-STATUS            PIC X.
  2324
  2325     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2326         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2327         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2328         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2329         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2330
  2331     12  AM-BENEFIT-CONTROLS.
  2332         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2333             20  AM-BENEFIT-CODE           PIC XX.
  2334             20  AM-BENEFIT-TYPE           PIC X.
  2335             20  AM-BENEFIT-REVISION       PIC XXX.
  2336             20  AM-BENEFIT-REM-TERM       PIC X.
  2337             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2338             20  FILLER                    PIC XX.
  2339         16  FILLER                        PIC X(80).
  2340
  2341     12  AM-TRANSFER-DATA.
  2342         16  AM-TRANSFERRED-FROM.
  2343             20  AM-TRNFROM-CARRIER        PIC X.
  2344             20  AM-TRNFROM-GROUPING.
  2345                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2346                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2347             20  AM-TRNFROM-STATE          PIC XX.
  2348             20  AM-TRNFROM-ACCOUNT.
  2349                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2350                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2351             20  AM-TRNFROM-DTE            PIC XX.
  2352         16  AM-TRANSFERRED-TO.
  2353             20  AM-TRNTO-CARRIER          PIC X.
  2354             20  AM-TRNTO-GROUPING.
  2355                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2356                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2357             20  AM-TRNTO-STATE            PIC XX.
  2358             20  AM-TRNTO-ACCOUNT.
  2359                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2360                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2361             20  AM-TRNTO-DTE              PIC XX.
  2362         16  FILLER                        PIC X(10).
  2363
  2364     12  AM-SAVED-REMIT-TO                 PIC 99.
  2365
  2366     12  AM-COMM-STRUCTURE-SAVED.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  43
* EL6318.cbl
  2367         16  AM-DEFN-1-SAVED.
  2368             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2369                 24  AM-AGT-SV             PIC X(10).
  2370                 24  AM-COM-TYP-SV         PIC X.
  2371                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2372                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2373                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2374                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2375                 24  FILLER                PIC X.
  2376                 24  AM-GL-CODES-SV        PIC X.
  2377                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2378                 24  FILLER                PIC X.
  2379         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2380             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2381                 24  FILLER                PIC X(11).
  2382                 24  AM-L-COMA-SV          PIC XXX.
  2383                 24  AM-J-COMA-SV          PIC XXX.
  2384                 24  AM-A-COMA-SV          PIC XXX.
  2385                 24  FILLER                PIC X(6).
  2386
  2387     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2388         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2389            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2390            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2391            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2392
  2393     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2394     12  FILLER                            PIC X(120).
  2395
  2396     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2397         16  AM-CONTROL-NAME               PIC X(30).
  2398         16  AM-EXECUTIVE-ONE.
  2399             20  AM-EXEC1-NAME             PIC X(15).
  2400             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2401                                                          COMP-3.
  2402             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2403                                                          COMP-3.
  2404         16  AM-EXECUTIVE-TWO.
  2405             20  AM-EXEC2-NAME             PIC X(15).
  2406             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2407                                                          COMP-3.
  2408             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2409                                                          COMP-3.
  2410
  2411     12  AM-RETRO-ADDITIONAL-DATA.
  2412         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2413         16  AM-RETRO-PREM-P-E             PIC X.
  2414         16  AM-RETRO-CLMS-P-I             PIC X.
  2415         16  AM-RETRO-RET-BRACKET-LF.
  2416             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2417                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2418                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2419             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2420                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2421                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2422             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2423                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2424                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  44
* EL6318.cbl
  2425         16  AM-RETRO-RET-BRACKET-AH.
  2426             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2427                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2428                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2429                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2430             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2431                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2432                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2433             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2434                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2435                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2436
  2437     12  AM-COMMENTS.
  2438         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2439
  2440     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2441         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2442         16  AM-FLI-BILLING-CODE           PIC X.
  2443         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2444         16  AM-FLI-UNITED-IDENT           PIC X.
  2445         16  AM-FLI-INTEREST-LOST-DATA.
  2446             20  AM-FLI-BANK-NO            PIC X(5).
  2447             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2448             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2449             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2450         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2451             20  AM-FLI-AGT                PIC X(9).
  2452             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2453             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2454         16  FILLER                        PIC X(102).
  2455
  2456     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2457         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2458             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2459             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2460             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2461             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2462             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2463         16  FILLER                          PIC X(10).
  2464******************************************************************
  2465*                                COPY ELCCNTL.
  2466******************************************************************
  2467*                                                                *
  2468*                                                                *
  2469*                            ELCCNTL.                            *
  2470*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2471*                            VMOD=2.059                          *
  2472*                                                                *
  2473*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2474*                                                                *
  2475*   FILE TYPE = VSAM,KSDS                                        *
  2476*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2477*                                                                *
  2478*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2479*       ALTERNATE INDEX = NONE                                   *
  2480*                                                                *
  2481*   LOG = YES                                                    *
  2482*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  45
* EL6318.cbl
  2483******************************************************************
  2484*                   C H A N G E   L O G
  2485*
  2486* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2487*-----------------------------------------------------------------
  2488*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2489* EFFECTIVE    NUMBER
  2490*-----------------------------------------------------------------
  2491* 082503                   PEMA  ADD BENEFIT GROUP
  2492* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2493* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2494* 092705    2005050300006  PEMA  ADD SPP LEASES
  2495* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2496* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2497* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2498* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2499* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2500* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2501* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2502* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2503* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2504* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2505******************************************************************
  2506*
  2507 01  CONTROL-FILE.
  2508     12  CF-RECORD-ID                       PIC XX.
  2509         88  VALID-CF-ID                        VALUE 'CF'.
  2510
  2511     12  CF-CONTROL-PRIMARY.
  2512         16  CF-COMPANY-ID                  PIC XXX.
  2513         16  CF-RECORD-TYPE                 PIC X.
  2514             88  CF-COMPANY-MASTER              VALUE '1'.
  2515             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2516             88  CF-STATE-MASTER                VALUE '3'.
  2517             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2518             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2519             88  CF-CARRIER-MASTER              VALUE '6'.
  2520             88  CF-MORTALITY-MASTER            VALUE '7'.
  2521             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2522             88  CF-TERMINAL-MASTER             VALUE '9'.
  2523             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2524             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2525             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2526             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2527             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2528             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2529             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2530             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2531             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2532         16  CF-ACCESS-CD-GENL              PIC X(4).
  2533         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2534             20  CF-PROCESSOR               PIC X(4).
  2535         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2536             20  CF-STATE-CODE              PIC XX.
  2537             20  FILLER                     PIC XX.
  2538         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2539             20  FILLER                     PIC XX.
  2540             20  CF-HI-BEN-IN-REC           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  46
* EL6318.cbl
  2541         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2542             20  FILLER                     PIC XXX.
  2543             20  CF-CARRIER-CNTL            PIC X.
  2544         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2545             20  FILLER                     PIC XX.
  2546             20  CF-HI-TYPE-IN-REC          PIC 99.
  2547         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2548             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2549                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2550             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2551             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2552         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2553             20  FILLER                     PIC X.
  2554             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2555         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2556             20  FILLER                     PIC XX.
  2557             20  CF-MORTGAGE-PLAN           PIC XX.
  2558         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2559
  2560     12  CF-LAST-MAINT-DT                   PIC XX.
  2561     12  CF-LAST-MAINT-BY                   PIC X(4).
  2562     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2563
  2564     12  CF-RECORD-BODY                     PIC X(728).
  2565
  2566
  2567****************************************************************
  2568*             COMPANY MASTER RECORD                            *
  2569****************************************************************
  2570
  2571     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2572         16  CF-COMPANY-ADDRESS.
  2573             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2574             20  CF-CL-IN-CARE-OF           PIC X(30).
  2575             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2576             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2577             20  CF-CL-CITY-STATE           PIC X(30).
  2578             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2579             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2580         16  CF-COMPANY-CD                  PIC X.
  2581         16  CF-COMPANY-PASSWORD            PIC X(8).
  2582         16  CF-SECURITY-OPTION             PIC X.
  2583             88  ALL-SECURITY                   VALUE '1'.
  2584             88  COMPANY-VERIFY                 VALUE '2'.
  2585             88  PROCESSOR-VERIFY               VALUE '3'.
  2586             88  NO-SECURITY                    VALUE '4'.
  2587             88  ALL-BUT-TERM                   VALUE '5'.
  2588         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2589             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2590         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2591             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2592         16  CF-INFORCE-LOCATION            PIC X.
  2593             88  CERTS-ARE-ONLINE               VALUE '1'.
  2594             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2595             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2596         16  CF-LOWER-CASE-LETTERS          PIC X.
  2597         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2598             88  CF-ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  47
* EL6318.cbl
  2599             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2600             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2601             88  CF-ACCNT-CNTL                  VALUE '3'.
  2602             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2603
  2604         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2605         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2606
  2607         16  CF-LGX-CREDIT-USER             PIC X.
  2608             88  CO-IS-NOT-USER                 VALUE 'N'.
  2609             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2610
  2611         16 CF-CREDIT-CALC-CODES.
  2612             20  CF-CR-REM-TERM-CALC PIC X.
  2613               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2614               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2615               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2616               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2617               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2618               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2619               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2620             20  CF-CR-R78-METHOD           PIC X.
  2621               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2622               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2623
  2624         16  CF-CLAIM-CONTROL-COUNTS.
  2625             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2626                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2627
  2628             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2629                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2630
  2631             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2632                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2633
  2634             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2635                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2636
  2637         16  CF-CURRENT-MONTH-END           PIC XX.
  2638
  2639         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2640             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2641             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2642             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2643             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2644                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2645                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2646             20  CF-CO-PREM-REJECT-SW       PIC X.
  2647                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2648                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2649             20  CF-CO-REF-REJECT-SW        PIC X.
  2650                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2651                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2652
  2653         16  CF-CO-REPORTING-DT             PIC XX.
  2654         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2655         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2656           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  48
* EL6318.cbl
  2657           88  CF-CO-MONTH-END                  VALUE '1'.
  2658
  2659         16  CF-LGX-CLAIM-USER              PIC X.
  2660             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2661             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2662
  2663         16  CF-CREDIT-EDIT-CONTROLS.
  2664             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2665             20  CF-MIN-AGE                 PIC 99.
  2666             20  CF-DEFAULT-AGE             PIC 99.
  2667             20  CF-MIN-TERM                PIC S999      COMP-3.
  2668             20  CF-MAX-TERM                PIC S999      COMP-3.
  2669             20  CF-DEFAULT-SEX             PIC X.
  2670             20  CF-JOINT-AGE-INPUT         PIC X.
  2671                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2672             20  CF-BIRTH-DATE-INPUT        PIC X.
  2673                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2674             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2675                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2676                 88  CF-ZERO-CARRIER            VALUE '1'.
  2677                 88  CF-ZERO-GROUPING           VALUE '2'.
  2678                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2679             20  CF-EDIT-SW                 PIC X.
  2680                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2681             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2682             20  CF-CR-PR-METHOD            PIC X.
  2683               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2684               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2685             20  FILLER                     PIC X.
  2686
  2687         16  CF-CREDIT-MISC-CONTROLS.
  2688             20  CF-REIN-TABLE-SW           PIC X.
  2689                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2690             20  CF-COMP-TABLE-SW           PIC X.
  2691                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2692             20  CF-EXPERIENCE-RETENTION-AGE
  2693                                            PIC S9        COMP-3.
  2694             20  CF-CONVERSION-DT           PIC XX.
  2695             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2696             20  CF-RUN-FREQUENCY-SW        PIC X.
  2697                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2698                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2699
  2700             20  CF-CR-CHECK-NO-CONTROL.
  2701                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2702                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2703                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2704                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2705                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2706                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2707
  2708                 24  CF-CR-CHECK-COUNT       REDEFINES
  2709                     CF-CR-CHECK-COUNTER      PIC X(4).
  2710
  2711                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2712                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2713
  2714                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  49
* EL6318.cbl
  2715                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2716                 24  CF-MAIL-PROCESSING       PIC X.
  2717                     88  MAIL-PROCESSING          VALUE 'Y'.
  2718
  2719         16  CF-MISC-SYSTEM-CONTROL.
  2720             20  CF-SYSTEM-C                 PIC X.
  2721                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2722             20  CF-SYSTEM-D                 PIC X.
  2723                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2724             20  CF-SOC-SEC-NO-SW            PIC X.
  2725                 88  SOC-SEC-NO-USED             VALUE '1'.
  2726             20  CF-MEMBER-NO-SW             PIC X.
  2727                 88  MEMBER-NO-USED              VALUE '1'.
  2728             20  CF-TAX-ID-NUMBER            PIC X(11).
  2729             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2730             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2731                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2732                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2733                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2734                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2735             20  CF-SYSTEM-E                 PIC X.
  2736                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2737
  2738         16  CF-LGX-LIFE-USER               PIC X.
  2739             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2740             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2741
  2742         16  CF-CR-MONTH-END-DT             PIC XX.
  2743
  2744         16  CF-FILE-MAINT-DATES.
  2745             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2746                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2747             20  CF-LAST-BATCH       REDEFINES
  2748                 CF-LAST-BATCH-NO               PIC X(4).
  2749             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2750             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2751             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2752             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2753             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2754             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2755             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2756             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2757             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2758             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2759
  2760         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2761         16  FILLER                         PIC X.
  2762
  2763         16  CF-ALT-MORT-CODE               PIC X(4).
  2764         16  CF-MEMBER-CAPTION              PIC X(10).
  2765
  2766         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2767             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2768             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2769             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2770             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2771             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2772
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  50
* EL6318.cbl
  2773         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2774
  2775         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2776         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2777         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2778         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2779
  2780         16  CF-AH-OVERRIDE-L1              PIC X.
  2781         16  CF-AH-OVERRIDE-L2              PIC XX.
  2782         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2783         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2784
  2785         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2786         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2787
  2788         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2789         16  CF-AR-LAST-EL860-DT            PIC XX.
  2790         16  CF-MP-MONTH-END-DT             PIC XX.
  2791
  2792         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2793         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2794             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2795
  2796         16  CF-AR-MONTH-END-DT             PIC XX.
  2797
  2798         16  CF-CRDTCRD-USER                PIC X.
  2799             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2800             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2801
  2802         16  CF-CC-MONTH-END-DT             PIC XX.
  2803
  2804         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2805
  2806         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2807             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2808             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2809             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2810         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2811         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2812         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2813         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2814             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2815             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2816         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2817         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2818         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2819             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2820         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2821
  2822         16  CF-CL-ZIP-CODE.
  2823             20  CF-CL-ZIP-PRIME.
  2824                 24  CF-CL-ZIP-1ST          PIC X.
  2825                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2826                 24  FILLER                 PIC X(4).
  2827             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2828         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2829             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2830             20  CF-CL-CAN-POSTAL-2         PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  51
* EL6318.cbl
  2831             20  FILLER                     PIC XXX.
  2832
  2833         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2834         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2835         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2836         16  CF-CO-OPTION-START-DATE        PIC XX.
  2837         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2838           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2839                                                      '3' '4'.
  2840           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2841           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2842           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2843           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2844           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2845           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2846
  2847         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2848
  2849         16  CF-PAYMENT-APPROVAL-LEVELS.
  2850             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2851             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2852             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2853             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2854             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2855             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2856
  2857         16  CF-END-USER-REPORTING-USER     PIC X.
  2858             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2859             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2860
  2861         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2862             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2863             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2864
  2865         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2866
  2867         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2868         16  FILLER                         PIC X.
  2869
  2870         16  CF-CREDIT-ARCHIVE-CNTL.
  2871             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2872             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2873             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2874
  2875         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2876
  2877         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2878             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2879             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2880
  2881         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2882             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2883             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2884
  2885         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2886
  2887         16  CF-CO-ACH-ID-CODE              PIC  X.
  2888             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  52
* EL6318.cbl
  2889             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2890             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2891         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2892         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2893         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2894         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2895         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2896         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2897         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2898         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2899         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2900                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2901         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2902                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2903
  2904         16  CF-CO-OVER-SHORT.
  2905             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2906             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2907
  2908*         16  FILLER                         PIC X(102).
  2909         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2910             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2911             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2912
  2913         16  CF-AH-APPROVAL-DAYS.
  2914             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2915             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2916             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2917             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2918
  2919         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2920
  2921         16  CF-APPROV-LEV-5.
  2922             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2923             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2924             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2925
  2926         16  FILLER                         PIC X(68).
  2927****************************************************************
  2928*             PROCESSOR/USER RECORD                            *
  2929****************************************************************
  2930
  2931     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2932         16  CF-PROCESSOR-NAME              PIC X(30).
  2933         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2934         16  CF-PROCESSOR-TITLE             PIC X(26).
  2935         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2936                 88  MESSAGE-YES                VALUE 'Y'.
  2937                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2938
  2939*****************************************************
  2940****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2941****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2942****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2943****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2944*****************************************************
  2945
  2946         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  53
* EL6318.cbl
  2947             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2948             20  CF-APPLICATION-FORCE       PIC X.
  2949             20  CF-INDIVIDUAL-APP.
  2950                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2951                     28  CF-BROWSE-APP      PIC X.
  2952                     28  CF-UPDATE-APP      PIC X.
  2953
  2954         16  CF-CURRENT-TERM-ON             PIC X(4).
  2955         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2956             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2957             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2958             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2959             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2960             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2961             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2962             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2963         16  CF-PROCESSOR-CARRIER           PIC X.
  2964             88  NO-CARRIER-SECURITY            VALUE ' '.
  2965         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2966             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2967         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2968             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2969         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2970             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2971
  2972         16  CF-PROC-SYS-ACCESS-SW.
  2973             20  CF-PROC-CREDIT-CLAIMS-SW.
  2974                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2975                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2976                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2977                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2978             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2979                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2980                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2981             20  CF-PROC-LIFE-GNRLDGR-SW.
  2982                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2983                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2984                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2985                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2986             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2987                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2988                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2989         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2990             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2991             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2992         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2993
  2994         16  CF-APPROVAL-LEVEL                  PIC X.
  2995             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2996             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2997             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2998             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2999             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3000
  3001         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3002
  3003         16  CF-LANGUAGE-TYPE                   PIC X.
  3004             88  CF-LANG-IS-ENG                     VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  54
* EL6318.cbl
  3005             88  CF-LANG-IS-FR                      VALUE 'F'.
  3006
  3007         16  CF-CSR-IND                         PIC X.
  3008         16  FILLER                             PIC X(239).
  3009
  3010****************************************************************
  3011*             PROCESSOR/REMINDERS RECORD                       *
  3012****************************************************************
  3013
  3014     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3015         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3016             20  CF-START-REMIND-DT         PIC XX.
  3017             20  CF-END-REMIND-DT           PIC XX.
  3018             20  CF-REMINDER-TEXT           PIC X(50).
  3019         16  FILLER                         PIC X(296).
  3020
  3021
  3022****************************************************************
  3023*             STATE MASTER RECORD                              *
  3024****************************************************************
  3025
  3026     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3027         16  CF-STATE-ABBREVIATION          PIC XX.
  3028         16  CF-STATE-NAME                  PIC X(25).
  3029         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3030         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3031             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3032             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3033             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3034             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3035                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3036                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3037             20  CF-ST-PREM-REJECT-SW       PIC X.
  3038                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3039                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3040             20  CF-ST-REF-REJECT-SW        PIC X.
  3041                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3042                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3043         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3044         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3045         16  CF-ST-REFUND-RULES.
  3046             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3047             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3048             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3049         16  CF-ST-FST-PMT-EXTENSION.
  3050             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3051             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3052                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3053                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3054                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3055                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3056         16  CF-ST-STATE-CALL.
  3057             20  CF-ST-CALL-UNEARNED        PIC X.
  3058             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3059             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3060         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3061             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3062             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  55
* EL6318.cbl
  3063         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3064         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3065         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3066         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3067         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3068         16  FILLER                         PIC X.
  3069         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3070             20  CF-ST-BENEFIT-CD           PIC XX.
  3071             20  CF-ST-BENEFIT-KIND         PIC X.
  3072                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3073                 88  CF-ST-AH-KIND              VALUE 'A'.
  3074             20  CF-ST-REM-TERM-CALC        PIC X.
  3075                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3076                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3077                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3078                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3079                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3080                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3081                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3082                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3083
  3084             20  CF-ST-REFUND-CALC          PIC X.
  3085                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3086                 88  ST-REFD-BY-R78             VALUE '1'.
  3087                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3088                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3089                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3090                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3091                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3092                 88  ST-REFD-UTAH               VALUE '7'.
  3093                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3094                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3095                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3096
  3097             20  CF-ST-EARNING-CALC         PIC X.
  3098                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3099                 88  ST-EARN-BY-R78             VALUE '1'.
  3100                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3101                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3102                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3103                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3104                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3105                 88  ST-EARN-MEAN               VALUE '8'.
  3106                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3107
  3108             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3109                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3110                 88  ST-OVRD-BY-R78             VALUE '1'.
  3111                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3112                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3113                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3114                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3115                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3116                 88  ST-OVRD-MEAN               VALUE '8'.
  3117                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3118             20  cf-st-extra-periods        pic 9.
  3119*            20  FILLER                     PIC X.
  3120
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  56
* EL6318.cbl
  3121         16  CF-ST-COMMISSION-CAPS.
  3122             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3123             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3124             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3125             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3126         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3127                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3128
  3129         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3130
  3131         16  CF-ST-STATUTORY-INTEREST.
  3132             20  CF-ST-STAT-DATE-FROM       PIC X.
  3133                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3134                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3135             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3136             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3137             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3138             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3139             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3140
  3141         16  CF-ST-OVER-SHORT.
  3142             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3143             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3144
  3145         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3146
  3147         16  CF-ST-RT-CALC                  PIC X.
  3148
  3149         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3150         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3151         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3152         16  CF-ST-RF-LR-CALC               PIC X.
  3153         16  CF-ST-RF-LL-CALC               PIC X.
  3154         16  CF-ST-RF-LN-CALC               PIC X.
  3155         16  CF-ST-RF-AH-CALC               PIC X.
  3156         16  CF-ST-RF-CP-CALC               PIC X.
  3157*        16  FILLER                         PIC X(206).
  3158*CIDMOD         16  FILLER                         PIC X(192).
  3159         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3160             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3161         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3162         16  CF-ST-VFY-2ND-BENE             PIC X.
  3163         16  CF-ST-CAUSAL-STATE             PIC X.
  3164         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3165         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3166         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3167             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3168         16  CF-ST-NET-ONLY-STATE           PIC X.
  3169             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3170         16  FILLER                         PIC X(181).
  3171
  3172****************************************************************
  3173*             BENEFIT MASTER RECORD                            *
  3174****************************************************************
  3175
  3176     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3177         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3178             20  CF-BENEFIT-CODE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  57
* EL6318.cbl
  3179             20  CF-BENEFIT-NUMERIC  REDEFINES
  3180                 CF-BENEFIT-CODE            PIC XX.
  3181             20  CF-BENEFIT-ALPHA           PIC XXX.
  3182             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3183             20  CF-BENEFIT-COMMENT         PIC X(10).
  3184
  3185             20  CF-LF-COVERAGE-TYPE        PIC X.
  3186                 88  CF-REDUCING                VALUE 'R'.
  3187                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3188
  3189             20  CF-SPECIAL-CALC-CD         PIC X.
  3190                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3191                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3192                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3193                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3194                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3195                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3196                 88  CF-FARM-PLAN               VALUE 'F'.
  3197                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3198                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3199                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3200                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3201                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3202                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3203                 88  CF-PRUDENTIAL              VALUE 'P'.
  3204                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3205                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3206                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3207                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3208                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3209                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3210
  3211             20  CF-JOINT-INDICATOR         PIC X.
  3212                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3213
  3214*            20  FILLER                     PIC X(12).
  3215             20  cf-maximum-benefits        pic s999 comp-3.
  3216             20  FILLER                     PIC X(09).
  3217             20  CF-BENEFIT-CATEGORY        PIC X.
  3218             20  CF-LOAN-TYPE               PIC X(8).
  3219
  3220             20  CF-CO-REM-TERM-CALC        PIC X.
  3221                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3222                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3223                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3224                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3225                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3226
  3227             20  CF-CO-EARNINGS-CALC        PIC X.
  3228                 88  CO-EARN-BY-R78             VALUE '1'.
  3229                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3230                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3231                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3232                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3233                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3234                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3235                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3236
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  58
* EL6318.cbl
  3237             20  CF-CO-REFUND-CALC          PIC X.
  3238                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3239                 88  CO-REFD-BY-R78             VALUE '1'.
  3240                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3241                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3242                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3243                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3244                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3245                 88  CO-REFD-MEAN               VALUE '8'.
  3246                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3247                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3248                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3249
  3250             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3251                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3252                 88  CO-OVRD-BY-R78             VALUE '1'.
  3253                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3254                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3255                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3256                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3257                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3258                 88  CO-OVRD-MEAN               VALUE '8'.
  3259                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3260
  3261             20  CF-CO-BEN-I-G-CD           PIC X.
  3262                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3263                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3264                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3265
  3266         16  FILLER                         PIC X(304).
  3267
  3268
  3269****************************************************************
  3270*             CARRIER MASTER RECORD                            *
  3271****************************************************************
  3272
  3273     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3274         16  CF-ADDRESS-DATA.
  3275             20  CF-MAIL-TO-NAME            PIC X(30).
  3276             20  CF-IN-CARE-OF              PIC X(30).
  3277             20  CF-ADDRESS-LINE-1          PIC X(30).
  3278             20  CF-ADDRESS-LINE-2          PIC X(30).
  3279             20  CF-CITY-STATE              PIC X(30).
  3280             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3281             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3282
  3283         16  CF-CLAIM-NO-CONTROL.
  3284             20  CF-CLAIM-NO-METHOD         PIC X.
  3285                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3286                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3287                 88  CLAIM-NO-SEQ               VALUE '3'.
  3288                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3289             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3290                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3291                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3292                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3293
  3294         16  CF-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  59
* EL6318.cbl
  3295             20  CF-CHECK-NO-METHOD         PIC X.
  3296                 88  CHECK-NO-MANUAL            VALUE '1'.
  3297                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3298                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3299                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3300             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3301                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3302
  3303         16  CF-DOMICILE-STATE              PIC XX.
  3304
  3305         16  CF-EXPENSE-CONTROLS.
  3306             20  CF-EXPENSE-METHOD          PIC X.
  3307                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3308                 88  DOLLARS-PER-PMT            VALUE '2'.
  3309                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3310                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3311             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3312             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3313
  3314         16  CF-CORRESPONDENCE-CONTROL.
  3315             20  CF-LETTER-RESEND-OPT       PIC X.
  3316                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3317                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3318             20  FILLER                     PIC X(4).
  3319
  3320         16  CF-RESERVE-CONTROLS.
  3321             20  CF-MANUAL-SW               PIC X.
  3322                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3323             20  CF-FUTURE-SW               PIC X.
  3324                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3325             20  CF-PTC-SW                  PIC X.
  3326                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3327             20  CF-IBNR-SW                 PIC X.
  3328                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3329             20  CF-PTC-LF-SW               PIC X.
  3330                 88  CF-LF-PTC-USED             VALUE '1'.
  3331             20  CF-CDT-ACCESS-METHOD       PIC X.
  3332                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3333                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3334                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3335             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3336
  3337         16  CF-CLAIM-CALC-METHOD           PIC X.
  3338             88  360-PLUS-MONTHS                VALUE '1'.
  3339             88  365-PLUS-MONTHS                VALUE '2'.
  3340             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3341             88  360-DAILY                      VALUE '4'.
  3342             88  365-DAILY                      VALUE '5'.
  3343
  3344         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3345         16  FILLER                         PIC X(11).
  3346
  3347         16  CF-LIMIT-AMOUNTS.
  3348             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3349             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3350             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3351             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3352             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  60
* EL6318.cbl
  3353             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3354             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3355             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3356             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3357             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3358
  3359         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3360         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3361         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3362
  3363         16  CF-ZIP-CODE.
  3364             20  CF-ZIP-PRIME.
  3365                 24  CF-ZIP-1ST             PIC X.
  3366                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3367                 24  FILLER                 PIC X(4).
  3368             20  CF-ZIP-PLUS4               PIC X(4).
  3369         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3370             20  CF-CAN-POSTAL-1            PIC XXX.
  3371             20  CF-CAN-POSTAL-2            PIC XXX.
  3372             20  FILLER                     PIC XXX.
  3373
  3374         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3375         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3376         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3377
  3378         16  CF-RATING-SWITCH               PIC X.
  3379             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3380             88  CF-NO-RATING                   VALUE 'N'.
  3381
  3382         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3383
  3384         16  CF-CARRIER-OVER-SHORT.
  3385             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3386             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3387
  3388         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3389         16  CF-SECPAY-SWITCH               PIC X.
  3390             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3391             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3392         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3393         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3394         16  FILLER                         PIC X(444).
  3395*        16  FILLER                         PIC X(452).
  3396
  3397
  3398****************************************************************
  3399*             MORTALITY MASTER RECORD                          *
  3400****************************************************************
  3401
  3402     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3403         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3404                                INDEXED BY CF-MORT-NDX.
  3405             20  CF-MORT-TABLE              PIC X(5).
  3406             20  CF-MORT-TABLE-TYPE         PIC X.
  3407                 88  CF-MORT-JOINT              VALUE 'J'.
  3408                 88  CF-MORT-SINGLE             VALUE 'S'.
  3409                 88  CF-MORT-COMBINED           VALUE 'C'.
  3410                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  61
* EL6318.cbl
  3411                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3412             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3413             20  CF-MORT-AGE-METHOD         PIC XX.
  3414                 88  CF-AGE-LAST                VALUE 'AL'.
  3415                 88  CF-AGE-NEAR                VALUE 'AN'.
  3416             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3417             20  CF-MORT-ADJUSTMENT-DIRECTION
  3418                                            PIC X.
  3419                 88  CF-MINUS                   VALUE '-'.
  3420                 88  CF-PLUS                    VALUE '+'.
  3421             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3422             20  CF-MORT-JOINT-CODE         PIC X.
  3423                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3424             20  CF-MORT-PC-Q               PIC X.
  3425                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3426             20  CF-MORT-TABLE-CODE         PIC X(4).
  3427             20  CF-MORT-COMMENTS           PIC X(15).
  3428             20  FILLER                     PIC X(14).
  3429
  3430         16  FILLER                         PIC X(251).
  3431
  3432
  3433****************************************************************
  3434*             BUSSINESS TYPE MASTER RECORD                     *
  3435****************************************************************
  3436
  3437     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3438* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3439* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3440* AND RECORD 05 IS TYPES 81-99
  3441         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3442             20  CF-BUSINESS-TITLE          PIC  X(19).
  3443             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3444                                            PIC S9V9(4) COMP-3.
  3445             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3446             20  FILLER                     PIC  X.
  3447         16  FILLER                         PIC  X(248).
  3448
  3449
  3450****************************************************************
  3451*             TERMINAL MASTER RECORD                           *
  3452****************************************************************
  3453
  3454     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3455
  3456         16  CF-COMPANY-TERMINALS.
  3457             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3458                                  PIC X(4).
  3459         16  FILLER               PIC X(248).
  3460
  3461
  3462****************************************************************
  3463*             LIFE EDIT MASTER RECORD                          *
  3464****************************************************************
  3465
  3466     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3467         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3468             20  CF-LIFE-CODE-IN            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  62
* EL6318.cbl
  3469             20  CF-LIFE-CODE-OUT           PIC XX.
  3470         16  FILLER                         PIC X(248).
  3471
  3472
  3473****************************************************************
  3474*             AH EDIT MASTER RECORD                            *
  3475****************************************************************
  3476
  3477     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3478         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3479             20  CF-AH-CODE-IN              PIC XXX.
  3480             20  CF-AH-CODE-OUT             PIC XX.
  3481         16  FILLER                         PIC X(248).
  3482
  3483
  3484****************************************************************
  3485*             CREDIBILITY TABLES                               *
  3486****************************************************************
  3487
  3488     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3489         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3490                             INDEXED BY CF-CRDB-NDX.
  3491             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3492             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3493             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3494         16  FILLER                         PIC  X(332).
  3495
  3496
  3497****************************************************************
  3498*             REPORT CUSTOMIZATION RECORD                      *
  3499****************************************************************
  3500
  3501     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3502         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3503             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3504             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3505             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3506**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3507****       A T-TRANSFER.                                   ****
  3508             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3509
  3510         16  FILLER                         PIC XX.
  3511
  3512         16  CF-CARRIER-CNTL-OPT.
  3513             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3514                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3515                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3516             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3517                                            PIC X.
  3518         16  CF-GROUP-CNTL-OPT.
  3519             20  CF-GROUP-OPT-SEQ           PIC 9.
  3520                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3521                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3522             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3523                                            PIC X(6).
  3524         16  CF-STATE-CNTL-OPT.
  3525             20  CF-STATE-OPT-SEQ           PIC 9.
  3526                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  63
* EL6318.cbl
  3527                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3528             20  CF-STATE-SELECT OCCURS 3 TIMES
  3529                                            PIC XX.
  3530         16  CF-ACCOUNT-CNTL-OPT.
  3531             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3532                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3533                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3534             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3535                                            PIC X(10).
  3536         16  CF-BUS-TYP-CNTL-OPT.
  3537             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3538                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3539                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3540             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3541                                            PIC XX.
  3542         16  CF-LF-TYP-CNTL-OPT.
  3543             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3544                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3545                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3546             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3547                                            PIC XX.
  3548         16  CF-AH-TYP-CNTL-OPT.
  3549             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3550                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3551                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3552             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3553                                            PIC XX.
  3554         16  CF-REPTCD1-CNTL-OPT.
  3555             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3556                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3557                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3558             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3559                                            PIC X(10).
  3560         16  CF-REPTCD2-CNTL-OPT.
  3561             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3562                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3563                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3564             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3565                                            PIC X(10).
  3566         16  CF-USER1-CNTL-OPT.
  3567             20  CF-USER1-OPT-SEQ           PIC 9.
  3568                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3569                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3570             20  CF-USER1-SELECT OCCURS 3 TIMES
  3571                                            PIC X(10).
  3572         16  CF-USER2-CNTL-OPT.
  3573             20  CF-USER2-OPT-SEQ           PIC 9.
  3574                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3575                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3576             20  CF-USER2-SELECT OCCURS 3 TIMES
  3577                                            PIC X(10).
  3578         16  CF-USER3-CNTL-OPT.
  3579             20  CF-USER3-OPT-SEQ           PIC 9.
  3580                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3581                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3582             20  CF-USER3-SELECT OCCURS 3 TIMES
  3583                                            PIC X(10).
  3584         16  CF-USER4-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  64
* EL6318.cbl
  3585             20  CF-USER4-OPT-SEQ           PIC 9.
  3586                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3587                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3588             20  CF-USER4-SELECT OCCURS 3 TIMES
  3589                                            PIC X(10).
  3590         16  CF-USER5-CNTL-OPT.
  3591             20  CF-USER5-OPT-SEQ           PIC 9.
  3592                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3593                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3594             20  CF-USER5-SELECT OCCURS 3 TIMES
  3595                                            PIC X(10).
  3596         16  CF-REINS-CNTL-OPT.
  3597             20  CF-REINS-OPT-SEQ           PIC 9.
  3598                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3599                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3600             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3601                 24  CF-REINS-PRIME         PIC XXX.
  3602                 24  CF-REINS-SUB           PIC XXX.
  3603
  3604         16  CF-AGENT-CNTL-OPT.
  3605             20  CF-AGENT-OPT-SEQ           PIC 9.
  3606                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3607                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3608             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3609                                            PIC X(10).
  3610
  3611         16  FILLER                         PIC X(43).
  3612
  3613         16  CF-LOSS-RATIO-SELECT.
  3614             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3615             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3616         16  CF-ENTRY-DATE-SELECT.
  3617             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3618             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3619         16  CF-EFFECTIVE-DATE-SELECT.
  3620             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3621             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3622
  3623         16  CF-EXCEPTION-LIST-IND          PIC X.
  3624             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3625
  3626         16  FILLER                         PIC X(318).
  3627
  3628****************************************************************
  3629*                  EXCEPTION REPORTING RECORD                  *
  3630****************************************************************
  3631
  3632     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3633         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3634             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3635
  3636         16  CF-COMBINED-LIFE-AH-OPT.
  3637             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3638             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3639             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3640             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3641
  3642         16  CF-LIFE-OPT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  65
* EL6318.cbl
  3643             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3644             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3645             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3646             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3647             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3648             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3649             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3650             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3651             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3652             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3653
  3654         16  CF-AH-OPT.
  3655             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3656             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3657             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3658             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3659             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3660             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3661             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3662             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3663             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3664             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3665
  3666         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3667             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3668             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3669             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3670
  3671         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3672
  3673         16  FILLER                         PIC X(673).
  3674
  3675
  3676****************************************************************
  3677*             MORTGAGE SYSTEM PLAN RECORD                      *
  3678****************************************************************
  3679
  3680     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3681         16  CF-PLAN-TYPE                   PIC X.
  3682             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3683             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3684             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3685         16  CF-PLAN-ABBREV                 PIC XXX.
  3686         16  CF-PLAN-DESCRIPT               PIC X(10).
  3687         16  CF-PLAN-NOTES                  PIC X(20).
  3688         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3689         16  CF-PLAN-UNDERWRITING.
  3690             20  CF-PLAN-TERM-DATA.
  3691                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3692                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3693             20  CF-PLAN-AGE-DATA.
  3694                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3695                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3696                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3697             20  CF-PLAN-BENEFIT-DATA.
  3698                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3699                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3700                 24  CF-MAXIMUM-MONTHLY-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  66
* EL6318.cbl
  3701                                            PIC S9(7)V99  COMP-3.
  3702         16  CF-PLAN-POLICY-FORMS.
  3703             20  CF-POLICY-FORM             PIC X(12).
  3704             20  CF-MASTER-APPLICATION      PIC X(12).
  3705             20  CF-MASTER-POLICY           PIC X(12).
  3706         16  CF-PLAN-RATING.
  3707             20  CF-RATE-CODE               PIC X(5).
  3708             20  CF-SEX-RATING              PIC X.
  3709                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3710                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3711             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3712             20  CF-SUB-STD-TYPE            PIC X.
  3713                 88  CF-PCT-OF-PREM            VALUE '1'.
  3714                 88  CF-PCT-OF-BENE            VALUE '2'.
  3715         16  CF-PLAN-PREM-TOLERANCES.
  3716             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3717             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3718         16  CF-PLAN-PYMT-TOLERANCES.
  3719             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3720             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3721         16  CF-PLAN-MISC-DATA.
  3722             20  FILLER                     PIC X.
  3723             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3724             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3725         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3726         16  CF-PLAN-IND-GRP                PIC X.
  3727             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3728                                                     '1'.
  3729             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3730                                                     '2'.
  3731         16  CF-MIB-SEARCH-SW               PIC X.
  3732             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3733             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3734             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3735             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3736         16  CF-ALPHA-SEARCH-SW             PIC X.
  3737             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3738             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3739             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3740             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3741             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3742             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3743             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3744             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3745             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3746             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3747                                                     'A' 'B' 'C'
  3748                                                     'X' 'Y' 'Z'.
  3749         16  CF-EFF-DT-RULE-SW              PIC X.
  3750             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3751             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3752             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3753             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3754             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3755         16  FILLER                         PIC X(4).
  3756         16  CF-HEALTH-QUESTIONS            PIC X.
  3757             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3758         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  67
* EL6318.cbl
  3759         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3760         16  CF-PLAN-SNGL-JNT               PIC X.
  3761             88  CF-COMBINED-PLAN              VALUE 'C'.
  3762             88  CF-JNT-PLAN                   VALUE 'J'.
  3763             88  CF-SNGL-PLAN                  VALUE 'S'.
  3764         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3765         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3766         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3767         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3768         16  CF-RERATE-CNTL                 PIC  X.
  3769             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3770             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3771             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3772             88  CF-AUTO-RECALC                 VALUE '4'.
  3773         16  CF-BENEFIT-TYPE                PIC  X.
  3774             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3775             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3776         16  CF-POLICY-FEE                  PIC S999V99
  3777                                                    COMP-3.
  3778         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3779         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3780         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3781         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3782         16  FILLER                         PIC  X(32).
  3783         16  CF-TERMINATION-FORM            PIC  X(04).
  3784         16  FILLER                         PIC  X(08).
  3785         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3786                                                       COMP-3.
  3787         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3788         16  CF-ISSUE-LETTER                PIC  X(4).
  3789         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3790         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3791             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3792             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3793         16  CF-MP-REFUND-CALC              PIC X.
  3794             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3795             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3796             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3797             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3798             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3799             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3800             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3801             88  CF-MP-REFD-MEAN                VALUE '8'.
  3802         16  CF-ALT-RATE-CODE               PIC  X(5).
  3803
  3804
  3805         16  FILLER                         PIC X(498).
  3806****************************************************************
  3807*             MORTGAGE COMPANY MASTER RECORD                   *
  3808****************************************************************
  3809
  3810     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3811         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3812         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3813             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3814             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3815             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3816             88  CF-MORT-PROD-CNTL                   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  68
* EL6318.cbl
  3817             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3818
  3819         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3820         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3821         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3822         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3823         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3824
  3825         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3826             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3827         16  CF-MP-RECON-USE-IND            PIC X(1).
  3828             88  CF-MP-USE-RECON             VALUE 'Y'.
  3829         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3830             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3831         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3832             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3833             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3834         16  FILLER                         PIC X(1).
  3835         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3836             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3837         16  CF-MORTG-MIB-VERSION           PIC X.
  3838             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3839             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3840             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3841         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3842             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3843                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3844             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3845                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3846             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3847                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3848             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3849                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3850             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3851                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3852             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3853                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3854         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3855         16  FILLER                         PIC X(7).
  3856         16  CF-MORTG-DESTINATION-SYMBOL.
  3857             20  CF-MORTG-MIB-COMM          PIC X(5).
  3858             20  CF-MORTG-MIB-TERM          PIC X(5).
  3859         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3860             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3861         16  FILLER                         PIC X(03).
  3862         16  CF-MP-CHECK-NO-CONTROL.
  3863             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3864                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3865                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3866                                                ' ' LOW-VALUES.
  3867                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3868                                               VALUE '3'.
  3869         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3870         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3871         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3872             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3873                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3874             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  69
* EL6318.cbl
  3875                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3876             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3877                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3878             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3879                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3880             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3881                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3882             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3883                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3884         16  CF-MORTG-BILLING-AREA.
  3885             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3886                                            PIC X.
  3887         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3888         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3889         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3890         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3891             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3892             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3893         16  FILLER                         PIC X.
  3894         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3895             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3896             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3897         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3898         16  FILLER                         PIC X(8).
  3899         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3900         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3901         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3902         16  CF-ACH-COMPANY-ID.
  3903             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3904                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3905                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3906                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3907             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3908         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3909             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3910         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3911             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3912             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3913         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3914         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3915         16  FILLER                         PIC X(536).
  3916
  3917****************************************************************
  3918*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3919****************************************************************
  3920
  3921     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3922         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3923             20  CF-FEMALE-HEIGHT.
  3924                 24  CF-FEMALE-FT           PIC 99.
  3925                 24  CF-FEMALE-IN           PIC 99.
  3926             20  CF-FEMALE-MIN-WT           PIC 999.
  3927             20  CF-FEMALE-MAX-WT           PIC 999.
  3928         16  FILLER                         PIC X(428).
  3929
  3930     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3931         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3932             20  CF-MALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  70
* EL6318.cbl
  3933                 24  CF-MALE-FT             PIC 99.
  3934                 24  CF-MALE-IN             PIC 99.
  3935             20  CF-MALE-MIN-WT             PIC 999.
  3936             20  CF-MALE-MAX-WT             PIC 999.
  3937         16  FILLER                         PIC X(428).
  3938******************************************************************
  3939*             AUTOMATIC ACTIVITY RECORD                          *
  3940******************************************************************
  3941     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3942         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3943             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3944             20  CF-SYS-LETTER-ID           PIC X(04).
  3945             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3946             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3947             20  CF-SYS-RESET-SW            PIC X(01).
  3948             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3949             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3950
  3951         16  FILLER                         PIC X(50).
  3952
  3953         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3954             20  CF-USER-ACTIVE-SW          PIC X(01).
  3955             20  CF-USER-LETTER-ID          PIC X(04).
  3956             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3957             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3958             20  CF-USER-RESET-SW           PIC X(01).
  3959             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3960             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3961             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3962
  3963         16  FILLER                         PIC X(246).
  3964*                                COPY ERCPNDB.
  3965******************************************************************
  3966*                                                                *
  3967*                                                                *
  3968*                            ERCPNDB.                            *
  3969*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3970*                            VMOD=2.025                          *
  3971*                                                                *
  3972*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3973*                                                                *
  3974******************************************************************
  3975*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3976*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3977******************************************************************
  3978*                                                                *
  3979*                                                                *
  3980*   FILE TYPE = VSAM,KSDS                                        *
  3981*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3982*                                                                *
  3983*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3984*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3985*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3986*                                                 RKP=13,LEN=36  *
  3987*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3988*                                      AND CHG-SEQ.)             *
  3989*                                                RKP=49,LEN=11   *
  3990*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  71
* EL6318.cbl
  3991*                                      AND CHG-SEQ.)             *
  3992*                                                RKP=60,LEN=15   *
  3993*                                                                *
  3994*   LOG = NO                                                     *
  3995*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3996******************************************************************
  3997******************************************************************
  3998*                   C H A N G E   L O G
  3999*
  4000* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4001*-----------------------------------------------------------------
  4002*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4003* EFFECTIVE    NUMBER
  4004*-----------------------------------------------------------------
  4005* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4006* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4007* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4008* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4009* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4010* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4011* 032306                   PEMA  ADD BOW LOAN NUMBER
  4012* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4013* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4014* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4015* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4016* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4017* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4018* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4019* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4020* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4021******************************************************************
  4022
  4023 01  PENDING-BUSINESS.
  4024     12  PB-RECORD-ID                     PIC XX.
  4025         88  VALID-PB-ID                        VALUE 'PB'.
  4026
  4027     12  PB-CONTROL-PRIMARY.
  4028         16  PB-COMPANY-CD                PIC X.
  4029         16  PB-ENTRY-BATCH               PIC X(6).
  4030         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4031         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4032
  4033     12  PB-CONTROL-BY-ACCOUNT.
  4034         16  PB-COMPANY-CD-A1             PIC X.
  4035         16  PB-CARRIER                   PIC X.
  4036         16  PB-GROUPING.
  4037             20  PB-GROUPING-PREFIX       PIC XXX.
  4038             20  PB-GROUPING-PRIME        PIC XXX.
  4039         16  PB-STATE                     PIC XX.
  4040         16  PB-ACCOUNT.
  4041             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4042             20  PB-ACCOUNT-PRIME         PIC X(6).
  4043         16  PB-CERT-EFF-DT               PIC XX.
  4044         16  PB-CERT-NO.
  4045             20  PB-CERT-PRIME            PIC X(10).
  4046             20  PB-CERT-SFX              PIC X.
  4047         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4048
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  72
* EL6318.cbl
  4049         16  PB-RECORD-TYPE               PIC X.
  4050             88  PB-MAILING-DATA                VALUE '0'.
  4051             88  PB-ISSUE                       VALUE '1'.
  4052             88  PB-CANCELLATION                VALUE '2'.
  4053             88  PB-BATCH-TRAILER               VALUE '9'.
  4054
  4055     12  PB-CONTROL-BY-ORIG-BATCH.
  4056         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4057         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4058         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4059         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4060
  4061     12  PB-CONTROL-BY-CSR.
  4062         16  PB-CSR-COMPANY-CD            PIC X.
  4063         16  PB-CSR-ID                    PIC X(4).
  4064         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4065         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4066         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4067******************************************************************
  4068*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4069******************************************************************
  4070
  4071     12  PB-LAST-MAINT-DT                 PIC XX.
  4072     12  PB-LAST-MAINT-BY                 PIC X(4).
  4073     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4074
  4075     12  PB-RECORD-BODY                   PIC X(375).
  4076
  4077     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4078         16  PB-CERT-ORIGIN               PIC X.
  4079             88  CLASIC-CREATED-CERT         VALUE '1'.
  4080         16  PB-I-NAME.
  4081             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4082             20  PB-I-INSURED-FIRST-NAME.
  4083                 24  PB-I-INSURED-1ST-INIT PIC X.
  4084                 24  FILLER                PIC X(9).
  4085             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4086         16  PB-I-AGE                     PIC S99   COMP-3.
  4087         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4088         16  PB-I-BIRTHDAY                PIC XX.
  4089         16  PB-I-INSURED-SEX             PIC X.
  4090             88  PB-SEX-MALE     VALUE 'M'.
  4091             88  PB-SEX-FEMALE   VALUE 'F'.
  4092
  4093         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4094         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4095         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4096         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4097         16  PB-I-SKIP-CODE               PIC X.
  4098             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4099             88  PB-SKIP-JULY              VALUE '1'.
  4100             88  PB-SKIP-AUGUST            VALUE '2'.
  4101             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4102             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4103             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4104             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4105             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4106             88  PB-SKIP-JUNE              VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  73
* EL6318.cbl
  4107             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4108             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4109             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4110         16  PB-I-TERM-TYPE               PIC X.
  4111             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4112             88  PB-PAID-WEEKLY            VALUE 'W'.
  4113             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4114             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4115             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4116         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4117         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4118         16  PB-I-DATA-ENTRY-SW           PIC X.
  4119             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4120             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4121             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4122             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4123         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4124         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4125*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4126         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4127         16  FILLER                       PIC X.
  4128
  4129         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4130             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4131             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4132                                                   '90' THRU '99'.
  4133         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4134                                          PIC XX.
  4135         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4136         16  PB-I-AMOUNT-FINANCED REDEFINES
  4137                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4138         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4139         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4140                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4141         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4142         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4143         16  PB-I-CLP-AMOUNT REDEFINES
  4144                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4145         16  PB-I-LF-CALC-FLAG            PIC X.
  4146             88 PB-COMP-LF-PREM               VALUE '?'.
  4147         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4148         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4149         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4150         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4151         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4152         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4153         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4154         16  PB-I-LF-ABBR                 PIC XXX.
  4155         16  PB-I-LF-INPUT-CD             PIC XX.
  4156
  4157         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4158             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4159             88  PB-INVALID-AH               VALUE '  ' '00'
  4160                                                   '90' THRU '99'.
  4161         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4162         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4163         16  PB-I-AH-CALC-FLAG            PIC X.
  4164             88 PB-COMP-AH-PREM                  VALUE '?'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  74
* EL6318.cbl
  4165         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4166         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4167         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4168         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4169         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4170         16  PB-I-AH-ABBR                 PIC XXX.
  4171         16  PB-I-AH-INPUT-CD             PIC XXX.
  4172
  4173         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4174         16  PB-I-REIN-TABLE              PIC XXX.
  4175         16  PB-I-BUSINESS-TYPE           PIC 99.
  4176         16  PB-I-INDV-GRP-CD             PIC X.
  4177         16  PB-I-MORT-CODE.
  4178             20  PB-I-TABLE               PIC X.
  4179             20  PB-I-INTEREST            PIC XX.
  4180             20  PB-I-MORT-TYP            PIC X.
  4181         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4182         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4183         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4184         16  PB-I-INDV-GRP-OVRD           PIC X.
  4185         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4186         16  PB-I-SIG-SW                  PIC X.
  4187             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4188         16  PB-I-RATE-CLASS              PIC XX.
  4189         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4190         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4191         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4192         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4193         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4194         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4195         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4196         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4197         16  PB-I-OB-FLAG                 PIC X.
  4198             88  PB-I-OB                      VALUE 'B'.
  4199             88  PB-I-SUMMARY                 VALUE 'Z'.
  4200         16  PB-I-ENTRY-STATUS            PIC X.
  4201             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4202                                              'M' '5' '9' '2'.
  4203             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4204             88  PB-I-POLICY-PENDING          VALUE '2'.
  4205             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4206             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4207             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4208             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4209             88  PB-I-REIN-ONLY               VALUE '9'.
  4210             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4211             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4212             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4213             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4214         16  PB-I-INT-CODE                PIC X.
  4215             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4216             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4217         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4218         16  PB-I-SOC-SEC-NO              PIC X(11).
  4219         16  PB-I-MEMBER-NO               PIC X(12).
  4220         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4221*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4222         16  PB-I-OLD-LOF                 PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  75
* EL6318.cbl
  4223         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4224         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4225         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4226         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4227         16  PB-I-LIFE-INDICATOR          PIC X.
  4228             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4229         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4230         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4231                                          PIC S9(5)V99    COMP-3.
  4232         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4233             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4234             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4235         16  PB-I-1ST-PMT-DT              PIC XX.
  4236         16  PB-I-JOINT-INSURED.
  4237             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4238             20 PB-I-JOINT-FIRST-NAME.
  4239                24  PB-I-JOINT-FIRST-INIT PIC X.
  4240                24  FILLER                PIC X(9).
  4241             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4242*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4243         16  PB-I-BENEFICIARY-NAME.
  4244             20  PB-I-BANK-NUMBER         PIC X(10).
  4245             20  FILLER                   PIC X(15).
  4246         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4247         16  PB-I-REFERENCE               PIC X(12).
  4248         16  FILLER REDEFINES PB-I-REFERENCE.
  4249             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4250             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4251             20  PB-I-CLP-STATE           PIC XX.
  4252         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4253             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4254             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4255             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4256         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4257         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4258         16  PB-I-RESIDENT-STATE          PIC XX.
  4259         16  PB-I-RATE-CODE               PIC X(4).
  4260         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4261         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4262         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4263         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4264         16  PB-I-BANK-NOCHRGB            PIC 99.
  4265         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4266         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4267
  4268     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4269         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4270             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4271         16  PB-C-CANCEL-ORIGIN           PIC X.
  4272             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4273         16  PB-C-LF-CANCEL-DT            PIC XX.
  4274         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4275         16  PB-C-LF-CALC-REQ             PIC X.
  4276             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4277         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4278         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4279         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4280             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  76
* EL6318.cbl
  4281         16  PB-C-AH-CANCEL-DT            PIC XX.
  4282         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4283         16  PB-C-AH-CALC-REQ             PIC X.
  4284             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4285         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4286         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4287         16  PB-C-LAST-NAME               PIC X(15).
  4288         16  PB-C-REFUND-SW               PIC X.
  4289             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4290             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4291         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4292         16  PB-C-PAYEE-CODE              PIC X(6).
  4293         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4294         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4295         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4296         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4297         16  PB-C-REFERENCE               PIC X(12).
  4298         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4299         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4300         16  PB-C-POST-CARD-IND           PIC X.
  4301         16  PB-C-CANCEL-REASON           PIC X.
  4302         16  PB-C-REF-INTERFACE-SW        PIC X.
  4303         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4304         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4305         16  FILLER                       PIC X(01).
  4306*        16  FILLER                       PIC X(18).
  4307         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4308*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4309         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4310         16  PB-CANCELED-CERT-DATA.
  4311             20  PB-CI-INSURED-NAME.
  4312                 24  PB-CI-LAST-NAME      PIC X(15).
  4313                 24  PB-CI-INITIALS       PIC XX.
  4314             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4315             20  PB-CI-INSURED-SEX        PIC X.
  4316             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4317             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4318             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4319             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4320             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4321             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4322             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4323             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4324             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4325             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4326             20  PB-CI-RATE-CLASS         PIC XX.
  4327             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4328             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4329             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4330             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4331             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4332             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4333             20  PB-CI-LF-ABBR            PIC X(3).
  4334             20  PB-CI-AH-ABBR            PIC X(3).
  4335             20  PB-CI-OB-FLAG            PIC X.
  4336                 88  PB-CI-OB                VALUE 'B'.
  4337             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4338                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  77
* EL6318.cbl
  4339                                           'M' '4' '5' '9' '2'.
  4340                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4341                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4342                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4343                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4344                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4345                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4346                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4347                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4348                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4349                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4350                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4351                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4352                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4353             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4354                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4355                                           'M' '4' '5' '9' '2'.
  4356                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4357                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4358                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4359                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4360                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4361                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4362                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4363                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4364                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4365                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4366                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4367                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4368                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4369             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4370             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4371             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4372             20  PB-CI-MEMBER-NO          PIC X(12).
  4373             20  PB-CI-INT-CODE           PIC X.
  4374                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4375                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4376             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4377             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4378             20  PB-CI-COMP-EXCP-SW       PIC X.
  4379                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4380                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4381             20  PB-CI-ENTRY-STATUS       PIC X.
  4382             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4383             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4384             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4385             20  PB-CI-DEATH-DT           PIC XX.
  4386             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4387             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4388             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4389             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4390             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4391             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4392             20  PB-CI-ENTRY-DT              PIC XX.
  4393             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4394             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4395             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4396             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  78
* EL6318.cbl
  4397             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4398             20  PB-CI-OLD-LOF               PIC XXX.
  4399*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4400             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4401             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4402             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4403             20  PB-CI-INDV-GRP-CD           PIC X.
  4404             20  PB-CI-BENEFICIARY-NAME.
  4405                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4406                 24  FILLER                  PIC X(15).
  4407             20  PB-CI-NOTE-SW               PIC X.
  4408             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4409             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4410             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4411             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4412             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4413             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4414             20  PB-CI-FIRST-NAME            PIC X(10).
  4415             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4416
  4417         16  FILLER                       PIC X(13).
  4418*032306  16  FILLER                       PIC X(27).
  4419*        16  FILLER                       PIC X(46).
  4420
  4421     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4422         16  FILLER                       PIC X(10).
  4423         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4424         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4425         16  PB-M-INSURED-MID-INIT        PIC X.
  4426         16  PB-M-INSURED-AGE             PIC 99.
  4427         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4428         16  PB-M-INSURED-SEX             PIC X.
  4429         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4430         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4431         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4432         16  PB-M-INSURED-CITY-STATE.
  4433             20  PB-M-INSURED-CITY        PIC X(28).
  4434             20  PB-M-INSURED-STATE       PIC XX.
  4435         16  PB-M-INSURED-ZIP-CODE.
  4436             20  PB-M-INSURED-ZIP-PRIME.
  4437                 24  PB-M-INSURED-ZIP-1   PIC X.
  4438                     88  PB-M-CANADIAN-POST-CODE
  4439                                             VALUE 'A' THRU 'Z'.
  4440                 24  FILLER               PIC X(4).
  4441             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4442         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4443                                        PB-M-INSURED-ZIP-CODE.
  4444             20  PM-M-INS-CAN-POST1       PIC XXX.
  4445             20  PM-M-INS-CAN-POST2       PIC XXX.
  4446             20  FILLER                   PIC XXX.
  4447         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4448         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4449         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4450         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4451         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4452         16  PB-M-CRED-BENE-CITYST.
  4453             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4454             20  PB-M-CRED-BENE-STATE     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  79
* EL6318.cbl
  4455         16  FILLER                       PIC X(92).
  4456
  4457     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4458         16  FILLER                       PIC X(10).
  4459         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4460         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4461         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4462         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4463         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4464         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4465         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4466         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4467         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4468         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4469         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4470         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4471         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4472         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4473         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4474         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4475         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4476         16  PB-ACCOUNT-NAME              PIC X(30).
  4477         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4478         16  PB-REFERENCE                 PIC X(12).
  4479         16  PB-B-RECEIVED-DT             PIC XX.
  4480         16  FILLER                       PIC X(234).
  4481
  4482     12  PB-RECORD-STATUS.
  4483         16  PB-CREDIT-SELECT-DT          PIC XX.
  4484         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4485         16  PB-BILLED-DT                 PIC XX.
  4486         16  PB-BILLING-STATUS            PIC X.
  4487             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4488             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4489             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4490         16  PB-RECORD-BILL               PIC X.
  4491             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4492             88  PB-RECORD-RETURNED           VALUE 'R'.
  4493             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4494             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4495             88  PB-OVERRIDE-AH               VALUE 'A'.
  4496             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4497         16  PB-BATCH-ENTRY               PIC X.
  4498             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4499             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4500             88  PB-REISSUED-CERT             VALUE 'E'.
  4501             88  PB-CASH-CERT                 VALUE 'C'.
  4502             88  PB-MONTHLY-CERT              VALUE 'M'.
  4503             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4504             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4505             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4506         16  PB-FORCE-CODE                PIC X.
  4507             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4508             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4509             88  PB-CANCEL-FORCE              VALUE '8'.
  4510             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4511             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4512             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  80
* EL6318.cbl
  4513             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4514             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4515             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4516             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4517         16  PB-FATAL-FLAG                PIC X.
  4518             88  PB-FATAL-ERRORS              VALUE 'X'.
  4519         16  PB-FORCE-ER-CD               PIC X.
  4520             88  PB-FORCE-ERRORS              VALUE 'F'.
  4521             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4522         16  PB-WARN-ER-CD                PIC X.
  4523             88  PB-WARNING-ERRORS            VALUE 'W'.
  4524         16  FILLER                       PIC X.
  4525         16  PB-OUT-BAL-CD                PIC X.
  4526             88  PB-OUT-OF-BAL                VALUE 'O'.
  4527         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4528         16  PB-AH-OVERRIDE-L1            PIC X.
  4529         16  PB-INPUT-DT                  PIC XX.
  4530         16  PB-INPUT-BY                  PIC X(4).
  4531         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4532         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4533         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4534         16  PB-LF-EARNING-METHOD         PIC X.
  4535         16  PB-AH-EARNING-METHOD         PIC X.
  4536         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4537         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4538         16  PB-REIN-CD                   PIC XXX.
  4539         16  PB-LF-REFUND-TYPE            PIC X.
  4540         16  PB-AH-REFUND-TYPE            PIC X.
  4541         16  PB-ACCT-EFF-DT               PIC XX.
  4542         16  PB-ACCT-EXP-DT               PIC XX.
  4543         16  PB-COMPANY-ID                PIC X(3).
  4544         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4545         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4546         16  PB-SV-CARRIER                PIC X.
  4547         16  PB-SV-GROUPING               PIC X(6).
  4548         16  PB-SV-STATE                  PIC XX.
  4549         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4550         16  PB-GA-BILLING-INFO.
  4551             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4552                                          PIC XX.
  4553         16  PB-SV-REMIT-TO  REDEFINES
  4554             PB-GA-BILLING-INFO           PIC X(10).
  4555         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4556         16  PB-I-LOAN-OFFICER            PIC X(5).
  4557         16  PB-I-VIN                     PIC X(17).
  4558
  4559         16  FILLER                       PIC X(04).
  4560         16  IMNET-BYPASS-SW              PIC X.
  4561
  4562******************************************************************
  4563*                COMMON EDIT ERRORS                              *
  4564******************************************************************
  4565
  4566     12  PB-COMMON-ERRORS.
  4567         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4568                                           PIC S9(4)     COMP.
  4569
  4570******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  81
* EL6318.cbl
  4571*                                COPY ELCCERT.
  4572******************************************************************
  4573*                                                                *
  4574*                            ELCCERT.                            *
  4575*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4576*                            VMOD=2.013                          *
  4577*                                                                *
  4578*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4579*                                                                *
  4580*   FILE TYPE = VSAM,KSDS                                        *
  4581*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4582*                                                                *
  4583*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4584*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4585*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4586*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4587*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4588*                                                                *
  4589*   LOG = YES                                                    *
  4590*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4591******************************************************************
  4592*                   C H A N G E   L O G
  4593*
  4594* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4595*-----------------------------------------------------------------
  4596*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4597* EFFECTIVE    NUMBER
  4598*-----------------------------------------------------------------
  4599* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4600* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4601* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4602* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4603* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4604* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4605* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4606* 032612  CR2011110200001  PEMA  AHL CHANGES
  4607* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4608******************************************************************
  4609
  4610 01  CERTIFICATE-MASTER.
  4611     12  CM-RECORD-ID                      PIC XX.
  4612         88  VALID-CM-ID                      VALUE 'CM'.
  4613
  4614     12  CM-CONTROL-PRIMARY.
  4615         16  CM-COMPANY-CD                 PIC X.
  4616         16  CM-CARRIER                    PIC X.
  4617         16  CM-GROUPING.
  4618             20  CM-GROUPING-PREFIX        PIC X(3).
  4619             20  CM-GROUPING-PRIME         PIC X(3).
  4620         16  CM-STATE                      PIC XX.
  4621         16  CM-ACCOUNT.
  4622             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4623             20  CM-ACCOUNT-PRIME          PIC X(6).
  4624         16  CM-CERT-EFF-DT                PIC XX.
  4625         16  CM-CERT-NO.
  4626             20  CM-CERT-PRIME             PIC X(10).
  4627             20  CM-CERT-SFX               PIC X.
  4628
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  82
* EL6318.cbl
  4629     12  CM-CONTROL-BY-NAME.
  4630         16  CM-COMPANY-CD-A1              PIC X.
  4631         16  CM-INSURED-LAST-NAME          PIC X(15).
  4632         16  CM-INSURED-INITIALS.
  4633             20  CM-INSURED-INITIAL1       PIC X.
  4634             20  CM-INSURED-INITIAL2       PIC X.
  4635
  4636     12  CM-CONTROL-BY-SSN.
  4637         16  CM-COMPANY-CD-A2              PIC X.
  4638         16  CM-SOC-SEC-NO.
  4639             20  CM-SSN-STATE              PIC XX.
  4640             20  CM-SSN-ACCOUNT            PIC X(6).
  4641             20  CM-SSN-LN3.
  4642                 25  CM-INSURED-INITIALS-A2.
  4643                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4644                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4645                 25 CM-PART-LAST-NAME-A2         PIC X.
  4646
  4647     12  CM-CONTROL-BY-CERT-NO.
  4648         16  CM-COMPANY-CD-A4              PIC X.
  4649         16  CM-CERT-NO-A4                 PIC X(11).
  4650
  4651     12  CM-CONTROL-BY-MEMB.
  4652         16  CM-COMPANY-CD-A5              PIC X.
  4653         16  CM-MEMBER-NO.
  4654             20  CM-MEMB-STATE             PIC XX.
  4655             20  CM-MEMB-ACCOUNT           PIC X(6).
  4656             20  CM-MEMB-LN4.
  4657                 25  CM-INSURED-INITIALS-A5.
  4658                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4659                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4660                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4661
  4662     12  CM-INSURED-PROFILE-DATA.
  4663         16  CM-INSURED-FIRST-NAME.
  4664             20  CM-INSURED-1ST-INIT       PIC X.
  4665             20  FILLER                    PIC X(9).
  4666         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4667         16  CM-INSURED-SEX                PIC X.
  4668             88  CM-SEX-MALE                  VALUE 'M'.
  4669             88  CM-SEX-FEMAL                 VALUE 'F'.
  4670         16  CM-INSURED-JOINT-AGE          PIC 99.
  4671         16  CM-JOINT-INSURED-NAME.
  4672             20  CM-JT-LAST-NAME           PIC X(15).
  4673             20  CM-JT-FIRST-NAME.
  4674                 24  CM-JT-1ST-INIT        PIC X.
  4675                 24  FILLER                PIC X(9).
  4676             20  CM-JT-INITIAL             PIC X.
  4677
  4678     12  CM-LIFE-DATA.
  4679         16  CM-LF-BENEFIT-CD              PIC XX.
  4680         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4681         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4682         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4683         16  CM-LF-DEV-CODE                PIC XXX.
  4684         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4685         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4686         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  83
* EL6318.cbl
  4687         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4688         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4689         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4690         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4691         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4692         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4693         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4694         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4695         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4696         16  cm-temp-epiq                  pic xx.
  4697             88  EPIQ-CLASS                  value 'EQ'.
  4698*        16  FILLER                        PIC XX.
  4699
  4700     12  CM-AH-DATA.
  4701         16  CM-AH-BENEFIT-CD              PIC XX.
  4702         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4703         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4704         16  CM-AH-DEV-CODE                PIC XXX.
  4705         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4706         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4707         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4708         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4709         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4710         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4711         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4712         16  CM-AH-PAID-THRU-DT            PIC XX.
  4713             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4714         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4715         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4716         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4717         16  FILLER                        PIC X.
  4718
  4719     12  CM-LOAN-INFORMATION.
  4720         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4721         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4722                                           PIC S9(5)V99  COMP-3.
  4723         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4724         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4725         16  CM-PAY-FREQUENCY              PIC S99.
  4726         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4727         16  CM-RATE-CLASS                 PIC XX.
  4728         16  CM-BENEFICIARY                PIC X(25).
  4729         16  CM-POLICY-FORM-NO             PIC X(12).
  4730         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4731         16  CM-LAST-ADD-ON-DT             PIC XX.
  4732         16  CM-DEDUCTIBLE-AMOUNTS.
  4733             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4734             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4735         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4736             20  CM-RESIDENT-STATE         PIC XX.
  4737             20  CM-RATE-CODE              PIC X(4).
  4738             20  FILLER                    PIC XX.
  4739         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4740             20  CM-LOAN-OFFICER           PIC X(5).
  4741             20  FILLER                    PIC XXX.
  4742         16  CM-CSR-CODE                   PIC XXX.
  4743         16  CM-UNDERWRITING-CODE          PIC X.
  4744             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  84
* EL6318.cbl
  4745         16  CM-POST-CARD-IND              PIC X.
  4746         16  CM-NH-INTERFACE-SW            PIC X.
  4747         16  CM-PREMIUM-TYPE               PIC X.
  4748             88  CM-SING-PRM                  VALUE '1'.
  4749             88  CM-O-B-COVERAGE              VALUE '2'.
  4750             88  CM-OPEN-END                  VALUE '3'.
  4751         16  CM-IND-GRP-TYPE               PIC X.
  4752             88  CM-INDIVIDUAL                VALUE 'I'.
  4753             88  CM-GROUP                     VALUE 'G'.
  4754         16  CM-SKIP-CODE                  PIC X.
  4755             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4756             88  SKIP-JULY                    VALUE '1'.
  4757             88  SKIP-AUGUST                  VALUE '2'.
  4758             88  SKIP-SEPTEMBER               VALUE '3'.
  4759             88  SKIP-JULY-AUG                VALUE '4'.
  4760             88  SKIP-AUG-SEPT                VALUE '5'.
  4761             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4762             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4763             88  SKIP-JUNE                    VALUE '8'.
  4764             88  SKIP-JUNE-JULY               VALUE '9'.
  4765             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4766             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4767         16  CM-PAYMENT-MODE               PIC X.
  4768             88  PAY-MONTHLY                  VALUE SPACE.
  4769             88  PAY-WEEKLY                   VALUE '1'.
  4770             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4771             88  PAY-BI-WEEKLY                VALUE '3'.
  4772             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4773         16  CM-LOAN-NUMBER                PIC X(8).
  4774         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4775         16  CM-OLD-LOF                    PIC XXX.
  4776*        16  CM-LOAN-OFFICER               PIC XXX.
  4777         16  CM-REIN-TABLE                 PIC XXX.
  4778         16  CM-SPECIAL-REIN-CODE          PIC X.
  4779         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4780         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4781         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4782
  4783     12  CM-STATUS-DATA.
  4784         16  CM-ENTRY-STATUS               PIC X.
  4785         16  CM-ENTRY-DT                   PIC XX.
  4786
  4787         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4788         16  CM-LF-CANCEL-DT               PIC XX.
  4789         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4790
  4791         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4792         16  CM-LF-DEATH-DT                PIC XX.
  4793         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4794
  4795         16  CM-LF-CURRENT-STATUS          PIC X.
  4796             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4797                                                'M' '4' '5' '9'.
  4798             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4799             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4800             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4801             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4802             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  85
* EL6318.cbl
  4803             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4804             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4805             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4806             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4807             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4808             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4809             88  CM-LF-DECLINED               VALUE 'D'.
  4810             88  CM-LF-VOIDED                 VALUE 'V'.
  4811
  4812         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4813         16  CM-AH-CANCEL-DT               PIC XX.
  4814         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4815
  4816         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4817         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4818         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4819
  4820         16  CM-AH-CURRENT-STATUS          PIC X.
  4821             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4822                                                'M' '4' '5' '9'.
  4823             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4824             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4825             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4826             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4827             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4828             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4829             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4830             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4831             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4832             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4833             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4834             88  CM-AH-DECLINED               VALUE 'D'.
  4835             88  CM-AH-VOIDED                 VALUE 'V'.
  4836
  4837         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4838             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4839             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4840             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4841         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4842
  4843         16  CM-ENTRY-BATCH                PIC X(6).
  4844         16  CM-LF-EXIT-BATCH              PIC X(6).
  4845         16  CM-AH-EXIT-BATCH              PIC X(6).
  4846         16  CM-LAST-MONTH-END             PIC XX.
  4847
  4848     12  CM-NOTE-SW                        PIC X.
  4849         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4850         88  CERT-NOTES-PRESENT               VALUE '1'.
  4851         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4852         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4853         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4854         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4855         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4856         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4857     12  CM-COMP-EXCP-SW                   PIC X.
  4858         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4859         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4860     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  86
* EL6318.cbl
  4861         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4862         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4863
  4864*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4865     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4866     12  FILLER                            PIC X.
  4867
  4868*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4869     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4870     12  FILLER                            PIC X.
  4871*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4872     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4873
  4874     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4875         88  CERT-ADDED-BATCH                 VALUE ' '.
  4876         88  CERT-ADDED-ONLINE                VALUE '1'.
  4877         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4878         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4879         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4880     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4881         88  CERT-AS-LOADED                   VALUE ' '.
  4882         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4883         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4884         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4885         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4886         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4887         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4888         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4889
  4890     12  CM-ACCOUNT-COMM-PCTS.
  4891         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4892         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4893
  4894     12  CM-USER-FIELD                     PIC X.
  4895     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4896     12  CM-CLP-STATE                      PIC XX.
  4897     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4898     12  CM-USER-RESERVED                  PIC XXX.
  4899     12  FILLER REDEFINES CM-USER-RESERVED.
  4900         16  CM-AH-CLASS-CD                PIC XX.
  4901         16  F                             PIC X.
  4902******************************************************************
  4903*                                COPY ELCCRTO.
  4904******************************************************************
  4905*                                                                *
  4906*                            ELCCRTO.                            *
  4907*                                                                *
  4908*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4909*                                                                *
  4910*   FILE TYPE = VSAM,KSDS                                        *
  4911*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4912*                                                                *
  4913*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4914*                                                                *
  4915*   LOG = YES                                                    *
  4916*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4917******************************************************************
  4918*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  87
* EL6318.cbl
  4919*
  4920* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4921*-----------------------------------------------------------------
  4922*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4923* EFFECTIVE    NUMBER
  4924*-----------------------------------------------------------------
  4925* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4926* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4927* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4928* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4929* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  4930******************************************************************
  4931 01  ORIGINAL-CERTIFICATE.
  4932     12  OC-RECORD-ID                      PIC XX.
  4933         88  VALID-OC-ID                      VALUE 'OC'.
  4934     12  OC-CONTROL-PRIMARY.
  4935         16  OC-COMPANY-CD                 PIC X.
  4936         16  OC-CARRIER                    PIC X.
  4937         16  OC-GROUPING                   PIC X(6).
  4938         16  OC-STATE                      PIC XX.
  4939         16  OC-ACCOUNT                    PIC X(10).
  4940         16  OC-CERT-EFF-DT                PIC XX.
  4941         16  OC-CERT-NO.
  4942             20  OC-CERT-PRIME             PIC X(10).
  4943             20  OC-CERT-SFX               PIC X.
  4944         16  OC-RECORD-TYPE                PIC X.
  4945         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4946     12  OC-LAST-MAINT-DT                  PIC XX.
  4947     12  OC-LAST-MAINT-BY                  PIC X(4).
  4948     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4949     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4950     12  FILLER                            PIC X(49).
  4951     12  OC-ORIG-REC.
  4952         16  OC-INS-LAST-NAME              PIC X(15).
  4953         16  OC-INS-FIRST-NAME             PIC X(10).
  4954         16  OC-INS-MIDDLE-INIT            PIC X.
  4955         16  OC-INS-AGE                    PIC S999     COMP-3.
  4956         16  OC-JNT-LAST-NAME              PIC X(15).
  4957         16  OC-JNT-FIRST-NAME             PIC X(10).
  4958         16  OC-JNT-MIDDLE-INIT            PIC X.
  4959         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4960         16  OC-LF-BENCD                   PIC XX.
  4961         16  OC-LF-TERM                    PIC S999      COMP-3.
  4962         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4963         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4964         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  4965         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  4966         16  OC-LF-EXP-DT                  PIC XX.
  4967         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  4968         16  OC-LF-CANCEL-DT               PIC XX.
  4969         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4970         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4971         16  OC-AH-BENCD                   PIC XX.
  4972         16  OC-AH-TERM                    PIC S999      COMP-3.
  4973         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4974         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4975         16  OC-AH-EXP-DT                  PIC XX.
  4976         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  88
* EL6318.cbl
  4977         16  OC-AH-CP                      PIC 99.
  4978         16  OC-AH-CANCEL-DT               PIC XX.
  4979         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4980         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4981         16  OC-CRED-BENE-NAME             PIC X(25).
  4982         16  OC-1ST-PMT-DT                 PIC XX.
  4983         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  4984         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  4985         16  OC-ISSUE-TRAN-IND             PIC X.
  4986         16  OC-CANCEL-TRAN-IND            PIC X.
  4987         16  FILLER                        PIC X(211).
  4988
  4989     12  FILLER                            PIC X(50).
  4990******************************************************************
  4991*                                COPY ERCENDT.
  4992******************************************************************
  4993*                                                                *
  4994*                                                                *
  4995*                            ERCENDT.                            *
  4996*                            VMOD=2.001                          *
  4997*                                                                *
  4998*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  4999*                                                                *
  5000*   FILE TYPE = VSAM,KSDS                                        *
  5001*   RECORD SIZE = 579  RECFORM = FIXED                           *
  5002*                                                                *
  5003*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  5004*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  5005*                                                                *
  5006*   LOG = NO                                                     *
  5007*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5008******************************************************************
  5009*-----------------------------------------------------------------
  5010*                   C H A N G E   L O G
  5011*
  5012* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5013*-----------------------------------------------------------------
  5014*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5015* EFFECTIVE    NUMBER
  5016*-----------------------------------------------------------------
  5017* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  5018*                                WITH OPEN CLAIMS
  5019* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  5020* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5021* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5022* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  5023*-----------------------------------------------------------------
  5024 01  ENDORSEMENT-RECORD.
  5025     12  EN-RECORD-ID                PIC XX.
  5026         88  VALID-EN-ID                VALUE 'EN'.
  5027     12  EN-CONTROL-PRIMARY.
  5028         16  EN-COMPANY-CD           PIC X.
  5029         16  EN-CARRIER              PIC X.
  5030         16  EN-GROUPING             PIC X(6).
  5031         16  EN-STATE                PIC XX.
  5032         16  EN-ACCOUNT              PIC X(10).
  5033         16  EN-CERT-EFF-DT          PIC XX.
  5034         16  EN-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  89
* EL6318.cbl
  5035             20  EN-CERT-PRIME       PIC X(10).
  5036             20  EN-CERT-SFX         PIC X.
  5037         16  EN-REC-TYPE             PIC X.
  5038             88  EN-ISSUE               VALUE 'I'.
  5039             88  EN-CANCELLATION        VALUE 'C'.
  5040         16  EN-SEQ-NO               PIC 9(04) BINARY.
  5041     12  EN-CONTROL-BY-ARCH-NO.
  5042         16  EN-COMPANY-CD-A1              PIC X.
  5043         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  5044     12  EN-LAST-MAINT-DT            PIC XX.
  5045     12  EN-LAST-MAINT-BY            PIC X(4).
  5046     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  5047     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  5048     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5049         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  5050         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  5051         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  5052         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  5053         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  5054         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  5055         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  5056         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  5057         16  EN-LF-ORIG-BENCD        PIC XX.
  5058         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  5059         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  5060         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  5061         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  5062         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  5063         16  EN-LF-ORIG-EXP-DT       PIC XX.
  5064*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  5065         16  EN-ORIG-CRED-BENE       PIC X(25).
  5066         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  5067         16  FILLER                  PIC X.
  5068         16  EN-AH-ORIG-BENCD        PIC XX.
  5069         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  5070         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  5071         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  5072         16  EN-AH-ORIG-EXP-DT       PIC XX.
  5073*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  5074*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  5075         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  5076         16  F                       PIC X(09).
  5077         16  EN-AH-ORIG-CP           PIC 99.
  5078         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  5079         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  5080         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  5081         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  5082         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  5083         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  5084         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  5085         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  5086         16  EN-LF-NEW-BENCD         PIC XX.
  5087         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  5088         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5089         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5090         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  5091         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  5092         16  EN-LF-NEW-EXP-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  90
* EL6318.cbl
  5093         16  EN-NEW-CRED-BENE        PIC X(25).
  5094         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5095         16  FILLER                  PIC X.
  5096         16  EN-AH-NEW-BENCD         PIC XX.
  5097         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  5098         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5099         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5100         16  EN-AH-NEW-EXP-DT        PIC XX.
  5101*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  5102*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  5103*        16  F                       PIC X(12).
  5104         16  EN-AH-NEW-CP            PIC 99.
  5105         16  EN-SIG-SW               PIC X.
  5106         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5107         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  5108         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  5109         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  5110         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  5111         16  FILLER                  PIC X(33).
  5112     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5113         16  EN-LF-ORIG-REF-DT       PIC XX.
  5114         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5115         16  EN-AH-ORIG-REF-DT       PIC XX.
  5116         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5117         16  EN-LF-NEW-REF-DT        PIC XX.
  5118         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5119         16  EN-AH-NEW-REF-DT        PIC XX.
  5120         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5121         16  EN-FLAG-CERT            PIC X.
  5122         16  EN-INS-LAST-NAME        PIC X(15).
  5123         16  EN-INS-FIRST-NAME       PIC X(10).
  5124         16  EN-INS-MIDDLE-INIT      PIC X.
  5125         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5126         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5127         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5128         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5129         16  FILLER                  PIC X(262).
  5130     12  EN-MONEY-SW             PIC X.
  5131     12  EN-HEALTH-APP           PIC X.
  5132     12  EN-VOUCHER-SW           PIC X.
  5133     12  EN-PAYEE                PIC X(14).
  5134     12  EN-INPUT-DT             PIC XX.
  5135     12  EN-PROCESS-DT           PIC XX.
  5136     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  5137     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  5138     12  EN-REASON-CODES.
  5139         16  F OCCURS 12.
  5140             20  EN-REASON-CODE  PIC X(4).
  5141     12  EN-TEMPLATE-USED        PIC X(8).
  5142     12  EN-DOCU-TYPE            PIC X.
  5143         88  EN-VERI-DOCU          VALUE 'V'.
  5144         88  EN-GCE-DOCU           VALUE 'G'.
  5145         88  EN-CANC-DOCU          VALUE 'C'.
  5146     12  EN-COMMENTS1            PIC X(13).
  5147     12  EN-COMMENTS2            PIC X(70).
  5148     12  EN-COMM-CHGBK           PIC X.
  5149         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  5150         88  EN-CHG-ACCT           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  91
* EL6318.cbl
  5151     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  5152     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  5153     12  EN-BATCH-NUMBER         PIC X(6).
  5154     12  EN-ACCT-SUMM            PIC X.
  5155     12  EN-CSO-SUMM             PIC X.
  5156     12  en-check-type           pic x.
  5157     12  FILLER                  PIC X(12).
  5158******************************************************************
  5159*                                COPY ERCNOTE.
  5160******************************************************************
  5161*                                                                *
  5162*                                                                *
  5163*                            ERCNOTE                             *
  5164*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5165*                            VMOD=2.003                          *
  5166*                                                                *
  5167*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5168*                                                                *
  5169*        FILE TYPE= VSAM,KSDS                                    *
  5170*        RECORD SIZE = 825    RECFORM = FIXED                    *
  5171*                                                                *
  5172*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  5173*                                                                *
  5174*        LOG = YES                                               *
  5175*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5176*                                                                *
  5177******************************************************************
  5178*                   C H A N G E   L O G
  5179*
  5180* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5181*-----------------------------------------------------------------
  5182*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5183* EFFECTIVE    NUMBER
  5184*-----------------------------------------------------------------
  5185* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5186*                                FILE WILL CONTAIN BILLING NOTES O
  5187******************************************************************
  5188
  5189 01  CERTIFICATE-NOTE.
  5190     12  CN-RECORD-ID                PIC  XX.
  5191         88  VALID-CN-ID                  VALUE 'CN'.
  5192
  5193     12  CN-CONTROL-PRIMARY.
  5194         16  CN-COMPANY-CD           PIC X.
  5195         16  CN-CARRIER              PIC X.
  5196         16  CN-GROUPING.
  5197             20 CN-GROUPING-PREFIX   PIC XXX.
  5198             20 CN-GROUPING-PRIME    PIC XXX.
  5199         16  CN-STATE                PIC XX.
  5200         16  CN-ACCOUNT.
  5201             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5202             20 CN-ACCOUNT-PRIME     PIC X(6).
  5203         16  CN-CERT-EFF-DT          PIC XX.
  5204         16  CN-CERT-NO.
  5205             20  CN-CERT-PRIME       PIC X(10).
  5206             20  CN-CERT-SFX         PIC X.
  5207
  5208     12  CN-BILLING-START-LINE-NO    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  92
* EL6318.cbl
  5209     12  CN-BILLING-END-LINE-NO      PIC 99.
  5210
  5211     12  CN-LINES.
  5212         16  CN-LINE OCCURS 10       PIC X(77).
  5213
  5214     12  CN-LAST-MAINT-DT            PIC XX.
  5215     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5216     12  CN-LAST-MAINT-USER          PIC X(4).
  5217     12  FILLER                      PIC X(6).
  5218******************************************************************
  5219*                                COPY ERCMAIL.
  5220******************************************************************
  5221*                                                                *
  5222*                                                                *
  5223*                            ERCMAIL                             *
  5224*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5225*                            VMOD=2.003                          *
  5226*                                                                *
  5227*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5228*                                                                *
  5229*   FILE TYPE = VSAM,KSDS                                        *
  5230*   RECORD SIZE = 374   RECFORM = FIX                            *
  5231*                                                                *
  5232*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5233*   ALTERNATE PATH    = NOT USED                                 *
  5234*                                                                *
  5235*   LOG = YES                                                    *
  5236*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5237******************************************************************
  5238*                   C H A N G E   L O G
  5239*
  5240* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5241*-----------------------------------------------------------------
  5242*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5243* EFFECTIVE    NUMBER
  5244*-----------------------------------------------------------------
  5245* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5246* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5247* 111108                   PEMA  ADD CRED BENE ADDR2
  5248******************************************************************
  5249
  5250 01  MAILING-DATA.
  5251     12  MA-RECORD-ID                      PIC XX.
  5252         88  VALID-MA-ID                       VALUE 'MA'.
  5253
  5254     12  MA-CONTROL-PRIMARY.
  5255         16  MA-COMPANY-CD                 PIC X.
  5256         16  MA-CARRIER                    PIC X.
  5257         16  MA-GROUPING.
  5258             20  MA-GROUPING-PREFIX        PIC XXX.
  5259             20  MA-GROUPING-PRIME         PIC XXX.
  5260         16  MA-STATE                      PIC XX.
  5261         16  MA-ACCOUNT.
  5262             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5263             20  MA-ACCOUNT-PRIME          PIC X(6).
  5264         16  MA-CERT-EFF-DT                PIC XX.
  5265         16  MA-CERT-NO.
  5266             20  MA-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  93
* EL6318.cbl
  5267             20  MA-CERT-SFX               PIC X.
  5268
  5269     12  FILLER                            PIC XX.
  5270
  5271     12  MA-ACCESS-CONTROL.
  5272         16  MA-SOURCE-SYSTEM              PIC XX.
  5273             88  MA-FROM-CREDIT                VALUE 'CR'.
  5274             88  MA-FROM-VSI                   VALUE 'VS'.
  5275             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5276             88  MA-FROM-OTHER                 VALUE 'OT'.
  5277         16  MA-RECORD-ADD-DT              PIC XX.
  5278         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5279         16  MA-LAST-MAINT-DT              PIC XX.
  5280         16  MA-LAST-MAINT-BY              PIC XXXX.
  5281         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5282
  5283     12  MA-PROFILE-INFO.
  5284         16  MA-QUALIFY-CODE-1             PIC XX.
  5285         16  MA-QUALIFY-CODE-2             PIC XX.
  5286         16  MA-QUALIFY-CODE-3             PIC XX.
  5287         16  MA-QUALIFY-CODE-4             PIC XX.
  5288         16  MA-QUALIFY-CODE-5             PIC XX.
  5289
  5290         16  MA-INSURED-LAST-NAME          PIC X(15).
  5291         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5292         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5293         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5294         16  MA-INSURED-BIRTH-DT           PIC XX.
  5295         16  MA-INSURED-SEX                PIC X.
  5296             88  MA-SEX-MALE                   VALUE 'M'.
  5297             88  MA-SEX-FEMALE                 VALUE 'F'.
  5298         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5299
  5300         16  MA-ADDRESS-CORRECTED          PIC X.
  5301         16  MA-JOINT-BIRTH-DT             PIC XX.
  5302*        16  FILLER                        PIC X(12).
  5303
  5304         16  MA-ADDRESS-LINE-1             PIC X(30).
  5305         16  MA-ADDRESS-LINE-2             PIC X(30).
  5306         16  MA-CITY-STATE.
  5307             20  MA-CITY                   PIC X(28).
  5308             20  MA-ADDR-STATE             PIC XX.
  5309         16  MA-ZIP.
  5310             20  MA-ZIP-CODE.
  5311                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5312                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5313                 24  FILLER                PIC X(4).
  5314             20  MA-ZIP-PLUS4              PIC X(4).
  5315         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5316             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5317             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5318             20  FILLER                    PIC X(3).
  5319
  5320         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5321
  5322         16  FILLER                        PIC XXX.
  5323*        16  FILLER                        PIC X(10).
  5324
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  94
* EL6318.cbl
  5325     12  MA-CRED-BENE-INFO.
  5326         16  MA-CRED-BENE-NAME                 PIC X(25).
  5327         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5328         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5329         16  MA-CRED-BENE-CTYST.
  5330             20  MA-CRED-BENE-CITY             PIC X(28).
  5331             20  MA-CRED-BENE-STATE            PIC XX.
  5332         16  MA-CRED-BENE-ZIP.
  5333             20  MA-CB-ZIP-CODE.
  5334                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5335                     88  MA-CB-CANADIAN-POST-CODE
  5336                                           VALUE 'A' THRU 'Z'.
  5337                 24  FILLER                    PIC X(4).
  5338             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5339         16  MA-CB-CANADIAN-POSTAL-CODE
  5340                            REDEFINES MA-CRED-BENE-ZIP.
  5341             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5342             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5343             20  FILLER                        PIC X(3).
  5344     12  MA-POST-CARD-MAIL-DATA.
  5345         16  MA-MAIL-DATA OCCURS 7.
  5346             20  MA-MAIL-TYPE              PIC X.
  5347                 88  MA-12MO-MAILING           VALUE '1'.
  5348                 88  MA-EXP-MAILING            VALUE '2'.
  5349             20  MA-MAIL-STATUS            PIC X.
  5350                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5351                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5352                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5353             20  MA-MAIL-DATE              PIC XX.
  5354     12  FILLER                            PIC XX.
  5355     12  FILLER                            PIC XX.
  5356*    12  FILLER                            PIC X(30).
  5357******************************************************************
  5358*                                COPY ERCARCH.
  5359******************************************************************
  5360*                                                                *
  5361*                            ERCARCH.                            *
  5362*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5363*                            VMOD=2.002                          *
  5364*                                                                *
  5365*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5366*                                                                *
  5367*   FILE TYPE = VSAM,KSDS                                        *
  5368*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5369*                                                                *
  5370*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5371*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5372*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5373*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5374*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5375*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5376*                                                                *
  5377*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5378******************************************************************
  5379*                   C H A N G E   L O G
  5380*
  5381* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5382*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  95
* EL6318.cbl
  5383*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5384* EFFECTIVE    NUMBER
  5385*-----------------------------------------------------------------
  5386* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5387* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5388* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5389******************************************************************
  5390 01  LETTER-ARCHIVE.
  5391     12  LA-RECORD-ID                PIC  X(02).
  5392         88  LA-VALID-ID                VALUE 'LA'.
  5393
  5394     12  LA-CONTROL-PRIMARY.
  5395         16  LA-COMPANY-CD           PIC  X(01).
  5396         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5397
  5398     12  LA-CONTROL-BY-CERT-RESP.
  5399         16  LA-COMPANY-CD-A2        PIC  X(01).
  5400         16  LA-CERT-NO-A2.
  5401             20  LA-CERT-PRIME-A2    PIC  X(10).
  5402             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5403         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5404             20  LA-RESP-PERSON-A2   PIC  X(10).
  5405             20  LA-TYPE-A2          PIC  X(01).
  5406         16  LA-CARRIER-A2           PIC  X(01).
  5407         16  LA-GROUPING-A2          PIC  X(06).
  5408         16  LA-STATE-A2             PIC  X(02).
  5409         16  LA-ACCOUNT-A2           PIC  X(10).
  5410         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5411         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5412
  5413     12  LA-CONTROL-BY-FORM.
  5414         16  LA-COMPANY-CD-A3        PIC  X(01).
  5415         16  LA-FORM-A3              PIC  X(04).
  5416         16  LA-CARRIER-A3           PIC  X(01).
  5417         16  LA-GROUPING-A3          PIC  X(06).
  5418         16  LA-STATE-A3             PIC  X(02).
  5419         16  LA-ACCOUNT-A3           PIC  X(10).
  5420         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5421
  5422     12  LA-CONTROL-BY-PROCESSOR.
  5423         16  LA-COMPANY-CD-A4        PIC  X(01).
  5424         16  LA-PROCESSOR-CD         PIC  X(04).
  5425         16  LA-CARRIER-A4           PIC  X(01).
  5426         16  LA-GROUPING-A4          PIC  X(06).
  5427         16  LA-STATE-A4             PIC  X(02).
  5428         16  LA-ACCOUNT-A4           PIC  X(10).
  5429         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5430
  5431     12  LA-CONTROL-BY-KEY-FIELDS.
  5432         16  LA-COMPANY-CD-A5        PIC  X(01).
  5433         16  LA-CARRIER-A5           PIC  X(01).
  5434         16  LA-GROUPING-A5          PIC  X(06).
  5435         16  LA-STATE-A5             PIC  X(02).
  5436         16  LA-ACCOUNT-A5           PIC  X(10).
  5437         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5438
  5439     12  LA-CONTROL-BY-GROUP-CODE.
  5440         16  LA-COMPANY-CD-A6        PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  96
* EL6318.cbl
  5441         16  LA-ENTRY-A6.
  5442             20  LA-FILLER           PIC  X(02).
  5443             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5444         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5445
  5446     12  FILLER                      PIC  X(09).
  5447
  5448     12  LA-HEADER-RECORD.
  5449         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5450         16  LA-CREATION-DATE        PIC  X(02).
  5451         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5452         16  LA-FINAL-ACT-DATE       REDEFINES
  5453               LA-FOLLOW-UP-DATE     PIC  X(02).
  5454         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5455         16  LA-NO-OF-COPIES         PIC S9(01).
  5456         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5457         16  LA-REPLY-DATE           PIC  X(02).
  5458         16  LA-RESEND-DATES.
  5459             20  LA-RESEND-DATE      PIC  X(02).
  5460             20  LA-SENT-DATE        PIC  X(02).
  5461             20  FILLER              PIC  X(08).
  5462         16  LA-SOURCE-INFORMATION.
  5463             20  LA-DATA-SOURCE      PIC  X(01).
  5464             20  LA-ADDR-SOURCE      PIC  X(01).
  5465         16  LA-STATUS               PIC  X(01).
  5466             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5467             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5468             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5469             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5470             88  LA-STATUS-PURGED         VALUE 'P'.
  5471             88  LA-STATUS-VOIDED         VALUE 'V'.
  5472         16  LA-LAST-RESENT-PRINT-DATE
  5473                                     PIC  X(02).
  5474         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5475             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5476                                          VALUE 'C'.
  5477             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5478                                          VALUE 'F'.
  5479             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5480                                          VALUE 'P'.
  5481         16  LA-PURGED-DATE          PIC  X(02).
  5482         16  LA-VOIDED-DATE          PIC  X(02).
  5483         16  LA-RESEND-LETR          PIC  X(4).
  5484         16  FILLER                  PIC  X(08).
  5485*        16  LA-RESEND-LETR-2        PIC  X(4).
  5486*        16  LA-RESEND-LETR-3        PIC  X(4).
  5487*        16  FILLER                  PIC  X(59).
  5488         16  LA-ARCHIVE-STATUS       PIC  X.
  5489             88  LA-TEMP                VALUE 'T'.
  5490             88  LA-QWS                 VALUE 'Q'.
  5491             88  LA-BATCH               VALUE 'B'.
  5492         16  LA-FINAL-ACT-IND        PIC  X(1).
  5493         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5494         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5495         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5496                                     PIC X(4).
  5497         16  FILLER                  PIC  X(42).
  5498*        16  FILLER                  PIC  X(71).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  97
* EL6318.cbl
  5499         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5500         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5501         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5502                                     PIC  X(4).
  5503         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5504
  5505******************************************************************
  5506*                                COPY ERCCNOT.
  5507******************************************************************
  5508*                                                                *
  5509*                            ERCCNOT                             *
  5510*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5511*                            VMOD=2.003                          *
  5512*                                                                *
  5513*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5514*                                                                *
  5515*        FILE TYPE= VSAM,KSDS                                    *
  5516*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5517*                                                                *
  5518*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5519*                                                                *
  5520*        LOG = YES                                               *
  5521*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5522*                                                                *
  5523******************************************************************
  5524*                   C H A N G E   L O G
  5525*
  5526* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5527*-----------------------------------------------------------------
  5528*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5529* EFFECTIVE    NUMBER
  5530*-----------------------------------------------------------------
  5531* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5532******************************************************************
  5533
  5534 01  CERT-NOTE-FILE.
  5535     12  CZ-RECORD-ID                PIC  XX.
  5536         88  VALID-CZ-ID                  VALUE 'CZ'.
  5537
  5538     12  CZ-CONTROL-PRIMARY.
  5539         16  CZ-COMPANY-CD           PIC X.
  5540         16  CZ-CARRIER              PIC X.
  5541         16  CZ-GROUPING.
  5542             20 CZ-GROUPING-PREFIX   PIC XXX.
  5543             20 CZ-GROUPING-PRIME    PIC XXX.
  5544         16  CZ-STATE                PIC XX.
  5545         16  CZ-ACCOUNT.
  5546             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5547             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5548         16  CZ-CERT-EFF-DT          PIC XX.
  5549         16  CZ-CERT-NO.
  5550             20  CZ-CERT-PRIME       PIC X(10).
  5551             20  CZ-CERT-SFX         PIC X.
  5552         16  CZ-RECORD-TYPE          PIC X.
  5553             88  CERT-NOTE           VALUE '1'.
  5554             88  CLAIM-CERT-NOTE     VALUE '2'.
  5555         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5556
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  98
* EL6318.cbl
  5557     12  CZ-LAST-MAINT-DT            PIC XX.
  5558     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5559     12  CZ-LAST-MAINT-USER          PIC X(4).
  5560
  5561     12  CZ-NOTE-INFORMATION.
  5562         16  CZ-NOTE                 PIC X(63).
  5563         16  FILLER                  PIC X(39).
  5564******************************************************************
  5565*                                COPY ELCEOBC.
  5566******************************************************************
  5567*                                                                *
  5568*                                                                *
  5569*                            ELCEOBC                             *
  5570*                            VMOD=2.001                          *
  5571*                                                                *
  5572*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5573*                                                                *
  5574*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5575*   VSAM EOB CODE TABLE                                          *
  5576*                                                                *
  5577*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5578*                                                                *
  5579*   FILE TYPE = VSAM,KSDS                                        *
  5580*   RECORD SIZE = 350   RECFORM = FIX                            *
  5581*                                                                *
  5582*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5583*                                                                *
  5584*   LOG = NO                                                     *
  5585*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5586*                                                                *
  5587*                                                                *
  5588******************************************************************
  5589*                   C H A N G E   L O G
  5590*
  5591* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5592*-----------------------------------------------------------------
  5593*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5594* EFFECTIVE    NUMBER
  5595*-----------------------------------------------------------------
  5596* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5597* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5598* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  5599******************************************************************
  5600 01  EOB-CODES.
  5601     12  EO-RECORD-ID                      PIC XX.
  5602         88  VALID-DN-ID                      VALUE 'EO'.
  5603     12  EO-CONTROL-PRIMARY.
  5604         16  EO-COMPANY-CD                 PIC X.
  5605         16  EO-RECORD-TYPE                PIC X.
  5606             88  EO-EOB-RECS                  VALUE '1'.
  5607             88  EO-VERIF-RECS                VALUE '2'.
  5608             88  EO-GCE-RECS                  VALUE '3'.
  5609             88  EO-CANC-RECS                 VALUE '4'.
  5610             88  EO-BILL-NOTE-RECS            VALUE '5'.
  5611         16  EO-EOB-CODE                   PIC X(4).
  5612         16  FILLER                        PIC X(9).
  5613     12  EO-MAINT-INFORMATION.
  5614         16  EO-LAST-MAINT-DT              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page  99
* EL6318.cbl
  5615         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5616         16  EO-LAST-MAINT-USER            PIC X(4).
  5617         16  FILLER                        PIC XX.
  5618     12  EO-DESCRIPTION                    PIC X(275).
  5619     12  FILLER                            PIC X(46).
  5620******************************************************************
  5621*                                COPY ELCCRTT.
  5622******************************************************************
  5623*                                                                *
  5624*                            ELCCRTT.                            *
  5625*                                                                *
  5626*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5627*                                                                *
  5628*   FILE TYPE = VSAM,KSDS                                        *
  5629*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5630*                                                                *
  5631*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5632*                                                                *
  5633*   LOG = YES                                                    *
  5634*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5635******************************************************************
  5636*                   C H A N G E   L O G
  5637*
  5638* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5639*-----------------------------------------------------------------
  5640*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5641* EFFECTIVE    NUMBER
  5642*-----------------------------------------------------------------
  5643* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5644* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5645* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5646* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5647* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5648* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5649* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5650* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  5651******************************************************************
  5652
  5653 01  CERTIFICATE-TRAILERS.
  5654     12  CS-RECORD-ID                      PIC XX.
  5655         88  VALID-CS-ID                      VALUE 'CS'.
  5656
  5657     12  CS-CONTROL-PRIMARY.
  5658         16  CS-COMPANY-CD                 PIC X.
  5659         16  CS-CARRIER                    PIC X.
  5660         16  CS-GROUPING                   PIC X(6).
  5661         16  CS-STATE                      PIC XX.
  5662         16  CS-ACCOUNT                    PIC X(10).
  5663         16  CS-CERT-EFF-DT                PIC XX.
  5664         16  CS-CERT-NO.
  5665             20  CS-CERT-PRIME             PIC X(10).
  5666             20  CS-CERT-SFX               PIC X.
  5667         16  CS-TRAILER-TYPE               PIC X.
  5668             88  COMM-TRLR           VALUE 'A'.
  5669             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5670             88  CERT-DATA-TRLR      VALUE 'C'.
  5671
  5672     12  CS-DATA-AREA                      PIC X(516).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 100
* EL6318.cbl
  5673
  5674     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5675         16  CS-BANK-COMMISSION-AREA.
  5676             20  CS-BANK-COMMS       OCCURS 10.
  5677                 24  CS-AGT                PIC X(10).
  5678                 24  CS-COM-TYP            PIC X.
  5679                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5680                 24  CS-RECALC-LV-INDIC    PIC X.
  5681                 24  FILLER                PIC X(10).
  5682         16  FILLER                        PIC X(256).
  5683
  5684     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5685****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5686         16  CS-MB-CLAIM-DATA OCCURS 24.
  5687             20  CS-CLAIM-NO               PIC X(7).
  5688             20  CS-CLAIM-TYPE             PIC X.
  5689                 88  CS-AH-CLM               VALUE 'A'.
  5690                 88  CS-IU-CLM               VALUE 'I'.
  5691                 88  CS-GP-CLM               VALUE 'G'.
  5692                 88  CS-LF-CLM               VALUE 'L'.
  5693                 88  CS-PR-CLM               VALUE 'P'.
  5694                 88  CS-FL-CLM               VALUE 'F'.
  5695             20  CS-INSURED-TYPE           PIC X.
  5696                 88  CS-PRIM-INSURED          VALUE 'P'.
  5697                 88  CS-CO-BORROWER           VALUE 'C'.
  5698             20  CS-BENEFIT-PERIOD         PIC 99.
  5699             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5700             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5701             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5702         16  FILLER                        PIC X(12).
  5703     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5704         16  CS-VIN-NUMBER                 PIC X(17).
  5705         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5706         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5707         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5708         16  cs-agent-name.
  5709             20  cs-agent-fname            pic x(20).
  5710             20  cs-agent-mi               pic x.
  5711             20  cs-agent-lname            pic x(25).
  5712         16  cs-license-no                 pic x(15).
  5713         16  cs-npn-number                 pic x(10).
  5714         16  cs-agent-edit-status          pic x.
  5715             88  cs-ae-refer-to-manager      value 'M'.
  5716             88  cs-ae-cover-sheet           value 'C'.
  5717             88  cs-ae-sig-form              value 'S'.
  5718             88  cs-ae-verified              value 'V'.
  5719             88  cs-unidentified-signature   value 'U'.
  5720             88  cs-cert-returned            value 'R'.
  5721             88  cs-accept-no-commission     value 'N'.
  5722         16  FILLER                        PIC X(424).
  5723*        16  FILLER                        PIC X(496).
  5724*                                COPY ELCENCC.
  5725******************************************************************
  5726*                                                                *
  5727*                                                                *
  5728*                            ELCENCC                             *
  5729*                            VMOD=2.001                          *
  5730*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 101
* EL6318.cbl
  5731*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5732*                                                                *
  5733*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  5734*   A NAPERSOFT DOCUMENT                                         *
  5735*                                                                *
  5736*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5737*                                                                *
  5738*   FILE TYPE = VSAM,KSDS                                        *
  5739*   RECORD SIZE = 400   RECFORM = FIX                            *
  5740*                                                                *
  5741*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  5742*                                                                *
  5743*   LOG = NO                                                     *
  5744*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5745*                                                                *
  5746*                                                                *
  5747******************************************************************
  5748*                   C H A N G E   L O G
  5749*
  5750* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5751*-----------------------------------------------------------------
  5752*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5753* EFFECTIVE    NUMBER
  5754*-----------------------------------------------------------------
  5755* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5756******************************************************************
  5757 01  ENCLOSURE-CODES.
  5758     12  NC-RECORD-ID                      PIC XX.
  5759         88  VALID-NC-ID                      VALUE 'NC'.
  5760     12  NC-CONTROL-PRIMARY.
  5761         16  NC-COMPANY-CD                 PIC X.
  5762         16  NC-REC-TYPE                   PIC X.
  5763             88  NC-CLAIMS                   VALUE '1'.
  5764             88  NC-ADMIN                    VALUE '2'.
  5765         16  NC-ENC-CODE                   PIC X(5).
  5766         16  FILLER                        PIC X(09).
  5767     12  NC-MAINT-INFORMATION.
  5768         16  NC-LAST-MAINT-DT              PIC XX.
  5769         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5770         16  NC-LAST-MAINT-USER            PIC X(4).
  5771         16  FILLER                        PIC XX.
  5772     12  NC-OUTPUT-STACK                   PIC XXX.
  5773     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5774     12  NC-ATTACHMENTS                    PIC X(100).
  5775     12  NC-FUTURE                         PIC X(50).
  5776     12  FILLER                            PIC X(117).
  5777******************************************************************
  5778 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5779                          ACCOUNT-MASTER CONTROL-FILE
  5780                          PENDING-BUSINESS CERTIFICATE-MASTER
  5781                          ORIGINAL-CERTIFICATE
  5782                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5783                          MAILING-DATA LETTER-ARCHIVE
  5784                          CERT-NOTE-FILE EOB-CODES
  5785                          CERTIFICATE-TRAILERS ENCLOSURE-CODES.
  5786 0000-DFHEXIT SECTION.
  5787     MOVE '9#                    $   ' TO DFHEIV0.
  5788     MOVE 'EL6318' TO DFHEIV1.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 102
* EL6318.cbl
  5789     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5790     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5791     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5792     MOVE '5'                    TO DC-OPTION-CODE
  5793     PERFORM 9700-DATE-LINK
  5794     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT
  5795     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT
  5796     MOVE EIBTRMID               TO QID-TERM
  5797     MOVE 2                      TO EMI-NUMBER-OF-LINES
  5798     IF EIBCALEN = 0
  5799        GO TO 8800-UNAUTHORIZED-ACCESS
  5800     END-IF
  5801     MOVE FUNCTION LENGTH(EL631KI) TO MAP-LENGTH
  5802     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5803        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5804           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5805           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5806           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5807           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5808           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5809           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5810           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5811           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5812           MOVE LOW-VALUES           TO EL631KI
  5813           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5814           GO TO 0350-BUILD-INIT-MAP
  5815        END-IF
  5816     END-IF
  5817     IF PI-CALLING-PROGRAM = 'EL614'
  5818        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5819                                 TO WS-PASSED-REASON-CODES
  5820        IF WS-PASSED-REASON-CODES NOT = SPACES
  5821           MOVE 'Y'                TO WS-SET-CODES-MDT
  5822        ELSE
  5823           MOVE 'N'                TO WS-SET-CODES-MDT
  5824        END-IF
  5825        PERFORM 0600-RECOVER-TEMP-STORAGE
  5826                                 THRU 0600-EXIT
  5827        GO TO 0350-BUILD-INIT-MAP
  5828     END-IF
  5829     IF PI-CALLING-PROGRAM = 'EL677'
  5830        move pi-el677-check-cut  to ws-el677-check-cut
  5831        move pi-el677-check-type to ws-el677-check-type
  5832        PERFORM 0600-RECOVER-TEMP-STORAGE
  5833                                 THRU 0600-EXIT
  5834        move ws-el677-check-cut  to pi-check-cut
  5835        move ws-el677-check-type to pi-check-type
  5836        GO TO 0350-BUILD-INIT-MAP
  5837     END-IF
  5838     if (eibaid = dfhclear or dfhpf23 or dfhpf24)
  5839        and (pi-check-cut = 'Y')
  5840        MOVE ER-3844             TO EMI-ERROR
  5841        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5842        GO TO 0350-BUILD-INIT-MAP
  5843     end-if
  5844     IF EIBAID = DFHCLEAR
  5845        IF PI-CLEAR-ERROR
  5846           MOVE SPACES            TO PI-CLEAR-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 103
* EL6318.cbl
  5847           MOVE ER-3833           TO EMI-ERROR
  5848           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5849           GO TO 0350-BUILD-INIT-MAP
  5850        ELSE
  5851           GO TO 9400-CLEAR
  5852        END-IF
  5853     END-IF
  5854     .
  5855 0200-RECEIVE.
  5856     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5857        MOVE ER-0008             TO EMI-ERROR
  5858        PERFORM 9900-ERROR-FORMAT
  5859                                 THRU 9900-EXIT
  5860        MOVE -1                  TO PFENTRL
  5861        GO TO 8100-SEND-INITIAL-MAP
  5862     END-IF
  5863
  5864* EXEC CICS RECEIVE
  5865*        MAP      (MAP-NAME)
  5866*        MAPSET   (MAPSET-NAME)
  5867*        INTO     (EL631KI)
  5868*    END-EXEC
  5869     MOVE LENGTH OF
  5870      EL631KI
  5871       TO DFHEIV11
  5872*    MOVE '8"T I  L              ''   #00005859' TO DFHEIV0
  5873     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5874     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5875     MOVE X'2020233030303035383539' TO DFHEIV0(25:11)
  5876     CALL 'kxdfhei1' USING DFHEIV0,
  5877           MAP-NAME,
  5878           EL631KI,
  5879           DFHEIV11,
  5880           MAPSET-NAME,
  5881           DFHEIV99,
  5882           DFHEIV99
  5883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5884     IF PFENTRL = 0
  5885         GO TO 0300-CHECK-PFKEYS
  5886     END-IF
  5887     IF EIBAID NOT = DFHENTER
  5888         MOVE ER-0004            TO EMI-ERROR
  5889         GO TO 0320-INPUT-ERROR
  5890     END-IF
  5891     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5892        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5893     ELSE
  5894        MOVE ER-0029            TO EMI-ERROR
  5895        GO TO 0320-INPUT-ERROR
  5896     END-IF
  5897     .
  5898 0300-CHECK-PFKEYS.
  5899     IF EIBAID = DFHPF3
  5900        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5901        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5902        PERFORM 0500-CREATE-TEMP-STORAGE THRU 0500-EXIT
  5903        MOVE 'EL614'             TO PGM-NAME
  5904        MOVE PI-REASON-CODE-IND  TO WS-SAVE-REASON-CODE-IND
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 104
* EL6318.cbl
  5905        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5906        move +1                  to s2
  5907        perform varying s1 from +1 by +1 until s1 > +12
  5908           if reacd-in (s1) not = spaces and low-values
  5909              move reacd-in (s1)    to pi-program-work-area (s2:4)
  5910              add +5 to s2
  5911           end-if
  5912        END-perform
  5913        MOVE WS-SAVE-REASON-CODE-IND TO PI-REASON-CODE-IND
  5914        GO TO 9300-XCTL
  5915     END-IF
  5916     IF (EIBAID = DFHPF4 OR DFHPF8)
  5917        and (vouchi = 'Y')
  5918        and (pi-check-cut not = 'Y')
  5919        MOVE ER-3845             TO EMI-ERROR
  5920        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5921        GO TO 0350-BUILD-INIT-MAP
  5922     end-if
  5923     IF EIBAID = DFHPF4 OR DFHPF8
  5924        GO TO 0360-FINALIZE
  5925     END-IF
  5926     IF (EIBAID = DFHPF5)
  5927        and (pi-endt-prm-diff > zeros)
  5928        PERFORM 0500-CREATE-TEMP-STORAGE
  5929                                 THRU 0500-EXIT
  5930        MOVE 'EL677'             TO PGM-NAME
  5931        move pi-endt-prm-diff    to pi-el677-prm-diff
  5932        move pi-endt-com-diff    to pi-el677-com-diff
  5933        move pi-check-cut        to pi-el677-check-cut
  5934        GO TO 9300-XCTL
  5935     END-IF
  5936     IF EIBAID = DFHPF23
  5937        IF PI-CLEAR-ERROR
  5938           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5939           MOVE ER-3833           TO EMI-ERROR
  5940           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5941           GO TO 0350-BUILD-INIT-MAP
  5942        ELSE
  5943           GO TO 8810-PF23
  5944        END-IF
  5945     END-IF
  5946     IF EIBAID = DFHPF24
  5947        IF PI-CLEAR-ERROR
  5948           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5949           MOVE ER-3833           TO EMI-ERROR
  5950           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5951           GO TO 0350-BUILD-INIT-MAP
  5952        ELSE
  5953           GO TO 9200-RETURN-MAIN-MENU
  5954        END-IF
  5955     END-IF
  5956     IF EIBAID = DFHPF12
  5957        GO TO 9500-PF12
  5958     END-IF
  5959     IF EIBAID = DFHENTER
  5960        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5961        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5962        GO TO 0330-CHECK-ERRORS
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 105
* EL6318.cbl
  5963     END-IF
  5964     MOVE ER-0029                TO EMI-ERROR
  5965     .
  5966 0320-INPUT-ERROR.
  5967     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5968     MOVE AL-UNBON               TO PFENTRA
  5969     MOVE -1                     TO PFENTRL
  5970     GO TO 8200-SEND-DATAONLY
  5971     .
  5972 0325-EDIT-SCREEN.
  5973     IF PRTSWL > ZEROS
  5974       IF PRTSWI = 'Y' OR 'N' OR 'P' OR ' '
  5975*          MOVE AL-UANON       TO PRTSWA
  5976*          IF PRTSWI = ' '
  5977*             MOVE 'N'         TO PRTSWI
  5978              MOVE 'P'         TO PRTSWI
  5979*          END-IF
  5980*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  5981        END-IF
  5982     END-IF
  5983     IF LTRIDL > ZEROS
  5984        AND LTRIDI > SPACES
  5985        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  5986        MOVE LTRIDI              TO LETR-LETTER-ID
  5987                                    PI-LTRID-ENTERED
  5988        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  5989        MOVE SPACES              TO LETR-FILLER
  5990        MOVE 0                   TO LETR-SEQ-NO
  5991        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  5992     ELSE
  5993        MOVE ER-1236          TO EMI-ERROR
  5994        MOVE -1               TO LTRIDL
  5995        MOVE AL-UABON         TO LTRIDA
  5996        PERFORM 9900-ERROR-FORMAT
  5997                                 THRU 9900-EXIT
  5998     END-IF
  5999
  6000     IF W-SIG-FLAG-DEFAULT > ' '
  6001        IF (SIGREQL > ZERO AND SIGREQI <> W-SIG-FLAG-DEFAULT)
  6002             MOVE W-SIG-FLAG-DEFAULT TO SIGREQI
  6003             MOVE +1 TO SIGREQL
  6004             MOVE ER-1664     TO EMI-ERROR
  6005             MOVE AL-UABON    TO SIGREQA
  6006             PERFORM 9900-ERROR-FORMAT
  6007                                 THRU 9900-EXIT
  6008        ELSE
  6009             MOVE W-SIG-FLAG-DEFAULT TO SIGREQI
  6010             MOVE +1 TO SIGREQL
  6011             MOVE AL-UANON    TO SIGREQA
  6012        END-IF
  6013     END-IF
  6014
  6015     IF (SIGREQL > ZEROS)
  6016        AND (SIGREQI = 'Y' OR 'N' OR ' ')
  6017        MOVE AL-UANON         TO SIGREQA
  6018        IF SIGREQI = ' '
  6019           MOVE 'N'           TO SIGREQI
  6020        END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 106
* EL6318.cbl
  6021        MOVE SIGREQI          TO PI-SIGREQ-ENTERED
  6022     ELSE
  6023        MOVE ER-2651          TO EMI-ERROR
  6024        MOVE -1               TO SIGREQL
  6025        MOVE AL-UABON         TO SIGREQA
  6026        PERFORM 9900-ERROR-FORMAT
  6027                                 THRU 9900-EXIT
  6028     END-IF
  6029
  6030     IF W-PROMPT-LETTER EQUAL 'Y'
  6031         MOVE ER-0894            TO EMI-ERROR
  6032         MOVE -1                 TO LTRIDL
  6033         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6034     END-IF
  6035     IF VOUCHL > ZEROS
  6036        IF VOUCHI = 'Y' OR 'N'
  6037           MOVE AL-UANON         TO VOUCHA
  6038           MOVE VOUCHI           TO PI-VOUCHER-ENTERED
  6039        ELSE
  6040           MOVE ER-9999          TO EMI-ERROR
  6041           MOVE -1               TO VOUCHL
  6042           MOVE AL-UABON         TO VOUCHA
  6043           PERFORM 9900-ERROR-FORMAT
  6044                                 THRU 9900-EXIT
  6045        END-IF
  6046     END-IF
  6047     IF HLTHAPPL > ZEROS
  6048        IF HLTHAPPI = 'Y' OR 'N'
  6049           MOVE AL-UANON         TO HLTHAPPA
  6050           MOVE HLTHAPPI         TO PI-HLTHAPP-ENTERED
  6051        ELSE
  6052           MOVE ER-9999          TO EMI-ERROR
  6053           MOVE -1               TO HLTHAPPL
  6054           MOVE AL-UABON         TO HLTHAPPA
  6055           PERFORM 9900-ERROR-FORMAT
  6056                                 THRU 9900-EXIT
  6057        END-IF
  6058     END-IF
  6059     IF PAYEEL > ZEROS
  6060        IF PAYEEI > SPACES
  6061           MOVE AL-UANON         TO PAYEEA
  6062           MOVE PAYEEI           TO PI-PAYEE-ENTERED
  6063        ELSE
  6064           MOVE ER-9999          TO EMI-ERROR
  6065           MOVE -1               TO PAYEEL
  6066           MOVE AL-UABON         TO PAYEEA
  6067           PERFORM 9900-ERROR-FORMAT
  6068                                 THRU 9900-EXIT
  6069        END-IF
  6070     END-IF
  6071     IF CERTIDL > ZEROS
  6072         IF CERTIDI NUMERIC
  6073            MOVE AL-UANON      TO CERTIDA
  6074            MOVE CERTIDI       TO PI-CERTID-ENTERED
  6075         ELSE
  6076            MOVE ER-1778       TO EMI-ERROR
  6077            MOVE -1            TO CERTIDL
  6078            MOVE AL-UABON      TO CERTIDA
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 107
* EL6318.cbl
  6079            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6080        END-IF
  6081     ELSE
  6082        IF PI-PRINT-CERTIFICATE = 'Y'
  6083            MOVE ER-0715       TO EMI-ERROR
  6084            MOVE -1            TO CERTIDL
  6085            MOVE AL-UABON      TO CERTIDA
  6086            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6087        END-IF
  6088     END-IF
  6089
  6090     IF ENCCODEL > ZEROS
  6091        MOVE FUNCTION UPPER-CASE(ENCCODEI) TO ENCCODEI
  6092                                              PI-ENCCODE
  6093        MOVE SPACES             TO WS-ELENCC-KEY
  6094        MOVE PI-COMPANY-CD      TO WS-ENCC-COMPANY-CD
  6095        MOVE '2'                TO WS-ENCC-REC-TYPE
  6096        MOVE ENCCODEI           TO WS-ENCC-ENC-CODE
  6097
  6098
  6099* EXEC CICS READ
  6100*           DATASET    (WS-ELENCC-FILE-ID)
  6101*           SET        (ADDRESS OF ENCLOSURE-CODES)
  6102*           RIDFLD     (WS-ELENCC-KEY)
  6103*           RESP       (WS-RESPONSE)
  6104*       END-EXEC
  6105*    MOVE '&"S        E          (  N#00006078' TO DFHEIV0
  6106     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6107     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6108     MOVE X'204E233030303036303738' TO DFHEIV0(25:11)
  6109     CALL 'kxdfhei1' USING DFHEIV0,
  6110           WS-ELENCC-FILE-ID,
  6111           DFHEIV20,
  6112           DFHEIV99,
  6113           WS-ELENCC-KEY,
  6114           DFHEIV99,
  6115           DFHEIV99,
  6116           DFHEIV99
  6117     SET ADDRESS OF ENCLOSURE-CODES TO
  6118         DFHEIV20
  6119     MOVE EIBRESP  TO WS-RESPONSE
  6120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6121
  6122        IF RESP-NORMAL
  6123           MOVE ENCCODEI         TO PI-ENCCODE
  6124                                    W-ENCLOSURE-CD
  6125           MOVE AL-UANON         TO ENCCODEA
  6126        ELSE
  6127           MOVE ER-1560          TO EMI-ERROR
  6128           MOVE -1               TO ENCCODEL
  6129           MOVE AL-UABON         TO ENCCODEA
  6130           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6131        END-IF
  6132     END-IF
  6133
  6134     SET REASONS-NOT-FOUND TO TRUE
  6135     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6136        IF REACDL (S1) = +4 OR
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 108
* EL6318.cbl
  6137          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6138              MOVE AL-SANON     TO REACDA (S1)
  6139              SET REASONS-FOUND TO TRUE
  6140        END-IF
  6141     END-PERFORM
  6142
  6143     IF REASONS-NOT-FOUND
  6144        MOVE ER-1820             TO EMI-ERROR
  6145        MOVE -1                  TO PFENTRL
  6146        PERFORM 9900-ERROR-FORMAT
  6147                                 THRU 9900-EXIT
  6148     ELSE
  6149        MOVE REASONCDS           TO PI-REASONS-ENTERED
  6150     END-IF
  6151
  6152     IF CRTNT1L > ZEROS
  6153        IF CRTNT1I > SPACES
  6154           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  6155        END-IF
  6156     END-IF
  6157
  6158     IF CRTNT2L > ZEROS
  6159        IF CRTNT2I > SPACES
  6160           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  6161        END-IF
  6162     END-IF
  6163
  6164     IF CRTNT3L > ZEROS
  6165        IF CRTNT3I > SPACES
  6166           MOVE CRTNT3I          TO PI-CERTNT3-ENTERED
  6167        END-IF
  6168     END-IF
  6169
  6170     IF CRTNT4L > ZEROS
  6171        IF CRTNT4I > SPACES
  6172           MOVE CRTNT4I          TO PI-CERTNT4-ENTERED
  6173        END-IF
  6174     END-IF
  6175
  6176     IF BILNT1L > ZEROS
  6177        IF BILNT1I > SPACES
  6178           MOVE BILNT1I          TO PI-BILLNT1-ENTERED
  6179        END-IF
  6180     END-IF
  6181
  6182     IF BILNT2L > ZEROS
  6183        IF BILNT2I > SPACES
  6184           MOVE BILNT2I          TO PI-BILLNT2-ENTERED
  6185        END-IF
  6186     END-IF
  6187
  6188     .
  6189 0325-EXIT.
  6190     EXIT.
  6191
  6192 0326-GET-Z-RECORD.
  6193
  6194     MOVE SPACES  TO W-Z-CONTROL-DATA
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 109
* EL6318.cbl
  6195
  6196
  6197* EXEC CICS STARTBR
  6198*         DATASET    ('ELLETR')
  6199*         RIDFLD     (ELLETR-KEY)
  6200*         GTEQ
  6201*         RESP      (WS-RESPONSE)
  6202*    END-EXEC.
  6203     MOVE 'ELLETR' TO DFHEIV1
  6204     MOVE 0
  6205       TO DFHEIV11
  6206*    MOVE '&,         G          &  N#00006159' TO DFHEIV0
  6207     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6208     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6209     MOVE X'204E233030303036313539' TO DFHEIV0(25:11)
  6210     CALL 'kxdfhei1' USING DFHEIV0,
  6211           DFHEIV1,
  6212           ELLETR-KEY,
  6213           DFHEIV99,
  6214           DFHEIV11,
  6215           DFHEIV99
  6216     MOVE EIBRESP  TO WS-RESPONSE
  6217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6218
  6219     IF NOT RESP-NORMAL
  6220         MOVE ER-1236          TO EMI-ERROR
  6221         MOVE -1               TO LTRIDL
  6222         MOVE AL-UABON         TO LTRIDA
  6223         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6224         GO TO 0326-ENDBR
  6225     END-IF.
  6226
  6227 0326-READNEXT.
  6228
  6229
  6230* EXEC CICS READNEXT
  6231*        DATASET   ('ELLETR')
  6232*        INTO      (TEXT-FILES)
  6233*        RIDFLD    (ELLETR-KEY)
  6234*        RESP      (WS-RESPONSE)
  6235*    END-EXEC
  6236     MOVE LENGTH OF
  6237      TEXT-FILES
  6238       TO DFHEIV12
  6239     MOVE 'ELLETR' TO DFHEIV1
  6240     MOVE 0
  6241       TO DFHEIV11
  6242*    MOVE '&.IL                  )  N#00006175' TO DFHEIV0
  6243     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6244     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6245     MOVE X'204E233030303036313735' TO DFHEIV0(25:11)
  6246     CALL 'kxdfhei1' USING DFHEIV0,
  6247           DFHEIV1,
  6248           TEXT-FILES,
  6249           DFHEIV12,
  6250           ELLETR-KEY,
  6251           DFHEIV99,
  6252           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 110
* EL6318.cbl
  6253           DFHEIV99,
  6254           DFHEIV99
  6255     MOVE EIBRESP  TO WS-RESPONSE
  6256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6257     IF RESP-NORMAL
  6258        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  6259           MOVE ER-1236          TO EMI-ERROR
  6260           MOVE -1               TO LTRIDL
  6261           MOVE AL-UABON         TO LTRIDA
  6262           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6263           GO TO 0326-ENDBR
  6264        END-IF
  6265
  6266        MOVE AL-UANON         TO LTRIDA
  6267        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  6268           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  6269        ELSE
  6270           GO TO 0326-READNEXT
  6271        END-IF
  6272     ELSE
  6273        MOVE ER-1236          TO EMI-ERROR
  6274        MOVE -1               TO LTRIDL
  6275        MOVE AL-UABON         TO LTRIDA
  6276        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6277        GO TO 0326-ENDBR
  6278     END-IF.
  6279
  6280     MOVE W-PRINT-CERTIFICATE TO PI-PRINT-CERTIFICATE.
  6281     IF PI-ENCCODE NOT GREATER THAN SPACES
  6282         MOVE W-ENCLOSURE-CD            TO PI-ENCCODE
  6283                                           ENCCODEO
  6284         MOVE AL-UANON                  TO ENCCODEA
  6285         MOVE +3                        TO ENCCODEL
  6286     END-IF.
  6287
  6288 0326-ENDBR.
  6289
  6290
  6291* EXEC CICS ENDBR
  6292*        DATASET     ('ELLETR')
  6293*    END-EXEC.
  6294     MOVE 'ELLETR' TO DFHEIV1
  6295     MOVE 0
  6296       TO DFHEIV11
  6297*    MOVE '&2                    $   #00006214' TO DFHEIV0
  6298     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6299     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6300     MOVE X'2020233030303036323134' TO DFHEIV0(25:11)
  6301     CALL 'kxdfhei1' USING DFHEIV0,
  6302           DFHEIV1,
  6303           DFHEIV11,
  6304           DFHEIV99
  6305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6306
  6307
  6308 0326-EXIT.
  6309      EXIT.
  6310 0330-CHECK-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 111
* EL6318.cbl
  6311     IF EMI-NO-ERRORS
  6312        GO TO 0350-BUILD-INIT-MAP
  6313     ELSE
  6314        GO TO 8200-SEND-DATAONLY
  6315     END-IF
  6316     .
  6317 0330-EXIT.
  6318     EXIT.
  6319 0350-BUILD-INIT-MAP.
  6320     IF PI-RETURN-TO-PROGRAM = 'EL6314'
  6321        MOVE PI-COMPANY-CD          TO CRTO-COMPANY-CD
  6322        MOVE PI-CARRIER             TO CRTO-CARRIER
  6323        MOVE PI-GROUPING            TO CRTO-GROUPING
  6324        MOVE PI-STATE               TO CRTO-STATE
  6325        MOVE PI-ACCOUNT             TO CRTO-ACCOUNT
  6326        MOVE PI-CERT-PRIME          TO CRTO-CERT-PRIME
  6327        MOVE PI-CERT-SFX            TO CRTO-CERT-SFX
  6328        MOVE PI-CERT-EFF-DT         TO CRTO-CERT-EFF-DT
  6329        MOVE 'I'                    TO CRTO-RECORD-TYPE
  6330        MOVE ZEROS                  TO CRTO-SEQ-NO
  6331        MOVE ELCRTO-KEY             TO PI-ELCRTO-KEY
  6332                                       PI-ERENDT-KEY
  6333     END-IF
  6334     MOVE PI-CRTO-CARRIER        TO CARRO
  6335     MOVE PI-CRTO-GROUPING       TO GROUPO
  6336     MOVE PI-CRTO-STATE          TO STATEO
  6337     MOVE PI-CRTO-ACCOUNT        TO ACCTO
  6338     MOVE PI-CRTO-CERT-PRIME     TO CERTNOO
  6339     MOVE PI-CRTO-CERT-SFX       TO CRTSFXO
  6340     MOVE PI-CRTO-SEQ-NO         TO SEQNOO
  6341     MOVE PI-CRTO-CERT-EFF-DT    TO DC-BIN-DATE-1
  6342     MOVE ' '                    TO DC-OPTION-CODE
  6343     PERFORM 9700-DATE-LINK
  6344     IF NO-CONVERSION-ERROR
  6345        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6346     END-IF
  6347*     IF PI-PRTSW-ENTERED > SPACES
  6348*        MOVE PI-PRTSW-ENTERED    TO PRTSWI
  6349*        MOVE AL-UANON            TO PRTSWA
  6350*        MOVE +1                  TO PRTSWL
  6351*     END-IF
  6352
  6353     IF PI-SIGREQ-ENTERED > SPACES
  6354        MOVE PI-SIGREQ-ENTERED   TO SIGREQI
  6355        MOVE AL-UANON            TO SIGREQA
  6356        MOVE +1                  TO SIGREQL
  6357     ELSE
  6358        IF PI-CLAIM-REFORMATION
  6359            MOVE 'Y'             TO SIGREQI
  6360            MOVE AL-UANON        TO SIGREQA
  6361            MOVE +1              TO SIGREQL
  6362        END-IF
  6363     END-IF
  6364
  6365     IF PI-LTRID-ENTERED > SPACES
  6366        MOVE PI-LTRID-ENTERED    TO LTRIDI
  6367        MOVE AL-UANON            TO LTRIDA
  6368        MOVE +4                  TO LTRIDL
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 112
* EL6318.cbl
  6369     ELSE
  6370        IF PI-CLAIM-REFORMATION
  6371            MOVE 'CLRF'          TO LTRIDI
  6372            MOVE AL-UANON        TO LTRIDA
  6373            MOVE +4              TO LTRIDL
  6374        END-IF
  6375     END-IF
  6376
  6377     if pi-endt-prm-diff > zeros
  6378        move 'Y'                 to vouchi
  6379        MOVE AL-UANON            TO VOUCHA
  6380        MOVE +1                  TO VOUCHL
  6381     END-IF
  6382     IF PI-VOUCHER-ENTERED > SPACES
  6383        MOVE PI-VOUCHER-ENTERED  TO VOUCHI
  6384        MOVE AL-UANON            TO VOUCHA
  6385        MOVE +1                  TO VOUCHL
  6386     END-IF
  6387     IF PI-HLTHAPP-ENTERED > SPACES
  6388        MOVE PI-HLTHAPP-ENTERED  TO HLTHAPPI
  6389        MOVE AL-UANON            TO HLTHAPPA
  6390        MOVE +1                  TO HLTHAPPL
  6391     END-IF
  6392
  6393     IF PI-PAYEE-ENTERED > SPACES
  6394        MOVE PI-PAYEE-ENTERED    TO PAYEEI
  6395        MOVE AL-UANON            TO PAYEEA
  6396        MOVE +10                 TO PAYEEL
  6397     END-IF
  6398
  6399     IF PI-CERTID-ENTERED > SPACES
  6400        MOVE PI-CERTID-ENTERED   TO CERTIDI
  6401        MOVE AL-UANON            TO CERTIDA
  6402        MOVE +5                  TO CERTIDL
  6403     END-IF
  6404
  6405     IF PI-ENCCODE > SPACES
  6406        MOVE PI-ENCCODE          TO ENCCODEI
  6407        MOVE AL-UANON            TO ENCCODEA
  6408        MOVE +3                  TO ENCCODEL
  6409     END-IF
  6410
  6411     SET REASONS-NOT-FOUND TO TRUE
  6412     MOVE PI-REASONS-ENTERED     TO REASONCDS
  6413     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6414        IF REACDL (S1) = +4 OR
  6415          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6416              MOVE AL-SANON      TO REACDA (S1)
  6417              MOVE +4            TO REACDL (S1)
  6418              SET REASONS-FOUND  TO TRUE
  6419        END-IF
  6420     END-PERFORM
  6421
  6422     IF REASONS-NOT-FOUND
  6423         IF PI-CLAIM-REFORMATION
  6424            MOVE 'CRNA'          TO REACD-IN (1)
  6425            MOVE AL-SANON        TO REACDA (1)
  6426            MOVE +4              TO REACDL (1)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 113
* EL6318.cbl
  6427            SET REASONS-FOUND    TO TRUE
  6428        END-IF
  6429     END-IF
  6430
  6431     IF PI-CERTNT1-ENTERED > SPACES
  6432        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6433        MOVE AL-UANON            TO CRTNT1A
  6434        MOVE +63                 TO CRTNT1L
  6435     END-IF
  6436
  6437     IF PI-CERTNT2-ENTERED > SPACES
  6438        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  6439        MOVE AL-UANON            TO CRTNT2A
  6440        MOVE +63                 TO CRTNT2L
  6441     END-IF
  6442
  6443     IF PI-CERTNT3-ENTERED > SPACES
  6444        MOVE PI-CERTNT3-ENTERED  TO CRTNT3I
  6445        MOVE AL-UANON            TO CRTNT3A
  6446        MOVE +63                 TO CRTNT3L
  6447     END-IF
  6448
  6449     IF PI-CERTNT4-ENTERED > SPACES
  6450        MOVE PI-CERTNT4-ENTERED  TO CRTNT4I
  6451        MOVE AL-UANON            TO CRTNT4A
  6452        MOVE +63                 TO CRTNT4L
  6453     END-IF
  6454
  6455     IF PI-BILLNT1-ENTERED > SPACES
  6456        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  6457        MOVE AL-UANON            TO BILNT1A
  6458        MOVE +63                 TO BILNT1L
  6459     END-IF
  6460
  6461     IF PI-BILLNT2-ENTERED > SPACES
  6462        MOVE PI-BILLNT2-ENTERED  TO BILNT2I
  6463        MOVE AL-UANON            TO BILNT2A
  6464        MOVE +63                 TO BILNT2L
  6465     END-IF
  6466
  6467     GO TO 8100-SEND-INITIAL-MAP
  6468     .
  6469 0360-FINALIZE.
  6470     set P to address of KIXSYS
  6471     CALL "getenv" using by value P returning var-ptr
  6472     if var-ptr = null then
  6473        display ' kixsys not set '
  6474     else
  6475        set address of var to var-ptr
  6476        move 0 to env-var-len
  6477        inspect var tallying env-var-len
  6478          for characters before X'00'
  6479*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  6480        unstring var (1:env-var-len) delimited by '/'
  6481           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  6482              WS-KIX-SYS
  6483        end-unstring
  6484*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 114
* EL6318.cbl
  6485*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  6486     end-if
  6487     set P to address of KIXHOST
  6488     CALL "getenv" using by value P returning var-ptr
  6489     if var-ptr = null then
  6490        display ' kixhost not set '
  6491     else
  6492        set address of var to var-ptr
  6493        move 0 to env-var-len
  6494        inspect var tallying env-var-len
  6495          for characters before X'00'
  6496*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  6497        MOVE var(1:env-var-len)  to ws-kixhost
  6498        DISPLAY ' WS KIX HOST ' WS-KIXhost
  6499     end-if
  6500     PERFORM 0325-EDIT-SCREEN    THRU 0325-EXIT
  6501     IF NOT EMI-NO-ERRORS
  6502       AND EIBAID = DFHPF4
  6503        GO TO 8200-SEND-DATAONLY
  6504     END-IF
  6505     MOVE LOW-VALUES             TO NEW-ELCRTO-REC
  6506     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  6507                                    NEW-ELCRTO-KEY
  6508     SUBTRACT +1               FROM NCRTO-SEQ-NO
  6509     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  6510     IF RESP-NORMAL
  6511       AND (PI-ELCRTO-KEY (1:33) = OC-CONTROL-PRIMARY (1:33))
  6512        MOVE OC-KEY-SEQ-NO       TO CRTO-SEQ-NO
  6513                                    PI-CRTO-SEQ-NO
  6514        MOVE LOW-VALUES          TO NEW-ELCRTO-REC
  6515        MOVE PI-ELCRTO-KEY       TO NEW-ELCRTO-KEY
  6516        SUBTRACT +1              FROM NCRTO-SEQ-NO
  6517        PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  6518*       PERFORM 1000-BUILD-ERARCH THRU 1000-EXIT
  6519        PERFORM 1100-CALL-NS-BUS-LOGIC
  6520                                 THRU 1100-EXIT
  6521        IF BL-OK
  6522           CONTINUE
  6523        ELSE
  6524           MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  6525           MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  6526           MOVE -1               TO SIGREQL
  6527        END-IF
  6528     ELSE
  6529        MOVE ER-9999             TO EMI-ERROR
  6530        PERFORM 9900-ERROR-FORMAT
  6531                                 THRU 9900-EXIT
  6532        MOVE -1                  TO SIGREQL
  6533        GO TO 8100-SEND-INITIAL-MAP
  6534     END-IF
  6535     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  6536                                 TO SYSO
  6537     MOVE WS-KIXHOST             TO HOSTO
  6538     MOVE PI-COMPANY-ID          TO COMPANYO
  6539     IF PI-RETURN-TO-PROGRAM = 'EL6314'
  6540         MOVE '2'                TO DATASORO
  6541     ELSE
  6542         MOVE '4'                TO DATASORO
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 115
* EL6318.cbl
  6543     END-IF
  6544     MOVE BL-BATCH-NO            TO BATCHNOO
  6545     MOVE BL-BATCH-SEQ           TO BSEQNOO
  6546     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  6547     MOVE PI-PROCESSOR-ID        TO PROCIDO
  6548*    MOVE 'N'                    TO PRTSWO
  6549*    MOVE -1                     TO PRTSWL
  6550*    MOVE AL-UANON               TO PRTSWA
  6551     MOVE -1                     TO SIGREQL
  6552     MOVE AL-UANON               TO SIGREQA
  6553     IF EIBAID = DFHPF4
  6554        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  6555        MOVE ER-0280             TO EMI-ERROR
  6556        PERFORM 9900-ERROR-FORMAT
  6557                                 THRU 9900-EXIT
  6558        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  6559        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  6560        MOVE 'Y'                 TO PI-FINALIZED-IND
  6561        GO TO 9400-CLEAR
  6562     ELSE
  6563        MOVE ER-1818             TO EMI-ERROR
  6564        PERFORM 9900-ERROR-FORMAT
  6565                                 THRU 9900-EXIT
  6566     END-IF
  6567     GO TO 0350-BUILD-INIT-MAP
  6568     .
  6569 0360-EXIT.
  6570     EXIT.
  6571 0362-READ-ELCRTO.
  6572
  6573* EXEC CICS READ
  6574*        DATASET   (WS-ELCRTO-FILE-ID)
  6575*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6576*        RIDFLD    (ELCRTO-KEY)
  6577*        GTEQ
  6578*        RESP      (WS-RESPONSE)
  6579*    END-EXEC
  6580*    MOVE '&"S        G          (  N#00006482' TO DFHEIV0
  6581     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6582     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6583     MOVE X'204E233030303036343832' TO DFHEIV0(25:11)
  6584     CALL 'kxdfhei1' USING DFHEIV0,
  6585           WS-ELCRTO-FILE-ID,
  6586           DFHEIV20,
  6587           DFHEIV99,
  6588           ELCRTO-KEY,
  6589           DFHEIV99,
  6590           DFHEIV99,
  6591           DFHEIV99
  6592     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6593         DFHEIV20
  6594     MOVE EIBRESP  TO WS-RESPONSE
  6595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6596     .
  6597 0362-EXIT.
  6598     EXIT.
  6599 0363-READ-ELCRTO-UPD.
  6600
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 116
* EL6318.cbl
  6601* EXEC CICS READ
  6602*        DATASET   (WS-ELCRTO-FILE-ID)
  6603*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6604*        RIDFLD    (ELCRTO-KEY)
  6605*        UPDATE
  6606*        RESP      (WS-RESPONSE)
  6607*    END-EXEC
  6608*    MOVE '&"S        EU         (  N#00006493' TO DFHEIV0
  6609     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6610     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6611     MOVE X'204E233030303036343933' TO DFHEIV0(25:11)
  6612     CALL 'kxdfhei1' USING DFHEIV0,
  6613           WS-ELCRTO-FILE-ID,
  6614           DFHEIV20,
  6615           DFHEIV99,
  6616           ELCRTO-KEY,
  6617           DFHEIV99,
  6618           DFHEIV99,
  6619           DFHEIV99
  6620     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6621         DFHEIV20
  6622     MOVE EIBRESP  TO WS-RESPONSE
  6623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6624     .
  6625 0363-EXIT.
  6626     EXIT.
  6627 0365-READ-ERENDT.
  6628
  6629* EXEC CICS READ
  6630*        DATASET   (WS-ERENDT-FILE-ID)
  6631*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  6632*        RIDFLD    (ERENDT-KEY)
  6633*        RESP      (WS-RESPONSE)
  6634*    END-EXEC
  6635*    MOVE '&"S        E          (  N#00006504' TO DFHEIV0
  6636     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6637     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6638     MOVE X'204E233030303036353034' TO DFHEIV0(25:11)
  6639     CALL 'kxdfhei1' USING DFHEIV0,
  6640           WS-ERENDT-FILE-ID,
  6641           DFHEIV20,
  6642           DFHEIV99,
  6643           ERENDT-KEY,
  6644           DFHEIV99,
  6645           DFHEIV99,
  6646           DFHEIV99
  6647     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6648         DFHEIV20
  6649     MOVE EIBRESP  TO WS-RESPONSE
  6650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6651     .
  6652 0365-EXIT.
  6653     EXIT.
  6654 0400-ADD-ERENDT.
  6655     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6656
  6657* EXEC CICS GETMAIN
  6658*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 117
* EL6318.cbl
  6659*         LENGTH   (ERENDT-LENGTH)
  6660*         INITIMG  (GETMAIN-SPACE)
  6661*    END-EXEC
  6662*    MOVE ',"IL                  $   #00006515' TO DFHEIV0
  6663     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6664     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6665     MOVE X'2020233030303036353135' TO DFHEIV0(25:11)
  6666     CALL 'kxdfhei1' USING DFHEIV0,
  6667           DFHEIV20,
  6668           ERENDT-LENGTH,
  6669           GETMAIN-SPACE
  6670     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6671         DFHEIV20
  6672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6673     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6674     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6675     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6676     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6677                                    EN-INPUT-DT
  6678                                    EN-PROCESS-DT
  6679
  6680     MOVE OC-INS-FIRST-NAME    TO EN-INS-ORIG-FIRST-NAME
  6681     MOVE OC-INS-MIDDLE-INIT   TO EN-INS-ORIG-MIDDLE-INIT
  6682     MOVE OC-INS-LAST-NAME     TO EN-INS-ORIG-LAST-NAME
  6683     MOVE OC-INS-AGE           TO EN-INS-ORIG-AGE
  6684     MOVE OC-INS-AGE-DEFAULT-FLAG TO EN-INS-ORIG-AGE-DEF-FLAG
  6685     MOVE OC-JNT-FIRST-NAME    TO EN-JNT-ORIG-FIRST-NAME
  6686     MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-ORIG-MIDDLE-INIT
  6687     MOVE OC-JNT-LAST-NAME     TO EN-JNT-ORIG-LAST-NAME
  6688     MOVE OC-JNT-AGE           TO EN-JNT-ORIG-AGE
  6689     MOVE OC-JNT-AGE-DEFAULT-FLAG TO EN-JNT-ORIG-AGE-DEF-FLAG
  6690     MOVE OC-LF-BENCD          TO EN-LF-ORIG-BENCD
  6691     IF OC-LF-BENCD NOT = '00' AND '  '
  6692        MOVE OC-LF-BEN-AMT       TO EN-LF-ORIG-BEN-AMT
  6693        MOVE OC-LF-PRM-AMT       TO EN-LF-ORIG-PRM-AMT
  6694        MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-ORIG-ALT-BEN-AMT
  6695        MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-ORIG-ALT-PRM-AMT
  6696        MOVE OC-LF-TERM          TO EN-LF-ORIG-TERM
  6697        MOVE OC-LF-EXP-DT        TO EN-LF-ORIG-EXP-DT
  6698        MOVE OC-LF-COMM-PCT      TO EN-LF-ORIG-COMM-PCT
  6699     END-IF
  6700     MOVE OC-AH-BENCD          TO EN-AH-ORIG-BENCD
  6701     IF OC-AH-BENCD NOT = '00' AND '  '
  6702        MOVE OC-AH-BEN-AMT       TO EN-AH-ORIG-BEN-AMT
  6703        MOVE OC-AH-PRM-AMT       TO EN-AH-ORIG-PRM-AMT
  6704        MOVE OC-AH-TERM          TO EN-AH-ORIG-TERM
  6705        MOVE OC-AH-EXP-DT        TO EN-AH-ORIG-EXP-DT
  6706        MOVE OC-AH-CP            TO EN-AH-ORIG-CP
  6707        MOVE OC-AH-COMM-PCT      TO EN-AH-ORIG-COMM-PCT
  6708     END-IF
  6709     MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6710
  6711     IF PI-RETURN-TO-PROGRAM EQUAL 'EL6314'
  6712
  6713         MOVE PI-COMPANY-CD       TO  W-CERT-COMPANY-CD
  6714         MOVE PI-CRTO-CARRIER     TO  W-CERT-CARRIER
  6715         MOVE PI-CRTO-GROUPING    TO  W-CERT-GROUPING
  6716         MOVE PI-CRTO-STATE       TO  W-CERT-STATE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 118
* EL6318.cbl
  6717         MOVE PI-CRTO-ACCOUNT     TO  W-CERT-ACCOUNT
  6718         MOVE PI-CRTO-CERT-EFF-DT TO  W-CERT-CERT-EFF-DT
  6719         MOVE PI-CRTO-CERT-PRIME  TO  W-CERT-CERT-PRIME
  6720         MOVE PI-CRTO-CERT-SFX    TO  W-CERT-CERT-SFX
  6721
  6722
  6723* EXEC CICS READ
  6724*            DATASET  (WS-ELCERT-FILE-ID)
  6725*            RIDFLD   (WS-ELCERT-KEY)
  6726*            SET      (ADDRESS OF CERTIFICATE-MASTER)
  6727*            RESP     (WS-RESPONSE)
  6728*        END-EXEC
  6729*    MOVE '&"S        E          (  N#00006569' TO DFHEIV0
  6730     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6731     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6732     MOVE X'204E233030303036353639' TO DFHEIV0(25:11)
  6733     CALL 'kxdfhei1' USING DFHEIV0,
  6734           WS-ELCERT-FILE-ID,
  6735           DFHEIV20,
  6736           DFHEIV99,
  6737           WS-ELCERT-KEY,
  6738           DFHEIV99,
  6739           DFHEIV99,
  6740           DFHEIV99
  6741     SET ADDRESS OF CERTIFICATE-MASTER TO
  6742         DFHEIV20
  6743     MOVE EIBRESP  TO WS-RESPONSE
  6744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6745         IF NOT RESP-NORMAL
  6746            GO TO 0400-EXIT
  6747         END-IF
  6748
  6749         MOVE CM-INSURED-FIRST-NAME TO EN-INS-NEW-FIRST-NAME
  6750                                       NCRTO-INS-FIRST-NAME
  6751         MOVE CM-INSURED-INITIAL2   TO EN-INS-NEW-MIDDLE-INIT
  6752                                       NCRTO-INS-MIDDLE-INIT
  6753         MOVE CM-INSURED-LAST-NAME  TO EN-INS-NEW-LAST-NAME
  6754                                       NCRTO-INS-LAST-NAME
  6755         MOVE CM-INSURED-ISSUE-AGE  TO EN-INS-NEW-AGE
  6756                                       NCRTO-INS-AGE
  6757         MOVE CM-JT-FIRST-NAME      TO EN-JNT-NEW-FIRST-NAME
  6758                                       NCRTO-JNT-FIRST-NAME
  6759         MOVE CM-JT-INITIAL         TO EN-JNT-NEW-MIDDLE-INIT
  6760                                       NCRTO-JNT-MIDDLE-INIT
  6761         MOVE CM-JT-LAST-NAME       TO EN-JNT-NEW-LAST-NAME
  6762                                       NCRTO-JNT-LAST-NAME
  6763         MOVE CM-INSURED-JOINT-AGE  TO EN-JNT-NEW-AGE
  6764                                       NCRTO-JNT-AGE
  6765
  6766         MOVE CM-LF-BENEFIT-CD      TO EN-LF-NEW-BENCD
  6767                                       NCRTO-LF-BENCD
  6768         IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  6769            MOVE CM-LF-BENEFIT-AMT  TO EN-LF-NEW-BEN-AMT
  6770                                       NCRTO-LF-BEN-AMT
  6771            MOVE CM-LF-PREMIUM-AMT  TO EN-LF-NEW-PRM-AMT
  6772                                       NCRTO-LF-PRM-AMT
  6773            MOVE CM-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  6774                                       NCRTO-LF-ALT-BEN-AMT
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 119
* EL6318.cbl
  6775            MOVE CM-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
  6776                                       NCRTO-LF-ALT-PRM-AMT
  6777            MOVE CM-LF-ORIG-TERM    TO EN-LF-NEW-TERM
  6778                                       NCRTO-LF-TERM
  6779            MOVE CM-LF-LOAN-EXPIRE-DT TO EN-LF-NEW-EXP-DT
  6780                                       NCRTO-LF-EXP-DT
  6781            MOVE CM-LIFE-COMM-PCT   TO EN-LF-NEW-COMM-PCT
  6782                                       NCRTO-LF-COMM-PCT
  6783         END-IF
  6784
  6785         MOVE CM-AH-BENEFIT-CD      TO EN-AH-NEW-BENCD
  6786                                       NCRTO-AH-BENCD
  6787         IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  6788            MOVE CM-AH-BENEFIT-AMT  TO EN-AH-NEW-BEN-AMT
  6789                                       NCRTO-AH-BEN-AMT
  6790            MOVE CM-AH-PREMIUM-AMT  TO EN-AH-NEW-PRM-AMT
  6791                                       NCRTO-AH-PRM-AMT
  6792            MOVE CM-AH-ORIG-TERM    TO EN-AH-NEW-TERM
  6793                                       NCRTO-AH-TERM
  6794            MOVE CM-AH-LOAN-EXPIRE-DT TO EN-AH-NEW-EXP-DT
  6795                                       NCRTO-AH-EXP-DT
  6796            MOVE CM-AH-CRITICAL-PERIOD TO EN-AH-NEW-CP
  6797                                       NCRTO-AH-CP
  6798            MOVE CM-AH-COMM-PCT     TO EN-AH-NEW-COMM-PCT
  6799                                       NCRTO-AH-COMM-PCT
  6800         END-IF
  6801
  6802         MOVE CM-LOAN-1ST-PMT-DT    TO NCRTO-1ST-PMT-DT
  6803         MOVE CM-ENTRY-BATCH        TO EN-BATCH-NUMBER
  6804
  6805         GO TO 0400-CONTINUE
  6806     END-IF.
  6807
  6808
  6809* EXEC CICS GETMAIN
  6810*         SET      (ADDRESS OF PENDING-BUSINESS)
  6811*         LENGTH   (ERPNDB-LENGTH)
  6812*         INITIMG  (GETMAIN-SPACE)
  6813*    END-EXEC
  6814*    MOVE ',"IL                  $   #00006638' TO DFHEIV0
  6815     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6816     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6817     MOVE X'2020233030303036363338' TO DFHEIV0(25:11)
  6818     CALL 'kxdfhei1' USING DFHEIV0,
  6819           DFHEIV20,
  6820           ERPNDB-LENGTH,
  6821           GETMAIN-SPACE
  6822     SET ADDRESS OF PENDING-BUSINESS TO
  6823         DFHEIV20
  6824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6825     MOVE PI-ERPNDB-KEY          TO ERPNDB-KEY
  6826
  6827* EXEC CICS READ
  6828*        DATASET   (WS-ERPNDB-FILE-ID)
  6829*        INTO      (PENDING-BUSINESS)
  6830*        RIDFLD    (ERPNDB-KEY)
  6831*        RESP      (WS-RESPONSE)
  6832*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 120
* EL6318.cbl
  6833     MOVE LENGTH OF
  6834      PENDING-BUSINESS
  6835       TO DFHEIV11
  6836*    MOVE '&"IL       E          (  N#00006644' TO DFHEIV0
  6837     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6838     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6839     MOVE X'204E233030303036363434' TO DFHEIV0(25:11)
  6840     CALL 'kxdfhei1' USING DFHEIV0,
  6841           WS-ERPNDB-FILE-ID,
  6842           PENDING-BUSINESS,
  6843           DFHEIV11,
  6844           ERPNDB-KEY,
  6845           DFHEIV99,
  6846           DFHEIV99,
  6847           DFHEIV99
  6848     MOVE EIBRESP  TO WS-RESPONSE
  6849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6850     IF NOT RESP-NORMAL
  6851        GO TO 0400-EXIT
  6852     END-IF
  6853*    set found-pndb to true
  6854     MOVE PB-I-INSURED-FIRST-NAME  TO EN-INS-NEW-FIRST-NAME
  6855                                      NCRTO-INS-FIRST-NAME
  6856     MOVE PB-I-INSURED-MIDDLE-INIT TO EN-INS-NEW-MIDDLE-INIT
  6857                                      NCRTO-INS-MIDDLE-INIT
  6858     MOVE PB-I-INSURED-LAST-NAME   TO EN-INS-NEW-LAST-NAME
  6859                                      NCRTO-INS-LAST-NAME
  6860     MOVE PB-I-AGE                 TO EN-INS-NEW-AGE
  6861                                      NCRTO-INS-AGE
  6862     MOVE PB-I-JOINT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  6863                                      NCRTO-JNT-FIRST-NAME
  6864     MOVE PB-I-JOINT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6865                                      NCRTO-JNT-MIDDLE-INIT
  6866     MOVE PB-I-JOINT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
  6867                                      NCRTO-JNT-LAST-NAME
  6868     MOVE PB-I-JOINT-AGE           TO EN-JNT-NEW-AGE
  6869                                      NCRTO-JNT-AGE
  6870     MOVE PB-I-LF-BENEFIT-CD       TO EN-LF-NEW-BENCD
  6871                                      NCRTO-LF-BENCD
  6872     IF PB-I-LF-BENEFIT-CD NOT = '00' AND '  '
  6873        MOVE PB-I-LF-BENEFIT-AMT   TO EN-LF-NEW-BEN-AMT
  6874                                      NCRTO-LF-BEN-AMT
  6875        MOVE PB-I-LF-PREMIUM-AMT   TO EN-LF-NEW-PRM-AMT
  6876                                      NCRTO-LF-PRM-AMT
  6877        MOVE PB-I-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  6878                                      NCRTO-LF-ALT-BEN-AMT
  6879        MOVE PB-I-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
  6880                                      NCRTO-LF-ALT-PRM-AMT
  6881        MOVE PB-I-LF-TERM          TO EN-LF-NEW-TERM
  6882                                      NCRTO-LF-TERM
  6883        MOVE PB-I-LF-EXPIRE-DT     TO EN-LF-NEW-EXP-DT
  6884                                      NCRTO-LF-EXP-DT
  6885        IF PB-I-JOINT-COMMISSION > +0
  6886           MOVE PB-I-JOINT-COMMISSION
  6887                                   TO EN-LF-NEW-COMM-PCT
  6888                                      NCRTO-LF-COMM-PCT
  6889        ELSE
  6890           MOVE PB-I-LIFE-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 121
* EL6318.cbl
  6891                                   TO EN-LF-NEW-COMM-PCT
  6892                                      NCRTO-LF-COMM-PCT
  6893        END-IF
  6894     END-IF
  6895     MOVE PB-I-AH-BENEFIT-CD       TO EN-AH-NEW-BENCD
  6896                                      NCRTO-AH-BENCD
  6897     IF PB-I-AH-BENEFIT-CD NOT = '00' AND '  '
  6898        MOVE PB-I-AH-BENEFIT-AMT   TO EN-AH-NEW-BEN-AMT
  6899                                      NCRTO-AH-BEN-AMT
  6900        MOVE PB-I-AH-PREMIUM-AMT   TO EN-AH-NEW-PRM-AMT
  6901                                      NCRTO-AH-PRM-AMT
  6902        MOVE PB-I-AH-TERM          TO EN-AH-NEW-TERM
  6903                                      NCRTO-AH-TERM
  6904        MOVE PB-I-AH-EXPIRE-DT     TO EN-AH-NEW-EXP-DT
  6905                                      NCRTO-AH-EXP-DT
  6906        MOVE PB-I-AH-CRIT-PER      TO EN-AH-NEW-CP
  6907                                      NCRTO-AH-CP
  6908        MOVE PB-I-AH-COMMISSION    TO EN-AH-NEW-COMM-PCT
  6909                                      NCRTO-AH-COMM-PCT
  6910     END-IF
  6911     MOVE PB-I-1ST-PMT-DT          TO NCRTO-1ST-PMT-DT
  6912     MOVE PB-ENTRY-BATCH           TO EN-BATCH-NUMBER
  6913     .
  6914 0400-CONTINUE.
  6915
  6916     MOVE W-ACCT-SUMM              TO EN-ACCT-SUMM
  6917     MOVE W-CSO-SUMM               TO EN-CSO-SUMM
  6918*     PERFORM 0450-GET-ERACCT     THRU 0450-EXIT
  6919     MOVE 'Y'                    TO EN-COMM-CHGBK
  6920
  6921     COMPUTE WS-DUE-BORROWER = (EN-LF-ORIG-PRM-AMT
  6922        + EN-LF-ORIG-ALT-PRM-AMT + EN-AH-ORIG-PRM-AMT) -
  6923        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  6924        EN-AH-NEW-PRM-AMT)
  6925     COMPUTE EN-ACCT-PORTION ROUNDED =
  6926        (((EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  6927        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT))
  6928        * EN-LF-NEW-COMM-PCT)
  6929                       +
  6930        ((EN-AH-ORIG-PRM-AMT - EN-AH-NEW-PRM-AMT)
  6931        * EN-AH-NEW-COMM-PCT)
  6932     COMPUTE EN-CSO-PORTION = WS-DUE-BORROWER -
  6933        EN-ACCT-PORTION
  6934     IF PI-RETURN-TO-PROGRAM = 'EL6314'
  6935         MOVE CM-CONTROL-PRIMARY TO WS-ERMAIL-KEY
  6936     ELSE
  6937     move pb-control-by-account (1:33)
  6938                                 to ws-ermail-key
  6939     END-IF
  6940
  6941
  6942* EXEC CICS READ
  6943*        DATASET   ('ERMAIL')
  6944*        SET       (ADDRESS OF MAILING-DATA)
  6945*        RIDFLD    (WS-ERMAIL-KEY)
  6946*        RESP      (WS-RESPONSE)
  6947*    END-EXEC
  6948     MOVE 'ERMAIL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 122
* EL6318.cbl
  6949*    MOVE '&"S        E          (  N#00006741' TO DFHEIV0
  6950     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6951     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6952     MOVE X'204E233030303036373431' TO DFHEIV0(25:11)
  6953     CALL 'kxdfhei1' USING DFHEIV0,
  6954           DFHEIV1,
  6955           DFHEIV20,
  6956           DFHEIV99,
  6957           WS-ERMAIL-KEY,
  6958           DFHEIV99,
  6959           DFHEIV99,
  6960           DFHEIV99
  6961     SET ADDRESS OF MAILING-DATA TO
  6962         DFHEIV20
  6963     MOVE EIBRESP  TO WS-RESPONSE
  6964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6965     IF RESP-NORMAL
  6966        MOVE MA-CRED-BENE-NAME   TO EN-NEW-CRED-BENE
  6967                                    NCRTO-CRED-BENE-NAME
  6968     ELSE
  6969        DISPLAY ' ERMAIL READ ' WS-RESPONSE
  6970     END-IF
  6971
  6972     IF PI-RETURN-TO-PROGRAM = 'EL6314'
  6973         MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
  6974     ELSE
  6975     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
  6976     END-IF
  6977
  6978     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
  6979
  6980
  6981* EXEC CICS READ
  6982*         DATASET  (WS-ELCRTT-FILE-ID)
  6983*         RIDFLD   (WS-ELCRTT-KEY)
  6984*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  6985*         RESP     (WS-RESPONSE)
  6986*    END-EXEC
  6987*    MOVE '&"S        E          (  N#00006762' TO DFHEIV0
  6988     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6989     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6990     MOVE X'204E233030303036373632' TO DFHEIV0(25:11)
  6991     CALL 'kxdfhei1' USING DFHEIV0,
  6992           WS-ELCRTT-FILE-ID,
  6993           DFHEIV20,
  6994           DFHEIV99,
  6995           WS-ELCRTT-KEY,
  6996           DFHEIV99,
  6997           DFHEIV99,
  6998           DFHEIV99
  6999     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  7000         DFHEIV20
  7001     MOVE EIBRESP  TO WS-RESPONSE
  7002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7003
  7004     IF RESP-NORMAL
  7005        MOVE CS-INS-AGE-DEFAULT-FLAG TO EN-INS-NEW-AGE-DEF-FLAG
  7006                                     NCRTO-INS-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 123
* EL6318.cbl
  7007        MOVE CS-JNT-AGE-DEFAULT-FLAG TO EN-JNT-NEW-AGE-DEF-FLAG
  7008                                     NCRTO-JNT-AGE-DEFAULT-FLAG
  7009     END-IF.
  7010     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  7011        IF REACD-IN (S1) NOT = LOW-VALUES
  7012           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  7013        END-IF
  7014     END-PERFORM
  7015     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  7016     MOVE 'G'                    TO EN-DOCU-TYPE
  7017     MOVE 'Y'                    TO EN-MONEY-SW
  7018     MOVE SIGREQI                TO EN-SIG-SW
  7019     MOVE VOUCHI                 TO EN-VOUCHER-SW
  7020     MOVE PAYEEI                 TO EN-PAYEE
  7021     MOVE HLTHAPPI               TO EN-HEALTH-APP
  7022     if pi-check-cut = 'Y' and pi-check-type = 'C'
  7023        move 'C'                 to en-check-type
  7024     end-if
  7025     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  7026     .
  7027 0400-EXIT.
  7028     EXIT.
  7029 0410-INIT-ERENDT.
  7030     MOVE OC-CONTROL-PRIMARY     TO ERENDT-KEY
  7031     MOVE ZEROS                  TO ENDT-SEQ-NO
  7032
  7033* EXEC CICS READ
  7034*        DATASET    (WS-ERENDT-FILE-ID)
  7035*        RIDFLD     (ERENDT-KEY)
  7036*        INTO       (ENDORSEMENT-RECORD)
  7037*        RESP       (WS-RESPONSE)
  7038*        GTEQ
  7039*    END-EXEC
  7040     MOVE LENGTH OF
  7041      ENDORSEMENT-RECORD
  7042       TO DFHEIV11
  7043*    MOVE '&"IL       G          (  N#00006797' TO DFHEIV0
  7044     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  7045     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7046     MOVE X'204E233030303036373937' TO DFHEIV0(25:11)
  7047     CALL 'kxdfhei1' USING DFHEIV0,
  7048           WS-ERENDT-FILE-ID,
  7049           ENDORSEMENT-RECORD,
  7050           DFHEIV11,
  7051           ERENDT-KEY,
  7052           DFHEIV99,
  7053           DFHEIV99,
  7054           DFHEIV99
  7055     MOVE EIBRESP  TO WS-RESPONSE
  7056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7057     IF RESP-NORMAL
  7058        AND (EN-CONTROL-PRIMARY (1:34) =
  7059           OC-CONTROL-PRIMARY (1:34))
  7060        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  7061     ELSE
  7062        MOVE +4096               TO WS-SEQ-NO
  7063     END-IF
  7064     MOVE 'EN'                   TO ENDORSEMENT-RECORD
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 124
* EL6318.cbl
  7065     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  7066     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  7067     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  7068     INITIALIZE EN-ISSUE-RECORD
  7069     MOVE LOW-VALUES             TO EN-LF-ORIG-EXP-DT
  7070                                    EN-AH-ORIG-EXP-DT
  7071                                    EN-LF-NEW-EXP-DT
  7072                                    EN-AH-NEW-EXP-DT
  7073                                    EN-PROCESS-DT
  7074     .
  7075 0410-EXIT.
  7076     EXIT.
  7077 0420-UPDATE-ELCRTO.
  7078     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  7079     IF RESP-NORMAL
  7080        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  7081                                    OC-LAST-MAINT-DT
  7082        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  7083        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  7084
  7085* EXEC CICS REWRITE
  7086*          FROM     (ORIGINAL-CERTIFICATE)
  7087*          DATASET  ('ELCRTO')
  7088*       END-EXEC
  7089     MOVE LENGTH OF
  7090      ORIGINAL-CERTIFICATE
  7091       TO DFHEIV11
  7092     MOVE 'ELCRTO' TO DFHEIV1
  7093*    MOVE '&& L                  %   #00006831' TO DFHEIV0
  7094     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7095     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7096     MOVE X'2020233030303036383331' TO DFHEIV0(25:11)
  7097     CALL 'kxdfhei1' USING DFHEIV0,
  7098           DFHEIV1,
  7099           ORIGINAL-CERTIFICATE,
  7100           DFHEIV11,
  7101           DFHEIV99
  7102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7103     END-IF
  7104     .
  7105 0420-EXIT.
  7106     EXIT.
  7107
  7108 0425-ADD-NEW-ELCRTO.
  7109     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  7110     MOVE 'OC'                   TO OC-RECORD-ID
  7111     MOVE NEW-ELCRTO-KEY         TO OC-CONTROL-PRIMARY
  7112     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  7113     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  7114     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  7115     MOVE NCRTO-INS-FIRST-NAME   TO OC-INS-FIRST-NAME
  7116     MOVE NCRTO-INS-MIDDLE-INIT  TO OC-INS-MIDDLE-INIT
  7117     MOVE NCRTO-INS-LAST-NAME    TO OC-INS-LAST-NAME
  7118     MOVE NCRTO-INS-AGE          TO OC-INS-AGE
  7119     MOVE NCRTO-JNT-FIRST-NAME   TO OC-JNT-FIRST-NAME
  7120     MOVE NCRTO-JNT-MIDDLE-INIT  TO OC-JNT-MIDDLE-INIT
  7121     MOVE NCRTO-JNT-LAST-NAME    TO OC-JNT-LAST-NAME
  7122     MOVE NCRTO-JNT-AGE          TO OC-JNT-AGE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 125
* EL6318.cbl
  7123     MOVE NCRTO-LF-BENCD         TO OC-LF-BENCD
  7124     MOVE NCRTO-LF-BEN-AMT       TO OC-LF-BEN-AMT
  7125     MOVE NCRTO-LF-PRM-AMT       TO OC-LF-PRM-AMT
  7126     MOVE NCRTO-LF-ALT-BEN-AMT   TO OC-LF-ALT-BEN-AMT
  7127     MOVE NCRTO-LF-ALT-PRM-AMT   TO OC-LF-ALT-PRM-AMT
  7128     MOVE NCRTO-LF-TERM          TO OC-LF-TERM
  7129     MOVE NCRTO-LF-EXP-DT        TO OC-LF-EXP-DT
  7130     MOVE NCRTO-LF-COMM-PCT      TO OC-LF-COMM-PCT
  7131     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
  7132     MOVE +0                     TO OC-LF-CANCEL-AMT
  7133                                    OC-LF-ITD-CANCEL-AMT
  7134     MOVE NCRTO-AH-BENCD         TO OC-AH-BENCD
  7135     MOVE NCRTO-AH-BEN-AMT       TO OC-AH-BEN-AMT
  7136     MOVE NCRTO-AH-PRM-AMT       TO OC-AH-PRM-AMT
  7137     MOVE NCRTO-AH-TERM          TO OC-AH-TERM
  7138     MOVE NCRTO-AH-EXP-DT        TO OC-AH-EXP-DT
  7139     MOVE NCRTO-AH-CP            TO OC-AH-CP
  7140     MOVE NCRTO-AH-COMM-PCT      TO OC-AH-COMM-PCT
  7141     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
  7142     MOVE +0                     TO OC-AH-CANCEL-AMT
  7143                                    OC-AH-ITD-CANCEL-AMT
  7144     MOVE NCRTO-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
  7145     MOVE NCRTO-1ST-PMT-DT       TO OC-1ST-PMT-DT
  7146     MOVE NCRTO-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
  7147     MOVE NCRTO-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
  7148     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
  7149     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
  7150     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  7151     .
  7152 0425-WRITE-ELCRTO.
  7153
  7154
  7155* EXEC CICS WRITE
  7156*       DATASET   ('ELCRTO')
  7157*       FROM      (ORIGINAL-CERTIFICATE)
  7158*       RIDFLD    (OC-CONTROL-PRIMARY)
  7159*       RESP      (WS-RESPONSE)
  7160*    END-EXEC
  7161     MOVE LENGTH OF
  7162      ORIGINAL-CERTIFICATE
  7163       TO DFHEIV11
  7164     MOVE 'ELCRTO' TO DFHEIV1
  7165*    MOVE '&$ L                  ''  N#00006886' TO DFHEIV0
  7166     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7167     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7168     MOVE X'204E233030303036383836' TO DFHEIV0(25:11)
  7169     CALL 'kxdfhei1' USING DFHEIV0,
  7170           DFHEIV1,
  7171           ORIGINAL-CERTIFICATE,
  7172           DFHEIV11,
  7173           OC-CONTROL-PRIMARY,
  7174           DFHEIV99,
  7175           DFHEIV99
  7176     MOVE EIBRESP  TO WS-RESPONSE
  7177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7178
  7179     IF RESP-DUPKEY
  7180        SUBTRACT +1              FROM OC-KEY-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 126
* EL6318.cbl
  7181        GO TO 0425-WRITE-ELCRTO
  7182     ELSE
  7183        IF NOT RESP-NORMAL
  7184           MOVE -1               TO SIGREQL
  7185           MOVE ER-3830          TO EMI-ERROR
  7186           PERFORM 9900-ERROR-FORMAT
  7187                                 THRU 9900-EXIT
  7188        ELSE
  7189           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  7190        END-IF
  7191     END-IF
  7192
  7193     .
  7194 0425-EXIT.
  7195     EXIT.
  7196
  7197 0426-ADD-CERT-NOTES.
  7198
  7199     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  7200     SET TB-INDX TO 1
  7201
  7202     IF PI-CERTNT1-ENTERED > SPACES
  7203         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  7204         MOVE PI-PROCESSOR-ID    TO
  7205                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7206         MOVE EIBTIME            TO
  7207                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7208         MOVE WS-CURRENT-BIN-DT  TO
  7209                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7210         SET TB-INDX UP BY +1
  7211     END-IF
  7212
  7213     IF PI-CERTNT2-ENTERED > SPACES
  7214         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
  7215         MOVE PI-PROCESSOR-ID    TO
  7216                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7217         MOVE EIBTIME            TO
  7218                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7219         MOVE WS-CURRENT-BIN-DT  TO
  7220                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7221         SET TB-INDX UP BY +1
  7222     END-IF
  7223
  7224     IF PI-CERTNT3-ENTERED > SPACES
  7225         MOVE PI-CERTNT3-ENTERED TO CERT-NT-TEXT (TB-INDX)
  7226         MOVE PI-PROCESSOR-ID    TO
  7227                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7228         MOVE EIBTIME            TO
  7229                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7230         MOVE WS-CURRENT-BIN-DT  TO
  7231                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7232         SET TB-INDX UP BY +1
  7233     END-IF
  7234
  7235     IF PI-CERTNT4-ENTERED > SPACES
  7236         MOVE PI-CERTNT4-ENTERED TO CERT-NT-TEXT (TB-INDX)
  7237         MOVE PI-PROCESSOR-ID    TO
  7238                      CERT-NT-LAST-MAINT-BY (TB-INDX)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 127
* EL6318.cbl
  7239         MOVE EIBTIME            TO
  7240                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7241         MOVE WS-CURRENT-BIN-DT  TO
  7242                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7243         SET TB-INDX UP BY +1
  7244     END-IF
  7245
  7246     IF CERT-NOTE-ENTRIES > SPACES
  7247         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  7248         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  7249     END-IF
  7250
  7251     IF PI-BILLNT1-ENTERED > SPACES
  7252         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  7253         MOVE PI-BILLNT1-ENTERED TO WS-MAN-BN-NOTE
  7254         MOVE +63 TO WS-LEN
  7255         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7256     END-IF
  7257
  7258     IF PI-BILLNT2-ENTERED > SPACES
  7259         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  7260         MOVE PI-BILLNT2-ENTERED TO WS-MAN-BN-NOTE
  7261         MOVE +63 TO WS-LEN
  7262         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7263     END-IF
  7264
  7265     .
  7266 0426-EXIT.
  7267     EXIT.
  7268
  7269 0427-LOAD-CURRENT-CERT-NOTES.
  7270
  7271     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  7272     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
  7273     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  7274     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  7275     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  7276     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  7277     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  7278     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  7279     MOVE '1'                 TO ERCNOT-REC-TYP
  7280     MOVE +0                  TO ERCNOT-SEQ
  7281     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  7282
  7283
  7284* EXEC CICS STARTBR
  7285*         DATASET(WS-ERCNOT-FILE-ID)
  7286*         RIDFLD(ERCNOT-KEY)
  7287*         KEYLENGTH(ERCNOT-START-LENGTH)
  7288*         RESP      (WS-RESPONSE)
  7289*         GENERIC
  7290*         GTEQ
  7291*    END-EXEC.
  7292     MOVE 0
  7293       TO DFHEIV11
  7294*    MOVE '&,   KG    G          &  N#00006997' TO DFHEIV0
  7295     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  7296     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 128
* EL6318.cbl
  7297     MOVE X'204E233030303036393937' TO DFHEIV0(25:11)
  7298     CALL 'kxdfhei1' USING DFHEIV0,
  7299           WS-ERCNOT-FILE-ID,
  7300           ERCNOT-KEY,
  7301           ERCNOT-START-LENGTH,
  7302           DFHEIV11,
  7303           DFHEIV99
  7304     MOVE EIBRESP  TO WS-RESPONSE
  7305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7306
  7307
  7308     IF NOT RESP-NORMAL
  7309        GO TO 0427-ENDBR
  7310     END-IF.
  7311
  7312 0427-LOOP.
  7313
  7314* EXEC CICS READNEXT
  7315*         SET(ADDRESS OF CERT-NOTE-FILE)
  7316*         DATASET(WS-ERCNOT-FILE-ID)
  7317*         RIDFLD(ERCNOT-KEY)
  7318*    END-EXEC.
  7319     MOVE 0
  7320       TO DFHEIV11
  7321*    MOVE '&.S                   )   #00007011' TO DFHEIV0
  7322     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7323     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7324     MOVE X'2020233030303037303131' TO DFHEIV0(25:11)
  7325     CALL 'kxdfhei1' USING DFHEIV0,
  7326           WS-ERCNOT-FILE-ID,
  7327           DFHEIV20,
  7328           DFHEIV99,
  7329           ERCNOT-KEY,
  7330           DFHEIV99,
  7331           DFHEIV11,
  7332           DFHEIV99,
  7333           DFHEIV99
  7334     SET ADDRESS OF CERT-NOTE-FILE TO
  7335         DFHEIV20
  7336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7337
  7338
  7339     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  7340         GO TO 0427-ENDBR
  7341     END-IF.
  7342
  7343     IF (CZ-CARRIER = SV-CARRIER)
  7344        AND (CZ-GROUPING = SV-GROUPING)
  7345        AND (CZ-STATE = SV-STATE)
  7346        AND (CZ-ACCOUNT = SV-ACCOUNT)
  7347        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  7348        AND (CZ-CERT-NO = SV-CERT-NO)
  7349        AND (CZ-RECORD-TYPE = '1')
  7350          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  7351          MOVE CZ-LAST-MAINT-USER TO
  7352                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7353          MOVE CZ-LAST-MAINT-DT TO
  7354                      CERT-NT-LAST-MAINT-DT (TB-INDX)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 129
* EL6318.cbl
  7355          MOVE CZ-LAST-MAINT-HHMMSS TO
  7356                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7357          SET TB-INDX UP BY 1
  7358          GO TO 0427-LOOP
  7359     END-IF.
  7360
  7361 0427-ENDBR.
  7362
  7363
  7364* EXEC CICS ENDBR
  7365*         DATASET(WS-ERCNOT-FILE-ID)
  7366*    END-EXEC.
  7367     MOVE 0
  7368       TO DFHEIV11
  7369*    MOVE '&2                    $   #00007041' TO DFHEIV0
  7370     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7371     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7372     MOVE X'2020233030303037303431' TO DFHEIV0(25:11)
  7373     CALL 'kxdfhei1' USING DFHEIV0,
  7374           WS-ERCNOT-FILE-ID,
  7375           DFHEIV11,
  7376           DFHEIV99
  7377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7378
  7379
  7380     .
  7381 0427-EXIT.
  7382     EXIT.
  7383
  7384 0430-WRITE-ERENDT.
  7385     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  7386     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  7387
  7388* EXEC CICS WRITE
  7389*         DATASET   (WS-ERENDT-FILE-ID)
  7390*         FROM      (ENDORSEMENT-RECORD)
  7391*         RIDFLD    (EN-CONTROL-PRIMARY)
  7392*         RESP      (WS-RESPONSE)
  7393*    END-EXEC
  7394     MOVE LENGTH OF
  7395      ENDORSEMENT-RECORD
  7396       TO DFHEIV11
  7397*    MOVE '&$ L                  ''  N#00007052' TO DFHEIV0
  7398     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7399     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7400     MOVE X'204E233030303037303532' TO DFHEIV0(25:11)
  7401     CALL 'kxdfhei1' USING DFHEIV0,
  7402           WS-ERENDT-FILE-ID,
  7403           ENDORSEMENT-RECORD,
  7404           DFHEIV11,
  7405           EN-CONTROL-PRIMARY,
  7406           DFHEIV99,
  7407           DFHEIV99
  7408     MOVE EIBRESP  TO WS-RESPONSE
  7409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7410     IF RESP-NORMAL
  7411        MOVE 'G'                 TO PI-DOCUMENT-PROCESSED
  7412        IF EIBAID = DFHPF4
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 130
* EL6318.cbl
  7413           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  7414           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  7415           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  7416           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  7417        END-IF
  7418     ELSE
  7419        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  7420        MOVE -1                  TO SIGREQL
  7421        MOVE ER-0132             TO EMI-ERROR
  7422        MOVE AL-UABON            TO SIGREQA
  7423        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7424     END-IF
  7425     .
  7426 0430-EXIT.
  7427     EXIT.
  7428
  7429
  7430 0440-ADD-BILLING-NOTE.
  7431
  7432* EXEC CICS GETMAIN
  7433*         SET      (ADDRESS OF EOB-CODES)
  7434*         LENGTH   (ELEOBC-LENGTH)
  7435*         INITIMG  (GETMAIN-SPACE)
  7436*    END-EXEC
  7437*    MOVE ',"IL                  $   #00007079' TO DFHEIV0
  7438     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7439     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7440     MOVE X'2020233030303037303739' TO DFHEIV0(25:11)
  7441     CALL 'kxdfhei1' USING DFHEIV0,
  7442           DFHEIV20,
  7443           ELEOBC-LENGTH,
  7444           GETMAIN-SPACE
  7445     SET ADDRESS OF EOB-CODES TO
  7446         DFHEIV20
  7447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7448
  7449     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  7450     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  7451     MOVE '5'                    TO WS-EOBC-REC-TYPE
  7452
  7453
  7454* EXEC CICS STARTBR
  7455*        DATASET   ('ELEOBC')
  7456*        RIDFLD    (WS-ELEOBC-KEY)
  7457*        GTEQ
  7458*        RESP      (WS-RESPONSE)
  7459*    END-EXEC
  7460     MOVE 'ELEOBC' TO DFHEIV1
  7461     MOVE 0
  7462       TO DFHEIV11
  7463*    MOVE '&,         G          &  N#00007089' TO DFHEIV0
  7464     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7465     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7466     MOVE X'204E233030303037303839' TO DFHEIV0(25:11)
  7467     CALL 'kxdfhei1' USING DFHEIV0,
  7468           DFHEIV1,
  7469           WS-ELEOBC-KEY,
  7470           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 131
* EL6318.cbl
  7471           DFHEIV11,
  7472           DFHEIV99
  7473     MOVE EIBRESP  TO WS-RESPONSE
  7474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7475
  7476     IF NOT RESP-NORMAL
  7477        GO TO 0440-EXIT
  7478     END-IF
  7479      .
  7480 0440-READNEXT-ELEOBC.
  7481
  7482
  7483* EXEC CICS READNEXT
  7484*       INTO    (EOB-CODES)
  7485*       DATASET ('ELEOBC')
  7486*       RIDFLD  (WS-ELEOBC-KEY)
  7487*       RESP    (WS-RESPONSE)
  7488*    END-EXEC
  7489     MOVE LENGTH OF
  7490      EOB-CODES
  7491       TO DFHEIV12
  7492     MOVE 'ELEOBC' TO DFHEIV1
  7493     MOVE 0
  7494       TO DFHEIV11
  7495*    MOVE '&.IL                  )  N#00007102' TO DFHEIV0
  7496     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7497     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7498     MOVE X'204E233030303037313032' TO DFHEIV0(25:11)
  7499     CALL 'kxdfhei1' USING DFHEIV0,
  7500           DFHEIV1,
  7501           EOB-CODES,
  7502           DFHEIV12,
  7503           WS-ELEOBC-KEY,
  7504           DFHEIV99,
  7505           DFHEIV11,
  7506           DFHEIV99,
  7507           DFHEIV99
  7508     MOVE EIBRESP  TO WS-RESPONSE
  7509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7510
  7511     IF RESP-NORMAL
  7512         IF EO-RECORD-TYPE NOT = '5'
  7513             GO TO 0440-EXIT
  7514         END-IF
  7515     ELSE
  7516         GO TO 0440-EXIT
  7517     END-IF
  7518
  7519     IF EO-RECORD-TYPE = '5' AND
  7520        EO-EOB-CODE = PI-LTRID-ENTERED
  7521           CONTINUE
  7522     ELSE
  7523         GO TO 0440-READNEXT-ELEOBC
  7524     END-IF
  7525
  7526     MOVE SPACES TO WS-BILLING-NOTE
  7527     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  7528     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 132
* EL6318.cbl
  7529     MOVE WS-CURRENT-DT TO WS-BN-DATE
  7530     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  7531     MOVE +25 TO WS-LEN
  7532
  7533     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7534     .
  7535 0440-EXIT.
  7536     EXIT.
  7537
  7538 0441-UPDATE-BILLING-NOTE.
  7539
  7540* EXEC CICS GETMAIN
  7541*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  7542*         LENGTH   (ERNOTE-LENGTH)
  7543*         INITIMG  (GETMAIN-SPACE)
  7544*    END-EXEC
  7545*    MOVE ',"IL                  $   #00007137' TO DFHEIV0
  7546     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7547     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7548     MOVE X'2020233030303037313337' TO DFHEIV0(25:11)
  7549     CALL 'kxdfhei1' USING DFHEIV0,
  7550           DFHEIV20,
  7551           ERNOTE-LENGTH,
  7552           GETMAIN-SPACE
  7553     SET ADDRESS OF CERTIFICATE-NOTE TO
  7554         DFHEIV20
  7555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7556
  7557     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  7558
  7559
  7560* EXEC CICS READ
  7561*       DATASET    (WS-ERNOTE-FILE-ID)
  7562*       RIDFLD     (WS-ERNOTE-KEY)
  7563*       INTO       (CERTIFICATE-NOTE)
  7564*       RESP       (WS-RESPONSE)
  7565*       UPDATE
  7566*    END-EXEC
  7567     MOVE LENGTH OF
  7568      CERTIFICATE-NOTE
  7569       TO DFHEIV11
  7570*    MOVE '&"IL       EU         (  N#00007145' TO DFHEIV0
  7571     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7572     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7573     MOVE X'204E233030303037313435' TO DFHEIV0(25:11)
  7574     CALL 'kxdfhei1' USING DFHEIV0,
  7575           WS-ERNOTE-FILE-ID,
  7576           CERTIFICATE-NOTE,
  7577           DFHEIV11,
  7578           WS-ERNOTE-KEY,
  7579           DFHEIV99,
  7580           DFHEIV99,
  7581           DFHEIV99
  7582     MOVE EIBRESP  TO WS-RESPONSE
  7583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7584
  7585     IF RESP-NORMAL
  7586       IF CN-BILLING-START-LINE-NO NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 133
* EL6318.cbl
  7587          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  7588       END-IF
  7589       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  7590          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  7591       END-IF
  7592       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7593           (NOTE-SUB > +10) OR
  7594           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7595                             WS-BILLING-NOTE (1:WS-LEN))
  7596       END-PERFORM
  7597       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7598                              WS-BILLING-NOTE (1:WS-LEN)
  7599
  7600* EXEC CICS UNLOCK
  7601*           DATASET    (WS-ERNOTE-FILE-ID)
  7602*        END-EXEC
  7603*    MOVE '&*                    #   #00007167' TO DFHEIV0
  7604     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7605     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7606     MOVE X'2020233030303037313637' TO DFHEIV0(25:11)
  7607     CALL 'kxdfhei1' USING DFHEIV0,
  7608           WS-ERNOTE-FILE-ID,
  7609           DFHEIV99
  7610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7611       ELSE
  7612         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7613           (NOTE-SUB > +10) OR
  7614           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  7615         END-PERFORM
  7616         IF (NOTE-SUB < +11)
  7617           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  7618              NOTE-SUB <= CN-BILLING-END-LINE-NO
  7619                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7620           ELSE
  7621             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  7622              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  7623                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  7624                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  7625             ELSE
  7626               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  7627                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  7628                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7629                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  7630               ELSE
  7631                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  7632                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  7633                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  7634                                       CN-BILLING-START-LINE-NO
  7635                 ELSE
  7636                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  7637                 END-IF
  7638               END-IF
  7639             END-IF
  7640           END-IF
  7641           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7642           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7643           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7644
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 134
* EL6318.cbl
  7645* EXEC CICS REWRITE
  7646*             DATASET    (WS-ERNOTE-FILE-ID)
  7647*             FROM       (CERTIFICATE-NOTE)
  7648*             RESP       (WS-RESPONSE)
  7649*          END-EXEC
  7650     MOVE LENGTH OF
  7651      CERTIFICATE-NOTE
  7652       TO DFHEIV11
  7653*    MOVE '&& L                  %  N#00007203' TO DFHEIV0
  7654     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7655     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7656     MOVE X'204E233030303037323033' TO DFHEIV0(25:11)
  7657     CALL 'kxdfhei1' USING DFHEIV0,
  7658           WS-ERNOTE-FILE-ID,
  7659           CERTIFICATE-NOTE,
  7660           DFHEIV11,
  7661           DFHEIV99
  7662     MOVE EIBRESP  TO WS-RESPONSE
  7663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7664           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7665         END-IF
  7666       END-IF
  7667     ELSE
  7668        MOVE SPACES              TO CERTIFICATE-NOTE
  7669        MOVE 'CN'                TO CN-RECORD-ID
  7670        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  7671                                     WS-ERNOTE-KEY
  7672        MOVE 01                  TO CN-BILLING-START-LINE-NO
  7673                                    CN-BILLING-END-LINE-NO
  7674        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  7675        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7676        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7677        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7678
  7679* EXEC CICS WRITE
  7680*          DATASET    (WS-ERNOTE-FILE-ID)
  7681*          FROM       (CERTIFICATE-NOTE)
  7682*          RIDFLD     (WS-ERNOTE-KEY)
  7683*          RESP       (WS-RESPONSE)
  7684*       END-EXEC
  7685     MOVE LENGTH OF
  7686      CERTIFICATE-NOTE
  7687       TO DFHEIV11
  7688*    MOVE '&$ L                  ''  N#00007222' TO DFHEIV0
  7689     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7690     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7691     MOVE X'204E233030303037323232' TO DFHEIV0(25:11)
  7692     CALL 'kxdfhei1' USING DFHEIV0,
  7693           WS-ERNOTE-FILE-ID,
  7694           CERTIFICATE-NOTE,
  7695           DFHEIV11,
  7696           WS-ERNOTE-KEY,
  7697           DFHEIV99,
  7698           DFHEIV99
  7699     MOVE EIBRESP  TO WS-RESPONSE
  7700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7701
  7702        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 135
* EL6318.cbl
  7703     END-IF
  7704
  7705     .
  7706 0441-EXIT.
  7707     EXIT.
  7708
  7709
  7710 0442-SQUEEZE-IT-IN.
  7711
  7712     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  7713        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7714           NOTE-SUB = +10
  7715           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  7716           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  7717             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  7718             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  7719             MOVE +9 TO NOTE-SUB
  7720           END-IF
  7721        END-PERFORM
  7722     ELSE
  7723        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  7724           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  7725             UNTIL NOTE-SUB = +1
  7726             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  7727             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  7728                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  7729                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  7730                MOVE +2          TO NOTE-SUB
  7731             END-IF
  7732           END-PERFORM
  7733        END-IF
  7734     END-IF
  7735
  7736     .
  7737 0442-EXIT.
  7738     EXIT.
  7739
  7740 0445-CERTIFICATE-UPDATE.
  7741     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7742     IF RESP-NORMAL
  7743        EVALUATE CM-NOTE-SW
  7744           WHEN '2'
  7745           WHEN '3'
  7746           WHEN '6'
  7747           WHEN '7'
  7748              SET NO-CERT-RW     TO TRUE
  7749           WHEN ' '
  7750              MOVE '2'           TO CM-NOTE-SW
  7751           WHEN '1'
  7752              MOVE '3'           TO CM-NOTE-SW
  7753           WHEN '4'
  7754              MOVE '6'           TO CM-NOTE-SW
  7755           WHEN '5'
  7756              MOVE '7'           TO CM-NOTE-SW
  7757        END-EVALUATE
  7758     END-IF
  7759     IF NOT NO-CERT-RW
  7760        PERFORM 1810-REWRITE-ELCERT
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 136
* EL6318.cbl
  7761                                 THRU 1810-EXIT
  7762     ELSE
  7763
  7764* EXEC CICS UNLOCK
  7765*          DATASET    (WS-ELCERT-FILE-ID)
  7766*       END-EXEC
  7767*    MOVE '&*                    #   #00007290' TO DFHEIV0
  7768     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7769     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7770     MOVE X'2020233030303037323930' TO DFHEIV0(25:11)
  7771     CALL 'kxdfhei1' USING DFHEIV0,
  7772           WS-ELCERT-FILE-ID,
  7773           DFHEIV99
  7774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7775     END-IF
  7776
  7777     .
  7778 0445-EXIT.
  7779     EXIT.
  7780
  7781 0450-GET-ERACCT.
  7782     MOVE ' '                    TO WS-ERACCT-SW
  7783     MOVE ZEROS                  TO WS-CHGBACK
  7784                                    WS-CSO-PORTION
  7785                                    WS-ACCT-PORTION
  7786                                    WS-DIFF
  7787     PERFORM 0460-STARTBR-ERACCT THRU 0460-EXIT
  7788     IF RESP-NORMAL
  7789        PERFORM 0470-READNEXT-ERACCT
  7790                                 THRU 0470-EXIT
  7791     END-IF
  7792     IF RESP-NORMAL
  7793        IF AM-CONTROL-PRIMARY (1:20) = EN-CONTROL-PRIMARY (1:20)
  7794           IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
  7795              AND >= AM-EFFECTIVE-DT
  7796              SET ACCT-FOUND TO TRUE
  7797           ELSE
  7798              PERFORM 0470-READNEXT-ERACCT
  7799                                 THRU 0470-EXIT
  7800              IF RESP-NORMAL
  7801                 IF AM-CONTROL-PRIMARY (1:20)
  7802                    = EN-CONTROL-PRIMARY (1:20)
  7803                    IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
  7804                       AND >= AM-EFFECTIVE-DT
  7805                       SET ACCT-FOUND TO TRUE
  7806                    END-IF
  7807                 END-IF
  7808              END-IF
  7809           END-IF
  7810        END-IF
  7811     END-IF
  7812     IF ACCT-FOUND
  7813        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  7814           (AM-COM-TYP (S1) = 'C' OR 'D')
  7815           OR (S1 > +10)
  7816        END-PERFORM
  7817        IF S1 < +11
  7818           MOVE AM-COMM-CHARGEBACK (S1)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 137
* EL6318.cbl
  7819                                 TO WS-CHGBACK
  7820        END-IF
  7821     END-IF
  7822    .
  7823 0450-EXIT.
  7824     EXIT.
  7825 0460-STARTBR-ERACCT.
  7826     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  7827     MOVE EN-CONTROL-PRIMARY     TO WS-ERACCT-KEY (1:22)
  7828     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  7829
  7830* EXEC CICS STARTBR
  7831*        DATASET   ('ERACCT')
  7832*        RIDFLD    (WS-ERACCT-KEY)
  7833*        GTEQ
  7834*        RESP      (WS-RESPONSE)
  7835*    END-EXEC
  7836     MOVE 'ERACCT' TO DFHEIV1
  7837     MOVE 0
  7838       TO DFHEIV11
  7839*    MOVE '&,         G          &  N#00007347' TO DFHEIV0
  7840     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7841     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7842     MOVE X'204E233030303037333437' TO DFHEIV0(25:11)
  7843     CALL 'kxdfhei1' USING DFHEIV0,
  7844           DFHEIV1,
  7845           WS-ERACCT-KEY,
  7846           DFHEIV99,
  7847           DFHEIV11,
  7848           DFHEIV99
  7849     MOVE EIBRESP  TO WS-RESPONSE
  7850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7851     .
  7852 0460-EXIT.
  7853     EXIT.
  7854 0470-READNEXT-ERACCT.
  7855
  7856* EXEC CICS READNEXT
  7857*       INTO    (ACCOUNT-MASTER)
  7858*       DATASET ('ERACCT')
  7859*       RIDFLD  (WS-ERACCT-KEY)
  7860*       RESP    (WS-RESPONSE)
  7861*    END-EXEC
  7862     MOVE LENGTH OF
  7863      ACCOUNT-MASTER
  7864       TO DFHEIV12
  7865     MOVE 'ERACCT' TO DFHEIV1
  7866     MOVE 0
  7867       TO DFHEIV11
  7868*    MOVE '&.IL                  )  N#00007357' TO DFHEIV0
  7869     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7870     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7871     MOVE X'204E233030303037333537' TO DFHEIV0(25:11)
  7872     CALL 'kxdfhei1' USING DFHEIV0,
  7873           DFHEIV1,
  7874           ACCOUNT-MASTER,
  7875           DFHEIV12,
  7876           WS-ERACCT-KEY,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 138
* EL6318.cbl
  7877           DFHEIV99,
  7878           DFHEIV11,
  7879           DFHEIV99,
  7880           DFHEIV99
  7881     MOVE EIBRESP  TO WS-RESPONSE
  7882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7883     .
  7884 0470-EXIT.
  7885     EXIT.
  7886 0500-CREATE-TEMP-STORAGE.
  7887*    display ' about to write pi ' program-interface-block
  7888
  7889* EXEC CICS WRITEQ TS
  7890*        QUEUE (QID)
  7891*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7892*        LENGTH(1300)
  7893*    END-EXEC
  7894     MOVE 1300
  7895       TO DFHEIV11
  7896*    MOVE '*"                    ''   #00007368' TO DFHEIV0
  7897     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7898     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7899     MOVE X'2020233030303037333638' TO DFHEIV0(25:11)
  7900     CALL 'kxdfhei1' USING DFHEIV0,
  7901           QID,
  7902           PROGRAM-INTERFACE-BLOCK,
  7903           DFHEIV11,
  7904           DFHEIV99,
  7905           DFHEIV99,
  7906           DFHEIV99
  7907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7908*    display ' about to write map ' el631ki
  7909
  7910* EXEC CICS WRITEQ TS
  7911*        QUEUE (QID)
  7912*        FROM  (EL631KI)
  7913*        LENGTH(MAP-LENGTH)
  7914*    END-EXEC.
  7915*    MOVE '*"                    ''   #00007374' TO DFHEIV0
  7916     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7917     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7918     MOVE X'2020233030303037333734' TO DFHEIV0(25:11)
  7919     CALL 'kxdfhei1' USING DFHEIV0,
  7920           QID,
  7921           EL631KI,
  7922           MAP-LENGTH,
  7923           DFHEIV99,
  7924           DFHEIV99,
  7925           DFHEIV99
  7926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7927
  7928 0500-EXIT.
  7929      EXIT.
  7930 0600-RECOVER-TEMP-STORAGE.
  7931
  7932* EXEC CICS READQ TS
  7933*        QUEUE (QID)
  7934*        INTO  (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 139
* EL6318.cbl
  7935*        LENGTH(1300)
  7936*    END-EXEC
  7937     MOVE 1300
  7938       TO DFHEIV11
  7939*    MOVE '*$I    L              ''   #00007382' TO DFHEIV0
  7940     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7941     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7942     MOVE X'2020233030303037333832' TO DFHEIV0(25:11)
  7943     CALL 'kxdfhei1' USING DFHEIV0,
  7944           QID,
  7945           PROGRAM-INTERFACE-BLOCK,
  7946           DFHEIV11,
  7947           DFHEIV99,
  7948           DFHEIV99,
  7949           DFHEIV99
  7950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7951
  7952* EXEC CICS READQ TS
  7953*        QUEUE (QID)
  7954*        INTO  (EL631KI)
  7955*        LENGTH(MAP-LENGTH)
  7956*    END-EXEC
  7957*    MOVE '*$I    L              ''   #00007387' TO DFHEIV0
  7958     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7959     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7960     MOVE X'2020233030303037333837' TO DFHEIV0(25:11)
  7961     CALL 'kxdfhei1' USING DFHEIV0,
  7962           QID,
  7963           EL631KI,
  7964           MAP-LENGTH,
  7965           DFHEIV99,
  7966           DFHEIV99,
  7967           DFHEIV99
  7968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7969     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  7970     MOVE AL-UANON            TO SIGREQA
  7971     MOVE AL-UANON            TO LTRIDA
  7972     MOVE AL-UANON            TO VOUCHA
  7973     MOVE AL-UANON            TO HLTHAPPA
  7974     MOVE AL-UANON            TO PAYEEA
  7975     IF WS-SET-CODES-MDT = 'Y'
  7976        move +1                  to s2
  7977        perform varying s1 from +1 by +5 until s1 > +60
  7978           MOVE WS-PASSED-REASON-CODES (s1:4)
  7979                                 TO reacd-in (s2)
  7980           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7981               MOVE AL-SANON     TO REACDA (S2)
  7982               MOVE +4           TO REACDL (S2)
  7983           END-IF
  7984           add +1                to s2
  7985        end-perform
  7986        MOVE REASONCDS       TO PI-REASONS-ENTERED
  7987     END-IF
  7988     IF CERTIDI > SPACES
  7989         MOVE AL-UANON       TO CERTIDA
  7990     END-IF
  7991
  7992     IF ENCCODEI > SPACES
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 140
* EL6318.cbl
  7993         MOVE AL-UANON       TO ENCCODEA
  7994     END-IF
  7995
  7996     IF CRTNT1I > SPACES
  7997         MOVE AL-UANON       TO CRTNT1A
  7998     END-IF
  7999
  8000     IF CRTNT2I > SPACES
  8001         MOVE AL-UANON       TO CRTNT2A
  8002     END-IF
  8003
  8004     IF CRTNT3I > SPACES
  8005         MOVE AL-UANON       TO CRTNT3A
  8006     END-IF
  8007
  8008     IF CRTNT4I > SPACES
  8009         MOVE AL-UANON       TO CRTNT4A
  8010     END-IF
  8011
  8012     IF BILNT1I > SPACES
  8013         MOVE AL-UANON       TO BILNT1A
  8014     END-IF
  8015
  8016     IF BILNT2I > SPACES
  8017         MOVE AL-UANON       TO BILNT2A
  8018     END-IF
  8019     .
  8020 0600-EXIT.
  8021      EXIT.
  8022 0800-DELETE-TS.
  8023
  8024* EXEC CICS DELETEQ TS
  8025*        QUEUE(QID)
  8026*    END-EXEC
  8027*    MOVE '*&                    #   #00007446' TO DFHEIV0
  8028     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8029     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8030     MOVE X'2020233030303037343436' TO DFHEIV0(25:11)
  8031     CALL 'kxdfhei1' USING DFHEIV0,
  8032           QID,
  8033           DFHEIV99
  8034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8035     .
  8036 0800-EXIT.
  8037      EXIT.
  8038 1000-BUILD-ERARCH.
  8039     MOVE SPACES                 TO W-CNTL-KEY
  8040     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
  8041     MOVE '1'                    TO W-CNTL-RECORD-TYPE
  8042     MOVE ZEROS                  TO W-CNTL-SEQ-NO
  8043
  8044* EXEC CICS READ
  8045*         DATASET    (WS-ELCNTL-FILE-ID)
  8046*         SET        (ADDRESS OF CONTROL-FILE)
  8047*         RIDFLD     (W-CNTL-KEY)
  8048*         UPDATE
  8049*         RESP       (WS-RESPONSE)
  8050*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 141
* EL6318.cbl
  8051*    MOVE '&"S        EU         (  N#00007457' TO DFHEIV0
  8052     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8053     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8054     MOVE X'204E233030303037343537' TO DFHEIV0(25:11)
  8055     CALL 'kxdfhei1' USING DFHEIV0,
  8056           WS-ELCNTL-FILE-ID,
  8057           DFHEIV20,
  8058           DFHEIV99,
  8059           W-CNTL-KEY,
  8060           DFHEIV99,
  8061           DFHEIV99,
  8062           DFHEIV99
  8063     SET ADDRESS OF CONTROL-FILE TO
  8064         DFHEIV20
  8065     MOVE EIBRESP  TO WS-RESPONSE
  8066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8067     IF RESP-NORMAL
  8068        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  8069           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  8070        END-IF
  8071        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  8072        MOVE CF-CREDIT-LAST-ARCH-NUM
  8073                                 TO W-ARCH-NUMBER
  8074
  8075* EXEC CICS REWRITE
  8076*          FROM      (CONTROL-FILE)
  8077*          DATASET   (WS-ELCNTL-FILE-ID)
  8078*       END-EXEC
  8079     MOVE LENGTH OF
  8080      CONTROL-FILE
  8081       TO DFHEIV11
  8082*    MOVE '&& L                  %   #00007471' TO DFHEIV0
  8083     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8084     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8085     MOVE X'2020233030303037343731' TO DFHEIV0(25:11)
  8086     CALL 'kxdfhei1' USING DFHEIV0,
  8087           WS-ELCNTL-FILE-ID,
  8088           CONTROL-FILE,
  8089           DFHEIV11,
  8090           DFHEIV99
  8091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8092     END-IF
  8093
  8094* EXEC CICS GETMAIN
  8095*       SET      (ADDRESS OF LETTER-ARCHIVE)
  8096*       LENGTH   (W-ARCH-LENGTH)
  8097*    END-EXEC
  8098*    MOVE '," L                  $   #00007476' TO DFHEIV0
  8099     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  8100     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8101     MOVE X'2020233030303037343736' TO DFHEIV0(25:11)
  8102     CALL 'kxdfhei1' USING DFHEIV0,
  8103           DFHEIV20,
  8104           W-ARCH-LENGTH,
  8105           DFHEIV99
  8106     SET ADDRESS OF LETTER-ARCHIVE TO
  8107         DFHEIV20
  8108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 142
* EL6318.cbl
  8109     MOVE 'LA'                   TO LETTER-ARCHIVE
  8110     MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
  8111                                    LA-ARCHIVE-NO-A2
  8112                                    LA-ARCHIVE-NO-A3
  8113                                    LA-ARCHIVE-NO-A4
  8114                                    LA-ARCHIVE-NO-A5
  8115                                    LA-ARCHIVE-NO-A6
  8116     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8117                                    LA-COMPANY-CD-A2
  8118                                    LA-COMPANY-CD-A3
  8119                                    LA-COMPANY-CD-A4
  8120                                    LA-COMPANY-CD-A5
  8121                                    LA-COMPANY-CD-A6
  8122     MOVE PB-CARRIER             TO LA-CARRIER-A2
  8123                                    LA-CARRIER-A3
  8124                                    LA-CARRIER-A4
  8125                                    LA-CARRIER-A5
  8126     MOVE Pb-cert-eff-dt         TO LA-EFFECT-DATE-A2
  8127     MOVE PB-GROUPING            TO LA-GROUPING-A2
  8128                                    LA-GROUPING-A3
  8129                                    LA-GROUPING-A4
  8130                                    LA-GROUPING-A5
  8131     MOVE PB-ACCOUNT             TO LA-ACCOUNT-A2
  8132                                    LA-ACCOUNT-A3
  8133                                    LA-ACCOUNT-A4
  8134                                    LA-ACCOUNT-A5
  8135     MOVE PB-STATE               TO LA-STATE-A2
  8136                                    LA-STATE-A3
  8137                                    LA-STATE-A4
  8138                                    LA-STATE-A5
  8139     MOVE PB-CERT-PRIME          TO LA-CERT-PRIME-A2
  8140     MOVE PB-CERT-SFX            TO LA-CERT-SUFFIX-A2
  8141     MOVE PB-ENTRY-BATCH         TO LA-ENTRY-A6
  8142     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD
  8143     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  8144                                    LA-INITIAL-PRINT-DATE
  8145                                    LA-SENT-DATE
  8146                                    LA-REPLY-DATE
  8147                                    LA-RESEND-DATE
  8148                                    LA-FOLLOW-UP-DATE
  8149     MOVE 'A'                    TO LA-STATUS
  8150     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  8151     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  8152     MOVE LTRIDI                 TO LA-FORM-A3
  8153     MOVE '4'                    TO LA-DATA-SOURCE
  8154     MOVE WS-CURRENT-BIN-DT      TO LA-CREATION-DATE
  8155     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  8156                                    LA-NO-OF-TEXT-RECORDS
  8157
  8158* EXEC CICS WRITE
  8159*         DATASET   ('ERARCH')
  8160*         FROM      (LETTER-ARCHIVE)
  8161*         RIDFLD    (LA-CONTROL-PRIMARY)
  8162*         RESP      (WS-RESPONSE)
  8163*    END-EXEC
  8164     MOVE LENGTH OF
  8165      LETTER-ARCHIVE
  8166       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 143
* EL6318.cbl
  8167     MOVE 'ERARCH' TO DFHEIV1
  8168*    MOVE '&$ L                  ''  N#00007528' TO DFHEIV0
  8169     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8170     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8171     MOVE X'204E233030303037353238' TO DFHEIV0(25:11)
  8172     CALL 'kxdfhei1' USING DFHEIV0,
  8173           DFHEIV1,
  8174           LETTER-ARCHIVE,
  8175           DFHEIV11,
  8176           LA-CONTROL-PRIMARY,
  8177           DFHEIV99,
  8178           DFHEIV99
  8179     MOVE EIBRESP  TO WS-RESPONSE
  8180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8181     IF RESP-NORMAL
  8182        MOVE ER-0280             TO EMI-ERROR
  8183        MOVE -1                  TO SIGREQL
  8184        PERFORM 9900-ERROR-FORMAT
  8185                                 THRU 9900-EXIT
  8186        MOVE W-ARCH-NUMBER       TO W-ARCH-SUPPRESS
  8187        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  8188     ELSE
  8189        MOVE ER-7345             TO EMI-ERROR
  8190        MOVE -1                  TO SIGREQL
  8191        PERFORM 9900-ERROR-FORMAT
  8192                                 THRU 9900-EXIT
  8193     END-IF
  8194     .
  8195 1000-EXIT.
  8196     EXIT.
  8197 1100-CALL-NS-BUS-LOGIC.
  8198     MOVE SPACES                 TO BL-INPUT
  8199     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  8200     IF PI-RETURN-TO-PROGRAM EQUAL 'EL6314'
  8201         MOVE '2'                TO BL-DATA-SRCE
  8202         MOVE SPACES             TO BL-BATCH-NO
  8203         MOVE ZEROS              TO BL-BATCH-SEQ
  8204     ELSE
  8205         MOVE '4'                TO BL-DATA-SRCE
  8206         MOVE PB-ENTRY-BATCH     TO BL-BATCH-NO
  8207         MOVE PB-BATCH-SEQ-NO    TO BL-BATCH-SEQ
  8208     END-IF
  8209     MOVE PI-CARRIER             TO BL-CARRIER
  8210     MOVE PI-GROUPING            TO BL-GROUP
  8211     MOVE PI-STATE               TO BL-STATE
  8212     MOVE PI-ACCOUNT             TO BL-ACCOUNT
  8213     IF PI-CERT-EFF-DT NOT = LOW-VALUES
  8214        MOVE PI-CERT-EFF-DT      TO DC-BIN-DATE-1
  8215        MOVE ' '                 TO DC-OPTION-CODE
  8216        PERFORM 9700-date-link
  8217        IF NO-CONVERSION-ERROR
  8218           MOVE DC-GREG-DATE-B-EDIT
  8219                                 TO BL-EFF-DT
  8220        END-IF
  8221     END-IF
  8222     MOVE PI-CERT-NO             TO BL-CERT-NO
  8223     MOVE SPACES                 TO BL-RESP-NO
  8224     MOVE LTRIDI                 TO BL-LETTER-ID
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 144
* EL6318.cbl
  8225     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  8226     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  8227*    MOVE 'ALWA'                 TO BL-PROC-ID
  8228     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  8229*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
  8230*    MOVE IFF-ENC-CD             TO BL-ENC-CD
  8231     MOVE PI-ENCCODE             TO BL-ENC-CD
  8232     IF EIBAID = DFHPF4
  8233        MOVE 'B'                 TO BL-WRITE-ERARCH
  8234     ELSE
  8235        MOVE 'T'                 TO BL-WRITE-ERARCH
  8236     END-IF
  8237     MOVE CERTIDI                TO BL-CERT-FORM-ID
  8238     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  8239     MOVE 'ISS ENDT'             TO BL-SOURCE-SCREEN
  8240     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  8241        IF REACD-IN (S1) NOT = LOW-VALUES
  8242           MOVE REACD-IN (S1)    TO BL-REASON-CODE (S1)
  8243        END-IF
  8244     END-PERFORM
  8245*****************************************
  8246* Invoke the LETTER business logic
  8247*****************************************
  8248
  8249* exec cics link
  8250*       program('NSRASBL')
  8251*       commarea(srch-commarea)
  8252*    end-exec.
  8253     MOVE LENGTH OF
  8254      srch-commarea
  8255       TO DFHEIV11
  8256     MOVE 'NSRASBL' TO DFHEIV1
  8257*    MOVE '."C                   (   #00007601' TO DFHEIV0
  8258     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8259     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8260     MOVE X'2020233030303037363031' TO DFHEIV0(25:11)
  8261     CALL 'kxdfhei1' USING DFHEIV0,
  8262           DFHEIV1,
  8263           srch-commarea,
  8264           DFHEIV11,
  8265           DFHEIV99,
  8266           DFHEIV99,
  8267           DFHEIV99,
  8268           DFHEIV99
  8269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8270
  8271     .
  8272 1100-EXIT.
  8273     EXIT.
  8274 1500-GET-ARCH-NO.
  8275     MOVE SPACES                 TO ELCNTL-KEY
  8276     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  8277     MOVE '1'                    TO CNTL-REC-TYPE
  8278     MOVE ZEROS                  TO CNTL-SEQ
  8279
  8280* EXEC CICS READ
  8281*         DATASET    (WS-ELCNTL-FILE-ID)
  8282*         SET        (ADDRESS OF CONTROL-FILE)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 145
* EL6318.cbl
  8283*         RIDFLD     (ELCNTL-KEY)
  8284*         UPDATE
  8285*         RESP       (WS-RESPONSE)
  8286*    END-EXEC
  8287*    MOVE '&"S        EU         (  N#00007613' TO DFHEIV0
  8288     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8289     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8290     MOVE X'204E233030303037363133' TO DFHEIV0(25:11)
  8291     CALL 'kxdfhei1' USING DFHEIV0,
  8292           WS-ELCNTL-FILE-ID,
  8293           DFHEIV20,
  8294           DFHEIV99,
  8295           ELCNTL-KEY,
  8296           DFHEIV99,
  8297           DFHEIV99,
  8298           DFHEIV99
  8299     SET ADDRESS OF CONTROL-FILE TO
  8300         DFHEIV20
  8301     MOVE EIBRESP  TO WS-RESPONSE
  8302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8303     IF RESP-NORMAL
  8304        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  8305           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  8306        END-IF
  8307        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  8308        MOVE CF-CREDIT-LAST-ARCH-NUM
  8309                                 TO W-ARCH-NUMBER
  8310
  8311* EXEC CICS REWRITE
  8312*          FROM      (CONTROL-FILE)
  8313*          DATASET   (WS-ELCNTL-FILE-ID)
  8314*       END-EXEC
  8315     MOVE LENGTH OF
  8316      CONTROL-FILE
  8317       TO DFHEIV11
  8318*    MOVE '&& L                  %   #00007627' TO DFHEIV0
  8319     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8320     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8321     MOVE X'2020233030303037363237' TO DFHEIV0(25:11)
  8322     CALL 'kxdfhei1' USING DFHEIV0,
  8323           WS-ELCNTL-FILE-ID,
  8324           CONTROL-FILE,
  8325           DFHEIV11,
  8326           DFHEIV99
  8327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8328     END-IF
  8329     .
  8330 1500-EXIT.
  8331     EXIT.
  8332
  8333
  8334 1700-WRITE-CERT-NOTE      SECTION.
  8335
  8336     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  8337     MOVE ZERO           TO ERCNOT-SEQ.
  8338     SET TB-INDX         DOWN BY 1.
  8339     SET TB-INDX1        TO TB-INDX.
  8340
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 146
* EL6318.cbl
  8341****DELETE CURRENT CERT NOTES
  8342 1700-LOOP.
  8343
  8344* EXEC CICS READ
  8345*        DATASET (WS-ERCNOT-FILE-ID)
  8346*        RIDFLD  (ERCNOT-KEY)
  8347*        SET     (ADDRESS OF CERT-NOTE-FILE)
  8348*        RESP    (WS-RESPONSE)
  8349*        GTEQ
  8350*    END-EXEC.
  8351*    MOVE '&"S        G          (  N#00007646' TO DFHEIV0
  8352     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8353     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8354     MOVE X'204E233030303037363436' TO DFHEIV0(25:11)
  8355     CALL 'kxdfhei1' USING DFHEIV0,
  8356           WS-ERCNOT-FILE-ID,
  8357           DFHEIV20,
  8358           DFHEIV99,
  8359           ERCNOT-KEY,
  8360           DFHEIV99,
  8361           DFHEIV99,
  8362           DFHEIV99
  8363     SET ADDRESS OF CERT-NOTE-FILE TO
  8364         DFHEIV20
  8365     MOVE EIBRESP  TO WS-RESPONSE
  8366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8367
  8368
  8369     IF NOT RESP-NORMAL
  8370        GO TO 1700-ENDDEL
  8371     END-IF
  8372
  8373     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  8374
  8375     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  8376         GO TO 1700-ENDDEL
  8377     END-IF.
  8378
  8379
  8380* EXEC CICS DELETE
  8381*        DATASET (WS-ERCNOT-FILE-ID)
  8382*        RIDFLD  (ERCNOT-KEY)
  8383*    END-EXEC.
  8384*    MOVE '&(  R                 &   #00007664' TO DFHEIV0
  8385     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  8386     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8387     MOVE X'2020233030303037363634' TO DFHEIV0(25:11)
  8388     CALL 'kxdfhei1' USING DFHEIV0,
  8389           WS-ERCNOT-FILE-ID,
  8390           ERCNOT-KEY,
  8391           DFHEIV99,
  8392           DFHEIV99,
  8393           DFHEIV99
  8394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8395
  8396
  8397     GO TO 1700-LOOP.
  8398
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 147
* EL6318.cbl
  8399 1700-ENDDEL.
  8400
  8401
  8402* EXEC CICS GETMAIN
  8403*         LENGTH(ERCNOT-LENGTH)
  8404*         SET(ADDRESS OF CERT-NOTE-FILE)
  8405*         INITIMG(GETMAIN-SPACE)
  8406*    END-EXEC.
  8407*    MOVE ',"IL                  $   #00007673' TO DFHEIV0
  8408     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8409     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8410     MOVE X'2020233030303037363733' TO DFHEIV0(25:11)
  8411     CALL 'kxdfhei1' USING DFHEIV0,
  8412           DFHEIV20,
  8413           ERCNOT-LENGTH,
  8414           GETMAIN-SPACE
  8415     SET ADDRESS OF CERT-NOTE-FILE TO
  8416         DFHEIV20
  8417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8418
  8419
  8420     SET TB-INDX TO 1.
  8421     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  8422     MOVE +0             TO ERCNOT-SEQ
  8423
  8424     PERFORM VARYING TB-INDX FROM 1 BY 1
  8425             UNTIL TB-INDX > TB-INDX1
  8426        MOVE SPACES                 TO  CERT-NOTE-FILE
  8427        ADD 1                       TO  ERCNOT-SEQ
  8428        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  8429        MOVE  'CZ'                  TO  CZ-RECORD-ID
  8430        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  8431        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  8432                                    TO  CZ-LAST-MAINT-USER
  8433        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  8434                                    TO  CZ-LAST-MAINT-HHMMSS
  8435        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  8436                                    TO  CZ-LAST-MAINT-DT
  8437
  8438
  8439* EXEC CICS WRITE
  8440*            DATASET(WS-ERCNOT-FILE-ID)
  8441*            FROM(CERT-NOTE-FILE)
  8442*            RIDFLD(ERCNOT-KEY)
  8443*       END-EXEC
  8444     MOVE LENGTH OF
  8445      CERT-NOTE-FILE
  8446       TO DFHEIV11
  8447*    MOVE '&$ L                  ''   #00007697' TO DFHEIV0
  8448     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8449     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8450     MOVE X'2020233030303037363937' TO DFHEIV0(25:11)
  8451     CALL 'kxdfhei1' USING DFHEIV0,
  8452           WS-ERCNOT-FILE-ID,
  8453           CERT-NOTE-FILE,
  8454           DFHEIV11,
  8455           ERCNOT-KEY,
  8456           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 148
* EL6318.cbl
  8457           DFHEIV99
  8458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8459     END-PERFORM
  8460
  8461     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8462     IF RESP-NORMAL
  8463        EVALUATE CM-NOTE-SW
  8464           WHEN '1'
  8465           WHEN '3'
  8466           WHEN '5'
  8467           WHEN '7'
  8468              SET NO-CERT-RW     TO TRUE
  8469           WHEN ' '
  8470              MOVE '1'           TO CM-NOTE-SW
  8471           WHEN '2'
  8472              MOVE '3'           TO CM-NOTE-SW
  8473           WHEN '4'
  8474              MOVE '5'           TO CM-NOTE-SW
  8475           WHEN '6'
  8476              MOVE '7'           TO CM-NOTE-SW
  8477        END-EVALUATE
  8478     END-IF
  8479     IF NOT NO-CERT-RW
  8480        PERFORM 1810-REWRITE-ELCERT
  8481                                 THRU 1810-EXIT
  8482     ELSE
  8483
  8484* EXEC CICS UNLOCK
  8485*          DATASET    (WS-ELCERT-FILE-ID)
  8486*       END-EXEC
  8487*    MOVE '&*                    #   #00007726' TO DFHEIV0
  8488     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8489     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8490     MOVE X'2020233030303037373236' TO DFHEIV0(25:11)
  8491     CALL 'kxdfhei1' USING DFHEIV0,
  8492           WS-ELCERT-FILE-ID,
  8493           DFHEIV99
  8494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8495     END-IF
  8496
  8497     .
  8498 1799-EXIT.
  8499     EXIT.
  8500
  8501 1800-READ-ELCERT-UPDATE.
  8502
  8503     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  8504     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  8505     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  8506     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  8507     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  8508     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  8509     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  8510     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  8511
  8512
  8513* EXEC CICS READ
  8514*        UPDATE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 149
* EL6318.cbl
  8515*        DATASET  (WS-ELCERT-FILE-ID)
  8516*        RIDFLD   (WS-ELCERT-KEY)
  8517*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8518*        RESP     (WS-RESPONSE)
  8519*    END-EXEC
  8520*    MOVE '&"S        EU         (  N#00007746' TO DFHEIV0
  8521     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8522     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8523     MOVE X'204E233030303037373436' TO DFHEIV0(25:11)
  8524     CALL 'kxdfhei1' USING DFHEIV0,
  8525           WS-ELCERT-FILE-ID,
  8526           DFHEIV20,
  8527           DFHEIV99,
  8528           WS-ELCERT-KEY,
  8529           DFHEIV99,
  8530           DFHEIV99,
  8531           DFHEIV99
  8532     SET ADDRESS OF CERTIFICATE-MASTER TO
  8533         DFHEIV20
  8534     MOVE EIBRESP  TO WS-RESPONSE
  8535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8536
  8537     .
  8538 1800-EXIT.
  8539     EXIT.
  8540
  8541 1810-REWRITE-ELCERT.
  8542
  8543
  8544* EXEC CICS REWRITE
  8545*        FROM     (CERTIFICATE-MASTER)
  8546*        DATASET  (WS-ELCERT-FILE-ID)
  8547*        RESP     (WS-RESPONSE)
  8548*    END-EXEC.
  8549     MOVE LENGTH OF
  8550      CERTIFICATE-MASTER
  8551       TO DFHEIV11
  8552*    MOVE '&& L                  %  N#00007760' TO DFHEIV0
  8553     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8554     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8555     MOVE X'204E233030303037373630' TO DFHEIV0(25:11)
  8556     CALL 'kxdfhei1' USING DFHEIV0,
  8557           WS-ELCERT-FILE-ID,
  8558           CERTIFICATE-MASTER,
  8559           DFHEIV11,
  8560           DFHEIV99
  8561     MOVE EIBRESP  TO WS-RESPONSE
  8562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8563
  8564
  8565     .
  8566 1810-EXIT.
  8567     EXIT.
  8568
  8569 8100-SEND-INITIAL-MAP.
  8570     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8571     MOVE '5'                    TO DC-OPTION-CODE.
  8572     PERFORM 9700-DATE-LINK.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 150
* EL6318.cbl
  8573     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8574     MOVE EIBTIME                TO TIME-IN.
  8575     MOVE TIME-OUT               TO TIMEO.
  8576     MOVE -1                     TO SIGREQL
  8577     IF PI-PROCESSOR-IS-CSR-SUPER
  8578        perform varying s1 from +1 by +1 until
  8579           s1 > +12
  8580           MOVE AL-UANON            TO reacda (s1)
  8581        end-perform
  8582     END-IF
  8583     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  8584     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  8585
  8586* EXEC CICS SEND
  8587*        MAP      (MAP-NAME)
  8588*        MAPSET   (MAPSET-NAME)
  8589*        FROM     (EL631KO)
  8590*        ERASE
  8591*        CURSOR
  8592*    END-EXEC.
  8593     MOVE LENGTH OF
  8594      EL631KO
  8595       TO DFHEIV12
  8596     MOVE -1
  8597       TO DFHEIV11
  8598*    MOVE '8$     CT  E    H L F ,   #00007786' TO DFHEIV0
  8599     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8600     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8601     MOVE X'2020233030303037373836' TO DFHEIV0(25:11)
  8602     CALL 'kxdfhei1' USING DFHEIV0,
  8603           MAP-NAME,
  8604           EL631KO,
  8605           DFHEIV12,
  8606           MAPSET-NAME,
  8607           DFHEIV99,
  8608           DFHEIV99,
  8609           DFHEIV99,
  8610           DFHEIV11,
  8611           DFHEIV99,
  8612           DFHEIV99,
  8613           DFHEIV99
  8614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8615
  8616     GO TO 9100-RETURN-TRAN.
  8617 8200-SEND-DATAONLY.
  8618     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8619     MOVE '5'                    TO DC-OPTION-CODE.
  8620     PERFORM 9700-DATE-LINK.
  8621     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8622     MOVE EIBTIME                TO TIME-IN.
  8623     MOVE TIME-OUT               TO TIMEO.
  8624     MOVE -1                     TO PFENTRL
  8625     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  8626     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  8627
  8628* EXEC CICS SEND
  8629*        MAP      (MAP-NAME)
  8630*        MAPSET   (MAPSET-NAME)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 151
* EL6318.cbl
  8631*        FROM     (EL631KO)
  8632*        DATAONLY
  8633*        ERASEAUP
  8634*        CURSOR
  8635*    END-EXEC.
  8636     MOVE LENGTH OF
  8637      EL631KO
  8638       TO DFHEIV12
  8639     MOVE -1
  8640       TO DFHEIV11
  8641*    MOVE '8$D    CT  A    H L F ,   #00007804' TO DFHEIV0
  8642     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  8643     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8644     MOVE X'2020233030303037383034' TO DFHEIV0(25:11)
  8645     CALL 'kxdfhei1' USING DFHEIV0,
  8646           MAP-NAME,
  8647           EL631KO,
  8648           DFHEIV12,
  8649           MAPSET-NAME,
  8650           DFHEIV99,
  8651           DFHEIV99,
  8652           DFHEIV99,
  8653           DFHEIV11,
  8654           DFHEIV99,
  8655           DFHEIV99,
  8656           DFHEIV99
  8657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8658
  8659     GO TO 9100-RETURN-TRAN.
  8660 8300-SEND-TEXT.
  8661
  8662* EXEC CICS SEND TEXT
  8663*        FROM     (LOGOFF-TEXT)
  8664*        LENGTH   (LOGOFF-LENGTH)
  8665*        ERASE
  8666*        FREEKB
  8667*    END-EXEC.
  8668*    MOVE '8&      T  E F  H   F -   #00007814' TO DFHEIV0
  8669     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8670     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8671     MOVE X'2020233030303037383134' TO DFHEIV0(25:11)
  8672     CALL 'kxdfhei1' USING DFHEIV0,
  8673           LOGOFF-TEXT,
  8674           LOGOFF-LENGTH,
  8675           DFHEIV99,
  8676           DFHEIV99,
  8677           DFHEIV99,
  8678           DFHEIV99,
  8679           DFHEIV99,
  8680           DFHEIV99,
  8681           DFHEIV99,
  8682           DFHEIV99,
  8683           DFHEIV99,
  8684           DFHEIV99
  8685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8686
  8687
  8688* EXEC CICS RETURN
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 152
* EL6318.cbl
  8689*    END-EXEC.
  8690*    MOVE '.(                    ''   #00007820' TO DFHEIV0
  8691     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8692     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8693     MOVE X'2020233030303037383230' TO DFHEIV0(25:11)
  8694     CALL 'kxdfhei1' USING DFHEIV0,
  8695           DFHEIV99,
  8696           DFHEIV99,
  8697           DFHEIV99,
  8698           DFHEIV99,
  8699           DFHEIV99,
  8700           DFHEIV99
  8701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8702
  8703 8800-UNAUTHORIZED-ACCESS.
  8704     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8705     GO TO 8300-SEND-TEXT.
  8706 8810-PF23.
  8707     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  8708     MOVE XCTL-005               TO PGM-NAME.
  8709     GO TO 9300-XCTL.
  8710 9000-RETURN-CICS.
  8711
  8712* EXEC CICS RETURN
  8713*    END-EXEC.
  8714*    MOVE '.(                    ''   #00007830' TO DFHEIV0
  8715     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8716     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8717     MOVE X'2020233030303037383330' TO DFHEIV0(25:11)
  8718     CALL 'kxdfhei1' USING DFHEIV0,
  8719           DFHEIV99,
  8720           DFHEIV99,
  8721           DFHEIV99,
  8722           DFHEIV99,
  8723           DFHEIV99,
  8724           DFHEIV99
  8725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8726
  8727 9100-RETURN-TRAN.
  8728     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  8729     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  8730
  8731* EXEC CICS RETURN
  8732*        TRANSID    (TRANS-ID)
  8733*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8734*        LENGTH     (1300)
  8735*        LENGTH     (PI-COMM-LENGTH)
  8736*    END-EXEC.
  8737     MOVE 1300
  8738       TO DFHEIV11
  8739*    MOVE '.(CT                  ''   #00007835' TO DFHEIV0
  8740     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8741     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8742     MOVE X'2020233030303037383335' TO DFHEIV0(25:11)
  8743     CALL 'kxdfhei1' USING DFHEIV0,
  8744           TRANS-ID,
  8745           PROGRAM-INTERFACE-BLOCK,
  8746           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 153
* EL6318.cbl
  8747           DFHEIV99,
  8748           DFHEIV99,
  8749           DFHEIV99
  8750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8751
  8752 9200-RETURN-MAIN-MENU.
  8753     MOVE XCTL-626               TO PGM-NAME.
  8754     GO TO 9300-XCTL.
  8755 9300-XCTL.
  8756
  8757* EXEC CICS XCTL
  8758*        PROGRAM    (PGM-NAME)
  8759*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8760*        LENGTH     (PI-COMM-LENGTH)
  8761*    END-EXEC.
  8762*    MOVE '.$C                   %   #00007845' TO DFHEIV0
  8763     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8764     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8765     MOVE X'2020233030303037383435' TO DFHEIV0(25:11)
  8766     CALL 'kxdfhei1' USING DFHEIV0,
  8767           PGM-NAME,
  8768           PROGRAM-INTERFACE-BLOCK,
  8769           PI-COMM-LENGTH,
  8770           DFHEIV99
  8771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8772
  8773 9400-CLEAR.
  8774     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  8775
  8776* EXEC CICS XCTL
  8777*        PROGRAM    (PGM-NAME)
  8778*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8779*        LENGTH     (PI-COMM-LENGTH)
  8780*    END-EXEC.
  8781*    MOVE '.$C                   %   #00007852' TO DFHEIV0
  8782     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8783     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8784     MOVE X'2020233030303037383532' TO DFHEIV0(25:11)
  8785     CALL 'kxdfhei1' USING DFHEIV0,
  8786           PGM-NAME,
  8787           PROGRAM-INTERFACE-BLOCK,
  8788           PI-COMM-LENGTH,
  8789           DFHEIV99
  8790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8791
  8792 9500-PF12.
  8793     MOVE XCTL-010               TO PGM-NAME.
  8794     GO TO 9300-XCTL.
  8795 9600-PGMID-ERROR.
  8796
  8797* EXEC CICS HANDLE CONDITION
  8798*        PGMIDERR    (8300-SEND-TEXT)
  8799*    END-EXEC.
  8800*    MOVE '"$L                   ! " #00007861' TO DFHEIV0
  8801     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8802     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8803     MOVE X'2220233030303037383631' TO DFHEIV0(25:11)
  8804     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 154
* EL6318.cbl
  8805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8806
  8807     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  8808     MOVE ' '                    TO PI-ENTRY-CD-1.
  8809     MOVE XCTL-005               TO PGM-NAME.
  8810     MOVE PGM-NAME               TO LOGOFF-PGM.
  8811     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  8812     GO TO 9300-XCTL.
  8813 9700-DATE-LINK.
  8814     MOVE LINK-ELDATCV           TO PGM-NAME.
  8815
  8816* EXEC CICS LINK
  8817*        PROGRAM    (PGM-NAME)
  8818*        COMMAREA   (DATE-CONVERSION-DATA)
  8819*        LENGTH     (DC-COMM-LENGTH)
  8820*    END-EXEC.
  8821*    MOVE '."C                   (   #00007872' TO DFHEIV0
  8822     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8823     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8824     MOVE X'2020233030303037383732' TO DFHEIV0(25:11)
  8825     CALL 'kxdfhei1' USING DFHEIV0,
  8826           PGM-NAME,
  8827           DATE-CONVERSION-DATA,
  8828           DC-COMM-LENGTH,
  8829           DFHEIV99,
  8830           DFHEIV99,
  8831           DFHEIV99,
  8832           DFHEIV99
  8833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8834
  8835 9900-ERROR-FORMAT.
  8836     IF NOT EMI-ERRORS-COMPLETE
  8837        MOVE LINK-001            TO PGM-NAME
  8838
  8839* EXEC CICS LINK
  8840*           PROGRAM    (PGM-NAME)
  8841*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8842*           LENGTH     (EMI-COMM-LENGTH)
  8843*       END-EXEC
  8844*    MOVE '."C                   (   #00007880' TO DFHEIV0
  8845     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8846     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8847     MOVE X'2020233030303037383830' TO DFHEIV0(25:11)
  8848     CALL 'kxdfhei1' USING DFHEIV0,
  8849           PGM-NAME,
  8850           ERROR-MESSAGE-INTERFACE-BLOCK,
  8851           EMI-COMM-LENGTH,
  8852           DFHEIV99,
  8853           DFHEIV99,
  8854           DFHEIV99,
  8855           DFHEIV99
  8856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8857     END-IF
  8858     .
  8859 9900-EXIT.
  8860     EXIT.
  8861 9990-ABEND.
  8862     MOVE LINK-004               TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 155
* EL6318.cbl
  8863     MOVE DFHEIBLK               TO EMI-LINE1.
  8864
  8865* EXEC CICS LINK
  8866*        PROGRAM   (PGM-NAME)
  8867*        COMMAREA  (EMI-LINE1)
  8868*        LENGTH    (72)
  8869*    END-EXEC.
  8870     MOVE 72
  8871       TO DFHEIV11
  8872*    MOVE '."C                   (   #00007892' TO DFHEIV0
  8873     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8874     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8875     MOVE X'2020233030303037383932' TO DFHEIV0(25:11)
  8876     CALL 'kxdfhei1' USING DFHEIV0,
  8877           PGM-NAME,
  8878           EMI-LINE1,
  8879           DFHEIV11,
  8880           DFHEIV99,
  8881           DFHEIV99,
  8882           DFHEIV99,
  8883           DFHEIV99
  8884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8885
  8886     GO TO 8200-SEND-DATAONLY.
  8887
  8888* GOBACK.
  8889     MOVE '9%                    "   ' TO DFHEIV0
  8890     MOVE 'EL6318' TO DFHEIV1
  8891     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8892     GOBACK.
  8893 9995-SECURITY-VIOLATION.
  8894*                            COPY ELCSCTP.
  8895******************************************************************
  8896*                                                                *
  8897*                            ELCSCTP                             *
  8898*                            VMOD=2.001                          *
  8899*                                                                *
  8900*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8901******************************************************************
  8902
  8903
  8904     MOVE EIBDATE          TO SM-JUL-DATE.
  8905     MOVE EIBTRMID         TO SM-TERMID.
  8906     MOVE THIS-PGM         TO SM-PGM.
  8907     MOVE EIBTIME          TO TIME-IN.
  8908     MOVE TIME-OUT         TO SM-TIME.
  8909     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8910
  8911
  8912* EXEC CICS LINK
  8913*         PROGRAM  ('EL003')
  8914*         COMMAREA (SECURITY-MESSAGE)
  8915*         LENGTH   (80)
  8916*    END-EXEC.
  8917     MOVE 'EL003' TO DFHEIV1
  8918     MOVE 80
  8919       TO DFHEIV11
  8920*    MOVE '."C                   (   #00007917' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:17 Page 156
* EL6318.cbl
  8921     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8922     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8923     MOVE X'2020233030303037393137' TO DFHEIV0(25:11)
  8924     CALL 'kxdfhei1' USING DFHEIV0,
  8925           DFHEIV1,
  8926           SECURITY-MESSAGE,
  8927           DFHEIV11,
  8928           DFHEIV99,
  8929           DFHEIV99,
  8930           DFHEIV99,
  8931           DFHEIV99
  8932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8933
  8934
  8935******************************************************************
  8936
  8937 9995-EXIT.
  8938     EXIT.
  8939
  8940 9999-DFHBACK SECTION.
  8941     MOVE '9%                    "   ' TO DFHEIV0
  8942     MOVE 'EL6318' TO DFHEIV1
  8943     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8944     GOBACK.
  8945 9999-DFHEXIT.
  8946     IF DFHEIGDJ EQUAL 0001
  8947         NEXT SENTENCE
  8948     ELSE IF DFHEIGDJ EQUAL 2
  8949         GO TO 8300-SEND-TEXT
  8950         DEPENDING ON DFHEIGDI.
  8951     MOVE '9%                    "   ' TO DFHEIV0
  8952     MOVE 'EL6318' TO DFHEIV1
  8953     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8954     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       34884     Code:       20406
