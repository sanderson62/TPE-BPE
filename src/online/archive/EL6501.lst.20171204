* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   1
* EL6501.cbl
* Options: int("EL6501.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6501.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6501.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6501.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL6501.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/11/94 14:25:07.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.060.
     9
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   2
* EL6501.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXC5 - ACCOUNT MAINT (GENERAL)
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    36*                                ADJUSTED MAP-R REDEFINES FILLER
    37* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    38*                          SMVA  ADD CLP TOL PCT CODE
    39* 102004                   PEMA  ADD STATUS OF CANCEL
    40* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    41* 021506  CR2006021400002  PEMA  DARKEN DCC FIELDS FOR CID
    42* 052306  CR2006050800002  PEMA  ADD COMM TYPE J
    43* 111606  CR2002061800017  PEMA  FIX ERCOMP UPDATE ROUTINE
    44* 110706  CR2006071700002  PEMA  FIX NAME LOOK UP
    45* 031607                   PEMA  PER TRWA AND KLSC DEFAULT TO P
    46* 062707  CR2007010300002  PEMA  REMOVE LEV 5 RESTRICTION FOR DCC
    47* 071207                   PEMA  ADD NEW TYPE 'M'
    48* 080807  CR2006062900001  PEMA  AUTOMATE STEPS TO CANCEL ACCT
    49* 022808  CR2007083100002  PEMA  ADD 'F' ACCT STATUS
    50* 042809    2007070200004  PEMA  ADD EDIT FOR KY ACCOUNTS
    51* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    52* 020210  CR2020010400006  PEMA  REMOVE CHANGES MADE ON 09/09
    53* 031811  CR2011012700001  PEMA  ADD 'S' ACCT STATUS
    54* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    55* 080612  CR2012042700005  PEMA  ADD OVER 120 DAYS FOR AHL
    56* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    57* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    58* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    59* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    60* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
    61******************************************************************
    62
    63 ENVIRONMENT DIVISION.
    64 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   3
* EL6501.cbl
    66 WORKING-STORAGE SECTION.
    67 01  DFH-START PIC X(04).
    68 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP.
    69 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    70                                   USAGE POINTER.
    71 77  FILLER  PIC X(32)  VALUE '********************************'.
    72 77  FILLER  PIC X(32)  VALUE '*    EL6501 WORKING STORAGE    *'.
    73 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.060 ***********'.
    74 77  WS-LAST-DATE-RANGE-SW       PIC X    VALUE SPACES.
    75     88  ON-LAST-DATE-RANGE             VALUE 'Y'.
    76 77  WS-AUTO-CANCEL-SW           PIC X  VALUE ' '.
    77     88  AUTO-CANCEL-ACCOUNT            VALUE 'Y'.
    78 77  WS-DELAY-INT                PIC S9(7) VALUE +2.
    79 77  WS-CHANGE-ALL-CNT           PIC S999  VALUE +0.
    80 01  WS-DEGUG-AREA.
    81     05  FILLER PIC X(20) VALUE '&&&&&& DEBUG &&&&&&&'.
    82     05  FILLER PIC X(20) VALUE '  PAGE NUMBER HERE  '.
    83     05  WS-PAGE-NUMBER PIC 99 VALUE ZEROS.
    84     05  FILLER PIC X(20) VALUE '  TOTAL LINES HERE  '.
    85     05  WS-TOTAL-LINES PIC 99 VALUE ZEROS.
    86     05  FILLER PIC X(20) VALUE ' LINE SELECTED HERE '.
    87     05  WS-LINE-SELECTED PIC 99 VALUE ZEROS.
    88     05  FILLER PIC X(20) VALUE '&&&&&& DEBUG &&&&&&&'.
    89 01  S1                          PIC S999   VALUE +0    COMP.
    90 01  WS-WORK-FIELD.
    91     12  WS-WORK-NUM                 PIC 9(5)    VALUE ZEROS.
    92 01  WS-COMM-LENGTH              PIC S9(4) COMP VALUE +1500.
    93 01  WS-DATE-AREA.
    94     12  SAVE-DATE               PIC X(8)    VALUE SPACES.
    95     12  SAVE-BIN-DATE           PIC XX      VALUE SPACES.
    96
    97***DMD CUSTOM CODE *****START
    98     12  WS-DMD-EXPR-DATE        PIC 9(8) COMP-3.
    99     12  WS-DMD-AGENT            PIC X(10).
   100     12  WS-YYYYMMDD             PIC X(8).
   101     12  WS-COMP-DATE REDEFINES WS-YYYYMMDD
   102                                 PIC 9(8).
   103***DMD CUSTOM CODE *****END
   104
   105 01  WS-ACCOUNT-NUM-AREA.
   106     12  WS-ACCOUNT-FILLER       PIC X(06).
   107     12  WS-ACCT-BRANCH-CD       PIC X(04).
   108
   109 01  WS-NAME-AREA.
   110     12  WS-NAME-1-4             PIC X(04).
   111     12  WS-NAME-FILLER          PIC X(26).
   112
   113 01  STANDARD-AREAS.
   114     12  WS-STATE-MAX-SW         PIC X       VALUE ' '.
   115         88  EXCEEDS-STATE-MAX      VALUE 'Y'.
   116     12  WS-RESPONSE             PIC S9(8)   COMP.
   117         88  RESP-NORMAL                  VALUE +00.
   118         88  RESP-NOTFND                  VALUE +13.
   119         88  RESP-DUPREC                  VALUE +14.
   120         88  RESP-DUPKEY                  VALUE +15.
   121         88  RESP-NOTOPEN                 VALUE +19.
   122         88  RESP-ENDFILE                 VALUE +20.
   123
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   4
* EL6501.cbl
   124     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   125     12  MAP-NAME                PIC X(8)    VALUE 'EL6501A'.
   126     12  MAPSET-NAME             PIC X(8)    VALUE 'EL6501S'.
   127     12  SCREEN-NUMBER           PIC X(4)    VALUE '650B'.
   128     12  TRANS-ID                PIC X(4)    VALUE 'EXC5'.
   129     12  THIS-PGM                PIC X(8)    VALUE 'EL6501'.
   130     12  PGM-NAME                PIC X(8).
   131     12  TIME-IN                 PIC S9(7).
   132     12  TIME-OUT-R REDEFINES TIME-IN.
   133         16  FILLER              PIC X.
   134         16  TIME-OUT            PIC 99V99.
   135         16  FILLER              PIC XX.
   136     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   137     12  XCTL-010                PIC X(8)    VALUE 'EL010'.
   138     12  XCTL-126                PIC X(8)    VALUE 'EL126'.
   139     12  XCTL-601                PIC X(8)    VALUE 'EL601'.
   140     12  XCTL-608                PIC X(8)    VALUE 'EL608'.
   141     12  XCTL-626                PIC X(8)    VALUE 'EL626'.
   142     12  XCTL-650                PIC X(8)    VALUE 'EL650'.
   143     12  XCTL-6502               PIC X(8)    VALUE 'EL6502'.
   144     12  XCTL-6503               PIC X(8)    VALUE 'EL6503'.
   145     12  XCTL-6504               PIC X(8)    VALUE 'EL6504'.
   146     12  XCTL-6505               PIC X(8)    VALUE 'EL6505'.
   147     12  XCTL-6506               PIC X(8)    VALUE 'EL6506'.
   148     12  XCTL-652                PIC X(8)    VALUE 'EL652'.
   149     12  XCTL-689                PIC X(8)    VALUE 'EL689'.
   150     12  XCTL-690                PIC X(8)    VALUE 'EL690'.
   151     12  XCTL-653                PIC X(8)    VALUE 'EL653'.
   152     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   153     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   154     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   155     12  FILE-ID                 PIC X(8).
   156     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   157     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   158     12  ERACNT-FILE-ID          PIC X(8)    VALUE 'ERACNT'.
   159     12  REIN-FILE-ID            PIC X(8)    VALUE 'ERREIN'.
   160     12  COMM-FILE-ID            PIC X(8)    VALUE 'ERCTBL'.
   161     12  COMP-FILE-ID            PIC X(8)    VALUE 'ERCOMP'.
   162     12  NAME-FILE-ID            PIC X(8)    VALUE 'ERNAME'.
   163     12  RQST-FILE-ID            PIC X(8)    VALUE 'ERRQST'.
   164     12  RQST3-FILE-ID           PIC X(8)    VALUE 'ERRQST3'.
   165     12  ERGXRF-FILE-ID          PIC X(8)    VALUE 'ERGXRF'.
   166     12  ACCT-REC-LEN            PIC S9(4)   VALUE +2000  COMP.
   167     12  ERACNT-REC-LEN          PIC S9(4)   VALUE +120   COMP.
   168     12  SC-ITEM                 PIC S9(4)   VALUE +1     COMP.
   169     12  COMP-REC-LEN            PIC S9(4)   VALUE +700   COMP.
   170     12  NAME-REC-LEN            PIC S9(4)   VALUE +160   COMP.
   171     12  ERGXRF-REC-LEN          PIC S9(4)   VALUE +0     COMP.
   172     12  ERGXRF-INC-LEN          PIC S9(4)   VALUE +31    COMP.
   173     12  ERGXRF-MIN-LEN          PIC S9(4)   VALUE +109   COMP.
   174     12  ERGXRF-MAX-LEN          PIC S9(8)   VALUE +31264 COMP.
   175     12  CNTL-REC-LEN            PIC S9(4)   VALUE +750   COMP.
   176     12  JRNL-REC-LEN            PIC S9(4)   VALUE ZERO   COMP.
   177*                                copy ERCGXRF.
   178******************************************************************
   179*                                                                *
   180*                                                                *
   181*                            ERCGXRF                             *
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   5
* EL6501.cbl
   182*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   183*                            VMOD=2.002                          *
   184*                                                                *
   185*   ONLINE CREDIT SYSTEM                                         *
   186*                                                                *
   187*   FILE DESCRIPTION = GENERAL AGENT CROSS REFERENCE             *
   188*                                                                *
   189*   FILE TYPE = VSAM,KSDS                                        *
   190*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
   191*                                                                *
   192*   BASE CLUSTER NAME = ERGXRF                   RKP=2,LEN=18    *
   193*       ALTERNATE PATH = NONE                                    *
   194*                                                                *
   195*   LOG = NO                                                     *
   196*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   197*                                                                *
   198******************************************************************
   199
   200 01  AGENT-CROSS-REFERENCE.
   201     12  GX-RECORD-ID                PIC XX.
   202         88  VALID-GX-ID             VALUE 'GX'.
   203
   204     12  GX-CONTROL-PRIMARY.
   205         16  GX-COMPANY-CD           PIC X.
   206         16  GX-CARRIER              PIC X.
   207         16  GX-GROUPING             PIC X(6).
   208         16  GX-AGENT-NO             PIC X(10).
   209
   210     12  GX-MAINT-INFORMATION.
   211         16  GX-LAST-MAINT-DT        PIC XX.
   212         16  GX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
   213         16  GX-LAST-MAINT-USER      PIC X(4).
   214         16  FILLER                  PIC X(9).
   215
   216     12  FILLER                      PIC X(37).
   217
   218     12  GX-AGENT-POINTER-CNT        PIC S9(4)  COMP.
   219
   220     12  GX-AGENT-POINTER   OCCURS 1 TO 1006 TIMES
   221                            DEPENDING ON GX-AGENT-POINTER-CNT.
   222         16  GX-AM-CARRIER           PIC X.
   223         16  GX-AM-GROUPING          PIC X(6).
   224         16  GX-AM-STATE             PIC XX.
   225         16  GX-AM-ACCOUNT           PIC X(10).
   226         16  GX-AM-EXPIRATION-DT     PIC XX.
   227         16  GX-AM-LEVEL-NO          PIC S9(4)     COMP.
   228         16  GX-LAST-BILL-DT         PIC XX.
   229         16  GX-AM-EFF-DT            PIC XX.
   230         16  FILLER                  PIC X(4).
   231
   232******************************************************************
   233 01  ERPDEF-KEY-SAVE             PIC X(18).
   234 01  ERPDEF-KEY.
   235     12  ERPDEF-COMPANY-CD       PIC X.
   236     12  ERPDEF-STATE            PIC XX.
   237     12  ERPDEF-PROD-CD          PIC XXX.
   238     12  F                       PIC X(7).
   239     12  ERPDEF-BEN-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   6
* EL6501.cbl
   240     12  ERPDEF-BEN-CODE         PIC XX.
   241     12  ERPDEF-EXP-DT           PIC XX.
   242 01  WORK-AREAS-AND-SWITCHES.
   243     12  ws-comp-cd-dis          pic s9(4) comp value +0.
   244     12  filler redefines ws-comp-cd-dis.
   245         16  filler              pic x.
   246         16  ws-comp-cd          pic x.
   247     12  W-ONE                   PIC S9(04)  COMP   VALUE +1.
   248     12  WS-TABLE-MAX            PIC S9V9(4) COMP-3 VALUE +0.
   249     12  WS-ST-COMMISSION-CAPS.
   250         16  WS-ST-COMM-CAP-SL   PIC S9V9(4) COMP-3 VALUE +0.
   251         16  WS-ST-COMM-CAP-JL   PIC S9V9(4) COMP-3 VALUE +0.
   252         16  WS-ST-COMM-CAP-SA   PIC S9V9(4) COMP-3 VALUE +0.
   253         16  WS-ST-COMM-CAP-JA   PIC S9V9(4) COMP-3 VALUE +0.
   254     12  WS-DCC-MAX-MARKET-FEE   PIC S9(5)   COMP-3 VALUE +100.
   255     12  WS-COMM-CAP-LIMIT-TO    PIC X.
   256         88  WS-LIMIT-TO-ACCOUNT             VALUE 'A'.
   257
   258     12  COMMISSION-ACCUMS.
   259         16  COMM-SL-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   260         16  COMM-JL-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   261         16  COMM-AH-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   262         16  COMM-MFEE-ACCUM     PIC S9(5)   COMP-3 VALUE ZERO.
   263
   264     12  SAVE-FIN-RESP           PIC X(10)   VALUE SPACES.
   265     12  SAVE-ACCT-AGENT         PIC X(10)   VALUE SPACES.
   266     12  SAVE-NEW-ACCT-AGENT     PIC X(10)   VALUE SPACES.
   267     12  SUB1                    PIC S9(4)   VALUE +0 COMP.
   268     12  WS-NDX                  PIC S9(5)   VALUE +0 COMP-3.
   269     12  CURRENT-SAVE            PIC 9(8).
   270     12  BIN-CURRENT-SAVE        PIC XX.
   271     12  CYMD-CURRENT-SAVE       PIC 9(8).
   272     12  SUB                     PIC 99.
   273     12  AGT-SUB                 PIC 99      VALUE ZEROS.
   274     12  VALID-AGT-SW            PIC X       VALUE 'N'.
   275     12  CHANGE-WAS-MADE-SW      PIC X       VALUE 'N'.
   276         88  CHANGE-WAS-MADE                 VALUE 'Y'.
   277
   278     12  WS-EDIT-BEN-CODE        PIC XX.
   279         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   280                                          '90' THRU '99'.
   281
   282     12  WS-KEY-SAVE.
   283           18  WS-ACCT-CCGSA-KEY.
   284             20  WS-ACCT-CO             PIC X.
   285             20  WS-ACCT-CARRIER        PIC X.
   286             20  WS-ACCT-GROUPING       PIC X(6).
   287             20  WS-ACCT-STATE          PIC XX.
   288             20  WS-ACCT-ACCOUNT        PIC X(10).
   289           18  WS-ACCT-EXP-DT           PIC XX.
   290           18  WS-ACCT-REST-OF-EXP      PIC X(4).
   291
   292     12  DEEDIT-FIELD                   PIC X(15).
   293     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD   PIC S9(15).
   294     12  DEEDIT-FIELD-V1 REDEFINES DEEDIT-FIELD   PIC S9(14)V9.
   295     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD   PIC S9(13)V99.
   296     12  DEEDIT-FIELD-V5 REDEFINES DEEDIT-FIELD   PIC S9(10)V9(5).
   297     12  DEEDIT-FIELD-V6 REDEFINES DEEDIT-FIELD   PIC S9(9)V9(6).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   7
* EL6501.cbl
   298
   299     12  ELCNTL-KEY.
   300         16  CNTL-COMP-ID        PIC XXX.
   301         16  CNTL-REC-TYPE       PIC X.
   302         16  CNTL-ACCESS.
   303             20  FILLER          PIC X(4).
   304         16  CNTL-BUS REDEFINES CNTL-ACCESS.
   305             20  FILLER          PIC XX.
   306             20  CNTL-BUS-TYPE   PIC XX.
   307         16  CNTL-BEN REDEFINES CNTL-ACCESS.
   308             20  FILLER          PIC XX.
   309             20  CNTL-BEN-TYPE   PIC XX.
   310         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   311
   312     12  REIN-KEY.
   313         16  REIN-COMP-CD        PIC X.
   314         16  REIN-CODE           PIC X.
   315         16  REIN-TABLE          PIC X(3).
   316         16  FILLER              PIC X(3).
   317
   318     12  WS-HOLD-COMM-KEY        PIC X(7) VALUE LOW-VALUES.
   319     12  COMM-KEY.
   320         16  COMM-COMP-CD        PIC X.
   321         16  COMM-TABLE          PIC XXX.
   322         16  COMM-LF-AH          PIC X.
   323         16  COMM-FILLER         PIC XX    VALUE LOW-VALUES.
   324
   325     12  RQST-KEY.
   326         16  RQST-COMPANY-CD     PIC X     VALUE SPACES.
   327         16  RQST-ENTRY-BATCH    PIC X(6)  VALUE SPACES.
   328
   329     12  RQST3-KEY.
   330         16  RQST3-COMPANY-CD    PIC X     VALUE SPACES.
   331         16  RQST3-CARRIER       PIC X     VALUE SPACES.
   332         16  RQST3-GROUPING      PIC X(6)  VALUE SPACES.
   333         16  RQST3-FIN-RESP      PIC X(10) VALUE SPACES.
   334         16  RQST3-ACCT-AGENT    PIC X(10) VALUE SPACES.
   335         16  RQST3-REFERENCE     PIC X(12) VALUE SPACES.
   336         16  RQST3-BATCH         PIC X(6)  VALUE SPACES.
   337
   338     12  SAVE-RQST3-KEY.
   339         16  FILLER              PIC X     VALUE SPACES.
   340         16  FILLER              PIC X     VALUE SPACES.
   341         16  FILLER              PIC X(6)  VALUE SPACES.
   342         16  FILLER              PIC X(10) VALUE SPACES.
   343         16  FILLER              PIC X(10) VALUE SPACES.
   344         16  FILLER              PIC X(12) VALUE SPACES.
   345         16  FILLER              PIC X(6)  VALUE SPACES.
   346
   347     12  COMP-KEY.
   348         16  COMP-COMPANY-CD     PIC X.
   349         16  COMP-CARRIER        PIC X.
   350         16  COMP-GROUPING       PIC X(6).
   351         16  COMP-RESP-NO        PIC X(10).
   352         16  COMP-ACCOUNT        PIC X(10).
   353         16  COMP-TYPE           PIC X.
   354
   355     12  WS-AXRF-KEY.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   8
* EL6501.cbl
   356         16  WS-AXRF-COMPANY-CD  PIC X.
   357         16  WS-AXRF-CARRIER     PIC X.
   358         16  WS-AXRF-GROUPING    PIC X(6).
   359         16  WS-AXRF-AGENT-NO    PIC X(10).
   360
   361     12  GX-AM-CONTROL-PRIMARY.
   362         16  GX-AM-COMPANY-CD    PIC X.
   363         16  GX-REST-OF-KEY      PIC X(20).
   364
   365     12  QID.
   366         16  QID-TERM            PIC X(4).
   367         16  FILLER              PIC X(4)    VALUE '6501'.
   368
   369     12  BROWSE-STARTED-SW       PIC X       VALUE ' '.
   370         88  BROWSE-STARTED         VALUE 'Y'.
   371     12  FIRST-TIME-SW           PIC X       VALUE ' '.
   372         88  FIRST-TIME             VALUE 'Y'.
   373
   374     12  AXRF-SUB                PIC S9(4)  COMP VALUE ZEROS.
   375     12  GX-AGENT-SUB            PIC S9(4)  COMP VALUE ZEROS.
   376     12  COMM-WORK-SUB           PIC S9(4)  COMP VALUE ZEROS.
   377     12  FIND-AGENT-SUB1         PIC S9(4)  COMP VALUE ZEROS.
   378     12  FIND-AGENT-SUB2         PIC S9(4)  COMP VALUE ZEROS.
   379     12  FIND-AGENT-SUB3         PIC S9(4)  COMP VALUE ZEROS.
   380     12  GETMAIN-SW              PIC X       VALUE SPACES.
   381     12  COMMISSION-GETMAIN-SW   PIC X       VALUE SPACES.
   382         88  GETMAIN-ACQUIRED                VALUE 'X'.
   383
   384     12  ER-0000                 PIC X(4)    VALUE '0000'.
   385     12  ER-0002                 PIC X(4)    VALUE '0002'.
   386     12  ER-0004                 PIC X(4)    VALUE '0004'.
   387     12  ER-0008                 PIC X(4)    VALUE '0008'.
   388     12  ER-0023                 PIC X(4)    VALUE '0023'.
   389     12  ER-0029                 PIC X(4)    VALUE '0029'.
   390     12  ER-0033                 PIC X(4)    VALUE '0033'.
   391     12  ER-0144                 PIC X(4)    VALUE '0144'.
   392     12  ER-0070                 PIC X(4)    VALUE '0070'.
   393     12  ER-0250                 PIC X(4)    VALUE '0250'.
   394     12  ER-0348                 PIC X(4)    VALUE '0348'.
   395     12  ER-0454                 PIC X(4)    VALUE '0454'.
   396     12  ER-0625                 PIC X(4)    VALUE '0625'.
   397     12  ER-0759                 PIC X(4)    VALUE '0759'.
   398     12  ER-0788                 PIC X(4)    VALUE '0788'.
   399     12  ER-0852                 PIC X(4)    VALUE '0852'.
   400     12  ER-0899                 PIC X(4)    VALUE '0899'.
   401     12  ER-1778                 PIC X(4)    VALUE '1778'.
   402     12  ER-1817                 PIC X(4)    VALUE '1817'.
   403     12  ER-1883                 PIC X(4)    VALUE '1883'.
   404     12  ER-1884                 PIC X(4)    VALUE '1884'.
   405     12  ER-1885                 PIC X(4)    VALUE '1885'.
   406     12  ER-1886                 PIC X(4)    VALUE '1886'.
   407     12  ER-1887                 PIC X(4)    VALUE '1887'.
   408     12  ER-2045                 PIC X(4)    VALUE '2045'.
   409     12  ER-2071                 PIC X(4)    VALUE '2071'.
   410     12  ER-2131                 PIC X(4)    VALUE '2131'.
   411*    12  ER-3057                 PIC X(4)    VALUE '3057'.
   412     12  ER-2151                 PIC X(4)    VALUE '2151'.
   413     12  ER-2152                 PIC X(4)    VALUE '2152'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   9
* EL6501.cbl
   414     12  ER-2153                 PIC X(4)    VALUE '2153'.
   415     12  ER-2154                 PIC X(4)    VALUE '2154'.
   416     12  ER-2155                 PIC X(4)    VALUE '2155'.
   417     12  ER-2156                 PIC X(4)    VALUE '2156'.
   418     12  ER-2157                 PIC X(4)    VALUE '2157'.
   419     12  ER-2158                 PIC X(4)    VALUE '2158'.
   420     12  ER-2159                 PIC X(4)    VALUE '2159'.
   421     12  ER-2160                 PIC X(4)    VALUE '2160'.
   422     12  ER-2165                 PIC X(4)    VALUE '2165'.
   423     12  ER-2168                 PIC X(4)    VALUE '2168'.
   424     12  ER-2169                 PIC X(4)    VALUE '2169'.
   425     12  ER-2170                 PIC X(4)    VALUE '2170'.
   426     12  ER-2172                 PIC X(4)    VALUE '2172'.
   427     12  ER-2173                 PIC X(4)    VALUE '2173'.
   428     12  ER-2174                 PIC X(4)    VALUE '2174'.
   429     12  ER-2175                 PIC X(4)    VALUE '2175'.
   430     12  ER-2176                 PIC X(4)    VALUE '2176'.
   431     12  ER-2177                 PIC X(4)    VALUE '2177'.
   432     12  ER-2178                 PIC X(4)    VALUE '2178'.
   433     12  ER-2179                 PIC X(4)    VALUE '2179'.
   434     12  ER-2180                 PIC X(4)    VALUE '2180'.
   435     12  ER-2181                 PIC X(4)    VALUE '2181'.
   436     12  ER-2182                 PIC X(4)    VALUE '2182'.
   437     12  ER-2183                 PIC X(4)    VALUE '2183'.
   438     12  ER-2189                 PIC X(4)    VALUE '2189'.
   439     12  ER-2572                 PIC X(4)    VALUE '2572'.
   440     12  ER-2615                 PIC X(4)    VALUE '2615'.
   441     12  ER-2949                 PIC X(4)    VALUE '2949'.
   442     12  ER-2970                 PIC X(4)    VALUE '2970'.
   443     12  ER-4009                 PIC X(4)    VALUE '4009'.
   444     12  ER-4010                 PIC X(4)    VALUE '4010'.
   445     12  ER-4011                 PIC X(4)    VALUE '4011'.
   446     12  ER-4012                 PIC X(4)    VALUE '4012'.
   447     12  ER-7717                 PIC X(4)    VALUE '7717'.
   448     12  er-8156                 pic x(4)    value '8156'.
   449     12  ER-9999                 PIC X(4)    VALUE '9999'.
   450     12  ER-XXXX                 PIC X(4)    VALUE 'XXXX'.
   451
   452     12  WSS-LINE-LIAB-LIMITS.
   453         16  WSS-LF-LIMITS.
   454             20  WSS-L-TYPE          PIC  XX    VALUE SPACES.
   455             20  WSS-LF-ATT-AGE      PIC S99    VALUE +0 COMP-3.
   456             20  WSS-L-LIMITS        OCCURS 4 TIMES.
   457                 24  WSS-LF-LM-AGE   PIC S99     COMP-3.
   458                 24  WSS-LF-LM-DUR   PIC S999    COMP-3.
   459                 24  WSS-LF-LM-AMT   PIC S9(6)   COMP-3.
   460         16  WSS-AH-LIMITS.
   461             20  WSS-A-TYPE          PIC  XX    VALUE SPACES.
   462             20  WSS-AH-ATT-AGE      PIC S99    VALUE +0 COMP-3.
   463             20  WSS-A-LIMITS        OCCURS 4 TIMES.
   464                 24  WSS-AH-LM-AGE   PIC S99     COMP-3.
   465                 24  WSS-AH-LM-DUR   PIC S999    COMP-3.
   466                 24  WSS-AH-LM-MOA   PIC S9(4)   COMP-3.
   467                 24  WSS-AH-LM-AMT   PIC S9(6)   COMP-3.
   468
   469     12  WSS-COMM-STRUCTURE.
   470         16  WSS-DEFN-1.
   471             20  WSS-AGT-COMMS.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  10
* EL6501.cbl
   472                 24  WSS-AGT     PIC  X(10)   VALUE SPACES.
   473                 24  WSS-COM-TYP PIC  X       VALUE SPACES.
   474                 24  WSS-L-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   475                 24  WSS-J-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   476                 24  WSS-A-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   477                 24  FILLER      PIC X(6)     VALUE SPACES.
   478
   479     12  WS-PHONE.
   480         16  WS-PH1              PIC XXX.
   481         16  WS-PH2              PIC XXX.
   482         16  WS-PH3              PIC XXXX.
   483     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   484
   485     12  WS-LIFE-PSI             PIC S9V9(6)  VALUE +0    COMP-3.
   486     12  WS-AH-PSI               PIC S9V9(6)  VALUE +0    COMP-3.
   487     12  WS-ACCOUNT-CTR-C        PIC 99       VALUE ZEROS COMP-3.
   488     12  WS-ACCOUNT-CTR-R        PIC 99       VALUE ZEROS COMP-3.
   489     12  WS-ACCOUNT-CTR-D        PIC 99       VALUE ZEROS COMP-3.
   490     12  WS-BUS-TYPE             PIC 99.
   491     12  WS-BUS-ENTRY            PIC 99.
   492     12  WS-ANVR-DT              PIC 9(11)    VALUE ZEROS.
   493     12  WS-PEFF-DT              PIC 9(11)    VALUE ZEROS.
   494     12  WS-PEXP-DT              PIC 9(11)    VALUE ZEROS.
   495     12  WS-TOL-PREM             PIC S999V99  VALUE ZEROS.
   496     12  WS-TOL-REF              PIC S999V99  VALUE ZEROS.
   497     12  WS-TOL-CLM              PIC S999V99  VALUE ZEROS.
   498     12  WS-COMM-ERROR-SW        PIC 9   COMP-3.
   499         88  COMMISSION-ERROR    VALUE 1.
   500     12  WS-JTYPEID              PIC XX       VALUE SPACES.
   501     12  AGENT-FIND              PIC X        VALUE SPACES.
   502         88  AGENT-RECORD-NOT-FOUND           VALUE 'X'.
   503         88  ACCT-RECORD-NOT-FOUND            VALUE 'Y'.
   504         88  ACCT-LEVEL-DIFFERENT             VALUE 'Z'.
   505
   506     12  WS-ZIP-CODE.
   507         16  WS-ZIP-1            PIC X.
   508             88  WS-CANADIAN-ZIP    VALUE 'A' THRU 'Z'.
   509         16  WS-ZIP-2-3          PIC XX.
   510         16  WS-ZIP-4            PIC X.
   511         16  WS-ZIP-5            PIC X.
   512         16  WS-ZIP-6            PIC X.
   513         16  FILLER              PIC X(4).
   514     12  WS-ZIP-AM-1  REDEFINES  WS-ZIP-CODE.
   515         16  WS-ZIP-AM-1-CODE    PIC X(5).
   516         16  WS-ZIP-AM-1-PLUS4   PIC X(4).
   517         16  FILLER              PIC X.
   518     12  WS-ZIP-AM-2  REDEFINES  WS-ZIP-CODE.
   519         16  WS-ZIP-AM-2-CODE    PIC X(5).
   520         16  WS-ZIP-AM-2-DASH    PIC X.
   521         16  WS-ZIP-AM-2-PLUS4   PIC X(4).
   522     12  WS-ZIP-CAN-1  REDEFINES  WS-ZIP-CODE.
   523         16  WS-ZIP-CAN-1-POST1  PIC XXX.
   524         16  WS-ZIP-CAN-1-POST2  PIC XXX.
   525         16  FILLER              PIC X(4).
   526     12  WS-ZIP-CAN-2  REDEFINES  WS-ZIP-CODE.
   527         16  WS-ZIP-CAN-2-POST1  PIC XXX.
   528         16  FILLER              PIC X.
   529         16  WS-ZIP-CAN-2-POST2  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  11
* EL6501.cbl
   530         16  FILLER              PIC XXX.
   531     12  WS-SOC-SEC-WORK.
   532         16  WS-SS-TYPE          PIC X.
   533         16  WS-SOC-SEC          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  12
* EL6501.cbl
   535*    COPY ELCSCTM.
   536******************************************************************
   537*                                                                *
   538*                                                                *
   539*                            ELCSCTM                             *
   540*                            VMOD=2.001                          *
   541*                                                                *
   542*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   543*                                                                *
   544******************************************************************
   545 01  SECURITY-MESSAGE.
   546     12  FILLER                          PIC X(30)
   547            VALUE '** LOGIC SECURITY VIOLATION -'.
   548     12  SM-READ                         PIC X(6).
   549     12  FILLER                          PIC X(5)
   550            VALUE ' PGM='.
   551     12  SM-PGM                          PIC X(6).
   552     12  FILLER                          PIC X(5)
   553            VALUE ' OPR='.
   554     12  SM-PROCESSOR-ID                 PIC X(4).
   555     12  FILLER                          PIC X(6)
   556            VALUE ' TERM='.
   557     12  SM-TERMID                       PIC X(4).
   558     12  FILLER                          PIC XX   VALUE SPACE.
   559     12  SM-JUL-DATE                     PIC 9(5).
   560     12  FILLER                          PIC X    VALUE SPACE.
   561     12  SM-TIME                         PIC 99.99.
   562
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  13
* EL6501.cbl
   564*    COPY ELCSCRTY.
   565******************************************************************
   566*                                                                *
   567*                                                                *
   568*                            ELCSCRTY                            *
   569*                            VMOD=2.001                          *
   570*                                                                *
   571*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   572*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   573*        SAVED IN PI-SECURITY-ADDRESS.                           *
   574*                                                                *
   575******************************************************************
   576 01  SECURITY-CONTROL.
   577     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   578     12  FILLER                       PIC XX    VALUE 'SC'.
   579     12  SC-CREDIT-CODES.
   580         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   581             20  SC-CREDIT-DISPLAY    PIC X.
   582             20  SC-CREDIT-UPDATE     PIC X.
   583     12  SC-CLAIMS-CODES.
   584         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   585             20  SC-CLAIMS-DISPLAY    PIC X.
   586             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  14
* EL6501.cbl
   588*    COPY ELCLOGOF.
   589******************************************************************
   590*                                                                *
   591*                                                                *
   592*                            ELCLOGOF.                           *
   593*                            VMOD=2.001                          *
   594*                                                                *
   595*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   596*                                                                *
   597******************************************************************
   598 01  CLASIC-LOGOFF.
   599     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   600     12  LOGOFF-TEXT.
   601         16  FILLER          PIC X(5)    VALUE SPACES.
   602         16  LOGOFF-MSG.
   603             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   604             20  FILLER      PIC X       VALUE SPACES.
   605             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   606         16  FILLER          PIC X(80)
   607           VALUE '* YOU ARE NOW LOGGED OFF'.
   608         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   609         16  FILLER          PIC X       VALUE QUOTE.
   610         16  LOGOFF-SYS-MSG  PIC X(17)
   611           VALUE 'S CLAS-IC SYSTEM '.
   612     12  TEXT-MESSAGES.
   613         16  UNACCESS-MSG    PIC X(29)
   614             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   615         16  PGMIDERR-MSG    PIC X(17)
   616             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  15
* EL6501.cbl
   618*    COPY ELCDATE.
   619******************************************************************
   620*                                                                *
   621*                                                                *
   622*                            ELCDATE.                            *
   623*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   624*                            VMOD=2.003
   625*                                                                *
   626*                                                                *
   627*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   628*                 LENGTH = 200                                   *
   629******************************************************************
   630
   631 01  DATE-CONVERSION-DATA.
   632     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   633     12  DC-OPTION-CODE                PIC X.
   634         88  BIN-TO-GREG                VALUE ' '.
   635         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   636         88  EDIT-GREG-TO-BIN           VALUE '2'.
   637         88  YMD-GREG-TO-BIN            VALUE '3'.
   638         88  MDY-GREG-TO-BIN            VALUE '4'.
   639         88  JULIAN-TO-BIN              VALUE '5'.
   640         88  BIN-PLUS-ELAPSED           VALUE '6'.
   641         88  FIND-CENTURY               VALUE '7'.
   642         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   643         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   644         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   645         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   646         88  JULIAN-TO-BIN-3            VALUE 'C'.
   647         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   648         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   649         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   650         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   651         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   652         88  CHECK-LEAP-YEAR            VALUE 'H'.
   653         88  BIN-3-TO-GREG              VALUE 'I'.
   654         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   655         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   656         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   657         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   658         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   659         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   660         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   661         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   662         88  THREE-CHARACTER-BIN
   663                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   664         88  GREGORIAN-TO-BIN
   665                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   666         88  BIN-TO-GREGORIAN
   667                  VALUES ' ' '1' 'I' '8' 'G'.
   668         88  JULIAN-TO-BINARY
   669                  VALUES '5' 'C' 'E' 'F'.
   670     12  DC-ERROR-CODE                 PIC X.
   671         88  NO-CONVERSION-ERROR        VALUE ' '.
   672         88  DATE-CONVERSION-ERROR
   673                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   674         88  DATE-IS-ZERO               VALUE '1'.
   675         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  16
* EL6501.cbl
   676         88  DATE-IS-INVALID            VALUE '3'.
   677         88  DATE1-GREATER-DATE2        VALUE '4'.
   678         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   679         88  DATE-INVALID-OPTION        VALUE '9'.
   680         88  INVALID-CENTURY            VALUE 'A'.
   681         88  ONLY-CENTURY               VALUE 'B'.
   682         88  ONLY-LEAP-YEAR             VALUE 'C'.
   683         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   684     12  DC-END-OF-MONTH               PIC X.
   685         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   686     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   687         88  USE-NORMAL-PROCESS         VALUE ' '.
   688         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   689         88  ADJUST-UP-100-YRS          VALUE '2'.
   690     12  FILLER                        PIC X.
   691     12  DC-CONVERSION-DATES.
   692         16  DC-BIN-DATE-1             PIC XX.
   693         16  DC-BIN-DATE-2             PIC XX.
   694         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   695         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   696                       DC-GREG-DATE-1-EDIT.
   697             20  DC-EDIT1-MONTH        PIC 99.
   698             20  SLASH1-1              PIC X.
   699             20  DC-EDIT1-DAY          PIC 99.
   700             20  SLASH1-2              PIC X.
   701             20  DC-EDIT1-YEAR         PIC 99.
   702         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   703         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   704                     DC-GREG-DATE-2-EDIT.
   705             20  DC-EDIT2-MONTH        PIC 99.
   706             20  SLASH2-1              PIC X.
   707             20  DC-EDIT2-DAY          PIC 99.
   708             20  SLASH2-2              PIC X.
   709             20  DC-EDIT2-YEAR         PIC 99.
   710         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   711         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   712                     DC-GREG-DATE-1-YMD.
   713             20  DC-YMD-YEAR           PIC 99.
   714             20  DC-YMD-MONTH          PIC 99.
   715             20  DC-YMD-DAY            PIC 99.
   716         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   717         16  DC-GREG-DATE-1-MDY-R REDEFINES
   718                      DC-GREG-DATE-1-MDY.
   719             20  DC-MDY-MONTH          PIC 99.
   720             20  DC-MDY-DAY            PIC 99.
   721             20  DC-MDY-YEAR           PIC 99.
   722         16  DC-GREG-DATE-1-ALPHA.
   723             20  DC-ALPHA-MONTH        PIC X(10).
   724             20  DC-ALPHA-DAY          PIC 99.
   725             20  FILLER                PIC XX.
   726             20  DC-ALPHA-CENTURY.
   727                 24 DC-ALPHA-CEN-N     PIC 99.
   728             20  DC-ALPHA-YEAR         PIC 99.
   729         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   730         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   731         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   732         16  DC-JULIAN-DATE            PIC 9(05).
   733         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  17
* EL6501.cbl
   734                                       PIC 9(05).
   735         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   736             20  DC-JULIAN-YEAR        PIC 99.
   737             20  DC-JULIAN-DAYS        PIC 999.
   738         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   739         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   740         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   741     12  DATE-CONVERSION-VARIBLES.
   742         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   743         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   744             20  FILLER                PIC 9(3).
   745             20  HOLD-CEN-1-CCYY.
   746                 24  HOLD-CEN-1-CC     PIC 99.
   747                 24  HOLD-CEN-1-YY     PIC 99.
   748             20  HOLD-CEN-1-MO         PIC 99.
   749             20  HOLD-CEN-1-DA         PIC 99.
   750         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   751             20  HOLD-CEN-1-R-MO       PIC 99.
   752             20  HOLD-CEN-1-R-DA       PIC 99.
   753             20  HOLD-CEN-1-R-CCYY.
   754                 24  HOLD-CEN-1-R-CC   PIC 99.
   755                 24  HOLD-CEN-1-R-YY   PIC 99.
   756             20  FILLER                PIC 9(3).
   757         16  HOLD-CENTURY-1-X.
   758             20  FILLER                PIC X(3)  VALUE SPACES.
   759             20  HOLD-CEN-1-X-CCYY.
   760                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   761                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   762             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   763             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   764         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   765             20  HOLD-CEN-1-R-X-MO     PIC XX.
   766             20  HOLD-CEN-1-R-X-DA     PIC XX.
   767             20  HOLD-CEN-1-R-X-CCYY.
   768                 24  HOLD-CEN-1-R-X-CC PIC XX.
   769                 24  HOLD-CEN-1-R-X-YY PIC XX.
   770             20  FILLER                PIC XXX.
   771         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   772         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   773         16  DC-JULIAN-DATE-1          PIC 9(07).
   774         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   775             20  DC-JULIAN-1-CCYY.
   776                 24  DC-JULIAN-1-CC    PIC 99.
   777                 24  DC-JULIAN-1-YR    PIC 99.
   778             20  DC-JULIAN-DA-1        PIC 999.
   779         16  DC-JULIAN-DATE-2          PIC 9(07).
   780         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   781             20  DC-JULIAN-2-CCYY.
   782                 24  DC-JULIAN-2-CC    PIC 99.
   783                 24  DC-JULIAN-2-YR    PIC 99.
   784             20  DC-JULIAN-DA-2        PIC 999.
   785         16  DC-GREG-DATE-A-EDIT.
   786             20  DC-EDITA-MONTH        PIC 99.
   787             20  SLASHA-1              PIC X VALUE '/'.
   788             20  DC-EDITA-DAY          PIC 99.
   789             20  SLASHA-2              PIC X VALUE '/'.
   790             20  DC-EDITA-CCYY.
   791                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  18
* EL6501.cbl
   792                 24  DC-EDITA-YEAR     PIC 99.
   793         16  DC-GREG-DATE-B-EDIT.
   794             20  DC-EDITB-MONTH        PIC 99.
   795             20  SLASHB-1              PIC X VALUE '/'.
   796             20  DC-EDITB-DAY          PIC 99.
   797             20  SLASHB-2              PIC X VALUE '/'.
   798             20  DC-EDITB-CCYY.
   799                 24  DC-EDITB-CENT     PIC 99.
   800                 24  DC-EDITB-YEAR     PIC 99.
   801         16  DC-GREG-DATE-CYMD         PIC 9(08).
   802         16  DC-GREG-DATE-CYMD-R REDEFINES
   803                              DC-GREG-DATE-CYMD.
   804             20  DC-CYMD-CEN           PIC 99.
   805             20  DC-CYMD-YEAR          PIC 99.
   806             20  DC-CYMD-MONTH         PIC 99.
   807             20  DC-CYMD-DAY           PIC 99.
   808         16  DC-GREG-DATE-MDCY         PIC 9(08).
   809         16  DC-GREG-DATE-MDCY-R REDEFINES
   810                              DC-GREG-DATE-MDCY.
   811             20  DC-MDCY-MONTH         PIC 99.
   812             20  DC-MDCY-DAY           PIC 99.
   813             20  DC-MDCY-CEN           PIC 99.
   814             20  DC-MDCY-YEAR          PIC 99.
   815    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   816        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   817    12  DC-EL310-DATE                  PIC X(21).
   818    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  19
* EL6501.cbl
   820*    COPY ELCATTR.
   821******************************************************************
   822*                                                                *
   823*                            ELCATTR.                            *
   824*                            VMOD=2.001                          *
   825*                                                                *
   826*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   827*                                                                *
   828*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   829*                                                                *
   830*                   POS 1   P=PROTECTED                          *
   831*                           U=UNPROTECTED                        *
   832*                           S=ASKIP                              *
   833*                   POS 2   A=ALPHA/NUMERIC                      *
   834*                           N=NUMERIC                            *
   835*                   POS 3   N=NORMAL                             *
   836*                           B=BRIGHT                             *
   837*                           D=DARK                               *
   838*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   839*                           OF=MODIFIED DATA TAG OFF             *
   840*                                                                *
   841*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   842******************************************************************
   843 01  ATTRIBUTE-LIST.
   844     12  AL-PABOF            PIC X       VALUE 'Y'.
   845     12  AL-PABON            PIC X       VALUE 'Z'.
   846     12  AL-PADOF            PIC X       VALUE '%'.
   847     12  AL-PADON            PIC X       VALUE '_'.
   848     12  AL-PANOF            PIC X       VALUE '-'.
   849     12  AL-PANON            PIC X       VALUE '/'.
   850     12  AL-SABOF            PIC X       VALUE '8'.
   851     12  AL-SABON            PIC X       VALUE '9'.
   852     12  AL-SADOF            PIC X       VALUE '@'.
   853     12  AL-SADON            PIC X       VALUE QUOTE.
   854     12  AL-SANOF            PIC X       VALUE '0'.
   855     12  AL-SANON            PIC X       VALUE '1'.
   856     12  AL-UABOF            PIC X       VALUE 'H'.
   857     12  AL-UABON            PIC X       VALUE 'I'.
   858     12  AL-UADOF            PIC X       VALUE '<'.
   859     12  AL-UADON            PIC X       VALUE '('.
   860     12  AL-UANOF            PIC X       VALUE ' '.
   861     12  AL-UANON            PIC X       VALUE 'A'.
   862     12  AL-UNBOF            PIC X       VALUE 'Q'.
   863     12  AL-UNBON            PIC X       VALUE 'R'.
   864     12  AL-UNDOF            PIC X       VALUE '*'.
   865     12  AL-UNDON            PIC X       VALUE ')'.
   866     12  AL-UNNOF            PIC X       VALUE '&'.
   867     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  20
* EL6501.cbl
   869*    COPY ELCEMIB.
   870******************************************************************
   871*                                                                *
   872*                                                                *
   873*                            ELCEMIB.                            *
   874*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   875*                            VMOD=2.005                          *
   876*                                                                *
   877*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   878*                                                                *
   879******************************************************************
   880 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   881     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   882     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   883     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   884     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   885     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   886     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   887     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   888     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   889     12  EMI-SWITCH1             PIC X        VALUE '1'.
   890         88  EMI-NO-ERRORS                    VALUE '1'.
   891         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   892         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   893     12  EMI-SWITCH2             PIC X        VALUE '1'.
   894         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   895     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   896         88  EMI-AREA1-EMPTY                  VALUE '1'.
   897         88  EMI-AREA1-FULL                   VALUE '2'.
   898     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   899         88  EMI-AREA2-EMPTY                  VALUE '1'.
   900         88  EMI-AREA2-FULL                   VALUE '2'.
   901     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   902         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   903         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   904         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   905         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   906         88  EMI-BYPASS-FATALS                VALUE 'X'.
   907     12  EMI-ERROR-LINES.
   908         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   909         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   910         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   911         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   912             20  EMI-ERR-CODES OCCURS 10 TIMES.
   913                 24  EMI-ERR-NUM         PIC X(4).
   914                 24  EMI-FILLER          PIC X.
   915                 24  EMI-SEV             PIC X.
   916                 24  FILLER              PIC X.
   917             20  FILLER                  PIC X(02).
   918     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   919         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   920             20  EMI-ERROR-NUMBER    PIC X(4).
   921             20  EMI-FILL            PIC X.
   922             20  EMI-SEVERITY        PIC X.
   923             20  FILLER              PIC X.
   924             20  EMI-ERROR-TEXT.
   925                 24  EMI-TEXT-VARIABLE   PIC X(10).
   926                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  21
* EL6501.cbl
   927     12  EMI-SEVERITY-SAVE           PIC X.
   928         88  EMI-NOTE                    VALUE 'N'.
   929         88  EMI-WARNING                 VALUE 'W'.
   930         88  EMI-FORCABLE                VALUE 'F'.
   931         88  EMI-FATAL                   VALUE 'X'.
   932     12  EMI-MESSAGE-FLAG            PIC X.
   933         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   934         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   935     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   936     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   937         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   938         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   939         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   940     12  emi-claim-no                pic x(7).
   941     12  emi-claim-type              pic x(6).
   942     12  FILLER                      PIC X(124)  VALUE SPACES.
   943     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   944     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   945     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   946     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  22
* EL6501.cbl
   948*    COPY ELCINTF.
   949******************************************************************
   950*                                                                *
   951*                                                                *
   952*                            ELCINTF.                            *
   953*                            VMOD=2.017                          *
   954*                                                                *
   955*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   956*                                                                *
   957*       LENGTH = 1024                                            *
   958*                                                                *
   959******************************************************************
   960*                   C H A N G E   L O G
   961*
   962* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   963*-----------------------------------------------------------------
   964*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   965* EFFECTIVE    NUMBER
   966*-----------------------------------------------------------------
   967* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   968******************************************************************
   969 01  PROGRAM-INTERFACE-BLOCK.
   970     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   971     12  PI-CALLING-PROGRAM              PIC X(8).
   972     12  PI-SAVED-PROGRAM-1              PIC X(8).
   973     12  PI-SAVED-PROGRAM-2              PIC X(8).
   974     12  PI-SAVED-PROGRAM-3              PIC X(8).
   975     12  PI-SAVED-PROGRAM-4              PIC X(8).
   976     12  PI-SAVED-PROGRAM-5              PIC X(8).
   977     12  PI-SAVED-PROGRAM-6              PIC X(8).
   978     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   979     12  PI-COMPANY-ID                   PIC XXX.
   980     12  PI-COMPANY-CD                   PIC X.
   981
   982     12  PI-COMPANY-PASSWORD             PIC X(8).
   983
   984     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   985
   986     12  PI-CONTROL-IN-PROGRESS.
   987         16  PI-CARRIER                  PIC X.
   988         16  PI-GROUPING                 PIC X(6).
   989         16  PI-STATE                    PIC XX.
   990         16  PI-ACCOUNT                  PIC X(10).
   991         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   992                                         PIC X(10).
   993         16  PI-CLAIM-CERT-GRP.
   994             20  PI-CLAIM-NO             PIC X(7).
   995             20  PI-CERT-NO.
   996                 25  PI-CERT-PRIME       PIC X(10).
   997                 25  PI-CERT-SFX         PIC X.
   998             20  PI-CERT-EFF-DT          PIC XX.
   999         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1000             20  PI-PLAN-CODE            PIC X(2).
  1001             20  PI-REVISION-NUMBER      PIC X(3).
  1002             20  PI-PLAN-EFF-DT          PIC X(2).
  1003             20  PI-PLAN-EXP-DT          PIC X(2).
  1004             20  FILLER                  PIC X(11).
  1005         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  23
* EL6501.cbl
  1006             20  PI-OE-REFERENCE-1.
  1007                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1008                 25  PI-OE-REF-1-SUFF    PIC XX.
  1009
  1010     12  PI-SESSION-IN-PROGRESS          PIC X.
  1011         88  CLAIM-SESSION                   VALUE '1'.
  1012         88  CREDIT-SESSION                  VALUE '2'.
  1013         88  WARRANTY-SESSION                VALUE '3'.
  1014         88  MORTGAGE-SESSION                VALUE '4'.
  1015         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1016
  1017
  1018*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1019
  1020     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1021     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1022
  1023     12  PI-CREDIT-USER                  PIC X.
  1024         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1025         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1026
  1027     12  PI-CLAIM-USER                   PIC X.
  1028         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1029         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1030
  1031     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1032         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1033         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1034         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1035         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1036         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1037
  1038     12  PI-PROCESSOR-ID                 PIC X(4).
  1039
  1040     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1041
  1042     12  PI-MEMBER-CAPTION               PIC X(10).
  1043
  1044     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1045         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1046
  1047     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1048     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1049     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1050     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1051
  1052     12  PI-AH-OVERRIDE-L1               PIC X.
  1053     12  PI-AH-OVERRIDE-L2               PIC XX.
  1054     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1055     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1056
  1057     12  PI-NEW-SYSTEM                   PIC X(2).
  1058
  1059     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1060     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1061         88  PI-USES-PAID-TO                 VALUE '1'.
  1062     12  PI-CRDTCRD-SYSTEM.
  1063         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  24
* EL6501.cbl
  1064             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1065             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1066         16  PI-CC-MONTH-END-DT          PIC XX.
  1067     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1068
  1069     12  PI-OE-REFERENCE-2.
  1070         16  PI-OE-REF-2-PRIME           PIC X(10).
  1071         16  PI-OE-REF-2-SUFF            PIC X.
  1072
  1073     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1074
  1075     12  PI-LANGUAGE-TYPE                PIC X.
  1076             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1077             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1078             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1079
  1080     12  PI-POLICY-LINKAGE-IND           PIC X.
  1081         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1082         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1083                                                   LOW-VALUES.
  1084
  1085     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1086     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1087         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1088         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1089
  1090     12  PI-PROCESSOR-CSR-IND            PIC X.
  1091         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1092         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1093
  1094     12  FILLER                          PIC X(3).
  1095
  1096     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1097
  1098     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1099         PI-SYSTEM-LEVEL.
  1100
  1101         16  PI-ENTRY-CODES.
  1102             20  PI-ENTRY-CD-1           PIC X.
  1103             20  PI-ENTRY-CD-2           PIC X.
  1104
  1105         16  PI-RETURN-CODES.
  1106             20  PI-RETURN-CD-1          PIC X.
  1107             20  PI-RETURN-CD-2          PIC X.
  1108
  1109         16  PI-UPDATE-STATUS-SAVE.
  1110             20  PI-UPDATE-BY            PIC X(4).
  1111             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1112
  1113         16  PI-LOWER-CASE-LETTERS       PIC X.
  1114             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1115
  1116*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1117*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1118*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1119
  1120         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1121             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  25
* EL6501.cbl
  1122             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1123             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1124             88  ACCNT-CNTL                  VALUE '3'.
  1125             88  CARR-ACCNT-CNTL             VALUE '4'.
  1126
  1127         16  PI-PROCESSOR-CAP-LIST.
  1128             20  PI-SYSTEM-CONTROLS.
  1129                24 PI-SYSTEM-DISPLAY     PIC X.
  1130                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1131                24 PI-SYSTEM-MODIFY      PIC X.
  1132                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1133             20  FILLER                  PIC XX.
  1134             20  PI-DISPLAY-CAP          PIC X.
  1135                 88  DISPLAY-CAP             VALUE 'Y'.
  1136             20  PI-MODIFY-CAP           PIC X.
  1137                 88  MODIFY-CAP              VALUE 'Y'.
  1138             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1139                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1140             20  PI-FORCE-CAP            PIC X.
  1141                 88  FORCE-CAP               VALUE 'Y'.
  1142
  1143         16  PI-PROGRAM-CONTROLS.
  1144             20  PI-PGM-PRINT-OPT        PIC X.
  1145             20  PI-PGM-FORMAT-OPT       PIC X.
  1146             20  PI-PGM-PROCESS-OPT      PIC X.
  1147             20  PI-PGM-TOTALS-OPT       PIC X.
  1148
  1149         16  PI-HELP-INTERFACE.
  1150             20  PI-LAST-ERROR-NO        PIC X(4).
  1151             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1152
  1153         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1154             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1155
  1156         16  PI-CR-CONTROL-IN-PROGRESS.
  1157             20  PI-CR-CARRIER           PIC X.
  1158             20  PI-CR-GROUPING          PIC X(6).
  1159             20  PI-CR-STATE             PIC XX.
  1160             20  PI-CR-ACCOUNT           PIC X(10).
  1161             20  PI-CR-FIN-RESP          PIC X(10).
  1162             20  PI-CR-TYPE              PIC X.
  1163
  1164         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1165
  1166         16  PI-CR-MONTH-END-DT          PIC XX.
  1167
  1168         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1169             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1170             88  PI-ZERO-CARRIER             VALUE '1'.
  1171             88  PI-ZERO-GROUPING            VALUE '2'.
  1172             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1173
  1174         16  PI-CARRIER-SECURITY         PIC X.
  1175             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1176
  1177         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1178             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1179             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  26
* EL6501.cbl
  1180
  1181         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1182             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1183                                         INDEXED BY PI-ACCESS-NDX
  1184                                         PIC X.
  1185
  1186         16  PI-GA-BILLING-CONTROL       PIC X.
  1187             88  PI-GA-BILLING               VALUE '1'.
  1188
  1189         16  PI-MAIL-PROCESSING          PIC X.
  1190             88  PI-MAIL-YES                 VALUE 'Y'.
  1191
  1192         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1193
  1194         16  PI-AR-SYSTEM.
  1195             20  PI-AR-PROCESSING-CNTL   PIC X.
  1196                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1197             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1198             20  PI-AR-MONTH-END-DT      PIC XX.
  1199
  1200         16  PI-MP-SYSTEM.
  1201             20  PI-MORTGAGE-USER            PIC X.
  1202                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1203                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1204             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1205                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1206                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1207                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1208                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1209                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1210             20  PI-MP-MONTH-END-DT          PIC XX.
  1211             20  PI-MP-REFERENCE-NO.
  1212                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1213                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1214
  1215         16  PI-LABEL-CONTROL            PIC X(01).
  1216             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1217             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1218
  1219         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1220             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1221
  1222         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1223             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1224             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1225
  1226         16  FILLER                      PIC X(14).
  1227
  1228     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1229******************************************************************
  1230*    COPY ELC650PI.
  1231******************************************************************
  1232*
  1233*                            ELC650PI.
  1234*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1235*                            VMOD=2.007
  1236*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
  1237*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  27
* EL6501.cbl
  1238* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
  1239*
  1240******************************************************************
  1241******************************************************************
  1242*                   C H A N G E   L O G
  1243*
  1244* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1245*-----------------------------------------------------------------
  1246*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1247* EFFECTIVE    NUMBER
  1248*-----------------------------------------------------------------
  1249* 101916  IR2016101900001  PEMA  Inc tot line to 3 bytes
  1250
  1251     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1252         16  PI-MAINT                   PIC X.
  1253         16  PI-PREV-ACCOUNT            PIC X(20).
  1254         16  PI-PREV-VG-ACCOUNT         PIC X(20).
  1255         16  PI-ACCT-KEY.
  1256             20  PI-ACCT-CCGSA-KEY.
  1257                 24  PI-ACCT-CO             PIC X.
  1258                 24  PI-ACCT-CARRIER        PIC X.
  1259                 24  PI-ACCT-GROUPING       PIC X(6).
  1260                 24  PI-ACCT-STATE          PIC XX.
  1261                 24  PI-ACCT-ACCOUNT        PIC X(10).
  1262             20  PI-ACCT-EXP-DT           PIC XX.
  1263             20  PI-ACCT-REST-OF-EXP      PIC X(4).
  1264         16  PI-ACCT-ID                 PIC X(8).
  1265         16  PI-PLAN-KEY.
  1266             20  PI-PLAN-ACCT-KEY.
  1267                 24  PI-PLAN-COMPANY-CD PIC X.
  1268                 24  PI-PLAN-CARRIER    PIC X.
  1269                 24  PI-PLAN-GROUP      PIC X(6).
  1270                 24  PI-PLAN-STATE      PIC X(2).
  1271                 24  PI-PLAN-ACCOUNT    PIC X(10).
  1272             20  PI-PLAN-BEN-TYPE       PIC X.
  1273             20  PI-PLAN-BEN            PIC XX.
  1274             20  PI-PLAN-REVISION       PIC X(3).
  1275         16  PI-WS-STATE                PIC XX.
  1276         16  PI-WS-CLASS                PIC XX.
  1277         16  PI-WS-DEV                  PIC X(3).
  1278         16  PI-WS-TYPE                 PIC X.
  1279         16  PI-WS-PLAN                 PIC XX.
  1280
  1281         16  PI-ERPNDB-ALT-KEY.
  1282             20  PI-PB-COMPANY-CD-A1    PIC X.
  1283             20  PI-PB-CARRIER          PIC X.
  1284             20  PI-PB-GROUPING         PIC X(6).
  1285             20  PI-PB-STATE            PIC XX.
  1286             20  PI-PB-ACCOUNT          PIC X(10).
  1287             20  PI-PB-CERT-EFF-DT      PIC XX.
  1288             20  PI-PB-CERT-NO          PIC X(10).
  1289             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
  1290             20  PI-PB-RECORD-TYPE      PIC X.
  1291
  1292         16  PI-DATE-RANGE-TABLE.
  1293             20  PI-TABLE-ENT OCCURS 32 TIMES
  1294                            INDEXED BY T-INDEX.
  1295                 24  PI-BIN-EFF-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  28
* EL6501.cbl
  1296                 24  PI-BIN-EXP-DT          PIC XX.
  1297                 24  PI-BIN-MAINT-DT        PIC XX.
  1298                 24  PI-BIN-LO-CERT         PIC XX.
  1299                 24  PI-BIN-AR-HI-CERT      PIC XX.
  1300                 24  PI-BIN-HI-CERT         PIC XX.
  1301         16  PI-PAGE-NUMBER             PIC S9.
  1302             88  PI-FST-PAGE               VALUE +1.
  1303             88  PI-2ND-PAGE               VALUE +2.
  1304             88  PI-3RD-PAGE               VALUE +3.
  1305             88  PI-LST-PAGE               VALUE +4.
  1306         16  PI-TOTAL-LINES             PIC S999.
  1307         16  PI-LINE-SELECTED    PIC S9.
  1308***  Y2K PROJ 7744
  1309         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
  1310         16  BIN-EFFCHG-SAVE     PIC XX.
  1311         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
  1312***  Y2K PROJ 7744
  1313         16  BIN-EXPCHG-SAVE     PIC XX.
  1314         16  PI-RECORD-ADDED-SW  PIC X.
  1315             88  PI-RECORD-ADDED            VALUE '1'.
  1316             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
  1317         16  PI-ACCNAME          PIC X(30).
  1318         16  PI-COMM-POINTER     PIC S9(8)   COMP.
  1319         16  PI-SV-MAINT         PIC X.
  1320         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
  1321         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
  1322         16  PI-UPDATE-SW        PIC X.
  1323             88  PI-CHANGES-MADE             VALUE '1'.
  1324         16  PI-NOTE-TYPE        PIC X.
  1325             88  PI-ACCT-NOTE                VALUE '1'.
  1326         16  PI-DMD-FILE-SW      PIC X.
  1327             88  END-OF-FILE                 VALUE 'E'.
  1328             88  INTO-NEXT-BENEFITS          VALUE 'I'.
  1329             88  FIRST-OCCURS                VALUE 'F'.
  1330         16  PI-DMD-OCCURS       PIC S999.
  1331         16  PI-DMD-SCREEN       PIC X.
  1332             88  SCREEN-1-DISPLAYED  VALUE '1'.
  1333             88  SCREEN-2-DISPLAYED  VALUE '2'.
  1334             88  SCREEN-3-DISPLAYED  VALUE '3'.
  1335         16  PI-NAMEFLG          PIC X.
  1336         16  PI-EL650-DEL-SW     PIC X.
  1337         16  PI-MAX-MFEE         PIC S9(5) COMP-3.
  1338         16  PI-DCC-PROD-CODE    PIC XXX.
  1339         16  FILLER              PIC X(34).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  29
* EL6501.cbl
  1341
  1342*    COPY ELCJPFX.
  1343******************************************************************
  1344*                                                                *
  1345*                                                                *
  1346*                            ELCJPFX.                            *
  1347*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1348*                            VMOD=2.002                          *
  1349*                                                                *
  1350*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1351*                                                                *
  1352*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1353*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1354*        ELCNTL - CONTROL FILE                                   *
  1355*        ELMSTR - CLAIM MASTERS                                  *
  1356*        ELTRLR - ACTIVITY TRAILERS                              *
  1357*        ELCHKQ - CHECK QUE                                      *
  1358******************************************************************
  1359 01  JOURNAL-RECORD.
  1360     12  jp-date                     pic s9(5) comp-3.
  1361     12  jp-time                     pic s9(7) comp-3.
  1362     12  JP-USER-ID                  PIC X(4).
  1363     12  JP-FILE-ID                  PIC X(8).
  1364     12  JP-PROGRAM-ID               PIC X(8).
  1365     12  JP-RECORD-TYPE              PIC X.
  1366         88 JP-ADD              VALUE 'A'.
  1367         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1368         88 JP-AFTER-CHANGE     VALUE 'C'.
  1369         88 JP-DELETE           VALUE 'D'.
  1370         88 JP-GENERIC-DELETE   VALUE 'G'.
  1371         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1372         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1373     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1374     12  JP-RECORD-AREA
  1375
  1376
  1377         PIC X(2000).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  30
* EL6501.cbl
  1379*    COPY ELCAID.
  1380******************************************************************
  1381*                                                                *
  1382*                            ELCAID.                             *
  1383*                            VMOD=2.001                          *
  1384*                                                                *
  1385*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1386*                                                                *
  1387*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1388*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1389******************************************************************
  1390
  1391 01  DFHAID.
  1392   02  DFHNULL   PIC  X  VALUE  ' '.
  1393   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1394   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1395   02  DFHPEN    PIC  X  VALUE  '='.
  1396   02  DFHOPID   PIC  X  VALUE  'W'.
  1397   02  DFHPA1    PIC  X  VALUE  '%'.
  1398   02  DFHPA2    PIC  X  VALUE  '>'.
  1399   02  DFHPA3    PIC  X  VALUE  ','.
  1400   02  DFHPF1    PIC  X  VALUE  '1'.
  1401   02  DFHPF2    PIC  X  VALUE  '2'.
  1402   02  DFHPF3    PIC  X  VALUE  '3'.
  1403   02  DFHPF4    PIC  X  VALUE  '4'.
  1404   02  DFHPF5    PIC  X  VALUE  '5'.
  1405   02  DFHPF6    PIC  X  VALUE  '6'.
  1406   02  DFHPF7    PIC  X  VALUE  '7'.
  1407   02  DFHPF8    PIC  X  VALUE  '8'.
  1408   02  DFHPF9    PIC  X  VALUE  '9'.
  1409   02  DFHPF10   PIC  X  VALUE  ':'.
  1410   02  DFHPF11   PIC  X  VALUE  '#'.
  1411   02  DFHPF12   PIC  X  VALUE  '@'.
  1412   02  DFHPF13   PIC  X  VALUE  'A'.
  1413   02  DFHPF14   PIC  X  VALUE  'B'.
  1414   02  DFHPF15   PIC  X  VALUE  'C'.
  1415   02  DFHPF16   PIC  X  VALUE  'D'.
  1416   02  DFHPF17   PIC  X  VALUE  'E'.
  1417   02  DFHPF18   PIC  X  VALUE  'F'.
  1418   02  DFHPF19   PIC  X  VALUE  'G'.
  1419   02  DFHPF20   PIC  X  VALUE  'H'.
  1420   02  DFHPF21   PIC  X  VALUE  'I'.
  1421*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1422   02  DFHPF22   PIC  X  VALUE  '['.
  1423   02  DFHPF23   PIC  X  VALUE  '.'.
  1424   02  DFHPF24   PIC  X  VALUE  '<'.
  1425   02  DFHMSRE   PIC  X  VALUE  'X'.
  1426   02  DFHSTRF   PIC  X  VALUE  'h'.
  1427   02  DFHTRIG   PIC  X  VALUE  '"'.
  1428 01  FILLER    REDEFINES DFHAID.
  1429     12  FILLER                  PIC X(8).
  1430     12  PF-VALUES               PIC X       OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  31
* EL6501.cbl
  1432*    COPY EL6501S.
  1433 01  EL6501AI.
  1434     05  FILLER            PIC  X(0012).
  1435*    -------------------------------
  1436     05  DATEL PIC S9(0004) COMP.
  1437     05  DATEF PIC  X(0001).
  1438     05  FILLER REDEFINES DATEF.
  1439         10  DATEA PIC  X(0001).
  1440     05  DATEI PIC  X(0008).
  1441*    -------------------------------
  1442     05  TIMEL PIC S9(0004) COMP.
  1443     05  TIMEF PIC  X(0001).
  1444     05  FILLER REDEFINES TIMEF.
  1445         10  TIMEA PIC  X(0001).
  1446     05  TIMEI PIC  X(0005).
  1447*    -------------------------------
  1448     05  CMPNYIDL PIC S9(0004) COMP.
  1449     05  CMPNYIDF PIC  X(0001).
  1450     05  FILLER REDEFINES CMPNYIDF.
  1451         10  CMPNYIDA PIC  X(0001).
  1452     05  CMPNYIDI PIC  X(0003).
  1453*    -------------------------------
  1454     05  USERIDL PIC S9(0004) COMP.
  1455     05  USERIDF PIC  X(0001).
  1456     05  FILLER REDEFINES USERIDF.
  1457         10  USERIDA PIC  X(0001).
  1458     05  USERIDI PIC  X(0004).
  1459*    -------------------------------
  1460     05  MAINTL PIC S9(0004) COMP.
  1461     05  MAINTF PIC  X(0001).
  1462     05  FILLER REDEFINES MAINTF.
  1463         10  MAINTA PIC  X(0001).
  1464     05  MAINTI PIC  X(0001).
  1465*    -------------------------------
  1466     05  CARRL PIC S9(0004) COMP.
  1467     05  CARRF PIC  X(0001).
  1468     05  FILLER REDEFINES CARRF.
  1469         10  CARRA PIC  X(0001).
  1470     05  CARRI PIC  X(0001).
  1471*    -------------------------------
  1472     05  GROUPINL PIC S9(0004) COMP.
  1473     05  GROUPINF PIC  X(0001).
  1474     05  FILLER REDEFINES GROUPINF.
  1475         10  GROUPINA PIC  X(0001).
  1476     05  GROUPINI PIC  X(0006).
  1477*    -------------------------------
  1478     05  STATEL PIC S9(0004) COMP.
  1479     05  STATEF PIC  X(0001).
  1480     05  FILLER REDEFINES STATEF.
  1481         10  STATEA PIC  X(0001).
  1482     05  STATEI PIC  X(0002).
  1483*    -------------------------------
  1484     05  ACCOUNTL PIC S9(0004) COMP.
  1485     05  ACCOUNTF PIC  X(0001).
  1486     05  FILLER REDEFINES ACCOUNTF.
  1487         10  ACCOUNTA PIC  X(0001).
  1488     05  ACCOUNTI PIC  X(0010).
  1489*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  32
* EL6501.cbl
  1490     05  EFFDTEL PIC S9(0004) COMP.
  1491     05  EFFDTEF PIC  X(0001).
  1492     05  FILLER REDEFINES EFFDTEF.
  1493         10  EFFDTEA PIC  X(0001).
  1494     05  EFFDTEI PIC  X(0008).
  1495*    -------------------------------
  1496     05  EXPDTEL PIC S9(0004) COMP.
  1497     05  EXPDTEF PIC  X(0001).
  1498     05  FILLER REDEFINES EXPDTEF.
  1499         10  EXPDTEA PIC  X(0001).
  1500     05  EXPDTEI PIC  X(0008).
  1501*    -------------------------------
  1502     05  MAINTBYL PIC S9(0004) COMP.
  1503     05  MAINTBYF PIC  X(0001).
  1504     05  FILLER REDEFINES MAINTBYF.
  1505         10  MAINTBYA PIC  X(0001).
  1506     05  MAINTBYI PIC  X(0004).
  1507*    -------------------------------
  1508     05  PCONTL PIC S9(0004) COMP.
  1509     05  PCONTF PIC  X(0001).
  1510     05  FILLER REDEFINES PCONTF.
  1511         10  PCONTA PIC  X(0001).
  1512     05  PCONTI PIC  X(0030).
  1513*    -------------------------------
  1514     05  CSRL PIC S9(0004) COMP.
  1515     05  CSRF PIC  X(0001).
  1516     05  FILLER REDEFINES CSRF.
  1517         10  CSRA PIC  X(0001).
  1518     05  CSRI PIC  X(0004).
  1519*    -------------------------------
  1520     05  PDSPLYL PIC S9(0004) COMP.
  1521     05  PDSPLYF PIC  X(0001).
  1522     05  FILLER REDEFINES PDSPLYF.
  1523         10  PDSPLYA PIC  X(0001).
  1524     05  PDSPLYI PIC  X(0006).
  1525*    -------------------------------
  1526     05  PEFFDTEL PIC S9(0004) COMP.
  1527     05  PEFFDTEF PIC  X(0001).
  1528     05  FILLER REDEFINES PEFFDTEF.
  1529         10  PEFFDTEA PIC  X(0001).
  1530     05  PEFFDTEI PIC  X(0008).
  1531*    -------------------------------
  1532     05  PEXPDTEL PIC S9(0004) COMP.
  1533     05  PEXPDTEF PIC  X(0001).
  1534     05  FILLER REDEFINES PEXPDTEF.
  1535         10  PEXPDTEA PIC  X(0001).
  1536     05  PEXPDTEI PIC  X(0008).
  1537*    -------------------------------
  1538     05  NAMEL PIC S9(0004) COMP.
  1539     05  NAMEF PIC  X(0001).
  1540     05  FILLER REDEFINES NAMEF.
  1541         10  NAMEA PIC  X(0001).
  1542     05  NAMEI PIC  X(0030).
  1543*    -------------------------------
  1544     05  TAXNOL PIC S9(0004) COMP.
  1545     05  TAXNOF PIC  X(0001).
  1546     05  FILLER REDEFINES TAXNOF.
  1547         10  TAXNOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  33
* EL6501.cbl
  1548     05  TAXNOI PIC  X(0011).
  1549*    -------------------------------
  1550     05  STATUSL PIC S9(0004) COMP.
  1551     05  STATUSF PIC  X(0001).
  1552     05  FILLER REDEFINES STATUSF.
  1553         10  STATUSA PIC  X(0001).
  1554     05  STATUSI PIC  X(0001).
  1555*    -------------------------------
  1556     05  INCAREL PIC S9(0004) COMP.
  1557     05  INCAREF PIC  X(0001).
  1558     05  FILLER REDEFINES INCAREF.
  1559         10  INCAREA PIC  X(0001).
  1560     05  INCAREI PIC  X(0030).
  1561*    -------------------------------
  1562     05  PHONEL PIC S9(0004) COMP.
  1563     05  PHONEF PIC  X(0001).
  1564     05  FILLER REDEFINES PHONEF.
  1565         10  PHONEA PIC  X(0001).
  1566     05  PHONEI PIC  X(0012).
  1567*    -------------------------------
  1568     05  INDGRPL PIC S9(0004) COMP.
  1569     05  INDGRPF PIC  X(0001).
  1570     05  FILLER REDEFINES INDGRPF.
  1571         10  INDGRPA PIC  X(0001).
  1572     05  INDGRPI PIC  X(0001).
  1573*    -------------------------------
  1574     05  ADDR1L PIC S9(0004) COMP.
  1575     05  ADDR1F PIC  X(0001).
  1576     05  FILLER REDEFINES ADDR1F.
  1577         10  ADDR1A PIC  X(0001).
  1578     05  ADDR1I PIC  X(0030).
  1579*    -------------------------------
  1580     05  CONTRL PIC S9(0004) COMP.
  1581     05  CONTRF PIC  X(0001).
  1582     05  FILLER REDEFINES CONTRF.
  1583         10  CONTRA PIC  X(0001).
  1584     05  CONTRI PIC  X(0008).
  1585*    -------------------------------
  1586     05  TYPEL PIC S9(0004) COMP.
  1587     05  TYPEF PIC  X(0001).
  1588     05  FILLER REDEFINES TYPEF.
  1589         10  TYPEA PIC  X(0001).
  1590     05  TYPEI PIC  99.
  1591*    -------------------------------
  1592     05  ACITYL PIC S9(0004) COMP.
  1593     05  ACITYF PIC  X(0001).
  1594     05  FILLER REDEFINES ACITYF.
  1595         10  ACITYA PIC  X(0001).
  1596     05  ACITYI PIC  X(0028).
  1597*    -------------------------------
  1598     05  ASTATEL PIC S9(0004) COMP.
  1599     05  ASTATEF PIC  X(0001).
  1600     05  FILLER REDEFINES ASTATEF.
  1601         10  ASTATEA PIC  X(0001).
  1602     05  ASTATEI PIC  X(0002).
  1603*    -------------------------------
  1604     05  PRODATEL PIC S9(0004) COMP.
  1605     05  PRODATEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  34
* EL6501.cbl
  1606     05  FILLER REDEFINES PRODATEF.
  1607         10  PRODATEA PIC  X(0001).
  1608     05  PRODATEI PIC  X(0008).
  1609*    -------------------------------
  1610     05  STDBENL PIC S9(0004) COMP.
  1611     05  STDBENF PIC  X(0001).
  1612     05  FILLER REDEFINES STDBENF.
  1613         10  STDBENA PIC  X(0001).
  1614     05  STDBENI PIC  X(0002).
  1615*    -------------------------------
  1616     05  ZIPL PIC S9(0004) COMP.
  1617     05  ZIPF PIC  X(0001).
  1618     05  FILLER REDEFINES ZIPF.
  1619         10  ZIPA PIC  X(0001).
  1620     05  ZIPI PIC  X(0010).
  1621*    -------------------------------
  1622     05  CTPLABLL PIC S9(0004) COMP.
  1623     05  CTPLABLF PIC  X(0001).
  1624     05  FILLER REDEFINES CTPLABLF.
  1625         10  CTPLABLA PIC  X(0001).
  1626     05  CTPLABLI PIC  X(0010).
  1627*    -------------------------------
  1628     05  CLPTOLPL PIC S9(0004) COMP.
  1629     05  CLPTOLPF PIC  X(0001).
  1630     05  FILLER REDEFINES CLPTOLPF.
  1631         10  CLPTOLPA PIC  X(0001).
  1632     05  CLPTOLPI PIC  S9(02)V9999.
  1633*    -------------------------------
  1634     05  RETROCDL PIC S9(0004) COMP.
  1635     05  RETROCDF PIC  X(0001).
  1636     05  FILLER REDEFINES RETROCDF.
  1637         10  RETROCDA PIC  X(0001).
  1638     05  RETROCDI PIC  X(0003).
  1639*    -------------------------------
  1640     05  BILLCDL PIC S9(0004) COMP.
  1641     05  BILLCDF PIC  X(0001).
  1642     05  FILLER REDEFINES BILLCDF.
  1643         10  BILLCDA PIC  X(0001).
  1644     05  BILLCDI PIC  X(0003).
  1645*    -------------------------------
  1646     05  LCLABLL PIC S9(0004) COMP.
  1647     05  LCLABLF PIC  X(0001).
  1648     05  FILLER REDEFINES LCLABLF.
  1649         10  LCLABLA PIC  X(0001).
  1650     05  LCLABLI PIC  X(0011).
  1651*    -------------------------------
  1652     05  LCOMML PIC S9(0004) COMP.
  1653     05  LCOMMF PIC  X(0001).
  1654     05  FILLER REDEFINES LCOMMF.
  1655         10  LCOMMA PIC  X(0001).
  1656     05  LCOMMI PIC  S9(6)V9(2).
  1657*    -------------------------------
  1658     05  MAXFEEHL PIC S9(0004) COMP.
  1659     05  MAXFEEHF PIC  X(0001).
  1660     05  FILLER REDEFINES MAXFEEHF.
  1661         10  MAXFEEHA PIC  X(0001).
  1662     05  MAXFEEHI PIC  X(0013).
  1663*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  35
* EL6501.cbl
  1664     05  MAXMFEEL PIC S9(0004) COMP.
  1665     05  MAXMFEEF PIC  X(0001).
  1666     05  FILLER REDEFINES MAXMFEEF.
  1667         10  MAXMFEEA PIC  X(0001).
  1668     05  MAXMFEEI PIC  X(0005).
  1669*    -------------------------------
  1670     05  CLPSTHL PIC S9(0004) COMP.
  1671     05  CLPSTHF PIC  X(0001).
  1672     05  FILLER REDEFINES CLPSTHF.
  1673         10  CLPSTHA PIC  X(0001).
  1674     05  CLPSTHI PIC  X(0010).
  1675*    -------------------------------
  1676     05  CLPSTL PIC S9(0004) COMP.
  1677     05  CLPSTF PIC  X(0001).
  1678     05  FILLER REDEFINES CLPSTF.
  1679         10  CLPSTA PIC  X(0001).
  1680     05  CLPSTI PIC  X(0002).
  1681*    -------------------------------
  1682     05  PRODCDHL PIC S9(0004) COMP.
  1683     05  PRODCDHF PIC  X(0001).
  1684     05  FILLER REDEFINES PRODCDHF.
  1685         10  PRODCDHA PIC  X(0001).
  1686     05  PRODCDHI PIC  X(0012).
  1687*    -------------------------------
  1688     05  PRODCDL PIC S9(0004) COMP.
  1689     05  PRODCDF PIC  X(0001).
  1690     05  FILLER REDEFINES PRODCDF.
  1691         10  PRODCDA PIC  X(0001).
  1692     05  PRODCDI PIC  X(0003).
  1693*    -------------------------------
  1694     05  REMITL PIC S9(0004) COMP.
  1695     05  REMITF PIC  X(0001).
  1696     05  FILLER REDEFINES REMITF.
  1697         10  REMITA PIC  X(0001).
  1698     05  REMITI PIC  99.
  1699*    -------------------------------
  1700     05  COMMCALL PIC S9(0004) COMP.
  1701     05  COMMCALF PIC  X(0001).
  1702     05  FILLER REDEFINES COMMCALF.
  1703         10  COMMCALA PIC  X(0001).
  1704     05  COMMCALI PIC  X(0001).
  1705*    -------------------------------
  1706     05  REINTABL PIC S9(0004) COMP.
  1707     05  REINTABF PIC  X(0001).
  1708     05  FILLER REDEFINES REINTABF.
  1709         10  REINTABA PIC  X(0001).
  1710     05  REINTABI PIC  X(0003).
  1711*    -------------------------------
  1712     05  REINCALL PIC S9(0004) COMP.
  1713     05  REINCALF PIC  X(0001).
  1714     05  FILLER REDEFINES REINCALF.
  1715         10  REINCALA PIC  X(0001).
  1716     05  REINCALI PIC  X(0001).
  1717*    -------------------------------
  1718     05  AHHEADL PIC S9(0004) COMP.
  1719     05  AHHEADF PIC  X(0001).
  1720     05  FILLER REDEFINES AHHEADF.
  1721         10  AHHEADA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  36
* EL6501.cbl
  1722     05  AHHEADI PIC  X(0006).
  1723*    -------------------------------
  1724     05  AGNT1L PIC S9(0004) COMP.
  1725     05  AGNT1F PIC  X(0001).
  1726     05  FILLER REDEFINES AGNT1F.
  1727         10  AGNT1A PIC  X(0001).
  1728     05  AGNT1I PIC  X(0010).
  1729*    -------------------------------
  1730     05  TYPE1L PIC S9(0004) COMP.
  1731     05  TYPE1F PIC  X(0001).
  1732     05  FILLER REDEFINES TYPE1F.
  1733         10  TYPE1A PIC  X(0001).
  1734     05  TYPE1I PIC  X(0001).
  1735*    -------------------------------
  1736     05  SINRT1L PIC S9(0004) COMP.
  1737     05  SINRT1F PIC  X(0001).
  1738     05  FILLER REDEFINES SINRT1F.
  1739         10  SINRT1A PIC  X(0001).
  1740     05  SINRT1I PIC  X(0006).
  1741*    -------------------------------
  1742     05  JNTRT1L PIC S9(0004) COMP.
  1743     05  JNTRT1F PIC  X(0001).
  1744     05  FILLER REDEFINES JNTRT1F.
  1745         10  JNTRT1A PIC  X(0001).
  1746     05  JNTRT1I PIC  X(0006).
  1747*    -------------------------------
  1748     05  AHRT1L PIC S9(0004) COMP.
  1749     05  AHRT1F PIC  X(0001).
  1750     05  FILLER REDEFINES AHRT1F.
  1751         10  AHRT1A PIC  X(0001).
  1752     05  AHRT1I PIC  X(0006).
  1753*    -------------------------------
  1754     05  RECAL1L PIC S9(0004) COMP.
  1755     05  RECAL1F PIC  X(0001).
  1756     05  FILLER REDEFINES RECAL1F.
  1757         10  RECAL1A PIC  X(0001).
  1758     05  RECAL1I PIC  X(0001).
  1759*    -------------------------------
  1760     05  COMM1L PIC S9(0004) COMP.
  1761     05  COMM1F PIC  X(0001).
  1762     05  FILLER REDEFINES COMM1F.
  1763         10  COMM1A PIC  X(0001).
  1764     05  COMM1I PIC  X(0001).
  1765*    -------------------------------
  1766     05  CHGBK1L PIC S9(0004) COMP.
  1767     05  CHGBK1F PIC  X(0001).
  1768     05  FILLER REDEFINES CHGBK1F.
  1769         10  CHGBK1A PIC  X(0001).
  1770     05  CHGBK1I PIC  X(0002).
  1771*    -------------------------------
  1772     05  GLCDE1L PIC S9(0004) COMP.
  1773     05  GLCDE1F PIC  X(0001).
  1774     05  FILLER REDEFINES GLCDE1F.
  1775         10  GLCDE1A PIC  X(0001).
  1776     05  GLCDE1I PIC  X(0001).
  1777*    -------------------------------
  1778     05  AGNT2L PIC S9(0004) COMP.
  1779     05  AGNT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  37
* EL6501.cbl
  1780     05  FILLER REDEFINES AGNT2F.
  1781         10  AGNT2A PIC  X(0001).
  1782     05  AGNT2I PIC  X(0010).
  1783*    -------------------------------
  1784     05  TYPE2L PIC S9(0004) COMP.
  1785     05  TYPE2F PIC  X(0001).
  1786     05  FILLER REDEFINES TYPE2F.
  1787         10  TYPE2A PIC  X(0001).
  1788     05  TYPE2I PIC  X(0001).
  1789*    -------------------------------
  1790     05  SINRT2L PIC S9(0004) COMP.
  1791     05  SINRT2F PIC  X(0001).
  1792     05  FILLER REDEFINES SINRT2F.
  1793         10  SINRT2A PIC  X(0001).
  1794     05  SINRT2I PIC  X(0006).
  1795*    -------------------------------
  1796     05  JNTRT2L PIC S9(0004) COMP.
  1797     05  JNTRT2F PIC  X(0001).
  1798     05  FILLER REDEFINES JNTRT2F.
  1799         10  JNTRT2A PIC  X(0001).
  1800     05  JNTRT2I PIC  X(0006).
  1801*    -------------------------------
  1802     05  AHRT2L PIC S9(0004) COMP.
  1803     05  AHRT2F PIC  X(0001).
  1804     05  FILLER REDEFINES AHRT2F.
  1805         10  AHRT2A PIC  X(0001).
  1806     05  AHRT2I PIC  X(0006).
  1807*    -------------------------------
  1808     05  RECAL2L PIC S9(0004) COMP.
  1809     05  RECAL2F PIC  X(0001).
  1810     05  FILLER REDEFINES RECAL2F.
  1811         10  RECAL2A PIC  X(0001).
  1812     05  RECAL2I PIC  X(0001).
  1813*    -------------------------------
  1814     05  COMM2L PIC S9(0004) COMP.
  1815     05  COMM2F PIC  X(0001).
  1816     05  FILLER REDEFINES COMM2F.
  1817         10  COMM2A PIC  X(0001).
  1818     05  COMM2I PIC  X(0001).
  1819*    -------------------------------
  1820     05  CHGBK2L PIC S9(0004) COMP.
  1821     05  CHGBK2F PIC  X(0001).
  1822     05  FILLER REDEFINES CHGBK2F.
  1823         10  CHGBK2A PIC  X(0001).
  1824     05  CHGBK2I PIC  X(0002).
  1825*    -------------------------------
  1826     05  GLCDE2L PIC S9(0004) COMP.
  1827     05  GLCDE2F PIC  X(0001).
  1828     05  FILLER REDEFINES GLCDE2F.
  1829         10  GLCDE2A PIC  X(0001).
  1830     05  GLCDE2I PIC  X(0001).
  1831*    -------------------------------
  1832     05  AGNT3L PIC S9(0004) COMP.
  1833     05  AGNT3F PIC  X(0001).
  1834     05  FILLER REDEFINES AGNT3F.
  1835         10  AGNT3A PIC  X(0001).
  1836     05  AGNT3I PIC  X(0010).
  1837*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  38
* EL6501.cbl
  1838     05  TYPE3L PIC S9(0004) COMP.
  1839     05  TYPE3F PIC  X(0001).
  1840     05  FILLER REDEFINES TYPE3F.
  1841         10  TYPE3A PIC  X(0001).
  1842     05  TYPE3I PIC  X(0001).
  1843*    -------------------------------
  1844     05  SINRT3L PIC S9(0004) COMP.
  1845     05  SINRT3F PIC  X(0001).
  1846     05  FILLER REDEFINES SINRT3F.
  1847         10  SINRT3A PIC  X(0001).
  1848     05  SINRT3I PIC  X(0006).
  1849*    -------------------------------
  1850     05  JNTRT3L PIC S9(0004) COMP.
  1851     05  JNTRT3F PIC  X(0001).
  1852     05  FILLER REDEFINES JNTRT3F.
  1853         10  JNTRT3A PIC  X(0001).
  1854     05  JNTRT3I PIC  X(0006).
  1855*    -------------------------------
  1856     05  AHRT3L PIC S9(0004) COMP.
  1857     05  AHRT3F PIC  X(0001).
  1858     05  FILLER REDEFINES AHRT3F.
  1859         10  AHRT3A PIC  X(0001).
  1860     05  AHRT3I PIC  X(0006).
  1861*    -------------------------------
  1862     05  RECAL3L PIC S9(0004) COMP.
  1863     05  RECAL3F PIC  X(0001).
  1864     05  FILLER REDEFINES RECAL3F.
  1865         10  RECAL3A PIC  X(0001).
  1866     05  RECAL3I PIC  X(0001).
  1867*    -------------------------------
  1868     05  COMM3L PIC S9(0004) COMP.
  1869     05  COMM3F PIC  X(0001).
  1870     05  FILLER REDEFINES COMM3F.
  1871         10  COMM3A PIC  X(0001).
  1872     05  COMM3I PIC  X(0001).
  1873*    -------------------------------
  1874     05  CHGBK3L PIC S9(0004) COMP.
  1875     05  CHGBK3F PIC  X(0001).
  1876     05  FILLER REDEFINES CHGBK3F.
  1877         10  CHGBK3A PIC  X(0001).
  1878     05  CHGBK3I PIC  X(0002).
  1879*    -------------------------------
  1880     05  GLCDE3L PIC S9(0004) COMP.
  1881     05  GLCDE3F PIC  X(0001).
  1882     05  FILLER REDEFINES GLCDE3F.
  1883         10  GLCDE3A PIC  X(0001).
  1884     05  GLCDE3I PIC  X(0001).
  1885*    -------------------------------
  1886     05  AGNT4L PIC S9(0004) COMP.
  1887     05  AGNT4F PIC  X(0001).
  1888     05  FILLER REDEFINES AGNT4F.
  1889         10  AGNT4A PIC  X(0001).
  1890     05  AGNT4I PIC  X(0010).
  1891*    -------------------------------
  1892     05  TYPE4L PIC S9(0004) COMP.
  1893     05  TYPE4F PIC  X(0001).
  1894     05  FILLER REDEFINES TYPE4F.
  1895         10  TYPE4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  39
* EL6501.cbl
  1896     05  TYPE4I PIC  X(0001).
  1897*    -------------------------------
  1898     05  SINRT4L PIC S9(0004) COMP.
  1899     05  SINRT4F PIC  X(0001).
  1900     05  FILLER REDEFINES SINRT4F.
  1901         10  SINRT4A PIC  X(0001).
  1902     05  SINRT4I PIC  X(0006).
  1903*    -------------------------------
  1904     05  JNTRT4L PIC S9(0004) COMP.
  1905     05  JNTRT4F PIC  X(0001).
  1906     05  FILLER REDEFINES JNTRT4F.
  1907         10  JNTRT4A PIC  X(0001).
  1908     05  JNTRT4I PIC  X(0006).
  1909*    -------------------------------
  1910     05  AHRT4L PIC S9(0004) COMP.
  1911     05  AHRT4F PIC  X(0001).
  1912     05  FILLER REDEFINES AHRT4F.
  1913         10  AHRT4A PIC  X(0001).
  1914     05  AHRT4I PIC  X(0006).
  1915*    -------------------------------
  1916     05  RECAL4L PIC S9(0004) COMP.
  1917     05  RECAL4F PIC  X(0001).
  1918     05  FILLER REDEFINES RECAL4F.
  1919         10  RECAL4A PIC  X(0001).
  1920     05  RECAL4I PIC  X(0001).
  1921*    -------------------------------
  1922     05  COMM4L PIC S9(0004) COMP.
  1923     05  COMM4F PIC  X(0001).
  1924     05  FILLER REDEFINES COMM4F.
  1925         10  COMM4A PIC  X(0001).
  1926     05  COMM4I PIC  X(0001).
  1927*    -------------------------------
  1928     05  CHGBK4L PIC S9(0004) COMP.
  1929     05  CHGBK4F PIC  X(0001).
  1930     05  FILLER REDEFINES CHGBK4F.
  1931         10  CHGBK4A PIC  X(0001).
  1932     05  CHGBK4I PIC  X(0002).
  1933*    -------------------------------
  1934     05  GLCDE4L PIC S9(0004) COMP.
  1935     05  GLCDE4F PIC  X(0001).
  1936     05  FILLER REDEFINES GLCDE4F.
  1937         10  GLCDE4A PIC  X(0001).
  1938     05  GLCDE4I PIC  X(0001).
  1939*    -------------------------------
  1940     05  AGNT5L PIC S9(0004) COMP.
  1941     05  AGNT5F PIC  X(0001).
  1942     05  FILLER REDEFINES AGNT5F.
  1943         10  AGNT5A PIC  X(0001).
  1944     05  AGNT5I PIC  X(0010).
  1945*    -------------------------------
  1946     05  TYPE5L PIC S9(0004) COMP.
  1947     05  TYPE5F PIC  X(0001).
  1948     05  FILLER REDEFINES TYPE5F.
  1949         10  TYPE5A PIC  X(0001).
  1950     05  TYPE5I PIC  X(0001).
  1951*    -------------------------------
  1952     05  SINRT5L PIC S9(0004) COMP.
  1953     05  SINRT5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  40
* EL6501.cbl
  1954     05  FILLER REDEFINES SINRT5F.
  1955         10  SINRT5A PIC  X(0001).
  1956     05  SINRT5I PIC  X(0006).
  1957*    -------------------------------
  1958     05  JNTRT5L PIC S9(0004) COMP.
  1959     05  JNTRT5F PIC  X(0001).
  1960     05  FILLER REDEFINES JNTRT5F.
  1961         10  JNTRT5A PIC  X(0001).
  1962     05  JNTRT5I PIC  X(0006).
  1963*    -------------------------------
  1964     05  AHRT5L PIC S9(0004) COMP.
  1965     05  AHRT5F PIC  X(0001).
  1966     05  FILLER REDEFINES AHRT5F.
  1967         10  AHRT5A PIC  X(0001).
  1968     05  AHRT5I PIC  X(0006).
  1969*    -------------------------------
  1970     05  RECAL5L PIC S9(0004) COMP.
  1971     05  RECAL5F PIC  X(0001).
  1972     05  FILLER REDEFINES RECAL5F.
  1973         10  RECAL5A PIC  X(0001).
  1974     05  RECAL5I PIC  X(0001).
  1975*    -------------------------------
  1976     05  COMM5L PIC S9(0004) COMP.
  1977     05  COMM5F PIC  X(0001).
  1978     05  FILLER REDEFINES COMM5F.
  1979         10  COMM5A PIC  X(0001).
  1980     05  COMM5I PIC  X(0001).
  1981*    -------------------------------
  1982     05  CHGBK5L PIC S9(0004) COMP.
  1983     05  CHGBK5F PIC  X(0001).
  1984     05  FILLER REDEFINES CHGBK5F.
  1985         10  CHGBK5A PIC  X(0001).
  1986     05  CHGBK5I PIC  X(0002).
  1987*    -------------------------------
  1988     05  GLCDE5L PIC S9(0004) COMP.
  1989     05  GLCDE5F PIC  X(0001).
  1990     05  FILLER REDEFINES GLCDE5F.
  1991         10  GLCDE5A PIC  X(0001).
  1992     05  GLCDE5I PIC  X(0001).
  1993*    -------------------------------
  1994     05  AGNT6L PIC S9(0004) COMP.
  1995     05  AGNT6F PIC  X(0001).
  1996     05  FILLER REDEFINES AGNT6F.
  1997         10  AGNT6A PIC  X(0001).
  1998     05  AGNT6I PIC  X(0010).
  1999*    -------------------------------
  2000     05  TYPE6L PIC S9(0004) COMP.
  2001     05  TYPE6F PIC  X(0001).
  2002     05  FILLER REDEFINES TYPE6F.
  2003         10  TYPE6A PIC  X(0001).
  2004     05  TYPE6I PIC  X(0001).
  2005*    -------------------------------
  2006     05  SINRT6L PIC S9(0004) COMP.
  2007     05  SINRT6F PIC  X(0001).
  2008     05  FILLER REDEFINES SINRT6F.
  2009         10  SINRT6A PIC  X(0001).
  2010     05  SINRT6I PIC  X(0006).
  2011*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  41
* EL6501.cbl
  2012     05  JNTRT6L PIC S9(0004) COMP.
  2013     05  JNTRT6F PIC  X(0001).
  2014     05  FILLER REDEFINES JNTRT6F.
  2015         10  JNTRT6A PIC  X(0001).
  2016     05  JNTRT6I PIC  X(0006).
  2017*    -------------------------------
  2018     05  AHRT6L PIC S9(0004) COMP.
  2019     05  AHRT6F PIC  X(0001).
  2020     05  FILLER REDEFINES AHRT6F.
  2021         10  AHRT6A PIC  X(0001).
  2022     05  AHRT6I PIC  X(0006).
  2023*    -------------------------------
  2024     05  RECAL6L PIC S9(0004) COMP.
  2025     05  RECAL6F PIC  X(0001).
  2026     05  FILLER REDEFINES RECAL6F.
  2027         10  RECAL6A PIC  X(0001).
  2028     05  RECAL6I PIC  X(0001).
  2029*    -------------------------------
  2030     05  COMM6L PIC S9(0004) COMP.
  2031     05  COMM6F PIC  X(0001).
  2032     05  FILLER REDEFINES COMM6F.
  2033         10  COMM6A PIC  X(0001).
  2034     05  COMM6I PIC  X(0001).
  2035*    -------------------------------
  2036     05  CHGBK6L PIC S9(0004) COMP.
  2037     05  CHGBK6F PIC  X(0001).
  2038     05  FILLER REDEFINES CHGBK6F.
  2039         10  CHGBK6A PIC  X(0001).
  2040     05  CHGBK6I PIC  X(0002).
  2041*    -------------------------------
  2042     05  GLCDE6L PIC S9(0004) COMP.
  2043     05  GLCDE6F PIC  X(0001).
  2044     05  FILLER REDEFINES GLCDE6F.
  2045         10  GLCDE6A PIC  X(0001).
  2046     05  GLCDE6I PIC  X(0001).
  2047*    -------------------------------
  2048     05  AGNT7L PIC S9(0004) COMP.
  2049     05  AGNT7F PIC  X(0001).
  2050     05  FILLER REDEFINES AGNT7F.
  2051         10  AGNT7A PIC  X(0001).
  2052     05  AGNT7I PIC  X(0010).
  2053*    -------------------------------
  2054     05  TYPE7L PIC S9(0004) COMP.
  2055     05  TYPE7F PIC  X(0001).
  2056     05  FILLER REDEFINES TYPE7F.
  2057         10  TYPE7A PIC  X(0001).
  2058     05  TYPE7I PIC  X(0001).
  2059*    -------------------------------
  2060     05  SINRT7L PIC S9(0004) COMP.
  2061     05  SINRT7F PIC  X(0001).
  2062     05  FILLER REDEFINES SINRT7F.
  2063         10  SINRT7A PIC  X(0001).
  2064     05  SINRT7I PIC  X(0006).
  2065*    -------------------------------
  2066     05  JNTRT7L PIC S9(0004) COMP.
  2067     05  JNTRT7F PIC  X(0001).
  2068     05  FILLER REDEFINES JNTRT7F.
  2069         10  JNTRT7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  42
* EL6501.cbl
  2070     05  JNTRT7I PIC  X(0006).
  2071*    -------------------------------
  2072     05  AHRT7L PIC S9(0004) COMP.
  2073     05  AHRT7F PIC  X(0001).
  2074     05  FILLER REDEFINES AHRT7F.
  2075         10  AHRT7A PIC  X(0001).
  2076     05  AHRT7I PIC  X(0006).
  2077*    -------------------------------
  2078     05  RECAL7L PIC S9(0004) COMP.
  2079     05  RECAL7F PIC  X(0001).
  2080     05  FILLER REDEFINES RECAL7F.
  2081         10  RECAL7A PIC  X(0001).
  2082     05  RECAL7I PIC  X(0001).
  2083*    -------------------------------
  2084     05  COMM7L PIC S9(0004) COMP.
  2085     05  COMM7F PIC  X(0001).
  2086     05  FILLER REDEFINES COMM7F.
  2087         10  COMM7A PIC  X(0001).
  2088     05  COMM7I PIC  X(0001).
  2089*    -------------------------------
  2090     05  CHGBK7L PIC S9(0004) COMP.
  2091     05  CHGBK7F PIC  X(0001).
  2092     05  FILLER REDEFINES CHGBK7F.
  2093         10  CHGBK7A PIC  X(0001).
  2094     05  CHGBK7I PIC  X(0002).
  2095*    -------------------------------
  2096     05  GLCDE7L PIC S9(0004) COMP.
  2097     05  GLCDE7F PIC  X(0001).
  2098     05  FILLER REDEFINES GLCDE7F.
  2099         10  GLCDE7A PIC  X(0001).
  2100     05  GLCDE7I PIC  X(0001).
  2101*    -------------------------------
  2102     05  AGNT8L PIC S9(0004) COMP.
  2103     05  AGNT8F PIC  X(0001).
  2104     05  FILLER REDEFINES AGNT8F.
  2105         10  AGNT8A PIC  X(0001).
  2106     05  AGNT8I PIC  X(0010).
  2107*    -------------------------------
  2108     05  TYPE8L PIC S9(0004) COMP.
  2109     05  TYPE8F PIC  X(0001).
  2110     05  FILLER REDEFINES TYPE8F.
  2111         10  TYPE8A PIC  X(0001).
  2112     05  TYPE8I PIC  X(0001).
  2113*    -------------------------------
  2114     05  SINRT8L PIC S9(0004) COMP.
  2115     05  SINRT8F PIC  X(0001).
  2116     05  FILLER REDEFINES SINRT8F.
  2117         10  SINRT8A PIC  X(0001).
  2118     05  SINRT8I PIC  X(0006).
  2119*    -------------------------------
  2120     05  JNTRT8L PIC S9(0004) COMP.
  2121     05  JNTRT8F PIC  X(0001).
  2122     05  FILLER REDEFINES JNTRT8F.
  2123         10  JNTRT8A PIC  X(0001).
  2124     05  JNTRT8I PIC  X(0006).
  2125*    -------------------------------
  2126     05  AHRT8L PIC S9(0004) COMP.
  2127     05  AHRT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  43
* EL6501.cbl
  2128     05  FILLER REDEFINES AHRT8F.
  2129         10  AHRT8A PIC  X(0001).
  2130     05  AHRT8I PIC  X(0006).
  2131*    -------------------------------
  2132     05  RECAL8L PIC S9(0004) COMP.
  2133     05  RECAL8F PIC  X(0001).
  2134     05  FILLER REDEFINES RECAL8F.
  2135         10  RECAL8A PIC  X(0001).
  2136     05  RECAL8I PIC  X(0001).
  2137*    -------------------------------
  2138     05  COMM8L PIC S9(0004) COMP.
  2139     05  COMM8F PIC  X(0001).
  2140     05  FILLER REDEFINES COMM8F.
  2141         10  COMM8A PIC  X(0001).
  2142     05  COMM8I PIC  X(0001).
  2143*    -------------------------------
  2144     05  CHGBK8L PIC S9(0004) COMP.
  2145     05  CHGBK8F PIC  X(0001).
  2146     05  FILLER REDEFINES CHGBK8F.
  2147         10  CHGBK8A PIC  X(0001).
  2148     05  CHGBK8I PIC  X(0002).
  2149*    -------------------------------
  2150     05  GLCDE8L PIC S9(0004) COMP.
  2151     05  GLCDE8F PIC  X(0001).
  2152     05  FILLER REDEFINES GLCDE8F.
  2153         10  GLCDE8A PIC  X(0001).
  2154     05  GLCDE8I PIC  X(0001).
  2155*    -------------------------------
  2156     05  AGNT9L PIC S9(0004) COMP.
  2157     05  AGNT9F PIC  X(0001).
  2158     05  FILLER REDEFINES AGNT9F.
  2159         10  AGNT9A PIC  X(0001).
  2160     05  AGNT9I PIC  X(0010).
  2161*    -------------------------------
  2162     05  TYPE9L PIC S9(0004) COMP.
  2163     05  TYPE9F PIC  X(0001).
  2164     05  FILLER REDEFINES TYPE9F.
  2165         10  TYPE9A PIC  X(0001).
  2166     05  TYPE9I PIC  X(0001).
  2167*    -------------------------------
  2168     05  SINRT9L PIC S9(0004) COMP.
  2169     05  SINRT9F PIC  X(0001).
  2170     05  FILLER REDEFINES SINRT9F.
  2171         10  SINRT9A PIC  X(0001).
  2172     05  SINRT9I PIC  X(0006).
  2173*    -------------------------------
  2174     05  JNTRT9L PIC S9(0004) COMP.
  2175     05  JNTRT9F PIC  X(0001).
  2176     05  FILLER REDEFINES JNTRT9F.
  2177         10  JNTRT9A PIC  X(0001).
  2178     05  JNTRT9I PIC  X(0006).
  2179*    -------------------------------
  2180     05  AHRT9L PIC S9(0004) COMP.
  2181     05  AHRT9F PIC  X(0001).
  2182     05  FILLER REDEFINES AHRT9F.
  2183         10  AHRT9A PIC  X(0001).
  2184     05  AHRT9I PIC  X(0006).
  2185*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  44
* EL6501.cbl
  2186     05  RECAL9L PIC S9(0004) COMP.
  2187     05  RECAL9F PIC  X(0001).
  2188     05  FILLER REDEFINES RECAL9F.
  2189         10  RECAL9A PIC  X(0001).
  2190     05  RECAL9I PIC  X(0001).
  2191*    -------------------------------
  2192     05  COMM9L PIC S9(0004) COMP.
  2193     05  COMM9F PIC  X(0001).
  2194     05  FILLER REDEFINES COMM9F.
  2195         10  COMM9A PIC  X(0001).
  2196     05  COMM9I PIC  X(0001).
  2197*    -------------------------------
  2198     05  CHGBK9L PIC S9(0004) COMP.
  2199     05  CHGBK9F PIC  X(0001).
  2200     05  FILLER REDEFINES CHGBK9F.
  2201         10  CHGBK9A PIC  X(0001).
  2202     05  CHGBK9I PIC  X(0002).
  2203*    -------------------------------
  2204     05  GLCDE9L PIC S9(0004) COMP.
  2205     05  GLCDE9F PIC  X(0001).
  2206     05  FILLER REDEFINES GLCDE9F.
  2207         10  GLCDE9A PIC  X(0001).
  2208     05  GLCDE9I PIC  X(0001).
  2209*    -------------------------------
  2210     05  AGNT10L PIC S9(0004) COMP.
  2211     05  AGNT10F PIC  X(0001).
  2212     05  FILLER REDEFINES AGNT10F.
  2213         10  AGNT10A PIC  X(0001).
  2214     05  AGNT10I PIC  X(0010).
  2215*    -------------------------------
  2216     05  TYPE10L PIC S9(0004) COMP.
  2217     05  TYPE10F PIC  X(0001).
  2218     05  FILLER REDEFINES TYPE10F.
  2219         10  TYPE10A PIC  X(0001).
  2220     05  TYPE10I PIC  X(0001).
  2221*    -------------------------------
  2222     05  SINRT10L PIC S9(0004) COMP.
  2223     05  SINRT10F PIC  X(0001).
  2224     05  FILLER REDEFINES SINRT10F.
  2225         10  SINRT10A PIC  X(0001).
  2226     05  SINRT10I PIC  X(0006).
  2227*    -------------------------------
  2228     05  JNTRT10L PIC S9(0004) COMP.
  2229     05  JNTRT10F PIC  X(0001).
  2230     05  FILLER REDEFINES JNTRT10F.
  2231         10  JNTRT10A PIC  X(0001).
  2232     05  JNTRT10I PIC  X(0006).
  2233*    -------------------------------
  2234     05  AHRT10L PIC S9(0004) COMP.
  2235     05  AHRT10F PIC  X(0001).
  2236     05  FILLER REDEFINES AHRT10F.
  2237         10  AHRT10A PIC  X(0001).
  2238     05  AHRT10I PIC  X(0006).
  2239*    -------------------------------
  2240     05  RECAL10L PIC S9(0004) COMP.
  2241     05  RECAL10F PIC  X(0001).
  2242     05  FILLER REDEFINES RECAL10F.
  2243         10  RECAL10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  45
* EL6501.cbl
  2244     05  RECAL10I PIC  X(0001).
  2245*    -------------------------------
  2246     05  COMM10L PIC S9(0004) COMP.
  2247     05  COMM10F PIC  X(0001).
  2248     05  FILLER REDEFINES COMM10F.
  2249         10  COMM10A PIC  X(0001).
  2250     05  COMM10I PIC  X(0001).
  2251*    -------------------------------
  2252     05  CHGBK10L PIC S9(0004) COMP.
  2253     05  CHGBK10F PIC  X(0001).
  2254     05  FILLER REDEFINES CHGBK10F.
  2255         10  CHGBK10A PIC  X(0001).
  2256     05  CHGBK10I PIC  X(0002).
  2257*    -------------------------------
  2258     05  GLCDE10L PIC S9(0004) COMP.
  2259     05  GLCDE10F PIC  X(0001).
  2260     05  FILLER REDEFINES GLCDE10F.
  2261         10  GLCDE10A PIC  X(0001).
  2262     05  GLCDE10I PIC  X(0001).
  2263*    -------------------------------
  2264     05  ERRMSG1L PIC S9(0004) COMP.
  2265     05  ERRMSG1F PIC  X(0001).
  2266     05  FILLER REDEFINES ERRMSG1F.
  2267         10  ERRMSG1A PIC  X(0001).
  2268     05  ERRMSG1I PIC  X(0075).
  2269*    -------------------------------
  2270     05  PFENTERL PIC S9(0004) COMP.
  2271     05  PFENTERF PIC  X(0001).
  2272     05  FILLER REDEFINES PFENTERF.
  2273         10  PFENTERA PIC  X(0001).
  2274     05  PFENTERI PIC  9(2).
  2275*    -------------------------------
  2276     05  PF1PF2L PIC S9(0004) COMP.
  2277     05  PF1PF2F PIC  X(0001).
  2278     05  FILLER REDEFINES PF1PF2F.
  2279         10  PF1PF2A PIC  X(0001).
  2280     05  PF1PF2I PIC  X(0035).
  2281 01  EL6501AO REDEFINES EL6501AI.
  2282     05  FILLER            PIC  X(0012).
  2283*    -------------------------------
  2284     05  FILLER            PIC  X(0003).
  2285     05  DATEO PIC  X(0008).
  2286*    -------------------------------
  2287     05  FILLER            PIC  X(0003).
  2288     05  TIMEO PIC  99.99.
  2289*    -------------------------------
  2290     05  FILLER            PIC  X(0003).
  2291     05  CMPNYIDO PIC  X(0003).
  2292*    -------------------------------
  2293     05  FILLER            PIC  X(0003).
  2294     05  USERIDO PIC  X(0004).
  2295*    -------------------------------
  2296     05  FILLER            PIC  X(0003).
  2297     05  MAINTO PIC  X(0001).
  2298*    -------------------------------
  2299     05  FILLER            PIC  X(0003).
  2300     05  CARRO PIC  X(0001).
  2301*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  46
* EL6501.cbl
  2302     05  FILLER            PIC  X(0003).
  2303     05  GROUPINO PIC  X(0006).
  2304*    -------------------------------
  2305     05  FILLER            PIC  X(0003).
  2306     05  STATEO PIC  X(0002).
  2307*    -------------------------------
  2308     05  FILLER            PIC  X(0003).
  2309     05  ACCOUNTO PIC  X(0010).
  2310*    -------------------------------
  2311     05  FILLER            PIC  X(0003).
  2312     05  EFFDTEO PIC  X(0008).
  2313*    -------------------------------
  2314     05  FILLER            PIC  X(0003).
  2315     05  EXPDTEO PIC  99B99B99.
  2316*    -------------------------------
  2317     05  FILLER            PIC  X(0003).
  2318     05  MAINTBYO PIC  X(0004).
  2319*    -------------------------------
  2320     05  FILLER            PIC  X(0003).
  2321     05  PCONTO PIC  X(0030).
  2322*    -------------------------------
  2323     05  FILLER            PIC  X(0003).
  2324     05  CSRO PIC  X(0004).
  2325*    -------------------------------
  2326     05  FILLER            PIC  X(0003).
  2327     05  PDSPLYO PIC  X(0006).
  2328*    -------------------------------
  2329     05  FILLER            PIC  X(0003).
  2330     05  PEFFDTEO PIC  X(0008).
  2331*    -------------------------------
  2332     05  FILLER            PIC  X(0003).
  2333     05  PEXPDTEO PIC  X(0008).
  2334*    -------------------------------
  2335     05  FILLER            PIC  X(0003).
  2336     05  NAMEO PIC  X(0030).
  2337*    -------------------------------
  2338     05  FILLER            PIC  X(0003).
  2339     05  TAXNOO PIC  X(0011).
  2340*    -------------------------------
  2341     05  FILLER            PIC  X(0003).
  2342     05  STATUSO PIC  X(0001).
  2343*    -------------------------------
  2344     05  FILLER            PIC  X(0003).
  2345     05  INCAREO PIC  X(0030).
  2346*    -------------------------------
  2347     05  FILLER            PIC  X(0003).
  2348     05  PHONEO PIC  999B999B9999.
  2349*    -------------------------------
  2350     05  FILLER            PIC  X(0003).
  2351     05  INDGRPO PIC  X(0001).
  2352*    -------------------------------
  2353     05  FILLER            PIC  X(0003).
  2354     05  ADDR1O PIC  X(0030).
  2355*    -------------------------------
  2356     05  FILLER            PIC  X(0003).
  2357     05  CONTRO PIC  X(0008).
  2358*    -------------------------------
  2359     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  47
* EL6501.cbl
  2360     05  TYPEO PIC  X(0002).
  2361*    -------------------------------
  2362     05  FILLER            PIC  X(0003).
  2363     05  ACITYO PIC  X(0028).
  2364*    -------------------------------
  2365     05  FILLER            PIC  X(0003).
  2366     05  ASTATEO PIC  X(0002).
  2367*    -------------------------------
  2368     05  FILLER            PIC  X(0003).
  2369     05  PRODATEO PIC  X(0008).
  2370*    -------------------------------
  2371     05  FILLER            PIC  X(0003).
  2372     05  STDBENO PIC  X(0002).
  2373*    -------------------------------
  2374     05  FILLER            PIC  X(0003).
  2375     05  ZIPO PIC  X(0010).
  2376*    -------------------------------
  2377     05  FILLER            PIC  X(0003).
  2378     05  CTPLABLO PIC  X(0010).
  2379*    -------------------------------
  2380     05  FILLER            PIC  X(0003).
  2381     05  CLPTOLPO PIC  Z.9999.
  2382*    -------------------------------
  2383     05  FILLER            PIC  X(0003).
  2384     05  RETROCDO PIC  X(0003).
  2385*    -------------------------------
  2386     05  FILLER            PIC  X(0003).
  2387     05  BILLCDO PIC  X(0003).
  2388*    -------------------------------
  2389     05  FILLER            PIC  X(0003).
  2390     05  LCLABLO PIC  X(0011).
  2391*    -------------------------------
  2392     05  FILLER            PIC  X(0003).
  2393     05  LCOMMO PIC  ZZ99.99-.
  2394*    -------------------------------
  2395     05  FILLER            PIC  X(0003).
  2396     05  MAXFEEHO PIC  X(0013).
  2397*    -------------------------------
  2398     05  FILLER            PIC  X(0003).
  2399     05  MAXMFEEO PIC  Z,Z99.
  2400*    -------------------------------
  2401     05  FILLER            PIC  X(0003).
  2402     05  CLPSTHO PIC  X(0010).
  2403*    -------------------------------
  2404     05  FILLER            PIC  X(0003).
  2405     05  CLPSTO PIC  X(0002).
  2406*    -------------------------------
  2407     05  FILLER            PIC  X(0003).
  2408     05  PRODCDHO PIC  X(0012).
  2409*    -------------------------------
  2410     05  FILLER            PIC  X(0003).
  2411     05  PRODCDO PIC  X(0003).
  2412*    -------------------------------
  2413     05  FILLER            PIC  X(0003).
  2414     05  REMITO PIC  X(0002).
  2415*    -------------------------------
  2416     05  FILLER            PIC  X(0003).
  2417     05  COMMCALO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  48
* EL6501.cbl
  2418*    -------------------------------
  2419     05  FILLER            PIC  X(0003).
  2420     05  REINTABO PIC  X(0003).
  2421*    -------------------------------
  2422     05  FILLER            PIC  X(0003).
  2423     05  REINCALO PIC  X(0001).
  2424*    -------------------------------
  2425     05  FILLER            PIC  X(0003).
  2426     05  AHHEADO PIC  X(0006).
  2427*    -------------------------------
  2428     05  FILLER            PIC  X(0003).
  2429     05  AGNT1O PIC  X(0010).
  2430*    -------------------------------
  2431     05  FILLER            PIC  X(0003).
  2432     05  TYPE1O PIC  X(0001).
  2433*    -------------------------------
  2434     05  FILLER            PIC  X(0003).
  2435     05  SINRT1O PIC  X(0006).
  2436*    -------------------------------
  2437     05  FILLER            PIC  X(0003).
  2438     05  JNTRT1O PIC  X(0006).
  2439*    -------------------------------
  2440     05  FILLER            PIC  X(0003).
  2441     05  AHRT1O PIC  X(0006).
  2442*    -------------------------------
  2443     05  FILLER            PIC  X(0003).
  2444     05  RECAL1O PIC  X(0001).
  2445*    -------------------------------
  2446     05  FILLER            PIC  X(0003).
  2447     05  COMM1O PIC  X(0001).
  2448*    -------------------------------
  2449     05  FILLER            PIC  X(0003).
  2450     05  CHGBK1O PIC  X(0002).
  2451*    -------------------------------
  2452     05  FILLER            PIC  X(0003).
  2453     05  GLCDE1O PIC  X(0001).
  2454*    -------------------------------
  2455     05  FILLER            PIC  X(0003).
  2456     05  AGNT2O PIC  X(0010).
  2457*    -------------------------------
  2458     05  FILLER            PIC  X(0003).
  2459     05  TYPE2O PIC  X(0001).
  2460*    -------------------------------
  2461     05  FILLER            PIC  X(0003).
  2462     05  SINRT2O PIC  X(0006).
  2463*    -------------------------------
  2464     05  FILLER            PIC  X(0003).
  2465     05  JNTRT2O PIC  X(0006).
  2466*    -------------------------------
  2467     05  FILLER            PIC  X(0003).
  2468     05  AHRT2O PIC  X(0006).
  2469*    -------------------------------
  2470     05  FILLER            PIC  X(0003).
  2471     05  RECAL2O PIC  X(0001).
  2472*    -------------------------------
  2473     05  FILLER            PIC  X(0003).
  2474     05  COMM2O PIC  X(0001).
  2475*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  49
* EL6501.cbl
  2476     05  FILLER            PIC  X(0003).
  2477     05  CHGBK2O PIC  X(0002).
  2478*    -------------------------------
  2479     05  FILLER            PIC  X(0003).
  2480     05  GLCDE2O PIC  X(0001).
  2481*    -------------------------------
  2482     05  FILLER            PIC  X(0003).
  2483     05  AGNT3O PIC  X(0010).
  2484*    -------------------------------
  2485     05  FILLER            PIC  X(0003).
  2486     05  TYPE3O PIC  X(0001).
  2487*    -------------------------------
  2488     05  FILLER            PIC  X(0003).
  2489     05  SINRT3O PIC  X(0006).
  2490*    -------------------------------
  2491     05  FILLER            PIC  X(0003).
  2492     05  JNTRT3O PIC  X(0006).
  2493*    -------------------------------
  2494     05  FILLER            PIC  X(0003).
  2495     05  AHRT3O PIC  X(0006).
  2496*    -------------------------------
  2497     05  FILLER            PIC  X(0003).
  2498     05  RECAL3O PIC  X(0001).
  2499*    -------------------------------
  2500     05  FILLER            PIC  X(0003).
  2501     05  COMM3O PIC  X(0001).
  2502*    -------------------------------
  2503     05  FILLER            PIC  X(0003).
  2504     05  CHGBK3O PIC  X(0002).
  2505*    -------------------------------
  2506     05  FILLER            PIC  X(0003).
  2507     05  GLCDE3O PIC  X(0001).
  2508*    -------------------------------
  2509     05  FILLER            PIC  X(0003).
  2510     05  AGNT4O PIC  X(0010).
  2511*    -------------------------------
  2512     05  FILLER            PIC  X(0003).
  2513     05  TYPE4O PIC  X(0001).
  2514*    -------------------------------
  2515     05  FILLER            PIC  X(0003).
  2516     05  SINRT4O PIC  X(0006).
  2517*    -------------------------------
  2518     05  FILLER            PIC  X(0003).
  2519     05  JNTRT4O PIC  X(0006).
  2520*    -------------------------------
  2521     05  FILLER            PIC  X(0003).
  2522     05  AHRT4O PIC  X(0006).
  2523*    -------------------------------
  2524     05  FILLER            PIC  X(0003).
  2525     05  RECAL4O PIC  X(0001).
  2526*    -------------------------------
  2527     05  FILLER            PIC  X(0003).
  2528     05  COMM4O PIC  X(0001).
  2529*    -------------------------------
  2530     05  FILLER            PIC  X(0003).
  2531     05  CHGBK4O PIC  X(0002).
  2532*    -------------------------------
  2533     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  50
* EL6501.cbl
  2534     05  GLCDE4O PIC  X(0001).
  2535*    -------------------------------
  2536     05  FILLER            PIC  X(0003).
  2537     05  AGNT5O PIC  X(0010).
  2538*    -------------------------------
  2539     05  FILLER            PIC  X(0003).
  2540     05  TYPE5O PIC  X(0001).
  2541*    -------------------------------
  2542     05  FILLER            PIC  X(0003).
  2543     05  SINRT5O PIC  X(0006).
  2544*    -------------------------------
  2545     05  FILLER            PIC  X(0003).
  2546     05  JNTRT5O PIC  X(0006).
  2547*    -------------------------------
  2548     05  FILLER            PIC  X(0003).
  2549     05  AHRT5O PIC  X(0006).
  2550*    -------------------------------
  2551     05  FILLER            PIC  X(0003).
  2552     05  RECAL5O PIC  X(0001).
  2553*    -------------------------------
  2554     05  FILLER            PIC  X(0003).
  2555     05  COMM5O PIC  X(0001).
  2556*    -------------------------------
  2557     05  FILLER            PIC  X(0003).
  2558     05  CHGBK5O PIC  X(0002).
  2559*    -------------------------------
  2560     05  FILLER            PIC  X(0003).
  2561     05  GLCDE5O PIC  X(0001).
  2562*    -------------------------------
  2563     05  FILLER            PIC  X(0003).
  2564     05  AGNT6O PIC  X(0010).
  2565*    -------------------------------
  2566     05  FILLER            PIC  X(0003).
  2567     05  TYPE6O PIC  X(0001).
  2568*    -------------------------------
  2569     05  FILLER            PIC  X(0003).
  2570     05  SINRT6O PIC  X(0006).
  2571*    -------------------------------
  2572     05  FILLER            PIC  X(0003).
  2573     05  JNTRT6O PIC  X(0006).
  2574*    -------------------------------
  2575     05  FILLER            PIC  X(0003).
  2576     05  AHRT6O PIC  X(0006).
  2577*    -------------------------------
  2578     05  FILLER            PIC  X(0003).
  2579     05  RECAL6O PIC  X(0001).
  2580*    -------------------------------
  2581     05  FILLER            PIC  X(0003).
  2582     05  COMM6O PIC  X(0001).
  2583*    -------------------------------
  2584     05  FILLER            PIC  X(0003).
  2585     05  CHGBK6O PIC  X(0002).
  2586*    -------------------------------
  2587     05  FILLER            PIC  X(0003).
  2588     05  GLCDE6O PIC  X(0001).
  2589*    -------------------------------
  2590     05  FILLER            PIC  X(0003).
  2591     05  AGNT7O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  51
* EL6501.cbl
  2592*    -------------------------------
  2593     05  FILLER            PIC  X(0003).
  2594     05  TYPE7O PIC  X(0001).
  2595*    -------------------------------
  2596     05  FILLER            PIC  X(0003).
  2597     05  SINRT7O PIC  X(0006).
  2598*    -------------------------------
  2599     05  FILLER            PIC  X(0003).
  2600     05  JNTRT7O PIC  X(0006).
  2601*    -------------------------------
  2602     05  FILLER            PIC  X(0003).
  2603     05  AHRT7O PIC  X(0006).
  2604*    -------------------------------
  2605     05  FILLER            PIC  X(0003).
  2606     05  RECAL7O PIC  X(0001).
  2607*    -------------------------------
  2608     05  FILLER            PIC  X(0003).
  2609     05  COMM7O PIC  X(0001).
  2610*    -------------------------------
  2611     05  FILLER            PIC  X(0003).
  2612     05  CHGBK7O PIC  X(0002).
  2613*    -------------------------------
  2614     05  FILLER            PIC  X(0003).
  2615     05  GLCDE7O PIC  X(0001).
  2616*    -------------------------------
  2617     05  FILLER            PIC  X(0003).
  2618     05  AGNT8O PIC  X(0010).
  2619*    -------------------------------
  2620     05  FILLER            PIC  X(0003).
  2621     05  TYPE8O PIC  X(0001).
  2622*    -------------------------------
  2623     05  FILLER            PIC  X(0003).
  2624     05  SINRT8O PIC  X(0006).
  2625*    -------------------------------
  2626     05  FILLER            PIC  X(0003).
  2627     05  JNTRT8O PIC  X(0006).
  2628*    -------------------------------
  2629     05  FILLER            PIC  X(0003).
  2630     05  AHRT8O PIC  X(0006).
  2631*    -------------------------------
  2632     05  FILLER            PIC  X(0003).
  2633     05  RECAL8O PIC  X(0001).
  2634*    -------------------------------
  2635     05  FILLER            PIC  X(0003).
  2636     05  COMM8O PIC  X(0001).
  2637*    -------------------------------
  2638     05  FILLER            PIC  X(0003).
  2639     05  CHGBK8O PIC  X(0002).
  2640*    -------------------------------
  2641     05  FILLER            PIC  X(0003).
  2642     05  GLCDE8O PIC  X(0001).
  2643*    -------------------------------
  2644     05  FILLER            PIC  X(0003).
  2645     05  AGNT9O PIC  X(0010).
  2646*    -------------------------------
  2647     05  FILLER            PIC  X(0003).
  2648     05  TYPE9O PIC  X(0001).
  2649*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  52
* EL6501.cbl
  2650     05  FILLER            PIC  X(0003).
  2651     05  SINRT9O PIC  X(0006).
  2652*    -------------------------------
  2653     05  FILLER            PIC  X(0003).
  2654     05  JNTRT9O PIC  X(0006).
  2655*    -------------------------------
  2656     05  FILLER            PIC  X(0003).
  2657     05  AHRT9O PIC  X(0006).
  2658*    -------------------------------
  2659     05  FILLER            PIC  X(0003).
  2660     05  RECAL9O PIC  X(0001).
  2661*    -------------------------------
  2662     05  FILLER            PIC  X(0003).
  2663     05  COMM9O PIC  X(0001).
  2664*    -------------------------------
  2665     05  FILLER            PIC  X(0003).
  2666     05  CHGBK9O PIC  X(0002).
  2667*    -------------------------------
  2668     05  FILLER            PIC  X(0003).
  2669     05  GLCDE9O PIC  X(0001).
  2670*    -------------------------------
  2671     05  FILLER            PIC  X(0003).
  2672     05  AGNT10O PIC  X(0010).
  2673*    -------------------------------
  2674     05  FILLER            PIC  X(0003).
  2675     05  TYPE10O PIC  X(0001).
  2676*    -------------------------------
  2677     05  FILLER            PIC  X(0003).
  2678     05  SINRT10O PIC  X(0006).
  2679*    -------------------------------
  2680     05  FILLER            PIC  X(0003).
  2681     05  JNTRT10O PIC  X(0006).
  2682*    -------------------------------
  2683     05  FILLER            PIC  X(0003).
  2684     05  AHRT10O PIC  X(0006).
  2685*    -------------------------------
  2686     05  FILLER            PIC  X(0003).
  2687     05  RECAL10O PIC  X(0001).
  2688*    -------------------------------
  2689     05  FILLER            PIC  X(0003).
  2690     05  COMM10O PIC  X(0001).
  2691*    -------------------------------
  2692     05  FILLER            PIC  X(0003).
  2693     05  CHGBK10O PIC  X(0002).
  2694*    -------------------------------
  2695     05  FILLER            PIC  X(0003).
  2696     05  GLCDE10O PIC  X(0001).
  2697*    -------------------------------
  2698     05  FILLER            PIC  X(0003).
  2699     05  ERRMSG1O PIC  X(0075).
  2700*    -------------------------------
  2701     05  FILLER            PIC  X(0003).
  2702     05  PFENTERO PIC  X(0002).
  2703*    -------------------------------
  2704     05  FILLER            PIC  X(0003).
  2705     05  PF1PF2O PIC  X(0035).
  2706*    -------------------------------
  2707 01  MAP-R REDEFINES EL6501AI.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  53
* EL6501.cbl
  2708*    12  FILLER                  PIC X(518).
  2709*    12  FILLER                  PIC X(543).
  2710     12  FILLER                  PIC X(546).
  2711     12  MAP-AGENT-AREA.
  2712         16  AGENT-AREA OCCURS 10 TIMES INDEXED BY M-INDEX.
  2713             20  AGENTL          PIC S9(4) COMP.
  2714             20  AGENTA          PIC X.
  2715             20  AGENT           PIC X(10).
  2716             20  ATYPEL          PIC S9(4) COMP.
  2717             20  ATYPEA          PIC X.
  2718             20  ATYPE           PIC X.
  2719             20  SINGLEL         PIC S9(4) COMP.
  2720             20  SINGLEA         PIC X.
  2721             20  SINGLE-COMM-T   PIC X(6).
  2722             20  SINGLE-COMM-N REDEFINES SINGLE-COMM-T.
  2723                 24  SINGLE-COMM-R PIC V9(5).
  2724                 24  SINGLE-DASH   PIC X.
  2725             20  SINGLE-COMM-O REDEFINES SINGLE-COMM-T
  2726                                 PIC V9(5)-.
  2727             20  JOINTL          PIC S9(4) COMP.
  2728             20  JOINTA          PIC X.
  2729             20  JOINT-COMM-T    PIC X(6).
  2730             20  JOINT-COMM-N REDEFINES JOINT-COMM-T.
  2731                 24  JOINT-COMM-R PIC V9(5).
  2732                 24  JOINT-DASH   PIC X.
  2733             20  JOINT-COMM-O REDEFINES JOINT-COMM-T
  2734                                 PIC V9(5)-.
  2735             20  A-HL            PIC S9(4) COMP.
  2736             20  A-HA            PIC X.
  2737             20  A-H-COMM-T      PIC X(6).
  2738             20  A-H-COMM-N  REDEFINES A-H-COMM-T.
  2739                 24  A-H-COMM-R  PIC V9(5).
  2740                 24  A-H-DASH    PIC X.
  2741             20  A-H-COMM-O  REDEFINES A-H-COMM-T
  2742                                 PIC V9(5)-.
  2743             20  RECALL          PIC S9(4) COMP.
  2744             20  RECALA          PIC X.
  2745             20  RECAL           PIC X.
  2746             20  RCOMML          PIC S9(4) COMP.
  2747             20  RCOMMA          PIC X.
  2748             20  RCOMM           PIC X.
  2749             20  CHGBCKL         PIC S9(4) COMP.
  2750             20  CHGBCKA         PIC X.
  2751             20  CHGBCK          PIC X(02).
  2752             20  GLCODEL         PIC S9(4) COMP.
  2753             20  GLCODEA         PIC X.
  2754             20  GLCODE          PIC X.
  2755****************************************************************
  2756*
  2757* Copyright (c) 2007 by Clerity Solutions, Inc.
  2758* All rights reserved.
  2759*
  2760****************************************************************
  2761 01  DFHEIV.
  2762   02  DFHEIV0               PIC X(35).
  2763   02  DFHEIV1               PIC X(08).
  2764   02  DFHEIV2               PIC X(08).
  2765   02  DFHEIV3               PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  54
* EL6501.cbl
  2766   02  DFHEIV4               PIC X(06).
  2767   02  DFHEIV5               PIC X(04).
  2768   02  DFHEIV6               PIC X(04).
  2769   02  DFHEIV7               PIC X(02).
  2770   02  DFHEIV8               PIC X(02).
  2771   02  DFHEIV9               PIC X(01).
  2772   02  DFHEIV10              PIC S9(7) COMP-3.
  2773   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2774   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2775   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2776   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2777   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2778   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2779   02  DFHEIV17              PIC X(04).
  2780   02  DFHEIV18              PIC X(04).
  2781   02  DFHEIV19              PIC X(04).
  2782   02  DFHEIV20              USAGE IS POINTER.
  2783   02  DFHEIV21              USAGE IS POINTER.
  2784   02  DFHEIV22              USAGE IS POINTER.
  2785   02  DFHEIV23              USAGE IS POINTER.
  2786   02  DFHEIV24              USAGE IS POINTER.
  2787   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2788   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2789   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2790   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2791   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2792   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2793   02  FILLER                PIC X(02).
  2794   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2795   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2796   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2797   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2798   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2799 LINKAGE  SECTION.
  2800*****************************************************************
  2801*                                                               *
  2802* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2803* All rights reserved.                                          *
  2804*                                                               *
  2805*****************************************************************
  2806 01  dfheiblk.
  2807     02  eibtime          pic s9(7) comp-3.
  2808     02  eibdate          pic s9(7) comp-3.
  2809     02  eibtrnid         pic x(4).
  2810     02  eibtaskn         pic s9(7) comp-3.
  2811     02  eibtrmid         pic x(4).
  2812     02  dfheigdi         pic s9(4) comp.
  2813     02  eibcposn         pic s9(4) comp.
  2814     02  eibcalen         pic s9(4) comp.
  2815     02  eibaid           pic x(1).
  2816     02  eibfiller1       pic x(1).
  2817     02  eibfn            pic x(2).
  2818     02  eibfiller2       pic x(2).
  2819     02  eibrcode         pic x(6).
  2820     02  eibfiller3       pic x(2).
  2821     02  eibds            pic x(8).
  2822     02  eibreqid         pic x(8).
  2823     02  eibrsrce         pic x(8).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  55
* EL6501.cbl
  2824     02  eibsync          pic x(1).
  2825     02  eibfree          pic x(1).
  2826     02  eibrecv          pic x(1).
  2827     02  eibsend          pic x(1).
  2828     02  eibatt           pic x(1).
  2829     02  eibeoc           pic x(1).
  2830     02  eibfmh           pic x(1).
  2831     02  eibcompl         pic x(1).
  2832     02  eibsig           pic x(1).
  2833     02  eibconf          pic x(1).
  2834     02  eiberr           pic x(1).
  2835     02  eibrldbk         pic x(1).
  2836     02  eiberrcd         pic x(4).
  2837     02  eibsynrb         pic x(1).
  2838     02  eibnodat         pic x(1).
  2839     02  eibfiller5       pic x(2).
  2840     02  eibresp          pic 9(09) comp.
  2841     02  eibresp2         pic 9(09) comp.
  2842     02  dfheigdj         pic s9(4) comp.
  2843     02  dfheigdk         pic s9(4) comp.
  2844 01  DFHCOMMAREA                 PIC X(1500).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  56
* EL6501.cbl
  2846*01 PARMLIST .
  2847*    02  FILLER                  PIC S9(8)   COMP.
  2848*    02  ERACCT-POINTER          PIC S9(8)   COMP.
  2849*    02  ELCNTL-POINTER          PIC S9(8)   COMP.
  2850*    02  REIN-POINTER            PIC S9(8)   COMP.
  2851*    02  CTBL-POINTER            PIC S9(8)   COMP.
  2852*    02  COMM-POINTER            PIC S9(8)   COMP.
  2853*    02  COMP-POINTER            PIC S9(8)   COMP.
  2854*    02  NAME-POINTER            PIC S9(8)   COMP.
  2855*    02  RQST-POINTER            PIC S9(8)   COMP.
  2856*    02  AXRF-POINTER            PIC S9(8)   COMP.
  2857*    02  AXRF2-POINTER           PIC S9(8)   COMP.
  2858*    02  AXRF3-POINTER           PIC S9(8)   COMP.
  2859*    02  AXRF4-POINTER           PIC S9(8)   COMP.
  2860*    02  AXRF5-POINTER           PIC S9(8)   COMP.
  2861*    02  AXRF6-POINTER           PIC S9(8)   COMP.
  2862*    02  AXRF7-POINTER           PIC S9(8)   COMP.
  2863*    02  AXRF8-POINTER           PIC S9(8)   COMP.
  2864*    COPY ERCACCT.
  2865******************************************************************
  2866*                                                                *
  2867*                                                                *
  2868*                            ERCACCT                             *
  2869*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2870*                            VMOD=2.031                          *
  2871*                                                                *
  2872*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2873*                                                                *
  2874*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2875*   VSAM ACCOUNT MASTER FILES.                                   *
  2876*                                                                *
  2877*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2878*                                                                *
  2879*   FILE TYPE = VSAM,KSDS                                        *
  2880*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2881*                                                                *
  2882*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2883*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2884*                                                                *
  2885*   LOG = NO                                                     *
  2886*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2887*                                                                *
  2888*                                                                *
  2889******************************************************************
  2890*                   C H A N G E   L O G
  2891*
  2892* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2893*-----------------------------------------------------------------
  2894*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2895* EFFECTIVE    NUMBER
  2896*-----------------------------------------------------------------
  2897* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2898* 092705    2005050300006  PEMA  ADD SPP LEASES
  2899* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2900* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2901* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2902* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2903* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  57
* EL6501.cbl
  2904* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2905******************************************************************
  2906
  2907 01  ACCOUNT-MASTER.
  2908     12  AM-RECORD-ID                      PIC XX.
  2909         88  VALID-AM-ID                      VALUE 'AM'.
  2910
  2911     12  AM-CONTROL-PRIMARY.
  2912         16  AM-COMPANY-CD                 PIC X.
  2913         16  AM-MSTR-CNTRL.
  2914             20  AM-CONTROL-A.
  2915                 24  AM-CARRIER            PIC X.
  2916                 24  AM-GROUPING.
  2917                     28 AM-GROUPING-PREFIX PIC XXX.
  2918                     28 AM-GROUPING-PRIME  PIC XXX.
  2919                 24  AM-STATE              PIC XX.
  2920                 24  AM-ACCOUNT.
  2921                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2922                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2923             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2924                                           PIC X(19).
  2925             20  AM-CNTRL-B.
  2926                 24  AM-EXPIRATION-DT      PIC XX.
  2927                 24  FILLER                PIC X(4).
  2928             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2929                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2930
  2931     12  AM-CONTROL-BY-VAR-GRP.
  2932         16  AM-COMPANY-CD-A1              PIC X.
  2933         16  AM-VG-CARRIER                 PIC X.
  2934         16  AM-VG-GROUPING                PIC X(6).
  2935         16  AM-VG-STATE                   PIC XX.
  2936         16  AM-VG-ACCOUNT                 PIC X(10).
  2937         16  AM-VG-DATE.
  2938             20  AM-VG-EXPIRATION-DT       PIC XX.
  2939             20  FILLER                    PIC X(4).
  2940         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2941                                           PIC 9(11)      COMP-3.
  2942     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2943         16  FILLER                        PIC X(10).
  2944         16  AM-VG-KEY3.
  2945             20  AM-VG3-ACCOUNT            PIC X(10).
  2946             20  AM-VG3-EXP-DT             PIC XX.
  2947         16  FILLER                        PIC X(4).
  2948     12  AM-MAINT-INFORMATION.
  2949         16  AM-LAST-MAINT-DT              PIC XX.
  2950         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2951         16  AM-LAST-MAINT-USER            PIC X(4).
  2952         16  FILLER                        PIC XX.
  2953
  2954     12  AM-EFFECTIVE-DT                   PIC XX.
  2955     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2956
  2957     12  AM-PREV-DATES  COMP-3.
  2958         16  AM-PREV-EXP-DT                PIC 9(11).
  2959         16  AM-PREV-EFF-DT                PIC 9(11).
  2960
  2961     12  AM-REPORT-CODE-1                  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  58
* EL6501.cbl
  2962     12  AM-REPORT-CODE-2                  PIC X(10).
  2963
  2964     12  AM-CITY-CODE                      PIC X(4).
  2965     12  AM-COUNTY-PARISH                  PIC X(6).
  2966
  2967     12  AM-NAME                           PIC X(30).
  2968     12  AM-PERSON                         PIC X(30).
  2969     12  AM-ADDRS                          PIC X(30).
  2970     12  AM-CITY.
  2971         16  AM-ADDR-CITY                  PIC X(28).
  2972         16  AM-ADDR-STATE                 PIC XX.
  2973     12  AM-ZIP.
  2974         16  AM-ZIP-PRIME.
  2975             20  AM-ZIP-PRI-1ST            PIC X.
  2976                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2977             20  FILLER                    PIC X(4).
  2978         16  AM-ZIP-PLUS4                  PIC X(4).
  2979     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2980         16  AM-CAN-POSTAL-1               PIC XXX.
  2981         16  AM-CAN-POSTAL-2               PIC XXX.
  2982         16  FILLER                        PIC XXX.
  2983     12  AM-TEL-NO.
  2984         16  AM-AREA-CODE                  PIC 999.
  2985         16  AM-TEL-PRE                    PIC 999.
  2986         16  AM-TEL-NBR                    PIC 9(4).
  2987     12  AM-TEL-LOC                        PIC X.
  2988         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2989         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2990
  2991     12  AM-COMM-STRUCTURE.
  2992         16  AM-DEFN-1.
  2993             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2994                 24  AM-AGT.
  2995                     28  AM-AGT-PREFIX     PIC X(4).
  2996                     28  AM-AGT-PRIME      PIC X(6).
  2997                 24  AM-COM-TYP            PIC X.
  2998                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2999                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3000                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3001                 24  AM-RECALC-LV-INDIC    PIC X.
  3002                 24  AM-RETRO-LV-INDIC     PIC X.
  3003                 24  AM-GL-CODES           PIC X.
  3004                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3005                 24  FILLER                PIC X(01).
  3006         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  3007             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3008                 24  FILLER                PIC X(11).
  3009                 24  AM-L-COMA             PIC XXX.
  3010                 24  AM-J-COMA             PIC XXX.
  3011                 24  AM-A-COMA             PIC XXX.
  3012                 24  FILLER                PIC X(6).
  3013
  3014     12  AM-COMM-CHANGE-STATUS             PIC X.
  3015         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3016
  3017     12  AM-CSR-CODE                       PIC X(4).
  3018
  3019     12  AM-BILLING-STATUS                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  59
* EL6501.cbl
  3020         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3021         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3022     12  AM-AUTO-REFUND-SW                 PIC X.
  3023         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3024         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3025     12  AM-GPCD                           PIC 99.
  3026     12  AM-IG                             PIC X.
  3027         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3028         88  AM-HAS-GROUP                     VALUE '2'.
  3029     12  AM-STATUS                         PIC X.
  3030         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3031         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3032         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3033         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3034         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3035         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3036         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  3037         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  3038         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  3039         88  AM-ACCOUNT-PENDING               VALUE '9'.
  3040     12  AM-REMIT-TO                       PIC 99.
  3041     12  AM-ID-NO                          PIC X(11).
  3042
  3043     12  AM-CAL-TABLE                      PIC XX.
  3044     12  AM-LF-DEVIATION                   PIC XXX.
  3045     12  AM-AH-DEVIATION                   PIC XXX.
  3046     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3047     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3048     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3049     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3050     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3051     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3052
  3053     12  AM-USER-FIELDS.
  3054         16  AM-FLD-1                      PIC XX.
  3055         16  AM-FLD-2                      PIC XX.
  3056         16  AM-FLD-3                      PIC XX.
  3057         16  AM-FLD-4                      PIC XX.
  3058         16  AM-FLD-5                      PIC XX.
  3059
  3060     12  AM-1ST-PROD-DATE.
  3061         16  AM-1ST-PROD-YR                PIC XX.
  3062         16  AM-1ST-PROD-MO                PIC XX.
  3063         16  AM-1ST-PROD-DA                PIC XX.
  3064     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3065     12  AM-CERTS-PURGED-DATE.
  3066         16  AM-PUR-YR                     PIC XX.
  3067         16  AM-PUR-MO                     PIC XX.
  3068         16  AM-PUR-DA                     PIC XX.
  3069     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3070     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3071     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3072     12  AM-INACTIVE-DATE.
  3073         16  AM-INA-MO                     PIC 99.
  3074         16  AM-INA-DA                     PIC 99.
  3075         16  AM-INA-YR                     PIC 99.
  3076     12  AM-AR-HI-CERT-DATE                PIC XX.
  3077
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  60
* EL6501.cbl
  3078     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3079     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3080
  3081     12  AM-OB-PAYMENT-MODE                PIC X.
  3082         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3083         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3084         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3085         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3086
  3087     12  AM-AH-ONLY-INDICATOR              PIC X.
  3088         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3089         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3090
  3091     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3092
  3093     12  AM-OVER-SHORT.
  3094         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3095         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3096
  3097     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3098     12  AM-DCC-CLP-STATE                  PIC XX.
  3099
  3100     12  AM-RECALC-COMM                    PIC X.
  3101     12  AM-RECALC-REIN                    PIC X.
  3102
  3103     12  AM-REI-TABLE                      PIC XXX.
  3104     12  AM-REI-ET-LF                      PIC X.
  3105     12  AM-REI-ET-AH                      PIC X.
  3106     12  AM-REI-PE-LF                      PIC X.
  3107     12  AM-REI-PE-AH                      PIC X.
  3108     12  AM-REI-PRT-ST                     PIC X.
  3109     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3110     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3111     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3112     12  AM-REI-GROUP-A                    PIC X(6).
  3113     12  AM-REI-MORT                       PIC X(4).
  3114     12  AM-REI-PRT-OW                     PIC X.
  3115     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3116     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3117     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3118     12  AM-REI-GROUP-B                    PIC X(6).
  3119
  3120     12  AM-TRUST-TYPE                     PIC X(2).
  3121
  3122     12  AM-EMPLOYER-STMT-USED             PIC X.
  3123     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3124
  3125     12  AM-STD-AH-TYPE                    PIC XX.
  3126     12  AM-EARN-METHODS.
  3127         16  AM-EARN-METHOD-R              PIC X.
  3128             88 AM-REF-RL-R78                 VALUE 'R'.
  3129             88 AM-REF-RL-PR                  VALUE 'P'.
  3130             88 AM-REF-RL-MEAN                VALUE 'M'.
  3131             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3132         16  AM-EARN-METHOD-L              PIC X.
  3133             88 AM-REF-LL-R78                 VALUE 'R'.
  3134             88 AM-REF-LL-PR                  VALUE 'P'.
  3135             88 AM-REF-LL-MEAN                VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  61
* EL6501.cbl
  3136             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3137         16  AM-EARN-METHOD-A              PIC X.
  3138             88 AM-REF-AH-R78                 VALUE 'R'.
  3139             88 AM-REF-AH-PR                  VALUE 'P'.
  3140             88 AM-REF-AH-MEAN                VALUE 'M'.
  3141             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3142             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3143             88 AM-REF-AH-NET                 VALUE 'N'.
  3144
  3145     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3146     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3147     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3148
  3149     12  AM-RET-Y-N                        PIC X.
  3150     12  AM-RET-P-E                        PIC X.
  3151     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3152     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3153     12  AM-RET-GRP                        PIC X(6).
  3154     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3155         16  AM-POOL-PRIME                 PIC XXX.
  3156         16  AM-POOL-SUB                   PIC XXX.
  3157     12  AM-RETRO-EARNINGS.
  3158         16  AM-RET-EARN-R                 PIC X.
  3159         16  AM-RET-EARN-L                 PIC X.
  3160         16  AM-RET-EARN-A                 PIC X.
  3161     12  AM-RET-ST-TAX-USE                 PIC X.
  3162         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3163         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3164     12  AM-RETRO-BEG-EARNINGS.
  3165         16  AM-RET-BEG-EARN-R             PIC X.
  3166         16  AM-RET-BEG-EARN-L             PIC X.
  3167         16  AM-RET-BEG-EARN-A             PIC X.
  3168     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3169     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3170
  3171     12  AM-USER-SELECT-OPTIONS.
  3172         16  AM-USER-SELECT-1              PIC X(10).
  3173         16  AM-USER-SELECT-2              PIC X(10).
  3174         16  AM-USER-SELECT-3              PIC X(10).
  3175         16  AM-USER-SELECT-4              PIC X(10).
  3176         16  AM-USER-SELECT-5              PIC X(10).
  3177
  3178     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3179
  3180     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3181
  3182     12  AM-RPT045A-SWITCH                 PIC X.
  3183         88  RPT045A-OFF                   VALUE 'N'.
  3184
  3185     12  AM-INSURANCE-LIMITS.
  3186         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  3187         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  3188
  3189     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3190         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  3191
  3192     12  AM-DISMBR-COVERAGE-SW             PIC X.
  3193         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  62
* EL6501.cbl
  3194         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  3195
  3196     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  3197
  3198     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  3199     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3200     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3201     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3202     12  AM-DCC-UEF-STATE                  PIC XX.
  3203     12  FILLER                            PIC XXX.
  3204     12  AM-REPORT-CODE-3                  PIC X(10).
  3205*    12  FILLER                            PIC X(22).
  3206
  3207     12  AM-RESERVE-DATE.
  3208         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  3209         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  3210         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  3211
  3212     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  3213     12  AM-NOTIFICATION-TYPES.
  3214         16  AM-NOTIF-OF-LETTERS           PIC X.
  3215         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  3216         16  AM-NOTIF-OF-REPORTS           PIC X.
  3217         16  AM-NOTIF-OF-STATUS            PIC X.
  3218
  3219     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  3220         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  3221         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  3222         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  3223         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  3224
  3225     12  AM-BENEFIT-CONTROLS.
  3226         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  3227             20  AM-BENEFIT-CODE           PIC XX.
  3228             20  AM-BENEFIT-TYPE           PIC X.
  3229             20  AM-BENEFIT-REVISION       PIC XXX.
  3230             20  AM-BENEFIT-REM-TERM       PIC X.
  3231             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  3232             20  FILLER                    PIC XX.
  3233         16  FILLER                        PIC X(80).
  3234
  3235     12  AM-TRANSFER-DATA.
  3236         16  AM-TRANSFERRED-FROM.
  3237             20  AM-TRNFROM-CARRIER        PIC X.
  3238             20  AM-TRNFROM-GROUPING.
  3239                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  3240                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  3241             20  AM-TRNFROM-STATE          PIC XX.
  3242             20  AM-TRNFROM-ACCOUNT.
  3243                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  3244                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  3245             20  AM-TRNFROM-DTE            PIC XX.
  3246         16  AM-TRANSFERRED-TO.
  3247             20  AM-TRNTO-CARRIER          PIC X.
  3248             20  AM-TRNTO-GROUPING.
  3249                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  3250                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  3251             20  AM-TRNTO-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  63
* EL6501.cbl
  3252             20  AM-TRNTO-ACCOUNT.
  3253                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  3254                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  3255             20  AM-TRNTO-DTE              PIC XX.
  3256         16  FILLER                        PIC X(10).
  3257
  3258     12  AM-SAVED-REMIT-TO                 PIC 99.
  3259
  3260     12  AM-COMM-STRUCTURE-SAVED.
  3261         16  AM-DEFN-1-SAVED.
  3262             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  3263                 24  AM-AGT-SV             PIC X(10).
  3264                 24  AM-COM-TYP-SV         PIC X.
  3265                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  3266                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  3267                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  3268                 24  AM-RECALC-LV-INDIC-SV PIC X.
  3269                 24  FILLER                PIC X.
  3270                 24  AM-GL-CODES-SV        PIC X.
  3271                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  3272                 24  FILLER                PIC X.
  3273         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  3274             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  3275                 24  FILLER                PIC X(11).
  3276                 24  AM-L-COMA-SV          PIC XXX.
  3277                 24  AM-J-COMA-SV          PIC XXX.
  3278                 24  AM-A-COMA-SV          PIC XXX.
  3279                 24  FILLER                PIC X(6).
  3280
  3281     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  3282         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  3283            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  3284            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  3285            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  3286
  3287     12  AM-ORIG-DEALER-NO                 PIC X(10).
  3288     12  FILLER                            PIC X(120).
  3289
  3290     12  AM-ACCOUNT-EXECUTIVE-DATA.
  3291         16  AM-CONTROL-NAME               PIC X(30).
  3292         16  AM-EXECUTIVE-ONE.
  3293             20  AM-EXEC1-NAME             PIC X(15).
  3294             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  3295                                                          COMP-3.
  3296             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  3297                                                          COMP-3.
  3298         16  AM-EXECUTIVE-TWO.
  3299             20  AM-EXEC2-NAME             PIC X(15).
  3300             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  3301                                                          COMP-3.
  3302             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  3303                                                          COMP-3.
  3304
  3305     12  AM-RETRO-ADDITIONAL-DATA.
  3306         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  3307         16  AM-RETRO-PREM-P-E             PIC X.
  3308         16  AM-RETRO-CLMS-P-I             PIC X.
  3309         16  AM-RETRO-RET-BRACKET-LF.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  64
* EL6501.cbl
  3310             20  AM-RETRO-RET-METHOD-LF    PIC X.
  3311                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  3312                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  3313             20  AM-RETRO-RET-BASIS-LF     PIC X.
  3314                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  3315                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  3316             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  3317                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  3318                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3319         16  AM-RETRO-RET-BRACKET-AH.
  3320             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3321                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3322                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3323                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3324             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3325                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  3326                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3327             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3328                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3329                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3330
  3331     12  AM-COMMENTS.
  3332         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3333
  3334     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3335         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3336         16  AM-FLI-BILLING-CODE           PIC X.
  3337         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3338         16  AM-FLI-UNITED-IDENT           PIC X.
  3339         16  AM-FLI-INTEREST-LOST-DATA.
  3340             20  AM-FLI-BANK-NO            PIC X(5).
  3341             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3342             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3343             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3344         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3345             20  AM-FLI-AGT                PIC X(9).
  3346             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3347             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3348         16  FILLER                        PIC X(102).
  3349
  3350     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3351         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3352             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3353             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3354             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3355             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3356             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3357         16  FILLER                          PIC X(10).
  3358******************************************************************
  3359*    copy ERCPDEF.
  3360******************************************************************
  3361*                                                                *
  3362*                                                                *
  3363*                            ERCPDEF.                            *
  3364*                                                                *
  3365*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3366*                                                                *
  3367*    FILE TYPE = VSAM,KSDS                                       *
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  65
* EL6501.cbl
  3368*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3369*                                                                *
  3370*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3371*                                                                *
  3372*    LOG = YES                                                   *
  3373*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3374******************************************************************
  3375*                   C H A N G E   L O G
  3376*
  3377* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3378*-----------------------------------------------------------------
  3379*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3380* EFFECTIVE    NUMBER
  3381*-----------------------------------------------------------------
  3382* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3383* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3384* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  3385******************************************************************
  3386 01  PRODUCT-MASTER.
  3387    12  PD-RECORD-ID                 PIC X(02).
  3388        88  VALID-PD-ID                  VALUE 'PD'.
  3389    12  PD-CONTROL-PRIMARY.
  3390        16  PD-COMPANY-CD            PIC X.
  3391        16  PD-STATE                 PIC XX.
  3392        16  PD-PRODUCT-CD            PIC XXX.
  3393        16  PD-FILLER                PIC X(7).
  3394        16  PD-BEN-TYPE              PIC X.
  3395        16  PD-BEN-CODE              PIC XX.
  3396        16  PD-PROD-EXP-DT           PIC XX.
  3397    12  FILLER                       PIC X(50).
  3398    12  PD-PRODUCT-DATA OCCURS 8.
  3399        16  PD-PROD-CODE             PIC X.
  3400            88  PD-PROD-LIFE           VALUE 'L'.
  3401            88  PD-PROD-PROP           VALUE 'P'.
  3402            88  PD-PROD-AH             VALUE 'A'.
  3403            88  PD-PROD-IU             VALUE 'I'.
  3404            88  PD-PROD-GAP            VALUE 'G'.
  3405            88  PD-PROD-FAML           VALUE 'F'.
  3406        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3407        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3408        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3409        16  PD-MAX-TERM              PIC S999        COMP-3.
  3410        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3411        16  FILLER                   PIC X.
  3412        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3413        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3414        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3415        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3416        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3417        16  PD-REC-CRIT-PERIOD       PIC 99.
  3418        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  3419            20  PD-RECURRING-YN      PIC X.
  3420            20  FILLER               PIC X.
  3421        16  PD-RTW-MOS               PIC 99.
  3422        16  PD-MAX-EXTENSION         PIC 99.
  3423        16  pd-ben-pct               pic sv999 comp-3.
  3424*       16  FILLER                   PIC XX.
  3425    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  66
* EL6501.cbl
  3426    12  PD-TERM-LIMITS OCCURS 15.
  3427        16  PD-LOW-TERM              PIC S999        COMP-3.
  3428        16  PD-HI-TERM               PIC S999        COMP-3.
  3429*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3430    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3431        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3432        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3433    12  PD-EARN-FACTORS.
  3434        16  FILLER OCCURS 15.
  3435            20  FILLER OCCURS 15.
  3436                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3437    12  PD-PRODUCT-DESC              PIC X(80).
  3438    12  PD-TRUNCATED                 PIC X.
  3439    12  FILLER                       PIC X(59).
  3440    12  PD-MAINT-INFORMATION.
  3441        16  PD-LAST-MAINT-DT         PIC X(02).
  3442        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3443        16  PD-LAST-MAINT-BY         PIC X(04).
  3444*    COPY ELCCNTL.
  3445******************************************************************
  3446*                                                                *
  3447*                                                                *
  3448*                            ELCCNTL.                            *
  3449*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3450*                            VMOD=2.059                          *
  3451*                                                                *
  3452*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3453*                                                                *
  3454*   FILE TYPE = VSAM,KSDS                                        *
  3455*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3456*                                                                *
  3457*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3458*       ALTERNATE INDEX = NONE                                   *
  3459*                                                                *
  3460*   LOG = YES                                                    *
  3461*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3462******************************************************************
  3463*                   C H A N G E   L O G
  3464*
  3465* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3466*-----------------------------------------------------------------
  3467*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3468* EFFECTIVE    NUMBER
  3469*-----------------------------------------------------------------
  3470* 082503                   PEMA  ADD BENEFIT GROUP
  3471* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3472* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3473* 092705    2005050300006  PEMA  ADD SPP LEASES
  3474* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3475* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3476* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3477* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3478* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3479* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3480* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3481* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3482* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3483* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  67
* EL6501.cbl
  3484******************************************************************
  3485*
  3486 01  CONTROL-FILE.
  3487     12  CF-RECORD-ID                       PIC XX.
  3488         88  VALID-CF-ID                        VALUE 'CF'.
  3489
  3490     12  CF-CONTROL-PRIMARY.
  3491         16  CF-COMPANY-ID                  PIC XXX.
  3492         16  CF-RECORD-TYPE                 PIC X.
  3493             88  CF-COMPANY-MASTER              VALUE '1'.
  3494             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3495             88  CF-STATE-MASTER                VALUE '3'.
  3496             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3497             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3498             88  CF-CARRIER-MASTER              VALUE '6'.
  3499             88  CF-MORTALITY-MASTER            VALUE '7'.
  3500             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3501             88  CF-TERMINAL-MASTER             VALUE '9'.
  3502             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3503             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3504             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3505             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3506             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3507             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3508             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3509             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3510             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3511         16  CF-ACCESS-CD-GENL              PIC X(4).
  3512         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3513             20  CF-PROCESSOR               PIC X(4).
  3514         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3515             20  CF-STATE-CODE              PIC XX.
  3516             20  FILLER                     PIC XX.
  3517         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3518             20  FILLER                     PIC XX.
  3519             20  CF-HI-BEN-IN-REC           PIC XX.
  3520         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3521             20  FILLER                     PIC XXX.
  3522             20  CF-CARRIER-CNTL            PIC X.
  3523         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3524             20  FILLER                     PIC XX.
  3525             20  CF-HI-TYPE-IN-REC          PIC 99.
  3526         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3527             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3528                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3529             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3530             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3531         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3532             20  FILLER                     PIC X.
  3533             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3534         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3535             20  FILLER                     PIC XX.
  3536             20  CF-MORTGAGE-PLAN           PIC XX.
  3537         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3538
  3539     12  CF-LAST-MAINT-DT                   PIC XX.
  3540     12  CF-LAST-MAINT-BY                   PIC X(4).
  3541     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  68
* EL6501.cbl
  3542
  3543     12  CF-RECORD-BODY                     PIC X(728).
  3544
  3545
  3546****************************************************************
  3547*             COMPANY MASTER RECORD                            *
  3548****************************************************************
  3549
  3550     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3551         16  CF-COMPANY-ADDRESS.
  3552             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3553             20  CF-CL-IN-CARE-OF           PIC X(30).
  3554             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3555             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3556             20  CF-CL-CITY-STATE           PIC X(30).
  3557             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3558             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3559         16  CF-COMPANY-CD                  PIC X.
  3560         16  CF-COMPANY-PASSWORD            PIC X(8).
  3561         16  CF-SECURITY-OPTION             PIC X.
  3562             88  ALL-SECURITY                   VALUE '1'.
  3563             88  COMPANY-VERIFY                 VALUE '2'.
  3564             88  PROCESSOR-VERIFY               VALUE '3'.
  3565             88  NO-SECURITY                    VALUE '4'.
  3566             88  ALL-BUT-TERM                   VALUE '5'.
  3567         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3568             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3569         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3570             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3571         16  CF-INFORCE-LOCATION            PIC X.
  3572             88  CERTS-ARE-ONLINE               VALUE '1'.
  3573             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3574             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3575         16  CF-LOWER-CASE-LETTERS          PIC X.
  3576         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3577             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3578             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3579             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3580             88  CF-ACCNT-CNTL                  VALUE '3'.
  3581             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3582
  3583         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3584         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3585
  3586         16  CF-LGX-CREDIT-USER             PIC X.
  3587             88  CO-IS-NOT-USER                 VALUE 'N'.
  3588             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3589
  3590         16 CF-CREDIT-CALC-CODES.
  3591             20  CF-CR-REM-TERM-CALC PIC X.
  3592               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3593               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3594               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3595               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3596               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3597               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3598               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3599             20  CF-CR-R78-METHOD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  69
* EL6501.cbl
  3600               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3601               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3602
  3603         16  CF-CLAIM-CONTROL-COUNTS.
  3604             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3605                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3606
  3607             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3608                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3609
  3610             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3611                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3612
  3613             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3614                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3615
  3616         16  CF-CURRENT-MONTH-END           PIC XX.
  3617
  3618         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3619             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3620             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3621             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3622             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3623                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3624                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3625             20  CF-CO-PREM-REJECT-SW       PIC X.
  3626                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3627                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3628             20  CF-CO-REF-REJECT-SW        PIC X.
  3629                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3630                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3631
  3632         16  CF-CO-REPORTING-DT             PIC XX.
  3633         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3634         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3635           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3636           88  CF-CO-MONTH-END                  VALUE '1'.
  3637
  3638         16  CF-LGX-CLAIM-USER              PIC X.
  3639             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3640             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3641
  3642         16  CF-CREDIT-EDIT-CONTROLS.
  3643             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3644             20  CF-MIN-AGE                 PIC 99.
  3645             20  CF-DEFAULT-AGE             PIC 99.
  3646             20  CF-MIN-TERM                PIC S999      COMP-3.
  3647             20  CF-MAX-TERM                PIC S999      COMP-3.
  3648             20  CF-DEFAULT-SEX             PIC X.
  3649             20  CF-JOINT-AGE-INPUT         PIC X.
  3650                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3651             20  CF-BIRTH-DATE-INPUT        PIC X.
  3652                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3653             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3654                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3655                 88  CF-ZERO-CARRIER            VALUE '1'.
  3656                 88  CF-ZERO-GROUPING           VALUE '2'.
  3657                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  70
* EL6501.cbl
  3658             20  CF-EDIT-SW                 PIC X.
  3659                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3660             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3661             20  CF-CR-PR-METHOD            PIC X.
  3662               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3663               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3664             20  FILLER                     PIC X.
  3665
  3666         16  CF-CREDIT-MISC-CONTROLS.
  3667             20  CF-REIN-TABLE-SW           PIC X.
  3668                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3669             20  CF-COMP-TABLE-SW           PIC X.
  3670                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3671             20  CF-EXPERIENCE-RETENTION-AGE
  3672                                            PIC S9        COMP-3.
  3673             20  CF-CONVERSION-DT           PIC XX.
  3674             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3675             20  CF-RUN-FREQUENCY-SW        PIC X.
  3676                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3677                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3678
  3679             20  CF-CR-CHECK-NO-CONTROL.
  3680                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3681                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3682                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3683                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3684                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3685                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3686
  3687                 24  CF-CR-CHECK-COUNT       REDEFINES
  3688                     CF-CR-CHECK-COUNTER      PIC X(4).
  3689
  3690                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3691                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3692
  3693                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3694                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3695                 24  CF-MAIL-PROCESSING       PIC X.
  3696                     88  MAIL-PROCESSING          VALUE 'Y'.
  3697
  3698         16  CF-MISC-SYSTEM-CONTROL.
  3699             20  CF-SYSTEM-C                 PIC X.
  3700                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3701             20  CF-SYSTEM-D                 PIC X.
  3702                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3703             20  CF-SOC-SEC-NO-SW            PIC X.
  3704                 88  SOC-SEC-NO-USED             VALUE '1'.
  3705             20  CF-MEMBER-NO-SW             PIC X.
  3706                 88  MEMBER-NO-USED              VALUE '1'.
  3707             20  CF-TAX-ID-NUMBER            PIC X(11).
  3708             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3709             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3710                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3711                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3712                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3713                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3714             20  CF-SYSTEM-E                 PIC X.
  3715                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  71
* EL6501.cbl
  3716
  3717         16  CF-LGX-LIFE-USER               PIC X.
  3718             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3719             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3720
  3721         16  CF-CR-MONTH-END-DT             PIC XX.
  3722
  3723         16  CF-FILE-MAINT-DATES.
  3724             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3725                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3726             20  CF-LAST-BATCH       REDEFINES
  3727                 CF-LAST-BATCH-NO               PIC X(4).
  3728             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3729             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3730             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3731             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3732             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3733             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3734             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3735             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3736             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3737             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3738
  3739         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3740         16  FILLER                         PIC X.
  3741
  3742         16  CF-ALT-MORT-CODE               PIC X(4).
  3743         16  CF-MEMBER-CAPTION              PIC X(10).
  3744
  3745         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3746             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3747             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3748             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3749             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3750             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3751
  3752         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3753
  3754         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3755         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3756         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3757         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3758
  3759         16  CF-AH-OVERRIDE-L1              PIC X.
  3760         16  CF-AH-OVERRIDE-L2              PIC XX.
  3761         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3762         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3763
  3764         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3765         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3766
  3767         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3768         16  CF-AR-LAST-EL860-DT            PIC XX.
  3769         16  CF-MP-MONTH-END-DT             PIC XX.
  3770
  3771         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3772         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3773             88  CF-CLAIM-PAID-TO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  72
* EL6501.cbl
  3774
  3775         16  CF-AR-MONTH-END-DT             PIC XX.
  3776
  3777         16  CF-CRDTCRD-USER                PIC X.
  3778             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3779             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3780
  3781         16  CF-CC-MONTH-END-DT             PIC XX.
  3782
  3783         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3784
  3785         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3786             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3787             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3788             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3789         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3790         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3791         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3792         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3793             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3794             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3795         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3796         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3797         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3798             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3799         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3800
  3801         16  CF-CL-ZIP-CODE.
  3802             20  CF-CL-ZIP-PRIME.
  3803                 24  CF-CL-ZIP-1ST          PIC X.
  3804                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3805                 24  FILLER                 PIC X(4).
  3806             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3807         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3808             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3809             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3810             20  FILLER                     PIC XXX.
  3811
  3812         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3813         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3814         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3815         16  CF-CO-OPTION-START-DATE        PIC XX.
  3816         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3817           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3818                                                      '3' '4'.
  3819           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3820           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3821           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3822           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3823           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3824           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3825
  3826         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3827
  3828         16  CF-PAYMENT-APPROVAL-LEVELS.
  3829             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3830             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3831             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  73
* EL6501.cbl
  3832             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3833             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3834             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3835
  3836         16  CF-END-USER-REPORTING-USER     PIC X.
  3837             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3838             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3839
  3840         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3841             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3842             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3843
  3844         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3845
  3846         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3847         16  FILLER                         PIC X.
  3848
  3849         16  CF-CREDIT-ARCHIVE-CNTL.
  3850             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3851             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3852             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3853
  3854         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3855
  3856         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3857             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3858             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3859
  3860         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3861             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3862             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3863
  3864         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3865
  3866         16  CF-CO-ACH-ID-CODE              PIC  X.
  3867             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3868             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3869             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3870         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3871         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3872         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3873         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3874         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3875         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3876         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3877         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3878         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3879                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3880         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3881                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3882
  3883         16  CF-CO-OVER-SHORT.
  3884             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3885             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3886
  3887*         16  FILLER                         PIC X(102).
  3888         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3889             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  74
* EL6501.cbl
  3890             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3891
  3892         16  CF-AH-APPROVAL-DAYS.
  3893             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3894             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3895             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3896             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3897
  3898         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3899
  3900         16  CF-APPROV-LEV-5.
  3901             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3902             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3903             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3904
  3905         16  FILLER                         PIC X(68).
  3906****************************************************************
  3907*             PROCESSOR/USER RECORD                            *
  3908****************************************************************
  3909
  3910     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3911         16  CF-PROCESSOR-NAME              PIC X(30).
  3912         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3913         16  CF-PROCESSOR-TITLE             PIC X(26).
  3914         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3915                 88  MESSAGE-YES                VALUE 'Y'.
  3916                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3917
  3918*****************************************************
  3919****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3920****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3921****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3922****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3923*****************************************************
  3924
  3925         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3926             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3927             20  CF-APPLICATION-FORCE       PIC X.
  3928             20  CF-INDIVIDUAL-APP.
  3929                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3930                     28  CF-BROWSE-APP      PIC X.
  3931                     28  CF-UPDATE-APP      PIC X.
  3932
  3933         16  CF-CURRENT-TERM-ON             PIC X(4).
  3934         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3935             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3936             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3937             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3938             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3939             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3940             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3941             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3942         16  CF-PROCESSOR-CARRIER           PIC X.
  3943             88  NO-CARRIER-SECURITY            VALUE ' '.
  3944         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3945             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3946         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3947             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  75
* EL6501.cbl
  3948         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3949             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3950
  3951         16  CF-PROC-SYS-ACCESS-SW.
  3952             20  CF-PROC-CREDIT-CLAIMS-SW.
  3953                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3954                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3955                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3956                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3957             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3958                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3959                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3960             20  CF-PROC-LIFE-GNRLDGR-SW.
  3961                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3962                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3963                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3964                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3965             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3966                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3967                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3968         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3969             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3970             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3971         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3972
  3973         16  CF-APPROVAL-LEVEL                  PIC X.
  3974             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3975             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3976             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3977             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3978             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3979
  3980         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3981
  3982         16  CF-LANGUAGE-TYPE                   PIC X.
  3983             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3984             88  CF-LANG-IS-FR                      VALUE 'F'.
  3985
  3986         16  CF-CSR-IND                         PIC X.
  3987         16  FILLER                             PIC X(239).
  3988
  3989****************************************************************
  3990*             PROCESSOR/REMINDERS RECORD                       *
  3991****************************************************************
  3992
  3993     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3994         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3995             20  CF-START-REMIND-DT         PIC XX.
  3996             20  CF-END-REMIND-DT           PIC XX.
  3997             20  CF-REMINDER-TEXT           PIC X(50).
  3998         16  FILLER                         PIC X(296).
  3999
  4000
  4001****************************************************************
  4002*             STATE MASTER RECORD                              *
  4003****************************************************************
  4004
  4005     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  76
* EL6501.cbl
  4006         16  CF-STATE-ABBREVIATION          PIC XX.
  4007         16  CF-STATE-NAME                  PIC X(25).
  4008         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4009         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4010             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4011             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4012             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4013             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4014                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4015                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4016             20  CF-ST-PREM-REJECT-SW       PIC X.
  4017                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4018                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4019             20  CF-ST-REF-REJECT-SW        PIC X.
  4020                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4021                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4022         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4023         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4024         16  CF-ST-REFUND-RULES.
  4025             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4026             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4027             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4028         16  CF-ST-FST-PMT-EXTENSION.
  4029             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4030             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4031                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4032                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4033                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4034                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4035         16  CF-ST-STATE-CALL.
  4036             20  CF-ST-CALL-UNEARNED        PIC X.
  4037             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4038             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4039         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4040             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4041             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4042         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4043         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4044         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4045         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4046         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4047         16  FILLER                         PIC X.
  4048         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4049             20  CF-ST-BENEFIT-CD           PIC XX.
  4050             20  CF-ST-BENEFIT-KIND         PIC X.
  4051                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4052                 88  CF-ST-AH-KIND              VALUE 'A'.
  4053             20  CF-ST-REM-TERM-CALC        PIC X.
  4054                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4055                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4056                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4057                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4058                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4059                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4060                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4061                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4062
  4063             20  CF-ST-REFUND-CALC          PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  77
* EL6501.cbl
  4064                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4065                 88  ST-REFD-BY-R78             VALUE '1'.
  4066                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4067                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4068                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4069                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4070                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4071                 88  ST-REFD-UTAH               VALUE '7'.
  4072                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4073                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4074                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4075
  4076             20  CF-ST-EARNING-CALC         PIC X.
  4077                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4078                 88  ST-EARN-BY-R78             VALUE '1'.
  4079                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4080                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4081                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4082                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4083                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4084                 88  ST-EARN-MEAN               VALUE '8'.
  4085                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4086
  4087             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4088                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4089                 88  ST-OVRD-BY-R78             VALUE '1'.
  4090                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4091                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4092                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4093                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4094                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4095                 88  ST-OVRD-MEAN               VALUE '8'.
  4096                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4097             20  cf-st-extra-periods        pic 9.
  4098*            20  FILLER                     PIC X.
  4099
  4100         16  CF-ST-COMMISSION-CAPS.
  4101             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4102             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4103             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4104             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4105         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4106                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4107
  4108         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4109
  4110         16  CF-ST-STATUTORY-INTEREST.
  4111             20  CF-ST-STAT-DATE-FROM       PIC X.
  4112                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4113                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4114             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4115             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4116             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4117             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4118             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4119
  4120         16  CF-ST-OVER-SHORT.
  4121             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  78
* EL6501.cbl
  4122             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4123
  4124         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4125
  4126         16  CF-ST-RT-CALC                  PIC X.
  4127
  4128         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4129         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4130         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4131         16  CF-ST-RF-LR-CALC               PIC X.
  4132         16  CF-ST-RF-LL-CALC               PIC X.
  4133         16  CF-ST-RF-LN-CALC               PIC X.
  4134         16  CF-ST-RF-AH-CALC               PIC X.
  4135         16  CF-ST-RF-CP-CALC               PIC X.
  4136*        16  FILLER                         PIC X(206).
  4137*CIDMOD         16  FILLER                         PIC X(192).
  4138         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4139             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4140         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4141         16  CF-ST-VFY-2ND-BENE             PIC X.
  4142         16  CF-ST-CAUSAL-STATE             PIC X.
  4143         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4144         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4145         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4146             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4147         16  CF-ST-NET-ONLY-STATE           PIC X.
  4148             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4149         16  FILLER                         PIC X(181).
  4150
  4151****************************************************************
  4152*             BENEFIT MASTER RECORD                            *
  4153****************************************************************
  4154
  4155     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4156         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4157             20  CF-BENEFIT-CODE            PIC XX.
  4158             20  CF-BENEFIT-NUMERIC  REDEFINES
  4159                 CF-BENEFIT-CODE            PIC XX.
  4160             20  CF-BENEFIT-ALPHA           PIC XXX.
  4161             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4162             20  CF-BENEFIT-COMMENT         PIC X(10).
  4163
  4164             20  CF-LF-COVERAGE-TYPE        PIC X.
  4165                 88  CF-REDUCING                VALUE 'R'.
  4166                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4167
  4168             20  CF-SPECIAL-CALC-CD         PIC X.
  4169                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4170                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4171                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4172                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4173                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4174                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4175                 88  CF-FARM-PLAN               VALUE 'F'.
  4176                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4177                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4178                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4179                 88  CF-4-MTH-INTEREST          VALUE 'K'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  79
* EL6501.cbl
  4180                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4181                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4182                 88  CF-PRUDENTIAL              VALUE 'P'.
  4183                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4184                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4185                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4186                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4187                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4188                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4189
  4190             20  CF-JOINT-INDICATOR         PIC X.
  4191                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4192
  4193*            20  FILLER                     PIC X(12).
  4194             20  cf-maximum-benefits        pic s999 comp-3.
  4195             20  FILLER                     PIC X(09).
  4196             20  CF-BENEFIT-CATEGORY        PIC X.
  4197             20  CF-LOAN-TYPE               PIC X(8).
  4198
  4199             20  CF-CO-REM-TERM-CALC        PIC X.
  4200                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4201                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4202                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4203                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4204                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4205
  4206             20  CF-CO-EARNINGS-CALC        PIC X.
  4207                 88  CO-EARN-BY-R78             VALUE '1'.
  4208                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4209                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4210                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4211                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4212                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4213                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4214                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4215
  4216             20  CF-CO-REFUND-CALC          PIC X.
  4217                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4218                 88  CO-REFD-BY-R78             VALUE '1'.
  4219                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4220                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4221                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4222                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4223                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4224                 88  CO-REFD-MEAN               VALUE '8'.
  4225                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4226                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4227                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4228
  4229             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4230                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4231                 88  CO-OVRD-BY-R78             VALUE '1'.
  4232                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4233                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4234                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4235                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4236                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4237                 88  CO-OVRD-MEAN               VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  80
* EL6501.cbl
  4238                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4239
  4240             20  CF-CO-BEN-I-G-CD           PIC X.
  4241                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4242                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4243                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4244
  4245         16  FILLER                         PIC X(304).
  4246
  4247
  4248****************************************************************
  4249*             CARRIER MASTER RECORD                            *
  4250****************************************************************
  4251
  4252     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4253         16  CF-ADDRESS-DATA.
  4254             20  CF-MAIL-TO-NAME            PIC X(30).
  4255             20  CF-IN-CARE-OF              PIC X(30).
  4256             20  CF-ADDRESS-LINE-1          PIC X(30).
  4257             20  CF-ADDRESS-LINE-2          PIC X(30).
  4258             20  CF-CITY-STATE              PIC X(30).
  4259             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4260             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4261
  4262         16  CF-CLAIM-NO-CONTROL.
  4263             20  CF-CLAIM-NO-METHOD         PIC X.
  4264                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4265                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4266                 88  CLAIM-NO-SEQ               VALUE '3'.
  4267                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4268             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4269                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4270                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4271                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4272
  4273         16  CF-CHECK-NO-CONTROL.
  4274             20  CF-CHECK-NO-METHOD         PIC X.
  4275                 88  CHECK-NO-MANUAL            VALUE '1'.
  4276                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4277                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4278                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4279             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4280                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4281
  4282         16  CF-DOMICILE-STATE              PIC XX.
  4283
  4284         16  CF-EXPENSE-CONTROLS.
  4285             20  CF-EXPENSE-METHOD          PIC X.
  4286                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4287                 88  DOLLARS-PER-PMT            VALUE '2'.
  4288                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4289                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4290             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4291             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4292
  4293         16  CF-CORRESPONDENCE-CONTROL.
  4294             20  CF-LETTER-RESEND-OPT       PIC X.
  4295                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  81
* EL6501.cbl
  4296                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4297             20  FILLER                     PIC X(4).
  4298
  4299         16  CF-RESERVE-CONTROLS.
  4300             20  CF-MANUAL-SW               PIC X.
  4301                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4302             20  CF-FUTURE-SW               PIC X.
  4303                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4304             20  CF-PTC-SW                  PIC X.
  4305                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4306             20  CF-IBNR-SW                 PIC X.
  4307                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4308             20  CF-PTC-LF-SW               PIC X.
  4309                 88  CF-LF-PTC-USED             VALUE '1'.
  4310             20  CF-CDT-ACCESS-METHOD       PIC X.
  4311                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4312                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4313                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4314             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4315
  4316         16  CF-CLAIM-CALC-METHOD           PIC X.
  4317             88  360-PLUS-MONTHS                VALUE '1'.
  4318             88  365-PLUS-MONTHS                VALUE '2'.
  4319             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4320             88  360-DAILY                      VALUE '4'.
  4321             88  365-DAILY                      VALUE '5'.
  4322
  4323         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4324         16  FILLER                         PIC X(11).
  4325
  4326         16  CF-LIMIT-AMOUNTS.
  4327             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4328             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4329             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4330             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4331             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4332             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4333             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4334             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4335             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4336             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4337
  4338         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4339         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4340         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4341
  4342         16  CF-ZIP-CODE.
  4343             20  CF-ZIP-PRIME.
  4344                 24  CF-ZIP-1ST             PIC X.
  4345                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4346                 24  FILLER                 PIC X(4).
  4347             20  CF-ZIP-PLUS4               PIC X(4).
  4348         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4349             20  CF-CAN-POSTAL-1            PIC XXX.
  4350             20  CF-CAN-POSTAL-2            PIC XXX.
  4351             20  FILLER                     PIC XXX.
  4352
  4353         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  82
* EL6501.cbl
  4354         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4355         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4356
  4357         16  CF-RATING-SWITCH               PIC X.
  4358             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4359             88  CF-NO-RATING                   VALUE 'N'.
  4360
  4361         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4362
  4363         16  CF-CARRIER-OVER-SHORT.
  4364             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4365             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4366
  4367         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4368         16  CF-SECPAY-SWITCH               PIC X.
  4369             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4370             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4371         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4372         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4373         16  FILLER                         PIC X(444).
  4374*        16  FILLER                         PIC X(452).
  4375
  4376
  4377****************************************************************
  4378*             MORTALITY MASTER RECORD                          *
  4379****************************************************************
  4380
  4381     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4382         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4383                                INDEXED BY CF-MORT-NDX.
  4384             20  CF-MORT-TABLE              PIC X(5).
  4385             20  CF-MORT-TABLE-TYPE         PIC X.
  4386                 88  CF-MORT-JOINT              VALUE 'J'.
  4387                 88  CF-MORT-SINGLE             VALUE 'S'.
  4388                 88  CF-MORT-COMBINED           VALUE 'C'.
  4389                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4390                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4391             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4392             20  CF-MORT-AGE-METHOD         PIC XX.
  4393                 88  CF-AGE-LAST                VALUE 'AL'.
  4394                 88  CF-AGE-NEAR                VALUE 'AN'.
  4395             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4396             20  CF-MORT-ADJUSTMENT-DIRECTION
  4397                                            PIC X.
  4398                 88  CF-MINUS                   VALUE '-'.
  4399                 88  CF-PLUS                    VALUE '+'.
  4400             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4401             20  CF-MORT-JOINT-CODE         PIC X.
  4402                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4403             20  CF-MORT-PC-Q               PIC X.
  4404                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4405             20  CF-MORT-TABLE-CODE         PIC X(4).
  4406             20  CF-MORT-COMMENTS           PIC X(15).
  4407             20  FILLER                     PIC X(14).
  4408
  4409         16  FILLER                         PIC X(251).
  4410
  4411
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  83
* EL6501.cbl
  4412****************************************************************
  4413*             BUSSINESS TYPE MASTER RECORD                     *
  4414****************************************************************
  4415
  4416     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4417* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4418* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4419* AND RECORD 05 IS TYPES 81-99
  4420         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4421             20  CF-BUSINESS-TITLE          PIC  X(19).
  4422             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4423                                            PIC S9V9(4) COMP-3.
  4424             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4425             20  FILLER                     PIC  X.
  4426         16  FILLER                         PIC  X(248).
  4427
  4428
  4429****************************************************************
  4430*             TERMINAL MASTER RECORD                           *
  4431****************************************************************
  4432
  4433     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4434
  4435         16  CF-COMPANY-TERMINALS.
  4436             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4437                                  PIC X(4).
  4438         16  FILLER               PIC X(248).
  4439
  4440
  4441****************************************************************
  4442*             LIFE EDIT MASTER RECORD                          *
  4443****************************************************************
  4444
  4445     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4446         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4447             20  CF-LIFE-CODE-IN            PIC XX.
  4448             20  CF-LIFE-CODE-OUT           PIC XX.
  4449         16  FILLER                         PIC X(248).
  4450
  4451
  4452****************************************************************
  4453*             AH EDIT MASTER RECORD                            *
  4454****************************************************************
  4455
  4456     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4457         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4458             20  CF-AH-CODE-IN              PIC XXX.
  4459             20  CF-AH-CODE-OUT             PIC XX.
  4460         16  FILLER                         PIC X(248).
  4461
  4462
  4463****************************************************************
  4464*             CREDIBILITY TABLES                               *
  4465****************************************************************
  4466
  4467     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4468         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4469                             INDEXED BY CF-CRDB-NDX.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  84
* EL6501.cbl
  4470             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4471             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4472             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4473         16  FILLER                         PIC  X(332).
  4474
  4475
  4476****************************************************************
  4477*             REPORT CUSTOMIZATION RECORD                      *
  4478****************************************************************
  4479
  4480     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4481         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4482             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4483             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4484             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4485**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4486****       A T-TRANSFER.                                   ****
  4487             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4488
  4489         16  FILLER                         PIC XX.
  4490
  4491         16  CF-CARRIER-CNTL-OPT.
  4492             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4493                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4494                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4495             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4496                                            PIC X.
  4497         16  CF-GROUP-CNTL-OPT.
  4498             20  CF-GROUP-OPT-SEQ           PIC 9.
  4499                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4500                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4501             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4502                                            PIC X(6).
  4503         16  CF-STATE-CNTL-OPT.
  4504             20  CF-STATE-OPT-SEQ           PIC 9.
  4505                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4506                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4507             20  CF-STATE-SELECT OCCURS 3 TIMES
  4508                                            PIC XX.
  4509         16  CF-ACCOUNT-CNTL-OPT.
  4510             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4511                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4512                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4513             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4514                                            PIC X(10).
  4515         16  CF-BUS-TYP-CNTL-OPT.
  4516             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4517                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4518                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4519             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4520                                            PIC XX.
  4521         16  CF-LF-TYP-CNTL-OPT.
  4522             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4523                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4524                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4525             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4526                                            PIC XX.
  4527         16  CF-AH-TYP-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  85
* EL6501.cbl
  4528             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4529                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4530                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4531             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4532                                            PIC XX.
  4533         16  CF-REPTCD1-CNTL-OPT.
  4534             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4535                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4536                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4537             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4538                                            PIC X(10).
  4539         16  CF-REPTCD2-CNTL-OPT.
  4540             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4541                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4542                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4543             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4544                                            PIC X(10).
  4545         16  CF-USER1-CNTL-OPT.
  4546             20  CF-USER1-OPT-SEQ           PIC 9.
  4547                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4548                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4549             20  CF-USER1-SELECT OCCURS 3 TIMES
  4550                                            PIC X(10).
  4551         16  CF-USER2-CNTL-OPT.
  4552             20  CF-USER2-OPT-SEQ           PIC 9.
  4553                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4554                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4555             20  CF-USER2-SELECT OCCURS 3 TIMES
  4556                                            PIC X(10).
  4557         16  CF-USER3-CNTL-OPT.
  4558             20  CF-USER3-OPT-SEQ           PIC 9.
  4559                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4560                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4561             20  CF-USER3-SELECT OCCURS 3 TIMES
  4562                                            PIC X(10).
  4563         16  CF-USER4-CNTL-OPT.
  4564             20  CF-USER4-OPT-SEQ           PIC 9.
  4565                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4566                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4567             20  CF-USER4-SELECT OCCURS 3 TIMES
  4568                                            PIC X(10).
  4569         16  CF-USER5-CNTL-OPT.
  4570             20  CF-USER5-OPT-SEQ           PIC 9.
  4571                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4572                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4573             20  CF-USER5-SELECT OCCURS 3 TIMES
  4574                                            PIC X(10).
  4575         16  CF-REINS-CNTL-OPT.
  4576             20  CF-REINS-OPT-SEQ           PIC 9.
  4577                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4578                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4579             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4580                 24  CF-REINS-PRIME         PIC XXX.
  4581                 24  CF-REINS-SUB           PIC XXX.
  4582
  4583         16  CF-AGENT-CNTL-OPT.
  4584             20  CF-AGENT-OPT-SEQ           PIC 9.
  4585                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  86
* EL6501.cbl
  4586                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4587             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4588                                            PIC X(10).
  4589
  4590         16  FILLER                         PIC X(43).
  4591
  4592         16  CF-LOSS-RATIO-SELECT.
  4593             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4594             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4595         16  CF-ENTRY-DATE-SELECT.
  4596             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4597             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4598         16  CF-EFFECTIVE-DATE-SELECT.
  4599             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4600             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4601
  4602         16  CF-EXCEPTION-LIST-IND          PIC X.
  4603             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4604
  4605         16  FILLER                         PIC X(318).
  4606
  4607****************************************************************
  4608*                  EXCEPTION REPORTING RECORD                  *
  4609****************************************************************
  4610
  4611     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4612         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4613             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4614
  4615         16  CF-COMBINED-LIFE-AH-OPT.
  4616             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4617             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4618             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4619             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4620
  4621         16  CF-LIFE-OPT.
  4622             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4623             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4624             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4625             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4626             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4627             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4628             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4629             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4630             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4631             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4632
  4633         16  CF-AH-OPT.
  4634             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4635             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4636             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4637             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4638             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4639             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4640             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4641             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4642             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4643             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  87
* EL6501.cbl
  4644
  4645         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4646             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4647             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4648             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4649
  4650         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4651
  4652         16  FILLER                         PIC X(673).
  4653
  4654
  4655****************************************************************
  4656*             MORTGAGE SYSTEM PLAN RECORD                      *
  4657****************************************************************
  4658
  4659     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4660         16  CF-PLAN-TYPE                   PIC X.
  4661             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4662             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4663             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4664         16  CF-PLAN-ABBREV                 PIC XXX.
  4665         16  CF-PLAN-DESCRIPT               PIC X(10).
  4666         16  CF-PLAN-NOTES                  PIC X(20).
  4667         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4668         16  CF-PLAN-UNDERWRITING.
  4669             20  CF-PLAN-TERM-DATA.
  4670                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4671                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4672             20  CF-PLAN-AGE-DATA.
  4673                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4674                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4675                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4676             20  CF-PLAN-BENEFIT-DATA.
  4677                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4678                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4679                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4680                                            PIC S9(7)V99  COMP-3.
  4681         16  CF-PLAN-POLICY-FORMS.
  4682             20  CF-POLICY-FORM             PIC X(12).
  4683             20  CF-MASTER-APPLICATION      PIC X(12).
  4684             20  CF-MASTER-POLICY           PIC X(12).
  4685         16  CF-PLAN-RATING.
  4686             20  CF-RATE-CODE               PIC X(5).
  4687             20  CF-SEX-RATING              PIC X.
  4688                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4689                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4690             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4691             20  CF-SUB-STD-TYPE            PIC X.
  4692                 88  CF-PCT-OF-PREM            VALUE '1'.
  4693                 88  CF-PCT-OF-BENE            VALUE '2'.
  4694         16  CF-PLAN-PREM-TOLERANCES.
  4695             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4696             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4697         16  CF-PLAN-PYMT-TOLERANCES.
  4698             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4699             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4700         16  CF-PLAN-MISC-DATA.
  4701             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  88
* EL6501.cbl
  4702             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4703             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4704         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4705         16  CF-PLAN-IND-GRP                PIC X.
  4706             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4707                                                     '1'.
  4708             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4709                                                     '2'.
  4710         16  CF-MIB-SEARCH-SW               PIC X.
  4711             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4712             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4713             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4714             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4715         16  CF-ALPHA-SEARCH-SW             PIC X.
  4716             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4717             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4718             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4719             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4720             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4721             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4722             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4723             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4724             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4725             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4726                                                     'A' 'B' 'C'
  4727                                                     'X' 'Y' 'Z'.
  4728         16  CF-EFF-DT-RULE-SW              PIC X.
  4729             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4730             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4731             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4732             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4733             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4734         16  FILLER                         PIC X(4).
  4735         16  CF-HEALTH-QUESTIONS            PIC X.
  4736             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4737         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4738         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4739         16  CF-PLAN-SNGL-JNT               PIC X.
  4740             88  CF-COMBINED-PLAN              VALUE 'C'.
  4741             88  CF-JNT-PLAN                   VALUE 'J'.
  4742             88  CF-SNGL-PLAN                  VALUE 'S'.
  4743         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4744         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4745         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4746         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4747         16  CF-RERATE-CNTL                 PIC  X.
  4748             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4749             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4750             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4751             88  CF-AUTO-RECALC                 VALUE '4'.
  4752         16  CF-BENEFIT-TYPE                PIC  X.
  4753             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4754             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4755         16  CF-POLICY-FEE                  PIC S999V99
  4756                                                    COMP-3.
  4757         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4758         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4759         16  CF-3RD-NOTICE-FORM             PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  89
* EL6501.cbl
  4760         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4761         16  FILLER                         PIC  X(32).
  4762         16  CF-TERMINATION-FORM            PIC  X(04).
  4763         16  FILLER                         PIC  X(08).
  4764         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4765                                                       COMP-3.
  4766         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4767         16  CF-ISSUE-LETTER                PIC  X(4).
  4768         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4769         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4770             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4771             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4772         16  CF-MP-REFUND-CALC              PIC X.
  4773             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4774             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4775             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4776             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4777             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4778             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4779             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4780             88  CF-MP-REFD-MEAN                VALUE '8'.
  4781         16  CF-ALT-RATE-CODE               PIC  X(5).
  4782
  4783
  4784         16  FILLER                         PIC X(498).
  4785****************************************************************
  4786*             MORTGAGE COMPANY MASTER RECORD                   *
  4787****************************************************************
  4788
  4789     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4790         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4791         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4792             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4793             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4794             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4795             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4796             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4797
  4798         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4799         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4800         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4801         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4802         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4803
  4804         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4805             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4806         16  CF-MP-RECON-USE-IND            PIC X(1).
  4807             88  CF-MP-USE-RECON             VALUE 'Y'.
  4808         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4809             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4810         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4811             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4812             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4813         16  FILLER                         PIC X(1).
  4814         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4815             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4816         16  CF-MORTG-MIB-VERSION           PIC X.
  4817             88  CF-MORTG-MIB-BATCH         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  90
* EL6501.cbl
  4818             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4819             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4820         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4821             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4822                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4823             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4824                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4825             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4826                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4827             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4828                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4829             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4830                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4831             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4832                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4833         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4834         16  FILLER                         PIC X(7).
  4835         16  CF-MORTG-DESTINATION-SYMBOL.
  4836             20  CF-MORTG-MIB-COMM          PIC X(5).
  4837             20  CF-MORTG-MIB-TERM          PIC X(5).
  4838         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4839             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4840         16  FILLER                         PIC X(03).
  4841         16  CF-MP-CHECK-NO-CONTROL.
  4842             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4843                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4844                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4845                                                ' ' LOW-VALUES.
  4846                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4847                                               VALUE '3'.
  4848         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4849         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4850         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4851             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4852                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4853             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4854                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4855             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4856                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4857             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4858                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4859             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4860                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4861             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4862                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4863         16  CF-MORTG-BILLING-AREA.
  4864             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4865                                            PIC X.
  4866         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4867         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4868         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4869         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4870             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4871             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4872         16  FILLER                         PIC X.
  4873         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4874             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4875             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  91
* EL6501.cbl
  4876         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4877         16  FILLER                         PIC X(8).
  4878         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4879         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4880         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4881         16  CF-ACH-COMPANY-ID.
  4882             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4883                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4884                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4885                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4886             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4887         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4888             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4889         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4890             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4891             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4892         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4893         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4894         16  FILLER                         PIC X(536).
  4895
  4896****************************************************************
  4897*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4898****************************************************************
  4899
  4900     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4901         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4902             20  CF-FEMALE-HEIGHT.
  4903                 24  CF-FEMALE-FT           PIC 99.
  4904                 24  CF-FEMALE-IN           PIC 99.
  4905             20  CF-FEMALE-MIN-WT           PIC 999.
  4906             20  CF-FEMALE-MAX-WT           PIC 999.
  4907         16  FILLER                         PIC X(428).
  4908
  4909     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4910         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4911             20  CF-MALE-HEIGHT.
  4912                 24  CF-MALE-FT             PIC 99.
  4913                 24  CF-MALE-IN             PIC 99.
  4914             20  CF-MALE-MIN-WT             PIC 999.
  4915             20  CF-MALE-MAX-WT             PIC 999.
  4916         16  FILLER                         PIC X(428).
  4917******************************************************************
  4918*             AUTOMATIC ACTIVITY RECORD                          *
  4919******************************************************************
  4920     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4921         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4922             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4923             20  CF-SYS-LETTER-ID           PIC X(04).
  4924             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4925             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4926             20  CF-SYS-RESET-SW            PIC X(01).
  4927             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4928             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4929
  4930         16  FILLER                         PIC X(50).
  4931
  4932         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4933             20  CF-USER-ACTIVE-SW          PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  92
* EL6501.cbl
  4934             20  CF-USER-LETTER-ID          PIC X(04).
  4935             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4936             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4937             20  CF-USER-RESET-SW           PIC X(01).
  4938             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4939             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4940             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4941
  4942         16  FILLER                         PIC X(246).
  4943*    COPY ERCREIN.
  4944******************************************************************
  4945*                                                                *
  4946*                            ERCREIN                             *
  4947*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4948*                            VMOD=2.010                          *
  4949*                                                                *
  4950*   ONLINE CREDIT SYSTEM                                         *
  4951*                                                                *
  4952*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  4953*                                                                *
  4954*   FILE TYPE = VSAM,KSDS                                        *
  4955*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  4956*                                                                *
  4957*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  4958*       ALTERNATE PATH = NONE                                    *
  4959*                                                                *
  4960*   LOG = NO                                                     *
  4961*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4962*                                                                *
  4963******************************************************************
  4964*                   C H A N G E   L O G
  4965*
  4966* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4967*-----------------------------------------------------------------
  4968*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4969* EFFECTIVE    NUMBER
  4970*-----------------------------------------------------------------
  4971* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  4972* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  4973******************************************************************
  4974 01  REINSURANCE-RECORD.
  4975     12  RE-RECORD-ID                      PIC XX.
  4976         88  VALID-RE-ID                      VALUE 'RE'.
  4977
  4978     12  RE-CONTROL-PRIMARY.
  4979         16  RE-COMPANY-CD                 PIC X.
  4980         16  RE-KEY.
  4981             20  RE-CODE                   PIC X.
  4982                 88  RE-TABLE-RECORD          VALUE 'A'.
  4983                 88  RE-COMPANY-RECORD        VALUE 'B'.
  4984             20  RE-TABLE                  PIC XXX.
  4985             20  FILLER                    PIC XXX.
  4986         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  4987             20  FILLER                    PIC X.
  4988             20  RE-COMPANY.
  4989                 24  RE-COMP-PRIME         PIC XXX.
  4990                 24  RE-COMP-SUB           PIC XXX.
  4991
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  93
* EL6501.cbl
  4992     12  RE-MAINT-INFORMATION.
  4993         16  RE-LAST-MAINT-DT              PIC XX.
  4994         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4995         16  RE-LAST-MAINT-USER            PIC X(4).
  4996         16  FILLER                        PIC X(10).
  4997
  4998     12  RE-TABLE-DATA.
  4999         16  RE-100-COMP                   PIC 99.
  5000
  5001         16  RE-COMP-INFO    OCCURS 30 TIMES.
  5002             20  RE-REI-COMP-NO.
  5003                 24  RE-REI-COMP           PIC XXX.
  5004                 24  RE-REI-COMP-SUB       PIC XXX.
  5005             20  RE-LF-QC                  PIC X.
  5006             20  RE-AH-QC                  PIC X.
  5007             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  5008             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  5009             20  RE-LFAGE-LO               PIC 99.
  5010             20  RE-LFAGE-HI               PIC 99.
  5011             20  RE-AHAGE-LO               PIC 99.
  5012             20  RE-AHAGE-HI               PIC 99.
  5013             20  RE-LFTRM-LO               PIC S999       COMP-3.
  5014             20  RE-LFTRM-HI               PIC S999       COMP-3.
  5015             20  RE-AHTRM-LO               PIC S999       COMP-3.
  5016             20  RE-AHTRM-HI               PIC S999       COMP-3.
  5017             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  5018             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  5019             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  5020             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  5021             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  5022             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  5023             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  5024             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  5025             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  5026             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  5027             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  5028             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  5029             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  5030             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  5031             20  RE-LF-BEN-CODE            PIC X.
  5032             20  RE-AH-BEN-CODE            PIC X.
  5033             20  RE-INTERACTIVE            PIC X.
  5034             20  RE-REMAINING              PIC X.
  5035             20  RE-LF-RUNOFF-SW           PIC X.
  5036             20  RE-AH-RUNOFF-SW           PIC X.
  5037             20  FILLER                    PIC X(19).
  5038
  5039         16  RE-COMP-INFO-END              PIC X(6).
  5040         16  RE-NSP-ST-CD-LF               PIC XX.
  5041         16  RE-NSP-ST-CD-AH               PIC XX.
  5042         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  5043             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  5044
  5045         16  FILLER                        PIC X(27).
  5046
  5047     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  5048         16  RE-NAME                       PIC X(30).
  5049         16  RE-LF-PE                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  94
* EL6501.cbl
  5050         16  RE-AH-PE                      PIC X.
  5051         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  5052         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  5053         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  5054         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  5055         16  RE-PRT-ST                     PIC X.
  5056         16  RE-PRT-OW                     PIC X.
  5057         16  RE-MORT-CODE                  PIC X(4).
  5058         16  RE-CLAIM-CODE                 PIC X.
  5059         16  RE-ZERO-LF-FEE                PIC X.
  5060         16  RE-ZERO-AH-FEE                PIC X.
  5061         16  RE-CEDE-NAME                  PIC X(30).
  5062         16  RE-LF-COMM                    PIC X.
  5063         16  RE-AH-COMM                    PIC X.
  5064         16  RE-LF-TAX                     PIC X.
  5065         16  RE-AH-TAX                     PIC X.
  5066         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  5067         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  5068         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  5069
  5070         16  RE-COMP-CARRIER-SECURITY      PIC X.
  5071             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  5072
  5073         16  RE-LF-CEDING-FEE-BRACKETS.
  5074             20  RE-LF-FEE-METHOD          PIC X.
  5075                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  5076                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  5077                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  5078                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  5079             20  RE-LF-FEE-BASIS           PIC X.
  5080                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  5081                 88  RE-LF-NET-CEDED               VALUE '2'.
  5082                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  5083                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  5084                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  5085                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  5086                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  5087                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  5088             20  FILLER                    PIC XXX.
  5089             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  5090                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  5091                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  5092
  5093         16  RE-AH-CEDING-FEE-BRACKETS.
  5094             20  RE-AH-FEE-METHOD          PIC X.
  5095                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  5096                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  5097                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  5098                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  5099             20  RE-AH-FEE-BASIS           PIC X.
  5100                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  5101                 88  RE-AH-NET-CEDED               VALUE '2'.
  5102                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  5103                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  5104                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  5105                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  5106                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  5107                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  95
* EL6501.cbl
  5108             20  FILLER                    PIC XXX.
  5109             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  5110                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  5111                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  5112
  5113         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  5114
  5115         16  RE-OLD-CEDING-STMT            PIC X.
  5116
  5117         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  5118         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  5119         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  5120         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  5121         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  5122         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  5123         16  RE-REINS-GROUPING-CODE        PIC X(6).
  5124         16  RE-MORT-SW                    PIC X.
  5125         16  RE-CEDING-TYPE-FLAG           PIC X.
  5126             88  RE-NO-CESSION-TYPE                VALUE ' '.
  5127             88  RE-CEDED                          VALUE 'C'.
  5128             88  RE-ASSUMED                        VALUE 'A'.
  5129             88  RE-PHANTOM                        VALUE 'P'.
  5130
  5131         16  RE-CEDING-STMT-OPT-A          PIC X.
  5132             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  5133         16  RE-CEDING-STMT-OPT-B          PIC X.
  5134             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  5135         16  RE-CEDING-STMT-OPT-C          PIC X.
  5136             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  5137         16  RE-CEDING-STMT-OPT-D          PIC X.
  5138             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  5139         16  RE-CEDING-STMT-OPT-E          PIC X.
  5140             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  5141
  5142         16  RE-PRT-CRSV                   PIC X.
  5143
  5144         16  RE-GL-CENTER                  PIC X(4).
  5145
  5146         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  5147
  5148         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  5149
  5150         16  RE-EARN-STOP-CODE             PIC X.
  5151             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  5152             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  5153
  5154         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  5155             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  5156
  5157         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  5158         16  FILLER                        PIC X(2281).
  5159
  5160         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  5161
  5162******************************************************************
  5163*    COPY ERCCTBL.
  5164******************************************************************
  5165*                                                                *
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  96
* EL6501.cbl
  5166*                                                                *
  5167*                            ERCCTBL                             *
  5168*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5169*                            VMOD=2.003
  5170*                                                                *
  5171*   ONLINE CREDIT SYSTEM                                         *
  5172*                                                                *
  5173*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  5174*                                                                *
  5175*   FILE TYPE = VSAM,KSDS                                        *
  5176*   RECORD SIZE = 200   RECFORM = FIXED                          *
  5177*                                                                *
  5178*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  5179*       ALTERNATE PATH = NONE                                    *
  5180*                                                                *
  5181*   LOG = NO                                                     *
  5182*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5183*                                                                *
  5184*                                                                *
  5185******************************************************************
  5186
  5187 01  COMM-TABLE-RECORD.
  5188     12  CT-RECORD-ID                      PIC XX.
  5189         88  VALID-CT-ID                      VALUE 'CT'.
  5190
  5191     12  CT-CONTROL-PRIMARY.
  5192         16  CT-COMPANY-CD                 PIC X.
  5193         16  CT-TABLE                      PIC XXX.
  5194         16  CT-CNTRL-2.
  5195             20  CT-BEN-TYPE               PIC X.
  5196             20  CT-BEN-CODE               PIC XX.
  5197
  5198     12  CT-MAINT-INFORMATION.
  5199         16  CT-LAST-MAINT-DT              PIC XX.
  5200         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5201         16  CT-LAST-MAINT-USER            PIC X(4).
  5202         16  FILLER                        PIC X(31).
  5203
  5204     12  CT-LIMITS.
  5205         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  5206
  5207         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  5208
  5209         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  5210
  5211     12  CT-RATES.
  5212         16  CT-RTX          OCCURS 27 TIMES.
  5213             20  CT-RT                     PIC SV9(5)     COMP-3.
  5214             20  CT-RT-R   REDEFINES
  5215                 CT-RT                     PIC XXX.
  5216
  5217     12  FILLER                            PIC  X(42).
  5218
  5219******************************************************************
  5220*                                COPY ERCACNT.
  5221******************************************************************
  5222*                                                                *
  5223*                                                                *
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  97
* EL6501.cbl
  5224*                            ERCACNT.                            *
  5225*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5226*                            VMOD=2.002                          *
  5227*                                                                *
  5228*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  5229*                                                                *
  5230*   FILE TYPE = VSAM,KSDS                                        *
  5231*   RECORD SIZE = 120   RECFORM = FIXED                          *
  5232*                                                                *
  5233*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  5234*       ALTERNATE INDEX = NONE                                   *
  5235*                                                                *
  5236*                                                                *
  5237*   LOG = YES                                                    *
  5238*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5239******************************************************************
  5240*                   C H A N G E   L O G
  5241*
  5242* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5243*-----------------------------------------------------------------
  5244*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5245* EFFECTIVE    NUMBER
  5246*-----------------------------------------------------------------
  5247* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  5248*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  5249******************************************************************
  5250 01  NOTE-FILE.
  5251     12  NT-FILE-ID                  PIC XX.
  5252         88  VALID-NOTE-ID              VALUE 'NT'.
  5253
  5254     12  NT-CONTROL-PRIMARY.
  5255         16  NT-COMPANY-CD           PIC X.
  5256         16  NT-ACCT-NOTE-KEY.
  5257             18  NT-CARRIER              PIC X.
  5258             18  NT-GROUPING             PIC X(06).
  5259             18  NT-STATE                PIC XX.
  5260             18  NT-ACCOUNT              PIC X(10).
  5261         16  NT-RECORD-TYPE          PIC X.
  5262              88  ACCT-NOTE          VALUE '1'.
  5263              88  ACCT-BRANCH-LOC    VALUE '2'.
  5264              88  ACCT-SHIPPING-ADDR VALUE '3'.
  5265         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  5266
  5267     12  NT-LAST-MAINT-DT            PIC XX.
  5268     12  NT-LAST-MAINT-BY            PIC X(4).
  5269     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  5270
  5271*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  5272*     SEQUENCE NUMBERS
  5273     12  NT-NOTE-INFORMATION.
  5274         16  NT-NOTE-LINE            PIC X(60).
  5275         16  FILLER                  PIC X(25).
  5276*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  5277     12  NT-LOCATION-INFORMATION REDEFINES
  5278                         NT-NOTE-INFORMATION.
  5279         16  NT-BRANCH-LOC-LINE      PIC X(60).
  5280         16  FILLER                  PIC X(25).
  5281*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  98
* EL6501.cbl
  5282*     SEQUENCE NUMBER 1 IS NAME LINE 1
  5283*     SEQUENCE NUMBER 2 IS NAME LINE 2
  5284*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  5285*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  5286*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  5287*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  5288     12  NT-SHIPPING-INFORMATION REDEFINES
  5289                         NT-NOTE-INFORMATION.
  5290         16  NT-SHIPPING-LINE        PIC X(60).
  5291         16  NT-SHIP-STATE           PIC XX.
  5292         16  NT-SHIP-ZIP             PIC X(10).
  5293         16  FILLER                  PIC X(13).
  5294*****************************************************************
  5295
  5296 01  COMMISSION-WORK-AREA.
  5297     05  WK-AGT-COMMS   OCCURS 10 TIMES.
  5298         10  WK-AM-AGT           PIC X(10).
  5299         10  WK-AM-TYPE          PIC X.
  5300         10  WK-FILLER           PIC X(13).
  5301         10  WK-GA-BILL-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  99
* EL6501.cbl
  5303*    COPY ERCCOMP.
  5304******************************************************************
  5305*                                                                *
  5306*                                                                *
  5307*                            ERCCOMP                             *
  5308*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5309*                            VMOD=2.019                          *
  5310*                                                                *
  5311*   ONLINE CREDIT SYSTEM                                         *
  5312*                                                                *
  5313*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  5314*                                                                *
  5315*   FILE TYPE = VSAM,KSDS                                        *
  5316*   RECORD SIZE = 700   RECFORM = FIXED                          *
  5317*                                                                *
  5318*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  5319*       ALTERNATE PATH = NONE                                    *
  5320*                                                                *
  5321*   LOG = NO                                                     *
  5322*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5323*                                                                *
  5324******************************************************************
  5325*                   C H A N G E   L O G
  5326*
  5327* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5328*-----------------------------------------------------------------
  5329*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5330* EFFECTIVE    NUMBER
  5331*-----------------------------------------------------------------
  5332* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5333* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  5334* 092205    2005050300006  PEMA  ADD LEASE FEE
  5335* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  5336* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  5337* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  5338* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5339* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  5340* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  5341******************************************************************
  5342
  5343 01  COMPENSATION-MASTER.
  5344     12  CO-RECORD-ID                          PIC XX.
  5345         88  VALID-CO-ID                          VALUE 'CO'.
  5346
  5347     12  CO-CONTROL-PRIMARY.
  5348         16  CO-COMPANY-CD                     PIC X.
  5349         16  CO-CONTROL.
  5350             20  CO-CTL-1.
  5351                 24  CO-CARR-GROUP.
  5352                     28  CO-CARRIER            PIC X.
  5353                     28  CO-GROUPING.
  5354                         32  CO-GROUP-PREFIX   PIC XXX.
  5355                         32  CO-GROUP-PRIME    PIC XXX.
  5356                 24  CO-RESP-NO.
  5357                     28  CO-RESP-PREFIX        PIC X(4).
  5358                     28  CO-RESP-PRIME         PIC X(6).
  5359             20  CO-CTL-2.
  5360                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 100
* EL6501.cbl
  5361                     28  CO-ACCT-PREFIX        PIC X(4).
  5362                     28  CO-ACCT-PRIME         PIC X(6).
  5363         16  CO-TYPE                           PIC X.
  5364             88  CO-COMPANY-TYPE                  VALUE 'C'.
  5365             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  5366             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  5367
  5368     12  CO-MAINT-INFORMATION.
  5369         16  CO-LAST-MAINT-DT                  PIC XX.
  5370         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  5371         16  CO-LAST-MAINT-USER                PIC X(4).
  5372     12  FILLER                                PIC XX.
  5373     12  CO-STMT-TYPE                          PIC XXX.
  5374     12  CO-COMP-TYPE                          PIC X.
  5375         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  5376     12  CO-STMT-OWNER                         PIC X(4).
  5377     12  CO-BALANCE-CONTROL                    PIC X.
  5378         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  5379         88  CO-NO-BALANCE                        VALUE 'N'.
  5380
  5381     12  CO-INTERNAL-CONTROL-1                 PIC X.
  5382         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  5383         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  5384         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  5385
  5386     12  CO-INTERNAL-CONTROL-2                 PIC X.
  5387         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  5388         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  5389
  5390     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  5391     12  CO-GA-DIRECT-DEP                      PIC X.
  5392     12  CO-FUTURE-SPACE                       PIC X.
  5393         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  5394
  5395     12  CO-ACCT-NAME                          PIC X(30).
  5396     12  CO-MAIL-NAME                          PIC X(30).
  5397     12  CO-ADDR-1                             PIC X(30).
  5398     12  CO-ADDR-2                             PIC X(30).
  5399     12  CO-ADDR-3.
  5400         16  CO-ADDR-CITY                      PIC X(27).
  5401         16  CO-ADDR-STATE                     PIC XX.
  5402     12  CO-CSO-1099                           PIC X.
  5403     12  CO-ZIP.
  5404         16  CO-ZIP-PRIME.
  5405             20  CO-ZIP-PRI-1ST                PIC X.
  5406                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5407             20  FILLER                        PIC X(4).
  5408         16  CO-ZIP-PLUS4                      PIC X(4).
  5409     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  5410         16  CO-CAN-POSTAL-1                   PIC XXX.
  5411         16  CO-CAN-POSTAL-2                   PIC XXX.
  5412         16  FILLER                            PIC XXX.
  5413     12  CO-SOC-SEC                            PIC X(13).
  5414     12  CO-TELEPHONE.
  5415         16  CO-AREA-CODE                      PIC XXX.
  5416         16  CO-PREFIX                         PIC XXX.
  5417         16  CO-PHONE                          PIC X(4).
  5418
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 101
* EL6501.cbl
  5419     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  5420
  5421     12  CO-AR-BAL-LEVEL                       PIC X.
  5422         88  CO-AR-REF-LVL                        VALUE '1'.
  5423         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  5424         88  CO-AR-BILL-LVL                       VALUE '2'.
  5425         88  CO-AR-AGT-LVL                        VALUE '3'.
  5426         88  CO-AR-FR-LVL                         VALUE '4'.
  5427
  5428     12  CO-AR-NORMAL-PRINT                    PIC X.
  5429         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  5430         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  5431
  5432     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  5433
  5434     12  CO-AR-REPORTING                       PIC X.
  5435         88  CO-AR-NET-REPORT                     VALUE 'N'.
  5436         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  5437
  5438     12  CO-AR-PULL-CHECK                      PIC X.
  5439         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  5440         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  5441
  5442     12  CO-AR-BALANCE-PRINT                   PIC X.
  5443         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  5444
  5445     12  CO-AR-LAST-RUN-CODE                   PIC X.
  5446         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  5447         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  5448         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  5449
  5450     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  5451
  5452     12  CO-USER-CODE                          PIC X.
  5453     12  CO-REPORT-GROUP-ID                    PIC X(12).
  5454
  5455******************************************************************
  5456*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  5457*    THE LAST MONTH END RUN.
  5458******************************************************************
  5459
  5460     12  CO-LAST-ACTIVITY-DATE.
  5461         16  CO-ACT-YEAR                       PIC 99.
  5462         16  CO-ACT-MONTH                      PIC 99.
  5463         16  CO-ACT-DAY                        PIC 99.
  5464
  5465     12  CO-LAST-STMT-DT.
  5466         16  CO-LAST-STMT-YEAR                 PIC 99.
  5467         16  CO-LAST-STMT-MONTH                PIC 99.
  5468         16  CO-LAST-STMT-DAY                  PIC 99.
  5469
  5470     12  CO-MO-END-TOTALS.
  5471         16  CO-MONTHLY-TOTALS.
  5472             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  5473             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  5474             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  5475             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  5476             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 102
* EL6501.cbl
  5477
  5478         16  CO-AGING-TOTALS.
  5479             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  5480             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  5481             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  5482             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  5483
  5484         16  CO-YTD-TOTALS.
  5485             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  5486             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  5487
  5488         16  CO-OVER-UNDER-TOTALS.
  5489             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5490             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5491
  5492     12  CO-MISCELLANEOUS-TOTALS.
  5493         16  CO-FICA-TOTALS.
  5494             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  5495             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  5496
  5497         16  CO-CLAIM-TOTALS.
  5498             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  5499             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  5500
  5501******************************************************************
  5502*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  5503*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  5504******************************************************************
  5505
  5506     12  CO-CURRENT-TOTALS.
  5507         16  CO-CURRENT-LAST-STMT-DT.
  5508             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  5509             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  5510             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  5511
  5512         16  CO-CURRENT-MONTHLY-TOTALS.
  5513             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  5514             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  5515             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  5516             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  5517             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  5518
  5519         16  CO-CURRENT-AGING-TOTALS.
  5520             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  5521             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  5522             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  5523             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  5524
  5525         16  CO-CURRENT-YTD-TOTALS.
  5526             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  5527             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  5528
  5529     12  CO-PAID-COMM-TOTALS.
  5530         16  CO-YTD-PAID-COMMS.
  5531             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  5532             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  5533
  5534     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 103
* EL6501.cbl
  5535         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  5536         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  5537
  5538     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  5539         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  5540         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  5541         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  5542         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  5543         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  5544         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  5545         88  CO-FINAL-LETTER                  VALUE 'F'.
  5546         88  CO-RECONCILING                   VALUE 'R'.
  5547         88  CO-PHONE-CALL                    VALUE 'P'.
  5548         88  CO-LEGAL                         VALUE 'L'.
  5549         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  5550         88  CO-WRITE-OFF                     VALUE 'W'.
  5551         88  CO-NO-ACTION                     VALUE 'N' ' '.
  5552
  5553     12  CO-CSR-CODE                       PIC X(4).
  5554
  5555     12  CO-GA-STATUS-INFO.
  5556         16  CO-GA-EFFECTIVE-DT            PIC XX.
  5557         16  CO-GA-TERMINATION-DT          PIC XX.
  5558         16  CO-GA-STATUS-CODE             PIC X.
  5559             88  CO-GA-ACTIVE                 VALUE 'A'.
  5560             88  CO-GA-INACTIVE               VALUE 'I'.
  5561             88  CO-GA-PENDING                VALUE 'P'.
  5562         16  CO-GA-COMMENTS.
  5563             20  CO-GA-COMMENT-1           PIC X(40).
  5564             20  CO-GA-COMMENT-2           PIC X(40).
  5565             20  CO-GA-COMMENT-3           PIC X(40).
  5566             20  CO-GA-COMMENT-4           PIC X(40).
  5567
  5568     12  CO-RPTCD2                         PIC X(10).
  5569     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  5570         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  5571         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  5572
  5573     12  CO-TYPE-AGENT                     PIC X(01).
  5574         88  CO-CORPORATION                   VALUE 'C'.
  5575         88  CO-PARTNERSHIP                   VALUE 'P'.
  5576         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  5577         88  CO-TRUST                         VALUE 'T'.
  5578         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  5579
  5580     12  CO-FAXNO.
  5581         16  CO-FAX-AREA-CODE                  PIC XXX.
  5582         16  CO-FAX-PREFIX                     PIC XXX.
  5583         16  CO-FAX-PHONE                      PIC X(4).
  5584
  5585     12  CO-BANK-INFORMATION.
  5586         16  CO-BANK-TRANSIT-NO                PIC X(8).
  5587         16  CO-BANK-TRANSIT-NON REDEFINES
  5588             CO-BANK-TRANSIT-NO                PIC 9(8).
  5589
  5590         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  5591     12  CO-MISC-DEDUCT-INFO REDEFINES
  5592                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 104
* EL6501.cbl
  5593         16  CO-MD-GL-ACCT                     PIC X(10).
  5594         16  CO-MD-DIV                         PIC XX.
  5595         16  CO-MD-CENTER                      PIC X(4).
  5596         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  5597         16  CO-CREATE-AP-CHECK                PIC X.
  5598         16  CO-DELIVER-CK-TO-MEL              PIC X.
  5599         16  FILLER                            PIC XXX.
  5600     12  CO-ACH-STATUS                         PIC X.
  5601         88  CO-ACH-ACTIVE                         VALUE 'A'.
  5602         88  CO-ACH-PENDING                        VALUE 'P'.
  5603
  5604     12  CO-BILL-SW                            PIC X.
  5605     12  CO-CONTROL-NAME                       PIC X(30).
  5606     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  5607     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  5608     12  CO-CLP-STATE                          PIC XX.
  5609     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  5610     12  CO-SPP-REFUND-EDIT                    PIC X.
  5611
  5612******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 105
* EL6501.cbl
  5614*    COPY ERCNAME.
  5615******************************************************************
  5616*                                                                *
  5617*                                                                *
  5618*                            ERCNAME                             *
  5619*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5620*                            VMOD=2.003                          *
  5621*                                                                *
  5622*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  5623*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  5624*                                                                *
  5625*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  5626*                                                                *
  5627*   FILE TYPE = VSAM,KSDS                                        *
  5628*   RECORD SIZE = 160   RECFORM = FIX                            *
  5629*                                                                *
  5630*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  5631*                                                                *
  5632*   LOG = NO                                                     *
  5633*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5634*                                                                *
  5635*                                                                *
  5636******************************************************************
  5637
  5638 01  NAME-LOOKUP-MASTER.
  5639     12  NL-RECORD-ID                PIC  X(02).
  5640         88  VALID-NL-ID                         VALUE 'NL'.
  5641
  5642     12  NL-RECORD-KEY.
  5643         16  NL-CONTROL-PRIMARY.
  5644             20  NL-COMPANY-CD       PIC  X(01).
  5645             20  NL-NAME             PIC  X(30).
  5646             20  NL-RECORD-TYPE      PIC  X(01).
  5647                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  5648                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  5649                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  5650
  5651         16  NL-ACCOUNT-MASTER.
  5652             20  NL-AM-COMPANY-CD    PIC  X(01).
  5653             20  NL-AM-CARRIER       PIC  X(01).
  5654             20  NL-AM-GROUPING      PIC  X(06).
  5655             20  NL-AM-STATE         PIC  X(02).
  5656             20  NL-AM-ACCOUNT       PIC  X(10).
  5657             20  FILLER              PIC  X(09).
  5658
  5659         16  NL-COMPENSATION-MASTER
  5660                                 REDEFINES  NL-ACCOUNT-MASTER.
  5661             20  NL-CO-COMPANY-CD    PIC  X(01).
  5662             20  NL-CO-CARRIER       PIC  X(01).
  5663             20  NL-CO-GROUPING      PIC  X(06).
  5664             20  NL-CO-RESP-NO       PIC  X(10).
  5665             20  NL-CO-ACCOUNT       PIC  X(10).
  5666             20  NL-CO-TYPE          PIC  X(01).
  5667
  5668         16  NL-REINSURANCE-RECORD
  5669                                 REDEFINES  NL-ACCOUNT-MASTER.
  5670             20  NL-RE-COMPANY-CD    PIC  X(01).
  5671             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 106
* EL6501.cbl
  5672             20  NL-RE-COMPANY.
  5673                 24  NL-RE-COMP      PIC  X(03).
  5674                 24  NL-RE-CO-SUB    PIC  X(03).
  5675             20  NL-RE-TABLE         PIC  X(03).
  5676             20  FILLER              PIC  X(18).
  5677
  5678     12  NL-MAINT-INFORMATION.
  5679         16  NL-LAST-MAINT-DT        PIC  X(02).
  5680         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  5681         16  NL-LAST-MAINT-USER      PIC  X(04).
  5682         16  FILLER                  PIC  X(10).
  5683
  5684     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  5685         16  NL-RE-LEVEL             PIC  9(02).
  5686
  5687     12  NL-CITY                     PIC  X(15).
  5688     12  NL-ST                       PIC  XX.
  5689
  5690******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 107
* EL6501.cbl
  5692*    COPY ERCRQST.
  5693******************************************************************
  5694*                                                                *
  5695*                                                                *
  5696*                            ERCRQST.                            *
  5697*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5698*                            VMOD=2.002                          *
  5699*                                                                *
  5700*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  5701*                                                                *
  5702*   FILE TYPE = VSAM,KSDS                                        *
  5703*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5704*                                                                *
  5705*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  5706*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  5707*                                   ACCOUNT, REF, BATCH)         *
  5708*                                                RKP=9, LEN=38   *
  5709*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  5710*                                   ACCOUNT, REF, BATCH)         *
  5711*                                                RKP=47, LEN=46  *
  5712*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  5713*                                   BATCH)                       *
  5714*                                                RKP=93, LEN=24  *
  5715*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  5716*                                   REF, BATCH)                  *
  5717*                                                RKP=117, LEN=35 *
  5718*   LOG = NO                                                     *
  5719*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5720******************************************************************
  5721
  5722 01  AR-REQUEST-RECORD.
  5723     12  RQ-RECORD-ID                     PIC XX.
  5724         88  VALID-RQ-ID                        VALUE 'RQ'.
  5725
  5726     12  RQ-CONTROL-PRIMARY.
  5727         16  RQ-COMPANY-CD                PIC X.
  5728         16  RQ-ENTRY-BATCH               PIC X(6).
  5729
  5730     12  RQ-CONTROL-BY-ACCT-REF.
  5731         16  RQ-COMPANY-CD-A1             PIC X.
  5732         16  RQ-CARRIER-A1                PIC X.
  5733         16  RQ-GROUPING-A1               PIC X(6).
  5734         16  RQ-STATE-A1                  PIC XX.
  5735         16  RQ-ACCOUNT-A1                PIC X(10).
  5736         16  RQ-REFERENCE-A1              PIC X(12).
  5737         16  RQ-BATCH-A1                  PIC X(6).
  5738
  5739     12  RQ-CONTROL-BY-FIN-RESP.
  5740         16  RQ-COMPANY-CD-A2             PIC X.
  5741         16  RQ-CARRIER-A2                PIC X.
  5742         16  RQ-GROUPING-A2               PIC X(6).
  5743         16  RQ-FIN-RESP-A2               PIC X(10).
  5744         16  RQ-ACCT-AGENT-A2             PIC X(10).
  5745         16  RQ-REFERENCE-A2              PIC X(12).
  5746         16  RQ-BATCH-A2                  PIC X(6).
  5747
  5748     12  RQ-CONTROL-BY-ACCT-AGENT.
  5749         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 108
* EL6501.cbl
  5750         16  RQ-CARRIER-A3                PIC X.
  5751         16  RQ-GROUPING-A3               PIC X(6).
  5752         16  RQ-ACCT-AGENT-A3             PIC X(10).
  5753         16  RQ-BATCH-A3                  PIC X(6).
  5754
  5755     12  RQ-CONTROL-BY-SUMMARY.
  5756         16  RQ-COMPANY-CD-A4             PIC X.
  5757         16  RQ-SUMMARY-CODE              PIC X(6).
  5758         16  RQ-ACCOUNT-A4                PIC X(10).
  5759         16  RQ-REFERENCE-A4              PIC X(12).
  5760         16  RQ-BATCH-A4                  PIC X(6).
  5761
  5762     12  RQ-REQUEST-METHOD                PIC X.
  5763         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  5764         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  5765         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  5766         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  5767     12  FILLER                           PIC X.
  5768     12  RQ-STATUS                        PIC X.
  5769         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  5770         88  RQ-RESUBMIT                      VALUE 'R'.
  5771     12  RQ-PROCESSOR-ID                  PIC X(4).
  5772     12  RQ-ENTRY-DT                      PIC XX.
  5773     12  RQ-MO-END-DT                     PIC XX.
  5774     12  RQ-REQUEST-DT                    PIC XX.
  5775     12  RQ-STMT-DT                       PIC XX.
  5776     12  RQ-REVERSAL-DT                   PIC XX.
  5777     12  RQ-CREDIT-SELECT-DT              PIC XX.
  5778     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  5779
  5780     12  FILLER                           PIC X(27).
  5781
  5782******************************************************************
  5783
  5784*EJECT
  5785*    COPY ERCGXRF.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 109
* EL6501.cbl
  5787 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ACCOUNT-MASTER
  5788                          PRODUCT-MASTER CONTROL-FILE
  5789                          REINSURANCE-RECORD COMM-TABLE-RECORD
  5790                          NOTE-FILE COMMISSION-WORK-AREA
  5791                          COMPENSATION-MASTER
  5792                          NAME-LOOKUP-MASTER AR-REQUEST-RECORD.
  5793 0000-DFHEXIT SECTION.
  5794     MOVE '9#                    $   ' TO DFHEIV0.
  5795     MOVE 'EL6501' TO DFHEIV1.
  5796     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5797     MOVE EIBTRMID              TO QID-TERM.
  5798
  5799     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  5800     MOVE '5'                   TO DC-OPTION-CODE.
  5801     PERFORM 9700-DATE-LINK.
  5802     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  5803     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  5804
  5805***  Y2K PROJ 7744
  5806     MOVE DC-GREG-DATE-1-YMD    TO  CYMD-CURRENT-SAVE
  5807                                    CURRENT-SAVE
  5808     MOVE DC-ALPHA-CENTURY      TO  CYMD-CURRENT-SAVE(1:2)
  5809                                    CURRENT-SAVE(1:2)
  5810***  Y2K PROJ 7744
  5811
  5812     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  5813     IF EIBCALEN = 0
  5814         GO TO 8800-UNAUTHORIZED-ACCESS.
  5815
  5816     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
  5817     MOVE LOW-VALUES             TO EL6501AI.
  5818
  5819
  5820* EXEC CICS HANDLE CONDITION
  5821*        PGMIDERR  (9600-PGMID-ERROR)
  5822*        ERROR     (9990-ABEND)
  5823*        QIDERR    (0500-CHECK-MAINT-TYPE)
  5824*    END-EXEC.
  5825*    MOVE '"$L.N                 ! " #00005815' TO DFHEIV0
  5826     MOVE X'22244C2E4E20202020202020' TO DFHEIV0(1:12)
  5827     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5828     MOVE X'2220233030303035383135' TO DFHEIV0(25:11)
  5829     CALL 'kxdfhei1' USING DFHEIV0
  5830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5831
  5832
  5833     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5834         IF PI-CALLING-PROGRAM = XCTL-650
  5835             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5836             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5837             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5838             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5839             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5840             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5841             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5842             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5843             PERFORM 5200-DELETE-TS THRU 5299-EXIT
  5844             GO TO 0500-CHECK-MAINT-TYPE
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 110
* EL6501.cbl
  5845         ELSE
  5846             PERFORM 5200-RECOVER-TS  THRU  5299-EXIT
  5847             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5848             GO TO 0600-DISPLAY-RECORD.
  5849
  5850     IF EIBAID = DFHCLEAR
  5851         GO TO 9400-CLEAR.
  5852
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 111
* EL6501.cbl
  5854 0200-RECEIVE.
  5855     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5856         MOVE ER-0008            TO EMI-ERROR
  5857         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5858         MOVE -1                 TO PFENTERL
  5859         GO TO 8200-SEND-DATAONLY.
  5860
  5861
  5862* EXEC CICS RECEIVE
  5863*        MAP      (MAP-NAME)
  5864*        MAPSET   (MAPSET-NAME)
  5865*        INTO     (EL6501AI)
  5866*    END-EXEC.
  5867     MOVE LENGTH OF
  5868      EL6501AI
  5869       TO DFHEIV11
  5870*    MOVE '8"T I  L              ''   #00005849' TO DFHEIV0
  5871     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5872     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5873     MOVE X'2020233030303035383439' TO DFHEIV0(25:11)
  5874     CALL 'kxdfhei1' USING DFHEIV0,
  5875           MAP-NAME,
  5876           EL6501AI,
  5877           DFHEIV11,
  5878           MAPSET-NAME,
  5879           DFHEIV99,
  5880           DFHEIV99
  5881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5882
  5883
  5884     IF PFENTERL = 0
  5885         GO TO 0300-CHECK-PFKEYS.
  5886     IF EIBAID NOT = DFHENTER
  5887         MOVE ER-0004            TO EMI-ERROR
  5888         GO TO 0320-INPUT-ERROR.
  5889     IF (PFENTERI NUMERIC) AND (PFENTERI > 0 AND < 25)
  5890         MOVE PF-VALUES (PFENTERI) TO EIBAID
  5891     ELSE
  5892         MOVE ER-0029            TO EMI-ERROR
  5893         GO TO 0320-INPUT-ERROR.
  5894
  5895 0300-CHECK-PFKEYS.
  5896     IF EIBAID = DFHPF23
  5897         GO TO 8810-PF23.
  5898     IF EIBAID = DFHPF24
  5899         GO TO 9200-RETURN-MAIN-MENU.
  5900     IF EIBAID = DFHPF12
  5901         GO TO 9500-PF12.
  5902
  5903* CHECK PF10 KEY FOR A CALL TO EL608 TO BROWSE RESIDENT STATE TAX
  5904*             MASTER(ERRESC)
  5905*
  5906*    IF  EIBAID = DFHPF10
  5907*        IF PI-COMPANY-ID = 'DMD'
  5908*           PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT
  5909*           MOVE LOW-VALUES TO WS-DMD-AGENT
  5910*           PERFORM 6500-READ-ACCT       THRU 6599-EXIT
  5911*           PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 112
* EL6501.cbl
  5912*           PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT
  5913*           MOVE EIBAID       TO PI-ENTRY-CD-1
  5914*           MOVE WS-COMP-DATE TO PI-PREV-VG-ACCOUNT (11:5)
  5915*           MOVE WS-DMD-AGENT TO PI-PREV-VG-ACCOUNT (1:10)
  5916*           MOVE XCTL-608           TO PGM-NAME
  5917*                                      PI-RETURN-TO-PROGRAM
  5918*                                      PI-CALLING-PROGRAM
  5919*           MOVE '106E'             TO PI-CURRENT-SCREEN-NO
  5920*           GO TO 9300-XCTL.
  5921
  5922     IF (EIBAID = DFHPF1  OR  DFHPF2  OR DFHPF3 OR
  5923                  DFHPF4  OR  DFHPF5  OR DFHPF7 OR
  5924                  DFHPF8  OR  DFHPF9 OR DFHPF10)
  5925         IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  5926             MOVE ER-0029        TO  EMI-ERROR
  5927             GO TO 0320-INPUT-ERROR
  5928         ELSE
  5929             GO TO 0800-CHECK-MAINT.
  5930
  5931     IF EIBAID = DFHENTER
  5932         GO TO 0330-EDIT-DATA.
  5933
  5934     MOVE ER-0029                TO EMI-ERROR.
  5935
  5936 0320-INPUT-ERROR.
  5937     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5938     MOVE AL-UNBON               TO PFENTERA.
  5939     MOVE -1                     TO PFENTERL.
  5940     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 113
* EL6501.cbl
  5942 0330-EDIT-DATA.
  5943     IF MAINTI  = 'S'
  5944        PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT
  5945        PERFORM 6500-READ-ACCT       THRU 6599-EXIT
  5946        PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
  5947        PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT
  5948        MOVE -1                  TO MAINTL
  5949        GO TO 8100-SEND-INITIAL-MAP.
  5950
  5951     PERFORM 8000-STATE-REC-READ   THRU 8010-EXIT.
  5952     PERFORM 6800-COMPANY-REC-READ THRU 6899-EXIT.
  5953
  5954     IF EMI-ERROR NOT = ZEROS
  5955         MOVE -1                 TO MAINTL
  5956         GO TO 8200-SEND-DATAONLY.
  5957
  5958     IF NOT MODIFY-CAP
  5959         MOVE 'UPDATE'           TO SM-READ
  5960         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  5961         MOVE ER-0070            TO EMI-ERROR
  5962         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5963         GO TO 8100-SEND-INITIAL-MAP.
  5964
  5965     MOVE SAVE-BIN-DATE          TO BIN-CURRENT-SAVE.
  5966
  5967     IF MAINTI = 'A'
  5968        GO TO 1000-ADD-A-RECORD.
  5969
  5970     IF MAINTI = 'C'
  5971        IF PI-SV-MAINT  =  'L'
  5972            MOVE -1             TO MAINTL
  5973            MOVE AL-UABON       TO MAINTA
  5974            MOVE ER-0899        TO EMI-ERROR
  5975            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5976            GO TO 8200-SEND-DATAONLY
  5977        ELSE
  5978            GO TO 2000-CHANGE-A-RECORD.
  5979
  5980     IF MAINTI = 'L'
  5981        MOVE 'L'                TO PI-SV-MAINT
  5982        GO TO 3000-CHANGE-ALL-RECORDS.
  5983
  5984     MOVE ER-0023                TO EMI-ERROR.
  5985     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5986     MOVE -1                     TO MAINTL.
  5987     MOVE AL-UABON               TO MAINTA.
  5988     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 114
* EL6501.cbl
  5990 0500-CHECK-MAINT-TYPE.
  5991     IF PI-MAINT = 'A'
  5992        PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
  5993        PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT
  5994        MOVE -1                  TO NAMEL
  5995        GO TO 8100-SEND-INITIAL-MAP.
  5996
  5997 0600-DISPLAY-RECORD.
  5998     PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT.
  5999     PERFORM 6500-READ-ACCT       THRU 6599-EXIT.
  6000     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  6001     PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT.
  6002
  6003     IF PI-MAINT = 'A'
  6004        MOVE -1                  TO NAMEL
  6005     ELSE
  6006        MOVE -1                  TO MAINTL.
  6007
  6008     GO TO 8100-SEND-INITIAL-MAP.
  6009
  6010 0700-FORMAT-KEYDATA.
  6011     MOVE PI-MAINT               TO MAINTI.
  6012
  6013     IF PI-MAINT = 'A'
  6014        MOVE AL-PANON            TO MAINTA
  6015        SET T-INDEX TO 1
  6016     ELSE
  6017        SET T-INDEX              TO PI-LINE-SELECTED
  6018        MOVE AL-UANON            TO MAINTA.
  6019
  6020     IF PI-2ND-PAGE
  6021         SET T-INDEX UP BY 8
  6022     ELSE
  6023     IF PI-3RD-PAGE
  6024         SET T-INDEX UP BY 16
  6025     ELSE
  6026     IF PI-LST-PAGE
  6027         SET T-INDEX UP BY 24.
  6028
  6029     MOVE PI-ACCT-CARRIER        TO CARRI.
  6030     MOVE PI-ACCT-GROUPING       TO GROUPINI.
  6031     MOVE PI-ACCT-STATE          TO STATEI.
  6032     MOVE PI-ACCT-ACCOUNT        TO ACCOUNTI.
  6033
  6034     IF PI-ACCT-EXP-DT = LOW-VALUES
  6035        MOVE SPACES              TO EXPDTEI
  6036     ELSE
  6037        IF PI-ACCT-EXP-DT NOT = HIGH-VALUES
  6038           MOVE PI-ACCT-EXP-DT      TO DC-BIN-DATE-1
  6039           MOVE SPACE               TO DC-OPTION-CODE
  6040           PERFORM 9700-DATE-LINK
  6041           MOVE DC-GREG-DATE-1-EDIT TO EXPDTEI
  6042        ELSE
  6043           MOVE 999999              TO EXPDTEO
  6044           INSPECT EXPDTEI CONVERTING SPACES TO '/'.
  6045
  6046***DMD CUSTOM CODE *****START
  6047     MOVE EXPDTEI (1:2)             TO WS-YYYYMMDD (5:2).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 115
* EL6501.cbl
  6048     MOVE EXPDTEI (4:2)             TO WS-YYYYMMDD (7:2).
  6049     MOVE EXPDTEI (6:2)             TO WS-YYYYMMDD (3:2).
  6050     IF EXPDTEI (7:1) IS NOT EQUAL TO '9'
  6051        MOVE '20'                 TO WS-YYYYMMDD (1:2)
  6052     ELSE
  6053        MOVE '19'                 TO WS-YYYYMMDD (1:2).
  6054***DMD CUSTOM CODE *****END
  6055
  6056     MOVE PI-BIN-EFF-DT (T-INDEX) TO DC-BIN-DATE-1.
  6057     MOVE SPACE                   TO DC-OPTION-CODE.
  6058     PERFORM 9700-DATE-LINK.
  6059     MOVE DC-GREG-DATE-1-EDIT     TO EFFDTEI.
  6060
  6061 0700-EXIT.
  6062      EXIT.
  6063
  6064 0800-CHECK-MAINT.
  6065     IF PI-MAINT = 'A'
  6066        IF PI-RECORD-NOT-CREATED
  6067           MOVE ER-2071          TO EMI-ERROR
  6068           MOVE  -1              TO NAMEL
  6069           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6070           GO TO 8200-SEND-DATAONLY.
  6071
  6072     IF  EIBAID = DFHPF1
  6073             AND
  6074         CREDIT-SESSION
  6075         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6076         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  6077         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  6078         MOVE PI-ACCT-STATE      TO PI-STATE
  6079         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  6080         MOVE PI-ACCT-EXP-DT     TO PI-CERT-EFF-DT
  6081         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  6082         MOVE XCTL-689           TO PGM-NAME
  6083         GO TO 9300-XCTL.
  6084
  6085     IF  EIBAID = DFHPF2 AND CREDIT-SESSION
  6086         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6087         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  6088         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  6089         MOVE PI-ACCT-STATE      TO PI-STATE
  6090         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  6091         MOVE LOW-VALUES         TO PI-CERT-EFF-DT
  6092         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  6093         MOVE XCTL-690           TO PGM-NAME
  6094         GO TO 9300-XCTL
  6095     END-IF.
  6096
  6097     IF EIBAID = DFHPF3
  6098             AND
  6099         CREDIT-SESSION
  6100         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6101         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  6102         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  6103         MOVE PI-ACCT-STATE      TO PI-STATE
  6104         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  6105         MOVE LOW-VALUES         TO PI-CERT-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 116
* EL6501.cbl
  6106         MOVE XCTL-653           TO PGM-NAME
  6107         GO TO 9300-XCTL.
  6108
  6109     IF EIBAID = DFHPF4
  6110         PERFORM 5100-WRITE-TS  THRU  5199-EXIT
  6111         MOVE XCTL-652           TO PGM-NAME
  6112         GO TO 9300-XCTL.
  6113
  6114     IF EIBAID = DFHPF5
  6115         MOVE XCTL-6502          TO PGM-NAME
  6116         GO TO 9300-XCTL.
  6117
  6118     IF EIBAID = DFHPF7
  6119         MOVE XCTL-6504          TO PGM-NAME
  6120         GO TO 9300-XCTL.
  6121
  6122     IF EIBAID = DFHPF8
  6123         MOVE XCTL-6506          TO PGM-NAME
  6124         GO TO 9300-XCTL.
  6125
  6126     IF EIBAID = DFHPF9
  6127        MOVE XCTL-6505           TO PGM-NAME
  6128        GO TO 9300-XCTL.
  6129
  6130     IF EIBAID = DFHPF10
  6131        IF PI-COMPANY-ID = 'DMD'
  6132           PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6133           MOVE XCTL-608         TO PGM-NAME
  6134           GO TO 9300-XCTL.
  6135
  6136     MOVE ER-0029                TO EMI-ERROR.
  6137     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6138     MOVE AL-UNBON               TO PFENTERA.
  6139     MOVE -1                     TO PFENTERL.
  6140     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 117
* EL6501.cbl
  6142 1000-ADD-A-RECORD.
  6143     IF PI-MAINT = 'A'
  6144        PERFORM 4000-EDITS THRU 4900-EXIT
  6145     ELSE
  6146        MOVE ER-2180             TO EMI-ERROR
  6147        MOVE -1                  TO MAINTL
  6148        MOVE AL-UABON            TO MAINTA
  6149        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6150
  6151     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6152        EMI-FATAL-CTR    GREATER ZERO
  6153         GO TO 8200-SEND-DATAONLY.
  6154
  6155
  6156* EXEC CICS GETMAIN
  6157*         LENGTH   (ACCT-REC-LEN)
  6158*         SET      (ADDRESS OF ACCOUNT-MASTER)
  6159*         INITIMG  (GETMAIN-SPACE)
  6160*    END-EXEC.
  6161*    MOVE ',"IL                  $   #00006126' TO DFHEIV0
  6162     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6163     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6164     MOVE X'2020233030303036313236' TO DFHEIV0(25:11)
  6165     CALL 'kxdfhei1' USING DFHEIV0,
  6166           DFHEIV20,
  6167           ACCT-REC-LEN,
  6168           GETMAIN-SPACE
  6169     SET ADDRESS OF ACCOUNT-MASTER TO
  6170         DFHEIV20
  6171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6172
  6173
  6174     MOVE ZEROS          TO WSS-LF-LM-AGE (1) WSS-LF-LM-AGE (2)
  6175                            WSS-LF-LM-AGE (3) WSS-LF-LM-AGE (4)
  6176                            WSS-LF-LM-DUR (1) WSS-LF-LM-DUR (2)
  6177                            WSS-LF-LM-DUR (3) WSS-LF-LM-DUR (4)
  6178                            WSS-LF-LM-AMT (1) WSS-LF-LM-AMT (2)
  6179                            WSS-LF-LM-AMT (3) WSS-LF-LM-AMT (4).
  6180
  6181     MOVE ZEROS          TO WSS-AH-LM-AGE (1) WSS-LF-LM-AGE (2)
  6182                            WSS-AH-LM-AGE (3) WSS-LF-LM-AGE (4)
  6183                            WSS-AH-LM-DUR (1) WSS-LF-LM-DUR (2)
  6184                            WSS-AH-LM-DUR (3) WSS-LF-LM-DUR (4)
  6185                            WSS-AH-LM-AMT (1) WSS-LF-LM-AMT (2)
  6186                            WSS-AH-LM-AMT (3) WSS-LF-LM-AMT (4)
  6187                            WSS-AH-LM-MOA (1) WSS-AH-LM-MOA (2)
  6188                            WSS-AH-LM-MOA (3) WSS-AH-LM-MOA (4).
  6189
  6190     MOVE WSS-AGT-COMMS          TO AM-AGT-COMMS (1)
  6191                                    AM-AGT-COMMS (2)
  6192                                    AM-AGT-COMMS (3)
  6193                                    AM-AGT-COMMS (4)
  6194                                    AM-AGT-COMMS (5)
  6195                                    AM-AGT-COMMS (6)
  6196                                    AM-AGT-COMMS (7)
  6197                                    AM-AGT-COMMS (8)
  6198                                    AM-AGT-COMMS (9)
  6199                                    AM-AGT-COMMS (10).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 118
* EL6501.cbl
  6200
  6201     IF PI-COMPANY-ID = 'FLI'
  6202         MOVE ZEROS              TO AM-FLI-BANK-BALANCE
  6203                                    AM-FLI-BANK-1ST-6-PREM
  6204                                    AM-FLI-BANK-CAP-AMT
  6205                                    AM-FLI-AGT-SHARE-PCT (1)
  6206                                    AM-FLI-AGT-SHARE-PCT (2)
  6207                                    AM-FLI-AGT-SHARE-PCT (3)
  6208                                    AM-FLI-AGT-SHARE-PCT (4)
  6209                                    AM-FLI-AGT-SHARE-PCT (5)
  6210                                    AM-FLI-AGT-SHARE-PCT (6)
  6211                                    AM-FLI-AGT-SHARE-PCT (7)
  6212                                    AM-FLI-AGT-SHARE-PCT (8)
  6213                                    AM-FLI-AGT-SHARE-PCT (9)
  6214                                    AM-FLI-AGT-SHARE-PCT (10).
  6215
  6216     MOVE ZEROS                  TO AM-GPCD
  6217                                    AM-LF-RET
  6218                                    AM-AH-RET
  6219                                    AM-LF-OB-RATE
  6220                                    AM-LF-OB-RATE-JNT
  6221                                    AM-AH-OB-RATE
  6222                                    AM-AH-OB-RATE-JNT
  6223                                    AM-REI-FEE-LF
  6224                                    AM-REI-FEE-AH
  6225                                    AM-REI-LF-TAX
  6226                                    AM-REI-PR-PCT
  6227                                    AM-REI-78-PCT
  6228                                    AM-REI-AH-TAX
  6229                                    AM-TOL-PREM
  6230                                    AM-TOL-REF
  6231                                    AM-CLP-TOL-PCT
  6232                                    AM-TOL-CLM
  6233                                    AM-CERTS-PURGED-DATE
  6234                                    AM-HI-CERT-DATE
  6235                                    AM-LO-CERT-DATE
  6236                                    AM-1ST-PROD-DATE
  6237                                    AM-GPCD
  6238                                    AM-CAL-TABLE
  6239                                    AM-LF-DEVIATION
  6240                                    AM-LF-DEVIATION-PCT
  6241                                    AM-AH-DEVIATION
  6242                                    AM-AH-DEVIATION-PCT
  6243                                    AM-ANNIVERSARY-DATE
  6244                                    AM-TEL-NO
  6245                                    AM-ENTRY-DATE
  6246                                    AM-INACTIVE-DATE
  6247                                    AM-RET-MIN-LOSS-L
  6248                                    AM-RET-MIN-LOSS-A
  6249                                    AM-LF-RPT021-EXP-PCT
  6250                                    AM-AH-RPT021-EXP-PCT
  6251                                    AM-MAX-MON-BEN
  6252                                    AM-MAX-TOT-BEN
  6253                                    AM-DCC-MAX-MARKETING-FEE
  6254                                    AM-SPP-LEASE-COMM
  6255                                    AM-RETRO-QUALIFY-LIMIT
  6256                                    AM-RETRO-RET-PCT-LF (1)
  6257                                    AM-RETRO-RET-PCT-LF (2)
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 119
* EL6501.cbl
  6258                                    AM-RETRO-RET-PCT-LF (3)
  6259                                    AM-RETRO-RET-THRU-LF (1)
  6260                                    AM-RETRO-RET-THRU-LF (2)
  6261                                    AM-RETRO-RET-THRU-LF (3)
  6262                                    AM-RETRO-RET-PCT-AH (1)
  6263                                    AM-RETRO-RET-PCT-AH (2)
  6264                                    AM-RETRO-RET-PCT-AH (3)
  6265                                    AM-RETRO-RET-THRU-AH (1)
  6266                                    AM-RETRO-RET-THRU-AH (2)
  6267                                    AM-RETRO-RET-THRU-AH (3).
  6268
  6269     IF PI-COMPANY-ID = 'DCC' or 'VPP'
  6270        MOVE +100                TO AM-DCC-MAX-MARKETING-FEE
  6271     END-IF
  6272     MOVE LOW-VALUES             TO PI-ACCT-REST-OF-EXP
  6273                                    AM-AR-HI-CERT-DATE.
  6274
  6275     MOVE 'AM'                   TO AM-RECORD-ID.
  6276     MOVE PI-ACCT-KEY            TO AM-CONTROL-PRIMARY
  6277                                    AM-CONTROL-BY-VAR-GRP.
  6278
  6279     IF ST-ACCNT-CNTL
  6280        MOVE SPACES              TO AM-VG-CARRIER
  6281                                    AM-VG-GROUPING.
  6282     IF CARR-ST-ACCNT-CNTL
  6283        MOVE SPACES              TO AM-VG-GROUPING.
  6284
  6285     IF ACCNT-CNTL
  6286        MOVE SPACES              TO AM-VG-CARRIER
  6287                                    AM-VG-STATE
  6288                                    AM-VG-GROUPING.
  6289
  6290     IF CARR-ACCNT-CNTL
  6291        MOVE SPACES              TO AM-VG-STATE
  6292                                    AM-VG-GROUPING.
  6293
  6294     MOVE CURRENT-SAVE           TO AM-ENTRY-DATE.
  6295     MOVE BIN-EXPCHG-SAVE        TO AM-VG-EXPIRATION-DT.
  6296     MOVE PI-BIN-EFF-DT (1)      TO AM-EFFECTIVE-DT.
  6297
  6298     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  6299     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  6300     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  6301
  6302     PERFORM 5000-MOVE-TO-RECORD THRU 5000-EXIT.
  6303
  6304     IF PI-COMPANY-ID = 'NCL'
  6305         MOVE 'N'                TO AM-AH-ONLY-INDICATOR.
  6306
  6307     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6308        EMI-FATAL-CTR    GREATER ZERO
  6309         GO TO 8200-SEND-DATAONLY.
  6310
  6311     IF PI-COMPANY-ID = 'DCC' or 'VPP'
  6312        IF CLPSTL <= ZEROS
  6313           MOVE ER-0144          TO  EMI-ERROR
  6314           MOVE -1               TO  CLPSTL
  6315           MOVE AL-UABON         TO  CLPSTA
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 120
* EL6501.cbl
  6316           PERFORM 9900-ERROR-FORMAT
  6317                                 THRU  9900-EXIT
  6318           GO TO 8200-SEND-DATAONLY
  6319        END-IF
  6320     END-IF
  6321     MOVE AM-COMM-STRUCTURE      TO AM-COMM-STRUCTURE-SAVED.
  6322     MOVE SPACE                  TO AM-COMM-CHANGE-STATUS.
  6323
  6324     MOVE +1 TO AXRF-SUB
  6325                COMM-WORK-SUB.
  6326
  6327     PERFORM 6700-BUILD-COMM-WORK     THRU 6799-EXIT.
  6328     PERFORM 6900-READ-AND-CHECK-AXRF THRU 6999-EXIT.
  6329
  6330     PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  6331
  6332     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6333         NEXT SENTENCE
  6334     ELSE
  6335         PERFORM 1500-ADD-COMP     THRU 1500-EXIT.
  6336
  6337
  6338* EXEC CICS WRITE
  6339*        FROM      (ACCOUNT-MASTER)
  6340*        RIDFLD    (AM-CONTROL-PRIMARY)
  6341*        DATASET   (ACCT-FILE-ID)
  6342*    END-EXEC.
  6343     MOVE LENGTH OF
  6344      ACCOUNT-MASTER
  6345       TO DFHEIV11
  6346*    MOVE '&$ L                  ''   #00006295' TO DFHEIV0
  6347     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6348     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6349     MOVE X'2020233030303036323935' TO DFHEIV0(25:11)
  6350     CALL 'kxdfhei1' USING DFHEIV0,
  6351           ACCT-FILE-ID,
  6352           ACCOUNT-MASTER,
  6353           DFHEIV11,
  6354           AM-CONTROL-PRIMARY,
  6355           DFHEIV99,
  6356           DFHEIV99
  6357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6358
  6359
  6360     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  6361
  6362     MOVE PI-MAINT               TO PI-SV-MAINT.
  6363     MOVE 'C'                    TO PI-MAINT.
  6364     MOVE LOW-VALUES             TO EL6501AI.
  6365
  6366     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  6367     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  6368     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  6369
  6370     IF PI-COMPANY-ID = 'NCL'
  6371         MOVE ER-4011            TO EMI-ERROR
  6372      ELSE
  6373         MOVE ER-0000            TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 121
* EL6501.cbl
  6374
  6375     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6376
  6377     MOVE -1                     TO MAINTL.
  6378     MOVE AL-UANON               TO MAINTA.
  6379     MOVE '1'                    TO PI-RECORD-ADDED-SW.
  6380     GO TO 8100-SEND-INITIAL-MAP.
  6381
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 122
* EL6501.cbl
  6383 1500-ADD-COMP.
  6384
  6385* EXEC CICS GETMAIN
  6386*         LENGTH   (COMP-REC-LEN)
  6387*         SET      (ADDRESS OF COMPENSATION-MASTER)
  6388*         INITIMG  (GETMAIN-SPACE)
  6389*    END-EXEC.
  6390*    MOVE ',"IL                  $   #00006325' TO DFHEIV0
  6391     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6392     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6393     MOVE X'2020233030303036333235' TO DFHEIV0(25:11)
  6394     CALL 'kxdfhei1' USING DFHEIV0,
  6395           DFHEIV20,
  6396           COMP-REC-LEN,
  6397           GETMAIN-SPACE
  6398     SET ADDRESS OF COMPENSATION-MASTER TO
  6399         DFHEIV20
  6400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6401
  6402
  6403     MOVE SPACES                 TO COMPENSATION-MASTER.
  6404     MOVE ZEROS TO CO-BAL-FWD      CO-CUR-COM   CO-CUR-CHG
  6405                   CO-CUR-PMT      CO-END-BAL   CO-CUR
  6406                   CO-OV30         CO-OV60      CO-OV90
  6407                   CO-YTD-COM      CO-YTD-OV    CO-CUR-OVR-UNDR
  6408                   CO-YTD-OVR-UNDR CO-CUR-FICA CO-YTD-FICA
  6409                   CO-LF-CLM-AMT   CO-AH-CLM-AMT
  6410                   CO-CURRENT-BAL-FWD CO-CURRENT-CUR-COM
  6411                   CO-CURRENT-CUR-CHG CO-CURRENT-END-BAL
  6412                   CO-CURRENT-CUR     CO-CURRENT-OV30
  6413                   CO-CURRENT-OV60    CO-CURRENT-OV90
  6414                   CO-CURRENT-CUR-PMT
  6415                   CO-CURRENT-YTD-COM CO-CURRENT-YTD-OV
  6416                   CO-ACT-YEAR        CO-ACT-MONTH
  6417                   CO-ACT-DAY         CO-LAST-STMT-YEAR
  6418                   CO-LAST-STMT-MONTH CO-LAST-STMT-DAY
  6419                   CO-CURRENT-LAST-STMT-YEAR
  6420                   CO-CURRENT-LAST-STMT-MONTH
  6421                   CO-CURRENT-LAST-STMT-DAY
  6422                   CO-YTD-PAID-COM
  6423                   CO-YTD-PAID-OV
  6424                   co-ov120 co-current-ov120
  6425
  6426     MOVE BIN-CURRENT-SAVE       TO CO-LAST-MAINT-DT.
  6427     MOVE PI-PROCESSOR-ID        TO CO-LAST-MAINT-USER.
  6428     MOVE EIBTIME                TO CO-LAST-MAINT-HHMMSS.
  6429     MOVE PI-CR-MONTH-END-DT     TO CO-ROLADEX-PRINT-DT.
  6430     MOVE PI-COMPANY-CD          TO CO-COMPANY-CD.
  6431
  6432     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  6433         MOVE ZEROS              TO CO-CARRIER
  6434     ELSE
  6435         MOVE AM-CARRIER         TO CO-CARRIER.
  6436
  6437     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  6438         MOVE ZEROS              TO CO-GROUPING
  6439     ELSE
  6440         MOVE AM-GROUPING        TO CO-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 123
* EL6501.cbl
  6441
  6442     MOVE 'CO'                   TO CO-RECORD-ID
  6443     MOVE 'A'                    TO CO-TYPE.
  6444     MOVE AM-NAME                TO CO-ACCT-NAME.
  6445     MOVE AM-PERSON              TO CO-MAIL-NAME.
  6446     MOVE AM-ADDRS               TO CO-ADDR-1.
  6447*    MOVE AM-CITY                TO CO-ADDR-3.
  6448     MOVE AM-ADDR-CITY           TO CO-ADDR-CITY
  6449     MOVE AM-ADDR-STATE          TO CO-ADDR-STATE
  6450     MOVE AM-ZIP                 TO CO-ZIP.
  6451     MOVE AM-CSR-CODE            TO CO-CSR-CODE.
  6452     MOVE AM-TEL-NO              TO CO-TELEPHONE.
  6453
  6454     IF PI-COMPANY-ID = 'NCL'
  6455         MOVE AM-ID-NO           TO  WS-SOC-SEC-WORK
  6456         IF WS-SS-TYPE = 'C' OR 'P' OR 'S' OR 'T' OR
  6457                         'X' OR 'I'
  6458             MOVE WS-SS-TYPE     TO  CO-TYPE-AGENT
  6459             MOVE WS-SOC-SEC     TO  CO-SOC-SEC
  6460         ELSE
  6461             MOVE SPACE          TO  CO-TYPE-AGENT
  6462             MOVE AM-ID-NO       TO  CO-SOC-SEC
  6463     ELSE
  6464         MOVE AM-ID-NO           TO CO-SOC-SEC.
  6465
  6466     IF AM-REMIT-TO NOT = ZERO
  6467         MOVE AM-AGT (AM-REMIT-TO) TO CO-RESP-NO
  6468       ELSE
  6469         MOVE AM-ACCOUNT           TO CO-RESP-NO.
  6470
  6471     MOVE +0                      TO AGT-SUB.
  6472
  6473     PERFORM 1600-FIND-C-AGT THRU 1600-EXIT.
  6474
  6475     IF VALID-AGT-SW = 'Y'
  6476         NEXT SENTENCE
  6477     ELSE
  6478         GO TO 1500-EXIT.
  6479
  6480     IF CO-RESP-NO = CO-ACCOUNT
  6481         MOVE 'Y'                  TO CO-BALANCE-CONTROL
  6482     ELSE
  6483         MOVE 'N'                  TO CO-BALANCE-CONTROL.
  6484
  6485     IF PI-AR-PROCESSING
  6486        MOVE 'G'                   TO CO-AR-REPORTING
  6487        MOVE '1'                   TO CO-AR-BAL-LEVEL
  6488        MOVE 'Y'                   TO CO-AR-PULL-CHECK
  6489        MOVE 'Y'                   TO CO-AR-NORMAL-PRINT.
  6490
  6491     IF PI-COMPANY-ID = 'CRI' OR 'HER' OR 'HSL'
  6492        MOVE 'N'                   TO CO-AR-REPORTING.
  6493
  6494     IF PI-COMPANY-ID = 'HER' OR 'HSL'
  6495        MOVE '999999'              TO CO-AR-SUMMARY-CODE.
  6496
  6497     PERFORM 2200-ADD-COMPENSATION-NAME THRU 2200-EXIT.
  6498
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 124
* EL6501.cbl
  6499
  6500* EXEC CICS HANDLE CONDITION
  6501*         DUPREC   (1500-EXIT)
  6502*    END-EXEC.
  6503*    MOVE '"$%                   ! # #00006427' TO DFHEIV0
  6504     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6505     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6506     MOVE X'2320233030303036343237' TO DFHEIV0(25:11)
  6507     CALL 'kxdfhei1' USING DFHEIV0
  6508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6509
  6510
  6511
  6512* EXEC CICS WRITE
  6513*        FROM      (COMPENSATION-MASTER)
  6514*        RIDFLD    (CO-CONTROL-PRIMARY)
  6515*        DATASET   (COMP-FILE-ID)
  6516*    END-EXEC.
  6517     MOVE LENGTH OF
  6518      COMPENSATION-MASTER
  6519       TO DFHEIV11
  6520*    MOVE '&$ L                  ''   #00006431' TO DFHEIV0
  6521     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6522     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6523     MOVE X'2020233030303036343331' TO DFHEIV0(25:11)
  6524     CALL 'kxdfhei1' USING DFHEIV0,
  6525           COMP-FILE-ID,
  6526           COMPENSATION-MASTER,
  6527           DFHEIV11,
  6528           CO-CONTROL-PRIMARY,
  6529           DFHEIV99,
  6530           DFHEIV99
  6531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6532
  6533
  6534 1500-EXIT.
  6535      EXIT.
  6536
  6537 1600-FIND-C-AGT.
  6538     ADD 1 TO  AGT-SUB.
  6539     IF AGT-SUB GREATER 10
  6540         MOVE 'N'                TO  VALID-AGT-SW
  6541         GO TO 1600-EXIT.
  6542
  6543************************************************************
  6544**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  6545************************************************************
  6546
  6547     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F'
  6548         MOVE AM-AGT (AGT-SUB)   TO  CO-ACCOUNT
  6549         MOVE 'Y'                TO  VALID-AGT-SW
  6550         GO TO 1600-EXIT
  6551     ELSE
  6552         GO TO 1600-FIND-C-AGT.
  6553
  6554 1600-EXIT.
  6555     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 125
* EL6501.cbl
  6557 1700-CHANGE-COMP.
  6558     MOVE 'N'                    TO CHANGE-WAS-MADE-SW.
  6559     MOVE PI-COMPANY-CD          TO COMP-COMPANY-CD.
  6560
  6561     IF PI-ZERO-CARRIER
  6562       OR PI-ZERO-CAR-GROUP
  6563         MOVE ZEROS              TO COMP-CARRIER
  6564     ELSE
  6565         MOVE AM-CARRIER         TO COMP-CARRIER.
  6566
  6567     IF PI-ZERO-GROUPING
  6568       OR PI-ZERO-CAR-GROUP
  6569         MOVE ZEROS              TO COMP-GROUPING
  6570     ELSE
  6571         MOVE AM-GROUPING        TO COMP-GROUPING.
  6572
  6573     IF AM-REMIT-TO NOT = ZERO
  6574         MOVE AM-AGT (AM-REMIT-TO)
  6575                                 TO COMP-RESP-NO
  6576     ELSE
  6577         MOVE AM-ACCOUNT         TO COMP-RESP-NO.
  6578
  6579     MOVE ZERO                   TO AGT-SUB.
  6580
  6581     PERFORM 1800-FIND-C-AGT THRU 1899-EXIT.
  6582
  6583     IF VALID-AGT-SW = 'Y'
  6584         NEXT SENTENCE
  6585     ELSE
  6586         GO TO 1799-EXIT.
  6587
  6588     MOVE 'A'                    TO COMP-TYPE.
  6589
  6590
  6591* EXEC CICS HANDLE CONDITION
  6592*         ENDFILE     (1799-EXIT)
  6593*         NOTFND      (1799-EXIT)
  6594*    END-EXEC.
  6595*    MOVE '"$''I                  ! $ #00006493' TO DFHEIV0
  6596     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6597     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6598     MOVE X'2420233030303036343933' TO DFHEIV0(25:11)
  6599     CALL 'kxdfhei1' USING DFHEIV0
  6600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6601
  6602
  6603
  6604* EXEC CICS READ
  6605*        UPDATE
  6606*        DATASET   (COMP-FILE-ID)
  6607*        SET       (ADDRESS OF COMPENSATION-MASTER)
  6608*        RIDFLD    (COMP-KEY)
  6609*    END-EXEC.
  6610*    MOVE '&"S        EU         (   #00006498' TO DFHEIV0
  6611     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6612     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6613     MOVE X'2020233030303036343938' TO DFHEIV0(25:11)
  6614     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 126
* EL6501.cbl
  6615           COMP-FILE-ID,
  6616           DFHEIV20,
  6617           DFHEIV99,
  6618           COMP-KEY,
  6619           DFHEIV99,
  6620           DFHEIV99,
  6621           DFHEIV99
  6622     SET ADDRESS OF COMPENSATION-MASTER TO
  6623         DFHEIV20
  6624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6625
  6626
  6627     IF (ON-LAST-DATE-RANGE)
  6628        IF NAMEL GREATER ZEROS
  6629           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6630           MOVE AM-NAME          TO CO-ACCT-NAME
  6631        END-IF
  6632        IF INCAREL GREATER ZEROS
  6633           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6634           MOVE AM-PERSON        TO CO-MAIL-NAME
  6635        END-IF
  6636        IF ADDR1L GREATER ZEROS
  6637           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6638           MOVE AM-ADDRS         TO CO-ADDR-1
  6639        END-IF
  6640        IF ACITYL  GREATER ZEROS
  6641           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6642           MOVE AM-ADDR-CITY     TO CO-ADDR-CITY
  6643        END-IF
  6644        IF ASTATEL  GREATER ZEROS
  6645           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6646           MOVE AM-ADDR-STATE    TO CO-ADDR-STATE
  6647        END-IF
  6648        IF ZIPL GREATER ZEROS
  6649           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6650           MOVE AM-ZIP           TO CO-ZIP
  6651        END-IF
  6652        IF CSRL GREATER ZEROS
  6653           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6654           MOVE AM-CSR-CODE      TO CO-CSR-CODE
  6655        END-IF
  6656        IF PHONEL GREATER ZEROS
  6657           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6658           MOVE AM-TEL-NO        TO CO-TELEPHONE
  6659        END-IF
  6660        IF TAXNOL GREATER ZEROS
  6661           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6662           MOVE AM-ID-NO         TO CO-SOC-SEC
  6663        END-IF
  6664        IF AUTO-CANCEL-ACCOUNT
  6665           IF CO-BILL-SW = ' '
  6666              MOVE 'B'           TO CO-BILL-SW
  6667              MOVE 'Y'           TO CHANGE-WAS-MADE-SW
  6668           END-IF
  6669        END-IF
  6670     END-IF
  6671
  6672     IF PCONTL > 0
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 127
* EL6501.cbl
  6673         MOVE 'Y'                TO CHANGE-WAS-MADE-SW
  6674         MOVE AM-CONTROL-NAME    TO CO-CONTROL-NAME
  6675     END-IF
  6676
  6677     IF CHANGE-WAS-MADE
  6678         MOVE BIN-CURRENT-SAVE   TO CO-LAST-MAINT-DT
  6679         MOVE PI-PROCESSOR-ID    TO CO-LAST-MAINT-USER
  6680         MOVE EIBTIME            TO CO-LAST-MAINT-HHMMSS.
  6681
  6682     IF NAMEL GREATER THAN ZERO
  6683         PERFORM 2200-ADD-COMPENSATION-NAME THRU 2200-EXIT.
  6684
  6685
  6686* EXEC CICS REWRITE
  6687*        FROM      (COMPENSATION-MASTER)
  6688*        DATASET   (COMP-FILE-ID)
  6689*    END-EXEC.
  6690     MOVE LENGTH OF
  6691      COMPENSATION-MASTER
  6692       TO DFHEIV11
  6693*    MOVE '&& L                  %   #00006563' TO DFHEIV0
  6694     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6695     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6696     MOVE X'2020233030303036353633' TO DFHEIV0(25:11)
  6697     CALL 'kxdfhei1' USING DFHEIV0,
  6698           COMP-FILE-ID,
  6699           COMPENSATION-MASTER,
  6700           DFHEIV11,
  6701           DFHEIV99
  6702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6703
  6704
  6705 1799-EXIT.
  6706     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 128
* EL6501.cbl
  6708 1800-FIND-C-AGT.
  6709     ADD 1                       TO  AGT-SUB.
  6710
  6711     IF AGT-SUB GREATER 10
  6712         MOVE 'N'                TO  VALID-AGT-SW
  6713         GO TO 1899-EXIT.
  6714
  6715************************************************************
  6716**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  6717************************************************************
  6718
  6719     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F'
  6720         MOVE AM-AGT (AGT-SUB)   TO  COMP-ACCOUNT
  6721         MOVE 'Y'                TO  VALID-AGT-SW
  6722         GO TO 1899-EXIT
  6723     ELSE
  6724         GO TO 1800-FIND-C-AGT.
  6725
  6726 1899-EXIT.
  6727     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 129
* EL6501.cbl
  6729 2000-CHANGE-A-RECORD.
  6730     PERFORM 4000-EDITS THRU 4900-EXIT.
  6731
  6732     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6733        EMI-FATAL-CTR    GREATER ZERO
  6734         GO TO 8200-SEND-DATAONLY.
  6735
  6736
  6737* EXEC CICS READ
  6738*        UPDATE
  6739*        DATASET   (ACCT-FILE-ID)
  6740*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6741*        RIDFLD    (PI-ACCT-KEY)
  6742*    END-EXEC.
  6743*    MOVE '&"S        EU         (   #00006599' TO DFHEIV0
  6744     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6745     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6746     MOVE X'2020233030303036353939' TO DFHEIV0(25:11)
  6747     CALL 'kxdfhei1' USING DFHEIV0,
  6748           ACCT-FILE-ID,
  6749           DFHEIV20,
  6750           DFHEIV99,
  6751           PI-ACCT-KEY,
  6752           DFHEIV99,
  6753           DFHEIV99,
  6754           DFHEIV99
  6755     SET ADDRESS OF ACCOUNT-MASTER TO
  6756         DFHEIV20
  6757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6758
  6759
  6760     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  6761
  6762     IF NOT PI-AR-PROCESSING
  6763        GO TO 2075-PROCESS-CHANGE.
  6764
  6765     MOVE AM-AGT (AM-REMIT-TO)   TO SAVE-FIN-RESP.
  6766     MOVE +0                     TO SUB1.
  6767
  6768 2075-PROCESS-CHANGE.
  6769     PERFORM 5000-MOVE-TO-RECORD THRU 5000-EXIT.
  6770
  6771     IF PI-AR-PROCESSING
  6772        PERFORM 5300-UPDATE-REQUEST-FILE THRU 5399-EXIT.
  6773
  6774     IF PI-COMPANY-ID = 'DMD'
  6775     IF AM-ANNIVERSARY-DATE = ZEROS
  6776           MOVE ER-0852             TO EMI-ERROR
  6777           MOVE -1                  TO CONTRL
  6778           MOVE AL-UABON            TO CONTRA
  6779           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6780
  6781     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6782        EMI-FATAL-CTR    GREATER ZERO
  6783         GO TO 8200-SEND-DATAONLY.
  6784
  6785     MOVE +1                     TO AXRF-SUB
  6786                                    COMM-WORK-SUB.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 130
* EL6501.cbl
  6787     PERFORM 6900-READ-AND-CHECK-AXRF THRU 6999-EXIT.
  6788
  6789     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  6790     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  6791     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  6792
  6793     IF ((PI-FST-PAGE)
  6794        AND (PI-TOTAL-LINES = PI-LINE-SELECTED))
  6795                      OR
  6796        ((PI-2ND-PAGE)
  6797        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 8))
  6798                      OR
  6799        ((PI-3RD-PAGE)
  6800        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 16))
  6801                      OR
  6802        ((PI-LST-PAGE)
  6803        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 24))
  6804        SET ON-LAST-DATE-RANGE   TO TRUE
  6805     END-IF
  6806     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6807         NEXT SENTENCE
  6808     ELSE
  6809         IF (ON-LAST-DATE-RANGE)
  6810                          OR
  6811            ((PI-COMPANY-ID = 'CID' OR 'AHL') AND
  6812             (PCONTL > ZERO))
  6813             PERFORM 1700-CHANGE-COMP THRU 1799-EXIT.
  6814
  6815     IF NAMEL GREATER THAN ZERO
  6816         PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  6817
  6818
  6819* EXEC CICS REWRITE
  6820*        FROM      (ACCOUNT-MASTER)
  6821*        DATASET   (ACCT-FILE-ID)
  6822*    END-EXEC.
  6823     MOVE LENGTH OF
  6824      ACCOUNT-MASTER
  6825       TO DFHEIV11
  6826*    MOVE '&& L                  %   #00006664' TO DFHEIV0
  6827     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6828     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6829     MOVE X'2020233030303036363634' TO DFHEIV0(25:11)
  6830     CALL 'kxdfhei1' USING DFHEIV0,
  6831           ACCT-FILE-ID,
  6832           ACCOUNT-MASTER,
  6833           DFHEIV11,
  6834           DFHEIV99
  6835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6836
  6837
  6838     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  6839
  6840     IF CSRL GREATER ZEROS
  6841         GO TO 3500-CHANGE-ALL-CSR.
  6842
  6843     MOVE ER-0000                TO EMI-ERROR.
  6844     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 131
* EL6501.cbl
  6845     MOVE LOW-VALUES             TO EL6501AI.
  6846
  6847     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  6848     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  6849     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  6850
  6851     MOVE ER-0000                TO EMI-ERROR.
  6852     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6853
  6854     MOVE -1                     TO MAINTL.
  6855     MOVE AL-UANON               TO MAINTA.
  6856     GO TO 8100-SEND-INITIAL-MAP.
  6857
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 132
* EL6501.cbl
  6859 2100-ADD-ACCOUNT-NAME.
  6860
  6861* EXEC CICS HANDLE CONDITION
  6862*         DUPREC   (2100-EXIT)
  6863*    END-EXEC.
  6864*    MOVE '"$%                   ! % #00006691' TO DFHEIV0
  6865     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6866     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6867     MOVE X'2520233030303036363931' TO DFHEIV0(25:11)
  6868     CALL 'kxdfhei1' USING DFHEIV0
  6869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6870
  6871
  6872
  6873* EXEC CICS GETMAIN
  6874*         LENGTH   (NAME-REC-LEN)
  6875*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  6876*         INITIMG  (GETMAIN-SPACE)
  6877*    END-EXEC.
  6878*    MOVE ',"IL                  $   #00006695' TO DFHEIV0
  6879     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6880     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6881     MOVE X'2020233030303036363935' TO DFHEIV0(25:11)
  6882     CALL 'kxdfhei1' USING DFHEIV0,
  6883           DFHEIV20,
  6884           NAME-REC-LEN,
  6885           GETMAIN-SPACE
  6886     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  6887         DFHEIV20
  6888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6889
  6890
  6891     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  6892     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  6893     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  6894     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  6895     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  6896     MOVE AM-NAME                TO  NL-NAME.
  6897     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  6898        MOVE NL-NAME (5:26)      TO NL-NAME
  6899     END-IF
  6900     MOVE AM-ADDR-CITY           TO  NL-CITY.
  6901     MOVE AM-ADDR-STATE          TO  NL-ST.
  6902     MOVE 'A'                    TO  NL-RECORD-TYPE.
  6903     MOVE PI-COMPANY-CD          TO  NL-AM-COMPANY-CD.
  6904     MOVE AM-CARRIER             TO  NL-AM-CARRIER.
  6905     MOVE AM-GROUPING            TO  NL-AM-GROUPING.
  6906     MOVE AM-STATE               TO  NL-AM-STATE.
  6907     MOVE AM-ACCOUNT             TO  NL-AM-ACCOUNT.
  6908
  6909
  6910* EXEC CICS WRITE
  6911*        FROM      (NAME-LOOKUP-MASTER)
  6912*        RIDFLD    (NL-CONTROL-PRIMARY)
  6913*        DATASET   (NAME-FILE-ID)
  6914*    END-EXEC.
  6915     MOVE LENGTH OF
  6916      NAME-LOOKUP-MASTER
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 133
* EL6501.cbl
  6917       TO DFHEIV11
  6918*    MOVE '&$ L                  ''   #00006719' TO DFHEIV0
  6919     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6920     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6921     MOVE X'2020233030303036373139' TO DFHEIV0(25:11)
  6922     CALL 'kxdfhei1' USING DFHEIV0,
  6923           NAME-FILE-ID,
  6924           NAME-LOOKUP-MASTER,
  6925           DFHEIV11,
  6926           NL-CONTROL-PRIMARY,
  6927           DFHEIV99,
  6928           DFHEIV99
  6929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6930
  6931
  6932 2100-EXIT.
  6933     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 134
* EL6501.cbl
  6935 2200-ADD-COMPENSATION-NAME.
  6936
  6937* EXEC CICS HANDLE CONDITION
  6938*         DUPREC   (2200-EXIT)
  6939*    END-EXEC.
  6940*    MOVE '"$%                   ! & #00006729' TO DFHEIV0
  6941     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6942     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6943     MOVE X'2620233030303036373239' TO DFHEIV0(25:11)
  6944     CALL 'kxdfhei1' USING DFHEIV0
  6945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6946
  6947
  6948
  6949* EXEC CICS GETMAIN
  6950*         LENGTH   (NAME-REC-LEN)
  6951*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  6952*         INITIMG  (GETMAIN-SPACE)
  6953*    END-EXEC.
  6954*    MOVE ',"IL                  $   #00006733' TO DFHEIV0
  6955     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6956     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6957     MOVE X'2020233030303036373333' TO DFHEIV0(25:11)
  6958     CALL 'kxdfhei1' USING DFHEIV0,
  6959           DFHEIV20,
  6960           NAME-REC-LEN,
  6961           GETMAIN-SPACE
  6962     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  6963         DFHEIV20
  6964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6965
  6966
  6967     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  6968     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  6969     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  6970     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  6971     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  6972     MOVE CO-ACCT-NAME           TO  NL-NAME.
  6973     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  6974        MOVE NL-NAME (5:26)      TO NL-NAME
  6975     END-IF
  6976     MOVE CO-ADDR-CITY           TO  NL-CITY.
  6977     MOVE CO-ADDR-STATE          TO  NL-ST
  6978     MOVE 'C'                    TO  NL-RECORD-TYPE.
  6979     MOVE PI-COMPANY-CD          TO  NL-CO-COMPANY-CD.
  6980     MOVE CO-CARRIER             TO  NL-CO-CARRIER.
  6981     MOVE CO-GROUPING            TO  NL-CO-GROUPING.
  6982     MOVE CO-RESP-NO             TO  NL-CO-RESP-NO.
  6983     MOVE CO-ACCOUNT             TO  NL-CO-ACCOUNT.
  6984     MOVE CO-TYPE                TO  NL-CO-TYPE.
  6985
  6986
  6987* EXEC CICS WRITE
  6988*        FROM      (NAME-LOOKUP-MASTER)
  6989*        RIDFLD    (NL-CONTROL-PRIMARY)
  6990*        DATASET   (NAME-FILE-ID)
  6991*    END-EXEC.
  6992     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 135
* EL6501.cbl
  6993      NAME-LOOKUP-MASTER
  6994       TO DFHEIV11
  6995*    MOVE '&$ L                  ''   #00006758' TO DFHEIV0
  6996     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6997     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6998     MOVE X'2020233030303036373538' TO DFHEIV0(25:11)
  6999     CALL 'kxdfhei1' USING DFHEIV0,
  7000           NAME-FILE-ID,
  7001           NAME-LOOKUP-MASTER,
  7002           DFHEIV11,
  7003           NL-CONTROL-PRIMARY,
  7004           DFHEIV99,
  7005           DFHEIV99
  7006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7007
  7008
  7009 2200-EXIT.
  7010     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 136
* EL6501.cbl
  7012 3000-CHANGE-ALL-RECORDS.
  7013     MOVE LOW-VALUES             TO PI-ACCT-REST-OF-EXP.
  7014     MOVE PI-ACCT-KEY            TO WS-KEY-SAVE.
  7015
  7016
  7017* EXEC CICS HANDLE CONDITION
  7018*         ENDFILE     (3030-END-FILE)
  7019*    END-EXEC.
  7020*    MOVE '"$''                   ! '' #00006771' TO DFHEIV0
  7021     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7022     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7023     MOVE X'2720233030303036373731' TO DFHEIV0(25:11)
  7024     CALL 'kxdfhei1' USING DFHEIV0
  7025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7026
  7027
  7028     PERFORM 6300-STARTBR THRU 6300-EXIT.
  7029
  7030 3010-READ-NEXT.
  7031     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7032
  7033     IF PI-ACCT-CCGSA-KEY NOT = WS-ACCT-CCGSA-KEY
  7034        GO TO 3030-END-FILE.
  7035
  7036
  7037* EXEC CICS ENDBR
  7038*        DATASET   (ACCT-FILE-ID)
  7039*    END-EXEC.
  7040     MOVE 0
  7041       TO DFHEIV11
  7042*    MOVE '&2                    $   #00006783' TO DFHEIV0
  7043     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7044     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7045     MOVE X'2020233030303036373833' TO DFHEIV0(25:11)
  7046     CALL 'kxdfhei1' USING DFHEIV0,
  7047           ACCT-FILE-ID,
  7048           DFHEIV11,
  7049           DFHEIV99
  7050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7051
  7052     ADD +1                      TO WS-CHANGE-ALL-CNT
  7053
  7054* EXEC CICS READ
  7055*        UPDATE
  7056*        DATASET   (ACCT-FILE-ID)
  7057*        SET       (ADDRESS OF ACCOUNT-MASTER)
  7058*        RIDFLD    (WS-KEY-SAVE)
  7059*    END-EXEC.
  7060*    MOVE '&"S        EU         (   #00006787' TO DFHEIV0
  7061     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7062     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7063     MOVE X'2020233030303036373837' TO DFHEIV0(25:11)
  7064     CALL 'kxdfhei1' USING DFHEIV0,
  7065           ACCT-FILE-ID,
  7066           DFHEIV20,
  7067           DFHEIV99,
  7068           WS-KEY-SAVE,
  7069           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 137
* EL6501.cbl
  7070           DFHEIV99,
  7071           DFHEIV99
  7072     SET ADDRESS OF ACCOUNT-MASTER TO
  7073         DFHEIV20
  7074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7075
  7076
  7077     IF NAMEL    GREATER THAN ZERO  OR
  7078        INCAREL  GREATER THAN ZERO  OR
  7079        ADDR1L   GREATER THAN ZERO  OR
  7080        ACITYL   GREATER THAN ZERO  OR
  7081        ASTATEL  GREATER THAN ZERO  OR
  7082        ZIPL     GREATER THAN ZERO  OR
  7083        CLPTOLPL GREATER THAN ZERO  OR
  7084        PHONEL   GREATER THAN ZERO
  7085         MOVE '*'                TO AM-PROFILE-CHANGE-SWITCH.
  7086
  7087     IF STATUSL > ZERO
  7088        EVALUATE TRUE
  7089           WHEN STATUSI = 'A'
  7090              MOVE '0'           TO AM-STATUS
  7091           WHEN STATUSI = 'I'
  7092              MOVE '1'           TO AM-STATUS
  7093           WHEN (STATUSI = 'C')
  7094              AND (AM-STATUS NOT = '3' AND 'C')
  7095              MOVE '3'           TO AM-STATUS
  7096              SET AUTO-CANCEL-ACCOUNT
  7097                                 TO TRUE
  7098           WHEN (STATUSI = 'C')
  7099              MOVE '3'           TO AM-STATUS
  7100           WHEN STATUSI = 'F'
  7101              MOVE '4'           TO AM-STATUS
  7102           WHEN STATUSI = 'S'
  7103              MOVE '5'           TO AM-STATUS
  7104           WHEN STATUSI = 'D'
  7105              MOVE '6'           TO AM-STATUS
  7106           WHEN STATUSI = 'L'
  7107              MOVE '7'           TO AM-STATUS
  7108           WHEN STATUSI = 'R'
  7109              MOVE '8'           TO AM-STATUS
  7110           WHEN STATUSI = 'P'
  7111              MOVE '9'           TO AM-STATUS
  7112           WHEN OTHER
  7113              MOVE -1            TO STATUSL
  7114              MOVE AL-UABON      TO STATUSA
  7115              MOVE ER-2153       TO EMI-ERROR
  7116              PERFORM 9900-ERROR-FORMAT
  7117                                 THRU 9900-EXIT
  7118        END-EVALUATE
  7119     END-IF
  7120*    IF STATUSL > ZERO
  7121*       IF STATUSI = 'A'
  7122*          MOVE '0'              TO AM-STATUS
  7123*       ELSE
  7124*          IF STATUSI = 'I'
  7125*             MOVE '1'           TO AM-STATUS
  7126*          ELSE
  7127*             IF STATUSI = 'C'
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 138
* EL6501.cbl
  7128*                IF AM-STATUS NOT = '3' AND 'C'
  7129*                   SET AUTO-CANCEL-ACCOUNT
  7130*                                TO TRUE
  7131*                END-IF
  7132*                MOVE '3'        TO AM-STATUS
  7133*             ELSE
  7134*                IF STATUSI = 'F'
  7135*                   MOVE '4'     TO AM-STATUS
  7136*                ELSE
  7137*                   MOVE -1         TO STATUSL
  7138*                   MOVE AL-UABON   TO STATUSA
  7139*                   MOVE ER-2153    TO EMI-ERROR
  7140*                   PERFORM 9900-ERROR-FORMAT
  7141*                                THRU 9900-EXIT
  7142*                END-IF
  7143*             END-IF
  7144*          END-IF
  7145*       END-IF
  7146*    END-IF
  7147
  7148     IF CSRL GREATER ZERO
  7149        MOVE CSRI                TO AM-CSR-CODE.
  7150     IF NAMEL GREATER THAN ZERO
  7151        MOVE NAMEI               TO AM-NAME.
  7152     IF PCONTL GREATER THAN ZERO
  7153        MOVE PCONTI              TO AM-CONTROL-NAME
  7154     END-IF
  7155     IF INCAREL GREATER ZEROS
  7156        MOVE INCAREI             TO AM-PERSON.
  7157     IF ADDR1L GREATER ZEROS
  7158        MOVE ADDR1I              TO AM-ADDRS.
  7159     IF ACITYL GREATER ZEROS
  7160        MOVE ACITYI             TO AM-ADDR-CITY.
  7161     IF ASTATEL GREATER ZEROS
  7162        MOVE ASTATEI            TO AM-ADDR-STATE.
  7163     IF ZIPL NOT GREATER ZEROS
  7164         GO TO 3015-CONT-CHANGING.
  7165
  7166     MOVE ZIPI                   TO WS-ZIP-CODE.
  7167
  7168     IF WS-CANADIAN-ZIP
  7169         IF WS-ZIP-4 = SPACE  OR  '-'
  7170             MOVE WS-ZIP-CAN-2-POST1  TO AM-CAN-POSTAL-1
  7171             MOVE WS-ZIP-CAN-2-POST2  TO AM-CAN-POSTAL-2
  7172         ELSE
  7173             MOVE WS-ZIP-CAN-1-POST1  TO AM-CAN-POSTAL-1
  7174             MOVE WS-ZIP-CAN-1-POST2  TO AM-CAN-POSTAL-2
  7175     ELSE
  7176         IF WS-ZIP-6 = SPACE  OR  '-'
  7177             MOVE WS-ZIP-AM-2-CODE    TO AM-ZIP-PRIME
  7178             MOVE WS-ZIP-AM-2-PLUS4   TO AM-ZIP-PLUS4
  7179         ELSE
  7180             MOVE WS-ZIP-AM-1-CODE    TO AM-ZIP-PRIME
  7181             MOVE WS-ZIP-AM-1-PLUS4   TO AM-ZIP-PLUS4.
  7182
  7183 3015-CONT-CHANGING.
  7184
  7185     IF CLPTOLPL GREATER ZEROS
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 139
* EL6501.cbl
  7186
  7187* EXEC CICS BIF
  7188*            DEEDIT
  7189*            FIELD    (CLPTOLPI)
  7190*            LENGTH   (6)
  7191*        END-EXEC
  7192     MOVE 6
  7193       TO DFHEIV11
  7194*    MOVE '@"L                   #   #00006903' TO DFHEIV0
  7195     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7196     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7197     MOVE X'2020233030303036393033' TO DFHEIV0(25:11)
  7198     CALL 'kxdfhei1' USING DFHEIV0,
  7199           CLPTOLPI,
  7200           DFHEIV11
  7201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7202         IF CLPTOLPI NUMERIC
  7203             MOVE CLPTOLPI            TO AM-CLP-TOL-PCT
  7204         ELSE
  7205             MOVE -1                  TO CLPTOLPL
  7206             MOVE AL-UNBON            TO CLPTOLPA
  7207             MOVE ER-1778             TO EMI-ERROR
  7208             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7209         END-IF
  7210     END-IF
  7211
  7212     IF LCOMML > ZEROS
  7213
  7214* EXEC CICS BIF
  7215*            DEEDIT
  7216*            FIELD    (LCOMMI)
  7217*            LENGTH   (8)
  7218*        END-EXEC
  7219     MOVE 8
  7220       TO DFHEIV11
  7221*    MOVE '@"L                   #   #00006919' TO DFHEIV0
  7222     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7223     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7224     MOVE X'2020233030303036393139' TO DFHEIV0(25:11)
  7225     CALL 'kxdfhei1' USING DFHEIV0,
  7226           LCOMMI,
  7227           DFHEIV11
  7228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7229         IF LCOMMI NUMERIC
  7230            MOVE LCOMMI          TO AM-SPP-LEASE-COMM
  7231         ELSE
  7232            MOVE -1              TO LCOMML
  7233            MOVE AL-UNBON        TO LCOMMA
  7234            MOVE ER-1778         TO EMI-ERROR
  7235            PERFORM 9900-ERROR-FORMAT
  7236                                 THRU 9900-EXIT
  7237         END-IF
  7238     END-IF
  7239
  7240     IF PHONEL GREATER ZEROS
  7241        MOVE PHONEI              TO DEEDIT-FIELD
  7242        PERFORM 8600-DEEDIT
  7243        MOVE DEEDIT-FIELD-V0     TO WS-PHONE-NUM
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 140
* EL6501.cbl
  7244        MOVE WS-PH1              TO AM-AREA-CODE
  7245        MOVE WS-PH2              TO AM-TEL-PRE
  7246        MOVE WS-PH3              TO AM-TEL-NBR.
  7247
  7248*    IF PSILFFL GREATER +0
  7249*       MOVE PSILFFI             TO DEEDIT-FIELD
  7250*       PERFORM 8600-DEEDIT
  7251*       IF DEEDIT-FIELD NUMERIC
  7252*          MOVE DEEDIT-FIELD-V5  TO AM-LF-PSI-FACTOR.
  7253*
  7254*    IF PSIAHFL GREATER +0
  7255*       MOVE PSIAHFI             TO DEEDIT-FIELD
  7256*       PERFORM 8600-DEEDIT
  7257*       IF DEEDIT-FIELD NUMERIC
  7258*          MOVE DEEDIT-FIELD-V5  TO AM-AH-PSI-FACTOR.
  7259
  7260     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  7261     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  7262     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  7263
  7264     IF ((PI-FST-PAGE)
  7265        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT))
  7266                      OR
  7267        ((PI-2ND-PAGE)
  7268        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 8))
  7269                      OR
  7270        ((PI-3RD-PAGE)
  7271        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 16))
  7272                      OR
  7273        ((PI-LST-PAGE)
  7274        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 24))
  7275        SET ON-LAST-DATE-RANGE   TO TRUE
  7276     END-IF
  7277*    IF ((PI-FST-PAGE)
  7278*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED))
  7279*                     OR
  7280*       ((PI-2ND-PAGE)
  7281*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 8))
  7282*                     OR
  7283*       ((PI-3RD-PAGE)
  7284*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 16))
  7285*                     OR
  7286*       ((PI-LST-PAGE)
  7287*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 24))
  7288*       SET ON-LAST-DATE-RANGE   TO TRUE
  7289*    END-IF
  7290     MOVE PI-PAGE-NUMBER TO WS-PAGE-NUMBER
  7291     MOVE PI-TOTAL-LINES TO WS-TOTAL-LINES
  7292     MOVE PI-LINE-SELECTED TO WS-LINE-SELECTED
  7293*    EXEC CICS DELAY
  7294*       INTERVAL (WS-DELAY-INT)
  7295*    END-EXEC
  7296     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7297        CONTINUE
  7298     ELSE
  7299        IF (ON-LAST-DATE-RANGE)
  7300                   OR
  7301           ((PI-COMPANY-ID = 'CID' OR 'AHL') AND
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 141
* EL6501.cbl
  7302           (PCONTL > ZERO))
  7303           PERFORM 1700-CHANGE-COMP
  7304                                 THRU 1799-EXIT
  7305        END-IF
  7306     END-IF
  7307
  7308     IF NAMEL GREATER THAN ZERO
  7309         PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  7310
  7311
  7312* EXEC CICS REWRITE
  7313*        FROM      (ACCOUNT-MASTER)
  7314*        DATASET   (ACCT-FILE-ID)
  7315*    END-EXEC.
  7316     MOVE LENGTH OF
  7317      ACCOUNT-MASTER
  7318       TO DFHEIV11
  7319*    MOVE '&& L                  %   #00007006' TO DFHEIV0
  7320     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7321     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7322     MOVE X'2020233030303037303036' TO DFHEIV0(25:11)
  7323     CALL 'kxdfhei1' USING DFHEIV0,
  7324           ACCT-FILE-ID,
  7325           ACCOUNT-MASTER,
  7326           DFHEIV11,
  7327           DFHEIV99
  7328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7329
  7330
  7331     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  7332     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7333
  7334     GO TO 3010-READ-NEXT.
  7335
  7336 3030-END-FILE.
  7337     IF BROWSE-STARTED
  7338        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7339
  7340     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  7341
  7342     IF AUTO-CANCEL-ACCOUNT
  7343
  7344* EXEC CICS GETMAIN
  7345*          LENGTH   (ERACNT-REC-LEN)
  7346*          SET      (ADDRESS OF NOTE-FILE)
  7347*          INITIMG  (GETMAIN-SPACE)
  7348*          RESP     (WS-RESPONSE)
  7349*       END-EXEC
  7350*    MOVE ',"IL                  $  N#00007023' TO DFHEIV0
  7351     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7352     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7353     MOVE X'204E233030303037303233' TO DFHEIV0(25:11)
  7354     CALL 'kxdfhei1' USING DFHEIV0,
  7355           DFHEIV20,
  7356           ERACNT-REC-LEN,
  7357           GETMAIN-SPACE
  7358     SET ADDRESS OF NOTE-FILE TO
  7359         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 142
* EL6501.cbl
  7360     MOVE EIBRESP  TO WS-RESPONSE
  7361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7362        MOVE PI-ACCT-CCGSA-KEY   TO NT-CONTROL-PRIMARY
  7363        MOVE '1'                 TO NT-RECORD-TYPE
  7364        MOVE +1                  TO NT-LINE-SEQUENCE
  7365        MOVE SAVE-BIN-DATE       TO NT-LAST-MAINT-DT
  7366        MOVE PI-PROCESSOR-ID     TO NT-LAST-MAINT-BY
  7367        MOVE EIBTIME             TO NT-LAST-MAINT-HHMMSS
  7368        MOVE 'CANCELLED DUE TO LOW PRODUCTION'
  7369                                 TO NT-NOTE-LINE
  7370        PERFORM WITH TEST AFTER UNTIL
  7371           (NOT RESP-DUPKEY)
  7372           AND (NOT RESP-DUPREC)
  7373
  7374* EXEC CICS WRITE
  7375*             FROM      (NOTE-FILE)
  7376*             RIDFLD    (NT-CONTROL-PRIMARY)
  7377*             DATASET   (ERACNT-FILE-ID)
  7378*             RESP      (WS-RESPONSE)
  7379*          END-EXEC
  7380     MOVE LENGTH OF
  7381      NOTE-FILE
  7382       TO DFHEIV11
  7383*    MOVE '&$ L                  ''  N#00007040' TO DFHEIV0
  7384     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7385     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7386     MOVE X'204E233030303037303430' TO DFHEIV0(25:11)
  7387     CALL 'kxdfhei1' USING DFHEIV0,
  7388           ERACNT-FILE-ID,
  7389           NOTE-FILE,
  7390           DFHEIV11,
  7391           NT-CONTROL-PRIMARY,
  7392           DFHEIV99,
  7393           DFHEIV99
  7394     MOVE EIBRESP  TO WS-RESPONSE
  7395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7396           IF RESP-DUPKEY OR RESP-DUPREC
  7397              ADD +1             TO NT-LINE-SEQUENCE
  7398           END-IF
  7399        END-PERFORM
  7400     END-IF
  7401     IF NOT EMI-NO-ERRORS
  7402         GO TO 8200-SEND-DATAONLY.
  7403
  7404     MOVE -1                     TO NAMEL.
  7405     MOVE ER-0000                TO EMI-ERROR.
  7406     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7407     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 143
* EL6501.cbl
  7409 3500-CHANGE-ALL-CSR.
  7410     MOVE PI-ACCT-KEY            TO WS-KEY-SAVE.
  7411     MOVE LOW-VALUES             TO WS-ACCT-EXP-DT
  7412                                    WS-ACCT-REST-OF-EXP.
  7413
  7414
  7415* EXEC CICS HANDLE CONDITION
  7416*         ENDFILE     (3530-END-FILE)
  7417*    END-EXEC.
  7418*    MOVE '"$''                   ! ( #00007064' TO DFHEIV0
  7419     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7420     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7421     MOVE X'2820233030303037303634' TO DFHEIV0(25:11)
  7422     CALL 'kxdfhei1' USING DFHEIV0
  7423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7424
  7425
  7426     PERFORM 6300-STARTBR THRU 6300-EXIT.
  7427
  7428 3510-READ-NEXT.
  7429     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7430
  7431     IF PI-ACCT-CCGSA-KEY NOT = WS-ACCT-CCGSA-KEY
  7432        GO TO 3530-END-FILE.
  7433
  7434
  7435* EXEC CICS ENDBR
  7436*        DATASET   (ACCT-FILE-ID)
  7437*    END-EXEC.
  7438     MOVE 0
  7439       TO DFHEIV11
  7440*    MOVE '&2                    $   #00007076' TO DFHEIV0
  7441     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7442     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7443     MOVE X'2020233030303037303736' TO DFHEIV0(25:11)
  7444     CALL 'kxdfhei1' USING DFHEIV0,
  7445           ACCT-FILE-ID,
  7446           DFHEIV11,
  7447           DFHEIV99
  7448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7449
  7450
  7451
  7452* EXEC CICS READ
  7453*        UPDATE
  7454*        DATASET   (ACCT-FILE-ID)
  7455*        SET       (ADDRESS OF ACCOUNT-MASTER)
  7456*        RIDFLD    (WS-KEY-SAVE)
  7457*    END-EXEC.
  7458*    MOVE '&"S        EU         (   #00007080' TO DFHEIV0
  7459     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7460     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7461     MOVE X'2020233030303037303830' TO DFHEIV0(25:11)
  7462     CALL 'kxdfhei1' USING DFHEIV0,
  7463           ACCT-FILE-ID,
  7464           DFHEIV20,
  7465           DFHEIV99,
  7466           WS-KEY-SAVE,
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 144
* EL6501.cbl
  7467           DFHEIV99,
  7468           DFHEIV99,
  7469           DFHEIV99
  7470     SET ADDRESS OF ACCOUNT-MASTER TO
  7471         DFHEIV20
  7472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7473
  7474
  7475     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  7476     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  7477     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  7478
  7479     MOVE CSRI                   TO AM-CSR-CODE.
  7480
  7481
  7482* EXEC CICS REWRITE
  7483*        FROM      (ACCOUNT-MASTER)
  7484*        DATASET   (ACCT-FILE-ID)
  7485*    END-EXEC.
  7486     MOVE LENGTH OF
  7487      ACCOUNT-MASTER
  7488       TO DFHEIV11
  7489*    MOVE '&& L                  %   #00007093' TO DFHEIV0
  7490     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7491     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7492     MOVE X'2020233030303037303933' TO DFHEIV0(25:11)
  7493     CALL 'kxdfhei1' USING DFHEIV0,
  7494           ACCT-FILE-ID,
  7495           ACCOUNT-MASTER,
  7496           DFHEIV11,
  7497           DFHEIV99
  7498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7499
  7500
  7501     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  7502     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7503
  7504     GO TO 3510-READ-NEXT.
  7505
  7506 3530-END-FILE.
  7507     IF BROWSE-STARTED
  7508        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7509
  7510     MOVE ER-4009                TO EMI-ERROR.
  7511     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7512     MOVE LOW-VALUES             TO EL6501AI.
  7513
  7514     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  7515     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  7516     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  7517
  7518     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  7519
  7520     MOVE -1                     TO MAINTL.
  7521     MOVE AL-UANON               TO MAINTA.
  7522     GO TO 8100-SEND-INITIAL-MAP.
  7523
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 145
* EL6501.cbl
  7525 4000-EDITS.
  7526     IF PI-COMPANY-ID = 'NCL'
  7527      IF MAINTI = 'A' OR 'C'
  7528        IF CSRL GREATER ZEROS
  7529            PERFORM 8050-USER-REC-READ THRU 8060-EXIT
  7530          ELSE
  7531            IF MAINTI = 'A'
  7532                MOVE ER-1883         TO EMI-ERROR
  7533                MOVE -1              TO CSRL
  7534                MOVE AL-UABON        TO CSRA
  7535                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7536
  7537     IF PI-COMPANY-ID  =  'AIG' OR 'AUK'
  7538        IF NAMEL NOT GREATER ZEROS
  7539           IF MAINTI = 'C'
  7540              GO TO 4070-CHECK-STATUS
  7541           ELSE
  7542              MOVE -1               TO  NAMEL
  7543              MOVE AL-UABON         TO  NAMEA
  7544              MOVE ER-2045          TO  EMI-ERROR
  7545              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  7546        ELSE
  7547            GO TO 4065-CHECK-ASSOCIATES.
  7548
  7549     IF TYPEL NOT GREATER ZEROS
  7550        IF MAINTI = 'C'
  7551           GO TO 4050-CONTINUE
  7552        ELSE
  7553           GO TO 4020-BUS-TYPE-ERROR.
  7554
  7555     IF TYPEI NOT NUMERIC
  7556        GO TO 4020-BUS-TYPE-ERROR
  7557     ELSE
  7558        IF TYPEI LESS 1 OR GREATER 99
  7559           GO TO 4020-BUS-TYPE-ERROR.
  7560
  7561     MOVE SPACES                 TO ELCNTL-KEY.
  7562
  7563     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  7564     MOVE TYPEI                  TO CNTL-BUS-TYPE.
  7565     MOVE '8'                    TO CNTL-REC-TYPE.
  7566     MOVE +0                     TO CNTL-SEQ-NO.
  7567
  7568
  7569* EXEC CICS HANDLE CONDITION
  7570*        NOTFND   (4020-BUS-TYPE-ERROR)
  7571*    END-EXEC.
  7572*    MOVE '"$I                   ! ) #00007165' TO DFHEIV0
  7573     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7574     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7575     MOVE X'2920233030303037313635' TO DFHEIV0(25:11)
  7576     CALL 'kxdfhei1' USING DFHEIV0
  7577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7578
  7579
  7580
  7581* EXEC CICS READ
  7582*        GTEQ
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 146
* EL6501.cbl
  7583*        DATASET   (CNTL-FILE-ID)
  7584*        SET       (ADDRESS OF CONTROL-FILE)
  7585*        RIDFLD    (ELCNTL-KEY)
  7586*    END-EXEC.
  7587*    MOVE '&"S        G          (   #00007169' TO DFHEIV0
  7588     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7589     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7590     MOVE X'2020233030303037313639' TO DFHEIV0(25:11)
  7591     CALL 'kxdfhei1' USING DFHEIV0,
  7592           CNTL-FILE-ID,
  7593           DFHEIV20,
  7594           DFHEIV99,
  7595           ELCNTL-KEY,
  7596           DFHEIV99,
  7597           DFHEIV99,
  7598           DFHEIV99
  7599     SET ADDRESS OF CONTROL-FILE TO
  7600         DFHEIV20
  7601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7602
  7603
  7604     IF TYPEI LESS 21
  7605        MOVE TYPEI               TO WS-BUS-ENTRY
  7606     ELSE
  7607        DIVIDE TYPEI BY 20
  7608            GIVING WS-BUS-TYPE REMAINDER WS-BUS-ENTRY
  7609        IF WS-BUS-ENTRY = ZEROS
  7610           MOVE 20               TO WS-BUS-ENTRY.
  7611
  7612     IF CF-BUSINESS-TITLE (WS-BUS-ENTRY) NOT = SPACES
  7613        GO TO 4050-CONTINUE.
  7614
  7615 4020-BUS-TYPE-ERROR.
  7616     MOVE -1                     TO TYPEL.
  7617     MOVE AL-UNBON               TO TYPEA.
  7618     MOVE ER-2178                TO EMI-ERROR.
  7619     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7620
  7621 4050-CONTINUE.
  7622     IF ASTATEL > 0
  7623        MOVE SPACES                 TO  ELCNTL-KEY
  7624        MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID
  7625        MOVE '3'                    TO  CNTL-REC-TYPE
  7626        MOVE ASTATEI                TO  CNTL-ACCESS (1:2)
  7627        MOVE +0                     TO  CNTL-SEQ-NO
  7628
  7629* EXEC CICS  READ
  7630*           DATASET  ('ELCNTL')
  7631*           SET      (ADDRESS OF CONTROL-FILE)
  7632*           RIDFLD   (ELCNTL-KEY)
  7633*           RESP     (WS-RESPONSE)
  7634*       END-EXEC
  7635     MOVE 'ELCNTL' TO DFHEIV1
  7636*    MOVE '&"S        E          (  N#00007200' TO DFHEIV0
  7637     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7638     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7639     MOVE X'204E233030303037323030' TO DFHEIV0(25:11)
  7640     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 147
* EL6501.cbl
  7641           DFHEIV1,
  7642           DFHEIV20,
  7643           DFHEIV99,
  7644           ELCNTL-KEY,
  7645           DFHEIV99,
  7646           DFHEIV99,
  7647           DFHEIV99
  7648     SET ADDRESS OF CONTROL-FILE TO
  7649         DFHEIV20
  7650     MOVE EIBRESP  TO WS-RESPONSE
  7651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7652        IF NOT RESP-NORMAL
  7653           MOVE ER-0144                TO  EMI-ERROR
  7654           MOVE -1                     TO  ASTATEL
  7655           MOVE AL-UABON               TO  ASTATEA
  7656           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7657        END-IF
  7658     ELSE
  7659        IF MAINTI = 'A'
  7660           MOVE ER-0144                TO  EMI-ERROR
  7661           MOVE -1                     TO  ASTATEL
  7662           MOVE AL-UABON               TO  ASTATEA
  7663           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7664        END-IF
  7665     END-IF
  7666     IF INDGRPL NOT GREATER ZEROS
  7667        IF MAINTI = 'C'
  7668           GO TO 4070-CHECK-STATUS
  7669        ELSE
  7670           GO TO 4060-IG-ERROR.
  7671
  7672     IF INDGRPI = 'I' OR 'G'
  7673        GO TO 4070-CHECK-STATUS.
  7674
  7675 4060-IG-ERROR.
  7676     MOVE -1                     TO INDGRPL.
  7677     MOVE AL-UABON               TO INDGRPA.
  7678     MOVE ER-2152                TO EMI-ERROR.
  7679     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7680
  7681 4065-CHECK-ASSOCIATES.
  7682     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7683        MOVE  PI-ACCT-ACCOUNT    TO  WS-ACCOUNT-NUM-AREA
  7684        MOVE  NAMEI              TO  WS-NAME-AREA
  7685     ELSE
  7686        GO TO 4070-CHECK-STATUS.
  7687
  7688     IF WS-NAME-1-4  =  WS-ACCT-BRANCH-CD
  7689        NEXT SENTENCE
  7690     ELSE
  7691        MOVE -1                  TO  NAMEL
  7692        MOVE AL-UABON            TO  NAMEA
  7693        MOVE ER-0788             TO  EMI-ERROR
  7694        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7695
  7696 4070-CHECK-STATUS.
  7697     IF STATUSL NOT GREATER ZEROS
  7698        IF MAINTI = 'C'
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 148
* EL6501.cbl
  7699           GO TO 4090-CHECK-STD-AH-TYPE
  7700        ELSE
  7701           MOVE 'A'              TO STATUSI
  7702           MOVE AL-UANON         TO STATUSA
  7703           GO TO 4090-CHECK-STD-AH-TYPE.
  7704
  7705*    IF STATUSI = 'A' OR 'I' OR 'C' OR 'F' OR 'S'
  7706     IF STATUSI = 'A' OR 'I' OR 'C' OR 'F' OR 'S' OR 'D' OR 'L'
  7707                      OR 'R' OR 'P'
  7708        GO TO 4090-CHECK-STD-AH-TYPE.
  7709
  7710 4080-STATUS-ERROR.
  7711     MOVE -1                     TO STATUSL.
  7712     MOVE AL-UABON               TO STATUSA.
  7713     MOVE ER-2153                TO EMI-ERROR.
  7714     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7715
  7716 4090-CHECK-STD-AH-TYPE.
  7717
  7718     IF PI-COMPANY-ID  = 'AIG' OR 'AUK'
  7719         GO TO 4900-EXIT.
  7720
  7721     IF STDBENL NOT GREATER ZEROS
  7722        IF MAINTI = 'C'
  7723*          GO TO 4110-CHECK-REMIT
  7724           GO TO 4100-CHECK-CLPTOLP
  7725        ELSE
  7726           MOVE ZEROS            TO STDBENI
  7727           MOVE AL-UANON         TO STDBENA
  7728*          GO TO 4110-CHECK-REMIT.
  7729           GO TO 4100-CHECK-CLPTOLP.
  7730
  7731     IF STDBENI = SPACES
  7732         MOVE ZEROS               TO STDBENI.
  7733     IF STDBENI = ZEROS
  7734*        GO TO 4110-CHECK-REMIT.
  7735         GO TO 4100-CHECK-CLPTOLP.
  7736
  7737     MOVE STDBENI                TO WS-EDIT-BEN-CODE.
  7738     IF INVALID-BENEFIT-CODE
  7739        GO TO 4099-STD-BEN-ERROR.
  7740
  7741     MOVE SPACES                 TO ELCNTL-KEY.
  7742
  7743     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  7744     MOVE STDBENI                TO CNTL-BEN-TYPE.
  7745     MOVE '5'                    TO CNTL-REC-TYPE.
  7746     MOVE +0                     TO CNTL-SEQ-NO.
  7747
  7748
  7749* EXEC CICS HANDLE CONDITION
  7750*        NOTFND   (4099-STD-BEN-ERROR)
  7751*    END-EXEC.
  7752*    MOVE '"$I                   ! * #00007302' TO DFHEIV0
  7753     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7754     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7755     MOVE X'2A20233030303037333032' TO DFHEIV0(25:11)
  7756     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 149
* EL6501.cbl
  7757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7758
  7759
  7760
  7761* EXEC CICS READ
  7762*        GTEQ
  7763*        DATASET   (CNTL-FILE-ID)
  7764*        SET       (ADDRESS OF CONTROL-FILE)
  7765*        RIDFLD    (ELCNTL-KEY)
  7766*    END-EXEC.
  7767*    MOVE '&"S        G          (   #00007306' TO DFHEIV0
  7768     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7769     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7770     MOVE X'2020233030303037333036' TO DFHEIV0(25:11)
  7771     CALL 'kxdfhei1' USING DFHEIV0,
  7772           CNTL-FILE-ID,
  7773           DFHEIV20,
  7774           DFHEIV99,
  7775           ELCNTL-KEY,
  7776           DFHEIV99,
  7777           DFHEIV99,
  7778           DFHEIV99
  7779     SET ADDRESS OF CONTROL-FILE TO
  7780         DFHEIV20
  7781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7782
  7783
  7784     IF CNTL-COMP-ID  = CF-COMPANY-ID  AND
  7785        CNTL-REC-TYPE = CF-RECORD-TYPE
  7786         MOVE 1                  TO SUB
  7787     ELSE
  7788         GO TO 4099-STD-BEN-ERROR.
  7789
  7790 4095-CHECK-BEN-TYPE.
  7791     IF STDBENI = CF-BENEFIT-CODE (SUB)
  7792*       GO TO 4110-CHECK-REMIT.
  7793        GO TO 4100-CHECK-CLPTOLP.
  7794
  7795     IF SUB LESS 8
  7796         ADD 1 TO SUB
  7797         GO TO 4095-CHECK-BEN-TYPE.
  7798
  7799 4099-STD-BEN-ERROR.
  7800     MOVE -1                     TO STDBENL.
  7801     MOVE AL-UABON               TO STDBENA.
  7802     MOVE ER-0250                TO EMI-ERROR.
  7803     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7804
  7805 4100-CHECK-CLPTOLP.
  7806
  7807     IF CLPTOLPL > ZERO
  7808
  7809* EXEC CICS BIF
  7810*            DEEDIT
  7811*            FIELD    (CLPTOLPI)
  7812*            LENGTH   (6)
  7813*        END-EXEC
  7814     MOVE 6
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 150
* EL6501.cbl
  7815       TO DFHEIV11
  7816*    MOVE '@"L                   #   #00007337' TO DFHEIV0
  7817     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7818     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7819     MOVE X'2020233030303037333337' TO DFHEIV0(25:11)
  7820     CALL 'kxdfhei1' USING DFHEIV0,
  7821           CLPTOLPI,
  7822           DFHEIV11
  7823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7824         IF CLPTOLPI NOT NUMERIC
  7825             MOVE ER-1778        TO EMI-ERROR
  7826             MOVE -1             TO CLPTOLPL
  7827             MOVE AL-UNBON       TO CLPTOLPA
  7828             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7829         END-IF
  7830     END-IF.
  7831     IF LCOMML > ZERO
  7832
  7833* EXEC CICS BIF
  7834*            DEEDIT
  7835*            FIELD    (LCOMMI)
  7836*            LENGTH   (8)
  7837*        END-EXEC
  7838     MOVE 8
  7839       TO DFHEIV11
  7840*    MOVE '@"L                   #   #00007350' TO DFHEIV0
  7841     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7842     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7843     MOVE X'2020233030303037333530' TO DFHEIV0(25:11)
  7844     CALL 'kxdfhei1' USING DFHEIV0,
  7845           LCOMMI,
  7846           DFHEIV11
  7847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7848         IF LCOMMI NOT NUMERIC
  7849             MOVE ER-1778        TO EMI-ERROR
  7850             MOVE -1             TO LCOMML
  7851             MOVE AL-UNBON       TO LCOMMA
  7852             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7853         END-IF
  7854     END-IF
  7855     IF MAXMFEEL > ZEROS
  7856
  7857* EXEC CICS BIF DEEDIT
  7858*          FIELD   (MAXMFEEI)
  7859*          LENGTH  (5)
  7860*       END-EXEC
  7861     MOVE 5
  7862       TO DFHEIV11
  7863*    MOVE '@"L                   #   #00007363' TO DFHEIV0
  7864     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7865     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7866     MOVE X'2020233030303037333633' TO DFHEIV0(25:11)
  7867     CALL 'kxdfhei1' USING DFHEIV0,
  7868           MAXMFEEI,
  7869           DFHEIV11
  7870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7871        IF MAXMFEEI NUMERIC
  7872           MOVE MAXMFEEI         TO WS-WORK-FIELD
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 151
* EL6501.cbl
  7873           MOVE WS-WORK-NUM      TO MAXMFEEO
  7874        ELSE
  7875           MOVE -1               TO MAXMFEEL
  7876           MOVE AL-UABON         TO MAXMFEEA
  7877           MOVE ER-7717          TO EMI-ERROR
  7878           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7879        END-IF
  7880     END-IF
  7881     IF (CLPSTL > 0)
  7882         MOVE AL-UANON           TO CLPSTA
  7883        IF (CLPSTI NOT = SPACES)
  7884           MOVE SPACES           TO ELCNTL-KEY
  7885           MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
  7886           MOVE '3'              TO CNTL-REC-TYPE
  7887           MOVE CLPSTI           TO CNTL-ACCESS (1:2)
  7888           MOVE +0               TO CNTL-SEQ-NO
  7889
  7890* EXEC CICS  READ
  7891*              DATASET  ('ELCNTL')
  7892*              SET      (ADDRESS OF CONTROL-FILE)
  7893*              RIDFLD   (ELCNTL-KEY)
  7894*              RESP     (WS-RESPONSE)
  7895*          END-EXEC
  7896     MOVE 'ELCNTL' TO DFHEIV1
  7897*    MOVE '&"S        E          (  N#00007385' TO DFHEIV0
  7898     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7899     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7900     MOVE X'204E233030303037333835' TO DFHEIV0(25:11)
  7901     CALL 'kxdfhei1' USING DFHEIV0,
  7902           DFHEIV1,
  7903           DFHEIV20,
  7904           DFHEIV99,
  7905           ELCNTL-KEY,
  7906           DFHEIV99,
  7907           DFHEIV99,
  7908           DFHEIV99
  7909     SET ADDRESS OF CONTROL-FILE TO
  7910         DFHEIV20
  7911     MOVE EIBRESP  TO WS-RESPONSE
  7912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7913           IF NOT RESP-NORMAL
  7914              MOVE ER-0144       TO EMI-ERROR
  7915              MOVE -1            TO CLPSTL
  7916              MOVE AL-UABON      TO CLPSTA
  7917              PERFORM 9900-ERROR-FORMAT
  7918                                 THRU  9900-EXIT
  7919           END-IF
  7920        ELSE
  7921           MOVE ER-0144          TO EMI-ERROR
  7922           MOVE -1               TO CLPSTL
  7923           MOVE AL-UABON         TO CLPSTA
  7924           PERFORM 9900-ERROR-FORMAT
  7925                                 THRU  9900-EXIT
  7926        END-IF
  7927     END-IF
  7928     IF (PRODCDL > ZEROS)
  7929        and (emi-error not = er-0144)
  7930        if prodcdi = spaces
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 152
* EL6501.cbl
  7931           continue
  7932        else
  7933           move low-values       to erpdef-key
  7934           move pi-company-cd    to erpdef-company-cd
  7935           move clpsti           to erpdef-state
  7936           move prodcdi          to erpdef-prod-cd
  7937           move erpdef-key       to erpdef-key-save
  7938
  7939* exec cics read
  7940*             dataset ('ERPDEF')
  7941*             set     (address of product-master)
  7942*             ridfld  (erpdef-key)
  7943*             length  (6)
  7944*             gteq
  7945*             resp    (ws-response)
  7946*          end-exec
  7947     MOVE 'ERPDEF' TO DFHEIV1
  7948*    MOVE '&"S        G          (  N#00007416' TO DFHEIV0
  7949     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7950     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7951     MOVE X'204E233030303037343136' TO DFHEIV0(25:11)
  7952     CALL 'kxdfhei1' USING DFHEIV0,
  7953           DFHEIV1,
  7954           DFHEIV20,
  7955           DFHEIV99,
  7956           erpdef-key,
  7957           DFHEIV99,
  7958           DFHEIV99,
  7959           DFHEIV99
  7960     SET ADDRESS OF product-master TO
  7961         DFHEIV20
  7962     MOVE EIBRESP  TO ws-response
  7963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7964           if (resp-normal)
  7965              and (pd-control-primary (1:6) =
  7966                           erpdef-key-save (1:6))
  7967              continue
  7968           else
  7969              move er-8156       to emi-error
  7970              MOVE -1            TO PRODCDL
  7971              MOVE AL-UABON      TO PRODCDA
  7972              PERFORM 9900-ERROR-FORMAT
  7973                                 THRU  9900-EXIT
  7974           end-if
  7975        end-if
  7976     end-if
  7977     .
  7978 4110-CHECK-REMIT.
  7979     IF REMITL NOT GREATER ZEROS
  7980        MOVE 1                   TO REMITI
  7981        MOVE AL-UNNON            TO REMITA
  7982        GO TO 4120-REMIT-ERROR.
  7983
  7984     IF (REMITI NOT NUMERIC)  OR
  7985        (REMITI LESS 1 OR GREATER 10)
  7986           GO TO 4120-REMIT-ERROR.
  7987
  7988 4115-CHECK-AGENT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 153
* EL6501.cbl
  7989     SET M-INDEX                 TO REMITI.
  7990
  7991     IF AGENTL (M-INDEX)  NOT GREATER ZEROS
  7992        MOVE ER-2156             TO EMI-ERROR
  7993        GO TO 4120-R-ERROR.
  7994
  7995     GO TO 4130-CHECK-CONTRACT.
  7996
  7997 4120-REMIT-ERROR.
  7998     MOVE ER-2155                TO EMI-ERROR.
  7999
  8000 4120-R-ERROR.
  8001     MOVE -1                     TO REMITL.
  8002     MOVE AL-UABON               TO REMITA.
  8003     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8004
  8005 4130-CHECK-CONTRACT.
  8006     IF CONTRL NOT = ZEROS AND CONTRI NOT = SPACES
  8007        MOVE CONTRI                TO DEEDIT-FIELD
  8008        PERFORM 8600-DEEDIT
  8009        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8010        MOVE '4'                    TO DC-OPTION-CODE
  8011        PERFORM 9700-DATE-LINK
  8012        IF DATE-CONVERSION-ERROR
  8013           MOVE ER-2157             TO EMI-ERROR
  8014           MOVE -1                  TO CONTRL
  8015           MOVE AL-UABON            TO CONTRA
  8016           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8017        ELSE
  8018***  Y2K PROJ 7744
  8019           MOVE DC-GREG-DATE-1-EDIT TO CONTRI
  8020           MOVE AL-UANON            TO CONTRA
  8021           MOVE DC-GREG-DATE-1-YMD  TO WS-ANVR-DT
  8022           MOVE DC-ALPHA-CENTURY    TO WS-ANVR-DT(4:2)
  8023        END-IF
  8024     END-IF.
  8025***  Y2K PROJ 7744
  8026
  8027     IF PI-COMPANY-ID = 'DMD'
  8028       IF PI-MAINT = 'A'
  8029        IF CONTRL = ZERO
  8030           MOVE ER-0852             TO EMI-ERROR
  8031           MOVE -1                  TO CONTRL
  8032           MOVE AL-UABON            TO CONTRA
  8033           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8034
  8035*4131-CHECK-PSI-FACTOR.
  8036*    IF PSILFFL GREATER +0
  8037*       MOVE PSILFFI             TO DEEDIT-FIELD
  8038*       PERFORM 8600-DEEDIT
  8039*       IF DEEDIT-FIELD NUMERIC
  8040*          MOVE DEEDIT-FIELD-V5  TO WS-LIFE-PSI
  8041*                                   PSILFFO
  8042*       ELSE
  8043*          MOVE ER-9999          TO EMI-ERROR
  8044*          MOVE -1               TO PSILFFL
  8045*          MOVE AL-UABON         TO PSILFFA
  8046*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 154
* EL6501.cbl
  8047*
  8048*    IF PSIAHFL GREATER +0
  8049*       MOVE PSIAHFI             TO DEEDIT-FIELD
  8050*       PERFORM 8600-DEEDIT
  8051*       IF DEEDIT-FIELD NUMERIC
  8052*          MOVE DEEDIT-FIELD-V5  TO WS-AH-PSI
  8053*                                   PSIAHFO
  8054*       ELSE
  8055*          MOVE ER-9999          TO EMI-ERROR
  8056*          MOVE -1               TO PSIAHFL
  8057*          MOVE AL-UABON         TO PSIAHFA
  8058*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8059
  8060 4135-CHECK-PREVIOUS-DATES.
  8061     IF PEFFDTEL NOT = ZEROS AND PEFFDTEI NOT = SPACES
  8062        MOVE PEFFDTEI              TO DEEDIT-FIELD
  8063        PERFORM 8600-DEEDIT
  8064        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8065        MOVE '4'                    TO DC-OPTION-CODE
  8066        PERFORM 9700-DATE-LINK
  8067        IF DATE-CONVERSION-ERROR
  8068           MOVE ER-0348             TO EMI-ERROR
  8069           MOVE -1                  TO PEFFDTEL
  8070           MOVE AL-UABON            TO PEFFDTEA
  8071           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8072        ELSE
  8073***  Y2K PROJ 7744
  8074           MOVE DC-GREG-DATE-1-EDIT TO PEFFDTEI
  8075           MOVE AL-UANON            TO PEFFDTEA
  8076           MOVE DC-GREG-DATE-1-YMD  TO WS-PEFF-DT
  8077           MOVE DC-ALPHA-CENTURY    TO WS-PEFF-DT(4:2)
  8078        END-IF
  8079     END-IF.
  8080
  8081     IF PEXPDTEL NOT = ZEROS AND PEXPDTEI NOT = SPACES
  8082        MOVE PEXPDTEI              TO DEEDIT-FIELD
  8083        PERFORM 8600-DEEDIT
  8084        IF DEEDIT-FIELD-V0 NOT LESS 999999
  8085           MOVE '99/99/99'             TO PEXPDTEO
  8086           MOVE 99999999999            TO WS-PEXP-DT
  8087           MOVE AL-UANON               TO PEXPDTEA
  8088        ELSE
  8089           MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8090           MOVE '4'                    TO DC-OPTION-CODE
  8091           PERFORM 9700-DATE-LINK
  8092           IF DATE-CONVERSION-ERROR
  8093              MOVE ER-0454             TO EMI-ERROR
  8094              MOVE -1                  TO PEXPDTEL
  8095              MOVE AL-UABON            TO PEXPDTEA
  8096              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8097           ELSE
  8098              MOVE DC-GREG-DATE-1-EDIT TO PEXPDTEI
  8099              MOVE AL-UANON            TO PEXPDTEA
  8100              MOVE DC-GREG-DATE-1-YMD  TO WS-PEXP-DT
  8101              MOVE DC-ALPHA-CENTURY    TO WS-PEXP-DT(4:2)
  8102           END-IF
  8103        END-IF
  8104     END-IF.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 155
* EL6501.cbl
  8105***  Y2K PROJ 7744
  8106
  8107     IF COMMCALL NOT GREATER ZEROS
  8108         GO TO 4150-CHECK-REINCAL.
  8109
  8110     IF (PI-COMPANY-ID = 'ADL' OR 'DEF') AND
  8111         (EFFCHG-SAVE LESS 841101)       AND
  8112         (COMMCALI = 'Y' OR '1')         AND
  8113         (NOT MODIFY-CAP)
  8114           MOVE -1               TO COMMCALL
  8115           MOVE AL-UABON         TO COMMCALA
  8116           MOVE ER-2189          TO EMI-ERROR
  8117           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8118
  8119     IF COMMCALI = 'Y' OR 'N' OR '1' OR ' '
  8120         GO TO 4150-CHECK-REINCAL.
  8121
  8122 4140-COMMCAL-ERROR.
  8123     MOVE -1                     TO COMMCALL.
  8124     MOVE AL-UABON               TO COMMCALA.
  8125     MOVE ER-2158                TO EMI-ERROR.
  8126     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8127
  8128 4150-CHECK-REINCAL.
  8129     IF REINCALL NOT GREATER ZEROS
  8130         GO TO 4170-CHECK-REINTAB.
  8131
  8132     IF REINCALI = 'Y' OR 'N'
  8133        GO TO 4170-CHECK-REINTAB.
  8134
  8135 4160-REINCAL-ERROR.
  8136     MOVE -1                     TO REINCALL.
  8137     MOVE AL-UABON               TO REINCALA.
  8138     MOVE ER-2179                TO EMI-ERROR.
  8139     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8140
  8141 4170-CHECK-REINTAB.
  8142     IF REINTABL NOT GREATER ZEROS
  8143        IF PI-COMPANY-ID = 'NCL' AND
  8144           MAINTI = 'A'
  8145                MOVE ER-4010         TO EMI-ERROR
  8146                MOVE -1              TO REINTABL
  8147                MOVE AL-UABON        TO REINTABA
  8148                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8149
  8150     IF REINTABL NOT GREATER ZEROS OR REINTABI = SPACES
  8151         GO TO 4410-CHECK-AGENTS.
  8152     IF PI-COMPANY-ID = 'CID'
  8153        IF PI-ACCT-STATE = 'KY'
  8154           IF REINTABI NOT = 'K98' AND 'K99' AND 'KYA'
  8155              MOVE -1            TO REINTABL
  8156              MOVE AL-UABON      TO REINTABA
  8157              MOVE ER-2159       TO EMI-ERROR
  8158              PERFORM 9900-ERROR-FORMAT
  8159                                 THRU 9900-EXIT
  8160           END-IF
  8161        END-IF
  8162     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 156
* EL6501.cbl
  8163     MOVE LOW-VALUES             TO REIN-KEY.
  8164
  8165     MOVE PI-COMPANY-CD          TO REIN-COMP-CD.
  8166     MOVE 'A'                    TO REIN-CODE.
  8167     MOVE REINTABI               TO REIN-TABLE.
  8168
  8169
  8170* EXEC CICS HANDLE CONDITION
  8171*        NOTFND   (4180-REIN-ERROR)
  8172*    END-EXEC.
  8173*    MOVE '"$I                   ! + #00007629' TO DFHEIV0
  8174     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8175     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8176     MOVE X'2B20233030303037363239' TO DFHEIV0(25:11)
  8177     CALL 'kxdfhei1' USING DFHEIV0
  8178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8179
  8180
  8181
  8182* EXEC CICS READ
  8183*        DATASET   (REIN-FILE-ID)
  8184*        SET       (ADDRESS OF REINSURANCE-RECORD)
  8185*        RIDFLD    (REIN-KEY)
  8186*    END-EXEC.
  8187*    MOVE '&"S        E          (   #00007633' TO DFHEIV0
  8188     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8189     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8190     MOVE X'2020233030303037363333' TO DFHEIV0(25:11)
  8191     CALL 'kxdfhei1' USING DFHEIV0,
  8192           REIN-FILE-ID,
  8193           DFHEIV20,
  8194           DFHEIV99,
  8195           REIN-KEY,
  8196           DFHEIV99,
  8197           DFHEIV99,
  8198           DFHEIV99
  8199     SET ADDRESS OF REINSURANCE-RECORD TO
  8200         DFHEIV20
  8201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8202
  8203
  8204     GO TO 4410-CHECK-AGENTS.
  8205
  8206 4180-REIN-ERROR.
  8207     MOVE -1                     TO REINTABL.
  8208     MOVE AL-UABON               TO REINTABA.
  8209     MOVE ER-2615                TO EMI-ERROR.
  8210     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8211
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 157
* EL6501.cbl
  8213 4410-CHECK-AGENTS.
  8214     MOVE PI-COMPANY-CD          TO COMM-COMP-CD.
  8215     SET M-INDEX TO 1.
  8216
  8217     IF PI-COMPANY-ID = 'NCL'
  8218       IF AGENTL (M-INDEX) GREATER ZEROS
  8219         MOVE PI-ACCT-ACCOUNT    TO AGENT  (M-INDEX).
  8220
  8221 4420-LOOP.
  8222     IF AGENTL (M-INDEX) NOT GREATER ZEROS
  8223        IF (ATYPEL (M-INDEX)  GREATER ZEROS AND
  8224            ATYPE  (M-INDEX) NOT = SPACES)  OR
  8225           SINGLEL (M-INDEX) GREATER ZEROS  OR
  8226           JOINTL  (M-INDEX) GREATER ZEROS  OR
  8227           A-HL    (M-INDEX) GREATER ZEROS  OR
  8228           RECALL  (M-INDEX) GREATER ZEROS  OR
  8229           RCOMML  (M-INDEX) GREATER ZEROS  OR
  8230           CHGBCKL (M-INDEX) GREATER ZEROS  OR
  8231           GLCODEL (M-INDEX) GREATER ZEROS
  8232           MOVE ER-2172          TO EMI-ERROR
  8233           MOVE -1               TO AGENTL (M-INDEX)
  8234           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8235           GO TO 4450-BUMP-INDEX
  8236        ELSE
  8237           GO TO 4450-BUMP-INDEX.
  8238
  8239     IF AGENT (M-INDEX) = ZEROS
  8240         MOVE ER-2970            TO  EMI-ERROR
  8241         MOVE -1                 TO  AGENTL (M-INDEX)
  8242         MOVE AL-UABON           TO  AGENTA (M-INDEX)
  8243         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8244         GO TO 4450-BUMP-INDEX.
  8245
  8246     IF ATYPEL (M-INDEX) = ZEROS
  8247        MOVE -1                  TO ATYPEL (M-INDEX)
  8248        MOVE ER-2173             TO EMI-ERROR
  8249        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8250        GO TO 4430-CHECK-SINGLE.
  8251
  8252     IF ATYPE (M-INDEX) = 'C'
  8253        ADD 1                    TO WS-ACCOUNT-CTR-C
  8254       ELSE
  8255        IF ATYPE (M-INDEX) = 'R'
  8256           ADD 1                 TO WS-ACCOUNT-CTR-R
  8257          ELSE
  8258           IF ATYPE (M-INDEX) = 'D'
  8259              ADD 1                 TO WS-ACCOUNT-CTR-D
  8260             ELSE
  8261              IF ATYPE (M-INDEX) = 'O' OR 'P' OR 'T' OR 'W'
  8262                                OR 'B' OR 'I' OR 'K' OR 'L'
  8263                                OR 'J' OR 'M' OR 'A' OR 'N'
  8264                                OR 'S'
  8265                 NEXT SENTENCE
  8266                ELSE
  8267                 IF ATYPE (M-INDEX) = SPACES
  8268                    NEXT SENTENCE
  8269                   ELSE
  8270                    MOVE ER-2175       TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 158
* EL6501.cbl
  8271                    MOVE -1            TO ATYPEL (M-INDEX)
  8272                    MOVE AL-UABON      TO ATYPEA (M-INDEX)
  8273                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8274
  8275 4430-CHECK-SINGLE.
  8276     IF SINGLEL (M-INDEX) GREATER ZEROS
  8277        IF SINGLE-COMM-R (M-INDEX) NOT NUMERIC
  8278           MOVE SINGLE-COMM-T (M-INDEX)    TO COMM-TABLE
  8279           MOVE PI-LIFE-OVERRIDE-L1        TO COMM-LF-AH
  8280           MOVE LOW-VALUES                 TO COMM-FILLER
  8281           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8282           IF COMMISSION-ERROR
  8283              MOVE AL-UABON      TO SINGLEA (M-INDEX)
  8284              MOVE -1            TO SINGLEL (M-INDEX)
  8285           ELSE
  8286            IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  8287              MOVE -1            TO MAINTL
  8288              MOVE ER-1884       TO EMI-ERROR
  8289              PERFORM 9900-ERROR-FORMAT
  8290                                 THRU 9900-EXIT
  8291            END-IF
  8292           END-IF
  8293        END-IF
  8294     END-IF
  8295
  8296     IF JOINTL (M-INDEX) GREATER ZEROS
  8297        IF JOINT-COMM-R (M-INDEX) NOT NUMERIC
  8298           MOVE JOINT-COMM-T (M-INDEX)     TO COMM-TABLE
  8299           MOVE PI-LIFE-OVERRIDE-L1        TO COMM-LF-AH
  8300           MOVE LOW-VALUES                 TO COMM-FILLER
  8301           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8302           IF COMMISSION-ERROR
  8303              MOVE AL-UABON      TO JOINTA (M-INDEX)
  8304              MOVE -1            TO JOINTL (M-INDEX)
  8305           ELSE
  8306            IF WS-TABLE-MAX > WS-ST-COMM-CAP-JL
  8307              MOVE -1            TO MAINTL
  8308              MOVE ER-1885       TO EMI-ERROR
  8309              PERFORM 9900-ERROR-FORMAT
  8310                                 THRU 9900-EXIT
  8311            END-IF
  8312           END-IF
  8313        END-IF
  8314     END-IF
  8315
  8316     IF A-HL (M-INDEX) GREATER ZEROS
  8317        IF A-H-COMM-R (M-INDEX)  NOT NUMERIC
  8318           MOVE A-H-COMM-T (M-INDEX)      TO COMM-TABLE
  8319           MOVE PI-AH-OVERRIDE-L1         TO COMM-LF-AH
  8320           MOVE LOW-VALUES                 TO COMM-FILLER
  8321           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8322           IF COMMISSION-ERROR
  8323              MOVE AL-UABON      TO A-HA (M-INDEX)
  8324              MOVE -1            TO A-HL (M-INDEX)
  8325           ELSE
  8326            IF WS-TABLE-MAX > WS-ST-COMM-CAP-SA
  8327              MOVE -1            TO MAINTL
  8328              MOVE ER-1886       TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 159
* EL6501.cbl
  8329              PERFORM 9900-ERROR-FORMAT
  8330                                 THRU 9900-EXIT
  8331            END-IF
  8332           END-IF
  8333        END-IF
  8334     END-IF
  8335
  8336     IF RECALL (M-INDEX) GREATER ZEROS
  8337         IF RECAL (M-INDEX) = 'Y' OR 'N' OR '1' OR SPACE
  8338             MOVE AL-UANON       TO RECALA (M-INDEX)
  8339         ELSE
  8340             MOVE -1             TO RECALL (M-INDEX)
  8341             MOVE AL-UABON       TO RECALA (M-INDEX)
  8342             MOVE ER-2158        TO EMI-ERROR
  8343             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8344
  8345     IF RCOMML (M-INDEX) GREATER ZEROS
  8346         IF RCOMM (M-INDEX) = 'Y' OR 'N' OR 'A' OR SPACE
  8347             MOVE AL-UANON       TO RCOMMA (M-INDEX)
  8348         ELSE
  8349             MOVE -1             TO RCOMML (M-INDEX)
  8350             MOVE AL-UABON       TO RCOMMA (M-INDEX)
  8351             MOVE ER-0625        TO EMI-ERROR
  8352             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8353
  8354     IF  CHGBCKL (M-INDEX)  GREATER THAN  ZEROS
  8355         IF  CHGBCK (M-INDEX)    NUMERIC
  8356             MOVE  AL-UNNON        TO  CHGBCKA (M-INDEX)
  8357         ELSE
  8358             MOVE  -1              TO  CHGBCKL (M-INDEX)
  8359             MOVE  AL-UNBON        TO  CHGBCKA (M-INDEX)
  8360             MOVE  ER-0759         TO  EMI-ERROR
  8361             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
  8362
  8363     IF  GLCODEL (M-INDEX)  GREATER THAN  ZEROS
  8364         IF  GLCODE (M-INDEX)    NUMERIC
  8365             MOVE  AL-UNNON        TO  GLCODEA (M-INDEX)
  8366         ELSE
  8367             MOVE  -1              TO  GLCODEL (M-INDEX)
  8368             MOVE  AL-UNBON        TO  GLCODEA (M-INDEX)
  8369             MOVE  ER-0759         TO  EMI-ERROR
  8370             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
  8371
  8372     IF ATYPE (M-INDEX) NOT = 'C' AND 'D' AND 'O' AND 'P'
  8373        AND 'J'
  8374         GO TO 4450-BUMP-INDEX.
  8375
  8376     IF SINGLE-COMM-R (M-INDEX) NUMERIC
  8377         ADD SINGLE-COMM-R (M-INDEX) TO COMM-SL-ACCUM.
  8378
  8379     IF JOINT-COMM-R (M-INDEX) NUMERIC
  8380         ADD JOINT-COMM-R (M-INDEX)  TO COMM-JL-ACCUM.
  8381
  8382     IF A-H-COMM-R (M-INDEX) NUMERIC
  8383        ADD A-H-COMM-R (M-INDEX)    TO COMM-AH-ACCUM
  8384     END-IF
  8385     .
  8386 4450-BUMP-INDEX.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 160
* EL6501.cbl
  8387     SET M-INDEX UP BY 1.
  8388
  8389     IF M-INDEX NOT = 11
  8390        GO TO 4420-LOOP.
  8391
  8392     IF WS-ACCOUNT-CTR-C = ZEROS AND
  8393        WS-ACCOUNT-CTR-D = ZEROS AND
  8394        WS-ACCOUNT-CTR-R = ZEROS
  8395          MOVE ER-2177             TO EMI-ERROR
  8396          MOVE -1                  TO AGENTL (1)
  8397          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8398          GO TO 4900-EXIT.
  8399
  8400     IF (WS-ACCOUNT-CTR-C  GREATER 0 AND
  8401         WS-ACCOUNT-CTR-D  GREATER 0) OR
  8402        (WS-ACCOUNT-CTR-R  GREATER 0 AND
  8403         WS-ACCOUNT-CTR-D  GREATER 0)
  8404           MOVE ER-2174             TO EMI-ERROR
  8405           MOVE -1                  TO AGENTL (1)
  8406           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8407           GO TO 4900-EXIT.
  8408
  8409     IF WS-ACCOUNT-CTR-C GREATER 1 OR
  8410        WS-ACCOUNT-CTR-R GREATER 1 OR
  8411        WS-ACCOUNT-CTR-D GREATER 1
  8412          MOVE ER-2182             TO EMI-ERROR
  8413          MOVE -1                  TO AGENTL (1)
  8414          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8415          GO TO 4900-EXIT.
  8416
  8417
  8418     IF WS-ST-COMM-CAP-SL NOT NUMERIC
  8419         MOVE ZEROS        TO WS-ST-COMM-CAP-SL.
  8420
  8421     IF WS-ST-COMM-CAP-SL = ZEROS
  8422        CONTINUE
  8423     ELSE
  8424      IF SINGLE-COMM-R (1) NUMERIC
  8425        IF (WS-LIMIT-TO-ACCOUNT AND
  8426           SINGLE-COMM-R (1) > WS-ST-COMM-CAP-SL)
  8427                       OR
  8428           (NOT WS-LIMIT-TO-ACCOUNT AND
  8429           COMM-SL-ACCUM > WS-ST-COMM-CAP-SL)
  8430           MOVE -1               TO MAINTL
  8431           MOVE ER-1884          TO EMI-ERROR
  8432           PERFORM 9900-ERROR-FORMAT
  8433                                 THRU 9900-EXIT
  8434        END-IF
  8435*     ELSE
  8436*       MOVE PI-COMPANY-CD       TO COMM-COMP-CD
  8437*       MOVE SINGLE-COMM-T (1)   TO COMM-TABLE
  8438*       MOVE PI-LIFE-OVERRIDE-L1 TO COMM-LF-AH
  8439*       MOVE LOW-VALUES          TO COMM-FILLER
  8440*       PERFORM 6400-READ-COMMISSION
  8441*                                THRU 6459-EXIT
  8442*       IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  8443*          MOVE -1               TO MAINTL
  8444*          MOVE ER-1884          TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 161
* EL6501.cbl
  8445*          PERFORM 9900-ERROR-FORMAT
  8446*                                THRU 9900-EXIT
  8447*       END-IF
  8448      END-IF
  8449     END-IF
  8450
  8451     IF WS-ST-COMM-CAP-JL NOT NUMERIC
  8452        MOVE ZEROS               TO WS-ST-COMM-CAP-JL
  8453     END-IF
  8454
  8455     IF WS-ST-COMM-CAP-JL = ZEROS
  8456        CONTINUE
  8457     ELSE
  8458        IF JOINT-COMM-R (1) NUMERIC
  8459           IF (WS-LIMIT-TO-ACCOUNT AND
  8460              JOINT-COMM-R (1) > WS-ST-COMM-CAP-JL)
  8461                       OR
  8462              (NOT WS-LIMIT-TO-ACCOUNT AND
  8463               COMM-JL-ACCUM > WS-ST-COMM-CAP-JL)
  8464               MOVE -1           TO MAINTL
  8465               MOVE ER-1885      TO EMI-ERROR
  8466               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8467           END-IF
  8468*       ELSE
  8469*          MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  8470*          MOVE JOINT-COMM-T (1) TO COMM-TABLE
  8471*          MOVE PI-LIFE-OVERRIDE-L1
  8472*                                TO COMM-LF-AH
  8473*          MOVE LOW-VALUES       TO COMM-FILLER
  8474*          PERFORM 6400-READ-COMMISSION
  8475*                                THRU 6459-EXIT
  8476*          IF EXCEEDS-STATE-MAX
  8477*             MOVE ER-1885       TO EMI-ERROR
  8478*             PERFORM 9900-ERROR-FORMAT
  8479*                                THRU 9900-EXIT
  8480*          END-IF
  8481        END-IF
  8482     END-IF
  8483
  8484     IF WS-ST-COMM-CAP-SA NOT NUMERIC
  8485        MOVE ZEROS               TO WS-ST-COMM-CAP-SA
  8486     END-IF
  8487
  8488     IF WS-ST-COMM-CAP-SA = ZEROS
  8489        CONTINUE
  8490     ELSE
  8491        IF A-H-COMM-R (1) NUMERIC
  8492           IF (WS-LIMIT-TO-ACCOUNT AND
  8493              A-H-COMM-R (1) > WS-ST-COMM-CAP-SA)
  8494                           OR
  8495              (NOT WS-LIMIT-TO-ACCOUNT AND
  8496              COMM-AH-ACCUM > WS-ST-COMM-CAP-SA)
  8497              MOVE -1            TO MAINTL
  8498              MOVE ER-1886       TO EMI-ERROR
  8499              PERFORM 9900-ERROR-FORMAT
  8500                                 THRU 9900-EXIT
  8501           END-IF
  8502*       ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 162
* EL6501.cbl
  8503*          MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  8504*          MOVE A-H-COMM-T (1)   TO COMM-TABLE
  8505*          MOVE PI-AH-OVERRIDE-L1
  8506*                                TO COMM-LF-AH
  8507*          MOVE LOW-VALUES       TO COMM-FILLER
  8508*          PERFORM 6400-READ-COMMISSION
  8509*                                THRU 6459-EXIT
  8510*          IF EXCEEDS-STATE-MAX
  8511*             MOVE ER-1886       TO EMI-ERROR
  8512*             PERFORM 9900-ERROR-FORMAT
  8513*                                THRU 9900-EXIT
  8514*          END-IF
  8515        END-IF
  8516     END-IF
  8517
  8518     IF MAINTI NOT = 'C'
  8519        GO TO 4900-EXIT.
  8520
  8521     IF NOT PI-GA-BILLING
  8522        GO TO 4900-EXIT.
  8523
  8524 4460-CHECK-IF-GA-BILLED.
  8525     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  8526
  8527     MOVE PI-COMM-POINTER        TO LCP-WS-ADDR-COMP
  8528     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  8529     SET M-INDEX TO +1.
  8530     MOVE +1 TO AXRF-SUB.
  8531
  8532 4470-GA-LOOP.
  8533     IF ((AGENT (M-INDEX) NOT = WK-AM-AGT (AXRF-SUB)  OR
  8534        ATYPE  (M-INDEX) NOT = WK-AM-TYPE (AXRF-SUB)) OR
  8535        SINGLEL (M-INDEX) GREATER ZERO                OR
  8536        JOINTL  (M-INDEX) GREATER ZERO                OR
  8537        A-HL    (M-INDEX) GREATER ZERO                OR
  8538        RCOMML  (M-INDEX) GREATER ZERO                OR
  8539        CHGBCKL (M-INDEX) GREATER ZERO                OR
  8540        GLCODEL (M-INDEX) GREATER ZERO)               AND
  8541        (WK-GA-BILL-DT (AXRF-SUB) NOT = LOW-VALUES AND SPACES)
  8542           MOVE ER-2131   TO EMI-ERROR
  8543           MOVE -1        TO AGENTL (M-INDEX)
  8544           MOVE AL-UABON  TO AGENTA (M-INDEX)
  8545           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8546
  8547     ADD +1 TO AXRF-SUB.
  8548     SET M-INDEX UP BY +1.
  8549
  8550     IF AXRF-SUB NOT = +11
  8551        GO TO 4470-GA-LOOP.
  8552
  8553 4900-EXIT.
  8554      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 163
* EL6501.cbl
  8556 5000-MOVE-TO-RECORD.
  8557
  8558     IF NAMEL   GREATER THAN ZERO  OR
  8559        INCAREL GREATER THAN ZERO  OR
  8560        ADDR1L  GREATER THAN ZERO  OR
  8561        ACITYL  GREATER THAN ZERO  OR
  8562        ASTATEL GREATER THAN ZERO  OR
  8563        ZIPL    GREATER THAN ZERO  OR
  8564        PHONEL  GREATER THAN ZERO  OR
  8565        TAXNOL  GREATER THAN ZERO
  8566         MOVE '*'                TO AM-PROFILE-CHANGE-SWITCH.
  8567
  8568     IF CSRL GREATER ZEROS
  8569        MOVE CSRI                TO AM-CSR-CODE.
  8570     IF NAMEL GREATER ZEROS
  8571        MOVE NAMEI               TO AM-NAME.
  8572     IF PCONTL GREATER ZEROS
  8573        MOVE PCONTI              TO AM-CONTROL-NAME
  8574     END-IF
  8575     IF INCAREL GREATER ZEROS
  8576        MOVE INCAREI             TO AM-PERSON.
  8577     IF ADDR1L GREATER ZEROS
  8578        MOVE ADDR1I              TO AM-ADDRS.
  8579     IF TAXNOL GREATER ZEROS
  8580        MOVE TAXNOI              TO AM-ID-NO.
  8581     IF PHONEL GREATER ZEROS
  8582        MOVE PHONEI              TO DEEDIT-FIELD
  8583        PERFORM 8600-DEEDIT
  8584        MOVE DEEDIT-FIELD-V0     TO WS-PHONE-NUM
  8585        MOVE WS-PH1              TO AM-AREA-CODE
  8586        MOVE WS-PH2              TO AM-TEL-PRE
  8587        MOVE WS-PH3              TO AM-TEL-NBR.
  8588
  8589     IF ACITYL GREATER ZEROS
  8590        MOVE ACITYI             TO AM-ADDR-CITY.
  8591     IF ASTATEL GREATER ZEROS
  8592        MOVE ASTATEI            TO AM-ADDR-STATE.
  8593
  8594     IF ZIPL NOT GREATER ZEROS
  8595         GO TO 5010-CONT-MOVING.
  8596
  8597     MOVE ZIPI                   TO WS-ZIP-CODE.
  8598
  8599     IF WS-CANADIAN-ZIP
  8600         IF WS-ZIP-4 = SPACE  OR  '-'
  8601             MOVE WS-ZIP-CAN-2-POST1  TO AM-CAN-POSTAL-1
  8602             MOVE WS-ZIP-CAN-2-POST2  TO AM-CAN-POSTAL-2
  8603         ELSE
  8604             MOVE WS-ZIP-CAN-1-POST1  TO AM-CAN-POSTAL-1
  8605             MOVE WS-ZIP-CAN-1-POST2  TO AM-CAN-POSTAL-2
  8606     ELSE
  8607         IF WS-ZIP-6 = SPACE  OR  '-'
  8608             MOVE WS-ZIP-AM-2-CODE    TO AM-ZIP-PRIME
  8609             MOVE WS-ZIP-AM-2-PLUS4   TO AM-ZIP-PLUS4
  8610         ELSE
  8611             MOVE WS-ZIP-AM-1-CODE    TO AM-ZIP-PRIME
  8612             MOVE WS-ZIP-AM-1-PLUS4   TO AM-ZIP-PLUS4.
  8613
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 164
* EL6501.cbl
  8614 5010-CONT-MOVING.
  8615     IF TYPEL GREATER ZEROS
  8616        MOVE TYPEI               TO AM-GPCD.
  8617
  8618     IF STDBENL GREATER ZEROS
  8619        MOVE STDBENI             TO AM-STD-AH-TYPE.
  8620
  8621     IF INDGRPL GREATER ZEROS
  8622        MOVE INDGRPI             TO AM-IG
  8623        INSPECT AM-IG CONVERTING 'IG' TO '12'.
  8624
  8625     IF STATUSL GREATER ZEROS
  8626        MOVE STATUSI             TO AM-STATUS
  8627*       INSPECT AM-STATUS CONVERTING 'SFCTIA' TO '543210'
  8628        INSPECT AM-STATUS CONVERTING 'PRLDSFCTIA' TO '9876543210'
  8629     END-IF
  8630
  8631     IF CLPTOLPL GREATER ZEROS
  8632        MOVE CLPTOLPI            TO AM-CLP-TOL-PCT
  8633     END-IF.
  8634
  8635     IF PRODCDL > 0
  8636        MOVE PRODCDI             TO AM-DCC-PRODUCT-CODE
  8637     END-IF
  8638     IF CLPSTL > 0
  8639        MOVE CLPSTI              TO AM-DCC-CLP-STATE
  8640     END-IF
  8641     IF MAXMFEEL > ZEROS
  8642        MOVE WS-WORK-NUM         TO AM-DCC-MAX-MARKETING-FEE
  8643     END-IF
  8644     IF LCOMML > ZEROS
  8645        MOVE LCOMMI              TO AM-SPP-LEASE-COMM
  8646     END-IF
  8647
  8648     IF REMITL GREATER ZEROS
  8649        MOVE REMITI              TO AM-REMIT-TO.
  8650     IF CONTRL GREATER ZEROS
  8651        MOVE WS-ANVR-DT          TO AM-ANNIVERSARY-DATE.
  8652*    IF PSILFFL GREATER +0
  8653*       MOVE WS-LIFE-PSI         TO AM-LF-PSI-FACTOR.
  8654*    IF PSIAHFL GREATER +0
  8655*       MOVE WS-AH-PSI           TO AM-AH-PSI-FACTOR.
  8656     IF PEFFDTEL GREATER ZEROS
  8657        MOVE WS-PEFF-DT          TO AM-PREV-EFF-DT.
  8658     IF PEXPDTEL GREATER ZEROS
  8659        MOVE WS-PEXP-DT          TO AM-PREV-EXP-DT.
  8660     IF COMMCALL GREATER ZEROS
  8661        MOVE COMMCALI            TO AM-RECALC-COMM
  8662        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8663     ELSE
  8664         IF MAINTI = 'A'
  8665             MOVE 'N'            TO AM-RECALC-COMM.
  8666
  8667     IF REINCALL GREATER ZEROS
  8668        MOVE REINCALI            TO AM-RECALC-REIN
  8669     ELSE
  8670         IF MAINTI = 'A'
  8671             MOVE 'N'            TO AM-RECALC-REIN.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 165
* EL6501.cbl
  8672
  8673     IF REINTABL GREATER ZEROS
  8674        MOVE REINTABI            TO AM-REI-TABLE.
  8675
  8676     IF PI-MAINT = 'A'
  8677        MOVE 'P'                 TO AM-RET-ST-TAX-USE
  8678     END-IF
  8679
  8680     MOVE 1                      TO SUB.
  8681     SET M-INDEX                 TO 1.
  8682
  8683
  8684* EXEC CICS
  8685*         ASKTIME
  8686*    END-EXEC.
  8687*    MOVE '0"                    "   #00008118' TO DFHEIV0
  8688     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
  8689     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  8690     MOVE X'2020233030303038313138' TO DFHEIV0(25:11)
  8691     CALL 'kxdfhei1' USING DFHEIV0,
  8692           DFHEIV99
  8693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8694
  8695
  8696 5000-LOOP.
  8697*    IF PI-COMPANY-ID = 'DCC'
  8698*       IF (M-INDEX = +5)
  8699*          AND ((AGENTL (5) > ZEROS)
  8700*              OR (ATYPEL (5) > ZEROS))
  8701*             MOVE ER-3057         TO EMI-ERROR
  8702*             MOVE -1              TO AGENTL (5)
  8703*             MOVE AL-UABON        TO AGENTA (5)
  8704*             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8705*             GO TO 5000-EXIT
  8706*       END-IF
  8707*    END-IF
  8708     IF MAINTI = 'C'
  8709        IF ((AM-AGT (SUB) NOT = ZEROS AND AGENT (M-INDEX)) AND
  8710           (COMMCALI NOT = 'Y' AND '1')                    AND
  8711            AM-HI-CERT-DATE NOT = ZEROS)                    OR
  8712           ((AM-AGT (SUB) = ZEROS AND
  8713             (AGENT (M-INDEX)) NOT = LOW-VALUES AND SPACES AND
  8714                                     ZEROS) AND
  8715           (COMMCALI NOT = 'Y' AND '1')  AND
  8716            AM-HI-CERT-DATE NOT = ZEROS)
  8717              MOVE ER-2181         TO EMI-ERROR
  8718              MOVE -1              TO COMMCALL
  8719              MOVE AL-UABON        TO COMMCALA
  8720              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8721              GO TO 5000-EXIT.
  8722
  8723     IF MAINTI = 'C'
  8724        IF ((AM-COM-TYP (SUB) NOT = SPACES AND
  8725             ATYPE (M-INDEX)) AND
  8726           (COMMCALI NOT = 'Y' AND '1') AND
  8727            AM-HI-CERT-DATE NOT = ZEROS)
  8728            OR
  8729           ((AM-COM-TYP (SUB) = SPACES AND
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 166
* EL6501.cbl
  8730             (ATYPE (M-INDEX)) NOT = LOW-VALUES AND SPACES) AND
  8731           (COMMCALI NOT = 'Y' AND '1')  AND
  8732            AM-HI-CERT-DATE NOT = ZEROS)
  8733              MOVE ER-2181         TO EMI-ERROR
  8734              MOVE -1              TO COMMCALL
  8735              MOVE AL-UABON        TO COMMCALA
  8736              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8737              GO TO 5000-EXIT.
  8738
  8739     IF AM-ACCOUNT-BILLED
  8740        IF COMMCALI = 'Y' OR '1'
  8741            MOVE ER-2183         TO EMI-ERROR
  8742            MOVE -1              TO COMMCALL
  8743            MOVE AL-UABON        TO COMMCALA
  8744            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8745            GO TO 5000-EXIT.
  8746
  8747     IF (AGENTL (M-INDEX) NOT GREATER ZEROS AND
  8748        ATYPEL  (M-INDEX) NOT GREATER ZEROS)
  8749        OR
  8750        ((AGENT (M-INDEX) = ZEROS OR SPACES) AND
  8751         ATYPE  (M-INDEX) = SPACES)
  8752           MOVE ZEROS              TO AM-AGT   (SUB)
  8753                                      AM-L-COM (SUB)
  8754                                      AM-J-COM (SUB)
  8755                                      AM-A-COM (SUB)
  8756           MOVE SPACE TO AM-COM-TYP (SUB)
  8757           SET M-INDEX UP BY 1
  8758           ADD 1 TO SUB
  8759           IF SUB = 11
  8760              GO TO 5000-CHECK-MAX-FEES
  8761            ELSE
  8762              GO TO 5000-LOOP.
  8763
  8764     MOVE AGENT (M-INDEX)        TO AM-AGT (SUB).
  8765     MOVE ATYPE (M-INDEX)        TO AM-COM-TYP (SUB).
  8766
  8767     IF SINGLEL (M-INDEX) GREATER ZEROS
  8768        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8769        IF SINGLE-COMM-R (M-INDEX) NOT NUMERIC
  8770           MOVE SINGLE-COMM-T (M-INDEX) TO AM-L-COMA (SUB)
  8771          ELSE
  8772           MOVE SINGLE-COMM-R (M-INDEX) TO AM-L-COM  (SUB)
  8773           IF SINGLE-DASH (M-INDEX) = '-'
  8774               MULTIPLY AM-L-COM (SUB) BY -1
  8775                     GIVING AM-L-COM (SUB).
  8776
  8777     IF JOINTL (M-INDEX) GREATER ZEROS
  8778        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8779        IF JOINT-COMM-R (M-INDEX) NOT NUMERIC
  8780           MOVE JOINT-COMM-T (M-INDEX)  TO AM-J-COMA (SUB)
  8781          ELSE
  8782           MOVE JOINT-COMM-R (M-INDEX)  TO AM-J-COM (SUB)
  8783           IF JOINT-DASH (M-INDEX) = '-'
  8784               MULTIPLY AM-J-COM (SUB) BY -1
  8785                     GIVING AM-J-COM (SUB).
  8786
  8787     IF A-HL (M-INDEX) GREATER ZEROS
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 167
* EL6501.cbl
  8788        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8789        IF A-H-COMM-R (M-INDEX) NOT NUMERIC
  8790           MOVE A-H-COMM-T (M-INDEX)  TO AM-A-COMA (SUB)
  8791          ELSE
  8792           MOVE A-H-COMM-R (M-INDEX)  TO AM-A-COM (SUB)
  8793           IF A-H-DASH (M-INDEX) = '-'
  8794               MULTIPLY AM-A-COM (SUB) BY -1
  8795                     GIVING AM-A-COM (SUB).
  8796
  8797     IF RECALL (M-INDEX) GREATER ZEROS
  8798         MOVE RECAL  (M-INDEX)   TO AM-RECALC-LV-INDIC (SUB).
  8799
  8800     IF RCOMML (M-INDEX) GREATER ZEROS
  8801         MOVE RCOMM  (M-INDEX)   TO AM-RETRO-LV-INDIC (SUB).
  8802
  8803     IF CHGBCKL (M-INDEX) GREATER ZEROS
  8804         MOVE CHGBCK (M-INDEX)   TO AM-COMM-CHARGEBACK (SUB).
  8805
  8806     IF GLCODEL (M-INDEX) GREATER ZEROS
  8807         MOVE GLCODE (M-INDEX)   TO AM-GL-CODES (SUB).
  8808
  8809     SET M-INDEX UP BY 1.
  8810     ADD 1 TO SUB.
  8811     IF M-INDEX NOT = 11
  8812        GO TO 5000-LOOP.
  8813
  8814 5000-CHECK-MAX-FEES.
  8815     IF (AM-DCC-PRODUCT-CODE = 'DDF')
  8816        MOVE +1                     TO S1
  8817        PERFORM UNTIL S1 > +10
  8818           IF (AM-A-COM (S1) NUMERIC)
  8819              AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M'
  8820                     AND 'O')
  8821              AND (AM-COM-TYP (S1) = 'J')
  8822                 COMPUTE COMM-MFEE-ACCUM = COMM-MFEE-ACCUM
  8823                    + (AM-A-COM (S1) * +1000)
  8824           END-IF
  8825           ADD +1             TO S1
  8826        END-PERFORM
  8827        IF COMM-MFEE-ACCUM > AM-DCC-MAX-MARKETING-FEE
  8828           MOVE -1               TO MAXMFEEL
  8829           MOVE AL-UABON         TO MAXMFEEA
  8830           MOVE ER-1817          TO EMI-ERROR
  8831           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8832        END-IF
  8833     END-IF
  8834     .
  8835 5000-EXIT.
  8836      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 168
* EL6501.cbl
  8838
  8839 5100-WRITE-TS.
  8840     PERFORM 6500-READ-ACCT THRU 6599-EXIT.
  8841
  8842     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  8843         MOVE ZEROS              TO PI-CR-CARRIER
  8844     ELSE
  8845         MOVE AM-CARRIER         TO PI-CR-CARRIER.
  8846
  8847     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  8848         MOVE ZEROS              TO PI-CR-GROUPING
  8849     ELSE
  8850         MOVE AM-GROUPING        TO PI-CR-GROUPING.
  8851
  8852     IF AM-REMIT-TO NOT = ZERO
  8853         MOVE AM-AGT (AM-REMIT-TO)
  8854                                 TO PI-CR-FIN-RESP
  8855       ELSE
  8856         MOVE AM-ACCOUNT         TO PI-CR-FIN-RESP.
  8857
  8858     MOVE 'A'                    TO PI-CR-TYPE.
  8859 5110-AGT-LOOP.
  8860     ADD 1                       TO  AGT-SUB.
  8861     IF AGT-SUB GREATER 10
  8862         MOVE LOW-VALUES         TO PI-CR-CONTROL-IN-PROGRESS
  8863         GO TO 5120-WRITE.
  8864
  8865************************************************************
  8866**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  8867************************************************************
  8868
  8869     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'R'
  8870                  OR 'F' OR 'U'
  8871         MOVE AM-AGT (AGT-SUB)   TO  PI-CR-ACCOUNT
  8872         GO TO 5120-WRITE
  8873     ELSE
  8874         GO TO 5110-AGT-LOOP.
  8875
  8876 5120-WRITE.
  8877
  8878* EXEC CICS WRITEQ TS
  8879*         QUEUE    (QID)
  8880*         FROM     (PROGRAM-INTERFACE-BLOCK)
  8881*         LENGTH   (WS-COMM-LENGTH)
  8882*         ITEM     (W-ONE)
  8883*    END-EXEC.
  8884*    MOVE '*" I                  ''   #00008303' TO DFHEIV0
  8885     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  8886     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8887     MOVE X'2020233030303038333033' TO DFHEIV0(25:11)
  8888     CALL 'kxdfhei1' USING DFHEIV0,
  8889           QID,
  8890           PROGRAM-INTERFACE-BLOCK,
  8891           WS-COMM-LENGTH,
  8892           W-ONE,
  8893           DFHEIV99,
  8894           DFHEIV99
  8895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 169
* EL6501.cbl
  8896
  8897
  8898 5199-EXIT.
  8899     EXIT.
  8900
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 170
* EL6501.cbl
  8902
  8903 5200-RECOVER-TS.
  8904
  8905     IF PI-CALLING-PROGRAM NOT = XCTL-652 AND
  8906                                 XCTL-653 AND
  8907                                 XCTL-689 AND
  8908                                 XCTL-608 AND
  8909                                 XCTL-690
  8910         GO TO 5299-EXIT.
  8911
  8912
  8913* EXEC CICS HANDLE CONDITION
  8914*        QIDERR  (5250-QID-ERROR)
  8915*    END-EXEC.
  8916*    MOVE '"$N                   ! , #00008324' TO DFHEIV0
  8917     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8918     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8919     MOVE X'2C20233030303038333234' TO DFHEIV0(25:11)
  8920     CALL 'kxdfhei1' USING DFHEIV0
  8921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8922
  8923
  8924
  8925* EXEC CICS READQ TS
  8926*        QUEUE    (QID)
  8927*        INTO     (PROGRAM-INTERFACE-BLOCK)
  8928*        LENGTH   (WS-COMM-LENGTH)
  8929*        ITEM     (W-ONE)
  8930*    END-EXEC.
  8931*    MOVE '*$II   L              ''   #00008328' TO DFHEIV0
  8932     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8933     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8934     MOVE X'2020233030303038333238' TO DFHEIV0(25:11)
  8935     CALL 'kxdfhei1' USING DFHEIV0,
  8936           QID,
  8937           PROGRAM-INTERFACE-BLOCK,
  8938           WS-COMM-LENGTH,
  8939           W-ONE,
  8940           DFHEIV99,
  8941           DFHEIV99
  8942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8943
  8944
  8945 5200-DELETE-TS.
  8946
  8947
  8948* EXEC CICS DELETEQ TS
  8949*        QUEUE    (QID)
  8950*    END-EXEC.
  8951*    MOVE '*&                    #   #00008337' TO DFHEIV0
  8952     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8953     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8954     MOVE X'2020233030303038333337' TO DFHEIV0(25:11)
  8955     CALL 'kxdfhei1' USING DFHEIV0,
  8956           QID,
  8957           DFHEIV99
  8958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8959
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 171
* EL6501.cbl
  8960
  8961     GO TO 5299-EXIT.
  8962
  8963 5250-QID-ERROR.
  8964     MOVE ER-0033                TO  EMI-ERROR.
  8965     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8966
  8967 5299-EXIT.
  8968     EXIT.
  8969
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 172
* EL6501.cbl
  8971
  8972 5300-UPDATE-REQUEST-FILE.
  8973     MOVE +0                     TO SUB1.
  8974
  8975 5300-FIND-ACCOUNT-AGENT.
  8976     ADD +1                      TO SUB1.
  8977
  8978     IF SUB1 GREATER THAN +10
  8979        MOVE ER-2949             TO EMI-ERROR
  8980        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8981        MOVE -1                  TO AGENTL (1)
  8982
  8983* EXEC CICS SYNCPOINT ROLLBACK
  8984*       END-EXEC
  8985*    MOVE '6"R                   !   #00008362' TO DFHEIV0
  8986     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  8987     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8988     MOVE X'2020233030303038333632' TO DFHEIV0(25:11)
  8989     CALL 'kxdfhei1' USING DFHEIV0
  8990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8991        GO TO 8200-SEND-DATAONLY.
  8992
  8993     MOVE SAVE-ACCT-AGENT      TO SAVE-NEW-ACCT-AGENT.
  8994
  8995************************************************************
  8996**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  8997************************************************************
  8998
  8999     IF AM-COM-TYP  (SUB1) = 'C' OR 'D' OR 'F'
  9000        IF AM-AGT   (SUB1) NOT = SAVE-ACCT-AGENT
  9001           MOVE AM-AGT (SUB1)  TO SAVE-NEW-ACCT-AGENT.
  9002
  9003     IF AM-AGT (AM-REMIT-TO) NOT = SAVE-FIN-RESP
  9004        GO TO 5325-PROCESS-RQST-FILE.
  9005
  9006     IF SAVE-ACCT-AGENT NOT = SAVE-NEW-ACCT-AGENT
  9007        GO TO 5325-PROCESS-RQST-FILE.
  9008
  9009     GO TO 5399-EXIT.
  9010
  9011 5325-PROCESS-RQST-FILE.
  9012     MOVE LOW-VALUES             TO RQST3-KEY.
  9013     MOVE AM-COMPANY-CD          TO RQST3-COMPANY-CD.
  9014     MOVE AM-CARRIER             TO RQST3-CARRIER.
  9015     MOVE AM-GROUPING            TO RQST3-GROUPING.
  9016     MOVE SAVE-FIN-RESP          TO RQST3-FIN-RESP.
  9017     MOVE SAVE-ACCT-AGENT        TO RQST3-ACCT-AGENT.
  9018
  9019
  9020* EXEC CICS HANDLE CONDITION
  9021*        NOTFND(5399-EXIT)
  9022*        ENDFILE(5399-EXIT)
  9023*    END-EXEC.
  9024*    MOVE '"$I''                  ! - #00008392' TO DFHEIV0
  9025     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9026     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9027     MOVE X'2D20233030303038333932' TO DFHEIV0(25:11)
  9028     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 173
* EL6501.cbl
  9029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9030
  9031
  9032 5325-PROCESS-REQUEST-FILE.
  9033
  9034* EXEC CICS STARTBR
  9035*         DATASET   (RQST3-FILE-ID)
  9036*         RIDFLD    (RQST3-KEY)
  9037*    END-EXEC.
  9038     MOVE 0
  9039       TO DFHEIV11
  9040*    MOVE '&,         G          &   #00008398' TO DFHEIV0
  9041     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9042     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9043     MOVE X'2020233030303038333938' TO DFHEIV0(25:11)
  9044     CALL 'kxdfhei1' USING DFHEIV0,
  9045           RQST3-FILE-ID,
  9046           RQST3-KEY,
  9047           DFHEIV99,
  9048           DFHEIV11,
  9049           DFHEIV99
  9050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9051
  9052
  9053 5330-READNEXT-REQUEST.
  9054
  9055* EXEC CICS READNEXT
  9056*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9057*        DATASET(RQST3-FILE-ID)
  9058*        RIDFLD (RQST3-KEY)
  9059*    END-EXEC.
  9060     MOVE 0
  9061       TO DFHEIV11
  9062*    MOVE '&.S                   )   #00008404' TO DFHEIV0
  9063     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9064     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9065     MOVE X'2020233030303038343034' TO DFHEIV0(25:11)
  9066     CALL 'kxdfhei1' USING DFHEIV0,
  9067           RQST3-FILE-ID,
  9068           DFHEIV20,
  9069           DFHEIV99,
  9070           RQST3-KEY,
  9071           DFHEIV99,
  9072           DFHEIV11,
  9073           DFHEIV99,
  9074           DFHEIV99
  9075     SET ADDRESS OF AR-REQUEST-RECORD TO
  9076         DFHEIV20
  9077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9078
  9079
  9080     IF RQST3-KEY = SAVE-RQST3-KEY
  9081        GO TO 5330-READNEXT-REQUEST.
  9082
  9083     MOVE RQST3-KEY              TO SAVE-RQST3-KEY.
  9084
  9085     IF RQ-COMPANY-CD-A2 NOT = PI-COMPANY-CD
  9086        GO TO 5350-REQUESTS-FINISHED.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 174
* EL6501.cbl
  9087
  9088     IF RQ-FIN-RESP-A2 NOT = SAVE-FIN-RESP
  9089        GO TO 5350-REQUESTS-FINISHED.
  9090
  9091     IF RQ-ACCT-AGENT-A2 NOT = SAVE-ACCT-AGENT
  9092        GO TO 5350-REQUESTS-FINISHED.
  9093
  9094     MOVE RQ-CONTROL-PRIMARY     TO RQST-KEY.
  9095
  9096
  9097* EXEC CICS ENDBR
  9098*        DATASET(RQST3-FILE-ID)
  9099*    END-EXEC.
  9100     MOVE 0
  9101       TO DFHEIV11
  9102*    MOVE '&2                    $   #00008426' TO DFHEIV0
  9103     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9104     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9105     MOVE X'2020233030303038343236' TO DFHEIV0(25:11)
  9106     CALL 'kxdfhei1' USING DFHEIV0,
  9107           RQST3-FILE-ID,
  9108           DFHEIV11,
  9109           DFHEIV99
  9110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9111
  9112
  9113
  9114* EXEC CICS READ
  9115*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9116*        DATASET(RQST-FILE-ID)
  9117*        RIDFLD (RQST-KEY)
  9118*        UPDATE
  9119*    END-EXEC.
  9120*    MOVE '&"S        EU         (   #00008430' TO DFHEIV0
  9121     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9122     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9123     MOVE X'2020233030303038343330' TO DFHEIV0(25:11)
  9124     CALL 'kxdfhei1' USING DFHEIV0,
  9125           RQST-FILE-ID,
  9126           DFHEIV20,
  9127           DFHEIV99,
  9128           RQST-KEY,
  9129           DFHEIV99,
  9130           DFHEIV99,
  9131           DFHEIV99
  9132     SET ADDRESS OF AR-REQUEST-RECORD TO
  9133         DFHEIV20
  9134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9135
  9136
  9137     MOVE AM-AGT (AM-REMIT-TO)   TO RQ-FIN-RESP-A2.
  9138     MOVE SAVE-NEW-ACCT-AGENT    TO RQ-ACCT-AGENT-A2.
  9139
  9140
  9141* EXEC CICS REWRITE
  9142*        DATASET   (RQST-FILE-ID)
  9143*        FROM      (AR-REQUEST-RECORD)
  9144*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 175
* EL6501.cbl
  9145     MOVE LENGTH OF
  9146      AR-REQUEST-RECORD
  9147       TO DFHEIV11
  9148*    MOVE '&& L                  %   #00008440' TO DFHEIV0
  9149     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9150     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9151     MOVE X'2020233030303038343430' TO DFHEIV0(25:11)
  9152     CALL 'kxdfhei1' USING DFHEIV0,
  9153           RQST-FILE-ID,
  9154           AR-REQUEST-RECORD,
  9155           DFHEIV11,
  9156           DFHEIV99
  9157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9158
  9159
  9160     GO TO  5325-PROCESS-REQUEST-FILE.
  9161
  9162 5350-REQUESTS-FINISHED.
  9163
  9164* EXEC CICS ENDBR
  9165*        DATASET(RQST3-FILE-ID)
  9166*    END-EXEC.
  9167     MOVE 0
  9168       TO DFHEIV11
  9169*    MOVE '&2                    $   #00008448' TO DFHEIV0
  9170     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9171     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9172     MOVE X'2020233030303038343438' TO DFHEIV0(25:11)
  9173     CALL 'kxdfhei1' USING DFHEIV0,
  9174           RQST3-FILE-ID,
  9175           DFHEIV11,
  9176           DFHEIV99
  9177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9178
  9179
  9180 5399-EXIT.
  9181     EXIT.
  9182
  9183
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 176
* EL6501.cbl
  9185
  9186 6000-MOVE-TO-SCREEN.
  9187     PERFORM 8000-STATE-REC-READ   THRU 8010-EXIT.
  9188
  9189     MOVE AM-LAST-MAINT-USER     TO MAINTBYO.
  9190     MOVE AM-NAME                TO NAMEO.
  9191     MOVE AM-CONTROL-NAME        TO PCONTO.
  9192     MOVE AM-CSR-CODE            TO CSRO.
  9193     MOVE AM-PERSON              TO INCAREO.
  9194     MOVE AM-ADDRS               TO ADDR1O.
  9195     MOVE AM-ID-NO               TO TAXNOO.
  9196     MOVE AM-TEL-NO              TO WS-PHONE.
  9197     MOVE WS-PHONE-NUM           TO PHONEO.
  9198     INSPECT PHONEI CONVERTING SPACES TO '-'.
  9199     MOVE AM-ADDR-CITY           TO ACITYO
  9200     MOVE AM-ADDR-STATE          TO ASTATEO
  9201
  9202     MOVE SPACES                 TO WS-ZIP-CODE.
  9203     IF AM-CANADIAN-POST-CODE
  9204         MOVE AM-CAN-POSTAL-1    TO WS-ZIP-CAN-2-POST1
  9205         MOVE AM-CAN-POSTAL-2    TO WS-ZIP-CAN-2-POST2
  9206     ELSE
  9207         MOVE AM-ZIP-PRIME       TO WS-ZIP-AM-2-CODE
  9208         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9209             MOVE '-'            TO WS-ZIP-AM-2-DASH
  9210             MOVE AM-ZIP-PLUS4   TO WS-ZIP-AM-2-PLUS4.
  9211
  9212     MOVE WS-ZIP-CODE            TO ZIPO.
  9213
  9214     MOVE AM-GPCD                TO TYPEO.
  9215     MOVE AM-STD-AH-TYPE         TO STDBENO.
  9216
  9217     MOVE AM-IG                  TO INDGRPO.
  9218     INSPECT INDGRPO CONVERTING '12' TO 'IG'.
  9219
  9220     MOVE AM-STATUS              TO STATUSO.
  9221*    INSPECT STATUSO CONVERTING '543210' TO 'SFCTIA'
  9222     INSPECT STATUSO CONVERTING '9876543210' TO 'PRLDSFCTIA'
  9223
  9224     MOVE AM-REMIT-TO            TO REMITO.
  9225
  9226     IF PI-AR-PROCESSING
  9227        IF AM-AR-HI-CERT-DATE = LOW-VALUES
  9228           MOVE AL-UNNON         TO REMITA
  9229        ELSE
  9230           MOVE AL-SANON         TO REMITA
  9231     ELSE
  9232        MOVE AL-UNNON            TO REMITA.
  9233
  9234***  Y2K PROJ 7744
  9235     MOVE AM-ANNIVERSARY-DATE    TO DC-GREG-DATE-1-YMD.
  9236     MOVE '3'                    TO DC-OPTION-CODE.
  9237     PERFORM 9700-DATE-LINK.
  9238     IF DATE-CONVERSION-ERROR
  9239        MOVE SPACES              TO CONTRO
  9240     ELSE
  9241        MOVE DC-GREG-DATE-1-EDIT TO CONTRO
  9242     END-IF.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 177
* EL6501.cbl
  9243***  Y2K PROJ 7744
  9244
  9245*    MOVE PI-LIFE-OVERRIDE-L6    TO PSILFTO
  9246*    MOVE PI-AH-OVERRIDE-L6      TO PSIAHTO.
  9247
  9248*    IF AM-LF-PSI-FACTOR NUMERIC
  9249*       MOVE AM-LF-PSI-FACTOR    TO PSILFFO.
  9250*
  9251*    IF AM-AH-PSI-FACTOR NUMERIC
  9252*       MOVE AM-AH-PSI-FACTOR    TO PSIAHFO.
  9253
  9254     MOVE AM-RECALC-COMM         TO COMMCALO.
  9255     MOVE AL-UANON               TO COMMCALA.
  9256     MOVE AM-RECALC-REIN         TO REINCALO.
  9257     MOVE AM-REI-TABLE           TO REINTABO.
  9258     MOVE AM-1ST-PROD-DATE       TO DC-GREG-DATE-1-YMD.
  9259     MOVE '3'                    TO DC-OPTION-CODE.
  9260     PERFORM 9700-DATE-LINK.
  9261     IF DATE-CONVERSION-ERROR
  9262        MOVE SPACES              TO PRODATEO
  9263     ELSE
  9264        MOVE DC-GREG-DATE-1-EDIT TO PRODATEO.
  9265
  9266     IF PI-COMPANY-ID = 'DCC' or 'VPP'
  9267        IF AM-CLP-TOL-PCT NOT NUMERIC
  9268           MOVE ZEROS            TO AM-CLP-TOL-PCT
  9269        END-IF
  9270        IF AM-SPP-LEASE-COMM NOT NUMERIC
  9271           MOVE ZEROS            TO AM-SPP-LEASE-COMM
  9272        END-IF
  9273        MOVE AM-CLP-TOL-PCT      TO CLPTOLPO
  9274        MOVE AM-SPP-LEASE-COMM   TO LCOMMO
  9275        MOVE AM-DCC-PRODUCT-CODE TO PRODCDO
  9276        MOVE AM-DCC-CLP-STATE    TO CLPSTO
  9277        MOVE AL-UANON            TO CLPSTA
  9278        IF AM-DCC-MAX-MARKETING-FEE NOT NUMERIC
  9279           MOVE ZEROS            TO AM-DCC-MAX-MARKETING-FEE
  9280        END-IF
  9281        MOVE AM-DCC-MAX-MARKETING-FEE
  9282                                 TO MAXMFEEO
  9283     ELSE
  9284        MOVE AL-SADOF            TO CTPLABLA
  9285                                    CLPTOLPA
  9286                                    LCLABLA
  9287                                    LCOMMA
  9288     END-IF
  9289
  9290     IF AM-RET-Y-N = ' '  OR  'N'
  9291         MOVE 'NO '              TO RETROCDO
  9292     ELSE
  9293         MOVE 'YES'              TO RETROCDO.
  9294
  9295     IF AM-ACCOUNT-BILLED
  9296         MOVE 'YES'              TO BILLCDO
  9297     ELSE
  9298         MOVE 'NO '              TO BILLCDO.
  9299
  9300     MOVE AL-UANON               TO RETROCDA.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 178
* EL6501.cbl
  9301     MOVE AL-SANON               TO PRODATEA
  9302                                    BILLCDA.
  9303     MOVE AM-PREV-EFF-DT TO DC-GREG-DATE-1-YMD.
  9304     MOVE '3' TO DC-OPTION-CODE.
  9305     PERFORM 9700-DATE-LINK.
  9306     IF DATE-CONVERSION-ERROR
  9307        MOVE SPACES TO PEFFDTEO
  9308     ELSE
  9309        MOVE DC-GREG-DATE-1-EDIT TO PEFFDTEO.
  9310
  9311     IF AM-PREV-EXP-DT NOT = 99999999999
  9312        MOVE AM-PREV-EXP-DT TO DC-GREG-DATE-1-YMD
  9313        MOVE '3' TO DC-OPTION-CODE
  9314        PERFORM 9700-DATE-LINK
  9315        IF DATE-CONVERSION-ERROR
  9316           MOVE SPACES TO PEXPDTEO
  9317        ELSE
  9318           MOVE DC-GREG-DATE-1-EDIT TO PEXPDTEO
  9319     ELSE
  9320        MOVE '99/99/99' TO PEXPDTEO.
  9321
  9322     IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
  9323        MOVE AL-UANON            TO PEXPDTEA
  9324                                    PEFFDTEA
  9325        MOVE AL-SANOF TO            PDSPLYA.
  9326
  9327     MOVE LOW-VALUES             TO MAP-AGENT-AREA.
  9328     MOVE PI-COMM-POINTER        TO LCP-WS-ADDR-COMP
  9329     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  9330
  9331     MOVE 1  TO SUB.
  9332     SET M-INDEX TO 1.
  9333
  9334 6005-LOOP.
  9335     IF AM-AGT (SUB) = SPACES  OR ZEROS
  9336        IF PI-AR-PROCESSING
  9337           IF AM-AR-HI-CERT-DATE GREATER THAN LOW-VALUES
  9338              MOVE AL-SANOF     TO AGENTA  (M-INDEX)
  9339                                   ATYPEA (M-INDEX)
  9340                                   SINGLEA (M-INDEX)
  9341                                   JOINTA (M-INDEX)
  9342                                   A-HA    (M-INDEX)
  9343              GO TO 6010-BUMP-SUB
  9344           ELSE
  9345              GO TO 6010-BUMP-SUB
  9346        ELSE
  9347           GO TO 6010-BUMP-SUB.
  9348
  9349     MOVE AM-AGT (SUB)           TO AGENT (M-INDEX).
  9350
  9351***DMD CUSTOM CODE - CAPTURE THE FIRST AGENT TO BE DISPLAYED
  9352     IF WS-DMD-AGENT = LOW-VALUES
  9353        MOVE AM-AGT (SUB)        TO WS-DMD-AGENT.
  9354***DMD ******************************************************
  9355
  9356     IF PI-GA-BILLING
  9357        MOVE AM-AGT (SUB)        TO WK-AM-AGT (SUB).
  9358     MOVE AL-UANON               TO AGENTA (M-INDEX).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 179
* EL6501.cbl
  9359
  9360     MOVE AM-COM-TYP (SUB)       TO ATYPE (M-INDEX).
  9361     IF PI-GA-BILLING
  9362        MOVE AM-COM-TYP (SUB)    TO WK-AM-TYPE (SUB).
  9363     MOVE AL-UANON               TO ATYPEA (M-INDEX).
  9364
  9365     IF (AM-L-COM (SUB) NOT NUMERIC)
  9366        OR (AM-L-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9367        MOVE AM-L-COMA (SUB)     TO SINGLE-COMM-T (M-INDEX)
  9368     ELSE
  9369        IF AM-L-COM (SUB) NOT = ZEROS
  9370           MOVE AM-L-COM  (SUB)  TO SINGLE-COMM-O (M-INDEX).
  9371
  9372     IF (AM-J-COM (SUB) NOT NUMERIC)
  9373        OR (AM-J-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9374        MOVE AM-J-COMA (SUB)     TO JOINT-COMM-T (M-INDEX)
  9375     ELSE
  9376        IF AM-J-COM (SUB) NOT = ZEROS
  9377           MOVE AM-J-COM  (SUB)  TO JOINT-COMM-O (M-INDEX).
  9378
  9379     IF (AM-A-COM (SUB) NOT NUMERIC)
  9380        OR (AM-A-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9381        MOVE AM-A-COMA (SUB)     TO A-H-COMM-T (M-INDEX)
  9382     ELSE
  9383        IF AM-A-COM (SUB) NOT = ZEROS
  9384           MOVE AM-A-COM  (SUB)  TO A-H-COMM-O (M-INDEX).
  9385
  9386************************************************************
  9387**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  9388************************************************************
  9389
  9390     IF (AM-COM-TYP (SUB) NOT = 'C' AND 'D' AND 'O' AND 'P'
  9391            AND 'F' AND 'S' AND 'G' AND 'B' AND 'I'
  9392            AND 'K' AND 'L' AND 'J' AND 'M' AND 'A' AND 'N')
  9393         GO TO 6006-CONTINUE.
  9394
  9395     IF (AM-L-COM (SUB) NUMERIC)
  9396        AND (AM-L-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9397         ADD AM-L-COM (SUB) TO COMM-SL-ACCUM.
  9398
  9399     IF (AM-J-COM (SUB) NUMERIC)
  9400        AND (AM-J-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9401         ADD AM-J-COM (SUB) TO COMM-JL-ACCUM.
  9402
  9403     IF (AM-A-COM (SUB) NUMERIC)
  9404        AND (AM-A-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9405        ADD AM-A-COM (SUB) TO COMM-AH-ACCUM
  9406     END-IF
  9407     .
  9408 6006-CONTINUE.
  9409     IF WS-ST-COMM-CAP-SL NOT NUMERIC
  9410         MOVE ZEROS        TO WS-ST-COMM-CAP-SL.
  9411
  9412     IF WS-ST-COMM-CAP-SL = ZEROS
  9413        CONTINUE
  9414     ELSE
  9415        IF (AM-L-COM (SUB) NUMERIC)
  9416           AND (AM-L-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 180
* EL6501.cbl
  9417           IF (WS-LIMIT-TO-ACCOUNT AND
  9418              AM-L-COM (SUB) > WS-ST-COMM-CAP-SL)
  9419                       OR
  9420              (NOT WS-LIMIT-TO-ACCOUNT AND
  9421              COMM-SL-ACCUM > WS-ST-COMM-CAP-SL)
  9422              MOVE -1            TO MAINTL
  9423              MOVE ER-1884       TO EMI-ERROR
  9424              PERFORM 9900-ERROR-FORMAT
  9425                                 THRU 9900-EXIT
  9426           END-IF
  9427        ELSE
  9428           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9429           MOVE AM-L-COMA (SUB)  TO COMM-TABLE
  9430           MOVE PI-LIFE-OVERRIDE-L1
  9431                                 TO COMM-LF-AH
  9432           MOVE LOW-VALUES       TO COMM-FILLER
  9433           PERFORM 6400-READ-COMMISSION
  9434                                 THRU 6459-EXIT
  9435           IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  9436              MOVE -1            TO MAINTL
  9437              MOVE ER-1884       TO EMI-ERROR
  9438              PERFORM 9900-ERROR-FORMAT
  9439                                 THRU 9900-EXIT
  9440           END-IF
  9441        END-IF
  9442     END-IF
  9443
  9444     IF WS-ST-COMM-CAP-JL NOT NUMERIC
  9445         MOVE ZEROS        TO WS-ST-COMM-CAP-JL.
  9446
  9447     IF WS-ST-COMM-CAP-JL = ZEROS
  9448        CONTINUE
  9449     ELSE
  9450        IF (AM-J-COM (SUB) NUMERIC)
  9451           AND (AM-J-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9452           IF (WS-LIMIT-TO-ACCOUNT AND
  9453              AM-J-COM (SUB) > WS-ST-COMM-CAP-JL)
  9454                       OR
  9455              (NOT WS-LIMIT-TO-ACCOUNT AND
  9456              COMM-JL-ACCUM > WS-ST-COMM-CAP-JL)
  9457              MOVE -1            TO MAINTL
  9458              MOVE ER-1885       TO EMI-ERROR
  9459              PERFORM 9900-ERROR-FORMAT
  9460                                 THRU 9900-EXIT
  9461           END-IF
  9462        ELSE
  9463           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9464           MOVE AM-J-COMA (SUB)  TO COMM-TABLE
  9465           MOVE PI-LIFE-OVERRIDE-L1
  9466                                 TO COMM-LF-AH
  9467           MOVE LOW-VALUES       TO COMM-FILLER
  9468           PERFORM 6400-READ-COMMISSION
  9469                                 THRU 6459-EXIT
  9470           IF WS-TABLE-MAX > WS-ST-COMM-CAP-JL
  9471              MOVE -1            TO MAINTL
  9472              MOVE ER-1885       TO EMI-ERROR
  9473              PERFORM 9900-ERROR-FORMAT
  9474                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 181
* EL6501.cbl
  9475           END-IF
  9476        END-IF
  9477     END-IF
  9478
  9479     IF WS-ST-COMM-CAP-SA NOT NUMERIC
  9480         MOVE ZEROS        TO WS-ST-COMM-CAP-SA.
  9481
  9482     IF WS-ST-COMM-CAP-SA = ZEROS
  9483        CONTINUE
  9484     ELSE
  9485        IF (AM-A-COM (SUB) NUMERIC)
  9486           AND (AM-A-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9487           IF (WS-LIMIT-TO-ACCOUNT AND
  9488              AM-A-COM (SUB) > WS-ST-COMM-CAP-SA)
  9489                       OR
  9490              (NOT WS-LIMIT-TO-ACCOUNT AND
  9491              COMM-AH-ACCUM > WS-ST-COMM-CAP-SA)
  9492              MOVE -1            TO MAINTL
  9493              MOVE ER-1886       TO EMI-ERROR
  9494              PERFORM 9900-ERROR-FORMAT
  9495                                 THRU 9900-EXIT
  9496           END-IF
  9497        ELSE
  9498           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9499           MOVE AM-A-COMA (SUB)  TO COMM-TABLE
  9500           MOVE PI-AH-OVERRIDE-L1
  9501                                 TO COMM-LF-AH
  9502           MOVE LOW-VALUES       TO COMM-FILLER
  9503           PERFORM 6400-READ-COMMISSION
  9504                                 THRU 6459-EXIT
  9505           IF WS-TABLE-MAX > WS-ST-COMM-CAP-SA
  9506              MOVE -1            TO MAINTL
  9507              MOVE ER-1886       TO EMI-ERROR
  9508              PERFORM 9900-ERROR-FORMAT
  9509                                 THRU 9900-EXIT
  9510           END-IF
  9511        END-IF
  9512     END-IF
  9513
  9514     IF AM-RECALC-LV-INDIC (SUB) NOT = SPACE
  9515         MOVE AM-RECALC-LV-INDIC (SUB) TO RECAL (M-INDEX).
  9516
  9517     IF AM-RETRO-LV-INDIC (SUB) NOT = SPACE
  9518         MOVE AM-RETRO-LV-INDIC (SUB) TO RCOMM (M-INDEX).
  9519
  9520     IF AM-COMM-CHARGEBACK (SUB)  NUMERIC
  9521        NEXT SENTENCE
  9522     ELSE
  9523        MOVE ZEROS              TO  AM-COMM-CHARGEBACK (SUB).
  9524
  9525     IF AM-COMM-CHARGEBACK (SUB)   NOT  =    ZEROS
  9526         MOVE AM-COMM-CHARGEBACK (SUB) TO CHGBCK (M-INDEX).
  9527
  9528     IF AM-GL-CODES (SUB)   NOT  =    ZEROS
  9529         MOVE AM-GL-CODES (SUB)  TO  GLCODE (M-INDEX).
  9530
  9531     IF NOT PI-AR-PROCESSING
  9532        GO TO 6010-BUMP-SUB.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 182
* EL6501.cbl
  9533
  9534     IF AM-AR-HI-CERT-DATE = LOW-VALUES
  9535        GO TO 6010-BUMP-SUB.
  9536
  9537     MOVE AL-SANON              TO AGENTA  (M-INDEX)
  9538                                   ATYPEA  (M-INDEX)
  9539                                   SINGLEA (M-INDEX)
  9540                                   JOINTA  (M-INDEX)
  9541                                   A-HA    (M-INDEX).
  9542
  9543 6010-BUMP-SUB.
  9544     ADD 1  TO SUB.
  9545     SET M-INDEX UP BY 1.
  9546     IF SUB LESS 11
  9547        GO TO 6005-LOOP.
  9548
  9549 6099-EXIT.
  9550      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 183
* EL6501.cbl
  9552 6300-STARTBR.
  9553
  9554* EXEC CICS STARTBR
  9555*         DATASET   (ACCT-FILE-ID)
  9556*         RIDFLD    (WS-KEY-SAVE)
  9557*    END-EXEC.
  9558     MOVE 0
  9559       TO DFHEIV11
  9560*    MOVE '&,         G          &   #00008825' TO DFHEIV0
  9561     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9562     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9563     MOVE X'2020233030303038383235' TO DFHEIV0(25:11)
  9564     CALL 'kxdfhei1' USING DFHEIV0,
  9565           ACCT-FILE-ID,
  9566           WS-KEY-SAVE,
  9567           DFHEIV99,
  9568           DFHEIV11,
  9569           DFHEIV99
  9570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9571
  9572
  9573     MOVE 'Y'                    TO BROWSE-STARTED-SW.
  9574
  9575 6300-EXIT.
  9576      EXIT.
  9577
  9578 6310-READNEXT.
  9579
  9580* EXEC CICS READNEXT
  9581*         DATASET    (ACCT-FILE-ID)
  9582*         SET        (ADDRESS OF ACCOUNT-MASTER)
  9583*         RIDFLD     (WS-KEY-SAVE)
  9584*    END-EXEC.
  9585     MOVE 0
  9586       TO DFHEIV11
  9587*    MOVE '&.S                   )   #00008836' TO DFHEIV0
  9588     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9589     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9590     MOVE X'2020233030303038383336' TO DFHEIV0(25:11)
  9591     CALL 'kxdfhei1' USING DFHEIV0,
  9592           ACCT-FILE-ID,
  9593           DFHEIV20,
  9594           DFHEIV99,
  9595           WS-KEY-SAVE,
  9596           DFHEIV99,
  9597           DFHEIV11,
  9598           DFHEIV99,
  9599           DFHEIV99
  9600     SET ADDRESS OF ACCOUNT-MASTER TO
  9601         DFHEIV20
  9602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9603
  9604
  9605 6310-EXIT.
  9606      EXIT.
  9607
  9608 6320-ENDBR.
  9609     MOVE SPACE               TO BROWSE-STARTED-SW.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 184
* EL6501.cbl
  9610
  9611* EXEC CICS ENDBR
  9612*        DATASET(ACCT-FILE-ID)
  9613*    END-EXEC.
  9614     MOVE 0
  9615       TO DFHEIV11
  9616*    MOVE '&2                    $   #00008847' TO DFHEIV0
  9617     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9618     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9619     MOVE X'2020233030303038383437' TO DFHEIV0(25:11)
  9620     CALL 'kxdfhei1' USING DFHEIV0,
  9621           ACCT-FILE-ID,
  9622           DFHEIV11,
  9623           DFHEIV99
  9624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9625
  9626
  9627 6320-EXIT.
  9628      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 185
* EL6501.cbl
  9630 6400-READ-COMMISSION.
  9631     MOVE ZEROS                  TO WS-COMM-ERROR-SW
  9632
  9633* EXEC CICS HANDLE CONDITION
  9634*         NOTFND   (6450-NOT-FOUND)
  9635*    END-EXEC
  9636*    MOVE '"$I                   ! . #00008856' TO DFHEIV0
  9637     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9638     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9639     MOVE X'2E20233030303038383536' TO DFHEIV0(25:11)
  9640     CALL 'kxdfhei1' USING DFHEIV0
  9641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9642
  9643
  9644* EXEC CICS READ
  9645*        GTEQ
  9646*        DATASET   (COMM-FILE-ID)
  9647*        SET       (ADDRESS OF COMM-TABLE-RECORD)
  9648*        RIDFLD    (COMM-KEY)
  9649*    END-EXEC
  9650*    MOVE '&"S        G          (   #00008860' TO DFHEIV0
  9651     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9652     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9653     MOVE X'2020233030303038383630' TO DFHEIV0(25:11)
  9654     CALL 'kxdfhei1' USING DFHEIV0,
  9655           COMM-FILE-ID,
  9656           DFHEIV20,
  9657           DFHEIV99,
  9658           COMM-KEY,
  9659           DFHEIV99,
  9660           DFHEIV99,
  9661           DFHEIV99
  9662     SET ADDRESS OF COMM-TABLE-RECORD TO
  9663         DFHEIV20
  9664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9665
  9666     IF CT-COMPANY-CD = PI-COMPANY-CD AND
  9667        CT-TABLE      = COMM-TABLE    AND
  9668        CT-BEN-TYPE   = COMM-LF-AH
  9669        PERFORM 6460-CHECK-MAX THRU 6460-EXIT
  9670        GO TO 6459-EXIT
  9671     END-IF
  9672     .
  9673 6450-NOT-FOUND.
  9674     MOVE ER-2176                TO EMI-ERROR.
  9675     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9676     MOVE 1  TO WS-COMM-ERROR-SW.
  9677
  9678 6459-EXIT.
  9679      EXIT.
  9680
  9681 6460-CHECK-MAX.
  9682
  9683
  9684* EXEC CICS STARTBR
  9685*         DATASET   (COMM-FILE-ID)
  9686*         RIDFLD    (COMM-KEY)
  9687*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 186
* EL6501.cbl
  9688*    END-EXEC
  9689     MOVE 0
  9690       TO DFHEIV11
  9691*    MOVE '&,         G          &  N#00008884' TO DFHEIV0
  9692     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9693     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9694     MOVE X'204E233030303038383834' TO DFHEIV0(25:11)
  9695     CALL 'kxdfhei1' USING DFHEIV0,
  9696           COMM-FILE-ID,
  9697           COMM-KEY,
  9698           DFHEIV99,
  9699           DFHEIV11,
  9700           DFHEIV99
  9701     MOVE EIBRESP  TO WS-RESPONSE
  9702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9703
  9704     MOVE SPACES          TO WS-STATE-MAX-SW
  9705
  9706     IF RESP-NORMAL
  9707        MOVE LOW-VALUES          TO COMM-FILLER
  9708        MOVE COMM-KEY            TO WS-HOLD-COMM-KEY
  9709        MOVE ZEROS               TO WS-TABLE-MAX
  9710        PERFORM UNTIL
  9711              (NOT RESP-NORMAL) OR
  9712              (COMM-KEY (1:5) NOT = WS-HOLD-COMM-KEY (1:5))
  9713
  9714* EXEC CICS READNEXT
  9715*             DATASET   (COMM-FILE-ID)
  9716*             SET       (ADDRESS OF COMM-TABLE-RECORD)
  9717*             RIDFLD    (COMM-KEY)
  9718*             RESP      (WS-RESPONSE)
  9719*           END-EXEC
  9720     MOVE 0
  9721       TO DFHEIV11
  9722*    MOVE '&.S                   )  N#00008899' TO DFHEIV0
  9723     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9724     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9725     MOVE X'204E233030303038383939' TO DFHEIV0(25:11)
  9726     CALL 'kxdfhei1' USING DFHEIV0,
  9727           COMM-FILE-ID,
  9728           DFHEIV20,
  9729           DFHEIV99,
  9730           COMM-KEY,
  9731           DFHEIV99,
  9732           DFHEIV11,
  9733           DFHEIV99,
  9734           DFHEIV99
  9735     SET ADDRESS OF COMM-TABLE-RECORD TO
  9736         DFHEIV20
  9737     MOVE EIBRESP  TO WS-RESPONSE
  9738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9739            IF (RESP-NORMAL) AND
  9740               (COMM-KEY (1:5) = WS-HOLD-COMM-KEY (1:5))
  9741               PERFORM VARYING WS-NDX FROM +1 BY +1 UNTIL
  9742                   (WS-NDX > +27)
  9743                   IF CT-RT (WS-NDX) > WS-TABLE-MAX
  9744                      MOVE CT-RT (WS-NDX)
  9745                                 TO WS-TABLE-MAX
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 187
* EL6501.cbl
  9746                   END-IF
  9747               END-PERFORM
  9748            END-IF
  9749        END-PERFORM
  9750
  9751* EXEC CICS ENDBR
  9752*            DATASET   (COMM-FILE-ID)
  9753*       END-EXEC
  9754     MOVE 0
  9755       TO DFHEIV11
  9756*    MOVE '&2                    $   #00008916' TO DFHEIV0
  9757     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9758     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9759     MOVE X'2020233030303038393136' TO DFHEIV0(25:11)
  9760     CALL 'kxdfhei1' USING DFHEIV0,
  9761           COMM-FILE-ID,
  9762           DFHEIV11,
  9763           DFHEIV99
  9764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9765     END-IF
  9766
  9767     .
  9768 6460-EXIT.
  9769      EXIT.
  9770
  9771
  9772 6500-READ-ACCT.
  9773
  9774* EXEC CICS READ
  9775*        GTEQ
  9776*        DATASET   (ACCT-FILE-ID)
  9777*        SET       (ADDRESS OF ACCOUNT-MASTER)
  9778*        RIDFLD    (PI-ACCT-KEY)
  9779*    END-EXEC.
  9780*    MOVE '&"S        G          (   #00008927' TO DFHEIV0
  9781     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9782     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9783     MOVE X'2020233030303038393237' TO DFHEIV0(25:11)
  9784     CALL 'kxdfhei1' USING DFHEIV0,
  9785           ACCT-FILE-ID,
  9786           DFHEIV20,
  9787           DFHEIV99,
  9788           PI-ACCT-KEY,
  9789           DFHEIV99,
  9790           DFHEIV99,
  9791           DFHEIV99
  9792     SET ADDRESS OF ACCOUNT-MASTER TO
  9793         DFHEIV20
  9794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9795
  9796
  9797 6599-EXIT.
  9798      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 188
* EL6501.cbl
  9800 6600-UPDATE-MAINT-DT.
  9801     MOVE SPACES                 TO ELCNTL-KEY.
  9802
  9803     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9804     MOVE '1'                    TO CNTL-REC-TYPE.
  9805     MOVE +0                     TO CNTL-SEQ-NO.
  9806
  9807
  9808* EXEC CICS HANDLE CONDITION
  9809*        NOTFND   (6699-EXIT)
  9810*    END-EXEC.
  9811*    MOVE '"$I                   ! / #00008944' TO DFHEIV0
  9812     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9813     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9814     MOVE X'2F20233030303038393434' TO DFHEIV0(25:11)
  9815     CALL 'kxdfhei1' USING DFHEIV0
  9816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9817
  9818
  9819
  9820* EXEC CICS READ
  9821*        UPDATE
  9822*        DATASET   (CNTL-FILE-ID)
  9823*        SET       (ADDRESS OF CONTROL-FILE)
  9824*        RIDFLD    (ELCNTL-KEY)
  9825*    END-EXEC.
  9826*    MOVE '&"S        EU         (   #00008948' TO DFHEIV0
  9827     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9828     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9829     MOVE X'2020233030303038393438' TO DFHEIV0(25:11)
  9830     CALL 'kxdfhei1' USING DFHEIV0,
  9831           CNTL-FILE-ID,
  9832           DFHEIV20,
  9833           DFHEIV99,
  9834           ELCNTL-KEY,
  9835           DFHEIV99,
  9836           DFHEIV99,
  9837           DFHEIV99
  9838     SET ADDRESS OF CONTROL-FILE TO
  9839         DFHEIV20
  9840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9841
  9842
  9843     MOVE BIN-CURRENT-SAVE       TO CF-ACCOUNT-MSTR-MAINT-DT.
  9844
  9845
  9846* EXEC CICS REWRITE
  9847*        DATASET   (CNTL-FILE-ID)
  9848*        FROM      (CONTROL-FILE)
  9849*    END-EXEC.
  9850     MOVE LENGTH OF
  9851      CONTROL-FILE
  9852       TO DFHEIV11
  9853*    MOVE '&& L                  %   #00008957' TO DFHEIV0
  9854     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9855     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9856     MOVE X'2020233030303038393537' TO DFHEIV0(25:11)
  9857     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 189
* EL6501.cbl
  9858           CNTL-FILE-ID,
  9859           CONTROL-FILE,
  9860           DFHEIV11,
  9861           DFHEIV99
  9862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9863
  9864
  9865 6699-EXIT.
  9866      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 190
* EL6501.cbl
  9868 6700-BUILD-COMM-WORK.
  9869     IF NOT PI-GA-BILLING
  9870         GO TO 6799-EXIT.
  9871
  9872
  9873* EXEC CICS GETMAIN
  9874*         LENGTH   (260)
  9875*         SET      (ADDRESS OF COMMISSION-WORK-AREA)
  9876*         INITIMG  (GETMAIN-SPACE)
  9877*     END-EXEC.
  9878     MOVE 260
  9879       TO DFHEIV11
  9880*    MOVE ',"IL                  $   #00008969' TO DFHEIV0
  9881     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9882     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9883     MOVE X'2020233030303038393639' TO DFHEIV0(25:11)
  9884     CALL 'kxdfhei1' USING DFHEIV0,
  9885           DFHEIV20,
  9886           DFHEIV11,
  9887           GETMAIN-SPACE
  9888     SET ADDRESS OF COMMISSION-WORK-AREA TO
  9889         DFHEIV20
  9890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9891
  9892     SET LCP-WS-ADDR-PNTR TO ADDRESS OF COMMISSION-WORK-AREA
  9893
  9894     MOVE LCP-WS-ADDR-COMP TO PI-COMM-POINTER.
  9895     MOVE SPACES             TO COMMISSION-WORK-AREA.
  9896     MOVE 'X'                TO COMMISSION-GETMAIN-SW.
  9897
  9898     IF PI-MAINT = 'A'
  9899         GO TO 6799-EXIT.
  9900
  9901     MOVE AM-COMM-STRUCTURE TO COMMISSION-WORK-AREA.
  9902     MOVE +1                TO AXRF-SUB.
  9903
  9904 6710-AXRF-LOOP.
  9905     MOVE SPACES         TO AGENT-FIND.
  9906     MOVE ERGXRF-MAX-LEN TO ERGXRF-REC-LEN.
  9907
  9908     PERFORM 6920-READ-AXRF-FILE THRU 6929-EXIT.
  9909
  9910     IF AGENT-FIND = SPACES
  9911        MOVE GX-LAST-BILL-DT (GX-AGENT-SUB) TO
  9912             WK-GA-BILL-DT (AXRF-SUB)
  9913     ELSE
  9914        MOVE LOW-VALUES TO WK-GA-BILL-DT (AXRF-SUB).
  9915
  9916     ADD +1 TO AXRF-SUB.
  9917
  9918     IF AXRF-SUB NOT = +11
  9919        GO TO 6710-AXRF-LOOP.
  9920
  9921 6799-EXIT.
  9922     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 191
* EL6501.cbl
  9924 6800-COMPANY-REC-READ.
  9925     MOVE SPACES                 TO ELCNTL-KEY.
  9926     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9927     MOVE '1'                    TO CNTL-REC-TYPE.
  9928     MOVE +0                     TO CNTL-SEQ-NO.
  9929
  9930* EXEC CICS HANDLE CONDITION
  9931*        NOTFND   (6880-NO-COMP)
  9932*    END-EXEC.
  9933*    MOVE '"$I                   ! 0 #00009011' TO DFHEIV0
  9934     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9935     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9936     MOVE X'3020233030303039303131' TO DFHEIV0(25:11)
  9937     CALL 'kxdfhei1' USING DFHEIV0
  9938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9939
  9940
  9941
  9942* EXEC CICS READ
  9943*        DATASET   (CNTL-FILE-ID)
  9944*        SET       (ADDRESS OF CONTROL-FILE)
  9945*        RIDFLD    (ELCNTL-KEY)
  9946*    END-EXEC.
  9947*    MOVE '&"S        E          (   #00009015' TO DFHEIV0
  9948     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9949     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9950     MOVE X'2020233030303039303135' TO DFHEIV0(25:11)
  9951     CALL 'kxdfhei1' USING DFHEIV0,
  9952           CNTL-FILE-ID,
  9953           DFHEIV20,
  9954           DFHEIV99,
  9955           ELCNTL-KEY,
  9956           DFHEIV99,
  9957           DFHEIV99,
  9958           DFHEIV99
  9959     SET ADDRESS OF CONTROL-FILE TO
  9960         DFHEIV20
  9961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9962
  9963
  9964     IF CF-ACCOUNT-MSTR-MAINT-DT = LOW-VALUES
  9965         MOVE ER-2572               TO EMI-ERROR
  9966         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9967
  9968     GO TO 6899-EXIT.
  9969
  9970 6880-NO-COMP.
  9971     MOVE ER-0002                TO EMI-ERROR.
  9972     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9973
  9974 6899-EXIT.
  9975     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 192
* EL6501.cbl
  9977 6900-READ-AND-CHECK-AXRF.
  9978     IF NOT PI-GA-BILLING
  9979        GO TO 6999-EXIT.
  9980
  9981     MOVE PI-COMM-POINTER TO LCP-WS-ADDR-COMP
  9982     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  9983
  9984 6905-AGENT-LEVEL-LOOP.
  9985     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
  9986     MOVE SPACES TO AGENT-FIND.
  9987     IF ((AM-AGT (AXRF-SUB) NOT = WK-AM-AGT (AXRF-SUB))
  9988      OR
  9989        (AM-COM-TYP (AXRF-SUB) NOT = WK-AM-TYPE (AXRF-SUB)))
  9990      AND
  9991        ((AM-COM-TYP (AXRF-SUB) = 'O' OR 'P' OR 'G'
  9992                             OR 'B' OR 'I'
  9993                             OR 'K' OR 'L' OR 'J' OR 'M'
  9994                             OR 'S' OR 'A' OR 'N')
  9995                            OR
  9996        (WK-AM-TYPE (AXRF-SUB) = 'O' OR 'P' OR 'G' OR
  9997                'B' OR 'I' OR 'K' OR 'L' OR 'J' OR 'M'
  9998                                  OR 'S' OR 'A' OR 'N'))
  9999            PERFORM 6920-READ-AXRF-FILE THRU 6929-EXIT
 10000            IF AGENT-RECORD-NOT-FOUND
 10001               PERFORM 6950-ADD-AGENT-RECORD THRU 6959-EXIT
 10002           ELSE
 10003            IF ACCT-RECORD-NOT-FOUND OR ACCT-LEVEL-DIFFERENT
 10004               PERFORM 6970-REWRITE-AGENT-RECORD THRU 6979-EXIT
 10005           ELSE
 10006        IF (AM-COM-TYP (AXRF-SUB) NOT = 'O' AND 'P' AND 'G'
 10007              AND 'B' AND 'I' AND 'S'
 10008              AND 'K' AND 'L' AND 'J' AND 'M' AND 'A' AND 'N') OR
 10009           (AM-AGT (AXRF-SUB) NOT =
 10010                   WK-AM-AGT (AXRF-SUB))
 10011           PERFORM 7000-DELETE-AXRF-REC THRU 7999-EXIT
 10012           GO TO 6910-INC-SUB.
 10013
 10014     MOVE SPACES TO AGENT-FIND.
 10015     IF (AM-AGT (AXRF-SUB) NOT = WK-AM-AGT (AXRF-SUB)) AND
 10016        (WK-AM-AGT (AXRF-SUB) NOT = LOW-VALUES AND
 10017                               SPACES AND ZEROS)
 10018          MOVE WK-AM-AGT (AXRF-SUB)   TO WS-AXRF-AGENT-NO
 10019          MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN
 10020          PERFORM 6921-READ-AXRF THRU 6929-EXIT
 10021          IF AGENT-FIND = SPACES
 10022              PERFORM 7000-DELETE-AXRF-REC THRU 7999-EXIT.
 10023
 10024 6910-INC-SUB.
 10025     ADD +1                      TO AXRF-SUB.
 10026     IF AXRF-SUB NOT = +11
 10027        GO TO 6905-AGENT-LEVEL-LOOP.
 10028
 10029     GO TO 6999-EXIT.
 10030
 10031 6920-READ-AXRF-FILE.
 10032*    IF GETMAIN-SW = 'X'
 10033*       GO TO 6920-BUILD-KEY.
 10034*
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 193
* EL6501.cbl
 10035*    EXEC CICS GETMAIN
 10036*         LENGTH   (ERGXRF-REC-LEN)
 10037*         SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
 10038*         INITIMG  (GETMAIN-SPACE)
 10039*    END-EXEC.
 10040*
 10041*    MOVE 'X' TO GETMAIN-SW.
 10042
 10043 6920-BUILD-KEY.
 10044     MOVE PI-COMPANY-CD          TO WS-AXRF-COMPANY-CD.
 10045
 10046     IF PI-ZERO-CARRIER
 10047       OR PI-ZERO-CAR-GROUP
 10048         MOVE ZERO               TO WS-AXRF-CARRIER
 10049     ELSE
 10050         MOVE AM-CARRIER         TO WS-AXRF-CARRIER.
 10051
 10052     IF PI-ZERO-GROUPING
 10053       OR PI-ZERO-CAR-GROUP
 10054         MOVE ZEROS              TO WS-AXRF-GROUPING
 10055     ELSE
 10056         MOVE AM-GROUPING        TO WS-AXRF-GROUPING.
 10057
 10058     IF AM-AGT (AXRF-SUB) NOT = SPACES AND ZEROS AND
 10059                                              LOW-VALUES
 10060        MOVE AM-AGT (AXRF-SUB) TO WS-AXRF-AGENT-NO
 10061     ELSE
 10062     IF WK-AM-AGT (AXRF-SUB) NOT = SPACES AND ZEROS AND
 10063                                              LOW-VALUES
 10064        MOVE WK-AM-AGT (AXRF-SUB) TO WS-AXRF-AGENT-NO
 10065     ELSE
 10066        MOVE 'X' TO AGENT-FIND
 10067        GO TO 6929-EXIT.
 10068
 10069     MOVE +1 TO GX-AGENT-SUB.
 10070
 10071 6921-READ-AXRF.
 10072
 10073* EXEC CICS HANDLE CONDITION
 10074*         ENDFILE     (6925-NOT-FIND)
 10075*         NOTFND      (6925-NOT-FIND)
 10076*    END-EXEC.
 10077*    MOVE '"$''I                  ! 1 #00009129' TO DFHEIV0
 10078     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10079     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10080     MOVE X'3120233030303039313239' TO DFHEIV0(25:11)
 10081     CALL 'kxdfhei1' USING DFHEIV0
 10082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10083
 10084
 10085
 10086* EXEC CICS READ
 10087*        DATASET   (ERGXRF-FILE-ID)
 10088*        LENGTH    (ERGXRF-REC-LEN)
 10089*        INTO      (AGENT-CROSS-REFERENCE)
 10090*        RIDFLD    (WS-AXRF-KEY)
 10091*        EQUAL
 10092*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 194
* EL6501.cbl
 10093*    MOVE '&"IL       E          (   #00009134' TO DFHEIV0
 10094     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10095     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10096     MOVE X'2020233030303039313334' TO DFHEIV0(25:11)
 10097     CALL 'kxdfhei1' USING DFHEIV0,
 10098           ERGXRF-FILE-ID,
 10099           AGENT-CROSS-REFERENCE,
 10100           ERGXRF-REC-LEN,
 10101           WS-AXRF-KEY,
 10102           DFHEIV99,
 10103           DFHEIV99,
 10104           DFHEIV99
 10105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10106
 10107
 10108     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10109
 10110     PERFORM 6921-FIND-ACCT-LOOP VARYING GX-AGENT-SUB
 10111             FROM +1 BY +1 UNTIL
 10112         (GX-AGENT-SUB GREATER THAN GX-AGENT-POINTER-CNT) OR
 10113         (GX-AM-ACCOUNT (GX-AGENT-SUB) = AM-ACCOUNT      AND
 10114         GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = AM-EXPIRATION-DT
 10115         AND
 10116         GX-AM-EFF-DT (GX-AGENT-SUB)   = AM-EFFECTIVE-DT AND
 10117         GX-AM-CARRIER (GX-AGENT-SUB)  = AM-CARRIER      AND
 10118         GX-AM-GROUPING (GX-AGENT-SUB) = AM-GROUPING     AND
 10119         GX-AM-STATE (GX-AGENT-SUB)    = AM-STATE).
 10120
 10121     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
 10122        MOVE 'Y' TO AGENT-FIND
 10123        GO TO 6929-EXIT.
 10124
 10125     IF GX-AM-LEVEL-NO (GX-AGENT-SUB) NOT = AXRF-SUB
 10126        MOVE 'Z' TO AGENT-FIND.
 10127
 10128     GO TO 6929-EXIT.
 10129
 10130 6921-FIND-ACCT-LOOP.
 10131***  DUMMY PARAGRAPH  ***
 10132
 10133 6925-NOT-FIND.
 10134     MOVE 'X' TO AGENT-FIND.
 10135
 10136 6929-EXIT.
 10137     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 195
* EL6501.cbl
 10139 6950-ADD-AGENT-RECORD.
 10140     IF AM-AGT (AXRF-SUB) = SPACES OR ZEROS
 10141        GO TO 6959-EXIT.
 10142
 10143     MOVE +109                   TO ERGXRF-REC-LEN.
 10144
 10145     MOVE +1                     TO GX-AGENT-POINTER-CNT.
 10146     MOVE 'GX'                   TO GX-RECORD-ID.
 10147     MOVE AM-COMPANY-CD          TO GX-COMPANY-CD.
 10148
 10149     IF PI-ZERO-CARRIER
 10150       OR PI-ZERO-CAR-GROUP
 10151         MOVE ZERO               TO GX-CARRIER
 10152     ELSE
 10153         MOVE AM-CARRIER         TO GX-CARRIER.
 10154
 10155     IF PI-ZERO-GROUPING
 10156       OR PI-ZERO-CAR-GROUP
 10157         MOVE ZERO               TO GX-GROUPING
 10158     ELSE
 10159         MOVE AM-GROUPING        TO GX-GROUPING.
 10160
 10161     MOVE AM-AGT (AXRF-SUB)      TO GX-AGENT-NO.
 10162
 10163     MOVE AM-CARRIER             TO GX-AM-CARRIER (1).
 10164     MOVE AM-GROUPING            TO GX-AM-GROUPING (1).
 10165     MOVE AM-STATE               TO GX-AM-STATE (1).
 10166     MOVE AM-ACCOUNT             TO GX-AM-ACCOUNT (1).
 10167     MOVE AM-EXPIRATION-DT       TO GX-AM-EXPIRATION-DT (1).
 10168     MOVE AM-EFFECTIVE-DT        TO GX-AM-EFF-DT (1).
 10169     MOVE AXRF-SUB               TO GX-AM-LEVEL-NO (1).
 10170     MOVE LOW-VALUES             TO GX-LAST-BILL-DT (1).
 10171
 10172     MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT.
 10173     MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS.
 10174     MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER.
 10175
 10176
 10177* EXEC CICS WRITE
 10178*        FROM      (AGENT-CROSS-REFERENCE)
 10179*        LENGTH    (ERGXRF-REC-LEN)
 10180*        RIDFLD    (GX-CONTROL-PRIMARY)
 10181*        DATASET   (ERGXRF-FILE-ID)
 10182*    END-EXEC.
 10183*    MOVE '&$ L                  ''   #00009210' TO DFHEIV0
 10184     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10185     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10186     MOVE X'2020233030303039323130' TO DFHEIV0(25:11)
 10187     CALL 'kxdfhei1' USING DFHEIV0,
 10188           ERGXRF-FILE-ID,
 10189           AGENT-CROSS-REFERENCE,
 10190           ERGXRF-REC-LEN,
 10191           GX-CONTROL-PRIMARY,
 10192           DFHEIV99,
 10193           DFHEIV99
 10194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10195
 10196
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 196
* EL6501.cbl
 10197 6959-EXIT.
 10198      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 197
* EL6501.cbl
 10200 6970-REWRITE-AGENT-RECORD.
 10201     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
 10202
 10203
 10204* EXEC CICS READ
 10205*        DATASET   (ERGXRF-FILE-ID)
 10206*        INTO      (AGENT-CROSS-REFERENCE)
 10207*        LENGTH    (ERGXRF-REC-LEN)
 10208*        RIDFLD    (WS-AXRF-KEY)
 10209*        EQUAL
 10210*        UPDATE
 10211*    END-EXEC.
 10212*    MOVE '&"IL       EU         (   #00009223' TO DFHEIV0
 10213     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10214     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10215     MOVE X'2020233030303039323233' TO DFHEIV0(25:11)
 10216     CALL 'kxdfhei1' USING DFHEIV0,
 10217           ERGXRF-FILE-ID,
 10218           AGENT-CROSS-REFERENCE,
 10219           ERGXRF-REC-LEN,
 10220           WS-AXRF-KEY,
 10221           DFHEIV99,
 10222           DFHEIV99,
 10223           DFHEIV99
 10224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10225
 10226
 10227     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10228
 10229     IF ACCT-LEVEL-DIFFERENT
 10230        GO TO 6975-UPDATE-LEVEL-NO.
 10231
 10232     IF GX-AGENT-POINTER-CNT = +1006
 10233         GO TO 6979-EXIT.
 10234
 10235     MOVE +1 TO FIND-AGENT-SUB1.
 10236
 10237 6972-FIND-REC-LOCATION.
 10238     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB1) TO GX-REST-OF-KEY.
 10239     MOVE AM-COMPANY-CD TO GX-AM-COMPANY-CD.
 10240
 10241     IF (GX-AM-CONTROL-PRIMARY GREATER AM-CONTROL-PRIMARY)  OR
 10242        (FIND-AGENT-SUB1 GREATER GX-AGENT-POINTER-CNT)
 10243        NEXT SENTENCE
 10244     ELSE
 10245        ADD +1 TO FIND-AGENT-SUB1
 10246        GO TO 6972-FIND-REC-LOCATION.
 10247
 10248     MOVE GX-AGENT-POINTER-CNT TO FIND-AGENT-SUB2
 10249                                  FIND-AGENT-SUB3.
 10250     ADD +1 TO FIND-AGENT-SUB3.
 10251
 10252     IF FIND-AGENT-SUB1 GREATER GX-AGENT-POINTER-CNT
 10253        NEXT SENTENCE
 10254     ELSE
 10255        PERFORM 6977-BUMP-AXRF-REC VARYING FIND-AGENT-SUB2
 10256        FROM FIND-AGENT-SUB2 BY -1 UNTIL
 10257        FIND-AGENT-SUB3 = FIND-AGENT-SUB1.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 198
* EL6501.cbl
 10258
 10259     ADD ERGXRF-INC-LEN          TO ERGXRF-REC-LEN.
 10260     ADD  +1                     TO GX-AGENT-POINTER-CNT.
 10261
 10262     MOVE AM-CARRIER  TO GX-AM-CARRIER (FIND-AGENT-SUB3).
 10263     MOVE AM-GROUPING TO GX-AM-GROUPING (FIND-AGENT-SUB3).
 10264
 10265     MOVE AM-STATE    TO GX-AM-STATE (FIND-AGENT-SUB3).
 10266     MOVE AM-ACCOUNT  TO GX-AM-ACCOUNT (FIND-AGENT-SUB3).
 10267     MOVE AM-EXPIRATION-DT TO
 10268                  GX-AM-EXPIRATION-DT (FIND-AGENT-SUB3).
 10269     MOVE AM-EFFECTIVE-DT  TO
 10270                  GX-AM-EFF-DT (FIND-AGENT-SUB3).
 10271     MOVE AXRF-SUB    TO GX-AM-LEVEL-NO (FIND-AGENT-SUB3).
 10272     MOVE LOW-VALUES  TO GX-LAST-BILL-DT (FIND-AGENT-SUB3).
 10273
 10274 6975-UPDATE-LEVEL-NO.
 10275     MOVE AXRF-SUB TO GX-AM-LEVEL-NO (GX-AGENT-SUB).
 10276     MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT.
 10277     MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS.
 10278     MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER.
 10279     compute ergxrf-rec-len = (gx-agent-pointer-cnt * +31) + +78
 10280     if ergxrf-rec-len > +31264
 10281        move +31264               to ergxrf-rec-len
 10282        move +1006                to gx-agent-pointer-cnt
 10283     end-if
 10284
 10285
 10286* EXEC CICS REWRITE
 10287*        FROM      (AGENT-CROSS-REFERENCE)
 10288*        LENGTH    (ERGXRF-REC-LEN)
 10289*        DATASET   (ERGXRF-FILE-ID)
 10290*    END-EXEC.
 10291*    MOVE '&& L                  %   #00009290' TO DFHEIV0
 10292     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10293     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10294     MOVE X'2020233030303039323930' TO DFHEIV0(25:11)
 10295     CALL 'kxdfhei1' USING DFHEIV0,
 10296           ERGXRF-FILE-ID,
 10297           AGENT-CROSS-REFERENCE,
 10298           ERGXRF-REC-LEN,
 10299           DFHEIV99
 10300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10301
 10302
 10303     GO TO 6979-EXIT.
 10304
 10305 6977-BUMP-AXRF-REC.
 10306     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB2) TO
 10307          GX-AGENT-POINTER (FIND-AGENT-SUB3).
 10308
 10309     SUBTRACT +1 FROM FIND-AGENT-SUB3.
 10310
 10311 6979-EXIT.
 10312     EXIT.
 10313
 10314 6999-EXIT.
 10315     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 199
* EL6501.cbl
 10317 7000-DELETE-AXRF-REC.
 10318     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
 10319
 10320
 10321* EXEC CICS HANDLE CONDITION
 10322*         ENDFILE     (7999-EXIT)
 10323*         NOTFND      (7999-EXIT)
 10324*    END-EXEC.
 10325*    MOVE '"$''I                  ! 2 #00009313' TO DFHEIV0
 10326     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10327     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10328     MOVE X'3220233030303039333133' TO DFHEIV0(25:11)
 10329     CALL 'kxdfhei1' USING DFHEIV0
 10330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10331
 10332
 10333
 10334* EXEC CICS READ
 10335*        DATASET   (ERGXRF-FILE-ID)
 10336*        INTO      (AGENT-CROSS-REFERENCE)
 10337*        LENGTH    (ERGXRF-REC-LEN)
 10338*        RIDFLD    (WS-AXRF-KEY)
 10339*        EQUAL
 10340*        UPDATE
 10341*    END-EXEC.
 10342*    MOVE '&"IL       EU         (   #00009318' TO DFHEIV0
 10343     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10344     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10345     MOVE X'2020233030303039333138' TO DFHEIV0(25:11)
 10346     CALL 'kxdfhei1' USING DFHEIV0,
 10347           ERGXRF-FILE-ID,
 10348           AGENT-CROSS-REFERENCE,
 10349           ERGXRF-REC-LEN,
 10350           WS-AXRF-KEY,
 10351           DFHEIV99,
 10352           DFHEIV99,
 10353           DFHEIV99
 10354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10355
 10356
 10357     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10358
 10359     IF GX-AGENT-SUB = +0
 10360        PERFORM 6921-FIND-ACCT-LOOP VARYING GX-AGENT-SUB
 10361        FROM +1 BY +1 UNTIL
 10362         (GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT) OR
 10363         (GX-AM-ACCOUNT (GX-AGENT-SUB) = AM-ACCOUNT  AND
 10364         GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = AM-EXPIRATION-DT
 10365         AND
 10366         GX-AM-EFF-DT (GX-AGENT-SUB)   = AM-EFFECTIVE-DT AND
 10367         GX-AM-CARRIER (GX-AGENT-SUB)  = AM-CARRIER      AND
 10368         GX-AM-GROUPING (GX-AGENT-SUB) = AM-GROUPING     AND
 10369         GX-AM-STATE (GX-AGENT-SUB)    = AM-STATE).
 10370
 10371     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
 10372        GO TO 7999-EXIT.
 10373
 10374     MOVE GX-AGENT-SUB TO FIND-AGENT-SUB1.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 200
* EL6501.cbl
 10375     PERFORM 7010-BUMP-RECORDS VARYING GX-AGENT-SUB
 10376                                  FROM GX-AGENT-SUB BY +1 UNTIL
 10377                            GX-AGENT-SUB = GX-AGENT-POINTER-CNT.
 10378     SUBTRACT ERGXRF-INC-LEN FROM ERGXRF-REC-LEN.
 10379     SUBTRACT +1             FROM GX-AGENT-POINTER-CNT.
 10380     GO TO 7020-REWRITE-AXRF-RECORD.
 10381
 10382 7010-BUMP-RECORDS.
 10383     ADD +1 TO FIND-AGENT-SUB1.
 10384     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB1) TO
 10385          GX-AGENT-POINTER (GX-AGENT-SUB).
 10386
 10387 7020-REWRITE-AXRF-RECORD.
 10388     IF GX-AGENT-POINTER-CNT = +0
 10389
 10390* EXEC CICS DELETE
 10391*            DATASET   (ERGXRF-FILE-ID)
 10392*       END-EXEC
 10393*    MOVE '&(                    &   #00009359' TO DFHEIV0
 10394     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10395     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10396     MOVE X'2020233030303039333539' TO DFHEIV0(25:11)
 10397     CALL 'kxdfhei1' USING DFHEIV0,
 10398           ERGXRF-FILE-ID,
 10399           DFHEIV99,
 10400           DFHEIV99,
 10401           DFHEIV99,
 10402           DFHEIV99
 10403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10404     ELSE
 10405        MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT
 10406        MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS
 10407        MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER
 10408        compute ergxrf-rec-len =
 10409            (gx-agent-pointer-cnt * +31) + +78
 10410        if ergxrf-rec-len > +31264
 10411           move +31264               to ergxrf-rec-len
 10412           move +1006                to gx-agent-pointer-cnt
 10413        end-if
 10414
 10415* EXEC CICS REWRITE
 10416*            FROM      (AGENT-CROSS-REFERENCE)
 10417*            LENGTH    (ERGXRF-REC-LEN)
 10418*            DATASET   (ERGXRF-FILE-ID)
 10419*       END-EXEC.
 10420*    MOVE '&& L                  %   #00009372' TO DFHEIV0
 10421     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10422     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10423     MOVE X'2020233030303039333732' TO DFHEIV0(25:11)
 10424     CALL 'kxdfhei1' USING DFHEIV0,
 10425           ERGXRF-FILE-ID,
 10426           AGENT-CROSS-REFERENCE,
 10427           ERGXRF-REC-LEN,
 10428           DFHEIV99
 10429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10430
 10431
 10432 7999-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 201
* EL6501.cbl
 10433     EXIT.
 10434
 10435*************************************
 10436 8000-STATE-REC-READ.
 10437     MOVE SPACES                 TO ELCNTL-KEY.
 10438     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10439     MOVE '3'                    TO CNTL-REC-TYPE.
 10440     MOVE PI-ACCT-STATE          TO CNTL-ACCESS.
 10441     MOVE +0                     TO CNTL-SEQ-NO.
 10442
 10443* EXEC CICS HANDLE CONDITION
 10444*        NOTFND  (8010-EXIT)
 10445*    END-EXEC.
 10446*    MOVE '"$I                   ! 3 #00009388' TO DFHEIV0
 10447     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10448     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10449     MOVE X'3320233030303039333838' TO DFHEIV0(25:11)
 10450     CALL 'kxdfhei1' USING DFHEIV0
 10451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10452
 10453
 10454
 10455* EXEC CICS READ
 10456*        DATASET   (CNTL-FILE-ID)
 10457*        SET       (ADDRESS OF CONTROL-FILE)
 10458*        RIDFLD    (ELCNTL-KEY)
 10459*    END-EXEC.
 10460*    MOVE '&"S        E          (   #00009392' TO DFHEIV0
 10461     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10462     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10463     MOVE X'2020233030303039333932' TO DFHEIV0(25:11)
 10464     CALL 'kxdfhei1' USING DFHEIV0,
 10465           CNTL-FILE-ID,
 10466           DFHEIV20,
 10467           DFHEIV99,
 10468           ELCNTL-KEY,
 10469           DFHEIV99,
 10470           DFHEIV99,
 10471           DFHEIV99
 10472     SET ADDRESS OF CONTROL-FILE TO
 10473         DFHEIV20
 10474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10475
 10476
 10477     MOVE CF-ST-COMMISSION-CAPS   TO WS-ST-COMMISSION-CAPS.
 10478     MOVE CF-COMM-CAP-LIMIT-TO    TO WS-COMM-CAP-LIMIT-TO.
 10479
 10480 8010-EXIT.
 10481      EXIT.
 10482
 10483 8050-USER-REC-READ.
 10484     MOVE SPACES                 TO ELCNTL-KEY.
 10485     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10486     MOVE '2'                    TO CNTL-REC-TYPE.
 10487     MOVE CSRI                   TO CNTL-ACCESS.
 10488     MOVE +0                     TO CNTL-SEQ-NO.
 10489
 10490* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 202
* EL6501.cbl
 10491*        NOTFND  (8055-NOTFND)
 10492*    END-EXEC.
 10493*    MOVE '"$I                   ! 4 #00009410' TO DFHEIV0
 10494     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10495     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10496     MOVE X'3420233030303039343130' TO DFHEIV0(25:11)
 10497     CALL 'kxdfhei1' USING DFHEIV0
 10498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10499
 10500
 10501
 10502* EXEC CICS READ
 10503*        DATASET   (CNTL-FILE-ID)
 10504*        SET       (ADDRESS OF CONTROL-FILE)
 10505*        RIDFLD    (ELCNTL-KEY)
 10506*    END-EXEC.
 10507*    MOVE '&"S        E          (   #00009414' TO DFHEIV0
 10508     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10509     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10510     MOVE X'2020233030303039343134' TO DFHEIV0(25:11)
 10511     CALL 'kxdfhei1' USING DFHEIV0,
 10512           CNTL-FILE-ID,
 10513           DFHEIV20,
 10514           DFHEIV99,
 10515           ELCNTL-KEY,
 10516           DFHEIV99,
 10517           DFHEIV99,
 10518           DFHEIV99
 10519     SET ADDRESS OF CONTROL-FILE TO
 10520         DFHEIV20
 10521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10522
 10523
 10524     GO TO 8060-EXIT.
 10525
 10526 8055-NOTFND.
 10527     MOVE ER-1883             TO EMI-ERROR.
 10528     MOVE -1                  TO CSRL.
 10529     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10530
 10531 8060-EXIT.
 10532      EXIT.
 10533
 10534*************************************
 10535
 10536 8100-SEND-INITIAL-MAP.
 10537     MOVE SAVE-DATE              TO DATEO.
 10538     MOVE EIBTIME                TO TIME-IN.
 10539     MOVE TIME-OUT               TO TIMEO.
 10540     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10541     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10542     MOVE -1                     TO PFENTERL.
 10543     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
 10544
 10545     MOVE PI-AH-OVERRIDE-L6      TO AHHEADO.
 10546
 10547*    IF PI-COMPANY-ID = 'HAN' OR 'LGX' OR 'BNE'
 10548*       NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 203
* EL6501.cbl
 10549*    ELSE
 10550*       MOVE AL-SADOF            TO PSIHEADA
 10551*                                   PSILFTA
 10552*                                   PSILFCA
 10553*                                   PSIAHTA
 10554*                                   PSIAHCA
 10555*                                   PSILFFA
 10556*                                   PSIAHFA.
 10557
 10558*    IF PI-COMPANY-ID = 'DMD'
 10559*         MOVE AL-SANOF          TO KEY10A.
 10560
 10561     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 10562        CONTINUE
 10563     ELSE
 10564        MOVE AL-SADOF            TO CTPLABLA
 10565                                    CLPTOLPA
 10566                                    LCLABLA
 10567                                    LCOMMA
 10568                                    MAXFEEHA
 10569                                    CLPSTHA
 10570                                    PRODCDHA
 10571     END-IF
 10572     IF PI-COMPANY-ID = 'NCL' OR 'LGX'
 10573        MOVE -1                  TO CSRL.
 10574
 10575     IF  CLAIM-SESSION
 10576         MOVE SPACES             TO PF1PF2O
 10577         MOVE AL-SANOF           TO PF1PF2A.
 10578
 10579
 10580* EXEC CICS SEND
 10581*        MAP      (MAP-NAME)
 10582*        MAPSET   (MAPSET-NAME)
 10583*        FROM     (EL6501AO)
 10584*        ERASE
 10585*        CURSOR
 10586*    END-EXEC.
 10587     MOVE LENGTH OF
 10588      EL6501AO
 10589       TO DFHEIV12
 10590     MOVE -1
 10591       TO DFHEIV11
 10592*    MOVE '8$     CT  E    H L F ,   #00009475' TO DFHEIV0
 10593     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10594     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10595     MOVE X'2020233030303039343735' TO DFHEIV0(25:11)
 10596     CALL 'kxdfhei1' USING DFHEIV0,
 10597           MAP-NAME,
 10598           EL6501AO,
 10599           DFHEIV12,
 10600           MAPSET-NAME,
 10601           DFHEIV99,
 10602           DFHEIV99,
 10603           DFHEIV99,
 10604           DFHEIV11,
 10605           DFHEIV99,
 10606           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 204
* EL6501.cbl
 10607           DFHEIV99
 10608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10609
 10610
 10611     GO TO 9100-RETURN-TRAN.
 10612
 10613 8200-SEND-DATAONLY.
 10614     MOVE SAVE-DATE              TO DATEO.
 10615     MOVE EIBTIME                TO TIME-IN.
 10616     MOVE TIME-OUT               TO TIMEO.
 10617     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10618     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10619     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
 10620
 10621     MOVE PI-AH-OVERRIDE-L6      TO AHHEADO.
 10622
 10623     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 10624        CONTINUE
 10625     ELSE
 10626        MOVE AL-SADOF            TO CTPLABLA
 10627                                    CLPTOLPA
 10628                                    LCLABLA
 10629                                    LCOMMA
 10630                                    MAXFEEHA
 10631                                    CLPSTHA
 10632                                    PRODCDHA
 10633     END-IF
 10634     IF  CLAIM-SESSION
 10635         MOVE SPACES             TO PF1PF2O
 10636         MOVE AL-SANOF           TO PF1PF2A.
 10637
 10638
 10639* EXEC CICS SEND
 10640*        MAP      (MAP-NAME)
 10641*        MAPSET   (MAPSET-NAME)
 10642*        FROM     (EL6501AO)
 10643*        DATAONLY
 10644*        CURSOR
 10645*    END-EXEC.
 10646     MOVE LENGTH OF
 10647      EL6501AO
 10648       TO DFHEIV12
 10649     MOVE -1
 10650       TO DFHEIV11
 10651*    MOVE '8$D    CT       H L F ,   #00009510' TO DFHEIV0
 10652     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10653     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10654     MOVE X'2020233030303039353130' TO DFHEIV0(25:11)
 10655     CALL 'kxdfhei1' USING DFHEIV0,
 10656           MAP-NAME,
 10657           EL6501AO,
 10658           DFHEIV12,
 10659           MAPSET-NAME,
 10660           DFHEIV99,
 10661           DFHEIV99,
 10662           DFHEIV99,
 10663           DFHEIV11,
 10664           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 205
* EL6501.cbl
 10665           DFHEIV99,
 10666           DFHEIV99
 10667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10668
 10669
 10670     GO TO 9100-RETURN-TRAN.
 10671
 10672 8300-SEND-TEXT.
 10673
 10674* EXEC CICS SEND TEXT
 10675*        FROM     (LOGOFF-TEXT)
 10676*        LENGTH   (LOGOFF-LENGTH)
 10677*        ERASE
 10678*        FREEKB
 10679*    END-EXEC.
 10680*    MOVE '8&      T  E F  H   F -   #00009521' TO DFHEIV0
 10681     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10682     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10683     MOVE X'2020233030303039353231' TO DFHEIV0(25:11)
 10684     CALL 'kxdfhei1' USING DFHEIV0,
 10685           LOGOFF-TEXT,
 10686           LOGOFF-LENGTH,
 10687           DFHEIV99,
 10688           DFHEIV99,
 10689           DFHEIV99,
 10690           DFHEIV99,
 10691           DFHEIV99,
 10692           DFHEIV99,
 10693           DFHEIV99,
 10694           DFHEIV99,
 10695           DFHEIV99,
 10696           DFHEIV99
 10697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10698
 10699
 10700
 10701* EXEC CICS RETURN
 10702*    END-EXEC.
 10703*    MOVE '.(                    ''   #00009528' TO DFHEIV0
 10704     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10705     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10706     MOVE X'2020233030303039353238' TO DFHEIV0(25:11)
 10707     CALL 'kxdfhei1' USING DFHEIV0,
 10708           DFHEIV99,
 10709           DFHEIV99,
 10710           DFHEIV99,
 10711           DFHEIV99,
 10712           DFHEIV99,
 10713           DFHEIV99
 10714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10715
 10716
 10717 8600-DEEDIT.
 10718
 10719* EXEC CICS BIF DEEDIT
 10720*         FIELD(DEEDIT-FIELD)
 10721*         LENGTH(15)
 10722*     END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 206
* EL6501.cbl
 10723     MOVE 15
 10724       TO DFHEIV11
 10725*    MOVE '@"L                   #   #00009532' TO DFHEIV0
 10726     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10727     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10728     MOVE X'2020233030303039353332' TO DFHEIV0(25:11)
 10729     CALL 'kxdfhei1' USING DFHEIV0,
 10730           DEEDIT-FIELD,
 10731           DFHEIV11
 10732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10733
 10734
 10735 8800-UNAUTHORIZED-ACCESS.
 10736     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 10737     GO TO 8300-SEND-TEXT.
 10738
 10739 8810-PF23.
 10740     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 10741     MOVE XCTL-005               TO PGM-NAME.
 10742     GO TO 9300-XCTL.
 10743
 10744 9100-RETURN-TRAN.
 10745     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 10746     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
 10747
 10748* EXEC CICS RETURN
 10749*        TRANSID    (TRANS-ID)
 10750*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10751*        LENGTH     (WS-COMM-LENGTH)
 10752*    END-EXEC.
 10753*    MOVE '.(CT                  ''   #00009549' TO DFHEIV0
 10754     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10755     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10756     MOVE X'2020233030303039353439' TO DFHEIV0(25:11)
 10757     CALL 'kxdfhei1' USING DFHEIV0,
 10758           TRANS-ID,
 10759           PROGRAM-INTERFACE-BLOCK,
 10760           WS-COMM-LENGTH,
 10761           DFHEIV99,
 10762           DFHEIV99,
 10763           DFHEIV99
 10764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10765
 10766
 10767 9200-RETURN-MAIN-MENU.
 10768     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10769         MOVE XCTL-126           TO  PGM-NAME
 10770     ELSE
 10771         MOVE XCTL-626           TO  PGM-NAME.
 10772
 10773     GO TO 9300-XCTL.
 10774
 10775 9300-XCTL.
 10776
 10777* EXEC CICS XCTL
 10778*        PROGRAM    (PGM-NAME)
 10779*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10780*        LENGTH     (WS-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 207
* EL6501.cbl
 10781*    END-EXEC.
 10782*    MOVE '.$C                   %   #00009564' TO DFHEIV0
 10783     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10784     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10785     MOVE X'2020233030303039353634' TO DFHEIV0(25:11)
 10786     CALL 'kxdfhei1' USING DFHEIV0,
 10787           PGM-NAME,
 10788           PROGRAM-INTERFACE-BLOCK,
 10789           WS-COMM-LENGTH,
 10790           DFHEIV99
 10791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10792
 10793
 10794 9400-CLEAR.
 10795     IF PI-GA-BILLING
 10796        IF GETMAIN-ACQUIRED
 10797           MOVE PI-COMM-POINTER TO LCP-WS-ADDR-COMP
 10798           SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR
 10799
 10800* EXEC CICS FREEMAIN
 10801*               DATA     (COMMISSION-WORK-AREA)
 10802*          END-EXEC.
 10803*    MOVE ',$D                   "   #00009575' TO DFHEIV0
 10804     MOVE X'2C2444202020202020202020' TO DFHEIV0(1:12)
 10805     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 10806     MOVE X'2020233030303039353735' TO DFHEIV0(25:11)
 10807     CALL 'kxdfhei1' USING DFHEIV0,
 10808           COMMISSION-WORK-AREA
 10809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10810
 10811
 10812     MOVE SPACES                 TO PI-SV-MAINT.
 10813     MOVE XCTL-650               TO PGM-NAME.
 10814     MOVE XCTL-650               TO PI-RETURN-TO-PROGRAM.
 10815     GO TO 9300-XCTL.
 10816
 10817 9500-PF12.
 10818     MOVE XCTL-010               TO PGM-NAME.
 10819     GO TO 9300-XCTL.
 10820
 10821 9600-PGMID-ERROR.
 10822
 10823* EXEC CICS HANDLE CONDITION
 10824*        PGMIDERR    (8300-SEND-TEXT)
 10825*    END-EXEC.
 10826*    MOVE '"$L                   ! 5 #00009589' TO DFHEIV0
 10827     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10828     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10829     MOVE X'3520233030303039353839' TO DFHEIV0(25:11)
 10830     CALL 'kxdfhei1' USING DFHEIV0
 10831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10832
 10833
 10834     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 10835     MOVE ' '                    TO PI-ENTRY-CD-1.
 10836     MOVE XCTL-005               TO PGM-NAME.
 10837     MOVE PGM-NAME               TO LOGOFF-PGM.
 10838     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 208
* EL6501.cbl
 10839     GO TO 9300-XCTL.
 10840
 10841 9700-DATE-LINK.
 10842     MOVE LINK-ELDATCV           TO PGM-NAME.
 10843
 10844* EXEC CICS LINK
 10845*        PROGRAM    (PGM-NAME)
 10846*        COMMAREA   (DATE-CONVERSION-DATA)
 10847*        LENGTH     (DC-COMM-LENGTH)
 10848*    END-EXEC.
 10849*    MOVE '."C                   (   #00009602' TO DFHEIV0
 10850     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10851     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10852     MOVE X'2020233030303039363032' TO DFHEIV0(25:11)
 10853     CALL 'kxdfhei1' USING DFHEIV0,
 10854           PGM-NAME,
 10855           DATE-CONVERSION-DATA,
 10856           DC-COMM-LENGTH,
 10857           DFHEIV99,
 10858           DFHEIV99,
 10859           DFHEIV99,
 10860           DFHEIV99
 10861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10862
 10863
 10864 9900-ERROR-FORMAT.
 10865     IF NOT EMI-ERRORS-COMPLETE
 10866         MOVE LINK-001           TO PGM-NAME
 10867
 10868* EXEC CICS LINK
 10869*            PROGRAM    (PGM-NAME)
 10870*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10871*            LENGTH     (EMI-COMM-LENGTH)
 10872*        END-EXEC.
 10873*    MOVE '."C                   (   #00009611' TO DFHEIV0
 10874     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10875     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10876     MOVE X'2020233030303039363131' TO DFHEIV0(25:11)
 10877     CALL 'kxdfhei1' USING DFHEIV0,
 10878           PGM-NAME,
 10879           ERROR-MESSAGE-INTERFACE-BLOCK,
 10880           EMI-COMM-LENGTH,
 10881           DFHEIV99,
 10882           DFHEIV99,
 10883           DFHEIV99,
 10884           DFHEIV99
 10885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10886
 10887
 10888 9900-EXIT.
 10889     EXIT.
 10890
 10891 9990-ABEND.
 10892     MOVE LINK-004               TO PGM-NAME.
 10893     MOVE DFHEIBLK               TO EMI-LINE1.
 10894
 10895* EXEC CICS LINK
 10896*        PROGRAM   (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 209
* EL6501.cbl
 10897*        COMMAREA  (EMI-LINE1)
 10898*        LENGTH    (72)
 10899*    END-EXEC.
 10900     MOVE 72
 10901       TO DFHEIV11
 10902*    MOVE '."C                   (   #00009623' TO DFHEIV0
 10903     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10904     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10905     MOVE X'2020233030303039363233' TO DFHEIV0(25:11)
 10906     CALL 'kxdfhei1' USING DFHEIV0,
 10907           PGM-NAME,
 10908           EMI-LINE1,
 10909           DFHEIV11,
 10910           DFHEIV99,
 10911           DFHEIV99,
 10912           DFHEIV99,
 10913           DFHEIV99
 10914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10915
 10916
 10917     MOVE -1                     TO PFENTERL.
 10918     GO TO 8200-SEND-DATAONLY.
 10919
 10920
 10921* GOBACK.
 10922     MOVE '9%                    "   ' TO DFHEIV0
 10923     MOVE 'EL6501' TO DFHEIV1
 10924     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10925     GOBACK.
 10926
 10927 9995-SECURITY-VIOLATION.
 10928*                            COPY ELCSCTP.
 10929******************************************************************
 10930*                                                                *
 10931*                            ELCSCTP                             *
 10932*                            VMOD=2.001                          *
 10933*                                                                *
 10934*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10935******************************************************************
 10936
 10937
 10938     MOVE EIBDATE          TO SM-JUL-DATE.
 10939     MOVE EIBTRMID         TO SM-TERMID.
 10940     MOVE THIS-PGM         TO SM-PGM.
 10941     MOVE EIBTIME          TO TIME-IN.
 10942     MOVE TIME-OUT         TO SM-TIME.
 10943     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10944
 10945
 10946* EXEC CICS LINK
 10947*         PROGRAM  ('EL003')
 10948*         COMMAREA (SECURITY-MESSAGE)
 10949*         LENGTH   (80)
 10950*    END-EXEC.
 10951     MOVE 'EL003' TO DFHEIV1
 10952     MOVE 80
 10953       TO DFHEIV11
 10954*    MOVE '."C                   (   #00009652' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 210
* EL6501.cbl
 10955     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10956     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10957     MOVE X'2020233030303039363532' TO DFHEIV0(25:11)
 10958     CALL 'kxdfhei1' USING DFHEIV0,
 10959           DFHEIV1,
 10960           SECURITY-MESSAGE,
 10961           DFHEIV11,
 10962           DFHEIV99,
 10963           DFHEIV99,
 10964           DFHEIV99,
 10965           DFHEIV99
 10966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10967
 10968
 10969******************************************************************
 10970
 10971
 10972 9995-EXIT.
 10973     EXIT.
 10974
 10975 9999-DFHBACK SECTION.
 10976     MOVE '9%                    "   ' TO DFHEIV0
 10977     MOVE 'EL6501' TO DFHEIV1
 10978     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10979     GOBACK.
 10980 9999-DFHEXIT.
 10981     IF DFHEIGDJ EQUAL 0001
 10982         NEXT SENTENCE
 10983     ELSE IF DFHEIGDJ EQUAL 2
 10984         GO TO 9600-PGMID-ERROR,
 10985               9990-ABEND,
 10986               0500-CHECK-MAINT-TYPE
 10987         DEPENDING ON DFHEIGDI
 10988     ELSE IF DFHEIGDJ EQUAL 3
 10989         GO TO 1500-EXIT
 10990         DEPENDING ON DFHEIGDI
 10991     ELSE IF DFHEIGDJ EQUAL 4
 10992         GO TO 1799-EXIT,
 10993               1799-EXIT
 10994         DEPENDING ON DFHEIGDI
 10995     ELSE IF DFHEIGDJ EQUAL 5
 10996         GO TO 2100-EXIT
 10997         DEPENDING ON DFHEIGDI
 10998     ELSE IF DFHEIGDJ EQUAL 6
 10999         GO TO 2200-EXIT
 11000         DEPENDING ON DFHEIGDI
 11001     ELSE IF DFHEIGDJ EQUAL 7
 11002         GO TO 3030-END-FILE
 11003         DEPENDING ON DFHEIGDI
 11004     ELSE IF DFHEIGDJ EQUAL 8
 11005         GO TO 3530-END-FILE
 11006         DEPENDING ON DFHEIGDI
 11007     ELSE IF DFHEIGDJ EQUAL 9
 11008         GO TO 4020-BUS-TYPE-ERROR
 11009         DEPENDING ON DFHEIGDI
 11010     ELSE IF DFHEIGDJ EQUAL 10
 11011         GO TO 4099-STD-BEN-ERROR
 11012         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 211
* EL6501.cbl
 11013     ELSE IF DFHEIGDJ EQUAL 11
 11014         GO TO 4180-REIN-ERROR
 11015         DEPENDING ON DFHEIGDI
 11016     ELSE IF DFHEIGDJ EQUAL 12
 11017         GO TO 5250-QID-ERROR
 11018         DEPENDING ON DFHEIGDI
 11019     ELSE IF DFHEIGDJ EQUAL 13
 11020         GO TO 5399-EXIT,
 11021               5399-EXIT
 11022         DEPENDING ON DFHEIGDI
 11023     ELSE IF DFHEIGDJ EQUAL 14
 11024         GO TO 6450-NOT-FOUND
 11025         DEPENDING ON DFHEIGDI
 11026     ELSE IF DFHEIGDJ EQUAL 15
 11027         GO TO 6699-EXIT
 11028         DEPENDING ON DFHEIGDI
 11029     ELSE IF DFHEIGDJ EQUAL 16
 11030         GO TO 6880-NO-COMP
 11031         DEPENDING ON DFHEIGDI
 11032     ELSE IF DFHEIGDJ EQUAL 17
 11033         GO TO 6925-NOT-FIND,
 11034               6925-NOT-FIND
 11035         DEPENDING ON DFHEIGDI
 11036     ELSE IF DFHEIGDJ EQUAL 18
 11037         GO TO 7999-EXIT,
 11038               7999-EXIT
 11039         DEPENDING ON DFHEIGDI
 11040     ELSE IF DFHEIGDJ EQUAL 19
 11041         GO TO 8010-EXIT
 11042         DEPENDING ON DFHEIGDI
 11043     ELSE IF DFHEIGDJ EQUAL 20
 11044         GO TO 8055-NOTFND
 11045         DEPENDING ON DFHEIGDI
 11046     ELSE IF DFHEIGDJ EQUAL 21
 11047         GO TO 8300-SEND-TEXT
 11048         DEPENDING ON DFHEIGDI.
 11049     MOVE '9%                    "   ' TO DFHEIV0
 11050     MOVE 'EL6501' TO DFHEIV1
 11051     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 11052     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       39340     Code:       35120
