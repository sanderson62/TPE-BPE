* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page   1
* EL6316.cbl
* Options: int("EL6316.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6316.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6316.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6316.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6316.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page   2
* EL6316.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24* 110410   2007070900001  PEMA  ADD REFORMATIONS AND RESCISSIONS
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    27* 072312   2011022800001  AJRA  NAPERSOFT MISC
    28* 091812 IR2012091400003  AJRA  CHANGE MSG 9999
    29* 101512   2011022800001  AJRA  FIX CLM RESC DEFAULT
    30* 102212   2012101700002  AJRA  SCREEN ID
    31* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    32* 110612   2012101700002  AJRA  ADD NEW FIELDS
    33* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    34*-----------------------------------------------------------------
    35*REMARKS.
    36*        TRANSACTION - EXBC - CANCEL CHANGES
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page   3
* EL6316.cbl
    38 ENVIRONMENT DIVISION.
    39 DATA DIVISION.
    40 WORKING-STORAGE SECTION.
    41 01  DFH-START PIC X(04).
    42 77  FILLER  PIC X(32)  VALUE '********************************'.
    43 77  FILLER  PIC X(32)  VALUE '*    EL6316 WORKING STORAGE    *'.
    44 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    45 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    46 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    47 77  W-ARCH-NUMBER               PIC 9(8) BINARY  VALUE ZEROS.
    48 77  w-prtsw                     pic x  value spaces.
    49 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    50 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    51     88  ACCT-FOUND                 VALUE 'Y'.
    52 77  WS-CHGBACK                  PIC 99  VALUE ZEROS.
    53 77  WS-CSO-PORTION              PIC S9(5)V99 COMP-3 VALUE +0.
    54 77  WS-ACCT-PORTION             PIC S9(5)V99 COMP-3 VALUE +0.
    55 77  WS-DIFF                     PIC 99 VALUE ZEROS.
    56 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    57 77  WS-DUE-BORROWER             PIC S9(7)V99 COMP-3 VALUE +0.
    58 77  s1                          pic s999 comp-3 value +0.
    59 77  s2                          pic s999 comp-3 value +0.
    60 77  WS-REASON-SW                PIC X  VALUE ' '.
    61     88  REASONS-FOUND                  VALUE 'Y'.
    62     88  REASONS-NOT-FOUND              VALUE 'N'.
    63 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    64     88  NO-CERT-RW                 VALUE 'N'.
    65     88  CERT-RW                    VALUE 'Y'.
    66 77  WS-COMM-LENGTH              PIC 9(4) BINARY.
    67 01  P pointer.
    68 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    69 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    70 01  var-ptr pointer.
    71 01  env-var-len                 pic 9(4)  binary.
    72 01  rc                          pic 9(9)  binary.
    73 01  WS-KIXHOST                  PIC X(10).
    74 01  WS-KIXSYS.
    75     05  WS-KIX-FIL1             PIC X(10).
    76     05  WS-KIX-APPS             PIC X(10).
    77     05  WS-KIX-ENV              PIC X(10).
    78     05  WS-KIX-MYENV            PIC X(10).
    79     05  WS-KIX-SYS              PIC X(10).
    80*    COPY ELCSCTM.
    81******************************************************************
    82*                                                                *
    83*                                                                *
    84*                            ELCSCTM                             *
    85*                            VMOD=2.001                          *
    86*                                                                *
    87*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    88*                                                                *
    89******************************************************************
    90 01  SECURITY-MESSAGE.
    91     12  FILLER                          PIC X(30)
    92            VALUE '** LOGIC SECURITY VIOLATION -'.
    93     12  SM-READ                         PIC X(6).
    94     12  FILLER                          PIC X(5)
    95            VALUE ' PGM='.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page   4
* EL6316.cbl
    96     12  SM-PGM                          PIC X(6).
    97     12  FILLER                          PIC X(5)
    98            VALUE ' OPR='.
    99     12  SM-PROCESSOR-ID                 PIC X(4).
   100     12  FILLER                          PIC X(6)
   101            VALUE ' TERM='.
   102     12  SM-TERMID                       PIC X(4).
   103     12  FILLER                          PIC XX   VALUE SPACE.
   104     12  SM-JUL-DATE                     PIC 9(5).
   105     12  FILLER                          PIC X    VALUE SPACE.
   106     12  SM-TIME                         PIC 99.99.
   107
   108*    COPY ELCSCRTY.
   109******************************************************************
   110*                                                                *
   111*                                                                *
   112*                            ELCSCRTY                            *
   113*                            VMOD=2.001                          *
   114*                                                                *
   115*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   116*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   117*        SAVED IN PI-SECURITY-ADDRESS.                           *
   118*                                                                *
   119******************************************************************
   120 01  SECURITY-CONTROL.
   121     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   122     12  FILLER                       PIC XX    VALUE 'SC'.
   123     12  SC-CREDIT-CODES.
   124         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   125             20  SC-CREDIT-DISPLAY    PIC X.
   126             20  SC-CREDIT-UPDATE     PIC X.
   127     12  SC-CLAIMS-CODES.
   128         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   129             20  SC-CLAIMS-DISPLAY    PIC X.
   130             20  SC-CLAIMS-UPDATE     PIC X.
   131 01 srch-commarea.
   132*                                copy ELCADLTRSPI.
   133******************************************************************
   134*                   C H A N G E   L O G
   135*
   136* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   137*-----------------------------------------------------------------
   138*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   139* EFFECTIVE    NUMBER
   140*-----------------------------------------------------------------
   141* 060611    2011022800001  PEMA  NEW COPYBOOK
   142* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   143* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   144******************************************************************
   145****************************************
   146*  commarea for NaperSoft On Demand Admin services letters
   147*  (business logic input & output)
   148****************************************
   149     03  BL-INPUT.
   150         05  BL-DATA-SRCE        PIC X.
   151         05  BL-LETTER-ID        PIC XXXX.
   152         05  BL-CARRIER          PIC X.
   153         05  BL-GROUP            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page   5
* EL6316.cbl
   154         05  BL-STATE            PIC XX.
   155         05  BL-ACCOUNT          PIC X(10).
   156         05  BL-EFF-DT           PIC X(10).
   157         05  BL-CERT-NO          PIC X(11).
   158         05  BL-BATCH-NO         PIC X(6).
   159         05  BL-BATCH-SEQ        PIC 9(8).
   160         05  BL-RESP-NO          PIC X(10).
   161         05  BL-NO-OF-COPIES     PIC 99.
   162         05  BL-PROC-ID          PIC XXXX.
   163         05  BL-COMP-ID          PIC XXX.
   164         05  BL-PRINT-NOW-SW     PIC X.
   165         05  BL-ENC-CD           PIC XXX.
   166         05  BL-RESEND-DT        PIC X(10).
   167         05  BL-FOLLOW-UP-DT     PIC X(10).
   168         05  BL-ARCHIVE-NO       PIC 9(8).
   169         05  BL-FUNC             PIC X(8).
   170         05  BL-COMMENTS         PIC X(100).
   171         05  FILLER REDEFINES BL-COMMENTS.
   172             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   173             10  BL-LETTER-TO-ACCT PIC X.
   174             10  BL-LETTER-TO-BENE PIC X.
   175             10  BL-WRITE-ERARCH   PIC X.
   176                 88  ERARCH-QWS      VALUE 'Q'.
   177                 88  ERARCH-BATCH    VALUE 'B'.
   178                 88  ERARCH-TEMP     VALUE 'T'.
   179             10  BL-PROCESS-TYPE PIC X(07).
   180             10  BL-CERT-FORM-ID PIC X(05).
   181             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   182             10  BL-SOURCE-SCREEN PIC X(8).
   183             10  FILLER          PIC X(25).
   184     03  BL-OUTPUT.
   185         05  BL-STATUS                   PIC X.
   186             88  BL-OK                      VALUE "P".
   187             88  BL-FAIL                  VALUE "F".
   188         05  BL-MESSAGE          PIC X(50).
   189     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   190     03  FILLER                  PIC X(31).
   191
   192*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   193*                                COPY ELCZREC.
   194******************************************************************
   195*                                                                *
   196*                                                                *
   197*                            ELCZREC.                            *
   198*                                                                *
   199*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   200*                                                                *
   201******************************************************************
   202*-----------------------------------------------------------------
   203*                   C H A N G E   L O G
   204*
   205* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   206*-----------------------------------------------------------------
   207*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   208* EFFECTIVE    NUMBER
   209*-----------------------------------------------------------------
   210* 122011    2011022800001  AJRA  NEW FILE
   211* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page   6
* EL6316.cbl
   212*-----------------------------------------------------------------
   213 01  W-Z-CONTROL-DATA.
   214     05  W-NUMBER-OF-COPIES      PIC  9.
   215     05  FILLER                  PIC  X.
   216     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   217     05  FILLER                  PIC  X.
   218     05  W-DAYS-TO-RESEND        PIC  999.
   219     05  FILLER                  PIC  X.
   220     05  W-FORM-TO-RESEND        PIC  X(4).
   221     05  FILLER                  PIC  X.
   222     05  W-PROMPT-LETTER         PIC  X.
   223     05  FILLER                  PIC  X.
   224     05  W-ENCLOSURE-CD          PIC  XXX.
   225     05  FILLER                  PIC  X.
   226     05  W-AUTO-CLOSE-IND        PIC  X.
   227     05  FILLER                  PIC  X.
   228     05  W-LETTER-TO-BENE        PIC  X.
   229     05  FILLER                  PIC  X.
   230     05  W-LETTER-TO-ACCT        PIC  X.
   231     05  FILLER                  PIC  X.
   232     05  W-LETTER-TYPE           PIC  X.
   233     05  FILLER                  PIC  X.
   234     05  W-PRINT-CERTIFICATE     PIC  X.
   235     05  FILLER                  PIC  X.
   236     05  W-REFUND-REQUIRED       PIC  X.
   237     05  FILLER                  PIC  X.
   238     05  W-ONBASE-CODE           PIC  XX.
   239     05  FILLER                  PIC  X.
   240     05  W-ACCT-SUMM             PIC  X.
   241     05  FILLER                  PIC  X.
   242     05  W-CSO-SUMM              PIC  X.
   243     05  FILLER                  PIC  X(31).
   244 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   245 01  STANDARD-AREAS.
   246     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   247     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   248                                 PIC  X(08).
   249     12  QID.
   250         16  QID-TERM        PIC X(4)    VALUE SPACES.
   251         16  FILLER          PIC X(4)    VALUE '631I'.
   252     12  TIME-MT                 PIC S9(7).
   253     12  TIME-MT-R  REDEFINES TIME-MT.
   254         16  FILLER              PIC X.
   255         16  TIME-LMT            PIC 99V99.
   256         16  FILLER              PIC X(2).
   257     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   258     12  MAP-LENGTH              PIC 9(4)   VALUE 359 BINARY.
   259     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   260     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   261     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   262     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   263     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   264     12  WS-ELCERT-KEY.
   265         16  W-CERT-COMPANY-CD   PIC X.
   266         16  W-CERT-CARRIER      PIC X.
   267         16  W-CERT-GROUPING     PIC X(6).
   268         16  W-CERT-STATE        PIC XX.
   269         16  W-CERT-ACCOUNT      PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page   7
* EL6316.cbl
   270         16  W-CERT-CERT-EFF-DT  PIC XX.
   271         16  W-CERT-CERT-PRIME   PIC X(10).
   272         16  W-CERT-CERT-SFX     PIC X.
   273     12  WS-ELEOBC-KEY.
   274         16  WS-EOBC-COMPANY-CD  PIC X.
   275         16  WS-EOBC-REC-TYPE    PIC X.
   276         16  WS-EOBC-CODE        PIC X(4).
   277         16  FILLER              PIC X(9).
   278     12  WS-ERNOTE-KEY.
   279         16  W-NOTE-COMPANY-CD   PIC X.
   280         16  W-NOTE-CARRIER      PIC X.
   281         16  W-NOTE-GROUPING     PIC X(6).
   282         16  W-NOTE-STATE        PIC XX.
   283         16  W-NOTE-ACCOUNT      PIC X(10).
   284         16  W-NOTE-CERT-EFF-DT  PIC XX.
   285         16  W-NOTE-CERT-PRIME   PIC X(10).
   286         16  W-NOTE-CERT-SFX     PIC X.
   287     12  ELLETR-KEY.
   288         16  LETR-PART-KEY.
   289             20  LETR-COMPANY-CD PIC X.
   290             20  LETR-LETTER-ID  PIC X(4).
   291         16  LETR-FILLER         PIC X(8).
   292         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   293     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   294     12  ERPNDB2-KEY.
   295         16  PNDB2-COMPANY-CD    PIC X.
   296         16  PNDB2-CARRIER       PIC X.
   297         16  PNDB2-GROUPING      PIC X(6).
   298         16  PNDB2-STATE         PIC XX.
   299         16  PNDB2-ACCOUNT       PIC X(10).
   300         16  PNDB2-CERT-EFF-DT   PIC XX.
   301         16  PNDB2-CERT-PRIME    PIC X(10).
   302         16  PNDB2-CERT-SFX      PIC X.
   303         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   304         16  PNDB2-RECORD-TYPE   PIC X.
   305     12  ERENDT-KEY.
   306         16  ENDT-COMPANY-CD       PIC X.
   307         16  ENDT-CARRIER          PIC X.
   308         16  ENDT-GROUPING         PIC X(6).
   309         16  ENDT-STATE            PIC XX.
   310         16  ENDT-ACCOUNT          PIC X(10).
   311         16  ENDT-CERT-EFF-DT      PIC XX.
   312         16  ENDT-CERT-PRIME       PIC X(10).
   313         16  ENDT-CERT-SFX         PIC X.
   314         16  ENDT-RECORD-TYPE      PIC X.
   315         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   316     12  ELCRTO-KEY.
   317         16  CRTO-COMPANY-CD     PIC X.
   318         16  CRTO-CARRIER        PIC X.
   319         16  CRTO-GROUPING       PIC X(6).
   320         16  CRTO-STATE          PIC XX.
   321         16  CRTO-ACCOUNT        PIC X(10).
   322         16  CRTO-CERT-EFF-DT    PIC XX.
   323         16  CRTO-CERT-PRIME     PIC X(10).
   324         16  CRTO-CERT-SFX       PIC X.
   325         16  CRTO-RECORD-TYPE    PIC X.
   326         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   327     12  WS-ERMAIL-KEY.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page   8
* EL6316.cbl
   328         16  MAIL-COMPANY-CD     PIC X.
   329         16  MAIL-CARRIER        PIC X.
   330         16  MAIL-GROUPING       PIC X(6).
   331         16  MAIL-STATE          PIC XX.
   332         16  MAIL-ACCOUNT        PIC X(10).
   333         16  MAIL-CERT-EFF-DT    PIC XX.
   334         16  MAIL-CERT-PRIME     PIC X(10).
   335         16  MAIL-CERT-SFX       PIC X.
   336     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   337     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   338     12  WS-CURRENT-DT.
   339         16  FILLER              PIC X(6)    VALUE SPACES.
   340         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   341     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   342     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   343         88  CANCEL-REC            VALUE 'C'.
   344         88  ISSUE-REC             VALUE 'I'.
   345     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   346     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   347     12  ELCNTL-KEY.
   348         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   349         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   350         16  CNTL-ACCESS.
   351             20  CNTL-STATE      PIC XX    VALUE SPACES.
   352             20  FILLER          PIC X     VALUE SPACES.
   353             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   354         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   355     12  WS-ERACCT-KEY.
   356         16  ACCT-COMPANY-CD     PIC X.
   357         16  ACCT-CARRIER        PIC X.
   358         16  ACCT-GROUPING       PIC X(6).
   359         16  ACCT-STATE          PIC XX.
   360         16  ACCT-ACCOUNT        PIC X(10).
   361         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   362         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   363     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   364     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   365     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   366     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   367     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   368     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   369     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   370     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   371     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   372     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   373     12  WS-RESPONSE             PIC S9(8)   COMP.
   374         88  RESP-NORMAL                  VALUE +00.
   375         88  RESP-NOTFND                  VALUE +13.
   376         88  RESP-DUPREC                  VALUE +14.
   377         88  RESP-DUPKEY                  VALUE +15.
   378         88  RESP-NOTOPEN                 VALUE +19.
   379         88  RESP-ENDFILE                 VALUE +20.
   380     12  MAP-NAME            PIC X(8)    VALUE 'EL631I'.
   381     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6316S'.
   382     12  SCREEN-NUMBER       PIC X(4)    VALUE '631I'.
   383     12  TRANS-ID            PIC X(4)    VALUE 'EXBC'.
   384     12  THIS-PGM            PIC X(8)    VALUE 'EL6316'.
   385     12  PGM-NAME            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page   9
* EL6316.cbl
   386     12  TIME-IN             PIC S9(7).
   387     12  TIME-OUT-R  REDEFINES TIME-IN.
   388         16  FILLER          PIC X.
   389         16  TIME-OUT        PIC 99V99.
   390         16  FILLER          PIC X(2).
   391     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   392     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   393     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   394     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   395     12  XCTL-6317           PIC X(8)    VALUE 'EL6317'.
   396     12  XCTL-6318           PIC X(8)    VALUE 'EL6318'.
   397     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   398     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   399     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   400     12  WS-PHONE.
   401         16  WS-PH1              PIC XXX.
   402         16  WS-PH2              PIC XXX.
   403         16  WS-PH3              PIC XXXX.
   404     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   405     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   406
   407     12  WS-BILLING-NOTE.
   408         16  WS-BN-NOTE          PIC X(25).
   409         16  WS-BN-LTRID         PIC X(4).
   410         16  FILLER              PIC X(3).
   411         16  WS-BN-DATE          PIC X(8).
   412         16  FILLER              PIC X(3).
   413         16  WS-BN-USERID        PIC X(4).
   414         16  FILLER              PIC X(30).
   415     12  NEW-ORIG-REC.
   416         16  NEW-INS-LAST-NAME             PIC X(15).
   417         16  NEW-INS-FIRST-NAME            PIC X(10).
   418         16  NEW-INS-MIDDLE-INIT           PIC X.
   419         16  NEW-INS-AGE                   PIC S999     COMP-3.
   420         16  NEW-JNT-LAST-NAME             PIC X(15).
   421         16  NEW-JNT-FIRST-NAME            PIC X(10).
   422         16  NEW-JNT-MIDDLE-INIT           PIC X.
   423         16  NEW-JNT-AGE                   PIC S999     COMP-3.
   424         16  NEW-LF-BENCD                  PIC XX.
   425         16  NEW-LF-TERM                   PIC S999      COMP-3.
   426         16  NEW-LF-BEN-AMT                PIC S9(9)V99  COMP-3.
   427         16  NEW-LF-PRM-AMT                PIC S9(7)V99  COMP-3.
   428         16  NEW-LF-ALT-BEN-AMT            PIC S9(9)V99  COMP-3.
   429         16  NEW-LF-ALT-PRM-AMT            PIC S9(7)V99  COMP-3.
   430         16  NEW-LF-EXP-DT                 PIC XX.
   431         16  NEW-LF-COMM-PCT               PIC SV9(5)    COMP-3.
   432         16  NEW-LF-CANCEL-DT              PIC XX.
   433         16  NEW-LF-CANCEL-AMT             PIC S9(7)V99  COMP-3.
   434         16  NEW-LF-ITD-CANCEL-AMT         PIC S9(7)V99  COMP-3.
   435         16  NEW-AH-BENCD                  PIC XX.
   436         16  NEW-AH-TERM                   PIC S999      COMP-3.
   437         16  NEW-AH-BEN-AMT                PIC S9(9)V99  COMP-3.
   438         16  NEW-AH-PRM-AMT                PIC S9(7)V99  COMP-3.
   439         16  NEW-AH-EXP-DT                 PIC XX.
   440         16  NEW-AH-COMM-PCT               PIC SV9(5)    COMP-3.
   441         16  NEW-AH-CP                     PIC 99.
   442         16  NEW-AH-CANCEL-DT              PIC XX.
   443         16  NEW-AH-CANCEL-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  10
* EL6316.cbl
   444         16  NEW-AH-ITD-CANCEL-AMT         PIC S9(7)V99  COMP-3.
   445         16  NEW-CRED-BENE-NAME            PIC X(25).
   446         16  NEW-1ST-PMT-DT                PIC XX.
   447         16  FILLER                        PIC X(239).
   448
   449 01  CERT-NOTE-ENTRIES.
   450     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   451         16  CERT-NT-TEXT                PIC X(63).
   452         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   453         16  CERT-NT-LAST-MAINT-DT       PIC XX.
   454         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   455
   456 01  ERCNOT-AREA.
   457     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   458     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   459     12  ERCNOT-KEY.
   460         16  ERCNOT-PARTIAL-KEY.
   461             20 ERCNOT-COMPANY-CD    PIC X.
   462             20 ERCNOT-CARRIER       PIC X.
   463             20 ERCNOT-GROUPING      PIC X(06).
   464             20 ERCNOT-STATE         PIC XX.
   465             20 ERCNOT-ACCOUNT       PIC X(10).
   466             20 ERCNOT-EFF-DT        PIC XX.
   467             20 ERCNOT-CERT-NO.
   468                25 ERCNOT-CERT-PRIME PIC X(10).
   469                25 ERCNOT-CERT-SFX   PIC X.
   470             20 ERCNOT-REC-TYP       PIC X.
   471         16 ERCNOT-SEQ           PIC S9(4) COMP.
   472     12  SV-PARTIAL-KEY.
   473         20 SV-COMPANY-CD            PIC X.
   474         20 SV-CARRIER               PIC X.
   475         20 SV-GROUPING              PIC X(06).
   476         20 SV-STATE                 PIC XX.
   477         20 SV-ACCOUNT               PIC X(10).
   478         20 SV-EFF-DT                PIC XX.
   479         20 SV-CERT-NO.
   480            25 SV-CERT-PRIME         PIC X(10).
   481            25 SV-CERT-SFX           PIC X(1).
   482         20 SV-REC-TYP               PIC X.
   483 01  ERROR-MESSAGES.
   484     12  ER-0000                 PIC X(4)  VALUE '0000'.
   485     12  ER-0004                 PIC X(4)  VALUE '0004'.
   486     12  ER-0008                 PIC X(4)  VALUE '0008'.
   487     12  ER-0023                 PIC X(4)  VALUE '0023'.
   488     12  ER-0029                 PIC X(4)  VALUE '0029'.
   489     12  ER-0068                 PIC X(4)  VALUE '0068'.
   490     12  ER-0132                 PIC X(4)  VALUE '0132'.
   491     12  ER-0142                 PIC X(4)  VALUE '0142'.
   492     12  ER-0148                 PIC X(4)  VALUE '0148'.
   493     12  ER-0215                 PIC X(4)  VALUE '0215'.
   494     12  ER-0280                 PIC X(4)  VALUE '0280'.
   495     12  ER-0348                 PIC X(4)  VALUE '0348'.
   496     12  ER-0419                 PIC X(4)  VALUE '0419'.
   497     12  ER-0894                 PIC X(4)  VALUE '0894'.
   498     12  ER-1101                 PIC X(4)  VALUE '1101'.
   499     12  ER-1236                 PIC X(4)  VALUE '1236'.
   500     12  ER-1818                 PIC X(4)  VALUE '1818'.
   501     12  ER-1820                 PIC X(4)  VALUE '1820'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  11
* EL6316.cbl
   502     12  ER-2056                 PIC X(4)  VALUE '2056'.
   503     12  ER-2079                 PIC X(4)  VALUE '2079'.
   504     12  ER-2208                 PIC X(4)  VALUE '2208'.
   505     12  ER-2209                 PIC X(4)  VALUE '2209'.
   506     12  ER-2237                 PIC X(4)  VALUE '2237'.
   507     12  ER-2238                 PIC X(4)  VALUE '2238'.
   508     12  ER-2253                 PIC X(4)  VALUE '2253'.
   509     12  ER-2619                 PIC X(4)  VALUE '2619'.
   510     12  ER-2651                 PIC X(4)  VALUE '2651'.
   511     12  ER-2784                 PIC X(4)  VALUE '2784'.
   512     12  ER-2785                 PIC X(4)  VALUE '2785'.
   513     12  ER-2786                 PIC X(4)  VALUE '2786'.
   514     12  ER-2791                 PIC X(4)  VALUE '2791'.
   515     12  ER-2845                 PIC X(4)  VALUE '2845'.
   516     12  ER-2848                 PIC X(4)  VALUE '2848'.
   517     12  ER-2851                 PIC X(4)  VALUE '2851'.
   518     12  ER-3829                 PIC X(4)  VALUE '3829'.
   519     12  ER-3830                 PIC X(4)  VALUE '3830'.
   520     12  ER-3833                 PIC X(4)  VALUE '3833'.
   521     12  ER-7638                 PIC X(4)  VALUE '7638'.
   522     12  ER-8888                 PIC X(4)  VALUE '8888'.
   523     12  ER-9999                 PIC X(4)  VALUE '9999'.
   524*    COPY ELCDATE.
   525******************************************************************
   526*                                                                *
   527*                                                                *
   528*                            ELCDATE.                            *
   529*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   530*                            VMOD=2.003
   531*                                                                *
   532*                                                                *
   533*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   534*                 LENGTH = 200                                   *
   535******************************************************************
   536
   537 01  DATE-CONVERSION-DATA.
   538     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   539     12  DC-OPTION-CODE                PIC X.
   540         88  BIN-TO-GREG                VALUE ' '.
   541         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   542         88  EDIT-GREG-TO-BIN           VALUE '2'.
   543         88  YMD-GREG-TO-BIN            VALUE '3'.
   544         88  MDY-GREG-TO-BIN            VALUE '4'.
   545         88  JULIAN-TO-BIN              VALUE '5'.
   546         88  BIN-PLUS-ELAPSED           VALUE '6'.
   547         88  FIND-CENTURY               VALUE '7'.
   548         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   549         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   550         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   551         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   552         88  JULIAN-TO-BIN-3            VALUE 'C'.
   553         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   554         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   555         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   556         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   557         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   558         88  CHECK-LEAP-YEAR            VALUE 'H'.
   559         88  BIN-3-TO-GREG              VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  12
* EL6316.cbl
   560         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   561         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   562         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   563         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   564         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   565         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   566         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   567         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   568         88  THREE-CHARACTER-BIN
   569                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   570         88  GREGORIAN-TO-BIN
   571                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   572         88  BIN-TO-GREGORIAN
   573                  VALUES ' ' '1' 'I' '8' 'G'.
   574         88  JULIAN-TO-BINARY
   575                  VALUES '5' 'C' 'E' 'F'.
   576     12  DC-ERROR-CODE                 PIC X.
   577         88  NO-CONVERSION-ERROR        VALUE ' '.
   578         88  DATE-CONVERSION-ERROR
   579                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   580         88  DATE-IS-ZERO               VALUE '1'.
   581         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   582         88  DATE-IS-INVALID            VALUE '3'.
   583         88  DATE1-GREATER-DATE2        VALUE '4'.
   584         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   585         88  DATE-INVALID-OPTION        VALUE '9'.
   586         88  INVALID-CENTURY            VALUE 'A'.
   587         88  ONLY-CENTURY               VALUE 'B'.
   588         88  ONLY-LEAP-YEAR             VALUE 'C'.
   589         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   590     12  DC-END-OF-MONTH               PIC X.
   591         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   592     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   593         88  USE-NORMAL-PROCESS         VALUE ' '.
   594         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   595         88  ADJUST-UP-100-YRS          VALUE '2'.
   596     12  FILLER                        PIC X.
   597     12  DC-CONVERSION-DATES.
   598         16  DC-BIN-DATE-1             PIC XX.
   599         16  DC-BIN-DATE-2             PIC XX.
   600         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   601         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   602                       DC-GREG-DATE-1-EDIT.
   603             20  DC-EDIT1-MONTH        PIC 99.
   604             20  SLASH1-1              PIC X.
   605             20  DC-EDIT1-DAY          PIC 99.
   606             20  SLASH1-2              PIC X.
   607             20  DC-EDIT1-YEAR         PIC 99.
   608         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   609         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   610                     DC-GREG-DATE-2-EDIT.
   611             20  DC-EDIT2-MONTH        PIC 99.
   612             20  SLASH2-1              PIC X.
   613             20  DC-EDIT2-DAY          PIC 99.
   614             20  SLASH2-2              PIC X.
   615             20  DC-EDIT2-YEAR         PIC 99.
   616         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   617         16  DC-GREG-DATE-1-YMD-R  REDEFINES
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  13
* EL6316.cbl
   618                     DC-GREG-DATE-1-YMD.
   619             20  DC-YMD-YEAR           PIC 99.
   620             20  DC-YMD-MONTH          PIC 99.
   621             20  DC-YMD-DAY            PIC 99.
   622         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   623         16  DC-GREG-DATE-1-MDY-R REDEFINES
   624                      DC-GREG-DATE-1-MDY.
   625             20  DC-MDY-MONTH          PIC 99.
   626             20  DC-MDY-DAY            PIC 99.
   627             20  DC-MDY-YEAR           PIC 99.
   628         16  DC-GREG-DATE-1-ALPHA.
   629             20  DC-ALPHA-MONTH        PIC X(10).
   630             20  DC-ALPHA-DAY          PIC 99.
   631             20  FILLER                PIC XX.
   632             20  DC-ALPHA-CENTURY.
   633                 24 DC-ALPHA-CEN-N     PIC 99.
   634             20  DC-ALPHA-YEAR         PIC 99.
   635         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   636         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   637         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   638         16  DC-JULIAN-DATE            PIC 9(05).
   639         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   640                                       PIC 9(05).
   641         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   642             20  DC-JULIAN-YEAR        PIC 99.
   643             20  DC-JULIAN-DAYS        PIC 999.
   644         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   645         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   646         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   647     12  DATE-CONVERSION-VARIBLES.
   648         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   649         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   650             20  FILLER                PIC 9(3).
   651             20  HOLD-CEN-1-CCYY.
   652                 24  HOLD-CEN-1-CC     PIC 99.
   653                 24  HOLD-CEN-1-YY     PIC 99.
   654             20  HOLD-CEN-1-MO         PIC 99.
   655             20  HOLD-CEN-1-DA         PIC 99.
   656         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   657             20  HOLD-CEN-1-R-MO       PIC 99.
   658             20  HOLD-CEN-1-R-DA       PIC 99.
   659             20  HOLD-CEN-1-R-CCYY.
   660                 24  HOLD-CEN-1-R-CC   PIC 99.
   661                 24  HOLD-CEN-1-R-YY   PIC 99.
   662             20  FILLER                PIC 9(3).
   663         16  HOLD-CENTURY-1-X.
   664             20  FILLER                PIC X(3)  VALUE SPACES.
   665             20  HOLD-CEN-1-X-CCYY.
   666                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   667                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   668             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   669             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   670         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   671             20  HOLD-CEN-1-R-X-MO     PIC XX.
   672             20  HOLD-CEN-1-R-X-DA     PIC XX.
   673             20  HOLD-CEN-1-R-X-CCYY.
   674                 24  HOLD-CEN-1-R-X-CC PIC XX.
   675                 24  HOLD-CEN-1-R-X-YY PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  14
* EL6316.cbl
   676             20  FILLER                PIC XXX.
   677         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   678         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   679         16  DC-JULIAN-DATE-1          PIC 9(07).
   680         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   681             20  DC-JULIAN-1-CCYY.
   682                 24  DC-JULIAN-1-CC    PIC 99.
   683                 24  DC-JULIAN-1-YR    PIC 99.
   684             20  DC-JULIAN-DA-1        PIC 999.
   685         16  DC-JULIAN-DATE-2          PIC 9(07).
   686         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   687             20  DC-JULIAN-2-CCYY.
   688                 24  DC-JULIAN-2-CC    PIC 99.
   689                 24  DC-JULIAN-2-YR    PIC 99.
   690             20  DC-JULIAN-DA-2        PIC 999.
   691         16  DC-GREG-DATE-A-EDIT.
   692             20  DC-EDITA-MONTH        PIC 99.
   693             20  SLASHA-1              PIC X VALUE '/'.
   694             20  DC-EDITA-DAY          PIC 99.
   695             20  SLASHA-2              PIC X VALUE '/'.
   696             20  DC-EDITA-CCYY.
   697                 24  DC-EDITA-CENT     PIC 99.
   698                 24  DC-EDITA-YEAR     PIC 99.
   699         16  DC-GREG-DATE-B-EDIT.
   700             20  DC-EDITB-MONTH        PIC 99.
   701             20  SLASHB-1              PIC X VALUE '/'.
   702             20  DC-EDITB-DAY          PIC 99.
   703             20  SLASHB-2              PIC X VALUE '/'.
   704             20  DC-EDITB-CCYY.
   705                 24  DC-EDITB-CENT     PIC 99.
   706                 24  DC-EDITB-YEAR     PIC 99.
   707         16  DC-GREG-DATE-CYMD         PIC 9(08).
   708         16  DC-GREG-DATE-CYMD-R REDEFINES
   709                              DC-GREG-DATE-CYMD.
   710             20  DC-CYMD-CEN           PIC 99.
   711             20  DC-CYMD-YEAR          PIC 99.
   712             20  DC-CYMD-MONTH         PIC 99.
   713             20  DC-CYMD-DAY           PIC 99.
   714         16  DC-GREG-DATE-MDCY         PIC 9(08).
   715         16  DC-GREG-DATE-MDCY-R REDEFINES
   716                              DC-GREG-DATE-MDCY.
   717             20  DC-MDCY-MONTH         PIC 99.
   718             20  DC-MDCY-DAY           PIC 99.
   719             20  DC-MDCY-CEN           PIC 99.
   720             20  DC-MDCY-YEAR          PIC 99.
   721    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   722        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   723    12  DC-EL310-DATE                  PIC X(21).
   724    12  FILLER                         PIC X(28).
   725*    COPY ELCLOGOF.
   726******************************************************************
   727*                                                                *
   728*                                                                *
   729*                            ELCLOGOF.                           *
   730*                            VMOD=2.001                          *
   731*                                                                *
   732*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   733*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  15
* EL6316.cbl
   734******************************************************************
   735 01  CLASIC-LOGOFF.
   736     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   737     12  LOGOFF-TEXT.
   738         16  FILLER          PIC X(5)    VALUE SPACES.
   739         16  LOGOFF-MSG.
   740             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   741             20  FILLER      PIC X       VALUE SPACES.
   742             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   743         16  FILLER          PIC X(80)
   744           VALUE '* YOU ARE NOW LOGGED OFF'.
   745         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   746         16  FILLER          PIC X       VALUE QUOTE.
   747         16  LOGOFF-SYS-MSG  PIC X(17)
   748           VALUE 'S CLAS-IC SYSTEM '.
   749     12  TEXT-MESSAGES.
   750         16  UNACCESS-MSG    PIC X(29)
   751             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   752         16  PGMIDERR-MSG    PIC X(17)
   753             VALUE 'PROGRAM NOT FOUND'.
   754*    COPY ELCATTR.
   755******************************************************************
   756*                                                                *
   757*                            ELCATTR.                            *
   758*                            VMOD=2.001                          *
   759*                                                                *
   760*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   761*                                                                *
   762*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   763*                                                                *
   764*                   POS 1   P=PROTECTED                          *
   765*                           U=UNPROTECTED                        *
   766*                           S=ASKIP                              *
   767*                   POS 2   A=ALPHA/NUMERIC                      *
   768*                           N=NUMERIC                            *
   769*                   POS 3   N=NORMAL                             *
   770*                           B=BRIGHT                             *
   771*                           D=DARK                               *
   772*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   773*                           OF=MODIFIED DATA TAG OFF             *
   774*                                                                *
   775*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   776******************************************************************
   777 01  ATTRIBUTE-LIST.
   778     12  AL-PABOF            PIC X       VALUE 'Y'.
   779     12  AL-PABON            PIC X       VALUE 'Z'.
   780     12  AL-PADOF            PIC X       VALUE '%'.
   781     12  AL-PADON            PIC X       VALUE '_'.
   782     12  AL-PANOF            PIC X       VALUE '-'.
   783     12  AL-PANON            PIC X       VALUE '/'.
   784     12  AL-SABOF            PIC X       VALUE '8'.
   785     12  AL-SABON            PIC X       VALUE '9'.
   786     12  AL-SADOF            PIC X       VALUE '@'.
   787     12  AL-SADON            PIC X       VALUE QUOTE.
   788     12  AL-SANOF            PIC X       VALUE '0'.
   789     12  AL-SANON            PIC X       VALUE '1'.
   790     12  AL-UABOF            PIC X       VALUE 'H'.
   791     12  AL-UABON            PIC X       VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  16
* EL6316.cbl
   792     12  AL-UADOF            PIC X       VALUE '<'.
   793     12  AL-UADON            PIC X       VALUE '('.
   794     12  AL-UANOF            PIC X       VALUE ' '.
   795     12  AL-UANON            PIC X       VALUE 'A'.
   796     12  AL-UNBOF            PIC X       VALUE 'Q'.
   797     12  AL-UNBON            PIC X       VALUE 'R'.
   798     12  AL-UNDOF            PIC X       VALUE '*'.
   799     12  AL-UNDON            PIC X       VALUE ')'.
   800     12  AL-UNNOF            PIC X       VALUE '&'.
   801     12  AL-UNNON            PIC X       VALUE 'J'.
   802*    COPY ELCEMIB.
   803******************************************************************
   804*                                                                *
   805*                                                                *
   806*                            ELCEMIB.                            *
   807*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   808*                            VMOD=2.005                          *
   809*                                                                *
   810*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   811*                                                                *
   812******************************************************************
   813 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   814     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   815     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   816     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   817     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   818     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   819     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   820     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   821     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   822     12  EMI-SWITCH1             PIC X        VALUE '1'.
   823         88  EMI-NO-ERRORS                    VALUE '1'.
   824         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   825         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   826     12  EMI-SWITCH2             PIC X        VALUE '1'.
   827         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   828     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   829         88  EMI-AREA1-EMPTY                  VALUE '1'.
   830         88  EMI-AREA1-FULL                   VALUE '2'.
   831     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   832         88  EMI-AREA2-EMPTY                  VALUE '1'.
   833         88  EMI-AREA2-FULL                   VALUE '2'.
   834     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   835         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   836         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   837         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   838         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   839         88  EMI-BYPASS-FATALS                VALUE 'X'.
   840     12  EMI-ERROR-LINES.
   841         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   842         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   843         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   844         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   845             20  EMI-ERR-CODES OCCURS 10 TIMES.
   846                 24  EMI-ERR-NUM         PIC X(4).
   847                 24  EMI-FILLER          PIC X.
   848                 24  EMI-SEV             PIC X.
   849                 24  FILLER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  17
* EL6316.cbl
   850             20  FILLER                  PIC X(02).
   851     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   852         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   853             20  EMI-ERROR-NUMBER    PIC X(4).
   854             20  EMI-FILL            PIC X.
   855             20  EMI-SEVERITY        PIC X.
   856             20  FILLER              PIC X.
   857             20  EMI-ERROR-TEXT.
   858                 24  EMI-TEXT-VARIABLE   PIC X(10).
   859                 24  FILLER          PIC X(55).
   860     12  EMI-SEVERITY-SAVE           PIC X.
   861         88  EMI-NOTE                    VALUE 'N'.
   862         88  EMI-WARNING                 VALUE 'W'.
   863         88  EMI-FORCABLE                VALUE 'F'.
   864         88  EMI-FATAL                   VALUE 'X'.
   865     12  EMI-MESSAGE-FLAG            PIC X.
   866         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   867         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   868     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   869     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   870         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   871         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   872         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   873     12  FILLER                      PIC X(137)  VALUE SPACES.
   874     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   875     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   876     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   877     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   878*    COPY ELCTEXT.
   879******************************************************************
   880*                                                                *
   881*                                                                *
   882*                            ELCTEXT.                            *
   883*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   884*                            VMOD=2.008                          *
   885*                                                                *
   886*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   887*                                     FORM LETTERS,              *
   888*                                     CERT FORM DISPLAY.
   889*                                                                *
   890*   FILE TYPE = VSAM,KSDS                                        *
   891*   RECORD SIZE = 100   RECFORM = FIXED                          *
   892*                                                                *
   893*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   894*       ALTERNATE INDEX = NONE                                   *
   895*                                                                *
   896*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   897*       ALTERNATE INDEX = NONE                                   *
   898*                                                                *
   899*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   900*       ALTERNATE INDEX = NONE                                   *
   901*                                                                *
   902*   LOG = NO                                                     *
   903*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   904******************************************************************
   905 01  TEXT-FILES.
   906     12  TEXT-FILE-ID                PIC XX.
   907         88  FORMS-FILE-TEXT            VALUE 'TF'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  18
* EL6316.cbl
   908         88  LETTER-FILE-TEXT           VALUE 'TL'.
   909         88  HELP-FILE-TEXT             VALUE 'TH'.
   910
   911     12  TX-CONTROL-PRIMARY.
   912         16  TX-COMPANY-CD           PIC X.
   913             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   914         16  TX-ACCESS-CD-GENL       PIC X(12).
   915
   916         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   917             20  TX-LETTER-NO        PIC X(4).
   918             20  FILLER              PIC X(8).
   919
   920         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   921             20  TX-FORM-NO          PIC X(12).
   922
   923         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   924             20  TX-HELP-TYPE        PIC X.
   925                 88  HELP-FOR-GENERAL   VALUE ' '.
   926                 88  HELP-BY-SCREEN     VALUE 'S'.
   927                 88  HELP-BY-ERROR      VALUE 'E'.
   928             20  TX-SCREEN-OR-ERROR  PIC X(4).
   929                 88  GENERAL-INFO-HELP  VALUE '0000'.
   930             20  TX-HELP-FOR-COMPANY  PIC XXX.
   931                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   932             20  FILLER              PIC X(4).
   933
   934         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   935
   936     12  TX-PROCESS-CONTROL          PIC XX.
   937         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   938
   939     12  TX-TEXT-LINE                PIC X(70).
   940
   941     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   942         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   943         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   944         88  TX-VALID-FORM-SQUEEZE-VALUE
   945                                        VALUE 'Y' ' '.
   946
   947     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   948         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   949         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   950         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   951         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   952         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   953         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   954         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   955                                              'K' 'N' ' '
   956                                              'Z'.
   957
   958     12  TX-ARCHIVE-SW               PIC X.
   959         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   960         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   961         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   962
   963     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   964     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   965
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  19
* EL6316.cbl
   966     12  TX-BSR-CODE                 PIC X.
   967         88  TX-BSR-LETTER              VALUE 'B'.
   968         88  TX-NON-BSR-LETTER          VALUE ' '.
   969
   970     12  FILLER                      PIC X.
   971*****************************************************************
   972*    COPY ELCINTF.
   973******************************************************************
   974*                                                                *
   975*                                                                *
   976*                            ELCINTF.                            *
   977*                            VMOD=2.017                          *
   978*                                                                *
   979*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   980*                                                                *
   981*       LENGTH = 1024                                            *
   982*                                                                *
   983******************************************************************
   984*                   C H A N G E   L O G
   985*
   986* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   987*-----------------------------------------------------------------
   988*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   989* EFFECTIVE    NUMBER
   990*-----------------------------------------------------------------
   991* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   992******************************************************************
   993 01  PROGRAM-INTERFACE-BLOCK.
   994     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   995     12  PI-CALLING-PROGRAM              PIC X(8).
   996     12  PI-SAVED-PROGRAM-1              PIC X(8).
   997     12  PI-SAVED-PROGRAM-2              PIC X(8).
   998     12  PI-SAVED-PROGRAM-3              PIC X(8).
   999     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1000     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1001     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1002     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1003     12  PI-COMPANY-ID                   PIC XXX.
  1004     12  PI-COMPANY-CD                   PIC X.
  1005
  1006     12  PI-COMPANY-PASSWORD             PIC X(8).
  1007
  1008     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1009
  1010     12  PI-CONTROL-IN-PROGRESS.
  1011         16  PI-CARRIER                  PIC X.
  1012         16  PI-GROUPING                 PIC X(6).
  1013         16  PI-STATE                    PIC XX.
  1014         16  PI-ACCOUNT                  PIC X(10).
  1015         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1016                                         PIC X(10).
  1017         16  PI-CLAIM-CERT-GRP.
  1018             20  PI-CLAIM-NO             PIC X(7).
  1019             20  PI-CERT-NO.
  1020                 25  PI-CERT-PRIME       PIC X(10).
  1021                 25  PI-CERT-SFX         PIC X.
  1022             20  PI-CERT-EFF-DT          PIC XX.
  1023         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  20
* EL6316.cbl
  1024             20  PI-PLAN-CODE            PIC X(2).
  1025             20  PI-REVISION-NUMBER      PIC X(3).
  1026             20  PI-PLAN-EFF-DT          PIC X(2).
  1027             20  PI-PLAN-EXP-DT          PIC X(2).
  1028             20  FILLER                  PIC X(11).
  1029         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1030             20  PI-OE-REFERENCE-1.
  1031                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1032                 25  PI-OE-REF-1-SUFF    PIC XX.
  1033
  1034     12  PI-SESSION-IN-PROGRESS          PIC X.
  1035         88  CLAIM-SESSION                   VALUE '1'.
  1036         88  CREDIT-SESSION                  VALUE '2'.
  1037         88  WARRANTY-SESSION                VALUE '3'.
  1038         88  MORTGAGE-SESSION                VALUE '4'.
  1039         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1040
  1041
  1042*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1043
  1044     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1045     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1046
  1047     12  PI-CREDIT-USER                  PIC X.
  1048         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1049         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1050
  1051     12  PI-CLAIM-USER                   PIC X.
  1052         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1053         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1054
  1055     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1056         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1057         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1058         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1059         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1060         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1061
  1062     12  PI-PROCESSOR-ID                 PIC X(4).
  1063
  1064     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1065
  1066     12  PI-MEMBER-CAPTION               PIC X(10).
  1067
  1068     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1069         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1070
  1071     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1072     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1073     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1074     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1075
  1076     12  PI-AH-OVERRIDE-L1               PIC X.
  1077     12  PI-AH-OVERRIDE-L2               PIC XX.
  1078     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1079     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1080
  1081     12  PI-NEW-SYSTEM                   PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  21
* EL6316.cbl
  1082
  1083     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1084     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1085         88  PI-USES-PAID-TO                 VALUE '1'.
  1086     12  PI-CRDTCRD-SYSTEM.
  1087         16  PI-CRDTCRD-USER             PIC X.
  1088             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1089             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1090         16  PI-CC-MONTH-END-DT          PIC XX.
  1091     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1092
  1093     12  PI-OE-REFERENCE-2.
  1094         16  PI-OE-REF-2-PRIME           PIC X(10).
  1095         16  PI-OE-REF-2-SUFF            PIC X.
  1096
  1097     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1098
  1099     12  PI-LANGUAGE-TYPE                PIC X.
  1100             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1101             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1102             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1103
  1104     12  PI-POLICY-LINKAGE-IND           PIC X.
  1105         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1106         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1107                                                   LOW-VALUES.
  1108
  1109     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1110     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1111         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1112         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1113
  1114     12  PI-PROCESSOR-CSR-IND            PIC X.
  1115         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1116         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1117
  1118     12  FILLER                          PIC X(3).
  1119
  1120     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1121
  1122     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1123         PI-SYSTEM-LEVEL.
  1124
  1125         16  PI-ENTRY-CODES.
  1126             20  PI-ENTRY-CD-1           PIC X.
  1127             20  PI-ENTRY-CD-2           PIC X.
  1128
  1129         16  PI-RETURN-CODES.
  1130             20  PI-RETURN-CD-1          PIC X.
  1131             20  PI-RETURN-CD-2          PIC X.
  1132
  1133         16  PI-UPDATE-STATUS-SAVE.
  1134             20  PI-UPDATE-BY            PIC X(4).
  1135             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1136
  1137         16  PI-LOWER-CASE-LETTERS       PIC X.
  1138             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1139
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  22
* EL6316.cbl
  1140*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1141*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1142*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1143
  1144         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1145             88  ST-ACCNT-CNTL               VALUE ' '.
  1146             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1147             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1148             88  ACCNT-CNTL                  VALUE '3'.
  1149             88  CARR-ACCNT-CNTL             VALUE '4'.
  1150
  1151         16  PI-PROCESSOR-CAP-LIST.
  1152             20  PI-SYSTEM-CONTROLS.
  1153                24 PI-SYSTEM-DISPLAY     PIC X.
  1154                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1155                24 PI-SYSTEM-MODIFY      PIC X.
  1156                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1157             20  FILLER                  PIC XX.
  1158             20  PI-DISPLAY-CAP          PIC X.
  1159                 88  DISPLAY-CAP             VALUE 'Y'.
  1160             20  PI-MODIFY-CAP           PIC X.
  1161                 88  MODIFY-CAP              VALUE 'Y'.
  1162             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1163                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1164             20  PI-FORCE-CAP            PIC X.
  1165                 88  FORCE-CAP               VALUE 'Y'.
  1166
  1167         16  PI-PROGRAM-CONTROLS.
  1168             20  PI-PGM-PRINT-OPT        PIC X.
  1169             20  PI-PGM-FORMAT-OPT       PIC X.
  1170             20  PI-PGM-PROCESS-OPT      PIC X.
  1171             20  PI-PGM-TOTALS-OPT       PIC X.
  1172
  1173         16  PI-HELP-INTERFACE.
  1174             20  PI-LAST-ERROR-NO        PIC X(4).
  1175             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1176
  1177         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1178             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1179
  1180         16  PI-CR-CONTROL-IN-PROGRESS.
  1181             20  PI-CR-CARRIER           PIC X.
  1182             20  PI-CR-GROUPING          PIC X(6).
  1183             20  PI-CR-STATE             PIC XX.
  1184             20  PI-CR-ACCOUNT           PIC X(10).
  1185             20  PI-CR-FIN-RESP          PIC X(10).
  1186             20  PI-CR-TYPE              PIC X.
  1187
  1188         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1189
  1190         16  PI-CR-MONTH-END-DT          PIC XX.
  1191
  1192         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1193             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1194             88  PI-ZERO-CARRIER             VALUE '1'.
  1195             88  PI-ZERO-GROUPING            VALUE '2'.
  1196             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1197
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  23
* EL6316.cbl
  1198         16  PI-CARRIER-SECURITY         PIC X.
  1199             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1200
  1201         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1202             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1203             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1204
  1205         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1206             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1207                                         INDEXED BY PI-ACCESS-NDX
  1208                                         PIC X.
  1209
  1210         16  PI-GA-BILLING-CONTROL       PIC X.
  1211             88  PI-GA-BILLING               VALUE '1'.
  1212
  1213         16  PI-MAIL-PROCESSING          PIC X.
  1214             88  PI-MAIL-YES                 VALUE 'Y'.
  1215
  1216         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1217
  1218         16  PI-AR-SYSTEM.
  1219             20  PI-AR-PROCESSING-CNTL   PIC X.
  1220                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1221             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1222             20  PI-AR-MONTH-END-DT      PIC XX.
  1223
  1224         16  PI-MP-SYSTEM.
  1225             20  PI-MORTGAGE-USER            PIC X.
  1226                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1227                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1228             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1229                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1230                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1231                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1232                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1233                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1234             20  PI-MP-MONTH-END-DT          PIC XX.
  1235             20  PI-MP-REFERENCE-NO.
  1236                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1237                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1238
  1239         16  PI-LABEL-CONTROL            PIC X(01).
  1240             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1241             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1242
  1243         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1244             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1245
  1246         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1247             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1248             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1249
  1250         16  FILLER                      PIC X(14).
  1251
  1252     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1253******************************************************************
  1254     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1255        16  PI-ISS-CAN-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  24
* EL6316.cbl
  1256        16  PI-ERENDT-KEY.
  1257            20  PI-ENDT-COMPANY-CD  PIC X.
  1258            20  PI-ENDT-CARRIER     PIC X.
  1259            20  PI-ENDT-GROUPING    PIC X(6).
  1260            20  PI-ENDT-STATE       PIC XX.
  1261            20  PI-ENDT-ACCOUNT     PIC X(10).
  1262            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1263            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1264            20  PI-ENDT-CERT-SFX    PIC X.
  1265            20  PI-ENDT-RECORD-TYPE PIC X.
  1266            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1267        16  PI-ELCRTO-KEY.
  1268            20  PI-CRTO-COMPANY-CD  PIC X.
  1269            20  PI-CRTO-CARRIER     PIC X.
  1270            20  PI-CRTO-GROUPING    PIC X(6).
  1271            20  PI-CRTO-STATE       PIC XX.
  1272            20  PI-CRTO-ACCOUNT     PIC X(10).
  1273            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1274            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1275            20  PI-CRTO-CERT-SFX    PIC X.
  1276            20  PI-CRTO-RECORD-TYPE PIC X.
  1277            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1278        16  PI-ERPNDB-KEY           PIC X(11).
  1279        16  PI-DOCUMENT-PROCESSED   PIC X.
  1280            88  PI-VERI-PROCESSED      VALUE 'V'.
  1281            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1282        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1283        16  PI-RES-REF-CLM-TYPE     PIC X.
  1284        16  PI-CLM-RESC-IND         PIC X.
  1285            88  PI-CLM-RESCISSION      VALUE 'Y'.
  1286        16  PI-CLEAR-ERROR-SW       PIC X.
  1287            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1288        16  PI-PRTSW-ENTERED        PIC X.
  1289        16  PI-LTRID-ENTERED        PIC X(4).
  1290        16  PI-REASONS-ENTERED      PIC X(84).
  1291        16  PI-CERTNT1-ENTERED      PIC X(63).
  1292        16  PI-CERTNT2-ENTERED      PIC X(63).
  1293        16  FILLER                  PIC X(20).
  1294        16  PI-FINALIZED-IND        PIC X.
  1295        16  FILLER                  PIC X(280).
  1296    12  FILLER                      PIC X(276).
  1297*    COPY ELCAID.
  1298******************************************************************
  1299*                                                                *
  1300*                            ELCAID.                             *
  1301*                            VMOD=2.001                          *
  1302*                                                                *
  1303*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1304*                                                                *
  1305*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1306*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1307******************************************************************
  1308
  1309 01  DFHAID.
  1310   02  DFHNULL   PIC  X  VALUE  ' '.
  1311   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1312   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1313   02  DFHPEN    PIC  X  VALUE  '='.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  25
* EL6316.cbl
  1314   02  DFHOPID   PIC  X  VALUE  'W'.
  1315   02  DFHPA1    PIC  X  VALUE  '%'.
  1316   02  DFHPA2    PIC  X  VALUE  '>'.
  1317   02  DFHPA3    PIC  X  VALUE  ','.
  1318   02  DFHPF1    PIC  X  VALUE  '1'.
  1319   02  DFHPF2    PIC  X  VALUE  '2'.
  1320   02  DFHPF3    PIC  X  VALUE  '3'.
  1321   02  DFHPF4    PIC  X  VALUE  '4'.
  1322   02  DFHPF5    PIC  X  VALUE  '5'.
  1323   02  DFHPF6    PIC  X  VALUE  '6'.
  1324   02  DFHPF7    PIC  X  VALUE  '7'.
  1325   02  DFHPF8    PIC  X  VALUE  '8'.
  1326   02  DFHPF9    PIC  X  VALUE  '9'.
  1327   02  DFHPF10   PIC  X  VALUE  ':'.
  1328   02  DFHPF11   PIC  X  VALUE  '#'.
  1329   02  DFHPF12   PIC  X  VALUE  '@'.
  1330   02  DFHPF13   PIC  X  VALUE  'A'.
  1331   02  DFHPF14   PIC  X  VALUE  'B'.
  1332   02  DFHPF15   PIC  X  VALUE  'C'.
  1333   02  DFHPF16   PIC  X  VALUE  'D'.
  1334   02  DFHPF17   PIC  X  VALUE  'E'.
  1335   02  DFHPF18   PIC  X  VALUE  'F'.
  1336   02  DFHPF19   PIC  X  VALUE  'G'.
  1337   02  DFHPF20   PIC  X  VALUE  'H'.
  1338   02  DFHPF21   PIC  X  VALUE  'I'.
  1339*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1340   02  DFHPF22   PIC  X  VALUE  '['.
  1341   02  DFHPF23   PIC  X  VALUE  '.'.
  1342   02  DFHPF24   PIC  X  VALUE  '<'.
  1343   02  DFHMSRE   PIC  X  VALUE  'X'.
  1344   02  DFHSTRF   PIC  X  VALUE  'h'.
  1345   02  DFHTRIG   PIC  X  VALUE  '"'.
  1346 01  FILLER    REDEFINES DFHAID.
  1347     12  FILLER              PIC X(8).
  1348     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1349*   COPY EL6316S.
  1350 01  EL631II.
  1351     05  FILLER            PIC  X(0012).
  1352*    -------------------------------
  1353     05  DATEL PIC S9(0004) COMP.
  1354     05  DATEF PIC  X(0001).
  1355     05  FILLER REDEFINES DATEF.
  1356         10  DATEA PIC  X(0001).
  1357     05  DATEI PIC  X(0008).
  1358*    -------------------------------
  1359     05  TIMEL PIC S9(0004) COMP.
  1360     05  TIMEF PIC  X(0001).
  1361     05  FILLER REDEFINES TIMEF.
  1362         10  TIMEA PIC  X(0001).
  1363     05  TIMEI PIC  X(0005).
  1364*    -------------------------------
  1365     05  PROCIDL PIC S9(0004) COMP.
  1366     05  PROCIDF PIC  X(0001).
  1367     05  FILLER REDEFINES PROCIDF.
  1368         10  PROCIDA PIC  X(0001).
  1369     05  PROCIDI PIC  X(0004).
  1370*    -------------------------------
  1371     05  HOSTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  26
* EL6316.cbl
  1372     05  HOSTF PIC  X(0001).
  1373     05  FILLER REDEFINES HOSTF.
  1374         10  HOSTA PIC  X(0001).
  1375     05  HOSTI PIC  X(0009).
  1376*    -------------------------------
  1377     05  SYSL PIC S9(0004) COMP.
  1378     05  SYSF PIC  X(0001).
  1379     05  FILLER REDEFINES SYSF.
  1380         10  SYSA PIC  X(0001).
  1381     05  SYSI PIC  X(0005).
  1382*    -------------------------------
  1383     05  COMPANYL PIC S9(0004) COMP.
  1384     05  COMPANYF PIC  X(0001).
  1385     05  FILLER REDEFINES COMPANYF.
  1386         10  COMPANYA PIC  X(0001).
  1387     05  COMPANYI PIC  X(0003).
  1388*    -------------------------------
  1389     05  DATASORL PIC S9(0004) COMP.
  1390     05  DATASORF PIC  X(0001).
  1391     05  FILLER REDEFINES DATASORF.
  1392         10  DATASORA PIC  X(0001).
  1393     05  DATASORI PIC  X(0001).
  1394*    -------------------------------
  1395     05  BATCHNOL PIC S9(0004) COMP.
  1396     05  BATCHNOF PIC  X(0001).
  1397     05  FILLER REDEFINES BATCHNOF.
  1398         10  BATCHNOA PIC  X(0001).
  1399     05  BATCHNOI PIC  X(0006).
  1400*    -------------------------------
  1401     05  BSEQNOL PIC S9(0004) COMP.
  1402     05  BSEQNOF PIC  X(0001).
  1403     05  FILLER REDEFINES BSEQNOF.
  1404         10  BSEQNOA PIC  X(0001).
  1405     05  BSEQNOI PIC  X(0008).
  1406*    -------------------------------
  1407     05  ARCHNOL PIC S9(0004) COMP.
  1408     05  ARCHNOF PIC  X(0001).
  1409     05  FILLER REDEFINES ARCHNOF.
  1410         10  ARCHNOA PIC  X(0001).
  1411     05  ARCHNOI PIC  X(0008).
  1412*    -------------------------------
  1413     05  PRTSWL PIC S9(0004) COMP.
  1414     05  PRTSWF PIC  X(0001).
  1415     05  FILLER REDEFINES PRTSWF.
  1416         10  PRTSWA PIC  X(0001).
  1417     05  PRTSWI PIC  X(0001).
  1418*    -------------------------------
  1419     05  CARRL PIC S9(0004) COMP.
  1420     05  CARRF PIC  X(0001).
  1421     05  FILLER REDEFINES CARRF.
  1422         10  CARRA PIC  X(0001).
  1423     05  CARRI PIC  X(0001).
  1424*    -------------------------------
  1425     05  GROUPL PIC S9(0004) COMP.
  1426     05  GROUPF PIC  X(0001).
  1427     05  FILLER REDEFINES GROUPF.
  1428         10  GROUPA PIC  X(0001).
  1429     05  GROUPI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  27
* EL6316.cbl
  1430*    -------------------------------
  1431     05  STATEL PIC S9(0004) COMP.
  1432     05  STATEF PIC  X(0001).
  1433     05  FILLER REDEFINES STATEF.
  1434         10  STATEA PIC  X(0001).
  1435     05  STATEI PIC  X(0002).
  1436*    -------------------------------
  1437     05  ACCTL PIC S9(0004) COMP.
  1438     05  ACCTF PIC  X(0001).
  1439     05  FILLER REDEFINES ACCTF.
  1440         10  ACCTA PIC  X(0001).
  1441     05  ACCTI PIC  X(0010).
  1442*    -------------------------------
  1443     05  EFFDTL PIC S9(0004) COMP.
  1444     05  EFFDTF PIC  X(0001).
  1445     05  FILLER REDEFINES EFFDTF.
  1446         10  EFFDTA PIC  X(0001).
  1447     05  EFFDTI PIC  X(0008).
  1448*    -------------------------------
  1449     05  CERTNOL PIC S9(0004) COMP.
  1450     05  CERTNOF PIC  X(0001).
  1451     05  FILLER REDEFINES CERTNOF.
  1452         10  CERTNOA PIC  X(0001).
  1453     05  CERTNOI PIC  X(0010).
  1454*    -------------------------------
  1455     05  CRTSFXL PIC S9(0004) COMP.
  1456     05  CRTSFXF PIC  X(0001).
  1457     05  FILLER REDEFINES CRTSFXF.
  1458         10  CRTSFXA PIC  X(0001).
  1459     05  CRTSFXI PIC  X(0001).
  1460*    -------------------------------
  1461     05  LTRIDL PIC S9(0004) COMP.
  1462     05  LTRIDF PIC  X(0001).
  1463     05  FILLER REDEFINES LTRIDF.
  1464         10  LTRIDA PIC  X(0001).
  1465     05  LTRIDI PIC  X(0004).
  1466*    -------------------------------
  1467     05  SEQNOL PIC S9(0004) COMP.
  1468     05  SEQNOF PIC  X(0001).
  1469     05  FILLER REDEFINES SEQNOF.
  1470         10  SEQNOA PIC  X(0001).
  1471     05  SEQNOI PIC  X(0006).
  1472*    -------------------------------
  1473     05  FNAMEL PIC S9(0004) COMP.
  1474     05  FNAMEF PIC  X(0001).
  1475     05  FILLER REDEFINES FNAMEF.
  1476         10  FNAMEA PIC  X(0001).
  1477     05  FNAMEI PIC  X(0010).
  1478*    -------------------------------
  1479     05  MINITL PIC S9(0004) COMP.
  1480     05  MINITF PIC  X(0001).
  1481     05  FILLER REDEFINES MINITF.
  1482         10  MINITA PIC  X(0001).
  1483     05  MINITI PIC  X(0001).
  1484*    -------------------------------
  1485     05  LNAMEL PIC S9(0004) COMP.
  1486     05  LNAMEF PIC  X(0001).
  1487     05  FILLER REDEFINES LNAMEF.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  28
* EL6316.cbl
  1488         10  LNAMEA PIC  X(0001).
  1489     05  LNAMEI PIC  X(0015).
  1490*    -------------------------------
  1491     05  OLFDTL PIC S9(0004) COMP.
  1492     05  OLFDTF PIC  X(0001).
  1493     05  FILLER REDEFINES OLFDTF.
  1494         10  OLFDTA PIC  X(0001).
  1495     05  OLFDTI PIC  X(0008).
  1496*    -------------------------------
  1497     05  OLFAMTL PIC S9(0004) COMP.
  1498     05  OLFAMTF PIC  X(0001).
  1499     05  FILLER REDEFINES OLFAMTF.
  1500         10  OLFAMTA PIC  X(0001).
  1501     05  OLFAMTI PIC  X(0012).
  1502*    -------------------------------
  1503     05  OAHDTL PIC S9(0004) COMP.
  1504     05  OAHDTF PIC  X(0001).
  1505     05  FILLER REDEFINES OAHDTF.
  1506         10  OAHDTA PIC  X(0001).
  1507     05  OAHDTI PIC  X(0008).
  1508*    -------------------------------
  1509     05  OAHAMTL PIC S9(0004) COMP.
  1510     05  OAHAMTF PIC  X(0001).
  1511     05  FILLER REDEFINES OAHAMTF.
  1512         10  OAHAMTA PIC  X(0001).
  1513     05  OAHAMTI PIC  X(0012).
  1514*    -------------------------------
  1515     05  NLFDTL PIC S9(0004) COMP.
  1516     05  NLFDTF PIC  X(0001).
  1517     05  FILLER REDEFINES NLFDTF.
  1518         10  NLFDTA PIC  X(0001).
  1519     05  NLFDTI PIC  X(0008).
  1520*    -------------------------------
  1521     05  NLFAMTL PIC S9(0004) COMP.
  1522     05  NLFAMTF PIC  X(0001).
  1523     05  FILLER REDEFINES NLFAMTF.
  1524         10  NLFAMTA PIC  X(0001).
  1525     05  NLFAMTI PIC  X(0012).
  1526*    -------------------------------
  1527     05  NAHDTL PIC S9(0004) COMP.
  1528     05  NAHDTF PIC  X(0001).
  1529     05  FILLER REDEFINES NAHDTF.
  1530         10  NAHDTA PIC  X(0001).
  1531     05  NAHDTI PIC  X(0008).
  1532*    -------------------------------
  1533     05  NAHAMTL PIC S9(0004) COMP.
  1534     05  NAHAMTF PIC  X(0001).
  1535     05  FILLER REDEFINES NAHAMTF.
  1536         10  NAHAMTA PIC  X(0001).
  1537     05  NAHAMTI PIC  X(0012).
  1538*    -------------------------------
  1539     05  INPDTL PIC S9(0004) COMP.
  1540     05  INPDTF PIC  X(0001).
  1541     05  FILLER REDEFINES INPDTF.
  1542         10  INPDTA PIC  X(0001).
  1543     05  INPDTI PIC  X(0008).
  1544*    -------------------------------
  1545     05  PROCDTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  29
* EL6316.cbl
  1546     05  PROCDTF PIC  X(0001).
  1547     05  FILLER REDEFINES PROCDTF.
  1548         10  PROCDTA PIC  X(0001).
  1549     05  PROCDTI PIC  X(0008).
  1550*    -------------------------------
  1551     05  LFCOMML PIC S9(0004) COMP.
  1552     05  LFCOMMF PIC  X(0001).
  1553     05  FILLER REDEFINES LFCOMMF.
  1554         10  LFCOMMA PIC  X(0001).
  1555     05  LFCOMMI PIC  X(0006).
  1556*    -------------------------------
  1557     05  AHCOMML PIC S9(0004) COMP.
  1558     05  AHCOMMF PIC  X(0001).
  1559     05  FILLER REDEFINES AHCOMMF.
  1560         10  AHCOMMA PIC  X(0001).
  1561     05  AHCOMMI PIC  X(0006).
  1562*    -------------------------------
  1563     05  RCD01L PIC S9(0004) COMP.
  1564     05  RCD01F PIC  X(0001).
  1565     05  FILLER REDEFINES RCD01F.
  1566         10  RCD01A PIC  X(0001).
  1567     05  RCD01I PIC  X(0004).
  1568*    -------------------------------
  1569     05  RCD02L PIC S9(0004) COMP.
  1570     05  RCD02F PIC  X(0001).
  1571     05  FILLER REDEFINES RCD02F.
  1572         10  RCD02A PIC  X(0001).
  1573     05  RCD02I PIC  X(0004).
  1574*    -------------------------------
  1575     05  RCD03L PIC S9(0004) COMP.
  1576     05  RCD03F PIC  X(0001).
  1577     05  FILLER REDEFINES RCD03F.
  1578         10  RCD03A PIC  X(0001).
  1579     05  RCD03I PIC  X(0004).
  1580*    -------------------------------
  1581     05  RCD04L PIC S9(0004) COMP.
  1582     05  RCD04F PIC  X(0001).
  1583     05  FILLER REDEFINES RCD04F.
  1584         10  RCD04A PIC  X(0001).
  1585     05  RCD04I PIC  X(0004).
  1586*    -------------------------------
  1587     05  RCD05L PIC S9(0004) COMP.
  1588     05  RCD05F PIC  X(0001).
  1589     05  FILLER REDEFINES RCD05F.
  1590         10  RCD05A PIC  X(0001).
  1591     05  RCD05I PIC  X(0004).
  1592*    -------------------------------
  1593     05  RCD06L PIC S9(0004) COMP.
  1594     05  RCD06F PIC  X(0001).
  1595     05  FILLER REDEFINES RCD06F.
  1596         10  RCD06A PIC  X(0001).
  1597     05  RCD06I PIC  X(0004).
  1598*    -------------------------------
  1599     05  RCD07L PIC S9(0004) COMP.
  1600     05  RCD07F PIC  X(0001).
  1601     05  FILLER REDEFINES RCD07F.
  1602         10  RCD07A PIC  X(0001).
  1603     05  RCD07I PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  30
* EL6316.cbl
  1604*    -------------------------------
  1605     05  RCD08L PIC S9(0004) COMP.
  1606     05  RCD08F PIC  X(0001).
  1607     05  FILLER REDEFINES RCD08F.
  1608         10  RCD08A PIC  X(0001).
  1609     05  RCD08I PIC  X(0004).
  1610*    -------------------------------
  1611     05  RCD09L PIC S9(0004) COMP.
  1612     05  RCD09F PIC  X(0001).
  1613     05  FILLER REDEFINES RCD09F.
  1614         10  RCD09A PIC  X(0001).
  1615     05  RCD09I PIC  X(0004).
  1616*    -------------------------------
  1617     05  RCD10L PIC S9(0004) COMP.
  1618     05  RCD10F PIC  X(0001).
  1619     05  FILLER REDEFINES RCD10F.
  1620         10  RCD10A PIC  X(0001).
  1621     05  RCD10I PIC  X(0004).
  1622*    -------------------------------
  1623     05  RCD11L PIC S9(0004) COMP.
  1624     05  RCD11F PIC  X(0001).
  1625     05  FILLER REDEFINES RCD11F.
  1626         10  RCD11A PIC  X(0001).
  1627     05  RCD11I PIC  X(0004).
  1628*    -------------------------------
  1629     05  RCD12L PIC S9(0004) COMP.
  1630     05  RCD12F PIC  X(0001).
  1631     05  FILLER REDEFINES RCD12F.
  1632         10  RCD12A PIC  X(0001).
  1633     05  RCD12I PIC  X(0004).
  1634*    -------------------------------
  1635     05  CRTNT1L PIC S9(0004) COMP.
  1636     05  CRTNT1F PIC  X(0001).
  1637     05  FILLER REDEFINES CRTNT1F.
  1638         10  CRTNT1A PIC  X(0001).
  1639     05  CRTNT1I PIC  X(0063).
  1640*    -------------------------------
  1641     05  CRTNT2L PIC S9(0004) COMP.
  1642     05  CRTNT2F PIC  X(0001).
  1643     05  FILLER REDEFINES CRTNT2F.
  1644         10  CRTNT2A PIC  X(0001).
  1645     05  CRTNT2I PIC  X(0063).
  1646*    -------------------------------
  1647     05  ERRMSGL PIC S9(0004) COMP.
  1648     05  ERRMSGF PIC  X(0001).
  1649     05  FILLER REDEFINES ERRMSGF.
  1650         10  ERRMSGA PIC  X(0001).
  1651     05  ERRMSGI PIC  X(0075).
  1652*    -------------------------------
  1653     05  PFENTRL PIC S9(0004) COMP.
  1654     05  PFENTRF PIC  X(0001).
  1655     05  FILLER REDEFINES PFENTRF.
  1656         10  PFENTRA PIC  X(0001).
  1657     05  PFENTRI PIC  9(2).
  1658 01  EL631IO REDEFINES EL631II.
  1659     05  FILLER            PIC  X(0012).
  1660*    -------------------------------
  1661     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  31
* EL6316.cbl
  1662     05  DATEO PIC  X(0008).
  1663*    -------------------------------
  1664     05  FILLER            PIC  X(0003).
  1665     05  TIMEO PIC  99.99.
  1666*    -------------------------------
  1667     05  FILLER            PIC  X(0003).
  1668     05  PROCIDO PIC  X(0004).
  1669*    -------------------------------
  1670     05  FILLER            PIC  X(0003).
  1671     05  HOSTO PIC  X(0009).
  1672*    -------------------------------
  1673     05  FILLER            PIC  X(0003).
  1674     05  SYSO PIC  X(0005).
  1675*    -------------------------------
  1676     05  FILLER            PIC  X(0003).
  1677     05  COMPANYO PIC  X(0003).
  1678*    -------------------------------
  1679     05  FILLER            PIC  X(0003).
  1680     05  DATASORO PIC  X(0001).
  1681*    -------------------------------
  1682     05  FILLER            PIC  X(0003).
  1683     05  BATCHNOO PIC  X(0006).
  1684*    -------------------------------
  1685     05  FILLER            PIC  X(0003).
  1686     05  BSEQNOO PIC  X(0008).
  1687*    -------------------------------
  1688     05  FILLER            PIC  X(0003).
  1689     05  ARCHNOO PIC  X(0008).
  1690*    -------------------------------
  1691     05  FILLER            PIC  X(0003).
  1692     05  PRTSWO PIC  X(0001).
  1693*    -------------------------------
  1694     05  FILLER            PIC  X(0003).
  1695     05  CARRO PIC  X(0001).
  1696*    -------------------------------
  1697     05  FILLER            PIC  X(0003).
  1698     05  GROUPO PIC  X(0006).
  1699*    -------------------------------
  1700     05  FILLER            PIC  X(0003).
  1701     05  STATEO PIC  X(0002).
  1702*    -------------------------------
  1703     05  FILLER            PIC  X(0003).
  1704     05  ACCTO PIC  X(0010).
  1705*    -------------------------------
  1706     05  FILLER            PIC  X(0003).
  1707     05  EFFDTO PIC  X(0008).
  1708*    -------------------------------
  1709     05  FILLER            PIC  X(0003).
  1710     05  CERTNOO PIC  X(0010).
  1711*    -------------------------------
  1712     05  FILLER            PIC  X(0003).
  1713     05  CRTSFXO PIC  X(0001).
  1714*    -------------------------------
  1715     05  FILLER            PIC  X(0003).
  1716     05  LTRIDO PIC  X(0004).
  1717*    -------------------------------
  1718     05  FILLER            PIC  X(0003).
  1719     05  SEQNOO PIC  999999.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  32
* EL6316.cbl
  1720*    -------------------------------
  1721     05  FILLER            PIC  X(0003).
  1722     05  FNAMEO PIC  X(0010).
  1723*    -------------------------------
  1724     05  FILLER            PIC  X(0003).
  1725     05  MINITO PIC  X(0001).
  1726*    -------------------------------
  1727     05  FILLER            PIC  X(0003).
  1728     05  LNAMEO PIC  X(0015).
  1729*    -------------------------------
  1730     05  FILLER            PIC  X(0003).
  1731     05  OLFDTO PIC  X(0008).
  1732*    -------------------------------
  1733     05  FILLER            PIC  X(0003).
  1734     05  OLFAMTO PIC  Z,ZZZ,999.99.
  1735*    -------------------------------
  1736     05  FILLER            PIC  X(0003).
  1737     05  OAHDTO PIC  X(0008).
  1738*    -------------------------------
  1739     05  FILLER            PIC  X(0003).
  1740     05  OAHAMTO PIC  Z,ZZZ,999.99.
  1741*    -------------------------------
  1742     05  FILLER            PIC  X(0003).
  1743     05  NLFDTO PIC  X(0008).
  1744*    -------------------------------
  1745     05  FILLER            PIC  X(0003).
  1746     05  NLFAMTO PIC  Z,ZZZ,999.99.
  1747*    -------------------------------
  1748     05  FILLER            PIC  X(0003).
  1749     05  NAHDTO PIC  X(0008).
  1750*    -------------------------------
  1751     05  FILLER            PIC  X(0003).
  1752     05  NAHAMTO PIC  Z,ZZZ,999.99.
  1753*    -------------------------------
  1754     05  FILLER            PIC  X(0003).
  1755     05  INPDTO PIC  X(0008).
  1756*    -------------------------------
  1757     05  FILLER            PIC  X(0003).
  1758     05  PROCDTO PIC  X(0008).
  1759*    -------------------------------
  1760     05  FILLER            PIC  X(0003).
  1761     05  LFCOMMO PIC  .99999.
  1762*    -------------------------------
  1763     05  FILLER            PIC  X(0003).
  1764     05  AHCOMMO PIC  .99999.
  1765*    -------------------------------
  1766     05  FILLER            PIC  X(0003).
  1767     05  RCD01O PIC  X(0004).
  1768*    -------------------------------
  1769     05  FILLER            PIC  X(0003).
  1770     05  RCD02O PIC  X(0004).
  1771*    -------------------------------
  1772     05  FILLER            PIC  X(0003).
  1773     05  RCD03O PIC  X(0004).
  1774*    -------------------------------
  1775     05  FILLER            PIC  X(0003).
  1776     05  RCD04O PIC  X(0004).
  1777*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  33
* EL6316.cbl
  1778     05  FILLER            PIC  X(0003).
  1779     05  RCD05O PIC  X(0004).
  1780*    -------------------------------
  1781     05  FILLER            PIC  X(0003).
  1782     05  RCD06O PIC  X(0004).
  1783*    -------------------------------
  1784     05  FILLER            PIC  X(0003).
  1785     05  RCD07O PIC  X(0004).
  1786*    -------------------------------
  1787     05  FILLER            PIC  X(0003).
  1788     05  RCD08O PIC  X(0004).
  1789*    -------------------------------
  1790     05  FILLER            PIC  X(0003).
  1791     05  RCD09O PIC  X(0004).
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
  1794     05  RCD10O PIC  X(0004).
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  RCD11O PIC  X(0004).
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  RCD12O PIC  X(0004).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  CRTNT1O PIC  X(0063).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  CRTNT2O PIC  X(0063).
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  ERRMSGO PIC  X(0075).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  PFENTRO PIC  X(0002).
  1813*    -------------------------------
  1814 01  FILLER REDEFINES EL631II.
  1815     12  FILLER                   PIC X(357).
  1816     12  REASONCDS.
  1817         16  FILLER OCCURS 12.
  1818             20  REACDL       PIC S9(4) COMP.
  1819             20  REACDA       PIC X.
  1820             20  REACD-IN     PIC X(4).
  1821     12  FILLER               PIC X(215).
  1822****************************************************************
  1823*
  1824* Copyright (c) 2007 by Clerity Solutions, Inc.
  1825* All rights reserved.
  1826*
  1827****************************************************************
  1828 01  DFHEIV.
  1829   02  DFHEIV0               PIC X(35).
  1830   02  DFHEIV1               PIC X(08).
  1831   02  DFHEIV2               PIC X(08).
  1832   02  DFHEIV3               PIC X(08).
  1833   02  DFHEIV4               PIC X(06).
  1834   02  DFHEIV5               PIC X(04).
  1835   02  DFHEIV6               PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  34
* EL6316.cbl
  1836   02  DFHEIV7               PIC X(02).
  1837   02  DFHEIV8               PIC X(02).
  1838   02  DFHEIV9               PIC X(01).
  1839   02  DFHEIV10              PIC S9(7) COMP-3.
  1840   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1841   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1842   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1843   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1844   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1845   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1846   02  DFHEIV17              PIC X(04).
  1847   02  DFHEIV18              PIC X(04).
  1848   02  DFHEIV19              PIC X(04).
  1849   02  DFHEIV20              USAGE IS POINTER.
  1850   02  DFHEIV21              USAGE IS POINTER.
  1851   02  DFHEIV22              USAGE IS POINTER.
  1852   02  DFHEIV23              USAGE IS POINTER.
  1853   02  DFHEIV24              USAGE IS POINTER.
  1854   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1855   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1856   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1857   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1858   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1859   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1860   02  FILLER                PIC X(02).
  1861   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1862   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1863   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1864   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1865   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1866 LINKAGE  SECTION.
  1867*****************************************************************
  1868*                                                               *
  1869* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1870* All rights reserved.                                          *
  1871*                                                               *
  1872*****************************************************************
  1873 01  dfheiblk.
  1874     02  eibtime          pic s9(7) comp-3.
  1875     02  eibdate          pic s9(7) comp-3.
  1876     02  eibtrnid         pic x(4).
  1877     02  eibtaskn         pic s9(7) comp-3.
  1878     02  eibtrmid         pic x(4).
  1879     02  dfheigdi         pic s9(4) comp.
  1880     02  eibcposn         pic s9(4) comp.
  1881     02  eibcalen         pic s9(4) comp.
  1882     02  eibaid           pic x(1).
  1883     02  eibfiller1       pic x(1).
  1884     02  eibfn            pic x(2).
  1885     02  eibfiller2       pic x(2).
  1886     02  eibrcode         pic x(6).
  1887     02  eibfiller3       pic x(2).
  1888     02  eibds            pic x(8).
  1889     02  eibreqid         pic x(8).
  1890     02  eibrsrce         pic x(8).
  1891     02  eibsync          pic x(1).
  1892     02  eibfree          pic x(1).
  1893     02  eibrecv          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  35
* EL6316.cbl
  1894     02  eibsend          pic x(1).
  1895     02  eibatt           pic x(1).
  1896     02  eibeoc           pic x(1).
  1897     02  eibfmh           pic x(1).
  1898     02  eibcompl         pic x(1).
  1899     02  eibsig           pic x(1).
  1900     02  eibconf          pic x(1).
  1901     02  eiberr           pic x(1).
  1902     02  eibrldbk         pic x(1).
  1903     02  eiberrcd         pic x(4).
  1904     02  eibsynrb         pic x(1).
  1905     02  eibnodat         pic x(1).
  1906     02  eibfiller5       pic x(2).
  1907     02  eibresp          pic 9(09) comp.
  1908     02  eibresp2         pic 9(09) comp.
  1909     02  dfheigdj         pic s9(4) comp.
  1910     02  dfheigdk         pic s9(4) comp.
  1911 01  DFHCOMMAREA                 PIC X(1300).
  1912 01  var  pic x(30).
  1913*                                COPY ERCACCT.
  1914******************************************************************
  1915*                                                                *
  1916*                                                                *
  1917*                            ERCACCT                             *
  1918*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1919*                            VMOD=2.031                          *
  1920*                                                                *
  1921*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1922*                                                                *
  1923*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1924*   VSAM ACCOUNT MASTER FILES.                                   *
  1925*                                                                *
  1926*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1927*                                                                *
  1928*   FILE TYPE = VSAM,KSDS                                        *
  1929*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1930*                                                                *
  1931*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1932*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1933*                                                                *
  1934*   LOG = NO                                                     *
  1935*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1936*                                                                *
  1937*                                                                *
  1938******************************************************************
  1939*                   C H A N G E   L O G
  1940*
  1941* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1942*-----------------------------------------------------------------
  1943*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1944* EFFECTIVE    NUMBER
  1945*-----------------------------------------------------------------
  1946* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1947* 092705    2005050300006  PEMA  ADD SPP LEASES
  1948* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1949* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1950* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1951* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  36
* EL6316.cbl
  1952* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1953******************************************************************
  1954
  1955 01  ACCOUNT-MASTER.
  1956     12  AM-RECORD-ID                      PIC XX.
  1957         88  VALID-AM-ID                      VALUE 'AM'.
  1958
  1959     12  AM-CONTROL-PRIMARY.
  1960         16  AM-COMPANY-CD                 PIC X.
  1961         16  AM-MSTR-CNTRL.
  1962             20  AM-CONTROL-A.
  1963                 24  AM-CARRIER            PIC X.
  1964                 24  AM-GROUPING.
  1965                     28 AM-GROUPING-PREFIX PIC XXX.
  1966                     28 AM-GROUPING-PRIME  PIC XXX.
  1967                 24  AM-STATE              PIC XX.
  1968                 24  AM-ACCOUNT.
  1969                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1970                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1971             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1972                                           PIC X(19).
  1973             20  AM-CNTRL-B.
  1974                 24  AM-EXPIRATION-DT      PIC XX.
  1975                 24  FILLER                PIC X(4).
  1976             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1977                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1978
  1979     12  AM-CONTROL-BY-VAR-GRP.
  1980         16  AM-COMPANY-CD-A1              PIC X.
  1981         16  AM-VG-CARRIER                 PIC X.
  1982         16  AM-VG-GROUPING                PIC X(6).
  1983         16  AM-VG-STATE                   PIC XX.
  1984         16  AM-VG-ACCOUNT                 PIC X(10).
  1985         16  AM-VG-DATE.
  1986             20  AM-VG-EXPIRATION-DT       PIC XX.
  1987             20  FILLER                    PIC X(4).
  1988         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1989                                           PIC 9(11)      COMP-3.
  1990     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1991         16  FILLER                        PIC X(10).
  1992         16  AM-VG-KEY3.
  1993             20  AM-VG3-ACCOUNT            PIC X(10).
  1994             20  AM-VG3-EXP-DT             PIC XX.
  1995         16  FILLER                        PIC X(4).
  1996     12  AM-MAINT-INFORMATION.
  1997         16  AM-LAST-MAINT-DT              PIC XX.
  1998         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1999         16  AM-LAST-MAINT-USER            PIC X(4).
  2000         16  FILLER                        PIC XX.
  2001
  2002     12  AM-EFFECTIVE-DT                   PIC XX.
  2003     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2004
  2005     12  AM-PREV-DATES  COMP-3.
  2006         16  AM-PREV-EXP-DT                PIC 9(11).
  2007         16  AM-PREV-EFF-DT                PIC 9(11).
  2008
  2009     12  AM-REPORT-CODE-1                  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  37
* EL6316.cbl
  2010     12  AM-REPORT-CODE-2                  PIC X(10).
  2011
  2012     12  AM-CITY-CODE                      PIC X(4).
  2013     12  AM-COUNTY-PARISH                  PIC X(6).
  2014
  2015     12  AM-NAME                           PIC X(30).
  2016     12  AM-PERSON                         PIC X(30).
  2017     12  AM-ADDRS                          PIC X(30).
  2018     12  AM-CITY.
  2019         16  AM-ADDR-CITY                  PIC X(28).
  2020         16  AM-ADDR-STATE                 PIC XX.
  2021     12  AM-ZIP.
  2022         16  AM-ZIP-PRIME.
  2023             20  AM-ZIP-PRI-1ST            PIC X.
  2024                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2025             20  FILLER                    PIC X(4).
  2026         16  AM-ZIP-PLUS4                  PIC X(4).
  2027     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2028         16  AM-CAN-POSTAL-1               PIC XXX.
  2029         16  AM-CAN-POSTAL-2               PIC XXX.
  2030         16  FILLER                        PIC XXX.
  2031     12  AM-TEL-NO.
  2032         16  AM-AREA-CODE                  PIC 999.
  2033         16  AM-TEL-PRE                    PIC 999.
  2034         16  AM-TEL-NBR                    PIC 9(4).
  2035     12  AM-TEL-LOC                        PIC X.
  2036         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2037         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2038
  2039     12  AM-COMM-STRUCTURE.
  2040         16  AM-DEFN-1.
  2041             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2042                 24  AM-AGT.
  2043                     28  AM-AGT-PREFIX     PIC X(4).
  2044                     28  AM-AGT-PRIME      PIC X(6).
  2045                 24  AM-COM-TYP            PIC X.
  2046                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2047                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2048                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2049                 24  AM-RECALC-LV-INDIC    PIC X.
  2050                 24  AM-RETRO-LV-INDIC     PIC X.
  2051                 24  AM-GL-CODES           PIC X.
  2052                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2053                 24  FILLER                PIC X(01).
  2054         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2055             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2056                 24  FILLER                PIC X(11).
  2057                 24  AM-L-COMA             PIC XXX.
  2058                 24  AM-J-COMA             PIC XXX.
  2059                 24  AM-A-COMA             PIC XXX.
  2060                 24  FILLER                PIC X(6).
  2061
  2062     12  AM-COMM-CHANGE-STATUS             PIC X.
  2063         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2064
  2065     12  AM-CSR-CODE                       PIC X(4).
  2066
  2067     12  AM-BILLING-STATUS                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  38
* EL6316.cbl
  2068         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2069         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2070     12  AM-AUTO-REFUND-SW                 PIC X.
  2071         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2072         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2073     12  AM-GPCD                           PIC 99.
  2074     12  AM-IG                             PIC X.
  2075         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2076         88  AM-HAS-GROUP                     VALUE '2'.
  2077     12  AM-STATUS                         PIC X.
  2078         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2079         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2080         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2081         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2082         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2083         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2084     12  AM-REMIT-TO                       PIC 99.
  2085     12  AM-ID-NO                          PIC X(11).
  2086
  2087     12  AM-CAL-TABLE                      PIC XX.
  2088     12  AM-LF-DEVIATION                   PIC XXX.
  2089     12  AM-AH-DEVIATION                   PIC XXX.
  2090     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2091     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2092     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2093     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2094     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2095     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2096
  2097     12  AM-USER-FIELDS.
  2098         16  AM-FLD-1                      PIC XX.
  2099         16  AM-FLD-2                      PIC XX.
  2100         16  AM-FLD-3                      PIC XX.
  2101         16  AM-FLD-4                      PIC XX.
  2102         16  AM-FLD-5                      PIC XX.
  2103
  2104     12  AM-1ST-PROD-DATE.
  2105         16  AM-1ST-PROD-YR                PIC XX.
  2106         16  AM-1ST-PROD-MO                PIC XX.
  2107         16  AM-1ST-PROD-DA                PIC XX.
  2108     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2109     12  AM-CERTS-PURGED-DATE.
  2110         16  AM-PUR-YR                     PIC XX.
  2111         16  AM-PUR-MO                     PIC XX.
  2112         16  AM-PUR-DA                     PIC XX.
  2113     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2114     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2115     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2116     12  AM-INACTIVE-DATE.
  2117         16  AM-INA-MO                     PIC 99.
  2118         16  AM-INA-DA                     PIC 99.
  2119         16  AM-INA-YR                     PIC 99.
  2120     12  AM-AR-HI-CERT-DATE                PIC XX.
  2121
  2122     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2123     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2124
  2125     12  AM-OB-PAYMENT-MODE                PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  39
* EL6316.cbl
  2126         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2127         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2128         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2129         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2130
  2131     12  AM-AH-ONLY-INDICATOR              PIC X.
  2132         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2133         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2134
  2135     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2136
  2137     12  AM-OVER-SHORT.
  2138         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2139         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2140
  2141     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2142     12  AM-DCC-CLP-STATE                  PIC XX.
  2143
  2144     12  AM-RECALC-COMM                    PIC X.
  2145     12  AM-RECALC-REIN                    PIC X.
  2146
  2147     12  AM-REI-TABLE                      PIC XXX.
  2148     12  AM-REI-ET-LF                      PIC X.
  2149     12  AM-REI-ET-AH                      PIC X.
  2150     12  AM-REI-PE-LF                      PIC X.
  2151     12  AM-REI-PE-AH                      PIC X.
  2152     12  AM-REI-PRT-ST                     PIC X.
  2153     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2154     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2155     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2156     12  AM-REI-GROUP-A                    PIC X(6).
  2157     12  AM-REI-MORT                       PIC X(4).
  2158     12  AM-REI-PRT-OW                     PIC X.
  2159     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2160     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2161     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2162     12  AM-REI-GROUP-B                    PIC X(6).
  2163
  2164     12  AM-TRUST-TYPE                     PIC X(2).
  2165
  2166     12  AM-EMPLOYER-STMT-USED             PIC X.
  2167     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2168
  2169     12  AM-STD-AH-TYPE                    PIC XX.
  2170     12  AM-EARN-METHODS.
  2171         16  AM-EARN-METHOD-R              PIC X.
  2172             88 AM-REF-RL-R78                 VALUE 'R'.
  2173             88 AM-REF-RL-PR                  VALUE 'P'.
  2174             88 AM-REF-RL-MEAN                VALUE 'M'.
  2175             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2176         16  AM-EARN-METHOD-L              PIC X.
  2177             88 AM-REF-LL-R78                 VALUE 'R'.
  2178             88 AM-REF-LL-PR                  VALUE 'P'.
  2179             88 AM-REF-LL-MEAN                VALUE 'M'.
  2180             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2181         16  AM-EARN-METHOD-A              PIC X.
  2182             88 AM-REF-AH-R78                 VALUE 'R'.
  2183             88 AM-REF-AH-PR                  VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  40
* EL6316.cbl
  2184             88 AM-REF-AH-MEAN                VALUE 'M'.
  2185             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2186             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2187             88 AM-REF-AH-NET                 VALUE 'N'.
  2188
  2189     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2190     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2191     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2192
  2193     12  AM-RET-Y-N                        PIC X.
  2194     12  AM-RET-P-E                        PIC X.
  2195     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2196     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2197     12  AM-RET-GRP                        PIC X(6).
  2198     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2199         16  AM-POOL-PRIME                 PIC XXX.
  2200         16  AM-POOL-SUB                   PIC XXX.
  2201     12  AM-RETRO-EARNINGS.
  2202         16  AM-RET-EARN-R                 PIC X.
  2203         16  AM-RET-EARN-L                 PIC X.
  2204         16  AM-RET-EARN-A                 PIC X.
  2205     12  AM-RET-ST-TAX-USE                 PIC X.
  2206         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2207         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2208     12  AM-RETRO-BEG-EARNINGS.
  2209         16  AM-RET-BEG-EARN-R             PIC X.
  2210         16  AM-RET-BEG-EARN-L             PIC X.
  2211         16  AM-RET-BEG-EARN-A             PIC X.
  2212     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2213     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2214
  2215     12  AM-USER-SELECT-OPTIONS.
  2216         16  AM-USER-SELECT-1              PIC X(10).
  2217         16  AM-USER-SELECT-2              PIC X(10).
  2218         16  AM-USER-SELECT-3              PIC X(10).
  2219         16  AM-USER-SELECT-4              PIC X(10).
  2220         16  AM-USER-SELECT-5              PIC X(10).
  2221
  2222     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2223
  2224     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2225
  2226     12  AM-RPT045A-SWITCH                 PIC X.
  2227         88  RPT045A-OFF                   VALUE 'N'.
  2228
  2229     12  AM-INSURANCE-LIMITS.
  2230         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2231         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2232
  2233     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2234         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2235
  2236     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2237         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2238         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2239
  2240     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2241
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  41
* EL6316.cbl
  2242     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2243     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2244     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2245     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2246     12  AM-DCC-UEF-STATE                  PIC XX.
  2247     12  FILLER                            PIC XXX.
  2248     12  AM-REPORT-CODE-3                  PIC X(10).
  2249*    12  FILLER                            PIC X(22).
  2250
  2251     12  AM-RESERVE-DATE.
  2252         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2253         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2254         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2255
  2256     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2257     12  AM-NOTIFICATION-TYPES.
  2258         16  AM-NOTIF-OF-LETTERS           PIC X.
  2259         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2260         16  AM-NOTIF-OF-REPORTS           PIC X.
  2261         16  AM-NOTIF-OF-STATUS            PIC X.
  2262
  2263     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2264         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2265         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2266         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2267         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2268
  2269     12  AM-BENEFIT-CONTROLS.
  2270         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2271             20  AM-BENEFIT-CODE           PIC XX.
  2272             20  AM-BENEFIT-TYPE           PIC X.
  2273             20  AM-BENEFIT-REVISION       PIC XXX.
  2274             20  AM-BENEFIT-REM-TERM       PIC X.
  2275             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2276             20  FILLER                    PIC XX.
  2277         16  FILLER                        PIC X(80).
  2278
  2279     12  AM-TRANSFER-DATA.
  2280         16  AM-TRANSFERRED-FROM.
  2281             20  AM-TRNFROM-CARRIER        PIC X.
  2282             20  AM-TRNFROM-GROUPING.
  2283                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2284                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2285             20  AM-TRNFROM-STATE          PIC XX.
  2286             20  AM-TRNFROM-ACCOUNT.
  2287                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2288                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2289             20  AM-TRNFROM-DTE            PIC XX.
  2290         16  AM-TRANSFERRED-TO.
  2291             20  AM-TRNTO-CARRIER          PIC X.
  2292             20  AM-TRNTO-GROUPING.
  2293                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2294                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2295             20  AM-TRNTO-STATE            PIC XX.
  2296             20  AM-TRNTO-ACCOUNT.
  2297                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2298                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2299             20  AM-TRNTO-DTE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  42
* EL6316.cbl
  2300         16  FILLER                        PIC X(10).
  2301
  2302     12  AM-SAVED-REMIT-TO                 PIC 99.
  2303
  2304     12  AM-COMM-STRUCTURE-SAVED.
  2305         16  AM-DEFN-1-SAVED.
  2306             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2307                 24  AM-AGT-SV             PIC X(10).
  2308                 24  AM-COM-TYP-SV         PIC X.
  2309                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2310                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2311                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2312                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2313                 24  FILLER                PIC X.
  2314                 24  AM-GL-CODES-SV        PIC X.
  2315                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2316                 24  FILLER                PIC X.
  2317         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2318             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2319                 24  FILLER                PIC X(11).
  2320                 24  AM-L-COMA-SV          PIC XXX.
  2321                 24  AM-J-COMA-SV          PIC XXX.
  2322                 24  AM-A-COMA-SV          PIC XXX.
  2323                 24  FILLER                PIC X(6).
  2324
  2325     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2326         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2327            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2328            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2329            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2330
  2331     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2332     12  FILLER                            PIC X(120).
  2333
  2334     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2335         16  AM-CONTROL-NAME               PIC X(30).
  2336         16  AM-EXECUTIVE-ONE.
  2337             20  AM-EXEC1-NAME             PIC X(15).
  2338             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2339                                                          COMP-3.
  2340             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2341                                                          COMP-3.
  2342         16  AM-EXECUTIVE-TWO.
  2343             20  AM-EXEC2-NAME             PIC X(15).
  2344             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2345                                                          COMP-3.
  2346             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2347                                                          COMP-3.
  2348
  2349     12  AM-RETRO-ADDITIONAL-DATA.
  2350         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2351         16  AM-RETRO-PREM-P-E             PIC X.
  2352         16  AM-RETRO-CLMS-P-I             PIC X.
  2353         16  AM-RETRO-RET-BRACKET-LF.
  2354             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2355                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2356                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2357             20  AM-RETRO-RET-BASIS-LF     PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  43
* EL6316.cbl
  2358                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2359                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2360             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2361                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2362                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2363         16  AM-RETRO-RET-BRACKET-AH.
  2364             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2365                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2366                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2367                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2368             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2369                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2370                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2371             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2372                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2373                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2374
  2375     12  AM-COMMENTS.
  2376         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2377
  2378     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2379         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2380         16  AM-FLI-BILLING-CODE           PIC X.
  2381         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2382         16  AM-FLI-UNITED-IDENT           PIC X.
  2383         16  AM-FLI-INTEREST-LOST-DATA.
  2384             20  AM-FLI-BANK-NO            PIC X(5).
  2385             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2386             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2387             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2388         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2389             20  AM-FLI-AGT                PIC X(9).
  2390             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2391             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2392         16  FILLER                        PIC X(102).
  2393
  2394     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2395         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2396             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2397             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2398             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2399             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2400             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2401         16  FILLER                          PIC X(10).
  2402******************************************************************
  2403*                                COPY ELCCNTL.
  2404******************************************************************
  2405*                                                                *
  2406*                                                                *
  2407*                            ELCCNTL.                            *
  2408*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2409*                            VMOD=2.059                          *
  2410*                                                                *
  2411*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2412*                                                                *
  2413*   FILE TYPE = VSAM,KSDS                                        *
  2414*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2415*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  44
* EL6316.cbl
  2416*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2417*       ALTERNATE INDEX = NONE                                   *
  2418*                                                                *
  2419*   LOG = YES                                                    *
  2420*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2421******************************************************************
  2422*                   C H A N G E   L O G
  2423*
  2424* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2425*-----------------------------------------------------------------
  2426*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2427* EFFECTIVE    NUMBER
  2428*-----------------------------------------------------------------
  2429* 082503                   PEMA  ADD BENEFIT GROUP
  2430* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2431* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2432* 092705    2005050300006  PEMA  ADD SPP LEASES
  2433* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2434* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2435* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2436* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2437* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2438* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2439******************************************************************
  2440*
  2441 01  CONTROL-FILE.
  2442     12  CF-RECORD-ID                       PIC XX.
  2443         88  VALID-CF-ID                        VALUE 'CF'.
  2444
  2445     12  CF-CONTROL-PRIMARY.
  2446         16  CF-COMPANY-ID                  PIC XXX.
  2447         16  CF-RECORD-TYPE                 PIC X.
  2448             88  CF-COMPANY-MASTER              VALUE '1'.
  2449             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2450             88  CF-STATE-MASTER                VALUE '3'.
  2451             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2452             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2453             88  CF-CARRIER-MASTER              VALUE '6'.
  2454             88  CF-MORTALITY-MASTER            VALUE '7'.
  2455             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2456             88  CF-TERMINAL-MASTER             VALUE '9'.
  2457             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2458             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2459             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2460             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2461             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2462             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2463             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2464             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2465             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2466         16  CF-ACCESS-CD-GENL              PIC X(4).
  2467         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2468             20  CF-PROCESSOR               PIC X(4).
  2469         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2470             20  CF-STATE-CODE              PIC XX.
  2471             20  FILLER                     PIC XX.
  2472         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2473             20  FILLER                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  45
* EL6316.cbl
  2474             20  CF-HI-BEN-IN-REC           PIC XX.
  2475         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2476             20  FILLER                     PIC XXX.
  2477             20  CF-CARRIER-CNTL            PIC X.
  2478         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2479             20  FILLER                     PIC XX.
  2480             20  CF-HI-TYPE-IN-REC          PIC 99.
  2481         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2482             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2483                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2484             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2485             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2486         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2487             20  FILLER                     PIC X.
  2488             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2489         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2490             20  FILLER                     PIC XX.
  2491             20  CF-MORTGAGE-PLAN           PIC XX.
  2492         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2493
  2494     12  CF-LAST-MAINT-DT                   PIC XX.
  2495     12  CF-LAST-MAINT-BY                   PIC X(4).
  2496     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2497
  2498     12  CF-RECORD-BODY                     PIC X(728).
  2499
  2500
  2501****************************************************************
  2502*             COMPANY MASTER RECORD                            *
  2503****************************************************************
  2504
  2505     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2506         16  CF-COMPANY-ADDRESS.
  2507             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2508             20  CF-CL-IN-CARE-OF           PIC X(30).
  2509             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2510             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2511             20  CF-CL-CITY-STATE           PIC X(30).
  2512             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2513             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2514         16  CF-COMPANY-CD                  PIC X.
  2515         16  CF-COMPANY-PASSWORD            PIC X(8).
  2516         16  CF-SECURITY-OPTION             PIC X.
  2517             88  ALL-SECURITY                   VALUE '1'.
  2518             88  COMPANY-VERIFY                 VALUE '2'.
  2519             88  PROCESSOR-VERIFY               VALUE '3'.
  2520             88  NO-SECURITY                    VALUE '4'.
  2521             88  ALL-BUT-TERM                   VALUE '5'.
  2522         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2523             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2524         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2525             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2526         16  CF-INFORCE-LOCATION            PIC X.
  2527             88  CERTS-ARE-ONLINE               VALUE '1'.
  2528             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2529             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2530         16  CF-LOWER-CASE-LETTERS          PIC X.
  2531         16  CF-CERT-ACCESS-CONTROL         PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  46
* EL6316.cbl
  2532             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2533             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2534             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2535             88  CF-ACCNT-CNTL                  VALUE '3'.
  2536             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2537
  2538         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2539         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2540
  2541         16  CF-LGX-CREDIT-USER             PIC X.
  2542             88  CO-IS-NOT-USER                 VALUE 'N'.
  2543             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2544
  2545         16 CF-CREDIT-CALC-CODES.
  2546             20  CF-CR-REM-TERM-CALC PIC X.
  2547               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2548               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2549               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2550               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2551               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2552               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2553               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2554             20  CF-CR-R78-METHOD           PIC X.
  2555               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2556               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2557
  2558         16  CF-CLAIM-CONTROL-COUNTS.
  2559             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2560                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2561
  2562             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2563                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2564
  2565             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2566                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2567
  2568             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2569                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2570
  2571         16  CF-CURRENT-MONTH-END           PIC XX.
  2572
  2573         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2574             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2575             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2576             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2577             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2578                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2579                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2580             20  CF-CO-PREM-REJECT-SW       PIC X.
  2581                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2582                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2583             20  CF-CO-REF-REJECT-SW        PIC X.
  2584                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2585                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2586
  2587         16  CF-CO-REPORTING-DT             PIC XX.
  2588         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2589         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  47
* EL6316.cbl
  2590           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2591           88  CF-CO-MONTH-END                  VALUE '1'.
  2592
  2593         16  CF-LGX-CLAIM-USER              PIC X.
  2594             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2595             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2596
  2597         16  CF-CREDIT-EDIT-CONTROLS.
  2598             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2599             20  CF-MIN-AGE                 PIC 99.
  2600             20  CF-DEFAULT-AGE             PIC 99.
  2601             20  CF-MIN-TERM                PIC S999      COMP-3.
  2602             20  CF-MAX-TERM                PIC S999      COMP-3.
  2603             20  CF-DEFAULT-SEX             PIC X.
  2604             20  CF-JOINT-AGE-INPUT         PIC X.
  2605                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2606             20  CF-BIRTH-DATE-INPUT        PIC X.
  2607                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2608             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2609                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2610                 88  CF-ZERO-CARRIER            VALUE '1'.
  2611                 88  CF-ZERO-GROUPING           VALUE '2'.
  2612                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2613             20  CF-EDIT-SW                 PIC X.
  2614                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2615             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2616             20  CF-CR-PR-METHOD            PIC X.
  2617               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2618               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2619             20  FILLER                     PIC X.
  2620
  2621         16  CF-CREDIT-MISC-CONTROLS.
  2622             20  CF-REIN-TABLE-SW           PIC X.
  2623                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2624             20  CF-COMP-TABLE-SW           PIC X.
  2625                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2626             20  CF-EXPERIENCE-RETENTION-AGE
  2627                                            PIC S9        COMP-3.
  2628             20  CF-CONVERSION-DT           PIC XX.
  2629             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2630             20  CF-RUN-FREQUENCY-SW        PIC X.
  2631                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2632                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2633
  2634             20  CF-CR-CHECK-NO-CONTROL.
  2635                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2636                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2637                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2638                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2639                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2640                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2641
  2642                 24  CF-CR-CHECK-COUNT       REDEFINES
  2643                     CF-CR-CHECK-COUNTER      PIC X(4).
  2644
  2645                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2646                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2647
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  48
* EL6316.cbl
  2648                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2649                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2650                 24  CF-MAIL-PROCESSING       PIC X.
  2651                     88  MAIL-PROCESSING          VALUE 'Y'.
  2652
  2653         16  CF-MISC-SYSTEM-CONTROL.
  2654             20  CF-SYSTEM-C                 PIC X.
  2655                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2656             20  CF-SYSTEM-D                 PIC X.
  2657                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2658             20  CF-SOC-SEC-NO-SW            PIC X.
  2659                 88  SOC-SEC-NO-USED             VALUE '1'.
  2660             20  CF-MEMBER-NO-SW             PIC X.
  2661                 88  MEMBER-NO-USED              VALUE '1'.
  2662             20  CF-TAX-ID-NUMBER            PIC X(11).
  2663             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2664             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2665                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2666                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2667                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2668                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2669             20  CF-SYSTEM-E                 PIC X.
  2670                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2671
  2672         16  CF-LGX-LIFE-USER               PIC X.
  2673             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2674             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2675
  2676         16  CF-CR-MONTH-END-DT             PIC XX.
  2677
  2678         16  CF-FILE-MAINT-DATES.
  2679             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2680                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2681             20  CF-LAST-BATCH       REDEFINES
  2682                 CF-LAST-BATCH-NO               PIC X(4).
  2683             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2684             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2685             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2686             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2687             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2688             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2689             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2690             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2691             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2692             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2693
  2694         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2695         16  FILLER                         PIC X.
  2696
  2697         16  CF-ALT-MORT-CODE               PIC X(4).
  2698         16  CF-MEMBER-CAPTION              PIC X(10).
  2699
  2700         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2701             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2702             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2703             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2704             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2705             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  49
* EL6316.cbl
  2706
  2707         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2708
  2709         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2710         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2711         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2712         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2713
  2714         16  CF-AH-OVERRIDE-L1              PIC X.
  2715         16  CF-AH-OVERRIDE-L2              PIC XX.
  2716         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2717         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2718
  2719         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2720         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2721
  2722         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2723         16  CF-AR-LAST-EL860-DT            PIC XX.
  2724         16  CF-MP-MONTH-END-DT             PIC XX.
  2725
  2726         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2727         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2728             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2729
  2730         16  CF-AR-MONTH-END-DT             PIC XX.
  2731
  2732         16  CF-CRDTCRD-USER                PIC X.
  2733             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2734             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2735
  2736         16  CF-CC-MONTH-END-DT             PIC XX.
  2737
  2738         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2739
  2740         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2741             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2742             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2743             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2744         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2745         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2746         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2747         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2748             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2749             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2750         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2751         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2752         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2753             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2754         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2755
  2756         16  CF-CL-ZIP-CODE.
  2757             20  CF-CL-ZIP-PRIME.
  2758                 24  CF-CL-ZIP-1ST          PIC X.
  2759                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2760                 24  FILLER                 PIC X(4).
  2761             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2762         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2763             20  CF-CL-CAN-POSTAL-1         PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  50
* EL6316.cbl
  2764             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2765             20  FILLER                     PIC XXX.
  2766
  2767         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2768         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2769         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2770         16  CF-CO-OPTION-START-DATE        PIC XX.
  2771         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2772           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2773                                                      '3' '4'.
  2774           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2775           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2776           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2777           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2778           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2779           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2780
  2781         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2782
  2783         16  CF-PAYMENT-APPROVAL-LEVELS.
  2784             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2785             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2786             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2787             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2788             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2789             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2790
  2791         16  CF-END-USER-REPORTING-USER     PIC X.
  2792             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2793             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2794
  2795         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2796             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2797             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2798
  2799         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2800
  2801         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2802         16  FILLER                         PIC X.
  2803
  2804         16  CF-CREDIT-ARCHIVE-CNTL.
  2805             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2806             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2807             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2808
  2809         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2810
  2811         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2812             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2813             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2814
  2815         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2816             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2817             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2818
  2819         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2820
  2821         16  CF-CO-ACH-ID-CODE              PIC  X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  51
* EL6316.cbl
  2822             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2823             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2824             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2825         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2826         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2827         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2828         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2829         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2830         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2831         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2832         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2833         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2834                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2835         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2836                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2837
  2838         16  CF-CO-OVER-SHORT.
  2839             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2840             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2841
  2842*         16  FILLER                         PIC X(102).
  2843         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2844             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2845             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2846
  2847         16  CF-AH-APPROVAL-DAYS.
  2848             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2849             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2850             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2851             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2852
  2853         16  FILLER                         PIC X(82).
  2854****************************************************************
  2855*             PROCESSOR/USER RECORD                            *
  2856****************************************************************
  2857
  2858     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2859         16  CF-PROCESSOR-NAME              PIC X(30).
  2860         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2861         16  CF-PROCESSOR-TITLE             PIC X(26).
  2862         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2863                 88  MESSAGE-YES                VALUE 'Y'.
  2864                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2865
  2866*****************************************************
  2867****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2868****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2869****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2870****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2871*****************************************************
  2872
  2873         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2874             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2875             20  CF-APPLICATION-FORCE       PIC X.
  2876             20  CF-INDIVIDUAL-APP.
  2877                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2878                     28  CF-BROWSE-APP      PIC X.
  2879                     28  CF-UPDATE-APP      PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  52
* EL6316.cbl
  2880
  2881         16  CF-CURRENT-TERM-ON             PIC X(4).
  2882         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2883             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2884             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2885             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2886             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2887             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2888             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2889             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2890         16  CF-PROCESSOR-CARRIER           PIC X.
  2891             88  NO-CARRIER-SECURITY            VALUE ' '.
  2892         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2893             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2894         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2895             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2896         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2897             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2898
  2899         16  CF-PROC-SYS-ACCESS-SW.
  2900             20  CF-PROC-CREDIT-CLAIMS-SW.
  2901                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2902                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2903                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2904                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2905             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2906                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2907                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2908             20  CF-PROC-LIFE-GNRLDGR-SW.
  2909                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2910                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2911                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2912                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2913             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2914                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2915                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2916         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2917             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2918             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2919         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2920
  2921         16  CF-APPROVAL-LEVEL                  PIC X.
  2922             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2923             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2924             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2925             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2926
  2927         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2928
  2929         16  CF-LANGUAGE-TYPE                   PIC X.
  2930             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2931             88  CF-LANG-IS-FR                      VALUE 'F'.
  2932
  2933         16  CF-CSR-IND                         PIC X.
  2934         16  FILLER                             PIC X(239).
  2935
  2936****************************************************************
  2937*             PROCESSOR/REMINDERS RECORD                       *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  53
* EL6316.cbl
  2938****************************************************************
  2939
  2940     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2941         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2942             20  CF-START-REMIND-DT         PIC XX.
  2943             20  CF-END-REMIND-DT           PIC XX.
  2944             20  CF-REMINDER-TEXT           PIC X(50).
  2945         16  FILLER                         PIC X(296).
  2946
  2947
  2948****************************************************************
  2949*             STATE MASTER RECORD                              *
  2950****************************************************************
  2951
  2952     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2953         16  CF-STATE-ABBREVIATION          PIC XX.
  2954         16  CF-STATE-NAME                  PIC X(25).
  2955         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2956         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2957             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2958             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2959             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2960             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2961                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2962                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2963             20  CF-ST-PREM-REJECT-SW       PIC X.
  2964                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2965                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2966             20  CF-ST-REF-REJECT-SW        PIC X.
  2967                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2968                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2969         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2970         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2971         16  CF-ST-REFUND-RULES.
  2972             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2973             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2974             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2975         16  CF-ST-FST-PMT-EXTENSION.
  2976             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2977             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2978                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2979                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2980                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2981                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2982         16  CF-ST-STATE-CALL.
  2983             20  CF-ST-CALL-UNEARNED        PIC X.
  2984             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2985             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2986         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2987             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2988             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2989         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2990         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2991         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2992         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2993         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2994         16  FILLER                         PIC X.
  2995         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  54
* EL6316.cbl
  2996             20  CF-ST-BENEFIT-CD           PIC XX.
  2997             20  CF-ST-BENEFIT-KIND         PIC X.
  2998                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2999                 88  CF-ST-AH-KIND              VALUE 'A'.
  3000             20  CF-ST-REM-TERM-CALC        PIC X.
  3001                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3002                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3003                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3004                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3005                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3006                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3007                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3008                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3009
  3010             20  CF-ST-REFUND-CALC          PIC X.
  3011                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3012                 88  ST-REFD-BY-R78             VALUE '1'.
  3013                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3014                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3015                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3016                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3017                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3018                 88  ST-REFD-UTAH               VALUE '7'.
  3019                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3020                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3021                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3022
  3023             20  CF-ST-EARNING-CALC         PIC X.
  3024                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3025                 88  ST-EARN-BY-R78             VALUE '1'.
  3026                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3027                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3028                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3029                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3030                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3031                 88  ST-EARN-MEAN               VALUE '8'.
  3032                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3033
  3034             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3035                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3036                 88  ST-OVRD-BY-R78             VALUE '1'.
  3037                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3038                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3039                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3040                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3041                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3042                 88  ST-OVRD-MEAN               VALUE '8'.
  3043                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3044             20  FILLER                     PIC X.
  3045
  3046         16  CF-ST-COMMISSION-CAPS.
  3047             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3048             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3049             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3050             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3051         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3052                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3053
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  55
* EL6316.cbl
  3054         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3055
  3056         16  CF-ST-STATUTORY-INTEREST.
  3057             20  CF-ST-STAT-DATE-FROM       PIC X.
  3058                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3059                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3060             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3061             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3062             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3063             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3064             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3065
  3066         16  CF-ST-OVER-SHORT.
  3067             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3068             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3069
  3070         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3071
  3072         16  CF-ST-RT-CALC                  PIC X.
  3073
  3074         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3075         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3076         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3077         16  CF-ST-RF-LR-CALC               PIC X.
  3078         16  CF-ST-RF-LL-CALC               PIC X.
  3079         16  CF-ST-RF-LN-CALC               PIC X.
  3080         16  CF-ST-RF-AH-CALC               PIC X.
  3081         16  CF-ST-RF-CP-CALC               PIC X.
  3082*        16  FILLER                         PIC X(206).
  3083*CIDMOD         16  FILLER                         PIC X(192).
  3084         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3085             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3086         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3087         16  CF-ST-VFY-2ND-BENE             PIC X.
  3088         16  FILLER                         PIC X(186).
  3089
  3090****************************************************************
  3091*             BENEFIT MASTER RECORD                            *
  3092****************************************************************
  3093
  3094     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3095         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3096             20  CF-BENEFIT-CODE            PIC XX.
  3097             20  CF-BENEFIT-NUMERIC  REDEFINES
  3098                 CF-BENEFIT-CODE            PIC XX.
  3099             20  CF-BENEFIT-ALPHA           PIC XXX.
  3100             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3101             20  CF-BENEFIT-COMMENT         PIC X(10).
  3102
  3103             20  CF-LF-COVERAGE-TYPE        PIC X.
  3104                 88  CF-REDUCING                VALUE 'R'.
  3105                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3106
  3107             20  CF-SPECIAL-CALC-CD         PIC X.
  3108                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3109                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3110                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3111                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  56
* EL6316.cbl
  3112                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3113                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3114                 88  CF-FARM-PLAN               VALUE 'F'.
  3115                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3116                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3117                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3118                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3119                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3120                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3121                 88  CF-PRUDENTIAL              VALUE 'P'.
  3122                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3123                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3124                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3125                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3126                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3127                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3128
  3129             20  CF-JOINT-INDICATOR         PIC X.
  3130                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3131
  3132*            20  FILLER                     PIC X(12).
  3133             20  FILLER                     PIC X(11).
  3134             20  CF-BENEFIT-CATEGORY        PIC X.
  3135             20  CF-LOAN-TYPE               PIC X(8).
  3136
  3137             20  CF-CO-REM-TERM-CALC        PIC X.
  3138                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3139                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3140                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3141                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3142                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3143
  3144             20  CF-CO-EARNINGS-CALC        PIC X.
  3145                 88  CO-EARN-BY-R78             VALUE '1'.
  3146                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3147                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3148                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3149                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3150                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3151                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3152                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3153
  3154             20  CF-CO-REFUND-CALC          PIC X.
  3155                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3156                 88  CO-REFD-BY-R78             VALUE '1'.
  3157                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3158                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3159                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3160                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3161                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3162                 88  CO-REFD-MEAN               VALUE '8'.
  3163                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3164                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3165                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3166
  3167             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3168                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3169                 88  CO-OVRD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  57
* EL6316.cbl
  3170                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3171                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3172                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3173                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3174                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3175                 88  CO-OVRD-MEAN               VALUE '8'.
  3176                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3177
  3178             20  CF-CO-BEN-I-G-CD           PIC X.
  3179                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3180                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3181                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3182
  3183         16  FILLER                         PIC X(304).
  3184
  3185
  3186****************************************************************
  3187*             CARRIER MASTER RECORD                            *
  3188****************************************************************
  3189
  3190     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3191         16  CF-ADDRESS-DATA.
  3192             20  CF-MAIL-TO-NAME            PIC X(30).
  3193             20  CF-IN-CARE-OF              PIC X(30).
  3194             20  CF-ADDRESS-LINE-1          PIC X(30).
  3195             20  CF-ADDRESS-LINE-2          PIC X(30).
  3196             20  CF-CITY-STATE              PIC X(30).
  3197             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3198             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3199
  3200         16  CF-CLAIM-NO-CONTROL.
  3201             20  CF-CLAIM-NO-METHOD         PIC X.
  3202                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3203                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3204                 88  CLAIM-NO-SEQ               VALUE '3'.
  3205                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3206             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3207                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3208                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3209                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3210
  3211         16  CF-CHECK-NO-CONTROL.
  3212             20  CF-CHECK-NO-METHOD         PIC X.
  3213                 88  CHECK-NO-MANUAL            VALUE '1'.
  3214                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3215                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3216                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3217             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3218                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3219
  3220         16  CF-DOMICILE-STATE              PIC XX.
  3221
  3222         16  CF-EXPENSE-CONTROLS.
  3223             20  CF-EXPENSE-METHOD          PIC X.
  3224                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3225                 88  DOLLARS-PER-PMT            VALUE '2'.
  3226                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3227                 88  DOLLARS-PER-MONTH          VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  58
* EL6316.cbl
  3228             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3229             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3230
  3231         16  CF-CORRESPONDENCE-CONTROL.
  3232             20  CF-LETTER-RESEND-OPT       PIC X.
  3233                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3234                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3235             20  FILLER                     PIC X(4).
  3236
  3237         16  CF-RESERVE-CONTROLS.
  3238             20  CF-MANUAL-SW               PIC X.
  3239                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3240             20  CF-FUTURE-SW               PIC X.
  3241                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3242             20  CF-PTC-SW                  PIC X.
  3243                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3244             20  CF-IBNR-SW                 PIC X.
  3245                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3246             20  CF-PTC-LF-SW               PIC X.
  3247                 88  CF-LF-PTC-USED             VALUE '1'.
  3248             20  CF-CDT-ACCESS-METHOD       PIC X.
  3249                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3250                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3251                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3252             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3253
  3254         16  CF-CLAIM-CALC-METHOD           PIC X.
  3255             88  360-PLUS-MONTHS                VALUE '1'.
  3256             88  365-PLUS-MONTHS                VALUE '2'.
  3257             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3258             88  360-DAILY                      VALUE '4'.
  3259             88  365-DAILY                      VALUE '5'.
  3260
  3261         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3262         16  FILLER                         PIC X(11).
  3263
  3264         16  CF-LIMIT-AMOUNTS.
  3265             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3266             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3267             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3268             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3269             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3270             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3271             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3272             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3273             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3274             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3275
  3276         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3277         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3278         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3279
  3280         16  CF-ZIP-CODE.
  3281             20  CF-ZIP-PRIME.
  3282                 24  CF-ZIP-1ST             PIC X.
  3283                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3284                 24  FILLER                 PIC X(4).
  3285             20  CF-ZIP-PLUS4               PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  59
* EL6316.cbl
  3286         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3287             20  CF-CAN-POSTAL-1            PIC XXX.
  3288             20  CF-CAN-POSTAL-2            PIC XXX.
  3289             20  FILLER                     PIC XXX.
  3290
  3291         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3292         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3293         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3294
  3295         16  CF-RATING-SWITCH               PIC X.
  3296             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3297             88  CF-NO-RATING                   VALUE 'N'.
  3298
  3299         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3300
  3301         16  CF-CARRIER-OVER-SHORT.
  3302             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3303             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3304
  3305         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3306         16  CF-SECPAY-SWITCH               PIC X.
  3307             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3308             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3309         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3310         16  FILLER                         PIC X(448).
  3311*        16  FILLER                         PIC X(452).
  3312
  3313
  3314****************************************************************
  3315*             MORTALITY MASTER RECORD                          *
  3316****************************************************************
  3317
  3318     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3319         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3320                                INDEXED BY CF-MORT-NDX.
  3321             20  CF-MORT-TABLE              PIC X(5).
  3322             20  CF-MORT-TABLE-TYPE         PIC X.
  3323                 88  CF-MORT-JOINT              VALUE 'J'.
  3324                 88  CF-MORT-SINGLE             VALUE 'S'.
  3325                 88  CF-MORT-COMBINED           VALUE 'C'.
  3326                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3327                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3328             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3329             20  CF-MORT-AGE-METHOD         PIC XX.
  3330                 88  CF-AGE-LAST                VALUE 'AL'.
  3331                 88  CF-AGE-NEAR                VALUE 'AN'.
  3332             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3333             20  CF-MORT-ADJUSTMENT-DIRECTION
  3334                                            PIC X.
  3335                 88  CF-MINUS                   VALUE '-'.
  3336                 88  CF-PLUS                    VALUE '+'.
  3337             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3338             20  CF-MORT-JOINT-CODE         PIC X.
  3339                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3340             20  CF-MORT-PC-Q               PIC X.
  3341                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3342             20  CF-MORT-TABLE-CODE         PIC X(4).
  3343             20  CF-MORT-COMMENTS           PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  60
* EL6316.cbl
  3344             20  FILLER                     PIC X(14).
  3345
  3346         16  FILLER                         PIC X(251).
  3347
  3348
  3349****************************************************************
  3350*             BUSSINESS TYPE MASTER RECORD                     *
  3351****************************************************************
  3352
  3353     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3354* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3355* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3356* AND RECORD 05 IS TYPES 81-99
  3357         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3358             20  CF-BUSINESS-TITLE          PIC  X(19).
  3359             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3360                                            PIC S9V9(4) COMP-3.
  3361             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3362             20  FILLER                     PIC  X.
  3363         16  FILLER                         PIC  X(248).
  3364
  3365
  3366****************************************************************
  3367*             TERMINAL MASTER RECORD                           *
  3368****************************************************************
  3369
  3370     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3371
  3372         16  CF-COMPANY-TERMINALS.
  3373             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3374                                  PIC X(4).
  3375         16  FILLER               PIC X(248).
  3376
  3377
  3378****************************************************************
  3379*             LIFE EDIT MASTER RECORD                          *
  3380****************************************************************
  3381
  3382     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3383         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3384             20  CF-LIFE-CODE-IN            PIC XX.
  3385             20  CF-LIFE-CODE-OUT           PIC XX.
  3386         16  FILLER                         PIC X(248).
  3387
  3388
  3389****************************************************************
  3390*             AH EDIT MASTER RECORD                            *
  3391****************************************************************
  3392
  3393     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3394         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3395             20  CF-AH-CODE-IN              PIC XXX.
  3396             20  CF-AH-CODE-OUT             PIC XX.
  3397         16  FILLER                         PIC X(248).
  3398
  3399
  3400****************************************************************
  3401*             CREDIBILITY TABLES                               *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  61
* EL6316.cbl
  3402****************************************************************
  3403
  3404     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3405         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3406                             INDEXED BY CF-CRDB-NDX.
  3407             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3408             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3409             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3410         16  FILLER                         PIC  X(332).
  3411
  3412
  3413****************************************************************
  3414*             REPORT CUSTOMIZATION RECORD                      *
  3415****************************************************************
  3416
  3417     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3418         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3419             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3420             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3421             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3422**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3423****       A T-TRANSFER.                                   ****
  3424             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3425
  3426         16  FILLER                         PIC XX.
  3427
  3428         16  CF-CARRIER-CNTL-OPT.
  3429             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3430                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3431                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3432             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3433                                            PIC X.
  3434         16  CF-GROUP-CNTL-OPT.
  3435             20  CF-GROUP-OPT-SEQ           PIC 9.
  3436                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3437                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3438             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3439                                            PIC X(6).
  3440         16  CF-STATE-CNTL-OPT.
  3441             20  CF-STATE-OPT-SEQ           PIC 9.
  3442                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3443                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3444             20  CF-STATE-SELECT OCCURS 3 TIMES
  3445                                            PIC XX.
  3446         16  CF-ACCOUNT-CNTL-OPT.
  3447             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3448                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3449                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3450             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3451                                            PIC X(10).
  3452         16  CF-BUS-TYP-CNTL-OPT.
  3453             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3454                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3455                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3456             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3457                                            PIC XX.
  3458         16  CF-LF-TYP-CNTL-OPT.
  3459             20  CF-LF-TYP-OPT-SEQ          PIC 9.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  62
* EL6316.cbl
  3460                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3461                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3462             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3463                                            PIC XX.
  3464         16  CF-AH-TYP-CNTL-OPT.
  3465             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3466                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3467                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3468             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3469                                            PIC XX.
  3470         16  CF-REPTCD1-CNTL-OPT.
  3471             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3472                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3473                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3474             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3475                                            PIC X(10).
  3476         16  CF-REPTCD2-CNTL-OPT.
  3477             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3478                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3479                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3480             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3481                                            PIC X(10).
  3482         16  CF-USER1-CNTL-OPT.
  3483             20  CF-USER1-OPT-SEQ           PIC 9.
  3484                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3485                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3486             20  CF-USER1-SELECT OCCURS 3 TIMES
  3487                                            PIC X(10).
  3488         16  CF-USER2-CNTL-OPT.
  3489             20  CF-USER2-OPT-SEQ           PIC 9.
  3490                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3491                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3492             20  CF-USER2-SELECT OCCURS 3 TIMES
  3493                                            PIC X(10).
  3494         16  CF-USER3-CNTL-OPT.
  3495             20  CF-USER3-OPT-SEQ           PIC 9.
  3496                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3497                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3498             20  CF-USER3-SELECT OCCURS 3 TIMES
  3499                                            PIC X(10).
  3500         16  CF-USER4-CNTL-OPT.
  3501             20  CF-USER4-OPT-SEQ           PIC 9.
  3502                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3503                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3504             20  CF-USER4-SELECT OCCURS 3 TIMES
  3505                                            PIC X(10).
  3506         16  CF-USER5-CNTL-OPT.
  3507             20  CF-USER5-OPT-SEQ           PIC 9.
  3508                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3509                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3510             20  CF-USER5-SELECT OCCURS 3 TIMES
  3511                                            PIC X(10).
  3512         16  CF-REINS-CNTL-OPT.
  3513             20  CF-REINS-OPT-SEQ           PIC 9.
  3514                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3515                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3516             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3517                 24  CF-REINS-PRIME         PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  63
* EL6316.cbl
  3518                 24  CF-REINS-SUB           PIC XXX.
  3519
  3520         16  CF-AGENT-CNTL-OPT.
  3521             20  CF-AGENT-OPT-SEQ           PIC 9.
  3522                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3523                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3524             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3525                                            PIC X(10).
  3526
  3527         16  FILLER                         PIC X(43).
  3528
  3529         16  CF-LOSS-RATIO-SELECT.
  3530             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3531             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3532         16  CF-ENTRY-DATE-SELECT.
  3533             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3534             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3535         16  CF-EFFECTIVE-DATE-SELECT.
  3536             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3537             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3538
  3539         16  CF-EXCEPTION-LIST-IND          PIC X.
  3540             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3541
  3542         16  FILLER                         PIC X(318).
  3543
  3544****************************************************************
  3545*                  EXCEPTION REPORTING RECORD                  *
  3546****************************************************************
  3547
  3548     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3549         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3550             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3551
  3552         16  CF-COMBINED-LIFE-AH-OPT.
  3553             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3554             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3555             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3556             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3557
  3558         16  CF-LIFE-OPT.
  3559             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3560             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3561             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3562             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3563             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3564             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3565             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3566             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3567             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3568             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3569
  3570         16  CF-AH-OPT.
  3571             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3572             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3573             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3574             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3575             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  64
* EL6316.cbl
  3576             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3577             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3578             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3579             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3580             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3581
  3582         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3583             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3584             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3585             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3586
  3587         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3588
  3589         16  FILLER                         PIC X(673).
  3590
  3591
  3592****************************************************************
  3593*             MORTGAGE SYSTEM PLAN RECORD                      *
  3594****************************************************************
  3595
  3596     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3597         16  CF-PLAN-TYPE                   PIC X.
  3598             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3599             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3600             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3601         16  CF-PLAN-ABBREV                 PIC XXX.
  3602         16  CF-PLAN-DESCRIPT               PIC X(10).
  3603         16  CF-PLAN-NOTES                  PIC X(20).
  3604         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3605         16  CF-PLAN-UNDERWRITING.
  3606             20  CF-PLAN-TERM-DATA.
  3607                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3608                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3609             20  CF-PLAN-AGE-DATA.
  3610                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3611                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3612                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3613             20  CF-PLAN-BENEFIT-DATA.
  3614                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3615                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3616                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3617                                            PIC S9(7)V99  COMP-3.
  3618         16  CF-PLAN-POLICY-FORMS.
  3619             20  CF-POLICY-FORM             PIC X(12).
  3620             20  CF-MASTER-APPLICATION      PIC X(12).
  3621             20  CF-MASTER-POLICY           PIC X(12).
  3622         16  CF-PLAN-RATING.
  3623             20  CF-RATE-CODE               PIC X(5).
  3624             20  CF-SEX-RATING              PIC X.
  3625                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3626                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3627             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3628             20  CF-SUB-STD-TYPE            PIC X.
  3629                 88  CF-PCT-OF-PREM            VALUE '1'.
  3630                 88  CF-PCT-OF-BENE            VALUE '2'.
  3631         16  CF-PLAN-PREM-TOLERANCES.
  3632             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3633             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  65
* EL6316.cbl
  3634         16  CF-PLAN-PYMT-TOLERANCES.
  3635             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3636             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3637         16  CF-PLAN-MISC-DATA.
  3638             20  FILLER                     PIC X.
  3639             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3640             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3641         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3642         16  CF-PLAN-IND-GRP                PIC X.
  3643             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3644                                                     '1'.
  3645             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3646                                                     '2'.
  3647         16  CF-MIB-SEARCH-SW               PIC X.
  3648             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3649             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3650             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3651             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3652         16  CF-ALPHA-SEARCH-SW             PIC X.
  3653             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3654             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3655             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3656             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3657             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3658             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3659             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3660             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3661             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3662             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3663                                                     'A' 'B' 'C'
  3664                                                     'X' 'Y' 'Z'.
  3665         16  CF-EFF-DT-RULE-SW              PIC X.
  3666             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3667             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3668             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3669             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3670             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3671         16  FILLER                         PIC X(4).
  3672         16  CF-HEALTH-QUESTIONS            PIC X.
  3673             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3674         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3675         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3676         16  CF-PLAN-SNGL-JNT               PIC X.
  3677             88  CF-COMBINED-PLAN              VALUE 'C'.
  3678             88  CF-JNT-PLAN                   VALUE 'J'.
  3679             88  CF-SNGL-PLAN                  VALUE 'S'.
  3680         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3681         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3682         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3683         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3684         16  CF-RERATE-CNTL                 PIC  X.
  3685             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3686             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3687             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3688             88  CF-AUTO-RECALC                 VALUE '4'.
  3689         16  CF-BENEFIT-TYPE                PIC  X.
  3690             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3691             88  CF-BENEFIT-REDUCES             VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  66
* EL6316.cbl
  3692         16  CF-POLICY-FEE                  PIC S999V99
  3693                                                    COMP-3.
  3694         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3695         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3696         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3697         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3698         16  FILLER                         PIC  X(32).
  3699         16  CF-TERMINATION-FORM            PIC  X(04).
  3700         16  FILLER                         PIC  X(08).
  3701         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3702                                                       COMP-3.
  3703         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3704         16  CF-ISSUE-LETTER                PIC  X(4).
  3705         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3706         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3707             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3708             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3709         16  CF-MP-REFUND-CALC              PIC X.
  3710             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3711             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3712             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3713             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3714             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3715             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3716             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3717             88  CF-MP-REFD-MEAN                VALUE '8'.
  3718         16  CF-ALT-RATE-CODE               PIC  X(5).
  3719
  3720
  3721         16  FILLER                         PIC X(498).
  3722****************************************************************
  3723*             MORTGAGE COMPANY MASTER RECORD                   *
  3724****************************************************************
  3725
  3726     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3727         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3728         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3729             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3730             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3731             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3732             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3733             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3734
  3735         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3736         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3737         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3738         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3739         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3740
  3741         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3742             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3743         16  CF-MP-RECON-USE-IND            PIC X(1).
  3744             88  CF-MP-USE-RECON             VALUE 'Y'.
  3745         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3746             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3747         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3748             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3749             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  67
* EL6316.cbl
  3750         16  FILLER                         PIC X(1).
  3751         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3752             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3753         16  CF-MORTG-MIB-VERSION           PIC X.
  3754             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3755             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3756             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3757         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3758             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3759                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3760             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3761                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3762             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3763                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3764             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3765                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3766             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3767                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3768             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3769                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3770         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3771         16  FILLER                         PIC X(7).
  3772         16  CF-MORTG-DESTINATION-SYMBOL.
  3773             20  CF-MORTG-MIB-COMM          PIC X(5).
  3774             20  CF-MORTG-MIB-TERM          PIC X(5).
  3775         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3776             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3777         16  FILLER                         PIC X(03).
  3778         16  CF-MP-CHECK-NO-CONTROL.
  3779             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3780                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3781                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3782                                                ' ' LOW-VALUES.
  3783                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3784                                               VALUE '3'.
  3785         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3786         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3787         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3788             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3789                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3790             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3791                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3792             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3793                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3794             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3795                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3796             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3797                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3798             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3799                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3800         16  CF-MORTG-BILLING-AREA.
  3801             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3802                                            PIC X.
  3803         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3804         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3805         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3806         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3807             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  68
* EL6316.cbl
  3808             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3809         16  FILLER                         PIC X.
  3810         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3811             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3812             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3813         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3814         16  FILLER                         PIC X(8).
  3815         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3816         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3817         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3818         16  CF-ACH-COMPANY-ID.
  3819             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3820                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3821                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3822                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3823             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3824         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3825             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3826         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3827             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3828             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3829         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3830         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3831         16  FILLER                         PIC X(536).
  3832
  3833****************************************************************
  3834*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3835****************************************************************
  3836
  3837     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3838         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3839             20  CF-FEMALE-HEIGHT.
  3840                 24  CF-FEMALE-FT           PIC 99.
  3841                 24  CF-FEMALE-IN           PIC 99.
  3842             20  CF-FEMALE-MIN-WT           PIC 999.
  3843             20  CF-FEMALE-MAX-WT           PIC 999.
  3844         16  FILLER                         PIC X(428).
  3845
  3846     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3847         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3848             20  CF-MALE-HEIGHT.
  3849                 24  CF-MALE-FT             PIC 99.
  3850                 24  CF-MALE-IN             PIC 99.
  3851             20  CF-MALE-MIN-WT             PIC 999.
  3852             20  CF-MALE-MAX-WT             PIC 999.
  3853         16  FILLER                         PIC X(428).
  3854******************************************************************
  3855*             AUTOMATIC ACTIVITY RECORD                          *
  3856******************************************************************
  3857     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3858         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3859             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3860             20  CF-SYS-LETTER-ID           PIC X(04).
  3861             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3862             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3863             20  CF-SYS-RESET-SW            PIC X(01).
  3864             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3865             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  69
* EL6316.cbl
  3866
  3867         16  FILLER                         PIC X(50).
  3868
  3869         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3870             20  CF-USER-ACTIVE-SW          PIC X(01).
  3871             20  CF-USER-LETTER-ID          PIC X(04).
  3872             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3873             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3874             20  CF-USER-RESET-SW           PIC X(01).
  3875             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3876             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3877             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3878
  3879         16  FILLER                         PIC X(246).
  3880*                                COPY ERCPNDB.
  3881******************************************************************
  3882*                                                                *
  3883*                                                                *
  3884*                            ERCPNDB.                            *
  3885*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3886*                            VMOD=2.025                          *
  3887*                                                                *
  3888*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3889*                                                                *
  3890******************************************************************
  3891*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3892*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3893******************************************************************
  3894*                                                                *
  3895*                                                                *
  3896*   FILE TYPE = VSAM,KSDS                                        *
  3897*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3898*                                                                *
  3899*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3900*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3901*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3902*                                                 RKP=13,LEN=36  *
  3903*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3904*                                      AND CHG-SEQ.)             *
  3905*                                                RKP=49,LEN=11   *
  3906*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3907*                                      AND CHG-SEQ.)             *
  3908*                                                RKP=60,LEN=15   *
  3909*                                                                *
  3910*   LOG = NO                                                     *
  3911*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3912******************************************************************
  3913******************************************************************
  3914*                   C H A N G E   L O G
  3915*
  3916* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3917*-----------------------------------------------------------------
  3918*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3919* EFFECTIVE    NUMBER
  3920*-----------------------------------------------------------------
  3921* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3922* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3923* 011904                   PEMA  ADD TOTAL FEE PROCESSING
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  70
* EL6316.cbl
  3924* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3925* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3926* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3927* 032306                   PEMA  ADD BOW LOAN NUMBER
  3928* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3929* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3930* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3931* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3932* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3933* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3934* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3935* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3936******************************************************************
  3937
  3938 01  PENDING-BUSINESS.
  3939     12  PB-RECORD-ID                     PIC XX.
  3940         88  VALID-PB-ID                        VALUE 'PB'.
  3941
  3942     12  PB-CONTROL-PRIMARY.
  3943         16  PB-COMPANY-CD                PIC X.
  3944         16  PB-ENTRY-BATCH               PIC X(6).
  3945         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3946         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3947
  3948     12  PB-CONTROL-BY-ACCOUNT.
  3949         16  PB-COMPANY-CD-A1             PIC X.
  3950         16  PB-CARRIER                   PIC X.
  3951         16  PB-GROUPING.
  3952             20  PB-GROUPING-PREFIX       PIC XXX.
  3953             20  PB-GROUPING-PRIME        PIC XXX.
  3954         16  PB-STATE                     PIC XX.
  3955         16  PB-ACCOUNT.
  3956             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3957             20  PB-ACCOUNT-PRIME         PIC X(6).
  3958         16  PB-CERT-EFF-DT               PIC XX.
  3959         16  PB-CERT-NO.
  3960             20  PB-CERT-PRIME            PIC X(10).
  3961             20  PB-CERT-SFX              PIC X.
  3962         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3963
  3964         16  PB-RECORD-TYPE               PIC X.
  3965             88  PB-MAILING-DATA                VALUE '0'.
  3966             88  PB-ISSUE                       VALUE '1'.
  3967             88  PB-CANCELLATION                VALUE '2'.
  3968             88  PB-BATCH-TRAILER               VALUE '9'.
  3969
  3970     12  PB-CONTROL-BY-ORIG-BATCH.
  3971         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3972         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3973         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3974         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3975
  3976     12  PB-CONTROL-BY-CSR.
  3977         16  PB-CSR-COMPANY-CD            PIC X.
  3978         16  PB-CSR-ID                    PIC X(4).
  3979         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3980         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3981         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  71
* EL6316.cbl
  3982******************************************************************
  3983*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3984******************************************************************
  3985
  3986     12  PB-LAST-MAINT-DT                 PIC XX.
  3987     12  PB-LAST-MAINT-BY                 PIC X(4).
  3988     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3989
  3990     12  PB-RECORD-BODY                   PIC X(375).
  3991
  3992     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3993         16  PB-CERT-ORIGIN               PIC X.
  3994             88  CLASIC-CREATED-CERT         VALUE '1'.
  3995         16  PB-I-NAME.
  3996             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3997             20  PB-I-INSURED-FIRST-NAME.
  3998                 24  PB-I-INSURED-1ST-INIT PIC X.
  3999                 24  FILLER                PIC X(9).
  4000             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4001         16  PB-I-AGE                     PIC S99   COMP-3.
  4002         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4003         16  PB-I-BIRTHDAY                PIC XX.
  4004         16  PB-I-INSURED-SEX             PIC X.
  4005             88  PB-SEX-MALE     VALUE 'M'.
  4006             88  PB-SEX-FEMALE   VALUE 'F'.
  4007
  4008         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4009         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4010         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4011         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4012         16  PB-I-SKIP-CODE               PIC X.
  4013             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4014             88  PB-SKIP-JULY              VALUE '1'.
  4015             88  PB-SKIP-AUGUST            VALUE '2'.
  4016             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4017             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4018             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4019             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4020             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4021             88  PB-SKIP-JUNE              VALUE '8'.
  4022             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4023             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4024             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4025         16  PB-I-TERM-TYPE               PIC X.
  4026             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4027             88  PB-PAID-WEEKLY            VALUE 'W'.
  4028             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4029             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4030             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4031         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4032         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4033         16  PB-I-DATA-ENTRY-SW           PIC X.
  4034             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4035             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4036             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4037             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4038         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4039         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  72
* EL6316.cbl
  4040*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4041         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4042         16  FILLER                       PIC X.
  4043
  4044         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4045             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4046             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4047                                                   '90' THRU '99'.
  4048         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4049                                          PIC XX.
  4050         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4051         16  PB-I-AMOUNT-FINANCED REDEFINES
  4052                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4053         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4054         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4055                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4056         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4057         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4058         16  PB-I-CLP-AMOUNT REDEFINES
  4059                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4060         16  PB-I-LF-CALC-FLAG            PIC X.
  4061             88 PB-COMP-LF-PREM               VALUE '?'.
  4062         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4063         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4064         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4065         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4066         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4067         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4068         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4069         16  PB-I-LF-ABBR                 PIC XXX.
  4070         16  PB-I-LF-INPUT-CD             PIC XX.
  4071
  4072         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4073             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4074             88  PB-INVALID-AH               VALUE '  ' '00'
  4075                                                   '90' THRU '99'.
  4076         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4077         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4078         16  PB-I-AH-CALC-FLAG            PIC X.
  4079             88 PB-COMP-AH-PREM                  VALUE '?'.
  4080         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4081         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4082         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4083         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4084         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4085         16  PB-I-AH-ABBR                 PIC XXX.
  4086         16  PB-I-AH-INPUT-CD             PIC XXX.
  4087
  4088         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4089         16  PB-I-REIN-TABLE              PIC XXX.
  4090         16  PB-I-BUSINESS-TYPE           PIC 99.
  4091         16  PB-I-INDV-GRP-CD             PIC X.
  4092         16  PB-I-MORT-CODE.
  4093             20  PB-I-TABLE               PIC X.
  4094             20  PB-I-INTEREST            PIC XX.
  4095             20  PB-I-MORT-TYP            PIC X.
  4096         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4097         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  73
* EL6316.cbl
  4098         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4099         16  PB-I-INDV-GRP-OVRD           PIC X.
  4100         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4101         16  PB-I-SIG-SW                  PIC X.
  4102             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4103         16  PB-I-RATE-CLASS              PIC XX.
  4104         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4105         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4106         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4107         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4108         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4109         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4110         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4111         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4112         16  PB-I-OB-FLAG                 PIC X.
  4113             88  PB-I-OB                      VALUE 'B'.
  4114             88  PB-I-SUMMARY                 VALUE 'Z'.
  4115         16  PB-I-ENTRY-STATUS            PIC X.
  4116             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4117                                              'M' '5' '9' '2'.
  4118             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4119             88  PB-I-POLICY-PENDING          VALUE '2'.
  4120             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4121             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4122             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4123             88  PB-I-REIN-ONLY               VALUE '9'.
  4124             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4125             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4126             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4127             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4128         16  PB-I-INT-CODE                PIC X.
  4129             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4130             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4131         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4132         16  PB-I-SOC-SEC-NO              PIC X(11).
  4133         16  PB-I-MEMBER-NO               PIC X(12).
  4134         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4135*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4136         16  PB-I-OLD-LOF                 PIC XXX.
  4137         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4138         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4139         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4140         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4141         16  PB-I-LIFE-INDICATOR          PIC X.
  4142             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4143         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4144         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4145                                          PIC S9(5)V99    COMP-3.
  4146         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4147             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4148             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4149         16  PB-I-1ST-PMT-DT              PIC XX.
  4150         16  PB-I-JOINT-INSURED.
  4151             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4152             20 PB-I-JOINT-FIRST-NAME.
  4153                24  PB-I-JOINT-FIRST-INIT PIC X.
  4154                24  FILLER                PIC X(9).
  4155             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  74
* EL6316.cbl
  4156*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4157         16  PB-I-BENEFICIARY-NAME.
  4158             20  PB-I-BANK-NUMBER         PIC X(10).
  4159             20  FILLER                   PIC X(15).
  4160         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4161         16  PB-I-REFERENCE               PIC X(12).
  4162         16  FILLER REDEFINES PB-I-REFERENCE.
  4163             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4164             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4165             20  PB-I-CLP-STATE           PIC XX.
  4166         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4167             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4168             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4169             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4170         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4171         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4172         16  PB-I-RESIDENT-STATE          PIC XX.
  4173         16  PB-I-RATE-CODE               PIC X(4).
  4174         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4175         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4176         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4177         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4178         16  PB-I-BANK-NOCHRGB            PIC 99.
  4179         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4180         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4181
  4182     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4183         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4184             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4185         16  PB-C-CANCEL-ORIGIN           PIC X.
  4186             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4187         16  PB-C-LF-CANCEL-DT            PIC XX.
  4188         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4189         16  PB-C-LF-CALC-REQ             PIC X.
  4190             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4191         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4192         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4193         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4194             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4195         16  PB-C-AH-CANCEL-DT            PIC XX.
  4196         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4197         16  PB-C-AH-CALC-REQ             PIC X.
  4198             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4199         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4200         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4201         16  PB-C-LAST-NAME               PIC X(15).
  4202         16  PB-C-REFUND-SW               PIC X.
  4203             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4204             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4205         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4206         16  PB-C-PAYEE-CODE              PIC X(6).
  4207         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4208         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4209         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4210         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4211         16  PB-C-REFERENCE               PIC X(12).
  4212         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4213         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  75
* EL6316.cbl
  4214         16  PB-C-POST-CARD-IND           PIC X.
  4215         16  PB-C-CANCEL-REASON           PIC X.
  4216         16  PB-C-REF-INTERFACE-SW        PIC X.
  4217         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4218         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4219         16  FILLER                       PIC X(01).
  4220*        16  FILLER                       PIC X(18).
  4221         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4222*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4223         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4224         16  PB-CANCELED-CERT-DATA.
  4225             20  PB-CI-INSURED-NAME.
  4226                 24  PB-CI-LAST-NAME      PIC X(15).
  4227                 24  PB-CI-INITIALS       PIC XX.
  4228             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4229             20  PB-CI-INSURED-SEX        PIC X.
  4230             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4231             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4232             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4233             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4234             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4235             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4236             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4237             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4238             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4239             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4240             20  PB-CI-RATE-CLASS         PIC XX.
  4241             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4242             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4243             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4244             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4245             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4246             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4247             20  PB-CI-LF-ABBR            PIC X(3).
  4248             20  PB-CI-AH-ABBR            PIC X(3).
  4249             20  PB-CI-OB-FLAG            PIC X.
  4250                 88  PB-CI-OB                VALUE 'B'.
  4251             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4252                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4253                                           'M' '4' '5' '9' '2'.
  4254                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4255                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4256                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4257                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4258                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4259                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4260                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4261                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4262                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4263                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4264                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4265                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4266             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4267                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4268                                           'M' '4' '5' '9' '2'.
  4269                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4270                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4271                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  76
* EL6316.cbl
  4272                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4273                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4274                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4275                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4276                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4277                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4278                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4279                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4280                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4281             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4282             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4283             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4284             20  PB-CI-MEMBER-NO          PIC X(12).
  4285             20  PB-CI-INT-CODE           PIC X.
  4286                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4287                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4288             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4289             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4290             20  PB-CI-COMP-EXCP-SW       PIC X.
  4291                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4292                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4293             20  PB-CI-ENTRY-STATUS       PIC X.
  4294             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4295             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4296             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4297             20  PB-CI-DEATH-DT           PIC XX.
  4298             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4299             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4300             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4301             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4302             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4303             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4304             20  PB-CI-ENTRY-DT              PIC XX.
  4305             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4306             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4307             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4308             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4309             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4310             20  PB-CI-OLD-LOF               PIC XXX.
  4311*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4312             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4313             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4314             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4315             20  PB-CI-INDV-GRP-CD           PIC X.
  4316             20  PB-CI-BENEFICIARY-NAME.
  4317                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4318                 24  FILLER                  PIC X(15).
  4319             20  PB-CI-NOTE-SW               PIC X.
  4320             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4321             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4322             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4323             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4324             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4325             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4326             20  PB-CI-FIRST-NAME            PIC X(10).
  4327             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4328
  4329         16  FILLER                       PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  77
* EL6316.cbl
  4330*032306  16  FILLER                       PIC X(27).
  4331*        16  FILLER                       PIC X(46).
  4332
  4333     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4334         16  FILLER                       PIC X(10).
  4335         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4336         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4337         16  PB-M-INSURED-MID-INIT        PIC X.
  4338         16  PB-M-INSURED-AGE             PIC 99.
  4339         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4340         16  PB-M-INSURED-SEX             PIC X.
  4341         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4342         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4343         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4344         16  PB-M-INSURED-CITY-STATE.
  4345             20  PB-M-INSURED-CITY        PIC X(28).
  4346             20  PB-M-INSURED-STATE       PIC XX.
  4347         16  PB-M-INSURED-ZIP-CODE.
  4348             20  PB-M-INSURED-ZIP-PRIME.
  4349                 24  PB-M-INSURED-ZIP-1   PIC X.
  4350                     88  PB-M-CANADIAN-POST-CODE
  4351                                             VALUE 'A' THRU 'Z'.
  4352                 24  FILLER               PIC X(4).
  4353             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4354         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4355                                        PB-M-INSURED-ZIP-CODE.
  4356             20  PM-M-INS-CAN-POST1       PIC XXX.
  4357             20  PM-M-INS-CAN-POST2       PIC XXX.
  4358             20  FILLER                   PIC XXX.
  4359         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4360         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4361         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4362         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4363         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4364         16  PB-M-CRED-BENE-CITYST.
  4365             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4366             20  PB-M-CRED-BENE-STATE     PIC XX.
  4367         16  FILLER                       PIC X(92).
  4368
  4369     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4370         16  FILLER                       PIC X(10).
  4371         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4372         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4373         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4374         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4375         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4376         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4377         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4378         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4379         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4380         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4381         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4382         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4383         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4384         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4385         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4386         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4387         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  78
* EL6316.cbl
  4388         16  PB-ACCOUNT-NAME              PIC X(30).
  4389         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4390         16  PB-REFERENCE                 PIC X(12).
  4391         16  PB-B-RECEIVED-DT             PIC XX.
  4392         16  FILLER                       PIC X(234).
  4393
  4394     12  PB-RECORD-STATUS.
  4395         16  PB-CREDIT-SELECT-DT          PIC XX.
  4396         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4397         16  PB-BILLED-DT                 PIC XX.
  4398         16  PB-BILLING-STATUS            PIC X.
  4399             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4400             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4401             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4402         16  PB-RECORD-BILL               PIC X.
  4403             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4404             88  PB-RECORD-RETURNED           VALUE 'R'.
  4405             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4406             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4407             88  PB-OVERRIDE-AH               VALUE 'A'.
  4408             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4409         16  PB-BATCH-ENTRY               PIC X.
  4410             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4411             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4412             88  PB-REISSUED-CERT             VALUE 'E'.
  4413             88  PB-MONTHLY-CERT              VALUE 'M'.
  4414             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4415             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4416             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4417         16  PB-FORCE-CODE                PIC X.
  4418             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4419             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4420             88  PB-CANCEL-FORCE              VALUE '8'.
  4421             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4422             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4423             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4424             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4425             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4426             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4427             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4428         16  PB-FATAL-FLAG                PIC X.
  4429             88  PB-FATAL-ERRORS              VALUE 'X'.
  4430         16  PB-FORCE-ER-CD               PIC X.
  4431             88  PB-FORCE-ERRORS              VALUE 'F'.
  4432             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4433         16  PB-WARN-ER-CD                PIC X.
  4434             88  PB-WARNING-ERRORS            VALUE 'W'.
  4435         16  FILLER                       PIC X.
  4436         16  PB-OUT-BAL-CD                PIC X.
  4437             88  PB-OUT-OF-BAL                VALUE 'O'.
  4438         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4439         16  PB-AH-OVERRIDE-L1            PIC X.
  4440         16  PB-INPUT-DT                  PIC XX.
  4441         16  PB-INPUT-BY                  PIC X(4).
  4442         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4443         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4444         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4445         16  PB-LF-EARNING-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  79
* EL6316.cbl
  4446         16  PB-AH-EARNING-METHOD         PIC X.
  4447         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4448         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4449         16  PB-REIN-CD                   PIC XXX.
  4450         16  PB-LF-REFUND-TYPE            PIC X.
  4451         16  PB-AH-REFUND-TYPE            PIC X.
  4452         16  PB-ACCT-EFF-DT               PIC XX.
  4453         16  PB-ACCT-EXP-DT               PIC XX.
  4454         16  PB-COMPANY-ID                PIC X(3).
  4455         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4456         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4457         16  PB-SV-CARRIER                PIC X.
  4458         16  PB-SV-GROUPING               PIC X(6).
  4459         16  PB-SV-STATE                  PIC XX.
  4460         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4461         16  PB-GA-BILLING-INFO.
  4462             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4463                                          PIC XX.
  4464         16  PB-SV-REMIT-TO  REDEFINES
  4465             PB-GA-BILLING-INFO           PIC X(10).
  4466         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4467         16  PB-I-LOAN-OFFICER            PIC X(5).
  4468         16  PB-I-VIN                     PIC X(17).
  4469
  4470         16  FILLER                       PIC X(04).
  4471         16  IMNET-BYPASS-SW              PIC X.
  4472
  4473******************************************************************
  4474*                COMMON EDIT ERRORS                              *
  4475******************************************************************
  4476
  4477     12  PB-COMMON-ERRORS.
  4478         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4479                                           PIC S9(4)     COMP.
  4480
  4481******************************************************************
  4482*                                COPY ELCCERT.
  4483******************************************************************
  4484*                                                                *
  4485*                            ELCCERT.                            *
  4486*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4487*                            VMOD=2.013                          *
  4488*                                                                *
  4489*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4490*                                                                *
  4491*   FILE TYPE = VSAM,KSDS                                        *
  4492*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4493*                                                                *
  4494*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4495*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4496*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4497*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4498*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4499*                                                                *
  4500*   LOG = YES                                                    *
  4501*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4502******************************************************************
  4503*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  80
* EL6316.cbl
  4504*
  4505* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4506*-----------------------------------------------------------------
  4507*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4508* EFFECTIVE    NUMBER
  4509*-----------------------------------------------------------------
  4510* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4511* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4512* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4513* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4514* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4515* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4516* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4517* 032612  CR2011110200001  PEMA  AHL CHANGES
  4518******************************************************************
  4519
  4520 01  CERTIFICATE-MASTER.
  4521     12  CM-RECORD-ID                      PIC XX.
  4522         88  VALID-CM-ID                      VALUE 'CM'.
  4523
  4524     12  CM-CONTROL-PRIMARY.
  4525         16  CM-COMPANY-CD                 PIC X.
  4526         16  CM-CARRIER                    PIC X.
  4527         16  CM-GROUPING.
  4528             20  CM-GROUPING-PREFIX        PIC X(3).
  4529             20  CM-GROUPING-PRIME         PIC X(3).
  4530         16  CM-STATE                      PIC XX.
  4531         16  CM-ACCOUNT.
  4532             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4533             20  CM-ACCOUNT-PRIME          PIC X(6).
  4534         16  CM-CERT-EFF-DT                PIC XX.
  4535         16  CM-CERT-NO.
  4536             20  CM-CERT-PRIME             PIC X(10).
  4537             20  CM-CERT-SFX               PIC X.
  4538
  4539     12  CM-CONTROL-BY-NAME.
  4540         16  CM-COMPANY-CD-A1              PIC X.
  4541         16  CM-INSURED-LAST-NAME          PIC X(15).
  4542         16  CM-INSURED-INITIALS.
  4543             20  CM-INSURED-INITIAL1       PIC X.
  4544             20  CM-INSURED-INITIAL2       PIC X.
  4545
  4546     12  CM-CONTROL-BY-SSN.
  4547         16  CM-COMPANY-CD-A2              PIC X.
  4548         16  CM-SOC-SEC-NO.
  4549             20  CM-SSN-STATE              PIC XX.
  4550             20  CM-SSN-ACCOUNT            PIC X(6).
  4551             20  CM-SSN-LN3.
  4552                 25  CM-INSURED-INITIALS-A2.
  4553                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4554                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4555                 25 CM-PART-LAST-NAME-A2         PIC X.
  4556
  4557     12  CM-CONTROL-BY-CERT-NO.
  4558         16  CM-COMPANY-CD-A4              PIC X.
  4559         16  CM-CERT-NO-A4                 PIC X(11).
  4560
  4561     12  CM-CONTROL-BY-MEMB.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  81
* EL6316.cbl
  4562         16  CM-COMPANY-CD-A5              PIC X.
  4563         16  CM-MEMBER-NO.
  4564             20  CM-MEMB-STATE             PIC XX.
  4565             20  CM-MEMB-ACCOUNT           PIC X(6).
  4566             20  CM-MEMB-LN4.
  4567                 25  CM-INSURED-INITIALS-A5.
  4568                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4569                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4570                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4571
  4572     12  CM-INSURED-PROFILE-DATA.
  4573         16  CM-INSURED-FIRST-NAME.
  4574             20  CM-INSURED-1ST-INIT       PIC X.
  4575             20  FILLER                    PIC X(9).
  4576         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4577         16  CM-INSURED-SEX                PIC X.
  4578             88  CM-SEX-MALE                  VALUE 'M'.
  4579             88  CM-SEX-FEMAL                 VALUE 'F'.
  4580         16  CM-INSURED-JOINT-AGE          PIC 99.
  4581         16  CM-JOINT-INSURED-NAME.
  4582             20  CM-JT-LAST-NAME           PIC X(15).
  4583             20  CM-JT-FIRST-NAME.
  4584                 24  CM-JT-1ST-INIT        PIC X.
  4585                 24  FILLER                PIC X(9).
  4586             20  CM-JT-INITIAL             PIC X.
  4587
  4588     12  CM-LIFE-DATA.
  4589         16  CM-LF-BENEFIT-CD              PIC XX.
  4590         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4591         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4592         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4593         16  CM-LF-DEV-CODE                PIC XXX.
  4594         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4595         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4596         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4597         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4598         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4599         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4600         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4601         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4602         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4603         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4604         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4605         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4606         16  FILLER                        PIC XX.
  4607
  4608     12  CM-AH-DATA.
  4609         16  CM-AH-BENEFIT-CD              PIC XX.
  4610         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4611         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4612         16  CM-AH-DEV-CODE                PIC XXX.
  4613         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4614         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4615         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4616         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4617         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4618         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4619         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  82
* EL6316.cbl
  4620         16  CM-AH-PAID-THRU-DT            PIC XX.
  4621             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4622         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4623         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4624         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4625         16  FILLER                        PIC X.
  4626
  4627     12  CM-LOAN-INFORMATION.
  4628         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4629         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4630                                           PIC S9(5)V99  COMP-3.
  4631         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4632         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4633         16  CM-PAY-FREQUENCY              PIC S99.
  4634         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4635         16  CM-RATE-CLASS                 PIC XX.
  4636         16  CM-BENEFICIARY                PIC X(25).
  4637         16  CM-POLICY-FORM-NO             PIC X(12).
  4638         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4639         16  CM-LAST-ADD-ON-DT             PIC XX.
  4640         16  CM-DEDUCTIBLE-AMOUNTS.
  4641             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4642             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4643         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4644             20  CM-RESIDENT-STATE         PIC XX.
  4645             20  CM-RATE-CODE              PIC X(4).
  4646             20  FILLER                    PIC XX.
  4647         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4648             20  CM-LOAN-OFFICER           PIC X(5).
  4649             20  FILLER                    PIC XXX.
  4650         16  CM-CSR-CODE                   PIC XXX.
  4651         16  CM-UNDERWRITING-CODE          PIC X.
  4652             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4653         16  CM-POST-CARD-IND              PIC X.
  4654         16  CM-NH-INTERFACE-SW            PIC X.
  4655         16  CM-PREMIUM-TYPE               PIC X.
  4656             88  CM-SING-PRM                  VALUE '1'.
  4657             88  CM-O-B-COVERAGE              VALUE '2'.
  4658             88  CM-OPEN-END                  VALUE '3'.
  4659         16  CM-IND-GRP-TYPE               PIC X.
  4660             88  CM-INDIVIDUAL                VALUE 'I'.
  4661             88  CM-GROUP                     VALUE 'G'.
  4662         16  CM-SKIP-CODE                  PIC X.
  4663             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4664             88  SKIP-JULY                    VALUE '1'.
  4665             88  SKIP-AUGUST                  VALUE '2'.
  4666             88  SKIP-SEPTEMBER               VALUE '3'.
  4667             88  SKIP-JULY-AUG                VALUE '4'.
  4668             88  SKIP-AUG-SEPT                VALUE '5'.
  4669             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4670             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4671             88  SKIP-JUNE                    VALUE '8'.
  4672             88  SKIP-JUNE-JULY               VALUE '9'.
  4673             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4674             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4675         16  CM-PAYMENT-MODE               PIC X.
  4676             88  PAY-MONTHLY                  VALUE SPACE.
  4677             88  PAY-WEEKLY                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  83
* EL6316.cbl
  4678             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4679             88  PAY-BI-WEEKLY                VALUE '3'.
  4680             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4681         16  CM-LOAN-NUMBER                PIC X(8).
  4682         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4683         16  CM-OLD-LOF                    PIC XXX.
  4684*        16  CM-LOAN-OFFICER               PIC XXX.
  4685         16  CM-REIN-TABLE                 PIC XXX.
  4686         16  CM-SPECIAL-REIN-CODE          PIC X.
  4687         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4688         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4689         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4690
  4691     12  CM-STATUS-DATA.
  4692         16  CM-ENTRY-STATUS               PIC X.
  4693         16  CM-ENTRY-DT                   PIC XX.
  4694
  4695         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4696         16  CM-LF-CANCEL-DT               PIC XX.
  4697         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4698
  4699         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4700         16  CM-LF-DEATH-DT                PIC XX.
  4701         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4702
  4703         16  CM-LF-CURRENT-STATUS          PIC X.
  4704             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4705                                                'M' '4' '5' '9'.
  4706             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4707             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4708             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4709             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4710             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4711             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4712             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4713             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4714             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4715             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4716             88  CM-LF-DECLINED               VALUE 'D'.
  4717             88  CM-LF-VOIDED                 VALUE 'V'.
  4718
  4719         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4720         16  CM-AH-CANCEL-DT               PIC XX.
  4721         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4722
  4723         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4724         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4725         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4726
  4727         16  CM-AH-CURRENT-STATUS          PIC X.
  4728             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4729                                                'M' '4' '5' '9'.
  4730             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4731             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4732             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4733             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4734             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4735             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  84
* EL6316.cbl
  4736             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4737             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4738             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4739             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4740             88  CM-AH-DECLINED               VALUE 'D'.
  4741             88  CM-AH-VOIDED                 VALUE 'V'.
  4742
  4743         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4744             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4745             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4746             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4747         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4748
  4749         16  CM-ENTRY-BATCH                PIC X(6).
  4750         16  CM-LF-EXIT-BATCH              PIC X(6).
  4751         16  CM-AH-EXIT-BATCH              PIC X(6).
  4752         16  CM-LAST-MONTH-END             PIC XX.
  4753
  4754     12  CM-NOTE-SW                        PIC X.
  4755         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4756         88  CERT-NOTES-PRESENT               VALUE '1'.
  4757         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4758         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4759         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4760         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4761         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4762         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4763     12  CM-COMP-EXCP-SW                   PIC X.
  4764         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4765         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4766     12  CM-INSURED-ADDRESS-SW             PIC X.
  4767         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4768         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4769
  4770*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4771     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4772     12  FILLER                            PIC X.
  4773
  4774*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4775     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4776     12  FILLER                            PIC X.
  4777*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4778     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4779
  4780     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4781         88  CERT-ADDED-BATCH                 VALUE ' '.
  4782         88  CERT-ADDED-ONLINE                VALUE '1'.
  4783         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4784         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4785         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4786     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4787         88  CERT-AS-LOADED                   VALUE ' '.
  4788         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4789         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4790         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4791         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4792         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4793         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  85
* EL6316.cbl
  4794         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4795
  4796     12  CM-ACCOUNT-COMM-PCTS.
  4797         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4798         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4799
  4800     12  CM-USER-FIELD                     PIC X.
  4801     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4802     12  CM-CLP-STATE                      PIC XX.
  4803     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4804     12  CM-USER-RESERVED                  PIC XXX.
  4805     12  FILLER REDEFINES CM-USER-RESERVED.
  4806         16  CM-AH-CLASS-CD                PIC XX.
  4807         16  F                             PIC X.
  4808******************************************************************
  4809*                                COPY ELCCRTO.
  4810******************************************************************
  4811*                                                                *
  4812*                            ELCCRTO.                            *
  4813*                                                                *
  4814*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4815*                                                                *
  4816*   FILE TYPE = VSAM,KSDS                                        *
  4817*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4818*                                                                *
  4819*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4820*                                                                *
  4821*   LOG = YES                                                    *
  4822*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4823******************************************************************
  4824*                   C H A N G E   L O G
  4825*
  4826* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4827*-----------------------------------------------------------------
  4828*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4829* EFFECTIVE    NUMBER
  4830*-----------------------------------------------------------------
  4831* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4832* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4833* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4834******************************************************************
  4835 01  ORIGINAL-CERTIFICATE.
  4836     12  OC-RECORD-ID                      PIC XX.
  4837         88  VALID-OC-ID                      VALUE 'OC'.
  4838     12  OC-CONTROL-PRIMARY.
  4839         16  OC-COMPANY-CD                 PIC X.
  4840         16  OC-CARRIER                    PIC X.
  4841         16  OC-GROUPING                   PIC X(6).
  4842         16  OC-STATE                      PIC XX.
  4843         16  OC-ACCOUNT                    PIC X(10).
  4844         16  OC-CERT-EFF-DT                PIC XX.
  4845         16  OC-CERT-NO.
  4846             20  OC-CERT-PRIME             PIC X(10).
  4847             20  OC-CERT-SFX               PIC X.
  4848         16  OC-RECORD-TYPE                PIC X.
  4849         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4850     12  OC-LAST-MAINT-DT                  PIC XX.
  4851     12  OC-LAST-MAINT-BY                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  86
* EL6316.cbl
  4852     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4853     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4854     12  FILLER                            PIC X(49).
  4855     12  OC-ORIG-REC.
  4856         16  OC-INS-LAST-NAME              PIC X(15).
  4857         16  OC-INS-FIRST-NAME             PIC X(10).
  4858         16  OC-INS-MIDDLE-INIT            PIC X.
  4859         16  OC-INS-AGE                    PIC S999     COMP-3.
  4860         16  OC-JNT-LAST-NAME              PIC X(15).
  4861         16  OC-JNT-FIRST-NAME             PIC X(10).
  4862         16  OC-JNT-MIDDLE-INIT            PIC X.
  4863         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4864         16  OC-LF-BENCD                   PIC XX.
  4865         16  OC-LF-TERM                    PIC S999      COMP-3.
  4866         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4867         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4868         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  4869         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  4870         16  OC-LF-EXP-DT                  PIC XX.
  4871         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  4872         16  OC-LF-CANCEL-DT               PIC XX.
  4873         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4874         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4875         16  OC-AH-BENCD                   PIC XX.
  4876         16  OC-AH-TERM                    PIC S999      COMP-3.
  4877         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4878         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4879         16  OC-AH-EXP-DT                  PIC XX.
  4880         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4881         16  OC-AH-CP                      PIC 99.
  4882         16  OC-AH-CANCEL-DT               PIC XX.
  4883         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4884         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4885         16  OC-CRED-BENE-NAME             PIC X(25).
  4886         16  OC-1ST-PMT-DT                 PIC XX.
  4887         16  FILLER                        PIC X(215).
  4888
  4889     12  FILLER                            PIC X(50).
  4890******************************************************************
  4891*                                COPY ERCENDT.
  4892******************************************************************
  4893*                                                                *
  4894*                                                                *
  4895*                            ERCENDT.                            *
  4896*                            VMOD=2.001                          *
  4897*                                                                *
  4898*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  4899*                                                                *
  4900*   FILE TYPE = VSAM,KSDS                                        *
  4901*   RECORD SIZE = 579  RECFORM = FIXED                           *
  4902*                                                                *
  4903*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  4904*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  4905*                                                                *
  4906*   LOG = NO                                                     *
  4907*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4908******************************************************************
  4909*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  87
* EL6316.cbl
  4910*                   C H A N G E   L O G
  4911*
  4912* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4913*-----------------------------------------------------------------
  4914*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4915* EFFECTIVE    NUMBER
  4916*-----------------------------------------------------------------
  4917* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  4918*                                WITH OPEN CLAIMS
  4919* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  4920* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4921*-----------------------------------------------------------------
  4922 01  ENDORSEMENT-RECORD.
  4923     12  EN-RECORD-ID                PIC XX.
  4924         88  VALID-EN-ID                VALUE 'EN'.
  4925     12  EN-CONTROL-PRIMARY.
  4926         16  EN-COMPANY-CD           PIC X.
  4927         16  EN-CARRIER              PIC X.
  4928         16  EN-GROUPING             PIC X(6).
  4929         16  EN-STATE                PIC XX.
  4930         16  EN-ACCOUNT              PIC X(10).
  4931         16  EN-CERT-EFF-DT          PIC XX.
  4932         16  EN-CERT-NO.
  4933             20  EN-CERT-PRIME       PIC X(10).
  4934             20  EN-CERT-SFX         PIC X.
  4935         16  EN-REC-TYPE             PIC X.
  4936             88  EN-ISSUE               VALUE 'I'.
  4937             88  EN-CANCELLATION        VALUE 'C'.
  4938         16  EN-SEQ-NO               PIC 9(04) BINARY.
  4939     12  EN-CONTROL-BY-ARCH-NO.
  4940         16  EN-COMPANY-CD-A1              PIC X.
  4941         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  4942     12  EN-LAST-MAINT-DT            PIC XX.
  4943     12  EN-LAST-MAINT-BY            PIC X(4).
  4944     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4945     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  4946     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4947         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  4948         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  4949         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  4950         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  4951         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  4952         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  4953         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  4954         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  4955         16  EN-LF-ORIG-BENCD        PIC XX.
  4956         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  4957         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4958         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4959         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  4960         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  4961         16  EN-LF-ORIG-EXP-DT       PIC XX.
  4962*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  4963         16  EN-ORIG-CRED-BENE       PIC X(25).
  4964         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4965         16  FILLER                  PIC X.
  4966         16  EN-AH-ORIG-BENCD        PIC XX.
  4967         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  88
* EL6316.cbl
  4968         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4969         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4970         16  EN-AH-ORIG-EXP-DT       PIC XX.
  4971*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  4972*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  4973         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4974         16  F                       PIC X(09).
  4975         16  EN-AH-ORIG-CP           PIC 99.
  4976         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  4977         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  4978         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  4979         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  4980         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  4981         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  4982         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  4983         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  4984         16  EN-LF-NEW-BENCD         PIC XX.
  4985         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  4986         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  4987         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  4988         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  4989         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  4990         16  EN-LF-NEW-EXP-DT        PIC XX.
  4991         16  EN-NEW-CRED-BENE        PIC X(25).
  4992         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  4993         16  FILLER                  PIC X.
  4994         16  EN-AH-NEW-BENCD         PIC XX.
  4995         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  4996         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  4997         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  4998         16  EN-AH-NEW-EXP-DT        PIC XX.
  4999*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  5000*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  5001*        16  F                       PIC X(12).
  5002         16  EN-AH-NEW-CP            PIC 99.
  5003         16  EN-SIG-SW               PIC X.
  5004         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5005         16  FILLER                  PIC X(37).
  5006     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5007         16  EN-LF-ORIG-REF-DT       PIC XX.
  5008         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5009         16  EN-AH-ORIG-REF-DT       PIC XX.
  5010         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5011         16  EN-LF-NEW-REF-DT        PIC XX.
  5012         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5013         16  EN-AH-NEW-REF-DT        PIC XX.
  5014         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5015         16  EN-FLAG-CERT            PIC X.
  5016         16  EN-INS-LAST-NAME        PIC X(15).
  5017         16  EN-INS-FIRST-NAME       PIC X(10).
  5018         16  EN-INS-MIDDLE-INIT      PIC X.
  5019         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5020         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5021         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5022         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5023         16  FILLER                  PIC X(262).
  5024     12  EN-MONEY-SW             PIC X.
  5025     12  EN-HEALTH-APP           PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  89
* EL6316.cbl
  5026     12  EN-VOUCHER-SW           PIC X.
  5027     12  EN-PAYEE                PIC X(14).
  5028     12  EN-INPUT-DT             PIC XX.
  5029     12  EN-PROCESS-DT           PIC XX.
  5030     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  5031     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  5032     12  EN-REASON-CODES.
  5033         16  F OCCURS 12.
  5034             20  EN-REASON-CODE  PIC X(4).
  5035     12  EN-TEMPLATE-USED        PIC X(8).
  5036     12  EN-DOCU-TYPE            PIC X.
  5037         88  EN-VERI-DOCU          VALUE 'V'.
  5038         88  EN-GCE-DOCU           VALUE 'G'.
  5039         88  EN-CANC-DOCU          VALUE 'C'.
  5040     12  EN-COMMENTS1            PIC X(13).
  5041     12  EN-COMMENTS2            PIC X(70).
  5042     12  EN-COMM-CHGBK           PIC X.
  5043         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  5044         88  EN-CHG-ACCT           VALUE 'Y'.
  5045     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  5046     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  5047     12  EN-BATCH-NUMBER         PIC X(6).
  5048     12  EN-ACCT-SUMM            PIC X.
  5049     12  EN-CSO-SUMM             PIC X.
  5050     12  FILLER                  PIC X(13).
  5051******************************************************************
  5052*                                COPY ERCNOTE.
  5053******************************************************************
  5054*                                                                *
  5055*                                                                *
  5056*                            ERCNOTE                             *
  5057*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5058*                            VMOD=2.003                          *
  5059*                                                                *
  5060*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5061*                                                                *
  5062*        FILE TYPE= VSAM,KSDS                                    *
  5063*        RECORD SIZE = 825    RECFORM = FIXED                    *
  5064*                                                                *
  5065*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  5066*                                                                *
  5067*        LOG = YES                                               *
  5068*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5069*                                                                *
  5070******************************************************************
  5071*                   C H A N G E   L O G
  5072*
  5073* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5074*-----------------------------------------------------------------
  5075*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5076* EFFECTIVE    NUMBER
  5077*-----------------------------------------------------------------
  5078* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5079*                                FILE WILL CONTAIN BILLING NOTES O
  5080******************************************************************
  5081
  5082 01  CERTIFICATE-NOTE.
  5083     12  CN-RECORD-ID                PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  90
* EL6316.cbl
  5084         88  VALID-CN-ID                  VALUE 'CN'.
  5085
  5086     12  CN-CONTROL-PRIMARY.
  5087         16  CN-COMPANY-CD           PIC X.
  5088         16  CN-CARRIER              PIC X.
  5089         16  CN-GROUPING.
  5090             20 CN-GROUPING-PREFIX   PIC XXX.
  5091             20 CN-GROUPING-PRIME    PIC XXX.
  5092         16  CN-STATE                PIC XX.
  5093         16  CN-ACCOUNT.
  5094             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5095             20 CN-ACCOUNT-PRIME     PIC X(6).
  5096         16  CN-CERT-EFF-DT          PIC XX.
  5097         16  CN-CERT-NO.
  5098             20  CN-CERT-PRIME       PIC X(10).
  5099             20  CN-CERT-SFX         PIC X.
  5100
  5101     12  CN-BILLING-START-LINE-NO    PIC 99.
  5102     12  CN-BILLING-END-LINE-NO      PIC 99.
  5103
  5104     12  CN-LINES.
  5105         16  CN-LINE OCCURS 10       PIC X(77).
  5106
  5107     12  CN-LAST-MAINT-DT            PIC XX.
  5108     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5109     12  CN-LAST-MAINT-USER          PIC X(4).
  5110     12  FILLER                      PIC X(6).
  5111******************************************************************
  5112*                                COPY ERCMAIL.
  5113******************************************************************
  5114*                                                                *
  5115*                                                                *
  5116*                            ERCMAIL                             *
  5117*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5118*                            VMOD=2.003                          *
  5119*                                                                *
  5120*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5121*                                                                *
  5122*   FILE TYPE = VSAM,KSDS                                        *
  5123*   RECORD SIZE = 374   RECFORM = FIX                            *
  5124*                                                                *
  5125*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5126*   ALTERNATE PATH    = NOT USED                                 *
  5127*                                                                *
  5128*   LOG = YES                                                    *
  5129*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5130******************************************************************
  5131*                   C H A N G E   L O G
  5132*
  5133* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5134*-----------------------------------------------------------------
  5135*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5136* EFFECTIVE    NUMBER
  5137*-----------------------------------------------------------------
  5138* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5139* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5140* 111108                   PEMA  ADD CRED BENE ADDR2
  5141******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  91
* EL6316.cbl
  5142
  5143 01  MAILING-DATA.
  5144     12  MA-RECORD-ID                      PIC XX.
  5145         88  VALID-MA-ID                       VALUE 'MA'.
  5146
  5147     12  MA-CONTROL-PRIMARY.
  5148         16  MA-COMPANY-CD                 PIC X.
  5149         16  MA-CARRIER                    PIC X.
  5150         16  MA-GROUPING.
  5151             20  MA-GROUPING-PREFIX        PIC XXX.
  5152             20  MA-GROUPING-PRIME         PIC XXX.
  5153         16  MA-STATE                      PIC XX.
  5154         16  MA-ACCOUNT.
  5155             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5156             20  MA-ACCOUNT-PRIME          PIC X(6).
  5157         16  MA-CERT-EFF-DT                PIC XX.
  5158         16  MA-CERT-NO.
  5159             20  MA-CERT-PRIME             PIC X(10).
  5160             20  MA-CERT-SFX               PIC X.
  5161
  5162     12  FILLER                            PIC XX.
  5163
  5164     12  MA-ACCESS-CONTROL.
  5165         16  MA-SOURCE-SYSTEM              PIC XX.
  5166             88  MA-FROM-CREDIT                VALUE 'CR'.
  5167             88  MA-FROM-VSI                   VALUE 'VS'.
  5168             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5169             88  MA-FROM-OTHER                 VALUE 'OT'.
  5170         16  MA-RECORD-ADD-DT              PIC XX.
  5171         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5172         16  MA-LAST-MAINT-DT              PIC XX.
  5173         16  MA-LAST-MAINT-BY              PIC XXXX.
  5174         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5175
  5176     12  MA-PROFILE-INFO.
  5177         16  MA-QUALIFY-CODE-1             PIC XX.
  5178         16  MA-QUALIFY-CODE-2             PIC XX.
  5179         16  MA-QUALIFY-CODE-3             PIC XX.
  5180         16  MA-QUALIFY-CODE-4             PIC XX.
  5181         16  MA-QUALIFY-CODE-5             PIC XX.
  5182
  5183         16  MA-INSURED-LAST-NAME          PIC X(15).
  5184         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5185         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5186         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5187         16  MA-INSURED-BIRTH-DT           PIC XX.
  5188         16  MA-INSURED-SEX                PIC X.
  5189             88  MA-SEX-MALE                   VALUE 'M'.
  5190             88  MA-SEX-FEMALE                 VALUE 'F'.
  5191         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5192
  5193         16  MA-ADDRESS-CORRECTED          PIC X.
  5194         16  MA-JOINT-BIRTH-DT             PIC XX.
  5195*        16  FILLER                        PIC X(12).
  5196
  5197         16  MA-ADDRESS-LINE-1             PIC X(30).
  5198         16  MA-ADDRESS-LINE-2             PIC X(30).
  5199         16  MA-CITY-STATE.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  92
* EL6316.cbl
  5200             20  MA-CITY                   PIC X(28).
  5201             20  MA-ADDR-STATE             PIC XX.
  5202         16  MA-ZIP.
  5203             20  MA-ZIP-CODE.
  5204                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5205                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5206                 24  FILLER                PIC X(4).
  5207             20  MA-ZIP-PLUS4              PIC X(4).
  5208         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5209             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5210             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5211             20  FILLER                    PIC X(3).
  5212
  5213         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5214
  5215         16  FILLER                        PIC XXX.
  5216*        16  FILLER                        PIC X(10).
  5217
  5218     12  MA-CRED-BENE-INFO.
  5219         16  MA-CRED-BENE-NAME                 PIC X(25).
  5220         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5221         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5222         16  MA-CRED-BENE-CTYST.
  5223             20  MA-CRED-BENE-CITY             PIC X(28).
  5224             20  MA-CRED-BENE-STATE            PIC XX.
  5225         16  MA-CRED-BENE-ZIP.
  5226             20  MA-CB-ZIP-CODE.
  5227                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5228                     88  MA-CB-CANADIAN-POST-CODE
  5229                                           VALUE 'A' THRU 'Z'.
  5230                 24  FILLER                    PIC X(4).
  5231             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5232         16  MA-CB-CANADIAN-POSTAL-CODE
  5233                            REDEFINES MA-CRED-BENE-ZIP.
  5234             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5235             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5236             20  FILLER                        PIC X(3).
  5237     12  MA-POST-CARD-MAIL-DATA.
  5238         16  MA-MAIL-DATA OCCURS 7.
  5239             20  MA-MAIL-TYPE              PIC X.
  5240                 88  MA-12MO-MAILING           VALUE '1'.
  5241                 88  MA-EXP-MAILING            VALUE '2'.
  5242             20  MA-MAIL-STATUS            PIC X.
  5243                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5244                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5245                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5246             20  MA-MAIL-DATE              PIC XX.
  5247     12  FILLER                            PIC XX.
  5248     12  FILLER                            PIC XX.
  5249*    12  FILLER                            PIC X(30).
  5250******************************************************************
  5251*                                COPY ERCCNOT.
  5252******************************************************************
  5253*                                                                *
  5254*                            ERCCNOT                             *
  5255*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5256*                            VMOD=2.003                          *
  5257*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  93
* EL6316.cbl
  5258*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5259*                                                                *
  5260*        FILE TYPE= VSAM,KSDS                                    *
  5261*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5262*                                                                *
  5263*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5264*                                                                *
  5265*        LOG = YES                                               *
  5266*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5267*                                                                *
  5268******************************************************************
  5269*                   C H A N G E   L O G
  5270*
  5271* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5272*-----------------------------------------------------------------
  5273*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5274* EFFECTIVE    NUMBER
  5275*-----------------------------------------------------------------
  5276* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5277******************************************************************
  5278
  5279 01  CERT-NOTE-FILE.
  5280     12  CZ-RECORD-ID                PIC  XX.
  5281         88  VALID-CZ-ID                  VALUE 'CZ'.
  5282
  5283     12  CZ-CONTROL-PRIMARY.
  5284         16  CZ-COMPANY-CD           PIC X.
  5285         16  CZ-CARRIER              PIC X.
  5286         16  CZ-GROUPING.
  5287             20 CZ-GROUPING-PREFIX   PIC XXX.
  5288             20 CZ-GROUPING-PRIME    PIC XXX.
  5289         16  CZ-STATE                PIC XX.
  5290         16  CZ-ACCOUNT.
  5291             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5292             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5293         16  CZ-CERT-EFF-DT          PIC XX.
  5294         16  CZ-CERT-NO.
  5295             20  CZ-CERT-PRIME       PIC X(10).
  5296             20  CZ-CERT-SFX         PIC X.
  5297         16  CZ-RECORD-TYPE          PIC X.
  5298             88  CERT-NOTE           VALUE '1'.
  5299             88  CLAIM-CERT-NOTE     VALUE '2'.
  5300         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5301
  5302     12  CZ-LAST-MAINT-DT            PIC XX.
  5303     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5304     12  CZ-LAST-MAINT-USER          PIC X(4).
  5305
  5306     12  CZ-NOTE-INFORMATION.
  5307         16  CZ-NOTE                 PIC X(63).
  5308         16  FILLER                  PIC X(39).
  5309******************************************************************
  5310*                                COPY ELCEOBC.
  5311******************************************************************
  5312*                                                                *
  5313*                                                                *
  5314*                            ELCEOBC                             *
  5315*                            VMOD=2.001                          *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  94
* EL6316.cbl
  5316*                                                                *
  5317*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5318*                                                                *
  5319*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5320*   VSAM EOB CODE TABLE                                          *
  5321*                                                                *
  5322*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5323*                                                                *
  5324*   FILE TYPE = VSAM,KSDS                                        *
  5325*   RECORD SIZE = 350   RECFORM = FIX                            *
  5326*                                                                *
  5327*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5328*                                                                *
  5329*   LOG = NO                                                     *
  5330*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5331*                                                                *
  5332*                                                                *
  5333******************************************************************
  5334*                   C H A N G E   L O G
  5335*
  5336* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5337*-----------------------------------------------------------------
  5338*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5339* EFFECTIVE    NUMBER
  5340*-----------------------------------------------------------------
  5341* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5342* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5343******************************************************************
  5344 01  EOB-CODES.
  5345     12  EO-RECORD-ID                      PIC XX.
  5346         88  VALID-DN-ID                      VALUE 'EO'.
  5347     12  EO-CONTROL-PRIMARY.
  5348         16  EO-COMPANY-CD                 PIC X.
  5349         16  EO-RECORD-TYPE                PIC X.
  5350             88  EO-EOB-RECS                  VALUE '1'.
  5351             88  EO-VERIF-RECS                VALUE '2'.
  5352             88  EO-GCE-RECS                  VALUE '3'.
  5353         16  EO-EOB-CODE                   PIC X(4).
  5354         16  FILLER                        PIC X(9).
  5355     12  EO-MAINT-INFORMATION.
  5356         16  EO-LAST-MAINT-DT              PIC XX.
  5357         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5358         16  EO-LAST-MAINT-USER            PIC X(4).
  5359         16  FILLER                        PIC XX.
  5360     12  EO-DESCRIPTION                    PIC X(275).
  5361     12  FILLER                            PIC X(46).
  5362******************************************************************
  5363 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5364                          ACCOUNT-MASTER CONTROL-FILE
  5365                          PENDING-BUSINESS CERTIFICATE-MASTER
  5366                          ORIGINAL-CERTIFICATE
  5367                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5368                          MAILING-DATA CERT-NOTE-FILE EOB-CODES.
  5369 0000-DFHEXIT SECTION.
  5370     MOVE '9#                    $   ' TO DFHEIV0.
  5371     MOVE 'EL6316' TO DFHEIV1.
  5372     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5373     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  95
* EL6316.cbl
  5374     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5375     MOVE '5'                    TO DC-OPTION-CODE
  5376     PERFORM 9700-DATE-LINK
  5377     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT
  5378     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-BIN-DT
  5379     MOVE EIBTRMID               TO QID-TERM
  5380     IF EIBCALEN = 0
  5381        GO TO 8800-UNAUTHORIZED-ACCESS
  5382     END-IF
  5383     DISPLAY ' ENDORSE LENGTH  '
  5384                FUNCTION LENGTH(ENDORSEMENT-RECORD)
  5385     move function length(EL631II) TO MAP-LENGTH
  5386     DISPLAY ' MAP LENGTH      ' MAP-LENGTH
  5387     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5388        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5389           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5390           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5391           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5392           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5393           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5394           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5395           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5396           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5397           MOVE LOW-VALUES             TO EL631II
  5398           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5399           GO TO 0350-DISPLAY-COMMON-DATA
  5400        END-IF
  5401     END-IF
  5402     IF PI-CALLING-PROGRAM = 'EL614'
  5403        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5404                                 TO WS-PASSED-REASON-CODES
  5405        DISPLAY ' COMING BACK FROM 614 ' WS-PASSED-REASON-CODES
  5406        IF WS-PASSED-REASON-CODES NOT = SPACES
  5407           MOVE 'Y'                TO WS-SET-CODES-MDT
  5408        ELSE
  5409           MOVE 'N'                TO WS-SET-CODES-MDT
  5410        END-IF
  5411        PERFORM 0610-RECOVER-TEMP-STORAGE
  5412                                 THRU 0610-EXIT
  5413        GO TO 0350-DISPLAY-COMMON-DATA
  5414     END-IF
  5415     IF EIBAID = DFHCLEAR
  5416        IF PI-CLEAR-ERROR
  5417           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5418           MOVE ER-3833           TO EMI-ERROR
  5419           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5420           GO TO 0350-DISPLAY-COMMON-DATA
  5421        ELSE
  5422           GO TO 9400-CLEAR
  5423        END-IF
  5424     END-IF
  5425     .
  5426 0200-RECEIVE.
  5427     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5428        MOVE ER-0008             TO EMI-ERROR
  5429        PERFORM 9900-ERROR-FORMAT
  5430                                 THRU 9900-EXIT
  5431        MOVE -1                  TO PFENTRL
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  96
* EL6316.cbl
  5432        GO TO 8100-SEND-INITIAL-MAP
  5433     END-IF
  5434
  5435* EXEC CICS RECEIVE
  5436*        MAP      (MAP-NAME)
  5437*        MAPSET   (MAPSET-NAME)
  5438*        INTO     (EL631II)
  5439*    END-EXEC
  5440     MOVE LENGTH OF
  5441      EL631II
  5442       TO DFHEIV11
  5443*    MOVE '8"T I  L              ''   #00005430' TO DFHEIV0
  5444     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5445     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5446     MOVE X'2020233030303035343330' TO DFHEIV0(25:11)
  5447     CALL 'kxdfhei1' USING DFHEIV0,
  5448           MAP-NAME,
  5449           EL631II,
  5450           DFHEIV11,
  5451           MAPSET-NAME,
  5452           DFHEIV99,
  5453           DFHEIV99
  5454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5455     IF PFENTRL = 0
  5456         GO TO 0300-CHECK-PFKEYS
  5457     END-IF
  5458     IF EIBAID NOT = DFHENTER
  5459         MOVE ER-0004            TO EMI-ERROR
  5460         GO TO 0320-INPUT-ERROR
  5461     END-IF
  5462     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5463        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5464     ELSE
  5465        MOVE ER-0029            TO EMI-ERROR
  5466        GO TO 0320-INPUT-ERROR
  5467     END-IF
  5468     .
  5469 0300-CHECK-PFKEYS.
  5470     IF EIBAID = DFHPF1
  5471        MOVE PI-ERENDT-KEY       TO ERENDT-KEY
  5472        PERFORM 0520-ERENDT-STARTBR
  5473                                 THRU 0520-EXIT
  5474        PERFORM 0510-ERENDT-READNEXT
  5475                                 THRU 0510-EXIT
  5476        IF ERENDT-KEY = PI-PREV-ERENDT-KEY
  5477            PERFORM 0510-ERENDT-READNEXT
  5478                                 THRU 0510-EXIT
  5479        END-IF
  5480        IF (RESP-NORMAL) AND
  5481         (PI-ERENDT-KEY (1:34) = EN-CONTROL-PRIMARY (1:34))
  5482           PERFORM 0390-BUILD-FROM-ERENDT
  5483                                 THRU 0390-EXIT
  5484           MOVE ER-0000          TO EMI-ERROR
  5485           PERFORM 9900-ERROR-FORMAT
  5486                                 THRU 9900-EXIT
  5487           GO TO 8100-SEND-INITIAL-MAP
  5488        ELSE
  5489           MOVE ER-2237          TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  97
* EL6316.cbl
  5490           MOVE -1               TO CARRL
  5491           PERFORM 9900-ERROR-FORMAT
  5492                                 THRU 9900-EXIT
  5493           GO TO 8200-SEND-DATAONLY
  5494        END-IF
  5495     END-IF
  5496     IF EIBAID = DFHPF2
  5497        MOVE PI-ERENDT-KEY       TO ERENDT-KEY
  5498        PERFORM 0520-ERENDT-STARTBR
  5499                                 THRU 0520-EXIT
  5500        PERFORM 0510-ERENDT-READNEXT
  5501                                 THRU 0510-EXIT
  5502        PERFORM 0530-ERENDT-READPREV
  5503                                 THRU 0530-EXIT
  5504        PERFORM 0530-ERENDT-READPREV
  5505                                 THRU 0530-EXIT
  5506        IF (RESP-NORMAL) AND
  5507         (PI-ERENDT-KEY (1:34) = EN-CONTROL-PRIMARY (1:34))
  5508           PERFORM 0390-BUILD-FROM-ERENDT
  5509                                 THRU 0390-EXIT
  5510           MOVE ER-0000          TO EMI-ERROR
  5511           PERFORM 9900-ERROR-FORMAT
  5512                                 THRU 9900-EXIT
  5513           GO TO 8100-SEND-INITIAL-MAP
  5514        ELSE
  5515           GO TO 0350-DISPLAY-COMMON-DATA
  5516           MOVE ER-2238          TO EMI-ERROR
  5517           PERFORM 9900-ERROR-FORMAT
  5518                                 THRU 9900-EXIT
  5519           MOVE -1               TO CARRL
  5520           GO TO 8200-SEND-DATAONLY
  5521        END-IF
  5522     END-IF
  5523     IF EIBAID = DFHPF3
  5524        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5525        PERFORM 0600-CREATE-TEMP-STORAGE
  5526                                 THRU 0600-EXIT
  5527        MOVE 'EL614'             TO PGM-NAME
  5528        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5529        MOVE +1                  TO S2
  5530        PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5531           IF REACD-IN (S1) NOT = SPACES AND LOW-VALUES
  5532              MOVE REACD-IN (S1) TO PI-PROGRAM-WORK-AREA (S2:4)
  5533              ADD +5 TO S2
  5534           END-IF
  5535        END-PERFORM
  5536        DISPLAY ' GOING TO 614 ' PI-PROGRAM-WORK-AREA (1:60)
  5537        GO TO 9300-XCTL
  5538     END-IF
  5539     IF EIBAID = DFHPF4 OR DFHPF8
  5540        GO TO 1000-FINALIZE
  5541     END-IF
  5542     IF EIBAID = DFHPF23
  5543        IF PI-CLEAR-ERROR
  5544           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5545           MOVE ER-3833           TO EMI-ERROR
  5546           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5547           GO TO 0350-DISPLAY-COMMON-DATA
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  98
* EL6316.cbl
  5548        ELSE
  5549           GO TO 8810-PF23
  5550        END-IF
  5551     END-IF
  5552     IF EIBAID = DFHPF24
  5553        IF PI-CLEAR-ERROR
  5554           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5555           MOVE ER-3833           TO EMI-ERROR
  5556           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5557           GO TO 0350-DISPLAY-COMMON-DATA
  5558        ELSE
  5559           GO TO 9200-RETURN-MAIN-MENU
  5560        END-IF
  5561     END-IF
  5562     IF EIBAID = DFHPF12
  5563        GO TO 9500-PF12
  5564     END-IF
  5565     IF EIBAID = DFHENTER
  5566        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5567        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5568        IF EMI-NO-ERRORS
  5569           GO TO 0350-DISPLAY-COMMON-DATA
  5570        ELSE
  5571           GO TO 8200-SEND-DATAONLY
  5572        END-IF
  5573     END-IF
  5574     MOVE ER-0029                TO EMI-ERROR
  5575     .
  5576 0320-INPUT-ERROR.
  5577     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5578     MOVE AL-UNBON               TO PFENTRA
  5579     MOVE -1                     TO PFENTRL
  5580     GO TO 8200-SEND-DATAONLY
  5581     .
  5582 0325-EDIT-SCREEN.
  5583     IF PRTSWL > ZEROS
  5584        IF PRTSWI = 'Y' OR 'N' OR 'P' OR ' '
  5585*          move prtswi to w-prtsw
  5586*          MOVE AL-UANON         TO PRTSWA
  5587*          IF PRTSWI = ' '
  5588              MOVE 'P'         TO PRTSWI
  5589*          END-IF
  5590*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  5591        END-IF
  5592     END-IF
  5593     IF LTRIDL > ZEROS
  5594        AND LTRIDI > SPACES
  5595        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  5596        MOVE LTRIDI              TO LETR-LETTER-ID
  5597                                    PI-LTRID-ENTERED
  5598        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  5599        MOVE SPACES              TO LETR-FILLER
  5600        MOVE 0                   TO LETR-SEQ-NO
  5601        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  5602     ELSE
  5603        MOVE ER-1236          TO EMI-ERROR
  5604        MOVE -1               TO LTRIDL
  5605        MOVE AL-UABON         TO LTRIDA
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  99
* EL6316.cbl
  5606        PERFORM 9900-ERROR-FORMAT
  5607                                 THRU 9900-EXIT
  5608     END-IF
  5609
  5610     IF W-PROMPT-LETTER EQUAL 'Y'
  5611         MOVE ER-0894            TO EMI-ERROR
  5612         MOVE -1                 TO LTRIDL
  5613         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5614     END-IF
  5615     SET REASONS-NOT-FOUND TO TRUE
  5616     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5617        IF REACDL (S1) = +4 OR
  5618          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5619              MOVE AL-SANON     TO REACDA (S1)
  5620              SET REASONS-FOUND TO TRUE
  5621        END-IF
  5622     END-PERFORM
  5623
  5624     IF REASONS-NOT-FOUND
  5625        MOVE ER-1820             TO EMI-ERROR
  5626        MOVE -1                  TO PFENTRL
  5627        PERFORM 9900-ERROR-FORMAT
  5628                                 THRU 9900-EXIT
  5629     ELSE
  5630        MOVE REASONCDS           TO PI-REASONS-ENTERED
  5631     END-IF
  5632
  5633     IF CRTNT1L > ZEROS
  5634        IF CRTNT1I > SPACES
  5635           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  5636        END-IF
  5637     END-IF
  5638
  5639     IF CRTNT2L > ZEROS
  5640        IF CRTNT2I > SPACES
  5641           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  5642        END-IF
  5643     END-IF
  5644
  5645     .
  5646 0325-EXIT.
  5647     EXIT.
  5648
  5649 0326-GET-Z-RECORD.
  5650
  5651     MOVE SPACES  TO W-Z-CONTROL-DATA
  5652
  5653
  5654* EXEC CICS STARTBR
  5655*         DATASET    ('ELLETR')
  5656*         RIDFLD     (ELLETR-KEY)
  5657*         GTEQ
  5658*         RESP      (WS-RESPONSE)
  5659*    END-EXEC.
  5660     MOVE 'ELLETR' TO DFHEIV1
  5661     MOVE 0
  5662       TO DFHEIV11
  5663*    MOVE '&,         G          &  N#00005633' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 100
* EL6316.cbl
  5664     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5665     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5666     MOVE X'204E233030303035363333' TO DFHEIV0(25:11)
  5667     CALL 'kxdfhei1' USING DFHEIV0,
  5668           DFHEIV1,
  5669           ELLETR-KEY,
  5670           DFHEIV99,
  5671           DFHEIV11,
  5672           DFHEIV99
  5673     MOVE EIBRESP  TO WS-RESPONSE
  5674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5675
  5676     IF NOT RESP-NORMAL
  5677         MOVE ER-1236          TO EMI-ERROR
  5678         MOVE -1               TO LTRIDL
  5679         MOVE AL-UABON         TO LTRIDA
  5680         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5681         GO TO 0326-ENDBR
  5682     END-IF.
  5683
  5684 0326-READNEXT.
  5685
  5686
  5687* EXEC CICS READNEXT
  5688*        DATASET   ('ELLETR')
  5689*        INTO      (TEXT-FILES)
  5690*        RIDFLD    (ELLETR-KEY)
  5691*        RESP      (WS-RESPONSE)
  5692*    END-EXEC
  5693     MOVE LENGTH OF
  5694      TEXT-FILES
  5695       TO DFHEIV12
  5696     MOVE 'ELLETR' TO DFHEIV1
  5697     MOVE 0
  5698       TO DFHEIV11
  5699*    MOVE '&.IL                  )  N#00005649' TO DFHEIV0
  5700     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5701     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5702     MOVE X'204E233030303035363439' TO DFHEIV0(25:11)
  5703     CALL 'kxdfhei1' USING DFHEIV0,
  5704           DFHEIV1,
  5705           TEXT-FILES,
  5706           DFHEIV12,
  5707           ELLETR-KEY,
  5708           DFHEIV99,
  5709           DFHEIV11,
  5710           DFHEIV99,
  5711           DFHEIV99
  5712     MOVE EIBRESP  TO WS-RESPONSE
  5713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5714     IF RESP-NORMAL
  5715        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  5716           MOVE ER-1236          TO EMI-ERROR
  5717           MOVE -1               TO LTRIDL
  5718           MOVE AL-UABON         TO LTRIDA
  5719           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5720           GO TO 0326-ENDBR
  5721        END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 101
* EL6316.cbl
  5722
  5723        MOVE AL-UANON         TO LTRIDA
  5724        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  5725           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  5726        ELSE
  5727           GO TO 0326-READNEXT
  5728        END-IF
  5729     ELSE
  5730        MOVE ER-1236          TO EMI-ERROR
  5731        MOVE -1               TO LTRIDL
  5732        MOVE AL-UABON         TO LTRIDA
  5733        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5734        GO TO 0326-ENDBR
  5735     END-IF.
  5736
  5737 0326-ENDBR.
  5738
  5739
  5740* EXEC CICS ENDBR
  5741*        DATASET     ('ELLETR')
  5742*    END-EXEC.
  5743     MOVE 'ELLETR' TO DFHEIV1
  5744     MOVE 0
  5745       TO DFHEIV11
  5746*    MOVE '&2                    $   #00005680' TO DFHEIV0
  5747     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5748     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5749     MOVE X'2020233030303035363830' TO DFHEIV0(25:11)
  5750     CALL 'kxdfhei1' USING DFHEIV0,
  5751           DFHEIV1,
  5752           DFHEIV11,
  5753           DFHEIV99
  5754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5755
  5756
  5757 0326-EXIT.
  5758      EXIT.
  5759 0350-DISPLAY-COMMON-DATA.
  5760     display ' made it to 0350 '
  5761     PERFORM 0360-CHECK-PENDING THRU 0360-EXIT
  5762     IF PI-LTRID-ENTERED > SPACES
  5763        MOVE PI-LTRID-ENTERED    TO LTRIDI
  5764        MOVE AL-UANON            TO LTRIDA
  5765        MOVE +4                  TO LTRIDL
  5766     ELSE
  5767        IF PI-CLM-RESCISSION
  5768            MOVE 'CLRC'          TO LTRIDI
  5769                                    PI-LTRID-ENTERED
  5770            MOVE +4              TO LTRIDL
  5771            MOVE AL-UANON        TO LTRIDA
  5772        END-IF
  5773     END-IF
  5774
  5775     SET REASONS-NOT-FOUND TO TRUE
  5776     MOVE PI-REASONS-ENTERED     TO REASONCDS
  5777     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5778        IF REACDL (S1) = +4 OR
  5779          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 102
* EL6316.cbl
  5780              MOVE AL-SANON      TO REACDA (S1)
  5781              MOVE +4            TO REACDL (S1)
  5782              SET REASONS-FOUND  TO TRUE
  5783        END-IF
  5784     END-PERFORM
  5785
  5786     IF REASONS-NOT-FOUND
  5787         IF PI-CLM-RESCISSION
  5788            MOVE 'CRNA'          TO REACD-IN (1)
  5789            MOVE AL-SANON        TO REACDA (1)
  5790            MOVE +4              TO REACDL (1)
  5791            SET REASONS-FOUND    TO TRUE
  5792        END-IF
  5793     END-IF
  5794
  5795     IF PI-CERTNT1-ENTERED > SPACES
  5796        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  5797        MOVE AL-UANON            TO CRTNT1A
  5798        MOVE +63                 TO CRTNT1L
  5799     END-IF
  5800
  5801     IF PI-CERTNT2-ENTERED > SPACES
  5802        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  5803        MOVE AL-UANON            TO CRTNT2A
  5804        MOVE +63                 TO CRTNT2L
  5805     END-IF
  5806
  5807     GO TO 8100-SEND-INITIAL-MAP
  5808     .
  5809 0350-EXIT.
  5810     EXIT.
  5811 0360-CHECK-PENDING.
  5812     display ' made it to 0360 '
  5813     MOVE PI-COMPANY-CD          TO CRTO-COMPANY-CD
  5814     MOVE PI-CARRIER             TO CRTO-CARRIER
  5815     MOVE PI-GROUPING            TO CRTO-GROUPING
  5816     MOVE PI-STATE               TO CRTO-STATE
  5817     MOVE PI-ACCOUNT             TO CRTO-ACCOUNT
  5818     MOVE PI-CERT-PRIME          TO CRTO-CERT-PRIME
  5819     MOVE PI-CERT-SFX            TO CRTO-CERT-SFX
  5820     MOVE PI-CERT-EFF-DT         TO CRTO-CERT-EFF-DT
  5821     MOVE 'I'                    TO CRTO-RECORD-TYPE
  5822     MOVE ZEROS                  TO CRTO-SEQ-NO
  5823     MOVE ELCRTO-KEY             TO PI-ELCRTO-KEY
  5824     MOVE ELCRTO-KEY (1:33)      TO PI-ERENDT-KEY (1:33)
  5825     MOVE 'C'                    TO PI-ENDT-RECORD-TYPE
  5826     MOVE ZEROS                  TO PI-ENDT-SEQ-NO
  5827     MOVE PI-ERENDT-KEY          TO PI-PREV-ERENDT-KEY
  5828     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  5829      display 'response ' ws-response
  5830      display 'pi-elcrto-key ' pi-elcrto-key
  5831      display 'oc key ' oc-control-primary
  5832     IF RESP-NORMAL
  5833       IF (PI-ELCRTO-KEY (1:33) =
  5834              OC-CONTROL-PRIMARY (1:33))
  5835          DISPLAY 'CRTO RESP NORMAL '
  5836          MOVE OC-CONTROL-PRIMARY  TO PI-ELCRTO-KEY
  5837          PERFORM 0361-MOVE-CRTO-TO-SCREEN THRU 0361-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 103
* EL6316.cbl
  5838          PERFORM 0370-READ-ERPNDB THRU 0370-EXIT
  5839          IF RESP-NORMAL
  5840             MOVE PB-CONTROL-PRIMARY TO PI-ERPNDB-KEY
  5841             PERFORM 0380-BUILD-FROM-ERPNDB THRU 0380-EXIT
  5842          END-IF
  5843       ELSE
  5844          MOVE ER-3829           TO EMI-ERROR
  5845          PERFORM 9900-ERROR-FORMAT
  5846                                 THRU 9900-EXIT
  5847          MOVE -1                TO CARRL
  5848          GO TO 8100-SEND-INITIAL-MAP
  5849       END-IF
  5850     ELSE
  5851        MOVE ER-3829             TO EMI-ERROR
  5852        PERFORM 9900-ERROR-FORMAT
  5853                                 THRU 9900-EXIT
  5854        MOVE -1                  TO CARRL
  5855        GO TO 8100-SEND-INITIAL-MAP
  5856     END-IF
  5857     .
  5858 0360-EXIT.
  5859     EXIT.
  5860 0361-MOVE-CRTO-TO-SCREEN.
  5861     display ' made it to 0361 '
  5862     MOVE OC-LF-CANCEL-DT          TO DC-BIN-DATE-1
  5863     MOVE ' '                      TO DC-OPTION-CODE
  5864     PERFORM 9700-DATE-LINK
  5865     IF NO-CONVERSION-ERROR
  5866        MOVE DC-GREG-DATE-1-EDIT   TO OLFDTO
  5867     END-IF
  5868     MOVE OC-AH-CANCEL-DT          TO DC-BIN-DATE-1
  5869     MOVE ' '                      TO DC-OPTION-CODE
  5870     PERFORM 9700-DATE-LINK
  5871     IF NO-CONVERSION-ERROR
  5872        MOVE DC-GREG-DATE-1-EDIT   TO OAHDTO
  5873     END-IF
  5874     MOVE OC-LF-CANCEL-AMT         TO OLFAMTO
  5875     MOVE OC-AH-CANCEL-AMT         TO OAHAMTO
  5876     .
  5877 0361-EXIT.
  5878     EXIT.
  5879 0362-READ-ELCRTO.
  5880     display ' made it to 0362 '
  5881
  5882* EXEC CICS READ
  5883*        DATASET   (WS-ELCRTO-FILE-ID)
  5884*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  5885*        RIDFLD    (ELCRTO-KEY)
  5886*        GTEQ
  5887*        RESP      (WS-RESPONSE)
  5888*    END-EXEC
  5889*    MOVE '&"S        G          (  N#00005808' TO DFHEIV0
  5890     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  5891     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5892     MOVE X'204E233030303035383038' TO DFHEIV0(25:11)
  5893     CALL 'kxdfhei1' USING DFHEIV0,
  5894           WS-ELCRTO-FILE-ID,
  5895           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 104
* EL6316.cbl
  5896           DFHEIV99,
  5897           ELCRTO-KEY,
  5898           DFHEIV99,
  5899           DFHEIV99,
  5900           DFHEIV99
  5901     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  5902         DFHEIV20
  5903     MOVE EIBRESP  TO WS-RESPONSE
  5904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5905     .
  5906 0362-EXIT.
  5907     EXIT.
  5908 0363-READ-ELCRTO-UPD.
  5909     display ' made it to 0363 '
  5910
  5911* EXEC CICS READ
  5912*        DATASET   (WS-ELCRTO-FILE-ID)
  5913*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  5914*        RIDFLD    (ELCRTO-KEY)
  5915*        UPDATE
  5916*        RESP      (WS-RESPONSE)
  5917*    END-EXEC
  5918*    MOVE '&"S        EU         (  N#00005820' TO DFHEIV0
  5919     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5920     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5921     MOVE X'204E233030303035383230' TO DFHEIV0(25:11)
  5922     CALL 'kxdfhei1' USING DFHEIV0,
  5923           WS-ELCRTO-FILE-ID,
  5924           DFHEIV20,
  5925           DFHEIV99,
  5926           ELCRTO-KEY,
  5927           DFHEIV99,
  5928           DFHEIV99,
  5929           DFHEIV99
  5930     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  5931         DFHEIV20
  5932     MOVE EIBRESP  TO WS-RESPONSE
  5933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5934     .
  5935 0363-EXIT.
  5936     EXIT.
  5937
  5938 0364-MOVE-ZERO-TO-SCREEN.
  5939
  5940     MOVE ZEROS    TO OLFDTO
  5941                      OAHDTO
  5942                      OLFAMTO
  5943                      OAHAMTO.
  5944
  5945 0364-EXIT.
  5946     EXIT.
  5947
  5948 0365-READ-ERENDT.
  5949
  5950* EXEC CICS READ
  5951*        DATASET   (WS-ERENDT-FILE-ID)
  5952*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  5953*        RIDFLD    (ERENDT-KEY)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 105
* EL6316.cbl
  5954*        RESP      (WS-RESPONSE)
  5955*    END-EXEC
  5956*    MOVE '&"S        E          (  N#00005842' TO DFHEIV0
  5957     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5958     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5959     MOVE X'204E233030303035383432' TO DFHEIV0(25:11)
  5960     CALL 'kxdfhei1' USING DFHEIV0,
  5961           WS-ERENDT-FILE-ID,
  5962           DFHEIV20,
  5963           DFHEIV99,
  5964           ERENDT-KEY,
  5965           DFHEIV99,
  5966           DFHEIV99,
  5967           DFHEIV99
  5968     SET ADDRESS OF ENDORSEMENT-RECORD TO
  5969         DFHEIV20
  5970     MOVE EIBRESP  TO WS-RESPONSE
  5971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5972     .
  5973 0365-EXIT.
  5974     EXIT.
  5975 0370-READ-ERPNDB.
  5976     display ' made it to 0370 '
  5977     MOVE PI-COMPANY-CD          TO PNDB2-COMPANY-CD
  5978     MOVE PI-CRTO-CARRIER        TO PNDB2-CARRIER
  5979     MOVE PI-CRTO-GROUPING       TO PNDB2-GROUPING
  5980     MOVE PI-CRTO-STATE          TO PNDB2-STATE
  5981     MOVE PI-CRTO-ACCOUNT        TO PNDB2-ACCOUNT
  5982     MOVE PI-CRTO-CERT-PRIME     TO PNDB2-CERT-PRIME
  5983     MOVE PI-CRTO-CERT-SFX       TO PNDB2-CERT-SFX
  5984     MOVE PI-CRTO-CERT-EFF-DT    TO PNDB2-CERT-EFF-DT
  5985     MOVE +0                     TO PNDB2-CHG-SEQ-NO
  5986     MOVE '2'                    TO PNDB2-RECORD-TYPE
  5987
  5988* EXEC CICS READ
  5989*        DATASET   (WS-ERPNDB2-FILE-ID)
  5990*        SET       (ADDRESS OF PENDING-BUSINESS)
  5991*        RIDFLD    (ERPNDB2-KEY)
  5992*        RESP      (WS-RESPONSE)
  5993*    END-EXEC
  5994*    MOVE '&"S        E          (  N#00005863' TO DFHEIV0
  5995     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5996     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5997     MOVE X'204E233030303035383633' TO DFHEIV0(25:11)
  5998     CALL 'kxdfhei1' USING DFHEIV0,
  5999           WS-ERPNDB2-FILE-ID,
  6000           DFHEIV20,
  6001           DFHEIV99,
  6002           ERPNDB2-KEY,
  6003           DFHEIV99,
  6004           DFHEIV99,
  6005           DFHEIV99
  6006     SET ADDRESS OF PENDING-BUSINESS TO
  6007         DFHEIV20
  6008     MOVE EIBRESP  TO WS-RESPONSE
  6009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6010     .
  6011 0370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 106
* EL6316.cbl
  6012     EXIT.
  6013 0380-BUILD-FROM-ERPNDB.
  6014     display ' made it to 0380 '
  6015     MOVE PB-CARRIER             TO CARRO
  6016     MOVE PB-GROUPING            TO GROUPO
  6017     MOVE PB-STATE               TO STATEO
  6018     MOVE PB-ACCOUNT             TO ACCTO
  6019     MOVE PB-CERT-PRIME          TO CERTNOO
  6020     MOVE PB-CERT-SFX            TO CRTSFXO
  6021     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  6022     MOVE ' '                    TO DC-OPTION-CODE
  6023     PERFORM 9700-DATE-LINK
  6024     IF NO-CONVERSION-ERROR
  6025        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6026     END-IF
  6027     MOVE PB-CI-LAST-NAME        TO LNAMEO
  6028     MOVE PB-CI-FIRST-NAME       TO FNAMEO
  6029     MOVE PB-CI-INITIALS (2:1)   TO MINITO
  6030     MOVE PB-C-LF-CANCEL-DT        TO DC-BIN-DATE-1
  6031     MOVE ' '                      TO DC-OPTION-CODE
  6032     PERFORM 9700-DATE-LINK
  6033     IF NO-CONVERSION-ERROR
  6034        MOVE DC-GREG-DATE-1-EDIT   TO NLFDTO
  6035     END-IF
  6036     MOVE PB-C-AH-CANCEL-DT        TO DC-BIN-DATE-1
  6037     MOVE ' '                      TO DC-OPTION-CODE
  6038     PERFORM 9700-DATE-LINK
  6039     IF NO-CONVERSION-ERROR
  6040        MOVE DC-GREG-DATE-1-EDIT   TO NAHDTO
  6041     END-IF
  6042     MOVE PB-C-LF-CANCEL-AMT       TO NLFAMTO
  6043     MOVE PB-C-AH-CANCEL-AMT       TO NAHAMTO
  6044     IF PB-CI-LIFE-COMMISSION NOT = ZEROS
  6045        MOVE PB-CI-LIFE-COMMISSION
  6046                              TO LFCOMMO
  6047*       MOVE AL-UNNON         TO LFCOMMA
  6048     END-IF
  6049     IF PB-CI-AH-COMMISSION NOT = ZEROS
  6050        MOVE PB-CI-AH-COMMISSION
  6051                              TO AHCOMMO
  6052*       MOVE AL-UNNON         TO AHCOMMA
  6053     END-IF
  6054     MOVE ER-2785                TO EMI-ERROR
  6055     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  6056     .
  6057 0380-EXIT.
  6058     EXIT.
  6059 0390-BUILD-FROM-ERENDT.
  6060     MOVE LOW-VALUES             TO EL631II
  6061*    move PI-PRTSW-ENTERED       to prtswo
  6062     IF PI-CERTNT1-ENTERED > SPACES
  6063        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6064        MOVE AL-UANON            TO CRTNT1A
  6065        MOVE +63                 TO CRTNT1L
  6066     END-IF
  6067
  6068     IF PI-CERTNT2-ENTERED > SPACES
  6069        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 107
* EL6316.cbl
  6070        MOVE AL-UANON            TO CRTNT2A
  6071        MOVE +63                 TO CRTNT2L
  6072     END-IF
  6073     MOVE PI-COMPANY-CD          TO PI-ENDT-COMPANY-CD
  6074     MOVE EN-CARRIER             TO PI-ENDT-CARRIER
  6075     MOVE EN-GROUPING            TO PI-ENDT-GROUPING
  6076     MOVE EN-STATE               TO PI-ENDT-STATE
  6077     MOVE EN-ACCOUNT             TO PI-ENDT-ACCOUNT
  6078     MOVE EN-CERT-PRIME          TO PI-ENDT-CERT-PRIME
  6079     MOVE EN-CERT-SFX            TO PI-ENDT-CERT-SFX
  6080     MOVE EN-CERT-EFF-DT         TO PI-ENDT-CERT-EFF-DT
  6081     MOVE EN-REC-TYPE            TO PI-ENDT-RECORD-TYPE
  6082     MOVE EN-SEQ-NO              TO PI-ENDT-SEQ-NO
  6083     MOVE PI-ERENDT-KEY          TO PI-PREV-ERENDT-KEY
  6084     MOVE EN-CARRIER             TO CARRO
  6085     MOVE EN-GROUPING            TO GROUPO
  6086     MOVE EN-STATE               TO STATEO
  6087     MOVE EN-ACCOUNT             TO ACCTO
  6088     MOVE EN-CERT-PRIME          TO CERTNOO
  6089     MOVE EN-CERT-SFX            TO CRTSFXO
  6090     MOVE EN-SEQ-NO              TO SEQNOO
  6091     MOVE EN-TEMPLATE-USED       TO LTRIDO
  6092     PERFORM 0370-READ-ERPNDB THRU 0370-EXIT
  6093     MOVE PB-CI-LAST-NAME        TO LNAMEO
  6094     MOVE PB-CI-FIRST-NAME       TO FNAMEO
  6095     MOVE PB-CI-INITIALS (2:1)   TO MINITO
  6096     IF PB-CI-LIFE-COMMISSION NOT = ZEROS
  6097        MOVE PB-CI-LIFE-COMMISSION TO LFCOMMO
  6098     END-IF
  6099     IF PB-CI-AH-COMMISSION NOT = ZEROS
  6100        MOVE PB-CI-AH-COMMISSION TO AHCOMMO
  6101     END-IF
  6102     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6103        IF EN-REASON-CODE (S1) NOT = SPACES
  6104           MOVE EN-REASON-CODE (S1) TO REACD-IN (S1)
  6105           MOVE AL-SANON         TO REACDA (S1)
  6106           MOVE +4               TO REACDL (S1)
  6107        END-IF
  6108     END-PERFORM
  6109     MOVE EN-CERT-EFF-DT         TO DC-BIN-DATE-1
  6110     MOVE ' '                    TO DC-OPTION-CODE
  6111     PERFORM 9700-DATE-LINK
  6112     IF NO-CONVERSION-ERROR
  6113        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6114     END-IF
  6115     IF EN-PROCESS-DT NOT = SPACES AND LOW-VALUES
  6116        MOVE EN-PROCESS-DT       TO DC-BIN-DATE-1
  6117        MOVE ' '                 TO DC-OPTION-CODE
  6118        PERFORM 9700-DATE-LINK
  6119        IF NO-CONVERSION-ERROR
  6120           MOVE DC-GREG-DATE-1-EDIT
  6121                                 TO PROCDTO
  6122        END-IF
  6123     END-IF
  6124     IF EN-INPUT-DT NOT = SPACES AND LOW-VALUES
  6125        MOVE EN-INPUT-DT         TO DC-BIN-DATE-1
  6126        MOVE ' '                 TO DC-OPTION-CODE
  6127        PERFORM 9700-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 108
* EL6316.cbl
  6128        IF NO-CONVERSION-ERROR
  6129           MOVE DC-GREG-DATE-1-EDIT
  6130                                 TO INPDTO
  6131        END-IF
  6132     END-IF
  6133     MOVE EN-LF-ORIG-REF-DT        TO DC-BIN-DATE-1
  6134     MOVE ' '                      TO DC-OPTION-CODE
  6135     PERFORM 9700-DATE-LINK
  6136     IF NO-CONVERSION-ERROR
  6137        MOVE DC-GREG-DATE-1-EDIT   TO OLFDTO
  6138     END-IF
  6139     MOVE EN-LF-ORIG-REF-AMT       TO OLFAMTO
  6140     MOVE EN-AH-ORIG-REF-DT        TO DC-BIN-DATE-1
  6141     MOVE ' '                      TO DC-OPTION-CODE
  6142     PERFORM 9700-DATE-LINK
  6143     IF NO-CONVERSION-ERROR
  6144        MOVE DC-GREG-DATE-1-EDIT   TO OAHDTO
  6145     END-IF
  6146     MOVE EN-AH-ORIG-REF-AMT       TO OAHAMTO
  6147     MOVE EN-LF-NEW-REF-DT         TO DC-BIN-DATE-1
  6148     MOVE ' '                      TO DC-OPTION-CODE
  6149     PERFORM 9700-DATE-LINK
  6150     IF NO-CONVERSION-ERROR
  6151        MOVE DC-GREG-DATE-1-EDIT   TO NLFDTO
  6152     END-IF
  6153     MOVE EN-LF-NEW-REF-AMT        TO NLFAMTO
  6154     MOVE EN-AH-NEW-REF-DT         TO DC-BIN-DATE-1
  6155     MOVE ' '                      TO DC-OPTION-CODE
  6156     PERFORM 9700-DATE-LINK
  6157     IF NO-CONVERSION-ERROR
  6158        MOVE DC-GREG-DATE-1-EDIT   TO NAHDTO
  6159     END-IF
  6160     MOVE EN-AH-NEW-REF-AMT        TO NAHAMTO
  6161     MOVE EN-ARCHIVE-NO            TO ARCHNOO
  6162     .
  6163 0390-EXIT.
  6164     EXIT.
  6165 0400-ADD-ERENDT.
  6166     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6167
  6168* EXEC CICS GETMAIN
  6169*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6170*         LENGTH   (ERENDT-LENGTH)
  6171*         INITIMG  (GETMAIN-SPACE)
  6172*    END-EXEC
  6173*    MOVE ',"IL                  $   #00006026' TO DFHEIV0
  6174     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6175     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6176     MOVE X'2020233030303036303236' TO DFHEIV0(25:11)
  6177     CALL 'kxdfhei1' USING DFHEIV0,
  6178           DFHEIV20,
  6179           ERENDT-LENGTH,
  6180           GETMAIN-SPACE
  6181     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6182         DFHEIV20
  6183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6184     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6185     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 109
* EL6316.cbl
  6186     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6187     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6188                                    EN-INPUT-DT
  6189     MOVE OC-LF-CANCEL-DT        TO EN-LF-ORIG-REF-DT
  6190     MOVE OC-AH-CANCEL-DT        TO EN-AH-ORIG-REF-DT
  6191     MOVE OC-LF-CANCEL-AMT       TO EN-LF-ORIG-REF-AMT
  6192     MOVE OC-AH-CANCEL-AMT       TO EN-AH-ORIG-REF-AMT
  6193
  6194     MOVE OC-LF-ITD-CANCEL-AMT   TO NEW-LF-ITD-CANCEL-AMT
  6195     MOVE OC-AH-ITD-CANCEL-AMT   TO NEW-AH-ITD-CANCEL-AMT
  6196
  6197     MOVE OC-INS-LAST-NAME       TO EN-INS-LAST-NAME
  6198     MOVE OC-INS-FIRST-NAME      TO EN-INS-FIRST-NAME
  6199     MOVE OC-INS-MIDDLE-INIT     TO EN-INS-MIDDLE-INIT
  6200
  6201     MOVE OC-LF-COMM-PCT         TO EN-LF-ORIG-REF-COMM-PCT
  6202     MOVE OC-AH-COMM-PCT         TO EN-AH-ORIG-REF-COMM-PCT
  6203
  6204* EXEC CICS READ
  6205*        DATASET   (WS-ERPNDB-FILE-ID)
  6206*        SET       (ADDRESS OF PENDING-BUSINESS)
  6207*        RIDFLD    (PI-ERPNDB-KEY)
  6208*        RESP      (WS-RESPONSE)
  6209*    END-EXEC
  6210*    MOVE '&"S        E          (  N#00006050' TO DFHEIV0
  6211     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6212     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6213     MOVE X'204E233030303036303530' TO DFHEIV0(25:11)
  6214     CALL 'kxdfhei1' USING DFHEIV0,
  6215           WS-ERPNDB-FILE-ID,
  6216           DFHEIV20,
  6217           DFHEIV99,
  6218           PI-ERPNDB-KEY,
  6219           DFHEIV99,
  6220           DFHEIV99,
  6221           DFHEIV99
  6222     SET ADDRESS OF PENDING-BUSINESS TO
  6223         DFHEIV20
  6224     MOVE EIBRESP  TO WS-RESPONSE
  6225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6226     IF NOT RESP-NORMAL
  6227        GO TO 0400-EXIT
  6228     END-IF
  6229     MOVE PB-C-LF-CANCEL-DT      TO EN-LF-NEW-REF-DT
  6230                                    NEW-LF-CANCEL-DT
  6231     MOVE PB-C-AH-CANCEL-DT      TO EN-AH-NEW-REF-DT
  6232                                    NEW-AH-CANCEL-DT
  6233     MOVE PB-C-LF-CANCEL-AMT     TO EN-LF-NEW-REF-AMT
  6234                                    NEW-LF-CANCEL-AMT
  6235     MOVE PB-C-AH-CANCEL-AMT     TO EN-AH-NEW-REF-AMT
  6236                                    NEW-AH-CANCEL-AMT
  6237     MOVE PB-CI-LIFE-COMMISSION  TO EN-LF-COMMISSION
  6238                                    EN-LF-NEW-REF-COMM-PCT
  6239                                    NEW-LF-COMM-PCT
  6240     MOVE PB-CI-AH-COMMISSION    TO EN-AH-COMMISSION
  6241                                    EN-AH-NEW-REF-COMM-PCT
  6242                                    NEW-AH-COMM-PCT
  6243     MOVE LTRIDI                 TO EN-TEMPLATE-USED
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 110
* EL6316.cbl
  6244     MOVE 'C'                    TO EN-DOCU-TYPE
  6245     MOVE 'Y'                    TO EN-MONEY-SW
  6246     MOVE PB-ENTRY-BATCH         TO EN-BATCH-NUMBER
  6247     MOVE W-ACCT-SUMM            TO EN-ACCT-SUMM
  6248     MOVE W-CSO-SUMM             TO EN-CSO-SUMM
  6249     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6250        IF REACD-IN (S1) NOT = LOW-VALUES
  6251           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  6252        END-IF
  6253     END-PERFORM
  6254     PERFORM 0450-GET-ERACCT     THRU 0450-EXIT
  6255
  6256     IF ACCT-FOUND
  6257        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
  6258        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
  6259        IF PB-C-LF-CANCEL-DT > DC-BIN-DATE-2
  6260           MOVE PB-C-LF-CANCEL-DT
  6261                                 TO DC-BIN-DATE-2
  6262        END-IF
  6263        MOVE '1'                 TO DC-OPTION-CODE
  6264        PERFORM 9700-DATE-LINK
  6265        IF NO-CONVERSION-ERROR
  6266           MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  6267           IF DC-ODD-DAYS-OVER > +1
  6268              ADD +1          TO WS-DIFF
  6269           END-IF
  6270        ELSE
  6271            MOVE +0           TO WS-DIFF
  6272        END-IF
  6273     ELSE
  6274        MOVE +0           TO WS-DIFF
  6275     END-IF
  6276
  6277     COMPUTE WS-DUE-BORROWER = (EN-LF-NEW-REF-AMT
  6278         + EN-AH-NEW-REF-AMT)
  6279
  6280     IF (WS-CHGBACK = 99)
  6281         OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  6282          MOVE WS-DUE-BORROWER TO EN-CSO-PORTION
  6283          MOVE ZEROS           TO EN-ACCT-PORTION
  6284          MOVE 'N'             TO EN-COMM-CHGBK
  6285     ELSE
  6286         COMPUTE EN-ACCT-PORTION = (EN-LF-NEW-REF-AMT
  6287                 * EN-LF-COMMISSION) +
  6288                (EN-AH-NEW-REF-AMT * EN-AH-COMMISSION)
  6289         COMPUTE EN-CSO-PORTION = WS-DUE-BORROWER
  6290                 - EN-ACCT-PORTION
  6291         MOVE 'Y'                TO EN-COMM-CHGBK
  6292     END-IF
  6293     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  6294     .
  6295 0400-EXIT.
  6296     EXIT.
  6297 0410-INIT-ERENDT.
  6298     MOVE OC-CONTROL-PRIMARY (1:33) TO ERENDT-KEY (1:33)
  6299     MOVE 'C'                    TO ENDT-RECORD-TYPE
  6300     MOVE ZEROS                  TO ENDT-SEQ-NO
  6301
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 111
* EL6316.cbl
  6302* EXEC CICS READ
  6303*        DATASET    (WS-ERENDT-FILE-ID)
  6304*        RIDFLD     (ERENDT-KEY)
  6305*        SET        (ADDRESS OF ENDORSEMENT-RECORD)
  6306*        RESP       (WS-RESPONSE)
  6307*        GTEQ
  6308*    END-EXEC
  6309*    MOVE '&"S        G          (  N#00006131' TO DFHEIV0
  6310     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6311     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6312     MOVE X'204E233030303036313331' TO DFHEIV0(25:11)
  6313     CALL 'kxdfhei1' USING DFHEIV0,
  6314           WS-ERENDT-FILE-ID,
  6315           DFHEIV20,
  6316           DFHEIV99,
  6317           ERENDT-KEY,
  6318           DFHEIV99,
  6319           DFHEIV99,
  6320           DFHEIV99
  6321     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6322         DFHEIV20
  6323     MOVE EIBRESP  TO WS-RESPONSE
  6324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6325     IF RESP-NORMAL
  6326        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
  6327        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  6328     ELSE
  6329        MOVE +4096               TO WS-SEQ-NO
  6330     END-IF
  6331     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  6332     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  6333     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  6334     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  6335     MOVE WS-CURRENT-BIN-DT      TO EN-PROCESS-DT
  6336     MOVE 'C'                    TO EN-REC-TYPE
  6337     INITIALIZE EN-CANCEL-RECORD
  6338     MOVE ZEROS TO EN-CSO-PORTION EN-ACCT-PORTION
  6339     MOVE LOW-VALUES             TO EN-LF-ORIG-REF-DT
  6340                                    EN-AH-ORIG-REF-DT
  6341                                    EN-LF-NEW-REF-DT
  6342                                    EN-AH-NEW-REF-DT
  6343     .
  6344 0410-EXIT.
  6345     EXIT.
  6346 0420-UPDATE-ELCRTO.
  6347     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  6348     IF RESP-NORMAL
  6349        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  6350                                    OC-LAST-MAINT-DT
  6351        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  6352        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  6353
  6354* EXEC CICS REWRITE
  6355*          FROM     (ORIGINAL-CERTIFICATE)
  6356*          DATASET  ('ELCRTO')
  6357*       END-EXEC
  6358     MOVE LENGTH OF
  6359      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 112
* EL6316.cbl
  6360       TO DFHEIV11
  6361     MOVE 'ELCRTO' TO DFHEIV1
  6362*    MOVE '&& L                  %   #00006166' TO DFHEIV0
  6363     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6364     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6365     MOVE X'2020233030303036313636' TO DFHEIV0(25:11)
  6366     CALL 'kxdfhei1' USING DFHEIV0,
  6367           DFHEIV1,
  6368           ORIGINAL-CERTIFICATE,
  6369           DFHEIV11,
  6370           DFHEIV99
  6371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6372     END-IF
  6373     .
  6374 0420-EXIT.
  6375     EXIT.
  6376
  6377 0425-ADD-NEW-ELCRTO.
  6378     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  6379     MOVE 'OC'                   TO OC-RECORD-ID
  6380     MOVE PI-ELCRTO-KEY          TO OC-CONTROL-PRIMARY
  6381     SUBTRACT +1                 FROM OC-KEY-SEQ-NO
  6382     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  6383     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  6384     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  6385     MOVE NEW-INS-FIRST-NAME     TO OC-INS-FIRST-NAME
  6386     MOVE NEW-INS-MIDDLE-INIT    TO OC-INS-MIDDLE-INIT
  6387     MOVE NEW-INS-LAST-NAME      TO OC-INS-LAST-NAME
  6388     MOVE NEW-INS-AGE            TO OC-INS-AGE
  6389     MOVE NEW-JNT-FIRST-NAME     TO OC-JNT-FIRST-NAME
  6390     MOVE NEW-JNT-MIDDLE-INIT    TO OC-JNT-MIDDLE-INIT
  6391     MOVE NEW-JNT-LAST-NAME      TO OC-JNT-LAST-NAME
  6392     MOVE NEW-JNT-AGE            TO OC-JNT-AGE
  6393     MOVE NEW-LF-BENCD           TO OC-LF-BENCD
  6394     MOVE NEW-LF-BEN-AMT         TO OC-LF-BEN-AMT
  6395     MOVE NEW-LF-PRM-AMT         TO OC-LF-PRM-AMT
  6396     MOVE NEW-LF-ALT-BEN-AMT     TO OC-LF-ALT-BEN-AMT
  6397     MOVE NEW-LF-ALT-PRM-AMT     TO OC-LF-ALT-PRM-AMT
  6398     MOVE NEW-LF-TERM            TO OC-LF-TERM
  6399     MOVE NEW-LF-EXP-DT          TO OC-LF-EXP-DT
  6400     MOVE NEW-LF-COMM-PCT        TO OC-LF-COMM-PCT
  6401     MOVE NEW-LF-CANCEL-DT       TO OC-LF-CANCEL-DT
  6402     MOVE NEW-LF-CANCEL-AMT      TO OC-LF-CANCEL-AMT
  6403     MOVE NEW-AH-BENCD           TO OC-AH-BENCD
  6404     MOVE NEW-AH-BEN-AMT         TO OC-AH-BEN-AMT
  6405     MOVE NEW-AH-PRM-AMT         TO OC-AH-PRM-AMT
  6406     MOVE NEW-AH-TERM            TO OC-AH-TERM
  6407     MOVE NEW-AH-EXP-DT          TO OC-AH-EXP-DT
  6408     MOVE NEW-AH-CP              TO OC-AH-CP
  6409     MOVE NEW-AH-COMM-PCT        TO OC-AH-COMM-PCT
  6410     MOVE NEW-AH-CANCEL-DT       TO OC-AH-CANCEL-DT
  6411     MOVE NEW-AH-CANCEL-AMT      TO OC-AH-CANCEL-AMT
  6412     MOVE NEW-CRED-BENE-NAME     TO OC-CRED-BENE-NAME
  6413     MOVE NEW-1ST-PMT-DT         TO OC-1ST-PMT-DT
  6414     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  6415     .
  6416 0425-WRITE-ELCRTO.
  6417
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 113
* EL6316.cbl
  6418
  6419* EXEC CICS WRITE
  6420*       DATASET   ('ELCRTO')
  6421*       FROM      (ORIGINAL-CERTIFICATE)
  6422*       RIDFLD    (OC-CONTROL-PRIMARY)
  6423*       RESP      (WS-RESPONSE)
  6424*    END-EXEC
  6425     MOVE LENGTH OF
  6426      ORIGINAL-CERTIFICATE
  6427       TO DFHEIV11
  6428     MOVE 'ELCRTO' TO DFHEIV1
  6429*    MOVE '&$ L                  ''  N#00006216' TO DFHEIV0
  6430     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6431     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6432     MOVE X'204E233030303036323136' TO DFHEIV0(25:11)
  6433     CALL 'kxdfhei1' USING DFHEIV0,
  6434           DFHEIV1,
  6435           ORIGINAL-CERTIFICATE,
  6436           DFHEIV11,
  6437           OC-CONTROL-PRIMARY,
  6438           DFHEIV99,
  6439           DFHEIV99
  6440     MOVE EIBRESP  TO WS-RESPONSE
  6441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6442
  6443     display ' just wrote new crto ' ws-response
  6444     IF RESP-DUPKEY
  6445        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  6446        GO TO 0425-WRITE-ELCRTO
  6447     ELSE
  6448        IF NOT RESP-NORMAL
  6449           MOVE -1               TO LTRIDL
  6450           MOVE ER-3830          TO EMI-ERROR
  6451           PERFORM 9900-ERROR-FORMAT
  6452                                 THRU 9900-EXIT
  6453        ELSE
  6454           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  6455        END-IF
  6456     END-IF
  6457
  6458     .
  6459 0425-EXIT.
  6460     EXIT.
  6461
  6462 0426-ADD-CERT-NOTES.
  6463
  6464     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  6465     SET TB-INDX TO 1
  6466
  6467     IF PI-CERTNT1-ENTERED > SPACES
  6468         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6469         MOVE PI-PROCESSOR-ID    TO
  6470                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6471         MOVE EIBTIME            TO
  6472                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6473         MOVE WS-CURRENT-BIN-DT  TO
  6474                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6475         SET TB-INDX UP BY +1
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 114
* EL6316.cbl
  6476     END-IF
  6477
  6478     IF PI-CERTNT2-ENTERED > SPACES
  6479         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6480         MOVE PI-PROCESSOR-ID    TO
  6481                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6482         MOVE EIBTIME            TO
  6483                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6484         MOVE WS-CURRENT-BIN-DT  TO
  6485                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6486         SET TB-INDX UP BY +1
  6487     END-IF
  6488
  6489     IF CERT-NOTE-ENTRIES > SPACES
  6490         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  6491         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6492     END-IF
  6493
  6494     .
  6495 0426-EXIT.
  6496     EXIT.
  6497
  6498 0427-LOAD-CURRENT-CERT-NOTES.
  6499
  6500     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  6501     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
  6502     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  6503     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  6504     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  6505     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  6506     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  6507     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  6508     MOVE '1'                 TO ERCNOT-REC-TYP
  6509     MOVE +0                  TO ERCNOT-SEQ
  6510     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  6511
  6512
  6513* EXEC CICS STARTBR
  6514*         DATASET(WS-ERCNOT-FILE-ID)
  6515*         RIDFLD(ERCNOT-KEY)
  6516*         KEYLENGTH(ERCNOT-START-LENGTH)
  6517*         RESP      (WS-RESPONSE)
  6518*         GENERIC
  6519*         GTEQ
  6520*    END-EXEC.
  6521     MOVE 0
  6522       TO DFHEIV11
  6523*    MOVE '&,   KG    G          &  N#00006292' TO DFHEIV0
  6524     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  6525     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6526     MOVE X'204E233030303036323932' TO DFHEIV0(25:11)
  6527     CALL 'kxdfhei1' USING DFHEIV0,
  6528           WS-ERCNOT-FILE-ID,
  6529           ERCNOT-KEY,
  6530           ERCNOT-START-LENGTH,
  6531           DFHEIV11,
  6532           DFHEIV99
  6533     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 115
* EL6316.cbl
  6534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6535
  6536
  6537     IF NOT RESP-NORMAL
  6538        GO TO 0427-ENDBR
  6539     END-IF.
  6540
  6541 0427-LOOP.
  6542
  6543* EXEC CICS READNEXT
  6544*         SET(ADDRESS OF CERT-NOTE-FILE)
  6545*         DATASET(WS-ERCNOT-FILE-ID)
  6546*         RIDFLD(ERCNOT-KEY)
  6547*    END-EXEC.
  6548     MOVE 0
  6549       TO DFHEIV11
  6550*    MOVE '&.S                   )   #00006306' TO DFHEIV0
  6551     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6552     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6553     MOVE X'2020233030303036333036' TO DFHEIV0(25:11)
  6554     CALL 'kxdfhei1' USING DFHEIV0,
  6555           WS-ERCNOT-FILE-ID,
  6556           DFHEIV20,
  6557           DFHEIV99,
  6558           ERCNOT-KEY,
  6559           DFHEIV99,
  6560           DFHEIV11,
  6561           DFHEIV99,
  6562           DFHEIV99
  6563     SET ADDRESS OF CERT-NOTE-FILE TO
  6564         DFHEIV20
  6565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6566
  6567
  6568     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  6569         GO TO 0427-ENDBR
  6570     END-IF.
  6571
  6572     IF (CZ-CARRIER = SV-CARRIER)
  6573        AND (CZ-GROUPING = SV-GROUPING)
  6574        AND (CZ-STATE = SV-STATE)
  6575        AND (CZ-ACCOUNT = SV-ACCOUNT)
  6576        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  6577        AND (CZ-CERT-NO = SV-CERT-NO)
  6578        AND (CZ-RECORD-TYPE = '1')
  6579          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  6580          MOVE CZ-LAST-MAINT-USER TO
  6581                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6582          MOVE CZ-LAST-MAINT-DT TO
  6583                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6584          MOVE CZ-LAST-MAINT-HHMMSS TO
  6585                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6586          SET TB-INDX UP BY 1
  6587          GO TO 0427-LOOP
  6588     END-IF.
  6589
  6590 0427-ENDBR.
  6591
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 116
* EL6316.cbl
  6592
  6593* EXEC CICS ENDBR
  6594*         DATASET(WS-ERCNOT-FILE-ID)
  6595*    END-EXEC.
  6596     MOVE 0
  6597       TO DFHEIV11
  6598*    MOVE '&2                    $   #00006336' TO DFHEIV0
  6599     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6600     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6601     MOVE X'2020233030303036333336' TO DFHEIV0(25:11)
  6602     CALL 'kxdfhei1' USING DFHEIV0,
  6603           WS-ERCNOT-FILE-ID,
  6604           DFHEIV11,
  6605           DFHEIV99
  6606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6607
  6608
  6609     .
  6610 0427-EXIT.
  6611     EXIT.
  6612
  6613 0430-WRITE-ERENDT.
  6614     DISPLAY ' NO ERRORS, ABOUT TO WRITE ERENDT '
  6615     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  6616     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  6617
  6618* EXEC CICS WRITE
  6619*         DATASET   (WS-ERENDT-FILE-ID)
  6620*         FROM      (ENDORSEMENT-RECORD)
  6621*         RIDFLD    (EN-CONTROL-PRIMARY)
  6622*         RESP      (WS-RESPONSE)
  6623*    END-EXEC
  6624     MOVE LENGTH OF
  6625      ENDORSEMENT-RECORD
  6626       TO DFHEIV11
  6627*    MOVE '&$ L                  ''  N#00006348' TO DFHEIV0
  6628     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6629     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6630     MOVE X'204E233030303036333438' TO DFHEIV0(25:11)
  6631     CALL 'kxdfhei1' USING DFHEIV0,
  6632           WS-ERENDT-FILE-ID,
  6633           ENDORSEMENT-RECORD,
  6634           DFHEIV11,
  6635           EN-CONTROL-PRIMARY,
  6636           DFHEIV99,
  6637           DFHEIV99
  6638     MOVE EIBRESP  TO WS-RESPONSE
  6639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6640     IF RESP-NORMAL
  6641        MOVE 'C'                 TO PI-DOCUMENT-PROCESSED
  6642        display ' good write erendt '
  6643        IF EIBAID = DFHPF4
  6644           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  6645           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  6646           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  6647           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  6648        END-IF
  6649     ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 117
* EL6316.cbl
  6650        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  6651        MOVE -1                  TO LTRIDL
  6652        MOVE ER-0132             TO EMI-ERROR
  6653        MOVE AL-UABON            TO LTRIDA
  6654        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6655     END-IF
  6656     .
  6657 0430-EXIT.
  6658     EXIT.
  6659 0440-ADD-BILLING-NOTE.
  6660     DISPLAY 'ADD BILLING NOTE'
  6661
  6662* EXEC CICS GETMAIN
  6663*         SET      (ADDRESS OF EOB-CODES)
  6664*         LENGTH   (ELEOBC-LENGTH)
  6665*         INITIMG  (GETMAIN-SPACE)
  6666*    END-EXEC
  6667*    MOVE ',"IL                  $   #00006375' TO DFHEIV0
  6668     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6669     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6670     MOVE X'2020233030303036333735' TO DFHEIV0(25:11)
  6671     CALL 'kxdfhei1' USING DFHEIV0,
  6672           DFHEIV20,
  6673           ELEOBC-LENGTH,
  6674           GETMAIN-SPACE
  6675     SET ADDRESS OF EOB-CODES TO
  6676         DFHEIV20
  6677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6678
  6679     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  6680     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  6681     MOVE '5'                    TO WS-EOBC-REC-TYPE
  6682
  6683
  6684* EXEC CICS STARTBR
  6685*        DATASET   ('ELEOBC')
  6686*        RIDFLD    (WS-ELEOBC-KEY)
  6687*        GTEQ
  6688*        RESP      (WS-RESPONSE)
  6689*    END-EXEC
  6690     MOVE 'ELEOBC' TO DFHEIV1
  6691     MOVE 0
  6692       TO DFHEIV11
  6693*    MOVE '&,         G          &  N#00006385' TO DFHEIV0
  6694     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6695     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6696     MOVE X'204E233030303036333835' TO DFHEIV0(25:11)
  6697     CALL 'kxdfhei1' USING DFHEIV0,
  6698           DFHEIV1,
  6699           WS-ELEOBC-KEY,
  6700           DFHEIV99,
  6701           DFHEIV11,
  6702           DFHEIV99
  6703     MOVE EIBRESP  TO WS-RESPONSE
  6704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6705
  6706     IF NOT RESP-NORMAL
  6707        GO TO 0440-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 118
* EL6316.cbl
  6708     END-IF
  6709      .
  6710 0440-READNEXT-ELEOBC.
  6711
  6712
  6713* EXEC CICS READNEXT
  6714*       INTO    (EOB-CODES)
  6715*       DATASET ('ELEOBC')
  6716*       RIDFLD  (WS-ELEOBC-KEY)
  6717*       RESP    (WS-RESPONSE)
  6718*    END-EXEC
  6719     MOVE LENGTH OF
  6720      EOB-CODES
  6721       TO DFHEIV12
  6722     MOVE 'ELEOBC' TO DFHEIV1
  6723     MOVE 0
  6724       TO DFHEIV11
  6725*    MOVE '&.IL                  )  N#00006398' TO DFHEIV0
  6726     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6727     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6728     MOVE X'204E233030303036333938' TO DFHEIV0(25:11)
  6729     CALL 'kxdfhei1' USING DFHEIV0,
  6730           DFHEIV1,
  6731           EOB-CODES,
  6732           DFHEIV12,
  6733           WS-ELEOBC-KEY,
  6734           DFHEIV99,
  6735           DFHEIV11,
  6736           DFHEIV99,
  6737           DFHEIV99
  6738     MOVE EIBRESP  TO WS-RESPONSE
  6739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6740
  6741     IF RESP-NORMAL
  6742         IF EO-RECORD-TYPE NOT = '5'
  6743             GO TO 0440-EXIT
  6744         END-IF
  6745     ELSE
  6746         GO TO 0440-EXIT
  6747     END-IF
  6748
  6749     IF EO-RECORD-TYPE = '5' AND
  6750        EO-EOB-CODE = PI-LTRID-ENTERED
  6751           CONTINUE
  6752     ELSE
  6753         GO TO 0440-READNEXT-ELEOBC
  6754     END-IF
  6755
  6756     DISPLAY 'FOUND BILL NOTE ' EOB-CODES
  6757     MOVE SPACES TO WS-BILLING-NOTE
  6758     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  6759     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  6760     MOVE WS-CURRENT-DT TO WS-BN-DATE
  6761     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  6762
  6763
  6764* EXEC CICS GETMAIN
  6765*         SET      (ADDRESS OF CERTIFICATE-NOTE)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 119
* EL6316.cbl
  6766*         LENGTH   (ERNOTE-LENGTH)
  6767*         INITIMG  (GETMAIN-SPACE)
  6768*    END-EXEC
  6769*    MOVE ',"IL                  $   #00006427' TO DFHEIV0
  6770     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6771     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6772     MOVE X'2020233030303036343237' TO DFHEIV0(25:11)
  6773     CALL 'kxdfhei1' USING DFHEIV0,
  6774           DFHEIV20,
  6775           ERNOTE-LENGTH,
  6776           GETMAIN-SPACE
  6777     SET ADDRESS OF CERTIFICATE-NOTE TO
  6778         DFHEIV20
  6779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6780
  6781     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  6782
  6783
  6784* EXEC CICS READ
  6785*       DATASET    (WS-ERNOTE-FILE-ID)
  6786*       RIDFLD     (WS-ERNOTE-KEY)
  6787*       INTO       (CERTIFICATE-NOTE)
  6788*       RESP       (WS-RESPONSE)
  6789*       UPDATE
  6790*    END-EXEC
  6791     MOVE LENGTH OF
  6792      CERTIFICATE-NOTE
  6793       TO DFHEIV11
  6794*    MOVE '&"IL       EU         (  N#00006435' TO DFHEIV0
  6795     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6796     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6797     MOVE X'204E233030303036343335' TO DFHEIV0(25:11)
  6798     CALL 'kxdfhei1' USING DFHEIV0,
  6799           WS-ERNOTE-FILE-ID,
  6800           CERTIFICATE-NOTE,
  6801           DFHEIV11,
  6802           WS-ERNOTE-KEY,
  6803           DFHEIV99,
  6804           DFHEIV99,
  6805           DFHEIV99
  6806     MOVE EIBRESP  TO WS-RESPONSE
  6807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6808
  6809     IF RESP-NORMAL
  6810       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  6811          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  6812       END-IF
  6813       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  6814          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  6815       END-IF
  6816       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  6817           (NOTE-SUB > +10) OR
  6818           (CN-LINE (NOTE-SUB) (1:20) = WS-BN-NOTE)
  6819       END-PERFORM
  6820       IF CN-LINE (NOTE-SUB) (1:20) = WS-BN-NOTE
  6821
  6822* EXEC CICS UNLOCK
  6823*           DATASET    (WS-ERNOTE-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 120
* EL6316.cbl
  6824*        END-EXEC
  6825*    MOVE '&*                    #   #00006455' TO DFHEIV0
  6826     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  6827     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6828     MOVE X'2020233030303036343535' TO DFHEIV0(25:11)
  6829     CALL 'kxdfhei1' USING DFHEIV0,
  6830           WS-ERNOTE-FILE-ID,
  6831           DFHEIV99
  6832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6833       ELSE
  6834         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  6835           (NOTE-SUB > +10) OR
  6836           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  6837         END-PERFORM
  6838         IF (NOTE-SUB < +11)
  6839           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  6840              NOTE-SUB <= CN-BILLING-END-LINE-NO
  6841                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  6842           ELSE
  6843             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  6844              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  6845                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  6846                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  6847             ELSE
  6848               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  6849                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  6850                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  6851                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  6852               ELSE
  6853                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  6854                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  6855                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  6856                                       CN-BILLING-START-LINE-NO
  6857                 ELSE
  6858                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  6859                 END-IF
  6860               END-IF
  6861             END-IF
  6862           END-IF
  6863           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  6864           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  6865           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  6866
  6867* EXEC CICS REWRITE
  6868*             DATASET    (WS-ERNOTE-FILE-ID)
  6869*             FROM       (CERTIFICATE-NOTE)
  6870*             RESP       (WS-RESPONSE)
  6871*          END-EXEC
  6872     MOVE LENGTH OF
  6873      CERTIFICATE-NOTE
  6874       TO DFHEIV11
  6875*    MOVE '&& L                  %  N#00006491' TO DFHEIV0
  6876     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6877     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6878     MOVE X'204E233030303036343931' TO DFHEIV0(25:11)
  6879     CALL 'kxdfhei1' USING DFHEIV0,
  6880           WS-ERNOTE-FILE-ID,
  6881           CERTIFICATE-NOTE,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 121
* EL6316.cbl
  6882           DFHEIV11,
  6883           DFHEIV99
  6884     MOVE EIBRESP  TO WS-RESPONSE
  6885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6886           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  6887         END-IF
  6888       END-IF
  6889     ELSE
  6890        MOVE SPACES              TO CERTIFICATE-NOTE
  6891        MOVE 'CN'                TO CN-RECORD-ID
  6892        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  6893                                     WS-ERNOTE-KEY
  6894        MOVE 01                  TO CN-BILLING-START-LINE-NO
  6895                                    CN-BILLING-END-LINE-NO
  6896        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  6897        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  6898        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  6899        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  6900
  6901* EXEC CICS WRITE
  6902*          DATASET    (WS-ERNOTE-FILE-ID)
  6903*          FROM       (CERTIFICATE-NOTE)
  6904*          RIDFLD     (WS-ERNOTE-KEY)
  6905*          RESP       (WS-RESPONSE)
  6906*       END-EXEC
  6907     MOVE LENGTH OF
  6908      CERTIFICATE-NOTE
  6909       TO DFHEIV11
  6910*    MOVE '&$ L                  ''  N#00006510' TO DFHEIV0
  6911     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6912     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6913     MOVE X'204E233030303036353130' TO DFHEIV0(25:11)
  6914     CALL 'kxdfhei1' USING DFHEIV0,
  6915           WS-ERNOTE-FILE-ID,
  6916           CERTIFICATE-NOTE,
  6917           DFHEIV11,
  6918           WS-ERNOTE-KEY,
  6919           DFHEIV99,
  6920           DFHEIV99
  6921     MOVE EIBRESP  TO WS-RESPONSE
  6922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6923
  6924        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  6925     END-IF
  6926
  6927     .
  6928 0440-EXIT.
  6929     EXIT.
  6930
  6931
  6932 0442-SQUEEZE-IT-IN.
  6933
  6934     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  6935        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  6936           NOTE-SUB = +10
  6937           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  6938           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  6939             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 122
* EL6316.cbl
  6940             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  6941             MOVE +9 TO NOTE-SUB
  6942           END-IF
  6943        END-PERFORM
  6944     ELSE
  6945        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  6946           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  6947             UNTIL NOTE-SUB = +1
  6948             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  6949             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  6950                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  6951                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  6952                MOVE +2          TO NOTE-SUB
  6953             END-IF
  6954           END-PERFORM
  6955        END-IF
  6956     END-IF
  6957
  6958     .
  6959 0442-EXIT.
  6960     EXIT.
  6961
  6962 0445-CERTIFICATE-UPDATE.
  6963    display 'billing note written, updating cert'
  6964     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  6965     IF RESP-NORMAL
  6966        EVALUATE CM-NOTE-SW
  6967           WHEN '2'
  6968           WHEN '3'
  6969           WHEN '6'
  6970           WHEN '7'
  6971              SET NO-CERT-RW     TO TRUE
  6972           WHEN ' '
  6973              MOVE '2'           TO CM-NOTE-SW
  6974           WHEN '1'
  6975              MOVE '3'           TO CM-NOTE-SW
  6976           WHEN '4'
  6977              MOVE '6'           TO CM-NOTE-SW
  6978           WHEN '5'
  6979              MOVE '7'           TO CM-NOTE-SW
  6980        END-EVALUATE
  6981     END-IF
  6982     IF NOT NO-CERT-RW
  6983        PERFORM 1810-REWRITE-ELCERT
  6984                                 THRU 1810-EXIT
  6985     ELSE
  6986
  6987* EXEC CICS UNLOCK
  6988*          DATASET    (WS-ELCERT-FILE-ID)
  6989*       END-EXEC
  6990*    MOVE '&*                    #   #00006579' TO DFHEIV0
  6991     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  6992     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6993     MOVE X'2020233030303036353739' TO DFHEIV0(25:11)
  6994     CALL 'kxdfhei1' USING DFHEIV0,
  6995           WS-ELCERT-FILE-ID,
  6996           DFHEIV99
  6997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 123
* EL6316.cbl
  6998     END-IF
  6999
  7000     .
  7001 0445-EXIT.
  7002     EXIT.
  7003
  7004 0450-GET-ERACCT.
  7005     DISPLAY ' MADE IT TO 0450 '
  7006     MOVE ' '                    TO WS-ERACCT-SW
  7007     MOVE ZEROS                  TO WS-CHGBACK
  7008                                    WS-CSO-PORTION
  7009                                    WS-ACCT-PORTION
  7010                                    WS-DIFF
  7011     PERFORM 0460-STARTBR-ERACCT THRU 0460-EXIT
  7012     IF RESP-NORMAL
  7013        DISPLAY ' GOOD STARTBR '
  7014        PERFORM 0470-READNEXT-ERACCT
  7015                                 THRU 0470-EXIT
  7016     END-IF
  7017     IF RESP-NORMAL
  7018        DISPLAY ' GOOD READNEXT '
  7019        IF AM-CONTROL-PRIMARY (1:20) = EN-CONTROL-PRIMARY (1:20)
  7020           IF (EN-CERT-EFF-DT < AM-EXPIRATION-DT)
  7021              AND (EN-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  7022              DISPLAY ' SETTING ACCT FOUND TO TRUE '
  7023              SET ACCT-FOUND TO TRUE
  7024           ELSE
  7025              PERFORM 0470-READNEXT-ERACCT
  7026                                 THRU 0470-EXIT
  7027              IF RESP-NORMAL
  7028                 IF AM-CONTROL-PRIMARY (1:20)
  7029                    = EN-CONTROL-PRIMARY (1:20)
  7030                    IF (EN-CERT-EFF-DT < AM-EXPIRATION-DT)
  7031                       AND (EN-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  7032                       DISPLAY ' SETTING ACCT FOUND TO TRUE '
  7033                       SET ACCT-FOUND TO TRUE
  7034                    END-IF
  7035                 END-IF
  7036              END-IF
  7037           END-IF
  7038        END-IF
  7039     END-IF
  7040     IF ACCT-FOUND
  7041        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  7042           (AM-COM-TYP (S1) = 'C' OR 'D')
  7043           OR (S1 > +10)
  7044        END-PERFORM
  7045        IF S1 < +11
  7046           MOVE AM-COMM-CHARGEBACK (S1)
  7047                                 TO WS-CHGBACK
  7048        END-IF
  7049     END-IF
  7050
  7051* EXEC CICS ENDBR
  7052*        DATASET     ('ERACCT')
  7053*    END-EXEC.
  7054     MOVE 'ERACCT' TO DFHEIV1
  7055     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 124
* EL6316.cbl
  7056       TO DFHEIV11
  7057*    MOVE '&2                    $   #00006634' TO DFHEIV0
  7058     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7059     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7060     MOVE X'2020233030303036363334' TO DFHEIV0(25:11)
  7061     CALL 'kxdfhei1' USING DFHEIV0,
  7062           DFHEIV1,
  7063           DFHEIV11,
  7064           DFHEIV99
  7065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7066
  7067    .
  7068 0450-EXIT.
  7069     EXIT.
  7070 0460-STARTBR-ERACCT.
  7071     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  7072     MOVE EN-CONTROL-PRIMARY     TO WS-ERACCT-KEY (1:22)
  7073     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  7074
  7075* EXEC CICS STARTBR
  7076*        DATASET   ('ERACCT')
  7077*        RIDFLD    (WS-ERACCT-KEY)
  7078*        GTEQ
  7079*        RESP      (WS-RESPONSE)
  7080*    END-EXEC
  7081     MOVE 'ERACCT' TO DFHEIV1
  7082     MOVE 0
  7083       TO DFHEIV11
  7084*    MOVE '&,         G          &  N#00006644' TO DFHEIV0
  7085     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7086     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7087     MOVE X'204E233030303036363434' TO DFHEIV0(25:11)
  7088     CALL 'kxdfhei1' USING DFHEIV0,
  7089           DFHEIV1,
  7090           WS-ERACCT-KEY,
  7091           DFHEIV99,
  7092           DFHEIV11,
  7093           DFHEIV99
  7094     MOVE EIBRESP  TO WS-RESPONSE
  7095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7096     .
  7097 0460-EXIT.
  7098     EXIT.
  7099 0470-READNEXT-ERACCT.
  7100
  7101* EXEC CICS READNEXT
  7102*       SET      (ADDRESS OF ACCOUNT-MASTER)
  7103*       DATASET ('ERACCT')
  7104*       RIDFLD  (WS-ERACCT-KEY)
  7105*       RESP    (WS-RESPONSE)
  7106*    END-EXEC
  7107     MOVE 'ERACCT' TO DFHEIV1
  7108     MOVE 0
  7109       TO DFHEIV11
  7110*    MOVE '&.S                   )  N#00006654' TO DFHEIV0
  7111     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7112     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7113     MOVE X'204E233030303036363534' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 125
* EL6316.cbl
  7114     CALL 'kxdfhei1' USING DFHEIV0,
  7115           DFHEIV1,
  7116           DFHEIV20,
  7117           DFHEIV99,
  7118           WS-ERACCT-KEY,
  7119           DFHEIV99,
  7120           DFHEIV11,
  7121           DFHEIV99,
  7122           DFHEIV99
  7123     SET ADDRESS OF ACCOUNT-MASTER TO
  7124         DFHEIV20
  7125     MOVE EIBRESP  TO WS-RESPONSE
  7126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7127     .
  7128 0470-EXIT.
  7129     EXIT.
  7130 0491-ERNOTE-READ-UPDATE.
  7131
  7132* EXEC CICS READ
  7133*       UPDATE
  7134*       DATASET    (WS-ERNOTE-FILE-ID)
  7135*       RIDFLD     (WS-ERNOTE-KEY)
  7136*       SET        (ADDRESS OF CERTIFICATE-NOTE)
  7137*       RESP       (WS-RESPONSE)
  7138*    END-EXEC
  7139*    MOVE '&"S        EU         (  N#00006664' TO DFHEIV0
  7140     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7141     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7142     MOVE X'204E233030303036363634' TO DFHEIV0(25:11)
  7143     CALL 'kxdfhei1' USING DFHEIV0,
  7144           WS-ERNOTE-FILE-ID,
  7145           DFHEIV20,
  7146           DFHEIV99,
  7147           WS-ERNOTE-KEY,
  7148           DFHEIV99,
  7149           DFHEIV99,
  7150           DFHEIV99
  7151     SET ADDRESS OF CERTIFICATE-NOTE TO
  7152         DFHEIV20
  7153     MOVE EIBRESP  TO WS-RESPONSE
  7154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7155     .
  7156 0491-EXIT.
  7157     EXIT.
  7158 0492-REWRITE-ERNOTE.
  7159     MOVE 'E631'              TO CN-LAST-MAINT-USER
  7160     MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7161     MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7162
  7163* EXEC CICS REWRITE
  7164*       DATASET    (WS-ERNOTE-FILE-ID)
  7165*       FROM       (CERTIFICATE-NOTE)
  7166*       RESP       (WS-RESPONSE)
  7167*    END-EXEC
  7168     MOVE LENGTH OF
  7169      CERTIFICATE-NOTE
  7170       TO DFHEIV11
  7171*    MOVE '&& L                  %  N#00006678' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 126
* EL6316.cbl
  7172     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7173     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7174     MOVE X'204E233030303036363738' TO DFHEIV0(25:11)
  7175     CALL 'kxdfhei1' USING DFHEIV0,
  7176           WS-ERNOTE-FILE-ID,
  7177           CERTIFICATE-NOTE,
  7178           DFHEIV11,
  7179           DFHEIV99
  7180     MOVE EIBRESP  TO WS-RESPONSE
  7181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7182     .
  7183 0492-EXIT.
  7184     EXIT.
  7185 0493-SQUEEZE-ERNOTE.
  7186     IF CN-BILLING-START-LINE-NO > 0
  7187         MOVE CN-BILLING-START-LINE-NO TO NOTE-SUB
  7188     ELSE
  7189         MOVE +1                 TO NOTE-SUB
  7190     END-IF.
  7191
  7192     PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7193        (NOTE-SUB > +9)
  7194        IF CN-LINE (NOTE-SUB) = SPACES
  7195           MOVE CN-LINE (NOTE-SUB + +1)
  7196                                 TO CN-LINE (NOTE-SUB)
  7197           MOVE SPACES           TO CN-LINE (NOTE-SUB + +1)
  7198        END-IF
  7199     END-PERFORM
  7200     .
  7201 0493-EXIT.
  7202     EXIT.
  7203 0500-ERENDT-READ-GTEQ.
  7204
  7205* EXEC CICS READ
  7206*        DATASET    (WS-ERENDT-FILE-ID)
  7207*        RIDFLD     (ERENDT-KEY)
  7208*        SET        (ADDRESS OF ENDORSEMENT-RECORD)
  7209*        RESP       (WS-RESPONSE)
  7210*        GTEQ
  7211*    END-EXEC
  7212*    MOVE '&"S        G          (  N#00006705' TO DFHEIV0
  7213     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7214     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7215     MOVE X'204E233030303036373035' TO DFHEIV0(25:11)
  7216     CALL 'kxdfhei1' USING DFHEIV0,
  7217           WS-ERENDT-FILE-ID,
  7218           DFHEIV20,
  7219           DFHEIV99,
  7220           ERENDT-KEY,
  7221           DFHEIV99,
  7222           DFHEIV99,
  7223           DFHEIV99
  7224     SET ADDRESS OF ENDORSEMENT-RECORD TO
  7225         DFHEIV20
  7226     MOVE EIBRESP  TO WS-RESPONSE
  7227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7228     IF NOT RESP-NORMAL
  7229        MOVE ER-2237             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 127
* EL6316.cbl
  7230        PERFORM 9900-ERROR-FORMAT
  7231                                 THRU 9900-EXIT
  7232        MOVE -1                  TO CARRL
  7233        GO TO 8200-SEND-DATAONLY
  7234     END-IF
  7235     .
  7236 0500-EXIT.
  7237     EXIT.
  7238 0510-ERENDT-READNEXT.
  7239
  7240* EXEC CICS READNEXT
  7241*       DATASET    (WS-ERENDT-FILE-ID)
  7242*       RIDFLD     (ERENDT-KEY)
  7243*       SET        (ADDRESS OF ENDORSEMENT-RECORD)
  7244*       RESP       (WS-RESPONSE)
  7245*    END-EXEC
  7246     MOVE 0
  7247       TO DFHEIV11
  7248*    MOVE '&.S                   )  N#00006723' TO DFHEIV0
  7249     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7250     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7251     MOVE X'204E233030303036373233' TO DFHEIV0(25:11)
  7252     CALL 'kxdfhei1' USING DFHEIV0,
  7253           WS-ERENDT-FILE-ID,
  7254           DFHEIV20,
  7255           DFHEIV99,
  7256           ERENDT-KEY,
  7257           DFHEIV99,
  7258           DFHEIV11,
  7259           DFHEIV99,
  7260           DFHEIV99
  7261     SET ADDRESS OF ENDORSEMENT-RECORD TO
  7262         DFHEIV20
  7263     MOVE EIBRESP  TO WS-RESPONSE
  7264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7265     IF NOT RESP-NORMAL
  7266        MOVE ER-2237             TO EMI-ERROR
  7267        PERFORM 9900-ERROR-FORMAT
  7268                                 THRU 9900-EXIT
  7269        MOVE -1                  TO CARRL
  7270        GO TO 8200-SEND-DATAONLY
  7271     END-IF
  7272     .
  7273 0510-EXIT.
  7274     EXIT.
  7275 0520-ERENDT-STARTBR.
  7276
  7277* EXEC CICS STARTBR
  7278*       DATASET    (WS-ERENDT-FILE-ID)
  7279*       RIDFLD     (ERENDT-KEY)
  7280*       RESP       (WS-RESPONSE)
  7281*    END-EXEC
  7282     MOVE 0
  7283       TO DFHEIV11
  7284*    MOVE '&,         G          &  N#00006740' TO DFHEIV0
  7285     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7286     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7287     MOVE X'204E233030303036373430' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 128
* EL6316.cbl
  7288     CALL 'kxdfhei1' USING DFHEIV0,
  7289           WS-ERENDT-FILE-ID,
  7290           ERENDT-KEY,
  7291           DFHEIV99,
  7292           DFHEIV11,
  7293           DFHEIV99
  7294     MOVE EIBRESP  TO WS-RESPONSE
  7295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7296     IF NOT RESP-NORMAL
  7297        MOVE ER-2237             TO EMI-ERROR
  7298        PERFORM 9900-ERROR-FORMAT
  7299                                 THRU 9900-EXIT
  7300        MOVE -1                  TO CARRL
  7301        GO TO 8200-SEND-DATAONLY
  7302     END-IF
  7303     .
  7304 0520-EXIT.
  7305     EXIT.
  7306 0530-ERENDT-READPREV.
  7307
  7308* EXEC CICS READPREV
  7309*       DATASET    (WS-ERENDT-FILE-ID)
  7310*       RIDFLD     (ERENDT-KEY)
  7311*       SET        (ADDRESS OF ENDORSEMENT-RECORD)
  7312*       RESP       (WS-RESPONSE)
  7313*    END-EXEC
  7314     MOVE 0
  7315       TO DFHEIV11
  7316*    MOVE '&0S                   )  N#00006756' TO DFHEIV0
  7317     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  7318     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7319     MOVE X'204E233030303036373536' TO DFHEIV0(25:11)
  7320     CALL 'kxdfhei1' USING DFHEIV0,
  7321           WS-ERENDT-FILE-ID,
  7322           DFHEIV20,
  7323           DFHEIV99,
  7324           ERENDT-KEY,
  7325           DFHEIV99,
  7326           DFHEIV11,
  7327           DFHEIV99,
  7328           DFHEIV99
  7329     SET ADDRESS OF ENDORSEMENT-RECORD TO
  7330         DFHEIV20
  7331     MOVE EIBRESP  TO WS-RESPONSE
  7332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7333     IF NOT RESP-NORMAL
  7334        MOVE ER-2238             TO EMI-ERROR
  7335        PERFORM 9900-ERROR-FORMAT
  7336                                 THRU 9900-EXIT
  7337        MOVE -1                  TO CARRL
  7338        GO TO 8200-SEND-DATAONLY
  7339     END-IF
  7340     .
  7341 0530-EXIT.
  7342     EXIT.
  7343 0600-CREATE-TEMP-STORAGE.
  7344
  7345* EXEC CICS WRITEQ TS
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 129
* EL6316.cbl
  7346*        QUEUE (QID)
  7347*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7348*        LENGTH(PI-COMM-LENGTH)
  7349*    END-EXEC
  7350*    MOVE '*"                    ''   #00006773' TO DFHEIV0
  7351     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7352     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7353     MOVE X'2020233030303036373733' TO DFHEIV0(25:11)
  7354     CALL 'kxdfhei1' USING DFHEIV0,
  7355           QID,
  7356           PROGRAM-INTERFACE-BLOCK,
  7357           PI-COMM-LENGTH,
  7358           DFHEIV99,
  7359           DFHEIV99,
  7360           DFHEIV99
  7361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7362     display ' about to write map ' el631ii
  7363
  7364* EXEC CICS WRITEQ TS
  7365*        QUEUE (QID)
  7366*        FROM  (EL631II)
  7367*        LENGTH(MAP-LENGTH)
  7368*    END-EXEC.
  7369*    MOVE '*"                    ''   #00006779' TO DFHEIV0
  7370     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7371     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7372     MOVE X'2020233030303036373739' TO DFHEIV0(25:11)
  7373     CALL 'kxdfhei1' USING DFHEIV0,
  7374           QID,
  7375           EL631II,
  7376           MAP-LENGTH,
  7377           DFHEIV99,
  7378           DFHEIV99,
  7379           DFHEIV99
  7380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7381
  7382 0600-EXIT.
  7383      EXIT.
  7384 0610-RECOVER-TEMP-STORAGE.
  7385
  7386* EXEC CICS READQ TS
  7387*        QUEUE (QID)
  7388*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7389*        LENGTH(PI-COMM-LENGTH)
  7390*    END-EXEC
  7391*    MOVE '*$I    L              ''   #00006787' TO DFHEIV0
  7392     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7393     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7394     MOVE X'2020233030303036373837' TO DFHEIV0(25:11)
  7395     CALL 'kxdfhei1' USING DFHEIV0,
  7396           QID,
  7397           PROGRAM-INTERFACE-BLOCK,
  7398           PI-COMM-LENGTH,
  7399           DFHEIV99,
  7400           DFHEIV99,
  7401           DFHEIV99
  7402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7403
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 130
* EL6316.cbl
  7404* EXEC CICS READQ TS
  7405*        QUEUE (QID)
  7406*        INTO  (EL631II)
  7407*        LENGTH(MAP-LENGTH)
  7408*    END-EXEC
  7409*    MOVE '*$I    L              ''   #00006792' TO DFHEIV0
  7410     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7411     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7412     MOVE X'2020233030303036373932' TO DFHEIV0(25:11)
  7413     CALL 'kxdfhei1' USING DFHEIV0,
  7414           QID,
  7415           EL631II,
  7416           MAP-LENGTH,
  7417           DFHEIV99,
  7418           DFHEIV99,
  7419           DFHEIV99
  7420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7421     display ' map ' EL631II
  7422     PERFORM 0620-DELETE-TS THRU 0620-EXIT
  7423     MOVE AL-UANON            TO LTRIDA
  7424     IF WS-SET-CODES-MDT = 'Y'
  7425        move +1                  to s2
  7426        perform varying s1 from +1 by +5 until s1 > +60
  7427           MOVE WS-PASSED-REASON-CODES (s1:4)
  7428                                 TO reacd-in (s2)
  7429           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7430               MOVE AL-SANON     TO REACDA (S2)
  7431               MOVE +4           TO REACDL (S2)
  7432           END-IF
  7433           add +1                to s2
  7434        end-perform
  7435        MOVE REASONCDS       TO PI-REASONS-ENTERED
  7436     END-IF
  7437
  7438     IF CRTNT1I > SPACES
  7439         MOVE AL-UANON       TO CRTNT1A
  7440     END-IF
  7441
  7442     IF CRTNT2I > SPACES
  7443         MOVE AL-UANON       TO CRTNT2A
  7444     END-IF
  7445     .
  7446 0610-EXIT.
  7447      EXIT.
  7448 0620-DELETE-TS.
  7449
  7450* EXEC CICS DELETEQ TS
  7451*        QUEUE(QID)
  7452*    END-EXEC
  7453*    MOVE '*&                    #   #00006825' TO DFHEIV0
  7454     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7455     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7456     MOVE X'2020233030303036383235' TO DFHEIV0(25:11)
  7457     CALL 'kxdfhei1' USING DFHEIV0,
  7458           QID,
  7459           DFHEIV99
  7460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7461     .
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 131
* EL6316.cbl
  7462 0620-EXIT.
  7463      EXIT.
  7464 1000-FINALIZE.
  7465     PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  7466     IF NOT EMI-NO-ERRORS
  7467      AND EIBAID = DFHPF4
  7468        GO TO 8200-SEND-DATAONLY
  7469     END-IF
  7470     display ' made it to 1000 '
  7471     set P to address of KIXSYS
  7472     CALL "getenv" using by value P returning var-ptr
  7473     if var-ptr = null then
  7474        display ' kixsys not set '
  7475     else
  7476        set address of var to var-ptr
  7477        move 0 to env-var-len
  7478        inspect var tallying env-var-len
  7479          for characters before X'00'
  7480*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  7481        unstring var (1:env-var-len) delimited by '/'
  7482           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  7483              WS-KIX-SYS
  7484        end-unstring
  7485*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  7486*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  7487     end-if
  7488     set P to address of KIXHOST
  7489     CALL "getenv" using by value P returning var-ptr
  7490     if var-ptr = null then
  7491        display ' kixhost not set '
  7492     else
  7493        set address of var to var-ptr
  7494        move 0 to env-var-len
  7495        inspect var tallying env-var-len
  7496          for characters before X'00'
  7497*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  7498        MOVE var(1:env-var-len)  to ws-kixhost
  7499        DISPLAY ' WS KIX HOST ' WS-KIXhost
  7500     end-if
  7501     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  7502     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  7503     IF RESP-NORMAL
  7504        AND (PI-ELCRTO-KEY (1:33) =
  7505              OC-CONTROL-PRIMARY (1:33))
  7506           DISPLAY ' RESP NORMAL AND = '
  7507           MOVE OC-ORIG-REC         TO NEW-ORIG-REC
  7508           PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  7509           PERFORM 1100-CALL-NS-BUS-LOGIC
  7510                                    THRU 1100-EXIT
  7511           IF BL-OK
  7512              CONTINUE
  7513           ELSE
  7514              MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  7515              MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  7516              MOVE -1               TO CARRL
  7517           END-IF
  7518     ELSE
  7519        MOVE ER-3829             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 132
* EL6316.cbl
  7520        PERFORM 9900-ERROR-FORMAT
  7521                                 THRU 9900-EXIT
  7522        MOVE -1                  TO CARRL
  7523        GO TO 8100-SEND-INITIAL-MAP
  7524     END-IF
  7525     PERFORM 0390-BUILD-FROM-ERENDT THRU 0390-EXIT
  7526     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  7527                                 TO SYSO
  7528     MOVE WS-KIXHOST             TO HOSTO
  7529     MOVE PI-COMPANY-ID          TO COMPANYO
  7530     MOVE PI-PROCESSOR-ID        TO PROCIDO
  7531     MOVE '4'                    TO DATASORO
  7532     MOVE BL-BATCH-NO            TO BATCHNOO
  7533     MOVE BL-BATCH-SEQ           TO BSEQNOO
  7534     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  7535*    MOVE -1                     TO PRTSWL
  7536*    MOVE AL-UANON               TO PRTSWA
  7537     IF EIBAID = DFHPF4
  7538        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  7539        MOVE ER-0280             TO EMI-ERROR
  7540        PERFORM 9900-ERROR-FORMAT
  7541                                 THRU 9900-EXIT
  7542        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  7543        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  7544        MOVE 'Y'                 TO PI-FINALIZED-IND
  7545        GO TO 9400-CLEAR
  7546     ELSE
  7547        MOVE ER-1818             TO EMI-ERROR
  7548        PERFORM 9900-ERROR-FORMAT
  7549                                 THRU 9900-EXIT
  7550     END-IF
  7551     GO TO 8100-SEND-INITIAL-MAP
  7552     .
  7553 1000-EXIT.
  7554     EXIT.
  7555 1100-CALL-NS-BUS-LOGIC.
  7556     DISPLAY ' MADE IT TO 1100 ' w-arch-number
  7557     MOVE SPACES                 TO BL-INPUT
  7558     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  7559     MOVE '4'                    TO BL-DATA-SRCE
  7560     MOVE PB-CARRIER             TO BL-CARRIER
  7561     MOVE PB-GROUPING            TO BL-GROUP
  7562     MOVE PB-STATE               TO BL-STATE
  7563     MOVE PB-ACCOUNT             TO BL-ACCOUNT
  7564     IF PB-CERT-EFF-DT NOT = LOW-VALUES
  7565        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
  7566        MOVE ' '                 TO DC-OPTION-CODE
  7567        PERFORM 9700-date-link
  7568        IF NO-CONVERSION-ERROR
  7569           MOVE DC-GREG-DATE-B-EDIT
  7570                                 TO BL-EFF-DT
  7571        END-IF
  7572     END-IF
  7573     MOVE PB-CERT-NO             TO BL-CERT-NO
  7574     MOVE PB-ENTRY-BATCH         TO BL-BATCH-NO
  7575     MOVE PB-BATCH-SEQ-NO        TO BL-BATCH-SEQ
  7576     MOVE SPACES                 TO BL-RESP-NO
  7577     MOVE LTRIDI                 TO BL-LETTER-ID
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 133
* EL6316.cbl
  7578     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  7579     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  7580*    MOVE 'ALWA'                 TO BL-PROC-ID
  7581     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  7582     IF EIBAID = DFHPF4
  7583        MOVE 'B'                 TO BL-WRITE-ERARCH
  7584     ELSE
  7585        MOVE 'T'                 TO BL-WRITE-ERARCH
  7586     END-IF
  7587     MOVE SPACES                 TO BL-CERT-FORM-ID
  7588     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  7589     MOVE 'CAN ENDT'             TO BL-SOURCE-SCREEN
  7590     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  7591        IF REACD-IN (S1) NOT = LOW-VALUES
  7592           MOVE REACD-IN (S1)    TO BL-REASON-CODE (S1)
  7593        END-IF
  7594     END-PERFORM
  7595    DISPLAY ' ABOUT TO LINK TO NSRASBL '
  7596     DISPLAY ' BL INPUT ' BL-INPUT
  7597*****************************************
  7598* Invoke the LETTER business logic
  7599*****************************************
  7600     MOVE FUNCTION LENGTH(SRCH-COMMAREA) TO WS-COMM-LENGTH
  7601     display ' srch commarea ' srch-commarea
  7602     display ' length ' ws-comm-length
  7603
  7604* exec cics link
  7605*       program('NSRASBL')
  7606*       commarea(srch-commarea)
  7607*       LENGTH  (WS-COMM-LENGTH)
  7608*    end-exec.
  7609     MOVE 'NSRASBL' TO DFHEIV1
  7610*    MOVE '."C                   (   #00006970' TO DFHEIV0
  7611     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7612     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7613     MOVE X'2020233030303036393730' TO DFHEIV0(25:11)
  7614     CALL 'kxdfhei1' USING DFHEIV0,
  7615           DFHEIV1,
  7616           srch-commarea,
  7617           WS-COMM-LENGTH,
  7618           DFHEIV99,
  7619           DFHEIV99,
  7620           DFHEIV99,
  7621           DFHEIV99
  7622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7623
  7624     DISPLAY ' MADE IT BACK FROM NSRASBL ' BL-STATUS ' '
  7625        BL-MESSAGE
  7626     .
  7627 1100-EXIT.
  7628     EXIT.
  7629 1500-GET-ARCH-NO.
  7630     display ' made it to 1500 '
  7631     MOVE SPACES                 TO ELCNTL-KEY
  7632     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  7633     MOVE '1'                    TO CNTL-REC-TYPE
  7634     MOVE ZEROS                  TO CNTL-SEQ
  7635
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 134
* EL6316.cbl
  7636* EXEC CICS READ
  7637*         DATASET    (WS-ELCNTL-FILE-ID)
  7638*         SET        (ADDRESS OF CONTROL-FILE)
  7639*         RIDFLD     (ELCNTL-KEY)
  7640*         UPDATE
  7641*         RESP       (WS-RESPONSE)
  7642*    END-EXEC
  7643*    MOVE '&"S        EU         (  N#00006986' TO DFHEIV0
  7644     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7645     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7646     MOVE X'204E233030303036393836' TO DFHEIV0(25:11)
  7647     CALL 'kxdfhei1' USING DFHEIV0,
  7648           WS-ELCNTL-FILE-ID,
  7649           DFHEIV20,
  7650           DFHEIV99,
  7651           ELCNTL-KEY,
  7652           DFHEIV99,
  7653           DFHEIV99,
  7654           DFHEIV99
  7655     SET ADDRESS OF CONTROL-FILE TO
  7656         DFHEIV20
  7657     MOVE EIBRESP  TO WS-RESPONSE
  7658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7659     IF RESP-NORMAL
  7660        display ' good read elcntl '
  7661        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7662           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7663        END-IF
  7664        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7665        MOVE CF-CREDIT-LAST-ARCH-NUM
  7666                                 TO W-ARCH-NUMBER
  7667        display ' new arch number ' w-arch-number
  7668
  7669* EXEC CICS REWRITE
  7670*          FROM      (CONTROL-FILE)
  7671*          DATASET   (WS-ELCNTL-FILE-ID)
  7672*       END-EXEC
  7673     MOVE LENGTH OF
  7674      CONTROL-FILE
  7675       TO DFHEIV11
  7676*    MOVE '&& L                  %   #00007002' TO DFHEIV0
  7677     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7678     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7679     MOVE X'2020233030303037303032' TO DFHEIV0(25:11)
  7680     CALL 'kxdfhei1' USING DFHEIV0,
  7681           WS-ELCNTL-FILE-ID,
  7682           CONTROL-FILE,
  7683           DFHEIV11,
  7684           DFHEIV99
  7685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7686     END-IF
  7687     .
  7688 1500-EXIT.
  7689     EXIT.
  7690
  7691
  7692 1700-WRITE-CERT-NOTE      SECTION.
  7693
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 135
* EL6316.cbl
  7694     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  7695     MOVE ZERO           TO ERCNOT-SEQ.
  7696     SET TB-INDX         DOWN BY 1.
  7697     SET TB-INDX1        TO TB-INDX.
  7698
  7699****DELETE CURRENT CERT NOTES
  7700 1700-LOOP.
  7701
  7702* EXEC CICS READ
  7703*        DATASET (WS-ERCNOT-FILE-ID)
  7704*        RIDFLD  (ERCNOT-KEY)
  7705*        SET     (ADDRESS OF CERT-NOTE-FILE)
  7706*        RESP    (WS-RESPONSE)
  7707*        GTEQ
  7708*    END-EXEC.
  7709*    MOVE '&"S        G          (  N#00007021' TO DFHEIV0
  7710     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7711     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7712     MOVE X'204E233030303037303231' TO DFHEIV0(25:11)
  7713     CALL 'kxdfhei1' USING DFHEIV0,
  7714           WS-ERCNOT-FILE-ID,
  7715           DFHEIV20,
  7716           DFHEIV99,
  7717           ERCNOT-KEY,
  7718           DFHEIV99,
  7719           DFHEIV99,
  7720           DFHEIV99
  7721     SET ADDRESS OF CERT-NOTE-FILE TO
  7722         DFHEIV20
  7723     MOVE EIBRESP  TO WS-RESPONSE
  7724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7725
  7726
  7727     IF NOT RESP-NORMAL
  7728        GO TO 1700-ENDDEL
  7729     END-IF
  7730
  7731     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  7732
  7733     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  7734         GO TO 1700-ENDDEL
  7735     END-IF.
  7736
  7737
  7738* EXEC CICS DELETE
  7739*        DATASET (WS-ERCNOT-FILE-ID)
  7740*        RIDFLD  (ERCNOT-KEY)
  7741*    END-EXEC.
  7742*    MOVE '&(  R                 &   #00007039' TO DFHEIV0
  7743     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  7744     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7745     MOVE X'2020233030303037303339' TO DFHEIV0(25:11)
  7746     CALL 'kxdfhei1' USING DFHEIV0,
  7747           WS-ERCNOT-FILE-ID,
  7748           ERCNOT-KEY,
  7749           DFHEIV99,
  7750           DFHEIV99,
  7751           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 136
* EL6316.cbl
  7752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7753
  7754
  7755     GO TO 1700-LOOP.
  7756
  7757 1700-ENDDEL.
  7758
  7759
  7760* EXEC CICS GETMAIN
  7761*         LENGTH(ERCNOT-LENGTH)
  7762*         SET(ADDRESS OF CERT-NOTE-FILE)
  7763*         INITIMG(GETMAIN-SPACE)
  7764*    END-EXEC.
  7765*    MOVE ',"IL                  $   #00007048' TO DFHEIV0
  7766     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7767     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7768     MOVE X'2020233030303037303438' TO DFHEIV0(25:11)
  7769     CALL 'kxdfhei1' USING DFHEIV0,
  7770           DFHEIV20,
  7771           ERCNOT-LENGTH,
  7772           GETMAIN-SPACE
  7773     SET ADDRESS OF CERT-NOTE-FILE TO
  7774         DFHEIV20
  7775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7776
  7777
  7778     SET TB-INDX TO 1.
  7779     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  7780     MOVE +0             TO ERCNOT-SEQ
  7781
  7782     PERFORM VARYING TB-INDX FROM 1 BY 1
  7783             UNTIL TB-INDX > TB-INDX1
  7784        MOVE SPACES                 TO  CERT-NOTE-FILE
  7785        ADD 1                       TO  ERCNOT-SEQ
  7786        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  7787        MOVE  'CZ'                  TO  CZ-RECORD-ID
  7788        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  7789        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  7790                                    TO  CZ-LAST-MAINT-USER
  7791        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7792                                    TO  CZ-LAST-MAINT-HHMMSS
  7793        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  7794                                    TO  CZ-LAST-MAINT-DT
  7795
  7796
  7797* EXEC CICS WRITE
  7798*            DATASET(WS-ERCNOT-FILE-ID)
  7799*            FROM(CERT-NOTE-FILE)
  7800*            RIDFLD(ERCNOT-KEY)
  7801*       END-EXEC
  7802     MOVE LENGTH OF
  7803      CERT-NOTE-FILE
  7804       TO DFHEIV11
  7805*    MOVE '&$ L                  ''   #00007072' TO DFHEIV0
  7806     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7807     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7808     MOVE X'2020233030303037303732' TO DFHEIV0(25:11)
  7809     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 137
* EL6316.cbl
  7810           WS-ERCNOT-FILE-ID,
  7811           CERT-NOTE-FILE,
  7812           DFHEIV11,
  7813           ERCNOT-KEY,
  7814           DFHEIV99,
  7815           DFHEIV99
  7816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7817     END-PERFORM
  7818
  7819     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7820     IF RESP-NORMAL
  7821        EVALUATE CM-NOTE-SW
  7822           WHEN '1'
  7823           WHEN '3'
  7824           WHEN '5'
  7825           WHEN '7'
  7826              SET NO-CERT-RW     TO TRUE
  7827           WHEN ' '
  7828              MOVE '1'           TO CM-NOTE-SW
  7829           WHEN '2'
  7830              MOVE '3'           TO CM-NOTE-SW
  7831           WHEN '4'
  7832              MOVE '5'           TO CM-NOTE-SW
  7833           WHEN '6'
  7834              MOVE '7'           TO CM-NOTE-SW
  7835        END-EVALUATE
  7836     END-IF
  7837     IF NOT NO-CERT-RW
  7838        PERFORM 1810-REWRITE-ELCERT
  7839                                 THRU 1810-EXIT
  7840     ELSE
  7841
  7842* EXEC CICS UNLOCK
  7843*          DATASET    (WS-ELCERT-FILE-ID)
  7844*       END-EXEC
  7845*    MOVE '&*                    #   #00007101' TO DFHEIV0
  7846     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7847     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7848     MOVE X'2020233030303037313031' TO DFHEIV0(25:11)
  7849     CALL 'kxdfhei1' USING DFHEIV0,
  7850           WS-ELCERT-FILE-ID,
  7851           DFHEIV99
  7852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7853     END-IF
  7854
  7855     .
  7856 1799-EXIT.
  7857     EXIT.
  7858
  7859 1800-READ-ELCERT-UPDATE.
  7860
  7861     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  7862     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  7863     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  7864     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  7865     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  7866     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  7867     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 138
* EL6316.cbl
  7868     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  7869
  7870
  7871* EXEC CICS READ
  7872*        UPDATE
  7873*        DATASET  (WS-ELCERT-FILE-ID)
  7874*        RIDFLD   (WS-ELCERT-KEY)
  7875*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  7876*        RESP     (WS-RESPONSE)
  7877*    END-EXEC
  7878*    MOVE '&"S        EU         (  N#00007121' TO DFHEIV0
  7879     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7880     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7881     MOVE X'204E233030303037313231' TO DFHEIV0(25:11)
  7882     CALL 'kxdfhei1' USING DFHEIV0,
  7883           WS-ELCERT-FILE-ID,
  7884           DFHEIV20,
  7885           DFHEIV99,
  7886           WS-ELCERT-KEY,
  7887           DFHEIV99,
  7888           DFHEIV99,
  7889           DFHEIV99
  7890     SET ADDRESS OF CERTIFICATE-MASTER TO
  7891         DFHEIV20
  7892     MOVE EIBRESP  TO WS-RESPONSE
  7893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7894
  7895     .
  7896 1800-EXIT.
  7897     EXIT.
  7898
  7899 1810-REWRITE-ELCERT.
  7900
  7901
  7902* EXEC CICS REWRITE
  7903*        FROM     (CERTIFICATE-MASTER)
  7904*        DATASET  (WS-ELCERT-FILE-ID)
  7905*        RESP     (WS-RESPONSE)
  7906*    END-EXEC.
  7907     MOVE LENGTH OF
  7908      CERTIFICATE-MASTER
  7909       TO DFHEIV11
  7910*    MOVE '&& L                  %  N#00007135' TO DFHEIV0
  7911     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7912     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7913     MOVE X'204E233030303037313335' TO DFHEIV0(25:11)
  7914     CALL 'kxdfhei1' USING DFHEIV0,
  7915           WS-ELCERT-FILE-ID,
  7916           CERTIFICATE-MASTER,
  7917           DFHEIV11,
  7918           DFHEIV99
  7919     MOVE EIBRESP  TO WS-RESPONSE
  7920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7921
  7922
  7923     .
  7924 1810-EXIT.
  7925     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 139
* EL6316.cbl
  7926
  7927 8100-SEND-INITIAL-MAP.
  7928     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7929     MOVE '5'                    TO DC-OPTION-CODE.
  7930     PERFORM 9700-DATE-LINK.
  7931     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  7932     MOVE EIBTIME                TO TIME-IN.
  7933     MOVE TIME-OUT               TO TIMEO.
  7934     MOVE -1                     TO LTRIDL
  7935*    MOVE AL-UANON               TO PRTSWA
  7936     IF PI-PROCESSOR-IS-CSR-SUPER
  7937        perform varying s1 from +1 by +1 until
  7938           s1 > +12
  7939           MOVE AL-UANON            TO reacda (s1)
  7940        end-perform
  7941     END-IF
  7942     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  7943
  7944* EXEC CICS SEND
  7945*        MAP      (MAP-NAME)
  7946*        MAPSET   (MAPSET-NAME)
  7947*        FROM     (EL631IO)
  7948*        ERASE
  7949*        CURSOR
  7950*    END-EXEC.
  7951     MOVE LENGTH OF
  7952      EL631IO
  7953       TO DFHEIV12
  7954     MOVE -1
  7955       TO DFHEIV11
  7956*    MOVE '8$     CT  E    H L F ,   #00007161' TO DFHEIV0
  7957     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  7958     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  7959     MOVE X'2020233030303037313631' TO DFHEIV0(25:11)
  7960     CALL 'kxdfhei1' USING DFHEIV0,
  7961           MAP-NAME,
  7962           EL631IO,
  7963           DFHEIV12,
  7964           MAPSET-NAME,
  7965           DFHEIV99,
  7966           DFHEIV99,
  7967           DFHEIV99,
  7968           DFHEIV11,
  7969           DFHEIV99,
  7970           DFHEIV99,
  7971           DFHEIV99
  7972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7973
  7974     GO TO 9100-RETURN-TRAN.
  7975 8200-SEND-DATAONLY.
  7976     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7977     MOVE '5'                    TO DC-OPTION-CODE.
  7978     PERFORM 9700-DATE-LINK.
  7979     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  7980     MOVE EIBTIME                TO TIME-IN.
  7981     MOVE TIME-OUT               TO TIMEO.
  7982     MOVE -1                     TO PFENTRL
  7983     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 140
* EL6316.cbl
  7984
  7985* EXEC CICS SEND
  7986*        MAP      (MAP-NAME)
  7987*        MAPSET   (MAPSET-NAME)
  7988*        FROM     (EL631IO)
  7989*        DATAONLY
  7990*        ERASEAUP
  7991*        CURSOR
  7992*    END-EXEC.
  7993     MOVE LENGTH OF
  7994      EL631IO
  7995       TO DFHEIV12
  7996     MOVE -1
  7997       TO DFHEIV11
  7998*    MOVE '8$D    CT  A    H L F ,   #00007178' TO DFHEIV0
  7999     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  8000     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8001     MOVE X'2020233030303037313738' TO DFHEIV0(25:11)
  8002     CALL 'kxdfhei1' USING DFHEIV0,
  8003           MAP-NAME,
  8004           EL631IO,
  8005           DFHEIV12,
  8006           MAPSET-NAME,
  8007           DFHEIV99,
  8008           DFHEIV99,
  8009           DFHEIV99,
  8010           DFHEIV11,
  8011           DFHEIV99,
  8012           DFHEIV99,
  8013           DFHEIV99
  8014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8015
  8016     GO TO 9100-RETURN-TRAN.
  8017 8300-SEND-TEXT.
  8018
  8019* EXEC CICS SEND TEXT
  8020*        FROM     (LOGOFF-TEXT)
  8021*        LENGTH   (LOGOFF-LENGTH)
  8022*        ERASE
  8023*        FREEKB
  8024*    END-EXEC.
  8025*    MOVE '8&      T  E F  H   F -   #00007188' TO DFHEIV0
  8026     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8027     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8028     MOVE X'2020233030303037313838' TO DFHEIV0(25:11)
  8029     CALL 'kxdfhei1' USING DFHEIV0,
  8030           LOGOFF-TEXT,
  8031           LOGOFF-LENGTH,
  8032           DFHEIV99,
  8033           DFHEIV99,
  8034           DFHEIV99,
  8035           DFHEIV99,
  8036           DFHEIV99,
  8037           DFHEIV99,
  8038           DFHEIV99,
  8039           DFHEIV99,
  8040           DFHEIV99,
  8041           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 141
* EL6316.cbl
  8042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8043
  8044
  8045* EXEC CICS RETURN
  8046*    END-EXEC.
  8047*    MOVE '.(                    ''   #00007194' TO DFHEIV0
  8048     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8049     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8050     MOVE X'2020233030303037313934' TO DFHEIV0(25:11)
  8051     CALL 'kxdfhei1' USING DFHEIV0,
  8052           DFHEIV99,
  8053           DFHEIV99,
  8054           DFHEIV99,
  8055           DFHEIV99,
  8056           DFHEIV99,
  8057           DFHEIV99
  8058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8059
  8060 8800-UNAUTHORIZED-ACCESS.
  8061     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8062     GO TO 8300-SEND-TEXT.
  8063 8810-PF23.
  8064     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  8065     MOVE XCTL-005               TO PGM-NAME.
  8066     GO TO 9300-XCTL.
  8067 9000-RETURN-CICS.
  8068
  8069* EXEC CICS RETURN
  8070*    END-EXEC.
  8071*    MOVE '.(                    ''   #00007204' TO DFHEIV0
  8072     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8073     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8074     MOVE X'2020233030303037323034' TO DFHEIV0(25:11)
  8075     CALL 'kxdfhei1' USING DFHEIV0,
  8076           DFHEIV99,
  8077           DFHEIV99,
  8078           DFHEIV99,
  8079           DFHEIV99,
  8080           DFHEIV99,
  8081           DFHEIV99
  8082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8083
  8084 9100-RETURN-TRAN.
  8085     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  8086     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  8087
  8088* EXEC CICS RETURN
  8089*        TRANSID    (TRANS-ID)
  8090*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8091*        LENGTH     (1300)
  8092*    END-EXEC.
  8093     MOVE 1300
  8094       TO DFHEIV11
  8095*    MOVE '.(CT                  ''   #00007209' TO DFHEIV0
  8096     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8097     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8098     MOVE X'2020233030303037323039' TO DFHEIV0(25:11)
  8099     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 142
* EL6316.cbl
  8100           TRANS-ID,
  8101           PROGRAM-INTERFACE-BLOCK,
  8102           DFHEIV11,
  8103           DFHEIV99,
  8104           DFHEIV99,
  8105           DFHEIV99
  8106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8107
  8108 9200-RETURN-MAIN-MENU.
  8109     MOVE XCTL-626               TO PGM-NAME.
  8110     GO TO 9300-XCTL.
  8111 9300-XCTL.
  8112
  8113* EXEC CICS XCTL
  8114*        PROGRAM    (PGM-NAME)
  8115*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8116*        LENGTH     (1300)
  8117*    END-EXEC.
  8118     MOVE 1300
  8119       TO DFHEIV11
  8120*    MOVE '.$C                   %   #00007218' TO DFHEIV0
  8121     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8122     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8123     MOVE X'2020233030303037323138' TO DFHEIV0(25:11)
  8124     CALL 'kxdfhei1' USING DFHEIV0,
  8125           PGM-NAME,
  8126           PROGRAM-INTERFACE-BLOCK,
  8127           DFHEIV11,
  8128           DFHEIV99
  8129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8130
  8131 9400-CLEAR.
  8132     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  8133
  8134* EXEC CICS XCTL
  8135*        PROGRAM    (PGM-NAME)
  8136*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8137*        LENGTH     (1300)
  8138*    END-EXEC.
  8139     MOVE 1300
  8140       TO DFHEIV11
  8141*    MOVE '.$C                   %   #00007225' TO DFHEIV0
  8142     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8143     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8144     MOVE X'2020233030303037323235' TO DFHEIV0(25:11)
  8145     CALL 'kxdfhei1' USING DFHEIV0,
  8146           PGM-NAME,
  8147           PROGRAM-INTERFACE-BLOCK,
  8148           DFHEIV11,
  8149           DFHEIV99
  8150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8151
  8152 9500-PF12.
  8153     MOVE XCTL-010               TO PGM-NAME.
  8154     GO TO 9300-XCTL.
  8155 9600-PGMID-ERROR.
  8156
  8157* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 143
* EL6316.cbl
  8158*        PGMIDERR    (8300-SEND-TEXT)
  8159*    END-EXEC.
  8160*    MOVE '"$L                   ! " #00007234' TO DFHEIV0
  8161     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8162     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8163     MOVE X'2220233030303037323334' TO DFHEIV0(25:11)
  8164     CALL 'kxdfhei1' USING DFHEIV0
  8165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8166
  8167     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  8168     MOVE ' '                    TO PI-ENTRY-CD-1.
  8169     MOVE XCTL-005               TO PGM-NAME.
  8170     MOVE PGM-NAME               TO LOGOFF-PGM.
  8171     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  8172     GO TO 9300-XCTL.
  8173 9700-DATE-LINK.
  8174     MOVE LINK-ELDATCV           TO PGM-NAME.
  8175
  8176* EXEC CICS LINK
  8177*        PROGRAM    (PGM-NAME)
  8178*        COMMAREA   (DATE-CONVERSION-DATA)
  8179*        LENGTH     (DC-COMM-LENGTH)
  8180*    END-EXEC.
  8181*    MOVE '."C                   (   #00007245' TO DFHEIV0
  8182     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8183     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8184     MOVE X'2020233030303037323435' TO DFHEIV0(25:11)
  8185     CALL 'kxdfhei1' USING DFHEIV0,
  8186           PGM-NAME,
  8187           DATE-CONVERSION-DATA,
  8188           DC-COMM-LENGTH,
  8189           DFHEIV99,
  8190           DFHEIV99,
  8191           DFHEIV99,
  8192           DFHEIV99
  8193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8194
  8195 9900-ERROR-FORMAT.
  8196     IF NOT EMI-ERRORS-COMPLETE
  8197        MOVE LINK-001            TO PGM-NAME
  8198
  8199* EXEC CICS LINK
  8200*           PROGRAM    (PGM-NAME)
  8201*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8202*           LENGTH     (EMI-COMM-LENGTH)
  8203*       END-EXEC
  8204*    MOVE '."C                   (   #00007253' TO DFHEIV0
  8205     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8206     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8207     MOVE X'2020233030303037323533' TO DFHEIV0(25:11)
  8208     CALL 'kxdfhei1' USING DFHEIV0,
  8209           PGM-NAME,
  8210           ERROR-MESSAGE-INTERFACE-BLOCK,
  8211           EMI-COMM-LENGTH,
  8212           DFHEIV99,
  8213           DFHEIV99,
  8214           DFHEIV99,
  8215           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 144
* EL6316.cbl
  8216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8217     END-IF
  8218     .
  8219 9900-EXIT.
  8220     EXIT.
  8221 9990-ABEND.
  8222     MOVE LINK-004               TO PGM-NAME.
  8223     MOVE DFHEIBLK               TO EMI-LINE1.
  8224
  8225* EXEC CICS LINK
  8226*        PROGRAM   (PGM-NAME)
  8227*        COMMAREA  (EMI-LINE1)
  8228*        LENGTH    (72)
  8229*    END-EXEC.
  8230     MOVE 72
  8231       TO DFHEIV11
  8232*    MOVE '."C                   (   #00007265' TO DFHEIV0
  8233     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8234     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8235     MOVE X'2020233030303037323635' TO DFHEIV0(25:11)
  8236     CALL 'kxdfhei1' USING DFHEIV0,
  8237           PGM-NAME,
  8238           EMI-LINE1,
  8239           DFHEIV11,
  8240           DFHEIV99,
  8241           DFHEIV99,
  8242           DFHEIV99,
  8243           DFHEIV99
  8244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8245
  8246     GO TO 8200-SEND-DATAONLY.
  8247
  8248* GOBACK.
  8249     MOVE '9%                    "   ' TO DFHEIV0
  8250     MOVE 'EL6316' TO DFHEIV1
  8251     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8252     GOBACK.
  8253 9995-SECURITY-VIOLATION.
  8254*                            COPY ELCSCTP.
  8255******************************************************************
  8256*                                                                *
  8257*                            ELCSCTP                             *
  8258*                            VMOD=2.001                          *
  8259*                                                                *
  8260*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8261******************************************************************
  8262
  8263
  8264     MOVE EIBDATE          TO SM-JUL-DATE.
  8265     MOVE EIBTRMID         TO SM-TERMID.
  8266     MOVE THIS-PGM         TO SM-PGM.
  8267     MOVE EIBTIME          TO TIME-IN.
  8268     MOVE TIME-OUT         TO SM-TIME.
  8269     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8270
  8271
  8272* EXEC CICS LINK
  8273*         PROGRAM  ('EL003')
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 145
* EL6316.cbl
  8274*         COMMAREA (SECURITY-MESSAGE)
  8275*         LENGTH   (80)
  8276*    END-EXEC.
  8277     MOVE 'EL003' TO DFHEIV1
  8278     MOVE 80
  8279       TO DFHEIV11
  8280*    MOVE '."C                   (   #00007290' TO DFHEIV0
  8281     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8282     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8283     MOVE X'2020233030303037323930' TO DFHEIV0(25:11)
  8284     CALL 'kxdfhei1' USING DFHEIV0,
  8285           DFHEIV1,
  8286           SECURITY-MESSAGE,
  8287           DFHEIV11,
  8288           DFHEIV99,
  8289           DFHEIV99,
  8290           DFHEIV99,
  8291           DFHEIV99
  8292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8293
  8294
  8295******************************************************************
  8296
  8297 9995-EXIT.
  8298     EXIT.
  8299
  8300 9999-DFHBACK SECTION.
  8301     MOVE '9%                    "   ' TO DFHEIV0
  8302     MOVE 'EL6316' TO DFHEIV1
  8303     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8304     GOBACK.
  8305 9999-DFHEXIT.
  8306     IF DFHEIGDJ EQUAL 0001
  8307         NEXT SENTENCE
  8308     ELSE IF DFHEIGDJ EQUAL 2
  8309         GO TO 8300-SEND-TEXT
  8310         DEPENDING ON DFHEIGDI.
  8311     MOVE '9%                    "   ' TO DFHEIV0
  8312     MOVE 'EL6316' TO DFHEIV1
  8313     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8314     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       34456     Code:       19069
