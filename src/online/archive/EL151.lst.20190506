* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page   1
* EL151.cbl
* Options: int("EL151.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL151.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL151.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL151.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL151 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/06/95 13:08:11.
     7*                            VMOD=2.012.
     8*
     9*AUTHOR.    LOGIC, INC.
    10*           DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page   2
* EL151.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24******************************************************************
    25*                   C H A N G E   L O G
    26*
    27* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    28*-----------------------------------------------------------------
    29*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    30* EFFECTIVE    NUMBER
    31*-----------------------------------------------------------------
    32* 050506    2006030600001  AJRA  ADD PROOF DATE TO DENIAL SCREEN
    33* 120808    2008100900001  PEMA  ADD FOR DENIAL CODE
    34* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    35* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    36******************************************************************
    37*REMARKS.
    38
    39*    SCREENS     - EL151S - DENIALS
    40
    41*    ENTERED BY  - EL150 - STATUS AND DISPOSITION
    42
    43*    EXIT TO     - EL150 - CALLING PROGRAM
    44
    45*    INPUT FILE  - ELMSTR - CLAIM MASTER
    46*                - ELTRLR - ACTIVITY TRAILERS
    47*                - ERNOTE - CERTIFICATE NOTES
    48
    49*    OUTPUT FILE - ELMSTR - CLAIM MASTER
    50*                - ELTRLR - ACTIVITY TRAILERS
    51
    52*    COMMAREA    - PASSED
    53
    54*    ERROR-CODES ACCESSED - 132,  133, 270, 137, 29, 315, 008, 50
    55
    56*    NARRATIVE   - 1- PROVIDE CREATION OF DENIAL TRAILERS
    57*                  2- UPDATE CLAIM STATUS TYPE TO CLOSED (ELMSTR)
    58*                  3- UPDATE RESERVE-EXPENSE TRAILER STATUS TO
    59*                     CLOSED, REASON DENIAL
    60
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page   3
* EL151.cbl
    62 ENVIRONMENT DIVISION.
    63
    64 DATA DIVISION.
    65
    66 WORKING-STORAGE SECTION.
    67 01  DFH-START PIC X(04).
    68
    69 77  FILLER  PIC X(32)  VALUE '********************************'.
    70 77  FILLER  PIC X(32)  VALUE '*   EL151  WORKING STORAGE     *'.
    71 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.012 ********'.
    72
    73*                            COPY ELCSCTM.
    74******************************************************************
    75*                                                                *
    76*                                                                *
    77*                            ELCSCTM                             *
    78*                            VMOD=2.001                          *
    79*                                                                *
    80*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    81*                                                                *
    82******************************************************************
    83 01  SECURITY-MESSAGE.
    84     12  FILLER                          PIC X(30)
    85            VALUE '** LOGIC SECURITY VIOLATION -'.
    86     12  SM-READ                         PIC X(6).
    87     12  FILLER                          PIC X(5)
    88            VALUE ' PGM='.
    89     12  SM-PGM                          PIC X(6).
    90     12  FILLER                          PIC X(5)
    91            VALUE ' OPR='.
    92     12  SM-PROCESSOR-ID                 PIC X(4).
    93     12  FILLER                          PIC X(6)
    94            VALUE ' TERM='.
    95     12  SM-TERMID                       PIC X(4).
    96     12  FILLER                          PIC XX   VALUE SPACE.
    97     12  SM-JUL-DATE                     PIC 9(5).
    98     12  FILLER                          PIC X    VALUE SPACE.
    99     12  SM-TIME                         PIC 99.99.
   100
   101
   102*                            COPY ELCSCRTY.
   103******************************************************************
   104*                                                                *
   105*                                                                *
   106*                            ELCSCRTY                            *
   107*                            VMOD=2.001                          *
   108*                                                                *
   109*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   110*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   111*        SAVED IN PI-SECURITY-ADDRESS.                           *
   112*                                                                *
   113******************************************************************
   114 01  SECURITY-CONTROL.
   115     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   116     12  FILLER                       PIC XX    VALUE 'SC'.
   117     12  SC-CREDIT-CODES.
   118         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   119             20  SC-CREDIT-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page   4
* EL151.cbl
   120             20  SC-CREDIT-UPDATE     PIC X.
   121     12  SC-CLAIMS-CODES.
   122         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   123             20  SC-CLAIMS-DISPLAY    PIC X.
   124             20  SC-CLAIMS-UPDATE     PIC X.
   125
   126*                            COPY ELCNWA.
   127*****************************************************************
   128*                                                               *
   129*                                                               *
   130*                            ELCNWA.                            *
   131*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   132*                            VMOD=2.003                         *
   133*                                                               *
   134*            M O V E   N A M E   W O R K   A R E A.             *
   135*                                                               *
   136*****************************************************************.
   137
   138 01  WS-NAME-WORK-AREA.
   139     05  WS-INSURED-LAST-NAME        PIC X(15).
   140     05  WS-INSURED-1ST-NAME         PIC X(12).
   141     05  WS-INSURED-MID-INIT         PIC X.
   142
   143     05  WS-NAME-WORK.
   144         10  WS-NW                   PIC X
   145             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   146
   147     05  WS-NAME-WORK2.
   148         10  WS-NW2                  PIC X
   149             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   150                                        NWA-INDEX0.
   151
   152     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   153                                     COMP-3.
   154
   155
   156 01  WS-DATE-AREA.
   157     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   158     05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   159     05  WS-BLANK            PIC X       VALUE ' '.
   160
   161 01  WS-SCRATCH-AREA.
   162     05  GETMAIN-SPACE               PIC X     VALUE SPACE.
   163     05  WS-TRLR-LENGTH              PIC S9(4) VALUE +200  COMP.
   164     05  WS-DMO-LENGTH               PIC S9(4) VALUE +108  COMP.
   165     05  WS-DCT-LENGTH               PIC S9(4) VALUE +53   COMP.
   166     05  SC-ITEM                     PIC S9(4) VALUE +0001 COMP.
   167
   168     05  WS-TRANS-ID                 PIC X(4)   VALUE 'EX32'.
   169     05  WS-SEQ-NO-SAVED             PIC S9(4)   VALUE ZEROS.
   170
   171     05  WS-ORIG-SEQ-CNT             PIC S9(4)   VALUE ZEROS.
   172
   173     05  TR-SUB                      PIC S9(4)   VALUE ZERO  COMP.
   174     05  TR-SUB-2                    PIC S9(4)   VALUE ZERO  COMP.
   175     05  MISC-SUB                    PIC S9(03)  COMP-3  VALUE +0.
   176
   177     05  MAP-NAME                    PIC X(08)   VALUE 'EL151A'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page   5
* EL151.cbl
   178     05  MAPSET-NAME                 PIC X(08)   VALUE 'EL151S'.
   179
   180     05  ELTRLR-FILE-ID              PIC X(08)   VALUE 'ELTRLR'.
   181     05  ELMSTR-FILE-ID              PIC X(08)   VALUE 'ELMSTR'.
   182     05  ELCNTL-FILE-ID              PIC X(08)   VALUE 'ELCNTL'.
   183     05  ELARCH-FILE-ID              PIC X(08)   VALUE 'ELARCH'.
   184
   185     05  THIS-PGM                    PIC X(08)   VALUE  'EL151'.
   186
   187     05  WS-OC-LOAD-SW               PIC X(01)   VALUE SPACE.
   188         88  OC-HISTORY-LOADED       VALUE 'X'.
   189
   190     05  WS-CLAIM-SEQ-SW             PIC X(01)   VALUE SPACE.
   191         88  NO-SEQ-NUMBER           VALUE 'X'.
   192         88  SEQ-NUMBER-EXIST        VALUE ' '.
   193         88  NO-ACCT-TRLR            VALUE 'Y'.
   194
   195     05  WS-RESET-SW                 PIC X(01)   VALUE 'N'.
   196     05  WS-REC-FOUND-SW             PIC X(01)   VALUE 'N'.
   197     05  WS-BROWSE-SW                PIC X(01)   VALUE 'N'.
   198     05  WS-UPDATE-SW                PIC X(01)   VALUE 'N'.
   199
   200     05  TIME-IN                     PIC S9(7).
   201     05  TIME-OUT-R REDEFINES TIME-IN.
   202         10  FILLER                  PIC X(01).
   203         10  TIME-OUT                PIC 99V99.
   204         10  FILLER                  PIC X(02).
   205
   206     05  DEEDIT-FIELD                PIC X(15).
   207     05  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD   PIC S9(15).
   208
   209     05  WS-PRF-DT                   PIC X(2).
   210     05  WS-MAX-LETTER-ANSWER-DT     PIC X(2)  VALUE LOW-VALUES.
   211
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page   6
* EL151.cbl
   213     05  DENIAL-TABLE.
   214         10  FILLER                  PIC X(44)    VALUE
   215             'DPE  PRE-EXISTING DISABILITY                '.
   216         10  FILLER                  PIC X(44)    VALUE
   217             'DDN  DISABILITY NOT COVERED DUE TO NATURE   '.
   218         10  FILLER                  PIC X(44)    VALUE
   219             'DIR  INSURED RECOVERED FROM DISABILITY      '.
   220         10  FILLER                  PIC X(44)    VALUE
   221             'DEM  EMPLOYMENT INDICATES OCCUPATION NOT MET'.
   222         10  FILLER                  PIC X(44)    VALUE
   223             'DWP  DISABILITY WAITING PERIOD NOT SATISFIED'.
   224         10  FILLER                  PIC X(44)    VALUE
   225             'DNC  NO COVERAGE                            '.
   226         10  FILLER                  PIC X(44)    VALUE
   227             'DAP  APPLICATION MISREPRESENTATION          '.
   228         10  FILLER                  PIC X(44)    VALUE
   229             'DMA  MIS-STATEMENT OF AGE                   '.
   230         10  FILLER                  PIC X(44)    VALUE
   231             'DSU  SUICIDE OR SELF-INFLICTED INJURY       '.
   232         10  FILLER                  PIC X(44)    VALUE
   233             'DOT  OTHER                                  '.
   234         10  FILLER                  PIC X(44)    VALUE
   235             'DAR  AWARE OF UNEMPLOY./RED. AT INCEPTION   '.
   236         10  FILLER                  PIC X(44)    VALUE
   237             'DNE  NOT EMPLOYED SIX MONTHS PRIOR          '.
   238         10  FILLER                  PIC X(44)    VALUE
   239             'DNR  NOT MADE REDUNDANT/NOT UNEMPLOYED      '.
   240         10  FILLER                  PIC X(44)    VALUE
   241             'DSE  SELF EMPLOYED                          '.
   242         10  FILLER                  PIC X(44)    VALUE
   243             'DTW  TEMPORARY WORK                         '.
   244         10  FILLER                  PIC X(44)    VALUE
   245             'LAP  APPLICATION MISREPRESENTATION          '.
   246         10  FILLER                  PIC X(44)    VALUE
   247             'LMA  MIS-STATEMENT OF AGE                   '.
   248         10  FILLER                  PIC X(44)    VALUE
   249             'LNC  NO COVERAGE                            '.
   250         10  FILLER                  PIC X(44)    VALUE
   251             'LOT  OTHER                                  '.
   252     05  DEN-TABLE REDEFINES DENIAL-TABLE OCCURS 19
   253         INDEXED BY DEN-INDEX.
   254         10  DENIAL-CODE.
   255             15  DENIAL-1-1          PIC X(01).
   256             15  DENIAL-2-3          PIC X(02).
   257             15  DENIAL-4-4          PIC X(01).
   258         10  FILLER                  PIC X(01).
   259         10  DENIAL-DESC             PIC X(39).
   260
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page   7
* EL151.cbl
   262 01  ACCESS-KEYS.
   263     05  WS-TRAILER-KEY.
   264         10  WS-CLAIM-KEY.
   265             15  WS-KEY-COMPANY-CD       PIC X.
   266             15  WS-KEY-CARRIER          PIC X.
   267             15  WS-KEY-CLAIM-NO         PIC X(7).
   268             15  WS-KEY-CERT-NO.
   269                 20  WS-KEY-CERT-PRIME   PIC X(10).
   270                 20  WS-KEY-CERT-SFX     PIC X.
   271         10  WS-KEY-SEQUENCE-NO      PIC   S9(4) COMP.
   272
   273     05  ELARCH-KEY.
   274         10  ELARCH-COMPANY-CD   PIC X(01).
   275         10  ELARCH-ARCHIVE-NO   PIC S9(08)  COMP.
   276         10  ELARCH-RECORD-TYPE  PIC X(01).
   277         10  ELARCH-SEQ-NO       PIC S9(04)  COMP.
   278
   279     05  WS-ELDENY-KEY.
   280         10  ELDENY-COMPANY-CD   PIC X.
   281         10  ELDENY-DENIAL-CODE  PIC X(4).
   282         10  FILLER              PIC X(10).
   283     05  ELCNTL-KEY.
   284         10  ELCNTL-COMPANY-ID   PIC X(03).
   285         10  ELCNTL-RECORD-TYPE  PIC X(01).
   286         10  ELCNTL-ACCESS       PIC X(04).
   287         10  ELCNTL-SEQ-NO       PIC S9(04)  COMP.
   288
   289     05  W-NOTE-KEY.
   290         10  W-NOTE-COMP-CD      PIC X.
   291         10  W-NOTE-CERT-KEY.
   292             16  W-NOTE-CARRIER  PIC X.
   293             16  W-NOTE-GROUPING PIC X(6).
   294             16  W-NOTE-STATE    PIC XX.
   295             16  W-NOTE-ACCOUNT  PIC X(10).
   296             16  W-NOTE-EFF-DT   PIC XX.
   297             16  W-NOTE-CERT-NO  PIC X(11).
   298
   299 01  WS-RESPONSE             PIC S9(8)   COMP.
   300     88  RESP-NORMAL              VALUE +00.
   301     88  RESP-ERROR               VALUE +01.
   302     88  RESP-NOTFND              VALUE +13.
   303     88  RESP-NOTOPEN             VALUE +19.
   304     88  RESP-ENDFILE             VALUE +20.
   305 01  ERROR-MESSAGES.
   306     12  ER-0000                 PIC X(4)  VALUE '0000'.
   307     12  ER-0004                 PIC X(4)  VALUE '0004'.
   308     12  ER-0008                 PIC X(4)  VALUE '0008'.
   309     12  ER-0021                 PIC X(4)  VALUE '0021'.
   310     12  ER-0029                 PIC X(4)  VALUE '0029'.
   311     12  ER-0050                 PIC X(4)  VALUE '0050'.
   312     12  ER-0070                 PIC X(4)  VALUE '0070'.
   313     12  ER-0132                 PIC X(4)  VALUE '0132'.
   314     12  ER-0133                 PIC X(4)  VALUE '0133'.
   315     12  ER-0137                 PIC X(4)  VALUE '0137'.
   316     12  ER-0154                 PIC X(4)  VALUE '0154'.
   317     12  ER-0172                 PIC X(4)  VALUE '0172'.
   318     12  ER-0270                 PIC X(4)  VALUE '0270'.
   319     12  ER-0483                 PIC X(4)  VALUE '0483'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page   8
* EL151.cbl
   320     12  ER-0872                 PIC X(4)  VALUE '0872'.
   321     12  ER-0873                 PIC X(4)  VALUE '0873'.
   322     12  ER-0884                 PIC X(4)  VALUE '0884'.
   323     12  ER-0919                 PIC X(4)  VALUE '0919'.
   324     12  ER-0921                 PIC X(4)  VALUE '0921'.
   325     12  ER-0946                 PIC X(4)  VALUE '0946'.
   326     12  ER-0947                 PIC X(4)  VALUE '0947'.
   327     12  ER-0948                 PIC X(4)  VALUE '0948'.
   328     12  ER-0949                 PIC X(4)  VALUE '0949'.
   329     12  ER-0950                 PIC X(4)  VALUE '0950'.
   330     12  ER-0951                 PIC X(4)  VALUE '0951'.
   331     12  ER-0954                 PIC X(4)  VALUE '0954'.
   332     12  ER-0974                 PIC X(4)  VALUE '0974'.
   333     12  ER-0975                 PIC X(4)  VALUE '0975'.
   334     12  ER-8051                 PIC X(4)  VALUE '8051'.
   335     12  ER-8052                 PIC X(4)  VALUE '8052'.
   336     12  ER-8053                 PIC X(4)  VALUE '8053'.
   337     12  ER-8054                 PIC X(4)  VALUE '8054'.
   338     12  ER-8055                 PIC X(4)  VALUE '8055'.
   339     12  ER-8056                 PIC X(4)  VALUE '8056'.
   340     12  ER-8057                 PIC X(4)  VALUE '8057'.
   341     12  ER-8058                 PIC X(4)  VALUE '8058'.
   342     12  ER-8059                 PIC X(4)  VALUE '8059'.
   343     12  ER-8060                 PIC X(4)  VALUE '8060'.
   344     12  ER-8061                 PIC X(4)  VALUE '8061'.
   345     12  ER-8062                 PIC X(4)  VALUE '8062'.
   346     12  ER-8063                 PIC X(4)  VALUE '8063'.
   347     12  ER-8064                 PIC X(4)  VALUE '8064'.
   348     12  ER-8065                 PIC X(4)  VALUE '8065'.
   349     12  ER-8066                 PIC X(4)  VALUE '8066'.
   350     12  ER-8152                 PIC X(4)  VALUE '8152'.
   351     12  ER-8153                 PIC X(4)  VALUE '8153'.
   352     12  ER-8154                 PIC X(4)  VALUE '8154'.
   353     12  ER-8155                 PIC X(4)  VALUE '8155'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page   9
* EL151.cbl
   355*                                    COPY ELCAID.
   356******************************************************************
   357*                                                                *
   358*                            ELCAID.                             *
   359*                            VMOD=2.001                          *
   360*                                                                *
   361*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   362*                                                                *
   363*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   364*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   365******************************************************************
   366
   367 01  DFHAID.
   368   02  DFHNULL   PIC  X  VALUE  ' '.
   369   02  DFHENTER  PIC  X  VALUE  QUOTE.
   370   02  DFHCLEAR  PIC  X  VALUE  '_'.
   371   02  DFHPEN    PIC  X  VALUE  '='.
   372   02  DFHOPID   PIC  X  VALUE  'W'.
   373   02  DFHPA1    PIC  X  VALUE  '%'.
   374   02  DFHPA2    PIC  X  VALUE  '>'.
   375   02  DFHPA3    PIC  X  VALUE  ','.
   376   02  DFHPF1    PIC  X  VALUE  '1'.
   377   02  DFHPF2    PIC  X  VALUE  '2'.
   378   02  DFHPF3    PIC  X  VALUE  '3'.
   379   02  DFHPF4    PIC  X  VALUE  '4'.
   380   02  DFHPF5    PIC  X  VALUE  '5'.
   381   02  DFHPF6    PIC  X  VALUE  '6'.
   382   02  DFHPF7    PIC  X  VALUE  '7'.
   383   02  DFHPF8    PIC  X  VALUE  '8'.
   384   02  DFHPF9    PIC  X  VALUE  '9'.
   385   02  DFHPF10   PIC  X  VALUE  ':'.
   386   02  DFHPF11   PIC  X  VALUE  '#'.
   387   02  DFHPF12   PIC  X  VALUE  '@'.
   388   02  DFHPF13   PIC  X  VALUE  'A'.
   389   02  DFHPF14   PIC  X  VALUE  'B'.
   390   02  DFHPF15   PIC  X  VALUE  'C'.
   391   02  DFHPF16   PIC  X  VALUE  'D'.
   392   02  DFHPF17   PIC  X  VALUE  'E'.
   393   02  DFHPF18   PIC  X  VALUE  'F'.
   394   02  DFHPF19   PIC  X  VALUE  'G'.
   395   02  DFHPF20   PIC  X  VALUE  'H'.
   396   02  DFHPF21   PIC  X  VALUE  'I'.
   397*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   398   02  DFHPF22   PIC  X  VALUE  '['.
   399   02  DFHPF23   PIC  X  VALUE  '.'.
   400   02  DFHPF24   PIC  X  VALUE  '<'.
   401   02  DFHMSRE   PIC  X  VALUE  'X'.
   402   02  DFHSTRF   PIC  X  VALUE  'h'.
   403   02  DFHTRIG   PIC  X  VALUE  '"'.
   404 01  PF-AID REDEFINES DFHAID.
   405     05  FILLER                      PIC X(8).
   406     05  PF-VALUES  OCCURS 24        PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  10
* EL151.cbl
   408*                                    COPY ELCINTF.
   409******************************************************************
   410*                                                                *
   411*                                                                *
   412*                            ELCINTF.                            *
   413*                            VMOD=2.017                          *
   414*                                                                *
   415*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   416*                                                                *
   417*       LENGTH = 1024                                            *
   418*                                                                *
   419******************************************************************
   420*                   C H A N G E   L O G
   421*
   422* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   423*-----------------------------------------------------------------
   424*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   425* EFFECTIVE    NUMBER
   426*-----------------------------------------------------------------
   427* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   428******************************************************************
   429 01  PROGRAM-INTERFACE-BLOCK.
   430     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   431     12  PI-CALLING-PROGRAM              PIC X(8).
   432     12  PI-SAVED-PROGRAM-1              PIC X(8).
   433     12  PI-SAVED-PROGRAM-2              PIC X(8).
   434     12  PI-SAVED-PROGRAM-3              PIC X(8).
   435     12  PI-SAVED-PROGRAM-4              PIC X(8).
   436     12  PI-SAVED-PROGRAM-5              PIC X(8).
   437     12  PI-SAVED-PROGRAM-6              PIC X(8).
   438     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   439     12  PI-COMPANY-ID                   PIC XXX.
   440     12  PI-COMPANY-CD                   PIC X.
   441
   442     12  PI-COMPANY-PASSWORD             PIC X(8).
   443
   444     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   445
   446     12  PI-CONTROL-IN-PROGRESS.
   447         16  PI-CARRIER                  PIC X.
   448         16  PI-GROUPING                 PIC X(6).
   449         16  PI-STATE                    PIC XX.
   450         16  PI-ACCOUNT                  PIC X(10).
   451         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   452                                         PIC X(10).
   453         16  PI-CLAIM-CERT-GRP.
   454             20  PI-CLAIM-NO             PIC X(7).
   455             20  PI-CERT-NO.
   456                 25  PI-CERT-PRIME       PIC X(10).
   457                 25  PI-CERT-SFX         PIC X.
   458             20  PI-CERT-EFF-DT          PIC XX.
   459         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   460             20  PI-PLAN-CODE            PIC X(2).
   461             20  PI-REVISION-NUMBER      PIC X(3).
   462             20  PI-PLAN-EFF-DT          PIC X(2).
   463             20  PI-PLAN-EXP-DT          PIC X(2).
   464             20  FILLER                  PIC X(11).
   465         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  11
* EL151.cbl
   466             20  PI-OE-REFERENCE-1.
   467                 25  PI-OE-REF-1-PRIME   PIC X(18).
   468                 25  PI-OE-REF-1-SUFF    PIC XX.
   469
   470     12  PI-SESSION-IN-PROGRESS          PIC X.
   471         88  CLAIM-SESSION                   VALUE '1'.
   472         88  CREDIT-SESSION                  VALUE '2'.
   473         88  WARRANTY-SESSION                VALUE '3'.
   474         88  MORTGAGE-SESSION                VALUE '4'.
   475         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   476
   477
   478*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   479
   480     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   481     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   482
   483     12  PI-CREDIT-USER                  PIC X.
   484         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   485         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   486
   487     12  PI-CLAIM-USER                   PIC X.
   488         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   489         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   490
   491     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   492         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   493         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   494         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   495         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   496         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   497
   498     12  PI-PROCESSOR-ID                 PIC X(4).
   499
   500     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   501
   502     12  PI-MEMBER-CAPTION               PIC X(10).
   503
   504     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   505         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   506
   507     12  PI-LIFE-OVERRIDE-L1             PIC X.
   508     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   509     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   510     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   511
   512     12  PI-AH-OVERRIDE-L1               PIC X.
   513     12  PI-AH-OVERRIDE-L2               PIC XX.
   514     12  PI-AH-OVERRIDE-L6               PIC X(6).
   515     12  PI-AH-OVERRIDE-L12              PIC X(12).
   516
   517     12  PI-NEW-SYSTEM                   PIC X(2).
   518
   519     12  PI-PRIMARY-CERT-NO              PIC X(11).
   520     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   521         88  PI-USES-PAID-TO                 VALUE '1'.
   522     12  PI-CRDTCRD-SYSTEM.
   523         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  12
* EL151.cbl
   524             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   525             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   526         16  PI-CC-MONTH-END-DT          PIC XX.
   527     12  PI-PROCESSOR-PRINTER            PIC X(4).
   528
   529     12  PI-OE-REFERENCE-2.
   530         16  PI-OE-REF-2-PRIME           PIC X(10).
   531         16  PI-OE-REF-2-SUFF            PIC X.
   532
   533     12  PI-REM-TRM-CALC-OPTION          PIC X.
   534
   535     12  PI-LANGUAGE-TYPE                PIC X.
   536             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   537             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   538             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   539
   540     12  PI-POLICY-LINKAGE-IND           PIC X.
   541         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   542         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   543                                                   LOW-VALUES.
   544
   545     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   546     12  PI-CLAIM-PW-SESSION             PIC X(1).
   547         88  PI-CLAIM-CREDIT                 VALUE '1'.
   548         88  PI-CLAIM-CONVEN                 VALUE '2'.
   549
   550     12  PI-PROCESSOR-CSR-IND            PIC X.
   551         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   552         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   553
   554     12  FILLER                          PIC X(3).
   555
   556     12  PI-SYSTEM-LEVEL                 PIC X(145).
   557
   558     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   559         PI-SYSTEM-LEVEL.
   560
   561         16  PI-ENTRY-CODES.
   562             20  PI-ENTRY-CD-1           PIC X.
   563             20  PI-ENTRY-CD-2           PIC X.
   564
   565         16  PI-RETURN-CODES.
   566             20  PI-RETURN-CD-1          PIC X.
   567             20  PI-RETURN-CD-2          PIC X.
   568
   569         16  PI-UPDATE-STATUS-SAVE.
   570             20  PI-UPDATE-BY            PIC X(4).
   571             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   572
   573         16  PI-LOWER-CASE-LETTERS       PIC X.
   574             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   575
   576*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   577*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   578*            88  CARRIER-CLM-CNTL            VALUE '2'.
   579
   580         16  PI-CERT-ACCESS-CONTROL      PIC X.
   581             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  13
* EL151.cbl
   582             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   583             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   584             88  ACCNT-CNTL                  VALUE '3'.
   585             88  CARR-ACCNT-CNTL             VALUE '4'.
   586
   587         16  PI-PROCESSOR-CAP-LIST.
   588             20  PI-SYSTEM-CONTROLS.
   589                24 PI-SYSTEM-DISPLAY     PIC X.
   590                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   591                24 PI-SYSTEM-MODIFY      PIC X.
   592                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   593             20  FILLER                  PIC XX.
   594             20  PI-DISPLAY-CAP          PIC X.
   595                 88  DISPLAY-CAP             VALUE 'Y'.
   596             20  PI-MODIFY-CAP           PIC X.
   597                 88  MODIFY-CAP              VALUE 'Y'.
   598             20  PI-MSG-AT-LOGON-CAP     PIC X.
   599                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   600             20  PI-FORCE-CAP            PIC X.
   601                 88  FORCE-CAP               VALUE 'Y'.
   602
   603         16  PI-PROGRAM-CONTROLS.
   604             20  PI-PGM-PRINT-OPT        PIC X.
   605             20  PI-PGM-FORMAT-OPT       PIC X.
   606             20  PI-PGM-PROCESS-OPT      PIC X.
   607             20  PI-PGM-TOTALS-OPT       PIC X.
   608
   609         16  PI-HELP-INTERFACE.
   610             20  PI-LAST-ERROR-NO        PIC X(4).
   611             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   612
   613         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   614             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   615
   616         16  PI-CR-CONTROL-IN-PROGRESS.
   617             20  PI-CR-CARRIER           PIC X.
   618             20  PI-CR-GROUPING          PIC X(6).
   619             20  PI-CR-STATE             PIC XX.
   620             20  PI-CR-ACCOUNT           PIC X(10).
   621             20  PI-CR-FIN-RESP          PIC X(10).
   622             20  PI-CR-TYPE              PIC X.
   623
   624         16  PI-CR-BATCH-NUMBER          PIC X(6).
   625
   626         16  PI-CR-MONTH-END-DT          PIC XX.
   627
   628         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   629             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   630             88  PI-ZERO-CARRIER             VALUE '1'.
   631             88  PI-ZERO-GROUPING            VALUE '2'.
   632             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   633
   634         16  PI-CARRIER-SECURITY         PIC X.
   635             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   636
   637         16  PI-ACCOUNT-SECURITY         PIC X(10).
   638             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   639             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  14
* EL151.cbl
   640
   641         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   642             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   643                                         INDEXED BY PI-ACCESS-NDX
   644                                         PIC X.
   645
   646         16  PI-GA-BILLING-CONTROL       PIC X.
   647             88  PI-GA-BILLING               VALUE '1'.
   648
   649         16  PI-MAIL-PROCESSING          PIC X.
   650             88  PI-MAIL-YES                 VALUE 'Y'.
   651
   652         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   653
   654         16  PI-AR-SYSTEM.
   655             20  PI-AR-PROCESSING-CNTL   PIC X.
   656                 88  PI-AR-PROCESSING        VALUE 'Y'.
   657             20  PI-AR-SUMMARY-CODE      PIC X(6).
   658             20  PI-AR-MONTH-END-DT      PIC XX.
   659
   660         16  PI-MP-SYSTEM.
   661             20  PI-MORTGAGE-USER            PIC X.
   662                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   663                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   664             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   665                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   666                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   667                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   668                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   669                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   670             20  PI-MP-MONTH-END-DT          PIC XX.
   671             20  PI-MP-REFERENCE-NO.
   672                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   673                 24  PI-MP-REFERENCE-SFX     PIC XX.
   674
   675         16  PI-LABEL-CONTROL            PIC X(01).
   676             88  PI-CREATE-LABELS                    VALUE 'Y'.
   677             88  PI-BYPASS-LABELS                    VALUE 'N'.
   678
   679         16  PI-BILL-GROUPING-CODE       PIC X(01).
   680             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   681
   682         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   683             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   684             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   685
   686         16  FILLER                      PIC X(14).
   687
   688     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   689******************************************************************
   690     12  PI-REDEFINES REDEFINES PI-PROGRAM-WORK-AREA.
   691         16  PI-PREV-TRLR-KEY        PIC X(22).
   692*00252          16  FILLER                  PIC X(618).
   693         16  PI-PROOF-DATE           PIC 9(6).
   694         16  FILLER                  PIC X(612).
   695
   696* DLO023
   697 01  DL23-COMM-LENGTH              PIC S9(4) COMP VALUE +132.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  15
* EL151.cbl
   698 01  WS-DLO-CODES-TABLE.
   699     12  DL23-SYSTEM-ID            PIC XX.
   700     12  DL23-RECORD-TYPE          PIC XX.
   701     12  DL23-RECORD-KEY           PIC X(6).
   702     12  DL23-RETURN-CODE          PIC XX.
   703     12  DL23-CODE-DESC.
   704         16  DL23-CODE-TEXT        PIC X(20).
   705         16  DL23-RET-CODE         PIC X(40).
   706     12  DL23-GEN-DESC-1           PIC X(20).
   707     12  DL23-GEN-DESC-2           PIC X(20).
   708     12  DL23-GEN-DESC-3           PIC X(20).
   709
   710 01  DMD-DATE-YYYYMMDD.
   711     12  DMD-DECADE          PIC XX      VALUE SPACES.
   712     12  DMD-YYMMDD.
   713         16  DMD-YY          PIC XX      VALUE SPACES.
   714         16  DMD-MM          PIC XX      VALUE SPACES.
   715         16  DMD-DD          PIC XX      VALUE SPACES.
   716
   717     12  W-NAME-LAST             PIC  X(15).
   718     12  W-NAME-FIRST            PIC  X(15).
   719     12  W-NAME-MIDDLE.
   720         16  FILLER              PIC  X(01).
   721         16  W-NAME-MIDDLE-2     PIC  X(01).
   722         16  FILLER              PIC  X(13).
   723
   724*                                    COPY ELCDCTB.
   725******************************************************************
   726*                                                                *
   727*                                                                *
   728*                            ELCDCTB.                            *
   729*                            VMOD=2.002                          *
   730*                                                                *
   731*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   732*       COMMUNICATIONS AREA                                      *
   733*                                                                *
   734******************************************************************
   735 01  DCT-COMMUNICATION-AREA.
   736     12  DCT-BILLING-BANK-ID      PIC  X(05).
   737     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   738     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   739     12  DCT-PRODUCT-CODE         PIC  X(02).
   740     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   741     12  DCT-RETURN-CODE          PIC  X(02).
   742     12  DCT-MAIL-CODE            PIC  X(05).
   743     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   744     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  16
* EL151.cbl
   746*                                    COPY ELCATTR.
   747******************************************************************
   748*                                                                *
   749*                            ELCATTR.                            *
   750*                            VMOD=2.001                          *
   751*                                                                *
   752*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   753*                                                                *
   754*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   755*                                                                *
   756*                   POS 1   P=PROTECTED                          *
   757*                           U=UNPROTECTED                        *
   758*                           S=ASKIP                              *
   759*                   POS 2   A=ALPHA/NUMERIC                      *
   760*                           N=NUMERIC                            *
   761*                   POS 3   N=NORMAL                             *
   762*                           B=BRIGHT                             *
   763*                           D=DARK                               *
   764*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   765*                           OF=MODIFIED DATA TAG OFF             *
   766*                                                                *
   767*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   768******************************************************************
   769 01  ATTRIBUTE-LIST.
   770     12  AL-PABOF            PIC X       VALUE 'Y'.
   771     12  AL-PABON            PIC X       VALUE 'Z'.
   772     12  AL-PADOF            PIC X       VALUE '%'.
   773     12  AL-PADON            PIC X       VALUE '_'.
   774     12  AL-PANOF            PIC X       VALUE '-'.
   775     12  AL-PANON            PIC X       VALUE '/'.
   776     12  AL-SABOF            PIC X       VALUE '8'.
   777     12  AL-SABON            PIC X       VALUE '9'.
   778     12  AL-SADOF            PIC X       VALUE '@'.
   779     12  AL-SADON            PIC X       VALUE QUOTE.
   780     12  AL-SANOF            PIC X       VALUE '0'.
   781     12  AL-SANON            PIC X       VALUE '1'.
   782     12  AL-UABOF            PIC X       VALUE 'H'.
   783     12  AL-UABON            PIC X       VALUE 'I'.
   784     12  AL-UADOF            PIC X       VALUE '<'.
   785     12  AL-UADON            PIC X       VALUE '('.
   786     12  AL-UANOF            PIC X       VALUE ' '.
   787     12  AL-UANON            PIC X       VALUE 'A'.
   788     12  AL-UNBOF            PIC X       VALUE 'Q'.
   789     12  AL-UNBON            PIC X       VALUE 'R'.
   790     12  AL-UNDOF            PIC X       VALUE '*'.
   791     12  AL-UNDON            PIC X       VALUE ')'.
   792     12  AL-UNNOF            PIC X       VALUE '&'.
   793     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  17
* EL151.cbl
   795*                                    COPY ELCLOGOF.
   796******************************************************************
   797*                                                                *
   798*                                                                *
   799*                            ELCLOGOF.                           *
   800*                            VMOD=2.001                          *
   801*                                                                *
   802*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   803*                                                                *
   804******************************************************************
   805 01  CLASIC-LOGOFF.
   806     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   807     12  LOGOFF-TEXT.
   808         16  FILLER          PIC X(5)    VALUE SPACES.
   809         16  LOGOFF-MSG.
   810             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   811             20  FILLER      PIC X       VALUE SPACES.
   812             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   813         16  FILLER          PIC X(80)
   814           VALUE '* YOU ARE NOW LOGGED OFF'.
   815         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   816         16  FILLER          PIC X       VALUE QUOTE.
   817         16  LOGOFF-SYS-MSG  PIC X(17)
   818           VALUE 'S CLAS-IC SYSTEM '.
   819     12  TEXT-MESSAGES.
   820         16  UNACCESS-MSG    PIC X(29)
   821             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   822         16  PGMIDERR-MSG    PIC X(17)
   823             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  18
* EL151.cbl
   825*                                    COPY ELCDATE.
   826******************************************************************
   827*                                                                *
   828*                                                                *
   829*                            ELCDATE.                            *
   830*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   831*                            VMOD=2.003
   832*                                                                *
   833*                                                                *
   834*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   835*                 LENGTH = 200                                   *
   836******************************************************************
   837
   838 01  DATE-CONVERSION-DATA.
   839     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   840     12  DC-OPTION-CODE                PIC X.
   841         88  BIN-TO-GREG                VALUE ' '.
   842         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   843         88  EDIT-GREG-TO-BIN           VALUE '2'.
   844         88  YMD-GREG-TO-BIN            VALUE '3'.
   845         88  MDY-GREG-TO-BIN            VALUE '4'.
   846         88  JULIAN-TO-BIN              VALUE '5'.
   847         88  BIN-PLUS-ELAPSED           VALUE '6'.
   848         88  FIND-CENTURY               VALUE '7'.
   849         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   850         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   851         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   852         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   853         88  JULIAN-TO-BIN-3            VALUE 'C'.
   854         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   855         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   856         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   857         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   858         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   859         88  CHECK-LEAP-YEAR            VALUE 'H'.
   860         88  BIN-3-TO-GREG              VALUE 'I'.
   861         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   862         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   863         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   864         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   865         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   866         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   867         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   868         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   869         88  THREE-CHARACTER-BIN
   870                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   871         88  GREGORIAN-TO-BIN
   872                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   873         88  BIN-TO-GREGORIAN
   874                  VALUES ' ' '1' 'I' '8' 'G'.
   875         88  JULIAN-TO-BINARY
   876                  VALUES '5' 'C' 'E' 'F'.
   877     12  DC-ERROR-CODE                 PIC X.
   878         88  NO-CONVERSION-ERROR        VALUE ' '.
   879         88  DATE-CONVERSION-ERROR
   880                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   881         88  DATE-IS-ZERO               VALUE '1'.
   882         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  19
* EL151.cbl
   883         88  DATE-IS-INVALID            VALUE '3'.
   884         88  DATE1-GREATER-DATE2        VALUE '4'.
   885         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   886         88  DATE-INVALID-OPTION        VALUE '9'.
   887         88  INVALID-CENTURY            VALUE 'A'.
   888         88  ONLY-CENTURY               VALUE 'B'.
   889         88  ONLY-LEAP-YEAR             VALUE 'C'.
   890         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   891     12  DC-END-OF-MONTH               PIC X.
   892         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   893     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   894         88  USE-NORMAL-PROCESS         VALUE ' '.
   895         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   896         88  ADJUST-UP-100-YRS          VALUE '2'.
   897     12  FILLER                        PIC X.
   898     12  DC-CONVERSION-DATES.
   899         16  DC-BIN-DATE-1             PIC XX.
   900         16  DC-BIN-DATE-2             PIC XX.
   901         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   902         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   903                       DC-GREG-DATE-1-EDIT.
   904             20  DC-EDIT1-MONTH        PIC 99.
   905             20  SLASH1-1              PIC X.
   906             20  DC-EDIT1-DAY          PIC 99.
   907             20  SLASH1-2              PIC X.
   908             20  DC-EDIT1-YEAR         PIC 99.
   909         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   910         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   911                     DC-GREG-DATE-2-EDIT.
   912             20  DC-EDIT2-MONTH        PIC 99.
   913             20  SLASH2-1              PIC X.
   914             20  DC-EDIT2-DAY          PIC 99.
   915             20  SLASH2-2              PIC X.
   916             20  DC-EDIT2-YEAR         PIC 99.
   917         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   918         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   919                     DC-GREG-DATE-1-YMD.
   920             20  DC-YMD-YEAR           PIC 99.
   921             20  DC-YMD-MONTH          PIC 99.
   922             20  DC-YMD-DAY            PIC 99.
   923         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   924         16  DC-GREG-DATE-1-MDY-R REDEFINES
   925                      DC-GREG-DATE-1-MDY.
   926             20  DC-MDY-MONTH          PIC 99.
   927             20  DC-MDY-DAY            PIC 99.
   928             20  DC-MDY-YEAR           PIC 99.
   929         16  DC-GREG-DATE-1-ALPHA.
   930             20  DC-ALPHA-MONTH        PIC X(10).
   931             20  DC-ALPHA-DAY          PIC 99.
   932             20  FILLER                PIC XX.
   933             20  DC-ALPHA-CENTURY.
   934                 24 DC-ALPHA-CEN-N     PIC 99.
   935             20  DC-ALPHA-YEAR         PIC 99.
   936         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   937         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   938         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   939         16  DC-JULIAN-DATE            PIC 9(05).
   940         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  20
* EL151.cbl
   941                                       PIC 9(05).
   942         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   943             20  DC-JULIAN-YEAR        PIC 99.
   944             20  DC-JULIAN-DAYS        PIC 999.
   945         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   946         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   947         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   948     12  DATE-CONVERSION-VARIBLES.
   949         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   950         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   951             20  FILLER                PIC 9(3).
   952             20  HOLD-CEN-1-CCYY.
   953                 24  HOLD-CEN-1-CC     PIC 99.
   954                 24  HOLD-CEN-1-YY     PIC 99.
   955             20  HOLD-CEN-1-MO         PIC 99.
   956             20  HOLD-CEN-1-DA         PIC 99.
   957         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   958             20  HOLD-CEN-1-R-MO       PIC 99.
   959             20  HOLD-CEN-1-R-DA       PIC 99.
   960             20  HOLD-CEN-1-R-CCYY.
   961                 24  HOLD-CEN-1-R-CC   PIC 99.
   962                 24  HOLD-CEN-1-R-YY   PIC 99.
   963             20  FILLER                PIC 9(3).
   964         16  HOLD-CENTURY-1-X.
   965             20  FILLER                PIC X(3)  VALUE SPACES.
   966             20  HOLD-CEN-1-X-CCYY.
   967                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   968                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   969             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   970             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   971         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   972             20  HOLD-CEN-1-R-X-MO     PIC XX.
   973             20  HOLD-CEN-1-R-X-DA     PIC XX.
   974             20  HOLD-CEN-1-R-X-CCYY.
   975                 24  HOLD-CEN-1-R-X-CC PIC XX.
   976                 24  HOLD-CEN-1-R-X-YY PIC XX.
   977             20  FILLER                PIC XXX.
   978         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   979         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   980         16  DC-JULIAN-DATE-1          PIC 9(07).
   981         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   982             20  DC-JULIAN-1-CCYY.
   983                 24  DC-JULIAN-1-CC    PIC 99.
   984                 24  DC-JULIAN-1-YR    PIC 99.
   985             20  DC-JULIAN-DA-1        PIC 999.
   986         16  DC-JULIAN-DATE-2          PIC 9(07).
   987         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   988             20  DC-JULIAN-2-CCYY.
   989                 24  DC-JULIAN-2-CC    PIC 99.
   990                 24  DC-JULIAN-2-YR    PIC 99.
   991             20  DC-JULIAN-DA-2        PIC 999.
   992         16  DC-GREG-DATE-A-EDIT.
   993             20  DC-EDITA-MONTH        PIC 99.
   994             20  SLASHA-1              PIC X VALUE '/'.
   995             20  DC-EDITA-DAY          PIC 99.
   996             20  SLASHA-2              PIC X VALUE '/'.
   997             20  DC-EDITA-CCYY.
   998                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  21
* EL151.cbl
   999                 24  DC-EDITA-YEAR     PIC 99.
  1000         16  DC-GREG-DATE-B-EDIT.
  1001             20  DC-EDITB-MONTH        PIC 99.
  1002             20  SLASHB-1              PIC X VALUE '/'.
  1003             20  DC-EDITB-DAY          PIC 99.
  1004             20  SLASHB-2              PIC X VALUE '/'.
  1005             20  DC-EDITB-CCYY.
  1006                 24  DC-EDITB-CENT     PIC 99.
  1007                 24  DC-EDITB-YEAR     PIC 99.
  1008         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1009         16  DC-GREG-DATE-CYMD-R REDEFINES
  1010                              DC-GREG-DATE-CYMD.
  1011             20  DC-CYMD-CEN           PIC 99.
  1012             20  DC-CYMD-YEAR          PIC 99.
  1013             20  DC-CYMD-MONTH         PIC 99.
  1014             20  DC-CYMD-DAY           PIC 99.
  1015         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1016         16  DC-GREG-DATE-MDCY-R REDEFINES
  1017                              DC-GREG-DATE-MDCY.
  1018             20  DC-MDCY-MONTH         PIC 99.
  1019             20  DC-MDCY-DAY           PIC 99.
  1020             20  DC-MDCY-CEN           PIC 99.
  1021             20  DC-MDCY-YEAR          PIC 99.
  1022    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1023        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1024    12  DC-EL310-DATE                  PIC X(21).
  1025    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  22
* EL151.cbl
  1027*                                    COPY ELCEMIB.
  1028******************************************************************
  1029*                                                                *
  1030*                                                                *
  1031*                            ELCEMIB.                            *
  1032*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1033*                            VMOD=2.005                          *
  1034*                                                                *
  1035*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1036*                                                                *
  1037******************************************************************
  1038 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1039     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1040     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1041     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1042     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1043     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1044     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1045     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1046     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1047     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1048         88  EMI-NO-ERRORS                    VALUE '1'.
  1049         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1050         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1051     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1052         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1053     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1054         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1055         88  EMI-AREA1-FULL                   VALUE '2'.
  1056     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1057         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1058         88  EMI-AREA2-FULL                   VALUE '2'.
  1059     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1060         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1061         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1062         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1063         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1064         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1065     12  EMI-ERROR-LINES.
  1066         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1067         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1068         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1069         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1070             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1071                 24  EMI-ERR-NUM         PIC X(4).
  1072                 24  EMI-FILLER          PIC X.
  1073                 24  EMI-SEV             PIC X.
  1074                 24  FILLER              PIC X.
  1075             20  FILLER                  PIC X(02).
  1076     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1077         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1078             20  EMI-ERROR-NUMBER    PIC X(4).
  1079             20  EMI-FILL            PIC X.
  1080             20  EMI-SEVERITY        PIC X.
  1081             20  FILLER              PIC X.
  1082             20  EMI-ERROR-TEXT.
  1083                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1084                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  23
* EL151.cbl
  1085     12  EMI-SEVERITY-SAVE           PIC X.
  1086         88  EMI-NOTE                    VALUE 'N'.
  1087         88  EMI-WARNING                 VALUE 'W'.
  1088         88  EMI-FORCABLE                VALUE 'F'.
  1089         88  EMI-FATAL                   VALUE 'X'.
  1090     12  EMI-MESSAGE-FLAG            PIC X.
  1091         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1092         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1093     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1094     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1095         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1096         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1097         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1098     12  emi-claim-no                pic x(7).
  1099     12  emi-claim-type              pic x(6).
  1100     12  FILLER                      PIC X(124)  VALUE SPACES.
  1101     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1102     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1103     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1104     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  24
* EL151.cbl
  1106*                                    COPY EL151S.
  1107 01  EL151AI.
  1108     05  FILLER            PIC  X(0012).
  1109*    -------------------------------
  1110     05  MRNDATEL PIC S9(0004) COMP.
  1111     05  MRNDATEF PIC  X(0001).
  1112     05  FILLER REDEFINES MRNDATEF.
  1113         10  MRNDATEA PIC  X(0001).
  1114     05  MRNDATEI PIC  X(0008).
  1115*    -------------------------------
  1116     05  MRNTIMEL PIC S9(0004) COMP.
  1117     05  MRNTIMEF PIC  X(0001).
  1118     05  FILLER REDEFINES MRNTIMEF.
  1119         10  MRNTIMEA PIC  X(0001).
  1120     05  MRNTIMEI PIC  X(0005).
  1121*    -------------------------------
  1122     05  MLINE1L PIC S9(0004) COMP.
  1123     05  MLINE1F PIC  X(0001).
  1124     05  FILLER REDEFINES MLINE1F.
  1125         10  MLINE1A PIC  X(0001).
  1126     05  MLINE1I PIC  X(0060).
  1127*    -------------------------------
  1128     05  MLINE2L PIC S9(0004) COMP.
  1129     05  MLINE2F PIC  X(0001).
  1130     05  FILLER REDEFINES MLINE2F.
  1131         10  MLINE2A PIC  X(0001).
  1132     05  MLINE2I PIC  X(0060).
  1133*    -------------------------------
  1134     05  MDENCDL PIC S9(0004) COMP.
  1135     05  MDENCDF PIC  X(0001).
  1136     05  FILLER REDEFINES MDENCDF.
  1137         10  MDENCDA PIC  X(0001).
  1138     05  MDENCDI PIC  X(0004).
  1139*    -------------------------------
  1140     05  MPRFDTL PIC S9(0004) COMP.
  1141     05  MPRFDTF PIC  X(0001).
  1142     05  FILLER REDEFINES MPRFDTF.
  1143         10  MPRFDTA PIC  X(0001).
  1144     05  MPRFDTI PIC  X(0008).
  1145*    -------------------------------
  1146     05  MERMSG1L PIC S9(0004) COMP.
  1147     05  MERMSG1F PIC  X(0001).
  1148     05  FILLER REDEFINES MERMSG1F.
  1149         10  MERMSG1A PIC  X(0001).
  1150     05  MERMSG1I PIC  X(0070).
  1151*    -------------------------------
  1152     05  MERMSG2L PIC S9(0004) COMP.
  1153     05  MERMSG2F PIC  X(0001).
  1154     05  FILLER REDEFINES MERMSG2F.
  1155         10  MERMSG2A PIC  X(0001).
  1156     05  MERMSG2I PIC  X(0070).
  1157*    -------------------------------
  1158     05  MPFNUMBL PIC S9(0004) COMP.
  1159     05  MPFNUMBF PIC  X(0001).
  1160     05  FILLER REDEFINES MPFNUMBF.
  1161         10  MPFNUMBA PIC  X(0001).
  1162     05  MPFNUMBI PIC  99.
  1163 01  EL151AO REDEFINES EL151AI.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  25
* EL151.cbl
  1164     05  FILLER            PIC  X(0012).
  1165*    -------------------------------
  1166     05  FILLER            PIC  X(0003).
  1167     05  MRNDATEO PIC  X(0008).
  1168*    -------------------------------
  1169     05  FILLER            PIC  X(0003).
  1170     05  MRNTIMEO PIC  99.99.
  1171*    -------------------------------
  1172     05  FILLER            PIC  X(0003).
  1173     05  MLINE1O PIC  X(0060).
  1174*    -------------------------------
  1175     05  FILLER            PIC  X(0003).
  1176     05  MLINE2O PIC  X(0060).
  1177*    -------------------------------
  1178     05  FILLER            PIC  X(0003).
  1179     05  MDENCDO PIC  X(0004).
  1180*    -------------------------------
  1181     05  FILLER            PIC  X(0003).
  1182     05  MPRFDTO PIC  99B99B99.
  1183*    -------------------------------
  1184     05  FILLER            PIC  X(0003).
  1185     05  MERMSG1O PIC  X(0070).
  1186*    -------------------------------
  1187     05  FILLER            PIC  X(0003).
  1188     05  MERMSG2O PIC  X(0070).
  1189*    -------------------------------
  1190     05  FILLER            PIC  X(0003).
  1191     05  MPFNUMBO PIC  99.
  1192*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  26
* EL151.cbl
  1194*                                    COPY ELCDMO.
  1195******************************************************************
  1196*                                                                *
  1197*                                                                *
  1198*                            ELCDMO.                             *
  1199*                            VMOD=2.004                          *
  1200*                                                                *
  1201*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  1202*        COMMUNICATION AREA                                      *
  1203*   FILE TYPE = NA                                               *
  1204*   RECORD SIZE = 110    RECFORM = FIXED                         *
  1205*                                                                *
  1206******************************************************************
  1207 01  DMO-COMMUNICATION-AREA.
  1208     12  DM-RECORD-TYPE                  PIC  X(02).
  1209             88  DM-ISSUE-TRAN                VALUE 'CC'.
  1210             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  1211             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  1212     12  DM-DIST-CODE                    PIC  X(04).
  1213     12  DM-MAIL-CODE                    PIC  X(05).
  1214     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  1215     12  DM-INSURED-NAME                 PIC  X(30).
  1216     12  DM-CLAIM-NO                     PIC  X(07).
  1217     12  DM-CLAIM-TYPE                   PIC  X.
  1218
  1219     12  DM-STATUS-DATA-AREA.
  1220         16  DM-CLAIM-STATUS             PIC  X.
  1221             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  1222             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  1223             88  DM-CLOSED                        VALUE '3'.
  1224             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  1225             88  DM-DEFAULT                       VALUE '9'.
  1226         16  DM-STATUS-DATE              PIC  X(08).
  1227******YYYYMMDD
  1228         16  DM-STAT-CHANGE-TYPE         PIC  X.
  1229             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  1230             88  DM-CLAIM-DENIED                  VALUE 'D'.
  1231             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  1232             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  1233             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  1234             88  DM-RE-OPENED                     VALUE 'R'.
  1235             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  1236             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  1237             88  DM-CLAIM-DELETED                 VALUE 'X'.
  1238         16  DM-STAT-CARRIER             PIC X.
  1239
  1240     12  DM-DRAFT-DATA-AREA.
  1241         16  DM-PAYMENT-TYPE             PIC  X.
  1242             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  1243         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  1244         16  DM-PAYMENT-DATE             PIC  X(08).
  1245******YYYYMMDD
  1246         16  DM-CERT-NO                  PIC  X(11).
  1247         16  DM-TRLR-SEQ-NO              PIC  9(04).
  1248         16  DM-CARRIER                  PIC  X.
  1249
  1250     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  27
* EL151.cbl
  1252****************************************************************
  1253*
  1254* Copyright (c) 2007 by Clerity Solutions, Inc.
  1255* All rights reserved.
  1256*
  1257****************************************************************
  1258 01  DFHEIV.
  1259   02  DFHEIV0               PIC X(35).
  1260   02  DFHEIV1               PIC X(08).
  1261   02  DFHEIV2               PIC X(08).
  1262   02  DFHEIV3               PIC X(08).
  1263   02  DFHEIV4               PIC X(06).
  1264   02  DFHEIV5               PIC X(04).
  1265   02  DFHEIV6               PIC X(04).
  1266   02  DFHEIV7               PIC X(02).
  1267   02  DFHEIV8               PIC X(02).
  1268   02  DFHEIV9               PIC X(01).
  1269   02  DFHEIV10              PIC S9(7) COMP-3.
  1270   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1271   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1272   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1273   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1274   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1275   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1276   02  DFHEIV17              PIC X(04).
  1277   02  DFHEIV18              PIC X(04).
  1278   02  DFHEIV19              PIC X(04).
  1279   02  DFHEIV20              USAGE IS POINTER.
  1280   02  DFHEIV21              USAGE IS POINTER.
  1281   02  DFHEIV22              USAGE IS POINTER.
  1282   02  DFHEIV23              USAGE IS POINTER.
  1283   02  DFHEIV24              USAGE IS POINTER.
  1284   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1285   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1286   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1287   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1288   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1289   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1290   02  FILLER                PIC X(02).
  1291   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1292   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1293   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1294   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1295   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1296 LINKAGE  SECTION.
  1297*****************************************************************
  1298*                                                               *
  1299* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1300* All rights reserved.                                          *
  1301*                                                               *
  1302*****************************************************************
  1303 01  dfheiblk.
  1304     02  eibtime          pic s9(7) comp-3.
  1305     02  eibdate          pic s9(7) comp-3.
  1306     02  eibtrnid         pic x(4).
  1307     02  eibtaskn         pic s9(7) comp-3.
  1308     02  eibtrmid         pic x(4).
  1309     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  28
* EL151.cbl
  1310     02  eibcposn         pic s9(4) comp.
  1311     02  eibcalen         pic s9(4) comp.
  1312     02  eibaid           pic x(1).
  1313     02  eibfiller1       pic x(1).
  1314     02  eibfn            pic x(2).
  1315     02  eibfiller2       pic x(2).
  1316     02  eibrcode         pic x(6).
  1317     02  eibfiller3       pic x(2).
  1318     02  eibds            pic x(8).
  1319     02  eibreqid         pic x(8).
  1320     02  eibrsrce         pic x(8).
  1321     02  eibsync          pic x(1).
  1322     02  eibfree          pic x(1).
  1323     02  eibrecv          pic x(1).
  1324     02  eibsend          pic x(1).
  1325     02  eibatt           pic x(1).
  1326     02  eibeoc           pic x(1).
  1327     02  eibfmh           pic x(1).
  1328     02  eibcompl         pic x(1).
  1329     02  eibsig           pic x(1).
  1330     02  eibconf          pic x(1).
  1331     02  eiberr           pic x(1).
  1332     02  eibrldbk         pic x(1).
  1333     02  eiberrcd         pic x(4).
  1334     02  eibsynrb         pic x(1).
  1335     02  eibnodat         pic x(1).
  1336     02  eibfiller5       pic x(2).
  1337     02  eibresp          pic 9(09) comp.
  1338     02  eibresp2         pic 9(09) comp.
  1339     02  dfheigdj         pic s9(4) comp.
  1340     02  dfheigdk         pic s9(4) comp.
  1341 01  DFHCOMMAREA                     PICTURE X(1024).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  29
* EL151.cbl
  1343*                                    COPY ELCMSTR.
  1344******************************************************************
  1345*                                                                *
  1346*                            ELCMSTR.                            *
  1347*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1348*                            VMOD=2.012                          *
  1349*                                                                *
  1350*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  1351*                                                                *
  1352*   FILE TYPE = VSAM,KSDS                                        *
  1353*   RECORD SIZE = 350  RECFORM = FIXED                           *
  1354*                                                                *
  1355*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  1356*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  1357*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  1358*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  1359*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  1360*                                                 RKP=75,LEN=21  *
  1361*                                                                *
  1362*   **** NOTE ****                                               *
  1363*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  1364*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  1365*                                                                *
  1366*   LOG = YES                                                    *
  1367*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1368******************************************************************
  1369*                   C H A N G E   L O G
  1370*
  1371* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1372*-----------------------------------------------------------------
  1373*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1374* EFFECTIVE    NUMBER
  1375*-----------------------------------------------------------------
  1376* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1377* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1378* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  1379* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1380* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1381******************************************************************
  1382 01  CLAIM-MASTER.
  1383     12  CL-RECORD-ID                PIC XX.
  1384         88  VALID-CL-ID         VALUE 'CL'.
  1385
  1386     12  CL-CONTROL-PRIMARY.
  1387         16  CL-COMPANY-CD           PIC X.
  1388         16  CL-CARRIER              PIC X.
  1389         16  CL-CLAIM-NO             PIC X(7).
  1390         16  CL-CERT-NO.
  1391             20  CL-CERT-PRIME       PIC X(10).
  1392             20  CL-CERT-SFX         PIC X.
  1393
  1394     12  CL-CONTROL-BY-NAME.
  1395         16  CL-COMPANY-CD-A1        PIC X.
  1396         16  CL-INSURED-LAST-NAME    PIC X(15).
  1397         16  CL-INSURED-NAME.
  1398             20  CL-INSURED-1ST-NAME PIC X(12).
  1399             20  CL-INSURED-MID-INIT PIC X.
  1400
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  30
* EL151.cbl
  1401     12  CL-CONTROL-BY-SSN.
  1402         16  CL-COMPANY-CD-A2        PIC X.
  1403         16  CL-SOC-SEC-NO.
  1404             20  CL-SSN-STATE        PIC XX.
  1405             20  CL-SSN-ACCOUNT      PIC X(6).
  1406             20  CL-SSN-LN3          PIC X(3).
  1407
  1408     12  CL-CONTROL-BY-CERT-NO.
  1409         16  CL-COMPANY-CD-A4        PIC X.
  1410         16  CL-CERT-NO-A4.
  1411             20  CL-CERT-A4-PRIME    PIC X(10).
  1412             20  CL-CERT-A4-SFX      PIC X.
  1413
  1414     12  CL-CONTROL-BY-CCN.
  1415         16  CL-COMPANY-CD-A5        PIC X.
  1416         16  CL-CCN-A5.
  1417             20  CL-CCN.
  1418                 24  CL-CCN-PREFIX-A5 PIC X(4).
  1419                 24  CL-CCN-PRIME-A5 PIC X(12).
  1420             20  CL-CCN-FILLER-A5    PIC X(4).
  1421
  1422     12  CL-INSURED-PROFILE-DATA.
  1423         16  CL-INSURED-BIRTH-DT     PIC XX.
  1424         16  CL-INSURED-SEX-CD       PIC X.
  1425             88  INSURED-IS-MALE        VALUE 'M'.
  1426             88  INSURED-IS-FEMALE      VALUE 'F'.
  1427             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  1428         16  CL-INSURED-OCC-CD       PIC X(6).
  1429         16  FILLER                  PIC X(5).
  1430
  1431     12  CL-PROCESSING-INFO.
  1432         16  CL-PROCESSOR-ID         PIC X(4).
  1433         16  CL-CLAIM-STATUS         PIC X.
  1434             88  CLAIM-IS-OPEN          VALUE 'O'.
  1435             88  CLAIM-IS-CLOSED        VALUE 'C'.
  1436         16  CL-CLAIM-TYPE           PIC X.
  1437*            88  AH-CLAIM               VALUE 'A'.
  1438*            88  LIFE-CLAIM             VALUE 'L'.
  1439*            88  PROPERTY-CLAIM         VALUE 'P'.
  1440*            88  IUI-CLAIM              VALUE 'I'.
  1441*            88  GAP-CLAIM              VALUE 'G'.
  1442*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  1443         16  CL-CLAIM-PREM-TYPE      PIC X.
  1444             88  SINGLE-PREMIUM         VALUE '1'.
  1445             88  O-B-COVERAGE           VALUE '2'.
  1446             88  OPEN-END-COVERAGE      VALUE '3'.
  1447         16  CL-INCURRED-DT          PIC XX.
  1448         16  CL-REPORTED-DT          PIC XX.
  1449         16  CL-FILE-ESTABLISH-DT    PIC XX.
  1450         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  1451         16  CL-LAST-PMT-DT          PIC XX.
  1452         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  1453         16  CL-PAID-THRU-DT         PIC XX.
  1454         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  1455         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  1456         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  1457         16  CL-PMT-CALC-METHOD      PIC X.
  1458             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  31
* EL151.cbl
  1459             88  CL-365-DAY-YR          VALUE '2'.
  1460             88  CL-FULL-MONTHS         VALUE '3'.
  1461         16  CL-CAUSE-CD             PIC X(6).
  1462
  1463         16  CL-PRIME-CERT-NO.
  1464             20  CL-PRIME-CERT-PRIME PIC X(10).
  1465             20  CL-PRIME-CERT-SFX   PIC X.
  1466
  1467         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  1468             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  1469             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  1470
  1471         16  CL-MICROFILM-NO         PIC X(10).
  1472         16  FILLER REDEFINES CL-MICROFILM-NO.
  1473             20  CL-BENEFIT-PERIOD   PIC 99.
  1474             20  FILLER              PIC X(8).
  1475         16  CL-PROG-FORM-TYPE       PIC X.
  1476         16  CL-LAST-ADD-ON-DT       PIC XX.
  1477
  1478         16  CL-LAST-REOPEN-DT       PIC XX.
  1479         16  CL-LAST-CLOSE-DT        PIC XX.
  1480         16  CL-LAST-CLOSE-REASON    PIC X(01).
  1481             88  FINAL-PAID             VALUE '1'.
  1482             88  CLAIM-DENIED           VALUE '2'.
  1483             88  AUTO-CLOSE             VALUE '3'.
  1484             88  MANUAL-CLOSE           VALUE '4'.
  1485             88  BENEFITS-CHANGED       VALUE 'C'.
  1486             88  SETUP-ERRORS           VALUE 'E'.
  1487         16  CL-ASSOC-CERT-SEQU      PIC S99.
  1488         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  1489         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  1490             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  1491         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  1492         16  FILLER                  PIC X.
  1493
  1494     12  CL-CERTIFICATE-DATA.
  1495         16  CL-CERT-ORIGIN          PIC X.
  1496             88  CERT-WAS-ONLINE        VALUE '1'.
  1497             88  CERT-WAS-CREATED       VALUE '2'.
  1498             88  COVERAGE-WAS-ADDED     VALUE '3'.
  1499         16  CL-CERT-KEY-DATA.
  1500             20  CL-CERT-CARRIER     PIC X.
  1501             20  CL-CERT-GROUPING    PIC X(6).
  1502             20  CL-CERT-STATE       PIC XX.
  1503             20  CL-CERT-ACCOUNT.
  1504                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  1505                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  1506             20  CL-CERT-EFF-DT      PIC XX.
  1507
  1508     12  CL-STATUS-CONTROLS.
  1509         16  CL-PRIORITY-CD          PIC X.
  1510             88  CONFIDENTIAL-DATA      VALUE '8'.
  1511             88  HIGHEST-PRIORITY       VALUE '9'.
  1512         16  CL-SUPV-ATTN-CD         PIC X.
  1513             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  1514             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  1515         16  CL-PURGED-DT            PIC XX.
  1516         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  32
* EL151.cbl
  1517         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  1518         16  CL-NEXT-RESEND-DT       PIC XX.
  1519         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  1520         16  CL-CRITICAL-PERIOD      PIC 99.
  1521*        16  FILLER                  PIC XX.
  1522         16  CL-LAST-MAINT-DT        PIC XX.
  1523         16  CL-LAST-MAINT-USER      PIC X(4).
  1524         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  1525         16  CL-LAST-MAINT-TYPE      PIC X.
  1526             88  CLAIM-SET-UP           VALUE ' '.
  1527             88  PAYMENT-MADE           VALUE '1'.
  1528             88  LETTER-SENT            VALUE '2'.
  1529             88  MASTER-WAS-ALTERED     VALUE '3'.
  1530             88  MASTER-WAS-RESTORED    VALUE '4'.
  1531             88  INCURRED-DATE-CHANGED  VALUE '5'.
  1532             88  FILE-CONVERTED         VALUE '6'.
  1533             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  1534             88  ERROR-CORRECTION       VALUE 'E'.
  1535         16  CL-RELATED-CLAIM-NO     PIC X(7).
  1536         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  1537         16  CL-BENEFICIARY          PIC X(10).
  1538         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  1539         16  CL-DENIAL-TYPE          PIC X.
  1540             88  CL-TYPE-DENIAL          VALUE '1'.
  1541             88  CL-TYPE-RESCISSION      VALUE '2'.
  1542             88  CL-TYPE-REFORMATION     VALUE '3'.
  1543             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  1544             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  1545         16  filler                  pic x(5).
  1546*        16  CL-CRIT-PER-RECURRENT   PIC X.
  1547*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  1548*        16  CL-RTW-DT               PIC XX.
  1549
  1550     12  CL-TRAILER-CONTROLS.
  1551         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  1552             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  1553             88  CL-LAST-TRL-AVAIL      VALUE +100.
  1554             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  1555         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  1556         16  FILLER                  PIC XX.
  1557         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  1558         16  CL-ADDRESS-TRAILER-CNT.
  1559             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  1560                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  1561             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  1562                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  1563             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  1564                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  1565             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  1566                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  1567             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  1568                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  1569             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  1570                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  1571             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  1572                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  1573
  1574     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  33
* EL151.cbl
  1575         16  CL-CV-REFNO-PRIME       PIC X(18).
  1576         16  CL-CV-REFNO-SFX         PIC XX.
  1577
  1578     12  CL-FILE-LOCATION            PIC X(4).
  1579
  1580     12  CL-PROCESS-ERRORS.
  1581         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  1582             88  NO-FATAL-ERRORS        VALUE ZERO.
  1583         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  1584             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  1585
  1586     12  CL-PRODUCT-CD               PIC X.
  1587
  1588     12  CL-CURRENT-KEY-DATA.
  1589         16  CL-CURRENT-CARRIER      PIC X.
  1590         16  CL-CURRENT-GROUPING     PIC X(6).
  1591         16  CL-CURRENT-STATE        PIC XX.
  1592         16  CL-CURRENT-ACCOUNT      PIC X(10).
  1593
  1594     12  CL-ASSOCIATES               PIC X.
  1595         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  1596         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  1597         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  1598         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  1599
  1600     12  CL-ACTIVITY-CODE            PIC 99.
  1601     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  1602     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  1603
  1604     12  CL-LAPSE-REPORT-CODE        PIC 9.
  1605     12  CL-LAG-REPORT-CODE          PIC 9.
  1606     12  CL-LOAN-TYPE                PIC XX.
  1607     12  CL-LEGAL-STATE              PIC XX.
  1608
  1609     12  CL-YESNOSW                  PIC X.
  1610     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  1611         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  1612         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  1613         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  1614     12  cl-insured-type             pic x.
  1615         88  cl-claim-on-primary         value 'P'.
  1616         88  cl-claim-on-co-borrower     value 'C'.
  1617     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  34
* EL151.cbl
  1619*                                    COPY ELCTRLR.
  1620******************************************************************
  1621*                                                                *
  1622*                            ELCTRLR.                            *
  1623*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1624*                            VMOD=2.014                          *
  1625*                                                                *
  1626*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  1627*                                                                *
  1628*   FILE TYPE = VSAM,KSDS                                        *
  1629*   RECORD SIZE = 200    RECFORM = FIXED                         *
  1630*                                                                *
  1631*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  1632*       ALTERNATE INDEX = NONE                                   *
  1633*                                                                *
  1634*   LOG = YES                                                    *
  1635*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1636******************************************************************
  1637*                   C H A N G E   L O G
  1638*
  1639* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1640*-----------------------------------------------------------------
  1641*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1642* EFFECTIVE    NUMBER
  1643*-----------------------------------------------------------------
  1644* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1645* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  1646* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  1647* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  1648* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  1649* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  1650* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  1651* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  1652* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  1653* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  1654* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  1655* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  1656* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  1657* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  1658* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  1659* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  1660* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  1661* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  1662* 040814    2014030500002  AJRA  ADD ICD CODES
  1663* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1664******************************************************************
  1665 01  ACTIVITY-TRAILERS.
  1666     12  AT-RECORD-ID                    PIC XX.
  1667         88  VALID-AT-ID                       VALUE 'AT'.
  1668
  1669     12  AT-CONTROL-PRIMARY.
  1670         16  AT-COMPANY-CD               PIC X.
  1671         16  AT-CARRIER                  PIC X.
  1672         16  AT-CLAIM-NO                 PIC X(7).
  1673         16  AT-CERT-NO.
  1674             20  AT-CERT-PRIME           PIC X(10).
  1675             20  AT-CERT-SFX             PIC X.
  1676         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  35
* EL151.cbl
  1677             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  1678             88  AT-LAST-TRL-AVAIL            VALUE +100.
  1679             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  1680             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  1681             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  1682             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  1683             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  1684             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  1685             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  1686             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  1687             88  AT-DIAGNOSIS-TRL             VALUE +90.
  1688             88  AT-BENEFICIARY-TRL           VALUE +91.
  1689             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  1690             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  1691             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  1692             88  AT-ERROR-MSGS-TRL            VALUE +95.
  1693
  1694     12  AT-TRAILER-TYPE                 PIC X.
  1695         88  RESERVE-EXPENSE-TR               VALUE '1'.
  1696         88  PAYMENT-TR                       VALUE '2'.
  1697         88  AUTO-PAY-TR                      VALUE '3'.
  1698         88  CORRESPONDENCE-TR                VALUE '4'.
  1699         88  ADDRESS-TR                       VALUE '5'.
  1700         88  GENERAL-INFO-TR                  VALUE '6'.
  1701         88  AUTO-PROMPT-TR                   VALUE '7'.
  1702         88  DENIAL-TR                        VALUE '8'.
  1703         88  INCURRED-CHG-TR                  VALUE '9'.
  1704         88  FORM-CONTROL-TR                  VALUE 'A'.
  1705
  1706     12  AT-RECORDED-DT                  PIC XX.
  1707     12  AT-RECORDED-BY                  PIC X(4).
  1708     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  1709
  1710     12  AT-TRAILER-BODY                 PIC X(165).
  1711
  1712     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  1713         16  AT-RESERVE-CONTROLS.
  1714             20  AT-MANUAL-SW            PIC X.
  1715                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  1716             20  AT-FUTURE-SW            PIC X.
  1717                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  1718             20  AT-PTC-SW               PIC X.
  1719                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  1720             20  AT-IBNR-SW              PIC X.
  1721                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  1722             20  AT-PTC-LF-SW            PIC X.
  1723                 88  AT-LF-PTC-USED          VALUE '1'.
  1724             20  AT-CDT-ACCESS-METHOD    PIC X.
  1725                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  1726                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  1727                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  1728             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  1729         16  AT-LAST-COMPUTED-DT         PIC XX.
  1730         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  1731         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  1732         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  1733         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  1734         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  36
* EL151.cbl
  1735         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  1736         16  AT-EXPENSE-CONTROLS.
  1737             20  AT-EXPENSE-METHOD       PIC X.
  1738                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  1739                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  1740                 88  PERCENT-OF-PMT           VALUE '3'.
  1741                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  1742             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  1743             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  1744         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  1745         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  1746
  1747         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  1748         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  1749
  1750*        16  FILLER                      PIC X(53).
  1751         16  FILLER                      PIC X(47).
  1752
  1753         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  1754         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  1755
  1756         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  1757             20  AT-OPEN-CLOSE-DATE      PIC XX.
  1758             20  AT-OPEN-CLOSE-TYPE      PIC X.
  1759*                    C = CLOSED
  1760*                    O = OPEN
  1761             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  1762*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  1763
  1764     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  1765         16  AT-PAYMENT-TYPE             PIC X.
  1766             88  PARTIAL-PAYMENT                VALUE '1'.
  1767             88  FINAL-PAYMENT                  VALUE '2'.
  1768             88  LUMP-SUM-PAYMENT               VALUE '3'.
  1769             88  ADDITIONAL-PAYMENT             VALUE '4'.
  1770             88  CHARGEABLE-EXPENSE             VALUE '5'.
  1771             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  1772             88  VOIDED-PAYMENT                 VALUE '9'.
  1773             88  TRANSFER                       VALUE 'T'.
  1774             88  LIFE-INTEREST                  VALUE 'I'.
  1775
  1776         16  AT-CLAIM-TYPE               PIC X.
  1777             88  PAID-FOR-AH                    VALUE 'A'.
  1778             88  PAID-FOR-LIFE                  VALUE 'L'.
  1779             88  PAID-FOR-IUI                   VALUE 'I'.
  1780             88  PAID-FOR-GAP                   VALUE 'G'.
  1781             88  PAID-FOR-FAM                   VALUE 'F'.
  1782         16  AT-CLAIM-PREM-TYPE          PIC X.
  1783             88  AT-SINGLE-PREMIUM              VALUE '1'.
  1784             88  AT-O-B-COVERAGE                VALUE '2'.
  1785             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  1786         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  1787         16  AT-CHECK-NO                 PIC X(7).
  1788         16  AT-PAID-FROM-DT             PIC XX.
  1789         16  AT-PAID-THRU-DT             PIC XX.
  1790         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  1791         16  FILLER                      PIC X.
  1792         16  AT-PAYEES-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  37
* EL151.cbl
  1793         16  AT-PAYMENT-ORIGIN           PIC X.
  1794             88  ONLINE-MANUAL-PMT              VALUE '1'.
  1795             88  ONLINE-AUTO-PMT                VALUE '2'.
  1796             88  OFFLINE-PMT                    VALUE '3'.
  1797         16  AT-CHECK-WRITTEN-DT         PIC XX.
  1798         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  1799         16  AT-VOID-DATA.
  1800             20  AT-VOID-DT              PIC XX.
  1801*00144       20  AT-VOID-REASON          PIC X(30).
  1802             20  AT-VOID-REASON          PIC X(26).
  1803         16  AT-PMT-APPROVED-BY          PIC X(04).
  1804         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  1805         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  1806         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  1807                                         PIC S99V9(5)  COMP-3.
  1808         16  AT-CREDIT-INTERFACE.
  1809             20  AT-PMT-SELECT-DT        PIC XX.
  1810                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  1811             20  AT-PMT-ACCEPT-DT        PIC XX.
  1812                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  1813             20  AT-VOID-SELECT-DT       PIC XX.
  1814                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  1815             20  AT-VOID-ACCEPT-DT       PIC XX.
  1816                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  1817
  1818         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  1819                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  1820                 88  CONVERSION-PAYMENT           VALUE +99999999.
  1821         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  1822
  1823         16  AT-FORCE-CONTROL            PIC X.
  1824             88  PAYMENT-WAS-FORCED           VALUE '1'.
  1825         16  AT-PREV-LAST-PMT-DT         PIC XX.
  1826         16  AT-PREV-PAID-THRU-DT        PIC XX.
  1827         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  1828         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  1829         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  1830         16  AT-BENEFIT-TYPE             PIC X.
  1831
  1832         16  AT-EXPENSE-TYPE             PIC X.
  1833         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  1834
  1835         16  AT-PAYEE-TYPE-CD.
  1836             20  AT-PAYEE-TYPE           PIC X.
  1837                 88  INSURED-PAID           VALUE 'I'.
  1838                 88  BENEFICIARY-PAID       VALUE 'B'.
  1839                 88  ACCOUNT-PAID           VALUE 'A'.
  1840                 88  OTHER-1-PAID           VALUE 'O'.
  1841                 88  OTHER-2-PAID           VALUE 'Q'.
  1842                 88  DOCTOR-PAID            VALUE 'P'.
  1843                 88  EMPLOYER-PAID          VALUE 'E'.
  1844             20  AT-PAYEE-SEQ            PIC X.
  1845
  1846         16  AT-CASH-PAYMENT             PIC X.
  1847         16  AT-GROUPED-PAYMENT          PIC X.
  1848         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  1849         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  1850         16  AT-APPROVED-LEVEL           PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  38
* EL151.cbl
  1851         16  AT-VOID-TYPE                PIC X.
  1852             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  1853             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  1854         16  AT-AIG-UNEMP-IND            PIC X.
  1855             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  1856         16  AT-ASSOCIATES               PIC X.
  1857             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  1858             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  1859
  1860         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  1861         16  AT-CV-PMT-CODE              PIC X.
  1862             88  FULL-DEATH-PAYMENT         VALUE '1'.
  1863             88  HALF-DEATH-PAYMENT         VALUE '2'.
  1864             88  FULL-ADD-PAYMENT           VALUE '3'.
  1865             88  HALF-ADD-PAYMENT           VALUE '4'.
  1866             88  FULL-RIDER-PAYMENT         VALUE '5'.
  1867             88  HALF-RIDER-PAYMENT         VALUE '6'.
  1868             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  1869             88  ADDL-PAYMENT               VALUE '8'.
  1870
  1871         16  AT-EOB-CODE1                PIC XXX.
  1872         16  AT-EOB-CODE2                PIC XXX.
  1873         16  AT-EOB-CODE3                PIC XXX.
  1874         16  FILLER REDEFINES AT-EOB-CODE3.
  1875             20  AT-PRINT-CLM-FORM       PIC X.
  1876             20  AT-PRINT-SURVEY         PIC X.
  1877             20  AT-SPECIAL-RELEASE      PIC X.
  1878         16  AT-EOB-CODE4                PIC XXX.
  1879         16  FILLER REDEFINES AT-EOB-CODE4.
  1880             20  AT-INT-PMT-SELECT-DT    PIC XX.
  1881             20  FILLER                  PIC X.
  1882         16  AT-EOB-CODE5                PIC XXX.
  1883         16  FILLER REDEFINES AT-EOB-CODE5.
  1884             20  AT-PMT-PROOF-DT         PIC XX.
  1885             20  FILLER                  PIC X.
  1886
  1887         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  1888             88  AT-PRINT-EOB            VALUE 'Y'.
  1889
  1890         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  1891         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  1892
  1893     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  1894         16  AT-SCHEDULE-START-DT        PIC XX.
  1895         16  AT-SCHEDULE-END-DT          PIC XX.
  1896         16  AT-TERMINATED-DT            PIC XX.
  1897         16  AT-LAST-PMT-TYPE            PIC X.
  1898             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  1899             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  1900         16  AT-FIRST-PMT-DATA.
  1901             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  1902             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  1903             20  AT-1ST-PAY-THRU-DT      PIC XX.
  1904         16  AT-REGULAR-PMT-DATA.
  1905             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  1906             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  1907             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  1908         16  AT-AUTO-PAYEE-CD.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  39
* EL151.cbl
  1909             20  AT-AUTO-PAYEE-TYPE      PIC X.
  1910                 88  INSURED-PAID-AUTO      VALUE 'I'.
  1911                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  1912                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  1913                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  1914                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  1915             20  AT-AUTO-PAYEE-SEQ       PIC X.
  1916         16  AT-AUTO-PAY-DAY             PIC 99.
  1917         16  AT-AUTO-CASH                PIC X.
  1918             88  AT-CASH                      VALUE 'Y'.
  1919             88  AT-NON-CASH                  VALUE 'N'.
  1920*        16  FILLER                      PIC X(129).
  1921         16  AT-AUTO-END-LETTER          PIC X(4).
  1922         16  FILLER                      PIC X(125).
  1923
  1924         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  1925         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  1926
  1927     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  1928         16  AT-LETTER-SENT-DT           PIC XX.
  1929         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  1930         16  AT-AUTO-RE-SEND-DT          PIC XX.
  1931         16  AT-LETTER-ANSWERED-DT       PIC XX.
  1932         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  1933         16  AT-LETTER-ORIGIN            PIC X.
  1934             88  ONLINE-CREATION              VALUE '1' '3'.
  1935             88  OFFLINE-CREATION             VALUE '2' '4'.
  1936             88  NAPER-ONLINE-CREATION        VALUE '3'.
  1937             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  1938         16  AT-STD-LETTER-FORM          PIC X(4).
  1939         16  AT-REASON-TEXT              PIC X(70).
  1940         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  1941         16  AT-ADDRESEE-TYPE            PIC X.
  1942              88  INSURED-ADDRESEE            VALUE 'I'.
  1943              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  1944              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  1945              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  1946              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  1947              88  OTHER-ADDRESEE-1            VALUE 'O'.
  1948              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  1949         16  AT-ADDRESSEE-NAME           PIC X(30).
  1950         16  AT-INITIAL-PRINT-DATE       PIC XX.
  1951         16  AT-RESEND-PRINT-DATE        PIC XX.
  1952         16  AT-CORR-SOL-UNSOL           PIC X.
  1953         16  AT-LETTER-PURGED-DT         PIC XX.
  1954*
  1955*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  1956*
  1957         16  AT-CSO-REDEFINITION.
  1958             20  AT-RESEND-LETTER-FORM   PIC X(4).
  1959             20  AT-AUTO-CLOSE-IND       PIC X(1).
  1960             20  AT-LETTER-TO-BENE       PIC X(1).
  1961             20  AT-STOP-LETTER-DT       PIC X(2).
  1962             20  FILLER                  PIC X(19).
  1963*             20  FILLER                  PIC X(27).
  1964             20  AT-CSO-LETTER-STATUS    PIC X.
  1965                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  1966                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  40
* EL151.cbl
  1967                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  1968             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  1969             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  1970*
  1971*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  1972*
  1973*        16  FILLER                      PIC X(26).
  1974*
  1975*        16  AT-DMD-BSR-CODE             PIC X.
  1976*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  1977*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  1978*
  1979*        16  AT-DMD-LETTER-STATUS        PIC X.
  1980*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  1981*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  1982*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  1983*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  1984*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  1985
  1986         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  1987         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  1988
  1989     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  1990         16  AT-ADDRESS-TYPE             PIC X.
  1991             88  INSURED-ADDRESS               VALUE 'I'.
  1992             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  1993             88  ACCOUNT-ADDRESS               VALUE 'A'.
  1994             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  1995             88  EMPLOYER-ADDRESS              VALUE 'E'.
  1996             88  OTHER-ADDRESS-1               VALUE 'O'.
  1997             88  OTHER-ADDRESS-2               VALUE 'Q'.
  1998         16  AT-MAIL-TO-NAME             PIC X(30).
  1999         16  AT-ADDRESS-LINE-1           PIC X(30).
  2000         16  AT-ADDRESS-LINE-2           PIC X(30).
  2001         16  AT-CITY-STATE.
  2002             20  AT-CITY                 PIC X(28).
  2003             20  AT-STATE                PIC XX.
  2004         16  AT-ZIP.
  2005             20  AT-ZIP-CODE.
  2006                 24  AT-ZIP-1ST          PIC X.
  2007                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2008                 24  FILLER              PIC X(4).
  2009             20  AT-ZIP-PLUS4            PIC X(4).
  2010         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  2011             20  AT-CAN-POSTAL-1         PIC XXX.
  2012             20  AT-CAN-POSTAL-2         PIC XXX.
  2013             20  FILLER                  PIC XXX.
  2014         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  2015*         16  FILLER                      PIC X(23).
  2016         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  2017         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  2018         16  FILLER                      PIC X(13).
  2019         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  2020         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  2021
  2022     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  2023         16  AT-INFO-LINE-1              PIC X(60).
  2024         16  FILLER REDEFINES AT-INFO-LINE-1.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  41
* EL151.cbl
  2025             20  AT-NOTE-ERROR-NO OCCURS 15
  2026                                         PIC X(4).
  2027         16  AT-INFO-LINE-2              PIC X(60).
  2028         16  FILLER REDEFINES AT-INFO-LINE-2.
  2029             20  AT-ICD-CODE-1           PIC X(8).
  2030             20  AT-ICD-CODE-2           PIC X(8).
  2031             20  FILLER                  PIC X(44).
  2032         16  AT-INFO-TRAILER-TYPE        PIC X.
  2033             88  AT-ERRORS-NOTE          VALUE 'E'.
  2034             88  AT-PAYMENT-NOTE         VALUE 'P'.
  2035             88  AT-CALL-NOTE            VALUE 'C'.
  2036             88  AT-MAINT-NOTE           VALUE 'M'.
  2037             88  AT-CERT-CHANGE          VALUE 'X'.
  2038             88  AT-APPROVAL-NOTE        VALUE 'R'.
  2039             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  2040             88  AT-CERT-CANCELLED       VALUE 'T'.
  2041         16  AT-CALL-TYPE                PIC X.
  2042             88  AT-PHONE-CALL-IN        VALUE 'I'.
  2043             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  2044         16  AT-NOTE-CONTINUATION        PIC X.
  2045             88  AT-CONTINUED-NOTE       VALUE 'X'.
  2046         16  AT-EOB-CODES-EXIST          PIC X.
  2047             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  2048         16  FILLER                      PIC X(35).
  2049         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  2050         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  2051
  2052     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  2053         16  AT-PROMPT-LINE-1            PIC X(60).
  2054         16  AT-PROMPT-LINE-2            PIC X(60).
  2055         16  AT-PROMPT-START-DT          PIC XX.
  2056         16  AT-PROMPT-END-DT            PIC XX.
  2057         16  FILLER                      PIC X(35).
  2058         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  2059         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  2060
  2061     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  2062         16  AT-DENIAL-INFO-1            PIC X(60).
  2063         16  AT-DENIAL-INFO-2            PIC X(60).
  2064         16  AT-DENIAL-DT                PIC XX.
  2065         16  AT-RETRACTION-DT            PIC XX.
  2066         16  AT-DENIAL-REASON-CODE       PIC X(4).
  2067*         16  FILLER                      PIC X(31).
  2068         16  AT-DENIAL-PROOF-DT          PIC XX.
  2069         16  FILLER                      PIC X(29).
  2070         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  2071         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  2072
  2073     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  2074         16  AT-OLD-INCURRED-DT          PIC XX.
  2075         16  AT-OLD-REPORTED-DT          PIC XX.
  2076         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  2077         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  2078         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  2079         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  2080         16  AT-OLD-PAID-THRU-DT         PIC XX.
  2081         16  AT-LAST-PMT-MADE-DT         PIC XX.
  2082         16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  42
* EL151.cbl
  2083         16  AT-OLD-DIAG-CODE            PIC X(6).
  2084         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  2085         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  2086         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  2087         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  2088         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  2089         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  2090         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  2091         16  AT-OLD-ICD-CODE-1           PIC X(8).
  2092         16  AT-OLD-ICD-CODE-2           PIC X(8).
  2093         16  FILLER                      PIC X(9).
  2094         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  2095
  2096     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  2097         16  AT-FORM-SEND-ON-DT          PIC XX.
  2098         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  2099         16  AT-FORM-RE-SEND-DT          PIC XX.
  2100         16  AT-FORM-ANSWERED-DT         PIC XX.
  2101         16  AT-FORM-PRINTED-DT          PIC XX.
  2102         16  AT-FORM-REPRINT-DT          PIC XX.
  2103         16  AT-FORM-TYPE                PIC X.
  2104             88  INITIAL-FORM                  VALUE '1'.
  2105             88  PROGRESS-FORM                 VALUE '2'.
  2106         16  AT-INSTRUCT-LN-1            PIC X(28).
  2107         16  AT-INSTRUCT-LN-2            PIC X(28).
  2108         16  AT-INSTRUCT-LN-3            PIC X(28).
  2109         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  2110         16  AT-FORM-ADDRESS             PIC X.
  2111             88  FORM-TO-INSURED              VALUE 'I'.
  2112             88  FORM-TO-ACCOUNT              VALUE 'A'.
  2113             88  FORM-TO-OTHER-1              VALUE 'O'.
  2114             88  FORM-TO-OTHER-2              VALUE 'Q'.
  2115         16  AT-RELATED-1.
  2116             20 AT-REL-CARR-1            PIC X.
  2117             20 AT-REL-CLAIM-1           PIC X(7).
  2118             20 AT-REL-CERT-1            PIC X(11).
  2119         16  AT-RELATED-2.
  2120             20 AT-REL-CARR-2            PIC X.
  2121             20 AT-REL-CLAIM-2           PIC X(7).
  2122             20 AT-REL-CERT-2            PIC X(11).
  2123         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  2124         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  2125         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  2126         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  2127         16  AT-FORM-REM-PRINT-DT        PIC XX.
  2128         16  AT-STOP-FORM-DT             PIC X(2).
  2129
  2130         16  FILLER                      PIC X(09).
  2131         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  2132         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  2133******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  43
* EL151.cbl
  2135*                                    COPY ELCARCH.
  2136******************************************************************
  2137*                                                                *
  2138*                            ELCARCH.                            *
  2139*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2140*                            VMOD=2.007                          *
  2141*                                                                *
  2142*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  2143*                                                                *
  2144*   FILE TYPE = VSAM,KSDS                                        *
  2145*   RECORD SIZE = 090  RECFORM = FIXED                           *
  2146*                                                                *
  2147*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  2148*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  2149*                                                                *
  2150*   LOG = NO                                                     *
  2151*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2152*                                                                *
  2153*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  2154******************************************************************
  2155 01  LETTER-ARCHIVE.
  2156     12  LA-RECORD-ID                PIC XX.
  2157         88  VALID-LA-ID                VALUE 'LA'.
  2158
  2159     12  LA-CONTROL-PRIMARY.
  2160         16  LA-COMPANY-CD           PIC X.
  2161         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  2162         16  LA-RECORD-TYPE          PIC X.
  2163             88  LA-HEADER-DATA         VALUE '1'.
  2164             88  LA-ADDRESS-DATA        VALUE '2'.
  2165             88  LA-TEXT-DATA           VALUE '3'.
  2166             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  2167         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  2168
  2169     12  LA-CONTROL-BY-TYPE.
  2170         16  LA-COMPANY-CD-A1        PIC X.
  2171         16  LA-RECORD-TYPE-A1       PIC X.
  2172         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  2173         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  2174
  2175     12  LA-TEXT-RECORD.
  2176         16  LA-SKIP-CONTROL         PIC XX.
  2177             88  NO-LINES-SKIPPED       VALUE SPACES.
  2178             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  2179         16  LA-TEXT-LINE            PIC X(70).
  2180
  2181     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  2182         16  FILLER                  PIC XX.
  2183         16  LA-ADDRESS-LINE         PIC X(30).
  2184         16  FILLER                  PIC X(40).
  2185
  2186     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  2187         16  FILLER                  PIC XX.
  2188         16  LA-CARRIER              PIC X.
  2189         16  LA-CLAIM-NO             PIC X(7).
  2190         16  LA-CERT-NO.
  2191             20  LA-CERT-PRIME       PIC X(10).
  2192             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  44
* EL151.cbl
  2193         16  LA-NO-OF-COPIES         PIC S9.
  2194         16  LA-RESEND-DATE          PIC XX.
  2195         16  LA-PROCESSOR-CD         PIC X(4).
  2196         16  LA-CREATION-DT          PIC XX.
  2197         16  LA-INITIAL-PRINT-DATE   PIC XX.
  2198         16  LA-RESEND-PRINT-DATE    PIC XX.
  2199         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  2200         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  2201*
  2202* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  2203*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  2204*   I        20  LA-DMD-PROD-CODE        PIC XX.
  2205*   I        20  LA-DMD-RES-ST           PIC XX.
  2206*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  2207*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  2208*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  2209*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  2210*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  2211*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  2212*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  2213*   I        20  LA-DMD-UND-CODE         PIC XX.
  2214*   I        20  LA-DMD-BEN-CODE         PIC XX.
  2215*   V    16  FILLER                  PIC X(15).
  2216* -----
  2217*
  2218* REINSERTED  CSO  MODS
  2219*
  2220         16  FILLER.
  2221             20  FILLER                  PIC X(29).
  2222             20  LA-CSO-LETTER-STATUS    PIC X.
  2223                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  2224                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  2225                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  2226             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  2227             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  2228*
  2229
  2230     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  2231         16  FILLER                  PIC XX.
  2232         16  LA4-CARRIER             PIC X.
  2233         16  LA4-CLAIM-NO            PIC X(7).
  2234         16  LA4-CERT-NO.
  2235             20  LA4-CERT-PRIME      PIC X(10).
  2236             20  LA4-CERT-SFX        PIC X.
  2237         16  LA4-NO-OF-COPIES        PIC S9.
  2238         16  LA4-RESEND-DATE         PIC XX.
  2239         16  LA4-PROCESSOR-CD        PIC X(4).
  2240         16  LA4-CREATION-DT         PIC XX.
  2241         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  2242         16  LA4-RESEND-PRINT-DATE   PIC XX.
  2243         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  2244         16  LA4-FORM-TYPE           PIC X.
  2245             88  LA4-INITIAL-FORM    VALUE '1'.
  2246             88  LA4-PROGRESS-FORM   VALUE '2'.
  2247         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  2248         16  LA4-STATE               PIC X(02).
  2249         16  FILLER                  PIC X(31).
  2250******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  45
* EL151.cbl
  2252*                                    COPY ELCCNTL.
  2253******************************************************************
  2254*                                                                *
  2255*                                                                *
  2256*                            ELCCNTL.                            *
  2257*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2258*                            VMOD=2.059                          *
  2259*                                                                *
  2260*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2261*                                                                *
  2262*   FILE TYPE = VSAM,KSDS                                        *
  2263*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2264*                                                                *
  2265*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2266*       ALTERNATE INDEX = NONE                                   *
  2267*                                                                *
  2268*   LOG = YES                                                    *
  2269*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2270******************************************************************
  2271*                   C H A N G E   L O G
  2272*
  2273* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2274*-----------------------------------------------------------------
  2275*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2276* EFFECTIVE    NUMBER
  2277*-----------------------------------------------------------------
  2278* 082503                   PEMA  ADD BENEFIT GROUP
  2279* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2280* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2281* 092705    2005050300006  PEMA  ADD SPP LEASES
  2282* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2283* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2284* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2285* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2286* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2287* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2288* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2289* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2290* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2291* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2292******************************************************************
  2293*
  2294 01  CONTROL-FILE.
  2295     12  CF-RECORD-ID                       PIC XX.
  2296         88  VALID-CF-ID                        VALUE 'CF'.
  2297
  2298     12  CF-CONTROL-PRIMARY.
  2299         16  CF-COMPANY-ID                  PIC XXX.
  2300         16  CF-RECORD-TYPE                 PIC X.
  2301             88  CF-COMPANY-MASTER              VALUE '1'.
  2302             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2303             88  CF-STATE-MASTER                VALUE '3'.
  2304             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2305             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2306             88  CF-CARRIER-MASTER              VALUE '6'.
  2307             88  CF-MORTALITY-MASTER            VALUE '7'.
  2308             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2309             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  46
* EL151.cbl
  2310             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2311             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2312             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2313             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2314             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2315             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2316             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2317             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2318             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2319         16  CF-ACCESS-CD-GENL              PIC X(4).
  2320         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2321             20  CF-PROCESSOR               PIC X(4).
  2322         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2323             20  CF-STATE-CODE              PIC XX.
  2324             20  FILLER                     PIC XX.
  2325         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2326             20  FILLER                     PIC XX.
  2327             20  CF-HI-BEN-IN-REC           PIC XX.
  2328         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2329             20  FILLER                     PIC XXX.
  2330             20  CF-CARRIER-CNTL            PIC X.
  2331         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2332             20  FILLER                     PIC XX.
  2333             20  CF-HI-TYPE-IN-REC          PIC 99.
  2334         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2335             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2336                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2337             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2338             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2339         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2340             20  FILLER                     PIC X.
  2341             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2342         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2343             20  FILLER                     PIC XX.
  2344             20  CF-MORTGAGE-PLAN           PIC XX.
  2345         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2346
  2347     12  CF-LAST-MAINT-DT                   PIC XX.
  2348     12  CF-LAST-MAINT-BY                   PIC X(4).
  2349     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2350
  2351     12  CF-RECORD-BODY                     PIC X(728).
  2352
  2353
  2354****************************************************************
  2355*             COMPANY MASTER RECORD                            *
  2356****************************************************************
  2357
  2358     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2359         16  CF-COMPANY-ADDRESS.
  2360             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2361             20  CF-CL-IN-CARE-OF           PIC X(30).
  2362             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2363             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2364             20  CF-CL-CITY-STATE           PIC X(30).
  2365             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2366             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2367         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  47
* EL151.cbl
  2368         16  CF-COMPANY-PASSWORD            PIC X(8).
  2369         16  CF-SECURITY-OPTION             PIC X.
  2370             88  ALL-SECURITY                   VALUE '1'.
  2371             88  COMPANY-VERIFY                 VALUE '2'.
  2372             88  PROCESSOR-VERIFY               VALUE '3'.
  2373             88  NO-SECURITY                    VALUE '4'.
  2374             88  ALL-BUT-TERM                   VALUE '5'.
  2375         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2376             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2377         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2378             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2379         16  CF-INFORCE-LOCATION            PIC X.
  2380             88  CERTS-ARE-ONLINE               VALUE '1'.
  2381             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2382             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2383         16  CF-LOWER-CASE-LETTERS          PIC X.
  2384         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2385             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2386             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2387             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2388             88  CF-ACCNT-CNTL                  VALUE '3'.
  2389             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2390
  2391         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2392         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2393
  2394         16  CF-LGX-CREDIT-USER             PIC X.
  2395             88  CO-IS-NOT-USER                 VALUE 'N'.
  2396             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2397
  2398         16 CF-CREDIT-CALC-CODES.
  2399             20  CF-CR-REM-TERM-CALC PIC X.
  2400               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2401               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2402               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2403               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2404               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2405               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2406               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2407             20  CF-CR-R78-METHOD           PIC X.
  2408               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2409               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2410
  2411         16  CF-CLAIM-CONTROL-COUNTS.
  2412             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2413                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2414
  2415             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2416                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2417
  2418             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2419                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2420
  2421             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2422                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2423
  2424         16  CF-CURRENT-MONTH-END           PIC XX.
  2425
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  48
* EL151.cbl
  2426         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2427             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2428             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2429             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2430             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2431                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2432                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2433             20  CF-CO-PREM-REJECT-SW       PIC X.
  2434                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2435                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2436             20  CF-CO-REF-REJECT-SW        PIC X.
  2437                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2438                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2439
  2440         16  CF-CO-REPORTING-DT             PIC XX.
  2441         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2442         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2443           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2444           88  CF-CO-MONTH-END                  VALUE '1'.
  2445
  2446         16  CF-LGX-CLAIM-USER              PIC X.
  2447             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2448             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2449
  2450         16  CF-CREDIT-EDIT-CONTROLS.
  2451             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2452             20  CF-MIN-AGE                 PIC 99.
  2453             20  CF-DEFAULT-AGE             PIC 99.
  2454             20  CF-MIN-TERM                PIC S999      COMP-3.
  2455             20  CF-MAX-TERM                PIC S999      COMP-3.
  2456             20  CF-DEFAULT-SEX             PIC X.
  2457             20  CF-JOINT-AGE-INPUT         PIC X.
  2458                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2459             20  CF-BIRTH-DATE-INPUT        PIC X.
  2460                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2461             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2462                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2463                 88  CF-ZERO-CARRIER            VALUE '1'.
  2464                 88  CF-ZERO-GROUPING           VALUE '2'.
  2465                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2466             20  CF-EDIT-SW                 PIC X.
  2467                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2468             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2469             20  CF-CR-PR-METHOD            PIC X.
  2470               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2471               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2472             20  FILLER                     PIC X.
  2473
  2474         16  CF-CREDIT-MISC-CONTROLS.
  2475             20  CF-REIN-TABLE-SW           PIC X.
  2476                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2477             20  CF-COMP-TABLE-SW           PIC X.
  2478                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2479             20  CF-EXPERIENCE-RETENTION-AGE
  2480                                            PIC S9        COMP-3.
  2481             20  CF-CONVERSION-DT           PIC XX.
  2482             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2483             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  49
* EL151.cbl
  2484                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2485                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2486
  2487             20  CF-CR-CHECK-NO-CONTROL.
  2488                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2489                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2490                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2491                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2492                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2493                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2494
  2495                 24  CF-CR-CHECK-COUNT       REDEFINES
  2496                     CF-CR-CHECK-COUNTER      PIC X(4).
  2497
  2498                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2499                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2500
  2501                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2502                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2503                 24  CF-MAIL-PROCESSING       PIC X.
  2504                     88  MAIL-PROCESSING          VALUE 'Y'.
  2505
  2506         16  CF-MISC-SYSTEM-CONTROL.
  2507             20  CF-SYSTEM-C                 PIC X.
  2508                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2509             20  CF-SYSTEM-D                 PIC X.
  2510                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2511             20  CF-SOC-SEC-NO-SW            PIC X.
  2512                 88  SOC-SEC-NO-USED             VALUE '1'.
  2513             20  CF-MEMBER-NO-SW             PIC X.
  2514                 88  MEMBER-NO-USED              VALUE '1'.
  2515             20  CF-TAX-ID-NUMBER            PIC X(11).
  2516             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2517             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2518                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2519                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2520                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2521                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2522             20  CF-SYSTEM-E                 PIC X.
  2523                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2524
  2525         16  CF-LGX-LIFE-USER               PIC X.
  2526             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2527             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2528
  2529         16  CF-CR-MONTH-END-DT             PIC XX.
  2530
  2531         16  CF-FILE-MAINT-DATES.
  2532             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2533                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2534             20  CF-LAST-BATCH       REDEFINES
  2535                 CF-LAST-BATCH-NO               PIC X(4).
  2536             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2537             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2538             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2539             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2540             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2541             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  50
* EL151.cbl
  2542             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2543             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2544             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2545             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2546
  2547         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2548         16  FILLER                         PIC X.
  2549
  2550         16  CF-ALT-MORT-CODE               PIC X(4).
  2551         16  CF-MEMBER-CAPTION              PIC X(10).
  2552
  2553         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2554             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2555             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2556             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2557             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2558             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2559
  2560         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2561
  2562         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2563         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2564         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2565         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2566
  2567         16  CF-AH-OVERRIDE-L1              PIC X.
  2568         16  CF-AH-OVERRIDE-L2              PIC XX.
  2569         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2570         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2571
  2572         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2573         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2574
  2575         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2576         16  CF-AR-LAST-EL860-DT            PIC XX.
  2577         16  CF-MP-MONTH-END-DT             PIC XX.
  2578
  2579         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2580         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2581             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2582
  2583         16  CF-AR-MONTH-END-DT             PIC XX.
  2584
  2585         16  CF-CRDTCRD-USER                PIC X.
  2586             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2587             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2588
  2589         16  CF-CC-MONTH-END-DT             PIC XX.
  2590
  2591         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2592
  2593         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2594             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2595             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2596             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2597         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2598         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2599         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  51
* EL151.cbl
  2600         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2601             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2602             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2603         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2604         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2605         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2606             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2607         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2608
  2609         16  CF-CL-ZIP-CODE.
  2610             20  CF-CL-ZIP-PRIME.
  2611                 24  CF-CL-ZIP-1ST          PIC X.
  2612                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2613                 24  FILLER                 PIC X(4).
  2614             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2615         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2616             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2617             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2618             20  FILLER                     PIC XXX.
  2619
  2620         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2621         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2622         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2623         16  CF-CO-OPTION-START-DATE        PIC XX.
  2624         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2625           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2626                                                      '3' '4'.
  2627           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2628           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2629           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2630           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2631           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2632           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2633
  2634         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2635
  2636         16  CF-PAYMENT-APPROVAL-LEVELS.
  2637             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2638             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2639             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2640             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2641             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2642             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2643
  2644         16  CF-END-USER-REPORTING-USER     PIC X.
  2645             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2646             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2647
  2648         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2649             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2650             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2651
  2652         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2653
  2654         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2655         16  FILLER                         PIC X.
  2656
  2657         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  52
* EL151.cbl
  2658             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2659             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2660             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2661
  2662         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2663
  2664         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2665             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2666             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2667
  2668         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2669             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2670             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2671
  2672         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2673
  2674         16  CF-CO-ACH-ID-CODE              PIC  X.
  2675             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2676             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2677             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2678         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2679         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2680         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2681         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2682         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2683         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2684         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2685         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2686         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2687                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2688         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2689                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2690
  2691         16  CF-CO-OVER-SHORT.
  2692             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2693             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2694
  2695*         16  FILLER                         PIC X(102).
  2696         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2697             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2698             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2699
  2700         16  CF-AH-APPROVAL-DAYS.
  2701             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2702             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2703             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2704             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2705
  2706         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2707
  2708         16  CF-APPROV-LEV-5.
  2709             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2710             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2711             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2712
  2713         16  FILLER                         PIC X(68).
  2714****************************************************************
  2715*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  53
* EL151.cbl
  2716****************************************************************
  2717
  2718     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2719         16  CF-PROCESSOR-NAME              PIC X(30).
  2720         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2721         16  CF-PROCESSOR-TITLE             PIC X(26).
  2722         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2723                 88  MESSAGE-YES                VALUE 'Y'.
  2724                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2725
  2726*****************************************************
  2727****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2728****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2729****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2730****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2731*****************************************************
  2732
  2733         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2734             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2735             20  CF-APPLICATION-FORCE       PIC X.
  2736             20  CF-INDIVIDUAL-APP.
  2737                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2738                     28  CF-BROWSE-APP      PIC X.
  2739                     28  CF-UPDATE-APP      PIC X.
  2740
  2741         16  CF-CURRENT-TERM-ON             PIC X(4).
  2742         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2743             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2744             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2745             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2746             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2747             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2748             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2749             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2750         16  CF-PROCESSOR-CARRIER           PIC X.
  2751             88  NO-CARRIER-SECURITY            VALUE ' '.
  2752         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2753             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2754         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2755             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2756         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2757             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2758
  2759         16  CF-PROC-SYS-ACCESS-SW.
  2760             20  CF-PROC-CREDIT-CLAIMS-SW.
  2761                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2762                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2763                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2764                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2765             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2766                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2767                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2768             20  CF-PROC-LIFE-GNRLDGR-SW.
  2769                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2770                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2771                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2772                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2773             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  54
* EL151.cbl
  2774                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2775                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2776         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2777             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2778             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2779         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2780
  2781         16  CF-APPROVAL-LEVEL                  PIC X.
  2782             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2783             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2784             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2785             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2786             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2787
  2788         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2789
  2790         16  CF-LANGUAGE-TYPE                   PIC X.
  2791             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2792             88  CF-LANG-IS-FR                      VALUE 'F'.
  2793
  2794         16  CF-CSR-IND                         PIC X.
  2795         16  FILLER                             PIC X(239).
  2796
  2797****************************************************************
  2798*             PROCESSOR/REMINDERS RECORD                       *
  2799****************************************************************
  2800
  2801     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2802         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2803             20  CF-START-REMIND-DT         PIC XX.
  2804             20  CF-END-REMIND-DT           PIC XX.
  2805             20  CF-REMINDER-TEXT           PIC X(50).
  2806         16  FILLER                         PIC X(296).
  2807
  2808
  2809****************************************************************
  2810*             STATE MASTER RECORD                              *
  2811****************************************************************
  2812
  2813     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2814         16  CF-STATE-ABBREVIATION          PIC XX.
  2815         16  CF-STATE-NAME                  PIC X(25).
  2816         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2817         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2818             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2819             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2820             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2821             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2822                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2823                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2824             20  CF-ST-PREM-REJECT-SW       PIC X.
  2825                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2826                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2827             20  CF-ST-REF-REJECT-SW        PIC X.
  2828                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2829                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2830         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2831         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  55
* EL151.cbl
  2832         16  CF-ST-REFUND-RULES.
  2833             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2834             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2835             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2836         16  CF-ST-FST-PMT-EXTENSION.
  2837             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2838             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2839                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2840                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2841                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2842                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2843         16  CF-ST-STATE-CALL.
  2844             20  CF-ST-CALL-UNEARNED        PIC X.
  2845             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2846             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2847         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2848             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2849             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2850         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2851         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2852         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2853         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2854         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2855         16  FILLER                         PIC X.
  2856         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2857             20  CF-ST-BENEFIT-CD           PIC XX.
  2858             20  CF-ST-BENEFIT-KIND         PIC X.
  2859                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2860                 88  CF-ST-AH-KIND              VALUE 'A'.
  2861             20  CF-ST-REM-TERM-CALC        PIC X.
  2862                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2863                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2864                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2865                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2866                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2867                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2868                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2869                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2870
  2871             20  CF-ST-REFUND-CALC          PIC X.
  2872                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2873                 88  ST-REFD-BY-R78             VALUE '1'.
  2874                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2875                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2876                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2877                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2878                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2879                 88  ST-REFD-UTAH               VALUE '7'.
  2880                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2881                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2882                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2883
  2884             20  CF-ST-EARNING-CALC         PIC X.
  2885                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2886                 88  ST-EARN-BY-R78             VALUE '1'.
  2887                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2888                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2889                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  56
* EL151.cbl
  2890                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2891                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2892                 88  ST-EARN-MEAN               VALUE '8'.
  2893                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2894
  2895             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2896                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2897                 88  ST-OVRD-BY-R78             VALUE '1'.
  2898                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2899                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2900                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2901                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2902                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2903                 88  ST-OVRD-MEAN               VALUE '8'.
  2904                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2905             20  cf-st-extra-periods        pic 9.
  2906*            20  FILLER                     PIC X.
  2907
  2908         16  CF-ST-COMMISSION-CAPS.
  2909             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2910             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2911             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2912             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2913         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2914                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2915
  2916         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2917
  2918         16  CF-ST-STATUTORY-INTEREST.
  2919             20  CF-ST-STAT-DATE-FROM       PIC X.
  2920                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2921                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2922             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2923             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2924             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2925             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2926             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2927
  2928         16  CF-ST-OVER-SHORT.
  2929             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2930             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2931
  2932         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2933
  2934         16  CF-ST-RT-CALC                  PIC X.
  2935
  2936         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2937         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2938         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2939         16  CF-ST-RF-LR-CALC               PIC X.
  2940         16  CF-ST-RF-LL-CALC               PIC X.
  2941         16  CF-ST-RF-LN-CALC               PIC X.
  2942         16  CF-ST-RF-AH-CALC               PIC X.
  2943         16  CF-ST-RF-CP-CALC               PIC X.
  2944*        16  FILLER                         PIC X(206).
  2945*CIDMOD         16  FILLER                         PIC X(192).
  2946         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2947             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  57
* EL151.cbl
  2948         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2949         16  CF-ST-VFY-2ND-BENE             PIC X.
  2950         16  CF-ST-CAUSAL-STATE             PIC X.
  2951         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2952         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2953         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2954             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2955         16  CF-ST-NET-ONLY-STATE           PIC X.
  2956             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2957         16  FILLER                         PIC X(181).
  2958
  2959****************************************************************
  2960*             BENEFIT MASTER RECORD                            *
  2961****************************************************************
  2962
  2963     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2964         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2965             20  CF-BENEFIT-CODE            PIC XX.
  2966             20  CF-BENEFIT-NUMERIC  REDEFINES
  2967                 CF-BENEFIT-CODE            PIC XX.
  2968             20  CF-BENEFIT-ALPHA           PIC XXX.
  2969             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2970             20  CF-BENEFIT-COMMENT         PIC X(10).
  2971
  2972             20  CF-LF-COVERAGE-TYPE        PIC X.
  2973                 88  CF-REDUCING                VALUE 'R'.
  2974                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2975
  2976             20  CF-SPECIAL-CALC-CD         PIC X.
  2977                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2978                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2979                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2980                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2981                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2982                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2983                 88  CF-FARM-PLAN               VALUE 'F'.
  2984                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2985                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2986                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2987                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2988                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2989                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2990                 88  CF-PRUDENTIAL              VALUE 'P'.
  2991                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2992                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2993                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2994                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2995                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2996                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2997
  2998             20  CF-JOINT-INDICATOR         PIC X.
  2999                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3000
  3001*            20  FILLER                     PIC X(12).
  3002             20  cf-maximum-benefits        pic s999 comp-3.
  3003             20  FILLER                     PIC X(09).
  3004             20  CF-BENEFIT-CATEGORY        PIC X.
  3005             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  58
* EL151.cbl
  3006
  3007             20  CF-CO-REM-TERM-CALC        PIC X.
  3008                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3009                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3010                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3011                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3012                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3013
  3014             20  CF-CO-EARNINGS-CALC        PIC X.
  3015                 88  CO-EARN-BY-R78             VALUE '1'.
  3016                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3017                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3018                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3019                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3020                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3021                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3022                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3023
  3024             20  CF-CO-REFUND-CALC          PIC X.
  3025                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3026                 88  CO-REFD-BY-R78             VALUE '1'.
  3027                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3028                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3029                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3030                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3031                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3032                 88  CO-REFD-MEAN               VALUE '8'.
  3033                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3034                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3035                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3036
  3037             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3038                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3039                 88  CO-OVRD-BY-R78             VALUE '1'.
  3040                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3041                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3042                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3043                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3044                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3045                 88  CO-OVRD-MEAN               VALUE '8'.
  3046                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3047
  3048             20  CF-CO-BEN-I-G-CD           PIC X.
  3049                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3050                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3051                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3052
  3053         16  FILLER                         PIC X(304).
  3054
  3055
  3056****************************************************************
  3057*             CARRIER MASTER RECORD                            *
  3058****************************************************************
  3059
  3060     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3061         16  CF-ADDRESS-DATA.
  3062             20  CF-MAIL-TO-NAME            PIC X(30).
  3063             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  59
* EL151.cbl
  3064             20  CF-ADDRESS-LINE-1          PIC X(30).
  3065             20  CF-ADDRESS-LINE-2          PIC X(30).
  3066             20  CF-CITY-STATE              PIC X(30).
  3067             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3068             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3069
  3070         16  CF-CLAIM-NO-CONTROL.
  3071             20  CF-CLAIM-NO-METHOD         PIC X.
  3072                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3073                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3074                 88  CLAIM-NO-SEQ               VALUE '3'.
  3075                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3076             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3077                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3078                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3079                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3080
  3081         16  CF-CHECK-NO-CONTROL.
  3082             20  CF-CHECK-NO-METHOD         PIC X.
  3083                 88  CHECK-NO-MANUAL            VALUE '1'.
  3084                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3085                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3086                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3087             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3088                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3089
  3090         16  CF-DOMICILE-STATE              PIC XX.
  3091
  3092         16  CF-EXPENSE-CONTROLS.
  3093             20  CF-EXPENSE-METHOD          PIC X.
  3094                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3095                 88  DOLLARS-PER-PMT            VALUE '2'.
  3096                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3097                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3098             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3099             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3100
  3101         16  CF-CORRESPONDENCE-CONTROL.
  3102             20  CF-LETTER-RESEND-OPT       PIC X.
  3103                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3104                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3105             20  FILLER                     PIC X(4).
  3106
  3107         16  CF-RESERVE-CONTROLS.
  3108             20  CF-MANUAL-SW               PIC X.
  3109                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3110             20  CF-FUTURE-SW               PIC X.
  3111                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3112             20  CF-PTC-SW                  PIC X.
  3113                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3114             20  CF-IBNR-SW                 PIC X.
  3115                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3116             20  CF-PTC-LF-SW               PIC X.
  3117                 88  CF-LF-PTC-USED             VALUE '1'.
  3118             20  CF-CDT-ACCESS-METHOD       PIC X.
  3119                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3120                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3121                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  60
* EL151.cbl
  3122             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3123
  3124         16  CF-CLAIM-CALC-METHOD           PIC X.
  3125             88  360-PLUS-MONTHS                VALUE '1'.
  3126             88  365-PLUS-MONTHS                VALUE '2'.
  3127             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3128             88  360-DAILY                      VALUE '4'.
  3129             88  365-DAILY                      VALUE '5'.
  3130
  3131         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3132         16  FILLER                         PIC X(11).
  3133
  3134         16  CF-LIMIT-AMOUNTS.
  3135             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3136             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3137             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3138             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3139             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3140             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3141             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3142             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3143             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3144             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3145
  3146         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3147         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3148         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3149
  3150         16  CF-ZIP-CODE.
  3151             20  CF-ZIP-PRIME.
  3152                 24  CF-ZIP-1ST             PIC X.
  3153                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3154                 24  FILLER                 PIC X(4).
  3155             20  CF-ZIP-PLUS4               PIC X(4).
  3156         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3157             20  CF-CAN-POSTAL-1            PIC XXX.
  3158             20  CF-CAN-POSTAL-2            PIC XXX.
  3159             20  FILLER                     PIC XXX.
  3160
  3161         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3162         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3163         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3164
  3165         16  CF-RATING-SWITCH               PIC X.
  3166             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3167             88  CF-NO-RATING                   VALUE 'N'.
  3168
  3169         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3170
  3171         16  CF-CARRIER-OVER-SHORT.
  3172             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3173             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3174
  3175         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3176         16  CF-SECPAY-SWITCH               PIC X.
  3177             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3178             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3179         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  61
* EL151.cbl
  3180         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3181         16  FILLER                         PIC X(444).
  3182*        16  FILLER                         PIC X(452).
  3183
  3184
  3185****************************************************************
  3186*             MORTALITY MASTER RECORD                          *
  3187****************************************************************
  3188
  3189     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3190         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3191                                INDEXED BY CF-MORT-NDX.
  3192             20  CF-MORT-TABLE              PIC X(5).
  3193             20  CF-MORT-TABLE-TYPE         PIC X.
  3194                 88  CF-MORT-JOINT              VALUE 'J'.
  3195                 88  CF-MORT-SINGLE             VALUE 'S'.
  3196                 88  CF-MORT-COMBINED           VALUE 'C'.
  3197                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3198                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3199             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3200             20  CF-MORT-AGE-METHOD         PIC XX.
  3201                 88  CF-AGE-LAST                VALUE 'AL'.
  3202                 88  CF-AGE-NEAR                VALUE 'AN'.
  3203             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3204             20  CF-MORT-ADJUSTMENT-DIRECTION
  3205                                            PIC X.
  3206                 88  CF-MINUS                   VALUE '-'.
  3207                 88  CF-PLUS                    VALUE '+'.
  3208             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3209             20  CF-MORT-JOINT-CODE         PIC X.
  3210                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3211             20  CF-MORT-PC-Q               PIC X.
  3212                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3213             20  CF-MORT-TABLE-CODE         PIC X(4).
  3214             20  CF-MORT-COMMENTS           PIC X(15).
  3215             20  FILLER                     PIC X(14).
  3216
  3217         16  FILLER                         PIC X(251).
  3218
  3219
  3220****************************************************************
  3221*             BUSSINESS TYPE MASTER RECORD                     *
  3222****************************************************************
  3223
  3224     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3225* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3226* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3227* AND RECORD 05 IS TYPES 81-99
  3228         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3229             20  CF-BUSINESS-TITLE          PIC  X(19).
  3230             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3231                                            PIC S9V9(4) COMP-3.
  3232             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3233             20  FILLER                     PIC  X.
  3234         16  FILLER                         PIC  X(248).
  3235
  3236
  3237****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  62
* EL151.cbl
  3238*             TERMINAL MASTER RECORD                           *
  3239****************************************************************
  3240
  3241     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3242
  3243         16  CF-COMPANY-TERMINALS.
  3244             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3245                                  PIC X(4).
  3246         16  FILLER               PIC X(248).
  3247
  3248
  3249****************************************************************
  3250*             LIFE EDIT MASTER RECORD                          *
  3251****************************************************************
  3252
  3253     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3254         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3255             20  CF-LIFE-CODE-IN            PIC XX.
  3256             20  CF-LIFE-CODE-OUT           PIC XX.
  3257         16  FILLER                         PIC X(248).
  3258
  3259
  3260****************************************************************
  3261*             AH EDIT MASTER RECORD                            *
  3262****************************************************************
  3263
  3264     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3265         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3266             20  CF-AH-CODE-IN              PIC XXX.
  3267             20  CF-AH-CODE-OUT             PIC XX.
  3268         16  FILLER                         PIC X(248).
  3269
  3270
  3271****************************************************************
  3272*             CREDIBILITY TABLES                               *
  3273****************************************************************
  3274
  3275     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3276         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3277                             INDEXED BY CF-CRDB-NDX.
  3278             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3279             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3280             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3281         16  FILLER                         PIC  X(332).
  3282
  3283
  3284****************************************************************
  3285*             REPORT CUSTOMIZATION RECORD                      *
  3286****************************************************************
  3287
  3288     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3289         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3290             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3291             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3292             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3293**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3294****       A T-TRANSFER.                                   ****
  3295             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  63
* EL151.cbl
  3296
  3297         16  FILLER                         PIC XX.
  3298
  3299         16  CF-CARRIER-CNTL-OPT.
  3300             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3301                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3302                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3303             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3304                                            PIC X.
  3305         16  CF-GROUP-CNTL-OPT.
  3306             20  CF-GROUP-OPT-SEQ           PIC 9.
  3307                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3308                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3309             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3310                                            PIC X(6).
  3311         16  CF-STATE-CNTL-OPT.
  3312             20  CF-STATE-OPT-SEQ           PIC 9.
  3313                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3314                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3315             20  CF-STATE-SELECT OCCURS 3 TIMES
  3316                                            PIC XX.
  3317         16  CF-ACCOUNT-CNTL-OPT.
  3318             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3319                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3320                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3321             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3322                                            PIC X(10).
  3323         16  CF-BUS-TYP-CNTL-OPT.
  3324             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3325                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3326                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3327             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3328                                            PIC XX.
  3329         16  CF-LF-TYP-CNTL-OPT.
  3330             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3331                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3332                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3333             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3334                                            PIC XX.
  3335         16  CF-AH-TYP-CNTL-OPT.
  3336             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3337                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3338                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3339             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3340                                            PIC XX.
  3341         16  CF-REPTCD1-CNTL-OPT.
  3342             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3343                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3344                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3345             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3346                                            PIC X(10).
  3347         16  CF-REPTCD2-CNTL-OPT.
  3348             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3349                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3350                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3351             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3352                                            PIC X(10).
  3353         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  64
* EL151.cbl
  3354             20  CF-USER1-OPT-SEQ           PIC 9.
  3355                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3356                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3357             20  CF-USER1-SELECT OCCURS 3 TIMES
  3358                                            PIC X(10).
  3359         16  CF-USER2-CNTL-OPT.
  3360             20  CF-USER2-OPT-SEQ           PIC 9.
  3361                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3362                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3363             20  CF-USER2-SELECT OCCURS 3 TIMES
  3364                                            PIC X(10).
  3365         16  CF-USER3-CNTL-OPT.
  3366             20  CF-USER3-OPT-SEQ           PIC 9.
  3367                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3368                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3369             20  CF-USER3-SELECT OCCURS 3 TIMES
  3370                                            PIC X(10).
  3371         16  CF-USER4-CNTL-OPT.
  3372             20  CF-USER4-OPT-SEQ           PIC 9.
  3373                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3374                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3375             20  CF-USER4-SELECT OCCURS 3 TIMES
  3376                                            PIC X(10).
  3377         16  CF-USER5-CNTL-OPT.
  3378             20  CF-USER5-OPT-SEQ           PIC 9.
  3379                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3380                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3381             20  CF-USER5-SELECT OCCURS 3 TIMES
  3382                                            PIC X(10).
  3383         16  CF-REINS-CNTL-OPT.
  3384             20  CF-REINS-OPT-SEQ           PIC 9.
  3385                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3386                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3387             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3388                 24  CF-REINS-PRIME         PIC XXX.
  3389                 24  CF-REINS-SUB           PIC XXX.
  3390
  3391         16  CF-AGENT-CNTL-OPT.
  3392             20  CF-AGENT-OPT-SEQ           PIC 9.
  3393                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3394                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3395             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3396                                            PIC X(10).
  3397
  3398         16  FILLER                         PIC X(43).
  3399
  3400         16  CF-LOSS-RATIO-SELECT.
  3401             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3402             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3403         16  CF-ENTRY-DATE-SELECT.
  3404             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3405             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3406         16  CF-EFFECTIVE-DATE-SELECT.
  3407             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3408             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3409
  3410         16  CF-EXCEPTION-LIST-IND          PIC X.
  3411             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  65
* EL151.cbl
  3412
  3413         16  FILLER                         PIC X(318).
  3414
  3415****************************************************************
  3416*                  EXCEPTION REPORTING RECORD                  *
  3417****************************************************************
  3418
  3419     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3420         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3421             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3422
  3423         16  CF-COMBINED-LIFE-AH-OPT.
  3424             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3425             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3426             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3427             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3428
  3429         16  CF-LIFE-OPT.
  3430             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3431             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3432             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3433             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3434             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3435             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3436             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3437             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3438             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3439             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3440
  3441         16  CF-AH-OPT.
  3442             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3443             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3444             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3445             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3446             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3447             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3448             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3449             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3450             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3451             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3452
  3453         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3454             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3455             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3456             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3457
  3458         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3459
  3460         16  FILLER                         PIC X(673).
  3461
  3462
  3463****************************************************************
  3464*             MORTGAGE SYSTEM PLAN RECORD                      *
  3465****************************************************************
  3466
  3467     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3468         16  CF-PLAN-TYPE                   PIC X.
  3469             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  66
* EL151.cbl
  3470             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3471             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3472         16  CF-PLAN-ABBREV                 PIC XXX.
  3473         16  CF-PLAN-DESCRIPT               PIC X(10).
  3474         16  CF-PLAN-NOTES                  PIC X(20).
  3475         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3476         16  CF-PLAN-UNDERWRITING.
  3477             20  CF-PLAN-TERM-DATA.
  3478                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3479                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3480             20  CF-PLAN-AGE-DATA.
  3481                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3482                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3483                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3484             20  CF-PLAN-BENEFIT-DATA.
  3485                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3486                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3487                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3488                                            PIC S9(7)V99  COMP-3.
  3489         16  CF-PLAN-POLICY-FORMS.
  3490             20  CF-POLICY-FORM             PIC X(12).
  3491             20  CF-MASTER-APPLICATION      PIC X(12).
  3492             20  CF-MASTER-POLICY           PIC X(12).
  3493         16  CF-PLAN-RATING.
  3494             20  CF-RATE-CODE               PIC X(5).
  3495             20  CF-SEX-RATING              PIC X.
  3496                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3497                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3498             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3499             20  CF-SUB-STD-TYPE            PIC X.
  3500                 88  CF-PCT-OF-PREM            VALUE '1'.
  3501                 88  CF-PCT-OF-BENE            VALUE '2'.
  3502         16  CF-PLAN-PREM-TOLERANCES.
  3503             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3504             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3505         16  CF-PLAN-PYMT-TOLERANCES.
  3506             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3507             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3508         16  CF-PLAN-MISC-DATA.
  3509             20  FILLER                     PIC X.
  3510             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3511             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3512         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3513         16  CF-PLAN-IND-GRP                PIC X.
  3514             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3515                                                     '1'.
  3516             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3517                                                     '2'.
  3518         16  CF-MIB-SEARCH-SW               PIC X.
  3519             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3520             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3521             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3522             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3523         16  CF-ALPHA-SEARCH-SW             PIC X.
  3524             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3525             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3526             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3527             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  67
* EL151.cbl
  3528             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3529             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3530             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3531             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3532             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3533             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3534                                                     'A' 'B' 'C'
  3535                                                     'X' 'Y' 'Z'.
  3536         16  CF-EFF-DT-RULE-SW              PIC X.
  3537             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3538             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3539             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3540             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3541             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3542         16  FILLER                         PIC X(4).
  3543         16  CF-HEALTH-QUESTIONS            PIC X.
  3544             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3545         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3546         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3547         16  CF-PLAN-SNGL-JNT               PIC X.
  3548             88  CF-COMBINED-PLAN              VALUE 'C'.
  3549             88  CF-JNT-PLAN                   VALUE 'J'.
  3550             88  CF-SNGL-PLAN                  VALUE 'S'.
  3551         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3552         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3553         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3554         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3555         16  CF-RERATE-CNTL                 PIC  X.
  3556             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3557             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3558             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3559             88  CF-AUTO-RECALC                 VALUE '4'.
  3560         16  CF-BENEFIT-TYPE                PIC  X.
  3561             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3562             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3563         16  CF-POLICY-FEE                  PIC S999V99
  3564                                                    COMP-3.
  3565         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3566         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3567         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3568         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3569         16  FILLER                         PIC  X(32).
  3570         16  CF-TERMINATION-FORM            PIC  X(04).
  3571         16  FILLER                         PIC  X(08).
  3572         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3573                                                       COMP-3.
  3574         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3575         16  CF-ISSUE-LETTER                PIC  X(4).
  3576         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3577         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3578             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3579             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3580         16  CF-MP-REFUND-CALC              PIC X.
  3581             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3582             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3583             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3584             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3585             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  68
* EL151.cbl
  3586             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3587             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3588             88  CF-MP-REFD-MEAN                VALUE '8'.
  3589         16  CF-ALT-RATE-CODE               PIC  X(5).
  3590
  3591
  3592         16  FILLER                         PIC X(498).
  3593****************************************************************
  3594*             MORTGAGE COMPANY MASTER RECORD                   *
  3595****************************************************************
  3596
  3597     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3598         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3599         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3600             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3601             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3602             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3603             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3604             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3605
  3606         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3607         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3608         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3609         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3610         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3611
  3612         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3613             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3614         16  CF-MP-RECON-USE-IND            PIC X(1).
  3615             88  CF-MP-USE-RECON             VALUE 'Y'.
  3616         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3617             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3618         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3619             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3620             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3621         16  FILLER                         PIC X(1).
  3622         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3623             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3624         16  CF-MORTG-MIB-VERSION           PIC X.
  3625             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3626             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3627             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3628         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3629             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3630                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3631             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3632                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3633             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3634                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3635             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3636                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3637             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3638                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3639             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3640                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3641         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3642         16  FILLER                         PIC X(7).
  3643         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  69
* EL151.cbl
  3644             20  CF-MORTG-MIB-COMM          PIC X(5).
  3645             20  CF-MORTG-MIB-TERM          PIC X(5).
  3646         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3647             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3648         16  FILLER                         PIC X(03).
  3649         16  CF-MP-CHECK-NO-CONTROL.
  3650             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3651                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3652                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3653                                                ' ' LOW-VALUES.
  3654                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3655                                               VALUE '3'.
  3656         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3657         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3658         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3659             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3660                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3661             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3662                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3663             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3664                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3665             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3666                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3667             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3668                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3669             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3670                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3671         16  CF-MORTG-BILLING-AREA.
  3672             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3673                                            PIC X.
  3674         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3675         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3676         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3677         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3678             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3679             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3680         16  FILLER                         PIC X.
  3681         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3682             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3683             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3684         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3685         16  FILLER                         PIC X(8).
  3686         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3687         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3688         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3689         16  CF-ACH-COMPANY-ID.
  3690             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3691                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3692                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3693                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3694             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3695         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3696             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3697         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3698             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3699             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3700         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3701         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  70
* EL151.cbl
  3702         16  FILLER                         PIC X(536).
  3703
  3704****************************************************************
  3705*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3706****************************************************************
  3707
  3708     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3709         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3710             20  CF-FEMALE-HEIGHT.
  3711                 24  CF-FEMALE-FT           PIC 99.
  3712                 24  CF-FEMALE-IN           PIC 99.
  3713             20  CF-FEMALE-MIN-WT           PIC 999.
  3714             20  CF-FEMALE-MAX-WT           PIC 999.
  3715         16  FILLER                         PIC X(428).
  3716
  3717     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3718         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3719             20  CF-MALE-HEIGHT.
  3720                 24  CF-MALE-FT             PIC 99.
  3721                 24  CF-MALE-IN             PIC 99.
  3722             20  CF-MALE-MIN-WT             PIC 999.
  3723             20  CF-MALE-MAX-WT             PIC 999.
  3724         16  FILLER                         PIC X(428).
  3725******************************************************************
  3726*             AUTOMATIC ACTIVITY RECORD                          *
  3727******************************************************************
  3728     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3729         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3730             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3731             20  CF-SYS-LETTER-ID           PIC X(04).
  3732             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3733             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3734             20  CF-SYS-RESET-SW            PIC X(01).
  3735             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3736             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3737
  3738         16  FILLER                         PIC X(50).
  3739
  3740         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3741             20  CF-USER-ACTIVE-SW          PIC X(01).
  3742             20  CF-USER-LETTER-ID          PIC X(04).
  3743             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3744             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3745             20  CF-USER-RESET-SW           PIC X(01).
  3746             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3747             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3748             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3749
  3750         16  FILLER                         PIC X(246).
  3751*                                    COPY ELCDENY.
  3752******************************************************************
  3753*                                                                *
  3754*                                                                *
  3755*                            ELCDENY                             *
  3756*                            VMOD=2.001                          *
  3757*                                                                *
  3758*   CLAIM SYSTEM DENIAL/RECESSION/REFORMATION TABLE              *
  3759*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  71
* EL151.cbl
  3760*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3761*   VSAM DENIAL TABLE                                            *
  3762*                                                                *
  3763*   FILE DESCRIPTION = DENIAL CODE TABLE                         *
  3764*                                                                *
  3765*   FILE TYPE = VSAM,KSDS                                        *
  3766*   RECORD SIZE = 125   RECFORM = FIX                            *
  3767*                                                                *
  3768*   BASE CLUSTER NAME = ELCDENY                   RKP=2,LEN=15   *
  3769*       ALTERNATE PATH1 = ELDENY2 (ALT GROUPING) RKP=17,LEN=16   *
  3770*                                                                *
  3771*   LOG = NO                                                     *
  3772*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3773*                                                                *
  3774*                                                                *
  3775******************************************************************
  3776*                   C H A N G E   L O G
  3777*
  3778* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3779*-----------------------------------------------------------------
  3780*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3781* EFFECTIVE    NUMBER
  3782*-----------------------------------------------------------------
  3783* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  3784******************************************************************
  3785 01  DENIAL-CODES.
  3786     12  DN-RECORD-ID                      PIC XX.
  3787         88  VALID-DN-ID                      VALUE 'DN'.
  3788     12  DN-CONTROL-PRIMARY.
  3789         16  DN-COMPANY-CD                 PIC X.
  3790         16  DN-DENIAL-CODE                PIC X(4).
  3791         16  FILLER                        PIC X(10).
  3792     12  DN-CONTROL-BY-TYPE.
  3793         16  DN-COMPANY-CD-A1              PIC X.
  3794         16  DN-RECORD-TYPE                PIC X.
  3795         16  DN-DENIAL-CODE-A1             PIC X(4).
  3796         16  FILLER                        PIC X(10).
  3797     12  DN-MAINT-INFORMATION.
  3798         16  DN-LAST-MAINT-DT              PIC XX.
  3799         16  DN-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3800         16  DN-LAST-MAINT-USER            PIC X(4).
  3801         16  FILLER                        PIC XX.
  3802     12  DN-DESCRIPTION                    PIC X(50).
  3803     12  FILLER                            PIC X(30).
  3804******************************************************************
  3805*                                    COPY ELCDAR.
  3806******************************************************************
  3807*                                                                *
  3808*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  3809*   FILE TYPE = VSAM,KSDS                                        *
  3810*   RECORD SIZE = 25   RECFORM = FIXED                           *
  3811*   BASE CLUSTER = DLYACTV                                       *
  3812*   LOG = YES                                                    *
  3813*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  3814*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  3815*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  3816*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  3817*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  72
* EL151.cbl
  3818*               BY PROGRAM "LGINFCE".                            *
  3819*                                                                *
  3820******************************************************************
  3821 01  DAILY-ACTIVITY-RECORD.
  3822     05  DA-KEY.
  3823         10  DA-COMP-CD          PIC X.
  3824         10  DA-CARRIER          PIC X.
  3825         10  DA-CLAIM-NO         PIC X(7).
  3826         10  DA-CERT-NO.
  3827             15  DA-CERT-PRIME   PIC X(10).
  3828             15  DA-CERT-SFX     PIC X.
  3829     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  3830     05  DA-RECORD-TYPE          PIC X.
  3831     05  FILLER                  PIC X(2).
  3832******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  73
* EL151.cbl
  3834*                                    COPY ERCDMDNT.
  3835******************************************************************
  3836*                                                                *
  3837*                            ERCDMDNT                            *
  3838*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3839*                            VMOD=2.005                          *
  3840*                                                                *
  3841*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  3842*                                                                *
  3843*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  3844*                                                                *
  3845*        FILE TYPE= VSAM,KSDS                                    *
  3846*        RECORD SIZE = 825    RECFORM = FIXED                    *
  3847*                                                                *
  3848*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  3849*                                                                *
  3850*        LOG = YES                                               *
  3851*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  3852*                                                                *
  3853******************************************************************
  3854
  3855 01  CERTIFICATE-NOTE.
  3856     12  CN-RECORD-ID                     PIC  XX.
  3857         88  VALID-CN-ID                      VALUE 'CN'.
  3858
  3859     12  CN-CONTROL-PRIMARY.
  3860         16  CN-COMPANY-CD                PIC X.
  3861         16  CN-CERT-KEY.
  3862             20  CN-CARRIER               PIC X.
  3863             20  CN-GROUPING.
  3864                 24  CN-GROUPING-PREFIX   PIC XXX.
  3865                 24  CN-GROUPING-PRIME    PIC XXX.
  3866             20  CN-STATE                 PIC XX.
  3867             20  CN-ACCOUNT.
  3868                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  3869                 24  CN-ACCOUNT-PRIME     PIC X(6).
  3870             20  CN-CERT-EFF-DT           PIC XX.
  3871             20  CN-CERT-NO.
  3872                 24  CN-CERT-PRIME        PIC X(10).
  3873                 24  CN-CERT-SFX          PIC X.
  3874
  3875     12  CN-BILLING-START-LINE-NO         PIC 99.
  3876     12  CN-BILLING-END-LINE-NO           PIC 99.
  3877
  3878     12  CN-LINES.
  3879         16  CN-LINE                      PIC X(77)  OCCURS 10.
  3880
  3881     12  CN-CSI-NOTES REDEFINES CN-LINES.
  3882         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  3883         16  CN-CSI-GENERAL-DATA-AREA.
  3884             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  3885
  3886         16  CN-CSI-GENERAL-DATA-R REDEFINES
  3887             CN-CSI-GENERAL-DATA-AREA.
  3888             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  3889             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  3890             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  3891             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  74
* EL151.cbl
  3892             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  3893             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  3894             20  CN-CSI-GEN-INFRM-MI          PIC X.
  3895             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  3896             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  3897             20  FILLER                       PIC XX.
  3898             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  3899             20  FILLER                       PIC X(38).
  3900
  3901         16  CN-CSI-PRODUCT-DATA-AREA.
  3902             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  3903
  3904         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  3905             CN-CSI-PRODUCT-DATA-AREA.
  3906             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  3907             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  3908             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  3909             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  3910             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  3911             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  3912             20  FILLER                   PIC XX.
  3913             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  3914             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  3915             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  3916             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  3917             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  3918             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  3919             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  3920             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  3921             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  3922             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  3923             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  3924             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  3925             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  3926             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  3927             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  3928             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  3929             20  CN-CSI-CC-TERM-AGE       PIC 999.
  3930             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  3931             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  3932             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  3933             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  3934             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  3935             20  FILLER                   PIC X(25).
  3936
  3937         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  3938             CN-CSI-CREDIT-CARD-DATA.
  3939             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  3940             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  3941             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  3942             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  3943             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  3944             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  3945             20  FILLER                   PIC XX.
  3946             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  3947             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  3948             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  3949             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  75
* EL151.cbl
  3950             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  3951             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  3952             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  3953             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  3954             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  3955             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  3956             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  3957             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  3958             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  3959             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  3960             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  3961             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  3962             20  CN-CSI-FL-TERM-AGE       PIC 999.
  3963             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  3964             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  3965             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  3966             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  3967             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  3968             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  3969             20  FILLER                   PIC X(17).
  3970
  3971         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  3972             CN-CSI-FAMILY-LEAVE-DATA.
  3973             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  3974             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  3975             20  CN-CSI-SL-BENE-REL       PIC X(8).
  3976             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  3977             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  3978             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  3979             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  3980             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  3981             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  3982             20  CN-CSI-SL-INT-ON-PROCEEDS
  3983                                          PIC S9(5)V99  COMP-3.
  3984             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  3985             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  3986             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  3987             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  3988             20  CN-CSI-SL-POLICY-BENEFITS
  3989                                          PIC S9(5)V99  COMP-3.
  3990             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  3991             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  3992             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  3993             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  3994             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  3995             20  CN-CSI-SL-PREM-MODE      PIC 99.
  3996             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  3997             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  3998             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  3999             20  CN-CSI-SL-STATE-NOT      PIC X.
  4000             20  FILLER                   PIC XX.
  4001
  4002         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  4003             CN-CSI-SENIOR-LIFE-DATA.
  4004             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  4005             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  4006             20  CN-CSI-PP-BEN-PAID-TO-DATE
  4007                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  76
* EL151.cbl
  4008             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  4009             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  4010             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  4011             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  4012             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  4013             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  4014             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  4015             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  4016             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  4017             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  4018             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  4019             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  4020             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  4021             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  4022             20  CN-CSI-PP-REPAIR         PIC X.
  4023             20  CN-CSI-PP-REPLACE        PIC X.
  4024             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  4025             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  4026             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  4027             20  CN-CSI-PP-TERM-AGE       PIC 999.
  4028             20  FILLER                   PIC X(5).
  4029
  4030         16  CN-CSI-EXT-WARR-DATA REDEFINES
  4031             CN-CSI-PURCH-PROP-DATA.
  4032             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  4033             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  4034             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  4035             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  4036             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  4037             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  4038             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  4039             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  4040             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  4041             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  4042             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  4043             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  4044             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  4045             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  4046             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  4047             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  4048             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  4049             20  CN-CSI-EW-REPLACE        PIC X.
  4050             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  4051             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  4052             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  4053             20  CN-CSI-EW-TERM-AGE       PIC 999.
  4054             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  4055             20  FILLER                   PIC X(4).
  4056
  4057     12  CN-LAST-MAINT-DT                 PIC XX.
  4058     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  4059     12  CN-LAST-MAINT-USER               PIC X(4).
  4060     12  FILLER                           PIC X(6).
  4061
  4062******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  77
* EL151.cbl
  4064 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  4065                          ACTIVITY-TRAILERS LETTER-ARCHIVE
  4066                          CONTROL-FILE DENIAL-CODES
  4067                          DAILY-ACTIVITY-RECORD
  4068                          CERTIFICATE-NOTE.
  4069 0000-DFHEXIT SECTION.
  4070     MOVE '9#                    $   ' TO DFHEIV0.
  4071     MOVE 'EL151' TO DFHEIV1.
  4072     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4073
  4074     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  4075     MOVE '5'                    TO DC-OPTION-CODE.
  4076     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  4077     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  4078     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  4079
  4080 0001-PROCESSING-EXITS.
  4081     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  4082     IF EIBCALEN NOT GREATER THAN ZEROS
  4083       GO TO 8800-UNAUTHORIZED-ACCESS.
  4084
  4085
  4086* EXEC CICS  HANDLE CONDITION
  4087*           ERROR    (9990-ABEND)
  4088*           PGMIDERR (9600-PGMID-ERROR)
  4089*    END-EXEC.
  4090*    MOVE '"$.L                  ! " #00004081' TO DFHEIV0
  4091     MOVE X'22242E4C2020202020202020' TO DFHEIV0(1:12)
  4092     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4093     MOVE X'2220233030303034303831' TO DFHEIV0(25:11)
  4094     CALL 'kxdfhei1' USING DFHEIV0
  4095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4096
  4097
  4098     IF PI-CALLING-PROGRAM  NOT  = THIS-PGM
  4099         IF PI-RETURN-TO-PROGRAM NOT  =  THIS-PGM
  4100             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  4101             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  4102             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  4103             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  4104             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  4105             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  4106             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  4107             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  4108         ELSE
  4109             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  4110             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  4111             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  4112             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  4113             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  4114             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  4115             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  4116             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  4117
  4118     IF EIBAID IS EQUAL TO DFHCLEAR
  4119         GO TO 9400-CLEAR.
  4120
  4121     IF PI-PROCESSOR-ID = 'LGXX'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  78
* EL151.cbl
  4122         NEXT SENTENCE
  4123     ELSE
  4124
  4125* EXEC CICS READQ TS
  4126*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  4127*            INTO    (SECURITY-CONTROL)
  4128*            LENGTH  (SC-COMM-LENGTH)
  4129*            ITEM    (SC-ITEM)
  4130*        END-EXEC
  4131*    MOVE '*$II   L              ''   #00004112' TO DFHEIV0
  4132     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4133     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4134     MOVE X'2020233030303034313132' TO DFHEIV0(25:11)
  4135     CALL 'kxdfhei1' USING DFHEIV0,
  4136           PI-SECURITY-TEMP-STORE-ID,
  4137           SECURITY-CONTROL,
  4138           SC-COMM-LENGTH,
  4139           SC-ITEM,
  4140           DFHEIV99,
  4141           DFHEIV99
  4142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4143         MOVE SC-CLAIMS-DISPLAY (6)    TO  PI-DISPLAY-CAP
  4144         MOVE SC-CLAIMS-UPDATE  (6)    TO  PI-MODIFY-CAP.
  4145
  4146     IF EIBTRNID IS EQUAL TO WS-TRANS-ID
  4147         GO TO 0200-RECEIVE.
  4148
  4149 0100-FIRST-TIME-IN.
  4150
  4151     MOVE LOW-VALUES                 TO  EL151AO
  4152     MOVE -1                         TO  MLINE1L
  4153     MOVE 1                          TO  EMI-NUMBER-OF-LINES.
  4154
  4155     MOVE SPACE                      TO  DC-ERROR-CODE
  4156                                         WS-CLAIM-SEQ-SW
  4157                                         MERMSG2O.
  4158
  4159     MOVE '153A'                     TO  PI-CURRENT-SCREEN-NO.
  4160
  4161     MOVE 0                          TO  PI-PROOF-DATE.
  4162     PERFORM 3550-FIND-LETTER-TRLR THRU 3550-EXIT.
  4163
  4164     GO TO 8100-SEND-INITIAL-MAP.
  4165
  4166 0200-RECEIVE.
  4167
  4168     MOVE LOW-VALUES              TO  EL151AI.
  4169
  4170     IF (EIBAID IS EQUAL TO DFHPA1 OR DFHPA2 OR DFHPA3)
  4171         MOVE ER-0008             TO  EMI-ERROR
  4172         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4173         MOVE -1                  TO  MPFNUMBL
  4174         GO TO 8200-SEND-DATAONLY.
  4175
  4176
  4177* EXEC CICS RECEIVE
  4178*        MAP      (MAP-NAME)
  4179*        MAPSET   (MAPSET-NAME)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  79
* EL151.cbl
  4180*        INTO     (EL151AI)
  4181*    END-EXEC.
  4182     MOVE LENGTH OF
  4183      EL151AI
  4184       TO DFHEIV11
  4185*    MOVE '8"T I  L              ''   #00004151' TO DFHEIV0
  4186     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  4187     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4188     MOVE X'2020233030303034313531' TO DFHEIV0(25:11)
  4189     CALL 'kxdfhei1' USING DFHEIV0,
  4190           MAP-NAME,
  4191           EL151AI,
  4192           DFHEIV11,
  4193           MAPSET-NAME,
  4194           DFHEIV99,
  4195           DFHEIV99
  4196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4197
  4198
  4199     IF MPFNUMBL IS EQUAL TO +0
  4200         GO TO 0300-CHECK-PFKEYS.
  4201
  4202     IF EIBAID IS NOT EQUAL TO DFHENTER
  4203         MOVE ER-0004             TO  EMI-ERROR
  4204         GO TO 0320-INPUT-ERROR.
  4205
  4206     IF (MPFNUMBI NUMERIC) AND (MPFNUMBI GREATER 0 AND LESS 25)
  4207         MOVE PF-VALUES (MPFNUMBI)    TO  EIBAID
  4208     ELSE
  4209         MOVE ER-0029                 TO  EMI-ERROR
  4210         GO TO 0320-INPUT-ERROR.
  4211
  4212 0300-CHECK-PFKEYS.
  4213
  4214     IF EIBAID IS EQUAL TO DFHPF12
  4215        MOVE  'EL010'            TO  THIS-PGM
  4216        GO TO 9300-XCTL.
  4217
  4218     IF EIBAID IS EQUAL TO DFHPF23
  4219        MOVE EIBAID              TO  PI-ENTRY-CD-1
  4220        MOVE 'EL005'             TO  THIS-PGM
  4221        GO TO 9300-XCTL.
  4222
  4223     IF EIBAID IS EQUAL TO DFHPF24
  4224        MOVE EIBAID              TO  PI-ENTRY-CD-1
  4225        MOVE  'EL126'            TO  THIS-PGM
  4226        GO TO 9300-XCTL.
  4227
  4228     IF EIBAID IS EQUAL TO DFHENTER
  4229        GO TO 0330-EDIT-DATA.
  4230
  4231     MOVE ER-0029                TO  EMI-ERROR.
  4232
  4233 0320-INPUT-ERROR.
  4234     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4235
  4236     MOVE -1                     TO  MPFNUMBL.
  4237     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  80
* EL151.cbl
  4238
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  81
* EL151.cbl
  4240 0330-EDIT-DATA.
  4241     IF NOT MODIFY-CAP
  4242        MOVE 'UPDATE'             TO  SM-READ
  4243        PERFORM 9995-SECURITY-VIOLATION
  4244        MOVE ER-0070              TO  EMI-ERROR
  4245        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4246        GO TO 8100-SEND-INITIAL-MAP.
  4247
  4248     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'CID' OR 'DCC'
  4249                     OR 'AHL' or 'VPP'
  4250         IF MLINE1I = (LOW-VALUES OR SPACES) AND
  4251            MLINE2I = (LOW-VALUES OR SPACES) AND
  4252            MDENCDI = (LOW-VALUES OR SPACES)
  4253             MOVE ER-0483        TO  EMI-ERROR
  4254             MOVE -1             TO  MLINE1L
  4255             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4256             GO TO 8100-SEND-INITIAL-MAP
  4257         ELSE
  4258             NEXT SENTENCE
  4259     ELSE
  4260         IF MLINE1I  = (LOW-VALUES OR SPACES)  AND
  4261            MLINE2I  = (LOW-VALUES OR SPACES)
  4262             MOVE ER-0483        TO  EMI-ERROR
  4263             MOVE -1             TO  MLINE1L
  4264             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4265             GO TO 8100-SEND-INITIAL-MAP.
  4266
  4267     IF MPRFDTL > 0
  4268         MOVE MPRFDTI TO DEEDIT-FIELD
  4269         PERFORM 9650-DEEDIT      THRU 9650-EXIT
  4270         MOVE DEEDIT-FIELD-V0  TO PI-PROOF-DATE
  4271         MOVE PI-PROOF-DATE    TO MPRFDTO
  4272         INSPECT MPRFDTI REPLACING ALL ' ' BY '/'
  4273     END-IF.
  4274
  4275     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES
  4276*     IF  MPRFDTI  = LOW-VALUES OR SPACES
  4277         MOVE ER-0872             TO EMI-ERROR
  4278         MOVE -1                  TO MPRFDTL
  4279         MOVE AL-UABON            TO MPRFDTA
  4280         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4281         GO TO 8200-SEND-DATAONLY
  4282     END-IF.
  4283
  4284     IF  PI-PROOF-DATE > 0
  4285         MOVE PI-PROOF-DATE       TO DEEDIT-FIELD
  4286         PERFORM 9650-DEEDIT      THRU 9650-EXIT
  4287         MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  4288         MOVE '4'                 TO DC-OPTION-CODE
  4289         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
  4290         IF DATE-CONVERSION-ERROR
  4291            MOVE ER-0021          TO EMI-ERROR
  4292            MOVE -1               TO MPRFDTL
  4293            MOVE AL-UABON         TO MPRFDTA
  4294            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4295            GO TO 8200-SEND-DATAONLY
  4296         ELSE
  4297            IF DC-BIN-DATE-1 > SAVE-BIN-DATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  82
* EL151.cbl
  4298                MOVE ER-0873      TO EMI-ERROR
  4299                MOVE -1           TO MPRFDTL
  4300                MOVE AL-UABON     TO MPRFDTA
  4301                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4302                GO TO 8200-SEND-DATAONLY
  4303            ELSE
  4304                MOVE DC-BIN-DATE-1    TO WS-PRF-DT
  4305                MOVE DEEDIT-FIELD-V0  TO PI-PROOF-DATE
  4306                MOVE PI-PROOF-DATE    TO MPRFDTO
  4307                INSPECT MPRFDTI REPLACING ALL ' ' BY '/'
  4308            END-IF
  4309         END-IF
  4310     END-IF.
  4311
  4312     MOVE LOW-VALUES             TO  WS-TRAILER-KEY.
  4313     MOVE PI-COMPANY-CD          TO  WS-KEY-COMPANY-CD.
  4314     MOVE PI-CARRIER             TO  WS-KEY-CARRIER.
  4315     MOVE PI-CLAIM-NO            TO  WS-KEY-CLAIM-NO.
  4316     MOVE PI-CERT-NO             TO  WS-KEY-CERT-NO.
  4317
  4318     PERFORM 7000-READ-ELMSTR-UPDATE THRU 7000-EXIT.
  4319
  4320     IF CL-LAST-TRL-AVAIL
  4321         MOVE ER-0137            TO  EMI-ERROR
  4322         MOVE -1                 TO  MLINE1L
  4323         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4324         GO TO 8200-SEND-DATAONLY.
  4325
  4326     MOVE CL-TRAILER-SEQ-CNT     TO  WS-ORIG-SEQ-CNT.
  4327     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
  4328     MOVE CL-TRAILER-SEQ-CNT     TO  WS-SEQ-NO-SAVED.
  4329     MOVE 'C'                    TO  CL-CLAIM-STATUS.
  4330     MOVE PI-PROCESSOR-ID        TO  CL-LAST-MAINT-USER.
  4331     MOVE '3'                    TO  CL-LAST-MAINT-TYPE.
  4332     MOVE '2'                    TO  CL-LAST-CLOSE-REASON.
  4333     MOVE EIBTIME                TO  CL-LAST-MAINT-HHMMSS.
  4334     MOVE SAVE-BIN-DATE          TO  CL-LAST-MAINT-DT
  4335                                     CL-LAST-CLOSE-DT.
  4336
  4337     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  4338         IF MDENCDL IS GREATER THAN +0
  4339             MOVE MDENCDI        TO  CL-FILE-LOCATION.
  4340
  4341*************************************************************
  4342*****         START BUILDING ACTIVITY RECORD HERE          **
  4343*************************************************************
  4344     IF PI-COMPANY-ID EQUAL 'CID' OR 'AHL'
  4345         PERFORM 2300-GETMAIN-DLYACTV THRU
  4346                 2300-EXIT
  4347         PERFORM 3500-BUILD-ACTIVITY-RECORD THRU
  4348                 3500-EXIT
  4349         PERFORM 2350-WRITE-DLYACTV THRU
  4350                 2350-EXIT
  4351     END-IF.
  4352
  4353*************************************************************
  4354*****            END OF BUILDING ACTIVITY RECORD           **
  4355*************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  83
* EL151.cbl
  4356
  4357     PERFORM 7120-READ-ELTRLR-UPDATE THRU 7120-EXIT.
  4358
  4359     MOVE +1                     TO  MISC-SUB.
  4360     MOVE SPACES                 TO  WS-OC-LOAD-SW.
  4361     PERFORM 1000-SET-OPEN-CLOSE-HIST THRU 1000-EXIT.
  4362
  4363     MOVE +01                    TO  TR-SUB
  4364                                     TR-SUB-2.
  4365     PERFORM 1010-UPDATE-TR1-OC   THRU 1010-EXIT
  4366             UNTIL  OC-HISTORY-LOADED.
  4367
  4368     MOVE PI-PROCESSOR-ID        TO AT-RESERVES-LAST-UPDATED-BY
  4369     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  4370     MOVE SAVE-BIN-DATE          TO AT-RESERVES-LAST-MAINT-DT.
  4371
  4372     IF PI-COMPANY-ID = 'DMD'
  4373         PERFORM 2000-CREATE-DMD-DMO  THRU  2000-EXIT.
  4374
  4375     PERFORM 7130-REWRITE-ELTRLR THRU 7130-EXIT.
  4376
  4377     PERFORM 7100-GETMAIN-ELTRLR  THRU 7100-EXIT.
  4378     PERFORM 1050-BUILD-DENIAL-TRLR THRU 1090-EXIT.
  4379
  4380     PERFORM 7110-WRITE-ELTRLR    THRU 7110-EXIT.
  4381
  4382     PERFORM 6100-CHECK-AUTO-ACTIVITY THRU 6100-EXIT.
  4383
  4384     IF WS-REC-FOUND-SW IS EQUAL TO 'N'
  4385         GO TO 0340-FINISH-EDIT-DATA.
  4386
  4387     IF CL-ACTIVITY-CODE IS EQUAL TO 09
  4388         GO TO 0340-FINISH-EDIT-DATA.
  4389
  4390     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK') AND
  4391        (CL-ACTIVITY-CODE IS EQUAL TO 11)
  4392         GO TO 0340-FINISH-EDIT-DATA.
  4393
  4394     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  4395         PERFORM 6000-RESET-AUTO-ACTIVITY THRU 6000-EXIT
  4396         IF WS-UPDATE-SW IS EQUAL TO 'Y'
  4397             MOVE LOW-VALUES         TO  CL-NEXT-RESEND-DT
  4398                                         CL-NEXT-FOLLOWUP-DT.
  4399
  4400     IF WS-RESET-SW IS EQUAL TO 'Y'
  4401         MOVE ZEROS                  TO  CL-ACTIVITY-CODE
  4402         MOVE SAVE-BIN-DATE          TO  CL-ACTIVITY-MAINT-DT
  4403         MOVE 'DENY'                 TO  CL-ACTIVITY-MAINT-TYPE.
  4404
  4405 0340-FINISH-EDIT-DATA.
  4406
  4407     PERFORM 7010-REWRITE-ELMSTR  THRU 7010-EXIT.
  4408
  4409     MOVE ER-0000                TO EMI-ERROR.
  4410     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4411     MOVE -1                     TO MLINE1L.
  4412*    MOVE LOW-VALUES             TO MLINE1O
  4413*                                   MLINE2O
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  84
* EL151.cbl
  4414*                                   MDENCDO.
  4415     GO TO 8200-SEND-DATAONLY.
  4416
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  85
* EL151.cbl
  4418 1000-SET-OPEN-CLOSE-HIST.
  4419     PERFORM 1000-BUMP-OPEN-CLOSE-HIST UNTIL
  4420        (MISC-SUB GREATER THAN +6 OR
  4421        AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES).
  4422
  4423     IF MISC-SUB GREATER THAN +1
  4424        SUBTRACT +1 FROM MISC-SUB
  4425        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = 'C'
  4426           MOVE SAVE-BIN-DATE   TO AT-OPEN-CLOSE-DATE (MISC-SUB)
  4427           MOVE 'C'             TO AT-OPEN-CLOSE-TYPE (MISC-SUB)
  4428           MOVE 'DENIED'        TO AT-OPEN-CLOSE-REASON (MISC-SUB)
  4429           MOVE 'X'             TO WS-OC-LOAD-SW.
  4430
  4431     GO TO 1000-EXIT.
  4432
  4433 1000-BUMP-OPEN-CLOSE-HIST.
  4434     ADD +1 TO MISC-SUB.
  4435
  4436 1000-EXIT.
  4437     EXIT.
  4438
  4439 1010-UPDATE-TR1-OC.
  4440     IF  AT-OPEN-CLOSE-DATE (TR-SUB) = (LOW-VALUE OR SPACES)
  4441         MOVE SAVE-BIN-DATE      TO AT-OPEN-CLOSE-DATE (TR-SUB)
  4442         MOVE 'C'                TO AT-OPEN-CLOSE-TYPE (TR-SUB)
  4443         MOVE 'DENIED'           TO AT-OPEN-CLOSE-REASON (TR-SUB)
  4444         MOVE 'X'                TO WS-OC-LOAD-SW
  4445         GO TO 1010-EXIT.
  4446
  4447     ADD 1  TO TR-SUB.
  4448     IF  TR-SUB  GREATER THAN 6
  4449         MOVE +01                TO TR-SUB
  4450         MOVE +02                TO TR-SUB-2
  4451         PERFORM 1020-BUMP    THRU 1020-EXIT
  4452          UNTIL TR-SUB-2 GREATER THAN 6
  4453         MOVE SPACES             TO AT-OPEN-CLOSE-DATE (TR-SUB).
  4454
  4455 1010-EXIT.
  4456      EXIT.
  4457
  4458 1020-BUMP.
  4459     MOVE AT-OPEN-CLOSE-DATE (TR-SUB-2) TO
  4460                           AT-OPEN-CLOSE-DATE (TR-SUB).
  4461     MOVE AT-OPEN-CLOSE-TYPE (TR-SUB-2) TO
  4462                           AT-OPEN-CLOSE-TYPE (TR-SUB).
  4463     MOVE AT-OPEN-CLOSE-REASON (TR-SUB-2) TO
  4464                           AT-OPEN-CLOSE-REASON (TR-SUB).
  4465
  4466     ADD +1  TO TR-SUB
  4467                TR-SUB-2.
  4468
  4469 1020-EXIT.
  4470     EXIT.
  4471
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  86
* EL151.cbl
  4473 1050-BUILD-DENIAL-TRLR.
  4474
  4475     MOVE 'AT'                   TO AT-RECORD-ID.
  4476     MOVE '8'                    TO AT-TRAILER-TYPE.
  4477
  4478*DLO023
  4479     IF PI-COMPANY-ID NOT = 'DMD'
  4480         GO TO 1055-EDIT-CID-CODE
  4481     END-IF
  4482
  4483     IF MDENCDL GREATER +0
  4484         MOVE 'CL'               TO DL23-SYSTEM-ID
  4485         MOVE 'DN'               TO DL23-RECORD-TYPE
  4486         MOVE MDENCDI            TO DL23-RECORD-KEY
  4487
  4488* EXEC CICS LINK
  4489*            PROGRAM    ('DLO023')
  4490*            COMMAREA   (WS-DLO-CODES-TABLE)
  4491*            LENGTH     (DL23-COMM-LENGTH)
  4492*        END-EXEC
  4493     MOVE 'DLO023' TO DFHEIV1
  4494*    MOVE '."C                   (   #00004445' TO DFHEIV0
  4495     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4496     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4497     MOVE X'2020233030303034343435' TO DFHEIV0(25:11)
  4498     CALL 'kxdfhei1' USING DFHEIV0,
  4499           DFHEIV1,
  4500           WS-DLO-CODES-TABLE,
  4501           DL23-COMM-LENGTH,
  4502           DFHEIV99,
  4503           DFHEIV99,
  4504           DFHEIV99,
  4505           DFHEIV99
  4506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4507         IF DL23-RETURN-CODE = 'OK'
  4508             MOVE AL-UANON       TO MDENCDA
  4509          ELSE
  4510             MOVE AL-UABON       TO MDENCDA
  4511             MOVE -1             TO MDENCDL
  4512             MOVE ER-0884        TO EMI-ERROR
  4513             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4514             PERFORM 2250-UNLOCK-CLAIM-MSTR THRU 2250-EXIT
  4515             PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4516             GO TO 8200-SEND-DATAONLY.
  4517
  4518     IF MLINE1I = LOW-VALUES OR SPACES
  4519         MOVE SPACES         TO AT-DENIAL-INFO-1
  4520      ELSE
  4521         MOVE MLINE1I        TO AT-DENIAL-INFO-1.
  4522
  4523     GO TO 1070-CONTINUE.
  4524
  4525 1055-EDIT-CID-CODE.
  4526     IF MDENCDL > +0
  4527        MOVE LOW-VALUES          TO WS-ELDENY-KEY
  4528        MOVE PI-COMPANY-CD       TO ELDENY-COMPANY-CD
  4529        MOVE MDENCDI             TO ELDENY-DENIAL-CODE
  4530
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  87
* EL151.cbl
  4531* EXEC CICS READ
  4532*          DATASET('ELDENY')
  4533*          SET    (ADDRESS OF DENIAL-CODES)
  4534*          RIDFLD (WS-ELDENY-KEY)
  4535*          RESP   (WS-RESPONSE)
  4536*       END-EXEC
  4537     MOVE 'ELDENY' TO DFHEIV1
  4538*    MOVE '&"S        E          (  N#00004473' TO DFHEIV0
  4539     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4540     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4541     MOVE X'204E233030303034343733' TO DFHEIV0(25:11)
  4542     CALL 'kxdfhei1' USING DFHEIV0,
  4543           DFHEIV1,
  4544           DFHEIV20,
  4545           DFHEIV99,
  4546           WS-ELDENY-KEY,
  4547           DFHEIV99,
  4548           DFHEIV99,
  4549           DFHEIV99
  4550     SET ADDRESS OF DENIAL-CODES TO
  4551         DFHEIV20
  4552     MOVE EIBRESP  TO WS-RESPONSE
  4553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4554        IF RESP-NORMAL
  4555           IF MLINE1L > +0
  4556              STRING DN-DESCRIPTION ' ' MLINE1I
  4557                 DELIMITED BY '  ' INTO AT-DENIAL-INFO-1
  4558              END-STRING
  4559           ELSE
  4560              MOVE DN-DESCRIPTION
  4561                                 TO AT-DENIAL-INFO-1
  4562           END-IF
  4563           MOVE DN-RECORD-TYPE   TO CL-DENIAL-TYPE
  4564           MOVE AT-DENIAL-INFO-1 TO MLINE1O
  4565           MOVE +1               TO MLINE1L
  4566           MOVE AL-UANON         TO MLINE1A
  4567           MOVE DN-RECORD-TYPE
  4568                                 TO CL-DENIAL-TYPE
  4569        ELSE
  4570           MOVE AL-UABON         TO MDENCDA
  4571           MOVE -1               TO MDENCDL
  4572           MOVE ER-0884          TO EMI-ERROR
  4573           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4574           PERFORM 2250-UNLOCK-CLAIM-MSTR THRU 2250-EXIT
  4575           PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4576           GO TO 8200-SEND-DATAONLY
  4577        END-IF
  4578     ELSE
  4579        MOVE AL-UABON            TO MDENCDA
  4580        MOVE -1                  TO MDENCDL
  4581        MOVE ER-0884             TO EMI-ERROR
  4582        PERFORM 9900-ERROR-FORMAT
  4583                                 THRU 9900-EXIT
  4584        PERFORM 2250-UNLOCK-CLAIM-MSTR
  4585                                 THRU 2250-EXIT
  4586        PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4587        GO TO 8200-SEND-DATAONLY
  4588     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  88
* EL151.cbl
  4589     GO TO 1070-CONTINUE
  4590     .
  4591 1060-CONTINUE.
  4592     IF MDENCDL IS GREATER THAN +0
  4593         SET DEN-INDEX TO +1
  4594         SEARCH DEN-TABLE VARYING DEN-INDEX
  4595             AT END
  4596                 MOVE MLINE1I                TO  AT-DENIAL-INFO-1
  4597         WHEN MDENCDI IS EQUAL TO DENIAL-CODE (DEN-INDEX)
  4598             MOVE DENIAL-DESC (DEN-INDEX)    TO  AT-DENIAL-INFO-1
  4599                                                 MLINE1O
  4600     ELSE
  4601         IF MLINE1I = LOW-VALUES OR SPACES
  4602             MOVE SPACES         TO AT-DENIAL-INFO-1
  4603         ELSE
  4604             MOVE MLINE1I        TO AT-DENIAL-INFO-1.
  4605
  4606 1070-CONTINUE.
  4607     IF  MLINE2I  = LOW-VALUES OR SPACES
  4608         MOVE  SPACES            TO AT-DENIAL-INFO-2
  4609     ELSE
  4610         MOVE MLINE2I            TO AT-DENIAL-INFO-2.
  4611
  4612     IF (AT-DENIAL-INFO-1 IS EQUAL TO SPACES OR LOW-VALUES)
  4613         MOVE AT-DENIAL-INFO-2   TO AT-DENIAL-INFO-1
  4614         MOVE SPACES             TO AT-DENIAL-INFO-2.
  4615
  4616     MOVE WS-PRF-DT              TO AT-DENIAL-PROOF-DT.
  4617     MOVE WS-SEQ-NO-SAVED        TO WS-KEY-SEQUENCE-NO.
  4618
  4619     MOVE WS-TRAILER-KEY         TO AT-CONTROL-PRIMARY.
  4620     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  4621                                    AT-DENIAL-LAST-UPDATED-BY.
  4622     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  4623     MOVE SAVE-BIN-DATE          TO AT-RECORDED-DT
  4624                                    AT-DENIAL-DT
  4625                                    AT-DENIAL-LAST-MAINT-DT.
  4626     MOVE MDENCDI                TO AT-DENIAL-REASON-CODE.
  4627     MOVE LOW-VALUES             TO AT-RETRACTION-DT.
  4628
  4629 1090-EXIT.
  4630      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  89
* EL151.cbl
  4632******************************************************************
  4633*    DMD ONLY  -  CREATE THE DIRECT MARKETING OUTPUT FILE
  4634******************************************************************
  4635 2000-CREATE-DMD-DMO.
  4636
  4637     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
  4638     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
  4639     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
  4640
  4641
  4642* EXEC CICS HANDLE CONDITION
  4643*         NOTFND   (2000-NOTE-NOT-FOUND)
  4644*         END-EXEC.
  4645*    MOVE '"$I                   ! # #00004566' TO DFHEIV0
  4646     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4647     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4648     MOVE X'2320233030303034353636' TO DFHEIV0(25:11)
  4649     CALL 'kxdfhei1' USING DFHEIV0
  4650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4651
  4652
  4653
  4654* EXEC CICS READ
  4655*         DATASET('ERNOTE')
  4656*         SET    (ADDRESS OF CERTIFICATE-NOTE)
  4657*         RIDFLD (W-NOTE-KEY)
  4658*         END-EXEC.
  4659     MOVE 'ERNOTE' TO DFHEIV1
  4660*    MOVE '&"S        E          (   #00004570' TO DFHEIV0
  4661     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4662     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4663     MOVE X'2020233030303034353730' TO DFHEIV0(25:11)
  4664     CALL 'kxdfhei1' USING DFHEIV0,
  4665           DFHEIV1,
  4666           DFHEIV20,
  4667           DFHEIV99,
  4668           W-NOTE-KEY,
  4669           DFHEIV99,
  4670           DFHEIV99,
  4671           DFHEIV99
  4672     SET ADDRESS OF CERTIFICATE-NOTE TO
  4673         DFHEIV20
  4674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4675
  4676
  4677     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
  4678     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
  4679     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
  4680
  4681     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
  4682         MOVE 'CC'               TO DCT-PRODUCT-CODE
  4683     ELSE
  4684         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
  4685
  4686     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
  4687     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
  4688
  4689
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  90
* EL151.cbl
  4690* EXEC CICS LINK
  4691*        PROGRAM    ('DLO006')
  4692*        COMMAREA   (DCT-COMMUNICATION-AREA)
  4693*        LENGTH     (WS-DCT-LENGTH)
  4694*    END-EXEC.
  4695     MOVE 'DLO006' TO DFHEIV1
  4696*    MOVE '."C                   (   #00004588' TO DFHEIV0
  4697     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4698     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4699     MOVE X'2020233030303034353838' TO DFHEIV0(25:11)
  4700     CALL 'kxdfhei1' USING DFHEIV0,
  4701           DFHEIV1,
  4702           DCT-COMMUNICATION-AREA,
  4703           WS-DCT-LENGTH,
  4704           DFHEIV99,
  4705           DFHEIV99,
  4706           DFHEIV99,
  4707           DFHEIV99
  4708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4709
  4710
  4711     IF  DCT-RETURN-CODE = 'OK'
  4712         GO TO 2000-CONT.
  4713
  4714     IF  DCT-RETURN-CODE = '01' OR '02'
  4715         GO TO 2000-EXIT.
  4716
  4717     IF  DCT-RETURN-CODE = '03'
  4718         MOVE ER-0951            TO EMI-ERROR
  4719         MOVE -1                 TO MLINE1L
  4720         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4721         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4722             THRU 2250-EXIT
  4723         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4724         GO TO 8200-SEND-DATAONLY.
  4725
  4726     IF  DCT-RETURN-CODE = '06'
  4727         MOVE ER-0921            TO EMI-ERROR
  4728         MOVE -1                 TO MLINE1L
  4729         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4730         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4731             THRU 2250-EXIT
  4732         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4733         GO TO 8200-SEND-DATAONLY.
  4734
  4735     IF  DCT-RETURN-CODE = '07'
  4736         MOVE ER-0919            TO EMI-ERROR
  4737         MOVE -1                 TO MLINE1L
  4738         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4739         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4740             THRU 2250-EXIT
  4741         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4742         GO TO 8200-SEND-DATAONLY.
  4743
  4744     IF  DCT-RETURN-CODE = '04'
  4745         MOVE ER-0946            TO EMI-ERROR
  4746         MOVE -1                 TO MLINE1L
  4747         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  91
* EL151.cbl
  4748         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4749             THRU 2250-EXIT
  4750         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4751         GO TO 8200-SEND-DATAONLY.
  4752
  4753     IF  DCT-RETURN-CODE = '05'
  4754         MOVE ER-0947            TO EMI-ERROR
  4755         MOVE -1                 TO MLINE1L
  4756         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4757         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4758             THRU 2250-EXIT
  4759         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4760         GO TO 8200-SEND-DATAONLY.
  4761
  4762     IF  DCT-RETURN-CODE = '08'
  4763         MOVE ER-0948            TO EMI-ERROR
  4764         MOVE -1                 TO MLINE1L
  4765         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4766         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4767             THRU 2250-EXIT
  4768         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4769         GO TO 8200-SEND-DATAONLY.
  4770
  4771     IF  DCT-RETURN-CODE = 'N1'
  4772         MOVE ER-0950            TO EMI-ERROR
  4773         MOVE -1                 TO MLINE1L
  4774         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4775         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4776             THRU 2250-EXIT
  4777         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4778         GO TO 8200-SEND-DATAONLY.
  4779
  4780     IF DCT-RETURN-CODE = 'E1'
  4781         MOVE ER-0974            TO EMI-ERROR
  4782         MOVE -1                 TO MLINE1L
  4783         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4784         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4785             THRU 2250-EXIT
  4786         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4787         GO TO 8200-SEND-DATAONLY.
  4788
  4789     IF DCT-RETURN-CODE = 'E2'
  4790         MOVE ER-0975            TO EMI-ERROR
  4791         MOVE -1                 TO MLINE1L
  4792         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4793         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4794             THRU 2250-EXIT
  4795         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4796         GO TO 8200-SEND-DATAONLY.
  4797
  4798     IF DCT-RETURN-CODE NOT = 'OK'
  4799         MOVE ER-0949            TO EMI-ERROR
  4800         MOVE -1                 TO MLINE1L
  4801         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4802         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4803             THRU 2250-EXIT
  4804         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4805         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  92
* EL151.cbl
  4806
  4807 2000-CONT.
  4808
  4809     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
  4810     MOVE 'CS'                   TO DM-RECORD-TYPE.
  4811     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
  4812     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
  4813     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
  4814     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
  4815     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
  4816
  4817     MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1.
  4818     MOVE ' '                    TO  DC-OPTION-CODE.
  4819     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  4820     MOVE DC-GREG-DATE-1-YMD     TO  DMD-YYMMDD.
  4821
  4822     IF DMD-YY GREATER THAN 70
  4823         MOVE '19'               TO  DMD-DECADE
  4824     ELSE
  4825         MOVE '20'               TO  DMD-DECADE.
  4826
  4827     MOVE DMD-DATE-YYYYMMDD      TO  DM-STATUS-DATE.
  4828     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
  4829     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
  4830     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
  4831     PERFORM 2100-FORMAT-LAST-NAME-1ST THRU 2100-EXIT.
  4832     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
  4833
  4834     MOVE 'D'                    TO DM-STAT-CHANGE-TYPE.
  4835     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
  4836     MOVE '3'                    TO DM-CLAIM-STATUS.
  4837
  4838
  4839* EXEC CICS LINK
  4840*        PROGRAM    ('DLO025')
  4841*        COMMAREA   (DMO-COMMUNICATION-AREA)
  4842*        LENGTH     (WS-DMO-LENGTH)
  4843*    END-EXEC.
  4844     MOVE 'DLO025' TO DFHEIV1
  4845*    MOVE '."C                   (   #00004721' TO DFHEIV0
  4846     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4847     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4848     MOVE X'2020233030303034373231' TO DFHEIV0(25:11)
  4849     CALL 'kxdfhei1' USING DFHEIV0,
  4850           DFHEIV1,
  4851           DMO-COMMUNICATION-AREA,
  4852           WS-DMO-LENGTH,
  4853           DFHEIV99,
  4854           DFHEIV99,
  4855           DFHEIV99,
  4856           DFHEIV99
  4857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4858
  4859
  4860     IF  DM-RETURN-CODE = 'OK'
  4861         GO TO 2000-EXIT.
  4862
  4863     IF  DM-RETURN-CODE = '01'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  93
* EL151.cbl
  4864         MOVE ER-8051            TO EMI-ERROR
  4865         MOVE -1                 TO MLINE1L
  4866         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4867         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4868             THRU 2250-EXIT
  4869         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4870         GO TO 8200-SEND-DATAONLY.
  4871
  4872     IF  DM-RETURN-CODE = '02'
  4873         MOVE ER-8052            TO EMI-ERROR
  4874         MOVE -1                 TO MLINE1L
  4875         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4876         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4877             THRU 2250-EXIT
  4878         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4879         GO TO 8200-SEND-DATAONLY.
  4880
  4881     IF  DM-RETURN-CODE = '03'
  4882         MOVE ER-8053            TO EMI-ERROR
  4883         MOVE -1                 TO MLINE1L
  4884         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4885         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4886             THRU 2250-EXIT
  4887         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4888         GO TO 8200-SEND-DATAONLY.
  4889
  4890     IF  DM-RETURN-CODE = '04'
  4891         MOVE ER-8054            TO EMI-ERROR
  4892         MOVE -1                 TO MLINE1L
  4893         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4894         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4895             THRU 2250-EXIT
  4896         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4897         GO TO 8200-SEND-DATAONLY.
  4898
  4899     IF  DM-RETURN-CODE = '05'
  4900         MOVE ER-8055            TO EMI-ERROR
  4901         MOVE -1                 TO MLINE1L
  4902         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4903         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4904             THRU 2250-EXIT
  4905         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4906         GO TO 8200-SEND-DATAONLY.
  4907
  4908     IF  DM-RETURN-CODE = '06'
  4909         MOVE ER-8056            TO EMI-ERROR
  4910         MOVE -1                 TO MLINE1L
  4911         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4912         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4913             THRU 2250-EXIT
  4914         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4915         GO TO 8200-SEND-DATAONLY.
  4916
  4917     IF  DM-RETURN-CODE = '07'
  4918         MOVE ER-8057            TO EMI-ERROR
  4919         MOVE -1                 TO MLINE1L
  4920         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4921         PERFORM 2250-UNLOCK-CLAIM-MSTR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  94
* EL151.cbl
  4922             THRU 2250-EXIT
  4923         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4924         GO TO 8200-SEND-DATAONLY.
  4925
  4926     IF  DM-RETURN-CODE = '08'
  4927         MOVE ER-8058            TO EMI-ERROR
  4928         MOVE -1                 TO MLINE1L
  4929         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4930         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4931             THRU 2250-EXIT
  4932         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4933         GO TO 8200-SEND-DATAONLY.
  4934
  4935     IF  DM-RETURN-CODE = '09'
  4936         MOVE ER-8059            TO EMI-ERROR
  4937         MOVE -1                 TO MLINE1L
  4938         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4939         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4940             THRU 2250-EXIT
  4941         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4942         GO TO 8200-SEND-DATAONLY.
  4943
  4944     IF  DM-RETURN-CODE = '10'
  4945         MOVE ER-8060            TO EMI-ERROR
  4946         MOVE -1                 TO MLINE1L
  4947         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4948         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4949             THRU 2250-EXIT
  4950         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4951         GO TO 8200-SEND-DATAONLY.
  4952
  4953     IF  DM-RETURN-CODE = '11'
  4954         MOVE ER-8061            TO EMI-ERROR
  4955         MOVE -1                 TO MLINE1L
  4956         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4957         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4958             THRU 2250-EXIT
  4959         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4960         GO TO 8200-SEND-DATAONLY.
  4961
  4962     IF  DM-RETURN-CODE = '12'
  4963         MOVE ER-8062            TO EMI-ERROR
  4964         MOVE -1                 TO MLINE1L
  4965         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4966         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4967             THRU 2250-EXIT
  4968         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4969         GO TO 8200-SEND-DATAONLY.
  4970
  4971     IF  DM-RETURN-CODE = '13'
  4972         MOVE ER-8063            TO EMI-ERROR
  4973         MOVE -1                 TO MLINE1L
  4974         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4975         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4976             THRU 2250-EXIT
  4977         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4978         GO TO 8200-SEND-DATAONLY.
  4979
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  95
* EL151.cbl
  4980     IF  DM-RETURN-CODE = '14'
  4981         MOVE ER-8064            TO EMI-ERROR
  4982         MOVE -1                 TO MLINE1L
  4983         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4984         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4985             THRU 2250-EXIT
  4986         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4987         GO TO 8200-SEND-DATAONLY.
  4988
  4989     IF  DM-RETURN-CODE = '15'
  4990         MOVE ER-8065            TO EMI-ERROR
  4991         MOVE -1                 TO MLINE1L
  4992         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4993         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4994             THRU 2250-EXIT
  4995         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4996         GO TO 8200-SEND-DATAONLY.
  4997
  4998     IF DM-RETURN-CODE = '16'
  4999         MOVE ER-8154            TO EMI-ERROR
  5000         MOVE -1                 TO MLINE1L
  5001         PERFORM 9900-ERROR-FORMAT      THRU 9900-EXIT
  5002         PERFORM 2250-UNLOCK-CLAIM-MSTR THRU 2250-EXIT
  5003         PERFORM 2255-UNLOCK-TRLR       THRU 2255-EXIT
  5004         GO TO 8200-SEND-DATAONLY.
  5005
  5006     IF DM-RETURN-CODE = '17'
  5007         MOVE ER-8155            TO EMI-ERROR
  5008         MOVE -1                 TO MLINE1L
  5009         PERFORM 9900-ERROR-FORMAT      THRU 9900-EXIT
  5010         PERFORM 2250-UNLOCK-CLAIM-MSTR THRU 2250-EXIT
  5011         PERFORM 2255-UNLOCK-TRLR       THRU 2255-EXIT
  5012         GO TO 8200-SEND-DATAONLY.
  5013
  5014     IF DM-RETURN-CODE = 'N1'
  5015         MOVE ER-8152            TO EMI-ERROR
  5016         MOVE -1                 TO MLINE1L
  5017         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5018         PERFORM 2250-UNLOCK-CLAIM-MSTR
  5019             THRU 2250-EXIT
  5020         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  5021         GO TO 8200-SEND-DATAONLY.
  5022
  5023     IF DM-RETURN-CODE = 'E1'
  5024         MOVE ER-8153            TO EMI-ERROR
  5025         MOVE -1                 TO MLINE1L
  5026         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5027         PERFORM 2250-UNLOCK-CLAIM-MSTR
  5028             THRU 2250-EXIT
  5029         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  5030         GO TO 8200-SEND-DATAONLY.
  5031
  5032     MOVE ER-8066                TO EMI-ERROR.
  5033     MOVE -1                     TO MLINE1L.
  5034     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5035     PERFORM 2250-UNLOCK-CLAIM-MSTR
  5036         THRU 2250-EXIT.
  5037     PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  96
* EL151.cbl
  5038     GO TO 8200-SEND-DATAONLY.
  5039
  5040 2000-NOTE-NOT-FOUND.
  5041
  5042     MOVE ER-0954                TO EMI-ERROR.
  5043     MOVE -1                     TO MLINE1L.
  5044     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5045     PERFORM 2250-UNLOCK-CLAIM-MSTR
  5046         THRU 2250-EXIT.
  5047     PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT.
  5048     GO TO 8200-SEND-DATAONLY.
  5049
  5050 2000-EXIT.
  5051     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  97
* EL151.cbl
  5053
  5054 2100-FORMAT-LAST-NAME-1ST.
  5055*****************************************************************
  5056*             M O V E   N A M E   R O U T I N E                 *
  5057*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
  5058*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
  5059*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
  5060*                  FIELD                   VALUE                *
  5061*           W-NAME-LAST    (CL15)      SMITH                    *
  5062*           W-NAME-FIRST   (CL15)      JOHN                     *
  5063*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
  5064*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
  5065*     CONTAIN                                                   *
  5066*                SMITH, JOHN ALLEN                              *
  5067*     OR                                                        *
  5068*                SMITH, JOHN A.                                 *
  5069*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
  5070*     COPYBOOK, ELCNWA.                                         *
  5071*****************************************************************.
  5072
  5073     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
  5074     MOVE ZERO                   TO  WS-NAME-SW.
  5075     SET NWA-INDEX               TO +1.
  5076
  5077     IF  W-NAME-LAST EQUAL SPACES
  5078             AND
  5079         W-NAME-MIDDLE EQUAL SPACES
  5080         MOVE +1                 TO WS-NAME-SW.
  5081
  5082     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
  5083     PERFORM 2150-MOVE-NAME THRU 2150-EXIT.
  5084
  5085     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
  5086     PERFORM 2150-MOVE-NAME THRU 2150-EXIT.
  5087
  5088     SET NWA-INDEX UP BY +1.
  5089
  5090     IF  W-NAME-MIDDLE NOT EQUAL SPACES
  5091
  5092         IF  W-NAME-MIDDLE-2 EQUAL SPACES
  5093             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
  5094             SET NWA-INDEX UP BY +1
  5095             MOVE '.'            TO WS-NW (NWA-INDEX)
  5096             SET NWA-INDEX UP BY +2
  5097
  5098         ELSE
  5099             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
  5100             PERFORM 2150-MOVE-NAME THRU 2150-EXIT.
  5101
  5102 2100-EXIT.
  5103     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  98
* EL151.cbl
  5105 2150-MOVE-NAME.
  5106
  5107     IF  WS-NAME-SW GREATER THAN +1
  5108         GO TO 2150-EXIT.
  5109
  5110     IF  WS-NAME-WORK2 = SPACES
  5111         GO TO 2150-EXIT.
  5112
  5113     SET NWA-INDEX2            TO +1.
  5114     SET NWA-INDEX3            TO +2.
  5115
  5116 2150-MOVE-NAME-CYCLE.
  5117
  5118     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  5119
  5120     IF  NWA-INDEX LESS THAN +30
  5121         SET NWA-INDEX UP BY +1
  5122
  5123     ELSE
  5124         ADD +2                TO  WS-NAME-SW
  5125         GO TO 2150-EXIT.
  5126
  5127     IF  NWA-INDEX2 LESS THAN +20
  5128         SET NWA-INDEX3 UP BY +1
  5129         SET NWA-INDEX2 UP BY +1.
  5130
  5131     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
  5132             AND
  5133         WS-NW2 (NWA-INDEX3) EQUAL SPACES
  5134
  5135         IF  WS-NAME-SW EQUAL ZERO
  5136             MOVE ','            TO  WS-NW (NWA-INDEX)
  5137             SET NWA-INDEX UP BY +2
  5138             MOVE +1             TO  WS-NAME-SW
  5139             GO TO 2150-EXIT
  5140
  5141         ELSE
  5142             GO TO 2150-EXIT.
  5143
  5144     GO TO 2150-MOVE-NAME-CYCLE.
  5145
  5146 2150-EXIT.
  5147     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page  99
* EL151.cbl
  5149 2250-UNLOCK-CLAIM-MSTR.
  5150
  5151* EXEC CICS UNLOCK
  5152*          DATASET  (ELMSTR-FILE-ID)
  5153*          END-EXEC.
  5154*    MOVE '&*                    #   #00005017' TO DFHEIV0
  5155     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5156     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5157     MOVE X'2020233030303035303137' TO DFHEIV0(25:11)
  5158     CALL 'kxdfhei1' USING DFHEIV0,
  5159           ELMSTR-FILE-ID,
  5160           DFHEIV99
  5161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5162
  5163 2250-EXIT.
  5164     EXIT.
  5165 2255-UNLOCK-TRLR.
  5166
  5167* EXEC CICS UNLOCK
  5168*          DATASET (ELTRLR-FILE-ID)
  5169*          END-EXEC.
  5170*    MOVE '&*                    #   #00005023' TO DFHEIV0
  5171     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5172     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5173     MOVE X'2020233030303035303233' TO DFHEIV0(25:11)
  5174     CALL 'kxdfhei1' USING DFHEIV0,
  5175           ELTRLR-FILE-ID,
  5176           DFHEIV99
  5177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5178
  5179 2255-EXIT.
  5180     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 100
* EL151.cbl
  5181/
  5182*************************************************************
  5183*****      CSO ADDITION - FOR BUILDING ACTIVITY FILE      ***
  5184*************************************************************
  5185 2300-GETMAIN-DLYACTV.
  5186
  5187* EXEC CICS GETMAIN
  5188*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  5189*        LENGTH (25)
  5190*        INITIMG (WS-BLANK)
  5191*    END-EXEC.
  5192     MOVE 25
  5193       TO DFHEIV11
  5194*    MOVE ',"IL                  $   #00005033' TO DFHEIV0
  5195     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5196     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5197     MOVE X'2020233030303035303333' TO DFHEIV0(25:11)
  5198     CALL 'kxdfhei1' USING DFHEIV0,
  5199           DFHEIV20,
  5200           DFHEIV11,
  5201           WS-BLANK
  5202     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  5203         DFHEIV20
  5204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5205
  5206 2300-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 101
* EL151.cbl
  5207/
  5208*************************************************************
  5209*****      CSO ADDITION - FOR BUILDING ACTIVITY FILE      ***
  5210*************************************************************
  5211 2350-WRITE-DLYACTV.
  5212
  5213* EXEC CICS HANDLE CONDITION
  5214*        NOTOPEN (9986-NOTOPEN-DLYACTV)
  5215*        DUPREC (2350-EXIT)
  5216*    END-EXEC.
  5217*    MOVE '"$J%                  ! $ #00005044' TO DFHEIV0
  5218     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  5219     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5220     MOVE X'2420233030303035303434' TO DFHEIV0(25:11)
  5221     CALL 'kxdfhei1' USING DFHEIV0
  5222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5223
  5224
  5225
  5226* EXEC CICS WRITE
  5227*        DATASET ('DLYACTV')
  5228*        RIDFLD (DA-KEY)
  5229*        FROM (DAILY-ACTIVITY-RECORD)
  5230*    END-EXEC.
  5231     MOVE LENGTH OF
  5232      DAILY-ACTIVITY-RECORD
  5233       TO DFHEIV11
  5234     MOVE 'DLYACTV' TO DFHEIV1
  5235*    MOVE '&$ L                  ''   #00005049' TO DFHEIV0
  5236     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5237     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5238     MOVE X'2020233030303035303439' TO DFHEIV0(25:11)
  5239     CALL 'kxdfhei1' USING DFHEIV0,
  5240           DFHEIV1,
  5241           DAILY-ACTIVITY-RECORD,
  5242           DFHEIV11,
  5243           DA-KEY,
  5244           DFHEIV99,
  5245           DFHEIV99
  5246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5247
  5248
  5249 2350-EXIT.
  5250     EXIT.
  5251
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 102
* EL151.cbl
  5252/
  5253*************************************************************
  5254*****      CSO ADDITION - FOR BUILDING ACTIVITY FILE      ***
  5255*************************************************************
  5256
  5257 3500-BUILD-ACTIVITY-RECORD.
  5258
  5259     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  5260     MOVE WS-CLAIM-KEY           TO DA-KEY.
  5261     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
  5262                                 GIVING DA-TRAILER-SEQ-NO.
  5263     MOVE 'D'                    TO DA-RECORD-TYPE.
  5264
  5265 3500-EXIT.
  5266     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 103
* EL151.cbl
  5267/
  5268 3550-FIND-LETTER-TRLR.
  5269      MOVE PI-COMPANY-CD             TO  WS-KEY-COMPANY-CD.
  5270      MOVE PI-CARRIER                TO  WS-KEY-CARRIER.
  5271      MOVE PI-CLAIM-NO               TO  WS-KEY-CLAIM-NO.
  5272      MOVE PI-CERT-NO                TO  WS-KEY-CERT-NO.
  5273      MOVE +100                      TO  WS-KEY-SEQUENCE-NO.
  5274
  5275 3550-STARTBR-ELTRLR.
  5276
  5277
  5278* EXEC CICS HANDLE CONDITION
  5279*         ENDFILE   (3550-END)
  5280*         NOTFND    (3550-END)
  5281*     END-EXEC.
  5282*    MOVE '"$''I                  ! % #00005083' TO DFHEIV0
  5283     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  5284     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5285     MOVE X'2520233030303035303833' TO DFHEIV0(25:11)
  5286     CALL 'kxdfhei1' USING DFHEIV0
  5287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5288
  5289
  5290
  5291* EXEC CICS STARTBR
  5292*         DATASET   (ELTRLR-FILE-ID)
  5293*         RIDFLD    (WS-TRAILER-KEY)
  5294*         GTEQ
  5295*     END-EXEC.
  5296     MOVE 0
  5297       TO DFHEIV11
  5298*    MOVE '&,         G          &   #00005088' TO DFHEIV0
  5299     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5300     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5301     MOVE X'2020233030303035303838' TO DFHEIV0(25:11)
  5302     CALL 'kxdfhei1' USING DFHEIV0,
  5303           ELTRLR-FILE-ID,
  5304           WS-TRAILER-KEY,
  5305           DFHEIV99,
  5306           DFHEIV11,
  5307           DFHEIV99
  5308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5309
  5310
  5311      MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
  5312
  5313 3550-READNEXT-ELTRLR.
  5314
  5315
  5316* EXEC CICS READNEXT
  5317*         DATASET   (ELTRLR-FILE-ID)
  5318*         RIDFLD    (WS-TRAILER-KEY)
  5319*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  5320*     END-EXEC.
  5321     MOVE 0
  5322       TO DFHEIV11
  5323*    MOVE '&.S                   )   #00005098' TO DFHEIV0
  5324     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 104
* EL151.cbl
  5325     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5326     MOVE X'2020233030303035303938' TO DFHEIV0(25:11)
  5327     CALL 'kxdfhei1' USING DFHEIV0,
  5328           ELTRLR-FILE-ID,
  5329           DFHEIV20,
  5330           DFHEIV99,
  5331           WS-TRAILER-KEY,
  5332           DFHEIV99,
  5333           DFHEIV11,
  5334           DFHEIV99,
  5335           DFHEIV99
  5336     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5337         DFHEIV20
  5338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5339
  5340
  5341      IF (PI-COMPANY-CD IS NOT EQUAL TO  WS-KEY-COMPANY-CD) OR
  5342         (PI-CARRIER    IS NOT EQUAL TO  WS-KEY-CARRIER)    OR
  5343         (PI-CLAIM-NO   IS NOT EQUAL TO  WS-KEY-CLAIM-NO)   OR
  5344         (PI-CERT-NO    IS NOT EQUAL TO  WS-KEY-CERT-NO)
  5345          GO TO 3550-END.
  5346
  5347      IF AT-TRAILER-TYPE IS NOT EQUAL TO '4'
  5348          GO TO 3550-READNEXT-ELTRLR.
  5349
  5350     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-ANSWER-DT
  5351         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER-DT
  5352     END-IF.
  5353
  5354     GO TO 3550-READNEXT-ELTRLR.
  5355
  5356 3550-END.
  5357
  5358     IF WS-MAX-LETTER-ANSWER-DT NOT EQUAL LOW-VALUES AND SPACES
  5359         MOVE SPACES             TO  DC-OPTION-CODE
  5360         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
  5361         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5362         MOVE DC-GREG-DATE-1-MDY TO PI-PROOF-DATE
  5363         MOVE PI-PROOF-DATE TO  MPRFDTO
  5364         INSPECT MPRFDTI REPLACING ALL ' ' BY '/'
  5365     END-IF.
  5366
  5367
  5368* EXEC CICS ENDBR
  5369*         DATASET   (ELTRLR-FILE-ID)
  5370*     END-EXEC.
  5371     MOVE 0
  5372       TO DFHEIV11
  5373*    MOVE '&2                    $   #00005130' TO DFHEIV0
  5374     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5375     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5376     MOVE X'2020233030303035313330' TO DFHEIV0(25:11)
  5377     CALL 'kxdfhei1' USING DFHEIV0,
  5378           ELTRLR-FILE-ID,
  5379           DFHEIV11,
  5380           DFHEIV99
  5381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5382
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 105
* EL151.cbl
  5383
  5384 3550-EXIT.
  5385     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 106
* EL151.cbl
  5386/
  5387 6000-RESET-AUTO-ACTIVITY.
  5388******************************************************************
  5389*    RESET ALL FUTURE LETTER ACTIVITY AWAITING FURTHER ACTION    *
  5390*    (RESEND, FOLLOW-UP, ETC) BY MOVING LOW-VALUES TO THE        *
  5391*    FOLLOW-UP OR RESEND DATES IN THE ACTIVITY TRAILER AND THE   *
  5392*    RESEND DATE IS THE LETTER ARCHIVE, IF NECESSARY.            *
  5393******************************************************************
  5394      MOVE PI-COMPANY-CD             TO  WS-KEY-COMPANY-CD.
  5395      MOVE PI-CARRIER                TO  WS-KEY-CARRIER.
  5396      MOVE PI-CLAIM-NO               TO  WS-KEY-CLAIM-NO.
  5397      MOVE PI-CERT-NO                TO  WS-KEY-CERT-NO.
  5398      MOVE +100                      TO  WS-KEY-SEQUENCE-NO.
  5399
  5400 6000-STARTBR-ELTRLR.
  5401
  5402
  5403* EXEC CICS HANDLE CONDITION
  5404*         ENDFILE   (6000-END-RESET)
  5405*         NOTFND    (6000-END-RESET)
  5406*     END-EXEC.
  5407*    MOVE '"$''I                  ! & #00005152' TO DFHEIV0
  5408     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  5409     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5410     MOVE X'2620233030303035313532' TO DFHEIV0(25:11)
  5411     CALL 'kxdfhei1' USING DFHEIV0
  5412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5413
  5414
  5415
  5416* EXEC CICS STARTBR
  5417*         DATASET   (ELTRLR-FILE-ID)
  5418*         RIDFLD    (WS-TRAILER-KEY)
  5419*         GTEQ
  5420*     END-EXEC.
  5421     MOVE 0
  5422       TO DFHEIV11
  5423*    MOVE '&,         G          &   #00005157' TO DFHEIV0
  5424     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5425     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5426     MOVE X'2020233030303035313537' TO DFHEIV0(25:11)
  5427     CALL 'kxdfhei1' USING DFHEIV0,
  5428           ELTRLR-FILE-ID,
  5429           WS-TRAILER-KEY,
  5430           DFHEIV99,
  5431           DFHEIV11,
  5432           DFHEIV99
  5433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5434
  5435
  5436      MOVE 'Y'                       TO  WS-BROWSE-SW.
  5437
  5438 6000-READNEXT-ELTRLR.
  5439
  5440
  5441* EXEC CICS READNEXT
  5442*         DATASET   (ELTRLR-FILE-ID)
  5443*         RIDFLD    (WS-TRAILER-KEY)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 107
* EL151.cbl
  5444*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  5445*     END-EXEC.
  5446     MOVE 0
  5447       TO DFHEIV11
  5448*    MOVE '&.S                   )   #00005167' TO DFHEIV0
  5449     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  5450     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5451     MOVE X'2020233030303035313637' TO DFHEIV0(25:11)
  5452     CALL 'kxdfhei1' USING DFHEIV0,
  5453           ELTRLR-FILE-ID,
  5454           DFHEIV20,
  5455           DFHEIV99,
  5456           WS-TRAILER-KEY,
  5457           DFHEIV99,
  5458           DFHEIV11,
  5459           DFHEIV99,
  5460           DFHEIV99
  5461     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5462         DFHEIV20
  5463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5464
  5465
  5466      IF (PI-COMPANY-CD IS NOT EQUAL TO  WS-KEY-COMPANY-CD) OR
  5467         (PI-CARRIER    IS NOT EQUAL TO  WS-KEY-CARRIER)    OR
  5468         (PI-CLAIM-NO   IS NOT EQUAL TO  WS-KEY-CLAIM-NO)   OR
  5469         (PI-CERT-NO    IS NOT EQUAL TO  WS-KEY-CERT-NO)
  5470          GO TO 6000-END-RESET.
  5471
  5472      IF WS-TRAILER-KEY IS EQUAL TO PI-PREV-TRLR-KEY
  5473          GO TO 6000-READNEXT-ELTRLR.
  5474
  5475      IF AT-TRAILER-TYPE IS NOT EQUAL TO '4'
  5476          GO TO 6000-READNEXT-ELTRLR.
  5477
  5478      IF (AT-LETTER-ANSWERED-DT NOT EQUAL LOW-VALUES AND SPACES)
  5479          GO TO 6000-READNEXT-ELTRLR.
  5480
  5481      IF (AT-AUTO-RE-SEND-DT EQUAL LOW-VALUES OR SPACES)
  5482        AND
  5483         (AT-RECEIPT-FOLLOW-UP EQUAL LOW-VALUES OR SPACES)
  5484          GO TO 6000-READNEXT-ELTRLR.
  5485
  5486      IF AT-RECEIPT-FOLLOW-UP IS LESS THAN SAVE-BIN-DATE AND
  5487         AT-AUTO-RE-SEND-DT IS LESS THAN SAVE-BIN-DATE   AND
  5488         AT-RESEND-PRINT-DATE IS LESS THAN SAVE-BIN-DATE
  5489          GO TO 6000-READNEXT-ELTRLR.
  5490
  5491      IF (AT-AUTO-RE-SEND-DT NOT EQUAL LOW-VALUES AND SPACES)
  5492        AND
  5493         (AT-RESEND-PRINT-DATE NOT EQUAL LOW-VALUES AND SPACES)
  5494        AND
  5495         (AT-RECEIPT-FOLLOW-UP EQUAL LOW-VALUES)
  5496          GO TO 6000-READNEXT-ELTRLR.
  5497
  5498 6000-END-BROWSE.
  5499
  5500      MOVE WS-TRAILER-KEY            TO  PI-PREV-TRLR-KEY.
  5501
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 108
* EL151.cbl
  5502
  5503* EXEC CICS ENDBR
  5504*         DATASET   (ELTRLR-FILE-ID)
  5505*     END-EXEC.
  5506     MOVE 0
  5507       TO DFHEIV11
  5508*    MOVE '&2                    $   #00005209' TO DFHEIV0
  5509     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5510     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5511     MOVE X'2020233030303035323039' TO DFHEIV0(25:11)
  5512     CALL 'kxdfhei1' USING DFHEIV0,
  5513           ELTRLR-FILE-ID,
  5514           DFHEIV11,
  5515           DFHEIV99
  5516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5517
  5518
  5519      MOVE 'N'                       TO  WS-BROWSE-SW.
  5520
  5521 6000-READ-ELTRLR-UPDATE.
  5522
  5523
  5524* EXEC CICS READ
  5525*         DATASET   (ELTRLR-FILE-ID)
  5526*         RIDFLD    (WS-TRAILER-KEY)
  5527*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  5528*         UPDATE
  5529*     END-EXEC.
  5530*    MOVE '&"S        EU         (   #00005217' TO DFHEIV0
  5531     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5532     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5533     MOVE X'2020233030303035323137' TO DFHEIV0(25:11)
  5534     CALL 'kxdfhei1' USING DFHEIV0,
  5535           ELTRLR-FILE-ID,
  5536           DFHEIV20,
  5537           DFHEIV99,
  5538           WS-TRAILER-KEY,
  5539           DFHEIV99,
  5540           DFHEIV99,
  5541           DFHEIV99
  5542     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5543         DFHEIV20
  5544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5545
  5546
  5547      MOVE 'Y'                       TO  WS-UPDATE-SW.
  5548
  5549      IF AT-AUTO-RE-SEND-DT IS NOT LESS THAN SAVE-BIN-DATE
  5550          MOVE LOW-VALUES            TO  AT-AUTO-RE-SEND-DT
  5551          MOVE PI-COMPANY-CD         TO  ELARCH-COMPANY-CD
  5552          MOVE AT-LETTER-ARCHIVE-NO  TO  ELARCH-ARCHIVE-NO
  5553          MOVE '1'                   TO  ELARCH-RECORD-TYPE
  5554          MOVE +0                    TO  ELARCH-SEQ-NO
  5555          PERFORM 6200-READ-ELARCH-UPDATE THRU 6200-EXIT.
  5556
  5557      IF AT-RECEIPT-FOLLOW-UP IS NOT LESS THAN SAVE-BIN-DATE
  5558          MOVE LOW-VALUES            TO  AT-RECEIPT-FOLLOW-UP.
  5559
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 109
* EL151.cbl
  5560 6000-REWRITE-ELTRLR.
  5561
  5562
  5563* EXEC CICS REWRITE
  5564*         DATASET   (ELTRLR-FILE-ID)
  5565*         FROM      (ACTIVITY-TRAILERS)
  5566*     END-EXEC.
  5567     MOVE LENGTH OF
  5568      ACTIVITY-TRAILERS
  5569       TO DFHEIV11
  5570*    MOVE '&& L                  %   #00005239' TO DFHEIV0
  5571     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5572     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5573     MOVE X'2020233030303035323339' TO DFHEIV0(25:11)
  5574     CALL 'kxdfhei1' USING DFHEIV0,
  5575           ELTRLR-FILE-ID,
  5576           ACTIVITY-TRAILERS,
  5577           DFHEIV11,
  5578           DFHEIV99
  5579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5580
  5581
  5582      GO TO 6000-STARTBR-ELTRLR.
  5583
  5584 6000-END-RESET.
  5585
  5586      IF WS-BROWSE-SW IS EQUAL TO 'Y'
  5587          MOVE 'N'                   TO  WS-BROWSE-SW
  5588
  5589* EXEC CICS ENDBR
  5590*             DATASET   (ELTRLR-FILE-ID)
  5591*         END-EXEC.
  5592     MOVE 0
  5593       TO DFHEIV11
  5594*    MOVE '&2                    $   #00005250' TO DFHEIV0
  5595     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5596     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5597     MOVE X'2020233030303035323530' TO DFHEIV0(25:11)
  5598     CALL 'kxdfhei1' USING DFHEIV0,
  5599           ELTRLR-FILE-ID,
  5600           DFHEIV11,
  5601           DFHEIV99
  5602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5603
  5604
  5605 6000-EXIT.
  5606     EXIT.
  5607
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 110
* EL151.cbl
  5609 6100-CHECK-AUTO-ACTIVITY.
  5610******************************************************************
  5611*    READ THE AUTOMATIC ACTIVITY RECORD TO DETERMINE IF THE      *
  5612*    AUTOMATIC ACTIVITY CODE IN THE CLAIM MASTER IS TO BE RESET. *
  5613******************************************************************
  5614
  5615
  5616* EXEC CICS HANDLE CONDITION
  5617*         NOTFND   (6100-NOT-FOUND)
  5618*     END-EXEC.
  5619*    MOVE '"$I                   ! '' #00005264' TO DFHEIV0
  5620     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5621     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5622     MOVE X'2720233030303035323634' TO DFHEIV0(25:11)
  5623     CALL 'kxdfhei1' USING DFHEIV0
  5624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5625
  5626
  5627      MOVE PI-COMPANY-ID             TO  ELCNTL-COMPANY-ID.
  5628      MOVE 'T'                       TO  ELCNTL-RECORD-TYPE.
  5629      MOVE SPACES                    TO  ELCNTL-ACCESS.
  5630      MOVE +0                        TO  ELCNTL-SEQ-NO.
  5631
  5632
  5633* EXEC CICS READ
  5634*         DATASET   (ELCNTL-FILE-ID)
  5635*         RIDFLD    (ELCNTL-KEY)
  5636*         SET       (ADDRESS OF CONTROL-FILE)
  5637*     END-EXEC.
  5638*    MOVE '&"S        E          (   #00005273' TO DFHEIV0
  5639     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5640     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5641     MOVE X'2020233030303035323733' TO DFHEIV0(25:11)
  5642     CALL 'kxdfhei1' USING DFHEIV0,
  5643           ELCNTL-FILE-ID,
  5644           DFHEIV20,
  5645           DFHEIV99,
  5646           ELCNTL-KEY,
  5647           DFHEIV99,
  5648           DFHEIV99,
  5649           DFHEIV99
  5650     SET ADDRESS OF CONTROL-FILE TO
  5651         DFHEIV20
  5652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5653
  5654
  5655      IF CL-ACTIVITY-CODE IS NOT EQUAL TO ZEROS
  5656          MOVE CL-ACTIVITY-CODE      TO  MISC-SUB
  5657          IF MISC-SUB IS GREATER THAN +9
  5658              SUBTRACT +9 FROM MISC-SUB
  5659              MOVE CF-USER-RESET-SW (MISC-SUB) TO  WS-RESET-SW
  5660          ELSE
  5661              MOVE CF-SYS-RESET-SW  (MISC-SUB) TO  WS-RESET-SW.
  5662
  5663      MOVE 'Y'                       TO  WS-REC-FOUND-SW.
  5664      GO TO 6100-EXIT.
  5665
  5666 6100-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 111
* EL151.cbl
  5667
  5668     MOVE 'N'                        TO  WS-RESET-SW
  5669                                         WS-REC-FOUND-SW.
  5670
  5671 6100-EXIT.
  5672     EXIT.
  5673
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 112
* EL151.cbl
  5675 6200-READ-ELARCH-UPDATE.
  5676******************************************************************
  5677*  READ AND UPDATE THE RESEND DATE IN THE LETTER ARCHIVE RECORD  *
  5678******************************************************************
  5679
  5680
  5681* EXEC CICS HANDLE CONDITION
  5682*         NOTFND   (6200-EXIT)
  5683*     END-EXEC.
  5684*    MOVE '"$I                   ! ( #00005304' TO DFHEIV0
  5685     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5686     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5687     MOVE X'2820233030303035333034' TO DFHEIV0(25:11)
  5688     CALL 'kxdfhei1' USING DFHEIV0
  5689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5690
  5691
  5692
  5693* EXEC CICS READ
  5694*         DATASET   (ELARCH-FILE-ID)
  5695*         RIDFLD    (ELARCH-KEY)
  5696*         SET       (ADDRESS OF LETTER-ARCHIVE)
  5697*         UPDATE
  5698*     END-EXEC.
  5699*    MOVE '&"S        EU         (   #00005308' TO DFHEIV0
  5700     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5701     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5702     MOVE X'2020233030303035333038' TO DFHEIV0(25:11)
  5703     CALL 'kxdfhei1' USING DFHEIV0,
  5704           ELARCH-FILE-ID,
  5705           DFHEIV20,
  5706           DFHEIV99,
  5707           ELARCH-KEY,
  5708           DFHEIV99,
  5709           DFHEIV99,
  5710           DFHEIV99
  5711     SET ADDRESS OF LETTER-ARCHIVE TO
  5712         DFHEIV20
  5713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5714
  5715
  5716      MOVE LOW-VALUES                TO  LA-RESEND-DATE.
  5717
  5718 6200-REWRITE-ELARCH.
  5719
  5720
  5721* EXEC CICS REWRITE
  5722*         DATASET   (ELARCH-FILE-ID)
  5723*         FROM      (LETTER-ARCHIVE)
  5724*     END-EXEC.
  5725     MOVE LENGTH OF
  5726      LETTER-ARCHIVE
  5727       TO DFHEIV11
  5728*    MOVE '&& L                  %   #00005319' TO DFHEIV0
  5729     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5730     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5731     MOVE X'2020233030303035333139' TO DFHEIV0(25:11)
  5732     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 113
* EL151.cbl
  5733           ELARCH-FILE-ID,
  5734           LETTER-ARCHIVE,
  5735           DFHEIV11,
  5736           DFHEIV99
  5737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5738
  5739
  5740 6200-EXIT.
  5741     EXIT.
  5742
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 114
* EL151.cbl
  5744 7000-READ-ELMSTR-UPDATE.
  5745
  5746
  5747* EXEC CICS  HANDLE CONDITION
  5748*           NOTFND  (7000-NOTFND)
  5749*           NOTOPEN (9981-NOTOPEN-MSTR)
  5750*    END-EXEC.
  5751*    MOVE '"$IJ                  ! ) #00005330' TO DFHEIV0
  5752     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  5753     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5754     MOVE X'2920233030303035333330' TO DFHEIV0(25:11)
  5755     CALL 'kxdfhei1' USING DFHEIV0
  5756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5757
  5758
  5759
  5760* EXEC CICS  READ
  5761*        DATASET  (ELMSTR-FILE-ID)
  5762*        RIDFLD   (WS-CLAIM-KEY)
  5763*        SET      (ADDRESS OF CLAIM-MASTER)
  5764*        UPDATE
  5765*    END-EXEC.
  5766*    MOVE '&"S        EU         (   #00005335' TO DFHEIV0
  5767     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5768     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5769     MOVE X'2020233030303035333335' TO DFHEIV0(25:11)
  5770     CALL 'kxdfhei1' USING DFHEIV0,
  5771           ELMSTR-FILE-ID,
  5772           DFHEIV20,
  5773           DFHEIV99,
  5774           WS-CLAIM-KEY,
  5775           DFHEIV99,
  5776           DFHEIV99,
  5777           DFHEIV99
  5778     SET ADDRESS OF CLAIM-MASTER TO
  5779         DFHEIV20
  5780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5781
  5782
  5783     GO TO 7000-EXIT.
  5784
  5785 7000-NOTFND.
  5786
  5787     MOVE ER-0133                TO  EMI-ERROR.
  5788     MOVE -1                     TO  MLINE1L.
  5789     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5790     GO TO 8200-SEND-DATAONLY.
  5791
  5792 7000-EXIT.
  5793      EXIT.
  5794
  5795 7010-REWRITE-ELMSTR.
  5796
  5797
  5798* EXEC CICS HANDLE CONDITION
  5799*        DUPKEY (7010-EXIT)
  5800*        END-EXEC.
  5801*    MOVE '"$$                   ! * #00005356' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 115
* EL151.cbl
  5802     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  5803     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5804     MOVE X'2A20233030303035333536' TO DFHEIV0(25:11)
  5805     CALL 'kxdfhei1' USING DFHEIV0
  5806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5807
  5808
  5809
  5810* EXEC CICS  REWRITE
  5811*        DATASET  (ELMSTR-FILE-ID)
  5812*        FROM     (CLAIM-MASTER)
  5813*    END-EXEC.
  5814     MOVE LENGTH OF
  5815      CLAIM-MASTER
  5816       TO DFHEIV11
  5817*    MOVE '&& L                  %   #00005360' TO DFHEIV0
  5818     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5819     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5820     MOVE X'2020233030303035333630' TO DFHEIV0(25:11)
  5821     CALL 'kxdfhei1' USING DFHEIV0,
  5822           ELMSTR-FILE-ID,
  5823           CLAIM-MASTER,
  5824           DFHEIV11,
  5825           DFHEIV99
  5826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5827
  5828
  5829 7010-EXIT.
  5830      EXIT.
  5831
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 116
* EL151.cbl
  5833 7100-GETMAIN-ELTRLR.
  5834
  5835
  5836* EXEC CICS GETMAIN
  5837*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  5838*        INITIMG (GETMAIN-SPACE)
  5839*        LENGTH  (WS-TRLR-LENGTH)
  5840*    END-EXEC.
  5841*    MOVE ',"IL                  $   #00005371' TO DFHEIV0
  5842     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5843     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5844     MOVE X'2020233030303035333731' TO DFHEIV0(25:11)
  5845     CALL 'kxdfhei1' USING DFHEIV0,
  5846           DFHEIV20,
  5847           WS-TRLR-LENGTH,
  5848           GETMAIN-SPACE
  5849     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5850         DFHEIV20
  5851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5852
  5853
  5854 7100-EXIT.
  5855     EXIT.
  5856
  5857 7110-WRITE-ELTRLR.
  5858
  5859* EXEC CICS  HANDLE CONDITION
  5860*           DUPREC   (7110-DUPREC)
  5861*    END-EXEC.
  5862*    MOVE '"$%                   ! + #00005381' TO DFHEIV0
  5863     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  5864     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5865     MOVE X'2B20233030303035333831' TO DFHEIV0(25:11)
  5866     CALL 'kxdfhei1' USING DFHEIV0
  5867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5868
  5869
  5870
  5871* EXEC CICS  WRITE
  5872*           DATASET  (ELTRLR-FILE-ID)
  5873*           RIDFLD   (WS-TRAILER-KEY)
  5874*           FROM     (ACTIVITY-TRAILERS)
  5875*    END-EXEC.
  5876     MOVE LENGTH OF
  5877      ACTIVITY-TRAILERS
  5878       TO DFHEIV11
  5879*    MOVE '&$ L                  ''   #00005385' TO DFHEIV0
  5880     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5881     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5882     MOVE X'2020233030303035333835' TO DFHEIV0(25:11)
  5883     CALL 'kxdfhei1' USING DFHEIV0,
  5884           ELTRLR-FILE-ID,
  5885           ACTIVITY-TRAILERS,
  5886           DFHEIV11,
  5887           WS-TRAILER-KEY,
  5888           DFHEIV99,
  5889           DFHEIV99
  5890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 117
* EL151.cbl
  5891
  5892
  5893     GO TO 7110-EXIT.
  5894
  5895 7110-DUPREC.
  5896
  5897     MOVE ER-0132                TO  EMI-ERROR.
  5898     MOVE -1                     TO  MLINE1L.
  5899     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5900     GO TO 8200-SEND-DATAONLY.
  5901
  5902 7110-EXIT.
  5903      EXIT.
  5904
  5905 7120-READ-ELTRLR-UPDATE.
  5906
  5907
  5908* EXEC CICS  HANDLE CONDITION
  5909*           NOTFND  (9965-NO-TRLR-ERROR)
  5910*           NOTOPEN (9982-NOTOPEN-TRLR)
  5911*    END-EXEC.
  5912*    MOVE '"$IJ                  ! , #00005405' TO DFHEIV0
  5913     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  5914     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5915     MOVE X'2C20233030303035343035' TO DFHEIV0(25:11)
  5916     CALL 'kxdfhei1' USING DFHEIV0
  5917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5918
  5919
  5920
  5921* EXEC CICS  READ
  5922*        DATASET  (ELTRLR-FILE-ID)
  5923*        RIDFLD   (WS-TRAILER-KEY)
  5924*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  5925*        UPDATE
  5926*    END-EXEC.
  5927*    MOVE '&"S        EU         (   #00005410' TO DFHEIV0
  5928     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5929     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5930     MOVE X'2020233030303035343130' TO DFHEIV0(25:11)
  5931     CALL 'kxdfhei1' USING DFHEIV0,
  5932           ELTRLR-FILE-ID,
  5933           DFHEIV20,
  5934           DFHEIV99,
  5935           WS-TRAILER-KEY,
  5936           DFHEIV99,
  5937           DFHEIV99,
  5938           DFHEIV99
  5939     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5940         DFHEIV20
  5941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5942
  5943
  5944 7120-EXIT.
  5945      EXIT.
  5946
  5947 7130-REWRITE-ELTRLR.
  5948
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 118
* EL151.cbl
  5949
  5950* EXEC CICS  REWRITE
  5951*        DATASET  (ELTRLR-FILE-ID)
  5952*        FROM     (ACTIVITY-TRAILERS)
  5953*    END-EXEC.
  5954     MOVE LENGTH OF
  5955      ACTIVITY-TRAILERS
  5956       TO DFHEIV11
  5957*    MOVE '&& L                  %   #00005422' TO DFHEIV0
  5958     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5959     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5960     MOVE X'2020233030303035343232' TO DFHEIV0(25:11)
  5961     CALL 'kxdfhei1' USING DFHEIV0,
  5962           ELTRLR-FILE-ID,
  5963           ACTIVITY-TRAILERS,
  5964           DFHEIV11,
  5965           DFHEIV99
  5966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5967
  5968
  5969 7130-EXIT.
  5970      EXIT.
  5971
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 119
* EL151.cbl
  5973 8100-SEND-INITIAL-MAP.
  5974
  5975     MOVE SAVE-DATE                  TO  MRNDATEO.
  5976     MOVE EIBTIME                    TO  TIME-IN.
  5977     MOVE TIME-OUT                   TO  MRNTIMEO.
  5978
  5979
  5980* EXEC CICS  SEND
  5981*         MAP      (MAP-NAME)
  5982*         MAPSET   (MAPSET-NAME)
  5983*         FROM     (EL151AO)
  5984*         ERASE
  5985*         CURSOR
  5986*    END-EXEC.
  5987     MOVE LENGTH OF
  5988      EL151AO
  5989       TO DFHEIV12
  5990     MOVE -1
  5991       TO DFHEIV11
  5992*    MOVE '8$     CT  E    H L F ,   #00005437' TO DFHEIV0
  5993     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5994     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5995     MOVE X'2020233030303035343337' TO DFHEIV0(25:11)
  5996     CALL 'kxdfhei1' USING DFHEIV0,
  5997           MAP-NAME,
  5998           EL151AO,
  5999           DFHEIV12,
  6000           MAPSET-NAME,
  6001           DFHEIV99,
  6002           DFHEIV99,
  6003           DFHEIV99,
  6004           DFHEIV11,
  6005           DFHEIV99,
  6006           DFHEIV99,
  6007           DFHEIV99
  6008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6009
  6010
  6011     GO TO 9100-RETURN-TRAN.
  6012
  6013 8200-SEND-DATAONLY.
  6014
  6015     MOVE SAVE-DATE                  TO  MRNDATEO.
  6016     MOVE EIBTIME                    TO  TIME-IN.
  6017     MOVE TIME-OUT                   TO  MRNTIMEO.
  6018
  6019
  6020* EXEC CICS  SEND
  6021*        MAP       (MAP-NAME)
  6022*        MAPSET    (MAPSET-NAME)
  6023*        FROM      (EL151AO)
  6024*        DATAONLY
  6025*        CURSOR
  6026*    END-EXEC.
  6027     MOVE LENGTH OF
  6028      EL151AO
  6029       TO DFHEIV12
  6030     MOVE -1
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 120
* EL151.cbl
  6031       TO DFHEIV11
  6032*    MOVE '8$D    CT       H L F ,   #00005453' TO DFHEIV0
  6033     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  6034     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  6035     MOVE X'2020233030303035343533' TO DFHEIV0(25:11)
  6036     CALL 'kxdfhei1' USING DFHEIV0,
  6037           MAP-NAME,
  6038           EL151AO,
  6039           DFHEIV12,
  6040           MAPSET-NAME,
  6041           DFHEIV99,
  6042           DFHEIV99,
  6043           DFHEIV99,
  6044           DFHEIV11,
  6045           DFHEIV99,
  6046           DFHEIV99,
  6047           DFHEIV99
  6048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6049
  6050
  6051     GO TO 9100-RETURN-TRAN.
  6052
  6053 8300-SEND-TEXT.
  6054
  6055* EXEC CICS SEND TEXT
  6056*        FROM     (LOGOFF-TEXT)
  6057*        LENGTH   (LOGOFF-LENGTH)
  6058*        ERASE
  6059*        FREEKB
  6060*    END-EXEC.
  6061*    MOVE '8&      T  E F  H   F -   #00005464' TO DFHEIV0
  6062     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  6063     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  6064     MOVE X'2020233030303035343634' TO DFHEIV0(25:11)
  6065     CALL 'kxdfhei1' USING DFHEIV0,
  6066           LOGOFF-TEXT,
  6067           LOGOFF-LENGTH,
  6068           DFHEIV99,
  6069           DFHEIV99,
  6070           DFHEIV99,
  6071           DFHEIV99,
  6072           DFHEIV99,
  6073           DFHEIV99,
  6074           DFHEIV99,
  6075           DFHEIV99,
  6076           DFHEIV99,
  6077           DFHEIV99
  6078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6079
  6080
  6081
  6082* EXEC CICS RETURN
  6083*        END-EXEC.
  6084*    MOVE '.(                    ''   #00005471' TO DFHEIV0
  6085     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  6086     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6087     MOVE X'2020233030303035343731' TO DFHEIV0(25:11)
  6088     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 121
* EL151.cbl
  6089           DFHEIV99,
  6090           DFHEIV99,
  6091           DFHEIV99,
  6092           DFHEIV99,
  6093           DFHEIV99,
  6094           DFHEIV99
  6095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6096
  6097
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 122
* EL151.cbl
  6099 9600-PGMID-ERROR.
  6100
  6101* EXEC CICS HANDLE CONDITION
  6102*        PGMIDERR (8300-SEND-TEXT)
  6103*    END-EXEC.
  6104*    MOVE '"$L                   ! - #00005476' TO DFHEIV0
  6105     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  6106     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6107     MOVE X'2D20233030303035343736' TO DFHEIV0(25:11)
  6108     CALL 'kxdfhei1' USING DFHEIV0
  6109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6110
  6111
  6112     MOVE THIS-PGM               TO LOGOFF-PGM
  6113                                    PI-CALLING-PROGRAM.
  6114     MOVE SPACES                 TO PI-ENTRY-CD-1.
  6115     MOVE 'EL005'                TO THIS-PGM.
  6116     MOVE THIS-PGM               TO LOGOFF-PGM.
  6117     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  6118     GO TO 9300-XCTL.
  6119
  6120 8800-UNAUTHORIZED-ACCESS.
  6121
  6122     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  6123     GO TO 8300-SEND-TEXT.
  6124
  6125 9100-RETURN-TRAN.
  6126     MOVE EMI-ERROR-NUMBER (1)    TO  PI-LAST-ERROR-NO.
  6127     MOVE '151A'                  TO  PI-CURRENT-SCREEN-NO.
  6128
  6129
  6130* EXEC CICS  RETURN
  6131*        TRANSID  (WS-TRANS-ID)
  6132*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  6133*        LENGTH   (PI-COMM-LENGTH)
  6134*    END-EXEC.
  6135*    MOVE '.(CT                  ''   #00005497' TO DFHEIV0
  6136     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  6137     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6138     MOVE X'2020233030303035343937' TO DFHEIV0(25:11)
  6139     CALL 'kxdfhei1' USING DFHEIV0,
  6140           WS-TRANS-ID,
  6141           PROGRAM-INTERFACE-BLOCK,
  6142           PI-COMM-LENGTH,
  6143           DFHEIV99,
  6144           DFHEIV99,
  6145           DFHEIV99
  6146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6147
  6148
  6149 9300-XCTL.
  6150
  6151* EXEC CICS XCTL
  6152*        PROGRAM  (THIS-PGM)
  6153*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  6154*        LENGTH   (PI-COMM-LENGTH)
  6155*    END-EXEC.
  6156*    MOVE '.$C                   %   #00005504' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 123
* EL151.cbl
  6157     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  6158     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6159     MOVE X'2020233030303035353034' TO DFHEIV0(25:11)
  6160     CALL 'kxdfhei1' USING DFHEIV0,
  6161           THIS-PGM,
  6162           PROGRAM-INTERFACE-BLOCK,
  6163           PI-COMM-LENGTH,
  6164           DFHEIV99
  6165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6166
  6167
  6168 9400-CLEAR.
  6169     MOVE PI-RETURN-TO-PROGRAM       TO  THIS-PGM.
  6170     GO TO 9300-XCTL.
  6171
  6172 9650-DEEDIT.
  6173
  6174* EXEC CICS BIF DEEDIT
  6175*        FIELD (DEEDIT-FIELD)
  6176*        LENGTH(15)
  6177*    END-EXEC.
  6178     MOVE 15
  6179       TO DFHEIV11
  6180*    MOVE '@"L                   #   #00005515' TO DFHEIV0
  6181     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6182     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6183     MOVE X'2020233030303035353135' TO DFHEIV0(25:11)
  6184     CALL 'kxdfhei1' USING DFHEIV0,
  6185           DEEDIT-FIELD,
  6186           DFHEIV11
  6187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6188
  6189
  6190 9650-EXIT.
  6191      EXIT.
  6192
  6193 9700-LINK-DATE-CONVERT.
  6194
  6195* EXEC CICS LINK
  6196*           PROGRAM  ('ELDATCV')
  6197*           COMMAREA (DATE-CONVERSION-DATA)
  6198*           LENGTH   (DC-COMM-LENGTH)
  6199*    END-EXEC.
  6200     MOVE 'ELDATCV' TO DFHEIV1
  6201*    MOVE '."C                   (   #00005524' TO DFHEIV0
  6202     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6203     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6204     MOVE X'2020233030303035353234' TO DFHEIV0(25:11)
  6205     CALL 'kxdfhei1' USING DFHEIV0,
  6206           DFHEIV1,
  6207           DATE-CONVERSION-DATA,
  6208           DC-COMM-LENGTH,
  6209           DFHEIV99,
  6210           DFHEIV99,
  6211           DFHEIV99,
  6212           DFHEIV99
  6213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6214
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 124
* EL151.cbl
  6215
  6216 9700-EXIT.
  6217      EXIT.
  6218
  6219 9900-ERROR-FORMAT.
  6220
  6221
  6222* EXEC CICS LINK
  6223*        PROGRAM  ('EL001')
  6224*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  6225*        LENGTH   (EMI-COMM-LENGTH)
  6226*    END-EXEC.
  6227     MOVE 'EL001' TO DFHEIV1
  6228*    MOVE '."C                   (   #00005535' TO DFHEIV0
  6229     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6230     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6231     MOVE X'2020233030303035353335' TO DFHEIV0(25:11)
  6232     CALL 'kxdfhei1' USING DFHEIV0,
  6233           DFHEIV1,
  6234           ERROR-MESSAGE-INTERFACE-BLOCK,
  6235           EMI-COMM-LENGTH,
  6236           DFHEIV99,
  6237           DFHEIV99,
  6238           DFHEIV99,
  6239           DFHEIV99
  6240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6241
  6242
  6243     MOVE EMI-LINE1              TO  MERMSG1O.
  6244
  6245 9900-EXIT.
  6246      EXIT.
  6247
  6248 9965-NO-TRLR-ERROR.
  6249     MOVE ER-0270                TO  EMI-ERROR.
  6250     MOVE -1                     TO  MLINE1L.
  6251     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6252     GO TO 8200-SEND-DATAONLY.
  6253
  6254 9981-NOTOPEN-MSTR.
  6255     MOVE ER-0154                TO EMI-ERROR
  6256     MOVE -1                     TO  MLINE1L.
  6257     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6258     GO TO 8200-SEND-DATAONLY.
  6259
  6260 9982-NOTOPEN-TRLR.
  6261     MOVE ER-0172                TO EMI-ERROR
  6262     MOVE -1                     TO  MLINE1L.
  6263     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6264     GO TO 8200-SEND-DATAONLY.
  6265
  6266 9986-NOTOPEN-DLYACTV.
  6267     MOVE '2955'                 TO EMI-ERROR.
  6268     MOVE -1                     TO  MLINE1L.
  6269     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6270     GO TO 8200-SEND-DATAONLY.
  6271
  6272 9995-SECURITY-VIOLATION.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 125
* EL151.cbl
  6273*                            COPY ELCSCTP.
  6274******************************************************************
  6275*                                                                *
  6276*                            ELCSCTP                             *
  6277*                            VMOD=2.001                          *
  6278*                                                                *
  6279*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  6280******************************************************************
  6281
  6282
  6283     MOVE EIBDATE          TO SM-JUL-DATE.
  6284     MOVE EIBTRMID         TO SM-TERMID.
  6285     MOVE THIS-PGM         TO SM-PGM.
  6286     MOVE EIBTIME          TO TIME-IN.
  6287     MOVE TIME-OUT         TO SM-TIME.
  6288     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  6289
  6290
  6291* EXEC CICS LINK
  6292*         PROGRAM  ('EL003')
  6293*         COMMAREA (SECURITY-MESSAGE)
  6294*         LENGTH   (80)
  6295*    END-EXEC.
  6296     MOVE 'EL003' TO DFHEIV1
  6297     MOVE 80
  6298       TO DFHEIV11
  6299*    MOVE '."C                   (   #00005588' TO DFHEIV0
  6300     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6301     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6302     MOVE X'2020233030303035353838' TO DFHEIV0(25:11)
  6303     CALL 'kxdfhei1' USING DFHEIV0,
  6304           DFHEIV1,
  6305           SECURITY-MESSAGE,
  6306           DFHEIV11,
  6307           DFHEIV99,
  6308           DFHEIV99,
  6309           DFHEIV99,
  6310           DFHEIV99
  6311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6312
  6313
  6314******************************************************************
  6315
  6316
  6317 9995-EXIT.
  6318     EXIT.
  6319
  6320 9990-ABEND.
  6321     MOVE -1                      TO  MPFNUMBL.
  6322     MOVE DFHEIBLK                TO  EMI-LINE1.
  6323
  6324
  6325* EXEC CICS LINK
  6326*          PROGRAM  ('EL004')
  6327*          COMMAREA (EMI-LINE1)
  6328*          LENGTH   (72)
  6329*    END-EXEC.
  6330     MOVE 'EL004' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 126
* EL151.cbl
  6331     MOVE 72
  6332       TO DFHEIV11
  6333*    MOVE '."C                   (   #00005604' TO DFHEIV0
  6334     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6335     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6336     MOVE X'2020233030303035363034' TO DFHEIV0(25:11)
  6337     CALL 'kxdfhei1' USING DFHEIV0,
  6338           DFHEIV1,
  6339           EMI-LINE1,
  6340           DFHEIV11,
  6341           DFHEIV99,
  6342           DFHEIV99,
  6343           DFHEIV99,
  6344           DFHEIV99
  6345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6346
  6347
  6348     MOVE EMI-LINE1               TO  MERMSG1O.
  6349     GO TO 8200-SEND-DATAONLY.
  6350
  6351
  6352 9999-DFHBACK SECTION.
  6353     MOVE '9%                    "   ' TO DFHEIV0
  6354     MOVE 'EL151' TO DFHEIV1
  6355     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6356     GOBACK.
  6357 9999-DFHEXIT.
  6358     IF DFHEIGDJ EQUAL 0001
  6359         NEXT SENTENCE
  6360     ELSE IF DFHEIGDJ EQUAL 2
  6361         GO TO 9990-ABEND,
  6362               9600-PGMID-ERROR
  6363         DEPENDING ON DFHEIGDI
  6364     ELSE IF DFHEIGDJ EQUAL 3
  6365         GO TO 2000-NOTE-NOT-FOUND
  6366         DEPENDING ON DFHEIGDI
  6367     ELSE IF DFHEIGDJ EQUAL 4
  6368         GO TO 9986-NOTOPEN-DLYACTV,
  6369               2350-EXIT
  6370         DEPENDING ON DFHEIGDI
  6371     ELSE IF DFHEIGDJ EQUAL 5
  6372         GO TO 3550-END,
  6373               3550-END
  6374         DEPENDING ON DFHEIGDI
  6375     ELSE IF DFHEIGDJ EQUAL 6
  6376         GO TO 6000-END-RESET,
  6377               6000-END-RESET
  6378         DEPENDING ON DFHEIGDI
  6379     ELSE IF DFHEIGDJ EQUAL 7
  6380         GO TO 6100-NOT-FOUND
  6381         DEPENDING ON DFHEIGDI
  6382     ELSE IF DFHEIGDJ EQUAL 8
  6383         GO TO 6200-EXIT
  6384         DEPENDING ON DFHEIGDI
  6385     ELSE IF DFHEIGDJ EQUAL 9
  6386         GO TO 7000-NOTFND,
  6387               9981-NOTOPEN-MSTR
  6388         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:13 Page 127
* EL151.cbl
  6389     ELSE IF DFHEIGDJ EQUAL 10
  6390         GO TO 7010-EXIT
  6391         DEPENDING ON DFHEIGDI
  6392     ELSE IF DFHEIGDJ EQUAL 11
  6393         GO TO 7110-DUPREC
  6394         DEPENDING ON DFHEIGDI
  6395     ELSE IF DFHEIGDJ EQUAL 12
  6396         GO TO 9965-NO-TRLR-ERROR,
  6397               9982-NOTOPEN-TRLR
  6398         DEPENDING ON DFHEIGDI
  6399     ELSE IF DFHEIGDJ EQUAL 13
  6400         GO TO 8300-SEND-TEXT
  6401         DEPENDING ON DFHEIGDI.
  6402     MOVE '9%                    "   ' TO DFHEIV0
  6403     MOVE 'EL151' TO DFHEIV1
  6404     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6405     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5328     Code:       13330
