* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page   1
* WSMESS01.cbl
* Options: int("WSMESS01.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("WSMESS01.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"WSMESS01.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "WSMESS01.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3 PROGRAM-ID. WSMESS01.
     4 AUTHOR.     Cowtown.
     5 DATE-COMPILED. 08-Aug-17 09:02.
     6*SECURITY.   *****************************************************
     7*            *                                                   *
     8*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
     9*            *                                                   *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF     CSO     IS EXPRESSLY PROHIBITED WITHOUT  *
    12*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    13*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page   2
* WSMESS01.cbl
    14*            *****************************************************
    15******************************************************************
    16*REMARKS.                                                        *
    17*  Returns premium calc based on info passed to me.              *
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 020617   2017020300002   PEMA  New Program
    27* 080117   2017020300002   PEMA  Tol for tot pmts, use totpmts GP
    28******************************************************************
    29 ENVIRONMENT DIVISION.
    30 data division.
    31 WORKING-STORAGE SECTION.
    32 01  DFH-START PIC X(04).
    33 77  FILLER  PIC X(32) VALUE '********************************'.
    34 77  FILLER  PIC X(32) VALUE '   WSMESS01 WORKING STORAGE     '.
    35 77  FILLER  PIC X(32) VALUE '********************************'.
    36*
    37* program buffers
    38*
    39 77  ws-seq-num                  pic s9(8) comp value 0.
    40 77  ws-flags                    pic s9(8) comp value 0.
    41 77  WS-COMP-CD                  PIC X  VALUE LOW-VALUES.
    42 77  ws-comp-id                  pic xxx value spaces.
    43 77  WS-SAVE-ACCOUNT             PIC X(10)  VALUE SPACES.
    44 77  WS-BIN-ORIG-EFF-DT          PIC XX  VALUE LOW-VALUES.
    45 77  WS-ORIG-EFF-DT              PIC X(10)  VALUE SPACES.
    46 77  WS-EFF-DATE                 PIC X(10)  VALUE SPACES.
    47 77  WS-EXP-DATE                 PIC X(10)  VALUE SPACES.
    48 77  X1                          PIC S999 COMP-3 VALUE +0.
    49 77  S1                          PIC S999 COMP-3 VALUE +0.
    50 77  S2                          PIC S999 COMP-3 VALUE +0.
    51 77  S3                          PIC S999 COMP-3 VALUE +0.
    52 77  b1                          pic s999 comp-3 value +0.
    53 77  WS-BUILD-SW                 PIC X.
    54     88  TIME-TO-BUILD              VALUE 'Y'.
    55 77  WS-SAVE-ERACCT              PIC X(2000).
    56 77  WS-DIS-RESP                 PIC 9(05) VALUE ZEROS.
    57 77  WS-PERFORM-SW               PIC X VALUE SPACES.
    58     88  GET-RATES                   VALUE 'R'.
    59     88  GET-ACT-ACCTS               VALUE 'A'.
    60 77  ws-bin-current-dt           pic xx  value low-values.
    61 77  ws-bin-eff-dt               pic xx  value low-values.
    62 77  ws-bin-exp-dt               pic xx  value low-values.
    63 77  ws-bin-1st-pmt-dt           pic xx  value low-values.
    64 77  ws-bin-pri-birth-dt         pic xx  value low-values.
    65 77  ws-bin-cob-birth-dt         pic xx  value low-values.
    66 77  WS-DISP-AMT                 PIC Z,ZZZ,Z99.99.
    67 77  ws-disp-rate                pic z9.99999.
    68 77  WS-ERACCT-SW                PIC X VALUE ' '.
    69     88  END-OF-ERACCT                 VALUE 'Y'.
    70 77  WS-ERCTBL-SW                PIC X VALUE ' '.
    71     88  END-OF-ERCTBL                 VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page   3
* WSMESS01.cbl
    72 77  WS-STATUS                   PIC X.
    73 77  ws-socket-sw                pic x value ' '.
    74     88  end-of-socket              value 'Y'.
    75 77  rec-cnt                     pic 9(5) value zeros.
    76 77  ws-stop-sw                  pic x value ' '.
    77     88  i-say-stop                 value 'Y'.
    78 77  ws-browse-sw                pic x value ' '.
    79     88  browse-started            value 'Y'.
    80 77  ws-contract-sw              pic x  value ' '.
    81     88  contract-no-assigned      value 'Y'.
    82 77  ws-error-sw                 pic x value ' '.
    83     88  error-in-one-coverage     value 'Y'.
    84 77  ws-connect-sw               pic x value ' '.
    85     88  connected-to-db           value 'Y'.
    86 77  client-id                   pic xxx.
    87 01  P pointer.
    88 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    89 01  var-ptr pointer.
    90 01  env-var-len                 pic 9(4)  binary.
    91 01  rc                          pic 9(9)  binary.
    92 01  WS-KIXSYS.
    93     05  WS-KIX-FIL1             PIC X(10).
    94     05  WS-KIX-APPS             PIC X(10).
    95     05  WS-KIX-ENV              PIC X(10).
    96     05  WS-KIX-MYENV            PIC X(10).
    97     05  WS-KIX-SYS              PIC X(10).
*   98 EXEC SQL
*   99    INCLUDE SQLDA
*  100 END-EXEC
   101 01 SQLDA sync.
   102    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   103    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   104    05 SQLN                  PIC S9(4) COMP-5 value 0.
   105    05 SQLD                  PIC S9(4) COMP-5 value 0.
   106    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   107       10 SQLTYPE            PIC S9(4) COMP-5.
   108       10 SQLLEN             PIC S9(4) COMP-5.
   109$IF P64 SET
   110X      *> For 64-bit environments, ensure that SQLDATA is
   111X      *> aligned on an 8-byte boundary.
   112X      10 FILLER             PIC S9(9) COMP-5.
   113$END
   114       10 SQLDATA            USAGE POINTER.
   115       10 SQLIND             USAGE POINTER.
   116       10 SQLNAME.
   117          15 SQLNAMEL        PIC S9(4) COMP-5.
   118          15 SQLNAMEC        PIC X(30).
   119
   120* Values for SQLTYPE
   121
   122 78  ESQL-DATE-CHAR              VALUE 384.
   123 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   124 78  ESQL-DATE-REC               VALUE 386.
   125 78  ESQL-DATE-REC-NULL          VALUE 387.
   126 78  ESQL-TIME-CHAR              VALUE 388.
   127 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   128 78  ESQL-TIME-REC               VALUE 390.
   129 78  ESQL-TIME-REC-NULL          VALUE 391.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page   4
* WSMESS01.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   131 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   132 78  ESQL-TIMESTAMP-REC          VALUE 394.
   133 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   134 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   135 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   136 78  ESQL-TS-OFFSET-REC          VALUE 398.
   137 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   138 78  ESQL-LONGVARBINARY          VALUE 404.
   139 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   140 78  ESQL-LONGVARCHAR            VALUE 408.
   141 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   142 78  ESQL-BINARY                 VALUE 444.
   143 78  ESQL-BINARY-NULL            VALUE 445.
   144 78  ESQL-VARBINARY              VALUE 446.
   145 78  ESQL-VARBINARY-NULL         VALUE 447.
   146 78  ESQL-VARCHAR                VALUE 448.
   147 78  ESQL-VARCHAR-NULL           VALUE 449.
   148
   149 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   150 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   151
   152 78  ESQL-CHAR                   VALUE 452.
   153 78  ESQL-CHAR-NULL              VALUE 453.
   154
   155 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   156 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   157
   158 78  ESQL-DOUBLE                 VALUE 480.
   159 78  ESQL-DOUBLE-NULL            VALUE 481.
   160 78  ESQL-REAL                   VALUE 482.
   161 78  ESQL-REAL-NULL              VALUE 483.
   162 78  ESQL-DECIMAL                VALUE 484.
   163 78  ESQL-DECIMAL-NULL           VALUE 485.
   164 78  ESQL-INTEGER                VALUE 496.
   165 78  ESQL-INTEGER-NULL           VALUE 497.
   166 78  ESQL-SMALLINT               VALUE 500.
   167 78  ESQL-SMALLINT-NULL          VALUE 501.
   168 78  ESQL-TINYINT                VALUE 502.
   169 78  ESQL-TINYINT-NULL           VALUE 503.
*  170 EXEC SQL
*  171    INCLUDE SQLCA
*  172 END-EXEC
   173 01 SQLCA.
   174     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   175     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   176     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   177     05  SQLERRM.
   178         49  SQLERRML    PIC S9(4) COMP-5.
   179         49  SQLERRMC    PIC X(70).
   180     05  SQLERRP         PIC X(8).
   181     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   182     05  SQLWARN.
   183         10  SQLWARN0    PIC X.
   184         10  SQLWARN1    PIC X.
   185         10  SQLWARN2    PIC X.
   186         10  SQLWARN3    PIC X.
   187         10  SQLWARN4    PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page   5
* WSMESS01.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188         10  SQLWARN5    PIC X.
   189         10  SQLWARN6    PIC X.
   190         10  SQLWARN7    PIC X.
   191     05  SQLEXT.
   192         10  SQLWARN8    PIC X.
   193         10  SQLWARN9    PIC X.
   194         10  SQLWARN10   PIC X.
   195         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   196     05  SQLSTATE    PIC X(5).
   197 EXEC SQL
   198    BEGIN DECLARE SECTION
   199 END-EXEC
   200 01  ws-dealer-state             pic xx.
   201 01  ws-dealer-id                pic x(10).
   202 01  ws-contract-eff-dt          pic x(10).
   203 01  ws-contract-no              pic x(10) value spaces.
   204 01  ws-contract-suffix          pic x     value spaces.
   205 01  ws-key-stuff.
   206     05  ws-ks-contract-no       pic x(10) value spaces.
   207     05  ws-batch-no             pic x(6) value zeros.
   208     05  ws-batch-no-n redefines
   209         ws-batch-no             pic 9(6).
   210     05  ws-check-key            pic 9(7).
   211     05  ws-check-no             pic x(7).
   212     05  ws-compid               pic xxx.
   213     05  ws-carrier              pic x.
   214     05  ws-grouping             pic x(6).
   215     05  ws-state                pic xx.
   216     05  ws-account              pic x(10).
   217     05  ws-eff-date             pic x(10).
   218     05  ws-certificate          pic x(10).
   219     05  ws-cert-sfx             pic x.
   220     05  ws-seq-no               pic 999.
   221     05  ws-type                 pic 999.
   222 01  ws-status-code-a            pic x(7) value zeros.
   223 01  ws-status-code redefines
   224     ws-status-code-a            pic 9(7).
   225 01  ws-error-message            pic x(50) value spaces.
   226 01  ws-status-date              pic x(10).
   227 01  sqlcmd                      pic x(1024).
   228 01  svr                         pic x(32).
   229 01  usr                         pic x(32).
   230 01  pass                        pic x(32).
   231 01  usr-pass                    pic x(64).
   232 01  ws-disp-code                pic s9(11).
   233***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   234***                                                            ***
   235***  These indicators are used to determine if a variable      ***
   236***  is        null.           The indicator will be -1        ***
   237***  if the value        is null  and +0 if the value is       ***
   238***  something other than null.  Here is an example on how     ***
   239***  to use the indicator variables.                           ***
   240***                                                            ***
   241***     EXEC SQL                                               ***
   242***        fetch checkapp into                                 ***
   243***           :db-app-status :nu-app-status,                   ***
   244***           :db-app-by     :nu-app-by,                       ***
   245***           :db-app-date   :nu-app-date,                     ***
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page   6
* WSMESS01.cbl
   246***           :db-app-batch  :nu-app-batch                     ***
   247***     END-EXEC                                               ***
   248***                                                            ***
   249***           OR This way on an update                         ***
   250***                                                            ***
   251***     EXEC SQL                                               ***
   252***        UPDATE                                              ***
   253***           CUC_Logic_Remittance                             ***
   254***        SET                                                 ***
   255***           LogicStatus     = :ws-status-code,               ***
   256***           LogicStatusDate = :ws-status-date,               ***
   257***           BatchNumber     = :ws-batch-no :nu-batchno       ***
   258***        WHERE                                               ***
   259***           RemitId = :ws-remit-id                           ***
   260***     END-EXEC                                               ***
   261***                                                            ***
   262***    Also, when the table has a column with a data type of   ***
   263***  "BIT" and used as true/false move the 1 byte receiving    ***
   264***  field to ws-bit and check out ws-bit-comp. if = zeros,    ***
   265***  then its false. I think true would be 256.                ***
   266***                                                            ***
   267***                                                            ***
   268***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   269 01  ws-bit                      pic x.
   270 01  ws-bit-comp redefines ws-bit pic s9(4) comp.
   271 01  indicator-vaiables-for-nulls.
   272     05  nu-app-status           pic s9(4) comp value +0.
   273     05  nu-app-by               pic s9(4) comp value +0.
   274     05  nu-app-date             pic s9(4) comp value +0.
   275     05  nu-app-batch            pic s9(4) comp value +0.
   276     05  nu-fincar               pic s9(4) comp value +0.
   277     05  nu-batchno              pic s9(4) comp value +0.
   278     05  nu-error-message        pic s9(4) comp value +0.
   279 01  sql-cert-records.
   280     05  sql-dlr-state           pic xx.
   281     05  sql-dlr-id              pic x(10).
   282     05  sql-eff-dt              pic x(10).
   283     05  sql-contr-no            pic x(10).
   284     05  sql-contr-suffix        pic x.
   285 EXEC SQL
   286    END DECLARE SECTION
   287 END-EXEC
   288 01  ws-TX-lf-benefit-code-table.
   289     05  ws-tx-lf-table.
   290         10  filler              pic x(5) value 'GSN01'.
   291         10  filler              pic x(5) value 'GJN03'.
   292     05  filler redefines ws-tx-lf-table occurs 02.
   293         10  ws-fl-lf-ben-type   pic x.
   294         10  ws-fl-lf-sin-jnt    pic x.
   295         10  ws-fl-lf-dismemb    pic x.
   296         10  ws-fl-lf-ben-code   pic xx.
   297 01  ws-TX-ah-benefit-code-table.
   298     05  ws-tx-ah-table.
   299         10  filler              pic x(8) value 'ASYR1401'.
   300         10  filler              pic x(8) value 'ASYR3004'.
   301         10  filler              pic x(8) value 'ASYE1405'.
   302         10  filler              pic x(8) value 'ASYE3002'.
   303         10  filler              pic x(8) value 'AJYR1454'.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page   7
* WSMESS01.cbl
   304         10  filler              pic x(8) value 'AJYR3055'.
   305         10  filler              pic x(8) value 'AJYE1456'.
   306         10  filler              pic x(8) value 'AJYE3057'.
   307     05  filler redefines ws-tx-ah-table occurs 08.
   308         10  ws-fl-ah-ben-type   pic x.
   309         10  ws-fl-ah-sin-jnt    pic x.
   310         10  ws-fl-ah-fullterm   pic x.
   311         10  ws-fl-ah-ret-elim   pic x.
   312         10  ws-fl-ah-elim-days  pic xx.
   313         10  ws-fl-ah-ben-code   pic xx.
   314 01  filler.
   315     05  ws-work-in              pic x(10).
   316     05  ws-work-out             pic x(10).
   317     05  ws-work-out-v2 redefines
   318         ws-work-out             pic 9(8)v99.
   319     05  ws-work-out-v0 redefines
   320         ws-work-out             pic 9(10).
   321     05  ws-work-out-v5 redefines
   322         ws-work-out             pic 9(5)v9(5).
   323 01  filler.
   324     05  ws-last-suffix          pic x value low-values.
   325     05  ws-tbl-last-suffix      pic x value low-values.
   326     05  filler.  *> Use X1 for this table.
   327         10  ws-codes            pic x(26) value
   328         ' ABCDEFGHIJKLMNOPQRSTUVWXY'.
   329         10  ws-suffix-value redefines ws-codes
   330           occurs 26             pic x.
   331 01  ws-work-date.
   332     05  ws-work-ccyy            pic x(4).
   333     05  ws-work-mm              pic xx.
   334     05  ws-work-dd              pic xx.
   335 01  ws-work-date-num redefines ws-work-date
   336                                 pic 9(8).
   337 01  raw-message001-area.
   338     05  raw-message-num         pic x(10).
   339     05  raw-state               pic xx.
   340     05  raw-acct-no             pic x(10).
   341     05  raw-vin                 pic x(17).
   342     05  raw-lf-ah               pic x.
   343     05  raw-ben-code            pic xx.
   344     05  raw-earn-meth           pic x.
   345     05  raw-pri-birth-date      pic x(10).
   346     05  raw-cob-birth-date      pic x(10).
   347     05  raw-benefit             pic x(9).
   348     05  raw-eff-date            pic x(10).
   349     05  raw-1st-pmt-dt          pic x(10).
   350     05  raw-premium             pic x(8).
   351     05  raw-loan-term           pic xxx.
   352     05  raw-ins-term            pic XXX.
   353     05  raw-apr                 pic x(8).
   354     05  raw-sin-jnt-ind         pic x.
   355     05  raw-dismemberment       pic x.
   356     05  raw-retro-elim          pic x.
   357     05  raw-waiting-days        pic xx.
   358     05  raw-crit-per            pic xx.
   359     05  raw-total-payments      pic x(9).
   360     05  raw-period-payment      pic x(8).
   361 01  ws-rate-work-area.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page   8
* WSMESS01.cbl
   362     05  ws-rate-state           pic xx.
   363     05  ws-rate-acct-no         pic x(10).
   364     05  ws-rate-vin             pic x(17).
   365     05  ws-rate-lf-ah           pic x.
   366     05  ws-rate-ben-code        pic xx.
   367     05  ws-rate-earn-meth       pic x.
   368     05  ws-rate-pri-birth-date  pic x(10).
   369     05  ws-rate-cob-birth-date  pic x(10).
   370     05  ws-rate-eff-date        pic x(10).
   371     05  ws-rate-1st-pmt-dt      pic x(10).
   372     05  ws-rate-benefit-type    pic x.
   373     05  ws-rate-benefit-cd      pic xx.
   374     05  ws-rate-benefit         pic 9(6)v99.
   375     05  ws-rate-tot-pmts        pic 9(6)v99.
   376     05  ws-rate-premium         pic 9(5)v99.
   377     05  ws-rate-apr             pic 99v9(5).
   378     05  ws-rate-loan-term       pic 999  value zeros.
   379     05  ws-rate-ins-term        pic 999  value zeros.
   380     05  ws-issue-age            pic 999  value zeros.
   381     05  ws-cob-age              pic 999  value zeros.
   382     05  ws-rate-age             pic 999  value zeros.
   383     05  ws-max-benefit          pic 9(7)v99 value zeros.
   384     05  ws-rate-crit-per        pic 99.
   385     05  ws-rate-sin-jnt-ind     pic x.
   386     05  ws-rate-dismemberment   pic x.
   387     05  ws-rate-retro-elim      pic x.
   388     05  ws-rate-waiting-days    pic 99.
   389     05  ws-rate-payment         pic 9(5)v99.
   390     05  ws-calc-tot-pmts        pic 9(7)v99 value zeros.
   391 01  WS-AM-KEY.
   392     05  WS-AM-COMPANY-CD        PIC X.
   393     05  WS-AM-CARRIER           PIC X.
   394     05  WS-AM-GROUP             PIC X(6).
   395     05  WS-AM-STATE             PIC XX.
   396     05  WS-AM-ACCOUNT           PIC X(10).
   397     05  WS-AM-EXP-DT            PIC XX.
   398     05  FILLER                  PIC X(4).
   399 01  ws-cm5-compare-key          pic x(12).
   400 01  WS-CM5-KEY.
   401     05  WS-CM5-COMPANY-CD       PIC X.
   402     05  WS-CM5-CERT-NO          PIC X(11).
   403 01  ws-cm-compare-key           pic x(33).
   404 01  WS-CM-KEY.
   405     05  WS-CM-COMPANY-CD        PIC X.
   406     05  WS-CM-CARRIER           PIC X.
   407     05  WS-CM-GROUP             PIC X(6).
   408     05  WS-CM-STATE             PIC XX.
   409     05  WS-CM-ACCOUNT           PIC X(10).
   410     05  WS-CM-EFF-DT            PIC XX.
   411     05  WS-CM-CERT-NO.
   412         10  ws-cm-cert-ten      pic x(10).
   413         10  ws-cm-cert-suffix   pic x.
   414 01  WS-CS-KEY.
   415     05  WS-CS-COMPANY-CD        PIC X.
   416     05  WS-CS-CARRIER           PIC X.
   417     05  WS-CS-GROUP             PIC X(6).
   418     05  WS-CS-STATE             PIC XX.
   419     05  WS-CS-ACCOUNT           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page   9
* WSMESS01.cbl
   420     05  WS-CS-EFF-DT            PIC XX.
   421     05  WS-CS-CERT-NO           PIC X(11).
   422     05  WS-CS-TRLR-TYPE         PIC X.
   423 01  WS-AM-ALT-KEY.
   424     05  WS-AM-ALT-ACCOUNT       PIC X(10).
   425     05  WS-AM-ALT-EXP-DT        PIC XX.
   426 01  WS-CF-KEY-SAVE              PIC X(10).
   427 01  WS-CF-KEY.
   428     05  WS-CF-COMPANY-ID        PIC XXX.
   429     05  WS-CF-RECORD-TYPE       PIC X.
   430     05  WS-CF-ACCESS            PIC X(4).
   431     05  WS-CF-SEQ-NO            PIC S9(4) COMP.
   432 01  filler.
   433     05  ws-errors-table.
   434         10  filler              pic x(50) value
   435         '0000Transaction successfully completed'.
   436         10  filler              pic x(50) value
   437         '0101Problem with amounts'.
   438         10  filler              pic x(50) value
   439         '0102Problem with dates'.
   440         10  filler              pic x(50) value
   441         '0103Issue age outside limits'.
   442         10  filler              pic x(50) value
   443         '0104Attained age outside limits'.
   444         10  filler              pic x(50) value
   445         '0105Term is not valid must be gt 0 and lt 361'.
   446         10  filler              pic x(50) value
   447         '0106Term is outside limits'.
   448         10  filler              pic x(50) value
   449         '0107Amount is outside limits'.
   450         10  filler              pic x(50) value
   451         '0108Loan term must be ge insurance term'.
   452         10  filler              pic x(50) value
   453         '0109Total benefit is outside limits'.
   454         10  filler              pic x(50) value
   455         '0110Rates found were zero'.
   456         10  filler              pic x(50) value
   457         '0111Rate table was not found'.
   458         10  filler              pic x(50) value
   459         '0112Rate file not open'.
   460         10  filler              pic x(50) value
   461         '0113Premium is out of tolerence'.
   462         10  filler              pic x(50) value
   463         '0114Duplicate contract and VIN on Logic'.
   464         10  filler              pic x(50) value
   465         '0115Problem with loan or insurance term'.
   466         10  filler              pic x(50) value
   467         '0116Total of payments incorrect '.
   468     05  filler redefines ws-errors-table occurs 17.
   469         10  ws-table-error-no   pic x(4).
   470         10  ws-table-error-mess pic x(46).
   471 01  ws-return-string.
   472     05  ws-return-error-no      pic x(4).
   473     05  ws-sc1                  pic x.
   474     05  ws-return-error-mess    pic x(46).
   475     05  ws-sc2                  pic x.
   476     05  ws-return-contract-no   pic x(11).
   477     05  ws-sc3                  pic x.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  10
* WSMESS01.cbl
   478     05  ws-return-max-ben       pic z,zzz,z99.99.
   479     05  ws-sc4                  pic x.
   480     05  ws-return-prem          pic z,zzz,z99.99.
   481     05  ws-sc5                  pic x.
   482     05  ws-return-rate          pic z9.99999.
   483     05  ws-sc6                  pic x.
   484     05  ws-return-exp-dt        pic x(10).
   485     05  ws-sc7                  pic x.
   486     05  ws-return-benefit-cd    pic xx.
   487 01  ws-mess001-length           pic s9(4) comp value +1024.
   488 01  WS-MESS001-PASS-AREA        PIC X(1024).
   489 01  WS-CID-NO                   PIC X(8).
   490 01  WS-DISP-RESP                PIC 9(5).
   491 01  WS-RESPONSE                 PIC S9(8)   COMP.
   492     88  RESP-NORMAL                  VALUE +00.
   493     88  RESP-NOTFND                  VALUE +13.
   494     88  resp-duprec                  value +14.
   495     88  resp-dupkey                  value +15.
   496     88  RESP-NOTOPEN                 VALUE +19.
   497     88  RESP-ENDFILE                 VALUE +20.
   498*                                 COPY ERCACCT.
   499******************************************************************
   500*                                                                *
   501*                                                                *
   502*                            ERCACCT                             *
   503*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   504*                            VMOD=2.031                          *
   505*                                                                *
   506*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
   507*                                                                *
   508*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
   509*   VSAM ACCOUNT MASTER FILES.                                   *
   510*                                                                *
   511*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
   512*                                                                *
   513*   FILE TYPE = VSAM,KSDS                                        *
   514*   RECORD SIZE = 2000  RECFORM = FIX                            *
   515*                                                                *
   516*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
   517*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
   518*                                                                *
   519*   LOG = NO                                                     *
   520*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   521*                                                                *
   522*                                                                *
   523******************************************************************
   524*                   C H A N G E   L O G
   525*
   526* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   527*-----------------------------------------------------------------
   528*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   529* EFFECTIVE    NUMBER
   530*-----------------------------------------------------------------
   531* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   532* 092705    2005050300006  PEMA  ADD SPP LEASES
   533* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   534* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   535* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  11
* WSMESS01.cbl
   536* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   537* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   538* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
   539******************************************************************
   540
   541 01  ACCOUNT-MASTER.
   542     12  AM-RECORD-ID                      PIC XX.
   543         88  VALID-AM-ID                      VALUE 'AM'.
   544
   545     12  AM-CONTROL-PRIMARY.
   546         16  AM-COMPANY-CD                 PIC X.
   547         16  AM-MSTR-CNTRL.
   548             20  AM-CONTROL-A.
   549                 24  AM-CARRIER            PIC X.
   550                 24  AM-GROUPING.
   551                     28 AM-GROUPING-PREFIX PIC XXX.
   552                     28 AM-GROUPING-PRIME  PIC XXX.
   553                 24  AM-STATE              PIC XX.
   554                 24  AM-ACCOUNT.
   555                     28  AM-ACCOUNT-PREFIX PIC X(4).
   556                     28  AM-ACCOUNT-PRIME  PIC X(6).
   557             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
   558                                           PIC X(19).
   559             20  AM-CNTRL-B.
   560                 24  AM-EXPIRATION-DT      PIC XX.
   561                 24  FILLER                PIC X(4).
   562             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
   563                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
   564
   565     12  AM-CONTROL-BY-VAR-GRP.
   566         16  AM-COMPANY-CD-A1              PIC X.
   567         16  AM-VG-CARRIER                 PIC X.
   568         16  AM-VG-GROUPING                PIC X(6).
   569         16  AM-VG-STATE                   PIC XX.
   570         16  AM-VG-ACCOUNT                 PIC X(10).
   571         16  AM-VG-DATE.
   572             20  AM-VG-EXPIRATION-DT       PIC XX.
   573             20  FILLER                    PIC X(4).
   574         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
   575                                           PIC 9(11)      COMP-3.
   576     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   577         16  FILLER                        PIC X(10).
   578         16  AM-VG-KEY3.
   579             20  AM-VG3-ACCOUNT            PIC X(10).
   580             20  AM-VG3-EXP-DT             PIC XX.
   581         16  FILLER                        PIC X(4).
   582     12  AM-MAINT-INFORMATION.
   583         16  AM-LAST-MAINT-DT              PIC XX.
   584         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   585         16  AM-LAST-MAINT-USER            PIC X(4).
   586         16  FILLER                        PIC XX.
   587
   588     12  AM-EFFECTIVE-DT                   PIC XX.
   589     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
   590
   591     12  AM-PREV-DATES  COMP-3.
   592         16  AM-PREV-EXP-DT                PIC 9(11).
   593         16  AM-PREV-EFF-DT                PIC 9(11).
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  12
* WSMESS01.cbl
   594
   595     12  AM-REPORT-CODE-1                  PIC X(10).
   596     12  AM-REPORT-CODE-2                  PIC X(10).
   597
   598     12  AM-CITY-CODE                      PIC X(4).
   599     12  AM-COUNTY-PARISH                  PIC X(6).
   600
   601     12  AM-NAME                           PIC X(30).
   602     12  AM-PERSON                         PIC X(30).
   603     12  AM-ADDRS                          PIC X(30).
   604     12  AM-CITY.
   605         16  AM-ADDR-CITY                  PIC X(28).
   606         16  AM-ADDR-STATE                 PIC XX.
   607     12  AM-ZIP.
   608         16  AM-ZIP-PRIME.
   609             20  AM-ZIP-PRI-1ST            PIC X.
   610                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   611             20  FILLER                    PIC X(4).
   612         16  AM-ZIP-PLUS4                  PIC X(4).
   613     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
   614         16  AM-CAN-POSTAL-1               PIC XXX.
   615         16  AM-CAN-POSTAL-2               PIC XXX.
   616         16  FILLER                        PIC XXX.
   617     12  AM-TEL-NO.
   618         16  AM-AREA-CODE                  PIC 999.
   619         16  AM-TEL-PRE                    PIC 999.
   620         16  AM-TEL-NBR                    PIC 9(4).
   621     12  AM-TEL-LOC                        PIC X.
   622         88  AM-TEL-AT-HOME                   VALUE 'H'.
   623         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
   624
   625     12  AM-COMM-STRUCTURE.
   626         16  AM-DEFN-1.
   627             20  AM-AGT-COMMS       OCCURS 10 TIMES.
   628                 24  AM-AGT.
   629                     28  AM-AGT-PREFIX     PIC X(4).
   630                     28  AM-AGT-PRIME      PIC X(6).
   631                 24  AM-COM-TYP            PIC X.
   632                 24  AM-L-COM              PIC SV9(5)     COMP-3.
   633                 24  AM-J-COM              PIC SV9(5)     COMP-3.
   634                 24  AM-A-COM              PIC SV9(5)     COMP-3.
   635                 24  AM-RECALC-LV-INDIC    PIC X.
   636                 24  AM-RETRO-LV-INDIC     PIC X.
   637                 24  AM-GL-CODES           PIC X.
   638                 24  AM-COMM-CHARGEBACK    PIC 9(02).
   639                 24  FILLER                PIC X(01).
   640         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
   641             20  AM-COM-TBLS        OCCURS 10 TIMES.
   642                 24  FILLER                PIC X(11).
   643                 24  AM-L-COMA             PIC XXX.
   644                 24  AM-J-COMA             PIC XXX.
   645                 24  AM-A-COMA             PIC XXX.
   646                 24  FILLER                PIC X(6).
   647
   648     12  AM-COMM-CHANGE-STATUS             PIC X.
   649         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
   650
   651     12  AM-CSR-CODE                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  13
* WSMESS01.cbl
   652
   653     12  AM-BILLING-STATUS                 PIC X.
   654         88  AM-ACCOUNT-BILLED                VALUE 'B'.
   655         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
   656     12  AM-AUTO-REFUND-SW                 PIC X.
   657         88  AUTO-REFUNDS-USED                VALUE 'Y'.
   658         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
   659     12  AM-GPCD                           PIC 99.
   660     12  AM-IG                             PIC X.
   661         88  AM-HAS-INDIVIDUAL                VALUE '1'.
   662         88  AM-HAS-GROUP                     VALUE '2'.
   663     12  AM-STATUS                         PIC X.
   664         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
   665         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
   666         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
   667         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   668         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   669         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   670         88  AM-ACCOUNT-DROPPED               VALUE '6'.
   671         88  AM-ACCOUNT-LAPSED                VALUE '7'.
   672         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
   673         88  AM-ACCOUNT-PENDING               VALUE '9'.
   674     12  AM-REMIT-TO                       PIC 99.
   675     12  AM-ID-NO                          PIC X(11).
   676
   677     12  AM-CAL-TABLE                      PIC XX.
   678     12  AM-LF-DEVIATION                   PIC XXX.
   679     12  AM-AH-DEVIATION                   PIC XXX.
   680     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   681     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   682     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
   683     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
   684     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   685     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   686
   687     12  AM-USER-FIELDS.
   688         16  AM-FLD-1                      PIC XX.
   689         16  AM-FLD-2                      PIC XX.
   690         16  AM-FLD-3                      PIC XX.
   691         16  AM-FLD-4                      PIC XX.
   692         16  AM-FLD-5                      PIC XX.
   693
   694     12  AM-1ST-PROD-DATE.
   695         16  AM-1ST-PROD-YR                PIC XX.
   696         16  AM-1ST-PROD-MO                PIC XX.
   697         16  AM-1ST-PROD-DA                PIC XX.
   698     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
   699     12  AM-CERTS-PURGED-DATE.
   700         16  AM-PUR-YR                     PIC XX.
   701         16  AM-PUR-MO                     PIC XX.
   702         16  AM-PUR-DA                     PIC XX.
   703     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
   704     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
   705     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
   706     12  AM-INACTIVE-DATE.
   707         16  AM-INA-MO                     PIC 99.
   708         16  AM-INA-DA                     PIC 99.
   709         16  AM-INA-YR                     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  14
* WSMESS01.cbl
   710     12  AM-AR-HI-CERT-DATE                PIC XX.
   711
   712     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   713     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   714
   715     12  AM-OB-PAYMENT-MODE                PIC X.
   716         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
   717         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
   718         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
   719         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
   720
   721     12  AM-AH-ONLY-INDICATOR              PIC X.
   722         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
   723         88  AM-NO-AH-ONLY                    VALUE 'N'.
   724
   725     12  AM-EDIT-LOAN-OFC                  PIC X(01).
   726
   727     12  AM-OVER-SHORT.
   728         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
   729         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
   730
   731     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   732     12  AM-DCC-CLP-STATE                  PIC XX.
   733
   734     12  AM-RECALC-COMM                    PIC X.
   735     12  AM-RECALC-REIN                    PIC X.
   736
   737     12  AM-REI-TABLE                      PIC XXX.
   738     12  AM-REI-ET-LF                      PIC X.
   739     12  AM-REI-ET-AH                      PIC X.
   740     12  AM-REI-PE-LF                      PIC X.
   741     12  AM-REI-PE-AH                      PIC X.
   742     12  AM-REI-PRT-ST                     PIC X.
   743     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
   744     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
   745     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
   746     12  AM-REI-GROUP-A                    PIC X(6).
   747     12  AM-REI-MORT                       PIC X(4).
   748     12  AM-REI-PRT-OW                     PIC X.
   749     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
   750     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
   751     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
   752     12  AM-REI-GROUP-B                    PIC X(6).
   753
   754     12  AM-TRUST-TYPE                     PIC X(2).
   755
   756     12  AM-EMPLOYER-STMT-USED             PIC X.
   757     12  AM-GROUPED-CHECKS-Y-N             PIC X.
   758
   759     12  AM-STD-AH-TYPE                    PIC XX.
   760     12  AM-EARN-METHODS.
   761         16  AM-EARN-METHOD-R              PIC X.
   762             88 AM-REF-RL-R78                 VALUE 'R'.
   763             88 AM-REF-RL-PR                  VALUE 'P'.
   764             88 AM-REF-RL-MEAN                VALUE 'M'.
   765             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
   766         16  AM-EARN-METHOD-L              PIC X.
   767             88 AM-REF-LL-R78                 VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  15
* WSMESS01.cbl
   768             88 AM-REF-LL-PR                  VALUE 'P'.
   769             88 AM-REF-LL-MEAN                VALUE 'M'.
   770             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
   771         16  AM-EARN-METHOD-A              PIC X.
   772             88 AM-REF-AH-R78                 VALUE 'R'.
   773             88 AM-REF-AH-PR                  VALUE 'P'.
   774             88 AM-REF-AH-MEAN                VALUE 'M'.
   775             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
   776             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
   777             88 AM-REF-AH-NET                 VALUE 'N'.
   778
   779     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
   780     12  AM-TOL-REF                        PIC S999V99    COMP-3.
   781     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
   782
   783     12  AM-RET-Y-N                        PIC X.
   784     12  AM-RET-P-E                        PIC X.
   785     12  AM-LF-RET                         PIC S9V9999    COMP-3.
   786     12  AM-AH-RET                         PIC S9V9999    COMP-3.
   787     12  AM-RET-GRP                        PIC X(6).
   788     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
   789         16  AM-POOL-PRIME                 PIC XXX.
   790         16  AM-POOL-SUB                   PIC XXX.
   791     12  AM-RETRO-EARNINGS.
   792         16  AM-RET-EARN-R                 PIC X.
   793         16  AM-RET-EARN-L                 PIC X.
   794         16  AM-RET-EARN-A                 PIC X.
   795     12  AM-RET-ST-TAX-USE                 PIC X.
   796         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
   797         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
   798     12  AM-RETRO-BEG-EARNINGS.
   799         16  AM-RET-BEG-EARN-R             PIC X.
   800         16  AM-RET-BEG-EARN-L             PIC X.
   801         16  AM-RET-BEG-EARN-A             PIC X.
   802     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
   803     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
   804
   805     12  AM-USER-SELECT-OPTIONS.
   806         16  AM-USER-SELECT-1              PIC X(10).
   807         16  AM-USER-SELECT-2              PIC X(10).
   808         16  AM-USER-SELECT-3              PIC X(10).
   809         16  AM-USER-SELECT-4              PIC X(10).
   810         16  AM-USER-SELECT-5              PIC X(10).
   811
   812     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   813
   814     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   815
   816     12  AM-RPT045A-SWITCH                 PIC X.
   817         88  RPT045A-OFF                   VALUE 'N'.
   818
   819     12  AM-INSURANCE-LIMITS.
   820         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
   821         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
   822
   823     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
   824         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
   825
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  16
* WSMESS01.cbl
   826     12  AM-DISMBR-COVERAGE-SW             PIC X.
   827         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
   828         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
   829
   830     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
   831
   832     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
   833     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   834     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   835     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   836     12  AM-DCC-UEF-STATE                  PIC XX.
   837     12  FILLER                            PIC XXX.
   838     12  AM-REPORT-CODE-3                  PIC X(10).
   839*    12  FILLER                            PIC X(22).
   840
   841     12  AM-RESERVE-DATE.
   842         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
   843         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
   844         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
   845
   846     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
   847     12  AM-NOTIFICATION-TYPES.
   848         16  AM-NOTIF-OF-LETTERS           PIC X.
   849         16  AM-NOTIF-OF-PAYMENTS          PIC X.
   850         16  AM-NOTIF-OF-REPORTS           PIC X.
   851         16  AM-NOTIF-OF-STATUS            PIC X.
   852
   853     12  AM-BENEFIT-TABLE-USAGE            PIC X.
   854         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
   855         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
   856         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
   857         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
   858
   859     12  AM-BENEFIT-CONTROLS.
   860         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
   861             20  AM-BENEFIT-CODE           PIC XX.
   862             20  AM-BENEFIT-TYPE           PIC X.
   863             20  AM-BENEFIT-REVISION       PIC XXX.
   864             20  AM-BENEFIT-REM-TERM       PIC X.
   865             20  AM-BENEFIT-RETRO-Y-N      PIC X.
   866             20  FILLER                    PIC XX.
   867         16  FILLER                        PIC X(80).
   868
   869     12  AM-TRANSFER-DATA.
   870         16  AM-TRANSFERRED-FROM.
   871             20  AM-TRNFROM-CARRIER        PIC X.
   872             20  AM-TRNFROM-GROUPING.
   873                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
   874                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
   875             20  AM-TRNFROM-STATE          PIC XX.
   876             20  AM-TRNFROM-ACCOUNT.
   877                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
   878                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
   879             20  AM-TRNFROM-DTE            PIC XX.
   880         16  AM-TRANSFERRED-TO.
   881             20  AM-TRNTO-CARRIER          PIC X.
   882             20  AM-TRNTO-GROUPING.
   883                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  17
* WSMESS01.cbl
   884                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
   885             20  AM-TRNTO-STATE            PIC XX.
   886             20  AM-TRNTO-ACCOUNT.
   887                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
   888                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
   889             20  AM-TRNTO-DTE              PIC XX.
   890         16  FILLER                        PIC X(10).
   891
   892     12  AM-SAVED-REMIT-TO                 PIC 99.
   893
   894     12  AM-COMM-STRUCTURE-SAVED.
   895         16  AM-DEFN-1-SAVED.
   896             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
   897                 24  AM-AGT-SV             PIC X(10).
   898                 24  AM-COM-TYP-SV         PIC X.
   899                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
   900                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
   901                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
   902                 24  AM-RECALC-LV-INDIC-SV PIC X.
   903                 24  FILLER                PIC X.
   904                 24  AM-GL-CODES-SV        PIC X.
   905                 24  AM-COM-CHARGEBACK-SV  PIC 99.
   906                 24  FILLER                PIC X.
   907         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
   908             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
   909                 24  FILLER                PIC X(11).
   910                 24  AM-L-COMA-SV          PIC XXX.
   911                 24  AM-J-COMA-SV          PIC XXX.
   912                 24  AM-A-COMA-SV          PIC XXX.
   913                 24  FILLER                PIC X(6).
   914
   915     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
   916         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
   917            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
   918            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
   919            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
   920
   921     12  AM-ORIG-DEALER-NO                 PIC X(10).
   922     12  FILLER                            PIC X(120).
   923
   924     12  AM-ACCOUNT-EXECUTIVE-DATA.
   925         16  AM-CONTROL-NAME               PIC X(30).
   926         16  AM-EXECUTIVE-ONE.
   927             20  AM-EXEC1-NAME             PIC X(15).
   928             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
   929                                                          COMP-3.
   930             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
   931                                                          COMP-3.
   932         16  AM-EXECUTIVE-TWO.
   933             20  AM-EXEC2-NAME             PIC X(15).
   934             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
   935                                                          COMP-3.
   936             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
   937                                                          COMP-3.
   938
   939     12  AM-RETRO-ADDITIONAL-DATA.
   940         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
   941         16  AM-RETRO-PREM-P-E             PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  18
* WSMESS01.cbl
   942         16  AM-RETRO-CLMS-P-I             PIC X.
   943         16  AM-RETRO-RET-BRACKET-LF.
   944             20  AM-RETRO-RET-METHOD-LF    PIC X.
   945                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
   946                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
   947             20  AM-RETRO-RET-BASIS-LF     PIC X.
   948                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
   949                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
   950             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
   951                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
   952                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
   953         16  AM-RETRO-RET-BRACKET-AH.
   954             20  AM-RETRO-RET-METHOD-AH    PIC X.
   955                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
   956                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
   957                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
   958             20  AM-RETRO-RET-BASIS-AH     PIC X.
   959                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
   960                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
   961             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
   962                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
   963                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
   964
   965     12  AM-COMMENTS.
   966         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
   967
   968     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
   969         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
   970         16  AM-FLI-BILLING-CODE           PIC X.
   971         16  AM-FLI-ALT-STATE-CODE         PIC XX.
   972         16  AM-FLI-UNITED-IDENT           PIC X.
   973         16  AM-FLI-INTEREST-LOST-DATA.
   974             20  AM-FLI-BANK-NO            PIC X(5).
   975             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
   976             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
   977             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
   978         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
   979             20  AM-FLI-AGT                PIC X(9).
   980             20  AM-FLI-AGT-COMM-ACC       PIC X.
   981             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
   982         16  FILLER                        PIC X(102).
   983
   984     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
   985         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
   986             20  AM-BENEFIT-DMD-CODE         PIC XX.
   987             20  AM-BENEFIT-DMD-TYPE         PIC X.
   988             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
   989             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
   990             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
   991         16  FILLER                          PIC X(10).
   992******************************************************************
   993*                                 COPY ELCCERT.
   994******************************************************************
   995*                                                                *
   996*                            ELCCERT.                            *
   997*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   998*                            VMOD=2.013                          *
   999*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  19
* WSMESS01.cbl
  1000*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1001*                                                                *
  1002*   FILE TYPE = VSAM,KSDS                                        *
  1003*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1004*                                                                *
  1005*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1006*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1007*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1008*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1009*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1010*                                                                *
  1011*   LOG = YES                                                    *
  1012*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1013******************************************************************
  1014*                   C H A N G E   L O G
  1015*
  1016* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1017*-----------------------------------------------------------------
  1018*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1019* EFFECTIVE    NUMBER
  1020*-----------------------------------------------------------------
  1021* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1022* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1023* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1024* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1025* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1026* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1027* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1028* 032612  CR2011110200001  PEMA  AHL CHANGES
  1029* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  1030* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1031******************************************************************
  1032
  1033 01  CERTIFICATE-MASTER.
  1034     12  CM-RECORD-ID                      PIC XX.
  1035         88  VALID-CM-ID                      VALUE 'CM'.
  1036
  1037     12  CM-CONTROL-PRIMARY.
  1038         16  CM-COMPANY-CD                 PIC X.
  1039         16  CM-CARRIER                    PIC X.
  1040         16  CM-GROUPING.
  1041             20  CM-GROUPING-PREFIX        PIC X(3).
  1042             20  CM-GROUPING-PRIME         PIC X(3).
  1043         16  CM-STATE                      PIC XX.
  1044         16  CM-ACCOUNT.
  1045             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1046             20  CM-ACCOUNT-PRIME          PIC X(6).
  1047         16  CM-CERT-EFF-DT                PIC XX.
  1048         16  CM-CERT-NO.
  1049             20  CM-CERT-PRIME             PIC X(10).
  1050             20  CM-CERT-SFX               PIC X.
  1051
  1052     12  CM-CONTROL-BY-NAME.
  1053         16  CM-COMPANY-CD-A1              PIC X.
  1054         16  CM-INSURED-LAST-NAME          PIC X(15).
  1055         16  CM-INSURED-INITIALS.
  1056             20  CM-INSURED-INITIAL1       PIC X.
  1057             20  CM-INSURED-INITIAL2       PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  20
* WSMESS01.cbl
  1058
  1059     12  CM-CONTROL-BY-SSN.
  1060         16  CM-COMPANY-CD-A2              PIC X.
  1061         16  CM-SOC-SEC-NO.
  1062             20  CM-SSN-STATE              PIC XX.
  1063             20  CM-SSN-ACCOUNT            PIC X(6).
  1064             20  CM-SSN-LN3.
  1065                 25  CM-INSURED-INITIALS-A2.
  1066                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1067                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1068                 25 CM-PART-LAST-NAME-A2         PIC X.
  1069
  1070     12  CM-CONTROL-BY-CERT-NO.
  1071         16  CM-COMPANY-CD-A4              PIC X.
  1072         16  CM-CERT-NO-A4                 PIC X(11).
  1073
  1074     12  CM-CONTROL-BY-MEMB.
  1075         16  CM-COMPANY-CD-A5              PIC X.
  1076         16  CM-MEMBER-NO.
  1077             20  CM-MEMB-STATE             PIC XX.
  1078             20  CM-MEMB-ACCOUNT           PIC X(6).
  1079             20  CM-MEMB-LN4.
  1080                 25  CM-INSURED-INITIALS-A5.
  1081                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1082                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1083                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1084
  1085     12  CM-INSURED-PROFILE-DATA.
  1086         16  CM-INSURED-FIRST-NAME.
  1087             20  CM-INSURED-1ST-INIT       PIC X.
  1088             20  FILLER                    PIC X(9).
  1089         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1090         16  CM-INSURED-SEX                PIC X.
  1091             88  CM-SEX-MALE                  VALUE 'M'.
  1092             88  CM-SEX-FEMAL                 VALUE 'F'.
  1093         16  CM-INSURED-JOINT-AGE          PIC 99.
  1094         16  CM-JOINT-INSURED-NAME.
  1095             20  CM-JT-LAST-NAME           PIC X(15).
  1096             20  CM-JT-FIRST-NAME.
  1097                 24  CM-JT-1ST-INIT        PIC X.
  1098                 24  FILLER                PIC X(9).
  1099             20  CM-JT-INITIAL             PIC X.
  1100
  1101     12  CM-LIFE-DATA.
  1102         16  CM-LF-BENEFIT-CD              PIC XX.
  1103         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1104         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1105         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1106         16  CM-LF-DEV-CODE                PIC XXX.
  1107         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1108         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1109         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1110         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1111         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1112         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1113         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1114         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1115         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  21
* WSMESS01.cbl
  1116         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1117         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1118         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1119         16  cm-temp-epiq                  pic xx.
  1120             88  EPIQ-CLASS                  value 'EQ'.
  1121*        16  FILLER                        PIC XX.
  1122
  1123     12  CM-AH-DATA.
  1124         16  CM-AH-BENEFIT-CD              PIC XX.
  1125         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1126         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1127         16  CM-AH-DEV-CODE                PIC XXX.
  1128         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1129         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1130         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1131         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1132         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1133         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1134         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1135         16  CM-AH-PAID-THRU-DT            PIC XX.
  1136             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1137         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1138         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  1139         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1140         16  FILLER                        PIC X.
  1141
  1142     12  CM-LOAN-INFORMATION.
  1143         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1144         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  1145                                           PIC S9(5)V99  COMP-3.
  1146         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1147         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1148         16  CM-PAY-FREQUENCY              PIC S99.
  1149         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1150         16  CM-RATE-CLASS                 PIC XX.
  1151         16  CM-BENEFICIARY                PIC X(25).
  1152         16  CM-POLICY-FORM-NO             PIC X(12).
  1153         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1154         16  CM-LAST-ADD-ON-DT             PIC XX.
  1155         16  CM-DEDUCTIBLE-AMOUNTS.
  1156             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1157             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1158         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1159             20  CM-RESIDENT-STATE         PIC XX.
  1160             20  CM-RATE-CODE              PIC X(4).
  1161             20  FILLER                    PIC XX.
  1162         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1163             20  CM-LOAN-OFFICER           PIC X(5).
  1164             20  FILLER                    PIC XXX.
  1165         16  CM-CSR-CODE                   PIC XXX.
  1166         16  CM-UNDERWRITING-CODE          PIC X.
  1167             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1168         16  CM-POST-CARD-IND              PIC X.
  1169         16  CM-NH-INTERFACE-SW            PIC X.
  1170         16  CM-PREMIUM-TYPE               PIC X.
  1171             88  CM-SING-PRM                  VALUE '1'.
  1172             88  CM-O-B-COVERAGE              VALUE '2'.
  1173             88  CM-OPEN-END                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  22
* WSMESS01.cbl
  1174         16  CM-IND-GRP-TYPE               PIC X.
  1175             88  CM-INDIVIDUAL                VALUE 'I'.
  1176             88  CM-GROUP                     VALUE 'G'.
  1177         16  CM-SKIP-CODE                  PIC X.
  1178             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  1179             88  SKIP-JULY                    VALUE '1'.
  1180             88  SKIP-AUGUST                  VALUE '2'.
  1181             88  SKIP-SEPTEMBER               VALUE '3'.
  1182             88  SKIP-JULY-AUG                VALUE '4'.
  1183             88  SKIP-AUG-SEPT                VALUE '5'.
  1184             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1185             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1186             88  SKIP-JUNE                    VALUE '8'.
  1187             88  SKIP-JUNE-JULY               VALUE '9'.
  1188             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  1189             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  1190         16  CM-PAYMENT-MODE               PIC X.
  1191             88  PAY-MONTHLY                  VALUE SPACE.
  1192             88  PAY-WEEKLY                   VALUE '1'.
  1193             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1194             88  PAY-BI-WEEKLY                VALUE '3'.
  1195             88  PAY-SEMI-ANUALLY             VALUE '4'.
  1196         16  CM-LOAN-NUMBER                PIC X(8).
  1197         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1198         16  CM-OLD-LOF                    PIC XXX.
  1199*        16  CM-LOAN-OFFICER               PIC XXX.
  1200         16  CM-REIN-TABLE                 PIC XXX.
  1201         16  CM-SPECIAL-REIN-CODE          PIC X.
  1202         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1203         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1204         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1205
  1206     12  CM-STATUS-DATA.
  1207         16  CM-ENTRY-STATUS               PIC X.
  1208         16  CM-ENTRY-DT                   PIC XX.
  1209
  1210         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1211         16  CM-LF-CANCEL-DT               PIC XX.
  1212         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  1213
  1214         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1215         16  CM-LF-DEATH-DT                PIC XX.
  1216         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1217
  1218         16  CM-LF-CURRENT-STATUS          PIC X.
  1219             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1220                                                'M' '4' '5' '9'.
  1221             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1222             88  CM-LF-POLICY-PENDING         VALUE '2'.
  1223             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  1224             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  1225             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1226             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  1227             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1228             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1229             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1230             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  1231             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  23
* WSMESS01.cbl
  1232             88  CM-LF-DECLINED               VALUE 'D'.
  1233             88  CM-LF-VOIDED                 VALUE 'V'.
  1234
  1235         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1236         16  CM-AH-CANCEL-DT               PIC XX.
  1237         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1238
  1239         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1240         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1241         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1242
  1243         16  CM-AH-CURRENT-STATUS          PIC X.
  1244             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1245                                                'M' '4' '5' '9'.
  1246             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  1247             88  CM-AH-POLICY-PENDING         VALUE '2'.
  1248             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  1249             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  1250             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1251             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  1252             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1253             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1254             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1255             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  1256             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1257             88  CM-AH-DECLINED               VALUE 'D'.
  1258             88  CM-AH-VOIDED                 VALUE 'V'.
  1259
  1260         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1261             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1262             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1263             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1264         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1265
  1266         16  CM-ENTRY-BATCH                PIC X(6).
  1267         16  CM-LF-EXIT-BATCH              PIC X(6).
  1268         16  CM-AH-EXIT-BATCH              PIC X(6).
  1269         16  CM-LAST-MONTH-END             PIC XX.
  1270
  1271     12  CM-NOTE-SW                        PIC X.
  1272         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1273         88  CERT-NOTES-PRESENT               VALUE '1'.
  1274         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1275         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1276         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1277         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1278         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1279         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1280     12  CM-COMP-EXCP-SW                   PIC X.
  1281         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  1282         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  1283     12  CM-INSURED-ADDRESS-SW             PIC X.
  1284         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  1285         88  INSURED-ADDR-PRESENT             VALUE '1'.
  1286
  1287*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  1288     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  1289     12  FILLER                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  24
* WSMESS01.cbl
  1290
  1291*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  1292     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  1293     12  FILLER                            PIC X.
  1294*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  1295     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  1296
  1297     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  1298         88  CERT-ADDED-BATCH                 VALUE ' '.
  1299         88  CERT-ADDED-ONLINE                VALUE '1'.
  1300         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  1301         88  CERT-PURGED-OFFLINE              VALUE '3'.
  1302         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  1303     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  1304         88  CERT-AS-LOADED                   VALUE ' '.
  1305         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  1306         88  CERT-CLAIM-ONLINE                VALUE '2'.
  1307         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  1308         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  1309         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  1310         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  1311         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  1312
  1313     12  CM-ACCOUNT-COMM-PCTS.
  1314         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  1315         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1316
  1317     12  CM-USER-FIELD                     PIC X.
  1318     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  1319     12  CM-CLP-STATE                      PIC XX.
  1320     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  1321     12  CM-USER-RESERVED                  PIC XXX.
  1322     12  FILLER REDEFINES CM-USER-RESERVED.
  1323         16  CM-AH-CLASS-CD                PIC XX.
  1324         16  F                             PIC X.
  1325******************************************************************
  1326*                                 COPY ELCCRTT.
  1327******************************************************************
  1328*                                                                *
  1329*                            ELCCRTT.                            *
  1330*                                                                *
  1331*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  1332*                                                                *
  1333*   FILE TYPE = VSAM,KSDS                                        *
  1334*   RECORD SIZE = 552  RECFORM = FIXED                           *
  1335*                                                                *
  1336*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  1337*                                                                *
  1338*   LOG = YES                                                    *
  1339*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1340******************************************************************
  1341*                   C H A N G E   L O G
  1342*
  1343* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1344*-----------------------------------------------------------------
  1345*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1346* EFFECTIVE    NUMBER
  1347*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  25
* WSMESS01.cbl
  1348* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  1349* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  1350* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  1351* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1352* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  1353* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1354* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1355* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  1356* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  1357******************************************************************
  1358
  1359 01  CERTIFICATE-TRAILERS.
  1360     12  CS-RECORD-ID                      PIC XX.
  1361         88  VALID-CS-ID                      VALUE 'CS'.
  1362
  1363     12  CS-CONTROL-PRIMARY.
  1364         16  CS-COMPANY-CD                 PIC X.
  1365         16  CS-CARRIER                    PIC X.
  1366         16  CS-GROUPING                   PIC X(6).
  1367         16  CS-STATE                      PIC XX.
  1368         16  CS-ACCOUNT                    PIC X(10).
  1369         16  CS-CERT-EFF-DT                PIC XX.
  1370         16  CS-CERT-NO.
  1371             20  CS-CERT-PRIME             PIC X(10).
  1372             20  CS-CERT-SFX               PIC X.
  1373         16  CS-TRAILER-TYPE               PIC X.
  1374             88  COMM-TRLR           VALUE 'A'.
  1375             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  1376             88  CERT-DATA-TRLR      VALUE 'C'.
  1377
  1378     12  CS-DATA-AREA                      PIC X(516).
  1379
  1380     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  1381         16  CS-BANK-COMMISSION-AREA.
  1382             20  CS-BANK-COMMS       OCCURS 10.
  1383                 24  CS-AGT                PIC X(10).
  1384                 24  CS-COM-TYP            PIC X.
  1385                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  1386                 24  CS-RECALC-LV-INDIC    PIC X.
  1387                 24  FILLER                PIC X(10).
  1388         16  FILLER                        PIC X(256).
  1389
  1390     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  1391****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  1392         16  CS-MB-CLAIM-DATA OCCURS 24.
  1393             20  CS-CLAIM-NO               PIC X(7).
  1394             20  CS-CLAIM-TYPE             PIC X.
  1395                 88  CS-AH-CLM               VALUE 'A'.
  1396                 88  CS-IU-CLM               VALUE 'I'.
  1397                 88  CS-GP-CLM               VALUE 'G'.
  1398                 88  CS-LF-CLM               VALUE 'L'.
  1399                 88  CS-PR-CLM               VALUE 'P'.
  1400                 88  CS-FL-CLM               VALUE 'F'.
  1401             20  CS-INSURED-TYPE           PIC X.
  1402                 88  CS-PRIM-INSURED          VALUE 'P'.
  1403                 88  CS-CO-BORROWER           VALUE 'C'.
  1404             20  CS-BENEFIT-PERIOD         PIC 99.
  1405             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  26
* WSMESS01.cbl
  1406             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  1407             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  1408         16  FILLER                        PIC X(12).
  1409     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  1410         16  CS-VIN-NUMBER                 PIC X(17).
  1411         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  1412         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  1413         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  1414         16  cs-agent-name.
  1415             20  cs-agent-fname            pic x(20).
  1416             20  cs-agent-mi               pic x.
  1417             20  cs-agent-lname            pic x(25).
  1418         16  cs-license-no                 pic x(15).
  1419         16  cs-npn-number                 pic x(10).
  1420         16  cs-agent-edit-status          pic x.
  1421             88  cs-ae-refer-to-manager      value 'M'.
  1422             88  cs-ae-cover-sheet           value 'C'.
  1423             88  cs-ae-sig-form              value 'S'.
  1424             88  cs-ae-verified              value 'V'.
  1425             88  cs-unidentified-signature   value 'U'.
  1426             88  cs-cert-returned            value 'R'.
  1427             88  cs-accept-no-commission     value 'N'.
  1428         16  cs-year                       pic 9999.
  1429         16  cs-make                       pic x(20).
  1430         16  cs-model                      pic x(20).
  1431         16  cs-future                     pic x(20).
  1432         16  cs-vehicle-odometer           pic s9(7) comp-3.
  1433         16  FILLER                        PIC X(356). *> was 420
  1434*        16  FILLER                        PIC X(496).
  1435*                                 COPY ELCCNTL.
  1436******************************************************************
  1437*                                                                *
  1438*                                                                *
  1439*                            ELCCNTL.                            *
  1440*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1441*                            VMOD=2.059                          *
  1442*                                                                *
  1443*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1444*                                                                *
  1445*   FILE TYPE = VSAM,KSDS                                        *
  1446*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1447*                                                                *
  1448*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1449*       ALTERNATE INDEX = NONE                                   *
  1450*                                                                *
  1451*   LOG = YES                                                    *
  1452*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1453******************************************************************
  1454*                   C H A N G E   L O G
  1455*
  1456* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1457*-----------------------------------------------------------------
  1458*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1459* EFFECTIVE    NUMBER
  1460*-----------------------------------------------------------------
  1461* 082503                   PEMA  ADD BENEFIT GROUP
  1462* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1463* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  27
* WSMESS01.cbl
  1464* 092705    2005050300006  PEMA  ADD SPP LEASES
  1465* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1466* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1467* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1468* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1469* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1470* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1471* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1472* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1473* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1474* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1475******************************************************************
  1476*
  1477 01  CONTROL-FILE.
  1478     12  CF-RECORD-ID                       PIC XX.
  1479         88  VALID-CF-ID                        VALUE 'CF'.
  1480
  1481     12  CF-CONTROL-PRIMARY.
  1482         16  CF-COMPANY-ID                  PIC XXX.
  1483         16  CF-RECORD-TYPE                 PIC X.
  1484             88  CF-COMPANY-MASTER              VALUE '1'.
  1485             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1486             88  CF-STATE-MASTER                VALUE '3'.
  1487             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1488             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1489             88  CF-CARRIER-MASTER              VALUE '6'.
  1490             88  CF-MORTALITY-MASTER            VALUE '7'.
  1491             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1492             88  CF-TERMINAL-MASTER             VALUE '9'.
  1493             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1494             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1495             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1496             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1497             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1498             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1499             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1500             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1501             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1502         16  CF-ACCESS-CD-GENL              PIC X(4).
  1503         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1504             20  CF-PROCESSOR               PIC X(4).
  1505         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1506             20  CF-STATE-CODE              PIC XX.
  1507             20  FILLER                     PIC XX.
  1508         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1509             20  FILLER                     PIC XX.
  1510             20  CF-HI-BEN-IN-REC           PIC XX.
  1511         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1512             20  FILLER                     PIC XXX.
  1513             20  CF-CARRIER-CNTL            PIC X.
  1514         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1515             20  FILLER                     PIC XX.
  1516             20  CF-HI-TYPE-IN-REC          PIC 99.
  1517         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1518             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1519                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1520             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1521             20  CF-CRDB-WAITING-PERIOD     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  28
* WSMESS01.cbl
  1522         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1523             20  FILLER                     PIC X.
  1524             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1525         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1526             20  FILLER                     PIC XX.
  1527             20  CF-MORTGAGE-PLAN           PIC XX.
  1528         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1529
  1530     12  CF-LAST-MAINT-DT                   PIC XX.
  1531     12  CF-LAST-MAINT-BY                   PIC X(4).
  1532     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1533
  1534     12  CF-RECORD-BODY                     PIC X(728).
  1535
  1536
  1537****************************************************************
  1538*             COMPANY MASTER RECORD                            *
  1539****************************************************************
  1540
  1541     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1542         16  CF-COMPANY-ADDRESS.
  1543             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1544             20  CF-CL-IN-CARE-OF           PIC X(30).
  1545             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1546             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1547             20  CF-CL-CITY-STATE           PIC X(30).
  1548             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1549             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1550         16  CF-COMPANY-CD                  PIC X.
  1551         16  CF-COMPANY-PASSWORD            PIC X(8).
  1552         16  CF-SECURITY-OPTION             PIC X.
  1553             88  ALL-SECURITY                   VALUE '1'.
  1554             88  COMPANY-VERIFY                 VALUE '2'.
  1555             88  PROCESSOR-VERIFY               VALUE '3'.
  1556             88  NO-SECURITY                    VALUE '4'.
  1557             88  ALL-BUT-TERM                   VALUE '5'.
  1558         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1559             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1560         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1561             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1562         16  CF-INFORCE-LOCATION            PIC X.
  1563             88  CERTS-ARE-ONLINE               VALUE '1'.
  1564             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1565             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1566         16  CF-LOWER-CASE-LETTERS          PIC X.
  1567         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1568             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1569             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1570             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1571             88  CF-ACCNT-CNTL                  VALUE '3'.
  1572             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1573
  1574         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1575         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1576
  1577         16  CF-LGX-CREDIT-USER             PIC X.
  1578             88  CO-IS-NOT-USER                 VALUE 'N'.
  1579             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  29
* WSMESS01.cbl
  1580
  1581         16 CF-CREDIT-CALC-CODES.
  1582             20  CF-CR-REM-TERM-CALC PIC X.
  1583               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1584               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1585               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1586               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1587               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1588               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1589               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1590             20  CF-CR-R78-METHOD           PIC X.
  1591               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1592               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1593
  1594         16  CF-CLAIM-CONTROL-COUNTS.
  1595             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1596                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1597
  1598             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1599                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1600
  1601             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1602                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1603
  1604             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1605                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1606
  1607         16  CF-CURRENT-MONTH-END           PIC XX.
  1608
  1609         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1610             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1611             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1612             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1613             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1614                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1615                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1616             20  CF-CO-PREM-REJECT-SW       PIC X.
  1617                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1618                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1619             20  CF-CO-REF-REJECT-SW        PIC X.
  1620                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1621                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1622
  1623         16  CF-CO-REPORTING-DT             PIC XX.
  1624         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1625         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1626           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1627           88  CF-CO-MONTH-END                  VALUE '1'.
  1628
  1629         16  CF-LGX-CLAIM-USER              PIC X.
  1630             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1631             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1632
  1633         16  CF-CREDIT-EDIT-CONTROLS.
  1634             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1635             20  CF-MIN-AGE                 PIC 99.
  1636             20  CF-DEFAULT-AGE             PIC 99.
  1637             20  CF-MIN-TERM                PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  30
* WSMESS01.cbl
  1638             20  CF-MAX-TERM                PIC S999      COMP-3.
  1639             20  CF-DEFAULT-SEX             PIC X.
  1640             20  CF-JOINT-AGE-INPUT         PIC X.
  1641                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1642             20  CF-BIRTH-DATE-INPUT        PIC X.
  1643                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1644             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1645                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1646                 88  CF-ZERO-CARRIER            VALUE '1'.
  1647                 88  CF-ZERO-GROUPING           VALUE '2'.
  1648                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1649             20  CF-EDIT-SW                 PIC X.
  1650                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1651             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1652             20  CF-CR-PR-METHOD            PIC X.
  1653               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1654               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1655             20  FILLER                     PIC X.
  1656
  1657         16  CF-CREDIT-MISC-CONTROLS.
  1658             20  CF-REIN-TABLE-SW           PIC X.
  1659                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1660             20  CF-COMP-TABLE-SW           PIC X.
  1661                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1662             20  CF-EXPERIENCE-RETENTION-AGE
  1663                                            PIC S9        COMP-3.
  1664             20  CF-CONVERSION-DT           PIC XX.
  1665             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1666             20  CF-RUN-FREQUENCY-SW        PIC X.
  1667                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1668                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1669
  1670             20  CF-CR-CHECK-NO-CONTROL.
  1671                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1672                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1673                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1674                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1675                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1676                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1677
  1678                 24  CF-CR-CHECK-COUNT       REDEFINES
  1679                     CF-CR-CHECK-COUNTER      PIC X(4).
  1680
  1681                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1682                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1683
  1684                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1685                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1686                 24  CF-MAIL-PROCESSING       PIC X.
  1687                     88  MAIL-PROCESSING          VALUE 'Y'.
  1688
  1689         16  CF-MISC-SYSTEM-CONTROL.
  1690             20  CF-SYSTEM-C                 PIC X.
  1691                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1692             20  CF-SYSTEM-D                 PIC X.
  1693                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1694             20  CF-SOC-SEC-NO-SW            PIC X.
  1695                 88  SOC-SEC-NO-USED             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  31
* WSMESS01.cbl
  1696             20  CF-MEMBER-NO-SW             PIC X.
  1697                 88  MEMBER-NO-USED              VALUE '1'.
  1698             20  CF-TAX-ID-NUMBER            PIC X(11).
  1699             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1700             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1701                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1702                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1703                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1704                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1705             20  CF-SYSTEM-E                 PIC X.
  1706                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1707
  1708         16  CF-LGX-LIFE-USER               PIC X.
  1709             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1710             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1711
  1712         16  CF-CR-MONTH-END-DT             PIC XX.
  1713
  1714         16  CF-FILE-MAINT-DATES.
  1715             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1716                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1717             20  CF-LAST-BATCH       REDEFINES
  1718                 CF-LAST-BATCH-NO               PIC X(4).
  1719             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1720             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1721             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1722             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1723             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1724             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1725             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1726             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1727             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1728             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1729
  1730         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1731         16  FILLER                         PIC X.
  1732
  1733         16  CF-ALT-MORT-CODE               PIC X(4).
  1734         16  CF-MEMBER-CAPTION              PIC X(10).
  1735
  1736         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1737             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1738             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1739             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1740             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1741             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1742
  1743         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1744
  1745         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1746         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1747         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1748         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1749
  1750         16  CF-AH-OVERRIDE-L1              PIC X.
  1751         16  CF-AH-OVERRIDE-L2              PIC XX.
  1752         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1753         16  CF-AH-OVERRIDE-L12             PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  32
* WSMESS01.cbl
  1754
  1755         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1756         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1757
  1758         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1759         16  CF-AR-LAST-EL860-DT            PIC XX.
  1760         16  CF-MP-MONTH-END-DT             PIC XX.
  1761
  1762         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1763         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1764             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1765
  1766         16  CF-AR-MONTH-END-DT             PIC XX.
  1767
  1768         16  CF-CRDTCRD-USER                PIC X.
  1769             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1770             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1771
  1772         16  CF-CC-MONTH-END-DT             PIC XX.
  1773
  1774         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1775
  1776         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1777             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1778             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1779             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1780         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1781         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1782         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1783         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1784             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1785             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1786         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1787         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1788         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1789             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1790         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1791
  1792         16  CF-CL-ZIP-CODE.
  1793             20  CF-CL-ZIP-PRIME.
  1794                 24  CF-CL-ZIP-1ST          PIC X.
  1795                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1796                 24  FILLER                 PIC X(4).
  1797             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1798         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1799             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1800             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1801             20  FILLER                     PIC XXX.
  1802
  1803         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1804         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1805         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1806         16  CF-CO-OPTION-START-DATE        PIC XX.
  1807         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1808           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1809                                                      '3' '4'.
  1810           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1811           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  33
* WSMESS01.cbl
  1812           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1813           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1814           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1815           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1816
  1817         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1818
  1819         16  CF-PAYMENT-APPROVAL-LEVELS.
  1820             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1821             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1822             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1823             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1824             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1825             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1826
  1827         16  CF-END-USER-REPORTING-USER     PIC X.
  1828             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1829             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1830
  1831         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1832             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1833             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1834
  1835         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1836
  1837         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1838         16  FILLER                         PIC X.
  1839
  1840         16  CF-CREDIT-ARCHIVE-CNTL.
  1841             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1842             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1843             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1844
  1845         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1846
  1847         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1848             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1849             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1850
  1851         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1852             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1853             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1854
  1855         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1856
  1857         16  CF-CO-ACH-ID-CODE              PIC  X.
  1858             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1859             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1860             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1861         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1862         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1863         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1864         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1865         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1866         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1867         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1868         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1869         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  34
* WSMESS01.cbl
  1870                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1871         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1872                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1873
  1874         16  CF-CO-OVER-SHORT.
  1875             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1876             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1877
  1878*         16  FILLER                         PIC X(102).
  1879         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1880             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1881             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1882
  1883         16  CF-AH-APPROVAL-DAYS.
  1884             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1885             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1886             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1887             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1888
  1889         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1890
  1891         16  CF-APPROV-LEV-5.
  1892             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1893             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1894             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1895
  1896         16  FILLER                         PIC X(68).
  1897****************************************************************
  1898*             PROCESSOR/USER RECORD                            *
  1899****************************************************************
  1900
  1901     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1902         16  CF-PROCESSOR-NAME              PIC X(30).
  1903         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1904         16  CF-PROCESSOR-TITLE             PIC X(26).
  1905         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1906                 88  MESSAGE-YES                VALUE 'Y'.
  1907                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1908
  1909*****************************************************
  1910****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1911****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1912****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1913****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1914*****************************************************
  1915
  1916         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1917             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1918             20  CF-APPLICATION-FORCE       PIC X.
  1919             20  CF-INDIVIDUAL-APP.
  1920                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1921                     28  CF-BROWSE-APP      PIC X.
  1922                     28  CF-UPDATE-APP      PIC X.
  1923
  1924         16  CF-CURRENT-TERM-ON             PIC X(4).
  1925         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1926             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1927             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  35
* WSMESS01.cbl
  1928             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1929             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1930             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1931             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1932             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1933         16  CF-PROCESSOR-CARRIER           PIC X.
  1934             88  NO-CARRIER-SECURITY            VALUE ' '.
  1935         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1936             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1937         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1938             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1939         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1940             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1941
  1942         16  CF-PROC-SYS-ACCESS-SW.
  1943             20  CF-PROC-CREDIT-CLAIMS-SW.
  1944                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1945                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1946                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1947                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1948             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1949                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1950                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1951             20  CF-PROC-LIFE-GNRLDGR-SW.
  1952                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1953                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1954                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1955                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1956             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1957                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1958                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1959         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1960             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1961             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1962         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1963
  1964         16  CF-APPROVAL-LEVEL                  PIC X.
  1965             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1966             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1967             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1968             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1969             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1970
  1971         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1972
  1973         16  CF-LANGUAGE-TYPE                   PIC X.
  1974             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1975             88  CF-LANG-IS-FR                      VALUE 'F'.
  1976
  1977         16  CF-CSR-IND                         PIC X.
  1978         16  FILLER                             PIC X(239).
  1979
  1980****************************************************************
  1981*             PROCESSOR/REMINDERS RECORD                       *
  1982****************************************************************
  1983
  1984     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1985         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  36
* WSMESS01.cbl
  1986             20  CF-START-REMIND-DT         PIC XX.
  1987             20  CF-END-REMIND-DT           PIC XX.
  1988             20  CF-REMINDER-TEXT           PIC X(50).
  1989         16  FILLER                         PIC X(296).
  1990
  1991
  1992****************************************************************
  1993*             STATE MASTER RECORD                              *
  1994****************************************************************
  1995
  1996     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1997         16  CF-STATE-ABBREVIATION          PIC XX.
  1998         16  CF-STATE-NAME                  PIC X(25).
  1999         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2000         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2001             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2002             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2003             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2004             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2005                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2006                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2007             20  CF-ST-PREM-REJECT-SW       PIC X.
  2008                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2009                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2010             20  CF-ST-REF-REJECT-SW        PIC X.
  2011                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2012                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2013         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2014         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2015         16  CF-ST-REFUND-RULES.
  2016             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2017             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2018             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2019         16  CF-ST-FST-PMT-EXTENSION.
  2020             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2021             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2022                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2023                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2024                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2025                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2026         16  CF-ST-STATE-CALL.
  2027             20  CF-ST-CALL-UNEARNED        PIC X.
  2028             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2029             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2030         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2031             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2032             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2033         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2034         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2035         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2036         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2037         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2038         16  FILLER                         PIC X.
  2039         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2040             20  CF-ST-BENEFIT-CD           PIC XX.
  2041             20  CF-ST-BENEFIT-KIND         PIC X.
  2042                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2043                 88  CF-ST-AH-KIND              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  37
* WSMESS01.cbl
  2044             20  CF-ST-REM-TERM-CALC        PIC X.
  2045                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2046                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2047                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2048                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2049                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2050                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2051                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2052                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2053
  2054             20  CF-ST-REFUND-CALC          PIC X.
  2055                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2056                 88  ST-REFD-BY-R78             VALUE '1'.
  2057                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2058                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2059                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2060                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2061                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2062                 88  ST-REFD-UTAH               VALUE '7'.
  2063                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2064                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2065                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2066
  2067             20  CF-ST-EARNING-CALC         PIC X.
  2068                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2069                 88  ST-EARN-BY-R78             VALUE '1'.
  2070                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2071                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2072                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2073                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2074                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2075                 88  ST-EARN-MEAN               VALUE '8'.
  2076                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2077
  2078             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2079                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2080                 88  ST-OVRD-BY-R78             VALUE '1'.
  2081                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2082                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2083                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2084                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2085                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2086                 88  ST-OVRD-MEAN               VALUE '8'.
  2087                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2088             20  cf-st-extra-periods        pic 9.
  2089*            20  FILLER                     PIC X.
  2090
  2091         16  CF-ST-COMMISSION-CAPS.
  2092             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2093             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2094             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2095             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2096         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2097                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2098
  2099         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2100
  2101         16  CF-ST-STATUTORY-INTEREST.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  38
* WSMESS01.cbl
  2102             20  CF-ST-STAT-DATE-FROM       PIC X.
  2103                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2104                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2105             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2106             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2107             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2108             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2109             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2110
  2111         16  CF-ST-OVER-SHORT.
  2112             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2113             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2114
  2115         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2116
  2117         16  CF-ST-RT-CALC                  PIC X.
  2118
  2119         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2120         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2121         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2122         16  CF-ST-RF-LR-CALC               PIC X.
  2123         16  CF-ST-RF-LL-CALC               PIC X.
  2124         16  CF-ST-RF-LN-CALC               PIC X.
  2125         16  CF-ST-RF-AH-CALC               PIC X.
  2126         16  CF-ST-RF-CP-CALC               PIC X.
  2127*        16  FILLER                         PIC X(206).
  2128*CIDMOD         16  FILLER                         PIC X(192).
  2129         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2130             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2131         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2132         16  CF-ST-VFY-2ND-BENE             PIC X.
  2133         16  CF-ST-CAUSAL-STATE             PIC X.
  2134         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2135         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2136         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2137             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2138         16  CF-ST-NET-ONLY-STATE           PIC X.
  2139             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2140         16  FILLER                         PIC X(181).
  2141
  2142****************************************************************
  2143*             BENEFIT MASTER RECORD                            *
  2144****************************************************************
  2145
  2146     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2147         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2148             20  CF-BENEFIT-CODE            PIC XX.
  2149             20  CF-BENEFIT-NUMERIC  REDEFINES
  2150                 CF-BENEFIT-CODE            PIC XX.
  2151             20  CF-BENEFIT-ALPHA           PIC XXX.
  2152             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2153             20  CF-BENEFIT-COMMENT         PIC X(10).
  2154
  2155             20  CF-LF-COVERAGE-TYPE        PIC X.
  2156                 88  CF-REDUCING                VALUE 'R'.
  2157                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2158
  2159             20  CF-SPECIAL-CALC-CD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  39
* WSMESS01.cbl
  2160                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2161                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2162                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2163                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2164                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2165                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2166                 88  CF-FARM-PLAN               VALUE 'F'.
  2167                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2168                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2169                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2170                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2171                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2172                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2173                 88  CF-PRUDENTIAL              VALUE 'P'.
  2174                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2175                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2176                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2177                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2178                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2179                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2180
  2181             20  CF-JOINT-INDICATOR         PIC X.
  2182                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2183
  2184*            20  FILLER                     PIC X(12).
  2185             20  cf-maximum-benefits        pic s999 comp-3.
  2186             20  FILLER                     PIC X(09).
  2187             20  CF-BENEFIT-CATEGORY        PIC X.
  2188             20  CF-LOAN-TYPE               PIC X(8).
  2189
  2190             20  CF-CO-REM-TERM-CALC        PIC X.
  2191                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2192                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2193                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2194                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2195                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2196
  2197             20  CF-CO-EARNINGS-CALC        PIC X.
  2198                 88  CO-EARN-BY-R78             VALUE '1'.
  2199                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2200                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2201                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2202                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2203                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2204                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2205                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2206
  2207             20  CF-CO-REFUND-CALC          PIC X.
  2208                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2209                 88  CO-REFD-BY-R78             VALUE '1'.
  2210                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2211                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2212                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2213                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2214                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2215                 88  CO-REFD-MEAN               VALUE '8'.
  2216                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2217                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  40
* WSMESS01.cbl
  2218                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2219
  2220             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2221                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2222                 88  CO-OVRD-BY-R78             VALUE '1'.
  2223                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2224                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2225                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2226                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2227                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2228                 88  CO-OVRD-MEAN               VALUE '8'.
  2229                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2230
  2231             20  CF-CO-BEN-I-G-CD           PIC X.
  2232                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2233                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2234                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2235
  2236         16  FILLER                         PIC X(304).
  2237
  2238
  2239****************************************************************
  2240*             CARRIER MASTER RECORD                            *
  2241****************************************************************
  2242
  2243     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2244         16  CF-ADDRESS-DATA.
  2245             20  CF-MAIL-TO-NAME            PIC X(30).
  2246             20  CF-IN-CARE-OF              PIC X(30).
  2247             20  CF-ADDRESS-LINE-1          PIC X(30).
  2248             20  CF-ADDRESS-LINE-2          PIC X(30).
  2249             20  CF-CITY-STATE              PIC X(30).
  2250             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2251             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2252
  2253         16  CF-CLAIM-NO-CONTROL.
  2254             20  CF-CLAIM-NO-METHOD         PIC X.
  2255                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2256                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2257                 88  CLAIM-NO-SEQ               VALUE '3'.
  2258                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2259             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2260                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2261                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2262                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2263
  2264         16  CF-CHECK-NO-CONTROL.
  2265             20  CF-CHECK-NO-METHOD         PIC X.
  2266                 88  CHECK-NO-MANUAL            VALUE '1'.
  2267                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2268                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2269                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2270             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2271                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2272
  2273         16  CF-DOMICILE-STATE              PIC XX.
  2274
  2275         16  CF-EXPENSE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  41
* WSMESS01.cbl
  2276             20  CF-EXPENSE-METHOD          PIC X.
  2277                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2278                 88  DOLLARS-PER-PMT            VALUE '2'.
  2279                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2280                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2281             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2282             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2283
  2284         16  CF-CORRESPONDENCE-CONTROL.
  2285             20  CF-LETTER-RESEND-OPT       PIC X.
  2286                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2287                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2288             20  FILLER                     PIC X(4).
  2289
  2290         16  CF-RESERVE-CONTROLS.
  2291             20  CF-MANUAL-SW               PIC X.
  2292                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2293             20  CF-FUTURE-SW               PIC X.
  2294                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2295             20  CF-PTC-SW                  PIC X.
  2296                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2297             20  CF-IBNR-SW                 PIC X.
  2298                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2299             20  CF-PTC-LF-SW               PIC X.
  2300                 88  CF-LF-PTC-USED             VALUE '1'.
  2301             20  CF-CDT-ACCESS-METHOD       PIC X.
  2302                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2303                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2304                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2305             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2306
  2307         16  CF-CLAIM-CALC-METHOD           PIC X.
  2308             88  360-PLUS-MONTHS                VALUE '1'.
  2309             88  365-PLUS-MONTHS                VALUE '2'.
  2310             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2311             88  360-DAILY                      VALUE '4'.
  2312             88  365-DAILY                      VALUE '5'.
  2313
  2314         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2315         16  FILLER                         PIC X(11).
  2316
  2317         16  CF-LIMIT-AMOUNTS.
  2318             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2319             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2320             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2321             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2322             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2323             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2324             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2325             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2326             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2327             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2328
  2329         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2330         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2331         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2332
  2333         16  CF-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  42
* WSMESS01.cbl
  2334             20  CF-ZIP-PRIME.
  2335                 24  CF-ZIP-1ST             PIC X.
  2336                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2337                 24  FILLER                 PIC X(4).
  2338             20  CF-ZIP-PLUS4               PIC X(4).
  2339         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2340             20  CF-CAN-POSTAL-1            PIC XXX.
  2341             20  CF-CAN-POSTAL-2            PIC XXX.
  2342             20  FILLER                     PIC XXX.
  2343
  2344         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2345         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2346         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2347
  2348         16  CF-RATING-SWITCH               PIC X.
  2349             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2350             88  CF-NO-RATING                   VALUE 'N'.
  2351
  2352         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2353
  2354         16  CF-CARRIER-OVER-SHORT.
  2355             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2356             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2357
  2358         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2359         16  CF-SECPAY-SWITCH               PIC X.
  2360             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2361             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2362         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2363         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2364         16  FILLER                         PIC X(444).
  2365*        16  FILLER                         PIC X(452).
  2366
  2367
  2368****************************************************************
  2369*             MORTALITY MASTER RECORD                          *
  2370****************************************************************
  2371
  2372     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2373         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2374                                INDEXED BY CF-MORT-NDX.
  2375             20  CF-MORT-TABLE              PIC X(5).
  2376             20  CF-MORT-TABLE-TYPE         PIC X.
  2377                 88  CF-MORT-JOINT              VALUE 'J'.
  2378                 88  CF-MORT-SINGLE             VALUE 'S'.
  2379                 88  CF-MORT-COMBINED           VALUE 'C'.
  2380                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2381                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2382             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2383             20  CF-MORT-AGE-METHOD         PIC XX.
  2384                 88  CF-AGE-LAST                VALUE 'AL'.
  2385                 88  CF-AGE-NEAR                VALUE 'AN'.
  2386             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2387             20  CF-MORT-ADJUSTMENT-DIRECTION
  2388                                            PIC X.
  2389                 88  CF-MINUS                   VALUE '-'.
  2390                 88  CF-PLUS                    VALUE '+'.
  2391             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  43
* WSMESS01.cbl
  2392             20  CF-MORT-JOINT-CODE         PIC X.
  2393                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2394             20  CF-MORT-PC-Q               PIC X.
  2395                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2396             20  CF-MORT-TABLE-CODE         PIC X(4).
  2397             20  CF-MORT-COMMENTS           PIC X(15).
  2398             20  FILLER                     PIC X(14).
  2399
  2400         16  FILLER                         PIC X(251).
  2401
  2402
  2403****************************************************************
  2404*             BUSSINESS TYPE MASTER RECORD                     *
  2405****************************************************************
  2406
  2407     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2408* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2409* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2410* AND RECORD 05 IS TYPES 81-99
  2411         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2412             20  CF-BUSINESS-TITLE          PIC  X(19).
  2413             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2414                                            PIC S9V9(4) COMP-3.
  2415             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2416             20  FILLER                     PIC  X.
  2417         16  FILLER                         PIC  X(248).
  2418
  2419
  2420****************************************************************
  2421*             TERMINAL MASTER RECORD                           *
  2422****************************************************************
  2423
  2424     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2425
  2426         16  CF-COMPANY-TERMINALS.
  2427             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2428                                  PIC X(4).
  2429         16  FILLER               PIC X(248).
  2430
  2431
  2432****************************************************************
  2433*             LIFE EDIT MASTER RECORD                          *
  2434****************************************************************
  2435
  2436     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2437         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2438             20  CF-LIFE-CODE-IN            PIC XX.
  2439             20  CF-LIFE-CODE-OUT           PIC XX.
  2440         16  FILLER                         PIC X(248).
  2441
  2442
  2443****************************************************************
  2444*             AH EDIT MASTER RECORD                            *
  2445****************************************************************
  2446
  2447     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2448         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2449             20  CF-AH-CODE-IN              PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  44
* WSMESS01.cbl
  2450             20  CF-AH-CODE-OUT             PIC XX.
  2451         16  FILLER                         PIC X(248).
  2452
  2453
  2454****************************************************************
  2455*             CREDIBILITY TABLES                               *
  2456****************************************************************
  2457
  2458     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2459         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2460                             INDEXED BY CF-CRDB-NDX.
  2461             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2462             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2463             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2464         16  FILLER                         PIC  X(332).
  2465
  2466
  2467****************************************************************
  2468*             REPORT CUSTOMIZATION RECORD                      *
  2469****************************************************************
  2470
  2471     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2472         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2473             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2474             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2475             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2476**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2477****       A T-TRANSFER.                                   ****
  2478             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2479
  2480         16  FILLER                         PIC XX.
  2481
  2482         16  CF-CARRIER-CNTL-OPT.
  2483             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2484                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2485                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2486             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2487                                            PIC X.
  2488         16  CF-GROUP-CNTL-OPT.
  2489             20  CF-GROUP-OPT-SEQ           PIC 9.
  2490                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2491                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2492             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2493                                            PIC X(6).
  2494         16  CF-STATE-CNTL-OPT.
  2495             20  CF-STATE-OPT-SEQ           PIC 9.
  2496                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2497                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2498             20  CF-STATE-SELECT OCCURS 3 TIMES
  2499                                            PIC XX.
  2500         16  CF-ACCOUNT-CNTL-OPT.
  2501             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2502                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2503                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2504             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2505                                            PIC X(10).
  2506         16  CF-BUS-TYP-CNTL-OPT.
  2507             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  45
* WSMESS01.cbl
  2508                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2509                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2510             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2511                                            PIC XX.
  2512         16  CF-LF-TYP-CNTL-OPT.
  2513             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2514                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2515                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2516             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2517                                            PIC XX.
  2518         16  CF-AH-TYP-CNTL-OPT.
  2519             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2520                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2521                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2522             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2523                                            PIC XX.
  2524         16  CF-REPTCD1-CNTL-OPT.
  2525             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2526                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2527                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2528             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2529                                            PIC X(10).
  2530         16  CF-REPTCD2-CNTL-OPT.
  2531             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2532                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2533                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2534             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2535                                            PIC X(10).
  2536         16  CF-USER1-CNTL-OPT.
  2537             20  CF-USER1-OPT-SEQ           PIC 9.
  2538                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2539                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2540             20  CF-USER1-SELECT OCCURS 3 TIMES
  2541                                            PIC X(10).
  2542         16  CF-USER2-CNTL-OPT.
  2543             20  CF-USER2-OPT-SEQ           PIC 9.
  2544                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2545                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2546             20  CF-USER2-SELECT OCCURS 3 TIMES
  2547                                            PIC X(10).
  2548         16  CF-USER3-CNTL-OPT.
  2549             20  CF-USER3-OPT-SEQ           PIC 9.
  2550                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2551                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2552             20  CF-USER3-SELECT OCCURS 3 TIMES
  2553                                            PIC X(10).
  2554         16  CF-USER4-CNTL-OPT.
  2555             20  CF-USER4-OPT-SEQ           PIC 9.
  2556                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2557                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2558             20  CF-USER4-SELECT OCCURS 3 TIMES
  2559                                            PIC X(10).
  2560         16  CF-USER5-CNTL-OPT.
  2561             20  CF-USER5-OPT-SEQ           PIC 9.
  2562                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2563                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2564             20  CF-USER5-SELECT OCCURS 3 TIMES
  2565                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  46
* WSMESS01.cbl
  2566         16  CF-REINS-CNTL-OPT.
  2567             20  CF-REINS-OPT-SEQ           PIC 9.
  2568                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2569                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2570             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2571                 24  CF-REINS-PRIME         PIC XXX.
  2572                 24  CF-REINS-SUB           PIC XXX.
  2573
  2574         16  CF-AGENT-CNTL-OPT.
  2575             20  CF-AGENT-OPT-SEQ           PIC 9.
  2576                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2577                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2578             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2579                                            PIC X(10).
  2580
  2581         16  FILLER                         PIC X(43).
  2582
  2583         16  CF-LOSS-RATIO-SELECT.
  2584             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2585             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2586         16  CF-ENTRY-DATE-SELECT.
  2587             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2588             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2589         16  CF-EFFECTIVE-DATE-SELECT.
  2590             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2591             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2592
  2593         16  CF-EXCEPTION-LIST-IND          PIC X.
  2594             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2595
  2596         16  FILLER                         PIC X(318).
  2597
  2598****************************************************************
  2599*                  EXCEPTION REPORTING RECORD                  *
  2600****************************************************************
  2601
  2602     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2603         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2604             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2605
  2606         16  CF-COMBINED-LIFE-AH-OPT.
  2607             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2608             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2609             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2610             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2611
  2612         16  CF-LIFE-OPT.
  2613             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2614             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2615             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2616             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2617             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2618             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2619             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2620             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2621             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2622             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2623
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  47
* WSMESS01.cbl
  2624         16  CF-AH-OPT.
  2625             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2626             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2627             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2628             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2629             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2630             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2631             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2632             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2633             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2634             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2635
  2636         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2637             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2638             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2639             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2640
  2641         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2642
  2643         16  FILLER                         PIC X(673).
  2644
  2645
  2646****************************************************************
  2647*             MORTGAGE SYSTEM PLAN RECORD                      *
  2648****************************************************************
  2649
  2650     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2651         16  CF-PLAN-TYPE                   PIC X.
  2652             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2653             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2654             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2655         16  CF-PLAN-ABBREV                 PIC XXX.
  2656         16  CF-PLAN-DESCRIPT               PIC X(10).
  2657         16  CF-PLAN-NOTES                  PIC X(20).
  2658         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2659         16  CF-PLAN-UNDERWRITING.
  2660             20  CF-PLAN-TERM-DATA.
  2661                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2662                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2663             20  CF-PLAN-AGE-DATA.
  2664                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2665                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2666                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2667             20  CF-PLAN-BENEFIT-DATA.
  2668                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2669                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2670                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2671                                            PIC S9(7)V99  COMP-3.
  2672         16  CF-PLAN-POLICY-FORMS.
  2673             20  CF-POLICY-FORM             PIC X(12).
  2674             20  CF-MASTER-APPLICATION      PIC X(12).
  2675             20  CF-MASTER-POLICY           PIC X(12).
  2676         16  CF-PLAN-RATING.
  2677             20  CF-RATE-CODE               PIC X(5).
  2678             20  CF-SEX-RATING              PIC X.
  2679                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2680                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2681             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  48
* WSMESS01.cbl
  2682             20  CF-SUB-STD-TYPE            PIC X.
  2683                 88  CF-PCT-OF-PREM            VALUE '1'.
  2684                 88  CF-PCT-OF-BENE            VALUE '2'.
  2685         16  CF-PLAN-PREM-TOLERANCES.
  2686             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2687             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2688         16  CF-PLAN-PYMT-TOLERANCES.
  2689             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2690             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2691         16  CF-PLAN-MISC-DATA.
  2692             20  FILLER                     PIC X.
  2693             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2694             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2695         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2696         16  CF-PLAN-IND-GRP                PIC X.
  2697             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2698                                                     '1'.
  2699             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2700                                                     '2'.
  2701         16  CF-MIB-SEARCH-SW               PIC X.
  2702             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2703             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2704             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2705             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2706         16  CF-ALPHA-SEARCH-SW             PIC X.
  2707             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2708             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2709             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2710             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2711             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2712             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2713             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2714             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2715             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2716             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2717                                                     'A' 'B' 'C'
  2718                                                     'X' 'Y' 'Z'.
  2719         16  CF-EFF-DT-RULE-SW              PIC X.
  2720             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2721             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2722             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2723             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2724             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2725         16  FILLER                         PIC X(4).
  2726         16  CF-HEALTH-QUESTIONS            PIC X.
  2727             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2728         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2729         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2730         16  CF-PLAN-SNGL-JNT               PIC X.
  2731             88  CF-COMBINED-PLAN              VALUE 'C'.
  2732             88  CF-JNT-PLAN                   VALUE 'J'.
  2733             88  CF-SNGL-PLAN                  VALUE 'S'.
  2734         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2735         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2736         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2737         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2738         16  CF-RERATE-CNTL                 PIC  X.
  2739             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  49
* WSMESS01.cbl
  2740             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2741             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2742             88  CF-AUTO-RECALC                 VALUE '4'.
  2743         16  CF-BENEFIT-TYPE                PIC  X.
  2744             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2745             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2746         16  CF-POLICY-FEE                  PIC S999V99
  2747                                                    COMP-3.
  2748         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2749         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2750         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2751         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2752         16  FILLER                         PIC  X(32).
  2753         16  CF-TERMINATION-FORM            PIC  X(04).
  2754         16  FILLER                         PIC  X(08).
  2755         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2756                                                       COMP-3.
  2757         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2758         16  CF-ISSUE-LETTER                PIC  X(4).
  2759         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2760         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2761             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2762             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2763         16  CF-MP-REFUND-CALC              PIC X.
  2764             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2765             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2766             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2767             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2768             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2769             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2770             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2771             88  CF-MP-REFD-MEAN                VALUE '8'.
  2772         16  CF-ALT-RATE-CODE               PIC  X(5).
  2773
  2774
  2775         16  FILLER                         PIC X(498).
  2776****************************************************************
  2777*             MORTGAGE COMPANY MASTER RECORD                   *
  2778****************************************************************
  2779
  2780     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2781         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2782         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2783             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2784             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2785             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2786             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2787             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2788
  2789         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2790         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2791         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2792         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2793         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2794
  2795         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2796             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2797         16  CF-MP-RECON-USE-IND            PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  50
* WSMESS01.cbl
  2798             88  CF-MP-USE-RECON             VALUE 'Y'.
  2799         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2800             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2801         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2802             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2803             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2804         16  FILLER                         PIC X(1).
  2805         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2806             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2807         16  CF-MORTG-MIB-VERSION           PIC X.
  2808             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2809             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2810             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2811         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2812             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2813                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2814             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2815                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2816             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2817                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2818             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2819                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2820             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2821                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2822             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2823                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2824         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2825         16  FILLER                         PIC X(7).
  2826         16  CF-MORTG-DESTINATION-SYMBOL.
  2827             20  CF-MORTG-MIB-COMM          PIC X(5).
  2828             20  CF-MORTG-MIB-TERM          PIC X(5).
  2829         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2830             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2831         16  FILLER                         PIC X(03).
  2832         16  CF-MP-CHECK-NO-CONTROL.
  2833             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2834                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2835                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2836                                                ' ' LOW-VALUES.
  2837                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2838                                               VALUE '3'.
  2839         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2840         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2841         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2842             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2843                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2844             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2845                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2846             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2847                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2848             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2849                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2850             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2851                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2852             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2853                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2854         16  CF-MORTG-BILLING-AREA.
  2855             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  51
* WSMESS01.cbl
  2856                                            PIC X.
  2857         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2858         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2859         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2860         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2861             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2862             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2863         16  FILLER                         PIC X.
  2864         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2865             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2866             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2867         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2868         16  FILLER                         PIC X(8).
  2869         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2870         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2871         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2872         16  CF-ACH-COMPANY-ID.
  2873             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2874                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2875                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2876                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2877             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2878         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2879             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2880         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2881             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2882             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2883         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2884         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2885         16  FILLER                         PIC X(536).
  2886
  2887****************************************************************
  2888*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2889****************************************************************
  2890
  2891     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2892         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2893             20  CF-FEMALE-HEIGHT.
  2894                 24  CF-FEMALE-FT           PIC 99.
  2895                 24  CF-FEMALE-IN           PIC 99.
  2896             20  CF-FEMALE-MIN-WT           PIC 999.
  2897             20  CF-FEMALE-MAX-WT           PIC 999.
  2898         16  FILLER                         PIC X(428).
  2899
  2900     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2901         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2902             20  CF-MALE-HEIGHT.
  2903                 24  CF-MALE-FT             PIC 99.
  2904                 24  CF-MALE-IN             PIC 99.
  2905             20  CF-MALE-MIN-WT             PIC 999.
  2906             20  CF-MALE-MAX-WT             PIC 999.
  2907         16  FILLER                         PIC X(428).
  2908******************************************************************
  2909*             AUTOMATIC ACTIVITY RECORD                          *
  2910******************************************************************
  2911     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2912         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2913             20  CF-SYS-ACTIVE-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  52
* WSMESS01.cbl
  2914             20  CF-SYS-LETTER-ID           PIC X(04).
  2915             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2916             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2917             20  CF-SYS-RESET-SW            PIC X(01).
  2918             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2919             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2920
  2921         16  FILLER                         PIC X(50).
  2922
  2923         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2924             20  CF-USER-ACTIVE-SW          PIC X(01).
  2925             20  CF-USER-LETTER-ID          PIC X(04).
  2926             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2927             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2928             20  CF-USER-RESET-SW           PIC X(01).
  2929             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2930             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2931             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2932
  2933         16  FILLER                         PIC X(246).
  2934*                                 COPY ELCFUNDT.
  2935*****************************************************************
  2936*                                                               *
  2937*                            ELCFUNDT.                          *
  2938*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
  2939*                            VMOD=2.001                         *
  2940*                                                               *
  2941*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
  2942*                                                               *
  2943*****************************************************************
  2944
  2945
  2946 01  FUNCTION-DATE.
  2947     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
  2948     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
  2949         10  WS-FN-CCYR            PIC 9(4).
  2950         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
  2951             15  WS-FN-CC          PIC 99.
  2952             15  WS-FN-YR          PIC 99.
  2953         10  WS-FN-MO              PIC 99.
  2954         10  WS-FN-DA              PIC 99.
  2955     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
  2956     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
  2957     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
  2958     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
  2959     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
  2960         88  WS-BEHIND-GMT                     VALUE '-'.
  2961         88  WS-AFTER-GMT                      VALUE '+'.
  2962         88  WS-NO-GMT                         VALUE ZERO.
  2963     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
  2964     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
  2965*                                 COPY ELCDATE.
  2966******************************************************************
  2967*                                                                *
  2968*                                                                *
  2969*                            ELCDATE.                            *
  2970*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2971*                            VMOD=2.003
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  53
* WSMESS01.cbl
  2972*                                                                *
  2973*                                                                *
  2974*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2975*                 LENGTH = 200                                   *
  2976******************************************************************
  2977
  2978 01  DATE-CONVERSION-DATA.
  2979     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2980     12  DC-OPTION-CODE                PIC X.
  2981         88  BIN-TO-GREG                VALUE ' '.
  2982         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2983         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2984         88  YMD-GREG-TO-BIN            VALUE '3'.
  2985         88  MDY-GREG-TO-BIN            VALUE '4'.
  2986         88  JULIAN-TO-BIN              VALUE '5'.
  2987         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2988         88  FIND-CENTURY               VALUE '7'.
  2989         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2990         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2991         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2992         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2993         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2994         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2995         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2996         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2997         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2998         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2999         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3000         88  BIN-3-TO-GREG              VALUE 'I'.
  3001         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3002         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3003         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3004         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3005         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3006         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3007         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3008         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3009         88  THREE-CHARACTER-BIN
  3010                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3011         88  GREGORIAN-TO-BIN
  3012                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3013         88  BIN-TO-GREGORIAN
  3014                  VALUES ' ' '1' 'I' '8' 'G'.
  3015         88  JULIAN-TO-BINARY
  3016                  VALUES '5' 'C' 'E' 'F'.
  3017     12  DC-ERROR-CODE                 PIC X.
  3018         88  NO-CONVERSION-ERROR        VALUE ' '.
  3019         88  DATE-CONVERSION-ERROR
  3020                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3021         88  DATE-IS-ZERO               VALUE '1'.
  3022         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3023         88  DATE-IS-INVALID            VALUE '3'.
  3024         88  DATE1-GREATER-DATE2        VALUE '4'.
  3025         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3026         88  DATE-INVALID-OPTION        VALUE '9'.
  3027         88  INVALID-CENTURY            VALUE 'A'.
  3028         88  ONLY-CENTURY               VALUE 'B'.
  3029         88  ONLY-LEAP-YEAR             VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  54
* WSMESS01.cbl
  3030         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3031     12  DC-END-OF-MONTH               PIC X.
  3032         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3033     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3034         88  USE-NORMAL-PROCESS         VALUE ' '.
  3035         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3036         88  ADJUST-UP-100-YRS          VALUE '2'.
  3037     12  FILLER                        PIC X.
  3038     12  DC-CONVERSION-DATES.
  3039         16  DC-BIN-DATE-1             PIC XX.
  3040         16  DC-BIN-DATE-2             PIC XX.
  3041         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3042         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3043                       DC-GREG-DATE-1-EDIT.
  3044             20  DC-EDIT1-MONTH        PIC 99.
  3045             20  SLASH1-1              PIC X.
  3046             20  DC-EDIT1-DAY          PIC 99.
  3047             20  SLASH1-2              PIC X.
  3048             20  DC-EDIT1-YEAR         PIC 99.
  3049         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3050         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3051                     DC-GREG-DATE-2-EDIT.
  3052             20  DC-EDIT2-MONTH        PIC 99.
  3053             20  SLASH2-1              PIC X.
  3054             20  DC-EDIT2-DAY          PIC 99.
  3055             20  SLASH2-2              PIC X.
  3056             20  DC-EDIT2-YEAR         PIC 99.
  3057         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3058         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3059                     DC-GREG-DATE-1-YMD.
  3060             20  DC-YMD-YEAR           PIC 99.
  3061             20  DC-YMD-MONTH          PIC 99.
  3062             20  DC-YMD-DAY            PIC 99.
  3063         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3064         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3065                      DC-GREG-DATE-1-MDY.
  3066             20  DC-MDY-MONTH          PIC 99.
  3067             20  DC-MDY-DAY            PIC 99.
  3068             20  DC-MDY-YEAR           PIC 99.
  3069         16  DC-GREG-DATE-1-ALPHA.
  3070             20  DC-ALPHA-MONTH        PIC X(10).
  3071             20  DC-ALPHA-DAY          PIC 99.
  3072             20  FILLER                PIC XX.
  3073             20  DC-ALPHA-CENTURY.
  3074                 24 DC-ALPHA-CEN-N     PIC 99.
  3075             20  DC-ALPHA-YEAR         PIC 99.
  3076         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3077         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3078         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3079         16  DC-JULIAN-DATE            PIC 9(05).
  3080         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3081                                       PIC 9(05).
  3082         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3083             20  DC-JULIAN-YEAR        PIC 99.
  3084             20  DC-JULIAN-DAYS        PIC 999.
  3085         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3086         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3087         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  55
* WSMESS01.cbl
  3088     12  DATE-CONVERSION-VARIBLES.
  3089         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3090         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3091             20  FILLER                PIC 9(3).
  3092             20  HOLD-CEN-1-CCYY.
  3093                 24  HOLD-CEN-1-CC     PIC 99.
  3094                 24  HOLD-CEN-1-YY     PIC 99.
  3095             20  HOLD-CEN-1-MO         PIC 99.
  3096             20  HOLD-CEN-1-DA         PIC 99.
  3097         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3098             20  HOLD-CEN-1-R-MO       PIC 99.
  3099             20  HOLD-CEN-1-R-DA       PIC 99.
  3100             20  HOLD-CEN-1-R-CCYY.
  3101                 24  HOLD-CEN-1-R-CC   PIC 99.
  3102                 24  HOLD-CEN-1-R-YY   PIC 99.
  3103             20  FILLER                PIC 9(3).
  3104         16  HOLD-CENTURY-1-X.
  3105             20  FILLER                PIC X(3)  VALUE SPACES.
  3106             20  HOLD-CEN-1-X-CCYY.
  3107                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3108                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3109             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3110             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3111         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3112             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3113             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3114             20  HOLD-CEN-1-R-X-CCYY.
  3115                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3116                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3117             20  FILLER                PIC XXX.
  3118         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3119         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3120         16  DC-JULIAN-DATE-1          PIC 9(07).
  3121         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3122             20  DC-JULIAN-1-CCYY.
  3123                 24  DC-JULIAN-1-CC    PIC 99.
  3124                 24  DC-JULIAN-1-YR    PIC 99.
  3125             20  DC-JULIAN-DA-1        PIC 999.
  3126         16  DC-JULIAN-DATE-2          PIC 9(07).
  3127         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3128             20  DC-JULIAN-2-CCYY.
  3129                 24  DC-JULIAN-2-CC    PIC 99.
  3130                 24  DC-JULIAN-2-YR    PIC 99.
  3131             20  DC-JULIAN-DA-2        PIC 999.
  3132         16  DC-GREG-DATE-A-EDIT.
  3133             20  DC-EDITA-MONTH        PIC 99.
  3134             20  SLASHA-1              PIC X VALUE '/'.
  3135             20  DC-EDITA-DAY          PIC 99.
  3136             20  SLASHA-2              PIC X VALUE '/'.
  3137             20  DC-EDITA-CCYY.
  3138                 24  DC-EDITA-CENT     PIC 99.
  3139                 24  DC-EDITA-YEAR     PIC 99.
  3140         16  DC-GREG-DATE-B-EDIT.
  3141             20  DC-EDITB-MONTH        PIC 99.
  3142             20  SLASHB-1              PIC X VALUE '/'.
  3143             20  DC-EDITB-DAY          PIC 99.
  3144             20  SLASHB-2              PIC X VALUE '/'.
  3145             20  DC-EDITB-CCYY.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  56
* WSMESS01.cbl
  3146                 24  DC-EDITB-CENT     PIC 99.
  3147                 24  DC-EDITB-YEAR     PIC 99.
  3148         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3149         16  DC-GREG-DATE-CYMD-R REDEFINES
  3150                              DC-GREG-DATE-CYMD.
  3151             20  DC-CYMD-CEN           PIC 99.
  3152             20  DC-CYMD-YEAR          PIC 99.
  3153             20  DC-CYMD-MONTH         PIC 99.
  3154             20  DC-CYMD-DAY           PIC 99.
  3155         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3156         16  DC-GREG-DATE-MDCY-R REDEFINES
  3157                              DC-GREG-DATE-MDCY.
  3158             20  DC-MDCY-MONTH         PIC 99.
  3159             20  DC-MDCY-DAY           PIC 99.
  3160             20  DC-MDCY-CEN           PIC 99.
  3161             20  DC-MDCY-YEAR          PIC 99.
  3162    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3163        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3164    12  DC-EL310-DATE                  PIC X(21).
  3165    12  FILLER                         PIC X(28).
  3166*                                 COPY ELCCALC.
  3167******************************************************************
  3168*                                                                *
  3169*                           ELCCALC.                            *
  3170*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3171*                            VMOD=2.025                          *
  3172*                                                                *
  3173*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3174*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3175*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3176*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3177*                                                                *
  3178*  PASSED TO ELRTRM                                              *
  3179*  -----------------                                             *
  3180*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3181*  ORIGINAL TERM                                                 *
  3182*  BEGINNING DATE                                                *
  3183*  ENDING DATE                                                   *
  3184*  COMPANY I.D.                                                  *
  3185*  ACCOUNT MASTER USER FIELD                                     *
  3186*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3187*  FREE LOOK DAYS                                                *
  3188*                                                                *
  3189*  RETURNED FROM ELRTRM                                          *
  3190*  ---------------------                                         *
  3191*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3192*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3193*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3194*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3195*----------------------------------------------------------------*
  3196*  PASSED TO ELRAMT                                              *
  3197*  ----------------                                              *
  3198*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3199*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3200*  ORIGINAL AMOUNT                                               *
  3201*  ALTERNATE BENEFIT (BALLON)                                    *
  3202*  A.P.R. - NET PAY ONLY                                         *
  3203*  METHOD
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  57
* WSMESS01.cbl
  3204*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3205*  COMPANY I.D.                                                  *
  3206*  BENEFIT TYPE                                                  *
  3207*                                                                *
  3208*  RETURNED FROM ELRAMT                                          *
  3209*  --------------------                                          *
  3210*  REMAINING AMOUNT 1 - CURRENT                                  *
  3211*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3212*  REMAINING AMOUNT FACTOR
  3213*----------------------------------------------------------------*
  3214*  PASSED TO ELRESV                                              *
  3215*  -----------------                                             *
  3216*  CERTIFICATE EFFECTIVE DATE                                    *
  3217*  VALUATION DATE                                                *
  3218*  PAID THRU DATE                                                *
  3219*  BENEFIT                                                       *
  3220*  INCURRED DATE                                                 *
  3221*  REPORTED DATE                                                 *
  3222*  ISSUE AGE                                                     *
  3223*  TERM                                                          *
  3224*  CDT PERCENT                                                   *
  3225*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3226* *CLAIM TYPE (LIFE, A/H)                                        *
  3227* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3228* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3229*                                                                *
  3230*  RETURNED FROM ELRESV                                          *
  3231*  --------------------                                          *
  3232*  CDT TABLE USED                                                *
  3233*  CDT FACTOR USED                                               *
  3234*  PAY TO CURRENT RESERVE                                        *
  3235*  I.B.N.R. - A/H ONLY                                           *
  3236*  FUTURE (ACCRUED) AH ONLY                                      *
  3237*----------------------------------------------------------------*
  3238*  PASSED TO ELRATE                                              *
  3239*  ----------------                                              *
  3240*  CERT ISSUE DATE                                               *
  3241*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3242*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3243*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3244*  STATE CODE (CLIENT DEFINED)                                   *
  3245*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3246*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3247*  DEVIATION CODE                                                *
  3248*  ISSUE AGE                                                     *
  3249*  ORIGINAL BENEFIT AMOUNT                                       *
  3250*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3251*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3252*  BENEFIT KIND (LIFE OR A/H)                                    *
  3253*  A.P.R.                                                        *
  3254*  METHOD
  3255*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3256*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3257*  COMPANY I.D. (3 CHARACTER)                                    *
  3258*  BENEFIT CODE                                                  *
  3259*  BENEFIT OVERRIDE CODE                                         *
  3260*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3261*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  58
* WSMESS01.cbl
  3262*  JOINT INDICATOR (CSL ONLY)                                    *
  3263*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3264*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3265*                                                                *
  3266*  RETURNED FROM ELRATE                                          *
  3267*  --------------------                                          *
  3268*  CALCULATED PREMIUM                                            *
  3269*  PREMIUM RATE                                                  *
  3270*  MORTALITY CODE                                                *
  3271*  MAX ATTAINED AGE                                              *
  3272*  MAX AGE                                                       *
  3273*  MAX TERM                                                      *
  3274*  MAX MONTHLY BENEFIT                                           *
  3275*  MAX TOTAL BENIFIT                                             *
  3276*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3277*----------------------------------------------------------------*
  3278*  PASSED TO ELRFND                                              *
  3279*  ----------------                                              *
  3280*  CERT ISSUE DATE                                               *
  3281*  REFUND DATE                                                   *
  3282*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3283*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3284*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3285*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3286*  STATE CODE (CLIENT DEFINED)                                   *
  3287*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3288*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3289*  DEVIATION CODE                                                *
  3290*  ISSUE AGE                                                     *
  3291*  ORIGINAL BENEFIT AMOUNT                                       *
  3292*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3293*  PROCESS TYPE (CANCEL)                                         *
  3294*  BENEFIT KIND (LIFE OR A/H)                                    *
  3295*  A.P.R.                                                        *
  3296*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3297*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3298*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3299*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3300*  COMPANY I.D. (3 CHARACTER)                                    *
  3301*  BENEFIT CODE                                                  *
  3302*  BENEFIT OVERRIDE CODE                                         *
  3303*                                                                *
  3304*  RETURNED FROM ELRFND                                          *
  3305*  --------------------                                          *
  3306*  CALCULATED REFUND                                             *
  3307*----------------------------------------------------------------*
  3308*  PASSED TO ELEARN                                              *
  3309*  ----------------                                              *
  3310*  CERT ISSUE DATE                                               *
  3311*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3312*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3313*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3314*  STATE CODE (CLIENT DEFINED)                                   *
  3315*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3316*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3317*  DEVIATION CODE                                                *
  3318*  ISSUE AGE                                                     *
  3319*  ORIGINAL BENEFIT AMOUNT                                       *
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  59
* WSMESS01.cbl
  3320*  BENEFIT KIND (LIFE OR A/H)                                    *
  3321*  A.P.R.                                                        *
  3322*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3323*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3324*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3325*  COMPANY I.D. (3 CHARACTER)                                    *
  3326*  BENEFIT CODE                                                  *
  3327*  BENEFIT OVERRIDE CODE                                         *
  3328*                                                                *
  3329*  RETURNED FROM ELEARN                                          *
  3330*  --------------------                                          *
  3331*  INDICATED  EARNINGS                                           *
  3332*----------------------------------------------------------------*
  3333*                 LENGTH = 450                                   *
  3334*                                                                *
  3335******************************************************************
  3336******************************************************************
  3337*                   C H A N G E   L O G
  3338*
  3339* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3340*-----------------------------------------------------------------
  3341*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3342* EFFECTIVE    NUMBER
  3343*-----------------------------------------------------------------
  3344* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3345* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3346* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3347* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3348* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3349* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3350* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3351* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3352* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3353* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3354* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3355******************************************************************
  3356
  3357 01  CALCULATION-PASS-AREA.
  3358     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3359                                     COMP.
  3360
  3361     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3362       88  NO-CP-ERROR                             VALUE ZERO.
  3363       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3364                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3365       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3366       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3367       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3368       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3369       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3370       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3371       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3372       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3373       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3374       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3375       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3376       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3377       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  60
* WSMESS01.cbl
  3378       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3379       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3380       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3381       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3382
  3383     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3384       88  NO-CP-ERROR-2                           VALUE ZERO.
  3385***********************  INPUT AREAS ****************************
  3386
  3387     12  CP-CALCULATION-AREA.
  3388         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3389         16  CP-CERT-EFF-DT        PIC XX.
  3390         16  CP-VALUATION-DT       PIC XX.
  3391         16  CP-PAID-THRU-DT       PIC XX.
  3392         16  CP-BENEFIT-TYPE       PIC X.
  3393           88  CP-AH                               VALUE 'A' 'D'
  3394                                                   'I' 'U'.
  3395           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3396           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3397         16  CP-INCURRED-DT        PIC XX.
  3398         16  CP-REPORTED-DT        PIC XX.
  3399         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3400         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3401         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3402                                     COMP-3.
  3403         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3404                                     COMP-3.
  3405         16  CP-CDT-METHOD         PIC X.
  3406           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3407           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3408           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3409         16  CP-CLAIM-TYPE         PIC X.
  3410           88  CP-AH-CLAIM                         VALUE 'A'.
  3411           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3412         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3413                                     COMP-3.
  3414         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3415                                     COMP-3.
  3416         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3417                                     COMP-3.
  3418         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3419                                     COMP-3.
  3420         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3421                                     COMP-3.
  3422         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3423                                     COMP-3.
  3424         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3425                                     COMP-3.
  3426         16  CP-REM-TERM-METHOD    PIC X.
  3427           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3428           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3429           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3430           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3431           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3432           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3433           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3434         16  CP-EARNING-METHOD     PIC X.
  3435           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  61
* WSMESS01.cbl
  3436           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3437           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3438           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3439           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3440           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3441           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3442           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3443           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3444           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3445           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3446           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3447           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3448           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3449         16  CP-PROCESS-TYPE       PIC X.
  3450           88  CP-CLAIM                            VALUE '1'.
  3451           88  CP-CANCEL                           VALUE '2'.
  3452           88  CP-ISSUE                            VALUE '3'.
  3453         16  CP-SPECIAL-CALC-CD    PIC X.
  3454           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3455           88  CP-1-MTH-INTEREST               VALUE ' '.
  3456           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3457           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3458           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3459           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3460           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3461           88  CP-FARM-PLAN                    VALUE 'F'.
  3462           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3463           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3464           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3465           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3466           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3467           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3468           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3469           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3470           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3471           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3472                                                     'W' 'X'.
  3473           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3474           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3475           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3476           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3477           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3478           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3479           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3480           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3481           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3482           88  CP-CSL-METH-1                   VALUE '5'.
  3483           88  CP-CSL-METH-2                   VALUE '6'.
  3484           88  CP-CSL-METH-3                   VALUE '7'.
  3485           88  CP-CSL-METH-4                   VALUE '8'.
  3486
  3487         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3488                                     COMP-3.
  3489         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3490         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3491         16  CP-STATE              PIC XX          VALUE SPACE.
  3492         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3493         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  62
* WSMESS01.cbl
  3494           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3495               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3496         16  CP-R78-OPTION         PIC X.
  3497           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3498           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3499
  3500         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3501         16  CP-IBNR-RESERVE-SW    PIC X.
  3502         16  CP-CLAIM-STATUS       PIC X.
  3503         16  CP-RATE-FILE          PIC X.
  3504         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3505                                     COMP-3.
  3506
  3507         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3508         16  CP-AH-OVERRIDE-CODE   PIC X.
  3509
  3510         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3511                                     COMP-3.
  3512         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3513                                   PIC S9(5)V99 COMP-3.
  3514         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3515                                     COMP-3.
  3516         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3517                                     COMP-3.
  3518         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3519                                     COMP-3.
  3520         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3521                                  PIC S9(7)V99 COMP-3.
  3522
  3523         16  CP-PAID-FROM-DATE     PIC X(02).
  3524         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3525         16  CP-EXT-DAYS-CALC      PIC X.
  3526           88  CP-EXT-NO-CHG                   VALUE ' '.
  3527           88  CP-EXT-CHG-LF                   VALUE '1'.
  3528           88  CP-EXT-CHG-AH                   VALUE '2'.
  3529           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3530         16  CP-DOMICILE-STATE     PIC XX.
  3531         16  CP-CARRIER            PIC X.
  3532         16  CP-REIN-FLAG          PIC X.
  3533         16  CP-REM-TRM-CALC-OPTION PIC X.
  3534           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3535                      '2' '3' '4' '5'.
  3536           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3537           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3538           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3539           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3540           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3541           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3542           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3543           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3544         16  CP-SIG-SWITCH         PIC X.
  3545         16  CP-RATING-METHOD      PIC X.
  3546           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3547           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3548           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3549           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3550           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3551           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  63
* WSMESS01.cbl
  3552           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3553           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3554           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3555         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3556                                     COMP-3.
  3557         16  CP-BEN-CATEGORY       PIC X.
  3558         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3559         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3560                                   PIC S99V9(5) COMP-3.
  3561         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3562         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3563                                   PIC S99V9(5) COMP-3.
  3564         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3565         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3566         16  CP-EXPIRE-DT          PIC XX.
  3567         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3568         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3569         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3570         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3571         16  CP-DDF-SPEC-CALC      PIC X.
  3572             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3573             88  CP-CALC-CLP              VALUE 'C'.
  3574         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3575         16  CP-CANCEL-REASON      PIC X.
  3576         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3577         16  CP-PMT-MODE           PIC X.
  3578         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3579         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3580         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3581         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3582         16  FILLER                PIC X.
  3583
  3584***************    OUTPUT FROM ELRESV   ************************
  3585
  3586         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3587
  3588         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3589                                     COMP-3.
  3590         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3591                                     COMP-3.
  3592         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3593                                     COMP-3.
  3594         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3595                                     COMP-3.
  3596         16  FILLER                PIC X(09).
  3597***************    OUTPUT FROM ELRTRM   *************************
  3598
  3599         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3600                                     COMP-3.
  3601         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3602                                     COMP-3.
  3603         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3604                                     COMP-3.
  3605         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3606                                     COMP-3.
  3607         16  FILLER                PIC X(12).
  3608
  3609***************    OUTPUT FROM ELRAMT   *************************
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  64
* WSMESS01.cbl
  3610
  3611         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3612                                     COMP-3.
  3613         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3614                                     COMP-3.
  3615         16  FILLER                PIC X(12).
  3616
  3617***************    OUTPUT FROM ELRATE   *************************
  3618
  3619         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3620                                     COMP-3.
  3621         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3622                                     COMP-3.
  3623         16  CP-MORTALITY-CODE     PIC X(4).
  3624         16  CP-RATE-EDIT-FLAG     PIC X.
  3625             88  CP-RATES-NEED-APR                  VALUE '1'.
  3626         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3627                                     COMP-3.
  3628         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3629         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3630         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3631                                   PIC S9(7)V99 COMP-3.
  3632         16  FILLER                PIC X(07).
  3633
  3634***************    OUTPUT FROM ELRFND   *************************
  3635
  3636         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3637                                     COMP-3.
  3638         16  CP-REFUND-TYPE-USED   PIC X.
  3639           88  CP-R-AS-R78                         VALUE '1'.
  3640           88  CP-R-AS-PRORATA                     VALUE '2'.
  3641           88  CP-R-AS-CALIF                       VALUE '3'.
  3642           88  CP-R-AS-TEXAS                       VALUE '4'.
  3643           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3644           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3645           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3646           88  CP-R-AS-MEAN                        VALUE '8'.
  3647           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3648           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3649           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3650           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3651           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3652           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3653         16  FILLER                PIC X(12).
  3654
  3655***************    OUTPUT FROM ELEARN   *************************
  3656
  3657         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3658                                     COMP-3.
  3659         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3660                                     COMP-3.
  3661         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3662                                     COMP-3.
  3663         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3664                                     COMP-3.
  3665         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3666                                     COMP-3.
  3667         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  65
* WSMESS01.cbl
  3668                                     COMP-3.
  3669         16  CP-EARNING-TYPE-USED  PIC X.
  3670           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3671           88  CP-E-AS-R78                         VALUE '1'.
  3672           88  CP-E-AS-PRORATA                     VALUE '2'.
  3673           88  CP-E-AS-TEXAS                       VALUE '4'.
  3674           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3675           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3676           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3677           88  CP-E-AS-MEAN                        VALUE '8'.
  3678           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3679         16  FILLER                PIC X(12).
  3680
  3681***************    OUTPUT FROM ELPMNT   *************************
  3682
  3683         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3684                                     COMP-3.
  3685         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3686                                     COMP-3.
  3687         16  FILLER                PIC X(12).
  3688
  3689***************   MISC WORK AREAS    *****************************
  3690         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3691                                     COMP-3.
  3692         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3693                                     COMP-3.
  3694         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3695                                     COMP-3.
  3696         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3697                                     COMP-3.
  3698         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3699                                     COMP-3.
  3700         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3701                                     COMP-3.
  3702         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3703             88  OPEN-RATE-FILE                   VALUE 'O'.
  3704             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3705             88  IO-ERROR                         VALUE 'E'.
  3706
  3707         16  CP-FIRST-PAY-DATE     PIC XX.
  3708
  3709         16  CP-JOINT-INDICATOR    PIC X.
  3710
  3711         16  CP-RESERVE-REMAINING-TERM
  3712                                   PIC S9(4)V9    VALUE ZERO
  3713                                     COMP-3.
  3714
  3715         16  CP-INSURED-BIRTH-DT   PIC XX.
  3716
  3717         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3718                                     COMP-3.
  3719
  3720         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3721                                     COMP-3.
  3722
  3723         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3724                                     COMP-3.
  3725
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  66
* WSMESS01.cbl
  3726         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3727                                     COMP-3.
  3728
  3729         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3730                                     COMP-3.
  3731
  3732         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3733                                     COMP-3.
  3734
  3735         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3736                                     COMP-3.
  3737
  3738         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3739             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3740
  3741         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3742                                     COMP-3.
  3743         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3744                                     COMP-3.
  3745         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3746         16  cp-extra-periods      pic 9 value zeros.
  3747         16  cp-net-only-state     pic x value spaces.
  3748         16  FILLER                PIC X(13).
  3749******************************************************************
  3750****************************************************************
  3751*
  3752* Copyright (c) 2007-2013 Dell Inc.
  3753* All rights reserved.
  3754*
  3755****************************************************************
  3756 01  DFHEIV.
  3757   02  DFHEIV0               PIC X(35).
  3758   02  DFHEIV1               PIC X(08).
  3759   02  DFHEIV2               PIC X(08).
  3760   02  DFHEIV3               PIC X(08).
  3761   02  DFHEIV4               PIC X(06).
  3762   02  DFHEIV5               PIC X(04).
  3763   02  DFHEIV6               PIC X(04).
  3764   02  DFHEIV7               PIC X(02).
  3765   02  DFHEIV8               PIC X(02).
  3766   02  DFHEIV9               PIC X(01).
  3767   02  DFHEIV10              PIC S9(7) COMP-3.
  3768   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3769   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3770   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3771   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3772   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3773   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3774   02  DFHEIV17              PIC X(04).
  3775   02  DFHEIV18              PIC X(04).
  3776   02  DFHEIV19              PIC X(04).
  3777   02  DFHEIV20              USAGE IS POINTER.
  3778   02  DFHEIV21              USAGE IS POINTER.
  3779   02  DFHEIV22              USAGE IS POINTER.
  3780   02  DFHEIV23              USAGE IS POINTER.
  3781   02  DFHEIV24              USAGE IS POINTER.
  3782   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3783   02  DFHEIV26              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  67
* WSMESS01.cbl
  3784   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3785   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3786   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3787   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3788   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3789   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3790   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3791   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3792   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3793   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3794   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3795   02  FILLER                PIC X(02).
  3796   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3797   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3798   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3799   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3800   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3801   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3802   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3803 LINKAGE  SECTION.
  3804*****************************************************************
  3805*                                                               *
  3806* Copyright (c) 2007-2013 Dell Inc.                             *
  3807* All rights reserved.                                          *
  3808*                                                               *
  3809*****************************************************************
  3810 01  dfheiblk.
  3811     02  eibtime          pic s9(7) comp-3.
  3812     02  eibdate          pic s9(7) comp-3.
  3813     02  eibtrnid         pic x(4).
  3814     02  eibtaskn         pic s9(7) comp-3.
  3815     02  eibtrmid         pic x(4).
  3816     02  dfheigdi         pic s9(4) comp.
  3817     02  eibcposn         pic s9(4) comp.
  3818     02  eibcalen         pic s9(4) comp.
  3819     02  eibaid           pic x(1).
  3820     02  eibfiller1       pic x(1).
  3821     02  eibfn            pic x(2).
  3822     02  eibfiller2       pic x(2).
  3823     02  eibrcode         pic x(6).
  3824     02  eibfiller3       pic x(2).
  3825     02  eibds            pic x(8).
  3826     02  eibreqid         pic x(8).
  3827     02  eibrsrce         pic x(8).
  3828     02  eibsync          pic x(1).
  3829     02  eibfree          pic x(1).
  3830     02  eibrecv          pic x(1).
  3831     02  eibsend          pic x(1).
  3832     02  eibatt           pic x(1).
  3833     02  eibeoc           pic x(1).
  3834     02  eibfmh           pic x(1).
  3835     02  eibcompl         pic x(1).
  3836     02  eibsig           pic x(1).
  3837     02  eibconf          pic x(1).
  3838     02  eiberr           pic x(1).
  3839     02  eibrldbk         pic x(1).
  3840     02  eiberrcd         pic x(4).
  3841     02  eibsynrb         pic x(1).
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  68
* WSMESS01.cbl
  3842     02  eibnodat         pic x(1).
  3843     02  eibfiller5       pic x(2).
  3844     02  eibresp          pic s9(8) comp.
  3845     02  eibresp2         pic s9(8) comp.
  3846     02  dfheigdj         pic s9(4) comp.
  3847     02  dfheigdk         pic s9(4) comp.
  3848 01  DFHCOMMAREA                 pic x(1024).
  3849 01  var  pic x(30).
  3850 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  3851 0000-DFHEXIT SECTION.
  3852     MOVE '9#                    $   ' TO DFHEIV0.
  3853     MOVE 'WSMESS01' TO DFHEIV1.
  3854     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3855     display ' Entering program WSMESS01 '
  3856     move dfhcommarea            to ws-mess001-pass-area
  3857     perform 0000-init           thru 0000-exit
  3858     display ' mess001 area ' ws-mess001-pass-area
  3859     perform 0100-process-message
  3860                                 thru 0100-exit
  3861     display ' raw after unstring ' raw-message001-area
  3862*    move ' returning string goes here ' to ws-return-string
  3863     go to 0300-RETURN-CICS
  3864     .
  3865 0000-init.
  3866     move 'CID'                  to client-id
  3867     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  3868     move ws-fn-cymd             to dc-greg-date-cymd
  3869     move 'L'                    to dc-option-code
  3870     perform 9700-date-link      thru 9700-exit
  3871     if no-conversion-error
  3872        move dc-bin-date-1       to ws-bin-current-dt
  3873     else
  3874        display ' error current dt invalid ' dc-error-code
  3875     end-if
  3876     display ' current date/time '
  3877        ws-fn-mo '/' ws-fn-da '/' ws-fn-ccyy ' - '
  3878           ws-fn-hours ':' ws-fn-minutes ':' ws-fn-seconds
  3879     set P to address of KIXSYS
  3880     CALL "getenv" using by value P returning var-ptr
  3881     if var-ptr = null then
  3882        display ' kixsys not set '
  3883     else
  3884        set address of var to var-ptr
  3885        move 0 to env-var-len
  3886        inspect var tallying env-var-len
  3887          for characters before X'00'
  3888        unstring var (1:env-var-len) delimited by '/'
  3889           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  3890              WS-KIX-SYS
  3891        end-unstring
  3892     end-if
  3893     evaluate client-id
  3894        when 'DCC'
  3895           MOVE X'05'            TO WS-COMP-CD
  3896           MOVE 'DCC'            TO WS-COMP-ID
  3897        when 'CID'
  3898           MOVE X'04'            TO WS-COMP-CD
  3899           MOVE 'CID'            TO WS-COMP-ID
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  69
* WSMESS01.cbl
  3900        when 'AHL'
  3901           MOVE X'06'            TO WS-COMP-CD
  3902           MOVE 'AHL'            TO WS-COMP-ID
  3903        when other
  3904           move '0113;Invalid company id ' to ws-return-string
  3905           display ' Invalid company id ' client-id
  3906           go to 0300-RETURN-CICS
  3907     END-evaluate
  3908     .
  3909 0000-exit.
  3910     exit.
  3911 0020-edit-received.
  3912     if ws-rate-sin-jnt-ind = 'S' OR 'J'
  3913        continue
  3914     else
  3915        move 'S'                 to ws-rate-sin-jnt-ind
  3916     end-if
  3917     if ws-rate-dismemberment = 'Y'
  3918        continue
  3919     else
  3920        move 'N'                 to ws-rate-dismemberment
  3921     end-if
  3922     if ws-rate-lf-ah = 'A'
  3923        if ws-rate-retro-elim = 'R' or 'E'
  3924           continue
  3925        else
  3926           move 'R'              to ws-rate-retro-elim
  3927        end-if
  3928     else
  3929        move spaces              to ws-rate-retro-elim
  3930     end-if
  3931     if ws-rate-ins-term = zeros
  3932        move '0115;Problem with insurance term '
  3933                                 to ws-return-string
  3934        go to 0300-RETURN-CICS
  3935     end-if
  3936     if ws-rate-lf-ah = 'L'
  3937        move 'L'                 to ws-rate-benefit-type
  3938     else
  3939        move 'A'                 to ws-rate-benefit-type
  3940     end-if
  3941**==============================================================**
  3942**                                                              **
  3943**  Validate passed effective date. Probably should add edits   **
  3944**                                                              **
  3945**==============================================================**
  3946     move ws-rate-eff-date (7:4) to ws-work-date (1:4)
  3947     move ws-rate-eff-date (1:2) to ws-work-date (5:2)
  3948     move ws-rate-eff-date (4:2) to ws-work-date (7:2)
  3949     move ws-work-date-num       to dc-greg-date-cymd
  3950     move 'L'                    to dc-option-code
  3951     perform 9700-date-link      thru 9700-exit
  3952     if no-conversion-error
  3953        move dc-bin-date-1       to ws-bin-eff-dt
  3954     else
  3955        move '0102;Problem with Eff Date' to ws-return-string
  3956        go to 0300-RETURN-CICS
  3957     end-if
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  70
* WSMESS01.cbl
  3958     if ws-bin-eff-dt > ws-bin-current-dt
  3959        move '0102;Future Effective Date' to ws-return-string
  3960        go to 0300-RETURN-CICS
  3961     end-if
  3962**==============================================================**
  3963**                                                              **
  3964**  Validate passed 1st pmt date.   Probably should add edits   **
  3965**                                                              **
  3966**==============================================================**
  3967     move ws-rate-1st-pmt-dt (7:4)
  3968                                 to ws-work-date (1:4)
  3969     move ws-rate-1st-pmt-dt (1:2)
  3970                                 to ws-work-date (5:2)
  3971     move ws-rate-1st-pmt-dt (4:2)
  3972                                 to ws-work-date (7:2)
  3973     move ws-work-date-num       to dc-greg-date-cymd
  3974     move 'L'                    to dc-option-code
  3975     perform 9700-date-link      thru 9700-exit
  3976     if no-conversion-error
  3977        move dc-bin-date-1       to ws-bin-1st-pmt-dt
  3978     else
  3979        move low-values          to ws-bin-1st-pmt-dt
  3980        move '0102;Problem with 1st pmt Date'
  3981                                 to ws-return-string
  3982        go to 0300-RETURN-CICS
  3983     end-if
  3984     if ws-bin-1st-pmt-dt <= ws-bin-eff-dt
  3985        move low-values          to ws-bin-1st-pmt-dt
  3986        move '0102;1st Pmt Date not > Eff Dt '
  3987                                 to ws-return-string
  3988        go to 0300-RETURN-CICS
  3989     end-if
  3990**==============================================================**
  3991**                                                              **
  3992**  Only use the code below if there is a time they don't       **
  3993**  send the 1st pmt date.                                      **
  3994**                                                              **
  3995**==============================================================**
  3996     if ws-bin-1st-pmt-dt = low-values
  3997        move +1                  to dc-elapsed-months
  3998        move +0                  to dc-elapsed-days
  3999        move '6'                 to dc-option-code
  4000        perform 9700-date-link   thru 9700-exit
  4001        if no-conversion-error
  4002           move dc-bin-date-2    to ws-bin-1st-pmt-dt
  4003        else
  4004           move '0102;Problem with 1st pmt Date'
  4005                                 to ws-return-string
  4006           go to 0300-RETURN-CICS
  4007        end-if
  4008     end-if
  4009**==============================================================**
  4010**                                                              **
  4011**  Calculate the expiration date to be passed back.            **
  4012**                                                              **
  4013**==============================================================**
  4014     move ws-bin-1st-pmt-dt      to dc-bin-date-1
  4015     compute dc-elapsed-months = ws-rate-ins-term - 1
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  71
* WSMESS01.cbl
  4016     move +0                     to dc-elapsed-days
  4017     move '6'                    to dc-option-code
  4018     perform 9700-date-link      thru 9700-exit
  4019     if no-conversion-error
  4020        move dc-bin-date-2       to ws-bin-exp-dt
  4021        move dc-greg-date-a-edit to ws-exp-date
  4022     else
  4023        move '0102;Problem with calculating exp date'
  4024                              to ws-return-string
  4025        go to 0300-RETURN-CICS
  4026     end-if
  4027**==============================================================**
  4028**                                                              **
  4029**  Validate primary borrower birth date.                       **
  4030**                                                              **
  4031**==============================================================**
  4032     move ws-rate-pri-birth-date (7:4)
  4033                                 to ws-work-date (1:4)
  4034     move ws-rate-pri-birth-date (1:2)
  4035                                 to ws-work-date (5:2)
  4036     move ws-rate-pri-birth-date (4:2)
  4037                                 to ws-work-date (7:2)
  4038     move ws-work-date-num       to dc-greg-date-cymd
  4039     move 'L'                    to dc-option-code
  4040     perform 9700-date-link      thru 9700-exit
  4041     if no-conversion-error
  4042        move dc-bin-date-1       to ws-bin-pri-birth-dt
  4043     else
  4044        move '0102;Problem with Pri Birth Date'
  4045                                 to ws-return-string
  4046        go to 0300-RETURN-CICS
  4047     end-if
  4048**==============================================================**
  4049**                                                              **
  4050**  Validate co borrowers birth date.                           **
  4051**                                                              **
  4052**==============================================================**
  4053     if ws-rate-cob-birth-date (7:4) = spaces
  4054        move zeros               to ws-rate-cob-birth-date
  4055     end-if
  4056     move ws-rate-cob-birth-date (7:4)
  4057                                 to ws-work-date (1:4)
  4058     move ws-rate-cob-birth-date (1:2)
  4059                                 to ws-work-date (5:2)
  4060     move ws-rate-cob-birth-date (4:2)
  4061                                 to ws-work-date (7:2)
  4062     move low-values             to ws-bin-cob-birth-dt
  4063     if ws-work-date-num not = zeros
  4064        move ws-work-date-num    to dc-greg-date-cymd
  4065        move 'L'                 to dc-option-code
  4066        perform 9700-date-link   thru 9700-exit
  4067        if no-conversion-error
  4068           move dc-bin-date-1    to ws-bin-cob-birth-dt
  4069        else
  4070           move '0102;Problem with Cob Birth Date'
  4071                                 to ws-return-string
  4072           go to 0300-RETURN-CICS
  4073        end-if
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  72
* WSMESS01.cbl
  4074     end-if
  4075**==============================================================**
  4076**                                                              **
  4077**  Calculate primary borrowers age.                            **
  4078**                                                              **
  4079**==============================================================**
  4080     move ws-bin-pri-birth-dt    to dc-bin-date-1
  4081     move ws-bin-eff-dt          to dc-bin-date-2
  4082     move '1'                    to dc-option-code
  4083     perform 9700-date-link      thru 9700-exit
  4084     if no-conversion-error
  4085        compute ws-issue-age = dc-elapsed-months / +12
  4086        display ' issue age = 'ws-issue-age
  4087     else
  4088        move '0102;Problem with Pri Age calculation'
  4089                                 to ws-return-string
  4090        go to 0300-RETURN-CICS
  4091     end-if
  4092**==============================================================**
  4093**                                                              **
  4094**  Calculate co borrowers age.                                 **
  4095**                                                              **
  4096**==============================================================**
  4097     move zeros                  to ws-cob-age
  4098     if ws-bin-cob-birth-dt not = low-values
  4099        move ws-bin-cob-birth-dt to dc-bin-date-1
  4100        move ws-bin-eff-dt       to dc-bin-date-2
  4101        move '1'                 to dc-option-code
  4102        perform 9700-date-link   thru 9700-exit
  4103        if no-conversion-error
  4104           compute ws-cob-age = dc-elapsed-months / +12
  4105           display ' cob   age = 'ws-cob-age
  4106        else
  4107           move '0102;Problem with Cob Age calculation'
  4108                                 to ws-return-string
  4109           go to 0300-RETURN-CICS
  4110        end-if
  4111     end-if
  4112     move ws-issue-age           to ws-rate-age
  4113     if ws-cob-age > ws-rate-age
  4114        display ' Using Co borrower age ' ws-issue-age
  4115           ' ' ws-cob-age
  4116        move ws-cob-age          to ws-rate-age
  4117     end-if
  4118**==============================================================**
  4119**                                                              **
  4120**  Validate passed total of payments. loan term * payment      **
  4121**                                                              **
  4122**==============================================================**
  4123*    if ws-rate-lf-ah = 'A'
  4124*       GO TO 0020-EXIT
  4125*    END-IF
  4126     compute ws-calc-tot-pmts =
  4127        ws-rate-loan-term * ws-rate-payment
  4128     display '    my tot pmts ' ws-calc-tot-pmts
  4129     display ' their tot pmts ' ws-rate-tot-pmts
  4130     if ((ws-calc-tot-pmts - ws-rate-tot-pmts) > 1.00)
  4131                     or
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  73
* WSMESS01.cbl
  4132        ((ws-rate-tot-pmts - ws-calc-tot-pmts) > 1.00)
  4133*    if ws-calc-tot-pmts <> ws-rate-tot-pmts
  4134         move '0116;Total of payments incorrect '
  4135                                 to ws-return-string
  4136         go to 0300-RETURN-CICS
  4137     end-if
  4138     .
  4139 0020-exit.
  4140     exit.
  4141 0025-assign-ben-cd.
  4142**==============================================================**
  4143**                                                              **
  4144**     Eventually, depending on how well this project takes off **
  4145**  we should figure out a much better way to assign benefit    **
  4146**  codes. For now since we only have 1 or 2 accounts in TX it  **
  4147**  will be hard coded.                                         **
  4148**                                                              **
  4149**==============================================================**
  4150     if ws-rate-benefit-type = 'L'
  4151        if ws-rate-sin-jnt-ind = 'S'
  4152           move '01'             to ws-rate-benefit-cd
  4153        else
  4154           move '03'             to ws-rate-benefit-cd
  4155        end-if
  4156     else
  4157        if ws-rate-sin-jnt-ind = 'J'
  4158           if ws-rate-retro-elim = 'R'
  4159              if ws-rate-waiting-days = 14
  4160                 move '54'       to ws-rate-benefit-cd
  4161              else
  4162                 if ws-rate-waiting-days = 30
  4163                    move '55'    to ws-rate-benefit-cd
  4164                 end-if
  4165              end-if
  4166           else
  4167              if ws-rate-retro-elim = 'E'
  4168                 if ws-rate-waiting-days = 14
  4169                    move '56'    to ws-rate-benefit-cd
  4170                 else
  4171                    if ws-rate-waiting-days = 30
  4172                       move '57' to ws-rate-benefit-cd
  4173                    end-if
  4174                 end-if
  4175              end-if
  4176           end-if
  4177        else
  4178           if ws-rate-retro-elim = 'R'
  4179              if ws-rate-waiting-days = 14
  4180                 move '01'       to ws-rate-benefit-cd
  4181              else
  4182                 if ws-rate-waiting-days = 30
  4183                    move '04'    to ws-rate-benefit-cd
  4184                 end-if
  4185              end-if
  4186           else
  4187              if ws-rate-retro-elim = 'E'
  4188                 if ws-rate-waiting-days = 14
  4189                    move '05'    to ws-rate-benefit-cd
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  74
* WSMESS01.cbl
  4190                 else
  4191                    if ws-rate-waiting-days = 30
  4192                       move '02' to ws-rate-benefit-cd
  4193                    end-if
  4194                 end-if
  4195              end-if
  4196           end-if
  4197        end-if
  4198     end-if
  4199     .
  4200 0025-exit.
  4201     exit.
  4202 0030-get-rate.
  4203     perform 0050-get-account    thru 0050-exit
  4204*    move spaces                 to calculation-pass-area
  4205     move zeros                  to cp-r-max-mon-ben
  4206                                    cp-r-max-tot-ben
  4207                                    cp-rate-dev-pct
  4208                                    cp-original-premium
  4209                                    cp-critical-months
  4210                                    cp-term-or-ext-days
  4211     move am-cal-table           to cp-class-CODE
  4212     if ws-rate-benefit-type = 'L'
  4213        move am-lf-deviation     to cp-deviation-code
  4214        if raw-ben-code (1:1) = 'N' or 'T'
  4215           move ws-rate-benefit  to cp-original-benefit
  4216                                    cp-rating-benefit-amt
  4217        else
  4218           move ws-rate-tot-pmts to cp-original-benefit
  4219                                    cp-rating-benefit-amt
  4220        end-if
  4221     else
  4222        move am-ah-deviation     to cp-deviation-code
  4223        move ws-rate-benefit     to cp-original-benefit
  4224                                    cp-rating-benefit-amt
  4225     end-if
  4226     move ws-rate-state          to cp-state
  4227                                    cp-state-std-abbrv
  4228     move ws-rate-benefit-type   to cp-benefit-type
  4229     move ws-rate-benefit-cd     to cp-benefit-cd
  4230     move ws-rate-age            to cp-issue-age
  4231     move ws-comp-id             to cp-company-id
  4232     move ws-comp-cd             to cp-company-cd
  4233     move ws-rate-apr            to cp-loan-apr
  4234     if ws-rate-loan-term = zeros
  4235        move ws-rate-ins-term    to ws-rate-loan-term
  4236     end-if
  4237     move ws-rate-ins-term       to cp-original-term
  4238     move ws-rate-loan-term      to cp-loan-term
  4239     move 'L'                    to cp-life-override-code
  4240     move 'A'                    to cp-ah-override-code
  4241     move '3'                    to cp-process-type
  4242     move ws-rate-earn-meth      to cp-earning-method
  4243                                    cp-rating-method
  4244     move 'R'                    to cp-rate-file
  4245     move ws-bin-eff-dt          to cp-cert-eff-dt
  4246     move ws-bin-1st-pmt-dt      to cp-first-pay-date
  4247     PERFORM 7000-GET-RATE       THRU 7000-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  75
* WSMESS01.cbl
  4248     if no-cp-error
  4249        if ((cp-calc-premium - ws-rate-premium) > 9.99)
  4250                        or
  4251           ((ws-rate-premium - cp-calc-premium) > 9.99)
  4252           move 'Z'              to cp-return-code
  4253        end-if
  4254     end-if
  4255**==============================================================**
  4256**                                                              **
  4257** The below code will change as we add more states and forms   **
  4258** to this process.                                             **
  4259**                                                              **
  4260**==============================================================**
  4261*    if ws-rate-benefit-type = 'L'
  4262*       move cp-original-benefit to ws-max-benefit
  4263*    else
  4264*       compute ws-max-benefit =
  4265*          cp-original-term * cp-original-benefit
  4266*    end-if
  4267     if ws-rate-benefit-type = 'L'
  4268        move cp-r-max-tot-ben    to ws-max-benefit
  4269     else
  4270        move cp-r-max-mon-ben    to ws-max-benefit
  4271     end-if
  4272     .
  4273 0030-exit.
  4274     exit.
  4275 0040-format-buffer.
  4276     move spaces                 to ws-return-string
  4277     perform 0045-format-error   thru 0045-exit
  4278     move ';'                    to ws-sc1
  4279                                    ws-sc2
  4280                                    ws-sc3
  4281                                    ws-sc4
  4282                                    ws-sc5
  4283                                    ws-sc6
  4284                                    ws-sc7
  4285     if no-cp-error
  4286        if ws-contract-suffix = spaces or low-values
  4287           move ws-contract-no   to ws-return-contract-no (2:10)
  4288        else
  4289           move ws-contract-no   to ws-return-contract-no (1:10)
  4290           move ws-contract-suffix
  4291                                 to ws-return-contract-no (11:1)
  4292        end-if
  4293        move cp-calc-premium     to ws-return-prem
  4294        move cp-premium-rate     to ws-return-rate
  4295        move ws-max-benefit      to ws-return-max-ben
  4296        move ws-exp-date         to ws-return-exp-dt
  4297        move ws-rate-benefit-cd  to ws-return-benefit-cd
  4298     else
  4299        set error-in-one-coverage to true
  4300        move spaces              to ws-contract-no
  4301                                    ws-contract-suffix
  4302     end-if
  4303     .
  4304 0040-exit.
  4305     exit.
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  76
* WSMESS01.cbl
  4306 0045-format-error.
  4307     evaluate true
  4308        when cp-return-code = '0'
  4309           move +1               to s1
  4310        when cp-return-code = '1'
  4311           move +2               to s1
  4312        when cp-return-code = '2'
  4313           move +3               to s1
  4314        when cp-return-code = 'A'
  4315           move +4               to s1
  4316        when cp-return-code = 'B'
  4317           move +5               to s1
  4318        when cp-return-code = '4'
  4319           move +6               to s1
  4320        when cp-return-code = '9'
  4321           move +7               to s1
  4322        when cp-return-code = '8'
  4323           move +8               to s1
  4324        when cp-return-code = 'H'
  4325           move +9               to s1
  4326        when cp-return-code = 'C'
  4327           move +10              to s1
  4328        when cp-return-code = '7'
  4329           move +11              to s1
  4330        when cp-return-code = '6'
  4331           move +12              to s1
  4332        when cp-return-code = 'D'
  4333           move +13              to s1
  4334        when cp-return-code = 'Z'
  4335           move +14              to s1
  4336           move cp-calc-premium  to ws-return-prem
  4337           move cp-premium-rate  to ws-return-rate
  4338           move ws-max-benefit   to ws-return-max-ben
  4339           move ws-exp-date      to ws-return-exp-dt
  4340           move ws-rate-benefit-cd to ws-return-benefit-cd
  4341        when cp-return-code = 'Y'
  4342           move +15              to s1
  4343           move cp-calc-premium  to ws-return-prem
  4344           move cp-premium-rate  to ws-return-rate
  4345           move ws-max-benefit   to ws-return-max-ben
  4346           move ws-exp-date      to ws-return-exp-dt
  4347           move ws-rate-benefit-cd to ws-return-benefit-cd
  4348     end-evaluate
  4349     move ws-table-error-no (s1) to ws-return-error-no
  4350     move ws-table-error-mess (s1)
  4351                                 to ws-return-error-mess
  4352     .
  4353 0045-exit.
  4354     exit.
  4355 0050-get-account.
  4356     move ws-comp-cd             to ws-am-company-cd
  4357     move '9'                    to ws-am-carrier
  4358     move '000000'               to ws-am-group
  4359     move ws-rate-state          to ws-am-state
  4360     move ws-rate-acct-no        to ws-am-account
  4361     move ws-bin-eff-dt          to ws-am-exp-dt
  4362
  4363* exec cics read
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  77
* WSMESS01.cbl
  4364*       dataset      ('ERACCT')
  4365*       ridfld       (ws-am-key)
  4366*       into         (account-master)
  4367*       GTEQ
  4368*       resp         (ws-response)
  4369*    end-exec
  4370     MOVE LENGTH OF
  4371      account-master
  4372       TO DFHEIV11
  4373     MOVE 'ERACCT' TO DFHEIV1
  4374*    MOVE '&"IL       G          (  N#00004265' TO DFHEIV0
  4375     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  4376     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4377     MOVE X'204E233030303034323635' TO DFHEIV0(25:11)
  4378     CALL 'kxdfhei1' USING DFHEIV0,
  4379           DFHEIV1,
  4380           account-master,
  4381           DFHEIV11,
  4382           ws-am-key,
  4383           DFHEIV99,
  4384           DFHEIV99,
  4385           DFHEIV99
  4386     MOVE EIBRESP  TO ws-response
  4387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4388     if resp-normal
  4389        and (ws-comp-cd = am-company-cd)
  4390        and (ws-rate-state = am-state)
  4391        and (ws-rate-acct-no = am-account)
  4392        and (ws-bin-eff-dt >= am-effective-dt)
  4393        and (ws-bin-eff-dt < am-expiration-dt)
  4394        continue
  4395     else
  4396        move '0114;No account mstr found ' to ws-return-string
  4397        go to 0300-RETURN-CICS
  4398     end-if
  4399     .
  4400 0050-exit.
  4401     exit.
  4402 0060-check-for-dup.
  4403**==============================================================**
  4404**                                                              **
  4405**    All i'm going to do here is check for a dup using         **
  4406**  the state, account, eff dt and last six of vin and a space  **
  4407**  in the cert suffix. If I do find one then I will have to    **
  4408**  find the last suffix and use the next available one in the  **
  4409**  suffix table.                                               **
  4410**                                                              **
  4411**==============================================================**
  4412     move +1                     to x1
  4413     move ' '                    to ws-browse-sw
  4414     move ws-comp-cd             to ws-cm-key
  4415     move '9'                    to ws-cm-carrier
  4416     move '000000'               to ws-cm-group
  4417     move ws-rate-state          to ws-cm-state
  4418     move ws-rate-acct-no        to ws-cm-account
  4419     move ws-bin-eff-dt          to ws-cm-eff-dt
  4420     string
  4421        '0000'
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  78
* WSMESS01.cbl
  4422        ws-rate-vin (12:6)
  4423        ' ' delimited by size into ws-cm-cert-no
  4424     end-string
  4425     move ws-cm-key              to ws-cm-compare-key
  4426     move ws-cm-cert-ten         to ws-contract-no
  4427     move low-values             to ws-last-suffix
  4428     display ' about to startbr ' ws-cm-key (2:19) ' '
  4429        ws-rate-eff-date  ' ' ws-cm-key (23:11)
  4430
  4431* exec cics startbr
  4432*       dataset      ('ELCERT')
  4433*       ridfld       (ws-cm-key)
  4434*       gteq
  4435*       resp         (ws-response)
  4436*    end-exec
  4437     MOVE 'ELCERT' TO DFHEIV1
  4438     MOVE 0
  4439       TO DFHEIV11
  4440*    MOVE '&,         G          &  N#00004314' TO DFHEIV0
  4441     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4442     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4443     MOVE X'204E233030303034333134' TO DFHEIV0(25:11)
  4444     CALL 'kxdfhei1' USING DFHEIV0,
  4445           DFHEIV1,
  4446           ws-cm-key,
  4447           DFHEIV99,
  4448           DFHEIV11,
  4449           DFHEIV99
  4450     MOVE EIBRESP  TO ws-response
  4451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4452     evaluate true
  4453        when resp-normal
  4454           set browse-started to true
  4455        when resp-notfnd or resp-endfile
  4456           set i-say-stop to true
  4457        when other
  4458           move ws-response to ws-disp-resp
  4459           string
  4460              '9999' ';'
  4461              'Bad elcert startbr ' ';'
  4462              ws-disp-resp delimited by size
  4463                                 into ws-return-string
  4464           end-string
  4465           display ' something went wrong with start br '
  4466              ws-response
  4467           go to 0300-RETURN-CICS
  4468     end-evaluate
  4469     perform until i-say-stop
  4470
  4471* exec cics readnext
  4472*          dataset      ('ELCERT')
  4473*          ridfld       (ws-cm-key)
  4474*          into         (certificate-master)
  4475*          resp         (ws-response)
  4476*       end-exec
  4477     MOVE LENGTH OF
  4478      certificate-master
  4479       TO DFHEIV12
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  79
* WSMESS01.cbl
  4480     MOVE 'ELCERT' TO DFHEIV1
  4481     MOVE 0
  4482       TO DFHEIV11
  4483*    MOVE '&.IL                  )  N#00004338' TO DFHEIV0
  4484     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4485     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4486     MOVE X'204E233030303034333338' TO DFHEIV0(25:11)
  4487     CALL 'kxdfhei1' USING DFHEIV0,
  4488           DFHEIV1,
  4489           certificate-master,
  4490           DFHEIV12,
  4491           ws-cm-key,
  4492           DFHEIV99,
  4493           DFHEIV11,
  4494           DFHEIV99,
  4495           DFHEIV99
  4496     MOVE EIBRESP  TO ws-response
  4497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4498        if resp-normal
  4499           if ws-cm-key (1:32) = ws-cm-compare-key (1:32)
  4500              move ws-cm-cert-suffix
  4501                                 to ws-last-suffix
  4502           else
  4503              set i-say-stop to true
  4504           end-if
  4505        else
  4506           set i-say-stop to true
  4507        end-if
  4508     end-perform
  4509     if browse-started
  4510
  4511* exec cics endbr
  4512*          dataset   ('ELCERT')
  4513*       END-EXEC
  4514     MOVE 'ELCERT' TO DFHEIV1
  4515     MOVE 0
  4516       TO DFHEIV11
  4517*    MOVE '&2                    $   #00004356' TO DFHEIV0
  4518     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4519     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4520     MOVE X'2020233030303034333536' TO DFHEIV0(25:11)
  4521     CALL 'kxdfhei1' USING DFHEIV0,
  4522           DFHEIV1,
  4523           DFHEIV11,
  4524           DFHEIV99
  4525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4526     end-if
  4527     if ws-last-suffix not = low-values
  4528        perform varying x1 from +1 by +1 until
  4529           (x1 > +26)
  4530           or (ws-last-suffix = ws-suffix-value (x1))
  4531        end-perform
  4532        if x1 < +27
  4533           move ws-suffix-value (x1 + 1)
  4534                                 to ws-contract-suffix
  4535        else
  4536           MOVE 'BLEW SUFFIX TABLE ' to ws-return-string
  4537           display ' more than 26 suffix codes ' ws-last-suffix
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  80
* WSMESS01.cbl
  4538           go to 0300-RETURN-CICS
  4539        end-if
  4540     end-if
  4541     .
  4542 0060-exit.
  4543     exit.
  4544 0070-open-cursor.
  4545*    display ' declare cursor ' ws-begin-dt ' ' ws-end-dt
  4546***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  4547***                                                            ***
  4548***  The dates on the sql table have values in the time        ***
  4549***  so I convert it to a string and just use mm/dd/yyyy       ***
  4550***  to perform the comparison.                                ***
  4551***                                                            ***
  4552***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  4553     if not connected-to-db
  4554        perform 6000-connect-to-db thru 6000-exit
  4555     end-if
  4556     move ws-rate-state          to ws-dealer-state
  4557     move ws-rate-acct-no        to ws-dealer-id
  4558     move ws-rate-eff-date       to ws-contract-eff-dt
  4559     move zeros                  to ws-ks-contract-no
  4560     move ws-rate-vin (12:6)     to ws-ks-contract-no (5:6)
  4561     EXEC SQL
  4562        DECLARE
  4563           contracts cursor for
  4564        SELECT
  4565           DlrState,
  4566           DlrId,
  4567           EffDt,
  4568           ContractNo,
  4569           ContractSuffix
  4570        FROM
  4571           PendingContracts
  4572        WHERE
  4573           DlrState     = :ws-dealer-state
  4574           and DlrId    = :ws-dealer-id
  4575           and EffDt    = :ws-contract-eff-dt
  4576           and ContractNo  = :ws-ks-contract-no
  4577        ORDER BY
  4578           dlrstate,
  4579           dlrid,
  4580           effdt,
  4581           contractno,
  4582           contractsuffix
  4583     end-exec
  4584     if sqlcode not = 0
  4585        display "Error: cannot declare cursor "
  4586        display ' sql retrun code ' sqlcode
  4587        display ' sql err mess    ' sqlerrmc
  4588        go to 0070-exit
  4589     end-if
  4590     EXEC SQL
  4591        open contracts
  4592     END-EXEC
  4593     if sqlcode not = 0
  4594        display "Error: cannot open cursor "
  4595        display ' sql retrun code ' sqlcode
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  81
* WSMESS01.cbl
  4596        display ' sql err mess    ' sqlerrmc
  4597        go to 0070-exit
  4598     end-if
  4599     .
  4600 0070-exit.
  4601     exit.
  4602 0080-process-input.
  4603     perform until sqlcode not = 0
  4604        EXEC SQL
  4605           fetch contracts into
  4606              :sql-dlr-state,
  4607              :sql-dlr-id,
  4608              :sql-eff-dt,
  4609              :sql-contr-no,
  4610              :sql-contr-suffix
  4611        END-EXEC
  4612        if sqlcode = 0
  4613           display ' got a hit ' sql-contr-no ' '
  4614              sql-contr-suffix
  4615           move sql-contr-suffix to ws-tbl-last-suffix
  4616        else
  4617           if sqlcode not = 0 and 100
  4618              display "Error: cannot fetch row "
  4619              display ' sql return code ' sqlcode
  4620              display ' sql err mess    ' sqlerrmc
  4621           end-if
  4622        end-if
  4623     end-perform
  4624     if ws-tbl-last-suffix = low-values
  4625        display ' tbl last suffix = LV '
  4626     else
  4627        if ws-tbl-last-suffix = spaces
  4628           display ' tbl last suffix = SPACES '
  4629        else
  4630           display ' tbl last suffix = ' ws-tbl-last-suffix
  4631        end-if
  4632     end-if
  4633     if ws-last-suffix = low-values
  4634        display ' last suffix = LV '
  4635     else
  4636        if ws-last-suffix = spaces
  4637           display ' last suffix = SPACES '
  4638        else
  4639           display ' last suffix = ' ws-last-suffix
  4640        end-if
  4641     end-if
  4642     if sqlcode = 100
  4643        display ' Normal end of record set '
  4644     end-if
  4645     if ws-tbl-last-suffix not = low-values
  4646        and (ws-tbl-last-suffix > ws-last-suffix)
  4647        perform varying x1 from +1 by +1 until
  4648           (x1 > +26)
  4649           or (ws-tbl-last-suffix = ws-suffix-value (x1))
  4650        end-perform
  4651        if x1 < +27
  4652           move ws-suffix-value (x1 + 1)
  4653                                 to ws-contract-suffix
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  82
* WSMESS01.cbl
  4654        else
  4655           MOVE 'BLEW SUFFIX TABLE ' to ws-return-string
  4656           display ' more than 26 suffix codes ' ws-last-suffix
  4657           go to 0300-RETURN-CICS
  4658        end-if
  4659     end-if
  4660     EXEC SQL
  4661         close contracts
  4662     END-EXEC
  4663     if sqlcode not = 0
  4664        display "Error: cannot close cursor "
  4665        display ' sql retrun code ' sqlcode
  4666        display ' sql err mess    ' sqlerrmc
  4667     end-if
  4668     .
  4669 0080-exit.
  4670     exit.
  4671 0100-process-message.
  4672     perform 0110-unstring       thru 0110-exit
  4673     perform 0120-format-message thru 0120-exit
  4674     perform 0020-edit-received  thru 0020-exit
  4675     perform 0025-assign-ben-cd  thru 0025-exit
  4676     perform 0030-get-rate       thru 0030-exit
  4677     if (contract-no-assigned)
  4678            or
  4679        (error-in-one-coverage)
  4680        continue
  4681     else
  4682        perform 0060-check-for-dup
  4683                                 thru 0060-exit
  4684        perform 0070-open-cursor thru 0070-exit
  4685        perform 0080-process-input
  4686                                 thru 0080-exit
  4687     end-if
  4688     perform 0040-format-buffer  thru 0040-exit
  4689     set contract-no-assigned to true
  4690     .
  4691 0100-exit.
  4692     exit.
  4693 0110-unstring.
  4694***____________________________________________________________***
  4695**|                                                            |**
  4696**|    Unstring the raw data into data elements                |**
  4697**|                                                            |**
  4698***____________________________________________________________***
  4699        unstring dfhcommarea
  4700           delimited by '|' into
  4701              raw-message-num
  4702              raw-state
  4703              raw-acct-no
  4704              raw-vin
  4705              raw-lf-ah
  4706              raw-ben-code
  4707              raw-earn-meth
  4708              raw-pri-birth-date
  4709              raw-cob-birth-date
  4710              raw-benefit
  4711              raw-eff-date
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  83
* WSMESS01.cbl
  4712              raw-1st-pmt-dt
  4713              raw-premium
  4714              raw-loan-term
  4715              raw-ins-term
  4716              raw-apr
  4717              raw-sin-jnt-ind
  4718              raw-dismemberment
  4719              raw-retro-elim
  4720              raw-waiting-days
  4721              raw-crit-per
  4722              raw-total-payments
  4723              raw-period-payment
  4724        end-unstring
  4725     display ' made 0110 ' raw-total-payments ' '
  4726     raw-period-payment
  4727     .
  4728 0110-exit.
  4729     exit.
  4730 0120-format-message.
  4731***____________________________________________________________***
  4732**|                                                            |**
  4733**|    Format each data element to be consistant with          |**
  4734**|  COBOL rate copybook model                                 |**
  4735**|                                                            |**
  4736***____________________________________________________________***
  4737     inspect
  4738        raw-acct-no replacing leading spaces by zeros
  4739     inspect
  4740        raw-loan-term replacing leading spaces by zeros
  4741     inspect
  4742        raw-ins-term replacing leading spaces by zeros
  4743     inspect
  4744        raw-waiting-days replacing leading spaces by zeros
  4745     inspect
  4746        raw-crit-per replacing leading spaces by zeros
  4747     inspect
  4748        raw-benefit replacing all spaces by zeros
  4749     inspect
  4750        raw-premium replacing all spaces by zeros
  4751     inspect
  4752        raw-apr replacing all spaces by zeros
  4753     inspect
  4754        raw-total-payments replacing all spaces by zeros
  4755     inspect
  4756        raw-period-payment replacing all spaces by zeros
  4757     move raw-benefit            to ws-work-in
  4758     perform 0130-format-amt     thru 0130-exit
  4759     move ws-work-out-v2         to ws-rate-benefit
  4760     display ' ben  in *' ws-work-in '*'
  4761     display ' ben  out *' ws-work-out '*'
  4762     move raw-total-payments     to ws-work-in
  4763     perform 0130-format-amt     thru 0130-exit
  4764     move ws-work-out-v2         to ws-rate-tot-pmts
  4765     display ' tot pmts  in *' ws-work-in '*'
  4766     display ' tot pmts  out *' ws-work-out '*'
  4767     move raw-premium            to ws-work-in
  4768     perform 0130-format-amt     thru 0130-exit
  4769     move ws-work-out-v2         to ws-rate-premium
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  84
* WSMESS01.cbl
  4770     display ' prem in *' ws-work-in '*'
  4771     display ' prem out *' ws-work-out '*'
  4772     move raw-period-payment     to ws-work-in
  4773     perform 0130-format-amt     thru 0130-exit
  4774     move ws-work-out-v2         to ws-rate-payment
  4775     display ' pmt  in *' ws-work-in '*'
  4776     display ' pmt  out *' ws-work-out '*'
  4777     move raw-loan-term          to ws-work-in
  4778     perform 0140-format-term    thru 0140-exit
  4779     move ws-work-out-v0         to ws-rate-loan-term
  4780     display ' rate loan term *' ws-rate-loan-term '*'
  4781     display ' ln term in *' ws-work-in '*'
  4782     display ' ln term out *' ws-work-out '*'
  4783     move raw-ins-term           to ws-work-in
  4784     perform 0140-format-term    thru 0140-exit
  4785     move ws-work-out-v0         to ws-rate-ins-term
  4786     display ' rate ins  term *' ws-rate-ins-term '*'
  4787     display ' ins term in *' ws-work-in '*'
  4788     display ' ins term out *' ws-work-out '*'
  4789     move raw-waiting-days       to ws-work-in
  4790     perform 0140-format-term    thru 0140-exit
  4791     move ws-work-out-v0         to ws-rate-waiting-days
  4792     display ' wait day in *' ws-work-in '*'
  4793     display ' wait day out *' ws-work-out '*'
  4794     move raw-crit-per           to ws-work-in
  4795     perform 0140-format-term    thru 0140-exit
  4796     move ws-work-out-v0         to ws-rate-crit-per
  4797     display ' crit per in *' ws-work-in '*'
  4798     display ' crit per out *' ws-work-out '*'
  4799     move raw-apr                to ws-work-in
  4800     perform 0150-format-apr     thru 0150-exit
  4801     move ws-work-out-v5         to ws-rate-apr
  4802     display ' ins apr  in *' ws-work-in '*'
  4803     display ' ins apr  out *' ws-work-out '*'
  4804     move raw-state              to ws-rate-state
  4805     move raw-acct-no            to ws-rate-acct-no
  4806     move raw-vin                to ws-rate-vin
  4807     move raw-lf-ah              to ws-rate-lf-ah
  4808     move raw-ben-code           to ws-rate-ben-code
  4809     move raw-earn-meth          to ws-rate-earn-meth
  4810     move raw-pri-birth-date     to ws-rate-pri-birth-date
  4811     move raw-cob-birth-date     to ws-rate-cob-birth-date
  4812     move raw-eff-date           to ws-rate-eff-date
  4813     move raw-1st-pmt-dt         to ws-rate-1st-pmt-dt
  4814     move raw-sin-jnt-ind        to ws-rate-sin-jnt-ind
  4815     move raw-dismemberment      to ws-rate-dismemberment
  4816     move raw-retro-elim         to ws-rate-retro-elim
  4817     .
  4818 0120-exit.
  4819     exit.
  4820 0130-format-amt.
  4821     move zeros                  to ws-work-out
  4822     perform varying s2 from +10 by -1 until
  4823        (s2 < +1)
  4824        or (ws-work-in (s2:1) = '.')
  4825     end-perform
  4826     if s2 < +9
  4827        move ws-work-in (s2 + 1:2)
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  85
* WSMESS01.cbl
  4828                              to ws-work-out (9:2)
  4829        move +8               to s3
  4830        subtract +1 from s2
  4831        perform varying s2 from s2 by -1 until
  4832           (s2 < +1)
  4833           or (s3 = 0)
  4834           move ws-work-in (s2:1) to ws-work-out (s3:1)
  4835           subtract +1 from s3
  4836        end-perform
  4837     end-if
  4838     .
  4839 0130-exit.
  4840     exit.
  4841 0140-format-term.
  4842     move zeros                  to ws-work-out
  4843     perform varying s2 from +10 by -1 until
  4844        (s2 < +1)
  4845        or (ws-work-in (s2:1) numeric)
  4846     end-perform
  4847     if s2 > +0
  4848        move ws-work-in (s2:1)
  4849                              to ws-work-out (10:1)
  4850        move +9               to s3
  4851        subtract +1 from s2
  4852        perform varying s2 from s2 by -1 until
  4853           (s2 < +1)
  4854           or (s3 = 7)
  4855           move ws-work-in (s2:1) to ws-work-out (s3:1)
  4856           subtract +1 from s3
  4857        end-perform
  4858     end-if
  4859     .
  4860 0140-exit.
  4861     exit.
  4862 0150-format-apr.
  4863     move zeros                  to ws-work-out
  4864     perform varying s2 from +10 by -1 until
  4865        (s2 < +1)
  4866        or (ws-work-in (s2:1) = '.')
  4867     end-perform
  4868     if s2 < +5
  4869        move ws-work-in (s2 + 1:5)
  4870                              to ws-work-out (6:5)
  4871        move +5               to s3
  4872        subtract +1 from s2
  4873        perform varying s2 from s2 by -1 until
  4874           (s2 < +1)
  4875           or (s3 = 0)
  4876           move ws-work-in (s2:1) to ws-work-out (s3:1)
  4877           subtract +1 from s3
  4878        end-perform
  4879     end-if
  4880     .
  4881 0150-exit.
  4882     exit.
  4883 0300-RETURN-CICS.
  4884     move ws-return-string       to dfhcommarea
  4885
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  86
* WSMESS01.cbl
  4886* exec cics return end-exec
  4887*    MOVE '.(                    ''   #00004718' TO DFHEIV0
  4888     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4889     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4890     MOVE X'2020233030303034373138' TO DFHEIV0(25:11)
  4891     CALL 'kxdfhei1' USING DFHEIV0,
  4892           DFHEIV99,
  4893           DFHEIV99,
  4894           DFHEIV99,
  4895           DFHEIV99,
  4896           DFHEIV99,
  4897           DFHEIV99
  4898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4899
  4900* goback
  4901
  4902     MOVE '9%                    "   ' TO DFHEIV0
  4903     MOVE 'WSMESS01' TO DFHEIV1
  4904     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4905     goback
  4906     .
  4907 0300-exit.
  4908     exit.
  4909 6000-CONNECT-TO-DB.
  4910***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  4911***                                                            ***
  4912***                                                            ***
  4913***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  4914     evaluate true
  4915        when ws-kix-myenv = 'cid1p'
  4916           MOVE 'NTCSO2_CrtManage'
  4917                                 TO SVR
  4918           move 'sa'             to usr
  4919           move 'ntcso2'         to pass
  4920        when ws-kix-myenv = 'mdoff'
  4921           MOVE 'NTSQLTST2UAT_CrtManage'
  4922                                 TO SVR
  4923           move 'sa'             to usr
  4924           move 'sql2008r2'      to pass
  4925        when other
  4926           MOVE 'NTSQLTST2_CrtManage'
  4927                                 TO SVR
  4928           move 'sa'             to usr
  4929           move 'sql2008r2'      to pass
  4930     end-evaluate
  4931     string
  4932         usr delimited space
  4933         "." delimited size
  4934         pass delimited space into usr-pass
  4935     end-string
  4936     display ' About to connect to ' svr ' ' usr-pass
  4937     EXEC SQL
  4938        CONNECT TO :svr USER :usr-pass
  4939     END-EXEC
  4940     if sqlcode not = 0
  4941        display "Error: cannot connect to " svr
  4942        display sqlcode
  4943        display sqlerrmc
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  87
* WSMESS01.cbl
  4944     else
  4945        display ' Successful Connect ' sqlcode
  4946        set connected-to-db to true
  4947     end-if
  4948     .
  4949 6000-EXIT.
  4950     EXIT.
  4951 7000-GET-RATE.
  4952
  4953* EXEC CICS LINK
  4954*       PROGRAM ('ELRATE')
  4955*       COMMAREA (CALCULATION-PASS-AREA)
  4956*       LENGTH   (CP-COMM-LENGTH)
  4957*    END-EXEC
  4958     MOVE 'ELRATE' TO DFHEIV1
  4959*    MOVE '."C                   (   #00004766' TO DFHEIV0
  4960     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4961     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4962     MOVE X'2020233030303034373636' TO DFHEIV0(25:11)
  4963     CALL 'kxdfhei1' USING DFHEIV0,
  4964           DFHEIV1,
  4965           CALCULATION-PASS-AREA,
  4966           CP-COMM-LENGTH,
  4967           DFHEIV99,
  4968           DFHEIV99,
  4969           DFHEIV99,
  4970           DFHEIV99
  4971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4972     .
  4973 7000-EXIT.
  4974     EXIT.
  4975 9700-DATE-LINK.
  4976
  4977* EXEC CICS LINK
  4978*         PROGRAM  ('ELDATCV')
  4979*         COMMAREA (DATE-CONVERSION-DATA)
  4980*         LENGTH   (DC-COMM-LENGTH)
  4981*    END-EXEC.
  4982     MOVE 'ELDATCV' TO DFHEIV1
  4983*    MOVE '."C                   (   #00004775' TO DFHEIV0
  4984     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4985     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4986     MOVE X'2020233030303034373735' TO DFHEIV0(25:11)
  4987     CALL 'kxdfhei1' USING DFHEIV0,
  4988           DFHEIV1,
  4989           DATE-CONVERSION-DATA,
  4990           DC-COMM-LENGTH,
  4991           DFHEIV99,
  4992           DFHEIV99,
  4993           DFHEIV99,
  4994           DFHEIV99
  4995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4996
  4997 9700-EXIT.
  4998      EXIT.
  4999
  5000 9999-DFHBACK SECTION.
  5001     MOVE '9%                    "   ' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-Aug-17 09:02 Page  88
* WSMESS01.cbl
  5002     MOVE 'WSMESS01' TO DFHEIV1
  5003     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5004     GOBACK.
  5005 9999-DFHEXIT.
  5006     IF DFHEIGDJ EQUAL 0001
  5007         NEXT SENTENCE.
  5008     MOVE '9%                    "   ' TO DFHEIV0
  5009     MOVE 'WSMESS01' TO DFHEIV1
  5010     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5011     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      144644     Code:       11503
