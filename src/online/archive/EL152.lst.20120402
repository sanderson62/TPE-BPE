* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page   1
* EL152.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL152.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL152.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL152 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/14/94 08:03:40.
     7*                            VMOD=2.055.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*REMARKS.    TRANSACTION - EX27 - CLAIMS LETTER WRITER.
    13
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page   2
* EL152.cbl
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23*                                REMOVE OBSOLETE CODE
    24* 102703                   SMVA  MOD COPY MEMBER ELCNAMET TO LEAVE
    25*                                CERTIFICATION DESIGNATION ON
    26*                                PROCESSOR NAME LINE IN CAPS
    27* 121203                   SMVA  ADD PROCESSING FOR NEW CLM TYP G
    28* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
    29* 042605    2005042100002  PEMA  FIX TEMP STORAGE PROBLEMS
    30* 010407    2006111300003  PEMA  ADD PROCESSING FOR CARRIER 8
    31* 060109  CR2008102800002  PEMA  ADD VAR 16.1
    32* 033110  CR2009122800001  AJRA  NAPERSOFT
    33* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
    34* 011212  IR2012011100002  AJRA  FIX DCC PROMPT LETTER
    35******************************************************************
    36 ENVIRONMENT DIVISION.
    37
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page   3
* EL152.cbl
    39 DATA DIVISION.
    40 WORKING-STORAGE SECTION.
    41 01  DFH-START PIC X(04).
    42 77  FILLER  PIC X(32)  VALUE '********************************'.
    43 77  FILLER  PIC X(32)  VALUE '*    EL152 WORKING STORAGE     *'.
    44 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    45
    46*77  LCP-WS-ADDR-COMP              PIC S9(8) COMP.
    47*77  LCP-WS-ADDR-PNTR REDEFINES LCP-WS-ADDR-COMP
    48*                                  USAGE POINTER.
    49 77  LCP-WS-ADDR-COMP              PIC x(4) comp-5 value 0.
    50 77  LCP-WS-ADDR-PNTR REDEFINES LCP-WS-ADDR-COMP
    51                                   USAGE POINTER.
    52 77  B1                          PIC S9(5) COMP-3 VALUE +0.
    53 77  S1                          PIC S9 VALUE +0.
    54 77  S2                          PIC S9 VALUE +0.
    55 01  P pointer.
    56 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    57 01  var-ptr pointer.
    58 01  env-var-len                 pic 9(4)  binary.
    59 01  rc                          pic 9(9)  binary.
    60 01  WS-KIXSYS.
    61     05  WS-KIX-FIL1             PIC X(10).
    62     05  WS-KIX-APPS             PIC X(10).
    63     05  WS-KIX-ENV              PIC X(10).
    64     05  WS-KIX-MYENV            PIC X(10).
    65     05  WS-KIX-SYS              PIC X(10).
    66 01  WS-HOLDING-ZIPS.
    67     05  FILLER              PIC X(10)  VALUE '--AM-ZIP--'.
    68     05  WS-AM-ZIP           PIC X(9)   VALUE 'XXXXXXXXX'.
    69     05  FILLER              PIC X(10)  VALUE '--AT-ZIP--'.
    70     05  WS-AT-ZIP           PIC X(9)   VALUE 'XXXXXXXXX'.
    71     05  FILLER              PIC X(10)  VALUE '--BE-ZIP--'.
    72     05  WS-BE-ZIP-CODE      PIC X(9)   VALUE 'XXXXXXXXX'.
    73     05  FILLER              PIC X(10)  VALUE '--CO-ZIP--'.
    74     05  WS-CO-ZIP           PIC X(9)   VALUE 'XXXXXXXXX'.
    75     05  FILLER              PIC X(17)  VALUE '--AM-ZIP-BEFORE--'.
    76     05  WS-AM-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    77     05  FILLER              PIC X(17)  VALUE '--AT-ZIP-BEFORE--'.
    78     05  WS-AT-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    79     05  FILLER              PIC X(17)  VALUE '--BE-ZIP-BEFORE--'.
    80     05  WS-BE-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    81     05  FILLER              PIC X(17)  VALUE '--CO-ZIP-BEFORE--'.
    82     05  WS-CO-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    83     05  FILLER              PIC X(17)  VALUE '-----------------'.
    84
    85*                            COPY ELCSCTM.
    86******************************************************************
    87*                                                                *
    88*                                                                *
    89*                            ELCSCTM                             *
    90*                            VMOD=2.001                          *
    91*                                                                *
    92*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    93*                                                                *
    94******************************************************************
    95 01  SECURITY-MESSAGE.
    96     12  FILLER                          PIC X(30)
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page   4
* EL152.cbl
    97            VALUE '** LOGIC SECURITY VIOLATION -'.
    98     12  SM-READ                         PIC X(6).
    99     12  FILLER                          PIC X(5)
   100            VALUE ' PGM='.
   101     12  SM-PGM                          PIC X(6).
   102     12  FILLER                          PIC X(5)
   103            VALUE ' OPR='.
   104     12  SM-PROCESSOR-ID                 PIC X(4).
   105     12  FILLER                          PIC X(6)
   106            VALUE ' TERM='.
   107     12  SM-TERMID                       PIC X(4).
   108     12  FILLER                          PIC XX   VALUE SPACE.
   109     12  SM-JUL-DATE                     PIC 9(5).
   110     12  FILLER                          PIC X    VALUE SPACE.
   111     12  SM-TIME                         PIC 99.99.
   112
   113
   114*                            COPY ELCSCRTY.
   115******************************************************************
   116*                                                                *
   117*                                                                *
   118*                            ELCSCRTY                            *
   119*                            VMOD=2.001                          *
   120*                                                                *
   121*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   122*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   123*        SAVED IN PI-SECURITY-ADDRESS.                           *
   124*                                                                *
   125******************************************************************
   126 01  SECURITY-CONTROL.
   127     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   128     12  FILLER                       PIC XX    VALUE 'SC'.
   129     12  SC-CREDIT-CODES.
   130         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   131             20  SC-CREDIT-DISPLAY    PIC X.
   132             20  SC-CREDIT-UPDATE     PIC X.
   133     12  SC-CLAIMS-CODES.
   134         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   135             20  SC-CLAIMS-DISPLAY    PIC X.
   136             20  SC-CLAIMS-UPDATE     PIC X.
   137
   138 01  WS-DATE-AREA.
   139     12  SAVE-DATE               PIC X(08)    VALUE SPACES.
   140     12  SAVE-BIN-DATE           PIC XX       VALUE SPACES.
   141     12  W-REVERSE-DATE-SW       PIC X        VALUE SPACES.
   142         88  W-REVERSE-DATE                   VALUE 'Y'.
   143     12  W-EDIT-DATE-1.
   144         16  W-ED1-MM            PIC XX.
   145         16  FILLER              PIC X        VALUE '/'.
   146         16  W-ED1-DD            PIC XX.
   147         16  FILLER              PIC X        VALUE '/'.
   148         16  W-ED1-YY            PIC XX.
   149     12  W-EDIT-DATE-2.
   150         16  W-ED2-DD            PIC XX.
   151         16  FILLER              PIC X        VALUE '/'.
   152         16  W-ED2-MM            PIC XX.
   153         16  FILLER              PIC X        VALUE '/'.
   154         16  W-ED2-YY            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page   5
* EL152.cbl
   155 01  FILLER.
   156     05  WS-WORK-INT-RATE        PIC 99.999.
   157     05  WS-WORK-INT REDEFINES WS-WORK-INT-RATE
   158                                 PIC X(6).
   159 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
   160     'BEGINJOB mode=''MVS'''.
   161 01  TRAN-DATA-LINE2.
   162*     05  FILLER                  PIC X(39)    VALUE
   163*     '"smtp -f EL152cl2 -t pema,kmsb,jmsb -s '.
   164     05  FILLER                  PIC X(29)    VALUE
   165     '"smtp -f EL152cl2 -t ajra -s '.
   166     05  TRAN-DETAIL.
   167         10  FILLER              PIC XX       VALUE
   168         ''' '.
   169         10  TRAN-DL2-USER       PIC X(05)    VALUE SPACES.
   170         10  TRAN-DL2-ARCHNO     PIC ZZZZ999  VALUE ZEROS.
   171         10  FILLER              PIC X        VALUE SPACES.
   172         10  TRAN-DL2-CCC        PIC X(22)    VALUE SPACES.
   173     05  FILLER                  PIC XX       VALUE '''"'.
   174     05  FILLER                  PIC X(30)    VALUE SPACES.
   175 01  TRAN-DATA-LINE3             PIC X(80)    VALUE
   176     'ENDJOB            '.
   177
   178 01  WS-PRINTER-ID               PIC X(4)    VALUE SPACES.
   179 01  STANDARD-AREAS.
   180     12  WS-ACCT-READ-SW         PIC X       VALUE ' '.
   181     12  WS-COMP-READ-SW         PIC X       VALUE ' '.
   182     12  WS-PROD-READ-SW         PIC X       VALUE ' '.
   183     12  SC-ITEM                 PIC S9(4)   VALUE +1  COMP.
   184     12  MAP-NAME.
   185         16  MAP-PREFIX          PIC XX      VALUE 'EL'.
   186         16  MAP-NUMBER          PIC X(4)    VALUE '152A'.
   187         16  MAP-FILLER          PIC XX      VALUE SPACES.
   188     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   189     12  MAPSET-NAME             PIC X(8)    VALUE 'EL152S'.
   190     12  TRANS-ID                PIC X(4)    VALUE 'EX27'.
   191     12  PRINT-TRANS             PIC X(4)    VALUE 'EX57'.
   192     12  LGXX-ID                 PIC X(4)    VALUE 'LGXX'.
   193     12  PGM-NAME                PIC X(8).
   194     12  TIME-IN                 PIC S9(7).
   195     12  TIME-OUT-R  REDEFINES TIME-IN.
   196         16  FILLER              PIC X.
   197         16  TIME-OUT            PIC 99V99.
   198         16  FILLER              PIC XX.
   199     12  XCTL-005                PIC X(5)    VALUE 'EL005'.
   200     12  XCTL-010                PIC X(5)    VALUE 'EL010'.
   201     12  XCTL-126                PIC X(5)    VALUE 'EL126'.
   202     12  LINK-001                PIC X(5)    VALUE 'EL001'.
   203     12  LINK-004                PIC X(5)    VALUE 'EL004'.
   204     12  LINK-ELDATCV            PIC X(7)    VALUE 'ELDATCV'.
   205     12  THIS-PGM                PIC X(8)    VALUE 'EL152'.
   206     12  LINK-EL1522             PIC X(8)    VALUE 'EL1522'.
   207     12  PGM-EL126               PIC X(8)    VALUE 'EL126'.
   208     12  PGM-EL150               PIC X(8)    VALUE 'EL150'.
   209     12  PGM-EL141               PIC X(8)    VALUE 'EL141'.
   210     12  PGM-EL1042              PIC X(8)    VALUE 'EL1042'.
   211     12  SUB                     PIC 99.
   212     12  WS-LABELS-SW            PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page   6
* EL152.cbl
   213
   214     12  WS-PI-QID.
   215         16  QID-TERM            PIC X(4)    VALUE SPACES.
   216         16  FILLER              PIC X(4)    VALUE '152A'.
   217
   218     12  W-LETTER-ADDRESS-TYPE.
   219         16  W-LETTER-ADDR-TYPE  PIC  X VALUE SPACES.
   220         16  W-LETTER-ADDR-SEQ   PIC  9 VALUE ZEROS.
   221
   222     12  W-ADDRESS-SELECTION.
   223         16  W-ACCOUNT           PIC  9 VALUE ZEROS.
   224         16  W-BENEFICIARY       PIC  9 VALUE ZEROS.
   225         16  W-EMPLOYER          PIC  9 VALUE ZEROS.
   226         16  W-INSURED           PIC  9 VALUE ZEROS.
   227         16  W-OTHER-1           PIC  9 VALUE ZEROS.
   228         16  W-OTHER-2           PIC  9 VALUE ZEROS.
   229         16  W-PHYSICIAN         PIC  9 VALUE ZEROS.
   230
   231     12  W-Z-CONTROL-DATA.
   232         16  W-NUMBER-OF-COPIES  PIC  9.
   233         16  FILLER              PIC  X.
   234         16  W-DAYS-TO-FOLLOW-UP PIC  999.
   235         16  FILLER              PIC  X.
   236         16  W-DAYS-TO-RESEND-1  PIC  999.
   237         16  FILLER              PIC  X.
   238         16  W-FORM-TO-RESEND    PIC  X(4).
   239         16  FILLER              PIC  X(1).
   240         16  W-PROMPT-LETTER     PIC  X(1).
   241         16  FILLER              PIC  X(1).
   242         16  W-ENCLOSURE-CD      PIC  X(3).
   243         16  FILLER              PIC  X(1).
   244         16  W-AUTO-CLOSE-IND    PIC  X(1).
   245         16  FILLER              PIC  X(1).
   246         16  W-LETTER-TO-BENE    PIC  X(1).
   247
   248     12  W-CREDIT-CARD-LOAN-NO.
   249         16  W-LOAN-NO           PIC  X(08).
   250         16  W-CURRENT-LOAN-NO   PIC  X(12).
   251
   252     12  W-GROUPING.
   253         16  W-GROUP-3           PIC  XXX.
   254         16  FILLER              PIC  XXX.
   255
   256     12  W-NAME.
   257         16  W-FIRST-NAME        PIC  X(12).
   258         16  W-MIDDLE-NAME       PIC  X(12).
   259         16  W-LAST-NAME         PIC  X(15).
   260
   261     12  WS-PHONE-IN             PIC 9(11)   VALUE ZEROS.
   262     12  WS-PHONE-IN-R  REDEFINES WS-PHONE-IN.
   263         16  FILLER              PIC 9.
   264         16  WSPI-AREA           PIC 9(3).
   265         16  WSPI-PFX            PIC 9(3).
   266         16  WSPI-SFX            PIC 9(4).
   267     12  WS-PHONE-OUT.
   268         16  WSPO-AREA           PIC X(3).
   269         16  FILLER              PIC X       VALUE '-'.
   270         16  WSPO-PFX            PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page   7
* EL152.cbl
   271         16  FILLER              PIC X       VALUE '-'.
   272         16  WSPO-SFX            PIC X(4).
   273
   274     12  WS-ZIP-NUMERIC          PIC 9(9).
   275     12  WS-ZIP-NONNUM  REDEFINES  WS-ZIP-NUMERIC
   276                                 PIC X(9).
   277
   278     12  WS-ZIP-CODE.
   279         16  WS-AM-ZIP-CODE      PIC X(5).
   280         16  WS-AM-ZIP-DASH      PIC X.
   281         16  WS-AM-ZIP-PLUS4     PIC X(4).
   282     12  WS-ZIP-CODE-CANADIAN  REDEFINES  WS-ZIP-CODE.
   283         16  WS-CAN-POSTAL-1     PIC XXX.
   284         16  FILLER              PIC X.
   285         16  WS-CAN-POSTAL-2     PIC XXX.
   286         16  FILLER              PIC XXX.
   287
   288     12  WS-LABEL-HOLD-AREA.
   289         16  WS-LABEL-LINES OCCURS 6 TIMES
   290                            INDEXED BY WS-NDX  WS-NDX2.
   291             20  WS-LABEL-ZIP.
   292                 24  WS-LABEL-1ST-ZIP  PIC X(5).
   293                 24  FILLER            PIC X.
   294                 24  WS-LABEL-2ND-ZIP  PIC X(4).
   295             20  FILLER                PIC X(9).
   296             20  WS-LAST-DIGIT         PIC X.
   297             20  WS-LAST-ZIP.
   298                 24  WS-LAST-1ST-ZIP   PIC X(5).
   299                 24  FILLER            PIC X.
   300                 24  WS-LAST-2ND-ZIP   PIC X(4).
   301
   302     12  WS-DATA-FOUND-SW            PIC X.
   303         88  NO-CHARACTERS-FOUND           VALUE 'N'.
   304
   305     12  WS-SKIP-EMAIL           PIC X       VALUE 'N'.
   306     12  WS-STATE-LINE           PIC X       VALUE 'N'.
   307     12  WS-PROCESSOR-LINE       PIC X(01)   VALUE 'N'.
   308     12  WS-CAPS-SW              PIC X(01)   VALUE 'N'.
   309         88  THE-REST-R-CAPS                 VALUE 'Y'.
   310     12  WS-POSITION2            PIC S9(4)   COMP.
   311     12  WS-POSITION21           PIC S9(4)   COMP.
   312     12  WS-WORD-LENGTH          PIC S9(4)   COMP-3.
   313
   314     12  WS-TEMP-AREA1.
   315         16  WS-TEMP-1           PIC X OCCURS 29
   316                                       INDEXED BY TA1.
   317     12  WS-TEMP-AREA2.
   318         16  WS-TEMP-2           PIC X OCCURS 30
   319                                       INDEXED BY TA2
   320                                                  TA21
   321                                                  MOVE-INDX.
   322
   323     12  WS-SAVE-TEMP-AREA2      PIC X(30)   VALUE SPACES.
   324
   325     12  ACCT-BROWSE-STARTED     PIC X       VALUE 'N'.
   326     12  TEXT-BROWSE-STARTED     PIC X       VALUE 'N'.
   327     12  ARCH-BROWSE-STARTED     PIC X       VALUE 'N'.
   328     12  ACTV-BROWSE-STARTED     PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page   8
* EL152.cbl
   329     12  PROD-BROWSE-STARTED     PIC X       VALUE 'N'.
   330     12  INDX-WORK               PIC 99.
   331     12  TEMP-CURR-LINE          PIC S9(3)    COMP-3.
   332
   333     12  DATE-WORK               PIC 9(7).
   334     12  DT-REDEF REDEFINES DATE-WORK.
   335         16  FILLER              PIC XX.
   336         16  DT-WORK             PIC 9(5).
   337
   338     12  BEN-HOLD                PIC XX.
   339
   340     12  BENEFIT-WORK            PIC XXX.
   341     12  BEN-R REDEFINES BENEFIT-WORK.
   342         16  ELIM-DAYS           PIC XX.
   343         16  FILLER              PIC X.
   344
   345     12  GETMAIN-SWITCH          PIC 9        VALUE 0.
   346         88  NO-GETMAIN-DONE-YET              VALUE 0.
   347         88  REFRESH-GETMAIN-AREA             VALUE 1.
   348
   349     12  WORK-AMOUNT             PIC S9(9)V99 VALUE +0.
   350     12  CURRENT-SAVE            PIC XX.
   351     12  CURRENT-PLUS3-SAVE      PIC XX.
   352     12  RESEND-SAVE             PIC XX    VALUE LOW-VALUE.
   353     12  FOLLOW-UP-SAVE          PIC XX    VALUE LOW-VALUE.
   354     12  SEQ-COUNTER             PIC S9(4) COMP.
   355     12  CORR-TRLR-SEQ           PIC S9(4) COMP.
   356     12  DEEDIT-FIELD            PIC X(15).
   357     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD   PIC S9(15).
   358
   359     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   360     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   361
   362     12  LOWER-CASE PIC X(26) VALUE 'abcdefghijklmnopqrstuvwxyz'.
   363     12  UPPER-CASE PIC X(26) VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
   364
   365     12  WS-CCN-12               PIC X(12).
   366
   367     12  WS-ADDR-TYPE-CD.
   368         16  WS-ADDR-TYPE        PIC X.
   369         16  WS-ADDR-SEQ         PIC X.
   370         16  WS-ADDR-SEQ-NUM REDEFINES
   371             WS-ADDR-SEQ         PIC 9.
   372
   373     12  WS-DMD-CERT-STATE       PIC XX.
   374     12  WS-DMD-CERT-GROUPING    PIC XX.
   375     12  WS-DMD-BEN-CODE         PIC XX.
   376     12  WS-DMD-CORR-TRLR-SEQ    PIC S9(4) COMP.
   377     12  WS-DMD-LETTER-FORM      PIC X(4).
   378     12  WS-DMD-RES-ST           PIC XX.
   379
   380     12  WS-DMD-UND-STATEMENT    PIC X(50)  VALUE
   381          'Central States provides plan administration for'.
   382
   383     12  WS-DMD-UND-COMPANYA     PIC X(50)  VALUE
   384          'Central States Health and Life Co.'.
   385
   386     12  WS-DMD-UND-COMPANYB     PIC X(50)  VALUE
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page   9
* EL152.cbl
   387          'Central States Indemnity Co.'.
   388
   389* DLO023
   390 01  DL23-COMM-LENGTH            PIC S9(4) COMP VALUE +132.
   391 01  WS-DLO-CODES-TABLE.
   392     12  DL23-SYSTEM-ID          PIC XX.
   393     12  DL23-RECORD-TYPE        PIC XX.
   394     12  DL23-RECORD-KEY         PIC X(6).
   395     12  DL23-RETURN-CODE        PIC XX.
   396     12  DL23-CODE-DESC          PIC X(60).
   397     12  DL23-GEN-DESC-1         PIC X(20).
   398     12  DL23-GEN-DESC-2         PIC X(20).
   399     12  DL23-GEN-DESC-3         PIC X(20).
   400     12  WS-LETTER-STATUS        PIC X        VALUE ' '.
   401     12  WS-BLANK                PIC X        VALUE ' '.
   402
   403 01  WS-SAVE-ACCT-RECORD         PIC X(2000)  VALUE SPACES.
   404 01  WS-SAVE-PRODUCER-RECORD     PIC X(2000)  VALUE SPACES.
   405
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  10
* EL152.cbl
   407 01  ACCESS-KEYS-AND-FILE-IDS.
   408     12  CNTL-ID                  PIC X(8)    VALUE 'ELCNTL'.
   409     12  ACCT-ID                  PIC X(8)    VALUE 'ERACCT'.
   410     12  CERT-ID                  PIC X(8)    VALUE 'ELCERT'.
   411     12  ARCH-ID                  PIC X(8)    VALUE 'ELARCH'.
   412     12  ARCT-ID                  PIC X(8)    VALUE 'ELARCT'.
   413     12  CLAM-ID                  PIC X(8)    VALUE 'ELMSTR'.
   414     12  TEXT-ID                  PIC X(8)    VALUE 'ELLETR'.
   415     12  ACTV-ID                  PIC X(8)    VALUE 'ELTRLR'.
   416     12  BENE-ID                  PIC X(8)    VALUE 'ELBENE'.
   417     12  PROD-ID                  PIC X(8)    VALUE 'MPPROD'.
   418     12  PLCY-ID                  PIC X(8)    VALUE 'MPPLCY'.
   419     12  PLAN-ID                  PIC X(8)    VALUE 'MPPLAN'.
   420     12  NAPS-ID                  PIC X(8)    VALUE 'ELNAPS'.
   421
   422     12  CNTL-KEY.
   423         16  CNTL-CO              PIC X(3).
   424         16  CNTL-RECORD-TYPE     PIC X       VALUE '1'.
   425         16  CNTL-GENL.
   426           18 CNTL-GEN1           PIC XX      VALUE SPACES.
   427           18 CNTL-GEN2.
   428             20 CNTL-GEN3         PIC X       VALUE SPACES.
   429             20 CNTL-GEN4         PIC X       VALUE SPACES.
   430         16  CNTL-SEQ             PIC S9(4)   VALUE +0    COMP.
   431
   432      12  WS-ERCOMP-KEY.
   433          16  WS-ERCOMP-COMPANY-CD PIC X.
   434          16  WS-ERCOMP-CARRIER    PIC X.
   435          16  WS-ERCOMP-GROUPING   PIC X(6).
   436          16  WS-ERCOMP-RESP-NO    PIC X(10).
   437          16  WS-ERCOMP-ACCOUNT    PIC X(10).
   438          16  WS-ERCOMP-TYPE       PIC X.
   439
   440     12  CLAM-KEY.
   441         16  CLAM-CO              PIC X.
   442         16  CLAM-CARRIER         PIC X.
   443         16  CLAM-CLAIM           PIC X(7).
   444         16  CLAM-CERT-NUM        PIC X(11).
   445
   446     12  TEXT-KEY.
   447         16  TEXT-PARTIAL-KEY.
   448             20  TEXT-CO          PIC X.
   449             20  TEXT-LETTER      PIC X(4).
   450         16  TEXT-FILLER          PIC X(8)    VALUE SPACES.
   451         16  TEXT-SEQ             PIC S9(4)   VALUE +0    COMP.
   452
   453     12  ACTV-KEY.
   454         16  ACTV-PARTIAL-KEY.
   455             20  ACTV-CO          PIC X.
   456             20  ACTV-CARRIER     PIC X.
   457             20  ACTV-CLAIM       PIC X(7).
   458             20  ACTV-CERT-NUM    PIC X(11).
   459         16  ACTV-SEQ             PIC S9(4)   VALUE +0    COMP.
   460
   461     12  CERT-KEY.
   462         16  CERT-CO              PIC X.
   463         16  CERT-CARRIER         PIC X.
   464         16  CERT-GROUPING        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  11
* EL152.cbl
   465         16  CERT-STATE           PIC XX.
   466         16  CERT-ACCOUNT         PIC X(10).
   467         16  CERT-EFF-DT          PIC XX.
   468         16  CERT-CERT-NUM        PIC X(11).
   469
   470     12  ACCT-KEY.
   471         16  ACCT-PARTIAL-KEY.
   472             20  ACCT-CO              PIC X.
   473             20  ACCT-CARRIER         PIC X.
   474             20  ACCT-GROUPING        PIC X(6).
   475             20  ACCT-STATE           PIC XX.
   476             20  ACCT-ACCOUNT         PIC X(10).
   477         16  ACCT-EXP-DATE            PIC XX.
   478
   479     12  ARCH-KEY.
   480         16  ARCH-PARTIAL-KEY.
   481             20  ARCH-CO          PIC X.
   482             20  ARCH-NUMBER      PIC S9(8)      COMP.
   483         16  ARCH-REC-TYPE        PIC X.
   484         16  ARCH-SEQ             PIC S9(4)      COMP VALUE +0.
   485
   486     12  BENE-KEY.
   487         16  BENE-COMP-CD         PIC X.
   488         16  BENE-REC-TYPE        PIC X.
   489         16  BENE-NUMBER.
   490             20  BENE-CREDITOR    PIC XXX.
   491             20  FILLER           PIC X(7).
   492
   493     12  PROD-KEY.
   494         16  PROD-PARTIAL-KEY.
   495             20  PROD-CO          PIC X.
   496             20  PROD-CARRIER     PIC X.
   497             20  PROD-GROUPING    PIC X(6).
   498             20  PROD-STATE       PIC XX.
   499             20  PROD-PRODUCER    PIC X(10).
   500         16  PROD-EXP-DATE        PIC XX.
   501
   502     12  PLCY-KEY.
   503         16  PLCY-CO              PIC X.
   504         16  PLCY-CARRIER         PIC X.
   505         16  PLCY-GROUPING        PIC X(06).
   506         16  PLCY-STATE           PIC XX.
   507         16  PLCY-PRODUCER        PIC X(10).
   508         16  PLCY-EFF-DT          PIC XX.
   509         16  PLCY-REFERENCE-NO    PIC X(20).
   510
   511     12  PLAN-KEY.
   512         16  PLAN-CO              PIC X.
   513         16  PLAN-CARRIER         PIC X.
   514         16  PLAN-GROUPING        PIC X(6).
   515         16  PLAN-STATE           PIC XX.
   516         16  PLAN-PRODUCER        PIC X(10).
   517         16  PLAN-CODE            PIC XX.
   518         16  PLAN-REV-NO          PIC 999.
   519
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  12
* EL152.cbl
   521     12  ARCH-SAVE-KEY           PIC X(5).
   522     12  ACTV-SAVE-KEY           PIC X(20).
   523     12  ACCT-SAVE-KEY           PIC X(20).
   524     12  PROD-SAVE-KEY           PIC X(20).
   525     12  ACCT-LENGTH             PIC S9(4)  COMP  VALUE +2000.
   526     12  ARCH-LENGTH             PIC S9(4)  COMP  VALUE +90.
   527     12  ARCT-LENGTH             PIC S9(4)  COMP  VALUE +90.
   528     12  ACTV-LENGTH             PIC S9(4)  COMP  VALUE +200.
   529     12  PROD-LENGTH             PIC S9(4)  COMP  VALUE +2000.
   530     12  NAPS-LENGTH             PIC S9(4)  COMP  VALUE +150.
   531     12  TEXT-SAVE-KEY           PIC X(5).
   532     12  SAVE-VARIABLE-POINTER   PIC S9(8)   COMP.
   533     12  VAR-HOLD.
   534         16  V1                  PIC X.
   535         16  V2                  PIC X.
   536         16  V3                  PIC X.
   537         16  V4                  PIC X.
   538     12  V-HOLD REDEFINES VAR-HOLD.
   539         16  V-NUM               PIC 99.
   540         16  V-PERIOD            PIC X.
   541         16  V-DECIMAL           PIC 9.
   542
   543     12  MAX-LINES               PIC 999     VALUE 300.
   544     12  NUM-LINES-PER-SCREEN    PIC 99      VALUE 13.
   545     12  TS-NUM-REC-IN-GROUP     PIC 99      VALUE 50.
   546     12  TS-GROUP-WORK           PIC 9(5)    VALUE 0     COMP-3.
   547     12  TS-LENGTH               PIC S9(4)   VALUE +3650 COMP.
   548     12  TS-ITEM                 PIC S9(4)   VALUE +0    COMP.
   549     12  TS-MAP-LENGTH           PIC S9(4)   VALUE +1343 COMP.
   550     12  ROLL-COUNTER            PIC S999    VALUE +0    COMP-3.
   551     12  TS-NAME-TEXT.
   552         16  TS-ID-TEXT          PIC X(4)    VALUE '104A'.
   553         16  TS-ID-TIME REDEFINES TS-ID-TEXT  PIC S9(7) COMP-3.
   554         16  TS-TERM-TEXT.
   555          17 TS-TERM-PREFIX      PIC XX.
   556          17 FILLER              PIC XX.
   557     12  TS-NAME-SCREEN.
   558         16  FILLER              PIC X(4)    VALUE '152X'.
   559         16  TS-TERM-SCREEN      PIC X(4).
   560
   561     12  LINE-NUM.
   562         16  LINE1               PIC X.
   563         16  LINE23              PIC 99.
   564     12  LIN-NUM REDEFINES LINE-NUM  PIC 999.
   565     12  TOP-FORM                PIC X(70)
   566         VALUE '*****TOP OF FORM *****'.
   567     12  SINGLE-LINE             PIC X(70).
   568     12  SINGLE-LINE-BY-1 REDEFINES SINGLE-LINE.
   569         16  ONE-CHAR OCCURS 70 TIMES INDEXED BY INDX1 INDX2
   570                                 PIC X.
   571     12  NAPERSOFT-LETTER        PIC X(16)
   572         VALUE 'Napersoft letter'.
   573
   574 01  HAN-LETTER-REASON-DATA.
   575     12  WS-REASON-TEXT.
   576         16  WS-RE-NDX           PIC 99.
   577         16  FILLER              PIC X(68).
   578
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  13
* EL152.cbl
   579     12  HAN-REASON-TABLE.
   580         16  FILLER              PIC X(50) VALUE
   581           'ADDITIONAL INFO REQUESTED FROM PHYSICIAN          '.
   582         16  FILLER              PIC X(50) VALUE
   583           'CHECKING PRE-EXISTING CONDITION                   '.
   584         16  FILLER              PIC X(50) VALUE
   585           'ADDITIONAL INFO RECEIVED / CLAIM REOPENED         '.
   586         16  FILLER              PIC X(50) VALUE
   587           'LETTER TO INSURED                                 '.
   588         16  FILLER              PIC X(50) VALUE
   589           'LETTER TO CREDITOR                                '.
   590         16  FILLER              PIC X(50) VALUE
   591           'LETTER TO EMPLOYER                                '.
   592         16  FILLER              PIC X(50) VALUE
   593           'LETTER TO INSURED / 2ND REQUEST                   '.
   594         16  FILLER              PIC X(50) VALUE
   595           'LETTER TO CREDITOR / 2ND REQUEST                  '.
   596         16  FILLER              PIC X(50) VALUE
   597           'LETTER TO EMPLOYER / 2ND REQUEST                  '.
   598         16  FILLER              PIC X(50) VALUE
   599           'AWAITING INITIAL CLAIM FORM                       '.
   600         16  FILLER              PIC X(50) VALUE
   601           'AWAITING SUPPLEMENTAL INFORMATION                 '.
   602         16  FILLER              PIC X(50) VALUE
   603           'DENIED / PRE-EXISTING CONDITION                   '.
   604         16  FILLER              PIC X(50) VALUE
   605           'DENIED / WAITING PERIOD NOT MET                   '.
   606         16  FILLER              PIC X(50) VALUE
   607           'DENIED / NORMAL PREGNANCY                         '.
   608         16  FILLER              PIC X(50) VALUE
   609           'DENIED / ACT OF WAR                               '.
   610         16  FILLER              PIC X(50) VALUE
   611           'DENIED / NOT TOTALLY DISABLED                     '.
   612         16  FILLER              PIC X(50) VALUE
   613           'DENIED / NOT UNDER CARE & TREATMENT OF PHYSICIAN  '.
   614         16  FILLER              PIC X(50) VALUE
   615           'DENIED / NO COVERAGE INFORCE                      '.
   616         16  FILLER              PIC X(50) VALUE
   617           'DENIED / DISABLED ON DATE OF LOAN                 '.
   618         16  FILLER              PIC X(50) VALUE
   619           'DENIED / OVER MAXIMUM AGE                         '.
   620         16  FILLER              PIC X(50) VALUE
   621           'CLOSED / CLAIM INFO NOT PROVIDED                  '.
   622         16  FILLER              PIC X(50) VALUE
   623           'PHYSICIAN INFORMATION INCOMPLETE                  '.
   624         16  FILLER              PIC X(50) VALUE
   625           'ACKNOWLEDGEMENT LETTER TO INSURED                 '.
   626         16  FILLER              PIC X(50) VALUE
   627           'DENIED/SUICIDE EXCLUSION                          '.
   628         16  FILLER              PIC X(50) VALUE
   629           'DENIED/LOAN EFFECTIVE BEFORE POLICY EFFECTIVE DATE'.
   630         16  FILLER              PIC X(50) VALUE
   631           'DENIED/JOINT DEBTORS NOT COVERED                  '.
   632         16  FILLER              PIC X(50) VALUE
   633           'DENIED/GROUP POLICY LAPSED                        '.
   634         16  FILLER              PIC X(50) VALUE
   635           'DENIED/DECEASED PRIOR TO POLICY EFFECTIVE DATE    '.
   636         16  FILLER              PIC X(50) VALUE
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  14
* EL152.cbl
   637           'DENIED/LOAN TERM IN EXCESS OF MAXIMUM LOAN TERM   '.
   638         16  FILLER              PIC X(50) VALUE
   639           'DENIED/INSURED NOT PERMANENTLY & TOTALLY DISABLED '.
   640         16  FILLER              PIC X(50) VALUE
   641           'DENIED/IME EXAM DOES NOT SUPPORT CONT. DISABILITY '.
   642         16  FILLER              PIC X(50) VALUE
   643           'DENIED/INSURED DID NOT APPEAR FOR IME EXAM        '.
   644
   645     12  HAN-LETTER-REASON-TABLE  REDEFINES  HAN-REASON-TABLE.
   646         16  HAN-TABLE-ENTRIES  OCCURS  32  TIMES.
   647             20  HAN-REASON-TEXT PIC X(50).
   648
   649 01  ERROR-MESSAGES.
   650     12  ER-0000                 PIC X(4)  VALUE '0000'.
   651     12  ER-0004                 PIC X(4)  VALUE '0004'.
   652     12  ER-0006                 PIC X(4)  VALUE '0006'.
   653     12  ER-0008                 PIC X(4)  VALUE '0008'.
   654     12  ER-0013                 PIC X(4)  VALUE '0013'.
   655     12  ER-0023                 PIC X(4)  VALUE '0023'.
   656     12  ER-0029                 PIC X(4)  VALUE '0029'.
   657     12  ER-0033                 PIC X(4)  VALUE '0033'.
   658     12  ER-0042                 PIC X(4)  VALUE '0042'.
   659     12  ER-0047                 PIC X(4)  VALUE '0047'.
   660     12  ER-0051                 PIC X(4)  VALUE '0051'.
   661     12  ER-0066                 PIC X(4)  VALUE '0066'.
   662     12  ER-0067                 PIC X(4)  VALUE '0067'.
   663     12  ER-0070                 PIC X(4)  VALUE '0070'.
   664     12  ER-0133                 PIC X(4)  VALUE '0133'.
   665     12  ER-0154                 PIC X(4)  VALUE '0154'.
   666     12  ER-0168                 PIC X(4)  VALUE '0168'.
   667     12  ER-0169                 PIC X(4)  VALUE '0169'.
   668     12  ER-0172                 PIC X(4)  VALUE '0172'.
   669     12  ER-0174                 PIC X(4)  VALUE '0174'.
   670     12  ER-0175                 PIC X(4)  VALUE '0175'.
   671     12  ER-0176                 PIC X(4)  VALUE '0176'.
   672     12  ER-0177                 PIC X(4)  VALUE '0177'.
   673     12  ER-0178                 PIC X(4)  VALUE '0178'.
   674     12  ER-0179                 PIC X(4)  VALUE '0179'.
   675     12  ER-0180                 PIC X(4)  VALUE '0180'.
   676     12  ER-0181                 PIC X(4)  VALUE '0181'.
   677     12  ER-0182                 PIC X(4)  VALUE '0182'.
   678     12  ER-0183                 PIC X(4)  VALUE '0183'.
   679     12  ER-0184                 PIC X(4)  VALUE '0184'.
   680     12  ER-0185                 PIC X(4)  VALUE '0185'.
   681     12  ER-0186                 PIC X(4)  VALUE '0186'.
   682     12  ER-0187                 PIC X(4)  VALUE '0187'.
   683     12  ER-0188                 PIC X(4)  VALUE '0188'.
   684     12  ER-0189                 PIC X(4)  VALUE '0189'.
   685     12  ER-0190                 PIC X(4)  VALUE '0190'.
   686     12  ER-0191                 PIC X(4)  VALUE '0191'.
   687     12  ER-0206                 PIC X(4)  VALUE '0206'.
   688     12  ER-0211                 PIC X(4)  VALUE '0211'.
   689     12  ER-0279                 PIC X(4)  VALUE '0279'.
   690     12  ER-0280                 PIC X(4)  VALUE '0280'.
   691     12  ER-0281                 PIC X(4)  VALUE '0281'.
   692     12  ER-0332                 PIC X(4)  VALUE '0332'.
   693     12  ER-0343                 PIC X(4)  VALUE '0343'.
   694     12  ER-0373                 PIC X(4)  VALUE '0373'.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  15
* EL152.cbl
   695     12  ER-0374                 PIC X(4)  VALUE '0374'.
   696     12  ER-0412                 PIC X(4)  VALUE '0412'.
   697     12  ER-0413                 PIC X(4)  VALUE '0413'.
   698     12  ER-0533                 PIC X(4)  VALUE '0533'.
   699     12  ER-0537                 PIC X(4)  VALUE '0537'.
   700     12  ER-0716                 PIC X(4)  VALUE '0716'.
   701     12  ER-0861                 PIC X(4)  VALUE '0861'.
   702     12  ER-0894                 PIC X(4)  VALUE '0894'.
   703     12  ER-0900                 PIC X(4)  VALUE '0900'.
   704     12  ER-0909                 PIC X(4)  VALUE '0909'.
   705     12  ER-0911                 PIC X(4)  VALUE '0911'.
   706     12  ER-0912                 PIC X(4)  VALUE '0912'.
   707     12  ER-1236                 PIC X(4)  VALUE '1236'.
   708     12  ER-1560                 PIC X(4)  VALUE '1560'.
   709     12  ER-2055                 PIC X(4)  VALUE '2055'.
   710     12  ER-2397                 PIC X(4)  VALUE '2397'.
   711     12  ER-2398                 PIC X(4)  VALUE '2398'.
   712     12  ER-3547                 PIC X(4)  VALUE '3547'.
   713     12  ER-3770                 PIC X(4)  VALUE '3770'.
   714     12  ER-3771                 PIC X(4)  VALUE '3771'.
   715     12  ER-3772                 PIC X(4)  VALUE '3772'.
   716     12  ER-7675                 PIC X(4)  VALUE '7675'.
   717     12  ER-7840                 PIC X(4)  VALUE '7840'.
   718     12  ER-7842                 PIC X(4)  VALUE '7842'.
   719     12  ER-7843                 PIC X(4)  VALUE '7843'.
   720     12  ER-8158                 PIC X(4)  VALUE '8158'.
   721     12  ER-9106                 PIC X(4)  VALUE '9106'.
   722     12  ER-9483                 PIC X(4)  VALUE '9483'.
   723     12  ER-9808                 PIC X(4)  VALUE '9808'.
   724     12  ER-9883                 PIC X(4)  VALUE '9883'.
   725     12  ER-9887                 PIC X(4)  VALUE '9887'.
   726
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  16
* EL152.cbl
   728****************************************************
   729*       WHEN ADDING OR DELETING ENTRIES TO         *
   730*       THE SYSTEM-SUPPORTED-VARIABLES THE         *
   731*       SS-NUM-ENTRIES FIELD MUST BE ALTERED       *
   732*       TO MATCH THE NUMBER OF ENTRIES IN THE      *
   733*       SYSTEM-SUPPORTED-VARIABLE TABLE.           *
   734*       ALSO YOU NEED TO INCREASE THE LENGTH OF    *
   735*       SS-WORK-AREA-LENGTH AND SYSTEM-VARIABLES   *
   736*                                                  *
   737*   3 FIELDS TO CHANGE:                            *
   738*      1 - SS-NUM-ENTRIES........(NO.OF ENTRIES)   *
   739*      2 - SS-WORK-AREA-LENGTH...(TOTAL LENGTH)    *
   740*      3 - SYSTEM-VARIABLES......( "      "   )    *
   741****************************************************
   742
   743*  THE SYSTEM-VARIABLES  FIELD LENGTH MUST MATCH THE LENGTH OF
   744*  THE SS-WORK-AREA-LENGTH FIELD FOR THE VARIABLE-WORK-AREA
   745
   746     12  SS-NUM-ENTRIES          PIC 999    VALUE 130      COMP-3.
   747     12  SS-COUNTER              PIC 999                   COMP-3.
   748     12  SS-WORK-AREA-LENGTH     PIC S9(4)  VALUE +3865    COMP.
   749
   750 01  VARIABLE-WORK-AREA.
   751     12  VAR-CODE                PIC X(4).
   752     12  VAR-LEN                 PIC 99.
   753     12  VAR-DATA                PIC X(100).
   754     12  VAR-DATA-R REDEFINES VAR-DATA.
   755       16  VAR-ONE-CHAR OCCURS 100 TIMES INDEXED BY INDXV PIC X.
   756
   757 01  SYSTEM-SUPPORTED-VARIABLES.
   758*****COMPANY NAME
   759     12  SS01                    PIC X(4)  VALUE     '01.0'.
   760     12  SS01L                   PIC 99    VALUE 36.
   761     12  SS01D                   PIC X(30) VALUE ALL '*'.
   762*****FULL COMPANY ADDRESS
   763     12  SS02-1                  PIC X(4)  VALUE     '02.1'.
   764     12  SS02-1L                 PIC 99    VALUE 36.
   765     12  SS02-1D                 PIC X(30) VALUE ALL '*'.
   766     12  SS02-2                  PIC X(4)  VALUE     '02.2'.
   767     12  SS02-2L                 PIC 99    VALUE 36.
   768     12  SS02-2D                 PIC X(30) VALUE ALL '*'.
   769     12  SS02-3                  PIC X(4)  VALUE     '02.3'.
   770     12  SS02-3L                 PIC 99    VALUE 36.
   771     12  SS02-3D                 PIC X(30) VALUE ALL '*'.
   772     12  SS02-4                  PIC X(4)  VALUE     '02.4'.
   773     12  SS02-4L                 PIC 99    VALUE 36.
   774     12  SS02-4D                 PIC X(30) VALUE ALL '*'.
   775     12  SS02-5                  PIC X(4)  VALUE     '02.5'.
   776     12  SS02-5L                 PIC 99    VALUE 36.
   777     12  SS02-5D                 PIC X(30) VALUE ALL '*'.
   778*****CARRIER NAME
   779     12  SS03                    PIC X(4)  VALUE     '03.0'.
   780     12  SS03L                   PIC 99    VALUE 36.
   781     12  SS03D                   PIC X(30) VALUE ALL '*'.
   782*****INVESTORS HERITAGE
   783* as Administrator for Investors Heritage Life Insurance Company
   784     12  SS03-1                  PIC X(4)  VALUE     '03.1'.
   785     12  SS03-1L                 PIC 99    VALUE 68.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  17
* EL152.cbl
   786     12  SS03-1D                 PIC X(62) VALUE ALL '*'.
   787*****FULL CARRIER ADDRESS
   788     12  SS04-1                  PIC X(4)  VALUE     '04.1'.
   789     12  SS04-1L                 PIC 99    VALUE 36.
   790     12  SS04-1D                 PIC X(30) VALUE ALL '*'.
   791     12  SS04-2                  PIC X(4)  VALUE     '04.2'.
   792     12  SS04-2L                 PIC 99    VALUE 36.
   793     12  SS04-2D                 PIC X(30) VALUE ALL '*'.
   794     12  SS04-3                  PIC X(4)  VALUE     '04.3'.
   795     12  SS04-3L                 PIC 99    VALUE 36.
   796     12  SS04-3D                 PIC X(30) VALUE ALL '*'.
   797     12  SS04-4                  PIC X(4)  VALUE     '04.4'.
   798     12  SS04-4L                 PIC 99    VALUE 36.
   799     12  SS04-4D                 PIC X(30) VALUE ALL '*'.
   800     12  SS04-5                  PIC X(4)  VALUE     '04.5'.
   801     12  SS04-5L                 PIC 99    VALUE 36.
   802     12  SS04-5D                 PIC X(30) VALUE ALL '*'.
   803*****CARRIER PHONE NUMBER
   804     12  SS04-6                  PIC X(4)  VALUE     '04.6'.
   805     12  SS04-6L                 PIC 99    VALUE 18.
   806     12  SS04-6D                 PIC X(12) VALUE ALL '*'.
   807*****FULL ADDRESEE LABEL
   808     12  SS05-1                  PIC X(4)  VALUE     '05.1'.
   809     12  SS05-1L                 PIC 99    VALUE 36.
   810     12  SS05-1D                 PIC X(30) VALUE ALL '*'.
   811     12  SS05-2                  PIC X(4)  VALUE     '05.2'.
   812     12  SS05-2L                 PIC 99    VALUE 36.
   813     12  SS05-2D                 PIC X(30) VALUE ALL '*'.
   814     12  SS05-3                  PIC X(4)  VALUE     '05.3'.
   815     12  SS05-3L                 PIC 99    VALUE 36.
   816     12  SS05-3D                 PIC X(30) VALUE ALL '*'.
   817     12  SS05-4                  PIC X(4)  VALUE     '05.4'.
   818     12  SS05-4L                 PIC 99    VALUE 36.
   819     12  SS05-4D                 PIC X(30) VALUE ALL '*'.
   820     12  SS05-5                  PIC X(4)  VALUE     '05.5'.
   821     12  SS05-5L                 PIC 99    VALUE 36.
   822     12  SS05-5D                 PIC X(30) VALUE ALL '*'.
   823     12  SS05-6                  PIC X(4)  VALUE     '05.6'.
   824     12  SS05-6L                 PIC 99    VALUE 36.
   825     12  SS05-6D                 PIC X(30) VALUE ALL '*'.
   826*****ACCOUNT NAME
   827     12  SS06                    PIC X(4)  VALUE     '06.0'.
   828     12  SS06L                   PIC 99    VALUE 36.
   829     12  SS06D                   PIC X(30) VALUE ALL '*'.
   830*****FULL ACCOUNT ADDRESS
   831     12  SS07-1                  PIC X(4)  VALUE     '07.1'.
   832     12  SS07-1L                 PIC 99    VALUE 36.
   833     12  SS07-1D                 PIC X(30) VALUE ALL '*'.
   834     12  SS07-2                  PIC X(4)  VALUE     '07.2'.
   835     12  SS07-2L                 PIC 99    VALUE 36.
   836     12  SS07-2D                 PIC X(30) VALUE ALL '*'.
   837     12  SS07-3                  PIC X(4)  VALUE     '07.3'.
   838     12  SS07-3L                 PIC 99    VALUE 36.
   839     12  SS07-3D                 PIC X(30) VALUE ALL '*'.
   840     12  SS07-4                  PIC X(4)  VALUE     '07.4'.
   841     12  SS07-4L                 PIC 99    VALUE 36.
   842     12  SS07-4D                 PIC X(30) VALUE ALL '*'.
   843     12  SS07-5                  PIC X(4)  VALUE     '07.5'.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  18
* EL152.cbl
   844     12  SS07-5L                 PIC 99    VALUE 36.
   845     12  SS07-5D                 PIC X(30) VALUE ALL '*'.
   846*****ACCOUNT PHONE NUMBER
   847     12  SS07-6                  PIC X(4)  VALUE     '07.6'.
   848     12  SS07-6L                 PIC 99    VALUE 18.
   849     12  SS07-6D                 PIC X(12) VALUE ALL '*'.
   850*****EXECUTING PROCESSOR NAME
   851     12  SS08                    PIC X(4)  VALUE     '08.0'.
   852     12  SS08L                   PIC 99    VALUE 36.
   853     12  SS08D                   PIC X(30) VALUE ALL '*'.
   854*****PROCESSOR TITLE
   855     12  SS09                    PIC X(4)  VALUE     '09.0'.
   856     12  SS09L                   PIC 99    VALUE 32.
   857     12  SS09D                   PIC X(26) VALUE ALL '*'.
   858*****INSUREDS NAME
   859     12  SS10                    PIC X(4)  VALUE     '10.0'.
   860     12  SS10L                   PIC 99    VALUE 36.
   861     12  SS10D                   PIC X(30) VALUE ALL '*'.
   862*****INSUREDS ADDRESS
   863     12  SS11-1                  PIC X(4)  VALUE     '11.1'.
   864     12  SS11-1L                 PIC 99    VALUE 36.
   865     12  SS11-1D                 PIC X(30) VALUE ALL '*'.
   866     12  SS11-2                  PIC X(4)  VALUE     '11.2'.
   867     12  SS11-2L                 PIC 99    VALUE 36.
   868     12  SS11-2D                 PIC X(30) VALUE ALL '*'.
   869     12  SS11-3                  PIC X(4)  VALUE     '11.3'.
   870     12  SS11-3L                 PIC 99    VALUE 36.
   871     12  SS11-3D                 PIC X(30) VALUE ALL '*'.
   872     12  SS11-4                  PIC X(4)  VALUE     '11.4'.
   873     12  SS11-4L                 PIC 99    VALUE 36.
   874     12  SS11-4D                 PIC X(30) VALUE ALL '*'.
   875*****INSUREDS NAME FROM ADDR TRAILER
   876     12  SS11-5                  PIC X(4)  VALUE     '11.5'.
   877     12  SS11-5L                 PIC 99    VALUE 36.
   878     12  SS11-5D                 PIC X(30) VALUE ALL '*'.
   879*****INSUREDS PHONE NUMBER FROM ADDR TRAILER
   880     12  SS11-6                  PIC X(4)  VALUE     '11.6'.
   881     12  SS11-6L                 PIC 99    VALUE 18.
   882     12  SS11-6D                 PIC X(12) VALUE ALL '*'.
   883*****CLAIM TYPE NAME
   884     12  SS12                    PIC X(4)  VALUE     '12.0'.
   885     12  SS12L                   PIC 99    VALUE 12.
   886     12  SS12D                   PIC X(6)  VALUE ALL '*'.
   887*****CLAIM INCURRED DATE
   888     12  SS13                    PIC X(4)  VALUE     '13.0'.
   889     12  SS13L                   PIC 99    VALUE 14.
   890     12  SS13D                   PIC X(8)  VALUE ALL '*'.
   891*****CLAIM REPORTED DATE
   892     12  SS14                    PIC X(4)  VALUE     '14.0'.
   893     12  SS14L                   PIC 99    VALUE 14.
   894     12  SS14D                   PIC X(8)  VALUE ALL '*'.
   895*****LAST PAYMENT DATE
   896     12  SS15                    PIC X(4)  VALUE     '15.0'.
   897     12  SS15L                   PIC 99    VALUE 14.
   898     12  SS15D                   PIC X(8)  VALUE ALL '*'.
   899*****LAST PAYMENT AMOUNT
   900     12  SS16                    PIC X(4)  VALUE     '16.0'.
   901     12  SS16L                   PIC 99    VALUE 17.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  19
* EL152.cbl
   902     12  SS16D                   PIC $$$$,$$$.99 VALUE ZEROS.
   903*****CLAIM INTEREST RATE
   904     12  SS16-1                  PIC X(4)  VALUE     '16.1'.
   905     12  SS16-1L                 PIC 99    VALUE 13.
   906     12  SS16-1D                 PIC X(7)        VALUE SPACE.
   907*****CLAIM PAID THRU/TO DATE
   908     12  SS17                    PIC X(4)  VALUE     '17.0'.
   909     12  SS17L                   PIC 99    VALUE 14.
   910     12  SS17D                   PIC X(8)  VALUE ALL '*'.
   911*****TOTAL PAID TO DATE
   912     12  SS18                    PIC X(4)  VALUE     '18.0'.
   913     12  SS18L                   PIC 99    VALUE 17.
   914     12  SS18D                   PIC $$$$,$$$.99 VALUE ZEROS.
   915*****DIAGNOSIS OR CAUSE
   916     12  SS19                    PIC X(4)  VALUE     '19.0'.
   917     12  SS19L                   PIC 99    VALUE 32.
   918     12  SS19D                   PIC X(26) VALUE ALL '*'.
   919*****CAUSE CODE
   920     12  SS19-1                  PIC X(4)  VALUE     '19.1'.
   921     12  SS19-1L                 PIC 99    VALUE 12.
   922     12  SS19-1D                 PIC X(6)  VALUE ALL '*'.
   923*****CID LOAN NUMBER
   924     12  SS19-2                  PIC X(4)  VALUE     '19.2'.
   925     12  SS19-2L                 PIC 99    VALUE 31.
   926     12  SS19-2D                 PIC X(25) VALUE ALL '*'.
   927*****CURRENT DATE
   928     12  SS20                    PIC X(4)  VALUE     '20.0'.
   929     12  SS20L                   PIC 99    VALUE 14.
   930     12  SS20D                   PIC X(8)  VALUE ALL '*'.
   931*****FULL CURRENT DATE
   932     12  SS21                    PIC X(4)  VALUE     '21.0'.
   933     12  SS21L                   PIC 99    VALUE 24.
   934     12  SS21D                   PIC X(18) VALUE ALL '*'.
   935*****BENEFIT DESCRIPTION
   936     12  SS22                    PIC X(4)  VALUE     '22.0'.
   937     12  SS22L                   PIC 99    VALUE 16.
   938     12  SS22D                   PIC X(10) VALUE ALL '*'.
   939*****CARRIER CODE IN CERT
   940     12  SS23                    PIC X(4)  VALUE     '23.0'.
   941     12  SS23L                   PIC 99    VALUE 9.
   942     12  SS23D                   PIC XXX   VALUE ALL '*'.
   943*****GROUPING CODE IN CERT
   944     12  SS24                    PIC X(4)  VALUE     '24.0'.
   945     12  SS24L                   PIC 99    VALUE 12.
   946     12  SS24D                   PIC X(6)  VALUE ALL '*'.
   947*****ACCOUNT NUMBER IN CERT
   948     12  SS25                    PIC X(4)  VALUE     '25.0'.
   949     12  SS25L                   PIC 99    VALUE 16.
   950     12  SS25D                   PIC X(10) VALUE ALL '*'.
   951*****CERTIFICATE NUMBER
   952     12  SS26                    PIC X(4)  VALUE     '26.0'.
   953     12  SS26L                   PIC 99    VALUE 17.
   954     12  SS26D                   PIC X(11) VALUE ALL '*'.
   955*****CERT EFFECTIVE DATE
   956     12  SS27                    PIC X(4)  VALUE     '27.0'.
   957     12  SS27L                   PIC 99    VALUE 14.
   958     12  SS27D                   PIC X(8)  VALUE ALL '*'.
   959*****CERT EXPIRATION DATE
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  20
* EL152.cbl
   960     12  SS28                    PIC X(4)  VALUE     '28.0'.
   961     12  SS28L                   PIC 99    VALUE 14.
   962     12  SS28D                   PIC X(8)  VALUE ALL '*'.
   963*****APPLICABLE COVERAGE TERM
   964     12  SS29                    PIC X(4)  VALUE     '29.0'.
   965     12  SS29L                   PIC 99    VALUE 9.
   966     12  SS29D                   PIC XXX   VALUE ALL '*'.
   967*****APPLICABLE COVERAGE AMOUNT
   968     12  SS30                    PIC X(4)  VALUE     '30.0'.
   969     12  SS30L                   PIC 99    VALUE 18.
   970     12  SS30D                   PIC $$$$$,$$$.99  VALUE ZEROS.
   971*****APPLICABLE COVERAGE CANCEL DATE
   972     12  SS31                    PIC X(4)  VALUE     '31.0'.
   973     12  SS31L                   PIC 99    VALUE 14.
   974     12  SS31D                   PIC X(8)  VALUE ALL '*'.
   975*****APPLICABLE COVERAGE FORM NUMBER
   976     12  SS32                    PIC X(4)  VALUE     '32.0'.
   977     12  SS32L                   PIC 99    VALUE 18.
   978     12  SS32D                   PIC X(12) VALUE ALL '*'.
   979*****INSURES AGE AT POLICY ISSUE
   980     12  SS33                    PIC X(4)  VALUE     '33.0'.
   981     12  SS33L                   PIC 99    VALUE 9.
   982     12  SS33D                   PIC XXX   VALUE ALL '*'.
   983*****CLAIM NUMBER
   984     12  SS34                    PIC X(4)  VALUE     '34.0'.
   985     12  SS34L                   PIC 99    VALUE 13.
   986     12  SS34D                   PIC X(7)  VALUE ALL '*'.
   987*****LAST DENIAL TEXT
   988     12  SS35-1                  PIC X(4)  VALUE     '35.1'.
   989     12  SS35-1L                 PIC 99    VALUE 66.
   990     12  SS35-1D                 PIC X(60) VALUE ALL '*'.
   991     12  SS35-2                  PIC X(4)  VALUE     '35.2'.
   992     12  SS35-2L                 PIC 99    VALUE 66.
   993     12  SS35-2D                 PIC X(60) VALUE ALL '*'.
   994*****LOAN NUMBER
   995     12  SS36                    PIC X(4)  VALUE     '36.0'.
   996     12  SS36L                   PIC 99    VALUE 14.
   997     12  SS36D                   PIC X(8)  VALUE ALL '*'.
   998*****CURRENT LOAN NUMBER
   999     12  SS36-1                  PIC X(4)  VALUE     '36.1'.
  1000     12  SS36-1L                 PIC 99    VALUE 26.
  1001     12  SS36-1D                 PIC X(20) VALUE ALL '*'.
  1002*****LOAN BALANCE
  1003     12  SS37                    PIC X(4)  VALUE     '37.0'.
  1004     12  SS37L                   PIC 99    VALUE 18.
  1005     12  SS37D                   PIC $$$$$,$$$.99  VALUE ZEROS.
  1006*****MEMBER NUMBER
  1007     12  SS38                    PIC X(4)  VALUE     '38.0'.
  1008     12  SS38L                   PIC 99    VALUE 18.
  1009     12  SS38D                   PIC X(12) VALUE ALL '*'.
  1010*****INSURED NAME (FIRST M LAST)
  1011     12  SS39                    PIC X(4)  VALUE     '39.0'.
  1012     12  SS39L                   PIC 99    VALUE 36.
  1013     12  SS39D                   PIC X(30) VALUE ALL '*'.
  1014*****INSURED LAST NAME ONLY
  1015     12  SS40                    PIC X(4)  VALUE     '40.0'.
  1016     12  SS40L                   PIC 99    VALUE 21.
  1017     12  SS40D                   PIC X(15) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  21
* EL152.cbl
  1018*****TITLE (MR/MS)
  1019     12  SS41                    PIC X(4)  VALUE     '41.0'.
  1020     12  SS41L                   PIC 99    VALUE 9.
  1021     12  SS41D                   PIC X(3)  VALUE ALL '*'.
  1022*****ELIMINATION PERIOD
  1023     12  SS42                    PIC X(4)  VALUE     '42.0'.
  1024     12  SS42L                   PIC 99    VALUE 9.
  1025     12  SS42D                   PIC X(3)  VALUE ALL '*'.
  1026*****BENEFICIARY NAME
  1027     12  SS43                    PIC X(4)  VALUE     '43.0'.
  1028     12  SS43L                   PIC 99    VALUE 36.
  1029     12  SS43D                   PIC X(30) VALUE ALL '*'.
  1030*****BENEFICIARY ADDRESS
  1031     12  SS44-1                  PIC X(4)  VALUE     '44.1'.
  1032     12  SS44-1L                 PIC 99    VALUE 36.
  1033     12  SS44-1D                 PIC X(30) VALUE ALL '*'.
  1034     12  SS44-2                  PIC X(4)  VALUE     '44.2'.
  1035     12  SS44-2L                 PIC 99    VALUE 36.
  1036     12  SS44-2D                 PIC X(30) VALUE ALL '*'.
  1037     12  SS44-3                  PIC X(4)  VALUE     '44.3'.
  1038     12  SS44-3L                 PIC 99    VALUE 36.
  1039     12  SS44-3D                 PIC X(30) VALUE ALL '*'.
  1040     12  SS44-4                  PIC X(4)  VALUE     '44.4'.
  1041     12  SS44-4L                 PIC 99    VALUE 36.
  1042     12  SS44-4D                 PIC X(30) VALUE ALL '*'.
  1043     12  SS44-5                  PIC X(4)  VALUE     '44.5'.
  1044     12  SS44-5L                 PIC 99    VALUE 18.
  1045     12  SS44-5D                 PIC X(12) VALUE ALL '*'.
  1046     12  SS44-6                  PIC X(4)  VALUE     '44.6'.
  1047     12  SS44-6L                 PIC 99    VALUE 36.
  1048     12  SS44-6D                 PIC X(30) VALUE ALL '*'.
  1049*****INSUREDS DATE OF BIRTH
  1050     12  SS45                    PIC X(4)  VALUE     '45.0'.
  1051     12  SS45L                   PIC 99    VALUE 14.
  1052     12  SS45D                   PIC X(8)  VALUE ALL '*'.
  1053*****INSUREDS SOC SEC NUMBER
  1054     12  SS46                    PIC X(4)  VALUE     '46.0'.
  1055     12  SS46L                   PIC 99    VALUE 17.
  1056     12  SS46D                   PIC X(11) VALUE ALL '*'.
  1057*****PHYSICIANS  NAME
  1058     12  SS47                    PIC X(4)  VALUE     '47.0'.
  1059     12  SS47L                   PIC 99    VALUE 36.
  1060     12  SS47D                   PIC X(30) VALUE ALL '*'.
  1061*****PHYSICIANS  ADDRESS
  1062     12  SS47-1                  PIC X(4)  VALUE     '47.1'.
  1063     12  SS47-1L                 PIC 99    VALUE 36.
  1064     12  SS47-1D                 PIC X(30) VALUE ALL '*'.
  1065     12  SS47-2                  PIC X(4)  VALUE     '47.2'.
  1066     12  SS47-2L                 PIC 99    VALUE 36.
  1067     12  SS47-2D                 PIC X(30) VALUE ALL '*'.
  1068     12  SS47-3                  PIC X(4)  VALUE     '47.3'.
  1069     12  SS47-3L                 PIC 99    VALUE 36.
  1070     12  SS47-3D                 PIC X(30) VALUE ALL '*'.
  1071     12  SS47-4                  PIC X(4)  VALUE     '47.4'.
  1072     12  SS47-4L                 PIC 99    VALUE 36.
  1073     12  SS47-4D                 PIC X(30) VALUE ALL '*'.
  1074     12  SS47-5                  PIC X(4)  VALUE     '47.5'.
  1075     12  SS47-5L                 PIC 99    VALUE 18.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  22
* EL152.cbl
  1076     12  SS47-5D                 PIC X(12) VALUE ALL '*'.
  1077*****EMPLOYERS   NAME
  1078     12  SS48                    PIC X(4)  VALUE     '48.0'.
  1079     12  SS48L                   PIC 99    VALUE 36.
  1080     12  SS48D                   PIC X(30) VALUE ALL '*'.
  1081*****EMPLOYERS   ADDRESS
  1082     12  SS48-1                  PIC X(4)  VALUE     '48.1'.
  1083     12  SS48-1L                 PIC 99    VALUE 36.
  1084     12  SS48-1D                 PIC X(30) VALUE ALL '*'.
  1085     12  SS48-2                  PIC X(4)  VALUE     '48.2'.
  1086     12  SS48-2L                 PIC 99    VALUE 36.
  1087     12  SS48-2D                 PIC X(30) VALUE ALL '*'.
  1088     12  SS48-3                  PIC X(4)  VALUE     '48.3'.
  1089     12  SS48-3L                 PIC 99    VALUE 36.
  1090     12  SS48-3D                 PIC X(30) VALUE ALL '*'.
  1091     12  SS48-4                  PIC X(4)  VALUE     '48.4'.
  1092     12  SS48-4L                 PIC 99    VALUE 36.
  1093     12  SS48-4D                 PIC X(30) VALUE ALL '*'.
  1094     12  SS48-5                  PIC X(4)  VALUE     '48.5'.
  1095     12  SS48-5L                 PIC 99    VALUE 18.
  1096     12  SS48-5D                 PIC X(12) VALUE ALL '*'.
  1097*****OTHER1      NAME
  1098     12  SS49                    PIC X(4)  VALUE     '49.0'.
  1099     12  SS49L                   PIC 99    VALUE 36.
  1100     12  SS49D                   PIC X(30) VALUE ALL '*'.
  1101*****OTHER1      ADDRESS
  1102     12  SS49-1                  PIC X(4)  VALUE     '49.1'.
  1103     12  SS49-1L                 PIC 99    VALUE 36.
  1104     12  SS49-1D                 PIC X(30) VALUE ALL '*'.
  1105     12  SS49-2                  PIC X(4)  VALUE     '49.2'.
  1106     12  SS49-2L                 PIC 99    VALUE 36.
  1107     12  SS49-2D                 PIC X(30) VALUE ALL '*'.
  1108     12  SS49-3                  PIC X(4)  VALUE     '49.3'.
  1109     12  SS49-3L                 PIC 99    VALUE 36.
  1110     12  SS49-3D                 PIC X(30) VALUE ALL '*'.
  1111     12  SS49-4                  PIC X(4)  VALUE     '49.4'.
  1112     12  SS49-4L                 PIC 99    VALUE 36.
  1113     12  SS49-4D                 PIC X(30) VALUE ALL '*'.
  1114     12  SS49-5                  PIC X(4)  VALUE     '49.5'.
  1115     12  SS49-5L                 PIC 99    VALUE 18.
  1116     12  SS49-5D                 PIC X(12) VALUE ALL '*'.
  1117*****OTHER2      NAME
  1118     12  SS50                    PIC X(4)  VALUE     '50.0'.
  1119     12  SS50L                   PIC 99    VALUE 36.
  1120     12  SS50D                   PIC X(30) VALUE ALL '*'.
  1121*****OTHER2      ADDRESS
  1122     12  SS50-1                  PIC X(4)  VALUE     '50.1'.
  1123     12  SS50-1L                 PIC 99    VALUE 36.
  1124     12  SS50-1D                 PIC X(30) VALUE ALL '*'.
  1125     12  SS50-2                  PIC X(4)  VALUE     '50.2'.
  1126     12  SS50-2L                 PIC 99    VALUE 36.
  1127     12  SS50-2D                 PIC X(30) VALUE ALL '*'.
  1128     12  SS50-3                  PIC X(4)  VALUE     '50.3'.
  1129     12  SS50-3L                 PIC 99    VALUE 36.
  1130     12  SS50-3D                 PIC X(30) VALUE ALL '*'.
  1131     12  SS50-4                  PIC X(4)  VALUE     '50.4'.
  1132     12  SS50-4L                 PIC 99    VALUE 36.
  1133     12  SS50-4D                 PIC X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  23
* EL152.cbl
  1134     12  SS50-5                  PIC X(4)  VALUE     '50.5'.
  1135     12  SS50-5L                 PIC 99    VALUE 18.
  1136     12  SS50-5D                 PIC X(12) VALUE ALL '*'.
  1137*****A&H TERM TIMES MON. BEN.
  1138     12  SS51                    PIC X(4)  VALUE     '51.0'.
  1139     12  SS51L                   PIC 99    VALUE 17.
  1140     12  SS51D                   PIC $$$$,$$$.99 VALUE ZEROS.
  1141*****THIRD PARTY NAME
  1142     12  SS52                    PIC X(4)  VALUE     '52.0'.
  1143     12  SS52L                   PIC 99    VALUE 36.
  1144     12  SS52D                   PIC X(30) VALUE ALL '*'.
  1145*****THIRD PARTY ADDRESS
  1146     12  SS53-1                  PIC X(4)  VALUE     '53.1'.
  1147     12  SS53-1L                 PIC 99    VALUE 36.
  1148     12  SS53-1D                 PIC X(30) VALUE ALL '*'.
  1149     12  SS53-2                  PIC X(4)  VALUE     '53.2'.
  1150     12  SS53-2L                 PIC 99    VALUE 36.
  1151     12  SS53-2D                 PIC X(30) VALUE ALL '*'.
  1152     12  SS53-3                  PIC X(4)  VALUE     '53.3'.
  1153     12  SS53-3L                 PIC 99    VALUE 36.
  1154     12  SS53-3D                 PIC X(30) VALUE ALL '*'.
  1155     12  SS53-4                  PIC X(4)  VALUE     '53.4'.
  1156     12  SS53-4L                 PIC 99    VALUE 36.
  1157     12  SS53-4D                 PIC X(30) VALUE ALL '*'.
  1158     12  SS53-5                  PIC X(4)  VALUE     '53.5'.
  1159     12  SS53-5L                 PIC 99    VALUE 36.
  1160     12  SS53-5D                 PIC X(30) VALUE ALL '*'.
  1161*****THIRD PARTY PHONE NUMBER
  1162     12  SS53-6                  PIC X(4)  VALUE     '53.6'.
  1163     12  SS53-6L                 PIC 99    VALUE 18.
  1164     12  SS53-6D                 PIC X(12) VALUE ALL '*'.
  1165*****CERTIFICATE SEQUENCE
  1166     12  SS54                    PIC X(4)  VALUE     '54.0'.
  1167     12  SS54L                   PIC 99    VALUE 09.
  1168     12  SS54D                   PIC XXX VALUE ALL '*'.
  1169*****CERTIFICATE TOTAL  E
  1170     12  SS55                    PIC X(4)  VALUE     '55.0'.
  1171     12  SS55L                   PIC 99    VALUE 09.
  1172     12  SS55D                   PIC XXX VALUE ALL '*'.
  1173*****CREDITOR ID
  1174     12  SS56                    PIC  X(04) VALUE    '56.0'.
  1175     12  SS56L                   PIC  99 VALUE 36.
  1176     12  SS56D                   PIC  X(30) VALUE ALL '*'.
  1177*****INSUREDS NAME (CERTIFICATE)
  1178     12  SS57                    PIC X(4)  VALUE     '57.0'.
  1179     12  SS57L                   PIC 99    VALUE 36.
  1180     12  SS57D                   PIC X(30) VALUE ALL '*'.
  1181*****JOINT NAME (CERTIFICATE)
  1182     12  SS58                    PIC X(4)  VALUE     '58.0'.
  1183     12  SS58L                   PIC 99    VALUE 36.
  1184     12  SS58D                   PIC X(30) VALUE ALL '*'.
  1185*****POLICY REFERENCE NUMBER
  1186     12  SS59                    PIC X(4)  VALUE     '59.0'.
  1187     12  SS59L                   PIC 99    VALUE 26.
  1188     12  SS59D                   PIC X(20) VALUE ALL '*'.
  1189*****CREDIT CARD NUMBER (CLAIMS)
  1190     12  SS60                    PIC X(4)  VALUE     '60.0'.
  1191     12  SS60L                   PIC 99    VALUE 22.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  24
* EL152.cbl
  1192     12  SS60D                   PIC X(16) VALUE ALL '*'.
  1193*****CORRESPONDENCE BENEFICIARY NAME
  1194     12  SS61                    PIC X(4)  VALUE     '61.0'.
  1195     12  SS61L                   PIC 99    VALUE 36.
  1196     12  SS61D                   PIC X(30) VALUE ALL '*'.
  1197*****CORRESPONDENCE BENEFICIARY ADDRESS
  1198     12  SS61-1                  PIC X(4)  VALUE     '61.1'.
  1199     12  SS61-1L                 PIC 99    VALUE 36.
  1200     12  SS61-1D                 PIC X(30) VALUE ALL '*'.
  1201     12  SS61-2                  PIC X(4)  VALUE     '61.2'.
  1202     12  SS61-2L                 PIC 99    VALUE 36.
  1203     12  SS61-2D                 PIC X(30) VALUE ALL '*'.
  1204     12  SS61-3                  PIC X(4)  VALUE     '61.3'.
  1205     12  SS61-3L                 PIC 99    VALUE 36.
  1206     12  SS61-3D                 PIC X(30) VALUE ALL '*'.
  1207     12  SS61-4                  PIC X(4)  VALUE     '61.4'.
  1208     12  SS61-4L                 PIC 99    VALUE 36.
  1209     12  SS61-4D                 PIC X(30) VALUE ALL '*'.
  1210     12  SS61-5                  PIC X(4)  VALUE     '61.5'.
  1211     12  SS61-5L                 PIC 99    VALUE 36.
  1212     12  SS61-5D                 PIC X(30) VALUE ALL '*'.
  1213     12  SS61-6                  PIC X(4)  VALUE     '61.6'.
  1214     12  SS61-6L                 PIC 99    VALUE 18.
  1215     12  SS61-6D                 PIC X(12) VALUE ALL '*'.
  1216
  1217*****DMD UNDERWRITER STATEMENT
  1218     12  SS62                    PIC X(4)  VALUE     '62.0'.
  1219     12  SS62L                   PIC 99    VALUE 56.
  1220     12  SS62D                   PIC X(50) VALUE ALL '*'.
  1221
  1222*****DMD UNDERWRITER NAME
  1223     12  SS63                    PIC X(4)  VALUE     '63.0'.
  1224     12  SS63L                   PIC 99    VALUE 66.
  1225     12  SS63D                   PIC X(60) VALUE ALL '*'.
  1226
  1227*****DMD UNDERWRITER NAME
  1228     12  SS64                    PIC X(4)  VALUE     '64.0'.
  1229     12  SS64L                   PIC 99    VALUE 66.
  1230     12  SS64D                   PIC X(60) VALUE ALL '*'.
  1231
  1232****************************************************
  1233*       WHEN ADDING OR DELETING ENTRIES TO         *
  1234*       THE SYSTEM-SUPPORTED-VARIABLES THE         *
  1235*       SS-NUM-ENTRIES FIELD MUST BE ALTERED       *
  1236*       TO MATCH THE NUMBER OF ENTRIES IN THE      *
  1237*       SYSTEM-SUPPORTED-VARIABLE TABLE.           *
  1238*       ALSO YOU NEED TO INCREASE THE LENGTH OF    *
  1239*       SS-WORK-AREA-LENGTH AND SYSTEM-VARIABLES   *
  1240****************************************************
  1241*  THE SYSTEM-VARIABLES  FIELD LENGTH MUST MATCH THE LENGTH OF
  1242*  THE SS-WORK-AREA-LENGTH FIELD FOR THE VARIABLE-WORK-AREA
  1243
  1244 01  SYSTEM-VARIABLES            PIC X(3865).
  1245 01  SYS-VAR-ENTRY.
  1246     12  SYS-VAR-CODE            PIC X(4).
  1247     12  SYS-VAR-LEN             PIC 99.
  1248     12  SYS-VAR-DATA            PIC X(100).
  1249
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  25
* EL152.cbl
  1250*                                COPY ELCDATE.
  1251******************************************************************
  1252*                                                                *
  1253*                                                                *
  1254*                            ELCDATE.                            *
  1255*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1256*                            VMOD=2.003
  1257*                                                                *
  1258*                                                                *
  1259*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1260*                 LENGTH = 200                                   *
  1261******************************************************************
  1262
  1263 01  DATE-CONVERSION-DATA.
  1264     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1265     12  DC-OPTION-CODE                PIC X.
  1266         88  BIN-TO-GREG                VALUE ' '.
  1267         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1268         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1269         88  YMD-GREG-TO-BIN            VALUE '3'.
  1270         88  MDY-GREG-TO-BIN            VALUE '4'.
  1271         88  JULIAN-TO-BIN              VALUE '5'.
  1272         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1273         88  FIND-CENTURY               VALUE '7'.
  1274         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1275         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1276         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1277         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1278         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1279         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1280         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1281         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1282         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1283         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1284         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1285         88  BIN-3-TO-GREG              VALUE 'I'.
  1286         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1287         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1288         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1289         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1290         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1291         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1292         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1293         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1294         88  THREE-CHARACTER-BIN
  1295                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1296         88  GREGORIAN-TO-BIN
  1297                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1298         88  BIN-TO-GREGORIAN
  1299                  VALUES ' ' '1' 'I' '8' 'G'.
  1300         88  JULIAN-TO-BINARY
  1301                  VALUES '5' 'C' 'E' 'F'.
  1302     12  DC-ERROR-CODE                 PIC X.
  1303         88  NO-CONVERSION-ERROR        VALUE ' '.
  1304         88  DATE-CONVERSION-ERROR
  1305                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1306         88  DATE-IS-ZERO               VALUE '1'.
  1307         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  26
* EL152.cbl
  1308         88  DATE-IS-INVALID            VALUE '3'.
  1309         88  DATE1-GREATER-DATE2        VALUE '4'.
  1310         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1311         88  DATE-INVALID-OPTION        VALUE '9'.
  1312         88  INVALID-CENTURY            VALUE 'A'.
  1313         88  ONLY-CENTURY               VALUE 'B'.
  1314         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1315         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1316     12  DC-END-OF-MONTH               PIC X.
  1317         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1318     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1319         88  USE-NORMAL-PROCESS         VALUE ' '.
  1320         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1321         88  ADJUST-UP-100-YRS          VALUE '2'.
  1322     12  FILLER                        PIC X.
  1323     12  DC-CONVERSION-DATES.
  1324         16  DC-BIN-DATE-1             PIC XX.
  1325         16  DC-BIN-DATE-2             PIC XX.
  1326         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1327         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1328                       DC-GREG-DATE-1-EDIT.
  1329             20  DC-EDIT1-MONTH        PIC 99.
  1330             20  SLASH1-1              PIC X.
  1331             20  DC-EDIT1-DAY          PIC 99.
  1332             20  SLASH1-2              PIC X.
  1333             20  DC-EDIT1-YEAR         PIC 99.
  1334         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1335         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1336                     DC-GREG-DATE-2-EDIT.
  1337             20  DC-EDIT2-MONTH        PIC 99.
  1338             20  SLASH2-1              PIC X.
  1339             20  DC-EDIT2-DAY          PIC 99.
  1340             20  SLASH2-2              PIC X.
  1341             20  DC-EDIT2-YEAR         PIC 99.
  1342         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1343         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1344                     DC-GREG-DATE-1-YMD.
  1345             20  DC-YMD-YEAR           PIC 99.
  1346             20  DC-YMD-MONTH          PIC 99.
  1347             20  DC-YMD-DAY            PIC 99.
  1348         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1349         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1350                      DC-GREG-DATE-1-MDY.
  1351             20  DC-MDY-MONTH          PIC 99.
  1352             20  DC-MDY-DAY            PIC 99.
  1353             20  DC-MDY-YEAR           PIC 99.
  1354         16  DC-GREG-DATE-1-ALPHA.
  1355             20  DC-ALPHA-MONTH        PIC X(10).
  1356             20  DC-ALPHA-DAY          PIC 99.
  1357             20  FILLER                PIC XX.
  1358             20  DC-ALPHA-CENTURY.
  1359                 24 DC-ALPHA-CEN-N     PIC 99.
  1360             20  DC-ALPHA-YEAR         PIC 99.
  1361         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1362         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1363         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1364         16  DC-JULIAN-DATE            PIC 9(05).
  1365         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  27
* EL152.cbl
  1366                                       PIC 9(05).
  1367         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1368             20  DC-JULIAN-YEAR        PIC 99.
  1369             20  DC-JULIAN-DAYS        PIC 999.
  1370         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1371         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1372         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1373     12  DATE-CONVERSION-VARIBLES.
  1374         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1375         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1376             20  FILLER                PIC 9(3).
  1377             20  HOLD-CEN-1-CCYY.
  1378                 24  HOLD-CEN-1-CC     PIC 99.
  1379                 24  HOLD-CEN-1-YY     PIC 99.
  1380             20  HOLD-CEN-1-MO         PIC 99.
  1381             20  HOLD-CEN-1-DA         PIC 99.
  1382         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1383             20  HOLD-CEN-1-R-MO       PIC 99.
  1384             20  HOLD-CEN-1-R-DA       PIC 99.
  1385             20  HOLD-CEN-1-R-CCYY.
  1386                 24  HOLD-CEN-1-R-CC   PIC 99.
  1387                 24  HOLD-CEN-1-R-YY   PIC 99.
  1388             20  FILLER                PIC 9(3).
  1389         16  HOLD-CENTURY-1-X.
  1390             20  FILLER                PIC X(3)  VALUE SPACES.
  1391             20  HOLD-CEN-1-X-CCYY.
  1392                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1393                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1394             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1395             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1396         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1397             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1398             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1399             20  HOLD-CEN-1-R-X-CCYY.
  1400                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1401                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1402             20  FILLER                PIC XXX.
  1403         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1404         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1405         16  DC-JULIAN-DATE-1          PIC 9(07).
  1406         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1407             20  DC-JULIAN-1-CCYY.
  1408                 24  DC-JULIAN-1-CC    PIC 99.
  1409                 24  DC-JULIAN-1-YR    PIC 99.
  1410             20  DC-JULIAN-DA-1        PIC 999.
  1411         16  DC-JULIAN-DATE-2          PIC 9(07).
  1412         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1413             20  DC-JULIAN-2-CCYY.
  1414                 24  DC-JULIAN-2-CC    PIC 99.
  1415                 24  DC-JULIAN-2-YR    PIC 99.
  1416             20  DC-JULIAN-DA-2        PIC 999.
  1417         16  DC-GREG-DATE-A-EDIT.
  1418             20  DC-EDITA-MONTH        PIC 99.
  1419             20  SLASHA-1              PIC X VALUE '/'.
  1420             20  DC-EDITA-DAY          PIC 99.
  1421             20  SLASHA-2              PIC X VALUE '/'.
  1422             20  DC-EDITA-CCYY.
  1423                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  28
* EL152.cbl
  1424                 24  DC-EDITA-YEAR     PIC 99.
  1425         16  DC-GREG-DATE-B-EDIT.
  1426             20  DC-EDITB-MONTH        PIC 99.
  1427             20  SLASHB-1              PIC X VALUE '/'.
  1428             20  DC-EDITB-DAY          PIC 99.
  1429             20  SLASHB-2              PIC X VALUE '/'.
  1430             20  DC-EDITB-CCYY.
  1431                 24  DC-EDITB-CENT     PIC 99.
  1432                 24  DC-EDITB-YEAR     PIC 99.
  1433         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1434         16  DC-GREG-DATE-CYMD-R REDEFINES
  1435                              DC-GREG-DATE-CYMD.
  1436             20  DC-CYMD-CEN           PIC 99.
  1437             20  DC-CYMD-YEAR          PIC 99.
  1438             20  DC-CYMD-MONTH         PIC 99.
  1439             20  DC-CYMD-DAY           PIC 99.
  1440         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1441         16  DC-GREG-DATE-MDCY-R REDEFINES
  1442                              DC-GREG-DATE-MDCY.
  1443             20  DC-MDCY-MONTH         PIC 99.
  1444             20  DC-MDCY-DAY           PIC 99.
  1445             20  DC-MDCY-CEN           PIC 99.
  1446             20  DC-MDCY-YEAR          PIC 99.
  1447    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1448        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1449    12  DC-EL310-DATE                  PIC X(21).
  1450    12  FILLER                         PIC X(28).
  1451
  1452*                                COPY ELCLOGOF.
  1453******************************************************************
  1454*                                                                *
  1455*                                                                *
  1456*                            ELCLOGOF.                           *
  1457*                            VMOD=2.001                          *
  1458*                                                                *
  1459*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1460*                                                                *
  1461******************************************************************
  1462 01  CLASIC-LOGOFF.
  1463     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1464     12  LOGOFF-TEXT.
  1465         16  FILLER          PIC X(5)    VALUE SPACES.
  1466         16  LOGOFF-MSG.
  1467             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1468             20  FILLER      PIC X       VALUE SPACES.
  1469             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1470         16  FILLER          PIC X(80)
  1471           VALUE '* YOU ARE NOW LOGGED OFF'.
  1472         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1473         16  FILLER          PIC X       VALUE QUOTE.
  1474         16  LOGOFF-SYS-MSG  PIC X(17)
  1475           VALUE 'S CLAS-IC SYSTEM '.
  1476     12  TEXT-MESSAGES.
  1477         16  UNACCESS-MSG    PIC X(29)
  1478             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1479         16  PGMIDERR-MSG    PIC X(17)
  1480             VALUE 'PROGRAM NOT FOUND'.
  1481
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  29
* EL152.cbl
  1483*                                COPY ELCNWA.
  1484*****************************************************************
  1485*                                                               *
  1486*                                                               *
  1487*                            ELCNWA.                            *
  1488*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1489*                            VMOD=2.003                         *
  1490*                                                               *
  1491*            M O V E   N A M E   W O R K   A R E A.             *
  1492*                                                               *
  1493*****************************************************************.
  1494
  1495 01  WS-NAME-WORK-AREA.
  1496     05  WS-INSURED-LAST-NAME        PIC X(15).
  1497     05  WS-INSURED-1ST-NAME         PIC X(12).
  1498     05  WS-INSURED-MID-INIT         PIC X.
  1499
  1500     05  WS-NAME-WORK.
  1501         10  WS-NW                   PIC X
  1502             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  1503
  1504     05  WS-NAME-WORK2.
  1505         10  WS-NW2                  PIC X
  1506             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  1507                                        NWA-INDEX0.
  1508
  1509     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  1510                                     COMP-3.
  1511
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  30
* EL152.cbl
  1513*                                COPY ELCATTR.
  1514******************************************************************
  1515*                                                                *
  1516*                            ELCATTR.                            *
  1517*                            VMOD=2.001                          *
  1518*                                                                *
  1519*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1520*                                                                *
  1521*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1522*                                                                *
  1523*                   POS 1   P=PROTECTED                          *
  1524*                           U=UNPROTECTED                        *
  1525*                           S=ASKIP                              *
  1526*                   POS 2   A=ALPHA/NUMERIC                      *
  1527*                           N=NUMERIC                            *
  1528*                   POS 3   N=NORMAL                             *
  1529*                           B=BRIGHT                             *
  1530*                           D=DARK                               *
  1531*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1532*                           OF=MODIFIED DATA TAG OFF             *
  1533*                                                                *
  1534*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1535******************************************************************
  1536 01  ATTRIBUTE-LIST.
  1537     12  AL-PABOF            PIC X       VALUE 'Y'.
  1538     12  AL-PABON            PIC X       VALUE 'Z'.
  1539     12  AL-PADOF            PIC X       VALUE '%'.
  1540     12  AL-PADON            PIC X       VALUE '_'.
  1541     12  AL-PANOF            PIC X       VALUE '-'.
  1542     12  AL-PANON            PIC X       VALUE '/'.
  1543     12  AL-SABOF            PIC X       VALUE '8'.
  1544     12  AL-SABON            PIC X       VALUE '9'.
  1545     12  AL-SADOF            PIC X       VALUE '@'.
  1546     12  AL-SADON            PIC X       VALUE QUOTE.
  1547     12  AL-SANOF            PIC X       VALUE '0'.
  1548     12  AL-SANON            PIC X       VALUE '1'.
  1549     12  AL-UABOF            PIC X       VALUE 'H'.
  1550     12  AL-UABON            PIC X       VALUE 'I'.
  1551     12  AL-UADOF            PIC X       VALUE '<'.
  1552     12  AL-UADON            PIC X       VALUE '('.
  1553     12  AL-UANOF            PIC X       VALUE ' '.
  1554     12  AL-UANON            PIC X       VALUE 'A'.
  1555     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1556     12  AL-UNBON            PIC X       VALUE 'R'.
  1557     12  AL-UNDOF            PIC X       VALUE '*'.
  1558     12  AL-UNDON            PIC X       VALUE ')'.
  1559     12  AL-UNNOF            PIC X       VALUE '&'.
  1560     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  31
* EL152.cbl
  1562*                                COPY ELCEMIB.
  1563******************************************************************
  1564*                                                                *
  1565*                                                                *
  1566*                            ELCEMIB.                            *
  1567*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1568*                            VMOD=2.005                          *
  1569*                                                                *
  1570*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1571*                                                                *
  1572******************************************************************
  1573 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1574     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1575     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1576     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1577     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1578     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1579     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1580     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1581     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1582     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1583         88  EMI-NO-ERRORS                    VALUE '1'.
  1584         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1585         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1586     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1587         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1588     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1589         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1590         88  EMI-AREA1-FULL                   VALUE '2'.
  1591     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1592         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1593         88  EMI-AREA2-FULL                   VALUE '2'.
  1594     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1595         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1596         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1597         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1598         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1599         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1600     12  EMI-ERROR-LINES.
  1601         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1602         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1603         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1604         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1605             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1606                 24  EMI-ERR-NUM         PIC X(4).
  1607                 24  EMI-FILLER          PIC X.
  1608                 24  EMI-SEV             PIC X.
  1609                 24  FILLER              PIC X.
  1610             20  FILLER                  PIC X(02).
  1611     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1612         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1613             20  EMI-ERROR-NUMBER    PIC X(4).
  1614             20  EMI-FILL            PIC X.
  1615             20  EMI-SEVERITY        PIC X.
  1616             20  FILLER              PIC X.
  1617             20  EMI-ERROR-TEXT.
  1618                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1619                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  32
* EL152.cbl
  1620     12  EMI-SEVERITY-SAVE           PIC X.
  1621         88  EMI-NOTE                    VALUE 'N'.
  1622         88  EMI-WARNING                 VALUE 'W'.
  1623         88  EMI-FORCABLE                VALUE 'F'.
  1624         88  EMI-FATAL                   VALUE 'X'.
  1625     12  EMI-MESSAGE-FLAG            PIC X.
  1626         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1627         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1628     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1629     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1630         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1631         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1632         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1633     12  FILLER                      PIC X(137)  VALUE SPACES.
  1634     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1635     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1636     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1637     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1638 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  33
* EL152.cbl
  1640*                                COPY ELCINTF.
  1641******************************************************************
  1642*                                                                *
  1643*                                                                *
  1644*                            ELCINTF.                            *
  1645*                            VMOD=2.017                          *
  1646*                                                                *
  1647*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1648*                                                                *
  1649*       LENGTH = 1024                                            *
  1650*                                                                *
  1651******************************************************************
  1652 01  PROGRAM-INTERFACE-BLOCK.
  1653     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1654     12  PI-CALLING-PROGRAM              PIC X(8).
  1655     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1656     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1657     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1658     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1659     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1660     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1661     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1662     12  PI-COMPANY-ID                   PIC XXX.
  1663     12  PI-COMPANY-CD                   PIC X.
  1664
  1665     12  PI-COMPANY-PASSWORD             PIC X(8).
  1666
  1667     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1668
  1669     12  PI-CONTROL-IN-PROGRESS.
  1670         16  PI-CARRIER                  PIC X.
  1671         16  PI-GROUPING                 PIC X(6).
  1672         16  PI-STATE                    PIC XX.
  1673         16  PI-ACCOUNT                  PIC X(10).
  1674         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1675                                         PIC X(10).
  1676         16  PI-CLAIM-CERT-GRP.
  1677             20  PI-CLAIM-NO             PIC X(7).
  1678             20  PI-CERT-NO.
  1679                 25  PI-CERT-PRIME       PIC X(10).
  1680                 25  PI-CERT-SFX         PIC X.
  1681             20  PI-CERT-EFF-DT          PIC XX.
  1682         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1683             20  PI-PLAN-CODE            PIC X(2).
  1684             20  PI-REVISION-NUMBER      PIC X(3).
  1685             20  PI-PLAN-EFF-DT          PIC X(2).
  1686             20  PI-PLAN-EXP-DT          PIC X(2).
  1687             20  FILLER                  PIC X(11).
  1688         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1689             20  PI-OE-REFERENCE-1.
  1690                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1691                 25  PI-OE-REF-1-SUFF    PIC XX.
  1692
  1693     12  PI-SESSION-IN-PROGRESS          PIC X.
  1694         88  CLAIM-SESSION                   VALUE '1'.
  1695         88  CREDIT-SESSION                  VALUE '2'.
  1696         88  WARRANTY-SESSION                VALUE '3'.
  1697         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  34
* EL152.cbl
  1698         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1699
  1700
  1701*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1702
  1703     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1704     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1705
  1706     12  PI-CREDIT-USER                  PIC X.
  1707         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1708         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1709
  1710     12  PI-CLAIM-USER                   PIC X.
  1711         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1712         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1713
  1714     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1715         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1716         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1717         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1718         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1719         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1720
  1721     12  PI-PROCESSOR-ID                 PIC X(4).
  1722
  1723     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1724
  1725     12  PI-MEMBER-CAPTION               PIC X(10).
  1726
  1727     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1728         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1729
  1730     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1731     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1732     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1733     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1734
  1735     12  PI-AH-OVERRIDE-L1               PIC X.
  1736     12  PI-AH-OVERRIDE-L2               PIC XX.
  1737     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1738     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1739
  1740     12  PI-NEW-SYSTEM                   PIC X(2).
  1741
  1742     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1743     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1744         88  PI-USES-PAID-TO                 VALUE '1'.
  1745     12  PI-CRDTCRD-SYSTEM.
  1746         16  PI-CRDTCRD-USER             PIC X.
  1747             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1748             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1749         16  PI-CC-MONTH-END-DT          PIC XX.
  1750     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1751
  1752     12  PI-OE-REFERENCE-2.
  1753         16  PI-OE-REF-2-PRIME           PIC X(10).
  1754         16  PI-OE-REF-2-SUFF            PIC X.
  1755
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  35
* EL152.cbl
  1756     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1757
  1758     12  PI-LANGUAGE-TYPE                PIC X.
  1759             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1760             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1761             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1762
  1763     12  PI-POLICY-LINKAGE-IND           PIC X.
  1764         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1765         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1766                                                   LOW-VALUES.
  1767
  1768     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1769     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1770         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1771         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1772     12  FILLER                          PIC X(4).
  1773
  1774     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1775
  1776     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1777         PI-SYSTEM-LEVEL.
  1778
  1779         16  PI-ENTRY-CODES.
  1780             20  PI-ENTRY-CD-1           PIC X.
  1781             20  PI-ENTRY-CD-2           PIC X.
  1782
  1783         16  PI-RETURN-CODES.
  1784             20  PI-RETURN-CD-1          PIC X.
  1785             20  PI-RETURN-CD-2          PIC X.
  1786
  1787         16  PI-UPDATE-STATUS-SAVE.
  1788             20  PI-UPDATE-BY            PIC X(4).
  1789             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1790
  1791         16  PI-LOWER-CASE-LETTERS       PIC X.
  1792             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1793
  1794*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1795*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1796*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1797
  1798         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1799             88  ST-ACCNT-CNTL               VALUE ' '.
  1800             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1801             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1802             88  ACCNT-CNTL                  VALUE '3'.
  1803             88  CARR-ACCNT-CNTL             VALUE '4'.
  1804
  1805         16  PI-PROCESSOR-CAP-LIST.
  1806             20  PI-SYSTEM-CONTROLS.
  1807                24 PI-SYSTEM-DISPLAY     PIC X.
  1808                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1809                24 PI-SYSTEM-MODIFY      PIC X.
  1810                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1811             20  FILLER                  PIC XX.
  1812             20  PI-DISPLAY-CAP          PIC X.
  1813                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  36
* EL152.cbl
  1814             20  PI-MODIFY-CAP           PIC X.
  1815                 88  MODIFY-CAP              VALUE 'Y'.
  1816             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1817                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1818             20  PI-FORCE-CAP            PIC X.
  1819                 88  FORCE-CAP               VALUE 'Y'.
  1820
  1821         16  PI-PROGRAM-CONTROLS.
  1822             20  PI-PGM-PRINT-OPT        PIC X.
  1823             20  PI-PGM-FORMAT-OPT       PIC X.
  1824             20  PI-PGM-PROCESS-OPT      PIC X.
  1825             20  PI-PGM-TOTALS-OPT       PIC X.
  1826
  1827         16  PI-HELP-INTERFACE.
  1828             20  PI-LAST-ERROR-NO        PIC X(4).
  1829             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1830
  1831         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1832             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1833
  1834         16  PI-CR-CONTROL-IN-PROGRESS.
  1835             20  PI-CR-CARRIER           PIC X.
  1836             20  PI-CR-GROUPING          PIC X(6).
  1837             20  PI-CR-STATE             PIC XX.
  1838             20  PI-CR-ACCOUNT           PIC X(10).
  1839             20  PI-CR-FIN-RESP          PIC X(10).
  1840             20  PI-CR-TYPE              PIC X.
  1841
  1842         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1843
  1844         16  PI-CR-MONTH-END-DT          PIC XX.
  1845
  1846         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1847             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1848             88  PI-ZERO-CARRIER             VALUE '1'.
  1849             88  PI-ZERO-GROUPING            VALUE '2'.
  1850             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1851
  1852         16  PI-CARRIER-SECURITY         PIC X.
  1853             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1854
  1855         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1856             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1857             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1858
  1859         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1860             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1861                                         INDEXED BY PI-ACCESS-NDX
  1862                                         PIC X.
  1863
  1864         16  PI-GA-BILLING-CONTROL       PIC X.
  1865             88  PI-GA-BILLING               VALUE '1'.
  1866
  1867         16  PI-MAIL-PROCESSING          PIC X.
  1868             88  PI-MAIL-YES                 VALUE 'Y'.
  1869
  1870         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1871
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  37
* EL152.cbl
  1872         16  PI-AR-SYSTEM.
  1873             20  PI-AR-PROCESSING-CNTL   PIC X.
  1874                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1875             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1876             20  PI-AR-MONTH-END-DT      PIC XX.
  1877
  1878         16  PI-MP-SYSTEM.
  1879             20  PI-MORTGAGE-USER            PIC X.
  1880                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1881                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1882             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1883                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1884                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1885                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1886                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1887                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1888             20  PI-MP-MONTH-END-DT          PIC XX.
  1889             20  PI-MP-REFERENCE-NO.
  1890                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1891                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1892
  1893         16  PI-LABEL-CONTROL            PIC X(01).
  1894             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1895             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1896
  1897         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1898             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1899
  1900         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1901             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1902             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1903
  1904         16  FILLER                      PIC X(14).
  1905
  1906     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1907******************************************************************
  1908     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
  1909*        COPY ELC1042.
  1910******************************************************************
  1911*                                                                *
  1912*                                                                *
  1913*                           ELC1042                              *
  1914*                            VMOD=2.002                          *
  1915*                                                                *
  1916*    NOTE                                                        *
  1917*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  1918*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  1919*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  1920*        TO THESE PROGRAMS.                                      *
  1921*                                                                *
  1922*    NOTE                                                        *
  1923*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  1924*        USE ONLY!                                               *
  1925*                                                                *
  1926******************************************************************
  1927
  1928         16  PI-1042-WA.
  1929             20  PI-ACTION       PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  38
* EL152.cbl
  1930                 88 PI-SHOW-MODE           VALUE '1'.
  1931                 88 PI-CLEAR-MODE          VALUE '2'.
  1932                 88 PI-CREATE-MODE         VALUE '3'.
  1933             20  PI-COMM-CONTROL PIC  X(12).
  1934             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  1935             20  PI-EOF-SW       PIC  X(01).
  1936                 88  PI-FILE-EOF           VALUE 'Y'.
  1937             20  PI-FILETYP      PIC  X(01).
  1938             20  PI-FORM-SQUEEZE-CONTROL
  1939                                 PIC  X(01).
  1940                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1941                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1942             20  PI-LAST-CONTROL PIC  X(12).
  1943             20  PI-TEMP-STOR-ITEMS
  1944                                 PIC S9(04) COMP.
  1945             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1946             20  PI-UPDATE-SW    PIC  9(01).
  1947                 88 ANY-UPDATES            VALUE 1.
  1948             20  PI-104-SCREEN-SENT-IND
  1949                                 PIC  X(01).
  1950                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1951                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1952             20  PI-1042-SCREEN-SENT-IND
  1953                                 PIC  X(01).
  1954                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1955                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1956             20  PI-1042-ARCHIVE-IND
  1957                                 PIC  X(01).
  1958                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1959             20  FILLER          PIC  X(29).
  1960**********************************************************
  1961*    NOTE                                                *
  1962*        THE WORK AREA IS USED BY EL152 AND EL1522       *
  1963*        AND CANNOT BE REARRANGED WITHOUT COMPILING      *
  1964*        BOTH PROGRAMS.                                  *
  1965*                                                        *
  1966**********************************************************
  1967         16  PI-EL152-WA.
  1968             20  PI-ALT-PRINTER-ID        PIC X(4).
  1969             20  PI-ARCHIVE-NUMBER        PIC 9(8).
  1970             20  PI-FORM-NUMBER           PIC X(4).
  1971             20  PI-ADDR-TYPE             PIC XX.
  1972             20  PI-TEMP-STOR-ID          PIC X(8).
  1973             20  PI-NUM-PRINT-COPIES      PIC 9.
  1974             20  PI-ADDR-SEQ              PIC S9(4)   COMP.
  1975             20  PI-PRINT-SW              PIC X.
  1976                 88 PRINT-PERFORMED  VALUE '1'.
  1977             20  PI-LETTER-ADDRESS-TYPE   PIC XX.
  1978             20  PI-RESEND-FORM-NUMBER    PIC X(4).
  1979             20  PI-PROMPT-LETTER         PIC X.
  1980             20  PI-ENCLOSURE-CD          PIC X(3).
  1981             20  PI-AUTO-CLOSE-IND        PIC X(1).
  1982             20  PI-LETTER-TO-BENE        PIC X(1).
  1983             20  PI-FILLER                PIC X(528).
  1984             20  PI-FORCE-7840            PIC X.
  1985                 88 FORCE-7840       VALUE '1'.
  1986
  1987             20  PI-BSR-LETTER-IND        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  39
* EL152.cbl
  1988                 88  PI-BSR-AUTOMATED VALUE 'BA'.
  1989             20  FILLER REDEFINES PI-BSR-LETTER-IND.
  1990                 22  PI-ELLETR-BSR        PIC X.
  1991                 22  PI-ELBENE-BSR        PIC X.
  1992
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  40
* EL152.cbl
  1994*                            COPY DFHBMSCA.
  1995*****************************************************************
  1996*                                                               *
  1997* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1998* All rights reserved.                                          *
  1999*                                                               *
  2000*****************************************************************
  2001 01    DFHBMSCA.
  2002*        VARIABLE  PROTECTION    INTENSITY    MODIFIED
  2003*                                             DATA TAG
  2004*
  2005*        DFHBMUNP  Unprotected   Normal       Off
  2006     02  DFHBMUNP PIC X VALUE SPACE.
  2007*        DFHBMUNN  Numeric       Normal       Off
  2008     02  DFHBMUNN PIC X VALUE "&".
  2009*        DFHBMPRO  Protected     Normal       Off
  2010     02  DFHBMPRO PIC X VALUE "-".
  2011*        DFHBMASK  Autoskip      Normal       Off
  2012     02  DFHBMASK PIC X VALUE "0".
  2013*************************************************
  2014*        DFHBMBRY  Unprotected   Bright       Off
  2015     02  DFHBMBRY PIC X VALUE "H".
  2016*        DFHPROTI  Protected     Bright       Off
  2017     02  DFHPROTI PIC X VALUE "Y".
  2018*        DFHBMASB  Autoskip      Bright       Off
  2019     02  DFHBMASB PIC X VALUE "8".
  2020*************************************************
  2021*        DFHBMDAR  Unprotected   Non-Display  Off
  2022     02  DFHBMDAR PIC X VALUE "<".
  2023*        DFHPROTN  Protected     Non-Display  Off
  2024     02  DFHPROTN PIC X VALUE "%".
  2025*************************************************
  2026*        DFHBMFSE  Unprotected   Normal       On
  2027     02  DFHBMFSE PIC X VALUE "A".
  2028*        DFHBMASF  Autoskip      Normal       On
  2029     02  DFHBMASF  PIC X VALUE "1".
  2030*        DFHUNNUM  Numeric       Normal       On
  2031     02  DFHUNNUM PIC X VALUE "J".
  2032*        DFHBMPRF  Protected     Normal       On
  2033     02  DFHBMPRF PIC X VALUE "/".
  2034*************************************************
  2035*        DFHUNIMD  Unprotected   Bright       On
  2036     02  DFHUNIMD PIC X VALUE "I".
  2037*        DFHUNINT  Numeric       Bright       On
  2038     02  DFHUNINT PIC X VALUE "R".
  2039*************************************************
  2040*        DFHUNNOD  Unprotected   Non-Display  On
  2041     02  DFHUNNOD PIC X VALUE "(".
  2042*        DFHUNNON  Numeric       Non-Display  On
  2043     02  DFHUNNON PIC X VALUE ")".
  2044*************************************************
  2045*
  2046*     COLOURS
  2047*
  2048     02  DFHDFCOL PIC X VALUE X"00".
  2049     02  DFHBLUE  PIC X VALUE "1".
  2050     02  DFHRED   PIC X VALUE "2".
  2051     02  DFHPINK  PIC X VALUE "3".
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  41
* EL152.cbl
  2052     02  DFHGREEN PIC X VALUE "4".
  2053     02  DFHTURQ  PIC X VALUE "5".
  2054     02  DFHYELLO PIC X VALUE "6".
  2055     02  DFHNEUTR PIC X VALUE "7".
  2056     02  DFH3270  PIC X VALUE "{".
  2057     02  DFHALL   PIC X VALUE LOW-VALUE.
  2058     02  DFHBASE  PIC X VALUE LOW-VALUE.
  2059     02  DFHBLINK PIC X VALUE "1".
  2060     02  DFHBMDET PIC X VALUE LOW-VALUE.
  2061     02  DFHBMEOF PIC X VALUE X"80".
  2062     02  DFHBMPEM PIC X VALUE X"19".
  2063* Newline, DFHBMPNL, is changed to be an ASCII 0x0A
  2064     02  DFHBMPNL PIC X VALUE X"0A".
  2065     02  DFHCOLOR PIC X VALUE "!".
  2066     02  DFHDFHI  PIC X VALUE LOW-VALUE.
  2067     02  DFHDFT   PIC X VALUE X"FF".
  2068     02  DFHERROR PIC X VALUE X"1A".
  2069     02  DFHHLT   PIC X VALUE " ".
  2070     02  DFHMENT  PIC X VALUE X"02".
  2071     02  DFHBMCUR  PIC X VALUE X"02".
  2072     02  DFHBMFLG  PIC X.
  2073         88 DFHCURSR VALUES ARE X"02" , X"82".
  2074     02  DFHMET   PIC X VALUE X"03".
  2075     02  DFHMFE   PIC X VALUE X"06".
  2076     02  DFHMFET  PIC X VALUE LOW-VALUE.
  2077     02  DFHMFIL  PIC X VALUE X"1C".
  2078     02  DFHMFT   PIC X VALUE X"09".
  2079     02  DFHMT    PIC X VALUE X"01".
  2080     02  DFHPS    PIC X VALUE '"'.
  2081     02  DFHREVRS PIC X VALUE "2".
  2082     02  DFHSA    PIC X VALUE X"08".
  2083     02  DFHUNDLN PIC X VALUE "4".
  2084     02  DFHVAL   PIC X VALUE "A".
  2085     02  DFHLEFT  PIC X VALUE X"97".
  2086     02  DFHOVER  PIC X VALUE X"9C".
  2087     02  DFHRIGHT PIC X VALUE X"02".
  2088     02  DFHUNDER PIC X VALUE X"01".
  2089     02  DFHBOX-BIN  PIC 9(4) COMP VALUE 15.
  2090     02  FILLER REDEFINES DFHBOX-BIN.
  2091         03  FILLER PIC X.
  2092         03  DFHBOX PIC X.
  2093     02  DFHSOSI  PIC X VALUE X"01".
  2094     02  DFHBMPSO-BIN    PIC 9(4) COMP VALUE 3599.
  2095     02  FILLER REDEFINES DFHBMPSO-BIN.
  2096         03 DFHBMPSO  PIC X.
  2097         03 DFHBMPSI  PIC X.
  2098     02  DFHBMEC  PIC X VALUE X"82".
  2099*    02  DFHDFFR  PIC X VALUE X"00".
  2100*    02  DFHOPAQ  PIC X VALUE X"00".
  2101*    02  DFHOUTLN PIC X VALUE X"00".
  2102*    02  DFHTRANS PIC X VALUE X"00".
  2103*    02  DFHBKTRN PIC X VALUE X"00".
  2104*                            COPY ELCAID.
  2105******************************************************************
  2106*                                                                *
  2107*                            ELCAID.                             *
  2108*                            VMOD=2.001                          *
  2109*                                                                *
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  42
* EL152.cbl
  2110*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2111*                                                                *
  2112*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2113*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2114******************************************************************
  2115
  2116 01  DFHAID.
  2117   02  DFHNULL   PIC  X  VALUE  ' '.
  2118   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2119   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2120   02  DFHPEN    PIC  X  VALUE  '='.
  2121   02  DFHOPID   PIC  X  VALUE  'W'.
  2122   02  DFHPA1    PIC  X  VALUE  '%'.
  2123   02  DFHPA2    PIC  X  VALUE  '>'.
  2124   02  DFHPA3    PIC  X  VALUE  ','.
  2125   02  DFHPF1    PIC  X  VALUE  '1'.
  2126   02  DFHPF2    PIC  X  VALUE  '2'.
  2127   02  DFHPF3    PIC  X  VALUE  '3'.
  2128   02  DFHPF4    PIC  X  VALUE  '4'.
  2129   02  DFHPF5    PIC  X  VALUE  '5'.
  2130   02  DFHPF6    PIC  X  VALUE  '6'.
  2131   02  DFHPF7    PIC  X  VALUE  '7'.
  2132   02  DFHPF8    PIC  X  VALUE  '8'.
  2133   02  DFHPF9    PIC  X  VALUE  '9'.
  2134   02  DFHPF10   PIC  X  VALUE  ':'.
  2135   02  DFHPF11   PIC  X  VALUE  '#'.
  2136   02  DFHPF12   PIC  X  VALUE  '@'.
  2137   02  DFHPF13   PIC  X  VALUE  'A'.
  2138   02  DFHPF14   PIC  X  VALUE  'B'.
  2139   02  DFHPF15   PIC  X  VALUE  'C'.
  2140   02  DFHPF16   PIC  X  VALUE  'D'.
  2141   02  DFHPF17   PIC  X  VALUE  'E'.
  2142   02  DFHPF18   PIC  X  VALUE  'F'.
  2143   02  DFHPF19   PIC  X  VALUE  'G'.
  2144   02  DFHPF20   PIC  X  VALUE  'H'.
  2145   02  DFHPF21   PIC  X  VALUE  'I'.
  2146*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2147   02  DFHPF22   PIC  X  VALUE  '['.
  2148   02  DFHPF23   PIC  X  VALUE  '.'.
  2149   02  DFHPF24   PIC  X  VALUE  '<'.
  2150   02  DFHMSRE   PIC  X  VALUE  'X'.
  2151   02  DFHSTRF   PIC  X  VALUE  'h'.
  2152   02  DFHTRIG   PIC  X  VALUE  '"'.
  2153 01  FILLER    REDEFINES DFHAID.
  2154     12  FILLER              PIC X(8).
  2155     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  43
* EL152.cbl
  2157*                            COPY EL152S.
  2158 01  EL152AI.
  2159     05  FILLER            PIC  X(0012).
  2160*    -------------------------------
  2161     05  DATEAL PIC S9(0004) COMP.
  2162     05  DATEAF PIC  X(0001).
  2163     05  FILLER REDEFINES DATEAF.
  2164         10  DATEAA PIC  X(0001).
  2165     05  DATEAI PIC  X(0008).
  2166*    -------------------------------
  2167     05  TIMEAL PIC S9(0004) COMP.
  2168     05  TIMEAF PIC  X(0001).
  2169     05  FILLER REDEFINES TIMEAF.
  2170         10  TIMEAA PIC  X(0001).
  2171     05  TIMEAI PIC  X(0005).
  2172*    -------------------------------
  2173     05  CARRL PIC S9(0004) COMP.
  2174     05  CARRF PIC  X(0001).
  2175     05  FILLER REDEFINES CARRF.
  2176         10  CARRA PIC  X(0001).
  2177     05  CARRI PIC  X(0001).
  2178*    -------------------------------
  2179     05  CLMNOL PIC S9(0004) COMP.
  2180     05  CLMNOF PIC  X(0001).
  2181     05  FILLER REDEFINES CLMNOF.
  2182         10  CLMNOA PIC  X(0001).
  2183     05  CLMNOI PIC  X(0007).
  2184*    -------------------------------
  2185     05  CRTNOL PIC S9(0004) COMP.
  2186     05  CRTNOF PIC  X(0001).
  2187     05  FILLER REDEFINES CRTNOF.
  2188         10  CRTNOA PIC  X(0001).
  2189     05  CRTNOI PIC  X(0011).
  2190*    -------------------------------
  2191     05  PROCL PIC S9(0004) COMP.
  2192     05  PROCF PIC  X(0001).
  2193     05  FILLER REDEFINES PROCF.
  2194         10  PROCA PIC  X(0001).
  2195     05  PROCI PIC  X(0004).
  2196*    -------------------------------
  2197     05  COMPIDL PIC S9(0004) COMP.
  2198     05  COMPIDF PIC  X(0001).
  2199     05  FILLER REDEFINES COMPIDF.
  2200         10  COMPIDA PIC  X(0001).
  2201     05  COMPIDI PIC  X(0003).
  2202*    -------------------------------
  2203     05  CLEANL PIC S9(0004) COMP.
  2204     05  CLEANF PIC  X(0001).
  2205     05  FILLER REDEFINES CLEANF.
  2206         10  CLEANA PIC  X(0001).
  2207     05  CLEANI PIC  X(0001).
  2208*    -------------------------------
  2209     05  SYSL PIC S9(0004) COMP.
  2210     05  SYSF PIC  X(0001).
  2211     05  FILLER REDEFINES SYSF.
  2212         10  SYSA PIC  X(0001).
  2213     05  SYSI PIC  X(0008).
  2214*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  44
* EL152.cbl
  2215     05  MAINTL PIC S9(0004) COMP.
  2216     05  MAINTF PIC  X(0001).
  2217     05  FILLER REDEFINES MAINTF.
  2218         10  MAINTA PIC  X(0001).
  2219     05  MAINTI PIC  X(0001).
  2220*    -------------------------------
  2221     05  ARCHNUML PIC S9(0004) COMP.
  2222     05  ARCHNUMF PIC  X(0001).
  2223     05  FILLER REDEFINES ARCHNUMF.
  2224         10  ARCHNUMA PIC  X(0001).
  2225     05  ARCHNUMI PIC  99999999.
  2226*    -------------------------------
  2227     05  FORML PIC S9(0004) COMP.
  2228     05  FORMF PIC  X(0001).
  2229     05  FILLER REDEFINES FORMF.
  2230         10  FORMA PIC  X(0001).
  2231     05  FORMI PIC  X(0004).
  2232*    -------------------------------
  2233     05  FOLLOWL PIC S9(0004) COMP.
  2234     05  FOLLOWF PIC  X(0001).
  2235     05  FILLER REDEFINES FOLLOWF.
  2236         10  FOLLOWA PIC  X(0001).
  2237     05  FOLLOWI PIC  X(0008).
  2238*    -------------------------------
  2239     05  RESENDL PIC S9(0004) COMP.
  2240     05  RESENDF PIC  X(0001).
  2241     05  FILLER REDEFINES RESENDF.
  2242         10  RESENDA PIC  X(0001).
  2243     05  RESENDI PIC  X(0008).
  2244*    -------------------------------
  2245     05  PRINTL PIC S9(0004) COMP.
  2246     05  PRINTF PIC  X(0001).
  2247     05  FILLER REDEFINES PRINTF.
  2248         10  PRINTA PIC  X(0001).
  2249     05  PRINTI PIC  X(0001).
  2250*    -------------------------------
  2251     05  COPIESL PIC S9(0004) COMP.
  2252     05  COPIESF PIC  X(0001).
  2253     05  FILLER REDEFINES COPIESF.
  2254         10  COPIESA PIC  X(0001).
  2255     05  COPIESI PIC  X(0001).
  2256*    -------------------------------
  2257     05  ENCL PIC S9(0004) COMP.
  2258     05  ENCF PIC  X(0001).
  2259     05  FILLER REDEFINES ENCF.
  2260         10  ENCA PIC  X(0001).
  2261     05  ENCI PIC  X(0003).
  2262*    -------------------------------
  2263     05  ADDRL PIC S9(0004) COMP.
  2264     05  ADDRF PIC  X(0001).
  2265     05  FILLER REDEFINES ADDRF.
  2266         10  ADDRA PIC  X(0001).
  2267     05  ADDRI PIC  X(0002).
  2268*    -------------------------------
  2269     05  ACTL PIC S9(0004) COMP.
  2270     05  ACTF PIC  X(0001).
  2271     05  FILLER REDEFINES ACTF.
  2272         10  ACTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  45
* EL152.cbl
  2273     05  ACTI PIC  X(0001).
  2274*    -------------------------------
  2275     05  BENL PIC S9(0004) COMP.
  2276     05  BENF PIC  X(0001).
  2277     05  FILLER REDEFINES BENF.
  2278         10  BENA PIC  X(0001).
  2279     05  BENI PIC  X(0001).
  2280*    -------------------------------
  2281     05  EMPL PIC S9(0004) COMP.
  2282     05  EMPF PIC  X(0001).
  2283     05  FILLER REDEFINES EMPF.
  2284         10  EMPA PIC  X(0001).
  2285     05  EMPI PIC  X(0001).
  2286*    -------------------------------
  2287     05  INSL PIC S9(0004) COMP.
  2288     05  INSF PIC  X(0001).
  2289     05  FILLER REDEFINES INSF.
  2290         10  INSA PIC  X(0001).
  2291     05  INSI PIC  X(0001).
  2292*    -------------------------------
  2293     05  PHYSL PIC S9(0004) COMP.
  2294     05  PHYSF PIC  X(0001).
  2295     05  FILLER REDEFINES PHYSF.
  2296         10  PHYSA PIC  X(0001).
  2297     05  PHYSI PIC  X(0001).
  2298*    -------------------------------
  2299     05  OTHR1L PIC S9(0004) COMP.
  2300     05  OTHR1F PIC  X(0001).
  2301     05  FILLER REDEFINES OTHR1F.
  2302         10  OTHR1A PIC  X(0001).
  2303     05  OTHR1I PIC  X(0001).
  2304*    -------------------------------
  2305     05  OTHR2L PIC S9(0004) COMP.
  2306     05  OTHR2F PIC  X(0001).
  2307     05  FILLER REDEFINES OTHR2F.
  2308         10  OTHR2A PIC  X(0001).
  2309     05  OTHR2I PIC  X(0001).
  2310*    -------------------------------
  2311     05  REL PIC S9(0004) COMP.
  2312     05  REF PIC  X(0001).
  2313     05  FILLER REDEFINES REF.
  2314         10  REA PIC  X(0001).
  2315     05  REI PIC  X(0070).
  2316*    -------------------------------
  2317     05  L1L PIC S9(0004) COMP.
  2318     05  L1F PIC  X(0001).
  2319     05  FILLER REDEFINES L1F.
  2320         10  L1A PIC  X(0001).
  2321     05  L1I PIC  X(0003).
  2322*    -------------------------------
  2323     05  TEXT1L PIC S9(0004) COMP.
  2324     05  TEXT1F PIC  X(0001).
  2325     05  FILLER REDEFINES TEXT1F.
  2326         10  TEXT1A PIC  X(0001).
  2327     05  TEXT1I PIC  X(0070).
  2328*    -------------------------------
  2329     05  L2L PIC S9(0004) COMP.
  2330     05  L2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  46
* EL152.cbl
  2331     05  FILLER REDEFINES L2F.
  2332         10  L2A PIC  X(0001).
  2333     05  L2I PIC  X(0003).
  2334*    -------------------------------
  2335     05  TEXT2L PIC S9(0004) COMP.
  2336     05  TEXT2F PIC  X(0001).
  2337     05  FILLER REDEFINES TEXT2F.
  2338         10  TEXT2A PIC  X(0001).
  2339     05  TEXT2I PIC  X(0070).
  2340*    -------------------------------
  2341     05  L3L PIC S9(0004) COMP.
  2342     05  L3F PIC  X(0001).
  2343     05  FILLER REDEFINES L3F.
  2344         10  L3A PIC  X(0001).
  2345     05  L3I PIC  X(0003).
  2346*    -------------------------------
  2347     05  TEXT3L PIC S9(0004) COMP.
  2348     05  TEXT3F PIC  X(0001).
  2349     05  FILLER REDEFINES TEXT3F.
  2350         10  TEXT3A PIC  X(0001).
  2351     05  TEXT3I PIC  X(0070).
  2352*    -------------------------------
  2353     05  L4L PIC S9(0004) COMP.
  2354     05  L4F PIC  X(0001).
  2355     05  FILLER REDEFINES L4F.
  2356         10  L4A PIC  X(0001).
  2357     05  L4I PIC  X(0003).
  2358*    -------------------------------
  2359     05  TEXT4L PIC S9(0004) COMP.
  2360     05  TEXT4F PIC  X(0001).
  2361     05  FILLER REDEFINES TEXT4F.
  2362         10  TEXT4A PIC  X(0001).
  2363     05  TEXT4I PIC  X(0070).
  2364*    -------------------------------
  2365     05  L5L PIC S9(0004) COMP.
  2366     05  L5F PIC  X(0001).
  2367     05  FILLER REDEFINES L5F.
  2368         10  L5A PIC  X(0001).
  2369     05  L5I PIC  X(0003).
  2370*    -------------------------------
  2371     05  TEXT5L PIC S9(0004) COMP.
  2372     05  TEXT5F PIC  X(0001).
  2373     05  FILLER REDEFINES TEXT5F.
  2374         10  TEXT5A PIC  X(0001).
  2375     05  TEXT5I PIC  X(0070).
  2376*    -------------------------------
  2377     05  L6L PIC S9(0004) COMP.
  2378     05  L6F PIC  X(0001).
  2379     05  FILLER REDEFINES L6F.
  2380         10  L6A PIC  X(0001).
  2381     05  L6I PIC  X(0003).
  2382*    -------------------------------
  2383     05  TEXT6L PIC S9(0004) COMP.
  2384     05  TEXT6F PIC  X(0001).
  2385     05  FILLER REDEFINES TEXT6F.
  2386         10  TEXT6A PIC  X(0001).
  2387     05  TEXT6I PIC  X(0070).
  2388*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  47
* EL152.cbl
  2389     05  L7L PIC S9(0004) COMP.
  2390     05  L7F PIC  X(0001).
  2391     05  FILLER REDEFINES L7F.
  2392         10  L7A PIC  X(0001).
  2393     05  L7I PIC  X(0003).
  2394*    -------------------------------
  2395     05  TEXT7L PIC S9(0004) COMP.
  2396     05  TEXT7F PIC  X(0001).
  2397     05  FILLER REDEFINES TEXT7F.
  2398         10  TEXT7A PIC  X(0001).
  2399     05  TEXT7I PIC  X(0070).
  2400*    -------------------------------
  2401     05  L8L PIC S9(0004) COMP.
  2402     05  L8F PIC  X(0001).
  2403     05  FILLER REDEFINES L8F.
  2404         10  L8A PIC  X(0001).
  2405     05  L8I PIC  X(0003).
  2406*    -------------------------------
  2407     05  TEXT8L PIC S9(0004) COMP.
  2408     05  TEXT8F PIC  X(0001).
  2409     05  FILLER REDEFINES TEXT8F.
  2410         10  TEXT8A PIC  X(0001).
  2411     05  TEXT8I PIC  X(0070).
  2412*    -------------------------------
  2413     05  L9L PIC S9(0004) COMP.
  2414     05  L9F PIC  X(0001).
  2415     05  FILLER REDEFINES L9F.
  2416         10  L9A PIC  X(0001).
  2417     05  L9I PIC  X(0003).
  2418*    -------------------------------
  2419     05  TEXT9L PIC S9(0004) COMP.
  2420     05  TEXT9F PIC  X(0001).
  2421     05  FILLER REDEFINES TEXT9F.
  2422         10  TEXT9A PIC  X(0001).
  2423     05  TEXT9I PIC  X(0070).
  2424*    -------------------------------
  2425     05  L10L PIC S9(0004) COMP.
  2426     05  L10F PIC  X(0001).
  2427     05  FILLER REDEFINES L10F.
  2428         10  L10A PIC  X(0001).
  2429     05  L10I PIC  X(0003).
  2430*    -------------------------------
  2431     05  TEXT10L PIC S9(0004) COMP.
  2432     05  TEXT10F PIC  X(0001).
  2433     05  FILLER REDEFINES TEXT10F.
  2434         10  TEXT10A PIC  X(0001).
  2435     05  TEXT10I PIC  X(0070).
  2436*    -------------------------------
  2437     05  L11L PIC S9(0004) COMP.
  2438     05  L11F PIC  X(0001).
  2439     05  FILLER REDEFINES L11F.
  2440         10  L11A PIC  X(0001).
  2441     05  L11I PIC  X(0003).
  2442*    -------------------------------
  2443     05  TEXT11L PIC S9(0004) COMP.
  2444     05  TEXT11F PIC  X(0001).
  2445     05  FILLER REDEFINES TEXT11F.
  2446         10  TEXT11A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  48
* EL152.cbl
  2447     05  TEXT11I PIC  X(0070).
  2448*    -------------------------------
  2449     05  L12L PIC S9(0004) COMP.
  2450     05  L12F PIC  X(0001).
  2451     05  FILLER REDEFINES L12F.
  2452         10  L12A PIC  X(0001).
  2453     05  L12I PIC  X(0003).
  2454*    -------------------------------
  2455     05  TEXT12L PIC S9(0004) COMP.
  2456     05  TEXT12F PIC  X(0001).
  2457     05  FILLER REDEFINES TEXT12F.
  2458         10  TEXT12A PIC  X(0001).
  2459     05  TEXT12I PIC  X(0070).
  2460*    -------------------------------
  2461     05  L13L PIC S9(0004) COMP.
  2462     05  L13F PIC  X(0001).
  2463     05  FILLER REDEFINES L13F.
  2464         10  L13A PIC  X(0001).
  2465     05  L13I PIC  X(0003).
  2466*    -------------------------------
  2467     05  TEXT13L PIC S9(0004) COMP.
  2468     05  TEXT13F PIC  X(0001).
  2469     05  FILLER REDEFINES TEXT13F.
  2470         10  TEXT13A PIC  X(0001).
  2471     05  TEXT13I PIC  X(0070).
  2472*    -------------------------------
  2473     05  ERRMSGL PIC S9(0004) COMP.
  2474     05  ERRMSGF PIC  X(0001).
  2475     05  FILLER REDEFINES ERRMSGF.
  2476         10  ERRMSGA PIC  X(0001).
  2477     05  ERRMSGI PIC  X(0072).
  2478*    -------------------------------
  2479     05  ENTERPFL PIC S9(0004) COMP.
  2480     05  ENTERPFF PIC  X(0001).
  2481     05  FILLER REDEFINES ENTERPFF.
  2482         10  ENTERPFA PIC  X(0001).
  2483     05  ENTERPFI PIC  99.
  2484*    -------------------------------
  2485     05  PRINTERL PIC S9(0004) COMP.
  2486     05  PRINTERF PIC  X(0001).
  2487     05  FILLER REDEFINES PRINTERF.
  2488         10  PRINTERA PIC  X(0001).
  2489     05  PRINTERI PIC  X(0004).
  2490*    -------------------------------
  2491     05  PFKEY9L PIC S9(0004) COMP.
  2492     05  PFKEY9F PIC  X(0001).
  2493     05  FILLER REDEFINES PFKEY9F.
  2494         10  PFKEY9A PIC  X(0001).
  2495     05  PFKEY9I PIC  X(0014).
  2496 01  EL152AO REDEFINES EL152AI.
  2497     05  FILLER            PIC  X(0012).
  2498*    -------------------------------
  2499     05  FILLER            PIC  X(0003).
  2500     05  DATEAO PIC  X(0008).
  2501*    -------------------------------
  2502     05  FILLER            PIC  X(0003).
  2503     05  TIMEAO PIC  99.99.
  2504*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  49
* EL152.cbl
  2505     05  FILLER            PIC  X(0003).
  2506     05  CARRO PIC  X(0001).
  2507*    -------------------------------
  2508     05  FILLER            PIC  X(0003).
  2509     05  CLMNOO PIC  X(0007).
  2510*    -------------------------------
  2511     05  FILLER            PIC  X(0003).
  2512     05  CRTNOO PIC  X(0011).
  2513*    -------------------------------
  2514     05  FILLER            PIC  X(0003).
  2515     05  PROCO PIC  X(0004).
  2516*    -------------------------------
  2517     05  FILLER            PIC  X(0003).
  2518     05  COMPIDO PIC  X(0003).
  2519*    -------------------------------
  2520     05  FILLER            PIC  X(0003).
  2521     05  CLEANO PIC  X(0001).
  2522*    -------------------------------
  2523     05  FILLER            PIC  X(0003).
  2524     05  SYSO PIC  X(0008).
  2525*    -------------------------------
  2526     05  FILLER            PIC  X(0003).
  2527     05  MAINTO PIC  X(0001).
  2528*    -------------------------------
  2529     05  FILLER            PIC  X(0003).
  2530     05  ARCHNUMO PIC  X(0008).
  2531*    -------------------------------
  2532     05  FILLER            PIC  X(0003).
  2533     05  FORMO PIC  X(0004).
  2534*    -------------------------------
  2535     05  FILLER            PIC  X(0003).
  2536     05  FOLLOWO PIC  X(0008).
  2537*    -------------------------------
  2538     05  FILLER            PIC  X(0003).
  2539     05  RESENDO PIC  X(0008).
  2540*    -------------------------------
  2541     05  FILLER            PIC  X(0003).
  2542     05  PRINTO PIC  X(0001).
  2543*    -------------------------------
  2544     05  FILLER            PIC  X(0003).
  2545     05  COPIESO PIC  X(0001).
  2546*    -------------------------------
  2547     05  FILLER            PIC  X(0003).
  2548     05  ENCO PIC  X(0003).
  2549*    -------------------------------
  2550     05  FILLER            PIC  X(0003).
  2551     05  ADDRO PIC  X(0002).
  2552*    -------------------------------
  2553     05  FILLER            PIC  X(0003).
  2554     05  ACTO PIC  X(0001).
  2555*    -------------------------------
  2556     05  FILLER            PIC  X(0003).
  2557     05  BENO PIC  X(0001).
  2558*    -------------------------------
  2559     05  FILLER            PIC  X(0003).
  2560     05  EMPO PIC  X(0001).
  2561*    -------------------------------
  2562     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  50
* EL152.cbl
  2563     05  INSO PIC  X(0001).
  2564*    -------------------------------
  2565     05  FILLER            PIC  X(0003).
  2566     05  PHYSO PIC  X(0001).
  2567*    -------------------------------
  2568     05  FILLER            PIC  X(0003).
  2569     05  OTHR1O PIC  X(0001).
  2570*    -------------------------------
  2571     05  FILLER            PIC  X(0003).
  2572     05  OTHR2O PIC  X(0001).
  2573*    -------------------------------
  2574     05  FILLER            PIC  X(0003).
  2575     05  REO PIC  X(0070).
  2576*    -------------------------------
  2577     05  FILLER            PIC  X(0003).
  2578     05  L1O PIC  X(0003).
  2579*    -------------------------------
  2580     05  FILLER            PIC  X(0003).
  2581     05  TEXT1O PIC  X(0070).
  2582*    -------------------------------
  2583     05  FILLER            PIC  X(0003).
  2584     05  L2O PIC  X(0003).
  2585*    -------------------------------
  2586     05  FILLER            PIC  X(0003).
  2587     05  TEXT2O PIC  X(0070).
  2588*    -------------------------------
  2589     05  FILLER            PIC  X(0003).
  2590     05  L3O PIC  X(0003).
  2591*    -------------------------------
  2592     05  FILLER            PIC  X(0003).
  2593     05  TEXT3O PIC  X(0070).
  2594*    -------------------------------
  2595     05  FILLER            PIC  X(0003).
  2596     05  L4O PIC  X(0003).
  2597*    -------------------------------
  2598     05  FILLER            PIC  X(0003).
  2599     05  TEXT4O PIC  X(0070).
  2600*    -------------------------------
  2601     05  FILLER            PIC  X(0003).
  2602     05  L5O PIC  X(0003).
  2603*    -------------------------------
  2604     05  FILLER            PIC  X(0003).
  2605     05  TEXT5O PIC  X(0070).
  2606*    -------------------------------
  2607     05  FILLER            PIC  X(0003).
  2608     05  L6O PIC  X(0003).
  2609*    -------------------------------
  2610     05  FILLER            PIC  X(0003).
  2611     05  TEXT6O PIC  X(0070).
  2612*    -------------------------------
  2613     05  FILLER            PIC  X(0003).
  2614     05  L7O PIC  X(0003).
  2615*    -------------------------------
  2616     05  FILLER            PIC  X(0003).
  2617     05  TEXT7O PIC  X(0070).
  2618*    -------------------------------
  2619     05  FILLER            PIC  X(0003).
  2620     05  L8O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  51
* EL152.cbl
  2621*    -------------------------------
  2622     05  FILLER            PIC  X(0003).
  2623     05  TEXT8O PIC  X(0070).
  2624*    -------------------------------
  2625     05  FILLER            PIC  X(0003).
  2626     05  L9O PIC  X(0003).
  2627*    -------------------------------
  2628     05  FILLER            PIC  X(0003).
  2629     05  TEXT9O PIC  X(0070).
  2630*    -------------------------------
  2631     05  FILLER            PIC  X(0003).
  2632     05  L10O PIC  X(0003).
  2633*    -------------------------------
  2634     05  FILLER            PIC  X(0003).
  2635     05  TEXT10O PIC  X(0070).
  2636*    -------------------------------
  2637     05  FILLER            PIC  X(0003).
  2638     05  L11O PIC  X(0003).
  2639*    -------------------------------
  2640     05  FILLER            PIC  X(0003).
  2641     05  TEXT11O PIC  X(0070).
  2642*    -------------------------------
  2643     05  FILLER            PIC  X(0003).
  2644     05  L12O PIC  X(0003).
  2645*    -------------------------------
  2646     05  FILLER            PIC  X(0003).
  2647     05  TEXT12O PIC  X(0070).
  2648*    -------------------------------
  2649     05  FILLER            PIC  X(0003).
  2650     05  L13O PIC  X(0003).
  2651*    -------------------------------
  2652     05  FILLER            PIC  X(0003).
  2653     05  TEXT13O PIC  X(0070).
  2654*    -------------------------------
  2655     05  FILLER            PIC  X(0003).
  2656     05  ERRMSGO PIC  X(0072).
  2657*    -------------------------------
  2658     05  FILLER            PIC  X(0003).
  2659     05  ENTERPFO PIC  X(0002).
  2660*    -------------------------------
  2661     05  FILLER            PIC  X(0003).
  2662     05  PRINTERO PIC  X(0004).
  2663*    -------------------------------
  2664     05  FILLER            PIC  X(0003).
  2665     05  PFKEY9O PIC  X(0014).
  2666*    -------------------------------
  2667 01  MAP-REDEF REDEFINES EL152AI.
  2668     12  FILLER              PIC X(251).
  2669*    12  FILLER              PIC X(189).
  2670     12  EL152RI.
  2671       14  TEXT-LINES OCCURS 13 TIMES INDEXED BY SC-INDX.
  2672         16  SC-LINEL        PIC S9(4)  COMP.
  2673         16  SC-LINEA        PIC X.
  2674         16  SC-LINE         PIC XXX.
  2675         16  SC-TEXTL        PIC S9(4)  COMP.
  2676         16  SC-TEXTA        PIC X.
  2677         16  SC-TEXT         PIC X(70).
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  52
* EL152.cbl
  2679 01  RECORD-TABLE            PIC X(21900) VALUE SPACES.
  2680
  2681 01  REC-TABLE REDEFINES RECORD-TABLE.
  2682     12  TS-GROUP OCCURS 6 TIMES INDEXED BY TS-INDX
  2683                             PIC X(3650).
  2684
  2685 01  REC-ENTRIES REDEFINES RECORD-TABLE.
  2686     12  REC-ENT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
  2687         16  REC-TEXT        PIC X(70).
  2688         16  REC-PC          PIC 99.
  2689         16  FILLER          PIC X.
  2690
  2691 01  TS-WORK-AREA            PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  53
* EL152.cbl
  2693****************************************************************
  2694*
  2695* Copyright (c) 2007 by Clerity Solutions, Inc.
  2696* All rights reserved.
  2697*
  2698****************************************************************
  2699 01  DFHEIV.
  2700   02  DFHEIV0               PIC X(35).
  2701   02  DFHEIV1               PIC X(08).
  2702   02  DFHEIV2               PIC X(08).
  2703   02  DFHEIV3               PIC X(08).
  2704   02  DFHEIV4               PIC X(06).
  2705   02  DFHEIV5               PIC X(04).
  2706   02  DFHEIV6               PIC X(04).
  2707   02  DFHEIV7               PIC X(02).
  2708   02  DFHEIV8               PIC X(02).
  2709   02  DFHEIV9               PIC X(01).
  2710   02  DFHEIV10              PIC S9(7) COMP-3.
  2711   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2712   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2713   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2714   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2715   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2716   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2717   02  DFHEIV17              PIC X(04).
  2718   02  DFHEIV18              PIC X(04).
  2719   02  DFHEIV19              PIC X(04).
  2720   02  DFHEIV20              USAGE IS POINTER.
  2721   02  DFHEIV21              USAGE IS POINTER.
  2722   02  DFHEIV22              USAGE IS POINTER.
  2723   02  DFHEIV23              USAGE IS POINTER.
  2724   02  DFHEIV24              USAGE IS POINTER.
  2725   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2726   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2727   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2728   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2729   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2730   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2731   02  FILLER                PIC X(02).
  2732   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2733   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2734   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2735   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2736   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2737 LINKAGE  SECTION.
  2738*****************************************************************
  2739*                                                               *
  2740* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2741* All rights reserved.                                          *
  2742*                                                               *
  2743*****************************************************************
  2744 01  dfheiblk.
  2745     02  eibtime          pic s9(7) comp-3.
  2746     02  eibdate          pic s9(7) comp-3.
  2747     02  eibtrnid         pic x(4).
  2748     02  eibtaskn         pic s9(7) comp-3.
  2749     02  eibtrmid         pic x(4).
  2750     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  54
* EL152.cbl
  2751     02  eibcposn         pic s9(4) comp.
  2752     02  eibcalen         pic s9(4) comp.
  2753     02  eibaid           pic x(1).
  2754     02  eibfiller1       pic x(1).
  2755     02  eibfn            pic x(2).
  2756     02  eibfiller2       pic x(2).
  2757     02  eibrcode         pic x(6).
  2758     02  eibfiller3       pic x(2).
  2759     02  eibds            pic x(8).
  2760     02  eibreqid         pic x(8).
  2761     02  eibrsrce         pic x(8).
  2762     02  eibsync          pic x(1).
  2763     02  eibfree          pic x(1).
  2764     02  eibrecv          pic x(1).
  2765     02  eibsend          pic x(1).
  2766     02  eibatt           pic x(1).
  2767     02  eibeoc           pic x(1).
  2768     02  eibfmh           pic x(1).
  2769     02  eibcompl         pic x(1).
  2770     02  eibsig           pic x(1).
  2771     02  eibconf          pic x(1).
  2772     02  eiberr           pic x(1).
  2773     02  eibrldbk         pic x(1).
  2774     02  eiberrcd         pic x(4).
  2775     02  eibsynrb         pic x(1).
  2776     02  eibnodat         pic x(1).
  2777     02  eibfiller5       pic x(2).
  2778     02  eibresp          pic 9(09) comp.
  2779     02  eibresp2         pic 9(09) comp.
  2780     02  dfheigdj         pic s9(4) comp.
  2781     02  dfheigdk         pic s9(4) comp.
  2782 01  DFHCOMMAREA                 PIC X(1024).
  2783
  2784 01  var  pic x(30).
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  55
* EL152.cbl
  2786*                                COPY ELCMSTR.
  2787******************************************************************
  2788*                                                                *
  2789*                            ELCMSTR.                            *
  2790*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2791*                            VMOD=2.012                          *
  2792*                                                                *
  2793*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  2794*                                                                *
  2795*   FILE TYPE = VSAM,KSDS                                        *
  2796*   RECORD SIZE = 350  RECFORM = FIXED                           *
  2797*                                                                *
  2798*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  2799*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  2800*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  2801*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  2802*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  2803*                                                 RKP=75,LEN=21  *
  2804*                                                                *
  2805*   **** NOTE ****                                               *
  2806*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  2807*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  2808*                                                                *
  2809*   LOG = YES                                                    *
  2810*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2811******************************************************************
  2812*                   C H A N G E   L O G
  2813*
  2814* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2815*-----------------------------------------------------------------
  2816*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2817* EFFECTIVE    NUMBER
  2818*-----------------------------------------------------------------
  2819* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  2820* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  2821******************************************************************
  2822 01  CLAIM-MASTER.
  2823     12  CL-RECORD-ID                PIC XX.
  2824         88  VALID-CL-ID         VALUE 'CL'.
  2825
  2826     12  CL-CONTROL-PRIMARY.
  2827         16  CL-COMPANY-CD           PIC X.
  2828         16  CL-CARRIER              PIC X.
  2829         16  CL-CLAIM-NO             PIC X(7).
  2830         16  CL-CERT-NO.
  2831             20  CL-CERT-PRIME       PIC X(10).
  2832             20  CL-CERT-SFX         PIC X.
  2833
  2834     12  CL-CONTROL-BY-NAME.
  2835         16  CL-COMPANY-CD-A1        PIC X.
  2836         16  CL-INSURED-LAST-NAME    PIC X(15).
  2837         16  CL-INSURED-NAME.
  2838             20  CL-INSURED-1ST-NAME PIC X(12).
  2839             20  CL-INSURED-MID-INIT PIC X.
  2840
  2841     12  CL-CONTROL-BY-SSN.
  2842         16  CL-COMPANY-CD-A2        PIC X.
  2843         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  56
* EL152.cbl
  2844             20  CL-SSN-STATE        PIC XX.
  2845             20  CL-SSN-ACCOUNT      PIC X(6).
  2846             20  CL-SSN-LN3          PIC X(3).
  2847
  2848     12  CL-CONTROL-BY-CERT-NO.
  2849         16  CL-COMPANY-CD-A4        PIC X.
  2850         16  CL-CERT-NO-A4.
  2851             20  CL-CERT-A4-PRIME    PIC X(10).
  2852             20  CL-CERT-A4-SFX      PIC X.
  2853
  2854     12  CL-CONTROL-BY-CCN.
  2855         16  CL-COMPANY-CD-A5        PIC X.
  2856         16  CL-CCN-A5.
  2857             20  CL-CCN.
  2858                 24  CL-CCN-PREFIX-A5 PIC X(4).
  2859                 24  CL-CCN-PRIME-A5 PIC X(12).
  2860             20  CL-CCN-FILLER-A5    PIC X(4).
  2861
  2862     12  CL-INSURED-PROFILE-DATA.
  2863         16  CL-INSURED-BIRTH-DT     PIC XX.
  2864         16  CL-INSURED-SEX-CD       PIC X.
  2865             88  INSURED-IS-MALE        VALUE 'M'.
  2866             88  INSURED-IS-FEMALE      VALUE 'F'.
  2867             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  2868         16  CL-INSURED-OCC-CD       PIC X(6).
  2869         16  FILLER                  PIC X(5).
  2870
  2871     12  CL-PROCESSING-INFO.
  2872         16  CL-PROCESSOR-ID         PIC X(4).
  2873         16  CL-CLAIM-STATUS         PIC X.
  2874             88  CLAIM-IS-OPEN          VALUE 'O'.
  2875             88  CLAIM-IS-CLOSED        VALUE 'C'.
  2876         16  CL-CLAIM-TYPE           PIC X.
  2877*            88  AH-CLAIM               VALUE 'A'.
  2878*            88  LIFE-CLAIM             VALUE 'L'.
  2879*            88  PROPERTY-CLAIM         VALUE 'P'.
  2880*            88  IUI-CLAIM              VALUE 'I'.
  2881*            88  GAP-CLAIM              VALUE 'G'.
  2882         16  CL-CLAIM-PREM-TYPE      PIC X.
  2883             88  SINGLE-PREMIUM         VALUE '1'.
  2884             88  O-B-COVERAGE           VALUE '2'.
  2885             88  OPEN-END-COVERAGE      VALUE '3'.
  2886         16  CL-INCURRED-DT          PIC XX.
  2887         16  CL-REPORTED-DT          PIC XX.
  2888         16  CL-FILE-ESTABLISH-DT    PIC XX.
  2889         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  2890         16  CL-LAST-PMT-DT          PIC XX.
  2891         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  2892         16  CL-PAID-THRU-DT         PIC XX.
  2893         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  2894         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  2895         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  2896         16  CL-PMT-CALC-METHOD      PIC X.
  2897             88  CL-360-DAY-YR          VALUE '1'.
  2898             88  CL-365-DAY-YR          VALUE '2'.
  2899             88  CL-FULL-MONTHS         VALUE '3'.
  2900         16  CL-CAUSE-CD             PIC X(6).
  2901
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  57
* EL152.cbl
  2902         16  CL-PRIME-CERT-NO.
  2903             20  CL-PRIME-CERT-PRIME PIC X(10).
  2904             20  CL-PRIME-CERT-SFX   PIC X.
  2905
  2906         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  2907             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  2908             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  2909
  2910         16  CL-MICROFILM-NO         PIC X(10).
  2911         16  CL-PROG-FORM-TYPE       PIC X.
  2912         16  CL-LAST-ADD-ON-DT       PIC XX.
  2913
  2914         16  CL-LAST-REOPEN-DT       PIC XX.
  2915         16  CL-LAST-CLOSE-DT        PIC XX.
  2916         16  CL-LAST-CLOSE-REASON    PIC X(01).
  2917             88  FINAL-PAID             VALUE '1'.
  2918             88  CLAIM-DENIED           VALUE '2'.
  2919             88  AUTO-CLOSE             VALUE '3'.
  2920             88  MANUAL-CLOSE           VALUE '4'.
  2921             88  BENEFITS-CHANGED       VALUE 'C'.
  2922             88  SETUP-ERRORS           VALUE 'E'.
  2923         16  CL-ASSOC-CERT-SEQU      PIC S99.
  2924         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  2925         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  2926             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  2927         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  2928         16  FILLER                  PIC X.
  2929
  2930     12  CL-CERTIFICATE-DATA.
  2931         16  CL-CERT-ORIGIN          PIC X.
  2932             88  CERT-WAS-ONLINE        VALUE '1'.
  2933             88  CERT-WAS-CREATED       VALUE '2'.
  2934             88  COVERAGE-WAS-ADDED     VALUE '3'.
  2935         16  CL-CERT-KEY-DATA.
  2936             20  CL-CERT-CARRIER     PIC X.
  2937             20  CL-CERT-GROUPING    PIC X(6).
  2938             20  CL-CERT-STATE       PIC XX.
  2939             20  CL-CERT-ACCOUNT.
  2940                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  2941                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  2942             20  CL-CERT-EFF-DT      PIC XX.
  2943
  2944     12  CL-STATUS-CONTROLS.
  2945         16  CL-PRIORITY-CD          PIC X.
  2946             88  CONFIDENTIAL-DATA      VALUE '8'.
  2947             88  HIGHEST-PRIORITY       VALUE '9'.
  2948         16  CL-SUPV-ATTN-CD         PIC X.
  2949             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  2950             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  2951         16  CL-PURGED-DT            PIC XX.
  2952         16  CL-RESTORED-DT          PIC XX.
  2953         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  2954         16  CL-NEXT-RESEND-DT       PIC XX.
  2955         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  2956         16  FILLER                  PIC XX.
  2957         16  CL-LAST-MAINT-DT        PIC XX.
  2958         16  CL-LAST-MAINT-USER      PIC X(4).
  2959         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  58
* EL152.cbl
  2960         16  CL-LAST-MAINT-TYPE      PIC X.
  2961             88  CLAIM-SET-UP           VALUE ' '.
  2962             88  PAYMENT-MADE           VALUE '1'.
  2963             88  LETTER-SENT            VALUE '2'.
  2964             88  MASTER-WAS-ALTERED     VALUE '3'.
  2965             88  MASTER-WAS-RESTORED    VALUE '4'.
  2966             88  INCURRED-DATE-CHANGED  VALUE '5'.
  2967             88  FILE-CONVERTED         VALUE '6'.
  2968             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  2969             88  ERROR-CORRECTION       VALUE 'E'.
  2970         16  CL-RELATED-CLAIM-NO     PIC X(7).
  2971         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  2972         16  CL-BENEFICIARY          PIC X(10).
  2973         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  2974         16  CL-DENIAL-TYPE          PIC X.
  2975             88  CL-TYPE-DENIAL          VALUE '1'.
  2976             88  CL-TYPE-RESCISSION      VALUE '2'.
  2977             88  CL-TYPE-REFORMATION     VALUE '3'.
  2978             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  2979             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  2980         16  FILLER                  PIC X(5).
  2981
  2982     12  CL-TRAILER-CONTROLS.
  2983         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  2984             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  2985             88  CL-LAST-TRL-AVAIL      VALUE +100.
  2986             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  2987         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  2988         16  FILLER                  PIC XX.
  2989         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  2990         16  CL-ADDRESS-TRAILER-CNT.
  2991             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  2992                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  2993             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  2994                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  2995             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  2996                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  2997             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  2998                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  2999             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3000                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3001             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3002                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3003             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3004                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3005
  3006     12  CL-CV-REFERENCE-NO.
  3007         16  CL-CV-REFNO-PRIME       PIC X(18).
  3008         16  CL-CV-REFNO-SFX         PIC XX.
  3009
  3010     12  CL-FILE-LOCATION            PIC X(4).
  3011
  3012     12  CL-PROCESS-ERRORS.
  3013         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3014             88  NO-FATAL-ERRORS        VALUE ZERO.
  3015         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3016             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3017
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  59
* EL152.cbl
  3018     12  CL-PRODUCT-CD               PIC X.
  3019
  3020     12  CL-CURRENT-KEY-DATA.
  3021         16  CL-CURRENT-CARRIER      PIC X.
  3022         16  CL-CURRENT-GROUPING     PIC X(6).
  3023         16  CL-CURRENT-STATE        PIC XX.
  3024         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3025
  3026     12  CL-ASSOCIATES               PIC X.
  3027         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3028         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3029         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3030         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3031
  3032     12  CL-ACTIVITY-CODE            PIC 99.
  3033     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3034     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3035
  3036     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3037     12  CL-LAG-REPORT-CODE          PIC 9.
  3038     12  CL-LOAN-TYPE                PIC XX.
  3039     12  CL-LEGAL-STATE              PIC XX.
  3040
  3041*    12  FILLER                      PIC X(5).
  3042     12  CL-YESNOSW                  PIC X.
  3043     12  FILLER                      PIC X(4).
  3044
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  60
* EL152.cbl
  3046*                                COPY ELCCNTL.
  3047******************************************************************
  3048*                                                                *
  3049*                                                                *
  3050*                            ELCCNTL.                            *
  3051*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3052*                            VMOD=2.059                          *
  3053*                                                                *
  3054*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3055*                                                                *
  3056*   FILE TYPE = VSAM,KSDS                                        *
  3057*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3058*                                                                *
  3059*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3060*       ALTERNATE INDEX = NONE                                   *
  3061*                                                                *
  3062*   LOG = YES                                                    *
  3063*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3064******************************************************************
  3065*                   C H A N G E   L O G
  3066*
  3067* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3068*-----------------------------------------------------------------
  3069*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3070* EFFECTIVE    NUMBER
  3071*-----------------------------------------------------------------
  3072* 082503                   PEMA  ADD BENEFIT GROUP
  3073* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3074* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3075* 092705    2005050300006  PEMA  ADD SPP LEASES
  3076* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3077* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3078* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3079* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3080* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3081******************************************************************
  3082*
  3083 01  CONTROL-FILE.
  3084     12  CF-RECORD-ID                       PIC XX.
  3085         88  VALID-CF-ID                        VALUE 'CF'.
  3086
  3087     12  CF-CONTROL-PRIMARY.
  3088         16  CF-COMPANY-ID                  PIC XXX.
  3089         16  CF-RECORD-TYPE                 PIC X.
  3090             88  CF-COMPANY-MASTER              VALUE '1'.
  3091             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3092             88  CF-STATE-MASTER                VALUE '3'.
  3093             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3094             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3095             88  CF-CARRIER-MASTER              VALUE '6'.
  3096             88  CF-MORTALITY-MASTER            VALUE '7'.
  3097             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3098             88  CF-TERMINAL-MASTER             VALUE '9'.
  3099             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3100             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3101             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3102             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3103             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  61
* EL152.cbl
  3104             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3105             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3106             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3107             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3108         16  CF-ACCESS-CD-GENL              PIC X(4).
  3109         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3110             20  CF-PROCESSOR               PIC X(4).
  3111         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3112             20  CF-STATE-CODE              PIC XX.
  3113             20  FILLER                     PIC XX.
  3114         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3115             20  FILLER                     PIC XX.
  3116             20  CF-HI-BEN-IN-REC           PIC XX.
  3117         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3118             20  FILLER                     PIC XXX.
  3119             20  CF-CARRIER-CNTL            PIC X.
  3120         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3121             20  FILLER                     PIC XX.
  3122             20  CF-HI-TYPE-IN-REC          PIC 99.
  3123         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3124             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3125                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3126             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3127             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3128         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3129             20  FILLER                     PIC X.
  3130             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3131         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3132             20  FILLER                     PIC XX.
  3133             20  CF-MORTGAGE-PLAN           PIC XX.
  3134         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3135
  3136     12  CF-LAST-MAINT-DT                   PIC XX.
  3137     12  CF-LAST-MAINT-BY                   PIC X(4).
  3138     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3139
  3140     12  CF-RECORD-BODY                     PIC X(728).
  3141
  3142
  3143****************************************************************
  3144*             COMPANY MASTER RECORD                            *
  3145****************************************************************
  3146
  3147     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3148         16  CF-COMPANY-ADDRESS.
  3149             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3150             20  CF-CL-IN-CARE-OF           PIC X(30).
  3151             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3152             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3153             20  CF-CL-CITY-STATE           PIC X(30).
  3154             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3155             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3156         16  CF-COMPANY-CD                  PIC X.
  3157         16  CF-COMPANY-PASSWORD            PIC X(8).
  3158         16  CF-SECURITY-OPTION             PIC X.
  3159             88  ALL-SECURITY                   VALUE '1'.
  3160             88  COMPANY-VERIFY                 VALUE '2'.
  3161             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  62
* EL152.cbl
  3162             88  NO-SECURITY                    VALUE '4'.
  3163             88  ALL-BUT-TERM                   VALUE '5'.
  3164         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3165             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3166         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3167             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3168         16  CF-INFORCE-LOCATION            PIC X.
  3169             88  CERTS-ARE-ONLINE               VALUE '1'.
  3170             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3171             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3172         16  CF-LOWER-CASE-LETTERS          PIC X.
  3173         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3174             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3175             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3176             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3177             88  CF-ACCNT-CNTL                  VALUE '3'.
  3178             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3179
  3180         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3181         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3182
  3183         16  CF-LGX-CREDIT-USER             PIC X.
  3184             88  CO-IS-NOT-USER                 VALUE 'N'.
  3185             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3186
  3187         16 CF-CREDIT-CALC-CODES.
  3188             20  CF-CR-REM-TERM-CALC PIC X.
  3189               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3190               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3191               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3192               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3193               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3194               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3195               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3196             20  CF-CR-R78-METHOD           PIC X.
  3197               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3198               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3199
  3200         16  CF-CLAIM-CONTROL-COUNTS.
  3201             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3202                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3203
  3204             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3205                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3206
  3207             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3208                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3209
  3210             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3211                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3212
  3213         16  CF-CURRENT-MONTH-END           PIC XX.
  3214
  3215         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3216             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3217             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3218             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3219             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  63
* EL152.cbl
  3220                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3221                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3222             20  CF-CO-PREM-REJECT-SW       PIC X.
  3223                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3224                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3225             20  CF-CO-REF-REJECT-SW        PIC X.
  3226                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3227                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3228
  3229         16  CF-CO-REPORTING-DT             PIC XX.
  3230         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3231         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3232           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3233           88  CF-CO-MONTH-END                  VALUE '1'.
  3234
  3235         16  CF-LGX-CLAIM-USER              PIC X.
  3236             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3237             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3238
  3239         16  CF-CREDIT-EDIT-CONTROLS.
  3240             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3241             20  CF-MIN-AGE                 PIC 99.
  3242             20  CF-DEFAULT-AGE             PIC 99.
  3243             20  CF-MIN-TERM                PIC S999      COMP-3.
  3244             20  CF-MAX-TERM                PIC S999      COMP-3.
  3245             20  CF-DEFAULT-SEX             PIC X.
  3246             20  CF-JOINT-AGE-INPUT         PIC X.
  3247                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3248             20  CF-BIRTH-DATE-INPUT        PIC X.
  3249                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3250             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3251                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3252                 88  CF-ZERO-CARRIER            VALUE '1'.
  3253                 88  CF-ZERO-GROUPING           VALUE '2'.
  3254                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3255             20  CF-EDIT-SW                 PIC X.
  3256                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3257             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3258             20  CF-CR-PR-METHOD            PIC X.
  3259               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3260               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3261             20  FILLER                     PIC X.
  3262
  3263         16  CF-CREDIT-MISC-CONTROLS.
  3264             20  CF-REIN-TABLE-SW           PIC X.
  3265                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3266             20  CF-COMP-TABLE-SW           PIC X.
  3267                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3268             20  CF-EXPERIENCE-RETENTION-AGE
  3269                                            PIC S9        COMP-3.
  3270             20  CF-CONVERSION-DT           PIC XX.
  3271             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3272             20  CF-RUN-FREQUENCY-SW        PIC X.
  3273                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3274                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3275
  3276             20  CF-CR-CHECK-NO-CONTROL.
  3277                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  64
* EL152.cbl
  3278                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3279                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3280                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3281                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3282                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3283
  3284                 24  CF-CR-CHECK-COUNT       REDEFINES
  3285                     CF-CR-CHECK-COUNTER      PIC X(4).
  3286
  3287                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3288                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3289
  3290                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3291                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3292                 24  CF-MAIL-PROCESSING       PIC X.
  3293                     88  MAIL-PROCESSING          VALUE 'Y'.
  3294
  3295         16  CF-MISC-SYSTEM-CONTROL.
  3296             20  CF-SYSTEM-C                 PIC X.
  3297                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3298             20  CF-SYSTEM-D                 PIC X.
  3299                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3300             20  CF-SOC-SEC-NO-SW            PIC X.
  3301                 88  SOC-SEC-NO-USED             VALUE '1'.
  3302             20  CF-MEMBER-NO-SW             PIC X.
  3303                 88  MEMBER-NO-USED              VALUE '1'.
  3304             20  CF-TAX-ID-NUMBER            PIC X(11).
  3305             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3306             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3307                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3308                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3309                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3310                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3311             20  CF-SYSTEM-E                 PIC X.
  3312                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3313
  3314         16  CF-LGX-LIFE-USER               PIC X.
  3315             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3316             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3317
  3318         16  CF-CR-MONTH-END-DT             PIC XX.
  3319
  3320         16  CF-FILE-MAINT-DATES.
  3321             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3322                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3323             20  CF-LAST-BATCH       REDEFINES
  3324                 CF-LAST-BATCH-NO               PIC X(4).
  3325             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3326             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3327             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3328             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3329             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3330             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3331             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3332             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3333             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3334             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3335
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  65
* EL152.cbl
  3336         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3337         16  FILLER                         PIC X.
  3338
  3339         16  CF-ALT-MORT-CODE               PIC X(4).
  3340         16  CF-MEMBER-CAPTION              PIC X(10).
  3341
  3342         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3343             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3344             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3345             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3346             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3347             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3348
  3349         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3350
  3351         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3352         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3353         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3354         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3355
  3356         16  CF-AH-OVERRIDE-L1              PIC X.
  3357         16  CF-AH-OVERRIDE-L2              PIC XX.
  3358         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3359         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3360
  3361         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3362         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3363
  3364         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3365         16  CF-AR-LAST-EL860-DT            PIC XX.
  3366         16  CF-MP-MONTH-END-DT             PIC XX.
  3367
  3368         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3369         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3370             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3371
  3372         16  CF-AR-MONTH-END-DT             PIC XX.
  3373
  3374         16  CF-CRDTCRD-USER                PIC X.
  3375             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3376             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3377
  3378         16  CF-CC-MONTH-END-DT             PIC XX.
  3379
  3380         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3381
  3382         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3383             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3384             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3385             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3386         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3387         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3388         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3389         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3390             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3391             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3392         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3393         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  66
* EL152.cbl
  3394         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3395             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3396         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3397
  3398         16  CF-CL-ZIP-CODE.
  3399             20  CF-CL-ZIP-PRIME.
  3400                 24  CF-CL-ZIP-1ST          PIC X.
  3401                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3402                 24  FILLER                 PIC X(4).
  3403             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3404         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3405             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3406             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3407             20  FILLER                     PIC XXX.
  3408
  3409         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3410         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3411         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3412         16  CF-CO-OPTION-START-DATE        PIC XX.
  3413         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3414           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3415                                                      '3' '4'.
  3416           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3417           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3418           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3419           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3420           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3421           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3422
  3423         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3424
  3425         16  CF-PAYMENT-APPROVAL-LEVELS.
  3426             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3427             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3428             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3429             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3430             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3431             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3432
  3433         16  CF-END-USER-REPORTING-USER     PIC X.
  3434             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3435             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3436
  3437         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3438             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3439             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3440
  3441         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3442
  3443         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3444         16  FILLER                         PIC X.
  3445
  3446         16  CF-CREDIT-ARCHIVE-CNTL.
  3447             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3448             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3449             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3450
  3451         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  67
* EL152.cbl
  3452
  3453         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3454             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3455             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3456
  3457         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3458             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3459             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3460
  3461         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3462
  3463         16  CF-CO-ACH-ID-CODE              PIC  X.
  3464             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3465             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3466             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3467         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3468         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3469         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3470         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3471         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3472         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3473         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3474         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3475         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3476                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3477         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3478                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3479
  3480         16  CF-CO-OVER-SHORT.
  3481             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3482             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3483
  3484*         16  FILLER                         PIC X(102).
  3485         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3486             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3487             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3488
  3489         16  CF-AH-APPROVAL-DAYS.
  3490             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3491             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3492             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3493             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3494
  3495         16  FILLER                         PIC X(82).
  3496****************************************************************
  3497*             PROCESSOR/USER RECORD                            *
  3498****************************************************************
  3499
  3500     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3501         16  CF-PROCESSOR-NAME              PIC X(30).
  3502         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3503         16  CF-PROCESSOR-TITLE             PIC X(26).
  3504         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3505                 88  MESSAGE-YES                VALUE 'Y'.
  3506                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3507
  3508*****************************************************
  3509****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  68
* EL152.cbl
  3510****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3511****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3512****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3513*****************************************************
  3514
  3515         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3516             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3517             20  CF-APPLICATION-FORCE       PIC X.
  3518             20  CF-INDIVIDUAL-APP.
  3519                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3520                     28  CF-BROWSE-APP      PIC X.
  3521                     28  CF-UPDATE-APP      PIC X.
  3522
  3523         16  CF-CURRENT-TERM-ON             PIC X(4).
  3524         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3525             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3526             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3527             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3528             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3529             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3530             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3531             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3532         16  CF-PROCESSOR-CARRIER           PIC X.
  3533             88  NO-CARRIER-SECURITY            VALUE ' '.
  3534         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3535             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3536         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3537             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3538         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3539             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3540
  3541         16  CF-PROC-SYS-ACCESS-SW.
  3542             20  CF-PROC-CREDIT-CLAIMS-SW.
  3543                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3544                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3545                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3546                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3547             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3548                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3549                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3550             20  CF-PROC-LIFE-GNRLDGR-SW.
  3551                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3552                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3553                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3554                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3555             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3556                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3557                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3558         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3559             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3560             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3561         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3562
  3563         16  CF-APPROVAL-LEVEL                  PIC X.
  3564             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3565             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3566             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3567             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  69
* EL152.cbl
  3568
  3569         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3570
  3571         16  CF-LANGUAGE-TYPE                   PIC X.
  3572             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3573             88  CF-LANG-IS-FR                      VALUE 'F'.
  3574         16  FILLER                             PIC  X(240).
  3575
  3576****************************************************************
  3577*             PROCESSOR/REMINDERS RECORD                       *
  3578****************************************************************
  3579
  3580     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3581         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3582             20  CF-START-REMIND-DT         PIC XX.
  3583             20  CF-END-REMIND-DT           PIC XX.
  3584             20  CF-REMINDER-TEXT           PIC X(50).
  3585         16  FILLER                         PIC X(296).
  3586
  3587
  3588****************************************************************
  3589*             STATE MASTER RECORD                              *
  3590****************************************************************
  3591
  3592     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3593         16  CF-STATE-ABBREVIATION          PIC XX.
  3594         16  CF-STATE-NAME                  PIC X(25).
  3595         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3596         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3597             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3598             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3599             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3600             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3601                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3602                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3603             20  CF-ST-PREM-REJECT-SW       PIC X.
  3604                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3605                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3606             20  CF-ST-REF-REJECT-SW        PIC X.
  3607                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3608                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3609         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3610         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3611         16  CF-ST-REFUND-RULES.
  3612             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3613             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3614             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3615         16  CF-ST-FST-PMT-EXTENSION.
  3616             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3617             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3618                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3619                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3620                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3621                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3622         16  CF-ST-STATE-CALL.
  3623             20  CF-ST-CALL-UNEARNED        PIC X.
  3624             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3625             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  70
* EL152.cbl
  3626         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3627             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3628             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3629         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3630         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3631         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3632         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3633         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3634         16  FILLER                         PIC X.
  3635         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3636             20  CF-ST-BENEFIT-CD           PIC XX.
  3637             20  CF-ST-BENEFIT-KIND         PIC X.
  3638                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3639                 88  CF-ST-AH-KIND              VALUE 'A'.
  3640             20  CF-ST-REM-TERM-CALC        PIC X.
  3641                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3642                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3643                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3644                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3645                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3646                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3647                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3648                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3649
  3650             20  CF-ST-REFUND-CALC          PIC X.
  3651                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3652                 88  ST-REFD-BY-R78             VALUE '1'.
  3653                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3654                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3655                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3656                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3657                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3658                 88  ST-REFD-UTAH               VALUE '7'.
  3659                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3660                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3661                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3662
  3663             20  CF-ST-EARNING-CALC         PIC X.
  3664                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3665                 88  ST-EARN-BY-R78             VALUE '1'.
  3666                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3667                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3668                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3669                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3670                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3671                 88  ST-EARN-MEAN               VALUE '8'.
  3672                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3673
  3674             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3675                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3676                 88  ST-OVRD-BY-R78             VALUE '1'.
  3677                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3678                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3679                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3680                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3681                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3682                 88  ST-OVRD-MEAN               VALUE '8'.
  3683                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  71
* EL152.cbl
  3684             20  FILLER                     PIC X.
  3685
  3686         16  CF-ST-COMMISSION-CAPS.
  3687             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3688             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3689             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3690             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3691         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3692                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3693
  3694         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3695
  3696         16  CF-ST-STATUTORY-INTEREST.
  3697             20  CF-ST-STAT-DATE-FROM       PIC X.
  3698                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3699                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3700             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3701             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3702             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3703             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3704             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3705
  3706         16  CF-ST-OVER-SHORT.
  3707             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3708             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3709
  3710         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3711
  3712         16  CF-ST-RT-CALC                  PIC X.
  3713
  3714         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3715         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3716         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3717         16  CF-ST-RF-LR-CALC               PIC X.
  3718         16  CF-ST-RF-LL-CALC               PIC X.
  3719         16  CF-ST-RF-LN-CALC               PIC X.
  3720         16  CF-ST-RF-AH-CALC               PIC X.
  3721         16  CF-ST-RF-CP-CALC               PIC X.
  3722*        16  FILLER                         PIC X(206).
  3723*CIDMOD         16  FILLER                         PIC X(192).
  3724         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3725             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3726         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3727         16  CF-ST-VFY-2ND-BENE             PIC X.
  3728         16  FILLER                         PIC X(186).
  3729
  3730****************************************************************
  3731*             BENEFIT MASTER RECORD                            *
  3732****************************************************************
  3733
  3734     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3735         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3736             20  CF-BENEFIT-CODE            PIC XX.
  3737             20  CF-BENEFIT-NUMERIC  REDEFINES
  3738                 CF-BENEFIT-CODE            PIC XX.
  3739             20  CF-BENEFIT-ALPHA           PIC XXX.
  3740             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3741             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  72
* EL152.cbl
  3742
  3743             20  CF-LF-COVERAGE-TYPE        PIC X.
  3744                 88  CF-REDUCING                VALUE 'R'.
  3745                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3746
  3747             20  CF-SPECIAL-CALC-CD         PIC X.
  3748                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3749                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3750                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3751                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3752                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3753                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3754                 88  CF-FARM-PLAN               VALUE 'F'.
  3755                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3756                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3757                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3758                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3759                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3760                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3761                 88  CF-PRUDENTIAL              VALUE 'P'.
  3762                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3763                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3764                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3765                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3766                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3767                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3768
  3769             20  CF-JOINT-INDICATOR         PIC X.
  3770                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3771
  3772*            20  FILLER                     PIC X(12).
  3773             20  FILLER                     PIC X(11).
  3774             20  CF-BENEFIT-CATEGORY        PIC X.
  3775             20  CF-LOAN-TYPE               PIC X(8).
  3776
  3777             20  CF-CO-REM-TERM-CALC        PIC X.
  3778                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3779                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3780                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3781                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3782                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3783
  3784             20  CF-CO-EARNINGS-CALC        PIC X.
  3785                 88  CO-EARN-BY-R78             VALUE '1'.
  3786                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3787                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3788                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3789                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3790                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3791                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3792                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3793
  3794             20  CF-CO-REFUND-CALC          PIC X.
  3795                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3796                 88  CO-REFD-BY-R78             VALUE '1'.
  3797                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3798                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3799                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  73
* EL152.cbl
  3800                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3801                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3802                 88  CO-REFD-MEAN               VALUE '8'.
  3803                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3804                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3805                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3806
  3807             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3808                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3809                 88  CO-OVRD-BY-R78             VALUE '1'.
  3810                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3811                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3812                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3813                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3814                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3815                 88  CO-OVRD-MEAN               VALUE '8'.
  3816                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3817
  3818             20  CF-CO-BEN-I-G-CD           PIC X.
  3819                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3820                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3821                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3822
  3823         16  FILLER                         PIC X(304).
  3824
  3825
  3826****************************************************************
  3827*             CARRIER MASTER RECORD                            *
  3828****************************************************************
  3829
  3830     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3831         16  CF-ADDRESS-DATA.
  3832             20  CF-MAIL-TO-NAME            PIC X(30).
  3833             20  CF-IN-CARE-OF              PIC X(30).
  3834             20  CF-ADDRESS-LINE-1          PIC X(30).
  3835             20  CF-ADDRESS-LINE-2          PIC X(30).
  3836             20  CF-CITY-STATE              PIC X(30).
  3837             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3838             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3839
  3840         16  CF-CLAIM-NO-CONTROL.
  3841             20  CF-CLAIM-NO-METHOD         PIC X.
  3842                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3843                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3844                 88  CLAIM-NO-SEQ               VALUE '3'.
  3845                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3846             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3847                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3848                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3849                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3850
  3851         16  CF-CHECK-NO-CONTROL.
  3852             20  CF-CHECK-NO-METHOD         PIC X.
  3853                 88  CHECK-NO-MANUAL            VALUE '1'.
  3854                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3855                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3856                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3857             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  74
* EL152.cbl
  3858                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3859
  3860         16  CF-DOMICILE-STATE              PIC XX.
  3861
  3862         16  CF-EXPENSE-CONTROLS.
  3863             20  CF-EXPENSE-METHOD          PIC X.
  3864                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3865                 88  DOLLARS-PER-PMT            VALUE '2'.
  3866                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3867                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3868             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3869             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3870
  3871         16  CF-CORRESPONDENCE-CONTROL.
  3872             20  CF-LETTER-RESEND-OPT       PIC X.
  3873                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3874                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3875             20  FILLER                     PIC X(4).
  3876
  3877         16  CF-RESERVE-CONTROLS.
  3878             20  CF-MANUAL-SW               PIC X.
  3879                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3880             20  CF-FUTURE-SW               PIC X.
  3881                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3882             20  CF-PTC-SW                  PIC X.
  3883                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3884             20  CF-IBNR-SW                 PIC X.
  3885                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3886             20  CF-PTC-LF-SW               PIC X.
  3887                 88  CF-LF-PTC-USED             VALUE '1'.
  3888             20  CF-CDT-ACCESS-METHOD       PIC X.
  3889                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3890                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3891                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3892             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3893
  3894         16  CF-CLAIM-CALC-METHOD           PIC X.
  3895             88  360-PLUS-MONTHS                VALUE '1'.
  3896             88  365-PLUS-MONTHS                VALUE '2'.
  3897             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3898             88  360-DAILY                      VALUE '4'.
  3899             88  365-DAILY                      VALUE '5'.
  3900
  3901         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3902         16  FILLER                         PIC X(11).
  3903
  3904         16  CF-LIMIT-AMOUNTS.
  3905             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3906             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3907             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3908             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3909             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3910             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3911             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3912             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3913             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3914             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3915
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  75
* EL152.cbl
  3916         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3917         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3918         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3919
  3920         16  CF-ZIP-CODE.
  3921             20  CF-ZIP-PRIME.
  3922                 24  CF-ZIP-1ST             PIC X.
  3923                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3924                 24  FILLER                 PIC X(4).
  3925             20  CF-ZIP-PLUS4               PIC X(4).
  3926         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3927             20  CF-CAN-POSTAL-1            PIC XXX.
  3928             20  CF-CAN-POSTAL-2            PIC XXX.
  3929             20  FILLER                     PIC XXX.
  3930
  3931         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3932         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3933         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3934
  3935         16  CF-RATING-SWITCH               PIC X.
  3936             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3937             88  CF-NO-RATING                   VALUE 'N'.
  3938
  3939         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3940
  3941         16  CF-CARRIER-OVER-SHORT.
  3942             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3943             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3944
  3945         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3946         16  CF-SECPAY-SWITCH               PIC X.
  3947             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3948             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3949         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3950         16  FILLER                         PIC X(448).
  3951*        16  FILLER                         PIC X(452).
  3952
  3953
  3954****************************************************************
  3955*             MORTALITY MASTER RECORD                          *
  3956****************************************************************
  3957
  3958     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3959         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3960                                INDEXED BY CF-MORT-NDX.
  3961             20  CF-MORT-TABLE              PIC X(5).
  3962             20  CF-MORT-TABLE-TYPE         PIC X.
  3963                 88  CF-MORT-JOINT              VALUE 'J'.
  3964                 88  CF-MORT-SINGLE             VALUE 'S'.
  3965                 88  CF-MORT-COMBINED           VALUE 'C'.
  3966                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3967                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3968             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3969             20  CF-MORT-AGE-METHOD         PIC XX.
  3970                 88  CF-AGE-LAST                VALUE 'AL'.
  3971                 88  CF-AGE-NEAR                VALUE 'AN'.
  3972             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3973             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  76
* EL152.cbl
  3974                                            PIC X.
  3975                 88  CF-MINUS                   VALUE '-'.
  3976                 88  CF-PLUS                    VALUE '+'.
  3977             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3978             20  CF-MORT-JOINT-CODE         PIC X.
  3979                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3980             20  CF-MORT-PC-Q               PIC X.
  3981                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3982             20  CF-MORT-TABLE-CODE         PIC X(4).
  3983             20  CF-MORT-COMMENTS           PIC X(15).
  3984             20  FILLER                     PIC X(14).
  3985
  3986         16  FILLER                         PIC X(251).
  3987
  3988
  3989****************************************************************
  3990*             BUSSINESS TYPE MASTER RECORD                     *
  3991****************************************************************
  3992
  3993     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3994* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3995* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3996* AND RECORD 05 IS TYPES 81-99
  3997         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3998             20  CF-BUSINESS-TITLE          PIC  X(19).
  3999             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4000                                            PIC S9V9(4) COMP-3.
  4001             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4002             20  FILLER                     PIC  X.
  4003         16  FILLER                         PIC  X(248).
  4004
  4005
  4006****************************************************************
  4007*             TERMINAL MASTER RECORD                           *
  4008****************************************************************
  4009
  4010     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4011
  4012         16  CF-COMPANY-TERMINALS.
  4013             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4014                                  PIC X(4).
  4015         16  FILLER               PIC X(248).
  4016
  4017
  4018****************************************************************
  4019*             LIFE EDIT MASTER RECORD                          *
  4020****************************************************************
  4021
  4022     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4023         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4024             20  CF-LIFE-CODE-IN            PIC XX.
  4025             20  CF-LIFE-CODE-OUT           PIC XX.
  4026         16  FILLER                         PIC X(248).
  4027
  4028
  4029****************************************************************
  4030*             AH EDIT MASTER RECORD                            *
  4031****************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  77
* EL152.cbl
  4032
  4033     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4034         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4035             20  CF-AH-CODE-IN              PIC XXX.
  4036             20  CF-AH-CODE-OUT             PIC XX.
  4037         16  FILLER                         PIC X(248).
  4038
  4039
  4040****************************************************************
  4041*             CREDIBILITY TABLES                               *
  4042****************************************************************
  4043
  4044     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4045         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4046                             INDEXED BY CF-CRDB-NDX.
  4047             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4048             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4049             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4050         16  FILLER                         PIC  X(332).
  4051
  4052
  4053****************************************************************
  4054*             REPORT CUSTOMIZATION RECORD                      *
  4055****************************************************************
  4056
  4057     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4058         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4059             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4060             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4061             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4062**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4063****       A T-TRANSFER.                                   ****
  4064             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4065
  4066         16  FILLER                         PIC XX.
  4067
  4068         16  CF-CARRIER-CNTL-OPT.
  4069             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4070                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4071                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4072             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4073                                            PIC X.
  4074         16  CF-GROUP-CNTL-OPT.
  4075             20  CF-GROUP-OPT-SEQ           PIC 9.
  4076                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4077                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4078             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4079                                            PIC X(6).
  4080         16  CF-STATE-CNTL-OPT.
  4081             20  CF-STATE-OPT-SEQ           PIC 9.
  4082                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4083                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4084             20  CF-STATE-SELECT OCCURS 3 TIMES
  4085                                            PIC XX.
  4086         16  CF-ACCOUNT-CNTL-OPT.
  4087             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4088                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4089                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  78
* EL152.cbl
  4090             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4091                                            PIC X(10).
  4092         16  CF-BUS-TYP-CNTL-OPT.
  4093             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4094                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4095                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4096             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4097                                            PIC XX.
  4098         16  CF-LF-TYP-CNTL-OPT.
  4099             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4100                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4101                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4102             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4103                                            PIC XX.
  4104         16  CF-AH-TYP-CNTL-OPT.
  4105             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4106                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4107                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4108             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4109                                            PIC XX.
  4110         16  CF-REPTCD1-CNTL-OPT.
  4111             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4112                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4113                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4114             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4115                                            PIC X(10).
  4116         16  CF-REPTCD2-CNTL-OPT.
  4117             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4118                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4119                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4120             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4121                                            PIC X(10).
  4122         16  CF-USER1-CNTL-OPT.
  4123             20  CF-USER1-OPT-SEQ           PIC 9.
  4124                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4125                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4126             20  CF-USER1-SELECT OCCURS 3 TIMES
  4127                                            PIC X(10).
  4128         16  CF-USER2-CNTL-OPT.
  4129             20  CF-USER2-OPT-SEQ           PIC 9.
  4130                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4131                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4132             20  CF-USER2-SELECT OCCURS 3 TIMES
  4133                                            PIC X(10).
  4134         16  CF-USER3-CNTL-OPT.
  4135             20  CF-USER3-OPT-SEQ           PIC 9.
  4136                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4137                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4138             20  CF-USER3-SELECT OCCURS 3 TIMES
  4139                                            PIC X(10).
  4140         16  CF-USER4-CNTL-OPT.
  4141             20  CF-USER4-OPT-SEQ           PIC 9.
  4142                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4143                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4144             20  CF-USER4-SELECT OCCURS 3 TIMES
  4145                                            PIC X(10).
  4146         16  CF-USER5-CNTL-OPT.
  4147             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  79
* EL152.cbl
  4148                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4149                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4150             20  CF-USER5-SELECT OCCURS 3 TIMES
  4151                                            PIC X(10).
  4152         16  CF-REINS-CNTL-OPT.
  4153             20  CF-REINS-OPT-SEQ           PIC 9.
  4154                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4155                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4156             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4157                 24  CF-REINS-PRIME         PIC XXX.
  4158                 24  CF-REINS-SUB           PIC XXX.
  4159
  4160         16  CF-AGENT-CNTL-OPT.
  4161             20  CF-AGENT-OPT-SEQ           PIC 9.
  4162                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4163                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4164             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4165                                            PIC X(10).
  4166
  4167         16  FILLER                         PIC X(43).
  4168
  4169         16  CF-LOSS-RATIO-SELECT.
  4170             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4171             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4172         16  CF-ENTRY-DATE-SELECT.
  4173             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4174             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4175         16  CF-EFFECTIVE-DATE-SELECT.
  4176             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4177             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4178
  4179         16  CF-EXCEPTION-LIST-IND          PIC X.
  4180             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4181
  4182         16  FILLER                         PIC X(318).
  4183
  4184****************************************************************
  4185*                  EXCEPTION REPORTING RECORD                  *
  4186****************************************************************
  4187
  4188     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4189         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4190             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4191
  4192         16  CF-COMBINED-LIFE-AH-OPT.
  4193             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4194             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4195             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4196             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4197
  4198         16  CF-LIFE-OPT.
  4199             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4200             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4201             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4202             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4203             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4204             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4205             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  80
* EL152.cbl
  4206             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4207             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4208             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4209
  4210         16  CF-AH-OPT.
  4211             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4212             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4213             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4214             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4215             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4216             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4217             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4218             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4219             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4220             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4221
  4222         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4223             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4224             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4225             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4226
  4227         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4228
  4229         16  FILLER                         PIC X(673).
  4230
  4231
  4232****************************************************************
  4233*             MORTGAGE SYSTEM PLAN RECORD                      *
  4234****************************************************************
  4235
  4236     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4237         16  CF-PLAN-TYPE                   PIC X.
  4238             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4239             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4240             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4241         16  CF-PLAN-ABBREV                 PIC XXX.
  4242         16  CF-PLAN-DESCRIPT               PIC X(10).
  4243         16  CF-PLAN-NOTES                  PIC X(20).
  4244         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4245         16  CF-PLAN-UNDERWRITING.
  4246             20  CF-PLAN-TERM-DATA.
  4247                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4248                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4249             20  CF-PLAN-AGE-DATA.
  4250                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4251                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4252                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4253             20  CF-PLAN-BENEFIT-DATA.
  4254                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4255                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4256                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4257                                            PIC S9(7)V99  COMP-3.
  4258         16  CF-PLAN-POLICY-FORMS.
  4259             20  CF-POLICY-FORM             PIC X(12).
  4260             20  CF-MASTER-APPLICATION      PIC X(12).
  4261             20  CF-MASTER-POLICY           PIC X(12).
  4262         16  CF-PLAN-RATING.
  4263             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  81
* EL152.cbl
  4264             20  CF-SEX-RATING              PIC X.
  4265                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4266                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4267             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4268             20  CF-SUB-STD-TYPE            PIC X.
  4269                 88  CF-PCT-OF-PREM            VALUE '1'.
  4270                 88  CF-PCT-OF-BENE            VALUE '2'.
  4271         16  CF-PLAN-PREM-TOLERANCES.
  4272             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4273             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4274         16  CF-PLAN-PYMT-TOLERANCES.
  4275             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4276             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4277         16  CF-PLAN-MISC-DATA.
  4278             20  FILLER                     PIC X.
  4279             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4280             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4281         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4282         16  CF-PLAN-IND-GRP                PIC X.
  4283             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4284                                                     '1'.
  4285             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4286                                                     '2'.
  4287         16  CF-MIB-SEARCH-SW               PIC X.
  4288             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4289             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4290             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4291             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4292         16  CF-ALPHA-SEARCH-SW             PIC X.
  4293             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4294             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4295             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4296             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4297             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4298             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4299             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4300             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4301             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4302             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4303                                                     'A' 'B' 'C'
  4304                                                     'X' 'Y' 'Z'.
  4305         16  CF-EFF-DT-RULE-SW              PIC X.
  4306             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4307             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4308             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4309             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4310             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4311         16  FILLER                         PIC X(4).
  4312         16  CF-HEALTH-QUESTIONS            PIC X.
  4313             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4314         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4315         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4316         16  CF-PLAN-SNGL-JNT               PIC X.
  4317             88  CF-COMBINED-PLAN              VALUE 'C'.
  4318             88  CF-JNT-PLAN                   VALUE 'J'.
  4319             88  CF-SNGL-PLAN                  VALUE 'S'.
  4320         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4321         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  82
* EL152.cbl
  4322         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4323         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4324         16  CF-RERATE-CNTL                 PIC  X.
  4325             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4326             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4327             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4328             88  CF-AUTO-RECALC                 VALUE '4'.
  4329         16  CF-BENEFIT-TYPE                PIC  X.
  4330             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4331             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4332         16  CF-POLICY-FEE                  PIC S999V99
  4333                                                    COMP-3.
  4334         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4335         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4336         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4337         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4338         16  FILLER                         PIC  X(32).
  4339         16  CF-TERMINATION-FORM            PIC  X(04).
  4340         16  FILLER                         PIC  X(08).
  4341         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4342                                                       COMP-3.
  4343         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4344         16  CF-ISSUE-LETTER                PIC  X(4).
  4345         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4346         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4347             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4348             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4349         16  CF-MP-REFUND-CALC              PIC X.
  4350             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4351             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4352             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4353             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4354             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4355             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4356             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4357             88  CF-MP-REFD-MEAN                VALUE '8'.
  4358         16  CF-ALT-RATE-CODE               PIC  X(5).
  4359
  4360
  4361         16  FILLER                         PIC X(498).
  4362****************************************************************
  4363*             MORTGAGE COMPANY MASTER RECORD                   *
  4364****************************************************************
  4365
  4366     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4367         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4368         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4369             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4370             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4371             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4372             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4373             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4374
  4375         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4376         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4377         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4378         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4379         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  83
* EL152.cbl
  4380
  4381         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4382             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4383         16  CF-MP-RECON-USE-IND            PIC X(1).
  4384             88  CF-MP-USE-RECON             VALUE 'Y'.
  4385         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4386             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4387         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4388             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4389             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4390         16  FILLER                         PIC X(1).
  4391         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4392             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4393         16  CF-MORTG-MIB-VERSION           PIC X.
  4394             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4395             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4396             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4397         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4398             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4399                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4400             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4401                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4402             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4403                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4404             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4405                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4406             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4407                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4408             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4409                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4410         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4411         16  FILLER                         PIC X(7).
  4412         16  CF-MORTG-DESTINATION-SYMBOL.
  4413             20  CF-MORTG-MIB-COMM          PIC X(5).
  4414             20  CF-MORTG-MIB-TERM          PIC X(5).
  4415         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4416             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4417         16  FILLER                         PIC X(03).
  4418         16  CF-MP-CHECK-NO-CONTROL.
  4419             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4420                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4421                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4422                                                ' ' LOW-VALUES.
  4423                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4424                                               VALUE '3'.
  4425         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4426         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4427         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4428             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4429                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4430             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4431                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4432             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4433                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4434             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4435                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4436             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4437                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  84
* EL152.cbl
  4438             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4439                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4440         16  CF-MORTG-BILLING-AREA.
  4441             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4442                                            PIC X.
  4443         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4444         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4445         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4446         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4447             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4448             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4449         16  FILLER                         PIC X.
  4450         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4451             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4452             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4453         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4454         16  FILLER                         PIC X(8).
  4455         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4456         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4457         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4458         16  CF-ACH-COMPANY-ID.
  4459             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4460                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4461                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4462                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4463             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4464         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4465             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4466         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4467             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4468             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4469         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4470         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4471         16  FILLER                         PIC X(536).
  4472
  4473****************************************************************
  4474*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4475****************************************************************
  4476
  4477     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4478         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4479             20  CF-FEMALE-HEIGHT.
  4480                 24  CF-FEMALE-FT           PIC 99.
  4481                 24  CF-FEMALE-IN           PIC 99.
  4482             20  CF-FEMALE-MIN-WT           PIC 999.
  4483             20  CF-FEMALE-MAX-WT           PIC 999.
  4484         16  FILLER                         PIC X(428).
  4485
  4486     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4487         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4488             20  CF-MALE-HEIGHT.
  4489                 24  CF-MALE-FT             PIC 99.
  4490                 24  CF-MALE-IN             PIC 99.
  4491             20  CF-MALE-MIN-WT             PIC 999.
  4492             20  CF-MALE-MAX-WT             PIC 999.
  4493         16  FILLER                         PIC X(428).
  4494******************************************************************
  4495*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  85
* EL152.cbl
  4496******************************************************************
  4497     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4498         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4499             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4500             20  CF-SYS-LETTER-ID           PIC X(04).
  4501             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4502             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4503             20  CF-SYS-RESET-SW            PIC X(01).
  4504             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4505             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4506
  4507         16  FILLER                         PIC X(50).
  4508
  4509         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4510             20  CF-USER-ACTIVE-SW          PIC X(01).
  4511             20  CF-USER-LETTER-ID          PIC X(04).
  4512             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4513             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4514             20  CF-USER-RESET-SW           PIC X(01).
  4515             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4516             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4517             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4518
  4519         16  FILLER                         PIC X(246).
  4520
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  86
* EL152.cbl
  4522*                                COPY ELCARCH.
  4523******************************************************************
  4524*                                                                *
  4525*                            ELCARCH.                            *
  4526*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4527*                            VMOD=2.007                          *
  4528*                                                                *
  4529*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  4530*                                                                *
  4531*   FILE TYPE = VSAM,KSDS                                        *
  4532*   RECORD SIZE = 090  RECFORM = FIXED                           *
  4533*                                                                *
  4534*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  4535*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  4536*                                                                *
  4537*   LOG = NO                                                     *
  4538*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4539*                                                                *
  4540*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  4541******************************************************************
  4542 01  LETTER-ARCHIVE.
  4543     12  LA-RECORD-ID                PIC XX.
  4544         88  VALID-LA-ID                VALUE 'LA'.
  4545
  4546     12  LA-CONTROL-PRIMARY.
  4547         16  LA-COMPANY-CD           PIC X.
  4548         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  4549         16  LA-RECORD-TYPE          PIC X.
  4550             88  LA-HEADER-DATA         VALUE '1'.
  4551             88  LA-ADDRESS-DATA        VALUE '2'.
  4552             88  LA-TEXT-DATA           VALUE '3'.
  4553             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  4554         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  4555
  4556     12  LA-CONTROL-BY-TYPE.
  4557         16  LA-COMPANY-CD-A1        PIC X.
  4558         16  LA-RECORD-TYPE-A1       PIC X.
  4559         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  4560         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  4561
  4562     12  LA-TEXT-RECORD.
  4563         16  LA-SKIP-CONTROL         PIC XX.
  4564             88  NO-LINES-SKIPPED       VALUE SPACES.
  4565             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  4566         16  LA-TEXT-LINE            PIC X(70).
  4567
  4568     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  4569         16  FILLER                  PIC XX.
  4570         16  LA-ADDRESS-LINE         PIC X(30).
  4571         16  FILLER                  PIC X(40).
  4572
  4573     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  4574         16  FILLER                  PIC XX.
  4575         16  LA-CARRIER              PIC X.
  4576         16  LA-CLAIM-NO             PIC X(7).
  4577         16  LA-CERT-NO.
  4578             20  LA-CERT-PRIME       PIC X(10).
  4579             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  87
* EL152.cbl
  4580         16  LA-NO-OF-COPIES         PIC S9.
  4581         16  LA-RESEND-DATE          PIC XX.
  4582         16  LA-PROCESSOR-CD         PIC X(4).
  4583         16  LA-CREATION-DT          PIC XX.
  4584         16  LA-INITIAL-PRINT-DATE   PIC XX.
  4585         16  LA-RESEND-PRINT-DATE    PIC XX.
  4586         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  4587         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  4588*
  4589* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  4590*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  4591*   I        20  LA-DMD-PROD-CODE        PIC XX.
  4592*   I        20  LA-DMD-RES-ST           PIC XX.
  4593*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  4594*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  4595*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  4596*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  4597*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  4598*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  4599*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  4600*   I        20  LA-DMD-UND-CODE         PIC XX.
  4601*   I        20  LA-DMD-BEN-CODE         PIC XX.
  4602*   V    16  FILLER                  PIC X(15).
  4603* -----
  4604*
  4605* REINSERTED  CSO  MODS
  4606*
  4607         16  FILLER.
  4608             20  FILLER                  PIC X(29).
  4609             20  LA-CSO-LETTER-STATUS    PIC X.
  4610                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  4611                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  4612                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  4613             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  4614             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  4615*
  4616
  4617     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  4618         16  FILLER                  PIC XX.
  4619         16  LA4-CARRIER             PIC X.
  4620         16  LA4-CLAIM-NO            PIC X(7).
  4621         16  LA4-CERT-NO.
  4622             20  LA4-CERT-PRIME      PIC X(10).
  4623             20  LA4-CERT-SFX        PIC X.
  4624         16  LA4-NO-OF-COPIES        PIC S9.
  4625         16  LA4-RESEND-DATE         PIC XX.
  4626         16  LA4-PROCESSOR-CD        PIC X(4).
  4627         16  LA4-CREATION-DT         PIC XX.
  4628         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  4629         16  LA4-RESEND-PRINT-DATE   PIC XX.
  4630         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  4631         16  LA4-FORM-TYPE           PIC X.
  4632             88  LA4-INITIAL-FORM    VALUE '1'.
  4633             88  LA4-PROGRESS-FORM   VALUE '2'.
  4634         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  4635         16  LA4-STATE               PIC X(02).
  4636         16  FILLER                  PIC X(31).
  4637******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  88
* EL152.cbl
  4638
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  89
* EL152.cbl
  4640*                                COPY ELCARCT.
  4641******************************************************************
  4642*                                                                *
  4643*                            ELCARCT.                            *
  4644*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4645*                            VMOD=2.003                          *
  4646*                                                                *
  4647*   FILE DESCRIPTION = TEMPORARY LETTER ARCHIVE FILE             *
  4648*                                                                *
  4649*   FILE TYPE = VSAM,KSDS                                        *
  4650*   RECORD SIZE = 090  RECFORM = FIXED                           *
  4651*                                                                *
  4652*   BASE CLUSTER = ELARCT                        RKP=2,LEN=8     *
  4653*       ALTERNATE PATH1 = ELARCT2  (RECORD TYPE) RKP=10,LEN=8    *
  4654*                                                                *
  4655*   LOG = NO                                                     *
  4656*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4657*                                                                *
  4658*  NO  CID  MODS  IN  COPYBOOK  ELCARCT                          *
  4659******************************************************************
  4660 01  LETTER-ARCHIVE-TEMP.
  4661     12  LT-RECORD-ID                PIC XX.
  4662         88  VALID-LT-ID                VALUE 'LT'.
  4663
  4664     12  LT-CONTROL-PRIMARY.
  4665         16  LT-COMPANY-CD           PIC X.
  4666         16  LT-ARCHIVE-NO           PIC S9(8)     COMP.
  4667         16  LT-RECORD-TYPE          PIC X.
  4668             88  LT-HEADER-DATA         VALUE '1'.
  4669             88  LT-ADDRESS-DATA        VALUE '2'.
  4670             88  LT-TEXT-DATA           VALUE '3'.
  4671             88  LT-FORM-CONTROL-HDR    VALUE '4'.
  4672         16  LT-LINE-SEQ-NO          PIC S9(4)     COMP.
  4673
  4674     12  LT-CONTROL-BY-TYPE.
  4675         16  LT-COMPANY-CD-A1        PIC X.
  4676         16  LT-RECORD-TYPE-A1       PIC X.
  4677         16  LT-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  4678         16  LT-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  4679
  4680     12  LT-TEXT-RECORD.
  4681         16  LT-SKIP-CONTROL         PIC XX.
  4682         16  LT-TEXT-LINE            PIC X(70).
  4683
  4684     12  LT-ADDRESS-RECORD  REDEFINES  LT-TEXT-RECORD.
  4685         16  FILLER                  PIC XX.
  4686         16  LT-ADDRESS-LINE         PIC X(30).
  4687         16  FILLER                  PIC X(40).
  4688
  4689     12  LT-HEADER-RECORD  REDEFINES  LT-TEXT-RECORD.
  4690         16  FILLER                  PIC XX.
  4691         16  LT-CARRIER              PIC X.
  4692         16  LT-CLAIM-NO             PIC X(7).
  4693         16  LT-CERT-NO.
  4694             20  LT-CERT-PRIME       PIC X(10).
  4695             20  LT-CERT-SFX         PIC X.
  4696         16  LT-NO-OF-COPIES         PIC S9.
  4697         16  LT-RESEND-DATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  90
* EL152.cbl
  4698         16  LT-PROCESSOR-CD         PIC X(4).
  4699         16  LT-CREATION-DT          PIC XX.
  4700         16  LT-INITIAL-PRINT-DATE   PIC XX.
  4701         16  LT-RESEND-PRINT-DATE    PIC XX.
  4702         16  LT-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  4703         16  LT-1ST-RESEND-PRINT-DT  PIC XX.
  4704         16  LT-DMD-ADDITIONAL-FIELDS.
  4705             20  LT-DMD-LETTER-FORM      PIC X(4).
  4706             20  LT-DMD-PROD-CODE        PIC XX.
  4707             20  LT-DMD-RES-ST           PIC XX.
  4708             20  LT-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  4709             20  LT-DMD-LETTER-STATUS    PIC X.
  4710                 88  LT-DMD-LETTER-ONLINE   VALUE '1'.
  4711                 88  LT-DMD-LETTER-PURGED   VALUE '2'.
  4712                 88  LT-DMD-LETTER-RELOADED VALUE '3'.
  4713             20  LT-DMD-LETTER-PURGE-DT  PIC XX.
  4714             20  LT-DMD-LETTER-RELOAD-DT PIC XX.
  4715             20  LT-DMD-UND-CODE         PIC XX.
  4716             20  LT-DMD-BEN-CODE         PIC XX.
  4717         16  FILLER                  PIC X(15).
  4718
  4719     12  LT-FORM-CONTROL-HEADER REDEFINES  LT-TEXT-RECORD.
  4720         16  FILLER                  PIC XX.
  4721         16  LT4-CARRIER             PIC X.
  4722         16  LT4-CLAIM-NO            PIC X(7).
  4723         16  LT4-CERT-NO.
  4724             20  LT4-CERT-PRIME      PIC X(10).
  4725             20  LT4-CERT-SFX        PIC X.
  4726         16  LT4-NO-OF-COPIES        PIC S9.
  4727         16  LT4-RESEND-DATE         PIC XX.
  4728         16  LT4-PROCESSOR-CD        PIC X(4).
  4729         16  LT4-CREATION-DT         PIC XX.
  4730         16  LT4-INITIAL-PRINT-DATE  PIC XX.
  4731         16  LT4-RESEND-PRINT-DATE   PIC XX.
  4732         16  LT4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  4733         16  LT4-FORM-TYPE           PIC X.
  4734             88  LT4-INITIAL-FORM    VALUE '1'.
  4735             88  LT4-PROGRESS-FORM   VALUE '2'.
  4736         16  LT4-FORM-REM-PRINT-DT   PIC XX.
  4737         16  LT4-STATE               PIC XX.
  4738         16  FILLER                  PIC X(31).
  4739******************************************************************
  4740
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  91
* EL152.cbl
  4742*                                COPY ELCCERT.
  4743******************************************************************
  4744*                                                                *
  4745*                            ELCCERT.                            *
  4746*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4747*                            VMOD=2.013                          *
  4748*                                                                *
  4749*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4750*                                                                *
  4751*   FILE TYPE = VSAM,KSDS                                        *
  4752*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4753*                                                                *
  4754*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4755*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4756*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4757*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4758*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4759*                                                                *
  4760*   LOG = YES                                                    *
  4761*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4762******************************************************************
  4763*                   C H A N G E   L O G
  4764*
  4765* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4766*-----------------------------------------------------------------
  4767*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4768* EFFECTIVE    NUMBER
  4769*-----------------------------------------------------------------
  4770* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4771* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4772* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4773* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4774* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4775* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4776* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4777******************************************************************
  4778
  4779 01  CERTIFICATE-MASTER.
  4780     12  CM-RECORD-ID                      PIC XX.
  4781         88  VALID-CM-ID                      VALUE 'CM'.
  4782
  4783     12  CM-CONTROL-PRIMARY.
  4784         16  CM-COMPANY-CD                 PIC X.
  4785         16  CM-CARRIER                    PIC X.
  4786         16  CM-GROUPING.
  4787             20  CM-GROUPING-PREFIX        PIC X(3).
  4788             20  CM-GROUPING-PRIME         PIC X(3).
  4789         16  CM-STATE                      PIC XX.
  4790         16  CM-ACCOUNT.
  4791             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4792             20  CM-ACCOUNT-PRIME          PIC X(6).
  4793         16  CM-CERT-EFF-DT                PIC XX.
  4794         16  CM-CERT-NO.
  4795             20  CM-CERT-PRIME             PIC X(10).
  4796             20  CM-CERT-SFX               PIC X.
  4797
  4798     12  CM-CONTROL-BY-NAME.
  4799         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  92
* EL152.cbl
  4800         16  CM-INSURED-LAST-NAME          PIC X(15).
  4801         16  CM-INSURED-INITIALS.
  4802             20  CM-INSURED-INITIAL1       PIC X.
  4803             20  CM-INSURED-INITIAL2       PIC X.
  4804
  4805     12  CM-CONTROL-BY-SSN.
  4806         16  CM-COMPANY-CD-A2              PIC X.
  4807         16  CM-SOC-SEC-NO.
  4808             20  CM-SSN-STATE              PIC XX.
  4809             20  CM-SSN-ACCOUNT            PIC X(6).
  4810             20  CM-SSN-LN3.
  4811                 25  CM-INSURED-INITIALS-A2.
  4812                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4813                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4814                 25 CM-PART-LAST-NAME-A2         PIC X.
  4815
  4816     12  CM-CONTROL-BY-CERT-NO.
  4817         16  CM-COMPANY-CD-A4              PIC X.
  4818         16  CM-CERT-NO-A4                 PIC X(11).
  4819
  4820     12  CM-CONTROL-BY-MEMB.
  4821         16  CM-COMPANY-CD-A5              PIC X.
  4822         16  CM-MEMBER-NO.
  4823             20  CM-MEMB-STATE             PIC XX.
  4824             20  CM-MEMB-ACCOUNT           PIC X(6).
  4825             20  CM-MEMB-LN4.
  4826                 25  CM-INSURED-INITIALS-A5.
  4827                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4828                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4829                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4830
  4831     12  CM-INSURED-PROFILE-DATA.
  4832         16  CM-INSURED-FIRST-NAME.
  4833             20  CM-INSURED-1ST-INIT       PIC X.
  4834             20  FILLER                    PIC X(9).
  4835         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4836         16  CM-INSURED-SEX                PIC X.
  4837             88  CM-SEX-MALE                  VALUE 'M'.
  4838             88  CM-SEX-FEMAL                 VALUE 'F'.
  4839         16  CM-INSURED-JOINT-AGE          PIC 99.
  4840         16  CM-JOINT-INSURED-NAME.
  4841             20  CM-JT-LAST-NAME           PIC X(15).
  4842             20  CM-JT-FIRST-NAME.
  4843                 24  CM-JT-1ST-INIT        PIC X.
  4844                 24  FILLER                PIC X(9).
  4845             20  CM-JT-INITIAL             PIC X.
  4846
  4847     12  CM-LIFE-DATA.
  4848         16  CM-LF-BENEFIT-CD              PIC XX.
  4849         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4850         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4851         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4852         16  CM-LF-DEV-CODE                PIC XXX.
  4853         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4854         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4855         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4856         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4857         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  93
* EL152.cbl
  4858         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4859         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4860         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4861         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4862         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4863         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4864         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4865         16  FILLER                        PIC XX.
  4866
  4867     12  CM-AH-DATA.
  4868         16  CM-AH-BENEFIT-CD              PIC XX.
  4869         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4870         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4871         16  CM-AH-DEV-CODE                PIC XXX.
  4872         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4873         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4874         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4875         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4876         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4877         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4878         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4879         16  CM-AH-PAID-THRU-DT            PIC XX.
  4880             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4881         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4882         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4883         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4884         16  FILLER                        PIC X.
  4885
  4886     12  CM-LOAN-INFORMATION.
  4887         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4888         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4889                                           PIC S9(5)V99  COMP-3.
  4890         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4891         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4892         16  CM-PAY-FREQUENCY              PIC S99.
  4893         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4894         16  CM-RATE-CLASS                 PIC XX.
  4895         16  CM-BENEFICIARY                PIC X(25).
  4896         16  CM-POLICY-FORM-NO             PIC X(12).
  4897         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4898         16  CM-LAST-ADD-ON-DT             PIC XX.
  4899         16  CM-DEDUCTIBLE-AMOUNTS.
  4900             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4901             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4902         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4903             20  CM-RESIDENT-STATE         PIC XX.
  4904             20  CM-RATE-CODE              PIC X(4).
  4905             20  FILLER                    PIC XX.
  4906         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4907             20  CM-LOAN-OFFICER           PIC X(5).
  4908             20  FILLER                    PIC XXX.
  4909         16  CM-CSR-CODE                   PIC XXX.
  4910         16  CM-UNDERWRITING-CODE          PIC X.
  4911             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4912         16  CM-POST-CARD-IND              PIC X.
  4913         16  CM-NH-INTERFACE-SW            PIC X.
  4914         16  CM-PREMIUM-TYPE               PIC X.
  4915             88  CM-SING-PRM                  VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  94
* EL152.cbl
  4916             88  CM-O-B-COVERAGE              VALUE '2'.
  4917             88  CM-OPEN-END                  VALUE '3'.
  4918         16  CM-IND-GRP-TYPE               PIC X.
  4919             88  CM-INDIVIDUAL                VALUE 'I'.
  4920             88  CM-GROUP                     VALUE 'G'.
  4921         16  CM-SKIP-CODE                  PIC X.
  4922             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4923             88  SKIP-JULY                    VALUE '1'.
  4924             88  SKIP-AUGUST                  VALUE '2'.
  4925             88  SKIP-SEPTEMBER               VALUE '3'.
  4926             88  SKIP-JULY-AUG                VALUE '4'.
  4927             88  SKIP-AUG-SEPT                VALUE '5'.
  4928             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4929             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4930             88  SKIP-JUNE                    VALUE '8'.
  4931             88  SKIP-JUNE-JULY               VALUE '9'.
  4932             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4933             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4934         16  CM-PAYMENT-MODE               PIC X.
  4935             88  PAY-MONTHLY                  VALUE SPACE.
  4936             88  PAY-WEEKLY                   VALUE '1'.
  4937             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4938             88  PAY-BI-WEEKLY                VALUE '3'.
  4939             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4940         16  CM-LOAN-NUMBER                PIC X(8).
  4941         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4942         16  CM-OLD-LOF                    PIC XXX.
  4943*        16  CM-LOAN-OFFICER               PIC XXX.
  4944         16  CM-REIN-TABLE                 PIC XXX.
  4945         16  CM-SPECIAL-REIN-CODE          PIC X.
  4946         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4947         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4948         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4949
  4950     12  CM-STATUS-DATA.
  4951         16  CM-ENTRY-STATUS               PIC X.
  4952         16  CM-ENTRY-DT                   PIC XX.
  4953
  4954         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4955         16  CM-LF-CANCEL-DT               PIC XX.
  4956         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4957
  4958         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4959         16  CM-LF-DEATH-DT                PIC XX.
  4960         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4961
  4962         16  CM-LF-CURRENT-STATUS          PIC X.
  4963             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4964                                                'M' '4' '5' '9'.
  4965             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4966             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4967             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4968             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4969             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4970             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4971             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4972             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4973             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  95
* EL152.cbl
  4974             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4975             88  CM-LF-DECLINED               VALUE 'D'.
  4976             88  CM-LF-VOIDED                 VALUE 'V'.
  4977
  4978         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4979         16  CM-AH-CANCEL-DT               PIC XX.
  4980         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4981
  4982         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4983         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4984         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4985
  4986         16  CM-AH-CURRENT-STATUS          PIC X.
  4987             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4988                                                'M' '4' '5' '9'.
  4989             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4990             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4991             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4992             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4993             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4994             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4995             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4996             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4997             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4998             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4999             88  CM-AH-DECLINED               VALUE 'D'.
  5000             88  CM-AH-VOIDED                 VALUE 'V'.
  5001
  5002         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5003             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5004             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5005             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5006         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5007
  5008         16  CM-ENTRY-BATCH                PIC X(6).
  5009         16  CM-LF-EXIT-BATCH              PIC X(6).
  5010         16  CM-AH-EXIT-BATCH              PIC X(6).
  5011         16  CM-LAST-MONTH-END             PIC XX.
  5012
  5013     12  CM-NOTE-SW                        PIC X.
  5014         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5015         88  CERT-NOTES-PRESENT               VALUE '1'.
  5016         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5017         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5018         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5019         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5020         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5021         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5022     12  CM-COMP-EXCP-SW                   PIC X.
  5023         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5024         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5025     12  CM-INSURED-ADDRESS-SW             PIC X.
  5026         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5027         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5028
  5029*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5030     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5031     12  FILLER                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  96
* EL152.cbl
  5032
  5033*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5034     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5035     12  FILLER                            PIC X.
  5036*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5037     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5038
  5039     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5040         88  CERT-ADDED-BATCH                 VALUE ' '.
  5041         88  CERT-ADDED-ONLINE                VALUE '1'.
  5042         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5043         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5044         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5045     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5046         88  CERT-AS-LOADED                   VALUE ' '.
  5047         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5048         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5049         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5050         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5051         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5052         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5053         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5054
  5055     12  CM-ACCOUNT-COMM-PCTS.
  5056         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5057         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5058
  5059     12  CM-USER-FIELD                     PIC X.
  5060     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5061     12  CM-CLP-STATE                      PIC XX.
  5062     12  CM-USER-RESERVED                  PIC XXX.
  5063******************************************************************
  5064
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  97
* EL152.cbl
  5066*                                COPY ERCACCT.
  5067******************************************************************
  5068*                                                                *
  5069*                                                                *
  5070*                            ERCACCT                             *
  5071*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5072*                            VMOD=2.031                          *
  5073*                                                                *
  5074*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5075*                                                                *
  5076*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5077*   VSAM ACCOUNT MASTER FILES.                                   *
  5078*                                                                *
  5079*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5080*                                                                *
  5081*   FILE TYPE = VSAM,KSDS                                        *
  5082*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5083*                                                                *
  5084*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5085*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5086*                                                                *
  5087*   LOG = NO                                                     *
  5088*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5089*                                                                *
  5090*                                                                *
  5091******************************************************************
  5092*                   C H A N G E   L O G
  5093*
  5094* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5095*-----------------------------------------------------------------
  5096*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5097* EFFECTIVE    NUMBER
  5098*-----------------------------------------------------------------
  5099* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5100* 092705    2005050300006  PEMA  ADD SPP LEASES
  5101* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5102* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5103* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5104* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5105* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5106******************************************************************
  5107
  5108 01  ACCOUNT-MASTER.
  5109     12  AM-RECORD-ID                      PIC XX.
  5110         88  VALID-AM-ID                      VALUE 'AM'.
  5111
  5112     12  AM-CONTROL-PRIMARY.
  5113         16  AM-COMPANY-CD                 PIC X.
  5114         16  AM-MSTR-CNTRL.
  5115             20  AM-CONTROL-A.
  5116                 24  AM-CARRIER            PIC X.
  5117                 24  AM-GROUPING.
  5118                     28 AM-GROUPING-PREFIX PIC XXX.
  5119                     28 AM-GROUPING-PRIME  PIC XXX.
  5120                 24  AM-STATE              PIC XX.
  5121                 24  AM-ACCOUNT.
  5122                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5123                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  98
* EL152.cbl
  5124             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5125                                           PIC X(19).
  5126             20  AM-CNTRL-B.
  5127                 24  AM-EXPIRATION-DT      PIC XX.
  5128                 24  FILLER                PIC X(4).
  5129             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5130                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5131
  5132     12  AM-CONTROL-BY-VAR-GRP.
  5133         16  AM-COMPANY-CD-A1              PIC X.
  5134         16  AM-VG-CARRIER                 PIC X.
  5135         16  AM-VG-GROUPING                PIC X(6).
  5136         16  AM-VG-STATE                   PIC XX.
  5137         16  AM-VG-ACCOUNT                 PIC X(10).
  5138         16  AM-VG-DATE.
  5139             20  AM-VG-EXPIRATION-DT       PIC XX.
  5140             20  FILLER                    PIC X(4).
  5141         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5142                                           PIC 9(11)      COMP-3.
  5143     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5144         16  FILLER                        PIC X(10).
  5145         16  AM-VG-KEY3.
  5146             20  AM-VG3-ACCOUNT            PIC X(10).
  5147             20  AM-VG3-EXP-DT             PIC XX.
  5148         16  FILLER                        PIC X(4).
  5149     12  AM-MAINT-INFORMATION.
  5150         16  AM-LAST-MAINT-DT              PIC XX.
  5151         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5152         16  AM-LAST-MAINT-USER            PIC X(4).
  5153         16  FILLER                        PIC XX.
  5154
  5155     12  AM-EFFECTIVE-DT                   PIC XX.
  5156     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5157
  5158     12  AM-PREV-DATES  COMP-3.
  5159         16  AM-PREV-EXP-DT                PIC 9(11).
  5160         16  AM-PREV-EFF-DT                PIC 9(11).
  5161
  5162     12  AM-REPORT-CODE-1                  PIC X(10).
  5163     12  AM-REPORT-CODE-2                  PIC X(10).
  5164
  5165     12  AM-CITY-CODE                      PIC X(4).
  5166     12  AM-COUNTY-PARISH                  PIC X(6).
  5167
  5168     12  AM-NAME                           PIC X(30).
  5169     12  AM-PERSON                         PIC X(30).
  5170     12  AM-ADDRS                          PIC X(30).
  5171     12  AM-CITY.
  5172         16  AM-ADDR-CITY                  PIC X(28).
  5173         16  AM-ADDR-STATE                 PIC XX.
  5174     12  AM-ZIP.
  5175         16  AM-ZIP-PRIME.
  5176             20  AM-ZIP-PRI-1ST            PIC X.
  5177                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5178             20  FILLER                    PIC X(4).
  5179         16  AM-ZIP-PLUS4                  PIC X(4).
  5180     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5181         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page  99
* EL152.cbl
  5182         16  AM-CAN-POSTAL-2               PIC XXX.
  5183         16  FILLER                        PIC XXX.
  5184     12  AM-TEL-NO.
  5185         16  AM-AREA-CODE                  PIC 999.
  5186         16  AM-TEL-PRE                    PIC 999.
  5187         16  AM-TEL-NBR                    PIC 9(4).
  5188     12  AM-TEL-LOC                        PIC X.
  5189         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5190         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5191
  5192     12  AM-COMM-STRUCTURE.
  5193         16  AM-DEFN-1.
  5194             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5195                 24  AM-AGT.
  5196                     28  AM-AGT-PREFIX     PIC X(4).
  5197                     28  AM-AGT-PRIME      PIC X(6).
  5198                 24  AM-COM-TYP            PIC X.
  5199                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5200                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5201                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5202                 24  AM-RECALC-LV-INDIC    PIC X.
  5203                 24  AM-RETRO-LV-INDIC     PIC X.
  5204                 24  AM-GL-CODES           PIC X.
  5205                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5206                 24  FILLER                PIC X(01).
  5207         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5208             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5209                 24  FILLER                PIC X(11).
  5210                 24  AM-L-COMA             PIC XXX.
  5211                 24  AM-J-COMA             PIC XXX.
  5212                 24  AM-A-COMA             PIC XXX.
  5213                 24  FILLER                PIC X(6).
  5214
  5215     12  AM-COMM-CHANGE-STATUS             PIC X.
  5216         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5217
  5218     12  AM-CSR-CODE                       PIC X(4).
  5219
  5220     12  AM-BILLING-STATUS                 PIC X.
  5221         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5222         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5223     12  AM-AUTO-REFUND-SW                 PIC X.
  5224         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5225         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5226     12  AM-GPCD                           PIC 99.
  5227     12  AM-IG                             PIC X.
  5228         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5229         88  AM-HAS-GROUP                     VALUE '2'.
  5230     12  AM-STATUS                         PIC X.
  5231         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5232         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5233         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5234         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5235         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5236         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5237     12  AM-REMIT-TO                       PIC 99.
  5238     12  AM-ID-NO                          PIC X(11).
  5239
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 100
* EL152.cbl
  5240     12  AM-CAL-TABLE                      PIC XX.
  5241     12  AM-LF-DEVIATION                   PIC XXX.
  5242     12  AM-AH-DEVIATION                   PIC XXX.
  5243     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5244     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5245     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5246     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5247     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5248     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5249
  5250     12  AM-USER-FIELDS.
  5251         16  AM-FLD-1                      PIC XX.
  5252         16  AM-FLD-2                      PIC XX.
  5253         16  AM-FLD-3                      PIC XX.
  5254         16  AM-FLD-4                      PIC XX.
  5255         16  AM-FLD-5                      PIC XX.
  5256
  5257     12  AM-1ST-PROD-DATE.
  5258         16  AM-1ST-PROD-YR                PIC XX.
  5259         16  AM-1ST-PROD-MO                PIC XX.
  5260         16  AM-1ST-PROD-DA                PIC XX.
  5261     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5262     12  AM-CERTS-PURGED-DATE.
  5263         16  AM-PUR-YR                     PIC XX.
  5264         16  AM-PUR-MO                     PIC XX.
  5265         16  AM-PUR-DA                     PIC XX.
  5266     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5267     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5268     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5269     12  AM-INACTIVE-DATE.
  5270         16  AM-INA-MO                     PIC 99.
  5271         16  AM-INA-DA                     PIC 99.
  5272         16  AM-INA-YR                     PIC 99.
  5273     12  AM-AR-HI-CERT-DATE                PIC XX.
  5274
  5275     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5276     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5277
  5278     12  AM-OB-PAYMENT-MODE                PIC X.
  5279         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5280         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5281         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5282         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5283
  5284     12  AM-AH-ONLY-INDICATOR              PIC X.
  5285         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5286         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5287
  5288     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5289
  5290     12  AM-OVER-SHORT.
  5291         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5292         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5293
  5294     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5295     12  AM-DCC-CLP-STATE                  PIC XX.
  5296
  5297     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 101
* EL152.cbl
  5298     12  AM-RECALC-REIN                    PIC X.
  5299
  5300     12  AM-REI-TABLE                      PIC XXX.
  5301     12  AM-REI-ET-LF                      PIC X.
  5302     12  AM-REI-ET-AH                      PIC X.
  5303     12  AM-REI-PE-LF                      PIC X.
  5304     12  AM-REI-PE-AH                      PIC X.
  5305     12  AM-REI-PRT-ST                     PIC X.
  5306     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5307     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5308     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5309     12  AM-REI-GROUP-A                    PIC X(6).
  5310     12  AM-REI-MORT                       PIC X(4).
  5311     12  AM-REI-PRT-OW                     PIC X.
  5312     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5313     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5314     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5315     12  AM-REI-GROUP-B                    PIC X(6).
  5316
  5317     12  AM-TRUST-TYPE                     PIC X(2).
  5318
  5319     12  AM-EMPLOYER-STMT-USED             PIC X.
  5320     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5321
  5322     12  AM-STD-AH-TYPE                    PIC XX.
  5323     12  AM-EARN-METHODS.
  5324         16  AM-EARN-METHOD-R              PIC X.
  5325             88 AM-REF-RL-R78                 VALUE 'R'.
  5326             88 AM-REF-RL-PR                  VALUE 'P'.
  5327             88 AM-REF-RL-MEAN                VALUE 'M'.
  5328             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5329         16  AM-EARN-METHOD-L              PIC X.
  5330             88 AM-REF-LL-R78                 VALUE 'R'.
  5331             88 AM-REF-LL-PR                  VALUE 'P'.
  5332             88 AM-REF-LL-MEAN                VALUE 'M'.
  5333             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5334         16  AM-EARN-METHOD-A              PIC X.
  5335             88 AM-REF-AH-R78                 VALUE 'R'.
  5336             88 AM-REF-AH-PR                  VALUE 'P'.
  5337             88 AM-REF-AH-MEAN                VALUE 'M'.
  5338             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5339             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5340             88 AM-REF-AH-NET                 VALUE 'N'.
  5341
  5342     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5343     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5344     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5345
  5346     12  AM-RET-Y-N                        PIC X.
  5347     12  AM-RET-P-E                        PIC X.
  5348     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5349     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5350     12  AM-RET-GRP                        PIC X(6).
  5351     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5352         16  AM-POOL-PRIME                 PIC XXX.
  5353         16  AM-POOL-SUB                   PIC XXX.
  5354     12  AM-RETRO-EARNINGS.
  5355         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 102
* EL152.cbl
  5356         16  AM-RET-EARN-L                 PIC X.
  5357         16  AM-RET-EARN-A                 PIC X.
  5358     12  AM-RET-ST-TAX-USE                 PIC X.
  5359         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5360         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5361     12  AM-RETRO-BEG-EARNINGS.
  5362         16  AM-RET-BEG-EARN-R             PIC X.
  5363         16  AM-RET-BEG-EARN-L             PIC X.
  5364         16  AM-RET-BEG-EARN-A             PIC X.
  5365     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5366     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5367
  5368     12  AM-USER-SELECT-OPTIONS.
  5369         16  AM-USER-SELECT-1              PIC X(10).
  5370         16  AM-USER-SELECT-2              PIC X(10).
  5371         16  AM-USER-SELECT-3              PIC X(10).
  5372         16  AM-USER-SELECT-4              PIC X(10).
  5373         16  AM-USER-SELECT-5              PIC X(10).
  5374
  5375     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5376
  5377     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5378
  5379     12  AM-RPT045A-SWITCH                 PIC X.
  5380         88  RPT045A-OFF                   VALUE 'N'.
  5381
  5382     12  AM-INSURANCE-LIMITS.
  5383         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5384         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5385
  5386     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5387         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5388
  5389     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5390         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5391         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5392
  5393     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5394
  5395     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5396     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5397     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5398     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5399     12  AM-DCC-UEF-STATE                  PIC XX.
  5400     12  FILLER                            PIC XXX.
  5401     12  AM-REPORT-CODE-3                  PIC X(10).
  5402*    12  FILLER                            PIC X(22).
  5403
  5404     12  AM-RESERVE-DATE.
  5405         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5406         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5407         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5408
  5409     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5410     12  AM-NOTIFICATION-TYPES.
  5411         16  AM-NOTIF-OF-LETTERS           PIC X.
  5412         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5413         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 103
* EL152.cbl
  5414         16  AM-NOTIF-OF-STATUS            PIC X.
  5415
  5416     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5417         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5418         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5419         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5420         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5421
  5422     12  AM-BENEFIT-CONTROLS.
  5423         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5424             20  AM-BENEFIT-CODE           PIC XX.
  5425             20  AM-BENEFIT-TYPE           PIC X.
  5426             20  AM-BENEFIT-REVISION       PIC XXX.
  5427             20  AM-BENEFIT-REM-TERM       PIC X.
  5428             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5429             20  FILLER                    PIC XX.
  5430         16  FILLER                        PIC X(80).
  5431
  5432     12  AM-TRANSFER-DATA.
  5433         16  AM-TRANSFERRED-FROM.
  5434             20  AM-TRNFROM-CARRIER        PIC X.
  5435             20  AM-TRNFROM-GROUPING.
  5436                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5437                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5438             20  AM-TRNFROM-STATE          PIC XX.
  5439             20  AM-TRNFROM-ACCOUNT.
  5440                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5441                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5442             20  AM-TRNFROM-DTE            PIC XX.
  5443         16  AM-TRANSFERRED-TO.
  5444             20  AM-TRNTO-CARRIER          PIC X.
  5445             20  AM-TRNTO-GROUPING.
  5446                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5447                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5448             20  AM-TRNTO-STATE            PIC XX.
  5449             20  AM-TRNTO-ACCOUNT.
  5450                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5451                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5452             20  AM-TRNTO-DTE              PIC XX.
  5453         16  FILLER                        PIC X(10).
  5454
  5455     12  AM-SAVED-REMIT-TO                 PIC 99.
  5456
  5457     12  AM-COMM-STRUCTURE-SAVED.
  5458         16  AM-DEFN-1-SAVED.
  5459             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5460                 24  AM-AGT-SV             PIC X(10).
  5461                 24  AM-COM-TYP-SV         PIC X.
  5462                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5463                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5464                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5465                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5466                 24  FILLER                PIC X.
  5467                 24  AM-GL-CODES-SV        PIC X.
  5468                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5469                 24  FILLER                PIC X.
  5470         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5471             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 104
* EL152.cbl
  5472                 24  FILLER                PIC X(11).
  5473                 24  AM-L-COMA-SV          PIC XXX.
  5474                 24  AM-J-COMA-SV          PIC XXX.
  5475                 24  AM-A-COMA-SV          PIC XXX.
  5476                 24  FILLER                PIC X(6).
  5477
  5478     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5479         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5480            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5481            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5482            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5483
  5484     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5485     12  FILLER                            PIC X(120).
  5486
  5487     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5488         16  AM-CONTROL-NAME               PIC X(30).
  5489         16  AM-EXECUTIVE-ONE.
  5490             20  AM-EXEC1-NAME             PIC X(15).
  5491             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5492                                                          COMP-3.
  5493             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5494                                                          COMP-3.
  5495         16  AM-EXECUTIVE-TWO.
  5496             20  AM-EXEC2-NAME             PIC X(15).
  5497             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5498                                                          COMP-3.
  5499             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5500                                                          COMP-3.
  5501
  5502     12  AM-RETRO-ADDITIONAL-DATA.
  5503         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5504         16  AM-RETRO-PREM-P-E             PIC X.
  5505         16  AM-RETRO-CLMS-P-I             PIC X.
  5506         16  AM-RETRO-RET-BRACKET-LF.
  5507             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5508                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5509                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5510             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5511                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5512                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5513             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5514                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5515                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5516         16  AM-RETRO-RET-BRACKET-AH.
  5517             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5518                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5519                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5520                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5521             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5522                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5523                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5524             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5525                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5526                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5527
  5528     12  AM-COMMENTS.
  5529         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 105
* EL152.cbl
  5530
  5531     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5532         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5533         16  AM-FLI-BILLING-CODE           PIC X.
  5534         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5535         16  AM-FLI-UNITED-IDENT           PIC X.
  5536         16  AM-FLI-INTEREST-LOST-DATA.
  5537             20  AM-FLI-BANK-NO            PIC X(5).
  5538             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5539             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5540             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5541         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5542             20  AM-FLI-AGT                PIC X(9).
  5543             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5544             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5545         16  FILLER                        PIC X(102).
  5546
  5547     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5548         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5549             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5550             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5551             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5552             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5553             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5554         16  FILLER                          PIC X(10).
  5555******************************************************************
  5556
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 106
* EL152.cbl
  5558*                                COPY ELCTEXT.
  5559******************************************************************
  5560*                                                                *
  5561*                                                                *
  5562*                            ELCTEXT.                            *
  5563*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5564*                            VMOD=2.008                          *
  5565*                                                                *
  5566*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  5567*                                     FORM LETTERS,              *
  5568*                                     CERT FORM DISPLAY.
  5569*                                                                *
  5570*   FILE TYPE = VSAM,KSDS                                        *
  5571*   RECORD SIZE = 100   RECFORM = FIXED                          *
  5572*                                                                *
  5573*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  5574*       ALTERNATE INDEX = NONE                                   *
  5575*                                                                *
  5576*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  5577*       ALTERNATE INDEX = NONE                                   *
  5578*                                                                *
  5579*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  5580*       ALTERNATE INDEX = NONE                                   *
  5581*                                                                *
  5582*   LOG = NO                                                     *
  5583*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5584******************************************************************
  5585 01  TEXT-FILES.
  5586     12  TEXT-FILE-ID                PIC XX.
  5587         88  FORMS-FILE-TEXT            VALUE 'TF'.
  5588         88  LETTER-FILE-TEXT           VALUE 'TL'.
  5589         88  HELP-FILE-TEXT             VALUE 'TH'.
  5590
  5591     12  TX-CONTROL-PRIMARY.
  5592         16  TX-COMPANY-CD           PIC X.
  5593             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  5594         16  TX-ACCESS-CD-GENL       PIC X(12).
  5595
  5596         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5597             20  TX-LETTER-NO        PIC X(4).
  5598             20  FILLER              PIC X(8).
  5599
  5600         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5601             20  TX-FORM-NO          PIC X(12).
  5602
  5603         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5604             20  TX-HELP-TYPE        PIC X.
  5605                 88  HELP-FOR-GENERAL   VALUE ' '.
  5606                 88  HELP-BY-SCREEN     VALUE 'S'.
  5607                 88  HELP-BY-ERROR      VALUE 'E'.
  5608             20  TX-SCREEN-OR-ERROR  PIC X(4).
  5609                 88  GENERAL-INFO-HELP  VALUE '0000'.
  5610             20  TX-HELP-FOR-COMPANY  PIC XXX.
  5611                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  5612             20  FILLER              PIC X(4).
  5613
  5614         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  5615
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 107
* EL152.cbl
  5616     12  TX-PROCESS-CONTROL          PIC XX.
  5617         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  5618
  5619     12  TX-TEXT-LINE                PIC X(70).
  5620
  5621     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  5622         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  5623         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  5624         88  TX-VALID-FORM-SQUEEZE-VALUE
  5625                                        VALUE 'Y' ' '.
  5626
  5627     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  5628         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  5629         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  5630         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  5631         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  5632         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  5633         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  5634         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  5635                                              'K' 'N' ' '
  5636                                              'Z'.
  5637
  5638     12  TX-ARCHIVE-SW               PIC X.
  5639         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  5640         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  5641         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  5642
  5643     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  5644     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  5645
  5646     12  TX-BSR-CODE                 PIC X.
  5647         88  TX-BSR-LETTER              VALUE 'B'.
  5648         88  TX-NON-BSR-LETTER          VALUE ' '.
  5649
  5650     12  FILLER                      PIC X.
  5651*****************************************************************
  5652
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 108
* EL152.cbl
  5654*                                COPY ELCTRLR.
  5655******************************************************************
  5656*                                                                *
  5657*                            ELCTRLR.                            *
  5658*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5659*                            VMOD=2.014                          *
  5660*                                                                *
  5661*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5662*                                                                *
  5663*   FILE TYPE = VSAM,KSDS                                        *
  5664*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5665*                                                                *
  5666*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5667*       ALTERNATE INDEX = NONE                                   *
  5668*                                                                *
  5669*   LOG = YES                                                    *
  5670*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5671******************************************************************
  5672*                   C H A N G E   L O G
  5673*
  5674* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5675*-----------------------------------------------------------------
  5676*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5677* EFFECTIVE    NUMBER
  5678*-----------------------------------------------------------------
  5679* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5680* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5681* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5682* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5683* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5684* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5685* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5686* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5687* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5688* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5689* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5690* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5691* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5692******************************************************************
  5693 01  ACTIVITY-TRAILERS.
  5694     12  AT-RECORD-ID                    PIC XX.
  5695         88  VALID-AT-ID                       VALUE 'AT'.
  5696
  5697     12  AT-CONTROL-PRIMARY.
  5698         16  AT-COMPANY-CD               PIC X.
  5699         16  AT-CARRIER                  PIC X.
  5700         16  AT-CLAIM-NO                 PIC X(7).
  5701         16  AT-CERT-NO.
  5702             20  AT-CERT-PRIME           PIC X(10).
  5703             20  AT-CERT-SFX             PIC X.
  5704         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5705             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5706             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5707             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5708             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5709             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5710             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5711             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 109
* EL152.cbl
  5712             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5713             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5714             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5715             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5716             88  AT-BENEFICIARY-TRL           VALUE +91.
  5717             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5718             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5719
  5720     12  AT-TRAILER-TYPE                 PIC X.
  5721         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5722         88  PAYMENT-TR                       VALUE '2'.
  5723         88  AUTO-PAY-TR                      VALUE '3'.
  5724         88  CORRESPONDENCE-TR                VALUE '4'.
  5725         88  ADDRESS-TR                       VALUE '5'.
  5726         88  GENERAL-INFO-TR                  VALUE '6'.
  5727         88  AUTO-PROMPT-TR                   VALUE '7'.
  5728         88  DENIAL-TR                        VALUE '8'.
  5729         88  INCURRED-CHG-TR                  VALUE '9'.
  5730         88  FORM-CONTROL-TR                  VALUE 'A'.
  5731
  5732     12  AT-RECORDED-DT                  PIC XX.
  5733     12  AT-RECORDED-BY                  PIC X(4).
  5734     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5735
  5736     12  AT-TRAILER-BODY                 PIC X(165).
  5737
  5738     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5739         16  AT-RESERVE-CONTROLS.
  5740             20  AT-MANUAL-SW            PIC X.
  5741                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5742             20  AT-FUTURE-SW            PIC X.
  5743                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5744             20  AT-PTC-SW               PIC X.
  5745                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5746             20  AT-IBNR-SW              PIC X.
  5747                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5748             20  AT-PTC-LF-SW            PIC X.
  5749                 88  AT-LF-PTC-USED          VALUE '1'.
  5750             20  AT-CDT-ACCESS-METHOD    PIC X.
  5751                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5752                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5753                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5754             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5755         16  AT-LAST-COMPUTED-DT         PIC XX.
  5756         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5757         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5758         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5759         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5760         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5761         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5762         16  AT-EXPENSE-CONTROLS.
  5763             20  AT-EXPENSE-METHOD       PIC X.
  5764                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5765                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5766                 88  PERCENT-OF-PMT           VALUE '3'.
  5767                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5768             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5769             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 110
* EL152.cbl
  5770         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5771         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5772
  5773         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5774         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5775
  5776*        16  FILLER                      PIC X(53).
  5777         16  FILLER                      PIC X(47).
  5778
  5779         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5780         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5781
  5782         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5783             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5784             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5785*                    C = CLOSED
  5786*                    O = OPEN
  5787             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5788*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5789
  5790     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5791         16  AT-PAYMENT-TYPE             PIC X.
  5792             88  PARTIAL-PAYMENT                VALUE '1'.
  5793             88  FINAL-PAYMENT                  VALUE '2'.
  5794             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5795             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5796             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5797             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5798             88  VOIDED-PAYMENT                 VALUE '9'.
  5799             88  TRANSFER                       VALUE 'T'.
  5800             88  LIFE-INTEREST                  VALUE 'I'.
  5801
  5802         16  AT-CLAIM-TYPE               PIC X.
  5803             88  PAID-FOR-AH                    VALUE 'A'.
  5804             88  PAID-FOR-LIFE                  VALUE 'L'.
  5805             88  PAID-FOR-IUI                   VALUE 'I'.
  5806             88  PAID-FOR-GAP                   VALUE 'G'.
  5807         16  AT-CLAIM-PREM-TYPE          PIC X.
  5808             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5809             88  AT-O-B-COVERAGE                VALUE '2'.
  5810             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5811         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5812         16  AT-CHECK-NO                 PIC X(7).
  5813         16  AT-PAID-FROM-DT             PIC XX.
  5814         16  AT-PAID-THRU-DT             PIC XX.
  5815         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5816         16  FILLER                      PIC X.
  5817         16  AT-PAYEES-NAME              PIC X(30).
  5818         16  AT-PAYMENT-ORIGIN           PIC X.
  5819             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5820             88  ONLINE-AUTO-PMT                VALUE '2'.
  5821             88  OFFLINE-PMT                    VALUE '3'.
  5822         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5823         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5824         16  AT-VOID-DATA.
  5825             20  AT-VOID-DT              PIC XX.
  5826*00144       20  AT-VOID-REASON          PIC X(30).
  5827             20  AT-VOID-REASON          PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 111
* EL152.cbl
  5828         16  AT-PMT-APPROVED-BY          PIC X(04).
  5829         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  5830         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5831         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5832                                         PIC S99V9(5)  COMP-3.
  5833         16  AT-CREDIT-INTERFACE.
  5834             20  AT-PMT-SELECT-DT        PIC XX.
  5835                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5836             20  AT-PMT-ACCEPT-DT        PIC XX.
  5837                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5838             20  AT-VOID-SELECT-DT       PIC XX.
  5839                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5840             20  AT-VOID-ACCEPT-DT       PIC XX.
  5841                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5842
  5843         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5844                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5845                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5846         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5847
  5848         16  AT-FORCE-CONTROL            PIC X.
  5849             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5850         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5851         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5852         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5853         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5854         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5855         16  AT-BENEFIT-TYPE             PIC X.
  5856
  5857         16  AT-EXPENSE-TYPE             PIC X.
  5858         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5859
  5860         16  AT-PAYEE-TYPE-CD.
  5861             20  AT-PAYEE-TYPE           PIC X.
  5862                 88  INSURED-PAID           VALUE 'I'.
  5863                 88  BENEFICIARY-PAID       VALUE 'B'.
  5864                 88  ACCOUNT-PAID           VALUE 'A'.
  5865                 88  OTHER-1-PAID           VALUE 'O'.
  5866                 88  OTHER-2-PAID           VALUE 'Q'.
  5867                 88  DOCTOR-PAID            VALUE 'P'.
  5868                 88  EMPLOYER-PAID          VALUE 'E'.
  5869             20  AT-PAYEE-SEQ            PIC X.
  5870
  5871         16  AT-CASH-PAYMENT             PIC X.
  5872         16  AT-GROUPED-PAYMENT          PIC X.
  5873         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  5874         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  5875         16  AT-APPROVED-LEVEL           PIC X.
  5876         16  AT-VOID-TYPE                PIC X.
  5877             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  5878             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  5879         16  AT-AIG-UNEMP-IND            PIC X.
  5880             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  5881         16  AT-ASSOCIATES               PIC X.
  5882             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  5883             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  5884
  5885         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 112
* EL152.cbl
  5886         16  AT-CV-PMT-CODE              PIC X.
  5887             88  FULL-DEATH-PAYMENT         VALUE '1'.
  5888             88  HALF-DEATH-PAYMENT         VALUE '2'.
  5889             88  FULL-ADD-PAYMENT           VALUE '3'.
  5890             88  HALF-ADD-PAYMENT           VALUE '4'.
  5891             88  FULL-RIDER-PAYMENT         VALUE '5'.
  5892             88  HALF-RIDER-PAYMENT         VALUE '6'.
  5893             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  5894             88  ADDL-PAYMENT               VALUE '8'.
  5895
  5896         16  AT-EOB-CODE1                PIC XXX.
  5897         16  AT-EOB-CODE2                PIC XXX.
  5898         16  AT-EOB-CODE3                PIC XXX.
  5899         16  AT-EOB-CODE4                PIC XXX.
  5900         16  FILLER REDEFINES AT-EOB-CODE4.
  5901             20  AT-INT-PMT-SELECT-DT    PIC XX.
  5902             20  FILLER                  PIC X.
  5903         16  AT-EOB-CODE5                PIC XXX.
  5904         16  FILLER REDEFINES AT-EOB-CODE5.
  5905             20  AT-PMT-PROOF-DT         PIC XX.
  5906             20  FILLER                  PIC X.
  5907
  5908         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  5909             88  AT-PRINT-EOB            VALUE 'Y'.
  5910
  5911         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  5912         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  5913
  5914     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  5915         16  AT-SCHEDULE-START-DT        PIC XX.
  5916         16  AT-SCHEDULE-END-DT          PIC XX.
  5917         16  AT-TERMINATED-DT            PIC XX.
  5918         16  AT-LAST-PMT-TYPE            PIC X.
  5919             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  5920             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  5921         16  AT-FIRST-PMT-DATA.
  5922             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5923             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  5924             20  AT-1ST-PAY-THRU-DT      PIC XX.
  5925         16  AT-REGULAR-PMT-DATA.
  5926             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  5927             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  5928             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  5929         16  AT-AUTO-PAYEE-CD.
  5930             20  AT-AUTO-PAYEE-TYPE      PIC X.
  5931                 88  INSURED-PAID-AUTO      VALUE 'I'.
  5932                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  5933                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  5934                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  5935                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  5936             20  AT-AUTO-PAYEE-SEQ       PIC X.
  5937         16  AT-AUTO-PAY-DAY             PIC 99.
  5938         16  AT-AUTO-CASH                PIC X.
  5939             88  AT-CASH                      VALUE 'Y'.
  5940             88  AT-NON-CASH                  VALUE 'N'.
  5941*        16  FILLER                      PIC X(129).
  5942         16  AT-AUTO-END-LETTER          PIC X(4).
  5943         16  FILLER                      PIC X(125).
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 113
* EL152.cbl
  5944
  5945         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  5946         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  5947
  5948     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  5949         16  AT-LETTER-SENT-DT           PIC XX.
  5950         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  5951         16  AT-AUTO-RE-SEND-DT          PIC XX.
  5952         16  AT-LETTER-ANSWERED-DT       PIC XX.
  5953         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  5954         16  AT-LETTER-ORIGIN            PIC X.
  5955             88  ONLINE-CREATION              VALUE '1' '3'.
  5956             88  OFFLINE-CREATION             VALUE '2' '4'.
  5957             88  NAPER-ONLINE-CREATION        VALUE '3'.
  5958             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  5959         16  AT-STD-LETTER-FORM          PIC X(4).
  5960         16  AT-REASON-TEXT              PIC X(70).
  5961         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  5962         16  AT-ADDRESEE-TYPE            PIC X.
  5963              88  INSURED-ADDRESEE            VALUE 'I'.
  5964              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  5965              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  5966              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  5967              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  5968              88  OTHER-ADDRESEE-1            VALUE 'O'.
  5969              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  5970         16  AT-ADDRESSEE-NAME           PIC X(30).
  5971         16  AT-INITIAL-PRINT-DATE       PIC XX.
  5972         16  AT-RESEND-PRINT-DATE        PIC XX.
  5973         16  AT-CORR-SOL-UNSOL           PIC X.
  5974         16  AT-LETTER-PURGED-DT         PIC XX.
  5975*
  5976*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  5977*
  5978         16  AT-CSO-REDEFINITION.
  5979             20  AT-RESEND-LETTER-FORM   PIC X(4).
  5980             20  AT-AUTO-CLOSE-IND       PIC X(1).
  5981             20  AT-LETTER-TO-BENE       PIC X(1).
  5982             20  AT-STOP-LETTER-DT       PIC X(2).
  5983             20  FILLER                  PIC X(19).
  5984*             20  FILLER                  PIC X(27).
  5985             20  AT-CSO-LETTER-STATUS    PIC X.
  5986                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  5987                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  5988                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  5989             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  5990             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  5991*
  5992*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  5993*
  5994*        16  FILLER                      PIC X(26).
  5995*
  5996*        16  AT-DMD-BSR-CODE             PIC X.
  5997*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  5998*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  5999*
  6000*        16  AT-DMD-LETTER-STATUS        PIC X.
  6001*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 114
* EL152.cbl
  6002*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6003*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6004*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6005*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6006
  6007         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6008         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6009
  6010     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6011         16  AT-ADDRESS-TYPE             PIC X.
  6012             88  INSURED-ADDRESS               VALUE 'I'.
  6013             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6014             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6015             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6016             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6017             88  OTHER-ADDRESS-1               VALUE 'O'.
  6018             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6019         16  AT-MAIL-TO-NAME             PIC X(30).
  6020         16  AT-ADDRESS-LINE-1           PIC X(30).
  6021         16  AT-ADDRESS-LINE-2           PIC X(30).
  6022         16  AT-CITY-STATE.
  6023             20  AT-CITY                 PIC X(28).
  6024             20  AT-STATE                PIC XX.
  6025         16  AT-ZIP.
  6026             20  AT-ZIP-CODE.
  6027                 24  AT-ZIP-1ST          PIC X.
  6028                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6029                 24  FILLER              PIC X(4).
  6030             20  AT-ZIP-PLUS4            PIC X(4).
  6031         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6032             20  AT-CAN-POSTAL-1         PIC XXX.
  6033             20  AT-CAN-POSTAL-2         PIC XXX.
  6034             20  FILLER                  PIC XXX.
  6035         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6036*         16  FILLER                      PIC X(23).
  6037         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6038         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6039         16  FILLER                      PIC X(13).
  6040         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6041         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6042
  6043     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6044         16  AT-INFO-LINE-1              PIC X(60).
  6045         16  AT-INFO-LINE-2              PIC X(60).
  6046         16  AT-INFO-TRAILER-TYPE        PIC X.
  6047             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6048             88  AT-CALL-NOTE            VALUE 'C'.
  6049             88  AT-MAINT-NOTE           VALUE 'M'.
  6050             88  AT-CERT-CHANGE          VALUE 'X'.
  6051             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6052             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6053         16  AT-CALL-TYPE                PIC X.
  6054             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6055             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6056         16  AT-NOTE-CONTINUATION        PIC X.
  6057             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6058         16  AT-EOB-CODES-EXIST          PIC X.
  6059             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 115
* EL152.cbl
  6060         16  FILLER                      PIC X(35).
  6061         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6062         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6063
  6064     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6065         16  AT-PROMPT-LINE-1            PIC X(60).
  6066         16  AT-PROMPT-LINE-2            PIC X(60).
  6067         16  AT-PROMPT-START-DT          PIC XX.
  6068         16  AT-PROMPT-END-DT            PIC XX.
  6069         16  FILLER                      PIC X(35).
  6070         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6071         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6072
  6073     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6074         16  AT-DENIAL-INFO-1            PIC X(60).
  6075         16  AT-DENIAL-INFO-2            PIC X(60).
  6076         16  AT-DENIAL-DT                PIC XX.
  6077         16  AT-RETRACTION-DT            PIC XX.
  6078         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6079*         16  FILLER                      PIC X(31).
  6080         16  AT-DENIAL-PROOF-DT          PIC XX.
  6081         16  FILLER                      PIC X(29).
  6082         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6083         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6084
  6085     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6086         16  AT-OLD-INCURRED-DT          PIC XX.
  6087         16  AT-OLD-REPORTED-DT          PIC XX.
  6088         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6089         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6090         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6091         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6092         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6093         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6094         16  FILLER                      PIC X(26).
  6095         16  AT-OLD-DIAG-CODE            PIC X(6).
  6096         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6097         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6098         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6099         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6100         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6101         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6102         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6103         16  FILLER                      PIC X(25).
  6104         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6105
  6106     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6107         16  AT-FORM-SEND-ON-DT          PIC XX.
  6108         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6109         16  AT-FORM-RE-SEND-DT          PIC XX.
  6110         16  AT-FORM-ANSWERED-DT         PIC XX.
  6111         16  AT-FORM-PRINTED-DT          PIC XX.
  6112         16  AT-FORM-REPRINT-DT          PIC XX.
  6113         16  AT-FORM-TYPE                PIC X.
  6114             88  INITIAL-FORM                  VALUE '1'.
  6115             88  PROGRESS-FORM                 VALUE '2'.
  6116         16  AT-INSTRUCT-LN-1            PIC X(28).
  6117         16  AT-INSTRUCT-LN-2            PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 116
* EL152.cbl
  6118         16  AT-INSTRUCT-LN-3            PIC X(28).
  6119         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6120         16  AT-FORM-ADDRESS             PIC X.
  6121             88  FORM-TO-INSURED              VALUE 'I'.
  6122             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6123             88  FORM-TO-OTHER-1              VALUE 'O'.
  6124             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6125         16  AT-RELATED-1.
  6126             20 AT-REL-CARR-1            PIC X.
  6127             20 AT-REL-CLAIM-1           PIC X(7).
  6128             20 AT-REL-CERT-1            PIC X(11).
  6129         16  AT-RELATED-2.
  6130             20 AT-REL-CARR-2            PIC X.
  6131             20 AT-REL-CLAIM-2           PIC X(7).
  6132             20 AT-REL-CERT-2            PIC X(11).
  6133         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6134         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6135         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6136         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6137         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6138         16  AT-STOP-FORM-DT             PIC X(2).
  6139
  6140         16  FILLER                      PIC X(09).
  6141         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6142         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6143******************************************************************
  6144
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 117
* EL152.cbl
  6146*                                COPY ELCBENE.
  6147******************************************************************
  6148*                                                                *
  6149*                            ELCBENE.                            *
  6150*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6151*                            VMOD=2.006                          *
  6152*                                                                *
  6153*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6154*                                                                *
  6155*   FILE TYPE = VSAM,KSDS                                        *
  6156*   RECORD SIZE = 500   RECFORM = FIX                            *
  6157*                                                                *
  6158*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6159*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6160*                                                                *
  6161*   LOG = YES                                                    *
  6162*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6163*                                                                *
  6164*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6165******************************************************************
  6166
  6167 01  BENEFICIARY-MASTER.
  6168     12  BE-RECORD-ID                PIC XX.
  6169         88  VALID-BE-ID                VALUE 'BE'.
  6170
  6171     12  BE-CONTROL-PRIMARY.
  6172         16  BE-COMPANY-CD           PIC X.
  6173         16  BE-RECORD-TYPE          PIC X.
  6174             88  BENEFICIARY-RECORD  VALUE 'B'.
  6175             88  ADJUSTOR-RECORD     VALUE 'A'.
  6176         16  BE-BENEFICIARY          PIC X(10).
  6177     12  BE-CONTROL-BY-NAME.
  6178         16  BE-COMPANY-CD-A1        PIC X.
  6179         16  BE-RECORD-TYPE-A1       PIC X.
  6180         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6181         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6182
  6183     12  BE-LAST-MAINT-DT            PIC XX.
  6184     12  BE-LAST-MAINT-BY            PIC X(4).
  6185     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6186
  6187     12  BE-ADDRESS-DATA.
  6188         16  BE-MAIL-TO-NAME         PIC X(30).
  6189         16  BE-ADDRESS-LINE-1       PIC X(30).
  6190         16  BE-ADDRESS-LINE-2       PIC X(30).
  6191         16  BE-ADDRESS-LINE-3       PIC X(30).
  6192         16  BE-CITY-STATE.
  6193             20  BE-CITY             PIC X(28).
  6194             20  BE-STATE            PIC XX.
  6195         16  BE-ZIP-CODE.
  6196             20  BE-ZIP-PRIME.
  6197                 24  BE-ZIP-1ST      PIC X.
  6198                     88  BE-CANADIAN-POST-CODE
  6199                                         VALUE 'A' THRU 'Z'.
  6200                 24  FILLER          PIC X(4).
  6201             20  BE-ZIP-PLUS4        PIC X(4).
  6202         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6203             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 118
* EL152.cbl
  6204             20  BE-CAN-POSTAL-2     PIC XXX.
  6205             20  FILLER              PIC XXX.
  6206         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6207         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6208
  6209******************************************************************
  6210*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6211*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6212******************************************************************
  6213     12  BE-CARRIER                  PIC X.
  6214
  6215     12  BE-ADDRESS-DATA2.
  6216         16  BE-MAIL-TO-NAME2        PIC X(30).
  6217         16  BE-ADDRESS-LINE-12      PIC X(30).
  6218         16  BE-ADDRESS-LINE-22      PIC X(30).
  6219         16  BE-ADDRESS-LINE-32      PIC X(30).
  6220         16  BE-CITY-STATE2.
  6221             20  BE-CITY2            PIC X(28).
  6222             20  BE-STATE2           PIC XX.
  6223         16  BE-ZIP-CODE2.
  6224             20  BE-ZIP-PRIME2.
  6225                 24  BE-ZIP-1ST2     PIC X.
  6226                     88  BE-CANADIAN-POST-CODE2
  6227                                         VALUE 'A' THRU 'Z'.
  6228                 24  FILLER          PIC X(4).
  6229             20  BE-ZIP-PLUS42       PIC X(4).
  6230         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6231             20  BE-CAN-POSTAL-12    PIC XXX.
  6232             20  BE-CAN-POSTAL-22    PIC XXX.
  6233             20  FILLER              PIC XXX.
  6234         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6235         16  BE-BILLING-STMT-DATA.
  6236             20  BE-BSR              PIC X.
  6237                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6238                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6239             20  BE-BSR-FROM         PIC X(30).
  6240             20  BE-BSR-DEPT         PIC X(30).
  6241             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6242             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6243             20  BE-OUTPUT-TYPE      PIC X.
  6244                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6245                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6246
  6247     12  FILLER                      PIC X(28).
  6248******************************************************************
  6249
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 119
* EL152.cbl
  6251*                                COPY ERCCOMP.
  6252******************************************************************
  6253*                                                                *
  6254*                                                                *
  6255*                            ERCCOMP                             *
  6256*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6257*                            VMOD=2.019                          *
  6258*                                                                *
  6259*   ONLINE CREDIT SYSTEM                                         *
  6260*                                                                *
  6261*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  6262*                                                                *
  6263*   FILE TYPE = VSAM,KSDS                                        *
  6264*   RECORD SIZE = 700   RECFORM = FIXED                          *
  6265*                                                                *
  6266*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  6267*       ALTERNATE PATH = NONE                                    *
  6268*                                                                *
  6269*   LOG = NO                                                     *
  6270*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6271*                                                                *
  6272******************************************************************
  6273*                   C H A N G E   L O G
  6274*
  6275* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6276*-----------------------------------------------------------------
  6277*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6278* EFFECTIVE    NUMBER
  6279*-----------------------------------------------------------------
  6280* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6281* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  6282* 092205    2005050300006  PEMA  ADD LEASE FEE
  6283* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  6284* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  6285* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  6286* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6287* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  6288******************************************************************
  6289
  6290 01  COMPENSATION-MASTER.
  6291     12  CO-RECORD-ID                          PIC XX.
  6292         88  VALID-CO-ID                          VALUE 'CO'.
  6293
  6294     12  CO-CONTROL-PRIMARY.
  6295         16  CO-COMPANY-CD                     PIC X.
  6296         16  CO-CONTROL.
  6297             20  CO-CTL-1.
  6298                 24  CO-CARR-GROUP.
  6299                     28  CO-CARRIER            PIC X.
  6300                     28  CO-GROUPING.
  6301                         32  CO-GROUP-PREFIX   PIC XXX.
  6302                         32  CO-GROUP-PRIME    PIC XXX.
  6303                 24  CO-RESP-NO.
  6304                     28  CO-RESP-PREFIX        PIC X(4).
  6305                     28  CO-RESP-PRIME         PIC X(6).
  6306             20  CO-CTL-2.
  6307                 24  CO-ACCOUNT.
  6308                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 120
* EL152.cbl
  6309                     28  CO-ACCT-PRIME         PIC X(6).
  6310         16  CO-TYPE                           PIC X.
  6311             88  CO-COMPANY-TYPE                  VALUE 'C'.
  6312             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  6313             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  6314
  6315     12  CO-MAINT-INFORMATION.
  6316         16  CO-LAST-MAINT-DT                  PIC XX.
  6317         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6318         16  CO-LAST-MAINT-USER                PIC X(4).
  6319     12  FILLER                                PIC XX.
  6320     12  CO-STMT-TYPE                          PIC XXX.
  6321     12  CO-COMP-TYPE                          PIC X.
  6322         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  6323     12  CO-STMT-OWNER                         PIC X(4).
  6324     12  CO-BALANCE-CONTROL                    PIC X.
  6325         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  6326         88  CO-NO-BALANCE                        VALUE 'N'.
  6327
  6328     12  CO-INTERNAL-CONTROL-1                 PIC X.
  6329         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  6330         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  6331         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  6332
  6333     12  CO-INTERNAL-CONTROL-2                 PIC X.
  6334         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  6335         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  6336
  6337     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  6338     12  CO-GA-DIRECT-DEP                      PIC X.
  6339     12  CO-FUTURE-SPACE                       PIC X.
  6340         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  6341
  6342     12  CO-ACCT-NAME                          PIC X(30).
  6343     12  CO-MAIL-NAME                          PIC X(30).
  6344     12  CO-ADDR-1                             PIC X(30).
  6345     12  CO-ADDR-2                             PIC X(30).
  6346     12  CO-ADDR-3.
  6347         16  CO-ADDR-CITY                      PIC X(27).
  6348         16  CO-ADDR-STATE                     PIC XX.
  6349     12  CO-CSO-1099                           PIC X.
  6350     12  CO-ZIP.
  6351         16  CO-ZIP-PRIME.
  6352             20  CO-ZIP-PRI-1ST                PIC X.
  6353                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  6354             20  FILLER                        PIC X(4).
  6355         16  CO-ZIP-PLUS4                      PIC X(4).
  6356     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  6357         16  CO-CAN-POSTAL-1                   PIC XXX.
  6358         16  CO-CAN-POSTAL-2                   PIC XXX.
  6359         16  FILLER                            PIC XXX.
  6360     12  CO-SOC-SEC                            PIC X(13).
  6361     12  CO-TELEPHONE.
  6362         16  CO-AREA-CODE                      PIC XXX.
  6363         16  CO-PREFIX                         PIC XXX.
  6364         16  CO-PHONE                          PIC X(4).
  6365
  6366     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 121
* EL152.cbl
  6367
  6368     12  CO-AR-BAL-LEVEL                       PIC X.
  6369         88  CO-AR-REF-LVL                        VALUE '1'.
  6370         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  6371         88  CO-AR-BILL-LVL                       VALUE '2'.
  6372         88  CO-AR-AGT-LVL                        VALUE '3'.
  6373         88  CO-AR-FR-LVL                         VALUE '4'.
  6374
  6375     12  CO-AR-NORMAL-PRINT                    PIC X.
  6376         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  6377         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  6378
  6379     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  6380
  6381     12  CO-AR-REPORTING                       PIC X.
  6382         88  CO-AR-NET-REPORT                     VALUE 'N'.
  6383         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  6384
  6385     12  CO-AR-PULL-CHECK                      PIC X.
  6386         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  6387         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  6388
  6389     12  CO-AR-BALANCE-PRINT                   PIC X.
  6390         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  6391
  6392     12  CO-AR-LAST-RUN-CODE                   PIC X.
  6393         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  6394         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  6395         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  6396
  6397     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  6398
  6399     12  CO-USER-CODE                          PIC X.
  6400     12  CO-REPORT-GROUP-ID                    PIC X(12).
  6401
  6402******************************************************************
  6403*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  6404*    THE LAST MONTH END RUN.
  6405******************************************************************
  6406
  6407     12  CO-LAST-ACTIVITY-DATE.
  6408         16  CO-ACT-YEAR                       PIC 99.
  6409         16  CO-ACT-MONTH                      PIC 99.
  6410         16  CO-ACT-DAY                        PIC 99.
  6411
  6412     12  CO-LAST-STMT-DT.
  6413         16  CO-LAST-STMT-YEAR                 PIC 99.
  6414         16  CO-LAST-STMT-MONTH                PIC 99.
  6415         16  CO-LAST-STMT-DAY                  PIC 99.
  6416
  6417     12  CO-MO-END-TOTALS.
  6418         16  CO-MONTHLY-TOTALS.
  6419             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  6420             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  6421             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  6422             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  6423             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  6424
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 122
* EL152.cbl
  6425         16  CO-AGING-TOTALS.
  6426             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  6427             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  6428             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  6429             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  6430
  6431         16  CO-YTD-TOTALS.
  6432             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  6433             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  6434
  6435         16  CO-OVER-UNDER-TOTALS.
  6436             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6437             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6438
  6439     12  CO-MISCELLANEOUS-TOTALS.
  6440         16  CO-FICA-TOTALS.
  6441             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  6442             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  6443
  6444         16  CO-CLAIM-TOTALS.
  6445             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  6446             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  6447
  6448******************************************************************
  6449*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  6450*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  6451******************************************************************
  6452
  6453     12  CO-CURRENT-TOTALS.
  6454         16  CO-CURRENT-LAST-STMT-DT.
  6455             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  6456             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  6457             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  6458
  6459         16  CO-CURRENT-MONTHLY-TOTALS.
  6460             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  6461             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  6462             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  6463             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  6464             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  6465
  6466         16  CO-CURRENT-AGING-TOTALS.
  6467             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  6468             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  6469             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  6470             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  6471
  6472         16  CO-CURRENT-YTD-TOTALS.
  6473             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  6474             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  6475
  6476     12  CO-PAID-COMM-TOTALS.
  6477         16  CO-YTD-PAID-COMMS.
  6478             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  6479             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  6480
  6481     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  6482         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 123
* EL152.cbl
  6483         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  6484
  6485     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  6486         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  6487         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  6488         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  6489         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  6490         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  6491         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  6492         88  CO-FINAL-LETTER                  VALUE 'F'.
  6493         88  CO-RECONCILING                   VALUE 'R'.
  6494         88  CO-PHONE-CALL                    VALUE 'P'.
  6495         88  CO-LEGAL                         VALUE 'L'.
  6496         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  6497         88  CO-WRITE-OFF                     VALUE 'W'.
  6498         88  CO-NO-ACTION                     VALUE 'N' ' '.
  6499
  6500     12  CO-CSR-CODE                       PIC X(4).
  6501
  6502     12  CO-GA-STATUS-INFO.
  6503         16  CO-GA-EFFECTIVE-DT            PIC XX.
  6504         16  CO-GA-TERMINATION-DT          PIC XX.
  6505         16  CO-GA-STATUS-CODE             PIC X.
  6506             88  CO-GA-ACTIVE                 VALUE 'A'.
  6507             88  CO-GA-INACTIVE               VALUE 'I'.
  6508             88  CO-GA-PENDING                VALUE 'P'.
  6509         16  CO-GA-COMMENTS.
  6510             20  CO-GA-COMMENT-1           PIC X(40).
  6511             20  CO-GA-COMMENT-2           PIC X(40).
  6512             20  CO-GA-COMMENT-3           PIC X(40).
  6513             20  CO-GA-COMMENT-4           PIC X(40).
  6514
  6515     12  CO-RPTCD2                         PIC X(10).
  6516
  6517     12  CO-TYPE-AGENT                     PIC X(01).
  6518         88  CO-CORPORATION                   VALUE 'C'.
  6519         88  CO-PARTNERSHIP                   VALUE 'P'.
  6520         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  6521         88  CO-TRUST                         VALUE 'T'.
  6522         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  6523
  6524     12  CO-FAXNO.
  6525         16  CO-FAX-AREA-CODE                  PIC XXX.
  6526         16  CO-FAX-PREFIX                     PIC XXX.
  6527         16  CO-FAX-PHONE                      PIC X(4).
  6528
  6529     12  CO-BANK-INFORMATION.
  6530         16  CO-BANK-TRANSIT-NO                PIC X(8).
  6531         16  CO-BANK-TRANSIT-NON REDEFINES
  6532             CO-BANK-TRANSIT-NO                PIC 9(8).
  6533
  6534         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  6535     12  CO-MISC-DEDUCT-INFO REDEFINES
  6536                  CO-BANK-INFORMATION.
  6537         16  CO-MD-GL-ACCT                     PIC X(10).
  6538         16  CO-MD-DIV                         PIC XX.
  6539         16  CO-MD-CENTER                      PIC X(4).
  6540         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 124
* EL152.cbl
  6541         16  CO-CREATE-AP-CHECK                PIC X.
  6542         16  CO-DELIVER-CK-TO-MEL              PIC X.
  6543         16  FILLER                            PIC XXX.
  6544     12  CO-ACH-STATUS                         PIC X.
  6545         88  CO-ACH-ACTIVE                         VALUE 'A'.
  6546         88  CO-ACH-PENDING                        VALUE 'P'.
  6547
  6548     12  CO-BILL-SW                            PIC X.
  6549     12  CO-CONTROL-NAME                       PIC X(30).
  6550     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  6551     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  6552     12  CO-CLP-STATE                          PIC XX.
  6553     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  6554     12  CO-SPP-REFUND-EDIT                    PIC X.
  6555
  6556******************************************************************
  6557
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 125
* EL152.cbl
  6559*                                COPY MPCPROD.
  6560*    EJECT
  6561*                                COPY MPCPLCY.
  6562*    EJECT
  6563*                                COPY MPCPLAN.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 126
* EL152.cbl
  6565*                                COPY ELCNAPS.
  6566******************************************************************
  6567*                                                                *
  6568*                            ELCNAPS                             *
  6569*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6570*                            VMOD=2.003                          *
  6571*                                                                *
  6572*        FILE DESCRIPTION = NAPERSOFT LETTER FILE                *
  6573*                                                                *
  6574*        FILE TYPE= VSAM,KSDS                                    *
  6575*        RECORD SIZE = 150    RECFORM = FIXED                    *
  6576*                                                                *
  6577*        BASE CLUSTER = ELNAPS        RKP=2,LEN=28               *
  6578*                                                                *
  6579*        LOG = YES                                               *
  6580*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6581*                                                                *
  6582******************************************************************
  6583*                   C H A N G E   L O G
  6584*
  6585* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6586*-----------------------------------------------------------------
  6587*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6588* EFFECTIVE    NUMBER
  6589*-----------------------------------------------------------------
  6590* 033110  CR2009122800001  AJRA  NEW FILE FOR NAPERSOFT.
  6591******************************************************************
  6592
  6593 01  NAPERSOFT-FILE.
  6594     12  NA-RECORD-ID                PIC  XX.
  6595         88  VALID-NA-ID                  VALUE 'NA'.
  6596
  6597     12  NA-CONTROL-PRIMARY.
  6598         16  NA-COMPANY-CD           PIC X.
  6599         16  NA-CARRIER              PIC X.
  6600         16  NA-CLAIM-NO             PIC X(7).
  6601         16  NA-CERT-NO.
  6602             20  NA-CERT-PRIME       PIC X(10).
  6603             20  NA-CERT-SFX         PIC X.
  6604         16  NA-ARCHIVE-NO           PIC 9(8).
  6605
  6606     12  NA-LETTER-INFORMATION.
  6607         16  NA-LETTER-ID            PIC X(4).
  6608         16  NA-PROCESSOR-ID         PIC X(4).
  6609         16  NA-CREATION-DT          PIC X(2).
  6610         16  NA-INITIAL-PRINT-DT     PIC X(2).
  6611         16  NA-FOLLOW-UP-DT         PIC X(2).
  6612         16  NA-RESEND-DT            PIC X(2).
  6613         16  NA-RESEND-LETTER-ID     PIC X(4).
  6614         16  NA-NO-OF-COPIES         PIC 9(2).
  6615         16  NA-ADDRESS-TYPE         PIC X(2).
  6616         16  NA-CORR-TRLR-SEQ        PIC 9(4).
  6617         16  NA-RESEND-PRINT-DT      PIC X(2).
  6618         16  NA-1ST-LTR-PRINT-DT     PIC X(2).
  6619         16  NA-NEXT-DUE-DT          PIC X(2).
  6620         16  NA-AUTOPYDT             PIC X(2).
  6621         16  NA-ENCLOSURE-CD         PIC X(3).
  6622         16  NA-CREATED-IN-NAPERSOFT PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 127
* EL152.cbl
  6623         16  NA-ORIG-ARCHIVE-NO      PIC 9(9).
  6624         16  NA-RESEND-PROMPT-IND    PIC X(1).
  6625         16  NA-ORIG-ENCLOSURE-CD    PIC X(3).
  6626         16  FILLER                  PIC X(67).
  6627******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 128
* EL152.cbl
  6629*  THE SYSTEM-VARIABLES  FIELD LENGTH MUST MATCH THE LENGTH OF
  6630*  THE SS-WORK-AREA-LENGTH FIELD FOR THE VARIABLE-WORK-AREA
  6631
  6632*01  SYSTEM-VARIABLES            PIC X(3851).
  6633*01  SYS-VAR-ENTRY REDEFINES SYSTEM-VARIABLES.
  6634*    12  SYS-VAR-CODE            PIC X(4).
  6635*    12  SYS-VAR-LEN             PIC 99.
  6636*    12  SYS-VAR-DATA            PIC X(100).
  6637
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 129
* EL152.cbl
  6639 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR CLAIM-MASTER
  6640                          CONTROL-FILE LETTER-ARCHIVE
  6641                          LETTER-ARCHIVE-TEMP
  6642                          CERTIFICATE-MASTER ACCOUNT-MASTER
  6643                          TEXT-FILES ACTIVITY-TRAILERS
  6644                          BENEFICIARY-MASTER
  6645                          COMPENSATION-MASTER NAPERSOFT-FILE.
  6646 0000-DFHEXIT SECTION.
  6647     MOVE '9#                    $   ' TO DFHEIV0.
  6648     MOVE 'EL152' TO DFHEIV1.
  6649     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6650
  6651     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  6652     MOVE '5'                   TO DC-OPTION-CODE.
  6653     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  6654     MOVE DC-GREG-DATE-1-EDIT   TO SAVE-DATE.
  6655     MOVE DC-BIN-DATE-1         TO SAVE-BIN-DATE.
  6656
  6657     MOVE DFHCOMMAREA           TO PROGRAM-INTERFACE-BLOCK.
  6658     MOVE 1                     TO EMI-NUMBER-OF-LINES.
  6659     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  6660                                TO EMI-SAVE-AREA.
  6661
  6662     MOVE EIBTRMID              TO TS-TERM-TEXT
  6663                                   TS-TERM-SCREEN
  6664                                   QID-TERM.
  6665
  6666     MOVE SAVE-BIN-DATE       TO CURRENT-SAVE.
  6667
  6668*    IF PI-COMPANY-ID = 'DMD'
  6669*       MOVE CURRENT-SAVE           TO DC-BIN-DATE-1
  6670*       MOVE '6'                    TO DC-OPTION-CODE
  6671*       MOVE +3                     TO DC-ELAPSED-MONTHS
  6672*       MOVE +0                     TO DC-ELAPSED-DAYS
  6673*       PERFORM 9700-DATE-LINK THRU 9700-EXIT
  6674*       MOVE DC-BIN-DATE-2          TO CURRENT-PLUS3-SAVE.
  6675
  6676
  6677* EXEC CICS HANDLE CONDITION
  6678*        PGMIDERR (9600-PGMID-ERROR)
  6679*        MAPFAIL  (0325-MAPFAIL)
  6680*        ERROR    (9990-ABEND)
  6681*    END-EXEC.
  6682*    MOVE '"$L?.                 ! " #00006672' TO DFHEIV0
  6683     MOVE X'22244C3F2E20202020202020' TO DFHEIV0(1:12)
  6684     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6685     MOVE X'2220233030303036363732' TO DFHEIV0(25:11)
  6686     CALL 'kxdfhei1' USING DFHEIV0
  6687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6688
  6689
  6690     IF PI-PROCESSOR-ID NOT = 'LGXX'
  6691
  6692* EXEC CICS READQ TS
  6693*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6694*            INTO    (SECURITY-CONTROL)
  6695*            LENGTH  (SC-COMM-LENGTH)
  6696*            ITEM    (SC-ITEM)
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 130
* EL152.cbl
  6697*        END-EXEC
  6698*    MOVE '*$II   L              ''   #00006679' TO DFHEIV0
  6699     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6700     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6701     MOVE X'2020233030303036363739' TO DFHEIV0(25:11)
  6702     CALL 'kxdfhei1' USING DFHEIV0,
  6703           PI-SECURITY-TEMP-STORE-ID,
  6704           SECURITY-CONTROL,
  6705           SC-COMM-LENGTH,
  6706           SC-ITEM,
  6707           DFHEIV99,
  6708           DFHEIV99
  6709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6710         MOVE SC-CLAIMS-DISPLAY (7)  TO  PI-DISPLAY-CAP
  6711         MOVE SC-CLAIMS-UPDATE  (7)  TO  PI-MODIFY-CAP.
  6712
  6713     set P to address of KIXSYS
  6714     CALL "getenv" using by value P returning var-ptr
  6715     if var-ptr = null then
  6716        display ' kixsys not set '
  6717     else
  6718        set address of var to var-ptr
  6719        move 0 to env-var-len
  6720        inspect var tallying env-var-len
  6721          for characters before X'00'
  6722        unstring var (1:env-var-len) delimited by '/'
  6723           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  6724              WS-KIX-SYS
  6725        end-unstring
  6726     end-if
  6727     IF EIBCALEN = 0
  6728         GO TO 8800-UNAUTHORIZED-ACCESS.
  6729
  6730     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  6731         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  6732             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  6733             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  6734             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  6735             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  6736             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  6737             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  6738             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  6739             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  6740             PERFORM 7750-DELETE-TEMP-STOR         THRU 7750-EXIT
  6741             PERFORM 7760-DELETE-TEMP-STOR-SCREEN  THRU 7760-EXIT
  6742             PERFORM 7770-DELETE-TEMP-STOR-PI-AREA THRU 7770-EXIT
  6743             MOVE SPACES              TO PI-WA
  6744                                         PI-FORCE-7840
  6745             MOVE ZEROS               TO PI-TOTAL-LINES
  6746                                         PI-CURRENT-LINE
  6747                                         PI-TEMP-STOR-ITEMS
  6748                                         PI-UPDATE-SW
  6749                                         PI-ADDR-SEQ
  6750             MOVE '2'                 TO PI-ACTION
  6751             MOVE LOW-VALUES          TO EL152AO
  6752                                         PI-ADDR-TYPE
  6753             GO TO 8100-SEND-INITIAL-MAP
  6754         ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 131
* EL152.cbl
  6755             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  6756             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  6757             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  6758             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  6759             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  6760             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  6761             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  6762             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  6763             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  6764             PERFORM 7500-READ-TS           THRU 7599-EXIT
  6765             PERFORM 7600-READ-SCREEN-TS    THRU 7699-EXIT
  6766             IF PGM-NAME = PGM-EL141
  6767                PERFORM 500-RECOVER-PI-TEMP-STORAGE THRU 599-EXIT
  6768                SET TB-INDX TO PI-CURRENT-LINE
  6769                PERFORM 400-SET-CODES       THRU 499-EXIT
  6770                PERFORM 7000-READ-ADDR      THRU 7099-EXIT
  6771                PERFORM 7170-FORMAT-SCREEN  THRU 7170-EXIT
  6772                        VARYING SC-INDX FROM 1 BY 1 UNTIL
  6773                        SC-INDX > NUM-LINES-PER-SCREEN
  6774                MOVE PI-ALT-PRINTER-ID  TO PRINTERO
  6775                MOVE AL-UANON           TO PRINTERA
  6776                GO TO 8100-SEND-INITIAL-MAP
  6777             ELSE
  6778                SET TB-INDX TO PI-CURRENT-LINE
  6779                PERFORM 7170-FORMAT-SCREEN   THRU  7170-EXIT
  6780                        VARYING SC-INDX FROM 1 BY 1 UNTIL
  6781                        SC-INDX > NUM-LINES-PER-SCREEN
  6782                MOVE PI-ALT-PRINTER-ID  TO PRINTERO
  6783                MOVE AL-UANON           TO PRINTERA
  6784                GO TO 8100-SEND-INITIAL-MAP.
  6785
  6786*0100-PA.
  6787*    MOVE ER-0008                TO EMI-ERROR.
  6788*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6789*    MOVE -1                     TO MAINTL.
  6790*    GO TO 8200-SEND-DATAONLY.
  6791
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 132
* EL152.cbl
  6793 0200-RECEIVE.
  6794     MOVE TRANS-ID         TO EIBTRNID.
  6795     MOVE EMI-SAVE-AREA    TO ERROR-MESSAGE-INTERFACE-BLOCK.
  6796     MOVE LOW-VALUES       TO EL152AI.
  6797     MOVE '104A'           TO TS-ID-TEXT.
  6798     MOVE EIBTRMID         TO TS-TERM-TEXT
  6799                              TS-TERM-SCREEN
  6800                              QID-TERM.
  6801
  6802
  6803* EXEC CICS HANDLE AID
  6804*        CLEAR    (9400-CLEAR)
  6805*        PA1      (0100-PA)
  6806*        PA2      (0100-PA)
  6807*        PA3      (0100-PA)
  6808*    END-EXEC.
  6809*    MOVE '"&=!"#               V! # #00006777' TO DFHEIV0
  6810     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  6811     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  6812     MOVE X'2320233030303036373737' TO DFHEIV0(25:11)
  6813     CALL 'kxdfhei1' USING DFHEIV0
  6814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6815
  6816
  6817
  6818* EXEC CICS HANDLE CONDITION
  6819*        MAPFAIL  (0325-MAPFAIL)
  6820*    END-EXEC.
  6821*    MOVE '"$?                   ! $ #00006784' TO DFHEIV0
  6822     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  6823     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6824     MOVE X'2420233030303036373834' TO DFHEIV0(25:11)
  6825     CALL 'kxdfhei1' USING DFHEIV0
  6826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6827
  6828
  6829
  6830* EXEC CICS SYNCPOINT
  6831*    END-EXEC.
  6832*    MOVE '6"                    !   #00006788' TO DFHEIV0
  6833     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  6834     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6835     MOVE X'2020233030303036373838' TO DFHEIV0(25:11)
  6836     CALL 'kxdfhei1' USING DFHEIV0
  6837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6838
  6839
  6840     IF LOWER-CASE-LETTERS-USED
  6841
  6842* EXEC CICS RECEIVE
  6843*            MAP      (MAP-NAME)
  6844*            MAPSET   (MAPSET-NAME)
  6845*            INTO     (EL152AI)
  6846*            ASIS
  6847*       END-EXEC
  6848     MOVE LENGTH OF
  6849      EL152AI
  6850       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 133
* EL152.cbl
  6851*    MOVE '8"TAI  L              ''   #00006792' TO DFHEIV0
  6852     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  6853     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6854     MOVE X'2020233030303036373932' TO DFHEIV0(25:11)
  6855     CALL 'kxdfhei1' USING DFHEIV0,
  6856           MAP-NAME,
  6857           EL152AI,
  6858           DFHEIV11,
  6859           MAPSET-NAME,
  6860           DFHEIV99,
  6861           DFHEIV99
  6862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6863      ELSE
  6864
  6865* EXEC CICS RECEIVE
  6866*            MAP      (MAP-NAME)
  6867*            MAPSET   (MAPSET-NAME)
  6868*            INTO     (EL152AI)
  6869*       END-EXEC.
  6870     MOVE LENGTH OF
  6871      EL152AI
  6872       TO DFHEIV11
  6873*    MOVE '8"T I  L              ''   #00006799' TO DFHEIV0
  6874     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6875     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6876     MOVE X'2020233030303036373939' TO DFHEIV0(25:11)
  6877     CALL 'kxdfhei1' USING DFHEIV0,
  6878           MAP-NAME,
  6879           EL152AI,
  6880           DFHEIV11,
  6881           MAPSET-NAME,
  6882           DFHEIV99,
  6883           DFHEIV99
  6884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6885
  6886
  6887     IF NOT DISPLAY-CAP AND PI-PROCESSOR-ID NOT = 'LGXX'
  6888         MOVE 'READ'             TO  SM-READ
  6889         PERFORM 9995-SECURITY-VIOLATION
  6890         MOVE ER-0070            TO  EMI-ERROR
  6891         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6892         GO TO 8100-SEND-INITIAL-MAP.
  6893
  6894     INSPECT MAINTI CONVERTING LOWER-CASE TO UPPER-CASE.
  6895     MOVE 'N'                    TO CLEANI
  6896
  6897     IF ENTERPFL = 0
  6898         GO TO 0300-CHECK-PFKEYS.
  6899     IF EIBAID NOT = DFHENTER
  6900         MOVE ER-0004            TO EMI-ERROR
  6901         GO TO 0320-INPUT-ERROR.
  6902     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  6903         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  6904     ELSE
  6905         MOVE ER-0029            TO EMI-ERROR
  6906         GO TO 0320-INPUT-ERROR.
  6907
  6908 0300-CHECK-PFKEYS.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 134
* EL152.cbl
  6909     IF EIBAID = DFHPF23
  6910         GO TO 8810-PF23.
  6911     IF EIBAID = DFHPF24
  6912         GO TO 9200-RETURN-MAIN-MENU.
  6913*    IF EIBAID = DFHPF12
  6914*        GO TO 9500-PF12.
  6915     IF EIBAID = DFHPF1
  6916         MOVE 7                  TO ROLL-COUNTER
  6917         GO TO 7900-ROLL-PAGE.
  6918     IF EIBAID = DFHPF2
  6919         MOVE -7                 TO ROLL-COUNTER
  6920         GO TO 7900-ROLL-PAGE.
  6921     IF EIBAID = DFHPF3
  6922         GO TO 6100-ADDR-MAINT.
  6923     IF EIBAID = DFHPF4
  6924         IF MODIFY-CAP
  6925             GO TO 6200-EDIT-MODE
  6926         ELSE
  6927             MOVE 'UPDATE'       TO  SM-READ
  6928             PERFORM 9995-SECURITY-VIOLATION
  6929             MOVE ER-0070        TO  EMI-ERROR
  6930             GO TO 0320-INPUT-ERROR.
  6931
  6932     IF EIBAID = DFHPF5
  6933         GO TO 0330-FUNCTION-CHECK.
  6934
  6935     IF EIBAID = DFHPF6
  6936         GO TO 0330-FUNCTION-CHECK.
  6937
  6938     IF EIBAID = DFHPF7
  6939        COMPUTE ROLL-COUNTER = ((PI-TOTAL-LINES - 1) * -1)
  6940        GO TO 7900-ROLL-PAGE.
  6941
  6942     IF EIBAID = DFHPF8
  6943        MOVE PI-TOTAL-LINES TO ROLL-COUNTER
  6944        GO TO 7900-ROLL-PAGE.
  6945
  6946*    IF EIBAID = DFHPF9 AND
  6947*       PI-COMPANY-ID = 'DMD'
  6948*        MOVE '1'           TO PI-FORCE-7840
  6949*        GO TO 0330-FUNCTION-CHECK.
  6950
  6951     IF EIBAID = DFHENTER
  6952         GO TO 0330-FUNCTION-CHECK.
  6953
  6954     PERFORM 7500-READ-TS        THRU 7599-EXIT
  6955
  6956     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  6957     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  6958             VARYING SC-INDX FROM 1 BY 1
  6959             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  6960
  6961     MOVE ER-0029                TO EMI-ERROR.
  6962 0320-INPUT-ERROR.
  6963     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6964     MOVE AL-UNBON               TO ENTERPFA.
  6965     IF ENTERPFL = 0
  6966         MOVE -1                 TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 135
* EL152.cbl
  6967     ELSE
  6968         MOVE -1                 TO ENTERPFL.
  6969
  6970     GO TO 8200-SEND-DATAONLY.
  6971
  6972 0100-PA.
  6973     MOVE ER-0008                TO EMI-ERROR.
  6974     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6975     MOVE -1                     TO MAINTL.
  6976     GO TO 8200-SEND-DATAONLY.
  6977
  6978 0325-MAPFAIL.
  6979***********************************************************
  6980*      ROUTINE SHOULD ONLY BE PERFORMED WHEN PRINTING     *
  6981*      LETTERS ON A 3275 PRINTER.                         *
  6982***********************************************************
  6983
  6984     PERFORM 7600-READ-SCREEN-TS    THRU 7699-EXIT.
  6985
  6986     SET TB-INDX         TO PI-CURRENT-LINE.
  6987     PERFORM 7170-FORMAT-SCREEN   THRU  7170-EXIT
  6988                  VARYING SC-INDX FROM 1 BY 1 UNTIL
  6989                  SC-INDX > NUM-LINES-PER-SCREEN.
  6990
  6991     GO TO 8100-SEND-INITIAL-MAP.
  6992
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 136
* EL152.cbl
  6994 0330-FUNCTION-CHECK.
  6995     IF NOT MODIFY-CAP
  6996         IF MAINTI = 'S'
  6997             NEXT SENTENCE
  6998         ELSE
  6999             MOVE 'UPDATE'           TO  SM-READ
  7000             PERFORM 9995-SECURITY-VIOLATION
  7001             MOVE ER-0070            TO  EMI-ERROR
  7002             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7003             GO TO 8100-SEND-INITIAL-MAP.
  7004
  7005     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  7006
  7007     IF EIBAID = DFHPF5
  7008      IF PI-PROMPT-LETTER = 'Y'
  7009         MOVE ER-0894            TO EMI-ERROR
  7010         MOVE -1             TO MAINTL
  7011         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7012         MOVE AL-UABON       TO MAINTA
  7013         GO TO 8200-SEND-DATAONLY
  7014      ELSE
  7015         IF MAINTI NOT = 'C'
  7016             MOVE ER-0716        TO EMI-ERROR
  7017             MOVE -1             TO MAINTL
  7018             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7019             MOVE AL-UABON       TO MAINTA
  7020             GO TO 8200-SEND-DATAONLY
  7021         ELSE
  7022             IF MODIFY-CAP
  7023                 GO TO 6400-LETTER-RELEASE
  7024             ELSE
  7025                 IF PRINT-PERFORMED
  7026                     GO TO 6400-LETTER-RELEASE
  7027                 ELSE
  7028                     MOVE AL-UNBON TO ENTERPFA
  7029                     MOVE -1       TO ENTERPFL
  7030                     MOVE ER-2398 TO EMI-ERROR
  7031                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7032                     GO TO 8200-SEND-DATAONLY.
  7033
  7034     IF EIBAID = DFHPF6
  7035      IF PI-PROMPT-LETTER = 'Y'
  7036         MOVE ER-0894            TO EMI-ERROR
  7037         MOVE -1             TO MAINTL
  7038         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7039         MOVE AL-UABON       TO MAINTA
  7040         GO TO 8200-SEND-DATAONLY
  7041      ELSE
  7042         GO TO 7800-PRINT-LETTER-NOW.
  7043
  7044     IF MAINTI = 'S'
  7045         GO TO 1000-SHOW.
  7046
  7047     IF MAINTI = 'C'
  7048         GO TO 2000-CREATE.
  7049
  7050     IF MAINTI = 'R'
  7051        IF NOT MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 137
* EL152.cbl
  7052           MOVE ER-0070          TO EMI-ERROR
  7053           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7054           MOVE LOW-VALUES       TO EL152AO
  7055           GO TO 8100-SEND-INITIAL-MAP
  7056          ELSE
  7057           GO TO 3000-RECORD.
  7058
  7059     PERFORM 7500-READ-TS        THRU 7599-EXIT
  7060     PERFORM 7950-SET-INDX       THRU 7950-EXIT
  7061     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN
  7062                                 THRU 7960-EXIT
  7063        VARYING SC-INDX FROM 1 BY 1 UNTIL
  7064        SC-INDX > NUM-LINES-PER-SCREEN
  7065     MOVE ER-0023                TO EMI-ERROR.
  7066     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7067     MOVE -1                     TO MAINTL.
  7068     MOVE AL-UABON               TO MAINTA.
  7069     GO TO 8200-SEND-DATAONLY.
  7070
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 138
* EL152.cbl
  7072 0350-EDIT-ROUTINE.
  7073     PERFORM 400-SET-CODES THRU 499-EXIT.
  7074     MOVE PI-CLAIM-NO    TO CLAM-CLAIM
  7075                            ACTV-CLAIM.
  7076
  7077     IF ADDRL NOT = +0
  7078        INSPECT ADDRI CONVERTING LOWER-CASE TO UPPER-CASE
  7079        MOVE ADDRI           TO WS-ADDR-TYPE-CD
  7080        IF WS-ADDR-TYPE = 'I' OR 'B' OR 'A' OR 'P' OR
  7081                          'O' OR 'Q' OR 'E'
  7082           MOVE AL-UANON         TO ADDRA
  7083        ELSE
  7084           MOVE -1               TO ADDRL
  7085           MOVE AL-UABON         TO ADDRA
  7086           MOVE ER-0176          TO EMI-ERROR
  7087           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7088*     ELSE
  7089*       IF PI-COMPANY-ID = 'DMD'
  7090*        IF MAINTI = 'C' OR 'R'
  7091*          MOVE -1               TO ADDRL
  7092*          MOVE AL-UABON         TO ADDRA
  7093*          MOVE ER-0861          TO EMI-ERROR
  7094*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7095
  7096     IF ADDRL NOT = +0
  7097        IF WS-ADDR-SEQ NOT NUMERIC
  7098           MOVE -1               TO ADDRL
  7099           MOVE AL-UABON         TO ADDRA
  7100           MOVE ER-0176          TO EMI-ERROR
  7101           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7102
  7103*    IF ADDRL NOT = +0
  7104*       IF PI-COMPANY-ID = 'DMD'
  7105*          IF WS-ADDR-TYPE = 'B' AND
  7106*             WS-ADDR-SEQ NOT = '9'
  7107*                MOVE -1               TO ADDRL
  7108*                MOVE AL-UABON         TO ADDRA
  7109*                MOVE ER-7842          TO EMI-ERROR
  7110*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7111
  7112     IF FORML NOT = ZEROS
  7113        INSPECT FORMI CONVERTING LOWER-CASE TO UPPER-CASE.
  7114
  7115     IF MAINTI = 'C' AND FORML = ZEROS
  7116        MOVE -1                  TO FORML
  7117        MOVE ER-0177             TO EMI-ERROR
  7118        MOVE AL-UABON            TO FORMA
  7119        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7120
  7121     IF FOLLOWL NOT = ZEROS
  7122        MOVE FOLLOWI             TO DEEDIT-FIELD
  7123        PERFORM 8600-DEEDIT
  7124        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7125        MOVE '4'                 TO DC-OPTION-CODE
  7126        PERFORM 9700-DATE-LINK  THRU  9700-EXIT
  7127        IF DATE-CONVERSION-ERROR
  7128           MOVE ER-0182          TO EMI-ERROR
  7129           MOVE -1               TO FOLLOWL
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 139
* EL152.cbl
  7130           MOVE AL-UABON         TO FOLLOWA
  7131           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7132        ELSE
  7133*          IF (PI-COMPANY-ID = 'DMD') AND
  7134*             (NOT FORCE-7840)        AND
  7135*             (DC-BIN-DATE-1 > CURRENT-PLUS3-SAVE)
  7136*              MOVE 'PF9=FORCE 7840' TO PFKEY9O
  7137*              MOVE AL-SABON         TO PFKEY9A
  7138*              MOVE ER-7840          TO EMI-ERROR
  7139*              MOVE -1               TO FOLLOWL
  7140*              MOVE AL-UABON         TO FOLLOWA
  7141*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7142*          ELSE
  7143             MOVE SPACES                TO PFKEY9O
  7144             MOVE AL-SADON              TO PFKEY9A
  7145             MOVE DC-GREG-DATE-1-EDIT   TO FOLLOWO
  7146             MOVE AL-UANON              TO FOLLOWA
  7147             MOVE DC-BIN-DATE-1         TO FOLLOW-UP-SAVE
  7148     ELSE
  7149        MOVE LOW-VALUES                 TO FOLLOW-UP-SAVE.
  7150
  7151     IF FOLLOW-UP-SAVE NOT = LOW-VALUES
  7152        IF FOLLOW-UP-SAVE NOT > CURRENT-SAVE
  7153           MOVE ER-0533          TO EMI-ERROR
  7154           MOVE AL-UABON         TO FOLLOWA
  7155           MOVE -1               TO FOLLOWL
  7156           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7157
  7158     IF RESENDL NOT = ZEROS
  7159        MOVE RESENDI             TO DEEDIT-FIELD
  7160        PERFORM 8600-DEEDIT
  7161        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7162        MOVE '4'                 TO DC-OPTION-CODE
  7163        PERFORM 9700-DATE-LINK  THRU  9700-EXIT
  7164        IF DATE-CONVERSION-ERROR
  7165           MOVE ER-0185          TO EMI-ERROR
  7166           MOVE -1               TO RESENDL
  7167           MOVE AL-UABON         TO RESENDA
  7168           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7169         ELSE
  7170*          IF (PI-COMPANY-ID = 'DMD') AND
  7171*             (NOT FORCE-7840)        AND
  7172*             (DC-BIN-DATE-1 > CURRENT-PLUS3-SAVE)
  7173*              MOVE 'PF9=FORCE 7840' TO PFKEY9O
  7174*              MOVE AL-SABON         TO PFKEY9A
  7175*              MOVE ER-7840          TO EMI-ERROR
  7176*              MOVE -1               TO RESENDL
  7177*              MOVE AL-UABON         TO RESENDA
  7178*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7179*          ELSE
  7180             MOVE SPACES                 TO PFKEY9O
  7181             MOVE AL-SADON               TO PFKEY9A
  7182             MOVE DC-GREG-DATE-1-EDIT    TO RESENDO
  7183             MOVE AL-UANON               TO RESENDA
  7184             MOVE DC-BIN-DATE-1          TO RESEND-SAVE
  7185     ELSE
  7186        MOVE LOW-VALUE                   TO RESEND-SAVE.
  7187
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 140
* EL152.cbl
  7188     IF RESEND-SAVE NOT = LOW-VALUES
  7189        IF RESEND-SAVE NOT > CURRENT-SAVE
  7190           MOVE ER-0537          TO EMI-ERROR
  7191           MOVE AL-UABON         TO RESENDA
  7192           MOVE -1               TO RESENDL
  7193           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7194
  7195     IF PRINTL NOT = ZEROS
  7196        INSPECT PRINTI CONVERTING LOWER-CASE TO UPPER-CASE
  7197        IF PRINTI = 'Y' OR = ' '
  7198           MOVE AL-UANON         TO PRINTA
  7199        ELSE
  7200           MOVE ER-0183          TO EMI-ERROR
  7201           MOVE -1               TO PRINTL
  7202           MOVE AL-UABON         TO PRINTA
  7203           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7204
  7205     MOVE 'Y'                    TO CLEANO
  7206     IF ENCL <= ZEROS
  7207        MOVE 'N'                 TO CLEANO
  7208     END-IF
  7209     IF ENCL > ZEROS
  7210        MOVE FUNCTION UPPER-CASE(ENCI) TO ENCI
  7211                                          PI-ENCLOSURE-CD
  7212        IF ENCI  = '1'   OR
  7213                      '1P'  OR
  7214                      '2'   OR
  7215                      '3'   OR
  7216                      '4'   OR
  7217                      '5'   OR
  7218                      '6'   OR
  7219                      '7'   OR
  7220                      '8'   OR
  7221                      '9'   OR
  7222                      'A'   OR
  7223                      'C'   OR
  7224                      'E'   OR
  7225                      'EP'  OR
  7226                      'ENV' OR
  7227                      'I'   OR
  7228                      '0'   OR
  7229                      '4P'  OR
  7230                      '5P'
  7231           MOVE ENCI             TO PI-ENCLOSURE-CD
  7232                                    W-ENCLOSURE-CD
  7233           MOVE AL-UANON         TO ENCA
  7234        ELSE
  7235           MOVE 'N'              TO CLEANO
  7236           MOVE ER-1560          TO EMI-ERROR
  7237           MOVE -1               TO ENCL
  7238           MOVE AL-UABON         TO ENCA
  7239           PERFORM 9900-ERROR-FORMAT
  7240                                 THRU 9900-EXIT
  7241        END-IF
  7242     END-IF
  7243     IF COPIESL NOT = ZEROS
  7244        IF COPIESI NOT NUMERIC OR
  7245           COPIESI = '0'
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 141
* EL152.cbl
  7246           MOVE ER-0184          TO EMI-ERROR
  7247           MOVE -1               TO COPIESL
  7248           MOVE AL-UABON         TO COPIESA
  7249           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7250        ELSE
  7251           MOVE AL-UANON         TO COPIESA.
  7252
  7253     IF PI-PROCESSOR-PRINTER NOT = SPACES
  7254         MOVE PI-PROCESSOR-PRINTER   TO  PI-ALT-PRINTER-ID.
  7255
  7256     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  7257
  7258     IF PRINTERL > ZERO
  7259        INSPECT PRINTERI CONVERTING LOWER-CASE TO UPPER-CASE
  7260        MOVE AL-UANON            TO PRINTERA
  7261        MOVE PRINTERI            TO PI-ALT-PRINTER-ID
  7262                                    PI-ALT-DMD-PRT-ID
  7263     ELSE
  7264        IF (PI-NO-CARRIER-SECURITY AND
  7265            PI-NO-ACCOUNT-SECURITY) OR
  7266            PI-PROCESSOR-PRINTER NOT = SPACES
  7267             NEXT SENTENCE
  7268        ELSE
  7269            MOVE AL-UABON       TO PRINTERA
  7270            MOVE -1             TO PRINTERL
  7271            MOVE ER-2397        TO EMI-ERROR
  7272            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7273
  7274     IF ACTL NOT = +0
  7275         MOVE ZEROS              TO W-ACCOUNT
  7276         IF ACTI > SPACES
  7277             IF ACTI NUMERIC
  7278                     AND
  7279                ACTI NOT < 1
  7280                     AND
  7281                ACTI NOT > 9
  7282                 MOVE AL-UANON   TO ACTA
  7283                 MOVE ACTI       TO W-ACCOUNT
  7284                                    W-LETTER-ADDR-SEQ
  7285                 MOVE 'A'        TO W-LETTER-ADDR-TYPE
  7286             ELSE
  7287                 MOVE -1         TO ACTL
  7288                 MOVE AL-UABON   TO ACTA
  7289                 MOVE ER-3547    TO EMI-ERROR
  7290                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7291
  7292     IF BENL NOT = +0
  7293         MOVE ZEROS              TO W-BENEFICIARY
  7294         IF BENI > SPACES
  7295             IF BENI NUMERIC
  7296                     AND
  7297                BENI NOT < 1
  7298                     AND
  7299                BENI NOT > 9
  7300                 MOVE AL-UANON   TO BENA
  7301                 MOVE BENI       TO W-BENEFICIARY
  7302                                    W-LETTER-ADDR-SEQ
  7303                 MOVE 'B'        TO W-LETTER-ADDR-TYPE
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 142
* EL152.cbl
  7304             ELSE
  7305                 MOVE -1         TO BENL
  7306                 MOVE AL-UABON   TO BENA
  7307                 MOVE ER-3547    TO EMI-ERROR
  7308                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7309
  7310     IF EMPL NOT = +0
  7311         MOVE ZEROS              TO W-EMPLOYER
  7312         IF EMPI > SPACES
  7313             IF EMPI NUMERIC
  7314                     AND
  7315                EMPI NOT < 1
  7316                     AND
  7317                EMPI NOT > 9
  7318                 MOVE AL-UANON   TO EMPA
  7319                 MOVE EMPI       TO W-EMPLOYER
  7320                                    W-LETTER-ADDR-SEQ
  7321                 MOVE 'E'        TO W-LETTER-ADDR-TYPE
  7322             ELSE
  7323                 MOVE -1         TO EMPL
  7324                 MOVE AL-UABON   TO EMPA
  7325                 MOVE ER-3547    TO EMI-ERROR
  7326                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7327
  7328     IF INSL NOT = +0
  7329         MOVE ZEROS              TO W-INSURED
  7330         IF INSI > SPACES
  7331             IF INSI NUMERIC
  7332                     AND
  7333                INSI NOT < 1
  7334                     AND
  7335                INSI NOT > 9
  7336                 MOVE AL-UANON   TO INSA
  7337                 MOVE INSI       TO W-INSURED
  7338                                    W-LETTER-ADDR-SEQ
  7339                 MOVE 'I'        TO W-LETTER-ADDR-TYPE
  7340             ELSE
  7341                 MOVE -1         TO INSL
  7342                 MOVE AL-UABON   TO INSA
  7343                 MOVE ER-3547    TO EMI-ERROR
  7344                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7345
  7346     IF PHYSL NOT = +0
  7347         MOVE ZEROS              TO W-PHYSICIAN
  7348         IF PHYSI > SPACES
  7349             IF PHYSI NUMERIC
  7350                     AND
  7351                PHYSI NOT < 1
  7352                     AND
  7353                PHYSI NOT > 9
  7354                 MOVE AL-UANON   TO PHYSA
  7355                 MOVE PHYSI      TO W-PHYSICIAN
  7356                                    W-LETTER-ADDR-SEQ
  7357                 MOVE 'P'        TO W-LETTER-ADDR-TYPE
  7358             ELSE
  7359                 MOVE -1         TO PHYSL
  7360                 MOVE AL-UABON   TO PHYSA
  7361                 MOVE ER-3547    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 143
* EL152.cbl
  7362                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7363
  7364     IF OTHR1L NOT = +0
  7365         MOVE ZEROS              TO W-OTHER-1
  7366         IF OTHR1I > SPACES
  7367             IF OTHR1I NUMERIC
  7368                     AND
  7369                OTHR1I NOT < 1
  7370                     AND
  7371                OTHR1I NOT > 9
  7372                 MOVE AL-UANON   TO OTHR1A
  7373                 MOVE OTHR1I     TO W-OTHER-1
  7374                                    W-LETTER-ADDR-SEQ
  7375                 MOVE 'O'        TO W-LETTER-ADDR-TYPE
  7376             ELSE
  7377                 MOVE -1         TO OTHR1L
  7378                 MOVE AL-UABON   TO OTHR1A
  7379                 MOVE ER-3547    TO EMI-ERROR
  7380                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7381
  7382     IF OTHR2L NOT = +0
  7383         MOVE ZEROS              TO W-OTHER-2
  7384         IF OTHR2I > SPACES
  7385             IF OTHR2I NUMERIC
  7386                     AND
  7387                OTHR2I NOT < 1
  7388                     AND
  7389                OTHR2I NOT > 9
  7390                 MOVE AL-UANON   TO OTHR2A
  7391                 MOVE OTHR2I     TO W-OTHER-2
  7392                                    W-LETTER-ADDR-SEQ
  7393                 MOVE 'Q'        TO W-LETTER-ADDR-TYPE
  7394             ELSE
  7395                 MOVE -1         TO OTHR2L
  7396                 MOVE AL-UABON   TO OTHR2A
  7397                 MOVE ER-3547    TO EMI-ERROR
  7398                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7399
  7400     IF NOT EMI-NO-ERRORS
  7401        GO TO 8200-SEND-DATAONLY.
  7402
  7403 0350-EXIT.
  7404      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 144
* EL152.cbl
  7406 400-SET-CODES.
  7407     MOVE PI-COMPANY-ID          TO CNTL-CO.
  7408     MOVE PI-COMPANY-CD          TO CLAM-CO
  7409                                    TEXT-CO
  7410                                    ACTV-CO
  7411                                    CERT-CO
  7412                                    ACCT-CO
  7413                                    ARCH-CO
  7414                                    PROD-CO
  7415                                    PLCY-CO
  7416                                    PLAN-CO.
  7417
  7418     MOVE PI-CARRIER             TO CLAM-CARRIER
  7419                                    ACTV-CARRIER
  7420                                    CERT-CARRIER
  7421                                    ACCT-CARRIER
  7422                                    PROD-CARRIER
  7423                                    PLCY-CARRIER
  7424                                    PLAN-CARRIER.
  7425
  7426     MOVE PI-CERT-NO             TO CLAM-CERT-NUM
  7427                                    ACTV-CERT-NUM
  7428                                    CERT-CERT-NUM.
  7429 499-EXIT.
  7430      EXIT.
  7431
  7432 500-RECOVER-PI-TEMP-STORAGE.
  7433
  7434
  7435* EXEC CICS HANDLE CONDITION
  7436*        QIDERR   (590-QIDERR)
  7437*    END-EXEC.
  7438*    MOVE '"$N                   ! % #00007352' TO DFHEIV0
  7439     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  7440     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7441     MOVE X'2520233030303037333532' TO DFHEIV0(25:11)
  7442     CALL 'kxdfhei1' USING DFHEIV0
  7443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7444
  7445
  7446
  7447* EXEC CICS READQ TS
  7448*        QUEUE    (WS-PI-QID)
  7449*        INTO     (PROGRAM-INTERFACE-BLOCK)
  7450*        LENGTH   (PI-COMM-LENGTH)
  7451*    END-EXEC.
  7452*    MOVE '*$I    L              ''   #00007356' TO DFHEIV0
  7453     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7454     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7455     MOVE X'2020233030303037333536' TO DFHEIV0(25:11)
  7456     CALL 'kxdfhei1' USING DFHEIV0,
  7457           WS-PI-QID,
  7458           PROGRAM-INTERFACE-BLOCK,
  7459           PI-COMM-LENGTH,
  7460           DFHEIV99,
  7461           DFHEIV99,
  7462           DFHEIV99
  7463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 145
* EL152.cbl
  7464
  7465
  7466     PERFORM 7770-DELETE-TEMP-STOR-PI-AREA THRU 7770-EXIT.
  7467
  7468     GO TO 599-EXIT.
  7469
  7470 590-QIDERR.
  7471
  7472     IF EIBTRNID = TRANS-ID
  7473         MOVE ER-0033                   TO  EMI-ERROR
  7474         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7475         GO TO 8200-SEND-DATAONLY.
  7476
  7477 599-EXIT.
  7478     EXIT.
  7479
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 146
* EL152.cbl
  7481 1000-SHOW.
  7482***************************************************************
  7483*     THIS ROUTINE WILL BROWSE THE ARCHIVE FILE WITH THE      *
  7484*     ARCHIVE NUMBER SPECIFIED FROM THE SCREEN. THE TEXT      *
  7485*     WILL BE INSERTED INTO THE TS-TABLE AND DISPLAYED TO     *
  7486*     OPERATOR.                                               *
  7487***************************************************************
  7488
  7489     MOVE SPACES                 TO RECORD-TABLE.
  7490     IF ARCHNUML = ZEROS
  7491        MOVE -1                  TO ARCHNUML
  7492        MOVE AL-UNBON            TO ARCHNUMA
  7493        MOVE ER-0174             TO EMI-ERROR
  7494        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7495        GO TO 8200-SEND-DATAONLY.
  7496
  7497     IF ARCHNUMI NOT NUMERIC
  7498        MOVE -1                  TO ARCHNUML
  7499        MOVE AL-UNBON            TO ARCHNUMA
  7500        MOVE ER-0175             TO EMI-ERROR
  7501        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7502        GO TO 8200-SEND-DATAONLY.
  7503
  7504     IF PI-SHOW-MODE
  7505*       IF PI-ARCHIVE-NUMBER = ARCHNUMI
  7506*          MOVE -1               TO MAINTL
  7507*          GO TO 8200-SEND-DATAONLY
  7508*       ELSE
  7509           PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
  7510
  7511     MOVE ARCHNUMI               TO ARCH-NUMBER
  7512                                    PI-ARCHIVE-NUMBER.
  7513     MOVE ' '                    TO ARCH-REC-TYPE.
  7514     MOVE '1'                    TO PI-ACTION.
  7515     MOVE ZEROS                  TO PI-ADDR-SEQ.
  7516     MOVE LOW-VALUES             TO PI-ADDR-TYPE.
  7517     MOVE SPACES                 TO PI-PRINT-SW
  7518                                    PI-FORM-NUMBER.
  7519     SET TB-INDX TO 1.
  7520
  7521     MOVE SPACE                  TO WS-LETTER-STATUS.
  7522
  7523
  7524* EXEC CICS HANDLE CONDITION
  7525*         NOTOPEN    (8850-ARCH-NOT-OPEN)
  7526*         NOTFND     (1020-ENDBR)
  7527*         ENDFILE    (1020-ENDBR)
  7528*    END-EXEC.
  7529*    MOVE '"$JI''                 ! & #00007419' TO DFHEIV0
  7530     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  7531     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7532     MOVE X'2620233030303037343139' TO DFHEIV0(25:11)
  7533     CALL 'kxdfhei1' USING DFHEIV0
  7534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7535
  7536
  7537     MOVE ARCH-PARTIAL-KEY       TO ARCH-SAVE-KEY.
  7538
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 147
* EL152.cbl
  7539
  7540* EXEC CICS STARTBR
  7541*         DATASET    (ARCH-ID)
  7542*         RIDFLD     (ARCH-KEY)
  7543*         GTEQ
  7544*    END-EXEC
  7545     MOVE 0
  7546       TO DFHEIV11
  7547*    MOVE '&,         G          &   #00007427' TO DFHEIV0
  7548     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7549     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7550     MOVE X'2020233030303037343237' TO DFHEIV0(25:11)
  7551     CALL 'kxdfhei1' USING DFHEIV0,
  7552           ARCH-ID,
  7553           ARCH-KEY,
  7554           DFHEIV99,
  7555           DFHEIV11,
  7556           DFHEIV99
  7557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7558
  7559     MOVE 'Y'                    TO ARCH-BROWSE-STARTED.
  7560
  7561 1010-READ-NEXT.
  7562
  7563* EXEC CICS READNEXT
  7564*         SET       (ADDRESS OF LETTER-ARCHIVE)
  7565*         DATASET   (ARCH-ID)
  7566*         RIDFLD    (ARCH-KEY)
  7567*    END-EXEC.
  7568     MOVE 0
  7569       TO DFHEIV11
  7570*    MOVE '&.S                   )   #00007436' TO DFHEIV0
  7571     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7572     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7573     MOVE X'2020233030303037343336' TO DFHEIV0(25:11)
  7574     CALL 'kxdfhei1' USING DFHEIV0,
  7575           ARCH-ID,
  7576           DFHEIV20,
  7577           DFHEIV99,
  7578           ARCH-KEY,
  7579           DFHEIV99,
  7580           DFHEIV11,
  7581           DFHEIV99,
  7582           DFHEIV99
  7583     SET ADDRESS OF LETTER-ARCHIVE TO
  7584         DFHEIV20
  7585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7586
  7587
  7588     IF LA-FORM-CONTROL-HDR
  7589        GO TO 1020-ENDBR.
  7590
  7591
  7592     IF NOT LA-HEADER-DATA
  7593         NEXT SENTENCE
  7594     ELSE
  7595         IF NOT LA-CSO-LETTER-PURGED
  7596             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 148
* EL152.cbl
  7597         ELSE
  7598             MOVE 'P'            TO WS-LETTER-STATUS
  7599             GO TO 1020-ENDBR.
  7600
  7601     IF ARCH-PARTIAL-KEY = ARCH-SAVE-KEY
  7602        IF LA-HEADER-DATA
  7603           PERFORM 1040-FORMAT-RESEND
  7604           MOVE LA-NO-OF-COPIES    TO COPIESO
  7605           PERFORM 1050-GET-CORRESPOND THRU 1059-EXIT
  7606           GO TO 1010-READ-NEXT
  7607        ELSE
  7608           IF LA-ADDRESS-DATA
  7609              MOVE LA-ADDRESS-LINE   TO REC-TEXT (TB-INDX)
  7610              MOVE ZEROS             TO REC-PC (TB-INDX)
  7611              SET TB-INDX UP BY 1
  7612              GO TO 1010-READ-NEXT
  7613           ELSE
  7614              PERFORM 1030-TEXT-BUILD
  7615              GO TO 1010-READ-NEXT.
  7616
  7617 1020-ENDBR.
  7618     IF ARCH-BROWSE-STARTED = 'Y'
  7619        MOVE 'N'                TO ARCH-BROWSE-STARTED
  7620
  7621* EXEC CICS ENDBR
  7622*            DATASET   (ARCH-ID)
  7623*       END-EXEC
  7624     MOVE 0
  7625       TO DFHEIV11
  7626*    MOVE '&2                    $   #00007474' TO DFHEIV0
  7627     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7628     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7629     MOVE X'2020233030303037343734' TO DFHEIV0(25:11)
  7630     CALL 'kxdfhei1' USING DFHEIV0,
  7631           ARCH-ID,
  7632           DFHEIV11,
  7633           DFHEIV99
  7634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7635     END-IF.
  7636
  7637*    IF PI-COMPANY-ID = 'CID'
  7638         IF TB-INDX = 1
  7639             IF WS-LETTER-STATUS EQUAL 'P'
  7640                 MOVE 9021           TO EMI-ERROR
  7641                 MOVE -1             TO ARCHNUML
  7642                 MOVE AL-UNBON       TO ARCHNUMA
  7643                 PERFORM 9900-ERROR-FORMAT THRU
  7644                         9900-EXIT
  7645                 GO TO 8200-SEND-DATAONLY
  7646             ELSE
  7647                 MOVE ER-0006             TO EMI-ERROR
  7648                 MOVE -1                  TO ARCHNUML
  7649                 MOVE AL-UNBON            TO ARCHNUMA
  7650                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7651                 GO TO 8200-SEND-DATAONLY
  7652             END-IF
  7653         END-IF
  7654*    ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 149
* EL152.cbl
  7655*        IF TB-INDX = 1
  7656*            MOVE ER-0006             TO EMI-ERROR
  7657*            MOVE -1                  TO ARCHNUML
  7658*            MOVE AL-UNBON            TO ARCHNUMA
  7659*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7660*            GO TO 8200-SEND-DATAONLY
  7661*        END-IF
  7662*    END-IF
  7663
  7664
  7665     SET TB-INDX DOWN BY 1.
  7666     SET PI-TOTAL-LINES          TO TB-INDX.
  7667     MOVE 1                      TO PI-CURRENT-LINE.
  7668     SET TB-INDX TO 1.
  7669
  7670     PERFORM 7170-FORMAT-SCREEN THRU 7170-EXIT
  7671             VARYING SC-INDX FROM 1 BY 1
  7672               UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  7673
  7674     MOVE SPACES                 TO PI-ADDR-TYPE
  7675                                    MAINTI.
  7676     MOVE -1                     TO MAINTL.
  7677
  7678     GO TO 8100-SEND-INITIAL-MAP.
  7679
  7680 1030-TEXT-BUILD.
  7681***** IF THERE ARE NO ADDRESS LINES OR LESS THAN 6 LINES, SET TO
  7682***** TOP OF FORM.
  7683     IF TB-INDX < 7
  7684        SET TB-INDX   TO 7.
  7685
  7686     IF TB-INDX = 7
  7687        MOVE TOP-FORM            TO REC-TEXT (TB-INDX)
  7688        SET TB-INDX UP BY 1.
  7689
  7690     MOVE LA-TEXT-LINE           TO REC-TEXT (TB-INDX).
  7691     MOVE LA-SKIP-CONTROL        TO REC-PC (TB-INDX)
  7692                                    INDX-WORK.
  7693
  7694     IF INDX-WORK NOT = 99
  7695        SET TB-INDX UP BY 1
  7696        SET TB-INDX UP BY INDX-WORK
  7697     ELSE
  7698        SET TB-INDX UP BY 1
  7699        MOVE TOP-FORM            TO REC-TEXT (TB-INDX)
  7700        SET TB-INDX UP BY 1.
  7701
  7702 1040-FORMAT-RESEND.
  7703     IF LA-RESEND-DATE = LOW-VALUES
  7704        MOVE SPACES                 TO RESENDI
  7705       ELSE
  7706        MOVE LA-RESEND-DATE         TO DC-BIN-DATE-1
  7707        MOVE ' '                    TO DC-OPTION-CODE
  7708        PERFORM 9700-DATE-LINK  THRU 9700-EXIT
  7709        MOVE DC-GREG-DATE-1-EDIT    TO RESENDO.
  7710
  7711 1050-GET-CORRESPOND.
  7712     MOVE LA-CARRIER             TO ACTV-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 150
* EL152.cbl
  7713     MOVE LA-CLAIM-NO            TO ACTV-CLAIM.
  7714     MOVE LA-CERT-NO             TO ACTV-CERT-NUM.
  7715     MOVE LA-CORR-TRLR-SEQ       TO ACTV-SEQ.
  7716
  7717
  7718* EXEC CICS READ
  7719*         DATASET     (ACTV-ID)
  7720*         RIDFLD      (ACTV-KEY)
  7721*         SET         (ADDRESS OF ACTIVITY-TRAILERS)
  7722*    END-EXEC.
  7723*    MOVE '&"S        E          (   #00007559' TO DFHEIV0
  7724     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7725     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7726     MOVE X'2020233030303037353539' TO DFHEIV0(25:11)
  7727     CALL 'kxdfhei1' USING DFHEIV0,
  7728           ACTV-ID,
  7729           DFHEIV20,
  7730           DFHEIV99,
  7731           ACTV-KEY,
  7732           DFHEIV99,
  7733           DFHEIV99,
  7734           DFHEIV99
  7735     SET ADDRESS OF ACTIVITY-TRAILERS TO
  7736         DFHEIV20
  7737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7738
  7739
  7740     IF AT-RECEIPT-FOLLOW-UP = LOW-VALUES
  7741        MOVE SPACES                TO FOLLOWI
  7742     ELSE
  7743        MOVE SPACES                TO DC-OPTION-CODE
  7744        MOVE AT-RECEIPT-FOLLOW-UP  TO DC-BIN-DATE-1
  7745        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7746        MOVE DC-GREG-DATE-1-EDIT   TO FOLLOWI.
  7747
  7748     MOVE SPACES                 TO ADDRI
  7749     MOVE AT-STD-LETTER-FORM     TO FORMI
  7750     MOVE AT-REASON-TEXT         TO REI.
  7751
  7752 1059-EXIT.
  7753      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 151
* EL152.cbl
  7755 2000-CREATE.
  7756***************************************************************
  7757*    THIS ROUTINE WILL CREATE A NEW LETTER BY READING THE     *
  7758*    TEXT FILE WITH THE FORM CODE SPECIFIED FROM THE SCREEN.  *
  7759*    ALL VARIABLE SYMBOLS WILL BE RESOLVED AND THE LETTER     *
  7760*    WILL BE DISPLAYED ONTO THE SCREEN.                       *
  7761*                                                             *
  7762***************************************************************
  7763
  7764***************************************************************
  7765*    CHECK TO SEE IF SAME REQUEST OR NOT.                     *
  7766*    IF NEW REQUEST AND A LETTER WAS PRINTED, FORCE AN ERROR  *
  7767***************************************************************
  7768
  7769     IF PI-CREATE-MODE
  7770        IF PI-FORM-NUMBER = FORMI AND PI-ADDR-TYPE = ADDRI AND
  7771           PI-LETTER-ADDRESS-TYPE = W-LETTER-ADDRESS-TYPE
  7772           PERFORM 7500-READ-TS  THRU 7599-EXIT
  7773           PERFORM 7950-SET-INDX THRU 7950-EXIT
  7774           PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  7775             VARYING SC-INDX FROM 1 BY 1
  7776             UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  7777           MOVE -1               TO MAINTL
  7778*          MOVE 'Y'              TO CLEANO
  7779           GO TO 8200-SEND-DATAONLY
  7780        ELSE
  7781           IF PRINT-PERFORMED AND
  7782              PI-RETURN-TO-PROGRAM  =  PGM-EL150 AND
  7783              FORMI NOT = 9999
  7784              MOVE ER-0279           TO EMI-ERROR
  7785              MOVE -1                TO MAINTL
  7786              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7787              GO TO 8200-SEND-DATAONLY.
  7788
  7789***************************************************************
  7790*   IF THE FORM NUMBER IS THE SAME BUT THE ADDRESS TYPE       *
  7791*   HAS CHANGED, THEN SAVE THE CURRENT SCREEN AND REBUILD     *
  7792*   THE ADDRESS DATA.                                         *
  7793***************************************************************
  7794
  7795     IF PI-FORM-NUMBER = FORMI AND
  7796        PI-ADDR-TYPE  =  ADDRI AND
  7797        PI-LETTER-ADDRESS-TYPE = W-LETTER-ADDRESS-TYPE
  7798           MOVE -1                  TO MAINTL
  7799           GO TO 8200-SEND-DATAONLY.
  7800
  7801     IF PI-LETTER-ADDRESS-TYPE NOT = W-LETTER-ADDRESS-TYPE
  7802         MOVE 0                  TO GETMAIN-SWITCH
  7803         MOVE 'N'                TO WS-ACCT-READ-SW
  7804                                    WS-PROD-READ-SW
  7805                                    WS-COMP-READ-SW.
  7806
  7807     MOVE SPACES                 TO RECORD-TABLE.
  7808
  7809     PERFORM 7000-READ-ADDR THRU 7099-EXIT.
  7810
  7811     SET TB-INDX TO 1
  7812     MOVE TOP-FORM               TO REC-TEXT (TB-INDX).
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 152
* EL152.cbl
  7813     SET TB-INDX UP BY 1.
  7814
  7815***************************************************************
  7816*    IF A NEW LETTER IS BEING CREATED FROM SCRATCH, SAVE      *
  7817*    THE EXISTING SCREEN AND PASS CONTROL TO THE TEXT EDITOR  *
  7818***************************************************************
  7819
  7820     IF FORMI = '9999'
  7821        MOVE 16                  TO PI-TOTAL-LINES
  7822        MOVE 1                   TO PI-CURRENT-LINE
  7823        PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
  7824        PERFORM 7790-WRITE-SCREEN-TS THRU 7790-EXIT
  7825        MOVE '3'                 TO PI-ACTION
  7826        MOVE FORMI               TO PI-FORM-NUMBER
  7827                                    PI-COMM-CONTROL
  7828        MOVE ZEROS               TO PI-UPDATE-SW
  7829        MOVE PGM-EL1042          TO PGM-NAME
  7830        GO TO 9300-XCTL.
  7831
  7832     MOVE FORMI                  TO TEXT-LETTER.
  7833     MOVE TEXT-PARTIAL-KEY       TO TEXT-SAVE-KEY.
  7834
  7835
  7836* EXEC CICS HANDLE CONDITION
  7837*         NOTFND     (2120-ENDBR)
  7838*         ENDFILE    (2120-ENDBR)
  7839*         NOTOPEN    (8890-TEXT-NOT-OPEN)
  7840*    END-EXEC
  7841*    MOVE '"$I''J                 ! '' #00007660' TO DFHEIV0
  7842     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  7843     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7844     MOVE X'2720233030303037363630' TO DFHEIV0(25:11)
  7845     CALL 'kxdfhei1' USING DFHEIV0
  7846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7847
  7848
  7849* EXEC CICS STARTBR
  7850*         DATASET    (TEXT-ID)
  7851*         RIDFLD     (TEXT-KEY)
  7852*         GTEQ
  7853*    END-EXEC.
  7854     MOVE 0
  7855       TO DFHEIV11
  7856*    MOVE '&,         G          &   #00007666' TO DFHEIV0
  7857     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7858     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7859     MOVE X'2020233030303037363636' TO DFHEIV0(25:11)
  7860     CALL 'kxdfhei1' USING DFHEIV0,
  7861           TEXT-ID,
  7862           TEXT-KEY,
  7863           DFHEIV99,
  7864           DFHEIV11,
  7865           DFHEIV99
  7866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7867
  7868
  7869     MOVE 'Y'                    TO TEXT-BROWSE-STARTED.
  7870
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 153
* EL152.cbl
  7871 2110-READ-NEXT.
  7872     IF TB-INDX > MAX-LINES
  7873        MOVE ER-0051             TO EMI-ERROR
  7874        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7875        GO TO 2120-ENDBR.
  7876
  7877
  7878* EXEC CICS READNEXT
  7879*         DATASET    (TEXT-ID)
  7880*         SET        (ADDRESS OF TEXT-FILES)
  7881*         RIDFLD     (TEXT-KEY)
  7882*    END-EXEC.
  7883     MOVE 0
  7884       TO DFHEIV11
  7885*    MOVE '&.S                   )   #00007680' TO DFHEIV0
  7886     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7887     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7888     MOVE X'2020233030303037363830' TO DFHEIV0(25:11)
  7889     CALL 'kxdfhei1' USING DFHEIV0,
  7890           TEXT-ID,
  7891           DFHEIV20,
  7892           DFHEIV99,
  7893           TEXT-KEY,
  7894           DFHEIV99,
  7895           DFHEIV11,
  7896           DFHEIV99,
  7897           DFHEIV99
  7898     SET ADDRESS OF TEXT-FILES TO
  7899         DFHEIV20
  7900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7901
  7902
  7903     IF TEXT-PARTIAL-KEY NOT = TEXT-SAVE-KEY
  7904        IF TB-INDX = +2
  7905           MOVE SPACES           TO PI-FORM-NUMBER
  7906           MOVE -1               TO FORML
  7907           MOVE AL-UABON         TO FORMA
  7908           MOVE ER-1236          TO EMI-ERROR
  7909           MOVE 'N'              TO CLEANO
  7910           PERFORM 9900-ERROR-FORMAT
  7911                                 THRU 9900-EXIT
  7912        END-IF
  7913        GO TO 2120-ENDBR
  7914     END-IF
  7915
  7916     MOVE FORMI                  TO PI-FORM-NUMBER.
  7917     IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  7918         PERFORM 2800-PROCESS-Z-CONTROLS THRU 2800-EXIT
  7919         GO TO 2110-READ-NEXT.
  7920
  7921      MOVE TX-BSR-CODE           TO PI-ELLETR-BSR.
  7922
  7923      IF (PI-COMPANY-ID = 'CID')
  7924         AND (PI-CARRIER NOT = '8')
  7925         PERFORM VARYING B1 FROM +1 BY +1 UNTIL
  7926            B1 > +20
  7927            IF TX-TEXT-LINE (B1:5) = '@03.1'
  7928               GO TO 2110-READ-NEXT
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 154
* EL152.cbl
  7929            END-IF
  7930         END-PERFORM
  7931      END-IF
  7932      MOVE TX-TEXT-LINE          TO REC-TEXT (TB-INDX).
  7933      MOVE TX-PROCESS-CONTROL    TO REC-PC (TB-INDX)
  7934                                    INDX-WORK.
  7935      SET TB-INDX UP BY 1.
  7936      IF INDX-WORK = 99
  7937         MOVE TOP-FORM           TO REC-TEXT (TB-INDX)
  7938         SET TB-INDX UP BY 1
  7939         GO TO 2110-READ-NEXT
  7940      ELSE
  7941         SET TB-INDX UP BY INDX-WORK
  7942         GO TO 2110-READ-NEXT.
  7943
  7944 2120-ENDBR.
  7945     IF TEXT-BROWSE-STARTED = 'Y'
  7946        MOVE 'N'                 TO TEXT-BROWSE-STARTED
  7947
  7948* EXEC CICS ENDBR
  7949*            DATASET     (TEXT-ID)
  7950*       END-EXEC.
  7951     MOVE 0
  7952       TO DFHEIV11
  7953*    MOVE '&2                    $   #00007730' TO DFHEIV0
  7954     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7955     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7956     MOVE X'2020233030303037373330' TO DFHEIV0(25:11)
  7957     CALL 'kxdfhei1' USING DFHEIV0,
  7958           TEXT-ID,
  7959           DFHEIV11,
  7960           DFHEIV99
  7961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7962
  7963
  7964*02160      IF TB-INDX = 8
  7965*02161         MOVE ER-0006             TO EMI-ERROR
  7966*02162         MOVE -1                  TO FORML
  7967*02163         MOVE AL-UABON            TO FORMA
  7968*02164         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7969*02165         GO TO 8200-SEND-DATAONLY-ERASEAUP.
  7970
  7971     SET TB-INDX DOWN BY 1.
  7972     SET PI-TOTAL-LINES          TO TB-INDX.
  7973     MOVE 1                      TO PI-CURRENT-LINE.
  7974
  7975***************************************************************
  7976*    IF IT IS A DESIGNATED CLAIM, THEN RESOLVE ALL            *
  7977*    VARIABLE SYMBOLS AND INSERT THEM INTO THE TEXT DATA.     *
  7978***************************************************************
  7979
  7980     IF PI-RETURN-TO-PROGRAM = PGM-EL150
  7981        PERFORM 7200-RESOLVE-VARIABLES THRU 7269-EXIT
  7982        MOVE SPACES              TO W-REVERSE-DATE-SW
  7983        PERFORM 7300-VARIABLE-SEARCH   THRU 7399-EXIT
  7984                VARYING TB-INDX FROM 7 BY 1 UNTIL
  7985                TB-INDX > PI-TOTAL-LINES
  7986     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 155
* EL152.cbl
  7987        MOVE ER-0373             TO EMI-ERROR
  7988        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7989
  7990     SET TB-INDX TO 1.
  7991     PERFORM 7170-FORMAT-SCREEN THRU 7170-EXIT
  7992             VARYING SC-INDX FROM 1 BY 1 UNTIL
  7993             SC-INDX > NUM-LINES-PER-SCREEN.
  7994
  7995     MOVE '3'                    TO PI-ACTION.
  7996*    MOVE FORMI                  TO PI-FORM-NUMBER.
  7997     MOVE W-LETTER-ADDRESS-TYPE  TO PI-LETTER-ADDRESS-TYPE.
  7998     MOVE -1                     TO MAINTL.
  7999     GO TO 8200-SEND-DATAONLY-ERASEAUP.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 156
* EL152.cbl
  8001 2800-PROCESS-Z-CONTROLS.
  8002
  8003     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA.
  8004
  8005     IF RESEND-SAVE = LOW-VALUES
  8006         IF W-DAYS-TO-RESEND-1 NUMERIC
  8007             IF W-DAYS-TO-RESEND-1 > ZEROS
  8008                 MOVE '6'                    TO DC-OPTION-CODE
  8009                 MOVE SAVE-BIN-DATE          TO DC-BIN-DATE-1
  8010                 MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  8011                 MOVE W-DAYS-TO-RESEND-1     TO DC-ELAPSED-DAYS
  8012                 PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8013                 IF NO-CONVERSION-ERROR
  8014                     MOVE DC-BIN-DATE-2       TO RESEND-SAVE
  8015                     MOVE DC-GREG-DATE-1-EDIT TO RESENDO
  8016                     MOVE AL-UANON            TO RESENDA
  8017                     MOVE +8                  TO RESENDL
  8018                 ELSE
  8019                     MOVE ER-3770             TO EMI-ERROR
  8020                     MOVE -1                  TO MAINTL
  8021                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8022                     GO TO 8200-SEND-DATAONLY.
  8023
  8024     IF FOLLOW-UP-SAVE = LOW-VALUES
  8025         IF W-DAYS-TO-FOLLOW-UP NUMERIC
  8026             IF W-DAYS-TO-FOLLOW-UP > ZEROS
  8027                 MOVE '6'                 TO DC-OPTION-CODE
  8028                 MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  8029                 MOVE ZEROS               TO DC-ELAPSED-MONTHS
  8030                 MOVE W-DAYS-TO-FOLLOW-UP TO DC-ELAPSED-DAYS
  8031                 PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8032                 IF NO-CONVERSION-ERROR
  8033                     MOVE DC-BIN-DATE-2       TO FOLLOW-UP-SAVE
  8034                     MOVE DC-GREG-DATE-1-EDIT TO FOLLOWO
  8035                     MOVE AL-UANON            TO FOLLOWA
  8036                     MOVE +8                  TO FOLLOWL
  8037                 ELSE
  8038                     MOVE ER-3771             TO EMI-ERROR
  8039                     MOVE -1                  TO MAINTL
  8040                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8041                     GO TO 8200-SEND-DATAONLY.
  8042
  8043     IF COPIESI NOT NUMERIC
  8044         IF W-NUMBER-OF-COPIES NUMERIC
  8045             IF W-NUMBER-OF-COPIES > ZEROS
  8046                 MOVE W-NUMBER-OF-COPIES  TO COPIESI
  8047                 MOVE AL-UNNON            TO COPIESA
  8048                 MOVE +1                  TO COPIESL
  8049             ELSE
  8050                 MOVE +1                  TO COPIESI
  8051                 MOVE AL-UNNON            TO COPIESA
  8052                 MOVE +1                  TO COPIESL.
  8053
  8054     IF W-FORM-TO-RESEND > SPACES
  8055         MOVE W-FORM-TO-RESEND          TO PI-RESEND-FORM-NUMBER
  8056     ELSE
  8057         MOVE LOW-VALUES                TO PI-RESEND-FORM-NUMBER
  8058     END-IF.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 157
* EL152.cbl
  8059
  8060     IF W-PROMPT-LETTER = 'Y'
  8061         MOVE W-PROMPT-LETTER           TO PI-PROMPT-LETTER
  8062         MOVE ER-0894                   TO EMI-ERROR
  8063         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8064     ELSE
  8065         MOVE 'N'                       TO PI-PROMPT-LETTER
  8066     END-IF.
  8067
  8068     MOVE W-ENCLOSURE-CD                TO PI-ENCLOSURE-CD
  8069                                           ENCO
  8070     MOVE AL-UANON                      TO ENCA
  8071     MOVE +3                            TO ENCL
  8072     MOVE 'N'                           TO CLEANO
  8073     MOVE W-AUTO-CLOSE-IND              TO PI-AUTO-CLOSE-IND.
  8074     MOVE W-LETTER-TO-BENE              TO PI-LETTER-TO-BENE.
  8075
  8076 2800-EXIT.
  8077     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 158
* EL152.cbl
  8079 3000-RECORD.
  8080***************************************************************
  8081*    THIS ROUTINE WILL SAVE THE LETTER TEXT (IF ANY) AND      *
  8082*    BUILD A CORRESPONDENCE TRAILER WITH THE DATA FROM        *
  8083*    THE SCREEN.                                              *
  8084***************************************************************
  8085
  8086     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  8087        MOVE ER-0211             TO EMI-ERROR
  8088        MOVE -1                  TO MAINTL
  8089        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8090        GO TO 8200-SEND-DATAONLY.
  8091
  8092
  8093* EXEC CICS HANDLE CONDITION
  8094*         NOTOPEN    (8860-CLAM-NOT-OPEN)
  8095*         NOTFND     (3010-NOT-FOUND)
  8096*    END-EXEC.
  8097*    MOVE '"$JI                  ! ( #00007862' TO DFHEIV0
  8098     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8099     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8100     MOVE X'2820233030303037383632' TO DFHEIV0(25:11)
  8101     CALL 'kxdfhei1' USING DFHEIV0
  8102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8103
  8104
  8105     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  8106     PERFORM 7950-SET-INDX     THRU 7950-EXIT.
  8107
  8108     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8109             VARYING SC-INDX FROM 1 BY 1
  8110             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8111
  8112     PERFORM 7000-READ-ADDR THRU 7099-EXIT.
  8113
  8114     IF NOT EMI-NO-ERRORS
  8115        GO TO 8200-SEND-DATAONLY.
  8116
  8117     MOVE ZEROS               TO ARCH-NUMBER.
  8118     PERFORM 6500-BUILD-CORRESPOND THRU 6599-EXIT.
  8119     MOVE ER-0000             TO EMI-ERROR.
  8120     MOVE -1                  TO MAINTL.
  8121     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8122     GO TO 8200-SEND-DATAONLY.
  8123
  8124 3010-NOT-FOUND.
  8125     MOVE ER-0133             TO EMI-ERROR.
  8126     MOVE -1                  TO MAINTL.
  8127     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8128     GO TO 8200-SEND-DATAONLY.
  8129
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 159
* EL152.cbl
  8131*4000-SET-BSR. Remove as dead code
  8132*4001-READ-NEXT. Remove as dead code
  8133*4002-ENDBR. Remove as dead code
  8134*4000-EXIT. Remove as dead code
  8135
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 160
* EL152.cbl
  8137 5000-MOVE-NAME.
  8138*    COPY ELCMNS.
  8139*****************************************************************
  8140*                                                               *
  8141*                                                               *
  8142*                            ELCMNS.                            *
  8143*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8144*                            VMOD=2.002                         *
  8145*                                                               *
  8146*                     M O V E   N A M E   R O U T I N E         *
  8147*                                                               *
  8148*                THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8149*            NAME FROM THE CLAIM MASTER TO A WORK AREA WITH     *
  8150*            NO EMBEDDED BLANKS.                                *
  8151*                                                               *
  8152*                  FIELD               VALUE                    *
  8153*                                                               *
  8154*                LAST NAME (CL15)      SMITH                    *
  8155*                1ST NAME  (CL12)      JOHN                     *
  8156*                MID NAME  (CL12)      ALLEN                    *
  8157*                                                               *
  8158*                AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8159*                                                               *
  8160*                        SMITH, JOHN ALLEN                      *
  8161*                                                               *
  8162*                TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8163*            STORAGE COPYBOOK:                                  *
  8164*                                                               *
  8165*                01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8166*                                                               *
  8167*****************************************************************.
  8168
  8169     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
  8170     MOVE ZERO                   TO  WS-NAME-SW.
  8171     SET NWA-INDEX TO +1.
  8172
  8173     IF CL-INSURED-1ST-NAME = SPACES  AND
  8174        CL-INSURED-MID-INIT = SPACES
  8175         MOVE +1                 TO  WS-NAME-SW.
  8176
  8177     MOVE CL-INSURED-LAST-NAME  TO  WS-NAME-WORK2.
  8178     PERFORM 5100-MOVE-NAME THRU 5190-EXIT.
  8179
  8180     MOVE CL-INSURED-1ST-NAME   TO  WS-NAME-WORK2.
  8181     PERFORM 5100-MOVE-NAME THRU 5190-EXIT.
  8182
  8183     SET NWA-INDEX UP BY +1.
  8184     MOVE CL-INSURED-MID-INIT   TO  WS-NAME-WORK2.
  8185     PERFORM 5100-MOVE-NAME THRU 5190-EXIT.
  8186
  8187 5000-EXIT.
  8188     EXIT.
  8189
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 161
* EL152.cbl
  8191 5100-MOVE-NAME SECTION.
  8192     IF WS-NAME-SW GREATER THAN +1
  8193         GO TO 5190-EXIT.
  8194
  8195     IF WS-NAME-WORK2 = SPACES
  8196         GO TO 5190-EXIT.
  8197
  8198     SET NWA-INDEX2 TO +1.
  8199     SET NWA-INDEX3 TO +2.
  8200
  8201 5110-MOVE-NAME.
  8202     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8203
  8204     IF NWA-INDEX LESS THAN +30
  8205         SET NWA-INDEX UP BY +1
  8206       ELSE
  8207         ADD +2  TO  WS-NAME-SW
  8208         GO TO 5190-EXIT.
  8209
  8210     IF NWA-INDEX2 LESS THAN +20
  8211         SET NWA-INDEX3 UP BY +1
  8212         SET NWA-INDEX2 UP BY +1.
  8213
  8214     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8215        WS-NW2 (NWA-INDEX3) = SPACES
  8216         IF WS-NAME-SW = ZERO
  8217             MOVE ','            TO  WS-NW (NWA-INDEX)
  8218             SET NWA-INDEX UP BY +2
  8219             MOVE +1             TO  WS-NAME-SW
  8220             GO TO 5190-EXIT
  8221           ELSE
  8222             GO TO 5190-EXIT.
  8223
  8224     GO TO 5110-MOVE-NAME.
  8225
  8226 5190-EXIT.
  8227     EXIT.
  8228
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 162
* EL152.cbl
  8230 5200-MOVE-NAME.
  8231*    NOTE *******************************************************
  8232*         *           M O V E   N A M E   R O U T I N E         *
  8233*         *                                                     *
  8234*         *      THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8235*         *  NAME FROM THE CLAIM MASTER TO A WORK AREA WITH     *
  8236*         *  NO EMBEDDED BLANKS.                                *
  8237*         *                                                     *
  8238*         *        FIELD               VALUE                    *
  8239*         *                                                     *
  8240*         *      LAST NAME (CL15)      SMITH                    *
  8241*         *      1ST NAME  (CL12)      JOHN                     *
  8242*         *      MID NAME  (CL1)       A                        *
  8243*         *                                                     *
  8244*         *      AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8245*         *                                                     *
  8246*         *              JOHN A. SMITH                          *
  8247*         *                                                     *
  8248*         *      TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8249*         *  STORAGE COPYBOOK:                                  *
  8250*         *                                                     *
  8251*         *      01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8252*         *                                                     *
  8253*         *******************************************************.
  8254
  8255     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
  8256     MOVE ZERO                   TO  WS-NAME-SW.
  8257     SET NWA-INDEX TO +1.
  8258
  8259     IF W-FIRST-NAME = SPACES
  8260             AND
  8261        W-MIDDLE-NAME = SPACES
  8262         MOVE W-LAST-NAME        TO WS-NAME-WORK
  8263         GO TO 5200-EXIT.
  8264
  8265     MOVE W-FIRST-NAME           TO  WS-NAME-WORK2.
  8266     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8267
  8268     SET NWA-INDEX UP BY +1.
  8269
  8270     IF W-MIDDLE-NAME NOT = SPACES
  8271        MOVE W-MIDDLE-NAME       TO  WS-NW (NWA-INDEX)
  8272        SET NWA-INDEX UP BY +1
  8273        MOVE '.'                 TO  WS-NW (NWA-INDEX)
  8274        SET NWA-INDEX UP BY +2.
  8275
  8276     MOVE W-LAST-NAME            TO  WS-NAME-WORK2.
  8277     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8278
  8279 5200-EXIT.
  8280     EXIT.
  8281
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 163
* EL152.cbl
  8283 5300-MOVE-NAME.
  8284     IF WS-NAME-SW > +1
  8285         GO TO 5390-EXIT.
  8286
  8287     IF WS-NAME-WORK2 = SPACES
  8288         GO TO 5390-EXIT.
  8289
  8290     SET NWA-INDEX2 TO +1.
  8291     SET NWA-INDEX3 TO +2.
  8292
  8293 5310-MOVE-NAME.
  8294     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8295
  8296     IF NWA-INDEX < +30
  8297        SET NWA-INDEX UP BY +1
  8298     ELSE
  8299        ADD +2  TO  WS-NAME-SW
  8300        GO TO 5390-EXIT.
  8301
  8302     IF NWA-INDEX2 < +20
  8303         SET NWA-INDEX2 UP BY +1
  8304         SET NWA-INDEX3 UP BY +1.
  8305
  8306     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8307        WS-NW2 (NWA-INDEX3) = SPACES
  8308        GO TO 5390-EXIT.
  8309
  8310     GO TO 5310-MOVE-NAME.
  8311
  8312 5390-EXIT.
  8313     EXIT.
  8314
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 164
* EL152.cbl
  8316 6100-ADDR-MAINT.
  8317***************************************************************
  8318*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
  8319*    AND THE TS-TABLE OF LETTER TEXT.                         *
  8320*    IT WILL THEN XCTL TO THE ADDRESS MAINT PROGRAM.          *
  8321***************************************************************
  8322
  8323     PERFORM 7500-READ-TS        THRU 7599-EXIT
  8324
  8325     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8326     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8327             VARYING SC-INDX FROM 1 BY 1
  8328             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8329
  8330     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  8331        MOVE ER-0343             TO EMI-ERROR
  8332        MOVE -1                  TO MAINTL
  8333        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8334        GO TO 8200-SEND-DATAONLY.
  8335
  8336*    PERFORM 7500-READ-TS        THRU 7599-EXIT
  8337*    PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8338*    PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8339*            VARYING SC-INDX FROM 1 BY 1
  8340*            UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8341
  8342     PERFORM 7700-PUT-TEMP-STOR    THRU 7749-EXIT.
  8343     PERFORM 7790-WRITE-SCREEN-TS  THRU 7790-EXIT.
  8344     PERFORM 7795-WRITE-PI-AREA-TS THRU 7795-EXIT.
  8345     MOVE PGM-EL141 TO PGM-NAME.
  8346
  8347     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 165
* EL152.cbl
  8349 6200-EDIT-MODE.
  8350***************************************************************
  8351*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
  8352*    AND THE TS-TABLE OF LETTER TEXT.                         *
  8353*    IT WILL THEN XCTL TO THE TEXT-EDITOR PROGRAM.            *
  8354***************************************************************
  8355     IF PI-SHOW-MODE
  8356        MOVE ER-0188             TO EMI-ERROR
  8357        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8358        MOVE -1                  TO MAINTL
  8359        MOVE AL-UABON            TO MAINTA
  8360        GO TO 8200-SEND-DATAONLY
  8361     END-IF
  8362
  8363*    IF PI-COMPANY-ID = 'DMD'
  8364*        IF PI-BSR-AUTOMATED
  8365*            MOVE ER-0912        TO EMI-ERROR
  8366*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8367*            MOVE -1             TO MAINTL
  8368*            MOVE AL-UABON       TO MAINTA
  8369*            GO TO 8200-SEND-DATAONLY.
  8370
  8371     IF PI-CURRENT-LINE = ZEROS
  8372        MOVE ER-0187             TO EMI-ERROR
  8373        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8374        MOVE -1                  TO MAINTL
  8375        GO TO 8200-SEND-DATAONLY.
  8376
  8377     PERFORM 7500-READ-TS        THRU 7599-EXIT
  8378     PERFORM 7750-DELETE-TEMP-STOR
  8379                                 THRU 7750-EXIT
  8380     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8381     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8382             VARYING SC-INDX FROM 1 BY 1
  8383             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8384
  8385     PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT.
  8386     PERFORM 7790-WRITE-SCREEN-TS THRU 7790-EXIT.
  8387
  8388     MOVE PI-FORM-NUMBER         TO PI-COMM-CONTROL.
  8389     MOVE ZEROS                  TO PI-UPDATE-SW.
  8390     MOVE '1'                    TO PI-ENTRY-CD-1.
  8391     MOVE PGM-EL1042             TO PGM-NAME.
  8392     GO TO 9300-XCTL.
  8393
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 166
* EL152.cbl
  8395 6400-LETTER-RELEASE.
  8396***************************************************************
  8397*    THIS ROUTINE WILL BE USED WHEN THE LETTER HAS BEEN       *
  8398*    COMPLETED AND IS TO BE PUT AS PERMANENT RECORDS ONTO     *
  8399*    THE ARCHIVE FILE.                                        *
  8400*    THE FOLLOWING FUNCTIONS WILL BE PERFORMED                *
  8401*        1. CHECK SECURITY AND IF IT IS A DESIGNATED LETTER.  *
  8402*        2. RE-EDIT DATA AND UPDATE TS-TABLE WITH CHANGES     *
  8403*        3. MAKE SURE THERE ARE NO UNRESOLVED SYMBOLS         *
  8404*        4. GET THE ARCHIVE NUMBER FROM THE CONTROL FILE.     *
  8405*        5. WRITE THE NEW ARCHIVE RECORDS FROM TS-TABLE.      *
  8406*        7. BUILD A CORRESPONDENCE TRAILER                    *
  8407*        8. BUILD OR UPDATE THE ACTIVITY QUE FILE WITH THE    *
  8408*                 ARCHIVE NUMBER IF IT IS TO BE PRINTED LATER.*
  8409*        4. RESET ALL CONTROL FIELDS AND RETURN THE           *
  8410*                 ARCHIVE NUMBER USED TO FILE THE RECORDS.    *
  8411***************************************************************
  8412
  8413     PERFORM 7500-READ-TS        THRU 7599-EXIT
  8414
  8415     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8416     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8417             VARYING SC-INDX FROM 1 BY 1
  8418             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8419
  8420     IF NOT MODIFY-CAP
  8421        MOVE ER-0070             TO EMI-ERROR
  8422        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8423        MOVE -1                  TO MAINTL
  8424        GO TO 8200-SEND-DATAONLY.
  8425
  8426     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  8427        MOVE ER-0211             TO EMI-ERROR
  8428        MOVE -1                  TO MAINTL
  8429        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8430        GO TO 8200-SEND-DATAONLY.
  8431
  8432*    PERFORM 7500-READ-TS        THRU 7599-EXIT
  8433*    PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8434*    PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8435*            VARYING SC-INDX FROM 1 BY 1
  8436*            UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8437
  8438     IF PI-ADDR-TYPE  NOT =  ADDRI
  8439        PERFORM 7000-READ-ADDR THRU 7099-EXIT.
  8440
  8441     IF NOT EMI-NO-ERRORS
  8442        GO TO 8200-SEND-DATAONLY.
  8443
  8444     MOVE +0                     TO TALLY.
  8445     INSPECT RECORD-TABLE TALLYING TALLY
  8446                                 FOR CHARACTERS BEFORE '@'.
  8447
  8448     IF TALLY < +21900
  8449        COMPUTE PI-CURRENT-LINE = TALLY / 73
  8450        MOVE ZEROS               TO ROLL-COUNTER
  8451        MOVE ER-0191             TO EMI-ERROR
  8452        MOVE -1                  TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 167
* EL152.cbl
  8453        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8454        GO TO 7900-ROLL-PAGE.
  8455
  8456     MOVE '1'                    TO CNTL-RECORD-TYPE.
  8457     MOVE ZEROS                  TO CNTL-SEQ.
  8458     MOVE SPACES                 TO CNTL-GENL.
  8459
  8460* EXEC CICS READ
  8461*         DATASET    (CNTL-ID)
  8462*         SET        (ADDRESS OF CONTROL-FILE)
  8463*         RIDFLD     (CNTL-KEY)
  8464*         UPDATE
  8465*    END-EXEC.
  8466*    MOVE '&"S        EU         (   #00008221' TO DFHEIV0
  8467     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8468     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8469     MOVE X'2020233030303038323231' TO DFHEIV0(25:11)
  8470     CALL 'kxdfhei1' USING DFHEIV0,
  8471           CNTL-ID,
  8472           DFHEIV20,
  8473           DFHEIV99,
  8474           CNTL-KEY,
  8475           DFHEIV99,
  8476           DFHEIV99,
  8477           DFHEIV99
  8478     SET ADDRESS OF CONTROL-FILE TO
  8479         DFHEIV20
  8480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8481
  8482
  8483     ADD 1                       TO CF-CO-ARCHIVE-COUNTER.
  8484     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
  8485     MOVE CF-PRINT-ADDRESS-LABELS   TO  WS-LABELS-SW.
  8486
  8487
  8488* EXEC CICS REWRITE
  8489*         FROM      (CONTROL-FILE)
  8490*         DATASET   (CNTL-ID)
  8491*    END-EXEC
  8492     MOVE LENGTH OF
  8493      CONTROL-FILE
  8494       TO DFHEIV11
  8495*    MOVE '&& L                  %   #00008232' TO DFHEIV0
  8496     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8497     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8498     MOVE X'2020233030303038323332' TO DFHEIV0(25:11)
  8499     CALL 'kxdfhei1' USING DFHEIV0,
  8500           CNTL-ID,
  8501           CONTROL-FILE,
  8502           DFHEIV11,
  8503           DFHEIV99
  8504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8505
  8506     PERFORM 6500-BUILD-CORRESPOND THRU 6599-EXIT.
  8507
  8508
  8509* EXEC CICS HANDLE CONDITION
  8510*         NOTOPEN   (9990-ABEND)
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 168
* EL152.cbl
  8511*    END-EXEC.
  8512*    MOVE '"$J                   ! ) #00008239' TO DFHEIV0
  8513     MOVE X'22244A202020202020202020' TO DFHEIV0(1:12)
  8514     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8515     MOVE X'2920233030303038323339' TO DFHEIV0(25:11)
  8516     CALL 'kxdfhei1' USING DFHEIV0
  8517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8518
  8519
  8520
  8521* EXEC CICS GETMAIN
  8522*         SET      (ADDRESS OF LETTER-ARCHIVE)
  8523*         LENGTH   (ARCH-LENGTH)
  8524*    END-EXEC.
  8525*    MOVE '," L                  $   #00008243' TO DFHEIV0
  8526     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  8527     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8528     MOVE X'2020233030303038323433' TO DFHEIV0(25:11)
  8529     CALL 'kxdfhei1' USING DFHEIV0,
  8530           DFHEIV20,
  8531           ARCH-LENGTH,
  8532           DFHEIV99
  8533     SET ADDRESS OF LETTER-ARCHIVE TO
  8534         DFHEIV20
  8535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8536
  8537
  8538     MOVE SPACES                 TO LETTER-ARCHIVE.
  8539     MOVE 'LA'                   TO LA-RECORD-ID.
  8540     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
  8541                                    LA-ARCHIVE-NO-A1.
  8542     MOVE '1'                    TO LA-RECORD-TYPE
  8543                                    LA-RECORD-TYPE-A1.
  8544     MOVE ZEROS                  TO LA-LINE-SEQ-NO
  8545                                    LA-LINE-SEQ-NO-A1.
  8546     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8547                                    LA-COMPANY-CD-A1.
  8548     MOVE CLAM-CARRIER           TO LA-CARRIER.
  8549     MOVE PI-CLAIM-NO            TO LA-CLAIM-NO.
  8550     MOVE PI-CERT-NO             TO LA-CERT-NO.
  8551
  8552*    IF PI-COMPANY-ID = 'DMD'
  8553*        MOVE WS-DMD-CERT-STATE    TO LA-DMD-UND-CODE
  8554*        MOVE WS-DMD-CERT-GROUPING TO LA-DMD-PROD-CODE
  8555*        MOVE WS-DMD-BEN-CODE      TO LA-DMD-BEN-CODE
  8556*        MOVE WS-DMD-CORR-TRLR-SEQ TO LA-DMD-CORR-TRLR-SEQ
  8557*        MOVE WS-DMD-LETTER-FORM   TO LA-DMD-LETTER-FORM
  8558*        MOVE WS-DMD-RES-ST        TO LA-DMD-RES-ST
  8559*        MOVE LOW-VALUES           TO LA-DMD-LETTER-PURGE-DT
  8560*                                     LA-DMD-LETTER-RELOAD-DT
  8561*        MOVE '1'                  TO LA-DMD-LETTER-STATUS
  8562*        EXEC CICS GETMAIN
  8563*            SET    (ADDRESS OF LETTER-ARCHIVE-TEMP)
  8564*            LENGTH (ARCT-LENGTH)
  8565*        END-EXEC.
  8566
  8567     IF COPIESL NOT = ZEROS
  8568        MOVE COPIESI             TO LA-NO-OF-COPIES
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 169
* EL152.cbl
  8569     ELSE
  8570        MOVE  1                  TO LA-NO-OF-COPIES.
  8571
  8572     IF RESENDL NOT = ZEROS
  8573        MOVE RESEND-SAVE         TO LA-RESEND-DATE
  8574     ELSE
  8575        MOVE LOW-VALUES          TO LA-RESEND-DATE.
  8576
  8577     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD.
  8578     MOVE CURRENT-SAVE           TO LA-CREATION-DT.
  8579
  8580     IF PRINT-PERFORMED
  8581        MOVE CURRENT-SAVE        TO LA-INITIAL-PRINT-DATE
  8582     ELSE
  8583        MOVE LOW-VALUES          TO LA-INITIAL-PRINT-DATE.
  8584
  8585     MOVE LOW-VALUES             TO LA-RESEND-PRINT-DATE.
  8586     MOVE CORR-TRLR-SEQ          TO LA-CORR-TRLR-SEQ.
  8587     PERFORM 6490-WRITE-ARCHIVE THRU 6499-EXIT.
  8588
  8589     IF PI-PROMPT-LETTER NOT EQUAL 'Y'
  8590         PERFORM 6700-BUILD-NAPERSOFT THRU 6799-EXIT
  8591     END-IF.
  8592
  8593     IF WS-LABELS-SW = 'N'
  8594         NEXT SENTENCE
  8595     ELSE
  8596         SET TB-INDX TO 1
  8597         MOVE ZEROS                  TO SEQ-COUNTER
  8598         PERFORM 6480-FORMAT-ADDRESS
  8599               VARYING TB-INDX FROM 1 BY 1 UNTIL
  8600               TB-INDX > 6.
  8601
  8602     MOVE ZEROS                  TO SEQ-COUNTER.
  8603     MOVE 'N'                    TO WS-SKIP-EMAIL
  8604     PERFORM 6470-FORMAT-TEXT THRU 6479-EXIT
  8605             VARYING TB-INDX FROM 8 BY 1
  8606             UNTIL TB-INDX > PI-TOTAL-LINES.
  8607     MOVE 'Y'                    TO WS-SKIP-EMAIL.
  8608     IF SEQ-COUNTER < +15
  8609      AND WS-SKIP-EMAIL EQUAL 'N'
  8610        MOVE ARCH-NUMBER         TO TRAN-DL2-ARCHNO
  8611        MOVE PI-PROCESSOR-ID     TO TRAN-DL2-USER
  8612        MOVE SPACES              TO TRAN-DL2-CCC
  8613        STRING PI-CARRIER ' ' PI-CLAIM-NO ' ' PI-CERT-NO
  8614           DELIMITED BY SIZE
  8615           INTO TRAN-DL2-CCC
  8616        END-STRING
  8617
  8618* EXEC CICS WRITEQ TD
  8619*          QUEUE ('BTCH')
  8620*          FROM (TRAN-DATA-LINE1)
  8621*          LENGTH (80)
  8622*       END-EXEC
  8623     MOVE 80
  8624       TO DFHEIV11
  8625     MOVE 'BTCH' TO DFHEIV5
  8626*    MOVE '(" L                  &   #00008327' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 170
* EL152.cbl
  8627     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  8628     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8629     MOVE X'2020233030303038333237' TO DFHEIV0(25:11)
  8630     CALL 'kxdfhei1' USING DFHEIV0,
  8631           DFHEIV5,
  8632           TRAN-DATA-LINE1,
  8633           DFHEIV11,
  8634           DFHEIV99,
  8635           DFHEIV99
  8636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8637
  8638* EXEC CICS WRITEQ TD
  8639*          QUEUE ('BTCH')
  8640*          FROM (TRAN-DATA-LINE2)
  8641*          LENGTH (80)
  8642*       END-EXEC
  8643     MOVE 80
  8644       TO DFHEIV11
  8645     MOVE 'BTCH' TO DFHEIV5
  8646*    MOVE '(" L                  &   #00008332' TO DFHEIV0
  8647     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  8648     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8649     MOVE X'2020233030303038333332' TO DFHEIV0(25:11)
  8650     CALL 'kxdfhei1' USING DFHEIV0,
  8651           DFHEIV5,
  8652           TRAN-DATA-LINE2,
  8653           DFHEIV11,
  8654           DFHEIV99,
  8655           DFHEIV99
  8656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8657
  8658* EXEC CICS WRITEQ TD
  8659*          QUEUE ('BTCH')
  8660*          FROM (TRAN-DATA-LINE3)
  8661*          LENGTH (80)
  8662*       END-EXEC
  8663     MOVE 80
  8664       TO DFHEIV11
  8665     MOVE 'BTCH' TO DFHEIV5
  8666*    MOVE '(" L                  &   #00008337' TO DFHEIV0
  8667     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  8668     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8669     MOVE X'2020233030303038333337' TO DFHEIV0(25:11)
  8670     CALL 'kxdfhei1' USING DFHEIV0,
  8671           DFHEIV5,
  8672           TRAN-DATA-LINE3,
  8673           DFHEIV11,
  8674           DFHEIV99,
  8675           DFHEIV99
  8676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8677     END-IF
  8678     MOVE ER-0280                TO EMI-ERROR.
  8679
  8680     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8681     MOVE ARCH-NUMBER            TO ARCH-SUPPRESS
  8682     MOVE ARCH-EDIT              TO EMI-TEXT-VARIABLE (1).
  8683
  8684     GO TO 9400-CLEAR.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 171
* EL152.cbl
  8685
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 172
* EL152.cbl
  8687 6470-FORMAT-TEXT.
  8688
  8689     IF REC-TEXT (TB-INDX) (1:16) = NAPERSOFT-LETTER
  8690         MOVE 'Y'                TO WS-SKIP-EMAIL
  8691     END-IF.
  8692
  8693     MOVE SPACES                 TO LETTER-ARCHIVE.
  8694     MOVE '3'                    TO LA-RECORD-TYPE
  8695                                    LA-RECORD-TYPE-A1.
  8696     MOVE 'LA'                   TO LA-RECORD-ID.
  8697     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
  8698                                    LA-ARCHIVE-NO-A1.
  8699     MOVE SEQ-COUNTER            TO LA-LINE-SEQ-NO
  8700                                    LA-LINE-SEQ-NO-A1.
  8701     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8702                                    LA-COMPANY-CD-A1.
  8703     MOVE REC-TEXT (TB-INDX)     TO LA-TEXT-LINE.
  8704     SET TB-INDX1 TO TB-INDX.
  8705     SET TB-INDX1 UP BY 1.
  8706     MOVE ZEROS                  TO INDX-WORK.
  8707
  8708 6472-LOOP.
  8709     IF TB-INDX1 < PI-TOTAL-LINES AND
  8710        REC-TEXT (TB-INDX1) = SPACES
  8711           SET TB-INDX1 UP BY 1
  8712           ADD 1                 TO INDX-WORK
  8713           GO TO 6472-LOOP.
  8714
  8715     IF REC-TEXT (TB-INDX1) = TOP-FORM
  8716        MOVE '99'                TO LA-SKIP-CONTROL
  8717        SET TB-INDX1 UP BY 1
  8718     ELSE
  8719        MOVE INDX-WORK           TO LA-SKIP-CONTROL.
  8720
  8721     SET TB-INDX TO TB-INDX1.
  8722     SET TB-INDX DOWN BY 1.
  8723     PERFORM 6490-WRITE-ARCHIVE THRU 6499-EXIT.
  8724     ADD 1 TO SEQ-COUNTER.
  8725
  8726 6479-EXIT.
  8727      EXIT.
  8728
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 173
* EL152.cbl
  8730 6480-FORMAT-ADDRESS.
  8731     MOVE SPACES                 TO LETTER-ARCHIVE.
  8732     MOVE '2'                    TO LA-RECORD-TYPE
  8733                                    LA-RECORD-TYPE-A1.
  8734     MOVE 'LA'                   TO LA-RECORD-ID.
  8735     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
  8736                                    LA-ARCHIVE-NO-A1.
  8737     MOVE SEQ-COUNTER            TO LA-LINE-SEQ-NO
  8738                                    LA-LINE-SEQ-NO-A1.
  8739     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8740                                    LA-COMPANY-CD-A1.
  8741     MOVE REC-TEXT (TB-INDX)     TO LA-ADDRESS-LINE.
  8742
  8743     PERFORM 6490-WRITE-ARCHIVE THRU 6499-EXIT.
  8744     ADD 1 TO SEQ-COUNTER.
  8745
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 174
* EL152.cbl
  8747 6490-WRITE-ARCHIVE.
  8748
  8749* EXEC CICS HANDLE CONDITION
  8750*        DUPKEY    (6499-EXIT)
  8751*    END-EXEC.
  8752*    MOVE '"$$                   ! * #00008413' TO DFHEIV0
  8753     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8754     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8755     MOVE X'2A20233030303038343133' TO DFHEIV0(25:11)
  8756     CALL 'kxdfhei1' USING DFHEIV0
  8757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8758
  8759
  8760*    IF PI-COMPANY-ID = 'DMD'
  8761*        MOVE LETTER-ARCHIVE     TO LETTER-ARCHIVE-TEMP
  8762*        MOVE 'LT'               TO LT-RECORD-ID
  8763*        EXEC CICS WRITE
  8764*            DATASET   (ARCT-ID)
  8765*            FROM      (LETTER-ARCHIVE-TEMP)
  8766*            RIDFLD    (LT-CONTROL-PRIMARY)
  8767*        END-EXEC.
  8768
  8769
  8770* EXEC CICS WRITE
  8771*         DATASET   (ARCH-ID)
  8772*         FROM      (LETTER-ARCHIVE)
  8773*         RIDFLD    (LA-CONTROL-PRIMARY)
  8774*    END-EXEC.
  8775     MOVE LENGTH OF
  8776      LETTER-ARCHIVE
  8777       TO DFHEIV11
  8778*    MOVE '&$ L                  ''   #00008426' TO DFHEIV0
  8779     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8780     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8781     MOVE X'2020233030303038343236' TO DFHEIV0(25:11)
  8782     CALL 'kxdfhei1' USING DFHEIV0,
  8783           ARCH-ID,
  8784           LETTER-ARCHIVE,
  8785           DFHEIV11,
  8786           LA-CONTROL-PRIMARY,
  8787           DFHEIV99,
  8788           DFHEIV99
  8789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8790
  8791
  8792 6499-EXIT.
  8793     EXIT.
  8794
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 175
* EL152.cbl
  8796 6500-BUILD-CORRESPOND.
  8797***************************************************************
  8798*    THIS ROUTINE WILL GET THE TRAILER SEQUENCE NUMBER FROM   *
  8799*    THE CLAIM MASTER AND BUILD A CORRESPONDENCE TRAILER      *
  8800*    USING THE NEW SEQUENCE NUMBER.                           *
  8801*    INPUT DATA FROM THE SCREEN IS USED TO CREATE THE NEW     *
  8802*    TRAILER RECORD.                                          *
  8803***************************************************************
  8804
  8805     MOVE PI-CLAIM-NO            TO CLAM-CLAIM.
  8806
  8807
  8808* EXEC CICS READ
  8809*         DATASET    (CLAM-ID)
  8810*         SET        (ADDRESS OF CLAIM-MASTER)
  8811*         RIDFLD     (CLAM-KEY)
  8812*         UPDATE
  8813*    END-EXEC.
  8814*    MOVE '&"S        EU         (   #00008447' TO DFHEIV0
  8815     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8816     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8817     MOVE X'2020233030303038343437' TO DFHEIV0(25:11)
  8818     CALL 'kxdfhei1' USING DFHEIV0,
  8819           CLAM-ID,
  8820           DFHEIV20,
  8821           DFHEIV99,
  8822           CLAM-KEY,
  8823           DFHEIV99,
  8824           DFHEIV99,
  8825           DFHEIV99
  8826     SET ADDRESS OF CLAIM-MASTER TO
  8827         DFHEIV20
  8828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8829
  8830
  8831     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
  8832
  8833     IF FOLLOW-UP-SAVE > CL-NEXT-FOLLOWUP-DT
  8834        MOVE FOLLOW-UP-SAVE      TO CL-NEXT-FOLLOWUP-DT.
  8835
  8836     IF RESEND-SAVE > CL-NEXT-FOLLOWUP-DT
  8837        MOVE RESEND-SAVE         TO CL-NEXT-FOLLOWUP-DT.
  8838
  8839     IF MAINTI = 'C'
  8840        MOVE '2'                 TO CL-LAST-MAINT-TYPE.
  8841
  8842     IF MAINTI = 'R'
  8843        PERFORM 6600-SET-ADDR-SEQ THRU 6699-EXIT
  8844        MOVE ACTV-SEQ            TO PI-ADDR-SEQ.
  8845
  8846*    IF PI-COMPANY-ID = 'DMD'
  8847*        MOVE 04                 TO CL-ACTIVITY-CODE.
  8848
  8849
  8850* EXEC CICS GETMAIN
  8851*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  8852*         INITIMG   (GETMAIN-SPACE)
  8853*         LENGTH    (ACTV-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 176
* EL152.cbl
  8854*    END-EXEC.
  8855*    MOVE ',"IL                  $   #00008472' TO DFHEIV0
  8856     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8857     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8858     MOVE X'2020233030303038343732' TO DFHEIV0(25:11)
  8859     CALL 'kxdfhei1' USING DFHEIV0,
  8860           DFHEIV20,
  8861           ACTV-LENGTH,
  8862           GETMAIN-SPACE
  8863     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8864         DFHEIV20
  8865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8866
  8867
  8868     MOVE 'AT'                   TO AT-RECORD-ID.
  8869     MOVE  4                     TO AT-TRAILER-TYPE.
  8870     MOVE CURRENT-SAVE           TO AT-RECORDED-DT
  8871                                    CL-LAST-MAINT-DT
  8872                                    AT-CORR-LAST-MAINT-DT
  8873     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  8874                                    CL-LAST-MAINT-USER
  8875                                    AT-CORR-LAST-UPDATED-BY
  8876     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  8877                                    CL-LAST-MAINT-HHMMSS.
  8878     MOVE ACTV-KEY               TO AT-CONTROL-PRIMARY.
  8879     MOVE PI-CLAIM-NO            TO AT-CLAIM-NO.
  8880     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
  8881                                    CORR-TRLR-SEQ.
  8882     MOVE CURRENT-SAVE           TO AT-LETTER-SENT-DT.
  8883     MOVE FOLLOW-UP-SAVE         TO AT-RECEIPT-FOLLOW-UP.
  8884     MOVE RESEND-SAVE            TO AT-AUTO-RE-SEND-DT.
  8885     MOVE LOW-VALUES             TO AT-LETTER-ANSWERED-DT
  8886                                    AT-LETTER-PURGED-DT.
  8887     MOVE ARCH-NUMBER            TO AT-LETTER-ARCHIVE-NO.
  8888     MOVE '1'                    TO AT-LETTER-ORIGIN.
  8889     MOVE PI-RESEND-FORM-NUMBER  TO AT-RESEND-LETTER-FORM.
  8890     MOVE PI-AUTO-CLOSE-IND      TO AT-AUTO-CLOSE-IND.
  8891     MOVE PI-LETTER-TO-BENE      TO AT-LETTER-TO-BENE.
  8892
  8893*    IF PI-COMPANY-ID = 'DMD'
  8894*        MOVE '1'                TO AT-DMD-LETTER-STATUS
  8895*        IF PI-BSR-AUTOMATED
  8896*            MOVE 'A'            TO AT-DMD-BSR-CODE.
  8897*
  8898     IF FORML  NOT = ZEROS
  8899        MOVE FORMI               TO AT-STD-LETTER-FORM
  8900     ELSE
  8901        MOVE SPACES              TO AT-STD-LETTER-FORM.
  8902
  8903     IF REL NOT = ZEROS
  8904        MOVE REI                 TO AT-REASON-TEXT
  8905     ELSE
  8906        MOVE SPACES              TO AT-REASON-TEXT.
  8907
  8908*    IF PI-COMPANY-ID = 'HAN'  OR  'JHL'
  8909*        MOVE AT-REASON-TEXT     TO WS-REASON-TEXT
  8910*        IF WS-RE-NDX NUMERIC  AND
  8911*           WS-RE-NDX > ZERO   AND
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 177
* EL152.cbl
  8912*           WS-RE-NDX < 33
  8913*            MOVE HAN-REASON-TEXT (WS-RE-NDX)
  8914*                                TO AT-REASON-TEXT.
  8915
  8916     MOVE PI-ADDR-SEQ            TO AT-ADDRESS-REC-SEQ-NO.
  8917
  8918     IF PI-ADDR-TYPE > SPACES
  8919         MOVE PI-ADDR-TYPE          TO AT-ADDRESEE-TYPE
  8920         MOVE REC-TEXT (1)          TO AT-ADDRESSEE-NAME
  8921     ELSE
  8922     IF W-ACCOUNT > ZEROS
  8923         MOVE 'A'                   TO AT-ADDRESEE-TYPE
  8924         MOVE SS06D                 TO AT-ADDRESSEE-NAME
  8925     ELSE
  8926     IF W-BENEFICIARY > ZEROS
  8927          MOVE 'B'                  TO AT-ADDRESEE-TYPE
  8928          IF W-BENEFICIARY = 9
  8929              MOVE SS61D            TO AT-ADDRESSEE-NAME
  8930            ELSE
  8931              MOVE SS43D            TO AT-ADDRESSEE-NAME
  8932     ELSE
  8933     IF W-EMPLOYER > ZEROS
  8934          MOVE 'E'                  TO AT-ADDRESEE-TYPE
  8935          MOVE SS48D                TO AT-ADDRESSEE-NAME
  8936     ELSE
  8937     IF W-INSURED > ZEROS
  8938          MOVE 'I'                  TO AT-ADDRESEE-TYPE
  8939          MOVE SS57D                TO AT-ADDRESSEE-NAME
  8940     ELSE
  8941     IF W-PHYSICIAN > ZEROS
  8942          MOVE 'P'                  TO AT-ADDRESEE-TYPE
  8943          MOVE SS47D                TO AT-ADDRESSEE-NAME
  8944     ELSE
  8945     IF W-OTHER-1 > ZEROS
  8946          MOVE 'O'                  TO AT-ADDRESEE-TYPE
  8947          MOVE SS49D                TO AT-ADDRESSEE-NAME
  8948     ELSE
  8949     IF W-OTHER-2 > ZEROS
  8950          MOVE 'Q'                  TO AT-ADDRESEE-TYPE
  8951          MOVE SS50D                TO AT-ADDRESSEE-NAME
  8952     ELSE
  8953          MOVE SPACES               TO AT-ADDRESEE-TYPE
  8954                                       AT-ADDRESSEE-NAME.
  8955     IF PRINT-PERFORMED
  8956        MOVE CURRENT-SAVE        TO AT-INITIAL-PRINT-DATE
  8957     ELSE
  8958        MOVE LOW-VALUES          TO AT-INITIAL-PRINT-DATE.
  8959
  8960     MOVE LOW-VALUES             TO AT-RESEND-PRINT-DATE.
  8961
  8962*    IF PI-COMPANY-ID = 'DMD'
  8963*        MOVE CL-CERT-STATE          TO WS-DMD-CERT-STATE
  8964*        MOVE CL-CERT-GROUPING (5:2) TO WS-DMD-CERT-GROUPING
  8965*        MOVE BEN-HOLD               TO WS-DMD-BEN-CODE
  8966*        MOVE AT-SEQUENCE-NO         TO WS-DMD-CORR-TRLR-SEQ
  8967*        MOVE AT-STD-LETTER-FORM     TO WS-DMD-LETTER-FORM.
  8968
  8969
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 178
* EL152.cbl
  8970* EXEC CICS WRITE
  8971*         DATASET    (ACTV-ID)
  8972*         FROM       (ACTIVITY-TRAILERS)
  8973*         RIDFLD     (AT-CONTROL-PRIMARY)
  8974*    END-EXEC.
  8975     MOVE LENGTH OF
  8976      ACTIVITY-TRAILERS
  8977       TO DFHEIV11
  8978*    MOVE '&$ L                  ''   #00008579' TO DFHEIV0
  8979     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8980     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8981     MOVE X'2020233030303038353739' TO DFHEIV0(25:11)
  8982     CALL 'kxdfhei1' USING DFHEIV0,
  8983           ACTV-ID,
  8984           ACTIVITY-TRAILERS,
  8985           DFHEIV11,
  8986           AT-CONTROL-PRIMARY,
  8987           DFHEIV99,
  8988           DFHEIV99
  8989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8990
  8991
  8992
  8993* EXEC CICS HANDLE CONDITION
  8994*        DUPKEY      (6599-EXIT)
  8995*    END-EXEC.
  8996*    MOVE '"$$                   ! + #00008585' TO DFHEIV0
  8997     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8998     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8999     MOVE X'2B20233030303038353835' TO DFHEIV0(25:11)
  9000     CALL 'kxdfhei1' USING DFHEIV0
  9001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9002
  9003
  9004
  9005* EXEC CICS REWRITE
  9006*         DATASET    (CLAM-ID)
  9007*         FROM       (CLAIM-MASTER)
  9008*    END-EXEC.
  9009     MOVE LENGTH OF
  9010      CLAIM-MASTER
  9011       TO DFHEIV11
  9012*    MOVE '&& L                  %   #00008589' TO DFHEIV0
  9013     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9014     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9015     MOVE X'2020233030303038353839' TO DFHEIV0(25:11)
  9016     CALL 'kxdfhei1' USING DFHEIV0,
  9017           CLAM-ID,
  9018           CLAIM-MASTER,
  9019           DFHEIV11,
  9020           DFHEIV99
  9021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9022
  9023
  9024 6599-EXIT.
  9025      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 179
* EL152.cbl
  9027 6600-SET-ADDR-SEQ.
  9028     IF ADDRL = ZEROS
  9029        GO TO 6699-EXIT.
  9030
  9031     MOVE ADDRI                  TO PI-ADDR-TYPE
  9032                                    WS-ADDR-TYPE-CD.
  9033     IF WS-ADDR-SEQ NOT NUMERIC
  9034        GO TO 6699-EXIT.
  9035
  9036     MOVE ZEROS                  TO PI-ADDR-SEQ.
  9037
  9038     IF WS-ADDR-TYPE = 'I'
  9039        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9040     ELSE
  9041     IF WS-ADDR-TYPE = 'A'
  9042        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9043        ADD +20                  TO ACTV-SEQ
  9044     ELSE
  9045     IF WS-ADDR-TYPE = 'B'
  9046        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9047        ADD +10                  TO ACTV-SEQ
  9048     ELSE
  9049     IF WS-ADDR-TYPE = 'P'
  9050        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9051        ADD +30                  TO ACTV-SEQ
  9052     ELSE
  9053     IF WS-ADDR-TYPE = 'E'
  9054        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9055        ADD +40                  TO ACTV-SEQ
  9056     ELSE
  9057     IF WS-ADDR-TYPE = 'O'
  9058        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9059        ADD +50                  TO ACTV-SEQ
  9060     ELSE
  9061     IF WS-ADDR-TYPE = 'Q'
  9062        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9063        ADD +60                  TO ACTV-SEQ.
  9064
  9065 6699-EXIT.
  9066      EXIT.
  9067
  9068 6700-BUILD-NAPERSOFT.
  9069
  9070
  9071* EXEC CICS GETMAIN
  9072*         SET      (ADDRESS OF NAPERSOFT-FILE)
  9073*         LENGTH   (NAPS-LENGTH)
  9074*    END-EXEC.
  9075*    MOVE '," L                  $   #00008640' TO DFHEIV0
  9076     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9077     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9078     MOVE X'2020233030303038363430' TO DFHEIV0(25:11)
  9079     CALL 'kxdfhei1' USING DFHEIV0,
  9080           DFHEIV20,
  9081           NAPS-LENGTH,
  9082           DFHEIV99
  9083     SET ADDRESS OF NAPERSOFT-FILE TO
  9084         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 180
* EL152.cbl
  9085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9086
  9087
  9088     MOVE LOW-VALUES            TO  NAPERSOFT-FILE.
  9089     MOVE 'NA'                  TO  NA-RECORD-ID.
  9090     MOVE PI-COMPANY-CD         TO  NA-COMPANY-CD.
  9091     MOVE PI-CARRIER            TO  NA-CARRIER.
  9092     MOVE PI-CLAIM-NO           TO  NA-CLAIM-NO.
  9093     MOVE PI-CERT-NO            TO  NA-CERT-NO.
  9094     MOVE ARCH-NUMBER           TO  NA-ARCHIVE-NO.
  9095     MOVE FORMI                 TO  NA-LETTER-ID.
  9096     MOVE PI-PROCESSOR-ID       TO  NA-PROCESSOR-ID.
  9097     MOVE CURRENT-SAVE          TO  NA-CREATION-DT.
  9098     IF PRINT-PERFORMED
  9099         MOVE CURRENT-SAVE      TO  NA-INITIAL-PRINT-DT
  9100     ELSE
  9101         MOVE LOW-VALUES        TO  NA-INITIAL-PRINT-DT
  9102     END-IF.
  9103     MOVE FOLLOW-UP-SAVE        TO  NA-FOLLOW-UP-DT.
  9104     MOVE RESEND-SAVE           TO  NA-RESEND-DT
  9105     MOVE PI-RESEND-FORM-NUMBER TO  NA-RESEND-LETTER-ID.
  9106     IF COPIESL NOT = ZEROS
  9107         MOVE COPIESI           TO  NA-NO-OF-COPIES
  9108     ELSE
  9109         MOVE 1                 TO  NA-NO-OF-COPIES
  9110     END-IF.
  9111     IF PI-LETTER-ADDRESS-TYPE = ' 0'
  9112         MOVE LOW-VALUES        TO  NA-ADDRESS-TYPE
  9113     ELSE
  9114         MOVE PI-LETTER-ADDRESS-TYPE TO NA-ADDRESS-TYPE
  9115     END-IF.
  9116     MOVE CORR-TRLR-SEQ         TO  NA-CORR-TRLR-SEQ.
  9117     MOVE PI-ENCLOSURE-CD       TO  NA-ENCLOSURE-CD.
  9118
  9119
  9120* EXEC CICS WRITE
  9121*         DATASET    (NAPS-ID)
  9122*         FROM       (NAPERSOFT-FILE)
  9123*         RIDFLD     (NA-CONTROL-PRIMARY)
  9124*    END-EXEC.
  9125     MOVE LENGTH OF
  9126      NAPERSOFT-FILE
  9127       TO DFHEIV11
  9128*    MOVE '&$ L                  ''   #00008676' TO DFHEIV0
  9129     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9130     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9131     MOVE X'2020233030303038363736' TO DFHEIV0(25:11)
  9132     CALL 'kxdfhei1' USING DFHEIV0,
  9133           NAPS-ID,
  9134           NAPERSOFT-FILE,
  9135           DFHEIV11,
  9136           NA-CONTROL-PRIMARY,
  9137           DFHEIV99,
  9138           DFHEIV99
  9139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9140
  9141
  9142 6799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 181
* EL152.cbl
  9143      EXIT.
  9144
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 182
* EL152.cbl
  9146 7000-READ-ADDR.
  9147     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  9148        IF ADDRL = ZEROS
  9149           GO TO 7099-EXIT
  9150        ELSE
  9151           MOVE ER-0374             TO EMI-ERROR
  9152           MOVE -1                  TO ADDRL
  9153           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9154           GO TO 7099-EXIT.
  9155
  9156     MOVE PI-CLAIM-NO            TO CLAM-CLAIM
  9157                                    ACTV-CLAIM.
  9158
  9159
  9160* EXEC CICS HANDLE CONDITION
  9161*         NOTOPEN    (8860-CLAM-NOT-OPEN)
  9162*         NOTFND     (7090-CLAIM-NOT-FOUND)
  9163*     END-EXEC.
  9164*    MOVE '"$JI                  ! , #00008699' TO DFHEIV0
  9165     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9166     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9167     MOVE X'2C20233030303038363939' TO DFHEIV0(25:11)
  9168     CALL 'kxdfhei1' USING DFHEIV0
  9169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9170
  9171
  9172
  9173* EXEC CICS READ
  9174*         DATASET    (CLAM-ID)
  9175*         SET        (ADDRESS OF CLAIM-MASTER)
  9176*         RIDFLD     (CLAM-KEY)
  9177*    END-EXEC.
  9178*    MOVE '&"S        E          (   #00008704' TO DFHEIV0
  9179     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9180     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9181     MOVE X'2020233030303038373034' TO DFHEIV0(25:11)
  9182     CALL 'kxdfhei1' USING DFHEIV0,
  9183           CLAM-ID,
  9184           DFHEIV20,
  9185           DFHEIV99,
  9186           CLAM-KEY,
  9187           DFHEIV99,
  9188           DFHEIV99,
  9189           DFHEIV99
  9190     SET ADDRESS OF CLAIM-MASTER TO
  9191         DFHEIV20
  9192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9193
  9194
  9195*    IF PI-COMPANY-ID = 'DMD'
  9196*            AND
  9197*       NOT SYSTEM-MODIFY-CAP
  9198*            AND
  9199*        HIGHEST-PRIORITY
  9200*        IF MAINTI = 'R'
  9201*            MOVE ER-0909        TO EMI-ERROR
  9202*            MOVE -1             TO ADDRL
  9203*            MOVE AL-UABON       TO ADDRA
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 183
* EL152.cbl
  9204*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9205*            GO TO 8200-SEND-DATAONLY
  9206*        ELSE
  9207*            MOVE ER-0900        TO EMI-ERROR
  9208*            MOVE -1             TO ADDRL
  9209*            MOVE AL-UABON       TO ADDRA
  9210*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9211*            GO TO 8200-SEND-DATAONLY.
  9212
  9213     IF ADDRL = ZEROS
  9214        GO TO 7099-EXIT.
  9215
  9216*    IF PI-COMPANY-ID = 'DMD'
  9217*        IF MAINTI = 'C'
  9218*           IF CL-BENEFICIARY = '0000B0CA10' OR '0000B0CAN0' OR
  9219*                               '0000B0CAS0' OR '0000B0CA50' OR
  9220*                               '0000B0CAA0' OR '0000B0CAB0' OR
  9221*                               '0000B0CAC0' OR '0000B0CAD0' OR
  9222*                               '0000B0CO20' OR '0000B0MN10' OR
  9223*                               '0000B0MN20' OR '0000B0MN30' OR
  9224*                               '0000B0MN40' OR '0000B0MN50' OR
  9225*                               '0000B0MN60' OR '0000B0MN70'
  9226*           IF ADDRI(1:1) = 'B'
  9227*              MOVE ER-8158     TO EMI-ERROR
  9228*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9229*              MOVE -1          TO MAINTL
  9230*              GO TO 8200-SEND-DATAONLY.
  9231*
  9232*    IF PI-COMPANY-ID = 'DMD'
  9233*      PERFORM 4000-SET-BSR THRU 4000-EXIT
  9234*      IF PI-BSR-AUTOMATED
  9235*        IF MAINTI = 'C'
  9236*           MOVE ER-7843          TO EMI-ERROR
  9237*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9238*           MOVE -1               TO MAINTL
  9239*           GO TO 8200-SEND-DATAONLY.
  9240
  9241     PERFORM 6600-SET-ADDR-SEQ THRU 6699-EXIT.
  9242
  9243     MOVE ADDRI TO WS-ADDR-TYPE-CD.
  9244
  9245*    IF CL-SYSTEM-IDENTIFIER = 'CV'
  9246*        GO TO 7040-READ-PRODUCER.
  9247
  9248 7010-READ-ACCT.
  9249
  9250     MOVE CL-CERT-GROUPING       TO ACCT-GROUPING.
  9251     MOVE CL-CERT-STATE          TO ACCT-STATE.
  9252     MOVE CL-CERT-ACCOUNT        TO ACCT-ACCOUNT.
  9253     MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DATE.
  9254
  9255
  9256* EXEC CICS HANDLE CONDITION
  9257*         NOTOPEN    (8880-ACCT-NOT-OPEN)
  9258*         NOTFND     (7080-ACCT-NOT-FOUND)
  9259*    END-EXEC.
  9260*    MOVE '"$JI                  ! - #00008770' TO DFHEIV0
  9261     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 184
* EL152.cbl
  9262     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9263     MOVE X'2D20233030303038373730' TO DFHEIV0(25:11)
  9264     CALL 'kxdfhei1' USING DFHEIV0
  9265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9266
  9267
  9268     PERFORM 8000-STARTBR-ERACCT THRU 8000-STARTBR-EXIT.
  9269
  9270     MOVE ACCT-PARTIAL-KEY       TO ACCT-SAVE-KEY.
  9271
  9272 7020-READNEXT.
  9273
  9274     PERFORM 8000-READNEXT-ERACCT THRU 8000-READNEXT-EXIT.
  9275
  9276     IF ACCT-PARTIAL-KEY NOT = ACCT-SAVE-KEY
  9277        IF WS-SAVE-ACCT-RECORD = SPACES
  9278            GO TO 7080-ACCT-NOT-FOUND
  9279        ELSE
  9280            MOVE 'Y'                 TO  WS-ACCT-READ-SW
  9281            MOVE AM-CONTROL-PRIMARY  TO  ACCT-KEY
  9282            MOVE WS-SAVE-ACCT-RECORD TO  ACCOUNT-MASTER
  9283            GO TO 7030-CONTINUE-BUILD-ADDR.
  9284
  9285     IF AM-EXPIRATION-DT = HIGH-VALUES
  9286         NEXT SENTENCE
  9287     ELSE
  9288         MOVE ACCOUNT-MASTER         TO  WS-SAVE-ACCT-RECORD
  9289         GO TO 7020-READNEXT.
  9290
  9291     MOVE AM-CONTROL-PRIMARY TO ACCT-KEY.
  9292     MOVE 'Y'                TO WS-ACCT-READ-SW.
  9293
  9294 7030-CONTINUE-BUILD-ADDR.
  9295
  9296     MOVE SPACES             TO  WS-SAVE-ACCT-RECORD.
  9297
  9298     IF WS-ADDR-TYPE-CD = 'A0'
  9299        MOVE ZEROS               TO PI-ADDR-SEQ
  9300     ELSE
  9301        GO TO 7067-CHECK-BENE-ADDR.
  9302
  9303     MOVE SPACES             TO               WS-LABEL-HOLD-AREA.
  9304     MOVE AM-NAME            TO  REC-TEXT (1) WS-LABEL-LINES (1).
  9305     MOVE AM-PERSON          TO  REC-TEXT (2) WS-LABEL-LINES (2).
  9306     MOVE AM-ADDRS           TO  REC-TEXT (3) WS-LABEL-LINES (3).
  9307*    MOVE AM-CITY            TO  REC-TEXT (4) WS-LABEL-LINES (4).
  9308     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE DELIMITED BY '  '
  9309        INTO WS-LABEL-LINES (4)
  9310     END-STRING
  9311     MOVE WS-LABEL-LINES (4)     TO REC-TEXT (4)
  9312     MOVE SPACES             TO  REC-TEXT (5) WS-LABEL-LINES (5).
  9313
  9314     MOVE SPACES             TO  WS-ZIP-CODE.
  9315
  9316     IF AM-CANADIAN-POST-CODE
  9317         MOVE AM-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
  9318         MOVE AM-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
  9319     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 185
* EL152.cbl
  9320         MOVE AM-ZIP-PRIME       TO  WS-AM-ZIP-CODE
  9321         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9322             MOVE '-'            TO  WS-AM-ZIP-DASH
  9323             MOVE AM-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
  9324
  9325     MOVE WS-ZIP-CODE        TO  REC-TEXT (6) WS-LABEL-LINES (6).
  9326
  9327     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
  9328
  9329     MOVE WS-LABEL-LINES (1) TO  REC-TEXT (1)    SS05-1D.
  9330     MOVE WS-LABEL-LINES (2) TO  REC-TEXT (2)    SS05-2D.
  9331     MOVE WS-LABEL-LINES (3) TO  REC-TEXT (3)    SS05-3D.
  9332     MOVE WS-LABEL-LINES (4) TO  REC-TEXT (4)    SS05-4D.
  9333     MOVE WS-LABEL-LINES (5) TO  REC-TEXT (5)    SS05-5D.
  9334     MOVE WS-LABEL-LINES (6) TO  REC-TEXT (6)    SS05-6D.
  9335
  9336     GO TO 7099-EXIT.
  9337
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 186
* EL152.cbl
  9339*7040-READ-PRODUCER. Remove as dead code
  9340*7050-READNEXT. Remove as dead code
  9341*7060-CONTINUE-BUILD-ADDR. Remove as dead code
  9342 7067-CHECK-BENE-ADDR.
  9343
  9344*    IF PI-COMPANY-ID = 'DMD'
  9345*        IF WS-ADDR-TYPE-CD = 'B9'
  9346*            GO TO 7067-CHECK-BENE-ADDR-9.
  9347
  9348     IF WS-ADDR-TYPE-CD NOT = 'B0'
  9349         GO TO 7068-CONTINUE-BUILD-ADDR.
  9350
  9351     IF CL-BENEFICIARY = SPACES
  9352         GO TO 7070-ACTV-NOT-FOUND.
  9353
  9354
  9355* EXEC CICS HANDLE CONDITION
  9356*         NOTFND     (7070-ACTV-NOT-FOUND)
  9357*    END-EXEC.
  9358*    MOVE '"$I                   ! . #00008861' TO DFHEIV0
  9359     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9360     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9361     MOVE X'2E20233030303038383631' TO DFHEIV0(25:11)
  9362     CALL 'kxdfhei1' USING DFHEIV0
  9363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9364
  9365
  9366     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
  9367     MOVE 'B'                    TO BENE-REC-TYPE.
  9368     MOVE CL-BENEFICIARY         TO BENE-NUMBER.
  9369
  9370
  9371* EXEC CICS READ
  9372*         DATASET    (BENE-ID)
  9373*         SET        (ADDRESS OF BENEFICIARY-MASTER)
  9374*         RIDFLD     (BENE-KEY)
  9375*    END-EXEC.
  9376*    MOVE '&"S        E          (   #00008869' TO DFHEIV0
  9377     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9378     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9379     MOVE X'2020233030303038383639' TO DFHEIV0(25:11)
  9380     CALL 'kxdfhei1' USING DFHEIV0,
  9381           BENE-ID,
  9382           DFHEIV20,
  9383           DFHEIV99,
  9384           BENE-KEY,
  9385           DFHEIV99,
  9386           DFHEIV99,
  9387           DFHEIV99
  9388     SET ADDRESS OF BENEFICIARY-MASTER TO
  9389         DFHEIV20
  9390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9391
  9392
  9393     MOVE SPACES              TO  WS-LABEL-HOLD-AREA.
  9394     MOVE BE-MAIL-TO-NAME     TO  REC-TEXT (1) WS-LABEL-LINES (1).
  9395     MOVE BE-ADDRESS-LINE-1   TO  REC-TEXT (2) WS-LABEL-LINES (2).
  9396     MOVE BE-ADDRESS-LINE-2   TO  REC-TEXT (3) WS-LABEL-LINES (3).
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 187
* EL152.cbl
  9397     MOVE BE-ADDRESS-LINE-3   TO  REC-TEXT (4) WS-LABEL-LINES (4).
  9398*    MOVE BE-CITY-STATE       TO  REC-TEXT (5) WS-LABEL-LINES (5).
  9399     STRING BE-CITY ' ' BE-STATE DELIMITED BY '  '
  9400        INTO WS-LABEL-LINES (5)
  9401     END-STRING
  9402     MOVE WS-LABEL-LINES (5)     TO REC-TEXT (5)
  9403
  9404     MOVE SPACES              TO  WS-ZIP-CODE.
  9405     IF BE-CANADIAN-POST-CODE
  9406         MOVE BE-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
  9407         MOVE BE-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
  9408     ELSE
  9409         MOVE BE-ZIP-PRIME       TO  WS-AM-ZIP-CODE
  9410         IF BE-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9411             MOVE '-'            TO  WS-AM-ZIP-DASH
  9412             MOVE BE-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
  9413
  9414     MOVE WS-ZIP-CODE         TO  REC-TEXT (6) WS-LABEL-LINES (6).
  9415
  9416     GO TO 7069-SET-ADDR.
  9417
  9418 7067-CHECK-BENE-ADDR-9.
  9419
  9420     IF CL-BENEFICIARY = SPACES
  9421         GO TO 7070-ACTV-NOT-FOUND.
  9422
  9423
  9424* EXEC CICS HANDLE CONDITION
  9425*         NOTFND     (7070-ACTV-NOT-FOUND)
  9426*    END-EXEC.
  9427*    MOVE '"$I                   ! / #00008905' TO DFHEIV0
  9428     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9429     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9430     MOVE X'2F20233030303038393035' TO DFHEIV0(25:11)
  9431     CALL 'kxdfhei1' USING DFHEIV0
  9432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9433
  9434
  9435     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
  9436     MOVE 'B'                    TO BENE-REC-TYPE.
  9437     MOVE CL-BENEFICIARY         TO BENE-NUMBER.
  9438
  9439
  9440* EXEC CICS READ
  9441*         DATASET    (BENE-ID)
  9442*         SET        (ADDRESS OF BENEFICIARY-MASTER)
  9443*         RIDFLD     (BENE-KEY)
  9444*    END-EXEC.
  9445*    MOVE '&"S        E          (   #00008913' TO DFHEIV0
  9446     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9447     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9448     MOVE X'2020233030303038393133' TO DFHEIV0(25:11)
  9449     CALL 'kxdfhei1' USING DFHEIV0,
  9450           BENE-ID,
  9451           DFHEIV20,
  9452           DFHEIV99,
  9453           BENE-KEY,
  9454           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 188
* EL152.cbl
  9455           DFHEIV99,
  9456           DFHEIV99
  9457     SET ADDRESS OF BENEFICIARY-MASTER TO
  9458         DFHEIV20
  9459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9460
  9461
  9462     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
  9463     MOVE BE-MAIL-TO-NAME2       TO REC-TEXT (1)
  9464                                    WS-LABEL-LINES (1).
  9465     MOVE BE-ADDRESS-LINE-12     TO REC-TEXT (2)
  9466                                    WS-LABEL-LINES (2).
  9467     MOVE BE-ADDRESS-LINE-22     TO REC-TEXT (3)
  9468                                    WS-LABEL-LINES (3).
  9469     MOVE BE-ADDRESS-LINE-32     TO REC-TEXT (4)
  9470                                    WS-LABEL-LINES (4).
  9471*    MOVE BE-CITY-STATE2         TO REC-TEXT (5)
  9472*                                   WS-LABEL-LINES (5).
  9473     STRING BE-CITY2 ' ' BE-STATE2 DELIMITED BY '  '
  9474        INTO WS-LABEL-LINES (5)
  9475     END-STRING
  9476     MOVE WS-LABEL-LINES (5)     TO REC-TEXT (5)
  9477
  9478     MOVE SPACES                 TO WS-ZIP-CODE.
  9479
  9480     IF BE-CANADIAN-POST-CODE2
  9481         MOVE BE-CAN-POSTAL-12   TO WS-CAN-POSTAL-1
  9482         MOVE BE-CAN-POSTAL-22   TO WS-CAN-POSTAL-2
  9483     ELSE
  9484         MOVE BE-ZIP-PRIME2      TO WS-AM-ZIP-CODE
  9485         IF BE-ZIP-PLUS42 NOT = SPACES AND ZEROS
  9486             MOVE '-'            TO WS-AM-ZIP-DASH
  9487             MOVE BE-ZIP-PLUS42  TO WS-AM-ZIP-PLUS4.
  9488
  9489     MOVE WS-ZIP-CODE            TO REC-TEXT (6)
  9490                                    WS-LABEL-LINES (6).
  9491
  9492     GO TO 7069-SET-ADDR.
  9493
  9494 7068-CONTINUE-BUILD-ADDR.
  9495
  9496     IF ACTV-SEQ = ZEROS
  9497        GO TO 7070-ACTV-NOT-FOUND.
  9498
  9499     MOVE ACTV-SEQ               TO PI-ADDR-SEQ.
  9500
  9501
  9502* EXEC CICS HANDLE CONDITION
  9503*         NOTOPEN    (8870-ACTV-NOT-OPEN)
  9504*         NOTFND     (7070-ACTV-NOT-FOUND)
  9505*    END-EXEC.
  9506*    MOVE '"$JI                  ! 0 #00008958' TO DFHEIV0
  9507     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9508     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9509     MOVE X'3020233030303038393538' TO DFHEIV0(25:11)
  9510     CALL 'kxdfhei1' USING DFHEIV0
  9511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9512
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 189
* EL152.cbl
  9513
  9514
  9515* EXEC CICS READ
  9516*         DATASET    (ACTV-ID)
  9517*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
  9518*         RIDFLD     (ACTV-KEY)
  9519*    END-EXEC.
  9520*    MOVE '&"S        E          (   #00008963' TO DFHEIV0
  9521     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9522     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9523     MOVE X'2020233030303038393633' TO DFHEIV0(25:11)
  9524     CALL 'kxdfhei1' USING DFHEIV0,
  9525           ACTV-ID,
  9526           DFHEIV20,
  9527           DFHEIV99,
  9528           ACTV-KEY,
  9529           DFHEIV99,
  9530           DFHEIV99,
  9531           DFHEIV99
  9532     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9533         DFHEIV20
  9534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9535
  9536
  9537     MOVE SPACES            TO              WS-LABEL-HOLD-AREA.
  9538     MOVE AT-MAIL-TO-NAME   TO REC-TEXT (1) WS-LABEL-LINES (1).
  9539     MOVE AT-ADDRESS-LINE-1 TO REC-TEXT (2) WS-LABEL-LINES (2).
  9540     MOVE AT-ADDRESS-LINE-2 TO REC-TEXT (3) WS-LABEL-LINES (3).
  9541*    MOVE AT-CITY-STATE     TO REC-TEXT (4) WS-LABEL-LINES (4).
  9542     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
  9543        INTO WS-LABEL-LINES (4)
  9544     END-STRING
  9545     MOVE WS-LABEL-LINES (4)     TO REC-TEXT (4)
  9546
  9547     MOVE SPACES            TO  WS-ZIP-CODE.
  9548     IF AT-CANADIAN-POST-CODE
  9549         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
  9550         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
  9551     ELSE
  9552         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
  9553         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9554             MOVE '-'            TO  WS-AM-ZIP-DASH
  9555             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
  9556
  9557     MOVE WS-ZIP-CODE       TO  REC-TEXT (5) WS-LABEL-LINES (5).
  9558
  9559     MOVE SPACES            TO  REC-TEXT (6).
  9560
  9561 7069-SET-ADDR.
  9562     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
  9563
  9564     MOVE WS-LABEL-LINES (1) TO  REC-TEXT (1)    SS05-1D.
  9565     MOVE WS-LABEL-LINES (2) TO  REC-TEXT (2)    SS05-2D.
  9566     MOVE WS-LABEL-LINES (3) TO  REC-TEXT (3)    SS05-3D.
  9567     MOVE WS-LABEL-LINES (4) TO  REC-TEXT (4)    SS05-4D.
  9568     MOVE WS-LABEL-LINES (5) TO  REC-TEXT (5)    SS05-5D.
  9569     MOVE SPACES             TO  REC-TEXT (6)    SS05-6D.
  9570
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 190
* EL152.cbl
  9571     GO TO 7099-EXIT.
  9572
  9573 7070-ACTV-NOT-FOUND.
  9574
  9575     IF ACTV-SEQ NOT = +29
  9576        GO TO 7075-CONTINUE-ACTV-ERROR.
  9577
  9578*    IF CL-SYSTEM-IDENTIFIER = 'CV'
  9579*        GO TO 7099-EXIT.
  9580
  9581     IF AM-3RD-PARTY-NOTIF-LEVEL NOT NUMERIC
  9582        MOVE ZEROS         TO AM-3RD-PARTY-NOTIF-LEVEL
  9583        GO TO 7075-CONTINUE-ACTV-ERROR.
  9584
  9585     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = SPACES OR ZEROS
  9586        GO TO 7075-CONTINUE-ACTV-ERROR.
  9587
  9588     MOVE PI-COMPANY-CD   TO WS-ERCOMP-COMPANY-CD
  9589     MOVE AM-CARRIER      TO WS-ERCOMP-CARRIER
  9590     MOVE AM-GROUPING     TO WS-ERCOMP-GROUPING
  9591     MOVE 'A'             TO WS-ERCOMP-TYPE
  9592     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
  9593                          TO WS-ERCOMP-RESP-NO.
  9594
  9595     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
  9596         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
  9597                                       'G' OR 'B'
  9598             MOVE 'G'            TO WS-ERCOMP-TYPE
  9599             MOVE LOW-VALUES     TO WS-ERCOMP-ACCOUNT
  9600         ELSE
  9601             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
  9602                                 TO WS-ERCOMP-ACCOUNT
  9603     ELSE
  9604         MOVE 'G'                TO WS-ERCOMP-TYPE
  9605         MOVE LOW-VALUES         TO WS-ERCOMP-ACCOUNT.
  9606
  9607     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  9608        MOVE ZEROS TO WS-ERCOMP-CARRIER.
  9609
  9610     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  9611        MOVE ZEROS TO WS-ERCOMP-GROUPING.
  9612
  9613
  9614* EXEC CICS HANDLE CONDITION
  9615*         NOTFND    (7075-CONTINUE-ACTV-ERROR)
  9616*    END-EXEC.
  9617*    MOVE '"$I                   ! 1 #00009045' TO DFHEIV0
  9618     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9619     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9620     MOVE X'3120233030303039303435' TO DFHEIV0(25:11)
  9621     CALL 'kxdfhei1' USING DFHEIV0
  9622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9623
  9624
  9625
  9626* EXEC CICS  READ
  9627*         SET      (ADDRESS OF COMPENSATION-MASTER)
  9628*         DATASET  ('ERCOMP')
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 191
* EL152.cbl
  9629*         RIDFLD   (WS-ERCOMP-KEY)
  9630*    END-EXEC.
  9631     MOVE 'ERCOMP' TO DFHEIV1
  9632*    MOVE '&"S        E          (   #00009049' TO DFHEIV0
  9633     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9634     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9635     MOVE X'2020233030303039303439' TO DFHEIV0(25:11)
  9636     CALL 'kxdfhei1' USING DFHEIV0,
  9637           DFHEIV1,
  9638           DFHEIV20,
  9639           DFHEIV99,
  9640           WS-ERCOMP-KEY,
  9641           DFHEIV99,
  9642           DFHEIV99,
  9643           DFHEIV99
  9644     SET ADDRESS OF COMPENSATION-MASTER TO
  9645         DFHEIV20
  9646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9647
  9648
  9649     MOVE 'Y'                   TO WS-COMP-READ-SW.
  9650     MOVE SPACES                TO WS-LABEL-HOLD-AREA.
  9651     MOVE CO-ACCT-NAME          TO WS-LABEL-LINES (1).
  9652
  9653     IF CO-ACCT-NAME = SPACES
  9654        MOVE CO-MAIL-NAME       TO WS-LABEL-LINES (1).
  9655
  9656     MOVE CO-ADDR-1             TO WS-LABEL-LINES (2).
  9657     MOVE CO-ADDR-2             TO WS-LABEL-LINES (3).
  9658     MOVE CO-ADDR-3             TO WS-LABEL-LINES (4).
  9659
  9660     MOVE SPACES                TO  WS-ZIP-CODE.
  9661     IF CO-CANADIAN-POST-CODE
  9662         MOVE CO-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
  9663         MOVE CO-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
  9664     ELSE
  9665         MOVE CO-ZIP-PRIME      TO  WS-AM-ZIP-CODE
  9666         IF CO-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9667             MOVE '-'           TO  WS-AM-ZIP-DASH
  9668             MOVE CO-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
  9669
  9670     MOVE WS-ZIP-CODE           TO  WS-LABEL-LINES (5).
  9671
  9672     MOVE ZEROS                 TO WS-PHONE-IN.
  9673     MOVE CO-AREA-CODE          TO WSPO-AREA.
  9674     MOVE CO-PREFIX             TO WSPO-PFX.
  9675     MOVE CO-PHONE              TO WSPO-SFX.
  9676     MOVE WS-PHONE-OUT          TO SS53-6D.
  9677
  9678     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
  9679
  9680     MOVE WS-LABEL-LINES (1)     TO REC-TEXT (1)    SS52D.
  9681     MOVE WS-LABEL-LINES (2)     TO REC-TEXT (2)    SS53-1D.
  9682     MOVE WS-LABEL-LINES (3)     TO REC-TEXT (3)    SS53-2D.
  9683     MOVE WS-LABEL-LINES (4)     TO REC-TEXT (4)    SS53-3D.
  9684     MOVE WS-LABEL-LINES (5)     TO REC-TEXT (5)    SS53-4D.
  9685     MOVE WS-LABEL-LINES (6)     TO REC-TEXT (6)    SS53-5D.
  9686
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 192
* EL152.cbl
  9687     GO TO 7099-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 193
* EL152.cbl
  9689
  9690 7075-CONTINUE-ACTV-ERROR.
  9691     MOVE ER-0178                TO EMI-ERROR.
  9692     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9693     MOVE -1                     TO ADDRL.
  9694     MOVE AL-UABON               TO ADDRA.
  9695     MOVE SPACES                 TO PI-ADDR-TYPE.
  9696     MOVE SPACES                 TO REC-TEXT (1)
  9697                                    REC-TEXT (2)
  9698                                    REC-TEXT (3)
  9699                                    REC-TEXT (4)
  9700                                    REC-TEXT (5)
  9701                                    REC-TEXT (6).
  9702     GO TO 7099-EXIT.
  9703
  9704 7080-ACCT-NOT-FOUND.
  9705     MOVE ER-0179                TO EMI-ERROR.
  9706     MOVE -1                     TO ADDRL.
  9707     MOVE AL-UABON               TO ADDRA.
  9708     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9709     GO TO 8200-SEND-DATAONLY.
  9710
  9711 7090-CLAIM-NOT-FOUND.
  9712     MOVE ER-0186                TO EMI-ERROR.
  9713     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9714     GO TO 8200-SEND-DATAONLY.
  9715
  9716*7095-PROD-NOT-FOUND. Remove as dead code
  9717
  9718 7099-EXIT.
  9719      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 194
* EL152.cbl
  9721
  9722 7170-FORMAT-SCREEN.
  9723     IF MAINTI = 'S'
  9724        MOVE AL-PANOF            TO SC-TEXTA (SC-INDX)
  9725       ELSE
  9726        MOVE AL-UANOF            TO SC-TEXTA (SC-INDX).
  9727
  9728     IF TB-INDX < 7
  9729        SET LINE23 TO TB-INDX
  9730        MOVE 'A'                 TO LINE1
  9731       ELSE
  9732        IF TB-INDX = 7
  9733           MOVE ZEROS            TO LINE-NUM
  9734        ELSE
  9735           SET LIN-NUM TO TB-INDX
  9736           SUBTRACT 7            FROM LIN-NUM.
  9737
  9738     MOVE LINE-NUM               TO SC-LINE (SC-INDX).
  9739     MOVE REC-TEXT (TB-INDX)     TO SC-TEXT (SC-INDX).
  9740     SET TB-INDX UP BY 1.
  9741
  9742 7170-EXIT.
  9743      EXIT.
  9744
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 195
* EL152.cbl
  9746 7200-RESOLVE-VARIABLES.
  9747***************************************************************
  9748*    THIS ROUTINE WILL FORMAT THE SYSTEM-DEFINED SYMBOLS      *
  9749*    WITH DATA PERTAINING TO THE DESIGNATED CLAIM.            *
  9750*    THIS ROUTINE IS PERFORMED THRU 7269-EXIT TO              *
  9751*    RESOLVE ALL OF THE SYMBOLS.                              *
  9752***************************************************************
  9753
  9754*    IF PI-COMPANY-ID = 'AUK'
  9755*        MOVE 'Y'                TO W-REVERSE-DATE-SW.
  9756
  9757     MOVE PI-CLAIM-NO            TO SS34D.
  9758
  9759     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9760        MOVE PI-LIFE-OVERRIDE-L6 TO SS12D
  9761     ELSE
  9762        MOVE PI-AH-OVERRIDE-L6   TO SS12D.
  9763
  9764     MOVE CL-LAST-PMT-AMT        TO SS16D.
  9765     MOVE CL-TOTAL-PAID-AMT      TO SS18D.
  9766     MOVE CL-CAUSE-CD            TO SS19-1D.
  9767     MOVE CL-ASSOC-CERT-SEQU     TO SS54D.
  9768     MOVE CL-ASSOC-CERT-TOTAL    TO SS55D.
  9769
  9770*    IF PI-COMPANY-ID NOT = 'DMD'
  9771*        GO TO 7200-CONTINUE.
  9772
  9773     IF CL-CCN-PREFIX-A5 = '1111' OR '3333' OR '6666' OR
  9774                           '8888' OR '9876'
  9775         MOVE CL-CCN-PRIME-A5    TO WS-CCN-12
  9776         MOVE WS-CCN-12          TO CL-CCN.
  9777
  9778     IF CL-CERT-STATE NOT = '08' AND '09'
  9779         MOVE SPACES             TO SS62D
  9780                                    SS63D
  9781         GO TO 7200-CONTINUE.
  9782
  9783     MOVE WS-DMD-UND-STATEMENT   TO SS62D.
  9784
  9785     MOVE 'CL'                   TO DL23-SYSTEM-ID.
  9786     MOVE 'UN'                   TO DL23-RECORD-TYPE.
  9787     MOVE CL-CERT-STATE          TO DL23-RECORD-KEY.
  9788
  9789
  9790* EXEC CICS LINK
  9791*        PROGRAM    ('DLO023')
  9792*        COMMAREA   (WS-DLO-CODES-TABLE)
  9793*        LENGTH     (DL23-COMM-LENGTH)
  9794*    END-EXEC.
  9795     MOVE 'DLO023' TO DFHEIV1
  9796*    MOVE '."C                   ''   #00009195' TO DFHEIV0
  9797     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9798     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9799     MOVE X'2020233030303039313935' TO DFHEIV0(25:11)
  9800     CALL 'kxdfhei1' USING DFHEIV0,
  9801           DFHEIV1,
  9802           WS-DLO-CODES-TABLE,
  9803           DL23-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 196
* EL152.cbl
  9804           DFHEIV99,
  9805           DFHEIV99,
  9806           DFHEIV99
  9807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9808
  9809
  9810     IF DL23-RETURN-CODE = 'OK'
  9811         MOVE DL23-CODE-DESC     TO SS63D
  9812       ELSE
  9813         MOVE SPACES             TO SS63D.
  9814
  9815 7200-CONTINUE.
  9816     MOVE CL-CCN                 TO SS60D.
  9817
  9818     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
  9819     MOVE SPACES                 TO DC-OPTION-CODE.
  9820     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  9821     IF NO-CONVERSION-ERROR
  9822        MOVE DC-GREG-DATE-1-EDIT TO SS13D.
  9823
  9824     MOVE CL-REPORTED-DT         TO DC-BIN-DATE-1.
  9825     MOVE SPACES                 TO DC-OPTION-CODE.
  9826     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  9827     IF NO-CONVERSION-ERROR
  9828        MOVE DC-GREG-DATE-1-EDIT TO SS14D.
  9829
  9830     MOVE CL-LAST-PMT-DT         TO DC-BIN-DATE-1.
  9831     MOVE SPACES                 TO DC-OPTION-CODE.
  9832     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  9833     IF NO-CONVERSION-ERROR
  9834        MOVE DC-GREG-DATE-1-EDIT TO SS15D.
  9835
  9836     IF NOT PI-USES-PAID-TO
  9837        MOVE CL-PAID-THRU-DT        TO DC-BIN-DATE-1
  9838        MOVE SPACES                 TO DC-OPTION-CODE
  9839        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  9840        IF NO-CONVERSION-ERROR
  9841           MOVE DC-GREG-DATE-1-EDIT TO SS17D
  9842        ELSE
  9843           MOVE SPACES TO SS17D
  9844     ELSE
  9845        MOVE CL-PAID-THRU-DT        TO DC-BIN-DATE-1
  9846        MOVE '6'                    TO DC-OPTION-CODE
  9847        MOVE +1                     TO DC-ELAPSED-DAYS
  9848        MOVE +0                     TO DC-ELAPSED-MONTHS
  9849        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  9850        IF NO-CONVERSION-ERROR
  9851           MOVE DC-GREG-DATE-1-EDIT TO SS17D.
  9852
  9853     MOVE CL-INSURED-BIRTH-DT    TO DC-BIN-DATE-1.
  9854     MOVE SPACES                 TO DC-OPTION-CODE.
  9855     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  9856     IF NO-CONVERSION-ERROR
  9857        MOVE DC-GREG-DATE-1-EDIT TO SS45D
  9858     ELSE
  9859        MOVE '@@DOB'             TO SS45D.
  9860
  9861     IF CL-SSN-STATE   = CL-CERT-STATE  AND
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 197
* EL152.cbl
  9862        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
  9863             NEXT SENTENCE
  9864         ELSE
  9865             MOVE CL-SOC-SEC-NO  TO SS46D.
  9866
  9867     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
  9868                                    ACCT-GROUPING
  9869                                    PROD-GROUPING
  9870                                    PLCY-GROUPING
  9871                                    PLAN-GROUPING.
  9872     MOVE CL-CERT-STATE          TO CERT-STATE
  9873                                    ACCT-STATE
  9874                                    PROD-STATE
  9875                                    PLCY-STATE
  9876                                    PLAN-STATE.
  9877     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  9878                                    ACCT-ACCOUNT
  9879                                    PROD-PRODUCER
  9880                                    PLCY-PRODUCER
  9881                                    PLAN-PRODUCER.
  9882     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT
  9883                                    PLCY-EFF-DT.
  9884     MOVE CL-CV-REFERENCE-NO     TO PLCY-REFERENCE-NO.
  9885
  9886     PERFORM 5000-MOVE-NAME THRU 5000-EXIT.
  9887
  9888*    IF PI-COMPANY-ID = 'DMD'
  9889*       MOVE WS-NAME-WORK           TO SS10D
  9890*       GO TO 7200-CONTINUE-2.
  9891
  9892     IF LOWER-CASE-LETTERS-USED
  9893        MOVE 'N'                    TO WS-STATE-LINE
  9894        MOVE WS-NAME-WORK           TO WS-TEMP-AREA2
  9895        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
  9896        MOVE WS-TEMP-AREA2          TO SS10D
  9897     ELSE
  9898        MOVE WS-NAME-WORK           TO SS10D.
  9899
  9900 7200-CONTINUE-2.
  9901     MOVE CL-INSURED-1ST-NAME     TO W-FIRST-NAME.
  9902     MOVE CL-INSURED-LAST-NAME    TO W-LAST-NAME.
  9903     MOVE CL-INSURED-MID-INIT     TO W-MIDDLE-NAME.
  9904     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
  9905
  9906     IF LOWER-CASE-LETTERS-USED
  9907        MOVE 'N'                    TO WS-STATE-LINE
  9908        MOVE WS-NAME-WORK           TO WS-TEMP-AREA2
  9909        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
  9910        MOVE WS-TEMP-AREA2          TO SS39D
  9911     ELSE
  9912        MOVE WS-NAME-WORK           TO SS39D.
  9913
  9914     MOVE CL-INSURED-LAST-NAME   TO SS40D.
  9915
  9916     IF INSURED-IS-FEMALE
  9917        MOVE 'MS.'               TO SS41D
  9918       ELSE
  9919        MOVE 'MR.'               TO SS41D.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 198
* EL152.cbl
  9920
  9921*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9922*        PERFORM 7290-RESOLVE-CREDITOR THRU 7290-EXIT.
  9923
  9924*    IF CL-SYSTEM-IDENTIFIER = 'CV'
  9925*        GO TO 7200-READ-EMPLCY.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 199
* EL152.cbl
  9927
  9928* EXEC CICS HANDLE CONDITION
  9929*         NOTOPEN   (8900-CERT-NOT-OPEN)
  9930*         NOTFND    (8910-CERT-NOT-FOUND)
  9931*    END-EXEC.
  9932*    MOVE '"$JI                  ! 2 #00009318' TO DFHEIV0
  9933     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9934     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9935     MOVE X'3220233030303039333138' TO DFHEIV0(25:11)
  9936     CALL 'kxdfhei1' USING DFHEIV0
  9937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9938
  9939
  9940
  9941* EXEC CICS READ
  9942*         DATASET   (CERT-ID)
  9943*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9944*         RIDFLD    (CERT-KEY)
  9945*    END-EXEC.
  9946*    MOVE '&"S        E          (   #00009323' TO DFHEIV0
  9947     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9948     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9949     MOVE X'2020233030303039333233' TO DFHEIV0(25:11)
  9950     CALL 'kxdfhei1' USING DFHEIV0,
  9951           CERT-ID,
  9952           DFHEIV20,
  9953           DFHEIV99,
  9954           CERT-KEY,
  9955           DFHEIV99,
  9956           DFHEIV99,
  9957           DFHEIV99
  9958     SET ADDRESS OF CERTIFICATE-MASTER TO
  9959         DFHEIV20
  9960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9961
  9962
  9963*    IF PI-COMPANY-ID = 'DMD'
  9964*        MOVE CM-RESIDENT-STATE  TO WS-DMD-RES-ST
  9965*        IF CM-POLICY-FORM-NO(6:1) = '1'
  9966*            MOVE WS-DMD-UND-COMPANYA    TO SS64D
  9967*          ELSE
  9968*        IF CM-POLICY-FORM-NO(6:1) = '2'
  9969*            MOVE WS-DMD-UND-COMPANYB    TO SS64D
  9970*          ELSE
  9971*            MOVE SPACES                 TO SS64D.
  9972
  9973     MOVE CM-CERT-NO             TO SS26D.
  9974     MOVE CM-INSURED-ISSUE-AGE   TO SS33D.
  9975
  9976*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9977*        MOVE CL-CURRENT-CARRIER TO SS23D
  9978*        MOVE CL-CURRENT-GROUPING
  9979*                                TO SS24D
  9980*        MOVE CL-CURRENT-ACCOUNT TO SS25D
  9981*        MOVE CM-MEMBER-NO       TO SS36D
  9982*        MOVE CM-GROUPING        TO W-GROUPING
  9983*        IF W-GROUP-3 = 'C01' OR 'C02'
  9984*            MOVE CM-MEMBER-NO   TO W-CURRENT-LOAN-NO
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 200
* EL152.cbl
  9985*            MOVE CM-LOAN-NUMBER TO W-LOAN-NO
  9986*            MOVE W-CREDIT-CARD-LOAN-NO
  9987*                                TO SS36-1D
  9988*        ELSE
  9989*            MOVE CM-MEMBER-NO   TO SS36-1D
  9990*    ELSE
  9991         MOVE CM-CARRIER         TO SS23D.
  9992         MOVE CM-GROUPING        TO SS24D.
  9993         MOVE CM-ACCOUNT         TO SS25D.
  9994         MOVE CM-LOAN-NUMBER     TO SS36D.
  9995
  9996     MOVE CM-LOAN-BALANCE        TO SS37D.
  9997     MOVE CM-MEMBER-NO           TO SS38D.
  9998
  9999     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 10000     MOVE SPACES                 TO DC-OPTION-CODE.
 10001     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
 10002     IF NO-CONVERSION-ERROR
 10003        MOVE DC-GREG-DATE-1-EDIT TO SS27D.
 10004
 10005     MOVE CM-INSURED-FIRST-NAME  TO W-FIRST-NAME.
 10006     MOVE CM-INSURED-LAST-NAME   TO W-LAST-NAME.
 10007     MOVE CM-INSURED-INITIAL2    TO W-MIDDLE-NAME.
 10008     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
 10009
 10010     IF LOWER-CASE-LETTERS-USED
 10011         MOVE 'N'                TO WS-STATE-LINE
 10012         MOVE WS-NAME-WORK       TO WS-TEMP-AREA2
 10013         PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 10014         MOVE WS-TEMP-AREA2      TO SS57D
 10015     ELSE
 10016         MOVE WS-NAME-WORK       TO SS57D.
 10017
 10018     MOVE CM-JT-FIRST-NAME       TO W-FIRST-NAME.
 10019     MOVE CM-JT-LAST-NAME        TO W-LAST-NAME.
 10020     MOVE CM-JT-INITIAL          TO W-MIDDLE-NAME.
 10021     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
 10022
 10023     IF LOWER-CASE-LETTERS-USED
 10024         MOVE 'N'                TO WS-STATE-LINE
 10025         MOVE WS-NAME-WORK       TO WS-TEMP-AREA2
 10026         PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 10027         MOVE WS-TEMP-AREA2      TO SS58D
 10028     ELSE
 10029         MOVE WS-NAME-WORK       TO SS58D.
 10030
 10031     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10032        MOVE CM-LF-BENEFIT-CD    TO BEN-HOLD
 10033        MOVE CM-LF-ORIG-TERM     TO SS29D
 10034        MOVE CM-LF-BENEFIT-AMT   TO SS30D
 10035        MOVE CM-POLICY-FORM-NO   TO SS32D
 10036        MOVE CM-LF-CANCEL-DT     TO DC-BIN-DATE-1
 10037     ELSE
 10038        MOVE CM-AH-BENEFIT-CD    TO BEN-HOLD
 10039        MOVE CM-AH-ORIG-TERM     TO SS29D
 10040        MOVE CM-AH-BENEFIT-AMT   TO SS30D
 10041        MOVE CM-POLICY-FORM-NO   TO SS32D
 10042        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 201
* EL152.cbl
 10043
 10044     COMPUTE WORK-AMOUNT = CM-AH-ORIG-TERM * CM-AH-BENEFIT-AMT.
 10045
 10046     MOVE WORK-AMOUNT            TO SS51D.
 10047
 10048     MOVE SPACES                 TO DC-OPTION-CODE.
 10049     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
 10050     IF NO-CONVERSION-ERROR
 10051        MOVE DC-GREG-DATE-1-EDIT TO SS31D.
 10052
 10053     MOVE ' '                         TO  DC-OPTION-CODE.
 10054     MOVE +0                          TO  DC-ELAPSED-MONTHS
 10055                                          DC-ELAPSED-DAYS.
 10056
 10057     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10058         MOVE CM-LF-LOAN-EXPIRE-DT    TO  DC-BIN-DATE-1
 10059         PERFORM 9700-DATE-LINK THRU 9700-EXIT
 10060         IF NO-CONVERSION-ERROR
 10061             MOVE DC-GREG-DATE-1-EDIT TO  SS28D
 10062         ELSE
 10063             NEXT SENTENCE
 10064     ELSE
 10065         MOVE CM-AH-LOAN-EXPIRE-DT    TO  DC-BIN-DATE-1
 10066         PERFORM 9700-DATE-LINK THRU 9700-EXIT
 10067         IF NO-CONVERSION-ERROR
 10068             MOVE DC-GREG-DATE-1-EDIT TO  SS28D.
 10069
 10070*    GO TO 7200-READ-DIAGNOSIS.
 10071
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 202
* EL152.cbl
 10073*7200-READ-EMPLCY. Remove as dead code
 10074 7200-READ-DIAGNOSIS.
 10075
 10076* EXEC CICS HANDLE CONDITION
 10077*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10078*         NOTFND     (7200-READ-LOAN-NUMBER)
 10079*    END-EXEC.
 10080*    MOVE '"$JI                  ! 3 #00009441' TO DFHEIV0
 10081     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10082     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10083     MOVE X'3320233030303039343431' TO DFHEIV0(25:11)
 10084     CALL 'kxdfhei1' USING DFHEIV0
 10085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10086
 10087
 10088     MOVE CL-CONTROL-PRIMARY    TO ACTV-KEY.
 10089     MOVE +90                   TO ACTV-SEQ.
 10090
 10091
 10092* EXEC CICS READ
 10093*         DATASET  (ACTV-ID)
 10094*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10095*         RIDFLD   (ACTV-KEY)
 10096*    END-EXEC.
 10097*    MOVE '&"S        E          (   #00009449' TO DFHEIV0
 10098     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10099     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10100     MOVE X'2020233030303039343439' TO DFHEIV0(25:11)
 10101     CALL 'kxdfhei1' USING DFHEIV0,
 10102           ACTV-ID,
 10103           DFHEIV20,
 10104           DFHEIV99,
 10105           ACTV-KEY,
 10106           DFHEIV99,
 10107           DFHEIV99,
 10108           DFHEIV99
 10109     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10110         DFHEIV20
 10111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10112
 10113
 10114     IF AT-TRAILER-TYPE = '6'
 10115        MOVE AT-INFO-LINE-1         TO SS19D.
 10116
 10117 7200-READ-LOAN-NUMBER.
 10118
 10119
 10120* EXEC CICS HANDLE CONDITION
 10121*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10122*         NOTFND     (7201-READ-BENEFICIARY)
 10123*    END-EXEC.
 10124*    MOVE '"$JI                  ! 4 #00009460' TO DFHEIV0
 10125     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10126     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10127     MOVE X'3420233030303039343630' TO DFHEIV0(25:11)
 10128     CALL 'kxdfhei1' USING DFHEIV0
 10129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10130
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 203
* EL152.cbl
 10131
 10132     MOVE CL-CONTROL-PRIMARY    TO ACTV-KEY.
 10133     MOVE +91                   TO ACTV-SEQ.
 10134
 10135
 10136* EXEC CICS READ
 10137*         DATASET  (ACTV-ID)
 10138*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10139*         RIDFLD   (ACTV-KEY)
 10140*    END-EXEC.
 10141*    MOVE '&"S        E          (   #00009468' TO DFHEIV0
 10142     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10143     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10144     MOVE X'2020233030303039343638' TO DFHEIV0(25:11)
 10145     CALL 'kxdfhei1' USING DFHEIV0,
 10146           ACTV-ID,
 10147           DFHEIV20,
 10148           DFHEIV99,
 10149           ACTV-KEY,
 10150           DFHEIV99,
 10151           DFHEIV99,
 10152           DFHEIV99
 10153     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10154         DFHEIV20
 10155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10156
 10157
 10158     IF AT-TRAILER-TYPE = '6'
 10159        MOVE AT-INFO-LINE-1         TO SS19-2D.
 10160
 10161 7201-READ-BENEFICIARY.
 10162     IF CL-BENIF-ADDR-CNT = +0  AND
 10163        CL-BENEFICIARY = SPACES
 10164          GO TO 7205-READ-PHYSICIAN-ADDR.
 10165
 10166     IF W-BENEFICIARY > ZERO
 10167         COMPUTE ACTV-SEQ = W-BENEFICIARY + 10
 10168     ELSE
 10169         MOVE CL-BENIF-ADDR-CNT  TO ACTV-SEQ
 10170         ADD +10                 TO ACTV-SEQ.
 10171
 10172
 10173* EXEC CICS HANDLE CONDITION
 10174*         NOTOPEN    (7290-BENE-NOT-OPEN)
 10175*         NOTFND     (7205-READ-PHYSICIAN-ADDR)
 10176*    END-EXEC.
 10177*    MOVE '"$JI                  ! 5 #00009488' TO DFHEIV0
 10178     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10179     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10180     MOVE X'3520233030303039343838' TO DFHEIV0(25:11)
 10181     CALL 'kxdfhei1' USING DFHEIV0
 10182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10183
 10184
 10185     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10186
 10187     IF ACTV-SEQ = +19
 10188         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 204
* EL152.cbl
 10189     ELSE
 10190         IF ACTV-SEQ NOT = +10
 10191             GO TO 7202-GET-FROM-ACTIVITY.
 10192
 10193     MOVE PI-COMPANY-CD        TO BENE-COMP-CD.
 10194     MOVE 'B'                  TO BENE-REC-TYPE.
 10195     MOVE CL-BENEFICIARY       TO BENE-NUMBER.
 10196
 10197
 10198* EXEC CICS READ
 10199*         DATASET    (BENE-ID)
 10200*         SET        (ADDRESS OF BENEFICIARY-MASTER)
 10201*         RIDFLD     (BENE-KEY)
 10202*    END-EXEC.
 10203*    MOVE '&"S        E          (   #00009505' TO DFHEIV0
 10204     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10205     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10206     MOVE X'2020233030303039353035' TO DFHEIV0(25:11)
 10207     CALL 'kxdfhei1' USING DFHEIV0,
 10208           BENE-ID,
 10209           DFHEIV20,
 10210           DFHEIV99,
 10211           BENE-KEY,
 10212           DFHEIV99,
 10213           DFHEIV99,
 10214           DFHEIV99
 10215     SET ADDRESS OF BENEFICIARY-MASTER TO
 10216         DFHEIV20
 10217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10218
 10219
 10220*    IF PI-COMPANY-ID = 'DMD'
 10221*        MOVE BE-BSR             TO PI-ELBENE-BSR.
 10222
 10223 7201-CONT.
 10224     MOVE BE-MAIL-TO-NAME2       TO WS-LABEL-LINES (1).
 10225     MOVE BE-ADDRESS-LINE-12     TO WS-LABEL-LINES (2).
 10226     MOVE BE-ADDRESS-LINE-22     TO WS-LABEL-LINES (3).
 10227     MOVE BE-ADDRESS-LINE-32     TO WS-LABEL-LINES (4).
 10228*    MOVE BE-CITY-STATE2         TO WS-LABEL-LINES (5).
 10229     STRING BE-CITY2 ' ' BE-STATE2 DELIMITED BY '  '
 10230        INTO WS-LABEL-LINES (5)
 10231     END-STRING
 10232
 10233     MOVE SPACES                 TO WS-ZIP-CODE.
 10234
 10235     IF BE-CANADIAN-POST-CODE2
 10236         MOVE BE-CAN-POSTAL-12   TO WS-CAN-POSTAL-1
 10237         MOVE BE-CAN-POSTAL-22   TO WS-CAN-POSTAL-2
 10238     ELSE
 10239         MOVE BE-ZIP-PRIME2      TO WS-AM-ZIP-CODE
 10240         IF BE-ZIP-PLUS42 NOT = SPACES AND ZEROS
 10241             MOVE '-'            TO WS-AM-ZIP-DASH
 10242             MOVE BE-ZIP-PLUS42  TO WS-AM-ZIP-PLUS4.
 10243
 10244     MOVE WS-ZIP-CODE            TO WS-LABEL-LINES (6).
 10245
 10246     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 205
* EL152.cbl
 10247
 10248     MOVE WS-LABEL-LINES (1)     TO SS61D.
 10249     MOVE WS-LABEL-LINES (2)     TO SS61-1D.
 10250     MOVE WS-LABEL-LINES (3)     TO SS61-2D.
 10251     MOVE WS-LABEL-LINES (4)     TO SS61-3D.
 10252     MOVE WS-LABEL-LINES (5)     TO SS61-4D.
 10253     MOVE WS-LABEL-LINES (6)     TO SS61-5D.
 10254
 10255     MOVE BE-PHONE-NO2           TO WS-PHONE-IN.
 10256     MOVE WSPI-AREA              TO WSPO-AREA.
 10257     MOVE WSPI-PFX               TO WSPO-PFX.
 10258     MOVE WSPI-SFX               TO WSPO-SFX.
 10259     MOVE WS-PHONE-OUT           TO SS61-6D.
 10260
 10261 7201-CONT-PROCESS.
 10262     MOVE BE-MAIL-TO-NAME      TO  WS-LABEL-LINES (1).
 10263     MOVE BE-ADDRESS-LINE-1    TO  WS-LABEL-LINES (2).
 10264     MOVE BE-ADDRESS-LINE-2    TO  WS-LABEL-LINES (3).
 10265     MOVE BE-ADDRESS-LINE-3    TO  WS-LABEL-LINES (4).
 10266*    MOVE BE-CITY-STATE        TO  WS-LABEL-LINES (5).
 10267     STRING BE-CITY ' ' BE-STATE DELIMITED BY '  '
 10268        INTO WS-LABEL-LINES (5)
 10269     END-STRING
 10270
 10271     MOVE SPACES               TO  WS-ZIP-CODE.
 10272     IF BE-CANADIAN-POST-CODE
 10273         MOVE BE-CAN-POSTAL-1  TO  WS-CAN-POSTAL-1
 10274         MOVE BE-CAN-POSTAL-2  TO  WS-CAN-POSTAL-2
 10275     ELSE
 10276         MOVE BE-ZIP-PRIME     TO  WS-AM-ZIP-CODE
 10277         IF BE-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10278             MOVE '-'          TO  WS-AM-ZIP-DASH
 10279             MOVE BE-ZIP-PLUS4 TO  WS-AM-ZIP-PLUS4.
 10280
 10281     MOVE WS-ZIP-CODE          TO  WS-LABEL-LINES (6).
 10282
 10283     MOVE BE-PHONE-NO          TO  WS-PHONE-IN.
 10284
 10285     GO TO 7204-SET-PHONE.
 10286
 10287 7202-GET-FROM-ACTIVITY.
 10288
 10289* EXEC CICS READ
 10290*         DATASET  (ACTV-ID)
 10291*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10292*         RIDFLD   (ACTV-KEY)
 10293*    END-EXEC.
 10294*    MOVE '&"S        E          (   #00009579' TO DFHEIV0
 10295     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10296     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10297     MOVE X'2020233030303039353739' TO DFHEIV0(25:11)
 10298     CALL 'kxdfhei1' USING DFHEIV0,
 10299           ACTV-ID,
 10300           DFHEIV20,
 10301           DFHEIV99,
 10302           ACTV-KEY,
 10303           DFHEIV99,
 10304           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 206
* EL152.cbl
 10305           DFHEIV99
 10306     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10307         DFHEIV20
 10308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10309
 10310
 10311     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10312     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10313     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10314*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10315     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10316        INTO WS-LABEL-LINES (4)
 10317     END-STRING
 10318
 10319     MOVE SPACES                 TO  WS-ZIP-CODE.
 10320     IF AT-CANADIAN-POST-CODE
 10321         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10322         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10323     ELSE
 10324         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10325         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10326             MOVE '-'            TO  WS-AM-ZIP-DASH
 10327             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10328
 10329     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10330
 10331     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10332
 10333 7204-SET-PHONE.
 10334     MOVE WSPI-AREA              TO WSPO-AREA.
 10335     MOVE WSPI-PFX               TO WSPO-PFX.
 10336     MOVE WSPI-SFX               TO WSPO-SFX.
 10337     MOVE WS-PHONE-OUT           TO SS44-5D.
 10338
 10339     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10340
 10341     MOVE WS-LABEL-LINES (1)     TO SS43D.
 10342     MOVE WS-LABEL-LINES (2)     TO SS44-1D.
 10343     MOVE WS-LABEL-LINES (3)     TO SS44-2D.
 10344     MOVE WS-LABEL-LINES (4)     TO SS44-3D.
 10345     MOVE WS-LABEL-LINES (5)     TO SS44-4D.
 10346     MOVE WS-LABEL-LINES (6)     TO SS44-6D.
 10347
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 207
* EL152.cbl
 10349 7205-READ-PHYSICIAN-ADDR.
 10350     IF W-PHYSICIAN > ZERO
 10351         COMPUTE ACTV-SEQ = W-PHYSICIAN + 30
 10352     ELSE
 10353         MOVE CL-DOCTOR-ADDR-CNT TO ACTV-SEQ
 10354         ADD +30                 TO ACTV-SEQ.
 10355
 10356     IF ACTV-SEQ = +30
 10357        GO TO 7210-READ-EMPLOYER-ADDR.
 10358
 10359
 10360* EXEC CICS HANDLE CONDITION
 10361*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10362*         NOTFND     (7210-READ-EMPLOYER-ADDR)
 10363*    END-EXEC.
 10364*    MOVE '"$JI                  ! 6 #00009633' TO DFHEIV0
 10365     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10366     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10367     MOVE X'3620233030303039363333' TO DFHEIV0(25:11)
 10368     CALL 'kxdfhei1' USING DFHEIV0
 10369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10370
 10371
 10372
 10373* EXEC CICS READ
 10374*         DATASET    (ACTV-ID)
 10375*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10376*         RIDFLD     (ACTV-KEY)
 10377*    END-EXEC.
 10378*    MOVE '&"S        E          (   #00009638' TO DFHEIV0
 10379     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10380     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10381     MOVE X'2020233030303039363338' TO DFHEIV0(25:11)
 10382     CALL 'kxdfhei1' USING DFHEIV0,
 10383           ACTV-ID,
 10384           DFHEIV20,
 10385           DFHEIV99,
 10386           ACTV-KEY,
 10387           DFHEIV99,
 10388           DFHEIV99,
 10389           DFHEIV99
 10390     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10391         DFHEIV20
 10392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10393
 10394
 10395     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10396     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10397     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10398     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10399*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10400     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10401        INTO WS-LABEL-LINES (4)
 10402     END-STRING
 10403
 10404     MOVE SPACES                 TO  WS-ZIP-CODE.
 10405     IF AT-CANADIAN-POST-CODE
 10406         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 208
* EL152.cbl
 10407         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10408     ELSE
 10409         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10410         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10411             MOVE '-'            TO  WS-AM-ZIP-DASH
 10412             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10413
 10414     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10415
 10416     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10417     MOVE WSPI-AREA              TO WSPO-AREA.
 10418     MOVE WSPI-PFX               TO WSPO-PFX.
 10419     MOVE WSPI-SFX               TO WSPO-SFX.
 10420     MOVE WS-PHONE-OUT           TO SS47-5D.
 10421
 10422     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10423
 10424     MOVE WS-LABEL-LINES (1)     TO SS47D.
 10425     MOVE WS-LABEL-LINES (2)     TO SS47-1D.
 10426     MOVE WS-LABEL-LINES (3)     TO SS47-2D.
 10427     MOVE WS-LABEL-LINES (4)     TO SS47-3D.
 10428     MOVE WS-LABEL-LINES (5)     TO SS47-4D.
 10429
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 209
* EL152.cbl
 10431
 10432 7210-READ-EMPLOYER-ADDR.
 10433     IF W-EMPLOYER > ZERO
 10434         COMPUTE ACTV-SEQ = W-EMPLOYER + 40
 10435     ELSE
 10436         MOVE CL-EMPLOYER-ADDR-CNT
 10437                                 TO ACTV-SEQ
 10438         ADD +40                 TO ACTV-SEQ.
 10439
 10440     IF ACTV-SEQ = +40
 10441        GO TO 7220-READ-INSURED-ADDR.
 10442
 10443
 10444* EXEC CICS HANDLE CONDITION
 10445*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10446*         NOTFND     (7220-READ-INSURED-ADDR)
 10447*    END-EXEC.
 10448*    MOVE '"$JI                  ! 7 #00009692' TO DFHEIV0
 10449     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10450     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10451     MOVE X'3720233030303039363932' TO DFHEIV0(25:11)
 10452     CALL 'kxdfhei1' USING DFHEIV0
 10453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10454
 10455
 10456
 10457* EXEC CICS READ
 10458*         DATASET    (ACTV-ID)
 10459*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10460*         RIDFLD     (ACTV-KEY)
 10461*    END-EXEC.
 10462*    MOVE '&"S        E          (   #00009697' TO DFHEIV0
 10463     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10464     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10465     MOVE X'2020233030303039363937' TO DFHEIV0(25:11)
 10466     CALL 'kxdfhei1' USING DFHEIV0,
 10467           ACTV-ID,
 10468           DFHEIV20,
 10469           DFHEIV99,
 10470           ACTV-KEY,
 10471           DFHEIV99,
 10472           DFHEIV99,
 10473           DFHEIV99
 10474     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10475         DFHEIV20
 10476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10477
 10478
 10479     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10480     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10481     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10482     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10483*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10484     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10485        INTO WS-LABEL-LINES (4)
 10486     END-STRING
 10487
 10488     MOVE SPACES                 TO  WS-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 210
* EL152.cbl
 10489     IF AT-CANADIAN-POST-CODE
 10490         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10491         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10492     ELSE
 10493         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10494         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10495             MOVE '-'            TO  WS-AM-ZIP-DASH
 10496             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10497
 10498     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10499
 10500     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10501     MOVE WSPI-AREA              TO WSPO-AREA.
 10502     MOVE WSPI-PFX               TO WSPO-PFX.
 10503     MOVE WSPI-SFX               TO WSPO-SFX.
 10504     MOVE WS-PHONE-OUT           TO SS48-5D.
 10505
 10506     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10507
 10508     MOVE WS-LABEL-LINES (1)     TO SS48D.
 10509     MOVE WS-LABEL-LINES (2)     TO SS48-1D.
 10510     MOVE WS-LABEL-LINES (3)     TO SS48-2D.
 10511     MOVE WS-LABEL-LINES (4)     TO SS48-3D.
 10512     MOVE WS-LABEL-LINES (5)     TO SS48-4D.
 10513
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 211
* EL152.cbl
 10515 7220-READ-INSURED-ADDR.
 10516
 10517     IF W-INSURED > ZERO
 10518         COMPUTE ACTV-SEQ = W-INSURED
 10519     ELSE
 10520         MOVE CL-INSURED-ADDR-CNT TO ACTV-SEQ.
 10521
 10522     IF ACTV-SEQ = +0
 10523        GO TO 7225-READ-OTHER1-ADDR.
 10524
 10525
 10526* EXEC CICS HANDLE CONDITION
 10527*         NOTOPEN   (8870-ACTV-NOT-OPEN)
 10528*         NOTFND    (7225-READ-OTHER1-ADDR)
 10529*    END-EXEC.
 10530*    MOVE '"$JI                  ! 8 #00009749' TO DFHEIV0
 10531     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10532     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10533     MOVE X'3820233030303039373439' TO DFHEIV0(25:11)
 10534     CALL 'kxdfhei1' USING DFHEIV0
 10535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10536
 10537
 10538
 10539* EXEC CICS READ
 10540*         DATASET   (ACTV-ID)
 10541*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10542*         RIDFLD    (ACTV-KEY)
 10543*    END-EXEC.
 10544*    MOVE '&"S        E          (   #00009754' TO DFHEIV0
 10545     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10546     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10547     MOVE X'2020233030303039373534' TO DFHEIV0(25:11)
 10548     CALL 'kxdfhei1' USING DFHEIV0,
 10549           ACTV-ID,
 10550           DFHEIV20,
 10551           DFHEIV99,
 10552           ACTV-KEY,
 10553           DFHEIV99,
 10554           DFHEIV99,
 10555           DFHEIV99
 10556     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10557         DFHEIV20
 10558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10559
 10560
 10561     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10562     MOVE SS10D                  TO WS-LABEL-LINES (1).
 10563     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10564     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10565*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10566     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10567        INTO WS-LABEL-LINES (4)
 10568     END-STRING
 10569
 10570     MOVE SPACES                 TO  WS-ZIP-CODE.
 10571     IF AT-CANADIAN-POST-CODE
 10572         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 212
* EL152.cbl
 10573         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10574     ELSE
 10575         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10576         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10577             MOVE '-'            TO  WS-AM-ZIP-DASH
 10578             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10579
 10580     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10581
 10582     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10583
 10584     MOVE WS-LABEL-LINES (1)     TO SS10D.
 10585     MOVE WS-LABEL-LINES (2)     TO SS11-1D.
 10586     MOVE WS-LABEL-LINES (3)     TO SS11-2D.
 10587     MOVE WS-LABEL-LINES (4)     TO SS11-3D.
 10588     MOVE WS-LABEL-LINES (5)     TO SS11-4D.
 10589     MOVE AT-MAIL-TO-NAME        TO SS11-5D.
 10590
 10591     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10592     MOVE WSPI-AREA              TO WSPO-AREA.
 10593     MOVE WSPI-PFX               TO WSPO-PFX.
 10594     MOVE WSPI-SFX               TO WSPO-SFX.
 10595     MOVE WS-PHONE-OUT           TO SS11-6D.
 10596
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 213
* EL152.cbl
 10598
 10599 7225-READ-OTHER1-ADDR.
 10600
 10601     IF W-OTHER-1 > ZERO
 10602         COMPUTE ACTV-SEQ = W-OTHER-1 + 50
 10603     ELSE
 10604         MOVE CL-OTHER-1-ADDR-CNT TO ACTV-SEQ
 10605         ADD +50                  TO ACTV-SEQ.
 10606
 10607     IF ACTV-SEQ = +50
 10608        GO TO 7230-READ-OTHER2-ADDR.
 10609
 10610
 10611* EXEC CICS HANDLE CONDITION
 10612*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10613*         NOTFND     (7230-READ-OTHER2-ADDR)
 10614*    END-EXEC.
 10615*    MOVE '"$JI                  ! 9 #00009809' TO DFHEIV0
 10616     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10617     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10618     MOVE X'3920233030303039383039' TO DFHEIV0(25:11)
 10619     CALL 'kxdfhei1' USING DFHEIV0
 10620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10621
 10622
 10623
 10624* EXEC CICS READ
 10625*         DATASET    (ACTV-ID)
 10626*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10627*         RIDFLD     (ACTV-KEY)
 10628*    END-EXEC.
 10629*    MOVE '&"S        E          (   #00009814' TO DFHEIV0
 10630     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10631     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10632     MOVE X'2020233030303039383134' TO DFHEIV0(25:11)
 10633     CALL 'kxdfhei1' USING DFHEIV0,
 10634           ACTV-ID,
 10635           DFHEIV20,
 10636           DFHEIV99,
 10637           ACTV-KEY,
 10638           DFHEIV99,
 10639           DFHEIV99,
 10640           DFHEIV99
 10641     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10642         DFHEIV20
 10643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10644
 10645
 10646     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10647     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10648     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10649     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10650*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10651     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10652        INTO WS-LABEL-LINES (4)
 10653     END-STRING
 10654
 10655     MOVE SPACES                 TO  WS-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 214
* EL152.cbl
 10656     IF AT-CANADIAN-POST-CODE
 10657         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10658         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10659     ELSE
 10660         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10661         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10662             MOVE '-'            TO  WS-AM-ZIP-DASH
 10663             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10664
 10665     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10666
 10667     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10668     MOVE WSPI-AREA              TO WSPO-AREA.
 10669     MOVE WSPI-PFX               TO WSPO-PFX.
 10670     MOVE WSPI-SFX               TO WSPO-SFX.
 10671     MOVE WS-PHONE-OUT           TO SS49-5D.
 10672
 10673     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10674
 10675     MOVE WS-LABEL-LINES (1)     TO SS49D.
 10676     MOVE WS-LABEL-LINES (2)     TO SS49-1D.
 10677     MOVE WS-LABEL-LINES (3)     TO SS49-2D.
 10678     MOVE WS-LABEL-LINES (4)     TO SS49-3D.
 10679     MOVE WS-LABEL-LINES (5)     TO SS49-4D.
 10680
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 215
* EL152.cbl
 10682 7230-READ-OTHER2-ADDR.
 10683
 10684     IF W-OTHER-2 > ZERO
 10685         COMPUTE ACTV-SEQ = W-OTHER-2 + 60
 10686     ELSE
 10687         MOVE CL-OTHER-2-ADDR-CNT TO ACTV-SEQ
 10688         ADD +60                  TO ACTV-SEQ.
 10689
 10690     IF ACTV-SEQ = +60
 10691        GO TO 7240-NOT-FOUND.
 10692
 10693
 10694* EXEC CICS HANDLE CONDITION
 10695*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10696*         NOTFND     (7240-NOT-FOUND)
 10697*    END-EXEC.
 10698*    MOVE '"$JI                  ! : #00009867' TO DFHEIV0
 10699     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10700     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10701     MOVE X'3A20233030303039383637' TO DFHEIV0(25:11)
 10702     CALL 'kxdfhei1' USING DFHEIV0
 10703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10704
 10705
 10706
 10707* EXEC CICS READ
 10708*         DATASET    (ACTV-ID)
 10709*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10710*         RIDFLD     (ACTV-KEY)
 10711*    END-EXEC.
 10712*    MOVE '&"S        E          (   #00009872' TO DFHEIV0
 10713     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10714     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10715     MOVE X'2020233030303039383732' TO DFHEIV0(25:11)
 10716     CALL 'kxdfhei1' USING DFHEIV0,
 10717           ACTV-ID,
 10718           DFHEIV20,
 10719           DFHEIV99,
 10720           ACTV-KEY,
 10721           DFHEIV99,
 10722           DFHEIV99,
 10723           DFHEIV99
 10724     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10725         DFHEIV20
 10726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10727
 10728
 10729     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10730     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10731     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10732     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10733*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10734     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10735        INTO WS-LABEL-LINES (4)
 10736     END-STRING
 10737
 10738     MOVE SPACES                 TO  WS-ZIP-CODE.
 10739     IF AT-CANADIAN-POST-CODE
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 216
* EL152.cbl
 10740         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10741         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10742     ELSE
 10743         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10744         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10745             MOVE '-'            TO  WS-AM-ZIP-DASH
 10746             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10747
 10748     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10749
 10750     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10751     MOVE WSPI-AREA              TO WSPO-AREA.
 10752     MOVE WSPI-PFX               TO WSPO-PFX.
 10753     MOVE WSPI-SFX               TO WSPO-SFX.
 10754     MOVE WS-PHONE-OUT           TO SS50-5D.
 10755
 10756     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10757
 10758     MOVE WS-LABEL-LINES (1)     TO SS50D.
 10759     MOVE WS-LABEL-LINES (2)     TO SS50-1D.
 10760     MOVE WS-LABEL-LINES (3)     TO SS50-2D.
 10761     MOVE WS-LABEL-LINES (4)     TO SS50-3D.
 10762     MOVE WS-LABEL-LINES (5)     TO SS50-4D.
 10763
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 217
* EL152.cbl
 10765 7240-NOT-FOUND.
 10766     IF ACCOUNT-IS-ONLINE
 10767        GO TO 7250-READ-ACCOUNT.
 10768
 10769     IF W-ACCOUNT > ZERO
 10770         COMPUTE ACTV-SEQ = W-ACCOUNT + 20
 10771     ELSE
 10772         MOVE CL-ACCOUNT-ADDR-CNT TO ACTV-SEQ
 10773         ADD +20                  TO ACTV-SEQ.
 10774
 10775     IF ACTV-SEQ = +20
 10776        GO TO 7250-READ-ACCOUNT.
 10777
 10778
 10779* EXEC CICS HANDLE CONDITION
 10780*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10781*         NOTFND     (7250-READ-ACCOUNT)
 10782*    END-EXEC.
 10783*    MOVE '"$JI                  ! ; #00009927' TO DFHEIV0
 10784     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10785     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10786     MOVE X'3B20233030303039393237' TO DFHEIV0(25:11)
 10787     CALL 'kxdfhei1' USING DFHEIV0
 10788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10789
 10790
 10791
 10792* EXEC CICS READ
 10793*         DATASET    (ACTV-ID)
 10794*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10795*         RIDFLD     (ACTV-KEY)
 10796*    END-EXEC.
 10797*    MOVE '&"S        E          (   #00009932' TO DFHEIV0
 10798     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10799     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10800     MOVE X'2020233030303039393332' TO DFHEIV0(25:11)
 10801     CALL 'kxdfhei1' USING DFHEIV0,
 10802           ACTV-ID,
 10803           DFHEIV20,
 10804           DFHEIV99,
 10805           ACTV-KEY,
 10806           DFHEIV99,
 10807           DFHEIV99,
 10808           DFHEIV99
 10809     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10810         DFHEIV20
 10811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10812
 10813
 10814     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10815     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10816     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10817     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10818*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10819     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10820        INTO WS-LABEL-LINES (4)
 10821     END-STRING
 10822
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 218
* EL152.cbl
 10823     MOVE SPACES                 TO  WS-ZIP-CODE.
 10824     IF AT-CANADIAN-POST-CODE
 10825         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10826         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10827     ELSE
 10828         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10829         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10830             MOVE '-'            TO  WS-AM-ZIP-DASH
 10831             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10832
 10833     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10834
 10835     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10836     MOVE WSPI-AREA              TO WSPO-AREA.
 10837     MOVE WSPI-PFX               TO WSPO-PFX.
 10838     MOVE WSPI-SFX               TO WSPO-SFX.
 10839     MOVE WS-PHONE-OUT           TO SS07-6D.
 10840
 10841*    IF PI-COMPANY-ID NOT = 'FLA'
 10842*        PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10843
 10844     MOVE WS-LABEL-LINES (1)     TO SS06D.
 10845     MOVE WS-LABEL-LINES (2)     TO SS07-1D.
 10846     MOVE WS-LABEL-LINES (3)     TO SS07-2D.
 10847     MOVE WS-LABEL-LINES (4)     TO SS07-3D.
 10848     MOVE WS-LABEL-LINES (5)     TO SS07-4D.
 10849     MOVE WS-LABEL-LINES (6)     TO SS07-5D.
 10850
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 219
* EL152.cbl
 10852 7250-READ-ACCOUNT.
 10853*    IF CL-SYSTEM-IDENTIFIER = 'CV'
 10854*        GO TO 7250-READ-PRODUCER.
 10855
 10856     IF WS-ACCT-READ-SW = 'Y'
 10857        GO TO 7250-BUILD-ACCT-ADDR.
 10858
 10859     MOVE CM-CERT-EFF-DT TO ACCT-EXP-DATE.
 10860
 10861
 10862* EXEC CICS HANDLE CONDITION
 10863*         NOTOPEN   (8880-ACCT-NOT-OPEN)
 10864*         NOTFND    (7251-READ-3RD-PARTY)
 10865*    END-EXEC.
 10866*    MOVE '"$JI                  ! < #00009985' TO DFHEIV0
 10867     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10868     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10869     MOVE X'3C20233030303039393835' TO DFHEIV0(25:11)
 10870     CALL 'kxdfhei1' USING DFHEIV0
 10871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10872
 10873
 10874 7250-STARTBR-ACCOUNT.
 10875     MOVE ACCT-PARTIAL-KEY       TO  ACCT-SAVE-KEY.
 10876     PERFORM 8000-STARTBR-ERACCT THRU 8000-STARTBR-EXIT.
 10877
 10878 7250-READNEXT-ACCOUNT.
 10879     PERFORM 8000-READNEXT-ERACCT THRU 8000-READNEXT-EXIT.
 10880
 10881     IF ACCT-PARTIAL-KEY NOT = ACCT-SAVE-KEY
 10882         IF WS-SAVE-ACCT-RECORD = SPACES
 10883             GO TO 7251-READ-3RD-PARTY
 10884         ELSE
 10885             MOVE AM-CONTROL-PRIMARY  TO  ACCT-KEY
 10886             MOVE WS-SAVE-ACCT-RECORD TO  ACCOUNT-MASTER
 10887             GO TO 7250-BUILD-ACCT-ADDR.
 10888
 10889     IF AM-EXPIRATION-DT = HIGH-VALUES
 10890         MOVE AM-CONTROL-PRIMARY      TO  ACCT-KEY
 10891     ELSE
 10892         MOVE ACCOUNT-MASTER          TO  WS-SAVE-ACCT-RECORD
 10893         GO TO 7250-READNEXT-ACCOUNT.
 10894
 10895 7250-BUILD-ACCT-ADDR.
 10896     MOVE SPACES                TO  WS-SAVE-ACCT-RECORD.
 10897
 10898     IF NOT ACCOUNT-IS-ONLINE
 10899        GO TO 7251-READ-3RD-PARTY.
 10900
 10901     MOVE SPACES                TO WS-LABEL-HOLD-AREA.
 10902     MOVE AM-NAME               TO WS-LABEL-LINES (1).
 10903     MOVE AM-PERSON             TO WS-LABEL-LINES (2).
 10904     MOVE AM-ADDRS              TO WS-LABEL-LINES (3).
 10905*    MOVE AM-CITY               TO WS-LABEL-LINES (4).
 10906     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE DELIMITED BY '  '
 10907        INTO WS-LABEL-LINES (4)
 10908     END-STRING
 10909
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 220
* EL152.cbl
 10910     MOVE SPACES                TO  WS-ZIP-CODE.
 10911     IF AM-CANADIAN-POST-CODE
 10912         MOVE AM-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
 10913         MOVE AM-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
 10914     ELSE
 10915         MOVE AM-ZIP-PRIME      TO  WS-AM-ZIP-CODE
 10916         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10917             MOVE '-'           TO  WS-AM-ZIP-DASH
 10918             MOVE AM-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
 10919
 10920     MOVE WS-ZIP-CODE           TO  WS-LABEL-LINES (5).
 10921
 10922     MOVE ZEROS                 TO WS-PHONE-IN.
 10923     MOVE AM-AREA-CODE          TO WSPO-AREA.
 10924     MOVE AM-TEL-PRE            TO WSPO-PFX.
 10925     MOVE AM-TEL-NBR            TO WSPO-SFX.
 10926     MOVE WS-PHONE-OUT          TO SS07-6D.
 10927
 10928*    IF PI-COMPANY-ID NOT = 'FLA'
 10929*        PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10930
 10931     MOVE WS-LABEL-LINES (1)     TO SS06D.
 10932     MOVE WS-LABEL-LINES (2)     TO SS07-1D.
 10933     MOVE WS-LABEL-LINES (3)     TO SS07-2D.
 10934     MOVE WS-LABEL-LINES (4)     TO SS07-3D.
 10935     MOVE WS-LABEL-LINES (5)     TO SS07-4D.
 10936     MOVE WS-LABEL-LINES (6)     TO SS07-5D.
 10937
 10938*    GO TO 7251-READ-3RD-PARTY.
 10939
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 221
* EL152.cbl
 10941*7250-READ-PRODUCER. Remove as dead code
 10942*7250-STARTBR-PRODUCER. Remove as dead code
 10943*7250-READNEXT-PRODUCER. Remove as dead code
 10944*7250-BUILD-PROD-ADDR. Remove as dead code
 10945 7251-READ-3RD-PARTY.
 10946
 10947     MOVE +29                    TO ACTV-SEQ.
 10948
 10949
 10950* EXEC CICS HANDLE CONDITION
 10951*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10952*         NOTFND     (7252-READ-COMP)
 10953*    END-EXEC.
 10954*    MOVE '"$JI                  ! = #00010065' TO DFHEIV0
 10955     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10956     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10957     MOVE X'3D20233030303130303635' TO DFHEIV0(25:11)
 10958     CALL 'kxdfhei1' USING DFHEIV0
 10959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10960
 10961
 10962
 10963* EXEC CICS READ
 10964*         DATASET    (ACTV-ID)
 10965*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10966*         RIDFLD     (ACTV-KEY)
 10967*    END-EXEC.
 10968*    MOVE '&"S        E          (   #00010070' TO DFHEIV0
 10969     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10970     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10971     MOVE X'2020233030303130303730' TO DFHEIV0(25:11)
 10972     CALL 'kxdfhei1' USING DFHEIV0,
 10973           ACTV-ID,
 10974           DFHEIV20,
 10975           DFHEIV99,
 10976           ACTV-KEY,
 10977           DFHEIV99,
 10978           DFHEIV99,
 10979           DFHEIV99
 10980     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10981         DFHEIV20
 10982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10983
 10984
 10985     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10986     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10987     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10988     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10989*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10990     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10991        INTO WS-LABEL-LINES (4)
 10992     END-STRING
 10993
 10994     MOVE SPACES                 TO  WS-ZIP-CODE.
 10995     IF AT-CANADIAN-POST-CODE
 10996         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10997         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10998     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 222
* EL152.cbl
 10999         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 11000         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11001             MOVE '-'            TO  WS-AM-ZIP-DASH
 11002             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 11003
 11004     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 11005
 11006     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 11007     MOVE WSPI-AREA              TO WSPO-AREA.
 11008     MOVE WSPI-PFX               TO WSPO-PFX.
 11009     MOVE WSPI-SFX               TO WSPO-SFX.
 11010     MOVE WS-PHONE-OUT           TO SS53-6D.
 11011
 11012     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11013
 11014     MOVE WS-LABEL-LINES (1)     TO SS52D.
 11015     MOVE WS-LABEL-LINES (2)     TO SS53-1D.
 11016     MOVE WS-LABEL-LINES (3)     TO SS53-2D.
 11017     MOVE WS-LABEL-LINES (4)     TO SS53-3D.
 11018     MOVE WS-LABEL-LINES (5)     TO SS53-4D.
 11019     MOVE WS-LABEL-LINES (6)     TO SS53-5D.
 11020
 11021     GO TO 7260-READ-DENIAL.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 223
* EL152.cbl
 11023 7252-READ-COMP.
 11024
 11025     IF WS-COMP-READ-SW = 'Y'
 11026        GO TO 7255-BUILD-COMP-ADDR.
 11027
 11028     IF AM-3RD-PARTY-NOTIF-LEVEL NOT NUMERIC
 11029        MOVE ZEROS         TO AM-3RD-PARTY-NOTIF-LEVEL
 11030        GO TO 7260-READ-DENIAL.
 11031
 11032     IF AM-3RD-PARTY-NOTIF-LEVEL > 00 AND < 11
 11033        NEXT SENTENCE
 11034     ELSE
 11035        GO TO 7260-READ-DENIAL.
 11036
 11037     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = SPACES OR ZEROS
 11038        GO TO 7260-READ-DENIAL.
 11039
 11040     MOVE PI-COMPANY-CD   TO WS-ERCOMP-COMPANY-CD.
 11041     MOVE AM-CARRIER      TO WS-ERCOMP-CARRIER.
 11042     MOVE AM-GROUPING     TO WS-ERCOMP-GROUPING.
 11043     MOVE 'A'             TO WS-ERCOMP-TYPE.
 11044     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 11045                          TO WS-ERCOMP-RESP-NO.
 11046
 11047     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 11048         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 11049                                       'G' OR 'B'
 11050             MOVE 'G'            TO WS-ERCOMP-TYPE
 11051             MOVE LOW-VALUES     TO WS-ERCOMP-ACCOUNT
 11052         ELSE
 11053             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 11054                                 TO WS-ERCOMP-ACCOUNT
 11055     ELSE
 11056         MOVE 'G'                TO WS-ERCOMP-TYPE
 11057         MOVE LOW-VALUES         TO WS-ERCOMP-ACCOUNT.
 11058
 11059     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
 11060        MOVE ZEROS TO WS-ERCOMP-CARRIER.
 11061
 11062     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
 11063        MOVE ZEROS TO WS-ERCOMP-GROUPING.
 11064
 11065
 11066* EXEC CICS HANDLE CONDITION
 11067*         NOTFND    (7260-READ-DENIAL)
 11068*    END-EXEC.
 11069*    MOVE '"$I                   ! > #00010156' TO DFHEIV0
 11070     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11071     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11072     MOVE X'3E20233030303130313536' TO DFHEIV0(25:11)
 11073     CALL 'kxdfhei1' USING DFHEIV0
 11074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11075
 11076
 11077
 11078* EXEC CICS  READ
 11079*         SET      (ADDRESS OF COMPENSATION-MASTER)
 11080*         DATASET  ('ERCOMP')
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 224
* EL152.cbl
 11081*         RIDFLD   (WS-ERCOMP-KEY)
 11082*    END-EXEC.
 11083     MOVE 'ERCOMP' TO DFHEIV1
 11084*    MOVE '&"S        E          (   #00010160' TO DFHEIV0
 11085     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11086     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11087     MOVE X'2020233030303130313630' TO DFHEIV0(25:11)
 11088     CALL 'kxdfhei1' USING DFHEIV0,
 11089           DFHEIV1,
 11090           DFHEIV20,
 11091           DFHEIV99,
 11092           WS-ERCOMP-KEY,
 11093           DFHEIV99,
 11094           DFHEIV99,
 11095           DFHEIV99
 11096     SET ADDRESS OF COMPENSATION-MASTER TO
 11097         DFHEIV20
 11098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11099
 11100
 11101 7255-BUILD-COMP-ADDR.
 11102
 11103     MOVE SPACES                TO WS-LABEL-HOLD-AREA.
 11104     MOVE CO-ACCT-NAME          TO WS-LABEL-LINES (1).
 11105     IF CO-ACCT-NAME = SPACES
 11106        MOVE CO-MAIL-NAME       TO WS-LABEL-LINES (1).
 11107     MOVE CO-ADDR-1             TO WS-LABEL-LINES (2).
 11108     MOVE CO-ADDR-2             TO WS-LABEL-LINES (3).
 11109     MOVE CO-ADDR-3             TO WS-LABEL-LINES (4).
 11110
 11111     MOVE SPACES                TO  WS-ZIP-CODE.
 11112     IF CO-CANADIAN-POST-CODE
 11113         MOVE CO-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
 11114         MOVE CO-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
 11115     ELSE
 11116         MOVE CO-ZIP-PRIME      TO  WS-AM-ZIP-CODE
 11117         IF CO-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11118             MOVE '-'           TO  WS-AM-ZIP-DASH
 11119             MOVE CO-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
 11120
 11121     MOVE WS-ZIP-CODE           TO  WS-LABEL-LINES (5).
 11122
 11123     MOVE ZEROS                 TO WS-PHONE-IN.
 11124     MOVE CO-AREA-CODE          TO WSPO-AREA.
 11125     MOVE CO-PREFIX             TO WSPO-PFX.
 11126     MOVE CO-PHONE              TO WSPO-SFX.
 11127     MOVE WS-PHONE-OUT          TO SS53-6D.
 11128
 11129     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11130
 11131     MOVE WS-LABEL-LINES (1)     TO SS52D.
 11132     MOVE WS-LABEL-LINES (2)     TO SS53-1D.
 11133     MOVE WS-LABEL-LINES (3)     TO SS53-2D.
 11134     MOVE WS-LABEL-LINES (4)     TO SS53-3D.
 11135     MOVE WS-LABEL-LINES (5)     TO SS53-4D.
 11136     MOVE WS-LABEL-LINES (6)     TO SS53-5D.
 11137
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 225
* EL152.cbl
 11139
 11140 7260-READ-DENIAL.
 11141
 11142     MOVE +93                    TO ACTV-SEQ
 11143
 11144
 11145* EXEC CICS HANDLE CONDITION
 11146*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 11147*         NOTFND     (7265-READ-CNTL1)
 11148*         ENDFILE    (7265-READ-CNTL1)
 11149*    END-EXEC.
 11150*    MOVE '"$JI''                 ! ? #00010209' TO DFHEIV0
 11151     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 11152     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11153     MOVE X'3F20233030303130323039' TO DFHEIV0(25:11)
 11154     CALL 'kxdfhei1' USING DFHEIV0
 11155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11156
 11157
 11158
 11159* EXEC CICS STARTBR
 11160*         DATASET    (ACTV-ID)
 11161*         RIDFLD     (ACTV-KEY)
 11162*         GTEQ
 11163*    END-EXEC.
 11164     MOVE 0
 11165       TO DFHEIV11
 11166*    MOVE '&,         G          &   #00010215' TO DFHEIV0
 11167     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11168     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11169     MOVE X'2020233030303130323135' TO DFHEIV0(25:11)
 11170     CALL 'kxdfhei1' USING DFHEIV0,
 11171           ACTV-ID,
 11172           ACTV-KEY,
 11173           DFHEIV99,
 11174           DFHEIV11,
 11175           DFHEIV99
 11176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11177
 11178
 11179     MOVE 'Y'                    TO ACTV-BROWSE-STARTED.
 11180     MOVE ACTV-PARTIAL-KEY       TO ACTV-SAVE-KEY.
 11181
 11182 7262-READ-NEXT.
 11183
 11184
 11185* EXEC CICS READNEXT
 11186*         SET     (ADDRESS OF ACTIVITY-TRAILERS)
 11187*         RIDFLD  (ACTV-KEY)
 11188*         DATASET (ACTV-ID)
 11189*    END-EXEC.
 11190     MOVE 0
 11191       TO DFHEIV11
 11192*    MOVE '&.S                   )   #00010226' TO DFHEIV0
 11193     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11194     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11195     MOVE X'2020233030303130323236' TO DFHEIV0(25:11)
 11196     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 226
* EL152.cbl
 11197           ACTV-ID,
 11198           DFHEIV20,
 11199           DFHEIV99,
 11200           ACTV-KEY,
 11201           DFHEIV99,
 11202           DFHEIV11,
 11203           DFHEIV99,
 11204           DFHEIV99
 11205     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11206         DFHEIV20
 11207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11208
 11209
 11210     IF ACTV-PARTIAL-KEY  NOT = ACTV-SAVE-KEY
 11211        GO TO 7265-READ-CNTL1.
 11212     IF AT-TRAILER-TYPE = '2'
 11213        AND AT-PAYMENT-TYPE = 'I'
 11214        AND AT-INT-RATE NUMERIC
 11215        AND AT-INT-RATE NOT = ZEROS
 11216        COMPUTE WS-WORK-INT-RATE = AT-INT-RATE * 100
 11217        MOVE +1                  TO S2
 11218        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
 11219           (S1 > +6)
 11220           IF WS-WORK-INT (S1:1) NOT = '0'
 11221              MOVE WS-WORK-INT (S1:1)
 11222                                 TO SS16-1D (S2:1)
 11223              ADD +1             TO S2
 11224           END-IF
 11225        END-PERFORM
 11226        MOVE '%'                 TO SS16-1D (S2:1)
 11227        GO TO 7262-READ-NEXT
 11228     END-IF
 11229     IF AT-TRAILER-TYPE = '8'
 11230        MOVE AT-DENIAL-INFO-1    TO SS35-1D
 11231        MOVE AT-DENIAL-INFO-2    TO SS35-2D
 11232        IF (CL-TOTAL-INT-PAID = ZEROS)
 11233           OR (CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1)
 11234           GO TO 7265-READ-CNTL1
 11235        END-IF
 11236     END-IF
 11237     GO TO 7262-READ-NEXT
 11238     .
 11239 7265-READ-CNTL1.
 11240     IF ACTV-BROWSE-STARTED = 'Y'
 11241        MOVE 'N'                  TO ACTV-BROWSE-STARTED
 11242
 11243* EXEC CICS ENDBR
 11244*            DATASET    (ACTV-ID)
 11245*       END-EXEC.
 11246     MOVE 0
 11247       TO DFHEIV11
 11248*    MOVE '&2                    $   #00010264' TO DFHEIV0
 11249     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11250     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11251     MOVE X'2020233030303130323634' TO DFHEIV0(25:11)
 11252     CALL 'kxdfhei1' USING DFHEIV0,
 11253           ACTV-ID,
 11254           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 227
* EL152.cbl
 11255           DFHEIV99
 11256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11257
 11258
 11259     IF SS35-1D = ALL '*'
 11260         MOVE '@@DENIAL1'        TO SS35-1D.
 11261
 11262     IF SS35-2D = ALL '*'
 11263         MOVE '@@DENIAL2'        TO SS35-2D.
 11264
 11265     MOVE '1'                    TO CNTL-RECORD-TYPE.
 11266     MOVE ZEROS                  TO CNTL-SEQ.
 11267
 11268* EXEC CICS HANDLE CONDITION
 11269*         NOTOPEN   (8840-CNTL-NOT-OPEN)
 11270*         NOTFND    (7266-READ-CNTL2)
 11271*    END-EXEC.
 11272*    MOVE '"$JI                  ! @ #00010276' TO DFHEIV0
 11273     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11274     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11275     MOVE X'4020233030303130323736' TO DFHEIV0(25:11)
 11276     CALL 'kxdfhei1' USING DFHEIV0
 11277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11278
 11279
 11280
 11281* EXEC CICS READ
 11282*         DATASET   (CNTL-ID)
 11283*         SET       (ADDRESS OF CONTROL-FILE)
 11284*         RIDFLD    (CNTL-KEY)
 11285*    END-EXEC.
 11286*    MOVE '&"S        E          (   #00010281' TO DFHEIV0
 11287     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11288     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11289     MOVE X'2020233030303130323831' TO DFHEIV0(25:11)
 11290     CALL 'kxdfhei1' USING DFHEIV0,
 11291           CNTL-ID,
 11292           DFHEIV20,
 11293           DFHEIV99,
 11294           CNTL-KEY,
 11295           DFHEIV99,
 11296           DFHEIV99,
 11297           DFHEIV99
 11298     SET ADDRESS OF CONTROL-FILE TO
 11299         DFHEIV20
 11300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11301
 11302
 11303     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 11304     MOVE CF-CL-MAIL-TO-NAME     TO WS-LABEL-LINES (1).
 11305     MOVE CF-CL-IN-CARE-OF       TO WS-LABEL-LINES (2).
 11306     MOVE CF-CL-ADDR-LINE-1      TO WS-LABEL-LINES (3).
 11307     MOVE CF-CL-ADDR-LINE-2      TO WS-LABEL-LINES (4).
 11308     MOVE CF-CL-CITY-STATE       TO WS-LABEL-LINES (5).
 11309
 11310     IF CF-CL-ZIP-CODE-NUM NOT NUMERIC
 11311         MOVE ZEROS              TO  CF-CL-ZIP-CODE-NUM.
 11312     IF CF-CL-ZIP-CODE-NUM NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 228
* EL152.cbl
 11313         MOVE CF-CL-ZIP-CODE-NUM TO  WS-ZIP-NUMERIC
 11314         MOVE WS-ZIP-NONNUM      TO  CF-CL-ZIP-CODE.
 11315
 11316     MOVE SPACES                 TO  WS-ZIP-CODE.
 11317     IF CF-CL-CAN-POST-CODE
 11318         MOVE CF-CL-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
 11319         MOVE CF-CL-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
 11320     ELSE
 11321         MOVE CF-CL-ZIP-PRIME      TO  WS-AM-ZIP-CODE
 11322         IF CF-CL-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11323             MOVE '-'              TO  WS-AM-ZIP-DASH
 11324             MOVE CF-CL-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
 11325
 11326     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (6).
 11327
 11328     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11329
 11330     MOVE WS-LABEL-LINES (1)     TO SS01D.
 11331     MOVE WS-LABEL-LINES (2)     TO SS02-1D.
 11332     MOVE WS-LABEL-LINES (3)     TO SS02-2D.
 11333     MOVE WS-LABEL-LINES (4)     TO SS02-3D.
 11334     MOVE WS-LABEL-LINES (5)     TO SS02-4D.
 11335     MOVE WS-LABEL-LINES (6)     TO SS02-5D.
 11336
 11337 7266-READ-CNTL2.
 11338     IF PI-PROCESSOR-ID  =  LGXX-ID
 11339        GO TO 7267-READ-CNTL4.
 11340
 11341     MOVE '2'                    TO CNTL-RECORD-TYPE.
 11342     MOVE PI-PROCESSOR-ID        TO CNTL-GENL.
 11343     MOVE ZEROS                  TO CNTL-SEQ.
 11344
 11345
 11346* EXEC CICS HANDLE CONDITION
 11347*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 11348*         NOTFND     (7267-READ-CNTL4)
 11349*    END-EXEC.
 11350*    MOVE '"$JI                  ! A #00010329' TO DFHEIV0
 11351     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11352     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11353     MOVE X'4120233030303130333239' TO DFHEIV0(25:11)
 11354     CALL 'kxdfhei1' USING DFHEIV0
 11355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11356
 11357
 11358
 11359* EXEC CICS READ
 11360*         DATASET    (CNTL-ID)
 11361*         SET        (ADDRESS OF CONTROL-FILE)
 11362*         RIDFLD     (CNTL-KEY)
 11363*    END-EXEC.
 11364*    MOVE '&"S        E          (   #00010334' TO DFHEIV0
 11365     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11366     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11367     MOVE X'2020233030303130333334' TO DFHEIV0(25:11)
 11368     CALL 'kxdfhei1' USING DFHEIV0,
 11369           CNTL-ID,
 11370           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 229
* EL152.cbl
 11371           DFHEIV99,
 11372           CNTL-KEY,
 11373           DFHEIV99,
 11374           DFHEIV99,
 11375           DFHEIV99
 11376     SET ADDRESS OF CONTROL-FILE TO
 11377         DFHEIV20
 11378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11379
 11380
 11381     MOVE CF-PROCESSOR-NAME      TO SS08D.
 11382     MOVE CF-PROCESSOR-TITLE     TO SS09D.
 11383
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 230
* EL152.cbl
 11385 7267-READ-CNTL4.
 11386*    IF CL-SYSTEM-IDENTIFIER = 'CV'
 11387*        GO TO 7267-READ-EMPLAN.
 11388
 11389     IF BEN-HOLD = ZEROS
 11390        GO TO 7267-READ-CNTL6.
 11391
 11392     MOVE BEN-HOLD               TO CNTL-GEN2.
 11393     MOVE SPACES                 TO CNTL-GEN1.
 11394
 11395     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11396        MOVE '4'                 TO CNTL-RECORD-TYPE
 11397     ELSE
 11398        MOVE '5'                 TO CNTL-RECORD-TYPE.
 11399
 11400     MOVE ZEROS                  TO CNTL-SEQ.
 11401
 11402
 11403* EXEC CICS HANDLE CONDITION
 11404*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 11405*         NOTFND     (7267-READ-CNTL6)
 11406*    END-EXEC.
 11407*    MOVE '"$JI                  ! B #00010361' TO DFHEIV0
 11408     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11409     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11410     MOVE X'4220233030303130333631' TO DFHEIV0(25:11)
 11411     CALL 'kxdfhei1' USING DFHEIV0
 11412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11413
 11414
 11415
 11416* EXEC CICS READ
 11417*         DATASET    (CNTL-ID)
 11418*         SET        (ADDRESS OF CONTROL-FILE)
 11419*         RIDFLD     (CNTL-KEY)
 11420*         GTEQ
 11421*    END-EXEC.
 11422*    MOVE '&"S        G          (   #00010366' TO DFHEIV0
 11423     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11424     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11425     MOVE X'2020233030303130333636' TO DFHEIV0(25:11)
 11426     CALL 'kxdfhei1' USING DFHEIV0,
 11427           CNTL-ID,
 11428           DFHEIV20,
 11429           DFHEIV99,
 11430           CNTL-KEY,
 11431           DFHEIV99,
 11432           DFHEIV99,
 11433           DFHEIV99
 11434     SET ADDRESS OF CONTROL-FILE TO
 11435         DFHEIV20
 11436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11437
 11438
 11439     MOVE 1                      TO SUB.
 11440 7267-LOOP.
 11441     IF SUB = 9
 11442        GO TO 7267-READ-CNTL6.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 231
* EL152.cbl
 11443
 11444     IF CF-BENEFIT-CODE (SUB) < BEN-HOLD
 11445        ADD 1 TO SUB
 11446        GO TO 7267-LOOP.
 11447
 11448     IF BEN-HOLD = CF-BENEFIT-CODE (SUB)
 11449        MOVE CF-BENEFIT-DESCRIP (SUB) TO SS22D
 11450        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 11451           OR CL-CLAIM-TYPE = 'I'
 11452           OR CL-CLAIM-TYPE = 'G'
 11453           MOVE CF-BENEFIT-ALPHA (SUB)   TO BENEFIT-WORK
 11454           MOVE ELIM-DAYS                TO SS42D.
 11455
 11456     GO TO 7267-READ-CNTL6.
 11457
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 232
* EL152.cbl
 11459*7267-READ-EMPLAN. Remove as dead code
 11460 7267-READ-CNTL6.
 11461     MOVE '6'                    TO CNTL-RECORD-TYPE.
 11462     MOVE SPACES                 TO CNTL-GENL.
 11463
 11464*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11465*        MOVE CL-CURRENT-CARRIER TO CNTL-GEN4
 11466*    ELSE
 11467         MOVE PI-CARRIER         TO CNTL-GEN4.
 11468
 11469     MOVE ZEROS                  TO CNTL-SEQ.
 11470
 11471
 11472* EXEC CICS HANDLE CONDITION
 11473*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 11474*         NOTFND     (7268-SET-DATE)
 11475*    END-EXEC.
 11476*    MOVE '"$JI                  ! C #00010405' TO DFHEIV0
 11477     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11478     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11479     MOVE X'4320233030303130343035' TO DFHEIV0(25:11)
 11480     CALL 'kxdfhei1' USING DFHEIV0
 11481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11482
 11483
 11484
 11485* EXEC CICS READ
 11486*         DATASET    (CNTL-ID)
 11487*         SET        (ADDRESS OF CONTROL-FILE)
 11488*         RIDFLD     (CNTL-KEY)
 11489*    END-EXEC.
 11490*    MOVE '&"S        E          (   #00010410' TO DFHEIV0
 11491     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11492     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11493     MOVE X'2020233030303130343130' TO DFHEIV0(25:11)
 11494     CALL 'kxdfhei1' USING DFHEIV0,
 11495           CNTL-ID,
 11496           DFHEIV20,
 11497           DFHEIV99,
 11498           CNTL-KEY,
 11499           DFHEIV99,
 11500           DFHEIV99,
 11501           DFHEIV99
 11502     SET ADDRESS OF CONTROL-FILE TO
 11503         DFHEIV20
 11504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11505
 11506
 11507     MOVE SPACES              TO WS-LABEL-HOLD-AREA.
 11508     MOVE CF-MAIL-TO-NAME     TO WS-LABEL-LINES (1).
 11509     MOVE CF-IN-CARE-OF       TO WS-LABEL-LINES (2).
 11510     MOVE CF-ADDRESS-LINE-1   TO WS-LABEL-LINES (3).
 11511     MOVE CF-ADDRESS-LINE-2   TO WS-LABEL-LINES (4).
 11512     MOVE CF-CITY-STATE       TO WS-LABEL-LINES (5).
 11513
 11514     IF CF-ZIP-CODE-NUM NOT NUMERIC
 11515         MOVE ZEROS              TO  CF-ZIP-CODE-NUM.
 11516     IF CF-ZIP-CODE-NUM NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 233
* EL152.cbl
 11517         MOVE CF-ZIP-CODE-NUM    TO  WS-ZIP-NUMERIC
 11518         MOVE WS-ZIP-NONNUM      TO  CF-ZIP-CODE.
 11519
 11520     MOVE SPACES              TO  WS-ZIP-CODE.
 11521     IF CF-CANADIAN-POST-CODE
 11522         MOVE CF-CAN-POSTAL-1  TO  WS-CAN-POSTAL-1
 11523         MOVE CF-CAN-POSTAL-2  TO  WS-CAN-POSTAL-2
 11524     ELSE
 11525         MOVE CF-ZIP-PRIME     TO  WS-AM-ZIP-CODE
 11526         IF CF-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11527             MOVE '-'          TO  WS-AM-ZIP-DASH
 11528             MOVE CF-ZIP-PLUS4 TO  WS-AM-ZIP-PLUS4.
 11529
 11530     MOVE WS-ZIP-CODE         TO  WS-LABEL-LINES (6).
 11531
 11532     MOVE CF-PHONE-NO         TO WS-PHONE-IN.
 11533     MOVE WSPI-AREA           TO WSPO-AREA.
 11534     MOVE WSPI-PFX            TO WSPO-PFX.
 11535     MOVE WSPI-SFX            TO WSPO-SFX.
 11536     MOVE WS-PHONE-OUT        TO SS04-6D.
 11537
 11538     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11539
 11540     MOVE WS-LABEL-LINES (1)  TO SS03D
 11541     IF PI-CARRIER = '8'
 11542        MOVE 'as Administrator for Investors Heritage Life Insuran
 11543-     'ce Company'               TO SS03-1D
 11544     END-IF
 11545     MOVE WS-LABEL-LINES (2)  TO SS04-1D.
 11546     MOVE WS-LABEL-LINES (3)  TO SS04-2D.
 11547     MOVE WS-LABEL-LINES (4)  TO SS04-3D.
 11548     MOVE WS-LABEL-LINES (5)  TO SS04-4D.
 11549     MOVE WS-LABEL-LINES (6)  TO SS04-5D.
 11550
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 234
* EL152.cbl
 11552 7268-SET-DATE.
 11553     MOVE EIBDATE                TO DATE-WORK.
 11554     MOVE DT-WORK                TO DC-JULIAN-YYDDD.
 11555     MOVE '5'                    TO DC-OPTION-CODE.
 11556     PERFORM 9700-DATE-LINK  THRU  9700-EXIT.
 11557     MOVE DC-GREG-DATE-1-EDIT    TO SS20D.
 11558     MOVE DC-GREG-DATE-1-ALPHA   TO SS21D.
 11559
 11560     IF NOT LOWER-CASE-LETTERS-USED
 11561        GO TO 7269-EXIT.
 11562
 11563*    IF PI-COMPANY-ID = 'DMD'
 11564*        MOVE SS21D              TO WS-TEMP-AREA2
 11565*        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11566*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11567*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11568*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11569*        END-IF
 11570*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11571*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11572*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11573*        END-IF
 11574*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11575*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11576*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11577*        END-IF
 11578*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11579*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11580*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11581*        END-IF
 11582*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11583*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11584*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11585*        END-IF
 11586*        MOVE WS-TEMP-AREA2      TO SS21D
 11587*        GO TO 7269-EXIT.
 11588*
 11589     INSPECT SS19D   CONVERTING UPPER-CASE TO LOWER-CASE.
 11590     INSPECT SS35-1D CONVERTING UPPER-CASE TO LOWER-CASE.
 11591     INSPECT SS35-2D CONVERTING UPPER-CASE TO LOWER-CASE.
 11592     INSPECT SS22D   CONVERTING UPPER-CASE TO LOWER-CASE.
 11593
 11594     MOVE 'N'                    TO WS-STATE-LINE.
 11595
 11596     MOVE 'Y'                    TO WS-PROCESSOR-LINE.
 11597     MOVE SS08D                  TO WS-TEMP-AREA2.
 11598     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11599     MOVE WS-TEMP-AREA2          TO SS08D.
 11600     MOVE 'N'                    TO WS-PROCESSOR-LINE.
 11601     MOVE 'N'                    TO WS-CAPS-SW.
 11602
 11603     MOVE SS09D                  TO WS-TEMP-AREA2.
 11604     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11605     MOVE WS-TEMP-AREA2          TO SS09D.
 11606
 11607     MOVE SS11-5D                TO WS-TEMP-AREA2.
 11608     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11609     MOVE WS-TEMP-AREA2          TO SS11-5D.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 235
* EL152.cbl
 11610
 11611     MOVE SS21D                  TO WS-TEMP-AREA2.
 11612     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11613     MOVE WS-TEMP-AREA2          TO SS21D.
 11614
 11615     MOVE SS40D                  TO WS-TEMP-AREA2.
 11616     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11617     MOVE WS-TEMP-AREA2          TO SS40D.
 11618
 11619     MOVE SS41D                  TO WS-TEMP-AREA2.
 11620     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11621     MOVE WS-TEMP-AREA2          TO SS41D.
 11622
 11623 7269-EXIT.
 11624     EXIT.
 11625
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 236
* EL152.cbl
 11627*            COPY ELCNAMET.
 11628*****************************************************************
 11629*                                                               *
 11630*                                                               *
 11631*                            ELCNAMET                           *
 11632*                            VMOD=2.003                         *
 11633*                                                               *
 11634*            TRANSLATION ROUTINE USED MAINLY FOR CONVERTING     *
 11635*            NAMES AND ADDRESSES AND OTHER VARIABLES TO         *
 11636*            LOWER CASE.  THE FIRST CHARACTER OF EACH WORD      *
 11637*            IS LEFT AS UPPER AND ALL OTHER LOWER CASE.         *
 11638*                                                               *
 11639*                                                               *
 11640*****************************************************************.
 11641*                   C H A N G E   L O G
 11642*
 11643* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 11644*-----------------------------------------------------------------
 11645*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 11646* EFFECTIVE    NUMBER
 11647*-----------------------------------------------------------------
 11648* 102703                   SMVA  LEAVE CERTIFICATION DESIGNATION O
 11649*                                PROCESSOR NAME LINE IN CAPS
 11650******************************************************************
 11651
 11652 7270-LABEL-MOVE.
 11653     IF WS-LABEL-HOLD-AREA = SPACES
 11654        GO TO 7279-EXIT.
 11655
 11656     IF PI-COMPANY-ID NOT = 'DMD'
 11657         PERFORM 7280-TRANSLATE-LOWER THRU 7280-EXIT.
 11658
 11659 7270-LABEL-MOVE-1.
 11660
 11661     IF WS-LABEL-LINES (1) = SPACES
 11662        MOVE WS-LABEL-LINES (2)  TO WS-LABEL-LINES (1)
 11663        MOVE WS-LABEL-LINES (3)  TO WS-LABEL-LINES (2)
 11664        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
 11665        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11666        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11667        MOVE SPACES              TO WS-LABEL-LINES (6)
 11668        GO TO 7270-LABEL-MOVE-1.
 11669
 11670     IF WS-LABEL-LINES (2) = SPACES AND
 11671        WS-LABEL-LINES (3) = SPACES AND
 11672        WS-LABEL-LINES (4) = SPACES AND
 11673        WS-LABEL-LINES (5) = SPACES AND
 11674        WS-LABEL-LINES (6) = SPACES
 11675        SET WS-NDX               TO 1
 11676        GO TO 7275-MOVE-ZIP.
 11677
 11678 7270-LABEL-MOVE-2.
 11679
 11680     IF WS-LABEL-LINES (2) = SPACES
 11681        MOVE WS-LABEL-LINES (3)  TO WS-LABEL-LINES (2)
 11682        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
 11683        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11684        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 237
* EL152.cbl
 11685        MOVE SPACES              TO WS-LABEL-LINES (6)
 11686        GO TO 7270-LABEL-MOVE-2.
 11687
 11688     IF WS-LABEL-LINES (3) = SPACES AND
 11689        WS-LABEL-LINES (4) = SPACES AND
 11690        WS-LABEL-LINES (5) = SPACES AND
 11691        WS-LABEL-LINES (6) = SPACES
 11692        SET WS-NDX               TO 2
 11693        GO TO 7275-MOVE-ZIP.
 11694
 11695 7270-LABEL-MOVE-3.
 11696
 11697     IF WS-LABEL-LINES (3) = SPACES
 11698        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
 11699        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11700        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11701        MOVE SPACES              TO WS-LABEL-LINES (6)
 11702        GO TO 7270-LABEL-MOVE-3.
 11703
 11704     IF WS-LABEL-LINES (4) = SPACES AND
 11705        WS-LABEL-LINES (5) = SPACES AND
 11706        WS-LABEL-LINES (6) = SPACES
 11707        SET WS-NDX               TO 3
 11708        GO TO 7275-MOVE-ZIP.
 11709
 11710 7270-LABEL-MOVE-4.
 11711
 11712     IF WS-LABEL-LINES (4) = SPACES
 11713        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11714        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11715        MOVE SPACES              TO WS-LABEL-LINES (6)
 11716        GO TO 7270-LABEL-MOVE-4.
 11717
 11718     IF WS-LABEL-LINES (5) = SPACES AND
 11719        WS-LABEL-LINES (6) = SPACES
 11720        SET WS-NDX               TO 4
 11721        GO TO 7275-MOVE-ZIP.
 11722
 11723 7270-LABEL-MOVE-5.
 11724
 11725     IF WS-LABEL-LINES (5) = SPACES
 11726        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11727        MOVE SPACES              TO WS-LABEL-LINES (6)
 11728        SET WS-NDX               TO 5
 11729        GO TO 7275-MOVE-ZIP
 11730
 11731     ELSE
 11732        IF WS-LABEL-LINES (6) = SPACES
 11733           SET WS-NDX            TO 5
 11734           GO TO 7275-MOVE-ZIP
 11735
 11736        ELSE
 11737           SET WS-NDX            TO 6.
 11738
 11739 7275-MOVE-ZIP.
 11740
 11741     SET WS-NDX2                 TO WS-NDX.
 11742     SET WS-NDX2 DOWN BY +1.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 238
* EL152.cbl
 11743
 11744     IF  WS-LAST-ZIP (WS-NDX2) = SPACES
 11745*****CANADIAN ZIP CODES (NON NUMERIC) STAY ON THE LAST LINE
 11746         IF WS-LABEL-1ST-ZIP (WS-NDX) NUMERIC
 11747          IF PI-COMPANY-ID NOT = 'FLA'
 11748            MOVE WS-LABEL-ZIP (WS-NDX)
 11749                                     TO WS-LAST-ZIP (WS-NDX2)
 11750            MOVE SPACES              TO WS-LABEL-LINES (WS-NDX).
 11751
 11752 7279-EXIT.
 11753     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 239
* EL152.cbl
 11755
 11756 7280-TRANSLATE-LOWER.
 11757     IF LOWER-CASE-LETTERS-USED
 11758        MOVE 'N'                     TO WS-STATE-LINE
 11759     ELSE
 11760        GO TO 7280-EXIT.
 11761
 11762     IF WS-LABEL-LINES (1) NOT = SPACES
 11763        MOVE WS-LABEL-LINES (1)      TO WS-TEMP-AREA2
 11764        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11765        MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (1).
 11766
 11767     IF WS-LABEL-LINES (2) NOT = SPACES
 11768        MOVE WS-LABEL-LINES (2)      TO WS-TEMP-AREA2
 11769        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11770        MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (2).
 11771
 11772     IF WS-LABEL-LINES (3) NOT = SPACES
 11773        MOVE WS-LABEL-LINES (3)      TO WS-TEMP-AREA2
 11774        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11775        MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (3).
 11776
 11777*****THE CITY STATE WILL BE ON LINE FOUR OR FIVE DEPENDING
 11778*****ON THE FORMAT USED.  THE SIXTH LINE BEING BLANK WILL TELL.
 11779
 11780
 11781     IF WS-LABEL-LINES (4) NOT = SPACES
 11782        IF (WS-LABEL-LINES (6) = SPACES  OR
 11783           WS-LABEL-LINES (5) = SPACES)
 11784           MOVE 'Y'                     TO WS-STATE-LINE
 11785           MOVE WS-LABEL-LINES (4)      TO WS-TEMP-AREA2
 11786           PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11787           MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (4)
 11788        ELSE
 11789           MOVE WS-LABEL-LINES (4)      TO WS-TEMP-AREA2
 11790           PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11791           MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (4).
 11792
 11793     IF WS-LABEL-LINES (5) NOT = SPACES
 11794        IF WS-LABEL-LINES (6) NOT = SPACES
 11795           MOVE 'Y'                     TO WS-STATE-LINE
 11796           MOVE WS-LABEL-LINES (5)      TO WS-TEMP-AREA2
 11797           PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11798           MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (5).
 11799
 11800 7280-EXIT.
 11801     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 240
* EL152.cbl
 11803
 11804 7281-SEARCH-AND-TRANSLATE.
 11805     SET TA1  TO +1.
 11806
 11807 7281-FIND-FIRST-NON-BLANK.
 11808     IF WS-TEMP-2 (TA1) = SPACES
 11809        SET TA1 UP BY 1
 11810        GO TO 7281-FIND-FIRST-NON-BLANK.
 11811
 11812*****SET INDEX TO THE NEXT CHAR TO START THE TRANSLATE.
 11813     SET TA2   TO TA1
 11814     SET TA2   UP BY 1
 11815     SET TA21  TO TA2
 11816     SET TA21  UP BY 1.
 11817
 11818     MOVE 'N'                   TO WS-DATA-FOUND-SW.
 11819     PERFORM 7282-FIND-NEXT-BLANK THRU 7282-EXIT.
 11820
 11821 7281-EXIT.
 11822     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 241
* EL152.cbl
 11824
 11825 7282-FIND-NEXT-BLANK.
 11826     IF TA21 GREATER THAN 31
 11827        GO TO 7282-EXIT.
 11828
 11829     IF TA21 EQUAL TO 31
 11830        IF NO-CHARACTERS-FOUND
 11831           GO TO 7282-EXIT
 11832           ELSE
 11833           SET TA1   TO +1
 11834           MOVE SPACES             TO WS-TEMP-AREA1
 11835           PERFORM 7283-MOVE VARYING MOVE-INDX FROM TA2 BY 1
 11836                   UNTIL MOVE-INDX EQUAL TO TA21
 11837           PERFORM 7285-TEST-AND-TRANSLATE THRU 7285-EXIT
 11838           SET TA1   TO +1
 11839           PERFORM 7284-MOVE-BACK VARYING MOVE-INDX FROM TA2 BY 1
 11840                   UNTIL MOVE-INDX EQUAL TO TA21
 11841           GO TO 7282-EXIT.
 11842
 11843     IF WS-TEMP-2 (TA2)  = SPACE OR ',' OR '/'
 11844         GO TO 7282-NEXT-GROUP-SEARCH.
 11845
 11846     IF WS-TEMP-2 (TA21) = SPACES OR ',' OR '/'
 11847         IF WS-TEMP-2 (TA21)  = ','
 11848            AND WS-PROCESSOR-LINE = 'Y'
 11849             SET THE-REST-R-CAPS TO TRUE
 11850         ELSE
 11851             CONTINUE
 11852     ELSE
 11853         MOVE 'Y'                  TO WS-DATA-FOUND-SW
 11854         SET TA21 UP BY +1
 11855         GO TO 7282-FIND-NEXT-BLANK.
 11856
 11857     SET TA1  TO +1
 11858     MOVE SPACES                   TO WS-TEMP-AREA1.
 11859     PERFORM 7283-MOVE VARYING MOVE-INDX FROM TA2 BY 1
 11860             UNTIL MOVE-INDX EQUAL TO TA21
 11861     PERFORM 7285-TEST-AND-TRANSLATE THRU 7285-EXIT.
 11862     SET TA1  TO +1
 11863     PERFORM 7284-MOVE-BACK VARYING MOVE-INDX FROM TA2 BY 1
 11864             UNTIL MOVE-INDX EQUAL TO TA21
 11865     IF THE-REST-R-CAPS
 11866         GO TO 7282-EXIT.
 11867     SET TA2   TO TA21
 11868     SET TA21  UP BY 1
 11869     MOVE 'N'                   TO WS-DATA-FOUND-SW.
 11870 7282-NEXT-GROUP-SEARCH.
 11871     IF WS-TEMP-2 (TA2) EQUAL TO SPACES OR ',' OR '/'
 11872        SET TA2   UP BY 1
 11873        IF TA2 = 30
 11874           GO TO 7282-EXIT
 11875           ELSE
 11876           GO TO 7282-NEXT-GROUP-SEARCH.
 11877
 11878     SET TA2    UP BY 1
 11879     SET TA21   TO TA2
 11880     SET TA21   UP BY 1
 11881     GO TO 7282-FIND-NEXT-BLANK.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 242
* EL152.cbl
 11882
 11883 7282-EXIT.
 11884     EXIT.
 11885
 11886
 11887 7283-MOVE.
 11888     MOVE WS-TEMP-2 (MOVE-INDX) TO WS-TEMP-1 (TA1)
 11889     SET TA1 UP BY +1.
 11890
 11891
 11892 7284-MOVE-BACK.
 11893     MOVE WS-TEMP-1 (TA1)       TO WS-TEMP-2 (MOVE-INDX).
 11894     SET TA1 UP BY +1.
 11895
 11896 7285-TEST-AND-TRANSLATE.
 11897***BYPASS IF THE AREA MAY BE A PO BOX, OR RR NUMBER
 11898     IF WS-TEMP-AREA1 = '.O.' OR 'RR' OR 'O'
 11899        GO TO 7285-EXIT.
 11900
 11901***BYPASS IF IT IS A CITY/STATE LINE AND BEYOND CHARACTER 07
 11902***AND IT APPEARS THAT IT MAY BE A ABREVIATION.
 11903
 11904     SET WS-POSITION2   TO TA2
 11905     SET WS-POSITION21  TO TA21
 11906     COMPUTE WS-WORD-LENGTH = WS-POSITION21 - WS-POSITION2
 11907     IF WS-WORD-LENGTH LESS THAN 3 AND
 11908        WS-STATE-LINE = 'Y' AND
 11909        TA2 GREATER THAN 07
 11910        GO TO 7285-EXIT.
 11911
 11912     INSPECT WS-TEMP-AREA1 CONVERTING UPPER-CASE TO LOWER-CASE.
 11913
 11914 7285-EXIT.
 11915     EXIT.
 11916
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 243
* EL152.cbl
 11918 7290-RESOLVE-CREDITOR.
 11919
 11920
 11921* EXEC CICS HANDLE CONDITION
 11922*         NOTOPEN    (7290-BENE-NOT-OPEN)
 11923*         NOTFND     (7290-EXIT)
 11924*    END-EXEC.
 11925*    MOVE '"$JI                  ! D #00010829' TO DFHEIV0
 11926     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11927     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11928     MOVE X'4420233030303130383239' TO DFHEIV0(25:11)
 11929     CALL 'kxdfhei1' USING DFHEIV0
 11930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11931
 11932
 11933     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 11934
 11935     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 11936     MOVE 'B'                    TO BENE-REC-TYPE.
 11937     MOVE SPACES                 TO BENE-NUMBER.
 11938     MOVE CL-CURRENT-GROUPING    TO BENE-CREDITOR.
 11939
 11940
 11941* EXEC CICS READ
 11942*         DATASET    (BENE-ID)
 11943*         SET        (ADDRESS OF BENEFICIARY-MASTER)
 11944*         RIDFLD     (BENE-KEY)
 11945*    END-EXEC.
 11946*    MOVE '&"S        E          (   #00010841' TO DFHEIV0
 11947     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11948     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11949     MOVE X'2020233030303130383431' TO DFHEIV0(25:11)
 11950     CALL 'kxdfhei1' USING DFHEIV0,
 11951           BENE-ID,
 11952           DFHEIV20,
 11953           DFHEIV99,
 11954           BENE-KEY,
 11955           DFHEIV99,
 11956           DFHEIV99,
 11957           DFHEIV99
 11958     SET ADDRESS OF BENEFICIARY-MASTER TO
 11959         DFHEIV20
 11960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11961
 11962
 11963     IF LOWER-CASE-LETTERS-USED
 11964         MOVE BE-MAIL-TO-NAME    TO WS-TEMP-AREA2
 11965         PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11966         MOVE WS-TEMP-AREA2      TO SS56D
 11967     ELSE
 11968         MOVE BE-MAIL-TO-NAME    TO SS56D.
 11969
 11970     GO TO 7290-EXIT.
 11971
 11972 7290-BENE-NOT-OPEN.
 11973
 11974     MOVE ER-7675                TO EMI-ERROR.
 11975     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 244
* EL152.cbl
 11976     MOVE -1                     TO MAINTL.
 11977     GO TO 8200-SEND-DATAONLY.
 11978
 11979 7290-EXIT.
 11980     EXIT.
 11981
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 245
* EL152.cbl
 11983 7300-VARIABLE-SEARCH.
 11984***************************************************************
 11985*    THIS ROUTINE SEARCHES THE NEWLY CREATED LETTER FOR ANY   *
 11986*    VARIABLE SYMBOL AND WILL REPLACE THE VARIABLE SYMBOL     *
 11987*    WITH THE CORRESPONDING DATA FROM THE SYSTEM DEFINED      *
 11988*    DATA THAT WAS GENERATED IN PARAGRAPHS 7200-7299.         *
 11989*                                                             *
 11990*    THE ADDRESSING OF THE VARIABLE TABLE IS ACCOMPLISHED     *
 11991*    BY DOING A GETMAIN, MOVING THE TABLE TO THE NEW STORAGE  *
 11992*    AND BY ADJUSTING THE BLL POINTER TO POINT AT THE DATA.   *
 11993***************************************************************
 11994
 11995     MOVE REC-TEXT (TB-INDX)     TO SINGLE-LINE.
 11996
 11997     SET INDX1 TO 1.
 11998 7301-LOOP.
 11999     IF INDX1 > 70
 12000        MOVE SINGLE-LINE         TO REC-TEXT (TB-INDX)
 12001        GO TO 7399-EXIT.
 12002
 12003     IF ONE-CHAR (INDX1) NOT = '@'
 12004        SET INDX1 UP BY 1
 12005        GO TO 7301-LOOP.
 12006
 12007     SET INDX2 TO INDX1.
 12008     SET INDX2 UP BY 1.
 12009
 12010     IF ONE-CHAR (INDX2) = '@'
 12011        SET INDX1 UP BY 2
 12012        GO TO 7301-LOOP.
 12013
 12014     MOVE ONE-CHAR (INDX2)       TO V1.
 12015     SET INDX2 UP BY 1.
 12016     MOVE ONE-CHAR (INDX2)       TO V2.
 12017     SET INDX2 UP BY 1.
 12018     MOVE ONE-CHAR (INDX2)       TO V3.
 12019     SET INDX2 UP BY 1.
 12020     MOVE ONE-CHAR (INDX2)       TO V4.
 12021
 12022     IF V-NUM NOT NUMERIC
 12023        GO TO 7330-VAR-ERROR.
 12024
 12025     IF V-PERIOD NOT = '.'
 12026        MOVE '.'                 TO V-PERIOD
 12027        MOVE ZERO                TO V-DECIMAL
 12028        GO TO 7340-TABLE-SEARCH.
 12029
 12030     IF V-DECIMAL NUMERIC
 12031        GO TO 7340-TABLE-SEARCH.
 12032
 12033 7330-VAR-ERROR.
 12034     MOVE ER-0180                TO EMI-ERROR.
 12035     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12036     SET INDX1 UP BY 1.
 12037     GO TO 7301-LOOP.
 12038
 12039 7340-TABLE-SEARCH.
 12040
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 246
* EL152.cbl
 12041     IF REFRESH-GETMAIN-AREA
 12042*        MOVE SAVE-VARIABLE-POINTER      TO LCP-WS-ADDR-COMP
 12043*        SET ADDRESS OF SYSTEM-VARIABLES TO LCP-WS-ADDR-PNTR
 12044         MOVE SYSTEM-SUPPORTED-VARIABLES TO SYSTEM-VARIABLES
 12045         MOVE 2                          TO GETMAIN-SWITCH
 12046         MOVE 1                          TO SS-COUNTER
 12047                                            B1
 12048     ELSE
 12049         IF NO-GETMAIN-DONE-YET
 12050*            EXEC CICS GETMAIN
 12051*                 SET       (ADDRESS OF SYSTEM-VARIABLES)
 12052*                 LENGTH    (SS-WORK-AREA-LENGTH)
 12053*            END-EXEC
 12054             MOVE 2              TO GETMAIN-SWITCH
 12055*            SET LCP-WS-ADDR-PNTR TO ADDRESS OF SYSTEM-VARIABLES
 12056*            MOVE LCP-WS-ADDR-COMP
 12057*                                TO SAVE-VARIABLE-POINTER
 12058             MOVE SYSTEM-SUPPORTED-VARIABLES
 12059                                 TO SYSTEM-VARIABLES
 12060             MOVE 1              TO SS-COUNTER
 12061                                    B1
 12062         ELSE
 12063             MOVE 1              TO SS-COUNTER
 12064                                    B1
 12065*            MOVE SAVE-VARIABLE-POINTER
 12066*                                TO LCP-WS-ADDR-COMP
 12067*            SET ADDRESS OF SYSTEM-VARIABLES TO LCP-WS-ADDR-PNTR
 12068         END-IF
 12069     END-IF
 12070     .
 12071 7350-TABLE-LOOP.
 12072
 12073     IF SS-COUNTER  >  SS-NUM-ENTRIES
 12074        GO TO 7330-VAR-ERROR.
 12075
 12076     MOVE SYSTEM-VARIABLES (B1:106)
 12077                                 TO SYS-VAR-ENTRY
 12078     IF SYS-VAR-CODE NOT = VAR-HOLD
 12079        ADD SYS-VAR-LEN          TO B1
 12080*       SET LCP-WS-ADDR-PNTR TO ADDRESS OF SYSTEM-VARIABLES
 12081*       ADD SYS-VAR-LEN          TO LCP-WS-ADDR-COMP
 12082*       SET ADDRESS OF SYSTEM-VARIABLES TO LCP-WS-ADDR-PNTR
 12083        ADD 1                    TO SS-COUNTER
 12084        GO TO 7350-TABLE-LOOP
 12085     END-IF
 12086
 12087     MOVE SYS-VAR-ENTRY          TO VARIABLE-WORK-AREA.
 12088     SET INDXV TO 1.
 12089     SUBTRACT 6                  FROM VAR-LEN.
 12090     PERFORM 7400-MOVE-VAR-DATA VAR-LEN TIMES.
 12091     GO TO 7301-LOOP.
 12092
 12093 7399-EXIT.
 12094      EXIT.
 12095
 12096 7400-MOVE-VAR-DATA.
 12097     IF INDX1 > 70
 12098        MOVE ER-0181             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 247
* EL152.cbl
 12099        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12100        GO TO 7301-LOOP.
 12101
 12102     MOVE VAR-ONE-CHAR (INDXV)   TO ONE-CHAR (INDX1).
 12103     SET INDXV UP BY 1.
 12104     SET INDX1 UP BY 1.
 12105
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 248
* EL152.cbl
 12107 7500-READ-TS.
 12108
 12109* EXEC CICS HANDLE CONDITION
 12110*         QIDERR     (7590-TS-QIDERR)
 12111*         ITEMERR    (7585-TS-ITEMERR)
 12112*    END-EXEC.
 12113*    MOVE '"$N<                  ! E #00010992' TO DFHEIV0
 12114     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 12115     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12116     MOVE X'4520233030303130393932' TO DFHEIV0(25:11)
 12117     CALL 'kxdfhei1' USING DFHEIV0
 12118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12119
 12120
 12121     SET TS-INDX TO 1.
 12122     MOVE 1                      TO TS-ITEM.
 12123
 12124 7501-LOOP.
 12125
 12126* EXEC CICS READQ TS
 12127*         INTO     (TS-WORK-AREA)
 12128*         QUEUE    (TS-NAME-TEXT)
 12129*         LENGTH   (TS-LENGTH)
 12130*         ITEM     (TS-ITEM)
 12131*    END-EXEC.
 12132*    MOVE '*$II   L              ''   #00011001' TO DFHEIV0
 12133     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 12134     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12135     MOVE X'2020233030303131303031' TO DFHEIV0(25:11)
 12136     CALL 'kxdfhei1' USING DFHEIV0,
 12137           TS-NAME-TEXT,
 12138           TS-WORK-AREA,
 12139           TS-LENGTH,
 12140           TS-ITEM,
 12141           DFHEIV99,
 12142           DFHEIV99
 12143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12144
 12145
 12146     MOVE TS-WORK-AREA           TO TS-GROUP (TS-INDX).
 12147     SET TS-INDX UP BY 1.
 12148     ADD 1                       TO TS-ITEM.
 12149     GO TO 7501-LOOP.
 12150
 12151 7585-TS-ITEMERR.
 12152     IF EIBTRNID NOT = TRANS-ID
 12153        SUBTRACT 1               FROM TS-ITEM
 12154        MOVE TS-ITEM             TO PI-TEMP-STOR-ITEMS.
 12155
 12156     GO TO 7599-EXIT.
 12157
 12158 7590-TS-QIDERR.
 12159     IF EIBTRNID = TRANS-ID
 12160        MOVE ER-0033             TO EMI-ERROR
 12161        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12162        GO TO 8200-SEND-DATAONLY.
 12163
 12164 7599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 249
* EL152.cbl
 12165      EXIT.
 12166
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 250
* EL152.cbl
 12168 7600-READ-SCREEN-TS.
 12169
 12170* EXEC CICS HANDLE CONDITION
 12171*         QIDERR     (7690-TS-QIDERR)
 12172*         ITEMERR    (7685-TS-ITEMERR)
 12173*    END-EXEC.
 12174*    MOVE '"$N<                  ! F #00011031' TO DFHEIV0
 12175     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 12176     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12177     MOVE X'4620233030303131303331' TO DFHEIV0(25:11)
 12178     CALL 'kxdfhei1' USING DFHEIV0
 12179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12180
 12181
 12182     MOVE 1                      TO TS-ITEM.
 12183
 12184
 12185* EXEC CICS READQ TS
 12186*         INTO    (EL152AO)
 12187*         QUEUE   (TS-NAME-SCREEN)
 12188*         LENGTH  (TS-MAP-LENGTH)
 12189*         ITEM    (TS-ITEM)
 12190*    END-EXEC.
 12191*    MOVE '*$II   L              ''   #00011038' TO DFHEIV0
 12192     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 12193     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12194     MOVE X'2020233030303131303338' TO DFHEIV0(25:11)
 12195     CALL 'kxdfhei1' USING DFHEIV0,
 12196           TS-NAME-SCREEN,
 12197           EL152AO,
 12198           TS-MAP-LENGTH,
 12199           TS-ITEM,
 12200           DFHEIV99,
 12201           DFHEIV99
 12202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12203
 12204
 12205     IF MAINTL NOT = ZEROS
 12206        MOVE AL-UANON            TO MAINTA.
 12207     IF ARCHNUML NOT = ZEROS
 12208        MOVE AL-UNNON            TO ARCHNUMA.
 12209     IF FORML NOT = ZEROS
 12210        MOVE AL-UANON            TO FORMA.
 12211     IF FOLLOWL NOT = ZEROS
 12212        MOVE AL-UANON            TO FOLLOWA.
 12213     IF RESENDL NOT = ZEROS
 12214        MOVE AL-UANON            TO RESENDA.
 12215     IF PRINTL NOT = ZEROS
 12216        MOVE AL-UANON            TO PRINTA.
 12217     IF COPIESL NOT = ZEROS
 12218        MOVE AL-UNNON            TO COPIESA.
 12219     IF ADDRL NOT = ZEROS
 12220        MOVE AL-UANON            TO ADDRA.
 12221     IF REL NOT = ZEROS
 12222        MOVE AL-UANON            TO REA.
 12223
 12224     GO TO 7699-EXIT.
 12225
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 251
* EL152.cbl
 12226 7685-TS-ITEMERR.
 12227     GO TO 7699-EXIT.
 12228
 12229 7690-TS-QIDERR.
 12230     IF EIBTRNID = TRANS-ID
 12231        MOVE ER-0033             TO EMI-ERROR
 12232        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12233        GO TO 8200-SEND-DATAONLY.
 12234
 12235 7699-EXIT.
 12236      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 252
* EL152.cbl
 12238
 12239 7700-PUT-TEMP-STOR.
 12240     PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
 12241     PERFORM 7760-DELETE-TEMP-STOR-SCREEN THRU 7760-EXIT.
 12242     SET TS-INDX TO 1.
 12243     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 12244     PERFORM 7780-WRITE-TS THRU 7780-EXIT
 12245             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
 12246             UNTIL TS-GROUP-WORK NOT < PI-TOTAL-LINES.
 12247
 12248 7749-EXIT.
 12249      EXIT.
 12250
 12251 7750-DELETE-TEMP-STOR.
 12252
 12253* EXEC CICS HANDLE CONDITION
 12254*         QIDERR      (7750-EXIT)
 12255*    END-EXEC.
 12256*    MOVE '"$N                   ! G #00011092' TO DFHEIV0
 12257     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 12258     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12259     MOVE X'4720233030303131303932' TO DFHEIV0(25:11)
 12260     CALL 'kxdfhei1' USING DFHEIV0
 12261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12262
 12263
 12264
 12265* EXEC CICS DELETEQ TS
 12266*         QUEUE       (TS-NAME-TEXT)
 12267*    END-EXEC.
 12268*    MOVE '*&                    #   #00011096' TO DFHEIV0
 12269     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 12270     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12271     MOVE X'2020233030303131303936' TO DFHEIV0(25:11)
 12272     CALL 'kxdfhei1' USING DFHEIV0,
 12273           TS-NAME-TEXT,
 12274           DFHEIV99
 12275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12276
 12277
 12278 7750-EXIT.
 12279     EXIT.
 12280
 12281 7760-DELETE-TEMP-STOR-SCREEN.
 12282
 12283* EXEC CICS HANDLE CONDITION
 12284*         QIDERR     (7760-EXIT)
 12285*    END-EXEC.
 12286*    MOVE '"$N                   ! H #00011104' TO DFHEIV0
 12287     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 12288     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12289     MOVE X'4820233030303131313034' TO DFHEIV0(25:11)
 12290     CALL 'kxdfhei1' USING DFHEIV0
 12291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12292
 12293
 12294
 12295* EXEC CICS DELETEQ TS
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 253
* EL152.cbl
 12296*         QUEUE      (TS-NAME-SCREEN)
 12297*    END-EXEC.
 12298*    MOVE '*&                    #   #00011108' TO DFHEIV0
 12299     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 12300     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12301     MOVE X'2020233030303131313038' TO DFHEIV0(25:11)
 12302     CALL 'kxdfhei1' USING DFHEIV0,
 12303           TS-NAME-SCREEN,
 12304           DFHEIV99
 12305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12306
 12307
 12308 7760-EXIT.
 12309     EXIT.
 12310
 12311 7770-DELETE-TEMP-STOR-PI-AREA.
 12312
 12313* EXEC CICS HANDLE CONDITION
 12314*        QIDERR   (7770-EXIT)
 12315*    END-EXEC.
 12316*    MOVE '"$N                   ! I #00011116' TO DFHEIV0
 12317     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 12318     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12319     MOVE X'4920233030303131313136' TO DFHEIV0(25:11)
 12320     CALL 'kxdfhei1' USING DFHEIV0
 12321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12322
 12323
 12324
 12325* EXEC CICS DELETEQ TS
 12326*        QUEUE    (WS-PI-QID)
 12327*    END-EXEC.
 12328*    MOVE '*&                    #   #00011120' TO DFHEIV0
 12329     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 12330     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12331     MOVE X'2020233030303131313230' TO DFHEIV0(25:11)
 12332     CALL 'kxdfhei1' USING DFHEIV0,
 12333           WS-PI-QID,
 12334           DFHEIV99
 12335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12336
 12337
 12338 7770-EXIT.
 12339     EXIT.
 12340
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 254
* EL152.cbl
 12342 7780-WRITE-TS.
 12343     MOVE TS-GROUP (TS-INDX)     TO TS-WORK-AREA.
 12344     SET TS-INDX UP BY 1.
 12345     ADD 1                       TO PI-TEMP-STOR-ITEMS.
 12346
 12347
 12348* EXEC CICS WRITEQ TS
 12349*         FROM    (TS-WORK-AREA)
 12350*         QUEUE   (TS-NAME-TEXT)
 12351*         LENGTH  (TS-LENGTH)
 12352*         ITEM    (PI-TEMP-STOR-ITEMS)
 12353*    END-EXEC.
 12354*    MOVE '*" I                  ''   #00011133' TO DFHEIV0
 12355     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 12356     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12357     MOVE X'2020233030303131313333' TO DFHEIV0(25:11)
 12358     CALL 'kxdfhei1' USING DFHEIV0,
 12359           TS-NAME-TEXT,
 12360           TS-WORK-AREA,
 12361           TS-LENGTH,
 12362           PI-TEMP-STOR-ITEMS,
 12363           DFHEIV99,
 12364           DFHEIV99
 12365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12366
 12367
 12368 7780-EXIT.
 12369     EXIT.
 12370
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 255
* EL152.cbl
 12372 7790-WRITE-SCREEN-TS.
 12373     MOVE 1                      TO TS-ITEM.
 12374
 12375
 12376* EXEC CICS WRITEQ TS
 12377*         FROM    (EL152AI)
 12378*         QUEUE   (TS-NAME-SCREEN)
 12379*         LENGTH  (TS-MAP-LENGTH)
 12380*         ITEM    (TS-ITEM)
 12381*    END-EXEC.
 12382*    MOVE '*" I                  ''   #00011147' TO DFHEIV0
 12383     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 12384     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12385     MOVE X'2020233030303131313437' TO DFHEIV0(25:11)
 12386     CALL 'kxdfhei1' USING DFHEIV0,
 12387           TS-NAME-SCREEN,
 12388           EL152AI,
 12389           TS-MAP-LENGTH,
 12390           TS-ITEM,
 12391           DFHEIV99,
 12392           DFHEIV99
 12393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12394
 12395
 12396 7790-EXIT.
 12397     EXIT.
 12398
 12399 7795-WRITE-PI-AREA-TS.
 12400
 12401* EXEC CICS WRITEQ TS
 12402*        QUEUE    (WS-PI-QID)
 12403*        FROM     (PROGRAM-INTERFACE-BLOCK)
 12404*        LENGTH   (PI-COMM-LENGTH)
 12405*    END-EXEC.
 12406*    MOVE '*"                    ''   #00011158' TO DFHEIV0
 12407     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 12408     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12409     MOVE X'2020233030303131313538' TO DFHEIV0(25:11)
 12410     CALL 'kxdfhei1' USING DFHEIV0,
 12411           WS-PI-QID,
 12412           PROGRAM-INTERFACE-BLOCK,
 12413           PI-COMM-LENGTH,
 12414           DFHEIV99,
 12415           DFHEIV99,
 12416           DFHEIV99
 12417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12418
 12419
 12420 7795-EXIT.
 12421     EXIT.
 12422
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 256
* EL152.cbl
 12424 7800-PRINT-LETTER-NOW.
 12425***************************************************************
 12426*     THIS ROUTINE WILL CAUSE THE CURRENTLY CREATED LETTER    *
 12427*     TO BE PRINTED ON A HARDCOPY PRINTER.                    *
 12428*        THE TEXT IS EDITED FOR ANY UNRESOLVED SYMBOLS,       *
 12429*        THE PRINTER ID IS OBTAINED FROM THE CONTROL FILE,    *
 12430*        THE LETTER IS SAVED IN TEMP-STORAGE,                 *
 12431*        AND A START IS ISSUED FOR THE PRINT TRANSACTION.     *
 12432***************************************************************
 12433
 12434     PERFORM 400-SET-CODES THRU 499-EXIT.
 12435
 12436     PERFORM 7500-READ-TS        THRU 7599-EXIT
 12437     PERFORM 7950-SET-INDX THRU 7950-EXIT.
 12438     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12439             VARYING SC-INDX FROM 1 BY 1
 12440             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
 12441
 12442     IF PI-TOTAL-LINES = 0
 12443        MOVE ER-0187             TO EMI-ERROR
 12444        MOVE -1                  TO MAINTL
 12445        MOVE AL-UABON            TO MAINTA
 12446        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12447        GO TO 8200-SEND-DATAONLY.
 12448
 12449     IF COPIESL NOT = ZEROS
 12450        IF COPIESI NOT NUMERIC
 12451           MOVE ER-0184          TO EMI-ERROR
 12452           MOVE -1               TO COPIESL
 12453           MOVE AL-UNBON         TO COPIESA
 12454           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12455           GO TO 8200-SEND-DATAONLY
 12456         ELSE
 12457           MOVE COPIESI          TO PI-NUM-PRINT-COPIES
 12458       ELSE
 12459        MOVE 1                   TO PI-NUM-PRINT-COPIES.
 12460
 12461*    PERFORM 7500-READ-TS        THRU 7599-EXIT
 12462*    PERFORM 7950-SET-INDX THRU 7950-EXIT.
 12463*    PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12464*            VARYING SC-INDX FROM 1 BY 1
 12465*            UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
 12466
 12467     MOVE +0                     TO TALLY.
 12468     INSPECT RECORD-TABLE TALLYING TALLY
 12469                                 FOR CHARACTERS BEFORE '@'.
 12470
 12471     IF TALLY < +21900
 12472        COMPUTE PI-CURRENT-LINE = TALLY / 73
 12473        MOVE ZEROS               TO ROLL-COUNTER
 12474        MOVE ER-0191             TO EMI-ERROR
 12475        MOVE -1                  TO MAINTL
 12476        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12477        GO TO 7900-ROLL-PAGE.
 12478
 12479 7800-UPDATE-CLAIM.
 12480
 12481     IF PI-RETURN-TO-PROGRAM = PGM-EL126
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 257
* EL152.cbl
 12482         GO TO 7800-GET-PRINTER.
 12483
 12484     MOVE PI-COMPANY-CD          TO  CLAM-CO.
 12485     MOVE PI-CARRIER             TO  CLAM-CARRIER.
 12486     MOVE PI-CLAIM-NO            TO  CLAM-CLAIM.
 12487     MOVE PI-CERT-NO             TO  CLAM-CERT-NUM.
 12488
 12489
 12490* EXEC CICS HANDLE CONDITION
 12491*        NOTOPEN   (8860-CLAM-NOT-OPEN)
 12492*        NOTFND    (7800-CLAIM-NOT-FOUND)
 12493*    END-EXEC.
 12494*    MOVE '"$JI                  ! J #00011233' TO DFHEIV0
 12495     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12496     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12497     MOVE X'4A20233030303131323333' TO DFHEIV0(25:11)
 12498     CALL 'kxdfhei1' USING DFHEIV0
 12499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12500
 12501
 12502
 12503* EXEC CICS READ
 12504*        DATASET   (CLAM-ID)
 12505*        RIDFLD    (CLAM-KEY)
 12506*        SET       (ADDRESS OF CLAIM-MASTER)
 12507*        UPDATE
 12508*    END-EXEC.
 12509*    MOVE '&"S        EU         (   #00011238' TO DFHEIV0
 12510     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12511     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12512     MOVE X'2020233030303131323338' TO DFHEIV0(25:11)
 12513     CALL 'kxdfhei1' USING DFHEIV0,
 12514           CLAM-ID,
 12515           DFHEIV20,
 12516           DFHEIV99,
 12517           CLAM-KEY,
 12518           DFHEIV99,
 12519           DFHEIV99,
 12520           DFHEIV99
 12521     SET ADDRESS OF CLAIM-MASTER TO
 12522         DFHEIV20
 12523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12524
 12525
 12526     MOVE PI-PROCESSOR-ID        TO  CL-LAST-MAINT-USER.
 12527     MOVE EIBTIME                TO  CL-LAST-MAINT-HHMMSS.
 12528     MOVE CURRENT-SAVE           TO  CL-LAST-MAINT-DT.
 12529     MOVE '2'                    TO  CL-LAST-MAINT-TYPE.
 12530
 12531
 12532* EXEC CICS HANDLE CONDITION
 12533*        DUPKEY    (7800-GET-PRINTER)
 12534*    END-EXEC.
 12535*    MOVE '"$$                   ! K #00011250' TO DFHEIV0
 12536     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12537     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12538     MOVE X'4B20233030303131323530' TO DFHEIV0(25:11)
 12539     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 258
* EL152.cbl
 12540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12541
 12542
 12543
 12544* EXEC CICS REWRITE
 12545*        DATASET   (CLAM-ID)
 12546*        FROM      (CLAIM-MASTER)
 12547*    END-EXEC.
 12548     MOVE LENGTH OF
 12549      CLAIM-MASTER
 12550       TO DFHEIV11
 12551*    MOVE '&& L                  %   #00011254' TO DFHEIV0
 12552     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12553     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12554     MOVE X'2020233030303131323534' TO DFHEIV0(25:11)
 12555     CALL 'kxdfhei1' USING DFHEIV0,
 12556           CLAM-ID,
 12557           CLAIM-MASTER,
 12558           DFHEIV11,
 12559           DFHEIV99
 12560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12561
 12562
 12563     GO TO 7800-GET-PRINTER.
 12564
 12565 7800-CLAIM-NOT-FOUND.
 12566
 12567     MOVE ER-0133                TO  EMI-ERROR.
 12568     MOVE -1                     TO  MAINTL.
 12569     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12570     GO TO 8200-SEND-DATAONLY.
 12571
 12572 7800-GET-PRINTER.
 12573
 12574     IF PI-ALT-PRINTER-ID NOT = SPACES
 12575        GO TO 7800-CNTL-BYPASS.
 12576
 12577     MOVE '1'                    TO CNTL-RECORD-TYPE.
 12578     MOVE SPACES                 TO CNTL-GENL.
 12579     MOVE ZEROS                  TO CNTL-SEQ.
 12580
 12581
 12582* EXEC CICS HANDLE CONDITION
 12583*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 12584*         NOTFND     (7890-NOT-FOUND)
 12585*    END-EXEC.
 12586*    MOVE '"$JI                  ! L #00011277' TO DFHEIV0
 12587     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12588     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12589     MOVE X'4C20233030303131323737' TO DFHEIV0(25:11)
 12590     CALL 'kxdfhei1' USING DFHEIV0
 12591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12592
 12593
 12594
 12595* EXEC CICS READ
 12596*         DATASET    (CNTL-ID)
 12597*         SET        (ADDRESS OF CONTROL-FILE)
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 259
* EL152.cbl
 12598*         RIDFLD     (CNTL-KEY)
 12599*    END-EXEC.
 12600*    MOVE '&"S        E          (   #00011282' TO DFHEIV0
 12601     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12602     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12603     MOVE X'2020233030303131323832' TO DFHEIV0(25:11)
 12604     CALL 'kxdfhei1' USING DFHEIV0,
 12605           CNTL-ID,
 12606           DFHEIV20,
 12607           DFHEIV99,
 12608           CNTL-KEY,
 12609           DFHEIV99,
 12610           DFHEIV99,
 12611           DFHEIV99
 12612     SET ADDRESS OF CONTROL-FILE TO
 12613         DFHEIV20
 12614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12615
 12616
 12617*    MOVE CF-FORMS-PRINTER-ID       TO TS-TERM-TEXT.
 12618     MOVE CF-FORMS-PRINTER-ID    TO WS-PRINTER-ID
 12619     GO TO 7800-SET-UP-TS.
 12620
 12621 7800-CNTL-BYPASS.
 12622*    MOVE PI-ALT-PRINTER-ID         TO TS-TERM-TEXT.
 12623     MOVE PI-ALT-PRINTER-ID      TO WS-PRINTER-ID.
 12624
 12625 7800-SET-UP-TS.
 12626
 12627***********************************************************
 12628*      CHECK TO SEE IF IT IS A PRINT REQUEST FOR PRINTING *
 12629*      LETTERS ON A 3275 PRINTER. IF SO, SAVE THE SCREEN  *
 12630***********************************************************
 12631
 12632     IF TS-TERM-PREFIX = 'DU'
 12633        PERFORM 7760-DELETE-TEMP-STOR-SCREEN THRU 7760-EXIT
 12634        PERFORM 7790-WRITE-SCREEN-TS THRU 7790-EXIT.
 12635
 12636     SET TS-INDX TO 1.
 12637
 12638
 12639* EXEC CICS ASKTIME
 12640*    END-EXEC.
 12641*    MOVE '0"                    "   #00011309' TO DFHEIV0
 12642     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
 12643     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 12644     MOVE X'2020233030303131333039' TO DFHEIV0(25:11)
 12645     CALL 'kxdfhei1' USING DFHEIV0,
 12646           DFHEIV99
 12647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12648
 12649
 12650     MOVE EIBTIME                TO TS-ID-TIME.
 12651*    MOVE '152A'                 TO TS-ID-TEXT
 12652     MOVE TS-NAME-TEXT           TO PI-TEMP-STOR-ID.
 12653     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 12654
 12655     PERFORM 7780-WRITE-TS THRU 7780-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 260
* EL152.cbl
 12656             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
 12657             UNTIL TS-GROUP-WORK NOT < PI-TOTAL-LINES
 12658
 12659     IF NOT PI-SHOW-MODE
 12660        MOVE '1'                 TO PI-PRINT-SW.
 12661
 12662
 12663* EXEC CICS HANDLE CONDITION
 12664*         TERMIDERR  (8820-TERM-ERROR)
 12665*         TRANSIDERR (8830-TRAN-ERROR)
 12666*    END-EXEC.
 12667*    MOVE '"$[\                  ! M #00011324' TO DFHEIV0
 12668     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
 12669     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12670     MOVE X'4D20233030303131333234' TO DFHEIV0(25:11)
 12671     CALL 'kxdfhei1' USING DFHEIV0
 12672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12673
 12674
 12675*    IF PI-COMPANY-ID = 'DMD' OR 'XXX'
 12676*        MOVE EIBTRMID    TO TS-TERM-TEXT
 12677*        EXEC CICS START
 12678*             INTERVAL    (0)
 12679*             TRANSID     (PRINT-TRANS)
 12680*             FROM        (PROGRAM-INTERFACE-BLOCK)
 12681*             LENGTH      (PI-COMM-LENGTH)
 12682*             TERMID      (TS-TERM-TEXT)
 12683*        END-EXEC
 12684*    ELSE
 12685
 12686* EXEC CICS START
 12687*             INTERVAL    (0)
 12688*             TRANSID     (PRINT-TRANS)
 12689*             FROM        (PROGRAM-INTERFACE-BLOCK)
 12690*             LENGTH      (PI-COMM-LENGTH)
 12691*             TERMID      (TS-TERM-TEXT)
 12692*             TERMID      (WS-PRINTER-ID)
 12693*        END-EXEC.
 12694     MOVE 0 TO DFHEIV10
 12695*    MOVE '0(ILFT                0   #00011339' TO DFHEIV0
 12696     MOVE X'3028494C4654202020202020' TO DFHEIV0(1:12)
 12697     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
 12698     MOVE X'2020233030303131333339' TO DFHEIV0(25:11)
 12699     CALL 'kxdfhei1' USING DFHEIV0,
 12700           DFHEIV10,
 12701           PRINT-TRANS,
 12702           DFHEIV99,
 12703           PROGRAM-INTERFACE-BLOCK,
 12704           PI-COMM-LENGTH,
 12705           WS-PRINTER-ID,
 12706           DFHEIV99,
 12707           DFHEIV99,
 12708           DFHEIV99,
 12709           DFHEIV99,
 12710           DFHEIV99,
 12711           DFHEIV99,
 12712           DFHEIV99,
 12713           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 261
* EL152.cbl
 12714           DFHEIV99
 12715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12716
 12717
 12718     MOVE '104A'                 TO TS-ID-TEXT
 12719     MOVE ER-0189                TO EMI-ERROR.
 12720     MOVE -1                     TO MAINTL.
 12721     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 12722     MOVE ' PRINT TRANS STARTED ' TO EMI-MESSAGE-AREA (1)
 12723     MOVE PI-TEMP-STOR-ID TO EMI-MESSAGE-AREA (1) (25:10)
 12724
 12725     GO TO 8200-SEND-DATAONLY.
 12726
 12727 7890-NOT-FOUND.
 12728     MOVE ER-0190                TO EMI-ERROR.
 12729     MOVE -1                     TO MAINTL.
 12730     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12731     GO TO 8200-SEND-DATAONLY.
 12732
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 262
* EL152.cbl
 12734 7900-ROLL-PAGE.
 12735     IF ENTERPFL NOT = ZEROS
 12736        MOVE -1                  TO ENTERPFL
 12737       ELSE
 12738        MOVE -1                  TO MAINTL.
 12739
 12740     PERFORM 7500-READ-TS     THRU 7599-EXIT
 12741     PERFORM 7950-SET-INDX    THRU 7950-EXIT
 12742     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12743        VARYING SC-INDX FROM 1 BY 1 UNTIL
 12744        SC-INDX > NUM-LINES-PER-SCREEN
 12745     IF PI-TOTAL-LINES = 0
 12746        MOVE ER-0047             TO EMI-ERROR
 12747        MOVE -1                  TO MAINTL
 12748        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12749        GO TO 8200-SEND-DATAONLY.
 12750
 12751     COMPUTE TEMP-CURR-LINE = PI-CURRENT-LINE + ROLL-COUNTER.
 12752
 12753     IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
 12754        MOVE ER-0067             TO EMI-ERROR
 12755        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12756        MOVE 1                   TO TEMP-CURR-LINE.
 12757
 12758     IF TEMP-CURR-LINE > PI-TOTAL-LINES
 12759        MOVE ER-0066             TO EMI-ERROR
 12760        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12761        COMPUTE TEMP-CURR-LINE
 12762            = PI-TOTAL-LINES + 1 - NUM-LINES-PER-SCREEN
 12763        IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
 12764            MOVE 1 TO TEMP-CURR-LINE.
 12765
 12766*    IF EMI-ERROR NOT = ER-0191
 12767*       PERFORM 7500-READ-TS     THRU 7599-EXIT
 12768*       PERFORM 7950-SET-INDX    THRU 7950-EXIT
 12769*       PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12770*                VARYING SC-INDX FROM 1 BY 1 UNTIL
 12771*                SC-INDX > NUM-LINES-PER-SCREEN
 12772*    END-IF
 12773
 12774     IF EMI-ERROR = ER-0066 OR ER-0067 OR ER-0000 OR ER-0191
 12775        NEXT SENTENCE
 12776     ELSE
 12777        GO TO 8200-SEND-DATAONLY.
 12778
 12779*    PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
 12780     MOVE TEMP-CURR-LINE         TO PI-CURRENT-LINE.
 12781     SET TB-INDX                 TO PI-CURRENT-LINE.
 12782     MOVE LOW-VALUES             TO EL152RI.
 12783
 12784*    PERFORM 7500-READ-TS        THRU 7599-EXIT
 12785     PERFORM 7170-FORMAT-SCREEN THRU 7170-EXIT
 12786             VARYING SC-INDX FROM 1 BY 1
 12787             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
 12788
 12789     GO TO 8200-SEND-DATAONLY.
 12790
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 263
* EL152.cbl
 12792 7950-SET-INDX.
 12793     IF PI-CURRENT-LINE = 0
 12794        SET TB-INDX TO 1
 12795       ELSE
 12796        SET TB-INDX              TO PI-CURRENT-LINE.
 12797
 12798 7950-EXIT.
 12799      EXIT.
 12800
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 264
* EL152.cbl
 12802 7960-UPDATE-TABLE-FROM-SCREEN.
 12803     IF SC-TEXTL (SC-INDX) NOT = ZEROS
 12804        IF TB-INDX > PI-TOTAL-LINES
 12805           IF PI-TOTAL-LINES = MAX-LINES
 12806              MOVE ER-0051       TO EMI-ERROR
 12807              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12808              GO TO 8200-SEND-DATAONLY
 12809           ELSE
 12810              MOVE SC-TEXT (SC-INDX) TO REC-TEXT (TB-INDX)
 12811              ADD 1              TO PI-TOTAL-LINES
 12812        ELSE
 12813           MOVE SC-TEXT (SC-INDX) TO REC-TEXT (TB-INDX).
 12814
 12815     SET TB-INDX UP BY 1.
 12816
 12817 7960-EXIT.
 12818      EXIT.
 12819
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 265
* EL152.cbl
 12821 8000-STARTBR-ERACCT.
 12822
 12823     IF WS-ACCT-READ-SW = 'Y'
 12824         NEXT SENTENCE
 12825     ELSE
 12826
 12827* EXEC CICS GETMAIN
 12828*             SET       (ADDRESS OF ACCOUNT-MASTER)
 12829*             LENGTH    (ACCT-LENGTH)
 12830*        END-EXEC.
 12831*    MOVE '," L                  $   #00011456' TO DFHEIV0
 12832     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 12833     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12834     MOVE X'2020233030303131343536' TO DFHEIV0(25:11)
 12835     CALL 'kxdfhei1' USING DFHEIV0,
 12836           DFHEIV20,
 12837           ACCT-LENGTH,
 12838           DFHEIV99
 12839     SET ADDRESS OF ACCOUNT-MASTER TO
 12840         DFHEIV20
 12841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12842
 12843
 12844
 12845* EXEC CICS STARTBR
 12846*        RIDFLD      (ACCT-KEY)
 12847*        DATASET     (ACCT-ID)
 12848*        KEYLENGTH   (20)
 12849*        GENERIC
 12850*    END-EXEC.
 12851     MOVE 20
 12852       TO DFHEIV11
 12853     MOVE 0
 12854       TO DFHEIV12
 12855*    MOVE '&,   KG    G          &   #00011461' TO DFHEIV0
 12856     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 12857     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12858     MOVE X'2020233030303131343631' TO DFHEIV0(25:11)
 12859     CALL 'kxdfhei1' USING DFHEIV0,
 12860           ACCT-ID,
 12861           ACCT-KEY,
 12862           DFHEIV11,
 12863           DFHEIV12,
 12864           DFHEIV99
 12865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12866
 12867
 12868     MOVE 'Y'         TO ACCT-BROWSE-STARTED.
 12869 8000-STARTBR-EXIT.
 12870     EXIT.
 12871
 12872 8000-READNEXT-ERACCT.
 12873
 12874
 12875* EXEC CICS READNEXT
 12876*        DATASET   (ACCT-ID)
 12877*        INTO      (ACCOUNT-MASTER)
 12878*        RIDFLD    (ACCT-KEY)
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 266
* EL152.cbl
 12879*    END-EXEC.
 12880     MOVE LENGTH OF
 12881      ACCOUNT-MASTER
 12882       TO DFHEIV12
 12883     MOVE 0
 12884       TO DFHEIV11
 12885*    MOVE '&.IL                  )   #00011474' TO DFHEIV0
 12886     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12887     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12888     MOVE X'2020233030303131343734' TO DFHEIV0(25:11)
 12889     CALL 'kxdfhei1' USING DFHEIV0,
 12890           ACCT-ID,
 12891           ACCOUNT-MASTER,
 12892           DFHEIV12,
 12893           ACCT-KEY,
 12894           DFHEIV99,
 12895           DFHEIV11,
 12896           DFHEIV99,
 12897           DFHEIV99
 12898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12899
 12900
 12901 8000-READNEXT-EXIT.
 12902     EXIT.
 12903
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 267
* EL152.cbl
 12905*8050-STARTBR-EMPROD. Remove as dead code
 12906*8050-EXIT. Remove as dead code
 12907*8060-READNEXT-EMPROD. Remove as dead code
 12908*8060-EXIT. Remove as dead code
 12909
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 268
* EL152.cbl
 12911 8100-SEND-INITIAL-MAP.
 12912     PERFORM 7700-PUT-TEMP-STOR  THRU 7749-EXIT
 12913     MOVE SAVE-DATE              TO DATEAO.
 12914     MOVE EIBTIME                TO TIME-IN.
 12915     MOVE TIME-OUT               TO TIMEAO.
 12916
 12917     MOVE PI-CARRIER             TO CARRO
 12918     MOVE PI-CLAIM-NO            TO CLMNOO
 12919     MOVE PI-CERT-NO             TO CRTNOO
 12920     MOVE PI-PROCESSOR-ID        TO PROCO
 12921     MOVE PI-COMPANY-ID          TO COMPIDO
 12922     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 12923                                 TO SYSO
 12924     MOVE PI-ENCLOSURE-CD        TO ENCO
 12925     IF NOT EMI-NO-ERRORS
 12926         SET EMI-INDX TO 1
 12927         MOVE EMI-MESSAGE-AREA (EMI-INDX) TO ERRMSGO
 12928     ELSE
 12929         MOVE SPACES             TO ERRMSGO.
 12930
 12931     MOVE -1                     TO MAINTL.
 12932
 12933
 12934* EXEC CICS SEND
 12935*        MAP      (MAP-NAME)
 12936*        MAPSET   (MAPSET-NAME)
 12937*        FROM     (EL152AO)
 12938*        ERASE
 12939*        CURSOR
 12940*    END-EXEC.
 12941     MOVE LENGTH OF
 12942      EL152AO
 12943       TO DFHEIV12
 12944     MOVE -1
 12945       TO DFHEIV11
 12946*    MOVE '8$     CT  E    H L F ,   #00011512' TO DFHEIV0
 12947     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 12948     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 12949     MOVE X'2020233030303131353132' TO DFHEIV0(25:11)
 12950     CALL 'kxdfhei1' USING DFHEIV0,
 12951           MAP-NAME,
 12952           EL152AO,
 12953           DFHEIV12,
 12954           MAPSET-NAME,
 12955           DFHEIV99,
 12956           DFHEIV99,
 12957           DFHEIV99,
 12958           DFHEIV11,
 12959           DFHEIV99,
 12960           DFHEIV99,
 12961           DFHEIV99
 12962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12963
 12964
 12965     PERFORM 8210-ENDBR  THRU 8210-EXIT.
 12966     PERFORM 8220-ENDBR-EMPROD THRU 8220-EXIT.
 12967
 12968     GO TO 9000-RETURN-TRANS.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 269
* EL152.cbl
 12969*    GO TO 0200-RECEIVE.
 12970
 12971 8200-SEND-DATAONLY.
 12972     PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
 12973     MOVE PI-ENCLOSURE-CD        TO ENCO
 12974     MOVE SAVE-DATE              TO DATEAO.
 12975     MOVE EIBTIME                TO TIME-IN.
 12976     MOVE TIME-OUT               TO TIMEAO.
 12977     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
 12978
 12979*    IF PI-COMPANY-ID = 'DMD'
 12980*       IF FORCE-7840
 12981*          MOVE '7840 FORCED' TO PFKEY9O
 12982*          MOVE AL-SABON      TO PFKEY9A.
 12983
 12984
 12985* EXEC CICS SEND
 12986*        MAP      (MAP-NAME)
 12987*        MAPSET   (MAPSET-NAME)
 12988*        FROM     (EL152AO)
 12989*        DATAONLY
 12990*        CURSOR
 12991*    END-EXEC.
 12992     MOVE LENGTH OF
 12993      EL152AO
 12994       TO DFHEIV12
 12995     MOVE -1
 12996       TO DFHEIV11
 12997*    MOVE '8$D    CT       H L F ,   #00011539' TO DFHEIV0
 12998     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 12999     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 13000     MOVE X'2020233030303131353339' TO DFHEIV0(25:11)
 13001     CALL 'kxdfhei1' USING DFHEIV0,
 13002           MAP-NAME,
 13003           EL152AO,
 13004           DFHEIV12,
 13005           MAPSET-NAME,
 13006           DFHEIV99,
 13007           DFHEIV99,
 13008           DFHEIV99,
 13009           DFHEIV11,
 13010           DFHEIV99,
 13011           DFHEIV99,
 13012           DFHEIV99
 13013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13014
 13015
 13016     PERFORM 8210-ENDBR  THRU 8210-EXIT.
 13017     PERFORM 8220-ENDBR-EMPROD THRU 8220-EXIT.
 13018
 13019     GO TO 9000-RETURN-TRANS.
 13020*    GO TO 0200-RECEIVE.
 13021
 13022 8200-SEND-DATAONLY-ERASEAUP.
 13023     PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
 13024     MOVE PI-ENCLOSURE-CD        TO ENCO
 13025     MOVE SAVE-DATE              TO DATEAO.
 13026     MOVE EIBTIME                TO TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 270
* EL152.cbl
 13027     MOVE TIME-OUT               TO TIMEAO.
 13028     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
 13029
 13030* EXEC CICS SEND
 13031*        MAP      (MAP-NAME)
 13032*        MAPSET   (MAPSET-NAME)
 13033*        FROM     (EL152AO)
 13034*        DATAONLY
 13035*        ERASEAUP
 13036*        CURSOR
 13037*    END-EXEC.
 13038     MOVE LENGTH OF
 13039      EL152AO
 13040       TO DFHEIV12
 13041     MOVE -1
 13042       TO DFHEIV11
 13043*    MOVE '8$D    CT  A    H L F ,   #00011560' TO DFHEIV0
 13044     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 13045     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 13046     MOVE X'2020233030303131353630' TO DFHEIV0(25:11)
 13047     CALL 'kxdfhei1' USING DFHEIV0,
 13048           MAP-NAME,
 13049           EL152AO,
 13050           DFHEIV12,
 13051           MAPSET-NAME,
 13052           DFHEIV99,
 13053           DFHEIV99,
 13054           DFHEIV99,
 13055           DFHEIV11,
 13056           DFHEIV99,
 13057           DFHEIV99,
 13058           DFHEIV99
 13059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13060
 13061
 13062     PERFORM 8210-ENDBR  THRU 8210-EXIT.
 13063     PERFORM 8220-ENDBR-EMPROD THRU 8220-EXIT.
 13064
 13065     GO TO 9000-RETURN-TRANS.
 13066*    GO TO 0200-RECEIVE.
 13067
 13068 8210-ENDBR.
 13069     IF ACCT-BROWSE-STARTED = 'Y'
 13070        MOVE 'N'                  TO ACCT-BROWSE-STARTED
 13071
 13072* EXEC CICS ENDBR
 13073*            DATASET    (ACCT-ID)
 13074*       END-EXEC.
 13075     MOVE 0
 13076       TO DFHEIV11
 13077*    MOVE '&2                    $   #00011578' TO DFHEIV0
 13078     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13079     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13080     MOVE X'2020233030303131353738' TO DFHEIV0(25:11)
 13081     CALL 'kxdfhei1' USING DFHEIV0,
 13082           ACCT-ID,
 13083           DFHEIV11,
 13084           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 271
* EL152.cbl
 13085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13086
 13087
 13088 8210-EXIT.
 13089     EXIT.
 13090
 13091 8220-ENDBR-EMPROD.
 13092     IF PROD-BROWSE-STARTED = 'Y'
 13093        MOVE 'N'                  TO PROD-BROWSE-STARTED
 13094
 13095* EXEC CICS ENDBR
 13096*            DATASET    (PROD-ID)
 13097*       END-EXEC.
 13098     MOVE 0
 13099       TO DFHEIV11
 13100*    MOVE '&2                    $   #00011588' TO DFHEIV0
 13101     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13102     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13103     MOVE X'2020233030303131353838' TO DFHEIV0(25:11)
 13104     CALL 'kxdfhei1' USING DFHEIV0,
 13105           PROD-ID,
 13106           DFHEIV11,
 13107           DFHEIV99
 13108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13109
 13110
 13111 8220-EXIT.
 13112     EXIT.
 13113
 13114 8300-SEND-TEXT.
 13115
 13116* EXEC CICS SEND TEXT
 13117*        FROM    (LOGOFF-TEXT)
 13118*        LENGTH  (LOGOFF-LENGTH)
 13119*        ERASE
 13120*        FREEKB
 13121*    END-EXEC.
 13122*    MOVE '8&      T  E F  H   F -   #00011596' TO DFHEIV0
 13123     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 13124     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 13125     MOVE X'2020233030303131353936' TO DFHEIV0(25:11)
 13126     CALL 'kxdfhei1' USING DFHEIV0,
 13127           LOGOFF-TEXT,
 13128           LOGOFF-LENGTH,
 13129           DFHEIV99,
 13130           DFHEIV99,
 13131           DFHEIV99,
 13132           DFHEIV99,
 13133           DFHEIV99,
 13134           DFHEIV99,
 13135           DFHEIV99,
 13136           DFHEIV99,
 13137           DFHEIV99,
 13138           DFHEIV99
 13139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13140
 13141
 13142
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 272
* EL152.cbl
 13143* EXEC CICS RETURN
 13144*    END-EXEC.
 13145*    MOVE '.(                    &   #00011603' TO DFHEIV0
 13146     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 13147     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13148     MOVE X'2020233030303131363033' TO DFHEIV0(25:11)
 13149     CALL 'kxdfhei1' USING DFHEIV0,
 13150           DFHEIV99,
 13151           DFHEIV99,
 13152           DFHEIV99,
 13153           DFHEIV99,
 13154           DFHEIV99
 13155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13156
 13157
 13158 8600-DEEDIT.
 13159
 13160* EXEC CICS BIF DEEDIT
 13161*         FIELD    (DEEDIT-FIELD)
 13162*         LENGTH   (15)
 13163*    END-EXEC.
 13164     MOVE 15
 13165       TO DFHEIV11
 13166*    MOVE '@"L                   #   #00011607' TO DFHEIV0
 13167     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13168     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13169     MOVE X'2020233030303131363037' TO DFHEIV0(25:11)
 13170     CALL 'kxdfhei1' USING DFHEIV0,
 13171           DEEDIT-FIELD,
 13172           DFHEIV11
 13173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13174
 13175
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 273
* EL152.cbl
 13177 8800-UNAUTHORIZED-ACCESS.
 13178     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 13179     GO TO 8300-SEND-TEXT.
 13180
 13181 8810-PF23.
 13182     PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
 13183     MOVE ZEROS                  TO PI-TOTAL-LINES.
 13184     MOVE ZEROS                  TO PI-CURRENT-LINE.
 13185     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 13186     MOVE XCTL-005               TO PGM-NAME.
 13187     GO TO 9300-XCTL.
 13188
 13189 8820-TERM-ERROR.
 13190     MOVE ER-0412                TO EMI-ERROR.
 13191     MOVE SPACES                 TO PI-PRINT-SW.
 13192     GO TO 8999-OPEN-ERROR.
 13193
 13194 8830-TRAN-ERROR.
 13195     MOVE ER-0413                TO EMI-ERROR.
 13196     MOVE SPACES                 TO PI-PRINT-SW.
 13197     GO TO 8999-OPEN-ERROR.
 13198
 13199 8840-CNTL-NOT-OPEN.
 13200     MOVE ER-0042                TO EMI-ERROR.
 13201     GO TO 8999-OPEN-ERROR.
 13202
 13203 8850-ARCH-NOT-OPEN.
 13204     MOVE ER-0332                TO EMI-ERROR.
 13205     GO TO 8999-OPEN-ERROR.
 13206
 13207 8860-CLAM-NOT-OPEN.
 13208     MOVE ER-0154                TO EMI-ERROR.
 13209     GO TO 8999-OPEN-ERROR.
 13210
 13211 8870-ACTV-NOT-OPEN.
 13212     MOVE ER-0172                TO EMI-ERROR.
 13213     GO TO 8999-OPEN-ERROR.
 13214
 13215 8880-ACCT-NOT-OPEN.
 13216     MOVE ER-0168                TO EMI-ERROR.
 13217     GO TO 8999-OPEN-ERROR.
 13218
 13219 8890-TEXT-NOT-OPEN.
 13220     MOVE ER-0013                TO EMI-ERROR.
 13221     GO TO 8999-OPEN-ERROR.
 13222
 13223 8900-CERT-NOT-OPEN.
 13224     MOVE ER-0169                TO EMI-ERROR.
 13225     GO TO 8999-OPEN-ERROR.
 13226
 13227 8910-CERT-NOT-FOUND.
 13228     MOVE ER-0206                TO EMI-ERROR.
 13229     GO TO 8999-OPEN-ERROR.
 13230
 13231 8915-PROD-NOT-OPEN.
 13232     MOVE ER-9106                TO EMI-ERROR.
 13233     GO TO 8999-OPEN-ERROR.
 13234
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 274
* EL152.cbl
 13235 8920-PLCY-NOT-OPEN.
 13236     MOVE ER-9883                TO EMI-ERROR.
 13237     GO TO 8999-OPEN-ERROR.
 13238
 13239 8925-PLAN-NOT-OPEN.
 13240     MOVE ER-9808                TO EMI-ERROR.
 13241     GO TO 8999-OPEN-ERROR.
 13242
 13243 8930-PLCY-NOT-FOUND.
 13244     MOVE ER-9483                TO EMI-ERROR.
 13245     GO TO 8999-OPEN-ERROR.
 13246
 13247 8999-OPEN-ERROR.
 13248     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13249     MOVE -1                     TO MAINTL.
 13250     GO TO 8200-SEND-DATAONLY.
 13251
 13252 9000-RETURN-TRANS.
 13253
 13254     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
 13255
 13256* EXEC CICS RETURN
 13257*        TRANSID    (TRANS-ID)
 13258*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 13259*        LENGTH     (PI-COMM-LENGTH)
 13260*    END-EXEC.
 13261*    MOVE '.(CT                  &   #00011691' TO DFHEIV0
 13262     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 13263     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13264     MOVE X'2020233030303131363931' TO DFHEIV0(25:11)
 13265     CALL 'kxdfhei1' USING DFHEIV0,
 13266           TRANS-ID,
 13267           PROGRAM-INTERFACE-BLOCK,
 13268           PI-COMM-LENGTH,
 13269           DFHEIV99,
 13270           DFHEIV99
 13271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13272
 13273
 13274
 13275 9000-EXIT.
 13276     EXIT.
 13277 9200-RETURN-MAIN-MENU.
 13278     PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
 13279
 13280     MOVE ZEROS                  TO PI-TOTAL-LINES
 13281                                    PI-CURRENT-LINE.
 13282     MOVE XCTL-126               TO PGM-NAME.
 13283
 13284     GO TO 9300-XCTL.
 13285
 13286 9300-XCTL.
 13287
 13288* EXEC CICS XCTL
 13289*        PROGRAM    (PGM-NAME)
 13290*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 13291*        LENGTH     (PI-COMM-LENGTH)
 13292*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 275
* EL152.cbl
 13293*    MOVE '.$C                   $   #00011710' TO DFHEIV0
 13294     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 13295     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13296     MOVE X'2020233030303131373130' TO DFHEIV0(25:11)
 13297     CALL 'kxdfhei1' USING DFHEIV0,
 13298           PGM-NAME,
 13299           PROGRAM-INTERFACE-BLOCK,
 13300           PI-COMM-LENGTH
 13301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13302
 13303
 13304 9400-CLEAR.
 13305     IF PI-CLEAR-MODE
 13306         MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME
 13307         GO TO 9300-XCTL
 13308     ELSE
 13309         PERFORM 7750-DELETE-TEMP-STOR         THRU 7750-EXIT
 13310         PERFORM 7760-DELETE-TEMP-STOR-SCREEN  THRU 7760-EXIT
 13311         PERFORM 7770-DELETE-TEMP-STOR-PI-AREA THRU 7770-EXIT
 13312         MOVE SPACES             TO PI-WA
 13313                                    RECORD-TABLE
 13314                                    TS-WORK-AREA
 13315         MOVE ZEROS              TO PI-TOTAL-LINES
 13316                                    PI-CURRENT-LINE
 13317                                    PI-TEMP-STOR-ITEMS
 13318                                    PI-UPDATE-SW
 13319                                    PI-ADDR-SEQ
 13320         MOVE '2'                TO PI-ACTION
 13321         MOVE LOW-VALUES         TO EL152AO
 13322                                    PI-ADDR-TYPE
 13323         SET TS-INDX
 13324             TA1
 13325             TA2
 13326             TA21
 13327             TB-INDX
 13328             TB-INDX1
 13329             MOVE-INDX
 13330             SC-INDX             TO +1
 13331         IF GETMAIN-SWITCH = '2'
 13332             MOVE 1              TO GETMAIN-SWITCH
 13333             GO TO 8100-SEND-INITIAL-MAP
 13334         ELSE
 13335             GO TO 8100-SEND-INITIAL-MAP.
 13336
 13337 9600-PGMID-ERROR.
 13338
 13339* EXEC CICS HANDLE CONDITION
 13340*        PGMIDERR    (8300-SEND-TEXT)
 13341*    END-EXEC.
 13342*    MOVE '"$L                   ! N #00011750' TO DFHEIV0
 13343     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 13344     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13345     MOVE X'4E20233030303131373530' TO DFHEIV0(25:11)
 13346     CALL 'kxdfhei1' USING DFHEIV0
 13347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13348
 13349
 13350     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 276
* EL152.cbl
 13351     MOVE ' '                    TO PI-ENTRY-CD-1.
 13352     MOVE XCTL-005               TO PGM-NAME.
 13353     MOVE PGM-NAME               TO LOGOFF-PGM.
 13354     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 13355     GO TO 9300-XCTL.
 13356
 13357 9700-DATE-LINK.
 13358     MOVE LINK-ELDATCV           TO PGM-NAME.
 13359
 13360* EXEC CICS LINK
 13361*        PROGRAM   (PGM-NAME)
 13362*        COMMAREA  (DATE-CONVERSION-DATA)
 13363*        LENGTH    (DC-COMM-LENGTH)
 13364*    END-EXEC.
 13365*    MOVE '."C                   ''   #00011763' TO DFHEIV0
 13366     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13367     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13368     MOVE X'2020233030303131373633' TO DFHEIV0(25:11)
 13369     CALL 'kxdfhei1' USING DFHEIV0,
 13370           PGM-NAME,
 13371           DATE-CONVERSION-DATA,
 13372           DC-COMM-LENGTH,
 13373           DFHEIV99,
 13374           DFHEIV99,
 13375           DFHEIV99
 13376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13377
 13378
 13379*    IF NO-CONVERSION-ERROR
 13380*            AND
 13381*       W-REVERSE-DATE
 13382*            AND
 13383*       PI-COMPANY-ID = 'AUK'
 13384*           MOVE DC-GREG-DATE-1-EDIT TO W-EDIT-DATE-1
 13385*           MOVE W-ED1-MM            TO W-ED2-MM
 13386*           MOVE W-ED1-DD            TO W-ED2-DD
 13387*           MOVE W-ED1-YY            TO W-ED2-YY
 13388*           MOVE W-EDIT-DATE-2       TO DC-GREG-DATE-1-EDIT.
 13389
 13390 9700-EXIT.
 13391      EXIT.
 13392
 13393 9900-ERROR-FORMAT.
 13394     IF NOT EMI-ERRORS-COMPLETE
 13395         MOVE LINK-001           TO PGM-NAME
 13396
 13397* EXEC CICS LINK
 13398*            PROGRAM   (PGM-NAME)
 13399*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 13400*            LENGTH    (EMI-COMM-LENGTH)
 13401*        END-EXEC.
 13402*    MOVE '."C                   ''   #00011786' TO DFHEIV0
 13403     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13404     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13405     MOVE X'2020233030303131373836' TO DFHEIV0(25:11)
 13406     CALL 'kxdfhei1' USING DFHEIV0,
 13407           PGM-NAME,
 13408           ERROR-MESSAGE-INTERFACE-BLOCK,
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 277
* EL152.cbl
 13409           EMI-COMM-LENGTH,
 13410           DFHEIV99,
 13411           DFHEIV99,
 13412           DFHEIV99
 13413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13414
 13415
 13416 9900-EXIT.
 13417     EXIT.
 13418
 13419 9990-ABEND.
 13420     MOVE LINK-004               TO PGM-NAME.
 13421     MOVE DFHEIBLK               TO EMI-LINE1.
 13422
 13423* EXEC CICS LINK
 13424*        PROGRAM   (PGM-NAME)
 13425*        COMMAREA  (EMI-LINE1)
 13426*        LENGTH    (72)
 13427*    END-EXEC.
 13428     MOVE 72
 13429       TO DFHEIV11
 13430*    MOVE '."C                   ''   #00011798' TO DFHEIV0
 13431     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13432     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13433     MOVE X'2020233030303131373938' TO DFHEIV0(25:11)
 13434     CALL 'kxdfhei1' USING DFHEIV0,
 13435           PGM-NAME,
 13436           EMI-LINE1,
 13437           DFHEIV11,
 13438           DFHEIV99,
 13439           DFHEIV99,
 13440           DFHEIV99
 13441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13442
 13443
 13444     GO TO 8200-SEND-DATAONLY.
 13445
 13446 9995-SECURITY-VIOLATION.
 13447*                            COPY ELCSCTP.
 13448******************************************************************
 13449*                                                                *
 13450*                            ELCSCTP                             *
 13451*                            VMOD=2.001                          *
 13452*                                                                *
 13453*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 13454******************************************************************
 13455
 13456
 13457     MOVE EIBDATE          TO SM-JUL-DATE.
 13458     MOVE EIBTRMID         TO SM-TERMID.
 13459     MOVE THIS-PGM         TO SM-PGM.
 13460     MOVE EIBTIME          TO TIME-IN.
 13461     MOVE TIME-OUT         TO SM-TIME.
 13462     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 13463
 13464
 13465* EXEC CICS LINK
 13466*         PROGRAM  ('EL003')
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 278
* EL152.cbl
 13467*         COMMAREA (SECURITY-MESSAGE)
 13468*         LENGTH   (80)
 13469*    END-EXEC.
 13470     MOVE 'EL003' TO DFHEIV1
 13471     MOVE 80
 13472       TO DFHEIV11
 13473*    MOVE '."C                   ''   #00011824' TO DFHEIV0
 13474     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13475     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13476     MOVE X'2020233030303131383234' TO DFHEIV0(25:11)
 13477     CALL 'kxdfhei1' USING DFHEIV0,
 13478           DFHEIV1,
 13479           SECURITY-MESSAGE,
 13480           DFHEIV11,
 13481           DFHEIV99,
 13482           DFHEIV99,
 13483           DFHEIV99
 13484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13485
 13486
 13487******************************************************************
 13488
 13489
 13490
 13491 9999-DFHBACK SECTION.
 13492     MOVE '9%                    "   ' TO DFHEIV0
 13493     MOVE 'EL152' TO DFHEIV1
 13494     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 13495     GOBACK.
 13496 9999-DFHEXIT.
 13497     IF DFHEIGDJ EQUAL 0001
 13498         NEXT SENTENCE
 13499     ELSE IF DFHEIGDJ EQUAL 2
 13500         GO TO 9600-PGMID-ERROR,
 13501               0325-MAPFAIL,
 13502               9990-ABEND
 13503         DEPENDING ON DFHEIGDI
 13504     ELSE IF DFHEIGDJ EQUAL 3
 13505         GO TO 9400-CLEAR,
 13506               0100-PA,
 13507               0100-PA,
 13508               0100-PA
 13509         DEPENDING ON DFHEIGDI
 13510     ELSE IF DFHEIGDJ EQUAL 4
 13511         GO TO 0325-MAPFAIL
 13512         DEPENDING ON DFHEIGDI
 13513     ELSE IF DFHEIGDJ EQUAL 5
 13514         GO TO 590-QIDERR
 13515         DEPENDING ON DFHEIGDI
 13516     ELSE IF DFHEIGDJ EQUAL 6
 13517         GO TO 8850-ARCH-NOT-OPEN,
 13518               1020-ENDBR,
 13519               1020-ENDBR
 13520         DEPENDING ON DFHEIGDI
 13521     ELSE IF DFHEIGDJ EQUAL 7
 13522         GO TO 2120-ENDBR,
 13523               2120-ENDBR,
 13524               8890-TEXT-NOT-OPEN
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 279
* EL152.cbl
 13525         DEPENDING ON DFHEIGDI
 13526     ELSE IF DFHEIGDJ EQUAL 8
 13527         GO TO 8860-CLAM-NOT-OPEN,
 13528               3010-NOT-FOUND
 13529         DEPENDING ON DFHEIGDI
 13530     ELSE IF DFHEIGDJ EQUAL 9
 13531         GO TO 9990-ABEND
 13532         DEPENDING ON DFHEIGDI
 13533     ELSE IF DFHEIGDJ EQUAL 10
 13534         GO TO 6499-EXIT
 13535         DEPENDING ON DFHEIGDI
 13536     ELSE IF DFHEIGDJ EQUAL 11
 13537         GO TO 6599-EXIT
 13538         DEPENDING ON DFHEIGDI
 13539     ELSE IF DFHEIGDJ EQUAL 12
 13540         GO TO 8860-CLAM-NOT-OPEN,
 13541               7090-CLAIM-NOT-FOUND
 13542         DEPENDING ON DFHEIGDI
 13543     ELSE IF DFHEIGDJ EQUAL 13
 13544         GO TO 8880-ACCT-NOT-OPEN,
 13545               7080-ACCT-NOT-FOUND
 13546         DEPENDING ON DFHEIGDI
 13547     ELSE IF DFHEIGDJ EQUAL 14
 13548         GO TO 7070-ACTV-NOT-FOUND
 13549         DEPENDING ON DFHEIGDI
 13550     ELSE IF DFHEIGDJ EQUAL 15
 13551         GO TO 7070-ACTV-NOT-FOUND
 13552         DEPENDING ON DFHEIGDI
 13553     ELSE IF DFHEIGDJ EQUAL 16
 13554         GO TO 8870-ACTV-NOT-OPEN,
 13555               7070-ACTV-NOT-FOUND
 13556         DEPENDING ON DFHEIGDI
 13557     ELSE IF DFHEIGDJ EQUAL 17
 13558         GO TO 7075-CONTINUE-ACTV-ERROR
 13559         DEPENDING ON DFHEIGDI
 13560     ELSE IF DFHEIGDJ EQUAL 18
 13561         GO TO 8900-CERT-NOT-OPEN,
 13562               8910-CERT-NOT-FOUND
 13563         DEPENDING ON DFHEIGDI
 13564     ELSE IF DFHEIGDJ EQUAL 19
 13565         GO TO 8870-ACTV-NOT-OPEN,
 13566               7200-READ-LOAN-NUMBER
 13567         DEPENDING ON DFHEIGDI
 13568     ELSE IF DFHEIGDJ EQUAL 20
 13569         GO TO 8870-ACTV-NOT-OPEN,
 13570               7201-READ-BENEFICIARY
 13571         DEPENDING ON DFHEIGDI
 13572     ELSE IF DFHEIGDJ EQUAL 21
 13573         GO TO 7290-BENE-NOT-OPEN,
 13574               7205-READ-PHYSICIAN-ADDR
 13575         DEPENDING ON DFHEIGDI
 13576     ELSE IF DFHEIGDJ EQUAL 22
 13577         GO TO 8870-ACTV-NOT-OPEN,
 13578               7210-READ-EMPLOYER-ADDR
 13579         DEPENDING ON DFHEIGDI
 13580     ELSE IF DFHEIGDJ EQUAL 23
 13581         GO TO 8870-ACTV-NOT-OPEN,
 13582               7220-READ-INSURED-ADDR
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 280
* EL152.cbl
 13583         DEPENDING ON DFHEIGDI
 13584     ELSE IF DFHEIGDJ EQUAL 24
 13585         GO TO 8870-ACTV-NOT-OPEN,
 13586               7225-READ-OTHER1-ADDR
 13587         DEPENDING ON DFHEIGDI
 13588     ELSE IF DFHEIGDJ EQUAL 25
 13589         GO TO 8870-ACTV-NOT-OPEN,
 13590               7230-READ-OTHER2-ADDR
 13591         DEPENDING ON DFHEIGDI
 13592     ELSE IF DFHEIGDJ EQUAL 26
 13593         GO TO 8870-ACTV-NOT-OPEN,
 13594               7240-NOT-FOUND
 13595         DEPENDING ON DFHEIGDI
 13596     ELSE IF DFHEIGDJ EQUAL 27
 13597         GO TO 8870-ACTV-NOT-OPEN,
 13598               7250-READ-ACCOUNT
 13599         DEPENDING ON DFHEIGDI
 13600     ELSE IF DFHEIGDJ EQUAL 28
 13601         GO TO 8880-ACCT-NOT-OPEN,
 13602               7251-READ-3RD-PARTY
 13603         DEPENDING ON DFHEIGDI
 13604     ELSE IF DFHEIGDJ EQUAL 29
 13605         GO TO 8870-ACTV-NOT-OPEN,
 13606               7252-READ-COMP
 13607         DEPENDING ON DFHEIGDI
 13608     ELSE IF DFHEIGDJ EQUAL 30
 13609         GO TO 7260-READ-DENIAL
 13610         DEPENDING ON DFHEIGDI
 13611     ELSE IF DFHEIGDJ EQUAL 31
 13612         GO TO 8870-ACTV-NOT-OPEN,
 13613               7265-READ-CNTL1,
 13614               7265-READ-CNTL1
 13615         DEPENDING ON DFHEIGDI
 13616     ELSE IF DFHEIGDJ EQUAL 32
 13617         GO TO 8840-CNTL-NOT-OPEN,
 13618               7266-READ-CNTL2
 13619         DEPENDING ON DFHEIGDI
 13620     ELSE IF DFHEIGDJ EQUAL 33
 13621         GO TO 8840-CNTL-NOT-OPEN,
 13622               7267-READ-CNTL4
 13623         DEPENDING ON DFHEIGDI
 13624     ELSE IF DFHEIGDJ EQUAL 34
 13625         GO TO 8840-CNTL-NOT-OPEN,
 13626               7267-READ-CNTL6
 13627         DEPENDING ON DFHEIGDI
 13628     ELSE IF DFHEIGDJ EQUAL 35
 13629         GO TO 8840-CNTL-NOT-OPEN,
 13630               7268-SET-DATE
 13631         DEPENDING ON DFHEIGDI
 13632     ELSE IF DFHEIGDJ EQUAL 36
 13633         GO TO 7290-BENE-NOT-OPEN,
 13634               7290-EXIT
 13635         DEPENDING ON DFHEIGDI
 13636     ELSE IF DFHEIGDJ EQUAL 37
 13637         GO TO 7590-TS-QIDERR,
 13638               7585-TS-ITEMERR
 13639         DEPENDING ON DFHEIGDI
 13640     ELSE IF DFHEIGDJ EQUAL 38
* Micro Focus Server Express         V5.1 revision 000 12-Jan-12 15:23 Page 281
* EL152.cbl
 13641         GO TO 7690-TS-QIDERR,
 13642               7685-TS-ITEMERR
 13643         DEPENDING ON DFHEIGDI
 13644     ELSE IF DFHEIGDJ EQUAL 39
 13645         GO TO 7750-EXIT
 13646         DEPENDING ON DFHEIGDI
 13647     ELSE IF DFHEIGDJ EQUAL 40
 13648         GO TO 7760-EXIT
 13649         DEPENDING ON DFHEIGDI
 13650     ELSE IF DFHEIGDJ EQUAL 41
 13651         GO TO 7770-EXIT
 13652         DEPENDING ON DFHEIGDI
 13653     ELSE IF DFHEIGDJ EQUAL 42
 13654         GO TO 8860-CLAM-NOT-OPEN,
 13655               7800-CLAIM-NOT-FOUND
 13656         DEPENDING ON DFHEIGDI
 13657     ELSE IF DFHEIGDJ EQUAL 43
 13658         GO TO 7800-GET-PRINTER
 13659         DEPENDING ON DFHEIGDI
 13660     ELSE IF DFHEIGDJ EQUAL 44
 13661         GO TO 8840-CNTL-NOT-OPEN,
 13662               7890-NOT-FOUND
 13663         DEPENDING ON DFHEIGDI
 13664     ELSE IF DFHEIGDJ EQUAL 45
 13665         GO TO 8820-TERM-ERROR,
 13666               8830-TRAN-ERROR
 13667         DEPENDING ON DFHEIGDI
 13668     ELSE IF DFHEIGDJ EQUAL 46
 13669         GO TO 8300-SEND-TEXT
 13670         DEPENDING ON DFHEIGDI.
 13671     MOVE '9%                    "   ' TO DFHEIV0
 13672     MOVE 'EL152' TO DFHEIV1
 13673     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 13674     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       47156     Code:       45135
