* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   1
* EL6318.cbl
* Options: int("EL6318.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6318.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6318.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6318.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6318.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   2
* EL6318.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24*          2011022800001  PEMA  NEW PROGRAM
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 060612   2011022800001  AJRA  NAPERSOFT
    27* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    28* 072312   2011022800001  AJRA  NAPERSOFT MISC
    29* 102212   2012101700002  AJRA  SCREEN ID
    30* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    31* 110612   2012101700002  AJRA  ADD NEW FIELDS
    32* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    33* 121012   2012101700002  AJRA  HIGHLIGHT REASON CODES
    34* 121112   2012101700002  AJRA  CHANGE PF1, PF2 TO PF3, PF4
    35* 121212   2012101700002  AJRA  CHG LAST 2 CERT NOTES TO BILLING N
    36* 121712   2012101700002  AJRA  ADD DEFAULT AGE FLAG
    37* 122712   2012122700001  AJRA  FIX CERT PRINT FLAG
    38* 011413 IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    39* 091913   2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
    40* 120313   2013090300001  AJRA  NAPERSOFT PHASE 2
    41* 121713   2013090300001  AJRA  ADD ENCLOSURE CODE TO SCREEN
    42* 091615 CR2015082000001  PEMA  ADD XFR TO EL677
    43* 020218 CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    44*-----------------------------------------------------------------
    45*REMARKS.
    46*        TRANSACTION - EXBE - GENERAL CHANGE ENDORSEMENT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   3
* EL6318.cbl
    48 ENVIRONMENT DIVISION.
    49 DATA DIVISION.
    50 WORKING-STORAGE SECTION.
    51 01  DFH-START PIC X(04).
    52 77  FILLER  PIC X(32)  VALUE '********************************'.
    53 77  FILLER  PIC X(32)  VALUE '*    EL6318 WORKING STORAGE    *'.
    54 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    55 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    56 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    57 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    58 77  s1                          pic s999 comp-3 value +0.
    59 77  s2                          pic s999 comp-3 value +0.
    60 77  W-ARCH-NUMBER               PIC S9(08)      COMP value +0.
    61 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    62     88  ACCT-FOUND                 VALUE 'Y'.
    63 77  WS-CHGBACK                 PIC 99  VALUE ZEROS.
    64 77  WS-CSO-PORTION              PIC S9(5)V99 COMP-3 VALUE +0.
    65 77  WS-ACCT-PORTION             PIC S9(5)V99 COMP-3 VALUE +0.
    66 77  WS-DIFF                     PIC 99 VALUE ZEROS.
    67 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    68 77  WS-DUE-BORROWER             PIC S9(7)V99 COMP-3 VALUE +0.
    69 77  WS-REASON-SW                PIC X  VALUE ' '.
    70     88  REASONS-FOUND                  VALUE 'Y'.
    71     88  REASONS-NOT-FOUND              VALUE 'N'.
    72 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    73     88  NO-CERT-RW                 VALUE 'N'.
    74     88  CERT-RW                    VALUE 'Y'.
    75 77  ws-el677-check-cut         pic x value 'N'.
    76 77  ws-el677-check-type        pic x value 'N'.
    77 77  ws-elcrtt-update-sw        pic x value ' '.
    78     88  update-elcrtt             value 'Y'.
    79 01  P pointer.
    80 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    81 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    82 01  var-ptr pointer.
    83 01  env-var-len                 pic 9(4)  binary.
    84 01  rc                          pic 9(9)  binary.
    85 01  WS-KIXHOST                  PIC X(10).
    86 01  WS-KIXSYS.
    87     05  WS-KIX-FIL1             PIC X(10).
    88     05  WS-KIX-APPS             PIC X(10).
    89     05  WS-KIX-ENV              PIC X(10).
    90     05  WS-KIX-MYENV            PIC X(10).
    91     05  WS-KIX-SYS              PIC X(10).
    92*                                COPY ELCSCTM.
    93******************************************************************
    94*                                                                *
    95*                                                                *
    96*                            ELCSCTM                             *
    97*                            VMOD=2.001                          *
    98*                                                                *
    99*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   100*                                                                *
   101******************************************************************
   102 01  SECURITY-MESSAGE.
   103     12  FILLER                          PIC X(30)
   104            VALUE '** LOGIC SECURITY VIOLATION -'.
   105     12  SM-READ                         PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   4
* EL6318.cbl
   106     12  FILLER                          PIC X(5)
   107            VALUE ' PGM='.
   108     12  SM-PGM                          PIC X(6).
   109     12  FILLER                          PIC X(5)
   110            VALUE ' OPR='.
   111     12  SM-PROCESSOR-ID                 PIC X(4).
   112     12  FILLER                          PIC X(6)
   113            VALUE ' TERM='.
   114     12  SM-TERMID                       PIC X(4).
   115     12  FILLER                          PIC XX   VALUE SPACE.
   116     12  SM-JUL-DATE                     PIC 9(5).
   117     12  FILLER                          PIC X    VALUE SPACE.
   118     12  SM-TIME                         PIC 99.99.
   119
   120*                                COPY ELCSCRTY.
   121******************************************************************
   122*                                                                *
   123*                                                                *
   124*                            ELCSCRTY                            *
   125*                            VMOD=2.001                          *
   126*                                                                *
   127*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   128*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   129*        SAVED IN PI-SECURITY-ADDRESS.                           *
   130*                                                                *
   131******************************************************************
   132 01  SECURITY-CONTROL.
   133     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   134     12  FILLER                       PIC XX    VALUE 'SC'.
   135     12  SC-CREDIT-CODES.
   136         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   137             20  SC-CREDIT-DISPLAY    PIC X.
   138             20  SC-CREDIT-UPDATE     PIC X.
   139     12  SC-CLAIMS-CODES.
   140         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   141             20  SC-CLAIMS-DISPLAY    PIC X.
   142             20  SC-CLAIMS-UPDATE     PIC X.
   143 01 srch-commarea.
   144*                                copy ELCADLTRSPI.
   145******************************************************************
   146*                   C H A N G E   L O G
   147*
   148* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   149*-----------------------------------------------------------------
   150*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   151* EFFECTIVE    NUMBER
   152*-----------------------------------------------------------------
   153* 060611    2011022800001  PEMA  NEW COPYBOOK
   154* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   155* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   156******************************************************************
   157****************************************
   158*  commarea for NaperSoft On Demand Admin services letters
   159*  (business logic input & output)
   160****************************************
   161     03  BL-INPUT.
   162         05  BL-DATA-SRCE        PIC X.
   163         05  BL-LETTER-ID        PIC XXXX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   5
* EL6318.cbl
   164         05  BL-CARRIER          PIC X.
   165         05  BL-GROUP            PIC X(6).
   166         05  BL-STATE            PIC XX.
   167         05  BL-ACCOUNT          PIC X(10).
   168         05  BL-EFF-DT           PIC X(10).
   169         05  BL-CERT-NO          PIC X(11).
   170         05  BL-BATCH-NO         PIC X(6).
   171         05  BL-BATCH-SEQ        PIC 9(8).
   172         05  BL-RESP-NO          PIC X(10).
   173         05  BL-NO-OF-COPIES     PIC 99.
   174         05  BL-PROC-ID          PIC XXXX.
   175         05  BL-COMP-ID          PIC XXX.
   176         05  BL-PRINT-NOW-SW     PIC X.
   177         05  BL-ENC-CD           PIC XXX.
   178         05  BL-RESEND-DT        PIC X(10).
   179         05  BL-FOLLOW-UP-DT     PIC X(10).
   180         05  BL-ARCHIVE-NO       PIC 9(8).
   181         05  BL-FUNC             PIC X(8).
   182         05  BL-COMMENTS         PIC X(100).
   183         05  FILLER REDEFINES BL-COMMENTS.
   184             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   185             10  BL-LETTER-TO-ACCT PIC X.
   186             10  BL-LETTER-TO-BENE PIC X.
   187             10  BL-WRITE-ERARCH   PIC X.
   188                 88  ERARCH-QWS      VALUE 'Q'.
   189                 88  ERARCH-BATCH    VALUE 'B'.
   190                 88  ERARCH-TEMP     VALUE 'T'.
   191             10  BL-PROCESS-TYPE PIC X(07).
   192             10  BL-CERT-FORM-ID PIC X(05).
   193             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   194             10  BL-SOURCE-SCREEN PIC X(8).
   195             10  FILLER          PIC X(25).
   196     03  BL-OUTPUT.
   197         05  BL-STATUS                   PIC X.
   198             88  BL-OK                      VALUE "P".
   199             88  BL-FAIL                  VALUE "F".
   200         05  BL-MESSAGE          PIC X(50).
   201     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   202     03  FILLER                  PIC X(31).
   203
   204*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   205*                                COPY ELCZREC.
   206******************************************************************
   207*                                                                *
   208*                                                                *
   209*                            ELCZREC.                            *
   210*                                                                *
   211*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   212*                                                                *
   213******************************************************************
   214*-----------------------------------------------------------------
   215*                   C H A N G E   L O G
   216*
   217* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   218*-----------------------------------------------------------------
   219*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   220* EFFECTIVE    NUMBER
   221*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   6
* EL6318.cbl
   222* 122011    2011022800001  AJRA  NEW FILE
   223* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   224* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   225* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   226* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   227*-----------------------------------------------------------------
   228 01  W-Z-CONTROL-DATA.
   229     05  W-NUMBER-OF-COPIES      PIC  9.
   230     05  FILLER                  PIC  X.
   231     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   232     05  FILLER                  PIC  X.
   233     05  W-DAYS-TO-RESEND        PIC  999.
   234     05  FILLER                  PIC  X.
   235     05  W-FORM-TO-RESEND        PIC  X(4).
   236     05  W-ADD-BAR-CODE          PIC  X.
   237     05  W-PROMPT-LETTER         PIC  X.
   238     05  W-HAS-RETURN-ENV        PIC  X.
   239     05  W-ENCLOSURE-CD          PIC  XXX.
   240     05  W-SIG-FLAG-DEFAULT      PIC  X.
   241     05  W-AUTO-CLOSE-IND        PIC  X.
   242     05  FILLER                  PIC  X.
   243     05  W-LETTER-TO-BENE        PIC  X.
   244     05  FILLER                  PIC  X.
   245     05  W-LETTER-TO-ACCT        PIC  X.
   246     05  FILLER                  PIC  X.
   247     05  W-LETTER-TYPE           PIC  X.
   248     05  FILLER                  PIC  X.
   249     05  W-PRINT-CERTIFICATE     PIC  X.
   250     05  FILLER                  PIC  X.
   251     05  W-REFUND-REQUIRED       PIC  X.
   252     05  FILLER                  PIC  X.
   253     05  W-ONBASE-CODE           PIC  XX.
   254     05  FILLER                  PIC  X.
   255     05  W-ACCT-SUMM             PIC  X.
   256     05  FILLER                  PIC  X.
   257     05  W-CSO-SUMM              PIC  X.
   258     05  FILLER                  PIC  X.
   259     05  W-REASONS-REQUIRED      PIC  X.
   260     05  FILLER                  PIC  X(29).
   261 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   262 01  STANDARD-AREAS.
   263     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   264     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   265                                 PIC  X(08).
   266     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
   267     12  QID.
   268         16  QID-TERM        PIC X(4)    VALUE SPACES.
   269         16  FILLER          PIC X(4)    VALUE '631K'.
   270     12  MAP-LENGTH          PIC 9(4)   VALUE 359 BINARY.
   271     12  TIME-MT                 PIC S9(7).
   272     12  TIME-MT-R  REDEFINES TIME-MT.
   273         16  FILLER              PIC X.
   274         16  TIME-LMT            PIC 99V99.
   275         16  FILLER              PIC X(2).
   276     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   277     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   278     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   279     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   7
* EL6318.cbl
   280     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   281     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   282     12  ELCRTT-LENGTH           PIC S9(4) COMP VALUE +552.
   283     12  ELENCC-LENGTH           PIC S9(04) VALUE +400 COMP.
   284     12  W-CNTL-KEY.
   285         16  W-CNTL-COMPANY-ID   PIC  X(03).
   286         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   287         16  W-CNTL-GENL.
   288             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   289             20  W-CNTL-GEN2.
   290                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   291                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   292         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   293     12  WS-ELCERT-KEY.
   294         16  W-CERT-COMPANY-CD   PIC X.
   295         16  W-CERT-CARRIER      PIC X.
   296         16  W-CERT-GROUPING     PIC X(6).
   297         16  W-CERT-STATE        PIC XX.
   298         16  W-CERT-ACCOUNT      PIC X(10).
   299         16  W-CERT-CERT-EFF-DT  PIC XX.
   300         16  W-CERT-CERT-PRIME   PIC X(10).
   301         16  W-CERT-CERT-SFX     PIC X.
   302     12  WS-ELEOBC-KEY.
   303         16  WS-EOBC-COMPANY-CD  PIC X.
   304         16  WS-EOBC-REC-TYPE    PIC X.
   305         16  WS-EOBC-CODE        PIC X(4).
   306         16  FILLER              PIC X(9).
   307     12  WS-ERNOTE-KEY.
   308         16  W-NOTE-COMPANY-CD   PIC X.
   309         16  W-NOTE-CARRIER      PIC X.
   310         16  W-NOTE-GROUPING     PIC X(6).
   311         16  W-NOTE-STATE        PIC XX.
   312         16  W-NOTE-ACCOUNT      PIC X(10).
   313         16  W-NOTE-CERT-EFF-DT  PIC XX.
   314         16  W-NOTE-CERT-PRIME   PIC X(10).
   315         16  W-NOTE-CERT-SFX     PIC X.
   316     12  ELLETR-KEY.
   317         16  LETR-PART-KEY.
   318             20  LETR-COMPANY-CD PIC X.
   319             20  LETR-LETTER-ID  PIC X(4).
   320         16  LETR-FILLER         PIC X(8).
   321         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   322     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   323     12  ERPNDB2-KEY.
   324         16  PNDB2-COMPANY-CD    PIC X.
   325         16  PNDB2-CARRIER       PIC X.
   326         16  PNDB2-GROUPING      PIC X(6).
   327         16  PNDB2-STATE         PIC XX.
   328         16  PNDB2-ACCOUNT       PIC X(10).
   329         16  PNDB2-CERT-EFF-DT   PIC XX.
   330         16  PNDB2-CERT-PRIME    PIC X(10).
   331         16  PNDB2-CERT-SFX      PIC X.
   332         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   333         16  PNDB2-RECORD-TYPE   PIC X.
   334     12  ERPNDB-KEY.
   335         16  PNDB-COMPANY-CD     PIC X.
   336         16  PNDB-BATCH-NO       PIC X(6).
   337         16  PNDB-BATCH-SEQ-NO   PIC 9(4) BINARY.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   8
* EL6318.cbl
   338         16  PNDB-CHG-SEQ-NO     PIC 9(4) BINARY.
   339     12  ERENDT-KEY.
   340         16  ENDT-COMPANY-CD       PIC X.
   341         16  ENDT-CARRIER          PIC X.
   342         16  ENDT-GROUPING         PIC X(6).
   343         16  ENDT-STATE            PIC XX.
   344         16  ENDT-ACCOUNT          PIC X(10).
   345         16  ENDT-CERT-EFF-DT      PIC XX.
   346         16  ENDT-CERT-PRIME       PIC X(10).
   347         16  ENDT-CERT-SFX         PIC X.
   348         16  ENDT-RECORD-TYPE      PIC X.
   349         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   350     12  ELCRTO-KEY.
   351         16  CRTO-COMPANY-CD     PIC X.
   352         16  CRTO-CARRIER        PIC X.
   353         16  CRTO-GROUPING       PIC X(6).
   354         16  CRTO-STATE          PIC XX.
   355         16  CRTO-ACCOUNT        PIC X(10).
   356         16  CRTO-CERT-EFF-DT    PIC XX.
   357         16  CRTO-CERT-PRIME     PIC X(10).
   358         16  CRTO-CERT-SFX       PIC X.
   359         16  CRTO-RECORD-TYPE    PIC X.
   360         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   361     12  WS-ELCRTT-KEY.
   362         16  WS-ELCRTT-PRIMARY   PIC X(33).
   363         16  WS-ELCRTT-REC-TYPE  PIC X(1).
   364     12  WS-ERMAIL-KEY.
   365         16  MAIL-COMPANY-CD     PIC X.
   366         16  MAIL-CARRIER        PIC X.
   367         16  MAIL-GROUPING       PIC X(6).
   368         16  MAIL-STATE          PIC XX.
   369         16  MAIL-ACCOUNT        PIC X(10).
   370         16  MAIL-CERT-EFF-DT    PIC XX.
   371         16  MAIL-CERT-PRIME     PIC X(10).
   372         16  MAIL-CERT-SFX       PIC X.
   373
   374     12  WS-ELENCC-KEY.
   375         16  WS-ENCC-COMPANY-CD  PIC X.
   376         16  WS-ENCC-REC-TYPE    PIC X.
   377         16  WS-ENCC-ENC-CODE    PIC X(5).
   378         16  FILLER              PIC X(09).
   379
   380     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   381     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   382     12  WS-CURRENT-DT.
   383         16  FILLER              PIC X(6)    VALUE SPACES.
   384         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   385     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   386     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   387         88  CANCEL-REC            VALUE 'C'.
   388         88  ISSUE-REC             VALUE 'I'.
   389     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   390     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   391     12  ELCNTL-KEY.
   392         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   393         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   394         16  CNTL-ACCESS.
   395             20  CNTL-STATE      PIC XX    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   9
* EL6318.cbl
   396             20  FILLER          PIC X     VALUE SPACES.
   397             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   398         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   399     12  WS-ERACCT-KEY.
   400         16  ACCT-COMPANY-CD     PIC X.
   401         16  ACCT-CARRIER        PIC X.
   402         16  ACCT-GROUPING       PIC X(6).
   403         16  ACCT-STATE          PIC XX.
   404         16  ACCT-ACCOUNT        PIC X(10).
   405         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   406         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   407     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
   408     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   409     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   410     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   411     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   412     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   413     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   414     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   415     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   416     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   417     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   418     12  WS-ELCRTT-FILE-ID       PIC X(8) VALUE 'ELCRTT'.
   419     12  WS-ELENCC-FILE-ID       PIC X(8) VALUE 'ELENCC'.
   420     12  WS-RESPONSE             PIC S9(8)   COMP.
   421         88  RESP-NORMAL                  VALUE +00.
   422         88  RESP-NOTFND                  VALUE +13.
   423         88  RESP-DUPREC                  VALUE +14.
   424         88  RESP-DUPKEY                  VALUE +15.
   425         88  RESP-NOTOPEN                 VALUE +19.
   426         88  RESP-ENDFILE                 VALUE +20.
   427     12  MAP-NAME            PIC X(8)    VALUE 'EL631K'.
   428     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6318S'.
   429     12  SCREEN-NUMBER       PIC X(4)    VALUE '631K'.
   430     12  TRANS-ID            PIC X(4)    VALUE 'EXBE'.
   431     12  THIS-PGM            PIC X(8)    VALUE 'EL6318'.
   432     12  PGM-NAME            PIC X(8).
   433     12  TIME-IN             PIC S9(7).
   434     12  TIME-OUT-R  REDEFINES TIME-IN.
   435         16  FILLER          PIC X.
   436         16  TIME-OUT        PIC 99V99.
   437         16  FILLER          PIC X(2).
   438     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   439     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   440     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   441     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   442     12  XCTL-677            PIC X(8)    VALUE 'EL677'.
   443     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   444     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   445     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   446     12  WS-PHONE.
   447         16  WS-PH1              PIC XXX.
   448         16  WS-PH2              PIC XXX.
   449         16  WS-PH3              PIC XXXX.
   450     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   451     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   452
   453     12  WS-BILLING-NOTE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  10
* EL6318.cbl
   454         16  WS-BN-NOTE          PIC X(25).
   455         16  WS-BN-LTRID         PIC X(4).
   456         16  FILLER              PIC X(3).
   457         16  WS-BN-DATE          PIC X(8).
   458         16  FILLER              PIC X(3).
   459         16  WS-BN-USERID        PIC X(4).
   460         16  FILLER              PIC X(30).
   461     12  WS-MANUAL-BILL-NOTE REDEFINES WS-BILLING-NOTE.
   462         16  WS-MAN-BN-NOTE      PIC X(63).
   463         16  FILLER              PIC X(14).
   464     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   465
   466     12  WS-SAVE-REASON-CODE-IND PIC X(26).
   467
   468 01  NEW-ELCRTO-REC.
   469     12  NEW-ELCRTO-KEY.
   470         16  NCRTO-COMPANY-CD      PIC X.
   471         16  NCRTO-CARRIER         PIC X.
   472         16  NCRTO-GROUPING        PIC X(6).
   473         16  NCRTO-STATE           PIC XX.
   474         16  NCRTO-ACCOUNT         PIC X(10).
   475         16  NCRTO-CERT-EFF-DT     PIC XX.
   476         16  NCRTO-CERT-PRIME      PIC X(10).
   477         16  NCRTO-CERT-SFX        PIC X.
   478         16  NCRTO-RECORD-TYPE     PIC X.
   479         16  NCRTO-SEQ-NO          PIC 9(4) BINARY.
   480     12  NEW-ORIG-REC.
   481         16  NCRTO-INS-LAST-NAME   PIC X(15).
   482         16  NCRTO-INS-FIRST-NAME  PIC X(10).
   483         16  NCRTO-INS-MIDDLE-INIT PIC X.
   484         16  NCRTO-INS-AGE         PIC S999     COMP-3.
   485         16  NCRTO-JNT-LAST-NAME   PIC X(15).
   486         16  NCRTO-JNT-FIRST-NAME  PIC X(10).
   487         16  NCRTO-JNT-MIDDLE-INIT PIC X.
   488         16  NCRTO-JNT-AGE         PIC S999     COMP-3.
   489         16  NCRTO-LF-BENCD        PIC XX.
   490         16  NCRTO-LF-TERM         PIC S999      COMP-3.
   491         16  NCRTO-LF-BEN-AMT      PIC S9(9)V99  COMP-3.
   492         16  NCRTO-LF-PRM-AMT      PIC S9(7)V99  COMP-3.
   493         16  NCRTO-LF-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
   494         16  NCRTO-LF-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
   495         16  NCRTO-LF-EXP-DT       PIC XX.
   496         16  NCRTO-LF-COMM-PCT     PIC SV9(5)    COMP-3.
   497         16  NCRTO-LF-CANCEL-DT    PIC XX.
   498         16  NCRTO-LF-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   499         16  NCRTO-LF-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   500         16  NCRTO-AH-BENCD        PIC XX.
   501         16  NCRTO-AH-TERM         PIC S999      COMP-3.
   502         16  NCRTO-AH-BEN-AMT      PIC S9(9)V99  COMP-3.
   503         16  NCRTO-AH-PRM-AMT      PIC S9(7)V99  COMP-3.
   504         16  NCRTO-AH-EXP-DT       PIC XX.
   505         16  NCRTO-AH-COMM-PCT     PIC SV9(5)    COMP-3.
   506         16  NCRTO-AH-CP           PIC 99.
   507         16  NCRTO-AH-CANCEL-DT    PIC XX.
   508         16  NCRTO-AH-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   509         16  NCRTO-AH-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   510         16  NCRTO-CRED-BENE-NAME  PIC X(25).
   511         16  NCRTO-1ST-PMT-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  11
* EL6318.cbl
   512         16  NCRTO-INS-AGE-DEFAULT-FLAG PIC X.
   513         16  NCRTO-JNT-AGE-DEFAULT-FLAG PIC X.
   514         16  NCRTO-ISSUE-TRAN-IND  PIC X.
   515         16  NCRTO-CANCEL-TRAN-IND PIC X.
   516         16  FILLER                PIC X(235).
   517
   518 01  CERT-NOTE-ENTRIES.
   519     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   520         16  CERT-NT-TEXT                PIC X(63).
   521         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   522         16  CERT-NT-LAST-MAINT-DT       PIC XX.
   523         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   524
   525 01  ERCNOT-AREA.
   526     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   527     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   528     12  ERCNOT-KEY.
   529         16  ERCNOT-PARTIAL-KEY.
   530             20 ERCNOT-COMPANY-CD    PIC X.
   531             20 ERCNOT-CARRIER       PIC X.
   532             20 ERCNOT-GROUPING      PIC X(06).
   533             20 ERCNOT-STATE         PIC XX.
   534             20 ERCNOT-ACCOUNT       PIC X(10).
   535             20 ERCNOT-EFF-DT        PIC XX.
   536             20 ERCNOT-CERT-NO.
   537                25 ERCNOT-CERT-PRIME PIC X(10).
   538                25 ERCNOT-CERT-SFX   PIC X.
   539             20 ERCNOT-REC-TYP       PIC X.
   540         16 ERCNOT-SEQ           PIC S9(4) COMP.
   541     12  SV-PARTIAL-KEY.
   542         20 SV-COMPANY-CD            PIC X.
   543         20 SV-CARRIER               PIC X.
   544         20 SV-GROUPING              PIC X(06).
   545         20 SV-STATE                 PIC XX.
   546         20 SV-ACCOUNT               PIC X(10).
   547         20 SV-EFF-DT                PIC XX.
   548         20 SV-CERT-NO.
   549            25 SV-CERT-PRIME         PIC X(10).
   550            25 SV-CERT-SFX           PIC X(1).
   551         20 SV-REC-TYP               PIC X.
   552 01  ERROR-MESSAGES.
   553     12  ER-0000                 PIC X(4)  VALUE '0000'.
   554     12  ER-0004                 PIC X(4)  VALUE '0004'.
   555     12  ER-0008                 PIC X(4)  VALUE '0008'.
   556     12  ER-0023                 PIC X(4)  VALUE '0023'.
   557     12  ER-0029                 PIC X(4)  VALUE '0029'.
   558     12  ER-0068                 PIC X(4)  VALUE '0068'.
   559     12  ER-0132                 PIC X(4)  VALUE '0132'.
   560     12  ER-0142                 PIC X(4)  VALUE '0142'.
   561     12  ER-0148                 PIC X(4)  VALUE '0148'.
   562     12  ER-0215                 PIC X(4)  VALUE '0215'.
   563     12  ER-0280                 PIC X(4)  VALUE '0280'.
   564     12  ER-0348                 PIC X(4)  VALUE '0348'.
   565     12  ER-0419                 PIC X(4)  VALUE '0419'.
   566     12  ER-0715                 PIC X(4)  VALUE '0715'.
   567     12  ER-0894                 PIC X(4)  VALUE '0894'.
   568     12  ER-1101                 PIC X(4)  VALUE '1101'.
   569     12  ER-1236                 PIC X(4)  VALUE '1236'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  12
* EL6318.cbl
   570     12  ER-1560                 PIC X(4)  VALUE '1560'.
   571     12  ER-1664                 PIC X(4)  VALUE '1664'.
   572     12  ER-1778                 PIC X(4)  VALUE '1778'.
   573     12  ER-1818                 PIC X(4)  VALUE '1818'.
   574     12  ER-1820                 PIC X(4)  VALUE '1820'.
   575     12  ER-1821                 PIC X(4)  VALUE '1821'.
   576     12  ER-2056                 PIC X(4)  VALUE '2056'.
   577     12  ER-2079                 PIC X(4)  VALUE '2079'.
   578     12  ER-2208                 PIC X(4)  VALUE '2208'.
   579     12  ER-2209                 PIC X(4)  VALUE '2209'.
   580     12  ER-2237                 PIC X(4)  VALUE '2237'.
   581     12  ER-2238                 PIC X(4)  VALUE '2238'.
   582     12  ER-2253                 PIC X(4)  VALUE '2253'.
   583     12  ER-2619                 PIC X(4)  VALUE '2619'.
   584     12  ER-2651                 PIC X(4)  VALUE '2651'.
   585     12  ER-2784                 PIC X(4)  VALUE '2784'.
   586     12  ER-2785                 PIC X(4)  VALUE '2785'.
   587     12  ER-2786                 PIC X(4)  VALUE '2786'.
   588     12  ER-2791                 PIC X(4)  VALUE '2791'.
   589     12  ER-2845                 PIC X(4)  VALUE '2845'.
   590     12  ER-2848                 PIC X(4)  VALUE '2848'.
   591     12  ER-2851                 PIC X(4)  VALUE '2851'.
   592     12  ER-3830                 PIC X(4)  VALUE '3830'.
   593     12  ER-3833                 PIC X(4)  VALUE '3833'.
   594     12  ER-3844                 PIC X(4)  VALUE '3844'.
   595     12  ER-3845                 PIC X(4)  VALUE '3845'.
   596     12  ER-7345                 PIC X(4)  VALUE '7345'.
   597     12  ER-7638                 PIC X(4)  VALUE '7638'.
   598     12  ER-8888                 PIC X(4)  VALUE '8888'.
   599     12  ER-9999                 PIC X(4)  VALUE '9999'.
   600*    COPY ELCDATE.
   601******************************************************************
   602*                                                                *
   603*                                                                *
   604*                            ELCDATE.                            *
   605*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   606*                            VMOD=2.003
   607*                                                                *
   608*                                                                *
   609*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   610*                 LENGTH = 200                                   *
   611******************************************************************
   612
   613 01  DATE-CONVERSION-DATA.
   614     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   615     12  DC-OPTION-CODE                PIC X.
   616         88  BIN-TO-GREG                VALUE ' '.
   617         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   618         88  EDIT-GREG-TO-BIN           VALUE '2'.
   619         88  YMD-GREG-TO-BIN            VALUE '3'.
   620         88  MDY-GREG-TO-BIN            VALUE '4'.
   621         88  JULIAN-TO-BIN              VALUE '5'.
   622         88  BIN-PLUS-ELAPSED           VALUE '6'.
   623         88  FIND-CENTURY               VALUE '7'.
   624         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   625         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   626         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   627         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  13
* EL6318.cbl
   628         88  JULIAN-TO-BIN-3            VALUE 'C'.
   629         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   630         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   631         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   632         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   633         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   634         88  CHECK-LEAP-YEAR            VALUE 'H'.
   635         88  BIN-3-TO-GREG              VALUE 'I'.
   636         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   637         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   638         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   639         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   640         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   641         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   642         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   643         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   644         88  THREE-CHARACTER-BIN
   645                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   646         88  GREGORIAN-TO-BIN
   647                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   648         88  BIN-TO-GREGORIAN
   649                  VALUES ' ' '1' 'I' '8' 'G'.
   650         88  JULIAN-TO-BINARY
   651                  VALUES '5' 'C' 'E' 'F'.
   652     12  DC-ERROR-CODE                 PIC X.
   653         88  NO-CONVERSION-ERROR        VALUE ' '.
   654         88  DATE-CONVERSION-ERROR
   655                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   656         88  DATE-IS-ZERO               VALUE '1'.
   657         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   658         88  DATE-IS-INVALID            VALUE '3'.
   659         88  DATE1-GREATER-DATE2        VALUE '4'.
   660         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   661         88  DATE-INVALID-OPTION        VALUE '9'.
   662         88  INVALID-CENTURY            VALUE 'A'.
   663         88  ONLY-CENTURY               VALUE 'B'.
   664         88  ONLY-LEAP-YEAR             VALUE 'C'.
   665         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   666     12  DC-END-OF-MONTH               PIC X.
   667         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   668     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   669         88  USE-NORMAL-PROCESS         VALUE ' '.
   670         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   671         88  ADJUST-UP-100-YRS          VALUE '2'.
   672     12  FILLER                        PIC X.
   673     12  DC-CONVERSION-DATES.
   674         16  DC-BIN-DATE-1             PIC XX.
   675         16  DC-BIN-DATE-2             PIC XX.
   676         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   677         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   678                       DC-GREG-DATE-1-EDIT.
   679             20  DC-EDIT1-MONTH        PIC 99.
   680             20  SLASH1-1              PIC X.
   681             20  DC-EDIT1-DAY          PIC 99.
   682             20  SLASH1-2              PIC X.
   683             20  DC-EDIT1-YEAR         PIC 99.
   684         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   685         16  DC-GREG-DATE-2-EDIT-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  14
* EL6318.cbl
   686                     DC-GREG-DATE-2-EDIT.
   687             20  DC-EDIT2-MONTH        PIC 99.
   688             20  SLASH2-1              PIC X.
   689             20  DC-EDIT2-DAY          PIC 99.
   690             20  SLASH2-2              PIC X.
   691             20  DC-EDIT2-YEAR         PIC 99.
   692         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   693         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   694                     DC-GREG-DATE-1-YMD.
   695             20  DC-YMD-YEAR           PIC 99.
   696             20  DC-YMD-MONTH          PIC 99.
   697             20  DC-YMD-DAY            PIC 99.
   698         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   699         16  DC-GREG-DATE-1-MDY-R REDEFINES
   700                      DC-GREG-DATE-1-MDY.
   701             20  DC-MDY-MONTH          PIC 99.
   702             20  DC-MDY-DAY            PIC 99.
   703             20  DC-MDY-YEAR           PIC 99.
   704         16  DC-GREG-DATE-1-ALPHA.
   705             20  DC-ALPHA-MONTH        PIC X(10).
   706             20  DC-ALPHA-DAY          PIC 99.
   707             20  FILLER                PIC XX.
   708             20  DC-ALPHA-CENTURY.
   709                 24 DC-ALPHA-CEN-N     PIC 99.
   710             20  DC-ALPHA-YEAR         PIC 99.
   711         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   712         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   713         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   714         16  DC-JULIAN-DATE            PIC 9(05).
   715         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   716                                       PIC 9(05).
   717         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   718             20  DC-JULIAN-YEAR        PIC 99.
   719             20  DC-JULIAN-DAYS        PIC 999.
   720         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   721         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   722         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   723     12  DATE-CONVERSION-VARIBLES.
   724         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   725         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   726             20  FILLER                PIC 9(3).
   727             20  HOLD-CEN-1-CCYY.
   728                 24  HOLD-CEN-1-CC     PIC 99.
   729                 24  HOLD-CEN-1-YY     PIC 99.
   730             20  HOLD-CEN-1-MO         PIC 99.
   731             20  HOLD-CEN-1-DA         PIC 99.
   732         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   733             20  HOLD-CEN-1-R-MO       PIC 99.
   734             20  HOLD-CEN-1-R-DA       PIC 99.
   735             20  HOLD-CEN-1-R-CCYY.
   736                 24  HOLD-CEN-1-R-CC   PIC 99.
   737                 24  HOLD-CEN-1-R-YY   PIC 99.
   738             20  FILLER                PIC 9(3).
   739         16  HOLD-CENTURY-1-X.
   740             20  FILLER                PIC X(3)  VALUE SPACES.
   741             20  HOLD-CEN-1-X-CCYY.
   742                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   743                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  15
* EL6318.cbl
   744             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   745             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   746         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   747             20  HOLD-CEN-1-R-X-MO     PIC XX.
   748             20  HOLD-CEN-1-R-X-DA     PIC XX.
   749             20  HOLD-CEN-1-R-X-CCYY.
   750                 24  HOLD-CEN-1-R-X-CC PIC XX.
   751                 24  HOLD-CEN-1-R-X-YY PIC XX.
   752             20  FILLER                PIC XXX.
   753         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   754         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   755         16  DC-JULIAN-DATE-1          PIC 9(07).
   756         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   757             20  DC-JULIAN-1-CCYY.
   758                 24  DC-JULIAN-1-CC    PIC 99.
   759                 24  DC-JULIAN-1-YR    PIC 99.
   760             20  DC-JULIAN-DA-1        PIC 999.
   761         16  DC-JULIAN-DATE-2          PIC 9(07).
   762         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   763             20  DC-JULIAN-2-CCYY.
   764                 24  DC-JULIAN-2-CC    PIC 99.
   765                 24  DC-JULIAN-2-YR    PIC 99.
   766             20  DC-JULIAN-DA-2        PIC 999.
   767         16  DC-GREG-DATE-A-EDIT.
   768             20  DC-EDITA-MONTH        PIC 99.
   769             20  SLASHA-1              PIC X VALUE '/'.
   770             20  DC-EDITA-DAY          PIC 99.
   771             20  SLASHA-2              PIC X VALUE '/'.
   772             20  DC-EDITA-CCYY.
   773                 24  DC-EDITA-CENT     PIC 99.
   774                 24  DC-EDITA-YEAR     PIC 99.
   775         16  DC-GREG-DATE-B-EDIT.
   776             20  DC-EDITB-MONTH        PIC 99.
   777             20  SLASHB-1              PIC X VALUE '/'.
   778             20  DC-EDITB-DAY          PIC 99.
   779             20  SLASHB-2              PIC X VALUE '/'.
   780             20  DC-EDITB-CCYY.
   781                 24  DC-EDITB-CENT     PIC 99.
   782                 24  DC-EDITB-YEAR     PIC 99.
   783         16  DC-GREG-DATE-CYMD         PIC 9(08).
   784         16  DC-GREG-DATE-CYMD-R REDEFINES
   785                              DC-GREG-DATE-CYMD.
   786             20  DC-CYMD-CEN           PIC 99.
   787             20  DC-CYMD-YEAR          PIC 99.
   788             20  DC-CYMD-MONTH         PIC 99.
   789             20  DC-CYMD-DAY           PIC 99.
   790         16  DC-GREG-DATE-MDCY         PIC 9(08).
   791         16  DC-GREG-DATE-MDCY-R REDEFINES
   792                              DC-GREG-DATE-MDCY.
   793             20  DC-MDCY-MONTH         PIC 99.
   794             20  DC-MDCY-DAY           PIC 99.
   795             20  DC-MDCY-CEN           PIC 99.
   796             20  DC-MDCY-YEAR          PIC 99.
   797    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   798        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   799    12  DC-EL310-DATE                  PIC X(21).
   800    12  FILLER                         PIC X(28).
   801*    COPY ELCTEXT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  16
* EL6318.cbl
   802******************************************************************
   803*                                                                *
   804*                                                                *
   805*                            ELCTEXT.                            *
   806*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   807*                            VMOD=2.008                          *
   808*                                                                *
   809*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   810*                                     FORM LETTERS,              *
   811*                                     CERT FORM DISPLAY.
   812*                                                                *
   813*   FILE TYPE = VSAM,KSDS                                        *
   814*   RECORD SIZE = 100   RECFORM = FIXED                          *
   815*                                                                *
   816*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   817*       ALTERNATE INDEX = NONE                                   *
   818*                                                                *
   819*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   820*       ALTERNATE INDEX = NONE                                   *
   821*                                                                *
   822*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   823*       ALTERNATE INDEX = NONE                                   *
   824*                                                                *
   825*   LOG = NO                                                     *
   826*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   827******************************************************************
   828 01  TEXT-FILES.
   829     12  TEXT-FILE-ID                PIC XX.
   830         88  FORMS-FILE-TEXT            VALUE 'TF'.
   831         88  LETTER-FILE-TEXT           VALUE 'TL'.
   832         88  HELP-FILE-TEXT             VALUE 'TH'.
   833
   834     12  TX-CONTROL-PRIMARY.
   835         16  TX-COMPANY-CD           PIC X.
   836             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   837         16  TX-ACCESS-CD-GENL       PIC X(12).
   838
   839         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   840             20  TX-LETTER-NO        PIC X(4).
   841             20  FILLER              PIC X(8).
   842
   843         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   844             20  TX-FORM-NO          PIC X(12).
   845
   846         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   847             20  TX-HELP-TYPE        PIC X.
   848                 88  HELP-FOR-GENERAL   VALUE ' '.
   849                 88  HELP-BY-SCREEN     VALUE 'S'.
   850                 88  HELP-BY-ERROR      VALUE 'E'.
   851             20  TX-SCREEN-OR-ERROR  PIC X(4).
   852                 88  GENERAL-INFO-HELP  VALUE '0000'.
   853             20  TX-HELP-FOR-COMPANY  PIC XXX.
   854                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   855             20  FILLER              PIC X(4).
   856
   857         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   858
   859     12  TX-PROCESS-CONTROL          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  17
* EL6318.cbl
   860         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   861
   862     12  TX-TEXT-LINE                PIC X(70).
   863
   864     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   865         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   866         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   867         88  TX-VALID-FORM-SQUEEZE-VALUE
   868                                        VALUE 'Y' ' '.
   869
   870     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   871         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   872         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   873         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   874         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   875         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   876         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   877         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   878                                              'K' 'N' ' '
   879                                              'Z'.
   880
   881     12  TX-ARCHIVE-SW               PIC X.
   882         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   883         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   884         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   885
   886     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   887     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   888
   889     12  TX-BSR-CODE                 PIC X.
   890         88  TX-BSR-LETTER              VALUE 'B'.
   891         88  TX-NON-BSR-LETTER          VALUE ' '.
   892
   893     12  FILLER                      PIC X.
   894*****************************************************************
   895*    COPY ELCLOGOF.
   896******************************************************************
   897*                                                                *
   898*                                                                *
   899*                            ELCLOGOF.                           *
   900*                            VMOD=2.001                          *
   901*                                                                *
   902*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   903*                                                                *
   904******************************************************************
   905 01  CLASIC-LOGOFF.
   906     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   907     12  LOGOFF-TEXT.
   908         16  FILLER          PIC X(5)    VALUE SPACES.
   909         16  LOGOFF-MSG.
   910             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   911             20  FILLER      PIC X       VALUE SPACES.
   912             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   913         16  FILLER          PIC X(80)
   914           VALUE '* YOU ARE NOW LOGGED OFF'.
   915         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   916         16  FILLER          PIC X       VALUE QUOTE.
   917         16  LOGOFF-SYS-MSG  PIC X(17)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  18
* EL6318.cbl
   918           VALUE 'S CLAS-IC SYSTEM '.
   919     12  TEXT-MESSAGES.
   920         16  UNACCESS-MSG    PIC X(29)
   921             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   922         16  PGMIDERR-MSG    PIC X(17)
   923             VALUE 'PROGRAM NOT FOUND'.
   924*    COPY ELCATTR.
   925******************************************************************
   926*                                                                *
   927*                            ELCATTR.                            *
   928*                            VMOD=2.001                          *
   929*                                                                *
   930*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   931*                                                                *
   932*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   933*                                                                *
   934*                   POS 1   P=PROTECTED                          *
   935*                           U=UNPROTECTED                        *
   936*                           S=ASKIP                              *
   937*                   POS 2   A=ALPHA/NUMERIC                      *
   938*                           N=NUMERIC                            *
   939*                   POS 3   N=NORMAL                             *
   940*                           B=BRIGHT                             *
   941*                           D=DARK                               *
   942*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   943*                           OF=MODIFIED DATA TAG OFF             *
   944*                                                                *
   945*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   946******************************************************************
   947 01  ATTRIBUTE-LIST.
   948     12  AL-PABOF            PIC X       VALUE 'Y'.
   949     12  AL-PABON            PIC X       VALUE 'Z'.
   950     12  AL-PADOF            PIC X       VALUE '%'.
   951     12  AL-PADON            PIC X       VALUE '_'.
   952     12  AL-PANOF            PIC X       VALUE '-'.
   953     12  AL-PANON            PIC X       VALUE '/'.
   954     12  AL-SABOF            PIC X       VALUE '8'.
   955     12  AL-SABON            PIC X       VALUE '9'.
   956     12  AL-SADOF            PIC X       VALUE '@'.
   957     12  AL-SADON            PIC X       VALUE QUOTE.
   958     12  AL-SANOF            PIC X       VALUE '0'.
   959     12  AL-SANON            PIC X       VALUE '1'.
   960     12  AL-UABOF            PIC X       VALUE 'H'.
   961     12  AL-UABON            PIC X       VALUE 'I'.
   962     12  AL-UADOF            PIC X       VALUE '<'.
   963     12  AL-UADON            PIC X       VALUE '('.
   964     12  AL-UANOF            PIC X       VALUE ' '.
   965     12  AL-UANON            PIC X       VALUE 'A'.
   966     12  AL-UNBOF            PIC X       VALUE 'Q'.
   967     12  AL-UNBON            PIC X       VALUE 'R'.
   968     12  AL-UNDOF            PIC X       VALUE '*'.
   969     12  AL-UNDON            PIC X       VALUE ')'.
   970     12  AL-UNNOF            PIC X       VALUE '&'.
   971     12  AL-UNNON            PIC X       VALUE 'J'.
   972*    COPY ELCEMIB.
   973******************************************************************
   974*                                                                *
   975*                                                                *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  19
* EL6318.cbl
   976*                            ELCEMIB.                            *
   977*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   978*                            VMOD=2.005                          *
   979*                                                                *
   980*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   981*                                                                *
   982******************************************************************
   983 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   984     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   985     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   986     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   987     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   988     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   989     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   990     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   991     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   992     12  EMI-SWITCH1             PIC X        VALUE '1'.
   993         88  EMI-NO-ERRORS                    VALUE '1'.
   994         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   995         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   996     12  EMI-SWITCH2             PIC X        VALUE '1'.
   997         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   998     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   999         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1000         88  EMI-AREA1-FULL                   VALUE '2'.
  1001     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1002         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1003         88  EMI-AREA2-FULL                   VALUE '2'.
  1004     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1005         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1006         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1007         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1008         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1009         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1010     12  EMI-ERROR-LINES.
  1011         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1012         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1013         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1014         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1015             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1016                 24  EMI-ERR-NUM         PIC X(4).
  1017                 24  EMI-FILLER          PIC X.
  1018                 24  EMI-SEV             PIC X.
  1019                 24  FILLER              PIC X.
  1020             20  FILLER                  PIC X(02).
  1021     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1022         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1023             20  EMI-ERROR-NUMBER    PIC X(4).
  1024             20  EMI-FILL            PIC X.
  1025             20  EMI-SEVERITY        PIC X.
  1026             20  FILLER              PIC X.
  1027             20  EMI-ERROR-TEXT.
  1028                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1029                 24  FILLER          PIC X(55).
  1030     12  EMI-SEVERITY-SAVE           PIC X.
  1031         88  EMI-NOTE                    VALUE 'N'.
  1032         88  EMI-WARNING                 VALUE 'W'.
  1033         88  EMI-FORCABLE                VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  20
* EL6318.cbl
  1034         88  EMI-FATAL                   VALUE 'X'.
  1035     12  EMI-MESSAGE-FLAG            PIC X.
  1036         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1037         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1038     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1039     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1040         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1041         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1042         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1043     12  emi-claim-no                pic x(7).
  1044     12  emi-claim-type              pic x(6).
  1045     12  FILLER                      PIC X(124)  VALUE SPACES.
  1046     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1047     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1048     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1049     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1050*    COPY ELCINTF.
  1051******************************************************************
  1052*                                                                *
  1053*                                                                *
  1054*                            ELCINTF.                            *
  1055*                            VMOD=2.017                          *
  1056*                                                                *
  1057*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1058*                                                                *
  1059*       LENGTH = 1024                                            *
  1060*                                                                *
  1061******************************************************************
  1062*                   C H A N G E   L O G
  1063*
  1064* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1065*-----------------------------------------------------------------
  1066*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1067* EFFECTIVE    NUMBER
  1068*-----------------------------------------------------------------
  1069* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1070******************************************************************
  1071 01  PROGRAM-INTERFACE-BLOCK.
  1072     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1073     12  PI-CALLING-PROGRAM              PIC X(8).
  1074     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1075     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1076     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1077     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1078     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1079     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1080     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1081     12  PI-COMPANY-ID                   PIC XXX.
  1082     12  PI-COMPANY-CD                   PIC X.
  1083
  1084     12  PI-COMPANY-PASSWORD             PIC X(8).
  1085
  1086     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1087
  1088     12  PI-CONTROL-IN-PROGRESS.
  1089         16  PI-CARRIER                  PIC X.
  1090         16  PI-GROUPING                 PIC X(6).
  1091         16  PI-STATE                    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  21
* EL6318.cbl
  1092         16  PI-ACCOUNT                  PIC X(10).
  1093         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1094                                         PIC X(10).
  1095         16  PI-CLAIM-CERT-GRP.
  1096             20  PI-CLAIM-NO             PIC X(7).
  1097             20  PI-CERT-NO.
  1098                 25  PI-CERT-PRIME       PIC X(10).
  1099                 25  PI-CERT-SFX         PIC X.
  1100             20  PI-CERT-EFF-DT          PIC XX.
  1101         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1102             20  PI-PLAN-CODE            PIC X(2).
  1103             20  PI-REVISION-NUMBER      PIC X(3).
  1104             20  PI-PLAN-EFF-DT          PIC X(2).
  1105             20  PI-PLAN-EXP-DT          PIC X(2).
  1106             20  FILLER                  PIC X(11).
  1107         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1108             20  PI-OE-REFERENCE-1.
  1109                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1110                 25  PI-OE-REF-1-SUFF    PIC XX.
  1111
  1112     12  PI-SESSION-IN-PROGRESS          PIC X.
  1113         88  CLAIM-SESSION                   VALUE '1'.
  1114         88  CREDIT-SESSION                  VALUE '2'.
  1115         88  WARRANTY-SESSION                VALUE '3'.
  1116         88  MORTGAGE-SESSION                VALUE '4'.
  1117         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1118
  1119
  1120*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1121
  1122     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1123     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1124
  1125     12  PI-CREDIT-USER                  PIC X.
  1126         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1127         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1128
  1129     12  PI-CLAIM-USER                   PIC X.
  1130         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1131         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1132
  1133     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1134         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1135         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1136         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1137         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1138         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1139
  1140     12  PI-PROCESSOR-ID                 PIC X(4).
  1141
  1142     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1143
  1144     12  PI-MEMBER-CAPTION               PIC X(10).
  1145
  1146     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1147         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1148
  1149     12  PI-LIFE-OVERRIDE-L1             PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  22
* EL6318.cbl
  1150     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1151     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1152     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1153
  1154     12  PI-AH-OVERRIDE-L1               PIC X.
  1155     12  PI-AH-OVERRIDE-L2               PIC XX.
  1156     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1157     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1158
  1159     12  PI-NEW-SYSTEM                   PIC X(2).
  1160
  1161     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1162     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1163         88  PI-USES-PAID-TO                 VALUE '1'.
  1164     12  PI-CRDTCRD-SYSTEM.
  1165         16  PI-CRDTCRD-USER             PIC X.
  1166             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1167             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1168         16  PI-CC-MONTH-END-DT          PIC XX.
  1169     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1170
  1171     12  PI-OE-REFERENCE-2.
  1172         16  PI-OE-REF-2-PRIME           PIC X(10).
  1173         16  PI-OE-REF-2-SUFF            PIC X.
  1174
  1175     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1176
  1177     12  PI-LANGUAGE-TYPE                PIC X.
  1178             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1179             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1180             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1181
  1182     12  PI-POLICY-LINKAGE-IND           PIC X.
  1183         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1184         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1185                                                   LOW-VALUES.
  1186
  1187     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1188     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1189         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1190         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1191
  1192     12  PI-PROCESSOR-CSR-IND            PIC X.
  1193         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1194         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1195
  1196     12  FILLER                          PIC X(3).
  1197
  1198     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1199
  1200     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1201         PI-SYSTEM-LEVEL.
  1202
  1203         16  PI-ENTRY-CODES.
  1204             20  PI-ENTRY-CD-1           PIC X.
  1205             20  PI-ENTRY-CD-2           PIC X.
  1206
  1207         16  PI-RETURN-CODES.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  23
* EL6318.cbl
  1208             20  PI-RETURN-CD-1          PIC X.
  1209             20  PI-RETURN-CD-2          PIC X.
  1210
  1211         16  PI-UPDATE-STATUS-SAVE.
  1212             20  PI-UPDATE-BY            PIC X(4).
  1213             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1214
  1215         16  PI-LOWER-CASE-LETTERS       PIC X.
  1216             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1217
  1218*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1219*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1220*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1221
  1222         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1223             88  ST-ACCNT-CNTL               VALUE ' '.
  1224             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1225             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1226             88  ACCNT-CNTL                  VALUE '3'.
  1227             88  CARR-ACCNT-CNTL             VALUE '4'.
  1228
  1229         16  PI-PROCESSOR-CAP-LIST.
  1230             20  PI-SYSTEM-CONTROLS.
  1231                24 PI-SYSTEM-DISPLAY     PIC X.
  1232                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1233                24 PI-SYSTEM-MODIFY      PIC X.
  1234                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1235             20  FILLER                  PIC XX.
  1236             20  PI-DISPLAY-CAP          PIC X.
  1237                 88  DISPLAY-CAP             VALUE 'Y'.
  1238             20  PI-MODIFY-CAP           PIC X.
  1239                 88  MODIFY-CAP              VALUE 'Y'.
  1240             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1241                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1242             20  PI-FORCE-CAP            PIC X.
  1243                 88  FORCE-CAP               VALUE 'Y'.
  1244
  1245         16  PI-PROGRAM-CONTROLS.
  1246             20  PI-PGM-PRINT-OPT        PIC X.
  1247             20  PI-PGM-FORMAT-OPT       PIC X.
  1248             20  PI-PGM-PROCESS-OPT      PIC X.
  1249             20  PI-PGM-TOTALS-OPT       PIC X.
  1250
  1251         16  PI-HELP-INTERFACE.
  1252             20  PI-LAST-ERROR-NO        PIC X(4).
  1253             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1254
  1255         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1256             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1257
  1258         16  PI-CR-CONTROL-IN-PROGRESS.
  1259             20  PI-CR-CARRIER           PIC X.
  1260             20  PI-CR-GROUPING          PIC X(6).
  1261             20  PI-CR-STATE             PIC XX.
  1262             20  PI-CR-ACCOUNT           PIC X(10).
  1263             20  PI-CR-FIN-RESP          PIC X(10).
  1264             20  PI-CR-TYPE              PIC X.
  1265
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  24
* EL6318.cbl
  1266         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1267
  1268         16  PI-CR-MONTH-END-DT          PIC XX.
  1269
  1270         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1271             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1272             88  PI-ZERO-CARRIER             VALUE '1'.
  1273             88  PI-ZERO-GROUPING            VALUE '2'.
  1274             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1275
  1276         16  PI-CARRIER-SECURITY         PIC X.
  1277             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1278
  1279         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1280             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1281             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1282
  1283         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1284             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1285                                         INDEXED BY PI-ACCESS-NDX
  1286                                         PIC X.
  1287
  1288         16  PI-GA-BILLING-CONTROL       PIC X.
  1289             88  PI-GA-BILLING               VALUE '1'.
  1290
  1291         16  PI-MAIL-PROCESSING          PIC X.
  1292             88  PI-MAIL-YES                 VALUE 'Y'.
  1293
  1294         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1295
  1296         16  PI-AR-SYSTEM.
  1297             20  PI-AR-PROCESSING-CNTL   PIC X.
  1298                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1299             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1300             20  PI-AR-MONTH-END-DT      PIC XX.
  1301
  1302         16  PI-MP-SYSTEM.
  1303             20  PI-MORTGAGE-USER            PIC X.
  1304                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1305                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1306             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1307                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1308                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1309                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1310                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1311                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1312             20  PI-MP-MONTH-END-DT          PIC XX.
  1313             20  PI-MP-REFERENCE-NO.
  1314                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1315                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1316
  1317         16  PI-LABEL-CONTROL            PIC X(01).
  1318             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1319             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1320
  1321         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1322             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1323
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  25
* EL6318.cbl
  1324         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1325             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1326             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1327
  1328         16  FILLER                      PIC X(14).
  1329
  1330     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1331******************************************************************
  1332     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1333        16  PI-ISS-CAN-SW           PIC X.
  1334        16  PI-ERENDT-KEY.  *>  36
  1335            20  PI-ENDT-COMPANY-CD  PIC X.
  1336            20  PI-ENDT-CARRIER     PIC X.
  1337            20  PI-ENDT-GROUPING    PIC X(6).
  1338            20  PI-ENDT-STATE       PIC XX.
  1339            20  PI-ENDT-ACCOUNT     PIC X(10).
  1340            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1341            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1342            20  PI-ENDT-CERT-SFX    PIC X.
  1343            20  PI-ENDT-RECORD-TYPE PIC X.
  1344            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1345        16  PI-ELCRTO-KEY.  *> 36
  1346            20  PI-CRTO-COMPANY-CD  PIC X.
  1347            20  PI-CRTO-CARRIER     PIC X.
  1348            20  PI-CRTO-GROUPING    PIC X(6).
  1349            20  PI-CRTO-STATE       PIC XX.
  1350            20  PI-CRTO-ACCOUNT     PIC X(10).
  1351            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1352            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1353            20  PI-CRTO-CERT-SFX    PIC X.
  1354            20  PI-CRTO-RECORD-TYPE PIC X.
  1355            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1356        16  PI-ERPNDB-KEY           PIC X(11).
  1357        16  PI-DOCUMENT-PROCESSED   PIC X.
  1358            88  PI-VERI-PROCESSED      VALUE 'V'.
  1359            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1360        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1361        16  PI-RES-REF-CLM-TYPE     PIC X.
  1362        16  PI-CLM-REFORM-IND       PIC X.
  1363            88  PI-CLAIM-REFORMATION   VALUE 'Y'.
  1364        16  PI-CLEAR-ERROR-SW       PIC X.
  1365            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1366        16  PI-PRINT-CERTIFICATE    PIC X.
  1367        16  PI-ENTERED.  *> 233
  1368            20  PI-PRTSW-ENTERED    PIC X.
  1369            20  PI-SIGREQ-ENTERED   PIC X.
  1370            20  PI-LTRID-ENTERED    PIC X(4).
  1371            20  PI-VOUCHER-ENTERED  PIC X.
  1372            20  PI-HLTHAPP-ENTERED  PIC X.
  1373            20  PI-PAYEE-ENTERED    PIC X(10).
  1374            20  PI-CERTID-ENTERED   PIC X(5).
  1375            20  PI-REASONS-ENTERED  PIC X(84).
  1376            20  PI-CERTNT1-ENTERED  PIC X(63).
  1377            20  PI-CERTNT2-ENTERED  PIC X(63).
  1378        16  PI-FINALIZED-IND        PIC X.
  1379        16  PI-CERTNT3-ENTERED      PIC X(63).
  1380        16  PI-CERTNT4-ENTERED      PIC X(63).
  1381        16  PI-BILLNT1-ENTERED      PIC X(63).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  26
* EL6318.cbl
  1382        16  PI-BILLNT2-ENTERED      PIC X(63).
  1383        16  PI-REASON-CODE-IND      PIC X(26).
  1384        16  PI-ENCCODE              PIC X(3).
  1385    12  pi-el677-work-area redefines pi-program-work-area.
  1386        16  filler                  pic x(318).
  1387        16  pi-el677-prm-diff       pic s9(7)v99 comp-3.
  1388        16  pi-el677-com-diff       pic s9(5)v99 comp-3.
  1389        16  pi-el677-check-type     pic x.
  1390        16  pi-el677-check-cut      pic x.
  1391        16  filler                  pic x(311).
  1392    12  pi-endt-prm-diff            pic s9(7)v99 comp-3.
  1393    12  pi-endt-com-diff            pic s9(5)v99 comp-3.
  1394    12  pi-check-cut                pic x.
  1395    12  pi-check-type               pic x.
  1396    12  FILLER                      PIC X(265). *> was 276
  1397*    COPY ELCAID.
  1398******************************************************************
  1399*                                                                *
  1400*                            ELCAID.                             *
  1401*                            VMOD=2.001                          *
  1402*                                                                *
  1403*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1404*                                                                *
  1405*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1406*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1407******************************************************************
  1408
  1409 01  DFHAID.
  1410   02  DFHNULL   PIC  X  VALUE  ' '.
  1411   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1412   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1413   02  DFHPEN    PIC  X  VALUE  '='.
  1414   02  DFHOPID   PIC  X  VALUE  'W'.
  1415   02  DFHPA1    PIC  X  VALUE  '%'.
  1416   02  DFHPA2    PIC  X  VALUE  '>'.
  1417   02  DFHPA3    PIC  X  VALUE  ','.
  1418   02  DFHPF1    PIC  X  VALUE  '1'.
  1419   02  DFHPF2    PIC  X  VALUE  '2'.
  1420   02  DFHPF3    PIC  X  VALUE  '3'.
  1421   02  DFHPF4    PIC  X  VALUE  '4'.
  1422   02  DFHPF5    PIC  X  VALUE  '5'.
  1423   02  DFHPF6    PIC  X  VALUE  '6'.
  1424   02  DFHPF7    PIC  X  VALUE  '7'.
  1425   02  DFHPF8    PIC  X  VALUE  '8'.
  1426   02  DFHPF9    PIC  X  VALUE  '9'.
  1427   02  DFHPF10   PIC  X  VALUE  ':'.
  1428   02  DFHPF11   PIC  X  VALUE  '#'.
  1429   02  DFHPF12   PIC  X  VALUE  '@'.
  1430   02  DFHPF13   PIC  X  VALUE  'A'.
  1431   02  DFHPF14   PIC  X  VALUE  'B'.
  1432   02  DFHPF15   PIC  X  VALUE  'C'.
  1433   02  DFHPF16   PIC  X  VALUE  'D'.
  1434   02  DFHPF17   PIC  X  VALUE  'E'.
  1435   02  DFHPF18   PIC  X  VALUE  'F'.
  1436   02  DFHPF19   PIC  X  VALUE  'G'.
  1437   02  DFHPF20   PIC  X  VALUE  'H'.
  1438   02  DFHPF21   PIC  X  VALUE  'I'.
  1439*00039    02  DFHPF22   PIC  X  VALUE  ''.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  27
* EL6318.cbl
  1440   02  DFHPF22   PIC  X  VALUE  '['.
  1441   02  DFHPF23   PIC  X  VALUE  '.'.
  1442   02  DFHPF24   PIC  X  VALUE  '<'.
  1443   02  DFHMSRE   PIC  X  VALUE  'X'.
  1444   02  DFHSTRF   PIC  X  VALUE  'h'.
  1445   02  DFHTRIG   PIC  X  VALUE  '"'.
  1446 01  FILLER    REDEFINES DFHAID.
  1447     12  FILLER              PIC X(8).
  1448     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1449     12  FILLER              PIC X(3).
  1450*   COPY EL6318S.
  1451 01  EL631KI.
  1452     05  FILLER            PIC  X(0012).
  1453*    -------------------------------
  1454     05  DATEL PIC S9(0004) COMP.
  1455     05  DATEF PIC  X(0001).
  1456     05  FILLER REDEFINES DATEF.
  1457         10  DATEA PIC  X(0001).
  1458     05  DATEI PIC  X(0008).
  1459*    -------------------------------
  1460     05  TIMEL PIC S9(0004) COMP.
  1461     05  TIMEF PIC  X(0001).
  1462     05  FILLER REDEFINES TIMEF.
  1463         10  TIMEA PIC  X(0001).
  1464     05  TIMEI PIC  X(0005).
  1465*    -------------------------------
  1466     05  PROCIDL PIC S9(0004) COMP.
  1467     05  PROCIDF PIC  X(0001).
  1468     05  FILLER REDEFINES PROCIDF.
  1469         10  PROCIDA PIC  X(0001).
  1470     05  PROCIDI PIC  X(0004).
  1471*    -------------------------------
  1472     05  HOSTL PIC S9(0004) COMP.
  1473     05  HOSTF PIC  X(0001).
  1474     05  FILLER REDEFINES HOSTF.
  1475         10  HOSTA PIC  X(0001).
  1476     05  HOSTI PIC  X(0009).
  1477*    -------------------------------
  1478     05  SYSL PIC S9(0004) COMP.
  1479     05  SYSF PIC  X(0001).
  1480     05  FILLER REDEFINES SYSF.
  1481         10  SYSA PIC  X(0001).
  1482     05  SYSI PIC  X(0005).
  1483*    -------------------------------
  1484     05  COMPANYL PIC S9(0004) COMP.
  1485     05  COMPANYF PIC  X(0001).
  1486     05  FILLER REDEFINES COMPANYF.
  1487         10  COMPANYA PIC  X(0001).
  1488     05  COMPANYI PIC  X(0003).
  1489*    -------------------------------
  1490     05  DATASORL PIC S9(0004) COMP.
  1491     05  DATASORF PIC  X(0001).
  1492     05  FILLER REDEFINES DATASORF.
  1493         10  DATASORA PIC  X(0001).
  1494     05  DATASORI PIC  X(0001).
  1495*    -------------------------------
  1496     05  BATCHNOL PIC S9(0004) COMP.
  1497     05  BATCHNOF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  28
* EL6318.cbl
  1498     05  FILLER REDEFINES BATCHNOF.
  1499         10  BATCHNOA PIC  X(0001).
  1500     05  BATCHNOI PIC  X(0006).
  1501*    -------------------------------
  1502     05  BSEQNOL PIC S9(0004) COMP.
  1503     05  BSEQNOF PIC  X(0001).
  1504     05  FILLER REDEFINES BSEQNOF.
  1505         10  BSEQNOA PIC  X(0001).
  1506     05  BSEQNOI PIC  X(0008).
  1507*    -------------------------------
  1508     05  ARCHNOL PIC S9(0004) COMP.
  1509     05  ARCHNOF PIC  X(0001).
  1510     05  FILLER REDEFINES ARCHNOF.
  1511         10  ARCHNOA PIC  X(0001).
  1512     05  ARCHNOI PIC  X(0008).
  1513*    -------------------------------
  1514     05  PRTSWL PIC S9(0004) COMP.
  1515     05  PRTSWF PIC  X(0001).
  1516     05  FILLER REDEFINES PRTSWF.
  1517         10  PRTSWA PIC  X(0001).
  1518     05  PRTSWI PIC  X(0001).
  1519*    -------------------------------
  1520     05  CARRL PIC S9(0004) COMP.
  1521     05  CARRF PIC  X(0001).
  1522     05  FILLER REDEFINES CARRF.
  1523         10  CARRA PIC  X(0001).
  1524     05  CARRI PIC  X(0001).
  1525*    -------------------------------
  1526     05  GROUPL PIC S9(0004) COMP.
  1527     05  GROUPF PIC  X(0001).
  1528     05  FILLER REDEFINES GROUPF.
  1529         10  GROUPA PIC  X(0001).
  1530     05  GROUPI PIC  X(0006).
  1531*    -------------------------------
  1532     05  STATEL PIC S9(0004) COMP.
  1533     05  STATEF PIC  X(0001).
  1534     05  FILLER REDEFINES STATEF.
  1535         10  STATEA PIC  X(0001).
  1536     05  STATEI PIC  X(0002).
  1537*    -------------------------------
  1538     05  ACCTL PIC S9(0004) COMP.
  1539     05  ACCTF PIC  X(0001).
  1540     05  FILLER REDEFINES ACCTF.
  1541         10  ACCTA PIC  X(0001).
  1542     05  ACCTI PIC  X(0010).
  1543*    -------------------------------
  1544     05  EFFDTL PIC S9(0004) COMP.
  1545     05  EFFDTF PIC  X(0001).
  1546     05  FILLER REDEFINES EFFDTF.
  1547         10  EFFDTA PIC  X(0001).
  1548     05  EFFDTI PIC  X(0008).
  1549*    -------------------------------
  1550     05  CERTNOL PIC S9(0004) COMP.
  1551     05  CERTNOF PIC  X(0001).
  1552     05  FILLER REDEFINES CERTNOF.
  1553         10  CERTNOA PIC  X(0001).
  1554     05  CERTNOI PIC  X(0010).
  1555*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  29
* EL6318.cbl
  1556     05  CRTSFXL PIC S9(0004) COMP.
  1557     05  CRTSFXF PIC  X(0001).
  1558     05  FILLER REDEFINES CRTSFXF.
  1559         10  CRTSFXA PIC  X(0001).
  1560     05  CRTSFXI PIC  X(0001).
  1561*    -------------------------------
  1562     05  SEQNOL PIC S9(0004) COMP.
  1563     05  SEQNOF PIC  X(0001).
  1564     05  FILLER REDEFINES SEQNOF.
  1565         10  SEQNOA PIC  X(0001).
  1566     05  SEQNOI PIC  X(0006).
  1567*    -------------------------------
  1568     05  SIGREQL PIC S9(0004) COMP.
  1569     05  SIGREQF PIC  X(0001).
  1570     05  FILLER REDEFINES SIGREQF.
  1571         10  SIGREQA PIC  X(0001).
  1572     05  SIGREQI PIC  X(0001).
  1573*    -------------------------------
  1574     05  LTRIDL PIC S9(0004) COMP.
  1575     05  LTRIDF PIC  X(0001).
  1576     05  FILLER REDEFINES LTRIDF.
  1577         10  LTRIDA PIC  X(0001).
  1578     05  LTRIDI PIC  X(0004).
  1579*    -------------------------------
  1580     05  HLTHAPPL PIC S9(0004) COMP.
  1581     05  HLTHAPPF PIC  X(0001).
  1582     05  FILLER REDEFINES HLTHAPPF.
  1583         10  HLTHAPPA PIC  X(0001).
  1584     05  HLTHAPPI PIC  X(0001).
  1585*    -------------------------------
  1586     05  VOUCHL PIC S9(0004) COMP.
  1587     05  VOUCHF PIC  X(0001).
  1588     05  FILLER REDEFINES VOUCHF.
  1589         10  VOUCHA PIC  X(0001).
  1590     05  VOUCHI PIC  X(0001).
  1591*    -------------------------------
  1592     05  PAYEEL PIC S9(0004) COMP.
  1593     05  PAYEEF PIC  X(0001).
  1594     05  FILLER REDEFINES PAYEEF.
  1595         10  PAYEEA PIC  X(0001).
  1596     05  PAYEEI PIC  X(0010).
  1597*    -------------------------------
  1598     05  CERTIDL PIC S9(0004) COMP.
  1599     05  CERTIDF PIC  X(0001).
  1600     05  FILLER REDEFINES CERTIDF.
  1601         10  CERTIDA PIC  X(0001).
  1602     05  CERTIDI PIC  X(0005).
  1603*    -------------------------------
  1604     05  ENCCODEL PIC S9(0004) COMP.
  1605     05  ENCCODEF PIC  X(0001).
  1606     05  FILLER REDEFINES ENCCODEF.
  1607         10  ENCCODEA PIC  X(0001).
  1608     05  ENCCODEI PIC  X(0003).
  1609*    -------------------------------
  1610     05  RCD01L PIC S9(0004) COMP.
  1611     05  RCD01F PIC  X(0001).
  1612     05  FILLER REDEFINES RCD01F.
  1613         10  RCD01A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  30
* EL6318.cbl
  1614     05  RCD01I PIC  X(0004).
  1615*    -------------------------------
  1616     05  RCD02L PIC S9(0004) COMP.
  1617     05  RCD02F PIC  X(0001).
  1618     05  FILLER REDEFINES RCD02F.
  1619         10  RCD02A PIC  X(0001).
  1620     05  RCD02I PIC  X(0004).
  1621*    -------------------------------
  1622     05  RCD03L PIC S9(0004) COMP.
  1623     05  RCD03F PIC  X(0001).
  1624     05  FILLER REDEFINES RCD03F.
  1625         10  RCD03A PIC  X(0001).
  1626     05  RCD03I PIC  X(0004).
  1627*    -------------------------------
  1628     05  RCD04L PIC S9(0004) COMP.
  1629     05  RCD04F PIC  X(0001).
  1630     05  FILLER REDEFINES RCD04F.
  1631         10  RCD04A PIC  X(0001).
  1632     05  RCD04I PIC  X(0004).
  1633*    -------------------------------
  1634     05  RCD05L PIC S9(0004) COMP.
  1635     05  RCD05F PIC  X(0001).
  1636     05  FILLER REDEFINES RCD05F.
  1637         10  RCD05A PIC  X(0001).
  1638     05  RCD05I PIC  X(0004).
  1639*    -------------------------------
  1640     05  RCD06L PIC S9(0004) COMP.
  1641     05  RCD06F PIC  X(0001).
  1642     05  FILLER REDEFINES RCD06F.
  1643         10  RCD06A PIC  X(0001).
  1644     05  RCD06I PIC  X(0004).
  1645*    -------------------------------
  1646     05  RCD07L PIC S9(0004) COMP.
  1647     05  RCD07F PIC  X(0001).
  1648     05  FILLER REDEFINES RCD07F.
  1649         10  RCD07A PIC  X(0001).
  1650     05  RCD07I PIC  X(0004).
  1651*    -------------------------------
  1652     05  RCD08L PIC S9(0004) COMP.
  1653     05  RCD08F PIC  X(0001).
  1654     05  FILLER REDEFINES RCD08F.
  1655         10  RCD08A PIC  X(0001).
  1656     05  RCD08I PIC  X(0004).
  1657*    -------------------------------
  1658     05  RCD09L PIC S9(0004) COMP.
  1659     05  RCD09F PIC  X(0001).
  1660     05  FILLER REDEFINES RCD09F.
  1661         10  RCD09A PIC  X(0001).
  1662     05  RCD09I PIC  X(0004).
  1663*    -------------------------------
  1664     05  RCD10L PIC S9(0004) COMP.
  1665     05  RCD10F PIC  X(0001).
  1666     05  FILLER REDEFINES RCD10F.
  1667         10  RCD10A PIC  X(0001).
  1668     05  RCD10I PIC  X(0004).
  1669*    -------------------------------
  1670     05  RCD11L PIC S9(0004) COMP.
  1671     05  RCD11F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  31
* EL6318.cbl
  1672     05  FILLER REDEFINES RCD11F.
  1673         10  RCD11A PIC  X(0001).
  1674     05  RCD11I PIC  X(0004).
  1675*    -------------------------------
  1676     05  RCD12L PIC S9(0004) COMP.
  1677     05  RCD12F PIC  X(0001).
  1678     05  FILLER REDEFINES RCD12F.
  1679         10  RCD12A PIC  X(0001).
  1680     05  RCD12I PIC  X(0004).
  1681*    -------------------------------
  1682     05  CRTNT1L PIC S9(0004) COMP.
  1683     05  CRTNT1F PIC  X(0001).
  1684     05  FILLER REDEFINES CRTNT1F.
  1685         10  CRTNT1A PIC  X(0001).
  1686     05  CRTNT1I PIC  X(0063).
  1687*    -------------------------------
  1688     05  CRTNT2L PIC S9(0004) COMP.
  1689     05  CRTNT2F PIC  X(0001).
  1690     05  FILLER REDEFINES CRTNT2F.
  1691         10  CRTNT2A PIC  X(0001).
  1692     05  CRTNT2I PIC  X(0063).
  1693*    -------------------------------
  1694     05  CRTNT3L PIC S9(0004) COMP.
  1695     05  CRTNT3F PIC  X(0001).
  1696     05  FILLER REDEFINES CRTNT3F.
  1697         10  CRTNT3A PIC  X(0001).
  1698     05  CRTNT3I PIC  X(0063).
  1699*    -------------------------------
  1700     05  CRTNT4L PIC S9(0004) COMP.
  1701     05  CRTNT4F PIC  X(0001).
  1702     05  FILLER REDEFINES CRTNT4F.
  1703         10  CRTNT4A PIC  X(0001).
  1704     05  CRTNT4I PIC  X(0063).
  1705*    -------------------------------
  1706     05  BILNT1L PIC S9(0004) COMP.
  1707     05  BILNT1F PIC  X(0001).
  1708     05  FILLER REDEFINES BILNT1F.
  1709         10  BILNT1A PIC  X(0001).
  1710     05  BILNT1I PIC  X(0063).
  1711*    -------------------------------
  1712     05  BILNT2L PIC S9(0004) COMP.
  1713     05  BILNT2F PIC  X(0001).
  1714     05  FILLER REDEFINES BILNT2F.
  1715         10  BILNT2A PIC  X(0001).
  1716     05  BILNT2I PIC  X(0063).
  1717*    -------------------------------
  1718     05  ERRMSG1L PIC S9(0004) COMP.
  1719     05  ERRMSG1F PIC  X(0001).
  1720     05  FILLER REDEFINES ERRMSG1F.
  1721         10  ERRMSG1A PIC  X(0001).
  1722     05  ERRMSG1I PIC  X(0075).
  1723*    -------------------------------
  1724     05  ERRMSG2L PIC S9(0004) COMP.
  1725     05  ERRMSG2F PIC  X(0001).
  1726     05  FILLER REDEFINES ERRMSG2F.
  1727         10  ERRMSG2A PIC  X(0001).
  1728     05  ERRMSG2I PIC  X(0075).
  1729*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  32
* EL6318.cbl
  1730     05  PFENTRL PIC S9(0004) COMP.
  1731     05  PFENTRF PIC  X(0001).
  1732     05  FILLER REDEFINES PFENTRF.
  1733         10  PFENTRA PIC  X(0001).
  1734     05  PFENTRI PIC  9(2).
  1735 01  EL631KO REDEFINES EL631KI.
  1736     05  FILLER            PIC  X(0012).
  1737*    -------------------------------
  1738     05  FILLER            PIC  X(0003).
  1739     05  DATEO PIC  X(0008).
  1740*    -------------------------------
  1741     05  FILLER            PIC  X(0003).
  1742     05  TIMEO PIC  99.99.
  1743*    -------------------------------
  1744     05  FILLER            PIC  X(0003).
  1745     05  PROCIDO PIC  X(0004).
  1746*    -------------------------------
  1747     05  FILLER            PIC  X(0003).
  1748     05  HOSTO PIC  X(0009).
  1749*    -------------------------------
  1750     05  FILLER            PIC  X(0003).
  1751     05  SYSO PIC  X(0005).
  1752*    -------------------------------
  1753     05  FILLER            PIC  X(0003).
  1754     05  COMPANYO PIC  X(0003).
  1755*    -------------------------------
  1756     05  FILLER            PIC  X(0003).
  1757     05  DATASORO PIC  X(0001).
  1758*    -------------------------------
  1759     05  FILLER            PIC  X(0003).
  1760     05  BATCHNOO PIC  X(0006).
  1761*    -------------------------------
  1762     05  FILLER            PIC  X(0003).
  1763     05  BSEQNOO PIC  X(0008).
  1764*    -------------------------------
  1765     05  FILLER            PIC  X(0003).
  1766     05  ARCHNOO PIC  X(0008).
  1767*    -------------------------------
  1768     05  FILLER            PIC  X(0003).
  1769     05  PRTSWO PIC  X(0001).
  1770*    -------------------------------
  1771     05  FILLER            PIC  X(0003).
  1772     05  CARRO PIC  X(0001).
  1773*    -------------------------------
  1774     05  FILLER            PIC  X(0003).
  1775     05  GROUPO PIC  X(0006).
  1776*    -------------------------------
  1777     05  FILLER            PIC  X(0003).
  1778     05  STATEO PIC  X(0002).
  1779*    -------------------------------
  1780     05  FILLER            PIC  X(0003).
  1781     05  ACCTO PIC  X(0010).
  1782*    -------------------------------
  1783     05  FILLER            PIC  X(0003).
  1784     05  EFFDTO PIC  X(0008).
  1785*    -------------------------------
  1786     05  FILLER            PIC  X(0003).
  1787     05  CERTNOO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  33
* EL6318.cbl
  1788*    -------------------------------
  1789     05  FILLER            PIC  X(0003).
  1790     05  CRTSFXO PIC  X(0001).
  1791*    -------------------------------
  1792     05  FILLER            PIC  X(0003).
  1793     05  SEQNOO PIC  999999.
  1794*    -------------------------------
  1795     05  FILLER            PIC  X(0003).
  1796     05  SIGREQO PIC  X(0001).
  1797*    -------------------------------
  1798     05  FILLER            PIC  X(0003).
  1799     05  LTRIDO PIC  X(0004).
  1800*    -------------------------------
  1801     05  FILLER            PIC  X(0003).
  1802     05  HLTHAPPO PIC  X(0001).
  1803*    -------------------------------
  1804     05  FILLER            PIC  X(0003).
  1805     05  VOUCHO PIC  X(0001).
  1806*    -------------------------------
  1807     05  FILLER            PIC  X(0003).
  1808     05  PAYEEO PIC  X(0010).
  1809*    -------------------------------
  1810     05  FILLER            PIC  X(0003).
  1811     05  CERTIDO PIC  X(0005).
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  ENCCODEO PIC  X(0003).
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  RCD01O PIC  X(0004).
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  RCD02O PIC  X(0004).
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  RCD03O PIC  X(0004).
  1824*    -------------------------------
  1825     05  FILLER            PIC  X(0003).
  1826     05  RCD04O PIC  X(0004).
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  RCD05O PIC  X(0004).
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  RCD06O PIC  X(0004).
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  RCD07O PIC  X(0004).
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  RCD08O PIC  X(0004).
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  RCD09O PIC  X(0004).
  1842*    -------------------------------
  1843     05  FILLER            PIC  X(0003).
  1844     05  RCD10O PIC  X(0004).
  1845*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  34
* EL6318.cbl
  1846     05  FILLER            PIC  X(0003).
  1847     05  RCD11O PIC  X(0004).
  1848*    -------------------------------
  1849     05  FILLER            PIC  X(0003).
  1850     05  RCD12O PIC  X(0004).
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  CRTNT1O PIC  X(0063).
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  CRTNT2O PIC  X(0063).
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
  1859     05  CRTNT3O PIC  X(0063).
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  CRTNT4O PIC  X(0063).
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  BILNT1O PIC  X(0063).
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
  1868     05  BILNT2O PIC  X(0063).
  1869*    -------------------------------
  1870     05  FILLER            PIC  X(0003).
  1871     05  ERRMSG1O PIC  X(0075).
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  ERRMSG2O PIC  X(0075).
  1875*    -------------------------------
  1876     05  FILLER            PIC  X(0003).
  1877     05  PFENTRO PIC  X(0002).
  1878*    -------------------------------
  1879 01  FILLER REDEFINES EL631KI.
  1880     12  FILLER             PIC X(217).
  1881     12  REASONCDS.
  1882         16  FILLER OCCURS 12.
  1883           20  REACDL       PIC S9(4) COMP.
  1884           20  REACDA       PIC X.
  1885           20  REACD-IN     PIC X(4).
  1886     12  FILLER             PIC X(557).
  1887****************************************************************
  1888*
  1889* Copyright (c) 2007-2013 Dell Inc.
  1890* All rights reserved.
  1891*
  1892****************************************************************
  1893 01  DFHEIV.
  1894   02  DFHEIV0               PIC X(35).
  1895   02  DFHEIV1               PIC X(08).
  1896   02  DFHEIV2               PIC X(08).
  1897   02  DFHEIV3               PIC X(08).
  1898   02  DFHEIV4               PIC X(06).
  1899   02  DFHEIV5               PIC X(04).
  1900   02  DFHEIV6               PIC X(04).
  1901   02  DFHEIV7               PIC X(02).
  1902   02  DFHEIV8               PIC X(02).
  1903   02  DFHEIV9               PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  35
* EL6318.cbl
  1904   02  DFHEIV10              PIC S9(7) COMP-3.
  1905   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1906   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1907   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1908   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1909   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1910   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1911   02  DFHEIV17              PIC X(04).
  1912   02  DFHEIV18              PIC X(04).
  1913   02  DFHEIV19              PIC X(04).
  1914   02  DFHEIV20              USAGE IS POINTER.
  1915   02  DFHEIV21              USAGE IS POINTER.
  1916   02  DFHEIV22              USAGE IS POINTER.
  1917   02  DFHEIV23              USAGE IS POINTER.
  1918   02  DFHEIV24              USAGE IS POINTER.
  1919   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1920   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1921   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1922   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1923   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1924   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1925   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1926   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1927   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1928   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1929   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1930   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1931   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1932   02  FILLER                PIC X(02).
  1933   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1934   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1935   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1936   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1937   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1938   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1939   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1940 LINKAGE  SECTION.
  1941*****************************************************************
  1942*                                                               *
  1943* Copyright (c) 2007-2013 Dell Inc.                             *
  1944* All rights reserved.                                          *
  1945*                                                               *
  1946*****************************************************************
  1947 01  dfheiblk.
  1948     02  eibtime          pic s9(7) comp-3.
  1949     02  eibdate          pic s9(7) comp-3.
  1950     02  eibtrnid         pic x(4).
  1951     02  eibtaskn         pic s9(7) comp-3.
  1952     02  eibtrmid         pic x(4).
  1953     02  dfheigdi         pic s9(4) comp.
  1954     02  eibcposn         pic s9(4) comp.
  1955     02  eibcalen         pic s9(4) comp.
  1956     02  eibaid           pic x(1).
  1957     02  eibfiller1       pic x(1).
  1958     02  eibfn            pic x(2).
  1959     02  eibfiller2       pic x(2).
  1960     02  eibrcode         pic x(6).
  1961     02  eibfiller3       pic x(2).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  36
* EL6318.cbl
  1962     02  eibds            pic x(8).
  1963     02  eibreqid         pic x(8).
  1964     02  eibrsrce         pic x(8).
  1965     02  eibsync          pic x(1).
  1966     02  eibfree          pic x(1).
  1967     02  eibrecv          pic x(1).
  1968     02  eibsend          pic x(1).
  1969     02  eibatt           pic x(1).
  1970     02  eibeoc           pic x(1).
  1971     02  eibfmh           pic x(1).
  1972     02  eibcompl         pic x(1).
  1973     02  eibsig           pic x(1).
  1974     02  eibconf          pic x(1).
  1975     02  eiberr           pic x(1).
  1976     02  eibrldbk         pic x(1).
  1977     02  eiberrcd         pic x(4).
  1978     02  eibsynrb         pic x(1).
  1979     02  eibnodat         pic x(1).
  1980     02  eibfiller5       pic x(2).
  1981     02  eibresp          pic s9(8) comp.
  1982     02  eibresp2         pic s9(8) comp.
  1983     02  dfheigdj         pic s9(4) comp.
  1984     02  dfheigdk         pic s9(4) comp.
  1985 01  DFHCOMMAREA                 PIC X(1300).
  1986 01  var  pic x(30).
  1987*                                COPY ERCACCT.
  1988******************************************************************
  1989*                                                                *
  1990*                                                                *
  1991*                            ERCACCT                             *
  1992*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1993*                            VMOD=2.031                          *
  1994*                                                                *
  1995*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1996*                                                                *
  1997*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1998*   VSAM ACCOUNT MASTER FILES.                                   *
  1999*                                                                *
  2000*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2001*                                                                *
  2002*   FILE TYPE = VSAM,KSDS                                        *
  2003*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2004*                                                                *
  2005*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2006*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2007*                                                                *
  2008*   LOG = NO                                                     *
  2009*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2010*                                                                *
  2011*                                                                *
  2012******************************************************************
  2013*                   C H A N G E   L O G
  2014*
  2015* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2016*-----------------------------------------------------------------
  2017*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2018* EFFECTIVE    NUMBER
  2019*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  37
* EL6318.cbl
  2020* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2021* 092705    2005050300006  PEMA  ADD SPP LEASES
  2022* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2023* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2024* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2025* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2026* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2027* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2028******************************************************************
  2029
  2030 01  ACCOUNT-MASTER.
  2031     12  AM-RECORD-ID                      PIC XX.
  2032         88  VALID-AM-ID                      VALUE 'AM'.
  2033
  2034     12  AM-CONTROL-PRIMARY.
  2035         16  AM-COMPANY-CD                 PIC X.
  2036         16  AM-MSTR-CNTRL.
  2037             20  AM-CONTROL-A.
  2038                 24  AM-CARRIER            PIC X.
  2039                 24  AM-GROUPING.
  2040                     28 AM-GROUPING-PREFIX PIC XXX.
  2041                     28 AM-GROUPING-PRIME  PIC XXX.
  2042                 24  AM-STATE              PIC XX.
  2043                 24  AM-ACCOUNT.
  2044                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2045                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2046             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2047                                           PIC X(19).
  2048             20  AM-CNTRL-B.
  2049                 24  AM-EXPIRATION-DT      PIC XX.
  2050                 24  FILLER                PIC X(4).
  2051             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2052                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2053
  2054     12  AM-CONTROL-BY-VAR-GRP.
  2055         16  AM-COMPANY-CD-A1              PIC X.
  2056         16  AM-VG-CARRIER                 PIC X.
  2057         16  AM-VG-GROUPING                PIC X(6).
  2058         16  AM-VG-STATE                   PIC XX.
  2059         16  AM-VG-ACCOUNT                 PIC X(10).
  2060         16  AM-VG-DATE.
  2061             20  AM-VG-EXPIRATION-DT       PIC XX.
  2062             20  FILLER                    PIC X(4).
  2063         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2064                                           PIC 9(11)      COMP-3.
  2065     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2066         16  FILLER                        PIC X(10).
  2067         16  AM-VG-KEY3.
  2068             20  AM-VG3-ACCOUNT            PIC X(10).
  2069             20  AM-VG3-EXP-DT             PIC XX.
  2070         16  FILLER                        PIC X(4).
  2071     12  AM-MAINT-INFORMATION.
  2072         16  AM-LAST-MAINT-DT              PIC XX.
  2073         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2074         16  AM-LAST-MAINT-USER            PIC X(4).
  2075         16  FILLER                        PIC XX.
  2076
  2077     12  AM-EFFECTIVE-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  38
* EL6318.cbl
  2078     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2079
  2080     12  AM-PREV-DATES  COMP-3.
  2081         16  AM-PREV-EXP-DT                PIC 9(11).
  2082         16  AM-PREV-EFF-DT                PIC 9(11).
  2083
  2084     12  AM-REPORT-CODE-1                  PIC X(10).
  2085     12  AM-REPORT-CODE-2                  PIC X(10).
  2086
  2087     12  AM-CITY-CODE                      PIC X(4).
  2088     12  AM-COUNTY-PARISH                  PIC X(6).
  2089
  2090     12  AM-NAME                           PIC X(30).
  2091     12  AM-PERSON                         PIC X(30).
  2092     12  AM-ADDRS                          PIC X(30).
  2093     12  AM-CITY.
  2094         16  AM-ADDR-CITY                  PIC X(28).
  2095         16  AM-ADDR-STATE                 PIC XX.
  2096     12  AM-ZIP.
  2097         16  AM-ZIP-PRIME.
  2098             20  AM-ZIP-PRI-1ST            PIC X.
  2099                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2100             20  FILLER                    PIC X(4).
  2101         16  AM-ZIP-PLUS4                  PIC X(4).
  2102     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2103         16  AM-CAN-POSTAL-1               PIC XXX.
  2104         16  AM-CAN-POSTAL-2               PIC XXX.
  2105         16  FILLER                        PIC XXX.
  2106     12  AM-TEL-NO.
  2107         16  AM-AREA-CODE                  PIC 999.
  2108         16  AM-TEL-PRE                    PIC 999.
  2109         16  AM-TEL-NBR                    PIC 9(4).
  2110     12  AM-TEL-LOC                        PIC X.
  2111         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2112         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2113
  2114     12  AM-COMM-STRUCTURE.
  2115         16  AM-DEFN-1.
  2116             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2117                 24  AM-AGT.
  2118                     28  AM-AGT-PREFIX     PIC X(4).
  2119                     28  AM-AGT-PRIME      PIC X(6).
  2120                 24  AM-COM-TYP            PIC X.
  2121                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2122                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2123                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2124                 24  AM-RECALC-LV-INDIC    PIC X.
  2125                 24  AM-RETRO-LV-INDIC     PIC X.
  2126                 24  AM-GL-CODES           PIC X.
  2127                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2128                 24  FILLER                PIC X(01).
  2129         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2130             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2131                 24  FILLER                PIC X(11).
  2132                 24  AM-L-COMA             PIC XXX.
  2133                 24  AM-J-COMA             PIC XXX.
  2134                 24  AM-A-COMA             PIC XXX.
  2135                 24  FILLER                PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  39
* EL6318.cbl
  2136
  2137     12  AM-COMM-CHANGE-STATUS             PIC X.
  2138         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2139
  2140     12  AM-CSR-CODE                       PIC X(4).
  2141
  2142     12  AM-BILLING-STATUS                 PIC X.
  2143         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2144         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2145     12  AM-AUTO-REFUND-SW                 PIC X.
  2146         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2147         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2148     12  AM-GPCD                           PIC 99.
  2149     12  AM-IG                             PIC X.
  2150         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2151         88  AM-HAS-GROUP                     VALUE '2'.
  2152     12  AM-STATUS                         PIC X.
  2153         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2154         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2155         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2156         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2157         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2158         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2159         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  2160         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  2161         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  2162         88  AM-ACCOUNT-PENDING               VALUE '9'.
  2163     12  AM-REMIT-TO                       PIC 99.
  2164     12  AM-ID-NO                          PIC X(11).
  2165
  2166     12  AM-CAL-TABLE                      PIC XX.
  2167     12  AM-LF-DEVIATION                   PIC XXX.
  2168     12  AM-AH-DEVIATION                   PIC XXX.
  2169     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2170     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2171     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2172     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2173     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2174     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2175
  2176     12  AM-USER-FIELDS.
  2177         16  AM-FLD-1                      PIC XX.
  2178         16  AM-FLD-2                      PIC XX.
  2179         16  AM-FLD-3                      PIC XX.
  2180         16  AM-FLD-4                      PIC XX.
  2181         16  AM-FLD-5                      PIC XX.
  2182
  2183     12  AM-1ST-PROD-DATE.
  2184         16  AM-1ST-PROD-YR                PIC XX.
  2185         16  AM-1ST-PROD-MO                PIC XX.
  2186         16  AM-1ST-PROD-DA                PIC XX.
  2187     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2188     12  AM-CERTS-PURGED-DATE.
  2189         16  AM-PUR-YR                     PIC XX.
  2190         16  AM-PUR-MO                     PIC XX.
  2191         16  AM-PUR-DA                     PIC XX.
  2192     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2193     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  40
* EL6318.cbl
  2194     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2195     12  AM-INACTIVE-DATE.
  2196         16  AM-INA-MO                     PIC 99.
  2197         16  AM-INA-DA                     PIC 99.
  2198         16  AM-INA-YR                     PIC 99.
  2199     12  AM-AR-HI-CERT-DATE                PIC XX.
  2200
  2201     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2202     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2203
  2204     12  AM-OB-PAYMENT-MODE                PIC X.
  2205         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2206         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2207         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2208         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2209
  2210     12  AM-AH-ONLY-INDICATOR              PIC X.
  2211         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2212         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2213
  2214     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2215
  2216     12  AM-OVER-SHORT.
  2217         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2218         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2219
  2220     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2221     12  AM-DCC-CLP-STATE                  PIC XX.
  2222
  2223     12  AM-RECALC-COMM                    PIC X.
  2224     12  AM-RECALC-REIN                    PIC X.
  2225
  2226     12  AM-REI-TABLE                      PIC XXX.
  2227     12  AM-REI-ET-LF                      PIC X.
  2228     12  AM-REI-ET-AH                      PIC X.
  2229     12  AM-REI-PE-LF                      PIC X.
  2230     12  AM-REI-PE-AH                      PIC X.
  2231     12  AM-REI-PRT-ST                     PIC X.
  2232     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2233     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2234     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2235     12  AM-REI-GROUP-A                    PIC X(6).
  2236     12  AM-REI-MORT                       PIC X(4).
  2237     12  AM-REI-PRT-OW                     PIC X.
  2238     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2239     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2240     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2241     12  AM-REI-GROUP-B                    PIC X(6).
  2242
  2243     12  AM-TRUST-TYPE                     PIC X(2).
  2244
  2245     12  AM-EMPLOYER-STMT-USED             PIC X.
  2246     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2247
  2248     12  AM-STD-AH-TYPE                    PIC XX.
  2249     12  AM-EARN-METHODS.
  2250         16  AM-EARN-METHOD-R              PIC X.
  2251             88 AM-REF-RL-R78                 VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  41
* EL6318.cbl
  2252             88 AM-REF-RL-PR                  VALUE 'P'.
  2253             88 AM-REF-RL-MEAN                VALUE 'M'.
  2254             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2255         16  AM-EARN-METHOD-L              PIC X.
  2256             88 AM-REF-LL-R78                 VALUE 'R'.
  2257             88 AM-REF-LL-PR                  VALUE 'P'.
  2258             88 AM-REF-LL-MEAN                VALUE 'M'.
  2259             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2260         16  AM-EARN-METHOD-A              PIC X.
  2261             88 AM-REF-AH-R78                 VALUE 'R'.
  2262             88 AM-REF-AH-PR                  VALUE 'P'.
  2263             88 AM-REF-AH-MEAN                VALUE 'M'.
  2264             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2265             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2266             88 AM-REF-AH-NET                 VALUE 'N'.
  2267
  2268     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2269     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2270     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2271
  2272     12  AM-RET-Y-N                        PIC X.
  2273     12  AM-RET-P-E                        PIC X.
  2274     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2275     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2276     12  AM-RET-GRP                        PIC X(6).
  2277     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2278         16  AM-POOL-PRIME                 PIC XXX.
  2279         16  AM-POOL-SUB                   PIC XXX.
  2280     12  AM-RETRO-EARNINGS.
  2281         16  AM-RET-EARN-R                 PIC X.
  2282         16  AM-RET-EARN-L                 PIC X.
  2283         16  AM-RET-EARN-A                 PIC X.
  2284     12  AM-RET-ST-TAX-USE                 PIC X.
  2285         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2286         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2287     12  AM-RETRO-BEG-EARNINGS.
  2288         16  AM-RET-BEG-EARN-R             PIC X.
  2289         16  AM-RET-BEG-EARN-L             PIC X.
  2290         16  AM-RET-BEG-EARN-A             PIC X.
  2291     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2292     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2293
  2294     12  AM-USER-SELECT-OPTIONS.
  2295         16  AM-USER-SELECT-1              PIC X(10).
  2296         16  AM-USER-SELECT-2              PIC X(10).
  2297         16  AM-USER-SELECT-3              PIC X(10).
  2298         16  AM-USER-SELECT-4              PIC X(10).
  2299         16  AM-USER-SELECT-5              PIC X(10).
  2300
  2301     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2302
  2303     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2304
  2305     12  AM-RPT045A-SWITCH                 PIC X.
  2306         88  RPT045A-OFF                   VALUE 'N'.
  2307
  2308     12  AM-INSURANCE-LIMITS.
  2309         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  42
* EL6318.cbl
  2310         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2311
  2312     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2313         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2314
  2315     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2316         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2317         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2318
  2319     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2320
  2321     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2322     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2323     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2324     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2325     12  AM-DCC-UEF-STATE                  PIC XX.
  2326     12  FILLER                            PIC XXX.
  2327     12  AM-REPORT-CODE-3                  PIC X(10).
  2328*    12  FILLER                            PIC X(22).
  2329
  2330     12  AM-RESERVE-DATE.
  2331         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2332         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2333         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2334
  2335     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2336     12  AM-NOTIFICATION-TYPES.
  2337         16  AM-NOTIF-OF-LETTERS           PIC X.
  2338         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2339         16  AM-NOTIF-OF-REPORTS           PIC X.
  2340         16  AM-NOTIF-OF-STATUS            PIC X.
  2341
  2342     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2343         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2344         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2345         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2346         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2347
  2348     12  AM-BENEFIT-CONTROLS.
  2349         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2350             20  AM-BENEFIT-CODE           PIC XX.
  2351             20  AM-BENEFIT-TYPE           PIC X.
  2352             20  AM-BENEFIT-REVISION       PIC XXX.
  2353             20  AM-BENEFIT-REM-TERM       PIC X.
  2354             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2355             20  FILLER                    PIC XX.
  2356         16  FILLER                        PIC X(80).
  2357
  2358     12  AM-TRANSFER-DATA.
  2359         16  AM-TRANSFERRED-FROM.
  2360             20  AM-TRNFROM-CARRIER        PIC X.
  2361             20  AM-TRNFROM-GROUPING.
  2362                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2363                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2364             20  AM-TRNFROM-STATE          PIC XX.
  2365             20  AM-TRNFROM-ACCOUNT.
  2366                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2367                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  43
* EL6318.cbl
  2368             20  AM-TRNFROM-DTE            PIC XX.
  2369         16  AM-TRANSFERRED-TO.
  2370             20  AM-TRNTO-CARRIER          PIC X.
  2371             20  AM-TRNTO-GROUPING.
  2372                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2373                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2374             20  AM-TRNTO-STATE            PIC XX.
  2375             20  AM-TRNTO-ACCOUNT.
  2376                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2377                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2378             20  AM-TRNTO-DTE              PIC XX.
  2379         16  FILLER                        PIC X(10).
  2380
  2381     12  AM-SAVED-REMIT-TO                 PIC 99.
  2382
  2383     12  AM-COMM-STRUCTURE-SAVED.
  2384         16  AM-DEFN-1-SAVED.
  2385             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2386                 24  AM-AGT-SV             PIC X(10).
  2387                 24  AM-COM-TYP-SV         PIC X.
  2388                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2389                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2390                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2391                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2392                 24  FILLER                PIC X.
  2393                 24  AM-GL-CODES-SV        PIC X.
  2394                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2395                 24  FILLER                PIC X.
  2396         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2397             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2398                 24  FILLER                PIC X(11).
  2399                 24  AM-L-COMA-SV          PIC XXX.
  2400                 24  AM-J-COMA-SV          PIC XXX.
  2401                 24  AM-A-COMA-SV          PIC XXX.
  2402                 24  FILLER                PIC X(6).
  2403
  2404     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2405         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2406            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2407            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2408            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2409
  2410     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2411     12  FILLER                            PIC X(120).
  2412
  2413     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2414         16  AM-CONTROL-NAME               PIC X(30).
  2415         16  AM-EXECUTIVE-ONE.
  2416             20  AM-EXEC1-NAME             PIC X(15).
  2417             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2418                                                          COMP-3.
  2419             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2420                                                          COMP-3.
  2421         16  AM-EXECUTIVE-TWO.
  2422             20  AM-EXEC2-NAME             PIC X(15).
  2423             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2424                                                          COMP-3.
  2425             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  44
* EL6318.cbl
  2426                                                          COMP-3.
  2427
  2428     12  AM-RETRO-ADDITIONAL-DATA.
  2429         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2430         16  AM-RETRO-PREM-P-E             PIC X.
  2431         16  AM-RETRO-CLMS-P-I             PIC X.
  2432         16  AM-RETRO-RET-BRACKET-LF.
  2433             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2434                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2435                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2436             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2437                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2438                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2439             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2440                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2441                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2442         16  AM-RETRO-RET-BRACKET-AH.
  2443             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2444                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2445                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2446                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2447             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2448                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2449                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2450             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2451                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2452                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2453
  2454     12  AM-COMMENTS.
  2455         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2456
  2457     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2458         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2459         16  AM-FLI-BILLING-CODE           PIC X.
  2460         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2461         16  AM-FLI-UNITED-IDENT           PIC X.
  2462         16  AM-FLI-INTEREST-LOST-DATA.
  2463             20  AM-FLI-BANK-NO            PIC X(5).
  2464             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2465             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2466             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2467         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2468             20  AM-FLI-AGT                PIC X(9).
  2469             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2470             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2471         16  FILLER                        PIC X(102).
  2472
  2473     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2474         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2475             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2476             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2477             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2478             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2479             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2480         16  FILLER                          PIC X(10).
  2481******************************************************************
  2482*                                COPY ELCCNTL.
  2483******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  45
* EL6318.cbl
  2484*                                                                *
  2485*                                                                *
  2486*                            ELCCNTL.                            *
  2487*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2488*                            VMOD=2.059                          *
  2489*                                                                *
  2490*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2491*                                                                *
  2492*   FILE TYPE = VSAM,KSDS                                        *
  2493*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2494*                                                                *
  2495*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2496*       ALTERNATE INDEX = NONE                                   *
  2497*                                                                *
  2498*   LOG = YES                                                    *
  2499*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2500******************************************************************
  2501*                   C H A N G E   L O G
  2502*
  2503* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2504*-----------------------------------------------------------------
  2505*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2506* EFFECTIVE    NUMBER
  2507*-----------------------------------------------------------------
  2508* 082503                   PEMA  ADD BENEFIT GROUP
  2509* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2510* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2511* 092705    2005050300006  PEMA  ADD SPP LEASES
  2512* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2513* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2514* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2515* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2516* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2517* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2518* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2519* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2520* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2521* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2522* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  2523******************************************************************
  2524*
  2525 01  CONTROL-FILE.
  2526     12  CF-RECORD-ID                       PIC XX.
  2527         88  VALID-CF-ID                        VALUE 'CF'.
  2528
  2529     12  CF-CONTROL-PRIMARY.
  2530         16  CF-COMPANY-ID                  PIC XXX.
  2531         16  CF-RECORD-TYPE                 PIC X.
  2532             88  CF-COMPANY-MASTER              VALUE '1'.
  2533             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2534             88  CF-STATE-MASTER                VALUE '3'.
  2535             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2536             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2537             88  CF-CARRIER-MASTER              VALUE '6'.
  2538             88  CF-MORTALITY-MASTER            VALUE '7'.
  2539             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2540             88  CF-TERMINAL-MASTER             VALUE '9'.
  2541             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  46
* EL6318.cbl
  2542             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2543             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2544             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2545             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2546             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2547             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2548             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2549             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2550         16  CF-ACCESS-CD-GENL              PIC X(4).
  2551         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2552             20  CF-PROCESSOR               PIC X(4).
  2553         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2554             20  CF-STATE-CODE              PIC XX.
  2555             20  FILLER                     PIC XX.
  2556         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2557             20  FILLER                     PIC XX.
  2558             20  CF-HI-BEN-IN-REC           PIC XX.
  2559         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2560             20  FILLER                     PIC XXX.
  2561             20  CF-CARRIER-CNTL            PIC X.
  2562         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2563             20  FILLER                     PIC XX.
  2564             20  CF-HI-TYPE-IN-REC          PIC 99.
  2565         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2566             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2567                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2568             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2569             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2570         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2571             20  FILLER                     PIC X.
  2572             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2573         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2574             20  FILLER                     PIC XX.
  2575             20  CF-MORTGAGE-PLAN           PIC XX.
  2576         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2577
  2578     12  CF-LAST-MAINT-DT                   PIC XX.
  2579     12  CF-LAST-MAINT-BY                   PIC X(4).
  2580     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2581
  2582     12  CF-RECORD-BODY                     PIC X(728).
  2583
  2584
  2585****************************************************************
  2586*             COMPANY MASTER RECORD                            *
  2587****************************************************************
  2588
  2589     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2590         16  CF-COMPANY-ADDRESS.
  2591             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2592             20  CF-CL-IN-CARE-OF           PIC X(30).
  2593             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2594             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2595             20  CF-CL-CITY-STATE           PIC X(30).
  2596             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2597             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2598         16  CF-COMPANY-CD                  PIC X.
  2599         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  47
* EL6318.cbl
  2600         16  CF-SECURITY-OPTION             PIC X.
  2601             88  ALL-SECURITY                   VALUE '1'.
  2602             88  COMPANY-VERIFY                 VALUE '2'.
  2603             88  PROCESSOR-VERIFY               VALUE '3'.
  2604             88  NO-SECURITY                    VALUE '4'.
  2605             88  ALL-BUT-TERM                   VALUE '5'.
  2606         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2607             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2608         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2609             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2610         16  CF-INFORCE-LOCATION            PIC X.
  2611             88  CERTS-ARE-ONLINE               VALUE '1'.
  2612             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2613             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2614         16  CF-LOWER-CASE-LETTERS          PIC X.
  2615         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2616             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2617             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2618             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2619             88  CF-ACCNT-CNTL                  VALUE '3'.
  2620             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2621
  2622         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2623         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2624
  2625         16  CF-LGX-CREDIT-USER             PIC X.
  2626             88  CO-IS-NOT-USER                 VALUE 'N'.
  2627             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2628
  2629         16 CF-CREDIT-CALC-CODES.
  2630             20  CF-CR-REM-TERM-CALC PIC X.
  2631               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2632               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2633               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2634               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2635               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2636               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2637               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2638             20  CF-CR-R78-METHOD           PIC X.
  2639               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2640               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2641
  2642         16  CF-CLAIM-CONTROL-COUNTS.
  2643             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2644                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2645
  2646             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2647                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2648
  2649             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2650                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2651
  2652             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2653                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2654
  2655         16  CF-CURRENT-MONTH-END           PIC XX.
  2656
  2657         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  48
* EL6318.cbl
  2658             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2659             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2660             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2661             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2662                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2663                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2664             20  CF-CO-PREM-REJECT-SW       PIC X.
  2665                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2666                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2667             20  CF-CO-REF-REJECT-SW        PIC X.
  2668                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2669                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2670
  2671         16  CF-CO-REPORTING-DT             PIC XX.
  2672         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2673         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2674           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2675           88  CF-CO-MONTH-END                  VALUE '1'.
  2676
  2677         16  CF-LGX-CLAIM-USER              PIC X.
  2678             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2679             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2680
  2681         16  CF-CREDIT-EDIT-CONTROLS.
  2682             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2683             20  CF-MIN-AGE                 PIC 99.
  2684             20  CF-DEFAULT-AGE             PIC 99.
  2685             20  CF-MIN-TERM                PIC S999      COMP-3.
  2686             20  CF-MAX-TERM                PIC S999      COMP-3.
  2687             20  CF-DEFAULT-SEX             PIC X.
  2688             20  CF-JOINT-AGE-INPUT         PIC X.
  2689                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2690             20  CF-BIRTH-DATE-INPUT        PIC X.
  2691                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2692             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2693                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2694                 88  CF-ZERO-CARRIER            VALUE '1'.
  2695                 88  CF-ZERO-GROUPING           VALUE '2'.
  2696                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2697             20  CF-EDIT-SW                 PIC X.
  2698                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2699             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2700             20  CF-CR-PR-METHOD            PIC X.
  2701               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2702               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2703             20  FILLER                     PIC X.
  2704
  2705         16  CF-CREDIT-MISC-CONTROLS.
  2706             20  CF-REIN-TABLE-SW           PIC X.
  2707                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2708             20  CF-COMP-TABLE-SW           PIC X.
  2709                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2710             20  CF-EXPERIENCE-RETENTION-AGE
  2711                                            PIC S9        COMP-3.
  2712             20  CF-CONVERSION-DT           PIC XX.
  2713             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2714             20  CF-RUN-FREQUENCY-SW        PIC X.
  2715                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  49
* EL6318.cbl
  2716                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2717
  2718             20  CF-CR-CHECK-NO-CONTROL.
  2719                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2720                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2721                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2722                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2723                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2724                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2725
  2726                 24  CF-CR-CHECK-COUNT       REDEFINES
  2727                     CF-CR-CHECK-COUNTER      PIC X(4).
  2728
  2729                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2730                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2731
  2732                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2733                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2734                 24  CF-MAIL-PROCESSING       PIC X.
  2735                     88  MAIL-PROCESSING          VALUE 'Y'.
  2736
  2737         16  CF-MISC-SYSTEM-CONTROL.
  2738             20  CF-SYSTEM-C                 PIC X.
  2739                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2740             20  CF-SYSTEM-D                 PIC X.
  2741                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2742             20  CF-SOC-SEC-NO-SW            PIC X.
  2743                 88  SOC-SEC-NO-USED             VALUE '1'.
  2744             20  CF-MEMBER-NO-SW             PIC X.
  2745                 88  MEMBER-NO-USED              VALUE '1'.
  2746             20  CF-TAX-ID-NUMBER            PIC X(11).
  2747             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2748             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2749                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2750                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2751                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2752                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2753             20  CF-SYSTEM-E                 PIC X.
  2754                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2755
  2756         16  CF-LGX-LIFE-USER               PIC X.
  2757             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2758             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2759
  2760         16  CF-CR-MONTH-END-DT             PIC XX.
  2761
  2762         16  CF-FILE-MAINT-DATES.
  2763             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2764                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2765             20  CF-LAST-BATCH       REDEFINES
  2766                 CF-LAST-BATCH-NO               PIC X(4).
  2767             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2768             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2769             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2770             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2771             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2772             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2773             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  50
* EL6318.cbl
  2774             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2775             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2776             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2777
  2778         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2779         16  FILLER                         PIC X.
  2780
  2781         16  CF-ALT-MORT-CODE               PIC X(4).
  2782         16  CF-MEMBER-CAPTION              PIC X(10).
  2783
  2784         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2785             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2786             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2787             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2788             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2789             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2790
  2791         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2792
  2793         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2794         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2795         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2796         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2797
  2798         16  CF-AH-OVERRIDE-L1              PIC X.
  2799         16  CF-AH-OVERRIDE-L2              PIC XX.
  2800         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2801         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2802
  2803         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2804         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2805
  2806         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2807         16  CF-AR-LAST-EL860-DT            PIC XX.
  2808         16  CF-MP-MONTH-END-DT             PIC XX.
  2809
  2810         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2811         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2812             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2813
  2814         16  CF-AR-MONTH-END-DT             PIC XX.
  2815
  2816         16  CF-CRDTCRD-USER                PIC X.
  2817             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2818             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2819
  2820         16  CF-CC-MONTH-END-DT             PIC XX.
  2821
  2822         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2823
  2824         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2825             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2826             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2827             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2828         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2829         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2830         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2831         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  51
* EL6318.cbl
  2832             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2833             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2834         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2835         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2836         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2837             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2838         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2839
  2840         16  CF-CL-ZIP-CODE.
  2841             20  CF-CL-ZIP-PRIME.
  2842                 24  CF-CL-ZIP-1ST          PIC X.
  2843                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2844                 24  FILLER                 PIC X(4).
  2845             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2846         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2847             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2848             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2849             20  FILLER                     PIC XXX.
  2850
  2851         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2852         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2853         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2854         16  CF-CO-OPTION-START-DATE        PIC XX.
  2855         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2856           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2857                                                      '3' '4'.
  2858           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2859           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2860           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2861           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2862           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2863           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2864
  2865         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2866
  2867         16  CF-PAYMENT-APPROVAL-LEVELS.
  2868             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2869             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2870             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2871             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2872             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2873             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2874
  2875         16  CF-END-USER-REPORTING-USER     PIC X.
  2876             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2877             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2878
  2879         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2880             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2881             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2882
  2883         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2884
  2885         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2886         16  FILLER                         PIC X.
  2887
  2888         16  CF-CREDIT-ARCHIVE-CNTL.
  2889             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  52
* EL6318.cbl
  2890             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2891             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2892
  2893         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2894
  2895         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2896             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2897             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2898
  2899         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2900             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2901             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2902
  2903         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2904
  2905         16  CF-CO-ACH-ID-CODE              PIC  X.
  2906             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2907             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2908             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2909         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2910         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2911         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2912         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2913         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2914         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2915         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2916         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2917         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2918                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2919         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2920                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2921
  2922         16  CF-CO-OVER-SHORT.
  2923             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2924             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2925
  2926*         16  FILLER                         PIC X(102).
  2927         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2928             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2929             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2930
  2931         16  CF-AH-APPROVAL-DAYS.
  2932             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2933             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2934             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2935             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2936
  2937         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2938
  2939         16  CF-APPROV-LEV-5.
  2940             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2941             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2942             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2943
  2944         16  FILLER                         PIC X(68).
  2945****************************************************************
  2946*             PROCESSOR/USER RECORD                            *
  2947****************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  53
* EL6318.cbl
  2948
  2949     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2950         16  CF-PROCESSOR-NAME              PIC X(30).
  2951         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2952         16  CF-PROCESSOR-TITLE             PIC X(26).
  2953         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2954                 88  MESSAGE-YES                VALUE 'Y'.
  2955                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2956
  2957*****************************************************
  2958****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2959****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2960****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2961****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2962*****************************************************
  2963
  2964         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2965             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2966             20  CF-APPLICATION-FORCE       PIC X.
  2967             20  CF-INDIVIDUAL-APP.
  2968                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2969                     28  CF-BROWSE-APP      PIC X.
  2970                     28  CF-UPDATE-APP      PIC X.
  2971
  2972         16  CF-CURRENT-TERM-ON             PIC X(4).
  2973         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2974             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2975             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2976             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2977             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2978             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2979             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2980             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2981         16  CF-PROCESSOR-CARRIER           PIC X.
  2982             88  NO-CARRIER-SECURITY            VALUE ' '.
  2983         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2984             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2985         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2986             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2987         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2988             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2989
  2990         16  CF-PROC-SYS-ACCESS-SW.
  2991             20  CF-PROC-CREDIT-CLAIMS-SW.
  2992                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2993                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2994                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2995                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2996             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2997                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2998                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2999             20  CF-PROC-LIFE-GNRLDGR-SW.
  3000                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3001                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3002                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3003                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3004             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3005                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  54
* EL6318.cbl
  3006                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3007         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3008             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3009             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3010         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3011
  3012         16  CF-APPROVAL-LEVEL                  PIC X.
  3013             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3014             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3015             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3016             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3017             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3018
  3019         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3020
  3021         16  CF-LANGUAGE-TYPE                   PIC X.
  3022             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3023             88  CF-LANG-IS-FR                      VALUE 'F'.
  3024
  3025         16  CF-CSR-IND                         PIC X.
  3026         16  FILLER                             PIC X(239).
  3027
  3028****************************************************************
  3029*             PROCESSOR/REMINDERS RECORD                       *
  3030****************************************************************
  3031
  3032     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3033         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3034             20  CF-START-REMIND-DT         PIC XX.
  3035             20  CF-END-REMIND-DT           PIC XX.
  3036             20  CF-REMINDER-TEXT           PIC X(50).
  3037         16  FILLER                         PIC X(296).
  3038
  3039
  3040****************************************************************
  3041*             STATE MASTER RECORD                              *
  3042****************************************************************
  3043
  3044     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3045         16  CF-STATE-ABBREVIATION          PIC XX.
  3046         16  CF-STATE-NAME                  PIC X(25).
  3047         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3048         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3049             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3050             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3051             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3052             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3053                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3054                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3055             20  CF-ST-PREM-REJECT-SW       PIC X.
  3056                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3057                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3058             20  CF-ST-REF-REJECT-SW        PIC X.
  3059                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3060                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3061         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3062         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3063         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  55
* EL6318.cbl
  3064             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3065             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3066             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3067         16  CF-ST-FST-PMT-EXTENSION.
  3068             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3069             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3070                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3071                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3072                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3073                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3074         16  CF-ST-STATE-CALL.
  3075             20  CF-ST-CALL-UNEARNED        PIC X.
  3076             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3077             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3078         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3079             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3080             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3081         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3082         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3083         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3084         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3085         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3086         16  FILLER                         PIC X.
  3087         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3088             20  CF-ST-BENEFIT-CD           PIC XX.
  3089             20  CF-ST-BENEFIT-KIND         PIC X.
  3090                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3091                 88  CF-ST-AH-KIND              VALUE 'A'.
  3092             20  CF-ST-REM-TERM-CALC        PIC X.
  3093                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3094                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3095                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3096                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3097                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3098                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3099                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3100                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3101
  3102             20  CF-ST-REFUND-CALC          PIC X.
  3103                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3104                 88  ST-REFD-BY-R78             VALUE '1'.
  3105                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3106                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3107                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3108                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3109                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3110                 88  ST-REFD-UTAH               VALUE '7'.
  3111                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3112                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3113                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3114
  3115             20  CF-ST-EARNING-CALC         PIC X.
  3116                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3117                 88  ST-EARN-BY-R78             VALUE '1'.
  3118                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3119                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3120                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3121                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  56
* EL6318.cbl
  3122                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3123                 88  ST-EARN-MEAN               VALUE '8'.
  3124                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3125
  3126             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3127                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3128                 88  ST-OVRD-BY-R78             VALUE '1'.
  3129                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3130                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3131                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3132                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3133                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3134                 88  ST-OVRD-MEAN               VALUE '8'.
  3135                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3136             20  cf-st-extra-periods        pic 9.
  3137*            20  FILLER                     PIC X.
  3138
  3139         16  CF-ST-COMMISSION-CAPS.
  3140             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3141             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3142             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3143             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3144         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3145                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3146                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  3147                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  3148
  3149         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3150
  3151         16  CF-ST-STATUTORY-INTEREST.
  3152             20  CF-ST-STAT-DATE-FROM       PIC X.
  3153                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3154                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3155             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3156             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3157             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3158             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3159             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3160
  3161         16  CF-ST-OVER-SHORT.
  3162             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3163             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3164
  3165         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3166
  3167         16  CF-ST-RT-CALC                  PIC X.
  3168
  3169         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3170         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3171         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3172         16  CF-ST-RF-LR-CALC               PIC X.
  3173         16  CF-ST-RF-LL-CALC               PIC X.
  3174         16  CF-ST-RF-LN-CALC               PIC X.
  3175         16  CF-ST-RF-AH-CALC               PIC X.
  3176         16  CF-ST-RF-CP-CALC               PIC X.
  3177*        16  FILLER                         PIC X(206).
  3178*CIDMOD         16  FILLER                         PIC X(192).
  3179         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  57
* EL6318.cbl
  3180             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3181         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3182         16  CF-ST-VFY-2ND-BENE             PIC X.
  3183         16  CF-ST-CAUSAL-STATE             PIC X.
  3184         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3185         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3186         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3187             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3188         16  CF-ST-NET-ONLY-STATE           PIC X.
  3189             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3190         16  cf-commission-cap-required     pic x.
  3191         16  CF-ST-GA-COMMISSION-CAPS.
  3192             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  3193             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  3194             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  3195             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  3196         16  CF-ST-TOT-COMMISSION-CAPS.
  3197             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  3198             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  3199             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  3200             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  3201         16  FILLER                         PIC X(156).
  3202
  3203****************************************************************
  3204*             BENEFIT MASTER RECORD                            *
  3205****************************************************************
  3206
  3207     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3208         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3209             20  CF-BENEFIT-CODE            PIC XX.
  3210             20  CF-BENEFIT-NUMERIC  REDEFINES
  3211                 CF-BENEFIT-CODE            PIC XX.
  3212             20  CF-BENEFIT-ALPHA           PIC XXX.
  3213             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3214             20  CF-BENEFIT-COMMENT         PIC X(10).
  3215
  3216             20  CF-LF-COVERAGE-TYPE        PIC X.
  3217                 88  CF-REDUCING                VALUE 'R'.
  3218                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3219
  3220             20  CF-SPECIAL-CALC-CD         PIC X.
  3221                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3222                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3223                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3224                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3225                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3226                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3227                 88  CF-FARM-PLAN               VALUE 'F'.
  3228                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3229                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3230                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3231                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3232                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3233                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3234                 88  CF-PRUDENTIAL              VALUE 'P'.
  3235                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3236                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3237                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  58
* EL6318.cbl
  3238                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3239                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3240                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3241
  3242             20  CF-JOINT-INDICATOR         PIC X.
  3243                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3244
  3245*            20  FILLER                     PIC X(12).
  3246             20  cf-maximum-benefits        pic s999 comp-3.
  3247             20  FILLER                     PIC X(09).
  3248             20  CF-BENEFIT-CATEGORY        PIC X.
  3249             20  CF-LOAN-TYPE               PIC X(8).
  3250
  3251             20  CF-CO-REM-TERM-CALC        PIC X.
  3252                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3253                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3254                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3255                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3256                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3257
  3258             20  CF-CO-EARNINGS-CALC        PIC X.
  3259                 88  CO-EARN-BY-R78             VALUE '1'.
  3260                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3261                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3262                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3263                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3264                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3265                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3266                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3267
  3268             20  CF-CO-REFUND-CALC          PIC X.
  3269                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3270                 88  CO-REFD-BY-R78             VALUE '1'.
  3271                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3272                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3273                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3274                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3275                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3276                 88  CO-REFD-MEAN               VALUE '8'.
  3277                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3278                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3279                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3280
  3281             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3282                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3283                 88  CO-OVRD-BY-R78             VALUE '1'.
  3284                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3285                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3286                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3287                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3288                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3289                 88  CO-OVRD-MEAN               VALUE '8'.
  3290                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3291
  3292             20  CF-CO-BEN-I-G-CD           PIC X.
  3293                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3294                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3295                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  59
* EL6318.cbl
  3296
  3297         16  FILLER                         PIC X(304).
  3298
  3299
  3300****************************************************************
  3301*             CARRIER MASTER RECORD                            *
  3302****************************************************************
  3303
  3304     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3305         16  CF-ADDRESS-DATA.
  3306             20  CF-MAIL-TO-NAME            PIC X(30).
  3307             20  CF-IN-CARE-OF              PIC X(30).
  3308             20  CF-ADDRESS-LINE-1          PIC X(30).
  3309             20  CF-ADDRESS-LINE-2          PIC X(30).
  3310             20  CF-CITY-STATE              PIC X(30).
  3311             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3312             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3313
  3314         16  CF-CLAIM-NO-CONTROL.
  3315             20  CF-CLAIM-NO-METHOD         PIC X.
  3316                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3317                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3318                 88  CLAIM-NO-SEQ               VALUE '3'.
  3319                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3320             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3321                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3322                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3323                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3324
  3325         16  CF-CHECK-NO-CONTROL.
  3326             20  CF-CHECK-NO-METHOD         PIC X.
  3327                 88  CHECK-NO-MANUAL            VALUE '1'.
  3328                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3329                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3330                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3331             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3332                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3333
  3334         16  CF-DOMICILE-STATE              PIC XX.
  3335
  3336         16  CF-EXPENSE-CONTROLS.
  3337             20  CF-EXPENSE-METHOD          PIC X.
  3338                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3339                 88  DOLLARS-PER-PMT            VALUE '2'.
  3340                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3341                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3342             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3343             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3344
  3345         16  CF-CORRESPONDENCE-CONTROL.
  3346             20  CF-LETTER-RESEND-OPT       PIC X.
  3347                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3348                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3349             20  FILLER                     PIC X(4).
  3350
  3351         16  CF-RESERVE-CONTROLS.
  3352             20  CF-MANUAL-SW               PIC X.
  3353                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  60
* EL6318.cbl
  3354             20  CF-FUTURE-SW               PIC X.
  3355                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3356             20  CF-PTC-SW                  PIC X.
  3357                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3358             20  CF-IBNR-SW                 PIC X.
  3359                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3360             20  CF-PTC-LF-SW               PIC X.
  3361                 88  CF-LF-PTC-USED             VALUE '1'.
  3362             20  CF-CDT-ACCESS-METHOD       PIC X.
  3363                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3364                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3365                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3366             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3367
  3368         16  CF-CLAIM-CALC-METHOD           PIC X.
  3369             88  360-PLUS-MONTHS                VALUE '1'.
  3370             88  365-PLUS-MONTHS                VALUE '2'.
  3371             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3372             88  360-DAILY                      VALUE '4'.
  3373             88  365-DAILY                      VALUE '5'.
  3374
  3375         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3376         16  FILLER                         PIC X(11).
  3377
  3378         16  CF-LIMIT-AMOUNTS.
  3379             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3380             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3381             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3382             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3383             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3384             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3385             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3386             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3387             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3388             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3389
  3390         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3391         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3392         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3393
  3394         16  CF-ZIP-CODE.
  3395             20  CF-ZIP-PRIME.
  3396                 24  CF-ZIP-1ST             PIC X.
  3397                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3398                 24  FILLER                 PIC X(4).
  3399             20  CF-ZIP-PLUS4               PIC X(4).
  3400         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3401             20  CF-CAN-POSTAL-1            PIC XXX.
  3402             20  CF-CAN-POSTAL-2            PIC XXX.
  3403             20  FILLER                     PIC XXX.
  3404
  3405         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3406         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3407         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3408
  3409         16  CF-RATING-SWITCH               PIC X.
  3410             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3411             88  CF-NO-RATING                   VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  61
* EL6318.cbl
  3412
  3413         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3414
  3415         16  CF-CARRIER-OVER-SHORT.
  3416             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3417             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3418
  3419         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3420         16  CF-SECPAY-SWITCH               PIC X.
  3421             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3422             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3423         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3424         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3425         16  FILLER                         PIC X(444).
  3426*        16  FILLER                         PIC X(452).
  3427
  3428
  3429****************************************************************
  3430*             MORTALITY MASTER RECORD                          *
  3431****************************************************************
  3432
  3433     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3434         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3435                                INDEXED BY CF-MORT-NDX.
  3436             20  CF-MORT-TABLE              PIC X(5).
  3437             20  CF-MORT-TABLE-TYPE         PIC X.
  3438                 88  CF-MORT-JOINT              VALUE 'J'.
  3439                 88  CF-MORT-SINGLE             VALUE 'S'.
  3440                 88  CF-MORT-COMBINED           VALUE 'C'.
  3441                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3442                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3443             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3444             20  CF-MORT-AGE-METHOD         PIC XX.
  3445                 88  CF-AGE-LAST                VALUE 'AL'.
  3446                 88  CF-AGE-NEAR                VALUE 'AN'.
  3447             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3448             20  CF-MORT-ADJUSTMENT-DIRECTION
  3449                                            PIC X.
  3450                 88  CF-MINUS                   VALUE '-'.
  3451                 88  CF-PLUS                    VALUE '+'.
  3452             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3453             20  CF-MORT-JOINT-CODE         PIC X.
  3454                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3455             20  CF-MORT-PC-Q               PIC X.
  3456                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3457             20  CF-MORT-TABLE-CODE         PIC X(4).
  3458             20  CF-MORT-COMMENTS           PIC X(15).
  3459             20  FILLER                     PIC X(14).
  3460
  3461         16  FILLER                         PIC X(251).
  3462
  3463
  3464****************************************************************
  3465*             BUSSINESS TYPE MASTER RECORD                     *
  3466****************************************************************
  3467
  3468     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3469* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  62
* EL6318.cbl
  3470* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3471* AND RECORD 05 IS TYPES 81-99
  3472         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3473             20  CF-BUSINESS-TITLE          PIC  X(19).
  3474             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3475                                            PIC S9V9(4) COMP-3.
  3476             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3477             20  FILLER                     PIC  X.
  3478         16  FILLER                         PIC  X(248).
  3479
  3480
  3481****************************************************************
  3482*             TERMINAL MASTER RECORD                           *
  3483****************************************************************
  3484
  3485     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3486
  3487         16  CF-COMPANY-TERMINALS.
  3488             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3489                                  PIC X(4).
  3490         16  FILLER               PIC X(248).
  3491
  3492
  3493****************************************************************
  3494*             LIFE EDIT MASTER RECORD                          *
  3495****************************************************************
  3496
  3497     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3498         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3499             20  CF-LIFE-CODE-IN            PIC XX.
  3500             20  CF-LIFE-CODE-OUT           PIC XX.
  3501         16  FILLER                         PIC X(248).
  3502
  3503
  3504****************************************************************
  3505*             AH EDIT MASTER RECORD                            *
  3506****************************************************************
  3507
  3508     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3509         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3510             20  CF-AH-CODE-IN              PIC XXX.
  3511             20  CF-AH-CODE-OUT             PIC XX.
  3512         16  FILLER                         PIC X(248).
  3513
  3514
  3515****************************************************************
  3516*             CREDIBILITY TABLES                               *
  3517****************************************************************
  3518
  3519     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3520         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3521                             INDEXED BY CF-CRDB-NDX.
  3522             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3523             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3524             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3525         16  FILLER                         PIC  X(332).
  3526
  3527
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  63
* EL6318.cbl
  3528****************************************************************
  3529*             REPORT CUSTOMIZATION RECORD                      *
  3530****************************************************************
  3531
  3532     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3533         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3534             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3535             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3536             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3537**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3538****       A T-TRANSFER.                                   ****
  3539             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3540
  3541         16  FILLER                         PIC XX.
  3542
  3543         16  CF-CARRIER-CNTL-OPT.
  3544             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3545                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3546                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3547             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3548                                            PIC X.
  3549         16  CF-GROUP-CNTL-OPT.
  3550             20  CF-GROUP-OPT-SEQ           PIC 9.
  3551                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3552                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3553             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3554                                            PIC X(6).
  3555         16  CF-STATE-CNTL-OPT.
  3556             20  CF-STATE-OPT-SEQ           PIC 9.
  3557                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3558                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3559             20  CF-STATE-SELECT OCCURS 3 TIMES
  3560                                            PIC XX.
  3561         16  CF-ACCOUNT-CNTL-OPT.
  3562             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3563                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3564                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3565             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3566                                            PIC X(10).
  3567         16  CF-BUS-TYP-CNTL-OPT.
  3568             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3569                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3570                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3571             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3572                                            PIC XX.
  3573         16  CF-LF-TYP-CNTL-OPT.
  3574             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3575                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3576                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3577             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3578                                            PIC XX.
  3579         16  CF-AH-TYP-CNTL-OPT.
  3580             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3581                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3582                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3583             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3584                                            PIC XX.
  3585         16  CF-REPTCD1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  64
* EL6318.cbl
  3586             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3587                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3588                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3589             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3590                                            PIC X(10).
  3591         16  CF-REPTCD2-CNTL-OPT.
  3592             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3593                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3594                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3595             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3596                                            PIC X(10).
  3597         16  CF-USER1-CNTL-OPT.
  3598             20  CF-USER1-OPT-SEQ           PIC 9.
  3599                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3600                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3601             20  CF-USER1-SELECT OCCURS 3 TIMES
  3602                                            PIC X(10).
  3603         16  CF-USER2-CNTL-OPT.
  3604             20  CF-USER2-OPT-SEQ           PIC 9.
  3605                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3606                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3607             20  CF-USER2-SELECT OCCURS 3 TIMES
  3608                                            PIC X(10).
  3609         16  CF-USER3-CNTL-OPT.
  3610             20  CF-USER3-OPT-SEQ           PIC 9.
  3611                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3612                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3613             20  CF-USER3-SELECT OCCURS 3 TIMES
  3614                                            PIC X(10).
  3615         16  CF-USER4-CNTL-OPT.
  3616             20  CF-USER4-OPT-SEQ           PIC 9.
  3617                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3618                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3619             20  CF-USER4-SELECT OCCURS 3 TIMES
  3620                                            PIC X(10).
  3621         16  CF-USER5-CNTL-OPT.
  3622             20  CF-USER5-OPT-SEQ           PIC 9.
  3623                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3624                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3625             20  CF-USER5-SELECT OCCURS 3 TIMES
  3626                                            PIC X(10).
  3627         16  CF-REINS-CNTL-OPT.
  3628             20  CF-REINS-OPT-SEQ           PIC 9.
  3629                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3630                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3631             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3632                 24  CF-REINS-PRIME         PIC XXX.
  3633                 24  CF-REINS-SUB           PIC XXX.
  3634
  3635         16  CF-AGENT-CNTL-OPT.
  3636             20  CF-AGENT-OPT-SEQ           PIC 9.
  3637                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3638                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3639             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3640                                            PIC X(10).
  3641
  3642         16  FILLER                         PIC X(43).
  3643
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  65
* EL6318.cbl
  3644         16  CF-LOSS-RATIO-SELECT.
  3645             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3646             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3647         16  CF-ENTRY-DATE-SELECT.
  3648             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3649             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3650         16  CF-EFFECTIVE-DATE-SELECT.
  3651             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3652             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3653
  3654         16  CF-EXCEPTION-LIST-IND          PIC X.
  3655             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3656
  3657         16  FILLER                         PIC X(318).
  3658
  3659****************************************************************
  3660*                  EXCEPTION REPORTING RECORD                  *
  3661****************************************************************
  3662
  3663     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3664         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3665             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3666
  3667         16  CF-COMBINED-LIFE-AH-OPT.
  3668             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3669             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3670             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3671             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3672
  3673         16  CF-LIFE-OPT.
  3674             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3675             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3676             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3677             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3678             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3679             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3680             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3681             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3682             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3683             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3684
  3685         16  CF-AH-OPT.
  3686             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3687             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3688             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3689             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3690             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3691             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3692             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3693             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3694             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3695             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3696
  3697         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3698             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3699             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3700             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3701
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  66
* EL6318.cbl
  3702         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3703
  3704         16  FILLER                         PIC X(673).
  3705
  3706
  3707****************************************************************
  3708*             MORTGAGE SYSTEM PLAN RECORD                      *
  3709****************************************************************
  3710
  3711     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3712         16  CF-PLAN-TYPE                   PIC X.
  3713             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3714             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3715             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3716         16  CF-PLAN-ABBREV                 PIC XXX.
  3717         16  CF-PLAN-DESCRIPT               PIC X(10).
  3718         16  CF-PLAN-NOTES                  PIC X(20).
  3719         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3720         16  CF-PLAN-UNDERWRITING.
  3721             20  CF-PLAN-TERM-DATA.
  3722                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3723                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3724             20  CF-PLAN-AGE-DATA.
  3725                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3726                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3727                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3728             20  CF-PLAN-BENEFIT-DATA.
  3729                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3730                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3731                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3732                                            PIC S9(7)V99  COMP-3.
  3733         16  CF-PLAN-POLICY-FORMS.
  3734             20  CF-POLICY-FORM             PIC X(12).
  3735             20  CF-MASTER-APPLICATION      PIC X(12).
  3736             20  CF-MASTER-POLICY           PIC X(12).
  3737         16  CF-PLAN-RATING.
  3738             20  CF-RATE-CODE               PIC X(5).
  3739             20  CF-SEX-RATING              PIC X.
  3740                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3741                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3742             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3743             20  CF-SUB-STD-TYPE            PIC X.
  3744                 88  CF-PCT-OF-PREM            VALUE '1'.
  3745                 88  CF-PCT-OF-BENE            VALUE '2'.
  3746         16  CF-PLAN-PREM-TOLERANCES.
  3747             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3748             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3749         16  CF-PLAN-PYMT-TOLERANCES.
  3750             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3751             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3752         16  CF-PLAN-MISC-DATA.
  3753             20  FILLER                     PIC X.
  3754             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3755             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3756         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3757         16  CF-PLAN-IND-GRP                PIC X.
  3758             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3759                                                     '1'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  67
* EL6318.cbl
  3760             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3761                                                     '2'.
  3762         16  CF-MIB-SEARCH-SW               PIC X.
  3763             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3764             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3765             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3766             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3767         16  CF-ALPHA-SEARCH-SW             PIC X.
  3768             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3769             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3770             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3771             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3772             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3773             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3774             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3775             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3776             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3777             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3778                                                     'A' 'B' 'C'
  3779                                                     'X' 'Y' 'Z'.
  3780         16  CF-EFF-DT-RULE-SW              PIC X.
  3781             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3782             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3783             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3784             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3785             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3786         16  FILLER                         PIC X(4).
  3787         16  CF-HEALTH-QUESTIONS            PIC X.
  3788             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3789         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3790         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3791         16  CF-PLAN-SNGL-JNT               PIC X.
  3792             88  CF-COMBINED-PLAN              VALUE 'C'.
  3793             88  CF-JNT-PLAN                   VALUE 'J'.
  3794             88  CF-SNGL-PLAN                  VALUE 'S'.
  3795         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3796         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3797         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3798         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3799         16  CF-RERATE-CNTL                 PIC  X.
  3800             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3801             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3802             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3803             88  CF-AUTO-RECALC                 VALUE '4'.
  3804         16  CF-BENEFIT-TYPE                PIC  X.
  3805             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3806             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3807         16  CF-POLICY-FEE                  PIC S999V99
  3808                                                    COMP-3.
  3809         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3810         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3811         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3812         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3813         16  FILLER                         PIC  X(32).
  3814         16  CF-TERMINATION-FORM            PIC  X(04).
  3815         16  FILLER                         PIC  X(08).
  3816         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3817                                                       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  68
* EL6318.cbl
  3818         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3819         16  CF-ISSUE-LETTER                PIC  X(4).
  3820         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3821         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3822             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3823             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3824         16  CF-MP-REFUND-CALC              PIC X.
  3825             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3826             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3827             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3828             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3829             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3830             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3831             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3832             88  CF-MP-REFD-MEAN                VALUE '8'.
  3833         16  CF-ALT-RATE-CODE               PIC  X(5).
  3834
  3835
  3836         16  FILLER                         PIC X(498).
  3837****************************************************************
  3838*             MORTGAGE COMPANY MASTER RECORD                   *
  3839****************************************************************
  3840
  3841     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3842         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3843         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3844             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3845             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3846             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3847             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3848             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3849
  3850         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3851         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3852         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3853         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3854         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3855
  3856         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3857             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3858         16  CF-MP-RECON-USE-IND            PIC X(1).
  3859             88  CF-MP-USE-RECON             VALUE 'Y'.
  3860         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3861             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3862         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3863             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3864             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3865         16  FILLER                         PIC X(1).
  3866         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3867             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3868         16  CF-MORTG-MIB-VERSION           PIC X.
  3869             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3870             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3871             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3872         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3873             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3874                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3875             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  69
* EL6318.cbl
  3876                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3877             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3878                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3879             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3880                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3881             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3882                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3883             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3884                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3885         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3886         16  FILLER                         PIC X(7).
  3887         16  CF-MORTG-DESTINATION-SYMBOL.
  3888             20  CF-MORTG-MIB-COMM          PIC X(5).
  3889             20  CF-MORTG-MIB-TERM          PIC X(5).
  3890         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3891             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3892         16  FILLER                         PIC X(03).
  3893         16  CF-MP-CHECK-NO-CONTROL.
  3894             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3895                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3896                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3897                                                ' ' LOW-VALUES.
  3898                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3899                                               VALUE '3'.
  3900         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3901         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3902         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3903             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3904                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3905             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3906                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3907             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3908                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3909             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3910                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3911             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3912                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3913             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3914                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3915         16  CF-MORTG-BILLING-AREA.
  3916             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3917                                            PIC X.
  3918         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3919         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3920         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3921         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3922             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3923             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3924         16  FILLER                         PIC X.
  3925         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3926             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3927             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3928         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3929         16  FILLER                         PIC X(8).
  3930         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3931         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3932         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3933         16  CF-ACH-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  70
* EL6318.cbl
  3934             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3935                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3936                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3937                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3938             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3939         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3940             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3941         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3942             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3943             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3944         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3945         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3946         16  FILLER                         PIC X(536).
  3947
  3948****************************************************************
  3949*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3950****************************************************************
  3951
  3952     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3953         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3954             20  CF-FEMALE-HEIGHT.
  3955                 24  CF-FEMALE-FT           PIC 99.
  3956                 24  CF-FEMALE-IN           PIC 99.
  3957             20  CF-FEMALE-MIN-WT           PIC 999.
  3958             20  CF-FEMALE-MAX-WT           PIC 999.
  3959         16  FILLER                         PIC X(428).
  3960
  3961     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3962         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3963             20  CF-MALE-HEIGHT.
  3964                 24  CF-MALE-FT             PIC 99.
  3965                 24  CF-MALE-IN             PIC 99.
  3966             20  CF-MALE-MIN-WT             PIC 999.
  3967             20  CF-MALE-MAX-WT             PIC 999.
  3968         16  FILLER                         PIC X(428).
  3969******************************************************************
  3970*             AUTOMATIC ACTIVITY RECORD                          *
  3971******************************************************************
  3972     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3973         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3974             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3975             20  CF-SYS-LETTER-ID           PIC X(04).
  3976             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3977             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3978             20  CF-SYS-RESET-SW            PIC X(01).
  3979             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3980             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3981
  3982         16  FILLER                         PIC X(50).
  3983
  3984         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3985             20  CF-USER-ACTIVE-SW          PIC X(01).
  3986             20  CF-USER-LETTER-ID          PIC X(04).
  3987             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3988             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3989             20  CF-USER-RESET-SW           PIC X(01).
  3990             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3991             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  71
* EL6318.cbl
  3992             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3993
  3994         16  FILLER                         PIC X(246).
  3995*                                COPY ERCPNDB.
  3996******************************************************************
  3997*                                                                *
  3998*                                                                *
  3999*                            ERCPNDB.                            *
  4000*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4001*                            VMOD=2.025                          *
  4002*                                                                *
  4003*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4004*                                                                *
  4005******************************************************************
  4006*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4007*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4008******************************************************************
  4009*                                                                *
  4010*                                                                *
  4011*   FILE TYPE = VSAM,KSDS                                        *
  4012*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4013*                                                                *
  4014*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4015*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4016*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4017*                                                 RKP=13,LEN=36  *
  4018*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4019*                                      AND CHG-SEQ.)             *
  4020*                                                RKP=49,LEN=11   *
  4021*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4022*                                      AND CHG-SEQ.)             *
  4023*                                                RKP=60,LEN=15   *
  4024*                                                                *
  4025*   LOG = NO                                                     *
  4026*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4027******************************************************************
  4028******************************************************************
  4029*                   C H A N G E   L O G
  4030*
  4031* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4032*-----------------------------------------------------------------
  4033*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4034* EFFECTIVE    NUMBER
  4035*-----------------------------------------------------------------
  4036* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4037* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4038* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4039* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4040* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4041* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4042* 032306                   PEMA  ADD BOW LOAN NUMBER
  4043* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4044* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4045* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4046* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4047* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4048* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4049* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  72
* EL6318.cbl
  4050* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4051* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4052* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4053* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4054* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4055******************************************************************
  4056
  4057 01  PENDING-BUSINESS.
  4058     12  PB-RECORD-ID                     PIC XX.
  4059         88  VALID-PB-ID                        VALUE 'PB'.
  4060
  4061     12  PB-CONTROL-PRIMARY.
  4062         16  PB-COMPANY-CD                PIC X.
  4063         16  PB-ENTRY-BATCH               PIC X(6).
  4064         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4065         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4066
  4067     12  PB-CONTROL-BY-ACCOUNT.
  4068         16  PB-COMPANY-CD-A1             PIC X.
  4069         16  PB-CARRIER                   PIC X.
  4070         16  PB-GROUPING.
  4071             20  PB-GROUPING-PREFIX       PIC XXX.
  4072             20  PB-GROUPING-PRIME        PIC XXX.
  4073         16  PB-STATE                     PIC XX.
  4074         16  PB-ACCOUNT.
  4075             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4076             20  PB-ACCOUNT-PRIME         PIC X(6).
  4077         16  PB-CERT-EFF-DT               PIC XX.
  4078         16  PB-CERT-NO.
  4079             20  PB-CERT-PRIME            PIC X(10).
  4080             20  PB-CERT-SFX              PIC X.
  4081         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4082
  4083         16  PB-RECORD-TYPE               PIC X.
  4084             88  PB-MAILING-DATA                VALUE '0'.
  4085             88  PB-ISSUE                       VALUE '1'.
  4086             88  PB-CANCELLATION                VALUE '2'.
  4087             88  PB-BATCH-TRAILER               VALUE '9'.
  4088
  4089     12  PB-CONTROL-BY-ORIG-BATCH.
  4090         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4091         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4092         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4093         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4094
  4095     12  PB-CONTROL-BY-CSR.
  4096         16  PB-CSR-COMPANY-CD            PIC X.
  4097         16  PB-CSR-ID                    PIC X(4).
  4098         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4099         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4100         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4101******************************************************************
  4102*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4103******************************************************************
  4104
  4105     12  PB-LAST-MAINT-DT                 PIC XX.
  4106     12  PB-LAST-MAINT-BY                 PIC X(4).
  4107     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  73
* EL6318.cbl
  4108
  4109     12  PB-RECORD-BODY                   PIC X(375).
  4110
  4111     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4112         16  PB-CERT-ORIGIN               PIC X.
  4113             88  CLASIC-CREATED-CERT         VALUE '1'.
  4114         16  PB-I-NAME.
  4115             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4116             20  PB-I-INSURED-FIRST-NAME.
  4117                 24  PB-I-INSURED-1ST-INIT PIC X.
  4118                 24  FILLER                PIC X(9).
  4119             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4120         16  PB-I-AGE                     PIC S99   COMP-3.
  4121         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4122         16  PB-I-BIRTHDAY                PIC XX.
  4123         16  PB-I-INSURED-SEX             PIC X.
  4124             88  PB-SEX-MALE     VALUE 'M'.
  4125             88  PB-SEX-FEMALE   VALUE 'F'.
  4126
  4127         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4128         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4129         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4130         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4131         16  PB-I-SKIP-CODE               PIC X.
  4132             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4133             88  PB-SKIP-JULY              VALUE '1'.
  4134             88  PB-SKIP-AUGUST            VALUE '2'.
  4135             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4136             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4137             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4138             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4139             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4140             88  PB-SKIP-JUNE              VALUE '8'.
  4141             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4142             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4143             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4144         16  PB-I-TERM-TYPE               PIC X.
  4145             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4146             88  PB-PAID-WEEKLY            VALUE 'W'.
  4147             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4148             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4149             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4150         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4151         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4152         16  PB-I-DATA-ENTRY-SW           PIC X.
  4153             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4154             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4155             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4156             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4157         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4158         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4159*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4160         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4161         16  FILLER                       PIC X.
  4162
  4163         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4164             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4165             88  PB-INVALID-LIFE             VALUE '  ' '00'
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  74
* EL6318.cbl
  4166                                                   '90' THRU '99'.
  4167         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4168                                          PIC XX.
  4169         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4170         16  PB-I-AMOUNT-FINANCED REDEFINES
  4171                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4172         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4173         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4174                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4175         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4176         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4177         16  PB-I-CLP-AMOUNT REDEFINES
  4178                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4179         16  PB-I-LF-CALC-FLAG            PIC X.
  4180             88 PB-COMP-LF-PREM               VALUE '?'.
  4181         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4182         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4183         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4184         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4185         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4186         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4187         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4188         16  PB-I-LF-ABBR                 PIC XXX.
  4189         16  PB-I-LF-INPUT-CD             PIC XX.
  4190
  4191         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4192             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4193             88  PB-INVALID-AH               VALUE '  ' '00'
  4194                                                   '90' THRU '99'.
  4195         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4196         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4197         16  PB-I-AH-CALC-FLAG            PIC X.
  4198             88 PB-COMP-AH-PREM                  VALUE '?'.
  4199         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4200         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4201         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4202         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4203         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4204         16  PB-I-AH-ABBR                 PIC XXX.
  4205         16  PB-I-AH-INPUT-CD             PIC XXX.
  4206
  4207         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4208         16  PB-I-REIN-TABLE              PIC XXX.
  4209         16  PB-I-BUSINESS-TYPE           PIC 99.
  4210         16  PB-I-INDV-GRP-CD             PIC X.
  4211         16  PB-I-MORT-CODE.
  4212             20  PB-I-TABLE               PIC X.
  4213             20  PB-I-INTEREST            PIC XX.
  4214             20  PB-I-MORT-TYP            PIC X.
  4215         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4216         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4217         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4218         16  PB-I-INDV-GRP-OVRD           PIC X.
  4219         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4220         16  PB-I-SIG-SW                  PIC X.
  4221             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4222         16  PB-I-RATE-CLASS              PIC XX.
  4223         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  75
* EL6318.cbl
  4224         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4225         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4226         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4227         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4228         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4229         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4230         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4231         16  PB-I-OB-FLAG                 PIC X.
  4232             88  PB-I-OB                      VALUE 'B'.
  4233             88  PB-I-SUMMARY                 VALUE 'Z'.
  4234         16  PB-I-ENTRY-STATUS            PIC X.
  4235             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4236                                              'M' '5' '9' '2'.
  4237             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4238             88  PB-I-POLICY-PENDING          VALUE '2'.
  4239             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4240             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4241             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4242             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4243             88  PB-I-REIN-ONLY               VALUE '9'.
  4244             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4245             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4246             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4247             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4248         16  PB-I-INT-CODE                PIC X.
  4249             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4250             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4251         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4252         16  PB-I-SOC-SEC-NO              PIC X(11).
  4253         16  PB-I-MEMBER-NO               PIC X(12).
  4254         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4255*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4256         16  PB-I-OLD-LOF                 PIC XXX.
  4257         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4258         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4259         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4260         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4261         16  PB-I-LIFE-INDICATOR          PIC X.
  4262             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4263         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4264         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4265                                          PIC S9(5)V99    COMP-3.
  4266         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4267             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4268             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4269         16  PB-I-1ST-PMT-DT              PIC XX.
  4270         16  PB-I-JOINT-INSURED.
  4271             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4272             20 PB-I-JOINT-FIRST-NAME.
  4273                24  PB-I-JOINT-FIRST-INIT PIC X.
  4274                24  FILLER                PIC X(9).
  4275             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4276*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4277         16  PB-I-BENEFICIARY-NAME.
  4278             20  PB-I-BANK-NUMBER         PIC X(10).
  4279             20  FILLER                   PIC X(15).
  4280         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4281         16  PB-I-REFERENCE               PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  76
* EL6318.cbl
  4282         16  FILLER REDEFINES PB-I-REFERENCE.
  4283             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4284             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4285             20  PB-I-CLP-STATE           PIC XX.
  4286         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4287             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4288             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4289             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4290         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4291         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4292         16  PB-I-RESIDENT-STATE          PIC XX.
  4293         16  PB-I-RATE-CODE               PIC X(4).
  4294         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4295         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4296         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4297         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4298         16  PB-I-BANK-NOCHRGB            PIC 99.
  4299         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4300         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4301
  4302     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4303         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4304             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4305         16  PB-C-CANCEL-ORIGIN           PIC X.
  4306             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4307         16  PB-C-LF-CANCEL-DT            PIC XX.
  4308         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4309         16  PB-C-LF-CALC-REQ             PIC X.
  4310             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4311         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4312         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4313         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4314             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4315         16  PB-C-AH-CANCEL-DT            PIC XX.
  4316         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4317         16  PB-C-AH-CALC-REQ             PIC X.
  4318             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4319         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4320         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4321         16  PB-C-LAST-NAME               PIC X(15).
  4322         16  PB-C-REFUND-SW               PIC X.
  4323             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4324             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4325         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4326         16  PB-C-PAYEE-CODE              PIC X(6).
  4327         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4328         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4329         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4330         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4331         16  PB-C-REFERENCE               PIC X(12).
  4332         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4333         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4334         16  PB-C-POST-CARD-IND           PIC X.
  4335         16  PB-C-CANCEL-REASON           PIC X.
  4336         16  PB-C-REF-INTERFACE-SW        PIC X.
  4337         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4338         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4339         16  FILLER                       PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  77
* EL6318.cbl
  4340*        16  FILLER                       PIC X(18).
  4341         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4342*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4343         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  4344         16  PB-CANCELED-CERT-DATA.
  4345             20  PB-CI-INSURED-NAME.
  4346                 24  PB-CI-LAST-NAME      PIC X(15).
  4347                 24  PB-CI-INITIALS       PIC XX.
  4348             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4349             20  PB-CI-INSURED-SEX        PIC X.
  4350             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4351             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4352             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4353             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4354             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4355             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4356             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4357             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4358             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4359             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4360             20  PB-CI-RATE-CLASS         PIC XX.
  4361             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4362             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4363             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4364             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4365             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4366             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4367             20  PB-CI-LF-ABBR            PIC X(3).
  4368             20  PB-CI-AH-ABBR            PIC X(3).
  4369             20  PB-CI-OB-FLAG            PIC X.
  4370                 88  PB-CI-OB                VALUE 'B'.
  4371             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4372                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4373                                           'M' '4' '5' '9' '2'.
  4374                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4375                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4376                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4377                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4378                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4379                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4380                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4381                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4382                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4383                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4384                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4385                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4386                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4387             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4388                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4389                                           'M' '4' '5' '9' '2'.
  4390                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4391                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4392                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4393                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4394                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4395                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4396                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4397                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  78
* EL6318.cbl
  4398                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4399                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4400                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4401                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4402                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4403             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4404             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4405             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4406             20  PB-CI-MEMBER-NO          PIC X(12).
  4407             20  PB-CI-INT-CODE           PIC X.
  4408                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4409                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4410             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4411             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4412             20  PB-CI-COMP-EXCP-SW       PIC X.
  4413                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4414                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4415             20  PB-CI-ENTRY-STATUS       PIC X.
  4416             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4417             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4418             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4419             20  PB-CI-DEATH-DT           PIC XX.
  4420             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4421             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4422             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4423             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4424             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4425             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4426             20  PB-CI-ENTRY-DT              PIC XX.
  4427             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4428             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4429             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4430             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4431             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4432             20  PB-CI-OLD-LOF               PIC XXX.
  4433*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4434             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4435             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4436             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4437             20  PB-CI-INDV-GRP-CD           PIC X.
  4438             20  PB-CI-BENEFICIARY-NAME.
  4439                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4440                 24  FILLER                  PIC X(15).
  4441             20  PB-CI-NOTE-SW               PIC X.
  4442             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4443             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4444             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4445             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4446             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4447             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4448             20  PB-CI-FIRST-NAME            PIC X(10).
  4449             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4450
  4451         16  FILLER                       PIC X(13).
  4452*032306  16  FILLER                       PIC X(27).
  4453*        16  FILLER                       PIC X(46).
  4454
  4455     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  79
* EL6318.cbl
  4456         16  FILLER                       PIC X(10).
  4457         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4458         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4459         16  PB-M-INSURED-MID-INIT        PIC X.
  4460         16  PB-M-INSURED-AGE             PIC 99.
  4461         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4462         16  PB-M-INSURED-SEX             PIC X.
  4463         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4464         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4465         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4466         16  PB-M-INSURED-CITY-STATE.
  4467             20  PB-M-INSURED-CITY        PIC X(28).
  4468             20  PB-M-INSURED-STATE       PIC XX.
  4469         16  PB-M-INSURED-ZIP-CODE.
  4470             20  PB-M-INSURED-ZIP-PRIME.
  4471                 24  PB-M-INSURED-ZIP-1   PIC X.
  4472                     88  PB-M-CANADIAN-POST-CODE
  4473                                             VALUE 'A' THRU 'Z'.
  4474                 24  FILLER               PIC X(4).
  4475             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4476         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4477                                        PB-M-INSURED-ZIP-CODE.
  4478             20  PM-M-INS-CAN-POST1       PIC XXX.
  4479             20  PM-M-INS-CAN-POST2       PIC XXX.
  4480             20  FILLER                   PIC XXX.
  4481         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4482         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4483         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4484         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4485         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4486         16  PB-M-CRED-BENE-CITYST.
  4487             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4488             20  PB-M-CRED-BENE-STATE     PIC XX.
  4489         16  FILLER                       PIC X(92).
  4490
  4491     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4492         16  FILLER                       PIC X(10).
  4493         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4494         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4495         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4496         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4497         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4498         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4499         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4500         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4501         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4502         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4503         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4504         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4505         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4506         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4507         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4508         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4509         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4510         16  PB-ACCOUNT-NAME              PIC X(30).
  4511         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4512         16  PB-REFERENCE                 PIC X(12).
  4513         16  PB-B-RECEIVED-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  80
* EL6318.cbl
  4514         16  FILLER                       PIC X(234).
  4515
  4516     12  PB-RECORD-STATUS.
  4517         16  PB-CREDIT-SELECT-DT          PIC XX.
  4518         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4519         16  PB-BILLED-DT                 PIC XX.
  4520         16  PB-BILLING-STATUS            PIC X.
  4521             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4522             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4523             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4524         16  PB-RECORD-BILL               PIC X.
  4525             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4526             88  PB-RECORD-RETURNED           VALUE 'R'.
  4527             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4528             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4529             88  PB-OVERRIDE-AH               VALUE 'A'.
  4530             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4531         16  PB-BATCH-ENTRY               PIC X.
  4532             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4533             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4534             88  PB-REISSUED-CERT             VALUE 'E'.
  4535             88  PB-CASH-CERT                 VALUE 'C'.
  4536             88  PB-MONTHLY-CERT              VALUE 'M'.
  4537             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4538             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4539             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4540         16  PB-FORCE-CODE                PIC X.
  4541             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4542             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4543             88  PB-CANCEL-FORCE              VALUE '8'.
  4544             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4545             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4546             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4547             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4548             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4549             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4550             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4551             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4552         16  PB-FATAL-FLAG                PIC X.
  4553             88  PB-FATAL-ERRORS              VALUE 'X'.
  4554         16  PB-FORCE-ER-CD               PIC X.
  4555             88  PB-FORCE-ERRORS              VALUE 'F'.
  4556             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4557         16  PB-WARN-ER-CD                PIC X.
  4558             88  PB-WARNING-ERRORS            VALUE 'W'.
  4559         16  FILLER                       PIC X.
  4560         16  PB-OUT-BAL-CD                PIC X.
  4561             88  PB-OUT-OF-BAL                VALUE 'O'.
  4562         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4563         16  PB-AH-OVERRIDE-L1            PIC X.
  4564         16  PB-INPUT-DT                  PIC XX.
  4565         16  PB-INPUT-BY                  PIC X(4).
  4566         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4567         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4568         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4569         16  PB-LF-EARNING-METHOD         PIC X.
  4570         16  PB-AH-EARNING-METHOD         PIC X.
  4571         16  PB-LF-TERM-CALC-METHOD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  81
* EL6318.cbl
  4572         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4573         16  PB-REIN-CD                   PIC XXX.
  4574         16  PB-LF-REFUND-TYPE            PIC X.
  4575         16  PB-AH-REFUND-TYPE            PIC X.
  4576         16  PB-ACCT-EFF-DT               PIC XX.
  4577         16  PB-ACCT-EXP-DT               PIC XX.
  4578         16  PB-COMPANY-ID                PIC X(3).
  4579         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4580         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4581         16  PB-SV-CARRIER                PIC X.
  4582         16  PB-SV-GROUPING               PIC X(6).
  4583         16  PB-SV-STATE                  PIC XX.
  4584         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4585         16  PB-GA-BILLING-INFO.
  4586             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4587                                          PIC XX.
  4588         16  PB-SV-REMIT-TO  REDEFINES
  4589             PB-GA-BILLING-INFO           PIC X(10).
  4590         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4591         16  PB-I-LOAN-OFFICER            PIC X(5).
  4592         16  PB-I-VIN                     PIC X(17).
  4593
  4594         16  FILLER                       PIC X(04).
  4595         16  IMNET-BYPASS-SW              PIC X.
  4596
  4597******************************************************************
  4598*                COMMON EDIT ERRORS                              *
  4599******************************************************************
  4600
  4601     12  PB-COMMON-ERRORS.
  4602         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4603                                           PIC S9(4)     COMP.
  4604
  4605******************************************************************
  4606*                                COPY ELCCERT.
  4607******************************************************************
  4608*                                                                *
  4609*                            ELCCERT.                            *
  4610*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4611*                            VMOD=2.013                          *
  4612*                                                                *
  4613*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4614*                                                                *
  4615*   FILE TYPE = VSAM,KSDS                                        *
  4616*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4617*                                                                *
  4618*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4619*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4620*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4621*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4622*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4623*                                                                *
  4624*   LOG = YES                                                    *
  4625*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4626******************************************************************
  4627*                   C H A N G E   L O G
  4628*
  4629* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  82
* EL6318.cbl
  4630*-----------------------------------------------------------------
  4631*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4632* EFFECTIVE    NUMBER
  4633*-----------------------------------------------------------------
  4634* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4635* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4636* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4637* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4638* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4639* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4640* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4641* 032612  CR2011110200001  PEMA  AHL CHANGES
  4642* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4643* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4644* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4645******************************************************************
  4646
  4647 01  CERTIFICATE-MASTER.
  4648     12  CM-RECORD-ID                      PIC XX.
  4649         88  VALID-CM-ID                      VALUE 'CM'.
  4650
  4651     12  CM-CONTROL-PRIMARY.
  4652         16  CM-COMPANY-CD                 PIC X.
  4653         16  CM-CARRIER                    PIC X.
  4654         16  CM-GROUPING.
  4655             20  CM-GROUPING-PREFIX        PIC X(3).
  4656             20  CM-GROUPING-PRIME         PIC X(3).
  4657         16  CM-STATE                      PIC XX.
  4658         16  CM-ACCOUNT.
  4659             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4660             20  CM-ACCOUNT-PRIME          PIC X(6).
  4661         16  CM-CERT-EFF-DT                PIC XX.
  4662         16  CM-CERT-NO.
  4663             20  CM-CERT-PRIME             PIC X(10).
  4664             20  CM-CERT-SFX               PIC X.
  4665
  4666     12  CM-CONTROL-BY-NAME.
  4667         16  CM-COMPANY-CD-A1              PIC X.
  4668         16  CM-INSURED-LAST-NAME          PIC X(15).
  4669         16  CM-INSURED-INITIALS.
  4670             20  CM-INSURED-INITIAL1       PIC X.
  4671             20  CM-INSURED-INITIAL2       PIC X.
  4672
  4673     12  CM-CONTROL-BY-SSN.
  4674         16  CM-COMPANY-CD-A2              PIC X.
  4675         16  CM-SOC-SEC-NO.
  4676             20  CM-SSN-STATE              PIC XX.
  4677             20  CM-SSN-ACCOUNT            PIC X(6).
  4678             20  CM-SSN-LN3.
  4679                 25  CM-INSURED-INITIALS-A2.
  4680                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4681                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4682                 25 CM-PART-LAST-NAME-A2         PIC X.
  4683
  4684     12  CM-CONTROL-BY-CERT-NO.
  4685         16  CM-COMPANY-CD-A4              PIC X.
  4686         16  CM-CERT-NO-A4                 PIC X(11).
  4687
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  83
* EL6318.cbl
  4688     12  CM-CONTROL-BY-MEMB.
  4689         16  CM-COMPANY-CD-A5              PIC X.
  4690         16  CM-MEMBER-NO.
  4691             20  CM-MEMB-STATE             PIC XX.
  4692             20  CM-MEMB-ACCOUNT           PIC X(6).
  4693             20  CM-MEMB-LN4.
  4694                 25  CM-INSURED-INITIALS-A5.
  4695                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4696                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4697                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4698
  4699     12  CM-INSURED-PROFILE-DATA.
  4700         16  CM-INSURED-FIRST-NAME.
  4701             20  CM-INSURED-1ST-INIT       PIC X.
  4702             20  FILLER                    PIC X(9).
  4703         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4704         16  CM-INSURED-SEX                PIC X.
  4705             88  CM-SEX-MALE                  VALUE 'M'.
  4706             88  CM-SEX-FEMAL                 VALUE 'F'.
  4707         16  CM-INSURED-JOINT-AGE          PIC 99.
  4708         16  CM-JOINT-INSURED-NAME.
  4709             20  CM-JT-LAST-NAME           PIC X(15).
  4710             20  CM-JT-FIRST-NAME.
  4711                 24  CM-JT-1ST-INIT        PIC X.
  4712                 24  FILLER                PIC X(9).
  4713             20  CM-JT-INITIAL             PIC X.
  4714
  4715     12  CM-LIFE-DATA.
  4716         16  CM-LF-BENEFIT-CD              PIC XX.
  4717         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4718         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4719         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4720         16  CM-LF-DEV-CODE                PIC XXX.
  4721         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4722         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4723         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4724         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4725         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4726         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4727         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4728         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4729         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4730         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4731         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4732         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4733         16  cm-temp-epiq                  pic xx.
  4734             88  EPIQ-CLASS                  value 'EQ'.
  4735*        16  FILLER                        PIC XX.
  4736
  4737     12  CM-AH-DATA.
  4738         16  CM-AH-BENEFIT-CD              PIC XX.
  4739         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4740         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4741         16  CM-AH-DEV-CODE                PIC XXX.
  4742         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4743         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4744         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4745         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  84
* EL6318.cbl
  4746         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4747         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4748         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4749         16  CM-AH-PAID-THRU-DT            PIC XX.
  4750             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4751         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4752         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4753         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4754         16  FILLER                        PIC X.
  4755
  4756     12  CM-LOAN-INFORMATION.
  4757         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4758         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4759                                           PIC S9(5)V99  COMP-3.
  4760         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4761         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4762         16  CM-PAY-FREQUENCY              PIC S99.
  4763         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4764         16  CM-RATE-CLASS                 PIC XX.
  4765         16  CM-BENEFICIARY                PIC X(25).
  4766         16  CM-POLICY-FORM-NO             PIC X(12).
  4767         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4768         16  CM-LAST-ADD-ON-DT             PIC XX.
  4769         16  CM-DEDUCTIBLE-AMOUNTS.
  4770             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4771             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4772         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4773             20  CM-RESIDENT-STATE         PIC XX.
  4774             20  CM-RATE-CODE              PIC X(4).
  4775             20  FILLER                    PIC XX.
  4776         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4777             20  CM-LOAN-OFFICER           PIC X(5).
  4778             20  FILLER                    PIC XXX.
  4779         16  CM-CSR-CODE                   PIC XXX.
  4780         16  CM-UNDERWRITING-CODE          PIC X.
  4781             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4782         16  CM-POST-CARD-IND              PIC X.
  4783         16  CM-REF-INTERFACE-SW           PIC X.
  4784         16  CM-PREMIUM-TYPE               PIC X.
  4785             88  CM-SING-PRM                  VALUE '1'.
  4786             88  CM-O-B-COVERAGE              VALUE '2'.
  4787             88  CM-OPEN-END                  VALUE '3'.
  4788         16  CM-IND-GRP-TYPE               PIC X.
  4789             88  CM-INDIVIDUAL                VALUE 'I'.
  4790             88  CM-GROUP                     VALUE 'G'.
  4791         16  CM-SKIP-CODE                  PIC X.
  4792             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4793             88  SKIP-JULY                    VALUE '1'.
  4794             88  SKIP-AUGUST                  VALUE '2'.
  4795             88  SKIP-SEPTEMBER               VALUE '3'.
  4796             88  SKIP-JULY-AUG                VALUE '4'.
  4797             88  SKIP-AUG-SEPT                VALUE '5'.
  4798             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4799             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4800             88  SKIP-JUNE                    VALUE '8'.
  4801             88  SKIP-JUNE-JULY               VALUE '9'.
  4802             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4803             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  85
* EL6318.cbl
  4804         16  CM-PAYMENT-MODE               PIC X.
  4805             88  PAY-MONTHLY                  VALUE SPACE.
  4806             88  PAY-WEEKLY                   VALUE '1'.
  4807             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4808             88  PAY-BI-WEEKLY                VALUE '3'.
  4809             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4810         16  CM-LOAN-NUMBER                PIC X(8).
  4811         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4812         16  CM-OLD-LOF                    PIC XXX.
  4813*        16  CM-LOAN-OFFICER               PIC XXX.
  4814         16  CM-REIN-TABLE                 PIC XXX.
  4815         16  CM-SPECIAL-REIN-CODE          PIC X.
  4816         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4817         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4818         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4819
  4820     12  CM-STATUS-DATA.
  4821         16  CM-ENTRY-STATUS               PIC X.
  4822         16  CM-ENTRY-DT                   PIC XX.
  4823
  4824         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4825         16  CM-LF-CANCEL-DT               PIC XX.
  4826         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4827
  4828         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4829         16  CM-LF-DEATH-DT                PIC XX.
  4830         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4831
  4832         16  CM-LF-CURRENT-STATUS          PIC X.
  4833             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4834                                                'M' '4' '5' '9'.
  4835             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4836             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4837             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4838             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4839             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4840             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4841             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4842             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4843             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4844             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4845             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4846             88  CM-LF-DECLINED               VALUE 'D'.
  4847             88  CM-LF-VOIDED                 VALUE 'V'.
  4848
  4849         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4850         16  CM-AH-CANCEL-DT               PIC XX.
  4851         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4852
  4853         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4854         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4855         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4856
  4857         16  CM-AH-CURRENT-STATUS          PIC X.
  4858             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4859                                                'M' '4' '5' '9'.
  4860             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4861             88  CM-AH-POLICY-PENDING         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  86
* EL6318.cbl
  4862             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4863             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4864             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4865             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4866             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4867             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4868             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4869             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4870             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4871             88  CM-AH-DECLINED               VALUE 'D'.
  4872             88  CM-AH-VOIDED                 VALUE 'V'.
  4873
  4874         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4875             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4876             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4877             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4878         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4879
  4880         16  CM-ENTRY-BATCH                PIC X(6).
  4881         16  CM-LF-EXIT-BATCH              PIC X(6).
  4882         16  CM-AH-EXIT-BATCH              PIC X(6).
  4883         16  CM-LAST-MONTH-END             PIC XX.
  4884
  4885     12  CM-NOTE-SW                        PIC X.
  4886         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4887         88  CERT-NOTES-PRESENT               VALUE '1'.
  4888         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4889         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4890         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4891         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4892         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4893         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4894     12  CM-COMP-EXCP-SW                   PIC X.
  4895         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4896         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4897     12  CM-INSURED-ADDRESS-SW             PIC X.
  4898         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4899         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4900
  4901*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4902     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4903     12  FILLER                            PIC X.
  4904
  4905*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4906     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4907     12  FILLER                            PIC X.
  4908*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4909     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  4910
  4911     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4912         88  CERT-ADDED-BATCH                 VALUE ' '.
  4913         88  CERT-ADDED-ONLINE                VALUE '1'.
  4914         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4915         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4916         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4917     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4918         88  CERT-AS-LOADED                   VALUE ' '.
  4919         88  CERT-CANCELLED-ONLINE            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  87
* EL6318.cbl
  4920         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4921         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4922         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4923         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4924         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4925         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4926
  4927     12  CM-ACCOUNT-COMM-PCTS.
  4928         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4929         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4930
  4931     12  CM-USER-FIELD                     PIC X.
  4932     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4933     12  CM-CLP-STATE                      PIC XX.
  4934     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4935     12  CM-USER-RESERVED                  PIC XXX.
  4936     12  FILLER REDEFINES CM-USER-RESERVED.
  4937         16  CM-AH-CLASS-CD                PIC XX.
  4938         16  F                             PIC X.
  4939******************************************************************
  4940*                                COPY ELCCRTO.
  4941******************************************************************
  4942*                                                                *
  4943*                            ELCCRTO.                            *
  4944*                                                                *
  4945*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4946*                                                                *
  4947*   FILE TYPE = VSAM,KSDS                                        *
  4948*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4949*                                                                *
  4950*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4951*                                                                *
  4952*   LOG = YES                                                    *
  4953*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4954******************************************************************
  4955*                   C H A N G E   L O G
  4956*
  4957* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4958*-----------------------------------------------------------------
  4959*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4960* EFFECTIVE    NUMBER
  4961*-----------------------------------------------------------------
  4962* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4963* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4964* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4965* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4966* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  4967******************************************************************
  4968 01  ORIGINAL-CERTIFICATE.
  4969     12  OC-RECORD-ID                      PIC XX.
  4970         88  VALID-OC-ID                      VALUE 'OC'.
  4971     12  OC-CONTROL-PRIMARY.
  4972         16  OC-COMPANY-CD                 PIC X.
  4973         16  OC-CARRIER                    PIC X.
  4974         16  OC-GROUPING                   PIC X(6).
  4975         16  OC-STATE                      PIC XX.
  4976         16  OC-ACCOUNT                    PIC X(10).
  4977         16  OC-CERT-EFF-DT                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  88
* EL6318.cbl
  4978         16  OC-CERT-NO.
  4979             20  OC-CERT-PRIME             PIC X(10).
  4980             20  OC-CERT-SFX               PIC X.
  4981         16  OC-RECORD-TYPE                PIC X.
  4982         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4983     12  OC-LAST-MAINT-DT                  PIC XX.
  4984     12  OC-LAST-MAINT-BY                  PIC X(4).
  4985     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4986     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4987     12  FILLER                            PIC X(49).
  4988     12  OC-ORIG-REC.
  4989         16  OC-INS-LAST-NAME              PIC X(15).
  4990         16  OC-INS-FIRST-NAME             PIC X(10).
  4991         16  OC-INS-MIDDLE-INIT            PIC X.
  4992         16  OC-INS-AGE                    PIC S999     COMP-3.
  4993         16  OC-JNT-LAST-NAME              PIC X(15).
  4994         16  OC-JNT-FIRST-NAME             PIC X(10).
  4995         16  OC-JNT-MIDDLE-INIT            PIC X.
  4996         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4997         16  OC-LF-BENCD                   PIC XX.
  4998         16  OC-LF-TERM                    PIC S999      COMP-3.
  4999         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5000         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5001         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5002         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5003         16  OC-LF-EXP-DT                  PIC XX.
  5004         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5005         16  OC-LF-CANCEL-DT               PIC XX.
  5006         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5007         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5008         16  OC-AH-BENCD                   PIC XX.
  5009         16  OC-AH-TERM                    PIC S999      COMP-3.
  5010         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5011         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5012         16  OC-AH-EXP-DT                  PIC XX.
  5013         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5014         16  OC-AH-CP                      PIC 99.
  5015         16  OC-AH-CANCEL-DT               PIC XX.
  5016         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5017         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5018         16  OC-CRED-BENE-NAME             PIC X(25).
  5019         16  OC-1ST-PMT-DT                 PIC XX.
  5020         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  5021         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  5022         16  OC-ISSUE-TRAN-IND             PIC X.
  5023         16  OC-CANCEL-TRAN-IND            PIC X.
  5024         16  FILLER                        PIC X(211).
  5025
  5026     12  FILLER                            PIC X(50).
  5027******************************************************************
  5028*                                COPY ERCENDT.
  5029******************************************************************
  5030*                                                                *
  5031*                                                                *
  5032*                            ERCENDT.                            *
  5033*                            VMOD=2.001                          *
  5034*                                                                *
  5035*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  89
* EL6318.cbl
  5036*                                                                *
  5037*   FILE TYPE = VSAM,KSDS                                        *
  5038*   RECORD SIZE = 579  RECFORM = FIXED                           *
  5039*                                                                *
  5040*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  5041*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  5042*                                                                *
  5043*   LOG = NO                                                     *
  5044*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5045******************************************************************
  5046*-----------------------------------------------------------------
  5047*                   C H A N G E   L O G
  5048*
  5049* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5050*-----------------------------------------------------------------
  5051*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5052* EFFECTIVE    NUMBER
  5053*-----------------------------------------------------------------
  5054* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  5055*                                WITH OPEN CLAIMS
  5056* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  5057* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5058* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5059* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  5060*-----------------------------------------------------------------
  5061 01  ENDORSEMENT-RECORD.
  5062     12  EN-RECORD-ID                PIC XX.
  5063         88  VALID-EN-ID                VALUE 'EN'.
  5064     12  EN-CONTROL-PRIMARY.
  5065         16  EN-COMPANY-CD           PIC X.
  5066         16  EN-CARRIER              PIC X.
  5067         16  EN-GROUPING             PIC X(6).
  5068         16  EN-STATE                PIC XX.
  5069         16  EN-ACCOUNT              PIC X(10).
  5070         16  EN-CERT-EFF-DT          PIC XX.
  5071         16  EN-CERT-NO.
  5072             20  EN-CERT-PRIME       PIC X(10).
  5073             20  EN-CERT-SFX         PIC X.
  5074         16  EN-REC-TYPE             PIC X.
  5075             88  EN-ISSUE               VALUE 'I'.
  5076             88  EN-CANCELLATION        VALUE 'C'.
  5077         16  EN-SEQ-NO               PIC 9(04) BINARY.
  5078     12  EN-CONTROL-BY-ARCH-NO.
  5079         16  EN-COMPANY-CD-A1              PIC X.
  5080         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  5081     12  EN-LAST-MAINT-DT            PIC XX.
  5082     12  EN-LAST-MAINT-BY            PIC X(4).
  5083     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  5084     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  5085     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5086         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  5087         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  5088         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  5089         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  5090         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  5091         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  5092         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  5093         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  90
* EL6318.cbl
  5094         16  EN-LF-ORIG-BENCD        PIC XX.
  5095         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  5096         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  5097         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  5098         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  5099         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  5100         16  EN-LF-ORIG-EXP-DT       PIC XX.
  5101*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  5102         16  EN-ORIG-CRED-BENE       PIC X(25).
  5103         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  5104         16  FILLER                  PIC X.
  5105         16  EN-AH-ORIG-BENCD        PIC XX.
  5106         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  5107         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  5108         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  5109         16  EN-AH-ORIG-EXP-DT       PIC XX.
  5110*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  5111*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  5112         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  5113         16  F                       PIC X(09).
  5114         16  EN-AH-ORIG-CP           PIC 99.
  5115         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  5116         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  5117         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  5118         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  5119         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  5120         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  5121         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  5122         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  5123         16  EN-LF-NEW-BENCD         PIC XX.
  5124         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  5125         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5126         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5127         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  5128         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  5129         16  EN-LF-NEW-EXP-DT        PIC XX.
  5130         16  EN-NEW-CRED-BENE        PIC X(25).
  5131         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5132         16  FILLER                  PIC X.
  5133         16  EN-AH-NEW-BENCD         PIC XX.
  5134         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  5135         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5136         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5137         16  EN-AH-NEW-EXP-DT        PIC XX.
  5138*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  5139*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  5140*        16  F                       PIC X(12).
  5141         16  EN-AH-NEW-CP            PIC 99.
  5142         16  EN-SIG-SW               PIC X.
  5143         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5144         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  5145         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  5146         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  5147         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  5148         16  FILLER                  PIC X(33).
  5149     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5150         16  EN-LF-ORIG-REF-DT       PIC XX.
  5151         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  91
* EL6318.cbl
  5152         16  EN-AH-ORIG-REF-DT       PIC XX.
  5153         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5154         16  EN-LF-NEW-REF-DT        PIC XX.
  5155         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5156         16  EN-AH-NEW-REF-DT        PIC XX.
  5157         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5158         16  EN-FLAG-CERT            PIC X.
  5159         16  EN-INS-LAST-NAME        PIC X(15).
  5160         16  EN-INS-FIRST-NAME       PIC X(10).
  5161         16  EN-INS-MIDDLE-INIT      PIC X.
  5162         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5163         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5164         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5165         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5166         16  FILLER                  PIC X(262).
  5167     12  EN-MONEY-SW             PIC X.
  5168     12  EN-HEALTH-APP           PIC X.
  5169     12  EN-VOUCHER-SW           PIC X.
  5170     12  EN-PAYEE                PIC X(14).
  5171     12  EN-INPUT-DT             PIC XX.
  5172     12  EN-PROCESS-DT           PIC XX.
  5173     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  5174     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  5175     12  EN-REASON-CODES.
  5176         16  F OCCURS 12.
  5177             20  EN-REASON-CODE  PIC X(4).
  5178     12  EN-TEMPLATE-USED        PIC X(8).
  5179     12  EN-DOCU-TYPE            PIC X.
  5180         88  EN-VERI-DOCU          VALUE 'V'.
  5181         88  EN-GCE-DOCU           VALUE 'G'.
  5182         88  EN-CANC-DOCU          VALUE 'C'.
  5183     12  EN-COMMENTS1            PIC X(13).
  5184     12  EN-COMMENTS2            PIC X(70).
  5185     12  EN-COMM-CHGBK           PIC X.
  5186         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  5187         88  EN-CHG-ACCT           VALUE 'Y'.
  5188     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  5189     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  5190     12  EN-BATCH-NUMBER         PIC X(6).
  5191     12  EN-ACCT-SUMM            PIC X.
  5192     12  EN-CSO-SUMM             PIC X.
  5193     12  en-check-type           pic x.
  5194     12  FILLER                  PIC X(12).
  5195******************************************************************
  5196*                                COPY ERCNOTE.
  5197******************************************************************
  5198*                                                                *
  5199*                                                                *
  5200*                            ERCNOTE                             *
  5201*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5202*                            VMOD=2.003                          *
  5203*                                                                *
  5204*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5205*                                                                *
  5206*        FILE TYPE= VSAM,KSDS                                    *
  5207*        RECORD SIZE = 825    RECFORM = FIXED                    *
  5208*                                                                *
  5209*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  92
* EL6318.cbl
  5210*                                                                *
  5211*        LOG = YES                                               *
  5212*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5213*                                                                *
  5214******************************************************************
  5215*                   C H A N G E   L O G
  5216*
  5217* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5218*-----------------------------------------------------------------
  5219*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5220* EFFECTIVE    NUMBER
  5221*-----------------------------------------------------------------
  5222* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5223*                                FILE WILL CONTAIN BILLING NOTES O
  5224******************************************************************
  5225
  5226 01  CERTIFICATE-NOTE.
  5227     12  CN-RECORD-ID                PIC  XX.
  5228         88  VALID-CN-ID                  VALUE 'CN'.
  5229
  5230     12  CN-CONTROL-PRIMARY.
  5231         16  CN-COMPANY-CD           PIC X.
  5232         16  CN-CARRIER              PIC X.
  5233         16  CN-GROUPING.
  5234             20 CN-GROUPING-PREFIX   PIC XXX.
  5235             20 CN-GROUPING-PRIME    PIC XXX.
  5236         16  CN-STATE                PIC XX.
  5237         16  CN-ACCOUNT.
  5238             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5239             20 CN-ACCOUNT-PRIME     PIC X(6).
  5240         16  CN-CERT-EFF-DT          PIC XX.
  5241         16  CN-CERT-NO.
  5242             20  CN-CERT-PRIME       PIC X(10).
  5243             20  CN-CERT-SFX         PIC X.
  5244
  5245     12  CN-BILLING-START-LINE-NO    PIC 99.
  5246     12  CN-BILLING-END-LINE-NO      PIC 99.
  5247
  5248     12  CN-LINES.
  5249         16  CN-LINE OCCURS 10       PIC X(77).
  5250
  5251     12  CN-LAST-MAINT-DT            PIC XX.
  5252     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5253     12  CN-LAST-MAINT-USER          PIC X(4).
  5254     12  FILLER                      PIC X(6).
  5255******************************************************************
  5256*                                COPY ERCMAIL.
  5257******************************************************************
  5258*                                                                *
  5259*                                                                *
  5260*                            ERCMAIL                             *
  5261*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5262*                            VMOD=2.003                          *
  5263*                                                                *
  5264*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5265*                                                                *
  5266*   FILE TYPE = VSAM,KSDS                                        *
  5267*   RECORD SIZE = 374   RECFORM = FIX                            *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  93
* EL6318.cbl
  5268*                                                                *
  5269*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5270*   ALTERNATE PATH    = NOT USED                                 *
  5271*                                                                *
  5272*   LOG = YES                                                    *
  5273*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5274******************************************************************
  5275*                   C H A N G E   L O G
  5276*
  5277* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5278*-----------------------------------------------------------------
  5279*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5280* EFFECTIVE    NUMBER
  5281*-----------------------------------------------------------------
  5282* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5283* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5284* 111108                   PEMA  ADD CRED BENE ADDR2
  5285******************************************************************
  5286
  5287 01  MAILING-DATA.
  5288     12  MA-RECORD-ID                      PIC XX.
  5289         88  VALID-MA-ID                       VALUE 'MA'.
  5290
  5291     12  MA-CONTROL-PRIMARY.
  5292         16  MA-COMPANY-CD                 PIC X.
  5293         16  MA-CARRIER                    PIC X.
  5294         16  MA-GROUPING.
  5295             20  MA-GROUPING-PREFIX        PIC XXX.
  5296             20  MA-GROUPING-PRIME         PIC XXX.
  5297         16  MA-STATE                      PIC XX.
  5298         16  MA-ACCOUNT.
  5299             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5300             20  MA-ACCOUNT-PRIME          PIC X(6).
  5301         16  MA-CERT-EFF-DT                PIC XX.
  5302         16  MA-CERT-NO.
  5303             20  MA-CERT-PRIME             PIC X(10).
  5304             20  MA-CERT-SFX               PIC X.
  5305
  5306     12  FILLER                            PIC XX.
  5307
  5308     12  MA-ACCESS-CONTROL.
  5309         16  MA-SOURCE-SYSTEM              PIC XX.
  5310             88  MA-FROM-CREDIT                VALUE 'CR'.
  5311             88  MA-FROM-VSI                   VALUE 'VS'.
  5312             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5313             88  MA-FROM-OTHER                 VALUE 'OT'.
  5314         16  MA-RECORD-ADD-DT              PIC XX.
  5315         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5316         16  MA-LAST-MAINT-DT              PIC XX.
  5317         16  MA-LAST-MAINT-BY              PIC XXXX.
  5318         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5319
  5320     12  MA-PROFILE-INFO.
  5321         16  MA-QUALIFY-CODE-1             PIC XX.
  5322         16  MA-QUALIFY-CODE-2             PIC XX.
  5323         16  MA-QUALIFY-CODE-3             PIC XX.
  5324         16  MA-QUALIFY-CODE-4             PIC XX.
  5325         16  MA-QUALIFY-CODE-5             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  94
* EL6318.cbl
  5326
  5327         16  MA-INSURED-LAST-NAME          PIC X(15).
  5328         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5329         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5330         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5331         16  MA-INSURED-BIRTH-DT           PIC XX.
  5332         16  MA-INSURED-SEX                PIC X.
  5333             88  MA-SEX-MALE                   VALUE 'M'.
  5334             88  MA-SEX-FEMALE                 VALUE 'F'.
  5335         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5336
  5337         16  MA-ADDRESS-CORRECTED          PIC X.
  5338         16  MA-JOINT-BIRTH-DT             PIC XX.
  5339*        16  FILLER                        PIC X(12).
  5340
  5341         16  MA-ADDRESS-LINE-1             PIC X(30).
  5342         16  MA-ADDRESS-LINE-2             PIC X(30).
  5343         16  MA-CITY-STATE.
  5344             20  MA-CITY                   PIC X(28).
  5345             20  MA-ADDR-STATE             PIC XX.
  5346         16  MA-ZIP.
  5347             20  MA-ZIP-CODE.
  5348                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5349                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5350                 24  FILLER                PIC X(4).
  5351             20  MA-ZIP-PLUS4              PIC X(4).
  5352         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5353             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5354             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5355             20  FILLER                    PIC X(3).
  5356
  5357         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5358
  5359         16  FILLER                        PIC XXX.
  5360*        16  FILLER                        PIC X(10).
  5361
  5362     12  MA-CRED-BENE-INFO.
  5363         16  MA-CRED-BENE-NAME                 PIC X(25).
  5364         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5365         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5366         16  MA-CRED-BENE-CTYST.
  5367             20  MA-CRED-BENE-CITY             PIC X(28).
  5368             20  MA-CRED-BENE-STATE            PIC XX.
  5369         16  MA-CRED-BENE-ZIP.
  5370             20  MA-CB-ZIP-CODE.
  5371                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5372                     88  MA-CB-CANADIAN-POST-CODE
  5373                                           VALUE 'A' THRU 'Z'.
  5374                 24  FILLER                    PIC X(4).
  5375             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5376         16  MA-CB-CANADIAN-POSTAL-CODE
  5377                            REDEFINES MA-CRED-BENE-ZIP.
  5378             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5379             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5380             20  FILLER                        PIC X(3).
  5381     12  MA-POST-CARD-MAIL-DATA.
  5382         16  MA-MAIL-DATA OCCURS 7.
  5383             20  MA-MAIL-TYPE              PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  95
* EL6318.cbl
  5384                 88  MA-12MO-MAILING           VALUE '1'.
  5385                 88  MA-EXP-MAILING            VALUE '2'.
  5386             20  MA-MAIL-STATUS            PIC X.
  5387                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5388                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5389                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5390             20  MA-MAIL-DATE              PIC XX.
  5391     12  FILLER                            PIC XX.
  5392     12  FILLER                            PIC XX.
  5393*    12  FILLER                            PIC X(30).
  5394******************************************************************
  5395*                                COPY ERCARCH.
  5396******************************************************************
  5397*                                                                *
  5398*                            ERCARCH.                            *
  5399*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5400*                            VMOD=2.002                          *
  5401*                                                                *
  5402*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5403*                                                                *
  5404*   FILE TYPE = VSAM,KSDS                                        *
  5405*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5406*                                                                *
  5407*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5408*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5409*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5410*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5411*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5412*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5413*                                                                *
  5414*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5415******************************************************************
  5416*                   C H A N G E   L O G
  5417*
  5418* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5419*-----------------------------------------------------------------
  5420*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5421* EFFECTIVE    NUMBER
  5422*-----------------------------------------------------------------
  5423* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5424* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5425* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5426******************************************************************
  5427 01  LETTER-ARCHIVE.
  5428     12  LA-RECORD-ID                PIC  X(02).
  5429         88  LA-VALID-ID                VALUE 'LA'.
  5430
  5431     12  LA-CONTROL-PRIMARY.
  5432         16  LA-COMPANY-CD           PIC  X(01).
  5433         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5434
  5435     12  LA-CONTROL-BY-CERT-RESP.
  5436         16  LA-COMPANY-CD-A2        PIC  X(01).
  5437         16  LA-CERT-NO-A2.
  5438             20  LA-CERT-PRIME-A2    PIC  X(10).
  5439             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5440         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5441             20  LA-RESP-PERSON-A2   PIC  X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  96
* EL6318.cbl
  5442             20  LA-TYPE-A2          PIC  X(01).
  5443         16  LA-CARRIER-A2           PIC  X(01).
  5444         16  LA-GROUPING-A2          PIC  X(06).
  5445         16  LA-STATE-A2             PIC  X(02).
  5446         16  LA-ACCOUNT-A2           PIC  X(10).
  5447         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5448         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5449
  5450     12  LA-CONTROL-BY-FORM.
  5451         16  LA-COMPANY-CD-A3        PIC  X(01).
  5452         16  LA-FORM-A3              PIC  X(04).
  5453         16  LA-CARRIER-A3           PIC  X(01).
  5454         16  LA-GROUPING-A3          PIC  X(06).
  5455         16  LA-STATE-A3             PIC  X(02).
  5456         16  LA-ACCOUNT-A3           PIC  X(10).
  5457         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5458
  5459     12  LA-CONTROL-BY-PROCESSOR.
  5460         16  LA-COMPANY-CD-A4        PIC  X(01).
  5461         16  LA-PROCESSOR-CD         PIC  X(04).
  5462         16  LA-CARRIER-A4           PIC  X(01).
  5463         16  LA-GROUPING-A4          PIC  X(06).
  5464         16  LA-STATE-A4             PIC  X(02).
  5465         16  LA-ACCOUNT-A4           PIC  X(10).
  5466         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5467
  5468     12  LA-CONTROL-BY-KEY-FIELDS.
  5469         16  LA-COMPANY-CD-A5        PIC  X(01).
  5470         16  LA-CARRIER-A5           PIC  X(01).
  5471         16  LA-GROUPING-A5          PIC  X(06).
  5472         16  LA-STATE-A5             PIC  X(02).
  5473         16  LA-ACCOUNT-A5           PIC  X(10).
  5474         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5475
  5476     12  LA-CONTROL-BY-GROUP-CODE.
  5477         16  LA-COMPANY-CD-A6        PIC  X(01).
  5478         16  LA-ENTRY-A6.
  5479             20  LA-FILLER           PIC  X(02).
  5480             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5481         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5482
  5483     12  FILLER                      PIC  X(09).
  5484
  5485     12  LA-HEADER-RECORD.
  5486         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5487         16  LA-CREATION-DATE        PIC  X(02).
  5488         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5489         16  LA-FINAL-ACT-DATE       REDEFINES
  5490               LA-FOLLOW-UP-DATE     PIC  X(02).
  5491         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5492         16  LA-NO-OF-COPIES         PIC S9(01).
  5493         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5494         16  LA-REPLY-DATE           PIC  X(02).
  5495         16  LA-RESEND-DATES.
  5496             20  LA-RESEND-DATE      PIC  X(02).
  5497             20  LA-SENT-DATE        PIC  X(02).
  5498             20  FILLER              PIC  X(08).
  5499         16  LA-SOURCE-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  97
* EL6318.cbl
  5500             20  LA-DATA-SOURCE      PIC  X(01).
  5501             20  LA-ADDR-SOURCE      PIC  X(01).
  5502         16  LA-STATUS               PIC  X(01).
  5503             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5504             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5505             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5506             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5507             88  LA-STATUS-PURGED         VALUE 'P'.
  5508             88  LA-STATUS-VOIDED         VALUE 'V'.
  5509         16  LA-LAST-RESENT-PRINT-DATE
  5510                                     PIC  X(02).
  5511         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5512             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5513                                          VALUE 'C'.
  5514             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5515                                          VALUE 'F'.
  5516             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5517                                          VALUE 'P'.
  5518         16  LA-PURGED-DATE          PIC  X(02).
  5519         16  LA-VOIDED-DATE          PIC  X(02).
  5520         16  LA-RESEND-LETR          PIC  X(4).
  5521         16  FILLER                  PIC  X(08).
  5522*        16  LA-RESEND-LETR-2        PIC  X(4).
  5523*        16  LA-RESEND-LETR-3        PIC  X(4).
  5524*        16  FILLER                  PIC  X(59).
  5525         16  LA-ARCHIVE-STATUS       PIC  X.
  5526             88  LA-TEMP                VALUE 'T'.
  5527             88  LA-QWS                 VALUE 'Q'.
  5528             88  LA-BATCH               VALUE 'B'.
  5529         16  LA-FINAL-ACT-IND        PIC  X(1).
  5530         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5531         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5532         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5533                                     PIC X(4).
  5534         16  FILLER                  PIC  X(42).
  5535*        16  FILLER                  PIC  X(71).
  5536         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5537         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5538         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5539                                     PIC  X(4).
  5540         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5541
  5542******************************************************************
  5543*                                COPY ERCCNOT.
  5544******************************************************************
  5545*                                                                *
  5546*                            ERCCNOT                             *
  5547*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5548*                            VMOD=2.003                          *
  5549*                                                                *
  5550*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5551*                                                                *
  5552*        FILE TYPE= VSAM,KSDS                                    *
  5553*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5554*                                                                *
  5555*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5556*                                                                *
  5557*        LOG = YES                                               *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  98
* EL6318.cbl
  5558*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5559*                                                                *
  5560******************************************************************
  5561*                   C H A N G E   L O G
  5562*
  5563* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5564*-----------------------------------------------------------------
  5565*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5566* EFFECTIVE    NUMBER
  5567*-----------------------------------------------------------------
  5568* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5569******************************************************************
  5570
  5571 01  CERT-NOTE-FILE.
  5572     12  CZ-RECORD-ID                PIC  XX.
  5573         88  VALID-CZ-ID                  VALUE 'CZ'.
  5574
  5575     12  CZ-CONTROL-PRIMARY.
  5576         16  CZ-COMPANY-CD           PIC X.
  5577         16  CZ-CARRIER              PIC X.
  5578         16  CZ-GROUPING.
  5579             20 CZ-GROUPING-PREFIX   PIC XXX.
  5580             20 CZ-GROUPING-PRIME    PIC XXX.
  5581         16  CZ-STATE                PIC XX.
  5582         16  CZ-ACCOUNT.
  5583             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5584             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5585         16  CZ-CERT-EFF-DT          PIC XX.
  5586         16  CZ-CERT-NO.
  5587             20  CZ-CERT-PRIME       PIC X(10).
  5588             20  CZ-CERT-SFX         PIC X.
  5589         16  CZ-RECORD-TYPE          PIC X.
  5590             88  CERT-NOTE           VALUE '1'.
  5591             88  CLAIM-CERT-NOTE     VALUE '2'.
  5592         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5593
  5594     12  CZ-LAST-MAINT-DT            PIC XX.
  5595     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5596     12  CZ-LAST-MAINT-USER          PIC X(4).
  5597
  5598     12  CZ-NOTE-INFORMATION.
  5599         16  CZ-NOTE                 PIC X(63).
  5600         16  FILLER                  PIC X(39).
  5601******************************************************************
  5602*                                COPY ELCEOBC.
  5603******************************************************************
  5604*                                                                *
  5605*                                                                *
  5606*                            ELCEOBC                             *
  5607*                            VMOD=2.001                          *
  5608*                                                                *
  5609*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5610*                                                                *
  5611*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5612*   VSAM EOB CODE TABLE                                          *
  5613*                                                                *
  5614*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5615*                                                                *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  99
* EL6318.cbl
  5616*   FILE TYPE = VSAM,KSDS                                        *
  5617*   RECORD SIZE = 350   RECFORM = FIX                            *
  5618*                                                                *
  5619*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5620*                                                                *
  5621*   LOG = NO                                                     *
  5622*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5623*                                                                *
  5624*                                                                *
  5625******************************************************************
  5626*                   C H A N G E   L O G
  5627*
  5628* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5629*-----------------------------------------------------------------
  5630*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5631* EFFECTIVE    NUMBER
  5632*-----------------------------------------------------------------
  5633* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5634* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5635* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  5636******************************************************************
  5637 01  EOB-CODES.
  5638     12  EO-RECORD-ID                      PIC XX.
  5639         88  VALID-DN-ID                      VALUE 'EO'.
  5640     12  EO-CONTROL-PRIMARY.
  5641         16  EO-COMPANY-CD                 PIC X.
  5642         16  EO-RECORD-TYPE                PIC X.
  5643             88  EO-EOB-RECS                  VALUE '1'.
  5644             88  EO-VERIF-RECS                VALUE '2'.
  5645             88  EO-GCE-RECS                  VALUE '3'.
  5646             88  EO-CANC-RECS                 VALUE '4'.
  5647             88  EO-BILL-NOTE-RECS            VALUE '5'.
  5648         16  EO-EOB-CODE                   PIC X(4).
  5649         16  FILLER                        PIC X(9).
  5650     12  EO-MAINT-INFORMATION.
  5651         16  EO-LAST-MAINT-DT              PIC XX.
  5652         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5653         16  EO-LAST-MAINT-USER            PIC X(4).
  5654         16  FILLER                        PIC XX.
  5655     12  EO-DESCRIPTION                    PIC X(275).
  5656     12  FILLER                            PIC X(46).
  5657******************************************************************
  5658*                                COPY ELCCRTT.
  5659******************************************************************
  5660*                                                                *
  5661*                            ELCCRTT.                            *
  5662*                                                                *
  5663*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5664*                                                                *
  5665*   FILE TYPE = VSAM,KSDS                                        *
  5666*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5667*                                                                *
  5668*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5669*                                                                *
  5670*   LOG = YES                                                    *
  5671*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5672******************************************************************
  5673*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 100
* EL6318.cbl
  5674*
  5675* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5676*-----------------------------------------------------------------
  5677*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5678* EFFECTIVE    NUMBER
  5679*-----------------------------------------------------------------
  5680* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5681* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5682* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5683* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5684* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5685* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5686* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5687* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  5688* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  5689* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  5690******************************************************************
  5691
  5692 01  CERTIFICATE-TRAILERS.
  5693     12  CS-RECORD-ID                      PIC XX.
  5694         88  VALID-CS-ID                      VALUE 'CS'.
  5695
  5696     12  CS-CONTROL-PRIMARY.
  5697         16  CS-COMPANY-CD                 PIC X.
  5698         16  CS-CARRIER                    PIC X.
  5699         16  CS-GROUPING                   PIC X(6).
  5700         16  CS-STATE                      PIC XX.
  5701         16  CS-ACCOUNT                    PIC X(10).
  5702         16  CS-CERT-EFF-DT                PIC XX.
  5703         16  CS-CERT-NO.
  5704             20  CS-CERT-PRIME             PIC X(10).
  5705             20  CS-CERT-SFX               PIC X.
  5706         16  CS-TRAILER-TYPE               PIC X.
  5707             88  COMM-TRLR           VALUE 'A'.
  5708             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5709             88  CERT-DATA-TRLR      VALUE 'C'.
  5710
  5711     12  CS-DATA-AREA                      PIC X(516).
  5712
  5713     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5714         16  CS-BANK-COMMISSION-AREA.
  5715             20  CS-BANK-COMMS       OCCURS 10.
  5716                 24  CS-AGT                PIC X(10).
  5717                 24  CS-COM-TYP            PIC X.
  5718                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5719                 24  CS-RECALC-LV-INDIC    PIC X.
  5720                 24  FILLER                PIC X(10).
  5721         16  FILLER                        PIC X(256).
  5722
  5723     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5724****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5725         16  CS-MB-CLAIM-DATA OCCURS 24.
  5726             20  CS-CLAIM-NO               PIC X(7).
  5727             20  CS-CLAIM-TYPE             PIC X.
  5728                 88  CS-AH-CLM               VALUE 'A'.
  5729                 88  CS-IU-CLM               VALUE 'I'.
  5730                 88  CS-GP-CLM               VALUE 'G'.
  5731                 88  CS-LF-CLM               VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 101
* EL6318.cbl
  5732                 88  CS-PR-CLM               VALUE 'P'.
  5733                 88  CS-FL-CLM               VALUE 'F'.
  5734             20  CS-INSURED-TYPE           PIC X.
  5735                 88  CS-PRIM-INSURED          VALUE 'P'.
  5736                 88  CS-CO-BORROWER           VALUE 'C'.
  5737             20  CS-BENEFIT-PERIOD         PIC 99.
  5738             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5739             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5740             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5741         16  FILLER                        PIC X(12).
  5742     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5743         16  CS-VIN-NUMBER                 PIC X(17).
  5744         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5745         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5746         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5747         16  cs-agent-name.
  5748             20  cs-agent-fname            pic x(20).
  5749             20  cs-agent-mi               pic x.
  5750             20  cs-agent-lname            pic x(25).
  5751         16  cs-license-no                 pic x(15).
  5752         16  cs-npn-number                 pic x(10).
  5753         16  cs-agent-edit-status          pic x.
  5754             88  cs-ae-refer-to-manager      value 'M'.
  5755             88  cs-ae-cover-sheet           value 'C'.
  5756             88  cs-ae-sig-form              value 'S'.
  5757             88  cs-ae-verified              value 'V'.
  5758             88  cs-unidentified-signature   value 'U'.
  5759             88  cs-cert-returned            value 'R'.
  5760             88  cs-accept-no-commission     value 'N'.
  5761         16  cs-year                       pic 9999.
  5762         16  cs-make                       pic x(20).
  5763         16  cs-model                      pic x(20).
  5764         16  cs-future                     pic x(20).
  5765         16  cs-vehicle-odometer           pic s9(7) comp-3.
  5766         16  cs-claim-verification-status  pic x.
  5767             88  cs-clm-ver-eligible         value 'A'.
  5768             88  cs-clm-ver-partial-elig     value 'B'.
  5769             88  cs-clm-ver-not-eligible     value 'C'.
  5770             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  5771             88  cs-clm-ver-not-part-elig-rw value 'E'.
  5772             88  cs-clm-ver-ND-CERT          value 'F'.
  5773             88  cs-clm-ver-spec-other       value 'G'.
  5774             88  cs-clam-ver-pratial-corrected
  5775                                             value 'H'.
  5776             88  cs-clm-ver-no-matches       value 'I'.
  5777             88  cs-clm-ver-not-elig-corrected
  5778                                             value 'J'.
  5779             88  cs-clm-ver-needs-review     value 'R'.
  5780             88  cs-clm-ver-sent-to-claims   value 'W'.
  5781         16  FILLER                        PIC X(355). *> was 420
  5782*        16  FILLER                        PIC X(496).
  5783*                                COPY ELCENCC.
  5784******************************************************************
  5785*                                                                *
  5786*                                                                *
  5787*                            ELCENCC                             *
  5788*                            VMOD=2.001                          *
  5789*                                                                *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 102
* EL6318.cbl
  5790*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5791*                                                                *
  5792*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  5793*   A NAPERSOFT DOCUMENT                                         *
  5794*                                                                *
  5795*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5796*                                                                *
  5797*   FILE TYPE = VSAM,KSDS                                        *
  5798*   RECORD SIZE = 400   RECFORM = FIX                            *
  5799*                                                                *
  5800*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  5801*                                                                *
  5802*   LOG = NO                                                     *
  5803*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5804*                                                                *
  5805*                                                                *
  5806******************************************************************
  5807*                   C H A N G E   L O G
  5808*
  5809* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5810*-----------------------------------------------------------------
  5811*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5812* EFFECTIVE    NUMBER
  5813*-----------------------------------------------------------------
  5814* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5815* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  5816******************************************************************
  5817 01  ENCLOSURE-CODES.
  5818     12  NC-RECORD-ID                      PIC XX.
  5819         88  VALID-NC-ID                      VALUE 'NC'.
  5820     12  NC-CONTROL-PRIMARY.
  5821         16  NC-COMPANY-CD                 PIC X.
  5822         16  NC-REC-TYPE                   PIC X.
  5823             88  NC-CLAIMS                   VALUE '1'.
  5824             88  NC-ADMIN                    VALUE '2'.
  5825         16  NC-ENC-CODE                   PIC X(5).
  5826         16  FILLER                        PIC X(09).
  5827     12  NC-MAINT-INFORMATION.
  5828         16  NC-LAST-MAINT-DT              PIC XX.
  5829         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5830         16  NC-LAST-MAINT-USER            PIC X(4).
  5831         16  FILLER                        PIC XX.
  5832     12  NC-OUTPUT-STACK                   PIC XXX.
  5833     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5834     12  NC-ATTACHMENTS                    PIC X(255).
  5835     12  NC-FUTURE                         PIC X(12).
  5836******************************************************************
  5837 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5838                          ACCOUNT-MASTER CONTROL-FILE
  5839                          PENDING-BUSINESS CERTIFICATE-MASTER
  5840                          ORIGINAL-CERTIFICATE
  5841                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5842                          MAILING-DATA LETTER-ARCHIVE
  5843                          CERT-NOTE-FILE EOB-CODES
  5844                          CERTIFICATE-TRAILERS ENCLOSURE-CODES.
  5845 0000-DFHEXIT SECTION.
  5846     MOVE '9#                    $   ' TO DFHEIV0.
  5847     MOVE 'EL6318' TO DFHEIV1.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 103
* EL6318.cbl
  5848     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5849     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5850     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5851     MOVE '5'                    TO DC-OPTION-CODE
  5852     PERFORM 9700-DATE-LINK
  5853     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT
  5854     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT
  5855     MOVE EIBTRMID               TO QID-TERM
  5856     MOVE 2                      TO EMI-NUMBER-OF-LINES
  5857     IF EIBCALEN = 0
  5858        GO TO 8800-UNAUTHORIZED-ACCESS
  5859     END-IF
  5860     MOVE FUNCTION LENGTH(EL631KI) TO MAP-LENGTH
  5861     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5862        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5863           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5864           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5865           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5866           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5867           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5868           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5869           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5870           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5871           MOVE LOW-VALUES           TO EL631KI
  5872           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5873           GO TO 0350-BUILD-INIT-MAP
  5874        END-IF
  5875     END-IF
  5876     IF PI-CALLING-PROGRAM = 'EL614'
  5877        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5878                                 TO WS-PASSED-REASON-CODES
  5879        IF WS-PASSED-REASON-CODES NOT = SPACES
  5880           MOVE 'Y'                TO WS-SET-CODES-MDT
  5881        ELSE
  5882           MOVE 'N'                TO WS-SET-CODES-MDT
  5883        END-IF
  5884        PERFORM 0600-RECOVER-TEMP-STORAGE
  5885                                 THRU 0600-EXIT
  5886        GO TO 0350-BUILD-INIT-MAP
  5887     END-IF
  5888     IF PI-CALLING-PROGRAM = 'EL677'
  5889        move pi-el677-check-cut  to ws-el677-check-cut
  5890        move pi-el677-check-type to ws-el677-check-type
  5891        PERFORM 0600-RECOVER-TEMP-STORAGE
  5892                                 THRU 0600-EXIT
  5893        move ws-el677-check-cut  to pi-check-cut
  5894        move ws-el677-check-type to pi-check-type
  5895        GO TO 0350-BUILD-INIT-MAP
  5896     END-IF
  5897     if (eibaid = dfhclear or dfhpf23 or dfhpf24)
  5898        and (pi-check-cut = 'Y')
  5899        MOVE ER-3844             TO EMI-ERROR
  5900        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5901        GO TO 0350-BUILD-INIT-MAP
  5902     end-if
  5903     IF EIBAID = DFHCLEAR
  5904        IF PI-CLEAR-ERROR
  5905           MOVE SPACES            TO PI-CLEAR-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 104
* EL6318.cbl
  5906           MOVE ER-3833           TO EMI-ERROR
  5907           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5908           GO TO 0350-BUILD-INIT-MAP
  5909        ELSE
  5910           GO TO 9400-CLEAR
  5911        END-IF
  5912     END-IF
  5913     .
  5914 0200-RECEIVE.
  5915     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5916        MOVE ER-0008             TO EMI-ERROR
  5917        PERFORM 9900-ERROR-FORMAT
  5918                                 THRU 9900-EXIT
  5919        MOVE -1                  TO PFENTRL
  5920        GO TO 8100-SEND-INITIAL-MAP
  5921     END-IF
  5922
  5923* EXEC CICS RECEIVE
  5924*        MAP      (MAP-NAME)
  5925*        MAPSET   (MAPSET-NAME)
  5926*        INTO     (EL631KI)
  5927*    END-EXEC
  5928     MOVE LENGTH OF
  5929      EL631KI
  5930       TO DFHEIV11
  5931*    MOVE '8"T I  L              ''   #00005918' TO DFHEIV0
  5932     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5933     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5934     MOVE X'2020233030303035393138' TO DFHEIV0(25:11)
  5935     CALL 'kxdfhei1' USING DFHEIV0,
  5936           MAP-NAME,
  5937           EL631KI,
  5938           DFHEIV11,
  5939           MAPSET-NAME,
  5940           DFHEIV99,
  5941           DFHEIV99
  5942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5943     IF PFENTRL = 0
  5944         GO TO 0300-CHECK-PFKEYS
  5945     END-IF
  5946     IF EIBAID NOT = DFHENTER
  5947         MOVE ER-0004            TO EMI-ERROR
  5948         GO TO 0320-INPUT-ERROR
  5949     END-IF
  5950     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5951        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5952     ELSE
  5953        MOVE ER-0029            TO EMI-ERROR
  5954        GO TO 0320-INPUT-ERROR
  5955     END-IF
  5956     .
  5957 0300-CHECK-PFKEYS.
  5958     IF EIBAID = DFHPF3
  5959        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5960        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5961        PERFORM 0500-CREATE-TEMP-STORAGE THRU 0500-EXIT
  5962        MOVE 'EL614'             TO PGM-NAME
  5963        MOVE PI-REASON-CODE-IND  TO WS-SAVE-REASON-CODE-IND
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 105
* EL6318.cbl
  5964        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5965        move +1                  to s2
  5966        perform varying s1 from +1 by +1 until s1 > +12
  5967           if reacd-in (s1) not = spaces and low-values
  5968              move reacd-in (s1)    to pi-program-work-area (s2:4)
  5969              add +5 to s2
  5970           end-if
  5971        END-perform
  5972        MOVE WS-SAVE-REASON-CODE-IND TO PI-REASON-CODE-IND
  5973        GO TO 9300-XCTL
  5974     END-IF
  5975     IF (EIBAID = DFHPF4 OR DFHPF8)
  5976        and (vouchi = 'Y')
  5977        and (pi-check-cut not = 'Y')
  5978        MOVE ER-3845             TO EMI-ERROR
  5979        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5980        GO TO 0350-BUILD-INIT-MAP
  5981     end-if
  5982     IF EIBAID = DFHPF4 OR DFHPF8
  5983        GO TO 0360-FINALIZE
  5984     END-IF
  5985     IF (EIBAID = DFHPF5)
  5986        and (pi-endt-prm-diff > zeros)
  5987        PERFORM 0500-CREATE-TEMP-STORAGE
  5988                                 THRU 0500-EXIT
  5989        MOVE 'EL677'             TO PGM-NAME
  5990        move pi-endt-prm-diff    to pi-el677-prm-diff
  5991        move pi-endt-com-diff    to pi-el677-com-diff
  5992        move pi-check-cut        to pi-el677-check-cut
  5993        GO TO 9300-XCTL
  5994     END-IF
  5995     IF EIBAID = DFHPF23
  5996        IF PI-CLEAR-ERROR
  5997           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5998           MOVE ER-3833           TO EMI-ERROR
  5999           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6000           GO TO 0350-BUILD-INIT-MAP
  6001        ELSE
  6002           GO TO 8810-PF23
  6003        END-IF
  6004     END-IF
  6005     IF EIBAID = DFHPF24
  6006        IF PI-CLEAR-ERROR
  6007           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  6008           MOVE ER-3833           TO EMI-ERROR
  6009           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6010           GO TO 0350-BUILD-INIT-MAP
  6011        ELSE
  6012           GO TO 9200-RETURN-MAIN-MENU
  6013        END-IF
  6014     END-IF
  6015     IF EIBAID = DFHPF12
  6016        GO TO 9500-PF12
  6017     END-IF
  6018     IF EIBAID = DFHENTER
  6019        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  6020        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  6021        GO TO 0330-CHECK-ERRORS
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 106
* EL6318.cbl
  6022     END-IF
  6023     MOVE ER-0029                TO EMI-ERROR
  6024     .
  6025 0320-INPUT-ERROR.
  6026     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6027     MOVE AL-UNBON               TO PFENTRA
  6028     MOVE -1                     TO PFENTRL
  6029     GO TO 8200-SEND-DATAONLY
  6030     .
  6031 0325-EDIT-SCREEN.
  6032     IF PRTSWL > ZEROS
  6033       IF PRTSWI = 'Y' OR 'N' OR 'P' OR ' '
  6034*          MOVE AL-UANON       TO PRTSWA
  6035*          IF PRTSWI = ' '
  6036*             MOVE 'N'         TO PRTSWI
  6037              MOVE 'P'         TO PRTSWI
  6038*          END-IF
  6039*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  6040        END-IF
  6041     END-IF
  6042     IF LTRIDL > ZEROS
  6043        AND LTRIDI > SPACES
  6044        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  6045        MOVE LTRIDI              TO LETR-LETTER-ID
  6046                                    PI-LTRID-ENTERED
  6047        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  6048        MOVE SPACES              TO LETR-FILLER
  6049        MOVE 0                   TO LETR-SEQ-NO
  6050        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  6051     ELSE
  6052        MOVE ER-1236          TO EMI-ERROR
  6053        MOVE -1               TO LTRIDL
  6054        MOVE AL-UABON         TO LTRIDA
  6055        PERFORM 9900-ERROR-FORMAT
  6056                                 THRU 9900-EXIT
  6057     END-IF
  6058
  6059     IF W-SIG-FLAG-DEFAULT > ' '
  6060        IF (SIGREQL > ZERO AND SIGREQI <> W-SIG-FLAG-DEFAULT)
  6061             MOVE W-SIG-FLAG-DEFAULT TO SIGREQI
  6062             MOVE +1 TO SIGREQL
  6063             MOVE ER-1664     TO EMI-ERROR
  6064             MOVE AL-UABON    TO SIGREQA
  6065             PERFORM 9900-ERROR-FORMAT
  6066                                 THRU 9900-EXIT
  6067        ELSE
  6068             MOVE W-SIG-FLAG-DEFAULT TO SIGREQI
  6069             MOVE +1 TO SIGREQL
  6070             MOVE AL-UANON    TO SIGREQA
  6071        END-IF
  6072     END-IF
  6073
  6074     IF (SIGREQL > ZEROS)
  6075        AND (SIGREQI = 'Y' OR 'N' OR ' ')
  6076        MOVE AL-UANON         TO SIGREQA
  6077        IF SIGREQI = ' '
  6078           MOVE 'N'           TO SIGREQI
  6079        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 107
* EL6318.cbl
  6080        MOVE SIGREQI          TO PI-SIGREQ-ENTERED
  6081     ELSE
  6082        MOVE ER-2651          TO EMI-ERROR
  6083        MOVE -1               TO SIGREQL
  6084        MOVE AL-UABON         TO SIGREQA
  6085        PERFORM 9900-ERROR-FORMAT
  6086                                 THRU 9900-EXIT
  6087     END-IF
  6088
  6089     IF W-PROMPT-LETTER EQUAL 'Y'
  6090         MOVE ER-0894            TO EMI-ERROR
  6091         MOVE -1                 TO LTRIDL
  6092         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6093     END-IF
  6094     IF VOUCHL > ZEROS
  6095        IF VOUCHI = 'Y' OR 'N'
  6096           MOVE AL-UANON         TO VOUCHA
  6097           MOVE VOUCHI           TO PI-VOUCHER-ENTERED
  6098        ELSE
  6099           MOVE ER-9999          TO EMI-ERROR
  6100           MOVE -1               TO VOUCHL
  6101           MOVE AL-UABON         TO VOUCHA
  6102           PERFORM 9900-ERROR-FORMAT
  6103                                 THRU 9900-EXIT
  6104        END-IF
  6105     END-IF
  6106     IF HLTHAPPL > ZEROS
  6107        IF HLTHAPPI = 'Y' OR 'N'
  6108           MOVE AL-UANON         TO HLTHAPPA
  6109           MOVE HLTHAPPI         TO PI-HLTHAPP-ENTERED
  6110        ELSE
  6111           MOVE ER-9999          TO EMI-ERROR
  6112           MOVE -1               TO HLTHAPPL
  6113           MOVE AL-UABON         TO HLTHAPPA
  6114           PERFORM 9900-ERROR-FORMAT
  6115                                 THRU 9900-EXIT
  6116        END-IF
  6117     END-IF
  6118     IF PAYEEL > ZEROS
  6119        IF PAYEEI > SPACES
  6120           MOVE AL-UANON         TO PAYEEA
  6121           MOVE PAYEEI           TO PI-PAYEE-ENTERED
  6122        ELSE
  6123           MOVE ER-9999          TO EMI-ERROR
  6124           MOVE -1               TO PAYEEL
  6125           MOVE AL-UABON         TO PAYEEA
  6126           PERFORM 9900-ERROR-FORMAT
  6127                                 THRU 9900-EXIT
  6128        END-IF
  6129     END-IF
  6130     IF CERTIDL > ZEROS
  6131         IF CERTIDI NUMERIC
  6132            MOVE AL-UANON      TO CERTIDA
  6133            MOVE CERTIDI       TO PI-CERTID-ENTERED
  6134         ELSE
  6135            MOVE ER-1778       TO EMI-ERROR
  6136            MOVE -1            TO CERTIDL
  6137            MOVE AL-UABON      TO CERTIDA
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 108
* EL6318.cbl
  6138            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6139        END-IF
  6140     ELSE
  6141        IF PI-PRINT-CERTIFICATE = 'Y'
  6142            MOVE ER-0715       TO EMI-ERROR
  6143            MOVE -1            TO CERTIDL
  6144            MOVE AL-UABON      TO CERTIDA
  6145            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6146        END-IF
  6147     END-IF
  6148
  6149     IF ENCCODEL > ZEROS
  6150        MOVE FUNCTION UPPER-CASE(ENCCODEI) TO ENCCODEI
  6151                                              PI-ENCCODE
  6152        MOVE SPACES             TO WS-ELENCC-KEY
  6153        MOVE PI-COMPANY-CD      TO WS-ENCC-COMPANY-CD
  6154        MOVE '2'                TO WS-ENCC-REC-TYPE
  6155        MOVE ENCCODEI           TO WS-ENCC-ENC-CODE
  6156
  6157
  6158* EXEC CICS READ
  6159*           DATASET    (WS-ELENCC-FILE-ID)
  6160*           SET        (ADDRESS OF ENCLOSURE-CODES)
  6161*           RIDFLD     (WS-ELENCC-KEY)
  6162*           RESP       (WS-RESPONSE)
  6163*       END-EXEC
  6164*    MOVE '&"S        E          (  N#00006137' TO DFHEIV0
  6165     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6166     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6167     MOVE X'204E233030303036313337' TO DFHEIV0(25:11)
  6168     CALL 'kxdfhei1' USING DFHEIV0,
  6169           WS-ELENCC-FILE-ID,
  6170           DFHEIV20,
  6171           DFHEIV99,
  6172           WS-ELENCC-KEY,
  6173           DFHEIV99,
  6174           DFHEIV99,
  6175           DFHEIV99
  6176     SET ADDRESS OF ENCLOSURE-CODES TO
  6177         DFHEIV20
  6178     MOVE EIBRESP  TO WS-RESPONSE
  6179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6180
  6181        IF RESP-NORMAL
  6182           MOVE ENCCODEI         TO PI-ENCCODE
  6183                                    W-ENCLOSURE-CD
  6184           MOVE AL-UANON         TO ENCCODEA
  6185        ELSE
  6186           MOVE ER-1560          TO EMI-ERROR
  6187           MOVE -1               TO ENCCODEL
  6188           MOVE AL-UABON         TO ENCCODEA
  6189           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6190        END-IF
  6191     END-IF
  6192
  6193     SET REASONS-NOT-FOUND TO TRUE
  6194     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6195        IF REACDL (S1) = +4 OR
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 109
* EL6318.cbl
  6196          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6197              MOVE AL-SANON     TO REACDA (S1)
  6198              SET REASONS-FOUND TO TRUE
  6199        END-IF
  6200     END-PERFORM
  6201
  6202     IF REASONS-NOT-FOUND
  6203        MOVE ER-1820             TO EMI-ERROR
  6204        MOVE -1                  TO PFENTRL
  6205        PERFORM 9900-ERROR-FORMAT
  6206                                 THRU 9900-EXIT
  6207     ELSE
  6208        MOVE REASONCDS           TO PI-REASONS-ENTERED
  6209     END-IF
  6210
  6211     IF CRTNT1L > ZEROS
  6212        IF CRTNT1I > SPACES
  6213           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  6214        END-IF
  6215     END-IF
  6216
  6217     IF CRTNT2L > ZEROS
  6218        IF CRTNT2I > SPACES
  6219           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  6220        END-IF
  6221     END-IF
  6222
  6223     IF CRTNT3L > ZEROS
  6224        IF CRTNT3I > SPACES
  6225           MOVE CRTNT3I          TO PI-CERTNT3-ENTERED
  6226        END-IF
  6227     END-IF
  6228
  6229     IF CRTNT4L > ZEROS
  6230        IF CRTNT4I > SPACES
  6231           MOVE CRTNT4I          TO PI-CERTNT4-ENTERED
  6232        END-IF
  6233     END-IF
  6234
  6235     IF BILNT1L > ZEROS
  6236        IF BILNT1I > SPACES
  6237           MOVE BILNT1I          TO PI-BILLNT1-ENTERED
  6238        END-IF
  6239     END-IF
  6240
  6241     IF BILNT2L > ZEROS
  6242        IF BILNT2I > SPACES
  6243           MOVE BILNT2I          TO PI-BILLNT2-ENTERED
  6244        END-IF
  6245     END-IF
  6246
  6247     .
  6248 0325-EXIT.
  6249     EXIT.
  6250
  6251 0326-GET-Z-RECORD.
  6252
  6253     MOVE SPACES  TO W-Z-CONTROL-DATA
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 110
* EL6318.cbl
  6254
  6255
  6256* EXEC CICS STARTBR
  6257*         DATASET    ('ELLETR')
  6258*         RIDFLD     (ELLETR-KEY)
  6259*         GTEQ
  6260*         RESP      (WS-RESPONSE)
  6261*    END-EXEC.
  6262     MOVE 'ELLETR' TO DFHEIV1
  6263     MOVE 0
  6264       TO DFHEIV11
  6265*    MOVE '&,         G          &  N#00006218' TO DFHEIV0
  6266     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6267     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6268     MOVE X'204E233030303036323138' TO DFHEIV0(25:11)
  6269     CALL 'kxdfhei1' USING DFHEIV0,
  6270           DFHEIV1,
  6271           ELLETR-KEY,
  6272           DFHEIV99,
  6273           DFHEIV11,
  6274           DFHEIV99
  6275     MOVE EIBRESP  TO WS-RESPONSE
  6276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6277
  6278     IF NOT RESP-NORMAL
  6279         MOVE ER-1236          TO EMI-ERROR
  6280         MOVE -1               TO LTRIDL
  6281         MOVE AL-UABON         TO LTRIDA
  6282         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6283         GO TO 0326-ENDBR
  6284     END-IF.
  6285
  6286 0326-READNEXT.
  6287
  6288
  6289* EXEC CICS READNEXT
  6290*        DATASET   ('ELLETR')
  6291*        INTO      (TEXT-FILES)
  6292*        RIDFLD    (ELLETR-KEY)
  6293*        RESP      (WS-RESPONSE)
  6294*    END-EXEC
  6295     MOVE LENGTH OF
  6296      TEXT-FILES
  6297       TO DFHEIV12
  6298     MOVE 'ELLETR' TO DFHEIV1
  6299     MOVE 0
  6300       TO DFHEIV11
  6301*    MOVE '&.IL                  )  N#00006234' TO DFHEIV0
  6302     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6303     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6304     MOVE X'204E233030303036323334' TO DFHEIV0(25:11)
  6305     CALL 'kxdfhei1' USING DFHEIV0,
  6306           DFHEIV1,
  6307           TEXT-FILES,
  6308           DFHEIV12,
  6309           ELLETR-KEY,
  6310           DFHEIV99,
  6311           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 111
* EL6318.cbl
  6312           DFHEIV99,
  6313           DFHEIV99
  6314     MOVE EIBRESP  TO WS-RESPONSE
  6315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6316     IF RESP-NORMAL
  6317        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  6318           MOVE ER-1236          TO EMI-ERROR
  6319           MOVE -1               TO LTRIDL
  6320           MOVE AL-UABON         TO LTRIDA
  6321           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6322           GO TO 0326-ENDBR
  6323        END-IF
  6324
  6325        MOVE AL-UANON         TO LTRIDA
  6326        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  6327           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  6328        ELSE
  6329           GO TO 0326-READNEXT
  6330        END-IF
  6331     ELSE
  6332        MOVE ER-1236          TO EMI-ERROR
  6333        MOVE -1               TO LTRIDL
  6334        MOVE AL-UABON         TO LTRIDA
  6335        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6336        GO TO 0326-ENDBR
  6337     END-IF.
  6338
  6339     MOVE W-PRINT-CERTIFICATE TO PI-PRINT-CERTIFICATE.
  6340     IF PI-ENCCODE NOT GREATER THAN SPACES
  6341         MOVE W-ENCLOSURE-CD            TO PI-ENCCODE
  6342                                           ENCCODEO
  6343         MOVE AL-UANON                  TO ENCCODEA
  6344         MOVE +3                        TO ENCCODEL
  6345     END-IF.
  6346
  6347 0326-ENDBR.
  6348
  6349
  6350* EXEC CICS ENDBR
  6351*        DATASET     ('ELLETR')
  6352*    END-EXEC.
  6353     MOVE 'ELLETR' TO DFHEIV1
  6354     MOVE 0
  6355       TO DFHEIV11
  6356*    MOVE '&2                    $   #00006273' TO DFHEIV0
  6357     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6358     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6359     MOVE X'2020233030303036323733' TO DFHEIV0(25:11)
  6360     CALL 'kxdfhei1' USING DFHEIV0,
  6361           DFHEIV1,
  6362           DFHEIV11,
  6363           DFHEIV99
  6364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6365
  6366
  6367 0326-EXIT.
  6368      EXIT.
  6369 0330-CHECK-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 112
* EL6318.cbl
  6370     IF EMI-NO-ERRORS
  6371        GO TO 0350-BUILD-INIT-MAP
  6372     ELSE
  6373        GO TO 8200-SEND-DATAONLY
  6374     END-IF
  6375     .
  6376 0330-EXIT.
  6377     EXIT.
  6378 0350-BUILD-INIT-MAP.
  6379     IF PI-RETURN-TO-PROGRAM = 'EL6314'
  6380        MOVE PI-COMPANY-CD          TO CRTO-COMPANY-CD
  6381        MOVE PI-CARRIER             TO CRTO-CARRIER
  6382        MOVE PI-GROUPING            TO CRTO-GROUPING
  6383        MOVE PI-STATE               TO CRTO-STATE
  6384        MOVE PI-ACCOUNT             TO CRTO-ACCOUNT
  6385        MOVE PI-CERT-PRIME          TO CRTO-CERT-PRIME
  6386        MOVE PI-CERT-SFX            TO CRTO-CERT-SFX
  6387        MOVE PI-CERT-EFF-DT         TO CRTO-CERT-EFF-DT
  6388        MOVE 'I'                    TO CRTO-RECORD-TYPE
  6389        MOVE ZEROS                  TO CRTO-SEQ-NO
  6390        MOVE ELCRTO-KEY             TO PI-ELCRTO-KEY
  6391                                       PI-ERENDT-KEY
  6392     END-IF
  6393     MOVE PI-CRTO-CARRIER        TO CARRO
  6394     MOVE PI-CRTO-GROUPING       TO GROUPO
  6395     MOVE PI-CRTO-STATE          TO STATEO
  6396     MOVE PI-CRTO-ACCOUNT        TO ACCTO
  6397     MOVE PI-CRTO-CERT-PRIME     TO CERTNOO
  6398     MOVE PI-CRTO-CERT-SFX       TO CRTSFXO
  6399     MOVE PI-CRTO-SEQ-NO         TO SEQNOO
  6400     MOVE PI-CRTO-CERT-EFF-DT    TO DC-BIN-DATE-1
  6401     MOVE ' '                    TO DC-OPTION-CODE
  6402     PERFORM 9700-DATE-LINK
  6403     IF NO-CONVERSION-ERROR
  6404        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6405     END-IF
  6406*     IF PI-PRTSW-ENTERED > SPACES
  6407*        MOVE PI-PRTSW-ENTERED    TO PRTSWI
  6408*        MOVE AL-UANON            TO PRTSWA
  6409*        MOVE +1                  TO PRTSWL
  6410*     END-IF
  6411
  6412     IF PI-SIGREQ-ENTERED > SPACES
  6413        MOVE PI-SIGREQ-ENTERED   TO SIGREQI
  6414        MOVE AL-UANON            TO SIGREQA
  6415        MOVE +1                  TO SIGREQL
  6416     ELSE
  6417        IF PI-CLAIM-REFORMATION
  6418            MOVE 'Y'             TO SIGREQI
  6419            MOVE AL-UANON        TO SIGREQA
  6420            MOVE +1              TO SIGREQL
  6421        END-IF
  6422     END-IF
  6423
  6424     IF PI-LTRID-ENTERED > SPACES
  6425        MOVE PI-LTRID-ENTERED    TO LTRIDI
  6426        MOVE AL-UANON            TO LTRIDA
  6427        MOVE +4                  TO LTRIDL
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 113
* EL6318.cbl
  6428     ELSE
  6429        IF PI-CLAIM-REFORMATION
  6430            MOVE 'CLRF'          TO LTRIDI
  6431            MOVE AL-UANON        TO LTRIDA
  6432            MOVE +4              TO LTRIDL
  6433        END-IF
  6434     END-IF
  6435
  6436     if pi-endt-prm-diff > zeros
  6437        move 'Y'                 to vouchi
  6438        MOVE AL-UANON            TO VOUCHA
  6439        MOVE +1                  TO VOUCHL
  6440     END-IF
  6441     IF PI-VOUCHER-ENTERED > SPACES
  6442        MOVE PI-VOUCHER-ENTERED  TO VOUCHI
  6443        MOVE AL-UANON            TO VOUCHA
  6444        MOVE +1                  TO VOUCHL
  6445     END-IF
  6446     IF PI-HLTHAPP-ENTERED > SPACES
  6447        MOVE PI-HLTHAPP-ENTERED  TO HLTHAPPI
  6448        MOVE AL-UANON            TO HLTHAPPA
  6449        MOVE +1                  TO HLTHAPPL
  6450     END-IF
  6451
  6452     IF PI-PAYEE-ENTERED > SPACES
  6453        MOVE PI-PAYEE-ENTERED    TO PAYEEI
  6454        MOVE AL-UANON            TO PAYEEA
  6455        MOVE +10                 TO PAYEEL
  6456     END-IF
  6457
  6458     IF PI-CERTID-ENTERED > SPACES
  6459        MOVE PI-CERTID-ENTERED   TO CERTIDI
  6460        MOVE AL-UANON            TO CERTIDA
  6461        MOVE +5                  TO CERTIDL
  6462     END-IF
  6463
  6464     IF PI-ENCCODE > SPACES
  6465        MOVE PI-ENCCODE          TO ENCCODEI
  6466        MOVE AL-UANON            TO ENCCODEA
  6467        MOVE +3                  TO ENCCODEL
  6468     END-IF
  6469
  6470     SET REASONS-NOT-FOUND TO TRUE
  6471     MOVE PI-REASONS-ENTERED     TO REASONCDS
  6472     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6473        IF REACDL (S1) = +4 OR
  6474          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6475              MOVE AL-SANON      TO REACDA (S1)
  6476              MOVE +4            TO REACDL (S1)
  6477              SET REASONS-FOUND  TO TRUE
  6478        END-IF
  6479     END-PERFORM
  6480
  6481     IF REASONS-NOT-FOUND
  6482         IF PI-CLAIM-REFORMATION
  6483            MOVE 'CRNA'          TO REACD-IN (1)
  6484            MOVE AL-SANON        TO REACDA (1)
  6485            MOVE +4              TO REACDL (1)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 114
* EL6318.cbl
  6486            SET REASONS-FOUND    TO TRUE
  6487        END-IF
  6488     END-IF
  6489
  6490     IF PI-CERTNT1-ENTERED > SPACES
  6491        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6492        MOVE AL-UANON            TO CRTNT1A
  6493        MOVE +63                 TO CRTNT1L
  6494     END-IF
  6495
  6496     IF PI-CERTNT2-ENTERED > SPACES
  6497        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  6498        MOVE AL-UANON            TO CRTNT2A
  6499        MOVE +63                 TO CRTNT2L
  6500     END-IF
  6501
  6502     IF PI-CERTNT3-ENTERED > SPACES
  6503        MOVE PI-CERTNT3-ENTERED  TO CRTNT3I
  6504        MOVE AL-UANON            TO CRTNT3A
  6505        MOVE +63                 TO CRTNT3L
  6506     END-IF
  6507
  6508     IF PI-CERTNT4-ENTERED > SPACES
  6509        MOVE PI-CERTNT4-ENTERED  TO CRTNT4I
  6510        MOVE AL-UANON            TO CRTNT4A
  6511        MOVE +63                 TO CRTNT4L
  6512     END-IF
  6513
  6514     IF PI-BILLNT1-ENTERED > SPACES
  6515        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  6516        MOVE AL-UANON            TO BILNT1A
  6517        MOVE +63                 TO BILNT1L
  6518     END-IF
  6519
  6520     IF PI-BILLNT2-ENTERED > SPACES
  6521        MOVE PI-BILLNT2-ENTERED  TO BILNT2I
  6522        MOVE AL-UANON            TO BILNT2A
  6523        MOVE +63                 TO BILNT2L
  6524     END-IF
  6525
  6526     GO TO 8100-SEND-INITIAL-MAP
  6527     .
  6528 0360-FINALIZE.
  6529     set P to address of KIXSYS
  6530     CALL "getenv" using by value P returning var-ptr
  6531     if var-ptr = null then
  6532        display ' kixsys not set '
  6533     else
  6534        set address of var to var-ptr
  6535        move 0 to env-var-len
  6536        inspect var tallying env-var-len
  6537          for characters before X'00'
  6538*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  6539        unstring var (1:env-var-len) delimited by '/'
  6540           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  6541              WS-KIX-SYS
  6542        end-unstring
  6543*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 115
* EL6318.cbl
  6544*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  6545     end-if
  6546     set P to address of KIXHOST
  6547     CALL "getenv" using by value P returning var-ptr
  6548     if var-ptr = null then
  6549        display ' kixhost not set '
  6550     else
  6551        set address of var to var-ptr
  6552        move 0 to env-var-len
  6553        inspect var tallying env-var-len
  6554          for characters before X'00'
  6555*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  6556        MOVE var(1:env-var-len)  to ws-kixhost
  6557        DISPLAY ' WS KIX HOST ' WS-KIXhost
  6558     end-if
  6559     PERFORM 0325-EDIT-SCREEN    THRU 0325-EXIT
  6560     IF NOT EMI-NO-ERRORS
  6561       AND EIBAID = DFHPF4
  6562        GO TO 8200-SEND-DATAONLY
  6563     END-IF
  6564     MOVE LOW-VALUES             TO NEW-ELCRTO-REC
  6565     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  6566                                    NEW-ELCRTO-KEY
  6567     SUBTRACT +1               FROM NCRTO-SEQ-NO
  6568     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  6569     IF RESP-NORMAL
  6570       AND (PI-ELCRTO-KEY (1:33) = OC-CONTROL-PRIMARY (1:33))
  6571        MOVE OC-KEY-SEQ-NO       TO CRTO-SEQ-NO
  6572                                    PI-CRTO-SEQ-NO
  6573        MOVE LOW-VALUES          TO NEW-ELCRTO-REC
  6574        MOVE PI-ELCRTO-KEY       TO NEW-ELCRTO-KEY
  6575        SUBTRACT +1              FROM NCRTO-SEQ-NO
  6576        PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  6577*       PERFORM 1000-BUILD-ERARCH THRU 1000-EXIT
  6578        PERFORM 1100-CALL-NS-BUS-LOGIC
  6579                                 THRU 1100-EXIT
  6580        IF BL-OK
  6581           CONTINUE
  6582        ELSE
  6583           MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  6584           MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  6585           MOVE -1               TO SIGREQL
  6586        END-IF
  6587        IF EIBAID = DFHPF4
  6588           move ' '              to ws-elcrtt-update-sw
  6589           move pi-elcrto-key(1:33)
  6590                                 to ws-elcrtt-primary
  6591           move 'C'              to ws-elcrtt-rec-type
  6592
  6593* EXEC CICS READ UPDATE
  6594*             DATASET  (WS-ELCRTT-FILE-ID)
  6595*             RIDFLD   (WS-ELCRTT-KEY)
  6596*             SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  6597*             RESP     (WS-RESPONSE)
  6598*          END-EXEC
  6599*    MOVE '&"S        EU         (  N#00006502' TO DFHEIV0
  6600     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6601     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 116
* EL6318.cbl
  6602     MOVE X'204E233030303036353032' TO DFHEIV0(25:11)
  6603     CALL 'kxdfhei1' USING DFHEIV0,
  6604           WS-ELCRTT-FILE-ID,
  6605           DFHEIV20,
  6606           DFHEIV99,
  6607           WS-ELCRTT-KEY,
  6608           DFHEIV99,
  6609           DFHEIV99,
  6610           DFHEIV99
  6611     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  6612         DFHEIV20
  6613     MOVE EIBRESP  TO WS-RESPONSE
  6614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6615           if resp-normal
  6616              if cs-claim-verification-status = 'B' or 'C'
  6617                 or 'D' or 'E' or 'F' or 'G'
  6618                 move 'H'        to cs-claim-verification-status
  6619                 set update-elcrtt to true
  6620              end-if
  6621              if update-elcrtt
  6622
  6623* EXEC CICS REWRITE
  6624*                   DATASET    (ws-elcrtt-FILE-ID)
  6625*                   FROM       (CERTIFICATE-TRAILERS)
  6626*                END-EXEC
  6627     MOVE LENGTH OF
  6628      CERTIFICATE-TRAILERS
  6629       TO DFHEIV11
  6630*    MOVE '&& L                  %   #00006515' TO DFHEIV0
  6631     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6632     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6633     MOVE X'2020233030303036353135' TO DFHEIV0(25:11)
  6634     CALL 'kxdfhei1' USING DFHEIV0,
  6635           ws-elcrtt-FILE-ID,
  6636           CERTIFICATE-TRAILERS,
  6637           DFHEIV11,
  6638           DFHEIV99
  6639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6640              else
  6641
  6642* exec cics unlock
  6643*                   dataset    (ws-elcrtt-FILE-ID)
  6644*                end-exec
  6645*    MOVE '&*                    #   #00006520' TO DFHEIV0
  6646     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  6647     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6648     MOVE X'2020233030303036353230' TO DFHEIV0(25:11)
  6649     CALL 'kxdfhei1' USING DFHEIV0,
  6650           ws-elcrtt-FILE-ID,
  6651           DFHEIV99
  6652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6653              end-if
  6654           end-if
  6655        end-if
  6656     ELSE
  6657        MOVE ER-9999             TO EMI-ERROR
  6658        PERFORM 9900-ERROR-FORMAT
  6659                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 117
* EL6318.cbl
  6660        MOVE -1                  TO SIGREQL
  6661        GO TO 8100-SEND-INITIAL-MAP
  6662     END-IF
  6663     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  6664                                 TO SYSO
  6665     MOVE WS-KIXHOST             TO HOSTO
  6666     MOVE PI-COMPANY-ID          TO COMPANYO
  6667     IF PI-RETURN-TO-PROGRAM = 'EL6314'
  6668         MOVE '2'                TO DATASORO
  6669     ELSE
  6670         MOVE '4'                TO DATASORO
  6671     END-IF
  6672     MOVE BL-BATCH-NO            TO BATCHNOO
  6673     MOVE BL-BATCH-SEQ           TO BSEQNOO
  6674     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  6675     MOVE PI-PROCESSOR-ID        TO PROCIDO
  6676*    MOVE 'N'                    TO PRTSWO
  6677*    MOVE -1                     TO PRTSWL
  6678*    MOVE AL-UANON               TO PRTSWA
  6679     MOVE -1                     TO SIGREQL
  6680     MOVE AL-UANON               TO SIGREQA
  6681     IF EIBAID = DFHPF4
  6682        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  6683        MOVE ER-0280             TO EMI-ERROR
  6684        PERFORM 9900-ERROR-FORMAT
  6685                                 THRU 9900-EXIT
  6686        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  6687        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  6688        MOVE 'Y'                 TO PI-FINALIZED-IND
  6689        GO TO 9400-CLEAR
  6690     ELSE
  6691        MOVE ER-1818             TO EMI-ERROR
  6692        PERFORM 9900-ERROR-FORMAT
  6693                                 THRU 9900-EXIT
  6694     END-IF
  6695     GO TO 0350-BUILD-INIT-MAP
  6696     .
  6697 0360-EXIT.
  6698     EXIT.
  6699 0362-READ-ELCRTO.
  6700
  6701* EXEC CICS READ
  6702*        DATASET   (WS-ELCRTO-FILE-ID)
  6703*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6704*        RIDFLD    (ELCRTO-KEY)
  6705*        GTEQ
  6706*        RESP      (WS-RESPONSE)
  6707*    END-EXEC
  6708*    MOVE '&"S        G          (  N#00006570' TO DFHEIV0
  6709     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6710     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6711     MOVE X'204E233030303036353730' TO DFHEIV0(25:11)
  6712     CALL 'kxdfhei1' USING DFHEIV0,
  6713           WS-ELCRTO-FILE-ID,
  6714           DFHEIV20,
  6715           DFHEIV99,
  6716           ELCRTO-KEY,
  6717           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 118
* EL6318.cbl
  6718           DFHEIV99,
  6719           DFHEIV99
  6720     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6721         DFHEIV20
  6722     MOVE EIBRESP  TO WS-RESPONSE
  6723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6724     .
  6725 0362-EXIT.
  6726     EXIT.
  6727 0363-READ-ELCRTO-UPD.
  6728
  6729* EXEC CICS READ
  6730*        DATASET   (WS-ELCRTO-FILE-ID)
  6731*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6732*        RIDFLD    (ELCRTO-KEY)
  6733*        UPDATE
  6734*        RESP      (WS-RESPONSE)
  6735*    END-EXEC
  6736*    MOVE '&"S        EU         (  N#00006581' TO DFHEIV0
  6737     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6738     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6739     MOVE X'204E233030303036353831' TO DFHEIV0(25:11)
  6740     CALL 'kxdfhei1' USING DFHEIV0,
  6741           WS-ELCRTO-FILE-ID,
  6742           DFHEIV20,
  6743           DFHEIV99,
  6744           ELCRTO-KEY,
  6745           DFHEIV99,
  6746           DFHEIV99,
  6747           DFHEIV99
  6748     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6749         DFHEIV20
  6750     MOVE EIBRESP  TO WS-RESPONSE
  6751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6752     .
  6753 0363-EXIT.
  6754     EXIT.
  6755 0365-READ-ERENDT.
  6756
  6757* EXEC CICS READ
  6758*        DATASET   (WS-ERENDT-FILE-ID)
  6759*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  6760*        RIDFLD    (ERENDT-KEY)
  6761*        RESP      (WS-RESPONSE)
  6762*    END-EXEC
  6763*    MOVE '&"S        E          (  N#00006592' TO DFHEIV0
  6764     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6765     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6766     MOVE X'204E233030303036353932' TO DFHEIV0(25:11)
  6767     CALL 'kxdfhei1' USING DFHEIV0,
  6768           WS-ERENDT-FILE-ID,
  6769           DFHEIV20,
  6770           DFHEIV99,
  6771           ERENDT-KEY,
  6772           DFHEIV99,
  6773           DFHEIV99,
  6774           DFHEIV99
  6775     SET ADDRESS OF ENDORSEMENT-RECORD TO
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 119
* EL6318.cbl
  6776         DFHEIV20
  6777     MOVE EIBRESP  TO WS-RESPONSE
  6778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6779     .
  6780 0365-EXIT.
  6781     EXIT.
  6782 0400-ADD-ERENDT.
  6783     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6784
  6785* EXEC CICS GETMAIN
  6786*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6787*         LENGTH   (ERENDT-LENGTH)
  6788*         INITIMG  (GETMAIN-SPACE)
  6789*    END-EXEC
  6790*    MOVE ',"IL                  $   #00006603' TO DFHEIV0
  6791     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6792     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6793     MOVE X'2020233030303036363033' TO DFHEIV0(25:11)
  6794     CALL 'kxdfhei1' USING DFHEIV0,
  6795           DFHEIV20,
  6796           ERENDT-LENGTH,
  6797           GETMAIN-SPACE
  6798     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6799         DFHEIV20
  6800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6801     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6802     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6803     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6804     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6805                                    EN-INPUT-DT
  6806                                    EN-PROCESS-DT
  6807
  6808     MOVE OC-INS-FIRST-NAME    TO EN-INS-ORIG-FIRST-NAME
  6809     MOVE OC-INS-MIDDLE-INIT   TO EN-INS-ORIG-MIDDLE-INIT
  6810     MOVE OC-INS-LAST-NAME     TO EN-INS-ORIG-LAST-NAME
  6811     MOVE OC-INS-AGE           TO EN-INS-ORIG-AGE
  6812     MOVE OC-INS-AGE-DEFAULT-FLAG TO EN-INS-ORIG-AGE-DEF-FLAG
  6813     MOVE OC-JNT-FIRST-NAME    TO EN-JNT-ORIG-FIRST-NAME
  6814     MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-ORIG-MIDDLE-INIT
  6815     MOVE OC-JNT-LAST-NAME     TO EN-JNT-ORIG-LAST-NAME
  6816     MOVE OC-JNT-AGE           TO EN-JNT-ORIG-AGE
  6817     MOVE OC-JNT-AGE-DEFAULT-FLAG TO EN-JNT-ORIG-AGE-DEF-FLAG
  6818     MOVE OC-LF-BENCD          TO EN-LF-ORIG-BENCD
  6819     IF OC-LF-BENCD NOT = '00' AND '  '
  6820        MOVE OC-LF-BEN-AMT       TO EN-LF-ORIG-BEN-AMT
  6821        MOVE OC-LF-PRM-AMT       TO EN-LF-ORIG-PRM-AMT
  6822        MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-ORIG-ALT-BEN-AMT
  6823        MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-ORIG-ALT-PRM-AMT
  6824        MOVE OC-LF-TERM          TO EN-LF-ORIG-TERM
  6825        MOVE OC-LF-EXP-DT        TO EN-LF-ORIG-EXP-DT
  6826        MOVE OC-LF-COMM-PCT      TO EN-LF-ORIG-COMM-PCT
  6827     END-IF
  6828     MOVE OC-AH-BENCD          TO EN-AH-ORIG-BENCD
  6829     IF OC-AH-BENCD NOT = '00' AND '  '
  6830        MOVE OC-AH-BEN-AMT       TO EN-AH-ORIG-BEN-AMT
  6831        MOVE OC-AH-PRM-AMT       TO EN-AH-ORIG-PRM-AMT
  6832        MOVE OC-AH-TERM          TO EN-AH-ORIG-TERM
  6833        MOVE OC-AH-EXP-DT        TO EN-AH-ORIG-EXP-DT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 120
* EL6318.cbl
  6834        MOVE OC-AH-CP            TO EN-AH-ORIG-CP
  6835        MOVE OC-AH-COMM-PCT      TO EN-AH-ORIG-COMM-PCT
  6836     END-IF
  6837     MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6838
  6839     IF PI-RETURN-TO-PROGRAM EQUAL 'EL6314'
  6840
  6841         MOVE PI-COMPANY-CD       TO  W-CERT-COMPANY-CD
  6842         MOVE PI-CRTO-CARRIER     TO  W-CERT-CARRIER
  6843         MOVE PI-CRTO-GROUPING    TO  W-CERT-GROUPING
  6844         MOVE PI-CRTO-STATE       TO  W-CERT-STATE
  6845         MOVE PI-CRTO-ACCOUNT     TO  W-CERT-ACCOUNT
  6846         MOVE PI-CRTO-CERT-EFF-DT TO  W-CERT-CERT-EFF-DT
  6847         MOVE PI-CRTO-CERT-PRIME  TO  W-CERT-CERT-PRIME
  6848         MOVE PI-CRTO-CERT-SFX    TO  W-CERT-CERT-SFX
  6849
  6850
  6851* EXEC CICS READ
  6852*            DATASET  (WS-ELCERT-FILE-ID)
  6853*            RIDFLD   (WS-ELCERT-KEY)
  6854*            SET      (ADDRESS OF CERTIFICATE-MASTER)
  6855*            RESP     (WS-RESPONSE)
  6856*        END-EXEC
  6857*    MOVE '&"S        E          (  N#00006657' TO DFHEIV0
  6858     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6859     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6860     MOVE X'204E233030303036363537' TO DFHEIV0(25:11)
  6861     CALL 'kxdfhei1' USING DFHEIV0,
  6862           WS-ELCERT-FILE-ID,
  6863           DFHEIV20,
  6864           DFHEIV99,
  6865           WS-ELCERT-KEY,
  6866           DFHEIV99,
  6867           DFHEIV99,
  6868           DFHEIV99
  6869     SET ADDRESS OF CERTIFICATE-MASTER TO
  6870         DFHEIV20
  6871     MOVE EIBRESP  TO WS-RESPONSE
  6872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6873         IF NOT RESP-NORMAL
  6874            GO TO 0400-EXIT
  6875         END-IF
  6876
  6877         MOVE CM-INSURED-FIRST-NAME TO EN-INS-NEW-FIRST-NAME
  6878                                       NCRTO-INS-FIRST-NAME
  6879         MOVE CM-INSURED-INITIAL2   TO EN-INS-NEW-MIDDLE-INIT
  6880                                       NCRTO-INS-MIDDLE-INIT
  6881         MOVE CM-INSURED-LAST-NAME  TO EN-INS-NEW-LAST-NAME
  6882                                       NCRTO-INS-LAST-NAME
  6883         MOVE CM-INSURED-ISSUE-AGE  TO EN-INS-NEW-AGE
  6884                                       NCRTO-INS-AGE
  6885         MOVE CM-JT-FIRST-NAME      TO EN-JNT-NEW-FIRST-NAME
  6886                                       NCRTO-JNT-FIRST-NAME
  6887         MOVE CM-JT-INITIAL         TO EN-JNT-NEW-MIDDLE-INIT
  6888                                       NCRTO-JNT-MIDDLE-INIT
  6889         MOVE CM-JT-LAST-NAME       TO EN-JNT-NEW-LAST-NAME
  6890                                       NCRTO-JNT-LAST-NAME
  6891         MOVE CM-INSURED-JOINT-AGE  TO EN-JNT-NEW-AGE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 121
* EL6318.cbl
  6892                                       NCRTO-JNT-AGE
  6893
  6894         MOVE CM-LF-BENEFIT-CD      TO EN-LF-NEW-BENCD
  6895                                       NCRTO-LF-BENCD
  6896         IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  6897            MOVE CM-LF-BENEFIT-AMT  TO EN-LF-NEW-BEN-AMT
  6898                                       NCRTO-LF-BEN-AMT
  6899            MOVE CM-LF-PREMIUM-AMT  TO EN-LF-NEW-PRM-AMT
  6900                                       NCRTO-LF-PRM-AMT
  6901            MOVE CM-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  6902                                       NCRTO-LF-ALT-BEN-AMT
  6903            MOVE CM-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
  6904                                       NCRTO-LF-ALT-PRM-AMT
  6905            MOVE CM-LF-ORIG-TERM    TO EN-LF-NEW-TERM
  6906                                       NCRTO-LF-TERM
  6907            MOVE CM-LF-LOAN-EXPIRE-DT TO EN-LF-NEW-EXP-DT
  6908                                       NCRTO-LF-EXP-DT
  6909            MOVE CM-LIFE-COMM-PCT   TO EN-LF-NEW-COMM-PCT
  6910                                       NCRTO-LF-COMM-PCT
  6911         END-IF
  6912
  6913         MOVE CM-AH-BENEFIT-CD      TO EN-AH-NEW-BENCD
  6914                                       NCRTO-AH-BENCD
  6915         IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  6916            MOVE CM-AH-BENEFIT-AMT  TO EN-AH-NEW-BEN-AMT
  6917                                       NCRTO-AH-BEN-AMT
  6918            MOVE CM-AH-PREMIUM-AMT  TO EN-AH-NEW-PRM-AMT
  6919                                       NCRTO-AH-PRM-AMT
  6920            MOVE CM-AH-ORIG-TERM    TO EN-AH-NEW-TERM
  6921                                       NCRTO-AH-TERM
  6922            MOVE CM-AH-LOAN-EXPIRE-DT TO EN-AH-NEW-EXP-DT
  6923                                       NCRTO-AH-EXP-DT
  6924            MOVE CM-AH-CRITICAL-PERIOD TO EN-AH-NEW-CP
  6925                                       NCRTO-AH-CP
  6926            MOVE CM-AH-COMM-PCT     TO EN-AH-NEW-COMM-PCT
  6927                                       NCRTO-AH-COMM-PCT
  6928         END-IF
  6929
  6930         MOVE CM-LOAN-1ST-PMT-DT    TO NCRTO-1ST-PMT-DT
  6931         MOVE CM-ENTRY-BATCH        TO EN-BATCH-NUMBER
  6932
  6933         GO TO 0400-CONTINUE
  6934     END-IF.
  6935
  6936
  6937* EXEC CICS GETMAIN
  6938*         SET      (ADDRESS OF PENDING-BUSINESS)
  6939*         LENGTH   (ERPNDB-LENGTH)
  6940*         INITIMG  (GETMAIN-SPACE)
  6941*    END-EXEC
  6942*    MOVE ',"IL                  $   #00006726' TO DFHEIV0
  6943     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6944     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6945     MOVE X'2020233030303036373236' TO DFHEIV0(25:11)
  6946     CALL 'kxdfhei1' USING DFHEIV0,
  6947           DFHEIV20,
  6948           ERPNDB-LENGTH,
  6949           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 122
* EL6318.cbl
  6950     SET ADDRESS OF PENDING-BUSINESS TO
  6951         DFHEIV20
  6952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6953     MOVE PI-ERPNDB-KEY          TO ERPNDB-KEY
  6954
  6955* EXEC CICS READ
  6956*        DATASET   (WS-ERPNDB-FILE-ID)
  6957*        INTO      (PENDING-BUSINESS)
  6958*        RIDFLD    (ERPNDB-KEY)
  6959*        RESP      (WS-RESPONSE)
  6960*    END-EXEC
  6961     MOVE LENGTH OF
  6962      PENDING-BUSINESS
  6963       TO DFHEIV11
  6964*    MOVE '&"IL       E          (  N#00006732' TO DFHEIV0
  6965     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6966     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6967     MOVE X'204E233030303036373332' TO DFHEIV0(25:11)
  6968     CALL 'kxdfhei1' USING DFHEIV0,
  6969           WS-ERPNDB-FILE-ID,
  6970           PENDING-BUSINESS,
  6971           DFHEIV11,
  6972           ERPNDB-KEY,
  6973           DFHEIV99,
  6974           DFHEIV99,
  6975           DFHEIV99
  6976     MOVE EIBRESP  TO WS-RESPONSE
  6977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6978     IF NOT RESP-NORMAL
  6979        GO TO 0400-EXIT
  6980     END-IF
  6981*    set found-pndb to true
  6982     MOVE PB-I-INSURED-FIRST-NAME  TO EN-INS-NEW-FIRST-NAME
  6983                                      NCRTO-INS-FIRST-NAME
  6984     MOVE PB-I-INSURED-MIDDLE-INIT TO EN-INS-NEW-MIDDLE-INIT
  6985                                      NCRTO-INS-MIDDLE-INIT
  6986     MOVE PB-I-INSURED-LAST-NAME   TO EN-INS-NEW-LAST-NAME
  6987                                      NCRTO-INS-LAST-NAME
  6988     MOVE PB-I-AGE                 TO EN-INS-NEW-AGE
  6989                                      NCRTO-INS-AGE
  6990     MOVE PB-I-JOINT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  6991                                      NCRTO-JNT-FIRST-NAME
  6992     MOVE PB-I-JOINT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6993                                      NCRTO-JNT-MIDDLE-INIT
  6994     MOVE PB-I-JOINT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
  6995                                      NCRTO-JNT-LAST-NAME
  6996     MOVE PB-I-JOINT-AGE           TO EN-JNT-NEW-AGE
  6997                                      NCRTO-JNT-AGE
  6998     MOVE PB-I-LF-BENEFIT-CD       TO EN-LF-NEW-BENCD
  6999                                      NCRTO-LF-BENCD
  7000     IF PB-I-LF-BENEFIT-CD NOT = '00' AND '  '
  7001        MOVE PB-I-LF-BENEFIT-AMT   TO EN-LF-NEW-BEN-AMT
  7002                                      NCRTO-LF-BEN-AMT
  7003        MOVE PB-I-LF-PREMIUM-AMT   TO EN-LF-NEW-PRM-AMT
  7004                                      NCRTO-LF-PRM-AMT
  7005        MOVE PB-I-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  7006                                      NCRTO-LF-ALT-BEN-AMT
  7007        MOVE PB-I-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 123
* EL6318.cbl
  7008                                      NCRTO-LF-ALT-PRM-AMT
  7009        MOVE PB-I-LF-TERM          TO EN-LF-NEW-TERM
  7010                                      NCRTO-LF-TERM
  7011        MOVE PB-I-LF-EXPIRE-DT     TO EN-LF-NEW-EXP-DT
  7012                                      NCRTO-LF-EXP-DT
  7013        IF PB-I-JOINT-COMMISSION > +0
  7014           MOVE PB-I-JOINT-COMMISSION
  7015                                   TO EN-LF-NEW-COMM-PCT
  7016                                      NCRTO-LF-COMM-PCT
  7017        ELSE
  7018           MOVE PB-I-LIFE-COMMISSION
  7019                                   TO EN-LF-NEW-COMM-PCT
  7020                                      NCRTO-LF-COMM-PCT
  7021        END-IF
  7022     END-IF
  7023     MOVE PB-I-AH-BENEFIT-CD       TO EN-AH-NEW-BENCD
  7024                                      NCRTO-AH-BENCD
  7025     IF PB-I-AH-BENEFIT-CD NOT = '00' AND '  '
  7026        MOVE PB-I-AH-BENEFIT-AMT   TO EN-AH-NEW-BEN-AMT
  7027                                      NCRTO-AH-BEN-AMT
  7028        MOVE PB-I-AH-PREMIUM-AMT   TO EN-AH-NEW-PRM-AMT
  7029                                      NCRTO-AH-PRM-AMT
  7030        MOVE PB-I-AH-TERM          TO EN-AH-NEW-TERM
  7031                                      NCRTO-AH-TERM
  7032        MOVE PB-I-AH-EXPIRE-DT     TO EN-AH-NEW-EXP-DT
  7033                                      NCRTO-AH-EXP-DT
  7034        MOVE PB-I-AH-CRIT-PER      TO EN-AH-NEW-CP
  7035                                      NCRTO-AH-CP
  7036        MOVE PB-I-AH-COMMISSION    TO EN-AH-NEW-COMM-PCT
  7037                                      NCRTO-AH-COMM-PCT
  7038     END-IF
  7039     MOVE PB-I-1ST-PMT-DT          TO NCRTO-1ST-PMT-DT
  7040     MOVE PB-ENTRY-BATCH           TO EN-BATCH-NUMBER
  7041     .
  7042 0400-CONTINUE.
  7043
  7044     MOVE W-ACCT-SUMM              TO EN-ACCT-SUMM
  7045     MOVE W-CSO-SUMM               TO EN-CSO-SUMM
  7046*     PERFORM 0450-GET-ERACCT     THRU 0450-EXIT
  7047     MOVE 'Y'                    TO EN-COMM-CHGBK
  7048
  7049     COMPUTE WS-DUE-BORROWER = (EN-LF-ORIG-PRM-AMT
  7050        + EN-LF-ORIG-ALT-PRM-AMT + EN-AH-ORIG-PRM-AMT) -
  7051        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  7052        EN-AH-NEW-PRM-AMT)
  7053     COMPUTE EN-ACCT-PORTION ROUNDED =
  7054        (((EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  7055        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT))
  7056        * EN-LF-NEW-COMM-PCT)
  7057                       +
  7058        ((EN-AH-ORIG-PRM-AMT - EN-AH-NEW-PRM-AMT)
  7059        * EN-AH-NEW-COMM-PCT)
  7060     COMPUTE EN-CSO-PORTION = WS-DUE-BORROWER -
  7061        EN-ACCT-PORTION
  7062     IF PI-RETURN-TO-PROGRAM = 'EL6314'
  7063         MOVE CM-CONTROL-PRIMARY TO WS-ERMAIL-KEY
  7064     ELSE
  7065     move pb-control-by-account (1:33)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 124
* EL6318.cbl
  7066                                 to ws-ermail-key
  7067     END-IF
  7068
  7069
  7070* EXEC CICS READ
  7071*        DATASET   ('ERMAIL')
  7072*        SET       (ADDRESS OF MAILING-DATA)
  7073*        RIDFLD    (WS-ERMAIL-KEY)
  7074*        RESP      (WS-RESPONSE)
  7075*    END-EXEC
  7076     MOVE 'ERMAIL' TO DFHEIV1
  7077*    MOVE '&"S        E          (  N#00006829' TO DFHEIV0
  7078     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7079     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7080     MOVE X'204E233030303036383239' TO DFHEIV0(25:11)
  7081     CALL 'kxdfhei1' USING DFHEIV0,
  7082           DFHEIV1,
  7083           DFHEIV20,
  7084           DFHEIV99,
  7085           WS-ERMAIL-KEY,
  7086           DFHEIV99,
  7087           DFHEIV99,
  7088           DFHEIV99
  7089     SET ADDRESS OF MAILING-DATA TO
  7090         DFHEIV20
  7091     MOVE EIBRESP  TO WS-RESPONSE
  7092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7093     IF RESP-NORMAL
  7094        MOVE MA-CRED-BENE-NAME   TO EN-NEW-CRED-BENE
  7095                                    NCRTO-CRED-BENE-NAME
  7096     ELSE
  7097        DISPLAY ' ERMAIL READ ' WS-RESPONSE
  7098     END-IF
  7099
  7100     IF PI-RETURN-TO-PROGRAM = 'EL6314'
  7101         MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
  7102     ELSE
  7103     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
  7104     END-IF
  7105
  7106     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
  7107
  7108
  7109* EXEC CICS READ
  7110*         DATASET  (WS-ELCRTT-FILE-ID)
  7111*         RIDFLD   (WS-ELCRTT-KEY)
  7112*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  7113*         RESP     (WS-RESPONSE)
  7114*    END-EXEC
  7115*    MOVE '&"S        E          (  N#00006850' TO DFHEIV0
  7116     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7117     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7118     MOVE X'204E233030303036383530' TO DFHEIV0(25:11)
  7119     CALL 'kxdfhei1' USING DFHEIV0,
  7120           WS-ELCRTT-FILE-ID,
  7121           DFHEIV20,
  7122           DFHEIV99,
  7123           WS-ELCRTT-KEY,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 125
* EL6318.cbl
  7124           DFHEIV99,
  7125           DFHEIV99,
  7126           DFHEIV99
  7127     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  7128         DFHEIV20
  7129     MOVE EIBRESP  TO WS-RESPONSE
  7130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7131
  7132     IF RESP-NORMAL
  7133        MOVE CS-INS-AGE-DEFAULT-FLAG TO EN-INS-NEW-AGE-DEF-FLAG
  7134                                     NCRTO-INS-AGE-DEFAULT-FLAG
  7135        MOVE CS-JNT-AGE-DEFAULT-FLAG TO EN-JNT-NEW-AGE-DEF-FLAG
  7136                                     NCRTO-JNT-AGE-DEFAULT-FLAG
  7137     END-IF.
  7138     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  7139        IF REACD-IN (S1) NOT = LOW-VALUES
  7140           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  7141        END-IF
  7142     END-PERFORM
  7143     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  7144     MOVE 'G'                    TO EN-DOCU-TYPE
  7145     MOVE 'Y'                    TO EN-MONEY-SW
  7146     MOVE SIGREQI                TO EN-SIG-SW
  7147     MOVE VOUCHI                 TO EN-VOUCHER-SW
  7148     MOVE PAYEEI                 TO EN-PAYEE
  7149     MOVE HLTHAPPI               TO EN-HEALTH-APP
  7150     if pi-check-cut = 'Y' and pi-check-type = 'C'
  7151        move 'C'                 to en-check-type
  7152     end-if
  7153     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  7154     .
  7155 0400-EXIT.
  7156     EXIT.
  7157 0410-INIT-ERENDT.
  7158     MOVE OC-CONTROL-PRIMARY     TO ERENDT-KEY
  7159     MOVE ZEROS                  TO ENDT-SEQ-NO
  7160
  7161* EXEC CICS READ
  7162*        DATASET    (WS-ERENDT-FILE-ID)
  7163*        RIDFLD     (ERENDT-KEY)
  7164*        INTO       (ENDORSEMENT-RECORD)
  7165*        RESP       (WS-RESPONSE)
  7166*        GTEQ
  7167*    END-EXEC
  7168     MOVE LENGTH OF
  7169      ENDORSEMENT-RECORD
  7170       TO DFHEIV11
  7171*    MOVE '&"IL       G          (  N#00006885' TO DFHEIV0
  7172     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  7173     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7174     MOVE X'204E233030303036383835' TO DFHEIV0(25:11)
  7175     CALL 'kxdfhei1' USING DFHEIV0,
  7176           WS-ERENDT-FILE-ID,
  7177           ENDORSEMENT-RECORD,
  7178           DFHEIV11,
  7179           ERENDT-KEY,
  7180           DFHEIV99,
  7181           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 126
* EL6318.cbl
  7182           DFHEIV99
  7183     MOVE EIBRESP  TO WS-RESPONSE
  7184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7185     IF RESP-NORMAL
  7186        AND (EN-CONTROL-PRIMARY (1:34) =
  7187           OC-CONTROL-PRIMARY (1:34))
  7188        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  7189     ELSE
  7190        MOVE +4096               TO WS-SEQ-NO
  7191     END-IF
  7192     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  7193     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  7194     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  7195     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  7196     INITIALIZE EN-ISSUE-RECORD
  7197     MOVE LOW-VALUES             TO EN-LF-ORIG-EXP-DT
  7198                                    EN-AH-ORIG-EXP-DT
  7199                                    EN-LF-NEW-EXP-DT
  7200                                    EN-AH-NEW-EXP-DT
  7201                                    EN-PROCESS-DT
  7202     .
  7203 0410-EXIT.
  7204     EXIT.
  7205 0420-UPDATE-ELCRTO.
  7206     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  7207     IF RESP-NORMAL
  7208        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  7209                                    OC-LAST-MAINT-DT
  7210        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  7211        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  7212
  7213* EXEC CICS REWRITE
  7214*          FROM     (ORIGINAL-CERTIFICATE)
  7215*          DATASET  ('ELCRTO')
  7216*       END-EXEC
  7217     MOVE LENGTH OF
  7218      ORIGINAL-CERTIFICATE
  7219       TO DFHEIV11
  7220     MOVE 'ELCRTO' TO DFHEIV1
  7221*    MOVE '&& L                  %   #00006919' TO DFHEIV0
  7222     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7223     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7224     MOVE X'2020233030303036393139' TO DFHEIV0(25:11)
  7225     CALL 'kxdfhei1' USING DFHEIV0,
  7226           DFHEIV1,
  7227           ORIGINAL-CERTIFICATE,
  7228           DFHEIV11,
  7229           DFHEIV99
  7230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7231     END-IF
  7232     .
  7233 0420-EXIT.
  7234     EXIT.
  7235
  7236 0425-ADD-NEW-ELCRTO.
  7237     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  7238     MOVE 'OC'                   TO OC-RECORD-ID
  7239     MOVE NEW-ELCRTO-KEY         TO OC-CONTROL-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 127
* EL6318.cbl
  7240     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  7241     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  7242     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  7243     MOVE NCRTO-INS-FIRST-NAME   TO OC-INS-FIRST-NAME
  7244     MOVE NCRTO-INS-MIDDLE-INIT  TO OC-INS-MIDDLE-INIT
  7245     MOVE NCRTO-INS-LAST-NAME    TO OC-INS-LAST-NAME
  7246     MOVE NCRTO-INS-AGE          TO OC-INS-AGE
  7247     MOVE NCRTO-JNT-FIRST-NAME   TO OC-JNT-FIRST-NAME
  7248     MOVE NCRTO-JNT-MIDDLE-INIT  TO OC-JNT-MIDDLE-INIT
  7249     MOVE NCRTO-JNT-LAST-NAME    TO OC-JNT-LAST-NAME
  7250     MOVE NCRTO-JNT-AGE          TO OC-JNT-AGE
  7251     MOVE NCRTO-LF-BENCD         TO OC-LF-BENCD
  7252     MOVE NCRTO-LF-BEN-AMT       TO OC-LF-BEN-AMT
  7253     MOVE NCRTO-LF-PRM-AMT       TO OC-LF-PRM-AMT
  7254     MOVE NCRTO-LF-ALT-BEN-AMT   TO OC-LF-ALT-BEN-AMT
  7255     MOVE NCRTO-LF-ALT-PRM-AMT   TO OC-LF-ALT-PRM-AMT
  7256     MOVE NCRTO-LF-TERM          TO OC-LF-TERM
  7257     MOVE NCRTO-LF-EXP-DT        TO OC-LF-EXP-DT
  7258     MOVE NCRTO-LF-COMM-PCT      TO OC-LF-COMM-PCT
  7259     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
  7260     MOVE +0                     TO OC-LF-CANCEL-AMT
  7261                                    OC-LF-ITD-CANCEL-AMT
  7262     MOVE NCRTO-AH-BENCD         TO OC-AH-BENCD
  7263     MOVE NCRTO-AH-BEN-AMT       TO OC-AH-BEN-AMT
  7264     MOVE NCRTO-AH-PRM-AMT       TO OC-AH-PRM-AMT
  7265     MOVE NCRTO-AH-TERM          TO OC-AH-TERM
  7266     MOVE NCRTO-AH-EXP-DT        TO OC-AH-EXP-DT
  7267     MOVE NCRTO-AH-CP            TO OC-AH-CP
  7268     MOVE NCRTO-AH-COMM-PCT      TO OC-AH-COMM-PCT
  7269     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
  7270     MOVE +0                     TO OC-AH-CANCEL-AMT
  7271                                    OC-AH-ITD-CANCEL-AMT
  7272     MOVE NCRTO-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
  7273     MOVE NCRTO-1ST-PMT-DT       TO OC-1ST-PMT-DT
  7274     MOVE NCRTO-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
  7275     MOVE NCRTO-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
  7276     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
  7277     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
  7278     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  7279     .
  7280 0425-WRITE-ELCRTO.
  7281
  7282
  7283* EXEC CICS WRITE
  7284*       DATASET   ('ELCRTO')
  7285*       FROM      (ORIGINAL-CERTIFICATE)
  7286*       RIDFLD    (OC-CONTROL-PRIMARY)
  7287*       RESP      (WS-RESPONSE)
  7288*    END-EXEC
  7289     MOVE LENGTH OF
  7290      ORIGINAL-CERTIFICATE
  7291       TO DFHEIV11
  7292     MOVE 'ELCRTO' TO DFHEIV1
  7293*    MOVE '&$ L                  ''  N#00006974' TO DFHEIV0
  7294     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7295     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7296     MOVE X'204E233030303036393734' TO DFHEIV0(25:11)
  7297     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 128
* EL6318.cbl
  7298           DFHEIV1,
  7299           ORIGINAL-CERTIFICATE,
  7300           DFHEIV11,
  7301           OC-CONTROL-PRIMARY,
  7302           DFHEIV99,
  7303           DFHEIV99
  7304     MOVE EIBRESP  TO WS-RESPONSE
  7305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7306
  7307     IF RESP-DUPKEY
  7308        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  7309        GO TO 0425-WRITE-ELCRTO
  7310     ELSE
  7311        IF NOT RESP-NORMAL
  7312           MOVE -1               TO SIGREQL
  7313           MOVE ER-3830          TO EMI-ERROR
  7314           PERFORM 9900-ERROR-FORMAT
  7315                                 THRU 9900-EXIT
  7316        ELSE
  7317           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  7318        END-IF
  7319     END-IF
  7320
  7321     .
  7322 0425-EXIT.
  7323     EXIT.
  7324
  7325 0426-ADD-CERT-NOTES.
  7326
  7327     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  7328     SET TB-INDX TO 1
  7329
  7330     IF PI-CERTNT1-ENTERED > SPACES
  7331         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  7332         MOVE PI-PROCESSOR-ID    TO
  7333                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7334         MOVE EIBTIME            TO
  7335                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7336         MOVE WS-CURRENT-BIN-DT  TO
  7337                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7338         SET TB-INDX UP BY +1
  7339     END-IF
  7340
  7341     IF PI-CERTNT2-ENTERED > SPACES
  7342         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
  7343         MOVE PI-PROCESSOR-ID    TO
  7344                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7345         MOVE EIBTIME            TO
  7346                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7347         MOVE WS-CURRENT-BIN-DT  TO
  7348                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7349         SET TB-INDX UP BY +1
  7350     END-IF
  7351
  7352     IF PI-CERTNT3-ENTERED > SPACES
  7353         MOVE PI-CERTNT3-ENTERED TO CERT-NT-TEXT (TB-INDX)
  7354         MOVE PI-PROCESSOR-ID    TO
  7355                      CERT-NT-LAST-MAINT-BY (TB-INDX)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 129
* EL6318.cbl
  7356         MOVE EIBTIME            TO
  7357                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7358         MOVE WS-CURRENT-BIN-DT  TO
  7359                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7360         SET TB-INDX UP BY +1
  7361     END-IF
  7362
  7363     IF PI-CERTNT4-ENTERED > SPACES
  7364         MOVE PI-CERTNT4-ENTERED TO CERT-NT-TEXT (TB-INDX)
  7365         MOVE PI-PROCESSOR-ID    TO
  7366                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7367         MOVE EIBTIME            TO
  7368                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7369         MOVE WS-CURRENT-BIN-DT  TO
  7370                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7371         SET TB-INDX UP BY +1
  7372     END-IF
  7373
  7374     IF CERT-NOTE-ENTRIES > SPACES
  7375         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  7376         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  7377     END-IF
  7378
  7379     IF PI-BILLNT1-ENTERED > SPACES
  7380         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  7381         MOVE PI-BILLNT1-ENTERED TO WS-MAN-BN-NOTE
  7382         MOVE +63 TO WS-LEN
  7383         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7384     END-IF
  7385
  7386     IF PI-BILLNT2-ENTERED > SPACES
  7387         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  7388         MOVE PI-BILLNT2-ENTERED TO WS-MAN-BN-NOTE
  7389         MOVE +63 TO WS-LEN
  7390         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7391     END-IF
  7392
  7393     .
  7394 0426-EXIT.
  7395     EXIT.
  7396
  7397 0427-LOAD-CURRENT-CERT-NOTES.
  7398
  7399     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  7400     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
  7401     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  7402     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  7403     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  7404     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  7405     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  7406     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  7407     MOVE '1'                 TO ERCNOT-REC-TYP
  7408     MOVE +0                  TO ERCNOT-SEQ
  7409     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  7410
  7411
  7412* EXEC CICS STARTBR
  7413*         DATASET(WS-ERCNOT-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 130
* EL6318.cbl
  7414*         RIDFLD(ERCNOT-KEY)
  7415*         KEYLENGTH(ERCNOT-START-LENGTH)
  7416*         RESP      (WS-RESPONSE)
  7417*         GENERIC
  7418*         GTEQ
  7419*    END-EXEC.
  7420     MOVE 0
  7421       TO DFHEIV11
  7422*    MOVE '&,   KG    G          &  N#00007085' TO DFHEIV0
  7423     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  7424     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7425     MOVE X'204E233030303037303835' TO DFHEIV0(25:11)
  7426     CALL 'kxdfhei1' USING DFHEIV0,
  7427           WS-ERCNOT-FILE-ID,
  7428           ERCNOT-KEY,
  7429           ERCNOT-START-LENGTH,
  7430           DFHEIV11,
  7431           DFHEIV99
  7432     MOVE EIBRESP  TO WS-RESPONSE
  7433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7434
  7435
  7436     IF NOT RESP-NORMAL
  7437        GO TO 0427-ENDBR
  7438     END-IF.
  7439
  7440 0427-LOOP.
  7441
  7442* EXEC CICS READNEXT
  7443*         SET(ADDRESS OF CERT-NOTE-FILE)
  7444*         DATASET(WS-ERCNOT-FILE-ID)
  7445*         RIDFLD(ERCNOT-KEY)
  7446*    END-EXEC.
  7447     MOVE 0
  7448       TO DFHEIV11
  7449*    MOVE '&.S                   )   #00007099' TO DFHEIV0
  7450     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7451     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7452     MOVE X'2020233030303037303939' TO DFHEIV0(25:11)
  7453     CALL 'kxdfhei1' USING DFHEIV0,
  7454           WS-ERCNOT-FILE-ID,
  7455           DFHEIV20,
  7456           DFHEIV99,
  7457           ERCNOT-KEY,
  7458           DFHEIV99,
  7459           DFHEIV11,
  7460           DFHEIV99,
  7461           DFHEIV99
  7462     SET ADDRESS OF CERT-NOTE-FILE TO
  7463         DFHEIV20
  7464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7465
  7466
  7467     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  7468         GO TO 0427-ENDBR
  7469     END-IF.
  7470
  7471     IF (CZ-CARRIER = SV-CARRIER)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 131
* EL6318.cbl
  7472        AND (CZ-GROUPING = SV-GROUPING)
  7473        AND (CZ-STATE = SV-STATE)
  7474        AND (CZ-ACCOUNT = SV-ACCOUNT)
  7475        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  7476        AND (CZ-CERT-NO = SV-CERT-NO)
  7477        AND (CZ-RECORD-TYPE = '1')
  7478          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  7479          MOVE CZ-LAST-MAINT-USER TO
  7480                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7481          MOVE CZ-LAST-MAINT-DT TO
  7482                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7483          MOVE CZ-LAST-MAINT-HHMMSS TO
  7484                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7485          SET TB-INDX UP BY 1
  7486          GO TO 0427-LOOP
  7487     END-IF.
  7488
  7489 0427-ENDBR.
  7490
  7491
  7492* EXEC CICS ENDBR
  7493*         DATASET(WS-ERCNOT-FILE-ID)
  7494*    END-EXEC.
  7495     MOVE 0
  7496       TO DFHEIV11
  7497*    MOVE '&2                    $   #00007129' TO DFHEIV0
  7498     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7499     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7500     MOVE X'2020233030303037313239' TO DFHEIV0(25:11)
  7501     CALL 'kxdfhei1' USING DFHEIV0,
  7502           WS-ERCNOT-FILE-ID,
  7503           DFHEIV11,
  7504           DFHEIV99
  7505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7506
  7507
  7508     .
  7509 0427-EXIT.
  7510     EXIT.
  7511
  7512 0430-WRITE-ERENDT.
  7513     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  7514     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  7515
  7516* EXEC CICS WRITE
  7517*         DATASET   (WS-ERENDT-FILE-ID)
  7518*         FROM      (ENDORSEMENT-RECORD)
  7519*         RIDFLD    (EN-CONTROL-PRIMARY)
  7520*         RESP      (WS-RESPONSE)
  7521*    END-EXEC
  7522     MOVE LENGTH OF
  7523      ENDORSEMENT-RECORD
  7524       TO DFHEIV11
  7525*    MOVE '&$ L                  ''  N#00007140' TO DFHEIV0
  7526     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7527     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7528     MOVE X'204E233030303037313430' TO DFHEIV0(25:11)
  7529     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 132
* EL6318.cbl
  7530           WS-ERENDT-FILE-ID,
  7531           ENDORSEMENT-RECORD,
  7532           DFHEIV11,
  7533           EN-CONTROL-PRIMARY,
  7534           DFHEIV99,
  7535           DFHEIV99
  7536     MOVE EIBRESP  TO WS-RESPONSE
  7537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7538     IF RESP-NORMAL
  7539        MOVE 'G'                 TO PI-DOCUMENT-PROCESSED
  7540        IF EIBAID = DFHPF4
  7541           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  7542           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  7543           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  7544           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  7545        END-IF
  7546     ELSE
  7547        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  7548        MOVE -1                  TO SIGREQL
  7549        MOVE ER-0132             TO EMI-ERROR
  7550        MOVE AL-UABON            TO SIGREQA
  7551        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7552     END-IF
  7553     .
  7554 0430-EXIT.
  7555     EXIT.
  7556
  7557
  7558 0440-ADD-BILLING-NOTE.
  7559
  7560* EXEC CICS GETMAIN
  7561*         SET      (ADDRESS OF EOB-CODES)
  7562*         LENGTH   (ELEOBC-LENGTH)
  7563*         INITIMG  (GETMAIN-SPACE)
  7564*    END-EXEC
  7565*    MOVE ',"IL                  $   #00007167' TO DFHEIV0
  7566     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7567     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7568     MOVE X'2020233030303037313637' TO DFHEIV0(25:11)
  7569     CALL 'kxdfhei1' USING DFHEIV0,
  7570           DFHEIV20,
  7571           ELEOBC-LENGTH,
  7572           GETMAIN-SPACE
  7573     SET ADDRESS OF EOB-CODES TO
  7574         DFHEIV20
  7575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7576
  7577     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  7578     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  7579     MOVE '5'                    TO WS-EOBC-REC-TYPE
  7580
  7581
  7582* EXEC CICS STARTBR
  7583*        DATASET   ('ELEOBC')
  7584*        RIDFLD    (WS-ELEOBC-KEY)
  7585*        GTEQ
  7586*        RESP      (WS-RESPONSE)
  7587*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 133
* EL6318.cbl
  7588     MOVE 'ELEOBC' TO DFHEIV1
  7589     MOVE 0
  7590       TO DFHEIV11
  7591*    MOVE '&,         G          &  N#00007177' TO DFHEIV0
  7592     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7593     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7594     MOVE X'204E233030303037313737' TO DFHEIV0(25:11)
  7595     CALL 'kxdfhei1' USING DFHEIV0,
  7596           DFHEIV1,
  7597           WS-ELEOBC-KEY,
  7598           DFHEIV99,
  7599           DFHEIV11,
  7600           DFHEIV99
  7601     MOVE EIBRESP  TO WS-RESPONSE
  7602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7603
  7604     IF NOT RESP-NORMAL
  7605        GO TO 0440-EXIT
  7606     END-IF
  7607      .
  7608 0440-READNEXT-ELEOBC.
  7609
  7610
  7611* EXEC CICS READNEXT
  7612*       INTO    (EOB-CODES)
  7613*       DATASET ('ELEOBC')
  7614*       RIDFLD  (WS-ELEOBC-KEY)
  7615*       RESP    (WS-RESPONSE)
  7616*    END-EXEC
  7617     MOVE LENGTH OF
  7618      EOB-CODES
  7619       TO DFHEIV12
  7620     MOVE 'ELEOBC' TO DFHEIV1
  7621     MOVE 0
  7622       TO DFHEIV11
  7623*    MOVE '&.IL                  )  N#00007190' TO DFHEIV0
  7624     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7625     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7626     MOVE X'204E233030303037313930' TO DFHEIV0(25:11)
  7627     CALL 'kxdfhei1' USING DFHEIV0,
  7628           DFHEIV1,
  7629           EOB-CODES,
  7630           DFHEIV12,
  7631           WS-ELEOBC-KEY,
  7632           DFHEIV99,
  7633           DFHEIV11,
  7634           DFHEIV99,
  7635           DFHEIV99
  7636     MOVE EIBRESP  TO WS-RESPONSE
  7637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7638
  7639     IF RESP-NORMAL
  7640         IF EO-RECORD-TYPE NOT = '5'
  7641             GO TO 0440-EXIT
  7642         END-IF
  7643     ELSE
  7644         GO TO 0440-EXIT
  7645     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 134
* EL6318.cbl
  7646
  7647     IF EO-RECORD-TYPE = '5' AND
  7648        EO-EOB-CODE = PI-LTRID-ENTERED
  7649           CONTINUE
  7650     ELSE
  7651         GO TO 0440-READNEXT-ELEOBC
  7652     END-IF
  7653
  7654     MOVE SPACES TO WS-BILLING-NOTE
  7655     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  7656     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  7657     MOVE WS-CURRENT-DT TO WS-BN-DATE
  7658     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  7659     MOVE +25 TO WS-LEN
  7660
  7661     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7662     .
  7663 0440-EXIT.
  7664     EXIT.
  7665
  7666 0441-UPDATE-BILLING-NOTE.
  7667
  7668* EXEC CICS GETMAIN
  7669*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  7670*         LENGTH   (ERNOTE-LENGTH)
  7671*         INITIMG  (GETMAIN-SPACE)
  7672*    END-EXEC
  7673*    MOVE ',"IL                  $   #00007225' TO DFHEIV0
  7674     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7675     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7676     MOVE X'2020233030303037323235' TO DFHEIV0(25:11)
  7677     CALL 'kxdfhei1' USING DFHEIV0,
  7678           DFHEIV20,
  7679           ERNOTE-LENGTH,
  7680           GETMAIN-SPACE
  7681     SET ADDRESS OF CERTIFICATE-NOTE TO
  7682         DFHEIV20
  7683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7684
  7685     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  7686
  7687
  7688* EXEC CICS READ
  7689*       DATASET    (WS-ERNOTE-FILE-ID)
  7690*       RIDFLD     (WS-ERNOTE-KEY)
  7691*       INTO       (CERTIFICATE-NOTE)
  7692*       RESP       (WS-RESPONSE)
  7693*       UPDATE
  7694*    END-EXEC
  7695     MOVE LENGTH OF
  7696      CERTIFICATE-NOTE
  7697       TO DFHEIV11
  7698*    MOVE '&"IL       EU         (  N#00007233' TO DFHEIV0
  7699     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7700     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7701     MOVE X'204E233030303037323333' TO DFHEIV0(25:11)
  7702     CALL 'kxdfhei1' USING DFHEIV0,
  7703           WS-ERNOTE-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 135
* EL6318.cbl
  7704           CERTIFICATE-NOTE,
  7705           DFHEIV11,
  7706           WS-ERNOTE-KEY,
  7707           DFHEIV99,
  7708           DFHEIV99,
  7709           DFHEIV99
  7710     MOVE EIBRESP  TO WS-RESPONSE
  7711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7712
  7713     IF RESP-NORMAL
  7714       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  7715          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  7716       END-IF
  7717       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  7718          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  7719       END-IF
  7720       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7721           (NOTE-SUB > +10) OR
  7722           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7723                             WS-BILLING-NOTE (1:WS-LEN))
  7724       END-PERFORM
  7725       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7726                              WS-BILLING-NOTE (1:WS-LEN)
  7727
  7728* EXEC CICS UNLOCK
  7729*           DATASET    (WS-ERNOTE-FILE-ID)
  7730*        END-EXEC
  7731*    MOVE '&*                    #   #00007255' TO DFHEIV0
  7732     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7733     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7734     MOVE X'2020233030303037323535' TO DFHEIV0(25:11)
  7735     CALL 'kxdfhei1' USING DFHEIV0,
  7736           WS-ERNOTE-FILE-ID,
  7737           DFHEIV99
  7738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7739       ELSE
  7740         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7741           (NOTE-SUB > +10) OR
  7742           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  7743         END-PERFORM
  7744         IF (NOTE-SUB < +11)
  7745           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  7746              NOTE-SUB <= CN-BILLING-END-LINE-NO
  7747                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7748           ELSE
  7749             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  7750              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  7751                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  7752                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  7753             ELSE
  7754               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  7755                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  7756                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7757                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  7758               ELSE
  7759                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  7760                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  7761                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 136
* EL6318.cbl
  7762                                       CN-BILLING-START-LINE-NO
  7763                 ELSE
  7764                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  7765                 END-IF
  7766               END-IF
  7767             END-IF
  7768           END-IF
  7769           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7770           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7771           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7772
  7773* EXEC CICS REWRITE
  7774*             DATASET    (WS-ERNOTE-FILE-ID)
  7775*             FROM       (CERTIFICATE-NOTE)
  7776*             RESP       (WS-RESPONSE)
  7777*          END-EXEC
  7778     MOVE LENGTH OF
  7779      CERTIFICATE-NOTE
  7780       TO DFHEIV11
  7781*    MOVE '&& L                  %  N#00007291' TO DFHEIV0
  7782     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7783     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7784     MOVE X'204E233030303037323931' TO DFHEIV0(25:11)
  7785     CALL 'kxdfhei1' USING DFHEIV0,
  7786           WS-ERNOTE-FILE-ID,
  7787           CERTIFICATE-NOTE,
  7788           DFHEIV11,
  7789           DFHEIV99
  7790     MOVE EIBRESP  TO WS-RESPONSE
  7791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7792           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7793         END-IF
  7794       END-IF
  7795     ELSE
  7796        MOVE SPACES              TO CERTIFICATE-NOTE
  7797        MOVE 'CN'                TO CN-RECORD-ID
  7798        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  7799                                     WS-ERNOTE-KEY
  7800        MOVE 01                  TO CN-BILLING-START-LINE-NO
  7801                                    CN-BILLING-END-LINE-NO
  7802        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  7803        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7804        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7805        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7806
  7807* EXEC CICS WRITE
  7808*          DATASET    (WS-ERNOTE-FILE-ID)
  7809*          FROM       (CERTIFICATE-NOTE)
  7810*          RIDFLD     (WS-ERNOTE-KEY)
  7811*          RESP       (WS-RESPONSE)
  7812*       END-EXEC
  7813     MOVE LENGTH OF
  7814      CERTIFICATE-NOTE
  7815       TO DFHEIV11
  7816*    MOVE '&$ L                  ''  N#00007310' TO DFHEIV0
  7817     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7818     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7819     MOVE X'204E233030303037333130' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 137
* EL6318.cbl
  7820     CALL 'kxdfhei1' USING DFHEIV0,
  7821           WS-ERNOTE-FILE-ID,
  7822           CERTIFICATE-NOTE,
  7823           DFHEIV11,
  7824           WS-ERNOTE-KEY,
  7825           DFHEIV99,
  7826           DFHEIV99
  7827     MOVE EIBRESP  TO WS-RESPONSE
  7828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7829
  7830        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7831     END-IF
  7832
  7833     .
  7834 0441-EXIT.
  7835     EXIT.
  7836
  7837
  7838 0442-SQUEEZE-IT-IN.
  7839
  7840     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  7841        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7842           NOTE-SUB = +10
  7843           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  7844           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  7845             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  7846             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  7847             MOVE +9 TO NOTE-SUB
  7848           END-IF
  7849        END-PERFORM
  7850     ELSE
  7851        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  7852           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  7853             UNTIL NOTE-SUB = +1
  7854             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  7855             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  7856                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  7857                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  7858                MOVE +2          TO NOTE-SUB
  7859             END-IF
  7860           END-PERFORM
  7861        END-IF
  7862     END-IF
  7863
  7864     .
  7865 0442-EXIT.
  7866     EXIT.
  7867
  7868 0445-CERTIFICATE-UPDATE.
  7869     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7870     IF RESP-NORMAL
  7871        EVALUATE CM-NOTE-SW
  7872           WHEN '2'
  7873           WHEN '3'
  7874           WHEN '6'
  7875           WHEN '7'
  7876              SET NO-CERT-RW     TO TRUE
  7877           WHEN ' '
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 138
* EL6318.cbl
  7878              MOVE '2'           TO CM-NOTE-SW
  7879           WHEN '1'
  7880              MOVE '3'           TO CM-NOTE-SW
  7881           WHEN '4'
  7882              MOVE '6'           TO CM-NOTE-SW
  7883           WHEN '5'
  7884              MOVE '7'           TO CM-NOTE-SW
  7885        END-EVALUATE
  7886     END-IF
  7887     IF NOT NO-CERT-RW
  7888        PERFORM 1810-REWRITE-ELCERT
  7889                                 THRU 1810-EXIT
  7890     ELSE
  7891
  7892* EXEC CICS UNLOCK
  7893*          DATASET    (WS-ELCERT-FILE-ID)
  7894*       END-EXEC
  7895*    MOVE '&*                    #   #00007378' TO DFHEIV0
  7896     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7897     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7898     MOVE X'2020233030303037333738' TO DFHEIV0(25:11)
  7899     CALL 'kxdfhei1' USING DFHEIV0,
  7900           WS-ELCERT-FILE-ID,
  7901           DFHEIV99
  7902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7903     END-IF
  7904
  7905     .
  7906 0445-EXIT.
  7907     EXIT.
  7908
  7909 0450-GET-ERACCT.
  7910     MOVE ' '                    TO WS-ERACCT-SW
  7911     MOVE ZEROS                  TO WS-CHGBACK
  7912                                    WS-CSO-PORTION
  7913                                    WS-ACCT-PORTION
  7914                                    WS-DIFF
  7915     PERFORM 0460-STARTBR-ERACCT THRU 0460-EXIT
  7916     IF RESP-NORMAL
  7917        PERFORM 0470-READNEXT-ERACCT
  7918                                 THRU 0470-EXIT
  7919     END-IF
  7920     IF RESP-NORMAL
  7921        IF AM-CONTROL-PRIMARY (1:20) = EN-CONTROL-PRIMARY (1:20)
  7922           IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
  7923              AND >= AM-EFFECTIVE-DT
  7924              SET ACCT-FOUND TO TRUE
  7925           ELSE
  7926              PERFORM 0470-READNEXT-ERACCT
  7927                                 THRU 0470-EXIT
  7928              IF RESP-NORMAL
  7929                 IF AM-CONTROL-PRIMARY (1:20)
  7930                    = EN-CONTROL-PRIMARY (1:20)
  7931                    IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
  7932                       AND >= AM-EFFECTIVE-DT
  7933                       SET ACCT-FOUND TO TRUE
  7934                    END-IF
  7935                 END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 139
* EL6318.cbl
  7936              END-IF
  7937           END-IF
  7938        END-IF
  7939     END-IF
  7940     IF ACCT-FOUND
  7941        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  7942           (AM-COM-TYP (S1) = 'C' OR 'D')
  7943           OR (S1 > +10)
  7944        END-PERFORM
  7945        IF S1 < +11
  7946           MOVE AM-COMM-CHARGEBACK (S1)
  7947                                 TO WS-CHGBACK
  7948        END-IF
  7949     END-IF
  7950    .
  7951 0450-EXIT.
  7952     EXIT.
  7953 0460-STARTBR-ERACCT.
  7954     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  7955     MOVE EN-CONTROL-PRIMARY     TO WS-ERACCT-KEY (1:22)
  7956     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  7957
  7958* EXEC CICS STARTBR
  7959*        DATASET   ('ERACCT')
  7960*        RIDFLD    (WS-ERACCT-KEY)
  7961*        GTEQ
  7962*        RESP      (WS-RESPONSE)
  7963*    END-EXEC
  7964     MOVE 'ERACCT' TO DFHEIV1
  7965     MOVE 0
  7966       TO DFHEIV11
  7967*    MOVE '&,         G          &  N#00007435' TO DFHEIV0
  7968     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7969     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7970     MOVE X'204E233030303037343335' TO DFHEIV0(25:11)
  7971     CALL 'kxdfhei1' USING DFHEIV0,
  7972           DFHEIV1,
  7973           WS-ERACCT-KEY,
  7974           DFHEIV99,
  7975           DFHEIV11,
  7976           DFHEIV99
  7977     MOVE EIBRESP  TO WS-RESPONSE
  7978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7979     .
  7980 0460-EXIT.
  7981     EXIT.
  7982 0470-READNEXT-ERACCT.
  7983
  7984* EXEC CICS READNEXT
  7985*       INTO    (ACCOUNT-MASTER)
  7986*       DATASET ('ERACCT')
  7987*       RIDFLD  (WS-ERACCT-KEY)
  7988*       RESP    (WS-RESPONSE)
  7989*    END-EXEC
  7990     MOVE LENGTH OF
  7991      ACCOUNT-MASTER
  7992       TO DFHEIV12
  7993     MOVE 'ERACCT' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 140
* EL6318.cbl
  7994     MOVE 0
  7995       TO DFHEIV11
  7996*    MOVE '&.IL                  )  N#00007445' TO DFHEIV0
  7997     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7998     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7999     MOVE X'204E233030303037343435' TO DFHEIV0(25:11)
  8000     CALL 'kxdfhei1' USING DFHEIV0,
  8001           DFHEIV1,
  8002           ACCOUNT-MASTER,
  8003           DFHEIV12,
  8004           WS-ERACCT-KEY,
  8005           DFHEIV99,
  8006           DFHEIV11,
  8007           DFHEIV99,
  8008           DFHEIV99
  8009     MOVE EIBRESP  TO WS-RESPONSE
  8010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8011     .
  8012 0470-EXIT.
  8013     EXIT.
  8014 0500-CREATE-TEMP-STORAGE.
  8015*    display ' about to write pi ' program-interface-block
  8016
  8017* EXEC CICS WRITEQ TS
  8018*        QUEUE (QID)
  8019*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8020*        LENGTH(1300)
  8021*    END-EXEC
  8022     MOVE 1300
  8023       TO DFHEIV11
  8024*    MOVE '*"     L              ''   #00007456' TO DFHEIV0
  8025     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8026     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8027     MOVE X'2020233030303037343536' TO DFHEIV0(25:11)
  8028     CALL 'kxdfhei1' USING DFHEIV0,
  8029           QID,
  8030           PROGRAM-INTERFACE-BLOCK,
  8031           DFHEIV11,
  8032           DFHEIV99,
  8033           DFHEIV99,
  8034           DFHEIV99
  8035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8036*    display ' about to write map ' el631ki
  8037
  8038* EXEC CICS WRITEQ TS
  8039*        QUEUE (QID)
  8040*        FROM  (EL631KI)
  8041*        LENGTH(MAP-LENGTH)
  8042*    END-EXEC.
  8043*    MOVE '*"     L              ''   #00007462' TO DFHEIV0
  8044     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8045     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8046     MOVE X'2020233030303037343632' TO DFHEIV0(25:11)
  8047     CALL 'kxdfhei1' USING DFHEIV0,
  8048           QID,
  8049           EL631KI,
  8050           MAP-LENGTH,
  8051           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 141
* EL6318.cbl
  8052           DFHEIV99,
  8053           DFHEIV99
  8054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8055
  8056 0500-EXIT.
  8057      EXIT.
  8058 0600-RECOVER-TEMP-STORAGE.
  8059
  8060* EXEC CICS READQ TS
  8061*        QUEUE (QID)
  8062*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8063*        LENGTH(1300)
  8064*    END-EXEC
  8065     MOVE 1300
  8066       TO DFHEIV11
  8067*    MOVE '*$I    L              ''   #00007470' TO DFHEIV0
  8068     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8069     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8070     MOVE X'2020233030303037343730' TO DFHEIV0(25:11)
  8071     CALL 'kxdfhei1' USING DFHEIV0,
  8072           QID,
  8073           PROGRAM-INTERFACE-BLOCK,
  8074           DFHEIV11,
  8075           DFHEIV99,
  8076           DFHEIV99,
  8077           DFHEIV99
  8078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8079
  8080* EXEC CICS READQ TS
  8081*        QUEUE (QID)
  8082*        INTO  (EL631KI)
  8083*        LENGTH(MAP-LENGTH)
  8084*    END-EXEC
  8085*    MOVE '*$I    L              ''   #00007475' TO DFHEIV0
  8086     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8087     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8088     MOVE X'2020233030303037343735' TO DFHEIV0(25:11)
  8089     CALL 'kxdfhei1' USING DFHEIV0,
  8090           QID,
  8091           EL631KI,
  8092           MAP-LENGTH,
  8093           DFHEIV99,
  8094           DFHEIV99,
  8095           DFHEIV99
  8096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8097     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8098     MOVE AL-UANON            TO SIGREQA
  8099     MOVE AL-UANON            TO LTRIDA
  8100     MOVE AL-UANON            TO VOUCHA
  8101     MOVE AL-UANON            TO HLTHAPPA
  8102     MOVE AL-UANON            TO PAYEEA
  8103     IF WS-SET-CODES-MDT = 'Y'
  8104        move +1                  to s2
  8105        perform varying s1 from +1 by +5 until s1 > +60
  8106           MOVE WS-PASSED-REASON-CODES (s1:4)
  8107                                 TO reacd-in (s2)
  8108           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  8109               MOVE AL-SANON     TO REACDA (S2)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 142
* EL6318.cbl
  8110               MOVE +4           TO REACDL (S2)
  8111           END-IF
  8112           add +1                to s2
  8113        end-perform
  8114        MOVE REASONCDS       TO PI-REASONS-ENTERED
  8115     END-IF
  8116     IF CERTIDI > SPACES
  8117         MOVE AL-UANON       TO CERTIDA
  8118     END-IF
  8119
  8120     IF ENCCODEI > SPACES
  8121         MOVE AL-UANON       TO ENCCODEA
  8122     END-IF
  8123
  8124     IF CRTNT1I > SPACES
  8125         MOVE AL-UANON       TO CRTNT1A
  8126     END-IF
  8127
  8128     IF CRTNT2I > SPACES
  8129         MOVE AL-UANON       TO CRTNT2A
  8130     END-IF
  8131
  8132     IF CRTNT3I > SPACES
  8133         MOVE AL-UANON       TO CRTNT3A
  8134     END-IF
  8135
  8136     IF CRTNT4I > SPACES
  8137         MOVE AL-UANON       TO CRTNT4A
  8138     END-IF
  8139
  8140     IF BILNT1I > SPACES
  8141         MOVE AL-UANON       TO BILNT1A
  8142     END-IF
  8143
  8144     IF BILNT2I > SPACES
  8145         MOVE AL-UANON       TO BILNT2A
  8146     END-IF
  8147     .
  8148 0600-EXIT.
  8149      EXIT.
  8150 0800-DELETE-TS.
  8151
  8152* EXEC CICS DELETEQ TS
  8153*        QUEUE(QID)
  8154*    END-EXEC
  8155*    MOVE '*&                    #   #00007534' TO DFHEIV0
  8156     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8157     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8158     MOVE X'2020233030303037353334' TO DFHEIV0(25:11)
  8159     CALL 'kxdfhei1' USING DFHEIV0,
  8160           QID,
  8161           DFHEIV99
  8162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8163     .
  8164 0800-EXIT.
  8165      EXIT.
  8166 1000-BUILD-ERARCH.
  8167     MOVE SPACES                 TO W-CNTL-KEY
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 143
* EL6318.cbl
  8168     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
  8169     MOVE '1'                    TO W-CNTL-RECORD-TYPE
  8170     MOVE ZEROS                  TO W-CNTL-SEQ-NO
  8171
  8172* EXEC CICS READ
  8173*         DATASET    (WS-ELCNTL-FILE-ID)
  8174*         SET        (ADDRESS OF CONTROL-FILE)
  8175*         RIDFLD     (W-CNTL-KEY)
  8176*         UPDATE
  8177*         RESP       (WS-RESPONSE)
  8178*    END-EXEC
  8179*    MOVE '&"S        EU         (  N#00007545' TO DFHEIV0
  8180     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8181     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8182     MOVE X'204E233030303037353435' TO DFHEIV0(25:11)
  8183     CALL 'kxdfhei1' USING DFHEIV0,
  8184           WS-ELCNTL-FILE-ID,
  8185           DFHEIV20,
  8186           DFHEIV99,
  8187           W-CNTL-KEY,
  8188           DFHEIV99,
  8189           DFHEIV99,
  8190           DFHEIV99
  8191     SET ADDRESS OF CONTROL-FILE TO
  8192         DFHEIV20
  8193     MOVE EIBRESP  TO WS-RESPONSE
  8194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8195     IF RESP-NORMAL
  8196        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  8197           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  8198        END-IF
  8199        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  8200        MOVE CF-CREDIT-LAST-ARCH-NUM
  8201                                 TO W-ARCH-NUMBER
  8202
  8203* EXEC CICS REWRITE
  8204*          FROM      (CONTROL-FILE)
  8205*          DATASET   (WS-ELCNTL-FILE-ID)
  8206*       END-EXEC
  8207     MOVE LENGTH OF
  8208      CONTROL-FILE
  8209       TO DFHEIV11
  8210*    MOVE '&& L                  %   #00007559' TO DFHEIV0
  8211     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8212     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8213     MOVE X'2020233030303037353539' TO DFHEIV0(25:11)
  8214     CALL 'kxdfhei1' USING DFHEIV0,
  8215           WS-ELCNTL-FILE-ID,
  8216           CONTROL-FILE,
  8217           DFHEIV11,
  8218           DFHEIV99
  8219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8220     END-IF
  8221
  8222* EXEC CICS GETMAIN
  8223*       SET      (ADDRESS OF LETTER-ARCHIVE)
  8224*       LENGTH   (W-ARCH-LENGTH)
  8225*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 144
* EL6318.cbl
  8226*    MOVE '," L                  $   #00007564' TO DFHEIV0
  8227     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  8228     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8229     MOVE X'2020233030303037353634' TO DFHEIV0(25:11)
  8230     CALL 'kxdfhei1' USING DFHEIV0,
  8231           DFHEIV20,
  8232           W-ARCH-LENGTH,
  8233           DFHEIV99
  8234     SET ADDRESS OF LETTER-ARCHIVE TO
  8235         DFHEIV20
  8236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8237     MOVE 'LA'                   TO LETTER-ARCHIVE
  8238     MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
  8239                                    LA-ARCHIVE-NO-A2
  8240                                    LA-ARCHIVE-NO-A3
  8241                                    LA-ARCHIVE-NO-A4
  8242                                    LA-ARCHIVE-NO-A5
  8243                                    LA-ARCHIVE-NO-A6
  8244     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8245                                    LA-COMPANY-CD-A2
  8246                                    LA-COMPANY-CD-A3
  8247                                    LA-COMPANY-CD-A4
  8248                                    LA-COMPANY-CD-A5
  8249                                    LA-COMPANY-CD-A6
  8250     MOVE PB-CARRIER             TO LA-CARRIER-A2
  8251                                    LA-CARRIER-A3
  8252                                    LA-CARRIER-A4
  8253                                    LA-CARRIER-A5
  8254     MOVE Pb-cert-eff-dt         TO LA-EFFECT-DATE-A2
  8255     MOVE PB-GROUPING            TO LA-GROUPING-A2
  8256                                    LA-GROUPING-A3
  8257                                    LA-GROUPING-A4
  8258                                    LA-GROUPING-A5
  8259     MOVE PB-ACCOUNT             TO LA-ACCOUNT-A2
  8260                                    LA-ACCOUNT-A3
  8261                                    LA-ACCOUNT-A4
  8262                                    LA-ACCOUNT-A5
  8263     MOVE PB-STATE               TO LA-STATE-A2
  8264                                    LA-STATE-A3
  8265                                    LA-STATE-A4
  8266                                    LA-STATE-A5
  8267     MOVE PB-CERT-PRIME          TO LA-CERT-PRIME-A2
  8268     MOVE PB-CERT-SFX            TO LA-CERT-SUFFIX-A2
  8269     MOVE PB-ENTRY-BATCH         TO LA-ENTRY-A6
  8270     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD
  8271     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  8272                                    LA-INITIAL-PRINT-DATE
  8273                                    LA-SENT-DATE
  8274                                    LA-REPLY-DATE
  8275                                    LA-RESEND-DATE
  8276                                    LA-FOLLOW-UP-DATE
  8277     MOVE 'A'                    TO LA-STATUS
  8278     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  8279     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  8280     MOVE LTRIDI                 TO LA-FORM-A3
  8281     MOVE '4'                    TO LA-DATA-SOURCE
  8282     MOVE WS-CURRENT-BIN-DT      TO LA-CREATION-DATE
  8283     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 145
* EL6318.cbl
  8284                                    LA-NO-OF-TEXT-RECORDS
  8285
  8286* EXEC CICS WRITE
  8287*         DATASET   ('ERARCH')
  8288*         FROM      (LETTER-ARCHIVE)
  8289*         RIDFLD    (LA-CONTROL-PRIMARY)
  8290*         RESP      (WS-RESPONSE)
  8291*    END-EXEC
  8292     MOVE LENGTH OF
  8293      LETTER-ARCHIVE
  8294       TO DFHEIV11
  8295     MOVE 'ERARCH' TO DFHEIV1
  8296*    MOVE '&$ L                  ''  N#00007616' TO DFHEIV0
  8297     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8298     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8299     MOVE X'204E233030303037363136' TO DFHEIV0(25:11)
  8300     CALL 'kxdfhei1' USING DFHEIV0,
  8301           DFHEIV1,
  8302           LETTER-ARCHIVE,
  8303           DFHEIV11,
  8304           LA-CONTROL-PRIMARY,
  8305           DFHEIV99,
  8306           DFHEIV99
  8307     MOVE EIBRESP  TO WS-RESPONSE
  8308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8309     IF RESP-NORMAL
  8310        MOVE ER-0280             TO EMI-ERROR
  8311        MOVE -1                  TO SIGREQL
  8312        PERFORM 9900-ERROR-FORMAT
  8313                                 THRU 9900-EXIT
  8314        MOVE W-ARCH-NUMBER       TO W-ARCH-SUPPRESS
  8315        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  8316     ELSE
  8317        MOVE ER-7345             TO EMI-ERROR
  8318        MOVE -1                  TO SIGREQL
  8319        PERFORM 9900-ERROR-FORMAT
  8320                                 THRU 9900-EXIT
  8321     END-IF
  8322     .
  8323 1000-EXIT.
  8324     EXIT.
  8325 1100-CALL-NS-BUS-LOGIC.
  8326     MOVE SPACES                 TO BL-INPUT
  8327     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  8328     IF PI-RETURN-TO-PROGRAM EQUAL 'EL6314'
  8329         MOVE '2'                TO BL-DATA-SRCE
  8330         MOVE SPACES             TO BL-BATCH-NO
  8331         MOVE ZEROS              TO BL-BATCH-SEQ
  8332     ELSE
  8333         MOVE '4'                TO BL-DATA-SRCE
  8334         MOVE PB-ENTRY-BATCH     TO BL-BATCH-NO
  8335         MOVE PB-BATCH-SEQ-NO    TO BL-BATCH-SEQ
  8336     END-IF
  8337     MOVE PI-CARRIER             TO BL-CARRIER
  8338     MOVE PI-GROUPING            TO BL-GROUP
  8339     MOVE PI-STATE               TO BL-STATE
  8340     MOVE PI-ACCOUNT             TO BL-ACCOUNT
  8341     IF PI-CERT-EFF-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 146
* EL6318.cbl
  8342        MOVE PI-CERT-EFF-DT      TO DC-BIN-DATE-1
  8343        MOVE ' '                 TO DC-OPTION-CODE
  8344        PERFORM 9700-date-link
  8345        IF NO-CONVERSION-ERROR
  8346           MOVE DC-GREG-DATE-B-EDIT
  8347                                 TO BL-EFF-DT
  8348        END-IF
  8349     END-IF
  8350     MOVE PI-CERT-NO             TO BL-CERT-NO
  8351     MOVE SPACES                 TO BL-RESP-NO
  8352     MOVE LTRIDI                 TO BL-LETTER-ID
  8353     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  8354     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  8355*    MOVE 'ALWA'                 TO BL-PROC-ID
  8356     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  8357*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
  8358*    MOVE IFF-ENC-CD             TO BL-ENC-CD
  8359     MOVE PI-ENCCODE             TO BL-ENC-CD
  8360     IF EIBAID = DFHPF4
  8361        MOVE 'B'                 TO BL-WRITE-ERARCH
  8362     ELSE
  8363        MOVE 'T'                 TO BL-WRITE-ERARCH
  8364     END-IF
  8365     MOVE CERTIDI                TO BL-CERT-FORM-ID
  8366     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  8367     MOVE 'ISS ENDT'             TO BL-SOURCE-SCREEN
  8368     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  8369        IF REACD-IN (S1) NOT = LOW-VALUES
  8370           MOVE REACD-IN (S1)    TO BL-REASON-CODE (S1)
  8371        END-IF
  8372     END-PERFORM
  8373*****************************************
  8374* Invoke the LETTER business logic
  8375*****************************************
  8376
  8377* exec cics link
  8378*       program('NSRASBL')
  8379*       commarea(srch-commarea)
  8380*    end-exec.
  8381     MOVE LENGTH OF
  8382      srch-commarea
  8383       TO DFHEIV11
  8384     MOVE 'NSRASBL' TO DFHEIV1
  8385*    MOVE '."C                   (   #00007689' TO DFHEIV0
  8386     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8387     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8388     MOVE X'2020233030303037363839' TO DFHEIV0(25:11)
  8389     CALL 'kxdfhei1' USING DFHEIV0,
  8390           DFHEIV1,
  8391           srch-commarea,
  8392           DFHEIV11,
  8393           DFHEIV99,
  8394           DFHEIV99,
  8395           DFHEIV99,
  8396           DFHEIV99
  8397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8398
  8399     .
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 147
* EL6318.cbl
  8400 1100-EXIT.
  8401     EXIT.
  8402 1500-GET-ARCH-NO.
  8403     MOVE SPACES                 TO ELCNTL-KEY
  8404     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  8405     MOVE '1'                    TO CNTL-REC-TYPE
  8406     MOVE ZEROS                  TO CNTL-SEQ
  8407
  8408* EXEC CICS READ
  8409*         DATASET    (WS-ELCNTL-FILE-ID)
  8410*         SET        (ADDRESS OF CONTROL-FILE)
  8411*         RIDFLD     (ELCNTL-KEY)
  8412*         UPDATE
  8413*         RESP       (WS-RESPONSE)
  8414*    END-EXEC
  8415*    MOVE '&"S        EU         (  N#00007701' TO DFHEIV0
  8416     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8417     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8418     MOVE X'204E233030303037373031' TO DFHEIV0(25:11)
  8419     CALL 'kxdfhei1' USING DFHEIV0,
  8420           WS-ELCNTL-FILE-ID,
  8421           DFHEIV20,
  8422           DFHEIV99,
  8423           ELCNTL-KEY,
  8424           DFHEIV99,
  8425           DFHEIV99,
  8426           DFHEIV99
  8427     SET ADDRESS OF CONTROL-FILE TO
  8428         DFHEIV20
  8429     MOVE EIBRESP  TO WS-RESPONSE
  8430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8431     IF RESP-NORMAL
  8432        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  8433           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  8434        END-IF
  8435        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  8436        MOVE CF-CREDIT-LAST-ARCH-NUM
  8437                                 TO W-ARCH-NUMBER
  8438
  8439* EXEC CICS REWRITE
  8440*          FROM      (CONTROL-FILE)
  8441*          DATASET   (WS-ELCNTL-FILE-ID)
  8442*       END-EXEC
  8443     MOVE LENGTH OF
  8444      CONTROL-FILE
  8445       TO DFHEIV11
  8446*    MOVE '&& L                  %   #00007715' TO DFHEIV0
  8447     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8448     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8449     MOVE X'2020233030303037373135' TO DFHEIV0(25:11)
  8450     CALL 'kxdfhei1' USING DFHEIV0,
  8451           WS-ELCNTL-FILE-ID,
  8452           CONTROL-FILE,
  8453           DFHEIV11,
  8454           DFHEIV99
  8455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8456     END-IF
  8457     .
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 148
* EL6318.cbl
  8458 1500-EXIT.
  8459     EXIT.
  8460
  8461
  8462 1700-WRITE-CERT-NOTE      SECTION.
  8463
  8464     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  8465     MOVE ZERO           TO ERCNOT-SEQ.
  8466     SET TB-INDX         DOWN BY 1.
  8467     SET TB-INDX1        TO TB-INDX.
  8468
  8469****DELETE CURRENT CERT NOTES
  8470 1700-LOOP.
  8471
  8472* EXEC CICS READ
  8473*        DATASET (WS-ERCNOT-FILE-ID)
  8474*        RIDFLD  (ERCNOT-KEY)
  8475*        SET     (ADDRESS OF CERT-NOTE-FILE)
  8476*        RESP    (WS-RESPONSE)
  8477*        GTEQ
  8478*    END-EXEC.
  8479*    MOVE '&"S        G          (  N#00007734' TO DFHEIV0
  8480     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8481     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8482     MOVE X'204E233030303037373334' TO DFHEIV0(25:11)
  8483     CALL 'kxdfhei1' USING DFHEIV0,
  8484           WS-ERCNOT-FILE-ID,
  8485           DFHEIV20,
  8486           DFHEIV99,
  8487           ERCNOT-KEY,
  8488           DFHEIV99,
  8489           DFHEIV99,
  8490           DFHEIV99
  8491     SET ADDRESS OF CERT-NOTE-FILE TO
  8492         DFHEIV20
  8493     MOVE EIBRESP  TO WS-RESPONSE
  8494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8495
  8496
  8497     IF NOT RESP-NORMAL
  8498        GO TO 1700-ENDDEL
  8499     END-IF
  8500
  8501     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  8502
  8503     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  8504         GO TO 1700-ENDDEL
  8505     END-IF.
  8506
  8507
  8508* EXEC CICS DELETE
  8509*        DATASET (WS-ERCNOT-FILE-ID)
  8510*        RIDFLD  (ERCNOT-KEY)
  8511*    END-EXEC.
  8512*    MOVE '&(  R                 &   #00007752' TO DFHEIV0
  8513     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  8514     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8515     MOVE X'2020233030303037373532' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 149
* EL6318.cbl
  8516     CALL 'kxdfhei1' USING DFHEIV0,
  8517           WS-ERCNOT-FILE-ID,
  8518           ERCNOT-KEY,
  8519           DFHEIV99,
  8520           DFHEIV99,
  8521           DFHEIV99
  8522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8523
  8524
  8525     GO TO 1700-LOOP.
  8526
  8527 1700-ENDDEL.
  8528
  8529
  8530* EXEC CICS GETMAIN
  8531*         LENGTH(ERCNOT-LENGTH)
  8532*         SET(ADDRESS OF CERT-NOTE-FILE)
  8533*         INITIMG(GETMAIN-SPACE)
  8534*    END-EXEC.
  8535*    MOVE ',"IL                  $   #00007761' TO DFHEIV0
  8536     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8537     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8538     MOVE X'2020233030303037373631' TO DFHEIV0(25:11)
  8539     CALL 'kxdfhei1' USING DFHEIV0,
  8540           DFHEIV20,
  8541           ERCNOT-LENGTH,
  8542           GETMAIN-SPACE
  8543     SET ADDRESS OF CERT-NOTE-FILE TO
  8544         DFHEIV20
  8545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8546
  8547
  8548     SET TB-INDX TO 1.
  8549     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  8550     MOVE +0             TO ERCNOT-SEQ
  8551
  8552     PERFORM VARYING TB-INDX FROM 1 BY 1
  8553             UNTIL TB-INDX > TB-INDX1
  8554        MOVE SPACES                 TO  CERT-NOTE-FILE
  8555        ADD 1                       TO  ERCNOT-SEQ
  8556        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  8557        MOVE  'CZ'                  TO  CZ-RECORD-ID
  8558        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  8559        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  8560                                    TO  CZ-LAST-MAINT-USER
  8561        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  8562                                    TO  CZ-LAST-MAINT-HHMMSS
  8563        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  8564                                    TO  CZ-LAST-MAINT-DT
  8565
  8566
  8567* EXEC CICS WRITE
  8568*            DATASET(WS-ERCNOT-FILE-ID)
  8569*            FROM(CERT-NOTE-FILE)
  8570*            RIDFLD(ERCNOT-KEY)
  8571*       END-EXEC
  8572     MOVE LENGTH OF
  8573      CERT-NOTE-FILE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 150
* EL6318.cbl
  8574       TO DFHEIV11
  8575*    MOVE '&$ L                  ''   #00007785' TO DFHEIV0
  8576     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8577     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8578     MOVE X'2020233030303037373835' TO DFHEIV0(25:11)
  8579     CALL 'kxdfhei1' USING DFHEIV0,
  8580           WS-ERCNOT-FILE-ID,
  8581           CERT-NOTE-FILE,
  8582           DFHEIV11,
  8583           ERCNOT-KEY,
  8584           DFHEIV99,
  8585           DFHEIV99
  8586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8587     END-PERFORM
  8588
  8589     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8590     IF RESP-NORMAL
  8591        EVALUATE CM-NOTE-SW
  8592           WHEN '1'
  8593           WHEN '3'
  8594           WHEN '5'
  8595           WHEN '7'
  8596              SET NO-CERT-RW     TO TRUE
  8597           WHEN ' '
  8598              MOVE '1'           TO CM-NOTE-SW
  8599           WHEN '2'
  8600              MOVE '3'           TO CM-NOTE-SW
  8601           WHEN '4'
  8602              MOVE '5'           TO CM-NOTE-SW
  8603           WHEN '6'
  8604              MOVE '7'           TO CM-NOTE-SW
  8605        END-EVALUATE
  8606     END-IF
  8607     IF NOT NO-CERT-RW
  8608        PERFORM 1810-REWRITE-ELCERT
  8609                                 THRU 1810-EXIT
  8610     ELSE
  8611
  8612* EXEC CICS UNLOCK
  8613*          DATASET    (WS-ELCERT-FILE-ID)
  8614*       END-EXEC
  8615*    MOVE '&*                    #   #00007814' TO DFHEIV0
  8616     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8617     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8618     MOVE X'2020233030303037383134' TO DFHEIV0(25:11)
  8619     CALL 'kxdfhei1' USING DFHEIV0,
  8620           WS-ELCERT-FILE-ID,
  8621           DFHEIV99
  8622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8623     END-IF
  8624
  8625     .
  8626 1799-EXIT.
  8627     EXIT.
  8628
  8629 1800-READ-ELCERT-UPDATE.
  8630
  8631     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 151
* EL6318.cbl
  8632     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  8633     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  8634     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  8635     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  8636     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  8637     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  8638     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  8639
  8640
  8641* EXEC CICS READ
  8642*        UPDATE
  8643*        DATASET  (WS-ELCERT-FILE-ID)
  8644*        RIDFLD   (WS-ELCERT-KEY)
  8645*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8646*        RESP     (WS-RESPONSE)
  8647*    END-EXEC
  8648*    MOVE '&"S        EU         (  N#00007834' TO DFHEIV0
  8649     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8650     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8651     MOVE X'204E233030303037383334' TO DFHEIV0(25:11)
  8652     CALL 'kxdfhei1' USING DFHEIV0,
  8653           WS-ELCERT-FILE-ID,
  8654           DFHEIV20,
  8655           DFHEIV99,
  8656           WS-ELCERT-KEY,
  8657           DFHEIV99,
  8658           DFHEIV99,
  8659           DFHEIV99
  8660     SET ADDRESS OF CERTIFICATE-MASTER TO
  8661         DFHEIV20
  8662     MOVE EIBRESP  TO WS-RESPONSE
  8663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8664
  8665     .
  8666 1800-EXIT.
  8667     EXIT.
  8668
  8669 1810-REWRITE-ELCERT.
  8670
  8671
  8672* EXEC CICS REWRITE
  8673*        FROM     (CERTIFICATE-MASTER)
  8674*        DATASET  (WS-ELCERT-FILE-ID)
  8675*        RESP     (WS-RESPONSE)
  8676*    END-EXEC.
  8677     MOVE LENGTH OF
  8678      CERTIFICATE-MASTER
  8679       TO DFHEIV11
  8680*    MOVE '&& L                  %  N#00007848' TO DFHEIV0
  8681     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8682     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8683     MOVE X'204E233030303037383438' TO DFHEIV0(25:11)
  8684     CALL 'kxdfhei1' USING DFHEIV0,
  8685           WS-ELCERT-FILE-ID,
  8686           CERTIFICATE-MASTER,
  8687           DFHEIV11,
  8688           DFHEIV99
  8689     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 152
* EL6318.cbl
  8690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8691
  8692
  8693     .
  8694 1810-EXIT.
  8695     EXIT.
  8696
  8697 8100-SEND-INITIAL-MAP.
  8698     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8699     MOVE '5'                    TO DC-OPTION-CODE.
  8700     PERFORM 9700-DATE-LINK.
  8701     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8702     MOVE EIBTIME                TO TIME-IN.
  8703     MOVE TIME-OUT               TO TIMEO.
  8704     MOVE -1                     TO SIGREQL
  8705     IF PI-PROCESSOR-IS-CSR-SUPER
  8706        perform varying s1 from +1 by +1 until
  8707           s1 > +12
  8708           MOVE AL-UANON            TO reacda (s1)
  8709        end-perform
  8710     END-IF
  8711     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  8712     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  8713
  8714* EXEC CICS SEND
  8715*        MAP      (MAP-NAME)
  8716*        MAPSET   (MAPSET-NAME)
  8717*        FROM     (EL631KO)
  8718*        ERASE
  8719*        CURSOR
  8720*    END-EXEC.
  8721     MOVE LENGTH OF
  8722      EL631KO
  8723       TO DFHEIV12
  8724     MOVE -1
  8725       TO DFHEIV11
  8726*    MOVE '8$     CT  E    H L F ,   #00007874' TO DFHEIV0
  8727     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8728     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8729     MOVE X'2020233030303037383734' TO DFHEIV0(25:11)
  8730     CALL 'kxdfhei1' USING DFHEIV0,
  8731           MAP-NAME,
  8732           EL631KO,
  8733           DFHEIV12,
  8734           MAPSET-NAME,
  8735           DFHEIV99,
  8736           DFHEIV99,
  8737           DFHEIV99,
  8738           DFHEIV11,
  8739           DFHEIV99,
  8740           DFHEIV99,
  8741           DFHEIV99
  8742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8743
  8744     GO TO 9100-RETURN-TRAN.
  8745 8200-SEND-DATAONLY.
  8746     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8747     MOVE '5'                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 153
* EL6318.cbl
  8748     PERFORM 9700-DATE-LINK.
  8749     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8750     MOVE EIBTIME                TO TIME-IN.
  8751     MOVE TIME-OUT               TO TIMEO.
  8752     MOVE -1                     TO PFENTRL
  8753     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  8754     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  8755
  8756* EXEC CICS SEND
  8757*        MAP      (MAP-NAME)
  8758*        MAPSET   (MAPSET-NAME)
  8759*        FROM     (EL631KO)
  8760*        DATAONLY
  8761*        ERASEAUP
  8762*        CURSOR
  8763*    END-EXEC.
  8764     MOVE LENGTH OF
  8765      EL631KO
  8766       TO DFHEIV12
  8767     MOVE -1
  8768       TO DFHEIV11
  8769*    MOVE '8$D    CT  A    H L F ,   #00007892' TO DFHEIV0
  8770     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  8771     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8772     MOVE X'2020233030303037383932' TO DFHEIV0(25:11)
  8773     CALL 'kxdfhei1' USING DFHEIV0,
  8774           MAP-NAME,
  8775           EL631KO,
  8776           DFHEIV12,
  8777           MAPSET-NAME,
  8778           DFHEIV99,
  8779           DFHEIV99,
  8780           DFHEIV99,
  8781           DFHEIV11,
  8782           DFHEIV99,
  8783           DFHEIV99,
  8784           DFHEIV99
  8785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8786
  8787     GO TO 9100-RETURN-TRAN.
  8788 8300-SEND-TEXT.
  8789
  8790* EXEC CICS SEND TEXT
  8791*        FROM     (LOGOFF-TEXT)
  8792*        LENGTH   (LOGOFF-LENGTH)
  8793*        ERASE
  8794*        FREEKB
  8795*    END-EXEC.
  8796*    MOVE '8&      T  E F  H   F -   #00007902' TO DFHEIV0
  8797     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8798     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8799     MOVE X'2020233030303037393032' TO DFHEIV0(25:11)
  8800     CALL 'kxdfhei1' USING DFHEIV0,
  8801           LOGOFF-TEXT,
  8802           LOGOFF-LENGTH,
  8803           DFHEIV99,
  8804           DFHEIV99,
  8805           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 154
* EL6318.cbl
  8806           DFHEIV99,
  8807           DFHEIV99,
  8808           DFHEIV99,
  8809           DFHEIV99,
  8810           DFHEIV99,
  8811           DFHEIV99,
  8812           DFHEIV99
  8813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8814
  8815
  8816* EXEC CICS RETURN
  8817*    END-EXEC.
  8818*    MOVE '.(                    ''   #00007908' TO DFHEIV0
  8819     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8820     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8821     MOVE X'2020233030303037393038' TO DFHEIV0(25:11)
  8822     CALL 'kxdfhei1' USING DFHEIV0,
  8823           DFHEIV99,
  8824           DFHEIV99,
  8825           DFHEIV99,
  8826           DFHEIV99,
  8827           DFHEIV99,
  8828           DFHEIV99
  8829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8830
  8831 8800-UNAUTHORIZED-ACCESS.
  8832     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8833     GO TO 8300-SEND-TEXT.
  8834 8810-PF23.
  8835     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  8836     MOVE XCTL-005               TO PGM-NAME.
  8837     GO TO 9300-XCTL.
  8838 9000-RETURN-CICS.
  8839
  8840* EXEC CICS RETURN
  8841*    END-EXEC.
  8842*    MOVE '.(                    ''   #00007918' TO DFHEIV0
  8843     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8844     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8845     MOVE X'2020233030303037393138' TO DFHEIV0(25:11)
  8846     CALL 'kxdfhei1' USING DFHEIV0,
  8847           DFHEIV99,
  8848           DFHEIV99,
  8849           DFHEIV99,
  8850           DFHEIV99,
  8851           DFHEIV99,
  8852           DFHEIV99
  8853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8854
  8855 9100-RETURN-TRAN.
  8856     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  8857     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  8858
  8859* EXEC CICS RETURN
  8860*        TRANSID    (TRANS-ID)
  8861*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8862*        LENGTH     (1300)
  8863*        LENGTH     (PI-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 155
* EL6318.cbl
  8864*    END-EXEC.
  8865     MOVE 1300
  8866       TO DFHEIV11
  8867*    MOVE '.(CT                  ''   #00007923' TO DFHEIV0
  8868     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8869     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8870     MOVE X'2020233030303037393233' TO DFHEIV0(25:11)
  8871     CALL 'kxdfhei1' USING DFHEIV0,
  8872           TRANS-ID,
  8873           PROGRAM-INTERFACE-BLOCK,
  8874           DFHEIV11,
  8875           DFHEIV99,
  8876           DFHEIV99,
  8877           DFHEIV99
  8878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8879
  8880 9200-RETURN-MAIN-MENU.
  8881     MOVE XCTL-626               TO PGM-NAME.
  8882     GO TO 9300-XCTL.
  8883 9300-XCTL.
  8884
  8885* EXEC CICS XCTL
  8886*        PROGRAM    (PGM-NAME)
  8887*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8888*        LENGTH     (PI-COMM-LENGTH)
  8889*    END-EXEC.
  8890*    MOVE '.$C                   %   #00007933' TO DFHEIV0
  8891     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8892     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8893     MOVE X'2020233030303037393333' TO DFHEIV0(25:11)
  8894     CALL 'kxdfhei1' USING DFHEIV0,
  8895           PGM-NAME,
  8896           PROGRAM-INTERFACE-BLOCK,
  8897           PI-COMM-LENGTH,
  8898           DFHEIV99
  8899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8900
  8901 9400-CLEAR.
  8902     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  8903
  8904* EXEC CICS XCTL
  8905*        PROGRAM    (PGM-NAME)
  8906*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8907*        LENGTH     (PI-COMM-LENGTH)
  8908*    END-EXEC.
  8909*    MOVE '.$C                   %   #00007940' TO DFHEIV0
  8910     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8911     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8912     MOVE X'2020233030303037393430' TO DFHEIV0(25:11)
  8913     CALL 'kxdfhei1' USING DFHEIV0,
  8914           PGM-NAME,
  8915           PROGRAM-INTERFACE-BLOCK,
  8916           PI-COMM-LENGTH,
  8917           DFHEIV99
  8918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8919
  8920 9500-PF12.
  8921     MOVE XCTL-010               TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 156
* EL6318.cbl
  8922     GO TO 9300-XCTL.
  8923 9600-PGMID-ERROR.
  8924
  8925* EXEC CICS HANDLE CONDITION
  8926*        PGMIDERR    (8300-SEND-TEXT)
  8927*    END-EXEC.
  8928*    MOVE '"$L                   ! " #00007949' TO DFHEIV0
  8929     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8930     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8931     MOVE X'2220233030303037393439' TO DFHEIV0(25:11)
  8932     CALL 'kxdfhei1' USING DFHEIV0
  8933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8934
  8935     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  8936     MOVE ' '                    TO PI-ENTRY-CD-1.
  8937     MOVE XCTL-005               TO PGM-NAME.
  8938     MOVE PGM-NAME               TO LOGOFF-PGM.
  8939     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  8940     GO TO 9300-XCTL.
  8941 9700-DATE-LINK.
  8942     MOVE LINK-ELDATCV           TO PGM-NAME.
  8943
  8944* EXEC CICS LINK
  8945*        PROGRAM    (PGM-NAME)
  8946*        COMMAREA   (DATE-CONVERSION-DATA)
  8947*        LENGTH     (DC-COMM-LENGTH)
  8948*    END-EXEC.
  8949*    MOVE '."C                   (   #00007960' TO DFHEIV0
  8950     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8951     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8952     MOVE X'2020233030303037393630' TO DFHEIV0(25:11)
  8953     CALL 'kxdfhei1' USING DFHEIV0,
  8954           PGM-NAME,
  8955           DATE-CONVERSION-DATA,
  8956           DC-COMM-LENGTH,
  8957           DFHEIV99,
  8958           DFHEIV99,
  8959           DFHEIV99,
  8960           DFHEIV99
  8961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8962
  8963 9900-ERROR-FORMAT.
  8964     IF NOT EMI-ERRORS-COMPLETE
  8965        MOVE LINK-001            TO PGM-NAME
  8966
  8967* EXEC CICS LINK
  8968*           PROGRAM    (PGM-NAME)
  8969*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8970*           LENGTH     (EMI-COMM-LENGTH)
  8971*       END-EXEC
  8972*    MOVE '."C                   (   #00007968' TO DFHEIV0
  8973     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8974     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8975     MOVE X'2020233030303037393638' TO DFHEIV0(25:11)
  8976     CALL 'kxdfhei1' USING DFHEIV0,
  8977           PGM-NAME,
  8978           ERROR-MESSAGE-INTERFACE-BLOCK,
  8979           EMI-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 157
* EL6318.cbl
  8980           DFHEIV99,
  8981           DFHEIV99,
  8982           DFHEIV99,
  8983           DFHEIV99
  8984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8985     END-IF
  8986     .
  8987 9900-EXIT.
  8988     EXIT.
  8989 9990-ABEND.
  8990     MOVE LINK-004               TO PGM-NAME.
  8991     MOVE DFHEIBLK               TO EMI-LINE1.
  8992
  8993* EXEC CICS LINK
  8994*        PROGRAM   (PGM-NAME)
  8995*        COMMAREA  (EMI-LINE1)
  8996*        LENGTH    (72)
  8997*    END-EXEC.
  8998     MOVE 72
  8999       TO DFHEIV11
  9000*    MOVE '."C                   (   #00007980' TO DFHEIV0
  9001     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9002     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9003     MOVE X'2020233030303037393830' TO DFHEIV0(25:11)
  9004     CALL 'kxdfhei1' USING DFHEIV0,
  9005           PGM-NAME,
  9006           EMI-LINE1,
  9007           DFHEIV11,
  9008           DFHEIV99,
  9009           DFHEIV99,
  9010           DFHEIV99,
  9011           DFHEIV99
  9012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9013
  9014     GO TO 8200-SEND-DATAONLY.
  9015
  9016* GOBACK.
  9017     MOVE '9%                    "   ' TO DFHEIV0
  9018     MOVE 'EL6318' TO DFHEIV1
  9019     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9020     GOBACK.
  9021 9995-SECURITY-VIOLATION.
  9022*                            COPY ELCSCTP.
  9023******************************************************************
  9024*                                                                *
  9025*                            ELCSCTP                             *
  9026*                            VMOD=2.001                          *
  9027*                                                                *
  9028*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  9029******************************************************************
  9030
  9031
  9032     MOVE EIBDATE          TO SM-JUL-DATE.
  9033     MOVE EIBTRMID         TO SM-TERMID.
  9034     MOVE THIS-PGM         TO SM-PGM.
  9035     MOVE EIBTIME          TO TIME-IN.
  9036     MOVE TIME-OUT         TO SM-TIME.
  9037     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 158
* EL6318.cbl
  9038
  9039
  9040* EXEC CICS LINK
  9041*         PROGRAM  ('EL003')
  9042*         COMMAREA (SECURITY-MESSAGE)
  9043*         LENGTH   (80)
  9044*    END-EXEC.
  9045     MOVE 'EL003' TO DFHEIV1
  9046     MOVE 80
  9047       TO DFHEIV11
  9048*    MOVE '."C                   (   #00008005' TO DFHEIV0
  9049     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9050     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9051     MOVE X'2020233030303038303035' TO DFHEIV0(25:11)
  9052     CALL 'kxdfhei1' USING DFHEIV0,
  9053           DFHEIV1,
  9054           SECURITY-MESSAGE,
  9055           DFHEIV11,
  9056           DFHEIV99,
  9057           DFHEIV99,
  9058           DFHEIV99,
  9059           DFHEIV99
  9060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9061
  9062
  9063******************************************************************
  9064
  9065 9995-EXIT.
  9066     EXIT.
  9067
  9068 9999-DFHBACK SECTION.
  9069     MOVE '9%                    "   ' TO DFHEIV0
  9070     MOVE 'EL6318' TO DFHEIV1
  9071     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9072     GOBACK.
  9073 9999-DFHEXIT.
  9074     IF DFHEIGDJ EQUAL 0001
  9075         NEXT SENTENCE
  9076     ELSE IF DFHEIGDJ EQUAL 2
  9077         GO TO 8300-SEND-TEXT
  9078         DEPENDING ON DFHEIGDI.
  9079     MOVE '9%                    "   ' TO DFHEIV0
  9080     MOVE 'EL6318' TO DFHEIV1
  9081     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9082     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       35428     Code:       20870
