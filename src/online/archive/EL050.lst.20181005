* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55* 013017  CR2016053100001  PEMA  ACH PROCESSING
    56* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
    57* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    58******************************************************************
    59 ENVIRONMENT DIVISION.
    60
    61 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page   3
* EL050.cbl
    63 WORKING-STORAGE SECTION.
    64 01  DFH-START PIC X(04).
    65
    66 77  FILLER   PIC X(32) VALUE '********************************'.
    67 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    68 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    69
    70 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    71 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    72                                   USAGE POINTER.
    73 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    74 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    75 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    76                                   USAGE IS POINTER.
    77 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    78 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    79                                   USAGE IS POINTER.
    80 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    81 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    82                                   USAGE IS POINTER.
    83
    84 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    85 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    86                                   USAGE IS POINTER.
    87
    88*    COPY ELC50WS.
    89*****************************************************************
    90*                                                               *
    91*                            ELC50WS.                           *
    92*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    93*                            VMOD=2.061.                        *
    94*                                                               *
    95*   THIS IS THE WORKING STORAGE FOR EL050                       *
    96*                                   EL517                       *
    97*****************************************************************
    98******************************************************************
    99*                   C H A N G E   L O G
   100*
   101* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   102*-----------------------------------------------------------------
   103*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   104* EFFECTIVE    NUMBER
   105*-----------------------------------------------------------------
   106* 123102                   PEMA  ADD DCC PROCESSING
   107* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   108* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   109* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   110* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   111* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   112* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   113* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   114* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   115* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   116* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   117* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   118* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   119* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   120* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page   4
* EL050.cbl
   121* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   122* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   123* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   124* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   125* 030309  CR2009021700001  PEMA  ADD ER-2883
   126* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   127* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   128* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   129* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   130* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   131* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   132* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   133* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   134* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   135* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   136* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   137* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   138* 061412  CR2011022800001  AJRA  NAPERSOFT
   139* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   140* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   141* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   142* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   143* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   144* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   145* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   146* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   147* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   148* 091114  IR2014091000001  TANA  ADD ERROR 2898
   149* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   150* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   151* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
   152* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
   153* 100617  CR2017062000003  PEMA  Inforce state comm cap
   154* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
   155* 062017  CR2015091000001  PEMA  ADD ST INT RATE FIELD
   156* 030118  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
   157* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
   158*-----------------------------------------------------------------
   159
   160 01  WORK-AREAS.
   161
   162*****************************************************************
   163*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   164*****************************************************************
   165
   166     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   167     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   168     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   169     12  WS-NAME-EDIT-WORK-AREA.
   170         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   171         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   172             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   173         16  WS-WORK-NAME.
   174             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   175             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   176             20  FILLER           PIC X(10)     VALUE SPACES.
   177         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   178             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page   5
* EL050.cbl
   179
   180*****************************************************************
   181*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   182*****************************************************************
   183
   184     12  WS-ERRESC-KEY.
   185         16 WS-ERRESC-SEARCH-KEY.
   186             20  WS-ERRESC-COMPANY-CD PIC  X.
   187             20  WS-ERRESC-CARRIER    PIC  X.
   188             20  WS-ERRESC-GROUP      PIC X(6).
   189             20  WS-ERRESC-STATE      PIC XX.
   190             20  WS-ERRESC-ACCOUNT    PIC X(10).
   191         16 WS-ERRESC-RESIDUAL-KEY.
   192             20  WS-ERRESC-AGENT      PIC X(10).
   193             20  WS-ERRESC-RES-STATE  PIC XX.
   194             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   195*                                          YYYYMMDD
   196     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   197     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   198
   199*RESIDENT STATE TAX MASTER(ERRESS)
   200*
   201     12  WS-ERRESS-KEY.
   202         16  WS-ERRESS-COMPANY-CD      PIC  X.
   203         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   204         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   205         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   206*                                          YYYYMMDD
   207
   208     12  WS-CONTRACT-DATE              PIC 9(8).
   209*                                          YYYYMMDD
   210     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   211     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   212         16 WS-YEAR-YY                 PIC   9999.
   213         16 FILLER                     PIC 9(4).
   214*                                          YYYYMMDD
   215     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   216     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   217     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   218     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   219
   220     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   221         88  DPRB-1ST-TIME                      VALUE ' '.
   222
   223*****************************************************************
   224*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   225*****************************************************************
   226
   227     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   228     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   229     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   230     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   231     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   232     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   233     12  ws-st-refund-int-rate   pic s9v9(4) comp-3 value +0.
   234     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   235     12  ws-st-agent-sig-edit    pic x          value spaces.
   236     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page   6
* EL050.cbl
   237     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   238     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   239     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   240         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   241         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   242     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   243         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   244         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   245     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   246
   247     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   248     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   249
   250     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   251     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   252     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   253     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   254     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   255     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   256     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   257     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   258     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   259     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   260     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   261     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   262     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   263     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   264     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   265     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   267     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   268     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   269     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   270     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   271     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   272     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   273     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   274     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   275     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   276     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   277     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   278     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   279     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   280     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   281     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   282     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   283     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   284     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   285     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   286     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   287     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   288     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   289     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   290     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   291     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   292     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   293     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   294     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page   7
* EL050.cbl
   295     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   296     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   297     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   298     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   299     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   300     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   301     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   302     12  WS-2671-SW               PIC X         VALUE SPACE.
   303     12  WS-2672-SW               PIC X         VALUE SPACE.
   304     12  ws-9813-sw               pic x         value spaces.
   305     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   306         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   307     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   308         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   309     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   310
   311     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   312         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   313         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   314         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   315         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   316
   317     12  WS-CREDIT-EDIT-CONTROLS.
   318         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   319         16  WS-MIN-AGE           PIC 99                VALUE  0.
   320         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   321         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   322         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   323         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   324
   325     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   326     12  WS-AGE-FIELDS.
   327         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   328         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   329         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   330         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   331
   332     12  WS-SAVE-ALLOWABLE-BENEFIT.
   333         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   334         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   335         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   336         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   337         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   338         16  FILLER                      PIC XX.
   339
   340     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   341     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   342     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   343     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   344     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   345     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   346     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   347     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   348     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   349     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   350
   351     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   352     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page   8
* EL050.cbl
   353     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   354     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   355     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   356     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   357     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   358     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   359         88  WS-REDUCING              VALUE 'R'.
   360         88  WS-LEVEL                 VALUE 'L' 'P'.
   361     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   362
   363     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   364     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   365     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   366     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   367     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   368     12  ws-ah-max-bens           pic 99        value zeros.
   369     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   370     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   371     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   372     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   373
   374     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   375     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   376     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   377     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   378     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   379     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   380     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   381     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   382     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   383     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   384     12  WS-ACCT-SIG-SW.
   385         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   386         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   387     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   388     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   389     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   390     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   391     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   392     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   393     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   394     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   395     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   396     12  WS-INITIALS.
   397         16  WS-INIT-1            PIC X         VALUE SPACES.
   398         16  WS-INIT-2            PIC X         VALUE SPACES.
   399
   400     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   401     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   402     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   403     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   404     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   405*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   406     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   407     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   408     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   409     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   410     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page   9
* EL050.cbl
   411     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   412     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   413     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   414     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   415     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   416     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   417     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   418     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   419     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   420     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   421     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   422     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   423     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   424     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   425     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   426     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   427     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   428******** FLA
   429     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   430     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   431     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   432     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   433     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   434********
   435     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   436     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   437     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   438     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   439     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   440     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   441     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   442     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   443     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   444     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   445
   446     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   447         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   448                                         '0' THRU '9'.
   449
   450     12  NUMBER-OF-MONTHS.
   451         16  SK-MO OCCURS 12 TIMES PIC X.
   452
   453     12  WS-WORK-DATE.
   454         16  WS-YEAR            PIC 99    VALUE 00.
   455         16  WS-MONTH           PIC 99    VALUE 00.
   456         16  WS-DAY             PIC 99    VALUE 00.
   457
   458     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   459     12  WS-WORK-CRIT-DEV       REDEFINES
   460         WS-WORK-LF-CRIT-PER    PIC X(03).
   461
   462     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   463     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   464
   465     12  WS-WORK-DATE-FROM.
   466         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   467         16  FILLER             PIC X  VALUE SPACE.
   468         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  10
* EL050.cbl
   469         16  FILLER             PIC X         VALUE SPACE.
   470         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   471
   472     12  WS-WORK-DATE-THRU.
   473         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   474         16  FILLER             PIC X         VALUE SPACE.
   475         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   476         16  FILLER             PIC X         VALUE SPACE.
   477         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   478
   479     12  WS-LF-INPUT-CD.
   480         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   481         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   482
   483     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   484     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   485         16  WS-AH-INPUT-CD-1   PIC X.
   486         16  WS-AH-INPUT-CD-2-3 PIC XX.
   487
   488     12  WS-SWITCHES.
   489         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   490         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   491             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   492         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   493             88  BANK-ACCT-FOUND          VALUE 'Y'.
   494         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   495             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   496         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   497             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   498         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   499             88  COMP-MASTER-FOUND        VALUE 'Y'.
   500         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   501             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   502         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   503             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   504         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   505             88  STAT-MASTER-FOUND        VALUE 'Y'.
   506         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   507             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   508         16  ELCRTT-FOUND-SW          PIC X    VALUE SPACES.
   509             88  ELCRTT-FOUND             VALUE 'Y'.
   510         16  ELCRTT-UPDATE-SW         PIC X    VALUE SPACES.
   511             88  ELCRTT-UPDATE            VALUE 'Y'.
   512         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   513             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   514         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   515             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   516         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   517             88  FORM-MASTER-FOUND        VALUE 'Y'.
   518         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   519             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   520         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   521             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   522         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   523             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   524         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   525             88  NO-BENEFIT-FOUND         VALUE 'N'.
   526         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  11
* EL050.cbl
   527             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   528         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   529             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   530         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   531             88  AH-BENEFIT-FOUND         VALUE ' '.
   532             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   533         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   534             88  LF-BENEFIT-FOUND         VALUE ' '.
   535             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   536         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   537             88  NO-STATE-RECORD          VALUE '1'.
   538         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   539             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   540         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   541             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   542         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   543             88  CERT-WAS-FOUND           VALUE ' '.
   544             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   545         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   546             88  BROWSE-STARTED           VALUE 'Y'.
   547         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   548             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   549         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   550             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   551         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   552             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   553         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   554             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   555         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   556             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   557         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   558             88  APP-CERT-USED            VALUE 'Y' 'A'.
   559         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   560             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   561             88  FIRST-TIME-THROUGH       VALUE '1'.
   562             88  CTBL-NOT-FOUND           VALUE '2'.
   563
   564         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   565             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   566
   567         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   568             88  DLO-ERROR-FOUND          VALUE 'Y'.
   569
   570********FLA
   571     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   572     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   573********
   574     12  RC-SW-1                  PIC X           VALUE '0'.
   575     12  RC-SW-2                  PIC X           VALUE '0'.
   576     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   577     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   578     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   579     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   580     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   581     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   582     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   583     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   584     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  12
* EL050.cbl
   585     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   586     12  LIT-SPACES               PIC X           VALUE SPACES.
   587     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   588     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   589     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   590     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   591     12  erpndm-unlock-sw         pic x           value spaces.
   592         88  need-to-unlock-erpndm  value 'Y'.
   593     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   594     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   595     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   596         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   597         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   598     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   599         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   600
   601 01  WS-EXTRA-PERIODS-BY-STATE.
   602     12  WS-INT-PERIODS          PIC 9.
   603     12  WS-EXTRA-PMTS           PIC 9.
   604 01  ws-net-only-state           pic x value 'N'.
   605 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   606     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   607     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   608 01  WS-CRI-SSN-WORK-AREA.
   609     05  WS-CRI-SOC-SEC-NO.
   610         10  WS-SS-REPT-CD       PIC X(5).
   611         10  WS-SS-LAST-NAME     PIC X(5).
   612         10  WS-SS-INITIAL       PIC X.
   613
   614     05  WS-CRI-REPORT-CODE.
   615         10  FILLER              PIC X(5).
   616         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   617
   618     05  WS-CRI-LAST-NAME.
   619         10  WS-CRI-NAME-MOVE    PIC X(5).
   620         10  FILLER              PIC X(10).
   621
   622 01  ws-state-commission-caps.
   623     05  ws-sl-wk-rate           pic sv9(5) comp-3 value zeros.
   624     05  ws-jl-wk-rate           pic sv9(5) comp-3 value zeros.
   625     05  ws-sa-wk-rate           pic sv9(5) comp-3 value zeros.
   626     05  ws-ja-wk-rate           pic sv9(5) comp-3 value zeros.
   627     05  ws-ga-sl-wk-rate        pic sv9(5) comp-3 value zeros.
   628     05  ws-ga-jl-wk-rate        pic sv9(5) comp-3 value zeros.
   629     05  ws-ga-sa-wk-rate        pic sv9(5) comp-3 value zeros.
   630     05  ws-ga-ja-wk-rate        pic sv9(5) comp-3 value zeros.
   631     05  ws-tot-sl-wk-rate       pic sv9(5) comp-3 value zeros.
   632     05  ws-tot-jl-wk-rate       pic sv9(5) comp-3 value zeros.
   633     05  ws-tot-sa-wk-rate       pic sv9(5) comp-3 value zeros.
   634     05  ws-tot-ja-wk-rate       pic sv9(5) comp-3 value zeros.
   635     05  ws-st-cap-limit-to      pic x.
   636     05  ws-st-comm-cap-sl       pic s9v9(4) comp-3.
   637     05  ws-st-comm-cap-jl       pic s9v9(4) comp-3.
   638     05  ws-st-comm-cap-sa       pic s9v9(4) comp-3.
   639     05  ws-st-comm-cap-ja       pic s9v9(4) comp-3.
   640     05  ws-st-ga-comm-cap-sl    pic s9v9(4) comp-3.
   641     05  ws-st-ga-comm-cap-jl    pic s9v9(4) comp-3.
   642     05  ws-st-ga-comm-cap-sa    pic s9v9(4) comp-3.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  13
* EL050.cbl
   643     05  ws-st-ga-comm-cap-ja    pic s9v9(4) comp-3.
   644     05  ws-st-tot-comm-cap-sl   pic s9v9(4) comp-3.
   645     05  ws-st-tot-comm-cap-jl   pic s9v9(4) comp-3.
   646     05  ws-st-tot-comm-cap-sa   pic s9v9(4) comp-3.
   647     05  ws-st-tot-comm-cap-ja   pic s9v9(4) comp-3.
   648 01  WS-NUM-TABLE                PIC X(26)  VALUE
   649     '12345678012345070923456789'.
   650 01  FILLER REDEFINES WS-NUM-TABLE.
   651     05  WS-NUM OCCURS 26        PIC 9.
   652 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   653 01  V1                          PIC S999 COMP-3.
   654 01  V2                          PIC S999 COMP-3.
   655 01  V3                          PIC S999 COMP-3.
   656 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   657 01  FILLER REDEFINES WS-WORK-VIN.
   658     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   659 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   660 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   661 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   662 01  WS-HEX-WORK.
   663     05  FILLER                  PIC X  VALUE LOW-VALUES.
   664     05  WS-HEX-BYTE             PIC X.
   665 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   666 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   667 01  WS-WORK-HIN-ROW-B.
   668     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   669
   670 01  ws-benefit-cd-chg-sw      pic x value spaces.
   671     88  benefit-code-chg           value 'Y'.
   672 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   673 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   674     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   675 01  WS-ROW-D-TABLE.
   676     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   677
   678 01  WS-HIN-TABLE-B.
   679     05  F                       PIC XX VALUE 'A2'.
   680     05  F                       PIC XX VALUE 'B3'.
   681     05  F                       PIC XX VALUE 'C4'.
   682     05  F                       PIC XX VALUE 'D5'.
   683     05  F                       PIC XX VALUE 'E6'.
   684     05  F                       PIC XX VALUE 'F7'.
   685     05  F                       PIC XX VALUE 'G8'.
   686     05  F                       PIC XX VALUE 'H9'.
   687     05  F                       PIC XX VALUE 'I1'.
   688     05  F                       PIC XX VALUE 'J2'.
   689     05  F                       PIC XX VALUE 'K3'.
   690     05  F                       PIC XX VALUE 'L4'.
   691     05  F                       PIC XX VALUE 'M5'.
   692     05  F                       PIC XX VALUE 'N6'.
   693     05  F                       PIC XX VALUE 'O0'.
   694     05  F                       PIC XX VALUE 'P7'.
   695     05  F                       PIC XX VALUE 'Q0'.
   696     05  F                       PIC XX VALUE 'R8'.
   697     05  F                       PIC XX VALUE 'S9'.
   698     05  F                       PIC XX VALUE 'T2'.
   699     05  F                       PIC XX VALUE 'U3'.
   700     05  F                       PIC XX VALUE 'V4'.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  14
* EL050.cbl
   701     05  F                       PIC XX VALUE 'W5'.
   702     05  F                       PIC XX VALUE 'X6'.
   703     05  F                       PIC XX VALUE 'Y7'.
   704     05  F                       PIC XX VALUE 'Z8'.
   705 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   706     05  WS-VAL-IN               PIC X.
   707     05  WS-VAL-OUT              PIC 9.
   708 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   709 01  ws-greg-eff-date            pic x(10) value ' '.
   710 01  WS-COMPARE-BINARY-DATES.
   711     05  WS-971231                PIC XX VALUE X'92FF'.
   712     05  WS-931231                PIC XX VALUE X'8CFF'.
   713     05  WS-791231                PIC XX VALUE X'77FF'.
   714     05  WS-771001                PIC XX VALUE X'74A1'.
   715     05  WS-820301                PIC XX VALUE X'7B41'.
   716     05  WS-831031                PIC XX VALUE X'7DBF'.
   717     05  WS-831231                PIC XX VALUE X'7DFF'.
   718     05  WS-810831                PIC XX VALUE X'7A7F'.
   719     05  WS-830901                PIC XX VALUE X'7D81'.
   720
   721 01  FILE-ACCESS-IDS.
   722     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   723     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   724     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   725     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   726     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   727     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   728     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   729     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   730     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   731     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   732     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   733     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   734     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   735     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   736     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   737     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   738     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   739 01  DD-IU-SW                    PIC X   VALUE ' '.
   740     88  DD-IU-PRESENT                 VALUE 'Y'.
   741
   742 01  ACCESS-KEYS.
   743     12  ELMSTR-KEY.
   744         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   745         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   746     12  W-CLAIM-KEY.
   747         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   748         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   749
   750     12  ELCNTL-KEY.
   751         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   752         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   753         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   754         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   755
   756     12  ELCERT-KEY.
   757         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   758         16  CERT-CARRIER         PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  15
* EL050.cbl
   759         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   760         16  CERT-STATE           PIC XX      VALUE SPACES.
   761         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   762         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   763         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   764
   765     12  ELCERT2-KEY.
   766         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   767         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   768
   769     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   770
   771     12  ELCERT-SAVE.
   772         16  FILLER                      PIC XX    VALUE SPACES.
   773
   774         16  WCS-CONTROL-PRIMARY.
   775             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   776             20  WCS-CARRIER             PIC X     VALUE SPACE.
   777             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   778             20  WCS-STATE               PIC XX    VALUE SPACES.
   779             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   780             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   781             20  WCS-CERT-NO.
   782                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   783                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   784
   785         16  CS-CONTROL-BY-NAME.
   786             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   787             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   788             20  CS-INSURED-INITIALS.
   789                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   790                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   791
   792         16  CS-CONTROL-BY-SSN.
   793             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   794             20  CS-SOC-SEC-NO.
   795                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   796                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   797                 24  CS-SSN-LN3.
   798                     28 CS-INSURED-INITIALS-A2   PIC XX
   799                                     VALUE SPACES.
   800                     28 CS-PART-LAST-NAME-A2     PIC X
   801                                     VALUE SPACE.
   802
   803         16  CS-CONTROL-BY-CERT-NO.
   804             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   805             20  CS-CERT-NO-A4           PIC X(11)
   806                                     VALUE SPACES.
   807
   808         16  CS-CONTROL-BY-MEMB.
   809             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   810             20  CS-MEMBER-NO.
   811                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   812                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   813                 24  CS-MEMB-LN4.
   814                     28 CS-INSURED-INITIALS-A5   PIC XX
   815                                      VALUE SPACES.
   816                     28 CS-PART-LAST-NAME-A5     PIC XX
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  16
* EL050.cbl
   817                                      VALUE SPACES.
   818
   819         16  FILLER              PIC X(360) VALUE SPACES.
   820
   821     12  ERACCT-KEY.
   822         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   823         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   824         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   825         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   826         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   827         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   828
   829     12  ERCOMP-KEY.
   830         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   831         16  COMP-CARRIER         PIC X     VALUE SPACES.
   832         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   833         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   834         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   835         16  COMP-TYPE            PIC X     VALUE SPACES.
   836
   837     12  ERLOFC-KEY.
   838         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   839         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   840         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   841         16  LOFC-STATE           PIC XX    VALUE SPACES.
   842         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   843         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   844
   845     12  WS-ELCRTT-KEY.
   846         16  WS-ELCRTT-PRIMARY       PIC X(33).
   847         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   848
   849     12  ERBXRF-KEY.
   850         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   851         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   852         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   853         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   854
   855     12  ERAGTC-KEY.
   856         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   857         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   858         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   859         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   860         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   861         16  AGTC-TYPE            PIC X     VALUE SPACES.
   862
   863     12  ERPLAN-KEY.
   864         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   865         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   866         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   867         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   868         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   869         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   870         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   871         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   872
   873     12  ERFORM-KEY.
   874         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  17
* EL050.cbl
   875         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   876         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   877         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   878
   879     12  ERREIN-KEY.
   880         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   881         16  REIN-TYPE            PIC X     VALUE SPACES.
   882         16  REIN-TABLE-CO.
   883             20  REIN-CODE-1      PIC X     VALUE SPACE.
   884             20  REIN-CODE-2      PIC X     VALUE SPACE.
   885             20  REIN-CODE-3      PIC X     VALUE SPACE.
   886         16  FILLER               PIC X(3)  VALUE SPACES.
   887
   888     12  ERCTBL-KEY.
   889         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   890         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   891         16  CTBL-CNTRL-2.
   892             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   893             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   894
   895     12  ELCRTO-KEY.
   896         16  ELCRTO-COMPANY-CD       PIC X.
   897         16  ELCRTO-CARRIER          PIC X.
   898         16  ELCRTO-GROUPING         PIC X(6).
   899         16  ELCRTO-STATE            PIC XX.
   900         16  ELCRTO-ACCOUNT          PIC X(10).
   901         16  ELCRTO-CERT-EFF-DT      PIC XX.
   902         16  ELCRTO-CERT-NO.
   903             20  ELCRTO-CERT-PRIME   PIC X(10).
   904             20  ELCRTO-CERT-SFX     PIC X.
   905         16  ELCRTO-RECORD-TYPE      PIC X.
   906         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   907
   908
   909     12  WS-ACCESS.
   910         16  FILLER               PIC XX    VALUE SPACES.
   911         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   912
   913     12  WS-CARR-ACCESS.
   914         16  FILLER               PIC X(3)  VALUE SPACES.
   915         16  WS-CARR              PIC X     VALUE SPACE.
   916*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   917*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   918     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   919         88  WS-DMD-LF-RATING   VALUE 'Y'.
   920         88  WS-DMD-AH-RATING   VALUE 'Y'.
   921         88  WS-DMD-NO-RATING   VALUE 'N'.
   922
   923     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   924         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   925                                         'NJ' 'NL'
   926                                         'PJ' 'PL'
   927                                         'SJ' 'SL'.
   928     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   929         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   930                                         'NI' 'NJ' 'NL' 'NU'
   931                                         'PJ' 'PL' 'PI' 'PU'
   932                                         'SI' 'SJ' 'SL' 'SU'
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  18
* EL050.cbl
   933                                         'MX' 'MY' 'MZ'.
   934 01  ERPDEF-KEY-SAVE             PIC X(18).
   935 01  ERPDEF-KEY.
   936     12  ERPDEF-COMPANY-CD       PIC X.
   937     12  ERPDEF-STATE            PIC XX.
   938     12  ERPDEF-PROD-CD          PIC XXX.
   939     12  F                       PIC X(7).
   940     12  ERPDEF-BEN-TYPE         PIC X.
   941     12  ERPDEF-BEN-CODE         PIC XX.
   942     12  ERPDEF-EXP-DT           PIC XX.
   943
   944 01  ELSTAT-KEY-SAVE             PIC X(20).
   945 01  ELSTAT-KEY.
   946     12  ELSTAT-COMPANY-ID       PIC XXX.
   947     12  ELSTAT-CARRIER          PIC X.
   948     12  ELSTAT-GROUP            PIC X(6).
   949     12  ELSTAT-STATE            PIC XX.
   950     12  ELSTAT-EXP-DT           PIC 9(8).
   951 01  WS-ERROR-VALUES.
   952     12  ER-1570                     PIC S9(4)   VALUE +1570.
   953     12  ER-1571                     PIC S9(4)   VALUE +1571.
   954     12  er-1572                     pic s9(4)   value +1572.
   955     12  er-1573                     pic s9(4)   value +1573.
   956     12  er-1574                     pic s9(4)   value +1574.
   957     12  ER-1575                     PIC S9(4)   VALUE +1575.
   958     12  er-1576                     pic s9(4)   value +1576.
   959     12  er-1583                     pic s9(4)   value +1583.
   960     12  er-1743                     pic s9(4)   value +1743.
   961     12  er-1744                     pic s9(4)   value +1744.
   962     12  er-1745                     pic s9(4)   value +1745.
   963     12  er-1746                     pic s9(4)   value +1746.
   964     12  er-1747                     pic s9(4)   value +1747.
   965     12  er-1748                     pic s9(4)   value +1748.
   966     12  er-1749                     pic s9(4)   value +1749.
   967     12  er-1750                     pic s9(4)   value +1750.
   968     12  er-1751                     pic s9(4)   value +1751.
   969     12  er-1752                     pic s9(4)   value +1752.
   970     12  er-1753                     pic s9(4)   value +1753.
   971     12  er-1754                     pic s9(4)   value +1754.
   972     12  er-1755                     pic s9(4)   value +1755.
   973     12  er-1756                     pic s9(4)   value +1756.
   974     12  er-1757                     pic s9(4)   value +1757.
   975     12  er-1758                     pic s9(4)   value +1758.
   976     12  er-1759                     pic s9(4)   value +1759.
   977     12  er-1760                     pic s9(4)   value +1760.
   978     12  er-1761                     pic s9(4)   value +1761.
   979     12  ER-1891                     PIC S9(4)   VALUE +1891.
   980     12  ER-1892                     PIC S9(4)   VALUE +1892.
   981     12  ER-1893                     PIC S9(4)   VALUE +1893.
   982     12  ER-1894                     PIC S9(4)   VALUE +1894.
   983     12  ER-1895                     PIC S9(4)   VALUE +1895.
   984     12  ER-1896                     PIC S9(4)   VALUE +1896.
   985     12  ER-1897                     PIC S9(4)   VALUE +1897.
   986     12  ER-1898                     PIC S9(4)   VALUE +1898.
   987     12  ER-1899                     PIC S9(4)   VALUE +1899.
   988     12  ER-1900                     PIC S9(4)   VALUE +1900.
   989     12  ER-1901                     PIC S9(4)   VALUE +1901.
   990     12  ER-1902                     PIC S9(4)   VALUE +1902.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  19
* EL050.cbl
   991     12  ER-1903                     PIC S9(4)   VALUE +1903.
   992     12  ER-1904                     PIC S9(4)   VALUE +1904.
   993     12  ER-1905                     PIC S9(4)   VALUE +1905.
   994     12  ER-1906                     PIC S9(4)   VALUE +1906.
   995     12  ER-1907                     PIC S9(4)   VALUE +1907.
   996     12  ER-1909                     PIC S9(4)   VALUE +1909.
   997     12  ER-1910                     PIC S9(4)   VALUE +1910.
   998     12  ER-1911                     PIC S9(4)   VALUE +1911.
   999     12  ER-1912                     PIC S9(4)   VALUE +1912.
  1000     12  ER-1913                     PIC S9(4)   VALUE +1913.
  1001     12  ER-1914                     PIC S9(4)   VALUE +1914.
  1002     12  ER-1915                     PIC S9(4)   VALUE +1915.
  1003     12  ER-1916                     PIC S9(4)   VALUE +1916.
  1004     12  ER-1917                     PIC S9(4)   VALUE +1917.
  1005     12  ER-1918                     PIC S9(4)   VALUE +1918.
  1006     12  ER-1919                     PIC S9(4)   VALUE +1919.
  1007     12  ER-1920                     PIC S9(4)   VALUE +1920.
  1008     12  ER-1921                     PIC S9(4)   VALUE +1921.
  1009     12  ER-1922                     PIC S9(4)   VALUE +1922.
  1010     12  ER-1923                     PIC S9(4)   VALUE +1923.
  1011     12  ER-1924                     PIC S9(4)   VALUE +1924.
  1012     12  ER-1925                     PIC S9(4)   VALUE +1925.
  1013     12  ER-1926                     PIC S9(4)   VALUE +1926.
  1014     12  ER-1927                     PIC S9(4)   VALUE +1927.
  1015     12  ER-1955                     PIC s9(4)   VALUE +1955.
  1016     12  ER-1956                     PIC s9(4)   VALUE +1956.
  1017     12  ER-1957                     PIC s9(4)   VALUE +1957.
  1018     12  ER-1958                     PIC s9(4)   VALUE +1958.
  1019     12  ER-1959                     PIC s9(4)   VALUE +1959.
  1020     12  ER-1960                     PIC s9(4)   VALUE +1960.
  1021     12  ER-1961                     PIC s9(4)   VALUE +1961.
  1022     12  ER-1962                     PIC s9(4)   VALUE +1962.
  1023     12  ER-1963                     PIC s9(4)   VALUE +1963.
  1024     12  ER-2393                     PIC S9(4)   VALUE +2393.
  1025     12  ER-2600                     PIC S9(4)   VALUE +2600.
  1026     12  ER-2601                     PIC S9(4)   VALUE +2601.
  1027     12  ER-2602                     PIC S9(4)   VALUE +2602.
  1028     12  ER-2603                     PIC S9(4)   VALUE +2603.
  1029     12  ER-2604                     PIC S9(4)   VALUE +2604.
  1030     12  ER-2605                     PIC S9(4)   VALUE +2605.
  1031     12  ER-2606                     PIC S9(4)   VALUE +2606.
  1032     12  ER-2607                     PIC S9(4)   VALUE +2607.
  1033     12  ER-2608                     PIC S9(4)   VALUE +2608.
  1034     12  ER-2609                     PIC S9(4)   VALUE +2609.
  1035     12  ER-2610                     PIC S9(4)   VALUE +2610.
  1036     12  ER-2611                     PIC S9(4)   VALUE +2611.
  1037     12  ER-2612                     PIC S9(4)   VALUE +2612.
  1038     12  ER-2613                     PIC S9(4)   VALUE +2613.
  1039     12  ER-2614                     PIC S9(4)   VALUE +2614.
  1040     12  ER-2615                     PIC S9(4)   VALUE +2615.
  1041     12  ER-2616                     PIC S9(4)   VALUE +2616.
  1042     12  ER-2617                     PIC S9(4)   VALUE +2617.
  1043     12  ER-2618                     PIC S9(4)   VALUE +2618.
  1044     12  ER-2619                     PIC S9(4)   VALUE +2619.
  1045     12  ER-2620                     PIC S9(4)   VALUE +2620.
  1046     12  ER-2621                     PIC S9(4)   VALUE +2621.
  1047     12  ER-2622                     PIC S9(4)   VALUE +2622.
  1048     12  ER-2623                     PIC S9(4)   VALUE +2623.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  20
* EL050.cbl
  1049     12  ER-2624                     PIC S9(4)   VALUE +2624.
  1050     12  ER-2625                     PIC S9(4)   VALUE +2625.
  1051     12  ER-2626                     PIC S9(4)   VALUE +2626.
  1052     12  ER-2627                     PIC S9(4)   VALUE +2627.
  1053     12  ER-2628                     PIC S9(4)   VALUE +2628.
  1054     12  ER-2629                     PIC S9(4)   VALUE +2629.
  1055     12  ER-2630                     PIC S9(4)   VALUE +2630.
  1056     12  ER-2631                     PIC S9(4)   VALUE +2631.
  1057     12  ER-2632                     PIC S9(4)   VALUE +2632.
  1058     12  ER-2633                     PIC S9(4)   VALUE +2633.
  1059     12  ER-2634                     PIC S9(4)   VALUE +2634.
  1060     12  ER-2635                     PIC S9(4)   VALUE +2635.
  1061     12  ER-2636                     PIC S9(4)   VALUE +2636.
  1062     12  ER-2637                     PIC S9(4)   VALUE +2637.
  1063     12  ER-2638                     PIC S9(4)   VALUE +2638.
  1064     12  ER-2639                     PIC S9(4)   VALUE +2639.
  1065     12  ER-2640                     PIC S9(4)   VALUE +2640.
  1066     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1067     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1068     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1069     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1070     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1071     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1072     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1073     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1074     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1075     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1076     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1077     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1078     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1079     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1080     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1081     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1082     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1083     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1084     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1085     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1086     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1087     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1088     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1089     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1090     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1091     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1092     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1093     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1094     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1095     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1096     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1097     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1098     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1099     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1100     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1101     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1102     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1103     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1104     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1105     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1106     12  ER-2681                     PIC S9(4)   VALUE +2681.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  21
* EL050.cbl
  1107     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1108     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1109     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1110     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1111     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1112     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1113     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1114     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1115     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1116     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1117     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1118     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1119     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1120     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1121     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1122     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1123     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1124     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1125     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1126     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1127     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1128     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1129     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1130     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1131     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1132     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1133     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1134     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1135     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1136     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1137     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1138     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1139     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1140     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1141     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1142     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1143     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1144     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1145     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1146     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1147     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1148     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1149     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1150     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1151     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1152     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1153     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1154     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1155     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1156     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1157     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1158     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1159     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1160     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1161     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1162     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1163     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1164     12  ER-2749                     PIC S9(4)   VALUE +2749.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  22
* EL050.cbl
  1165     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1166     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1167     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1168     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1169     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1170     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1171     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1172     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1173     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1174     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1175     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1176     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1177     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1178     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1179     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1180     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1181     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1182     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1183     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1184     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1185     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1186     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1187     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1188     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1189     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1190     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1191     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1192     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1193     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1194     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1195     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1196     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1197     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1198     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1199     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1200     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1201     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1202     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1203     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1204     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1205     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1206     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1207     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1208     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1209     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1210     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1211     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1212     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1213     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1214     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1215     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1216     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1217     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1218     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1219     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1220     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1221     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1222     12  ER-2891                     PIC S9(4)   VALUE +2891.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  23
* EL050.cbl
  1223     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1224     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1225     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1226     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1227     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1228     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1229     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1230     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1231     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1232     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1233     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1234     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1235     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1236     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1237     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1238     12  ER-3059                     PIC S9(4)   VALUE +3059.
  1239     12  ER-3060                     PIC S9(4)   VALUE +3060.
  1240     12  ER-3061                     PIC S9(4)   VALUE +3061.
  1241     12  ER-3062                     PIC S9(4)   VALUE +3062.
  1242     12  ER-3063                     PIC S9(4)   VALUE +3063.
  1243     12  ER-3068                     PIC S9(4)   VALUE +3068.
  1244     12  er-3270                     pic s9(4)   value +3270.
  1245     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1246     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1247     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1248     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1249     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1250     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1251     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1252     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1253     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1254     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1255     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1256     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1257     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1258     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1259     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1260     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1261     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1262     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1263     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1264     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1265     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1266     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1267     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1268     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1269     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1270     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1271     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1272     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1273     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1274     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1275     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1276     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1277     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1278     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1279     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1280     12  ER-8068                     PIC S9(4)   VALUE +8068.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  24
* EL050.cbl
  1281     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1282     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1283     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1284     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1285     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1286     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1287     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1288     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1289     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1290     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1291     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1292     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1293     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1294     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1295     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1296     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1297     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1298     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1299     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1300     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1301     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1302     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1303     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1304     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1305     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1306     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1307     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1308     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1309     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1310     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1311     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1312     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1313     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1314     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1315     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1316     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1317     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1318     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1319     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1320     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1321     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1322     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1323     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1324     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1325     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1326     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1327     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1328     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1329     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1330     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1331     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1332     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1333     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1334     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1335     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1336     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1337     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1338     12  er-9823                     pic s9(4)   value +9823.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  25
* EL050.cbl
  1339     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1340******************************************************************
  1341***************   END OF ELC50WS     ****************************
  1342******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  26
* EL050.cbl
  1345 01  WORKING-STORAGE-WORK-AREAS.
  1346     12  WS-RESPONSE             PIC S9(8)  COMP.
  1347         88  WS-RESP-NORMAL           VALUE +00.
  1348         88  WS-RESP-ERROR            VALUE +01.
  1349         88  WS-RESP-NOTFND           VALUE +13.
  1350         88  WS-RESP-DUPREC           VALUE +14.
  1351         88  WS-RESP-ENDFILE          VALUE +20.
  1352     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1353     12  WORK-AREAS.
  1354         16  WK-CONV-GREG.
  1355             24  WCG-CENT             PIC XX.
  1356             24  WCG-REST             PIC X(4).
  1357         16  WORK-GREGORIAN-DATE.
  1358             24  WK-GREG-CENT         PIC XX.
  1359             24  WK-GREG-DATE-YYMMDD.
  1360                 28  WK-GREG-YYMM     PIC X(4).
  1361                 28  WK-GREG-DD       PIC XX.
  1362
  1363         16  WORK-SELECT-DATE.
  1364             24  WK-SELECT-CENT            PIC XX.
  1365             24  WK-SELECT-DATE-YYMMDD.
  1366                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1367                 28  FILLER                PIC XX.
  1368
  1369         16  WK-FORM-NO.
  1370             24  WK-FORM-BANK-ID       PIC X(5).
  1371             24  WK-FORM-UNDRWRTR      PIC X(1).
  1372             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1373
  1374         16  WK-MEMBER-NO.
  1375             24  WK-MEMBER-1-6        PIC X(6).
  1376             24  WK-MEMBER-7-12       PIC X(6).
  1377
  1378         16  WK-FULL-CERT-NO.
  1379             24  WK-CERT-POS-1-2      PIC X(2).
  1380             24  WK-CERT-POS-3        PIC X(1).
  1381             24  WK-CERT-POS-4        PIC X(1).
  1382             24  WK-CERT-POS-5-6      PIC X(2).
  1383             24  WK-CERT-POS-7        PIC X(1).
  1384             24  WK-CERT-POS-8-11     PIC X(4).
  1385
  1386         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1387             88  VALID-RATE-CODE        VALUE 'Y'.
  1388             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1389
  1390         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1391         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1392         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1393         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1394         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1395         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1396         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1397         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1398         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1399         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1400
  1401* DLO001
  1402 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  27
* EL050.cbl
  1403     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1404     12  DMPF-RETURN-CODE          PIC XX.
  1405         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1406         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1407         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1408         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1409         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1410         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1411
  1412* DLO002
  1413 01  WS-DLO-INTERNAL-POLICY-FORM.
  1414     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1415     12  DIPF-RETURN-CODE          PIC XX.
  1416         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1417         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1418         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1419         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1420         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1421         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1422
  1423* DLO003
  1424 01  WS-DLO-VALID-BANK-ID.
  1425     12  DVBI-BANK-ID              PIC X(5).
  1426     12  DVBI-BANK-ID-TYPE         PIC X.
  1427         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1428         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1429         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1430         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1431         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1432     12  DVBI-RETURN-CODE          PIC XX.
  1433         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1434         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1435         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1436         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1437         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1438         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1439         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1440         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1441         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1442
  1443* DLO007
  1444 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1445     12  DCUA-RES-STATE            PIC XX.
  1446     12  DCUA-BEN-TYPE             PIC XX.
  1447     12  DCUA-SYS-IDENT            PIC X.
  1448         88  DCUA-CLAIM                        VALUE 'C'.
  1449         88  DCUA-PREMIUM                      VALUE 'P'.
  1450     12  DCUA-COVERAGE-RULE        PIC X.
  1451     12  DCUA-CLIENT-ID            PIC X(10).
  1452     12  DCUA-EFF-DATE             PIC X(8).
  1453     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1454     12  DCUA-RETURN-CODE          PIC XX.
  1455         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1456     12  DCUA-CERT-NUMBER          PIC X(11).
  1457     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1458     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1459
  1460* DLO011
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  28
* EL050.cbl
  1461 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1462     12  DPRB-RATE-CODE            PIC X(4).
  1463     12  DPRB-COVERAGE-CATEG       PIC X.
  1464     12  DPRB-RETURN-CODE          PIC XX.
  1465         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1466         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1467         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1468         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1469         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1470         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1471         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1472         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1473         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1474     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1475     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1476     12  DPRB-BEN-TYPE             PIC XX.
  1477
  1478* DLO017
  1479 01  WS-DLO-VALID-RATE-CODE.
  1480     12  DVRC-RATE-CODE            PIC X(4).
  1481     12  DVRC-RETURN-CODE          PIC XX.
  1482         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1483         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1484         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1485         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1486         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1487         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1488
  1489* DLO019
  1490 01  WS-DLO-ORIG-COV-CAT.
  1491     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1492     12  DOCC-RETURN-CODE          PIC XX.
  1493     12  DOCC-ORIG-COV-CAT         PIC X.
  1494     12  DOCC-UNDERWITER           PIC XX.
  1495     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1496     12  DOCC-FILLER               PIC X(6).
  1497
  1498* DLO021
  1499 01  WS-DLO-VALID-LOAN-OFFICER.
  1500     12  DVLO-LOAN-OFFICER.
  1501         16  DVLO-BILL-TYPE        PIC X.
  1502         16  DVLO-BILL-SOURCE      PIC X.
  1503         16  DVLO-BATCH-TYPE       PIC X.
  1504     12  DVLO-RETURN-CODE          PIC XX.
  1505         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1506         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1507         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1508         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1509         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1510         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1511
  1512* DLO022
  1513 01  WS-DLO-VALID-STATE-CODE.
  1514     12  DVSC-STATE-CODE           PIC XX.
  1515     12  DVSC-RETURN-CODE          PIC XX.
  1516         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1517
  1518* DLO023
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  29
* EL050.cbl
  1519 01  WS-DLO-VALID-CODE-VALUES.
  1520     12  DVCV-SYSTEM-ID            PIC XX.
  1521         88  DVCV-CLAIMS                       VALUE 'CL'.
  1522         88  DVCV-CREDIT                       VALUE 'CR'.
  1523     12  DVCV-RECORD-TYPE          PIC XX.
  1524         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1525         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1526         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1527         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1528         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1529         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1530         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1531         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1532     12  DVCV-RECORD-KEY           PIC X(6).
  1533     12  DVCV-RETURN-CODE          PIC XX.
  1534         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1535         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1536         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1537         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1538         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1539         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1540         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1541     12  DVCV-CODE-DESC            PIC X(60).
  1542     12  DVCV-GEN-DESC-1           PIC X(20).
  1543     12  DVCV-GEN-DESC-2           PIC X(20).
  1544     12  DVCV-GEN-DESC-3           PIC X(20).
  1545
  1546 01  hldi-pass-area-len          pic s9(4) comp value +214.
  1547 01  hldi-pass-area.
  1548     03  PA-VIN                  PIC X(17).
  1549     03  PA-ErrorCode            PIC X(10).
  1550     03  PA-ErrorDesc            PIC X(30).
  1551     03  PA-ModelYear            PIC 9(7).
  1552     03  PA-MakeName             PIC X(50).
  1553     03  PA-ModelName            PIC X(50).
  1554     03  PA-SeriesName           PIC X(50).
  1555 01  zipcd-pass-area-len         pic s9(4) comp value +67.
  1556 01  zipcd-pass-area.
  1557     03  PA-zip                  PIC X(5).
  1558     03  PA-ErrorCode-zip        PIC X(10).
  1559     03  PA-city                 PIC x(50).
  1560     03  PA-state                PIC Xx.
  1561 01  clmhs-pass-area-len         pic s9(4) comp value +40.
  1562 01  clmhs-pass-area.
  1563     03  pa-clmhs-state          pic xx.
  1564     03  pa-account              pic x(10).
  1565     03  pa-eff-dt               pic x(10).
  1566     03  pa-cert-no              pic x(11).
  1567     03  pa-clm-count            pic 9(5).
  1568****  this is for aggregate report.
  1569****  Length is erpndb + 100 of passed-key-area
  1570 01  ws-passed-key-length        pic s9(4) comp value +587.
  1571 01  ws-pass-to-pemaggo.
  1572     05  ws-passed-erpndb        pic x(585).
  1573     05  ws-exceed-limit-yn      pic x.
  1574     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  30
* EL050.cbl
  1576*    COPY ERCBXRF.
  1577******************************************************************
  1578*                                                                *
  1579*                                                                *
  1580*                            ERCBXRF                             *
  1581*                                                                *
  1582*   ONLINE CREDIT SYSTEM                                         *
  1583*                                                                *
  1584*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1585*                                                                *
  1586*   FILE TYPE = VSAM,KSDS                                        *
  1587*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1588*                                                                *
  1589*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1590*       ALTERNATE PATH = NONE                                    *
  1591*                                                                *
  1592*   LOG = NO                                                     *
  1593*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1594*                                                                *
  1595******************************************************************
  1596
  1597 01  BANK-CROSS-REFERENCE.
  1598     12  BK-RECORD-ID                PIC XX.
  1599         88  VALID-BK-ID             VALUE 'BK'.
  1600
  1601     12  BK-CONTROL-PRIMARY.
  1602         16  BK-COMPANY-CD           PIC X.
  1603         16  BK-CARRIER              PIC X.
  1604         16  BK-GROUPING             PIC X(6).
  1605         16  BK-BANK-NO              PIC X(10).
  1606
  1607     12  BK-MAINT-INFORMATION.
  1608         16  BK-LAST-MAINT-DT        PIC XX.
  1609         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1610         16  BK-LAST-MAINT-USER      PIC X(4).
  1611         16  FILLER                  PIC X(9).
  1612
  1613     12  FILLER                      PIC X(37).
  1614
  1615     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1616
  1617     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1618                            DEPENDING ON BK-BANK-POINTER-CNT.
  1619         16  BK-AM-ACCOUNT           PIC X(10).
  1620         16  BK-AM-EXP-DT            PIC XX.
  1621         16  BK-AM-EFF-DT            PIC XX.
  1622         16  BK-AM-STATE             PIC XX.
  1623         16  FILLER                  PIC X(20).
  1624
  1625******************************************************************
  1626
  1627*    COPY ERCCOMP.
  1628******************************************************************
  1629*                                                                *
  1630*                                                                *
  1631*                            ERCCOMP                             *
  1632*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1633*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  31
* EL050.cbl
  1634*                                                                *
  1635*   ONLINE CREDIT SYSTEM                                         *
  1636*                                                                *
  1637*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1638*                                                                *
  1639*   FILE TYPE = VSAM,KSDS                                        *
  1640*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1641*                                                                *
  1642*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1643*       ALTERNATE PATH = NONE                                    *
  1644*                                                                *
  1645*   LOG = NO                                                     *
  1646*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1647*                                                                *
  1648******************************************************************
  1649*                   C H A N G E   L O G
  1650*
  1651* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1652*-----------------------------------------------------------------
  1653*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1654* EFFECTIVE    NUMBER
  1655*-----------------------------------------------------------------
  1656* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1657* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1658* 092205    2005050300006  PEMA  ADD LEASE FEE
  1659* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1660* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1661* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1662* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1663* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1664* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1665******************************************************************
  1666
  1667 01  COMPENSATION-MASTER.
  1668     12  CO-RECORD-ID                          PIC XX.
  1669         88  VALID-CO-ID                          VALUE 'CO'.
  1670
  1671     12  CO-CONTROL-PRIMARY.
  1672         16  CO-COMPANY-CD                     PIC X.
  1673         16  CO-CONTROL.
  1674             20  CO-CTL-1.
  1675                 24  CO-CARR-GROUP.
  1676                     28  CO-CARRIER            PIC X.
  1677                     28  CO-GROUPING.
  1678                         32  CO-GROUP-PREFIX   PIC XXX.
  1679                         32  CO-GROUP-PRIME    PIC XXX.
  1680                 24  CO-RESP-NO.
  1681                     28  CO-RESP-PREFIX        PIC X(4).
  1682                     28  CO-RESP-PRIME         PIC X(6).
  1683             20  CO-CTL-2.
  1684                 24  CO-ACCOUNT.
  1685                     28  CO-ACCT-PREFIX        PIC X(4).
  1686                     28  CO-ACCT-PRIME         PIC X(6).
  1687         16  CO-TYPE                           PIC X.
  1688             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1689             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1690             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1691
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  32
* EL050.cbl
  1692     12  CO-MAINT-INFORMATION.
  1693         16  CO-LAST-MAINT-DT                  PIC XX.
  1694         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1695         16  CO-LAST-MAINT-USER                PIC X(4).
  1696     12  FILLER                                PIC XX.
  1697     12  CO-STMT-TYPE                          PIC XXX.
  1698     12  CO-COMP-TYPE                          PIC X.
  1699         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1700     12  CO-STMT-OWNER                         PIC X(4).
  1701     12  CO-BALANCE-CONTROL                    PIC X.
  1702         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1703         88  CO-NO-BALANCE                        VALUE 'N'.
  1704
  1705     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1706         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1707         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1708         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1709
  1710     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1711         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1712         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1713
  1714     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1715     12  CO-GA-DIRECT-DEP                      PIC X.
  1716     12  CO-FUTURE-SPACE                       PIC X.
  1717         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1718
  1719     12  CO-ACCT-NAME                          PIC X(30).
  1720     12  CO-MAIL-NAME                          PIC X(30).
  1721     12  CO-ADDR-1                             PIC X(30).
  1722     12  CO-ADDR-2                             PIC X(30).
  1723     12  CO-ADDR-3.
  1724         16  CO-ADDR-CITY                      PIC X(27).
  1725         16  CO-ADDR-STATE                     PIC XX.
  1726     12  CO-CSO-1099                           PIC X.
  1727     12  CO-ZIP.
  1728         16  CO-ZIP-PRIME.
  1729             20  CO-ZIP-PRI-1ST                PIC X.
  1730                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1731             20  FILLER                        PIC X(4).
  1732         16  CO-ZIP-PLUS4                      PIC X(4).
  1733     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1734         16  CO-CAN-POSTAL-1                   PIC XXX.
  1735         16  CO-CAN-POSTAL-2                   PIC XXX.
  1736         16  FILLER                            PIC XXX.
  1737     12  CO-SOC-SEC                            PIC X(13).
  1738     12  CO-TELEPHONE.
  1739         16  CO-AREA-CODE                      PIC XXX.
  1740         16  CO-PREFIX                         PIC XXX.
  1741         16  CO-PHONE                          PIC X(4).
  1742
  1743     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1744
  1745     12  CO-AR-BAL-LEVEL                       PIC X.
  1746         88  CO-AR-REF-LVL                        VALUE '1'.
  1747         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1748         88  CO-AR-BILL-LVL                       VALUE '2'.
  1749         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  33
* EL050.cbl
  1750         88  CO-AR-FR-LVL                         VALUE '4'.
  1751
  1752     12  CO-AR-NORMAL-PRINT                    PIC X.
  1753         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1754         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1755
  1756     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1757
  1758     12  CO-AR-REPORTING                       PIC X.
  1759         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1760         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1761
  1762     12  CO-AR-PULL-CHECK                      PIC X.
  1763         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1764         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1765
  1766     12  CO-AR-BALANCE-PRINT                   PIC X.
  1767         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1768
  1769     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1770         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1771         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1772         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1773
  1774     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1775
  1776     12  CO-USER-CODE                          PIC X.
  1777     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1778
  1779******************************************************************
  1780*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1781*    THE LAST MONTH END RUN.
  1782******************************************************************
  1783
  1784     12  CO-LAST-ACTIVITY-DATE.
  1785         16  CO-ACT-YEAR                       PIC 99.
  1786         16  CO-ACT-MONTH                      PIC 99.
  1787         16  CO-ACT-DAY                        PIC 99.
  1788
  1789     12  CO-LAST-STMT-DT.
  1790         16  CO-LAST-STMT-YEAR                 PIC 99.
  1791         16  CO-LAST-STMT-MONTH                PIC 99.
  1792         16  CO-LAST-STMT-DAY                  PIC 99.
  1793
  1794     12  CO-MO-END-TOTALS.
  1795         16  CO-MONTHLY-TOTALS.
  1796             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1797             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1798             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1799             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1800             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1801
  1802         16  CO-AGING-TOTALS.
  1803             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1804             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1805             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1806             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1807
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  34
* EL050.cbl
  1808         16  CO-YTD-TOTALS.
  1809             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1810             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1811
  1812         16  CO-OVER-UNDER-TOTALS.
  1813             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1814             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1815
  1816     12  CO-MISCELLANEOUS-TOTALS.
  1817         16  CO-FICA-TOTALS.
  1818             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1819             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1820
  1821         16  CO-CLAIM-TOTALS.
  1822             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1823             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1824
  1825******************************************************************
  1826*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1827*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1828******************************************************************
  1829
  1830     12  CO-CURRENT-TOTALS.
  1831         16  CO-CURRENT-LAST-STMT-DT.
  1832             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1833             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1834             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1835
  1836         16  CO-CURRENT-MONTHLY-TOTALS.
  1837             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1838             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1839             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1840             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1841             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1842
  1843         16  CO-CURRENT-AGING-TOTALS.
  1844             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1845             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1846             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1847             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1848
  1849         16  CO-CURRENT-YTD-TOTALS.
  1850             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1851             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1852
  1853     12  CO-PAID-COMM-TOTALS.
  1854         16  CO-YTD-PAID-COMMS.
  1855             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1856             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1857
  1858     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1859         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1860         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1861
  1862     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1863         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1864         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1865         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  35
* EL050.cbl
  1866         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1867         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1868         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1869         88  CO-FINAL-LETTER                  VALUE 'F'.
  1870         88  CO-RECONCILING                   VALUE 'R'.
  1871         88  CO-PHONE-CALL                    VALUE 'P'.
  1872         88  CO-LEGAL                         VALUE 'L'.
  1873         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1874         88  CO-WRITE-OFF                     VALUE 'W'.
  1875         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1876
  1877     12  CO-CSR-CODE                       PIC X(4).
  1878
  1879     12  CO-GA-STATUS-INFO.
  1880         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1881         16  CO-GA-TERMINATION-DT          PIC XX.
  1882         16  CO-GA-STATUS-CODE             PIC X.
  1883             88  CO-GA-ACTIVE                 VALUE 'A'.
  1884             88  CO-GA-INACTIVE               VALUE 'I'.
  1885             88  CO-GA-PENDING                VALUE 'P'.
  1886         16  CO-GA-COMMENTS.
  1887             20  CO-GA-COMMENT-1           PIC X(40).
  1888             20  CO-GA-COMMENT-2           PIC X(40).
  1889             20  CO-GA-COMMENT-3           PIC X(40).
  1890             20  CO-GA-COMMENT-4           PIC X(40).
  1891
  1892     12  CO-RPTCD2                         PIC X(10).
  1893     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1894         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1895         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1896
  1897     12  CO-TYPE-AGENT                     PIC X(01).
  1898         88  CO-CORPORATION                   VALUE 'C'.
  1899         88  CO-PARTNERSHIP                   VALUE 'P'.
  1900         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1901         88  CO-TRUST                         VALUE 'T'.
  1902         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1903
  1904     12  CO-FAXNO.
  1905         16  CO-FAX-AREA-CODE                  PIC XXX.
  1906         16  CO-FAX-PREFIX                     PIC XXX.
  1907         16  CO-FAX-PHONE                      PIC X(4).
  1908
  1909     12  CO-BANK-INFORMATION.
  1910         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1911         16  CO-BANK-TRANSIT-NON REDEFINES
  1912             CO-BANK-TRANSIT-NO                PIC 9(8).
  1913
  1914         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1915     12  CO-MISC-DEDUCT-INFO REDEFINES
  1916                  CO-BANK-INFORMATION.
  1917         16  CO-MD-GL-ACCT                     PIC X(10).
  1918         16  CO-MD-DIV                         PIC XX.
  1919         16  CO-MD-CENTER                      PIC X(4).
  1920         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1921         16  CO-CREATE-AP-CHECK                PIC X.
  1922         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1923         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  36
* EL050.cbl
  1924     12  CO-ACH-STATUS                         PIC X.
  1925         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1926         88  CO-ACH-PENDING                        VALUE 'P'.
  1927
  1928     12  CO-BILL-SW                            PIC X.
  1929     12  CO-CONTROL-NAME                       PIC X(30).
  1930     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1931     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1932     12  CO-CLP-STATE                          PIC XX.
  1933     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1934     12  CO-SPP-REFUND-EDIT                    PIC X.
  1935
  1936******************************************************************
  1937
  1938*    COPY ERCAGTC.
  1939******************************************************************
  1940*                                                                *
  1941*                                                                *
  1942*                            ERCAGTC                             *
  1943*                            VMOD=2.001                          *
  1944*                                                                *
  1945*   ONLINE CREDIT SYSTEM                                         *
  1946*                                                                *
  1947*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1948*                                                                *
  1949*   FILE TYPE = VSAM,KSDS                                        *
  1950*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1951*                                                                *
  1952*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1953*       ALTERNATE PATH = NONE                                    *
  1954*                                                                *
  1955*   LOG = NO                                                     *
  1956*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1957*                                                                *
  1958******************************************************************
  1959*                   C H A N G E   L O G
  1960*
  1961* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1962*-----------------------------------------------------------------
  1963*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1964* EFFECTIVE    NUMBER
  1965*-----------------------------------------------------------------
  1966* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1967* 111004                         NEW FILE AND COPYBOOK
  1968* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1969******************************************************************
  1970 01  AGENT-COMMISSIONS.
  1971     12  AG-RECORD-ID                          PIC XX.
  1972         88  VALID-CO-ID                          VALUE 'AG'.
  1973     12  AG-CONTROL-PRIMARY.
  1974         16  AG-COMPANY-CD                     PIC X.
  1975         16  AG-CONTROL.
  1976             20  AG-CTL-1.
  1977                 24  AG-CARR-GROUP.
  1978                     28  AG-CARRIER            PIC X.
  1979                     28  AG-GROUPING           PIC X(6).
  1980                 24  AG-BANK                   PIC X(10).
  1981             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  37
* EL050.cbl
  1982                 24  AG-EXP-DT                 PIC XX.
  1983         16  AG-TYPE                           PIC X.
  1984             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1985             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1986     12  AG-MAINT-INFORMATION.
  1987         16  AG-LAST-MAINT-DT                  PIC XX.
  1988         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1989         16  AG-LAST-MAINT-USER                PIC X(4).
  1990         16  FILLER                            PIC X(10).
  1991     12  AG-EFF-DT                             PIC XX.
  1992     12  AG-COMM-STRUCTURE.
  1993         16  AG-AGT-COMMS OCCURS 10.
  1994             20  AG-AGT                PIC X(10).
  1995             20  AG-COM-TYP            PIC X.
  1996             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1997             20  AG-RECALC-LV-INDIC    PIC X.
  1998             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1999             20  AG-LRCALC-LV-INDIC    PIC X.
  2000             20  FILLER                PIC X(05).
  2001     12  FILLER                  PIC X(145).
  2002******************************************************************
  2003*    COPY ERCRESS.
  2004******************************************************************
  2005*                                                                *
  2006*                            ERCRESS                             *
  2007*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2008*                            VMOD=2.002                          *
  2009*                                                                *
  2010*   CREDIT RESIDENT STATE TAXES MASTER                          *
  2011*                                                                *
  2012*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  2013*   VSAM RESIDENT STATE TAX MASTER                              *
  2014*                                                                *
  2015*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  2016*                                                                *
  2017*   FILE TYPE = VSAM,KSDS                                        *
  2018*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  2019*                                                                *
  2020*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  2021*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  2022*                                                                *
  2023*   LOG = NO                                                     *
  2024*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2025*                                                                *
  2026*                                                                *
  2027******************************************************************
  2028
  2029 01  RESIDENT-STATE-TAX-MASTER.
  2030
  2031     10  ERRESS-PRIMARY-KEY.
  2032         15  RES-COMPANY-CD        PIC X.
  2033         15  RES-RESIDENT-STATE    PIC XX.
  2034         15  RES-COVERAGE-CATEGORY PIC X.
  2035         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  2036*                                      YYYYMMDD
  2037*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  2038
  2039     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  38
* EL050.cbl
  2040
  2041         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  2042         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2043         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  2044         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2045
  2046     10 RES-RECALC-SW              PIC   X.
  2047         88 RECALC                VALUE 'Y'.
  2048         88 NO-RECALC             VALUE 'N'.
  2049     10  RES-MAINT-BY              PIC X(4).
  2050     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  2051     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  2052*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  39
* EL050.cbl
  2054*    COPY ERCRESC.
  2055******************************************************************
  2056*                                                                *
  2057*                            ERCRESC                             *
  2058*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2059*                            VMOD=2.003                          *
  2060*                                                                *
  2061*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  2062*                                                                *
  2063*   FILE TYPE = VSAM,KSDS                                        *
  2064*   RECORD SIZE = 103 RECFORM = FIXED                            *
  2065*                                                                *
  2066*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  2067*       ALTERNATE PATH1 = NONE                                   *
  2068*                                                                *
  2069*   LOG = NO                                                     *
  2070*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2071*                                                                *
  2072******************************************************************
  2073
  2074 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  2075
  2076     10  ERRESC-RECORD-KEY.
  2077         15  RESC-COMPANY-CD           PIC   X.
  2078         15  RESC-CARRIER              PIC   X.
  2079         15  RESC-GROUP                PIC   X(6).
  2080         15  RESC-STATE                PIC   XX.
  2081         15  RESC-ACCOUNT              PIC   X(10).
  2082         15  RESC-AGENT                PIC   X(10).
  2083         15  RESC-RESIDENT-STATE       PIC   XX.
  2084         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  2085*                                           YYYYMMDD
  2086     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  2087
  2088     10  RESC-COMM-RECORD-DATA.
  2089         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  2090             20 RESC-COVERAGE-CAT      PIC    X.
  2091             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  2092             20 RESC-COMMISSION-TAB REDEFINES
  2093                RESC-COMMISSION-PER    PIC  XXX.
  2094
  2095     10  RESC-MAINT-BY                 PIC X(4).
  2096     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2097     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2098*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  40
* EL050.cbl
  2100*    COPY ERCPLAN.
  2101******************************************************************
  2102*                                                                *
  2103*                                                                *
  2104*                            ERCPLAN                             *
  2105*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2106*                            VMOD=2.003                          *
  2107*                                                                *
  2108*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2109*                                                                *
  2110*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2111*   PLAN MASTER                                                  *
  2112*                                                                *
  2113*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2114*                                                                *
  2115*   FILE TYPE = VSAM,KSDS                                        *
  2116*   RECORD SIZE = 420   RECFORM = FIX                            *
  2117*                                                                *
  2118*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2119*       ALTERNATE PATH1 = N/A                                    *
  2120*                                                                *
  2121*   LOG = NO                                                     *
  2122*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2123*                                                                *
  2124*                                                                *
  2125******************************************************************
  2126
  2127 01  PLAN-MASTER.
  2128     12  PL-RECORD-ID                      PIC XX.
  2129         88  VALID-PL-ID                      VALUE 'PL'.
  2130
  2131     12  PL-CONTROL-PRIMARY.
  2132         16  PL-COMPANY-CD                 PIC X.
  2133         16  PL-MSTR-CNTRL.
  2134             20  PL-CONTROL-A.
  2135                 24  PL-CARRIER            PIC X.
  2136                 24  PL-GROUPING           PIC X(6).
  2137                 24  PL-STATE              PIC XX.
  2138                 24  PL-ACCOUNT            PIC X(10).
  2139             20  PL-BENEFIT-TYPE           PIC X.
  2140             20  PL-BENEFIT-CODE           PIC XX.
  2141             20  PL-REVISION-NO            PIC X(3).
  2142
  2143     12  PL-CONTROL-BY-VAR-GRP.
  2144         16  PL-COMPANY-CD-A1              PIC X.
  2145         16  PL-VG-CARRIER                 PIC X.
  2146         16  PL-VG-GROUPING                PIC X(6).
  2147         16  PL-VG-STATE                   PIC XX.
  2148         16  PL-VG-ACCOUNT                 PIC X(10).
  2149         16  PL-BENEFIT-TYPE-A1            PIC X.
  2150         16  PL-BENEFIT-CODE-A1            PIC XX.
  2151         16  PL-REVISION-NO-A1             PIC 999.
  2152
  2153     12  PL-MAINT-INFORMATION.
  2154         16  PL-LAST-MAINT-DT              PIC XX.
  2155         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2156         16  PL-LAST-MAINT-USER            PIC X(4).
  2157         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  41
* EL050.cbl
  2158
  2159     12  PL-LIABILITY-LIMITS.
  2160         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2161         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2162             20  PL-LM-AGE                 PIC S99        COMP-3.
  2163             20  PL-LM-DUR                 PIC S999       COMP-3.
  2164             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2165             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2166
  2167     12  FILLER                            PIC X(30).
  2168
  2169     12  PL-GL-ACCOUNT-NOS.
  2170         16  PL-PREMIUM-GL                 PIC X(8).
  2171         16  PL-COMM-GL                    PIC X(8).
  2172         16  PL-CLAIM-GL                   PIC X(8).
  2173     12  FILLER                            PIC X(24).
  2174     12  PL-TOLERANCES.
  2175         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2176         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2177         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2178         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2179         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2180         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2181     12  PL-OVER-SHORT.
  2182         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2183         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2184     12  FILLER                            PIC X(24).
  2185     12  PLAN-MISC.
  2186         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2187         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2188         16  PL-IG                         PIC X.
  2189         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2190         16  PL-POLICY-FORM                PIC X(12).
  2191         16  PL-EDIT-FOR-FORM              PIC X(01).
  2192         16  PL-DEV-CODE                   PIC XXX.
  2193         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2194         16  PL-CALC-METHOD                PIC X.
  2195         16  PL-BENEFIT-GROUP              PIC X(05).
  2196         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2197
  2198         16  FILLER                        PIC X(99).
  2199******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  42
* EL050.cbl
  2201*    COPY ELCCERT.
  2202******************************************************************
  2203*                                                                *
  2204*                            ELCCERT.                            *
  2205*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2206*                            VMOD=2.013                          *
  2207*                                                                *
  2208*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2209*                                                                *
  2210*   FILE TYPE = VSAM,KSDS                                        *
  2211*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2212*                                                                *
  2213*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2214*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2215*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2216*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2217*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2218*                                                                *
  2219*   LOG = YES                                                    *
  2220*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2221******************************************************************
  2222*                   C H A N G E   L O G
  2223*
  2224* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2225*-----------------------------------------------------------------
  2226*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2227* EFFECTIVE    NUMBER
  2228*-----------------------------------------------------------------
  2229* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2230* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2231* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2232* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2233* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2234* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2235* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2236* 032612  CR2011110200001  PEMA  AHL CHANGES
  2237* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2238* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2239* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  2240******************************************************************
  2241
  2242 01  CERTIFICATE-MASTER.
  2243     12  CM-RECORD-ID                      PIC XX.
  2244         88  VALID-CM-ID                      VALUE 'CM'.
  2245
  2246     12  CM-CONTROL-PRIMARY.
  2247         16  CM-COMPANY-CD                 PIC X.
  2248         16  CM-CARRIER                    PIC X.
  2249         16  CM-GROUPING.
  2250             20  CM-GROUPING-PREFIX        PIC X(3).
  2251             20  CM-GROUPING-PRIME         PIC X(3).
  2252         16  CM-STATE                      PIC XX.
  2253         16  CM-ACCOUNT.
  2254             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2255             20  CM-ACCOUNT-PRIME          PIC X(6).
  2256         16  CM-CERT-EFF-DT                PIC XX.
  2257         16  CM-CERT-NO.
  2258             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  43
* EL050.cbl
  2259             20  CM-CERT-SFX               PIC X.
  2260
  2261     12  CM-CONTROL-BY-NAME.
  2262         16  CM-COMPANY-CD-A1              PIC X.
  2263         16  CM-INSURED-LAST-NAME          PIC X(15).
  2264         16  CM-INSURED-INITIALS.
  2265             20  CM-INSURED-INITIAL1       PIC X.
  2266             20  CM-INSURED-INITIAL2       PIC X.
  2267
  2268     12  CM-CONTROL-BY-SSN.
  2269         16  CM-COMPANY-CD-A2              PIC X.
  2270         16  CM-SOC-SEC-NO.
  2271             20  CM-SSN-STATE              PIC XX.
  2272             20  CM-SSN-ACCOUNT            PIC X(6).
  2273             20  CM-SSN-LN3.
  2274                 25  CM-INSURED-INITIALS-A2.
  2275                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2276                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2277                 25 CM-PART-LAST-NAME-A2         PIC X.
  2278
  2279     12  CM-CONTROL-BY-CERT-NO.
  2280         16  CM-COMPANY-CD-A4              PIC X.
  2281         16  CM-CERT-NO-A4                 PIC X(11).
  2282
  2283     12  CM-CONTROL-BY-MEMB.
  2284         16  CM-COMPANY-CD-A5              PIC X.
  2285         16  CM-MEMBER-NO.
  2286             20  CM-MEMB-STATE             PIC XX.
  2287             20  CM-MEMB-ACCOUNT           PIC X(6).
  2288             20  CM-MEMB-LN4.
  2289                 25  CM-INSURED-INITIALS-A5.
  2290                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2291                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2292                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2293
  2294     12  CM-INSURED-PROFILE-DATA.
  2295         16  CM-INSURED-FIRST-NAME.
  2296             20  CM-INSURED-1ST-INIT       PIC X.
  2297             20  FILLER                    PIC X(9).
  2298         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2299         16  CM-INSURED-SEX                PIC X.
  2300             88  CM-SEX-MALE                  VALUE 'M'.
  2301             88  CM-SEX-FEMAL                 VALUE 'F'.
  2302         16  CM-INSURED-JOINT-AGE          PIC 99.
  2303         16  CM-JOINT-INSURED-NAME.
  2304             20  CM-JT-LAST-NAME           PIC X(15).
  2305             20  CM-JT-FIRST-NAME.
  2306                 24  CM-JT-1ST-INIT        PIC X.
  2307                 24  FILLER                PIC X(9).
  2308             20  CM-JT-INITIAL             PIC X.
  2309
  2310     12  CM-LIFE-DATA.
  2311         16  CM-LF-BENEFIT-CD              PIC XX.
  2312         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2313         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2314         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2315         16  CM-LF-DEV-CODE                PIC XXX.
  2316         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  44
* EL050.cbl
  2317         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2318         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2319         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2320         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2321         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2322         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2323         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2324         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2325         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2326         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2327         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2328         16  cm-temp-epiq                  pic xx.
  2329             88  EPIQ-CLASS                  value 'EQ'.
  2330*        16  FILLER                        PIC XX.
  2331
  2332     12  CM-AH-DATA.
  2333         16  CM-AH-BENEFIT-CD              PIC XX.
  2334         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2335         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2336         16  CM-AH-DEV-CODE                PIC XXX.
  2337         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2338         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2339         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2340         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2341         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2342         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2343         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2344         16  CM-AH-PAID-THRU-DT            PIC XX.
  2345             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2346         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2347         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2348         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2349         16  FILLER                        PIC X.
  2350
  2351     12  CM-LOAN-INFORMATION.
  2352         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2353         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2354                                           PIC S9(5)V99  COMP-3.
  2355         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2356         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2357         16  CM-PAY-FREQUENCY              PIC S99.
  2358         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2359         16  CM-RATE-CLASS                 PIC XX.
  2360         16  CM-BENEFICIARY                PIC X(25).
  2361         16  CM-POLICY-FORM-NO             PIC X(12).
  2362         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2363         16  CM-LAST-ADD-ON-DT             PIC XX.
  2364         16  CM-DEDUCTIBLE-AMOUNTS.
  2365             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2366             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2367         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2368             20  CM-RESIDENT-STATE         PIC XX.
  2369             20  CM-RATE-CODE              PIC X(4).
  2370             20  FILLER                    PIC XX.
  2371         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2372             20  CM-LOAN-OFFICER           PIC X(5).
  2373             20  FILLER                    PIC XXX.
  2374         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  45
* EL050.cbl
  2375         16  CM-UNDERWRITING-CODE          PIC X.
  2376             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2377         16  CM-POST-CARD-IND              PIC X.
  2378         16  CM-REF-INTERFACE-SW           PIC X.
  2379         16  CM-PREMIUM-TYPE               PIC X.
  2380             88  CM-SING-PRM                  VALUE '1'.
  2381             88  CM-O-B-COVERAGE              VALUE '2'.
  2382             88  CM-OPEN-END                  VALUE '3'.
  2383         16  CM-IND-GRP-TYPE               PIC X.
  2384             88  CM-INDIVIDUAL                VALUE 'I'.
  2385             88  CM-GROUP                     VALUE 'G'.
  2386         16  CM-SKIP-CODE                  PIC X.
  2387             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2388             88  SKIP-JULY                    VALUE '1'.
  2389             88  SKIP-AUGUST                  VALUE '2'.
  2390             88  SKIP-SEPTEMBER               VALUE '3'.
  2391             88  SKIP-JULY-AUG                VALUE '4'.
  2392             88  SKIP-AUG-SEPT                VALUE '5'.
  2393             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2394             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2395             88  SKIP-JUNE                    VALUE '8'.
  2396             88  SKIP-JUNE-JULY               VALUE '9'.
  2397             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2398             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2399         16  CM-PAYMENT-MODE               PIC X.
  2400             88  PAY-MONTHLY                  VALUE SPACE.
  2401             88  PAY-WEEKLY                   VALUE '1'.
  2402             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2403             88  PAY-BI-WEEKLY                VALUE '3'.
  2404             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2405         16  CM-LOAN-NUMBER                PIC X(8).
  2406         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2407         16  CM-OLD-LOF                    PIC XXX.
  2408*        16  CM-LOAN-OFFICER               PIC XXX.
  2409         16  CM-REIN-TABLE                 PIC XXX.
  2410         16  CM-SPECIAL-REIN-CODE          PIC X.
  2411         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2412         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2413         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2414
  2415     12  CM-STATUS-DATA.
  2416         16  CM-ENTRY-STATUS               PIC X.
  2417         16  CM-ENTRY-DT                   PIC XX.
  2418
  2419         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2420         16  CM-LF-CANCEL-DT               PIC XX.
  2421         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2422
  2423         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2424         16  CM-LF-DEATH-DT                PIC XX.
  2425         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2426
  2427         16  CM-LF-CURRENT-STATUS          PIC X.
  2428             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2429                                                'M' '4' '5' '9'.
  2430             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2431             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2432             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  46
* EL050.cbl
  2433             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2434             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2435             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2436             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2437             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2438             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2439             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2440             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2441             88  CM-LF-DECLINED               VALUE 'D'.
  2442             88  CM-LF-VOIDED                 VALUE 'V'.
  2443
  2444         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2445         16  CM-AH-CANCEL-DT               PIC XX.
  2446         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2447
  2448         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2449         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2450         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2451
  2452         16  CM-AH-CURRENT-STATUS          PIC X.
  2453             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2454                                                'M' '4' '5' '9'.
  2455             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2456             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2457             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2458             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2459             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2460             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2461             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2462             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2463             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2464             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2465             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2466             88  CM-AH-DECLINED               VALUE 'D'.
  2467             88  CM-AH-VOIDED                 VALUE 'V'.
  2468
  2469         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2470             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2471             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2472             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2473         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2474
  2475         16  CM-ENTRY-BATCH                PIC X(6).
  2476         16  CM-LF-EXIT-BATCH              PIC X(6).
  2477         16  CM-AH-EXIT-BATCH              PIC X(6).
  2478         16  CM-LAST-MONTH-END             PIC XX.
  2479
  2480     12  CM-NOTE-SW                        PIC X.
  2481         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2482         88  CERT-NOTES-PRESENT               VALUE '1'.
  2483         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2484         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2485         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2486         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2487         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2488         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2489     12  CM-COMP-EXCP-SW                   PIC X.
  2490         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  47
* EL050.cbl
  2491         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2492     12  CM-INSURED-ADDRESS-SW             PIC X.
  2493         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2494         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2495
  2496*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2497     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2498     12  FILLER                            PIC X.
  2499
  2500*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2501     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2502     12  FILLER                            PIC X.
  2503*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2504     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  2505
  2506     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2507         88  CERT-ADDED-BATCH                 VALUE ' '.
  2508         88  CERT-ADDED-ONLINE                VALUE '1'.
  2509         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2510         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2511         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2512     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2513         88  CERT-AS-LOADED                   VALUE ' '.
  2514         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2515         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2516         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2517         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2518         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2519         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2520         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2521
  2522     12  CM-ACCOUNT-COMM-PCTS.
  2523         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2524         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2525
  2526     12  CM-USER-FIELD                     PIC X.
  2527     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2528     12  CM-CLP-STATE                      PIC XX.
  2529     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2530     12  CM-USER-RESERVED                  PIC XXX.
  2531     12  FILLER REDEFINES CM-USER-RESERVED.
  2532         16  CM-AH-CLASS-CD                PIC XX.
  2533         16  F                             PIC X.
  2534******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  48
* EL050.cbl
  2536*    COPY ERCMAIL.
  2537******************************************************************
  2538*                                                                *
  2539*                                                                *
  2540*                            ERCMAIL                             *
  2541*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2542*                            VMOD=2.003                          *
  2543*                                                                *
  2544*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2545*                                                                *
  2546*   FILE TYPE = VSAM,KSDS                                        *
  2547*   RECORD SIZE = 374   RECFORM = FIX                            *
  2548*                                                                *
  2549*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2550*   ALTERNATE PATH    = NOT USED                                 *
  2551*                                                                *
  2552*   LOG = YES                                                    *
  2553*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2554******************************************************************
  2555*                   C H A N G E   L O G
  2556*
  2557* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2558*-----------------------------------------------------------------
  2559*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2560* EFFECTIVE    NUMBER
  2561*-----------------------------------------------------------------
  2562* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2563* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2564* 111108                   PEMA  ADD CRED BENE ADDR2
  2565******************************************************************
  2566
  2567 01  MAILING-DATA.
  2568     12  MA-RECORD-ID                      PIC XX.
  2569         88  VALID-MA-ID                       VALUE 'MA'.
  2570
  2571     12  MA-CONTROL-PRIMARY.
  2572         16  MA-COMPANY-CD                 PIC X.
  2573         16  MA-CARRIER                    PIC X.
  2574         16  MA-GROUPING.
  2575             20  MA-GROUPING-PREFIX        PIC XXX.
  2576             20  MA-GROUPING-PRIME         PIC XXX.
  2577         16  MA-STATE                      PIC XX.
  2578         16  MA-ACCOUNT.
  2579             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2580             20  MA-ACCOUNT-PRIME          PIC X(6).
  2581         16  MA-CERT-EFF-DT                PIC XX.
  2582         16  MA-CERT-NO.
  2583             20  MA-CERT-PRIME             PIC X(10).
  2584             20  MA-CERT-SFX               PIC X.
  2585
  2586     12  FILLER                            PIC XX.
  2587
  2588     12  MA-ACCESS-CONTROL.
  2589         16  MA-SOURCE-SYSTEM              PIC XX.
  2590             88  MA-FROM-CREDIT                VALUE 'CR'.
  2591             88  MA-FROM-VSI                   VALUE 'VS'.
  2592             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2593             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  49
* EL050.cbl
  2594         16  MA-RECORD-ADD-DT              PIC XX.
  2595         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2596         16  MA-LAST-MAINT-DT              PIC XX.
  2597         16  MA-LAST-MAINT-BY              PIC XXXX.
  2598         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2599
  2600     12  MA-PROFILE-INFO.
  2601         16  MA-QUALIFY-CODE-1             PIC XX.
  2602         16  MA-QUALIFY-CODE-2             PIC XX.
  2603         16  MA-QUALIFY-CODE-3             PIC XX.
  2604         16  MA-QUALIFY-CODE-4             PIC XX.
  2605         16  MA-QUALIFY-CODE-5             PIC XX.
  2606
  2607         16  MA-INSURED-LAST-NAME          PIC X(15).
  2608         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2609         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2610         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2611         16  MA-INSURED-BIRTH-DT           PIC XX.
  2612         16  MA-INSURED-SEX                PIC X.
  2613             88  MA-SEX-MALE                   VALUE 'M'.
  2614             88  MA-SEX-FEMALE                 VALUE 'F'.
  2615         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2616
  2617         16  MA-ADDRESS-CORRECTED          PIC X.
  2618         16  MA-JOINT-BIRTH-DT             PIC XX.
  2619*        16  FILLER                        PIC X(12).
  2620
  2621         16  MA-ADDRESS-LINE-1             PIC X(30).
  2622         16  MA-ADDRESS-LINE-2             PIC X(30).
  2623         16  MA-CITY-STATE.
  2624             20  MA-CITY                   PIC X(28).
  2625             20  MA-ADDR-STATE             PIC XX.
  2626         16  MA-ZIP.
  2627             20  MA-ZIP-CODE.
  2628                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2629                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2630                 24  FILLER                PIC X(4).
  2631             20  MA-ZIP-PLUS4              PIC X(4).
  2632         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2633             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2634             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2635             20  FILLER                    PIC X(3).
  2636
  2637         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2638
  2639         16  FILLER                        PIC XXX.
  2640*        16  FILLER                        PIC X(10).
  2641
  2642     12  MA-CRED-BENE-INFO.
  2643         16  MA-CRED-BENE-NAME                 PIC X(25).
  2644         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2645         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2646         16  MA-CRED-BENE-CTYST.
  2647             20  MA-CRED-BENE-CITY             PIC X(28).
  2648             20  MA-CRED-BENE-STATE            PIC XX.
  2649         16  MA-CRED-BENE-ZIP.
  2650             20  MA-CB-ZIP-CODE.
  2651                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  50
* EL050.cbl
  2652                     88  MA-CB-CANADIAN-POST-CODE
  2653                                           VALUE 'A' THRU 'Z'.
  2654                 24  FILLER                    PIC X(4).
  2655             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2656         16  MA-CB-CANADIAN-POSTAL-CODE
  2657                            REDEFINES MA-CRED-BENE-ZIP.
  2658             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2659             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2660             20  FILLER                        PIC X(3).
  2661     12  MA-POST-CARD-MAIL-DATA.
  2662         16  MA-MAIL-DATA OCCURS 7.
  2663             20  MA-MAIL-TYPE              PIC X.
  2664                 88  MA-12MO-MAILING           VALUE '1'.
  2665                 88  MA-EXP-MAILING            VALUE '2'.
  2666             20  MA-MAIL-STATUS            PIC X.
  2667                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2668                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2669                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2670             20  MA-MAIL-DATE              PIC XX.
  2671     12  FILLER                            PIC XX.
  2672     12  FILLER                            PIC XX.
  2673*    12  FILLER                            PIC X(30).
  2674******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  51
* EL050.cbl
  2676*    COPY ERCPNDM.
  2677******************************************************************
  2678*                                                                *
  2679*                                                                *
  2680*                            ERCPNDM                             *
  2681*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2682*                            VMOD=2.003                          *
  2683*                                                                *
  2684*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2685*                                                                *
  2686*   FILE TYPE = VSAM,KSDS                                        *
  2687*   RECORD SIZE = 374   RECFORM = FIX                            *
  2688*                                                                *
  2689*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2690*   ALTERNATE PATH    = NOT USED                                 *
  2691*                                                                *
  2692*   LOG = YES                                                    *
  2693*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2694******************************************************************
  2695*                   C H A N G E   L O G
  2696*
  2697* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2698*-----------------------------------------------------------------
  2699*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2700* EFFECTIVE    NUMBER
  2701*-----------------------------------------------------------------
  2702* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2703* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2704* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2705* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  2706******************************************************************
  2707
  2708 01  PENDING-MAILING-DATA.
  2709     12  PM-RECORD-ID                      PIC XX.
  2710         88  VALID-MA-ID                       VALUE 'PM'.
  2711
  2712     12  PM-CONTROL-PRIMARY.
  2713         16  PM-COMPANY-CD                 PIC X.
  2714         16  PM-ENTRY-BATCH                PIC X(6).
  2715         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2716         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2717
  2718     12  FILLER                            PIC X(14).
  2719
  2720     12  PM-ACCESS-CONTROL.
  2721         16  PM-SOURCE-SYSTEM              PIC XX.
  2722             88  PM-FROM-CREDIT                VALUE 'CR'.
  2723             88  PM-FROM-VSI                   VALUE 'VS'.
  2724             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2725             88  PM-FROM-OTHER                 VALUE 'OT'.
  2726         16  PM-RECORD-ADD-DT              PIC XX.
  2727         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2728         16  PM-LAST-MAINT-DT              PIC XX.
  2729         16  PM-LAST-MAINT-BY              PIC XXXX.
  2730         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2731
  2732     12  PM-PROFILE-INFO.
  2733         16  PM-QUALIFY-CODE-1             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  52
* EL050.cbl
  2734         16  PM-QUALIFY-CODE-2             PIC XX.
  2735         16  PM-QUALIFY-CODE-3             PIC XX.
  2736         16  PM-QUALIFY-CODE-4             PIC XX.
  2737         16  PM-QUALIFY-CODE-5             PIC XX.
  2738
  2739         16  PM-INSURED-LAST-NAME          PIC X(15).
  2740         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2741         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2742         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2743         16  PM-INSURED-BIRTH-DT           PIC XX.
  2744         16  PM-INSURED-SEX                PIC X.
  2745             88  PM-SEX-MALE                   VALUE 'M'.
  2746             88  PM-SEX-FEMALE                 VALUE 'F'.
  2747         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2748
  2749         16  PM-ADDRESS-CORRECTED          PIC X.
  2750         16  PM-JOINT-BIRTH-DT             PIC XX.
  2751*        16  FILLER                        PIC X(12).
  2752
  2753         16  PM-ADDRESS-LINE-1             PIC X(30).
  2754         16  PM-ADDRESS-LINE-2             PIC X(30).
  2755         16  PM-CITY-STATE.
  2756             20  PM-CITY                   PIC X(28).
  2757             20  PM-STATE                  PIC XX.
  2758         16  PM-ZIP.
  2759             20  PM-ZIP-CODE.
  2760                 24  PM-ZIP-1              PIC X.
  2761                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2762                 24  FILLER                PIC X(4).
  2763             20  PM-ZIP-PLUS4              PIC X(4).
  2764         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2765             20  PM-CAN-POST1              PIC XXX.
  2766             20  PM-CAN-POST2              PIC XXX.
  2767             20  FILLER                    PIC XXX.
  2768
  2769         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2770         16  pm-city-st-zip-verified       pic x.
  2771         16  FILLER                        PIC XX.
  2772
  2773     12  PM-CRED-BENE-INFO.
  2774         16  PM-CRED-BENE-NAME             PIC X(25).
  2775         16  PM-CRED-BENE-ADDR             PIC X(30).
  2776         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2777         16  PM-CRED-BENE-CTYST.
  2778             20  PM-CRED-BENE-CITY         PIC X(28).
  2779             20  PM-CRED-BENE-STATE        PIC XX.
  2780         16  PM-CRED-BENE-ZIP.
  2781             20  PM-CB-ZIP-CODE.
  2782                 24  PM-CB-ZIP-1           PIC X.
  2783                     88  PM-CB-CANADIAN-POST-CODE
  2784                                  VALUE 'A' THRU 'Z'.
  2785                 24  FILLER                PIC X(4).
  2786             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2787         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2788             20  PM-CB-CAN-POST1           PIC XXX.
  2789             20  PM-CB-CAN-POST2           PIC XXX.
  2790             20  FILLER                    PIC XXX.
  2791     12  PM-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  53
* EL050.cbl
  2792         16  PM-MAIL-DATA OCCURS 7.
  2793             20  PM-MAIL-TYPE              PIC X.
  2794                 88  PM-12MO-MAILING           VALUE '1'.
  2795                 88  PM-EXP-MAILING            VALUE '2'.
  2796             20  PM-MAIL-STATUS            PIC X.
  2797                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2798                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2799                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2800             20  PM-MAIL-DATE              PIC XX.
  2801     12  FILLER                            PIC XX.
  2802     12  FILLER                            PIC X(12).
  2803*    12  FILLER                            PIC X(30).
  2804
  2805******************************************************************
  2806*                                COPY ERCLOFC.
  2807******************************************************************
  2808*                                                                *
  2809*                                                                *
  2810*                            ERCLOFC                             *
  2811*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2812*                            VMOD=2.003                          *
  2813*                                                                *
  2814*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2815*                                                                *
  2816*   FILE TYPE = VSAM,KSDS                                        *
  2817*   RECORD SIZE = 670   RECFORM = FIX                            *
  2818*                                                                *
  2819*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2820*                                                                *
  2821*   LOG = YES                                                    *
  2822*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2823*                                                                *
  2824******************************************************************
  2825
  2826 01  LOAN-OFFICER-MASTER.
  2827     12  LO-RECORD-ID                PIC XX.
  2828         88  VALID-LO-ID                VALUE 'LO'.
  2829
  2830     12  LO-CONTROL-PRIMARY.
  2831         16  LO-COMPANY-CD           PIC X.
  2832         16  LO-CARRIER              PIC X.
  2833         16  LO-GROUPING.
  2834             20  LO-GROUPING-PREFIX  PIC XXX.
  2835             20  LO-GROUPING-PRIME   PIC XXX.
  2836         16  LO-STATE                PIC XX.
  2837         16  LO-ACCOUNT.
  2838             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2839             20  LO-ACCOUNT-PRIME    PIC X(6).
  2840         16  LO-OFFICER-CODE         PIC X(5).
  2841
  2842     12  LO-OFFICER-NAME             PIC X(30).
  2843
  2844     12  LO-LAST-MAINT-DT            PIC XX.
  2845     12  LO-LAST-USER                PIC X(4).
  2846     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2847
  2848     12  LO-COMP-CONTROL             PIC X.
  2849             88  LO-SHOW-COMP           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  54
* EL050.cbl
  2850             88  LO-SUPPRESS-COMP       VALUE 'N'.
  2851     12  LO-DETAIL-CONTROL           PIC X.
  2852             88  LO-PRINT-DETAIL        VALUE 'D'.
  2853             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2854
  2855     12  LO-SV-CARRIER               PIC X.
  2856     12  LO-SV-GROUPING              PIC X(6).
  2857     12  LO-SV-STATE                 PIC XX.
  2858
  2859     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2860     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2861
  2862     12  LO-OFFICER-INFO.
  2863         16  FILLER OCCURS 12 TIMES.
  2864             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2865             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2866             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2867             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2868             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2869             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2870             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2871             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2872     12  FILLER                      PIC X(198).
  2873******************************************************************
  2874*                                COPY ERCPDEF.
  2875******************************************************************
  2876*                                                                *
  2877*                                                                *
  2878*                            ERCPDEF.                            *
  2879*                                                                *
  2880*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2881*                                                                *
  2882*    FILE TYPE = VSAM,KSDS                                       *
  2883*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2884*                                                                *
  2885*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2886*                                                                *
  2887*    LOG = YES                                                   *
  2888*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2889******************************************************************
  2890*                   C H A N G E   L O G
  2891*
  2892* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2893*-----------------------------------------------------------------
  2894*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2895* EFFECTIVE    NUMBER
  2896*-----------------------------------------------------------------
  2897* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2898* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2899* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2900******************************************************************
  2901 01  PRODUCT-MASTER.
  2902    12  PD-RECORD-ID                 PIC X(02).
  2903        88  VALID-PD-ID                  VALUE 'PD'.
  2904    12  PD-CONTROL-PRIMARY.
  2905        16  PD-COMPANY-CD            PIC X.
  2906        16  PD-STATE                 PIC XX.
  2907        16  PD-PRODUCT-CD            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  55
* EL050.cbl
  2908        16  PD-FILLER                PIC X(7).
  2909        16  PD-BEN-TYPE              PIC X.
  2910        16  PD-BEN-CODE              PIC XX.
  2911        16  PD-PROD-EXP-DT           PIC XX.
  2912    12  FILLER                       PIC X(50).
  2913    12  PD-PRODUCT-DATA OCCURS 8.
  2914        16  PD-PROD-CODE             PIC X.
  2915            88  PD-PROD-LIFE           VALUE 'L'.
  2916            88  PD-PROD-PROP           VALUE 'P'.
  2917            88  PD-PROD-AH             VALUE 'A'.
  2918            88  PD-PROD-IU             VALUE 'I'.
  2919            88  PD-PROD-GAP            VALUE 'G'.
  2920            88  PD-PROD-FAML           VALUE 'F'.
  2921        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2922        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2923        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2924        16  PD-MAX-TERM              PIC S999        COMP-3.
  2925        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2926        16  FILLER                   PIC X.
  2927        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2928        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2929        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2930        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2931        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2932        16  PD-REC-CRIT-PERIOD       PIC 99.
  2933        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2934            20  PD-RECURRING-YN      PIC X.
  2935            20  FILLER               PIC X.
  2936        16  PD-RTW-MOS               PIC 99.
  2937        16  PD-MAX-EXTENSION         PIC 99.
  2938        16  pd-ben-pct               pic sv999 comp-3.
  2939*       16  FILLER                   PIC XX.
  2940    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2941    12  PD-TERM-LIMITS OCCURS 15.
  2942        16  PD-LOW-TERM              PIC S999        COMP-3.
  2943        16  PD-HI-TERM               PIC S999        COMP-3.
  2944*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2945    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2946        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2947        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2948    12  PD-EARN-FACTORS.
  2949        16  FILLER OCCURS 15.
  2950            20  FILLER OCCURS 15.
  2951                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2952    12  PD-PRODUCT-DESC              PIC X(80).
  2953    12  PD-TRUNCATED                 PIC X.
  2954    12  FILLER                       PIC X(59).
  2955    12  PD-MAINT-INFORMATION.
  2956        16  PD-LAST-MAINT-DT         PIC X(02).
  2957        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2958        16  PD-LAST-MAINT-BY         PIC X(04).
  2959*                                COPY ELCSTATE.
  2960******************************************************************
  2961*                                                                *
  2962*                                                                *
  2963*                            ELCSTATE.                           *
  2964*                                                                *
  2965*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  56
* EL050.cbl
  2966*                                                                *
  2967*   FILE TYPE = VSAM,KSDS                                        *
  2968*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2969*                                                                *
  2970*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2971*       ALTERNATE INDEX = NONE                                   *
  2972*                                                                *
  2973*   LOG = YES                                                    *
  2974*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2975******************************************************************
  2976*                   C H A N G E   L O G
  2977*
  2978* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2979*-----------------------------------------------------------------
  2980*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2981* EFFECTIVE    NUMBER
  2982*-----------------------------------------------------------------
  2983* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2984******************************************************************
  2985*
  2986 01  STATE-FILE.
  2987     12  SF-RECORD-ID                       PIC XX.
  2988         88  VALID-CF-ID                        VALUE 'SF'.
  2989     12  SF-CONTROL-PRIMARY.
  2990         16  SF-COMPANY-ID                  PIC XXX.
  2991         16  SF-CARRIER-CODE                PIC X.
  2992         16  SF-GROUPING                    PIC X(6).
  2993         16  SF-STATE-CODE                  PIC XX.
  2994         16  SF-EXPIRE-DATE                 PIC 9(8).
  2995****************************************************************
  2996*             STATE CONTROLS
  2997****************************************************************
  2998     12  SF-LAST-MAINT-DT                   PIC XX.
  2999     12  SF-LAST-MAINT-BY                   PIC X(4).
  3000     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3001     12  SF-STATE-RT-CONTROLS.
  3002         16  SF-ST-RT-CALC                  PIC X.
  3003     12  SF-ST-TAX-CONTROLS.
  3004         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3005         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3006         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3007     12  SF-ST-REFUND-OPTIONS.
  3008         16  SF-ST-RF-LR-CALC               PIC X.
  3009         16  SF-ST-RF-LL-CALC               PIC X.
  3010         16  SF-ST-RF-LN-CALC               PIC X.
  3011         16  SF-ST-RF-AH-CALC               PIC X.
  3012         16  SF-ST-RF-CP-CALC               PIC X.
  3013     12  SF-ST-UNEARN-PREM-OPTIONS.
  3014         16  SF-ST-LUEP-R78                 PIC X.
  3015         16  SF-ST-LUEP-PRO                 PIC X.
  3016         16  SF-ST-LUEP-ST                  PIC X.
  3017         16  SF-ST-LUEP-DOM                 PIC X.
  3018         16  SF-ST-AUEP-R78                 PIC X.
  3019         16  SF-ST-AUEP-PRO                 PIC X.
  3020         16  SF-ST-AUEP-ST                  PIC X.
  3021         16  SF-ST-AUEP-DOM                 PIC X.
  3022         16  SF-ST-CUEP-R78                 PIC X.
  3023         16  SF-ST-CUEP-PRO                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  57
* EL050.cbl
  3024         16  SF-ST-CUEP-ST                  PIC X.
  3025         16  SF-ST-CUEP-DOM                 PIC X.
  3026     12  SF-ST-EARN-PREM-OPTIONS.
  3027         16  SF-ST-LEP-R78                  PIC X.
  3028         16  SF-ST-LEP-PRO                  PIC X.
  3029         16  SF-ST-LEP-ST                   PIC X.
  3030         16  SF-ST-LEP-DOM                  PIC X.
  3031         16  SF-ST-AEP-R78                  PIC X.
  3032         16  SF-ST-AEP-PRO                  PIC X.
  3033         16  SF-ST-AEP-ST                   PIC X.
  3034         16  SF-ST-AEP-DOM                  PIC X.
  3035         16  SF-ST-CEP-R78                  PIC X.
  3036         16  SF-ST-CEP-PRO                  PIC X.
  3037         16  SF-ST-CEP-ST                   PIC X.
  3038         16  SF-ST-CEP-DOM                  PIC X.
  3039     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  58
* EL050.cbl
  3041*    COPY ELCCRTT.
  3042******************************************************************
  3043*                                                                *
  3044*                            ELCCRTT.                            *
  3045*                                                                *
  3046*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3047*                                                                *
  3048*   FILE TYPE = VSAM,KSDS                                        *
  3049*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3050*                                                                *
  3051*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3052*                                                                *
  3053*   LOG = YES                                                    *
  3054*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3055******************************************************************
  3056*                   C H A N G E   L O G
  3057*
  3058* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3059*-----------------------------------------------------------------
  3060*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3061* EFFECTIVE    NUMBER
  3062*-----------------------------------------------------------------
  3063* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3064* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3065* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3066* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3067* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3068* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3069* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3070* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3071* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3072* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  3073* 091318  CR2018073000001  PEMA  ADD Refund methods
  3074******************************************************************
  3075
  3076 01  CERTIFICATE-TRAILERS.
  3077     12  CS-RECORD-ID                      PIC XX.
  3078         88  VALID-CS-ID                      VALUE 'CS'.
  3079
  3080     12  CS-CONTROL-PRIMARY.
  3081         16  CS-COMPANY-CD                 PIC X.
  3082         16  CS-CARRIER                    PIC X.
  3083         16  CS-GROUPING                   PIC X(6).
  3084         16  CS-STATE                      PIC XX.
  3085         16  CS-ACCOUNT                    PIC X(10).
  3086         16  CS-CERT-EFF-DT                PIC XX.
  3087         16  CS-CERT-NO.
  3088             20  CS-CERT-PRIME             PIC X(10).
  3089             20  CS-CERT-SFX               PIC X.
  3090         16  CS-TRAILER-TYPE               PIC X.
  3091             88  COMM-TRLR           VALUE 'A'.
  3092             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3093             88  CERT-DATA-TRLR      VALUE 'C'.
  3094
  3095     12  CS-DATA-AREA                      PIC X(516).
  3096
  3097     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3098         16  CS-BANK-COMMISSION-AREA.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  59
* EL050.cbl
  3099             20  CS-BANK-COMMS       OCCURS 10.
  3100                 24  CS-AGT                PIC X(10).
  3101                 24  CS-COM-TYP            PIC X.
  3102                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3103                 24  CS-RECALC-LV-INDIC    PIC X.
  3104                 24  FILLER                PIC X(10).
  3105         16  FILLER                        PIC X(256).
  3106
  3107     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3108****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3109         16  CS-MB-CLAIM-DATA OCCURS 24.
  3110             20  CS-CLAIM-NO               PIC X(7).
  3111             20  CS-CLAIM-TYPE             PIC X.
  3112                 88  CS-AH-CLM               VALUE 'A'.
  3113                 88  CS-IU-CLM               VALUE 'I'.
  3114                 88  CS-GP-CLM               VALUE 'G'.
  3115                 88  CS-LF-CLM               VALUE 'L'.
  3116                 88  CS-PR-CLM               VALUE 'P'.
  3117                 88  CS-FL-CLM               VALUE 'F'.
  3118             20  CS-INSURED-TYPE           PIC X.
  3119                 88  CS-PRIM-INSURED          VALUE 'P'.
  3120                 88  CS-CO-BORROWER           VALUE 'C'.
  3121             20  CS-BENEFIT-PERIOD         PIC 99.
  3122             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3123             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3124             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3125         16  FILLER                        PIC X(12).
  3126     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3127         16  CS-VIN-NUMBER                 PIC X(17).
  3128         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3129         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3130         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3131         16  cs-agent-name.
  3132             20  cs-agent-fname            pic x(20).
  3133             20  cs-agent-mi               pic x.
  3134             20  cs-agent-lname            pic x(25).
  3135         16  cs-license-no                 pic x(15).
  3136         16  cs-npn-number                 pic x(10).
  3137         16  cs-agent-edit-status          pic x.
  3138             88  cs-ae-refer-to-manager      value 'M'.
  3139             88  cs-ae-cover-sheet           value 'C'.
  3140             88  cs-ae-sig-form              value 'S'.
  3141             88  cs-ae-verified              value 'V'.
  3142             88  cs-unidentified-signature   value 'U'.
  3143             88  cs-cert-returned            value 'R'.
  3144             88  cs-accept-no-commission     value 'N'.
  3145         16  cs-year                       pic 9999.
  3146         16  cs-make                       pic x(20).
  3147         16  cs-model                      pic x(20).
  3148         16  cs-future                     pic x(20).
  3149         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3150         16  cs-claim-verification-status  pic x.
  3151             88  cs-clm-ver-eligible         value 'A'.
  3152             88  cs-clm-ver-partial-elig     value 'B'.
  3153             88  cs-clm-ver-not-eligible     value 'C'.
  3154             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  3155             88  cs-clm-ver-not-part-elig-rw value 'E'.
  3156             88  cs-clm-ver-ND-CERT          value 'F'.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  60
* EL050.cbl
  3157             88  cs-clm-ver-spec-other       value 'G'.
  3158             88  cs-clam-ver-pratial-corrected
  3159                                             value 'H'.
  3160             88  cs-clm-ver-no-matches       value 'I'.
  3161             88  cs-clm-ver-not-elig-corrected
  3162                                             value 'J'.
  3163             88  cs-clm-ver-needs-review     value 'R'.
  3164             88  cs-clm-ver-sent-to-claims   value 'W'.
  3165         16  CS-LF-REFUND-METHOD           PIC X.
  3166         16  CS-AH-REFUND-METHOD           PIC X.
  3167         16  FILLER                        PIC X(353). *> was 420
  3168*        16  FILLER                        PIC X(496).
  3169*    COPY ELCCRTO.
  3170******************************************************************
  3171*                                                                *
  3172*                            ELCCRTO.                            *
  3173*                                                                *
  3174*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3175*                                                                *
  3176*   FILE TYPE = VSAM,KSDS                                        *
  3177*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3178*                                                                *
  3179*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3180*                                                                *
  3181*   LOG = YES                                                    *
  3182*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3183******************************************************************
  3184*                   C H A N G E   L O G
  3185*
  3186* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3187*-----------------------------------------------------------------
  3188*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3189* EFFECTIVE    NUMBER
  3190*-----------------------------------------------------------------
  3191* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3192* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3193* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3194* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3195* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3196******************************************************************
  3197 01  ORIGINAL-CERTIFICATE.
  3198     12  OC-RECORD-ID                      PIC XX.
  3199         88  VALID-OC-ID                      VALUE 'OC'.
  3200     12  OC-CONTROL-PRIMARY.
  3201         16  OC-COMPANY-CD                 PIC X.
  3202         16  OC-CARRIER                    PIC X.
  3203         16  OC-GROUPING                   PIC X(6).
  3204         16  OC-STATE                      PIC XX.
  3205         16  OC-ACCOUNT                    PIC X(10).
  3206         16  OC-CERT-EFF-DT                PIC XX.
  3207         16  OC-CERT-NO.
  3208             20  OC-CERT-PRIME             PIC X(10).
  3209             20  OC-CERT-SFX               PIC X.
  3210         16  OC-RECORD-TYPE                PIC X.
  3211         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3212     12  OC-LAST-MAINT-DT                  PIC XX.
  3213     12  OC-LAST-MAINT-BY                  PIC X(4).
  3214     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  61
* EL050.cbl
  3215     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3216     12  FILLER                            PIC X(49).
  3217     12  OC-ORIG-REC.
  3218         16  OC-INS-LAST-NAME              PIC X(15).
  3219         16  OC-INS-FIRST-NAME             PIC X(10).
  3220         16  OC-INS-MIDDLE-INIT            PIC X.
  3221         16  OC-INS-AGE                    PIC S999     COMP-3.
  3222         16  OC-JNT-LAST-NAME              PIC X(15).
  3223         16  OC-JNT-FIRST-NAME             PIC X(10).
  3224         16  OC-JNT-MIDDLE-INIT            PIC X.
  3225         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3226         16  OC-LF-BENCD                   PIC XX.
  3227         16  OC-LF-TERM                    PIC S999      COMP-3.
  3228         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3229         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3230         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3231         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3232         16  OC-LF-EXP-DT                  PIC XX.
  3233         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3234         16  OC-LF-CANCEL-DT               PIC XX.
  3235         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3236         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3237         16  OC-AH-BENCD                   PIC XX.
  3238         16  OC-AH-TERM                    PIC S999      COMP-3.
  3239         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3240         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3241         16  OC-AH-EXP-DT                  PIC XX.
  3242         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3243         16  OC-AH-CP                      PIC 99.
  3244         16  OC-AH-CANCEL-DT               PIC XX.
  3245         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3246         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3247         16  OC-CRED-BENE-NAME             PIC X(25).
  3248         16  OC-1ST-PMT-DT                 PIC XX.
  3249         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3250         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3251         16  OC-ISSUE-TRAN-IND             PIC X.
  3252         16  OC-CANCEL-TRAN-IND            PIC X.
  3253         16  FILLER                        PIC X(211).
  3254
  3255     12  FILLER                            PIC X(50).
  3256******************************************************************
  3257
  3258*    COPY ELCDATE.
  3259******************************************************************
  3260*                                                                *
  3261*                                                                *
  3262*                            ELCDATE.                            *
  3263*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3264*                            VMOD=2.003
  3265*                                                                *
  3266*                                                                *
  3267*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3268*                 LENGTH = 200                                   *
  3269******************************************************************
  3270
  3271 01  DATE-CONVERSION-DATA.
  3272     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  62
* EL050.cbl
  3273     12  DC-OPTION-CODE                PIC X.
  3274         88  BIN-TO-GREG                VALUE ' '.
  3275         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3276         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3277         88  YMD-GREG-TO-BIN            VALUE '3'.
  3278         88  MDY-GREG-TO-BIN            VALUE '4'.
  3279         88  JULIAN-TO-BIN              VALUE '5'.
  3280         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3281         88  FIND-CENTURY               VALUE '7'.
  3282         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3283         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3284         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3285         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3286         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3287         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3288         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3289         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3290         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3291         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3292         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3293         88  BIN-3-TO-GREG              VALUE 'I'.
  3294         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3295         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3296         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3297         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3298         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3299         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3300         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3301         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3302         88  THREE-CHARACTER-BIN
  3303                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3304         88  GREGORIAN-TO-BIN
  3305                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3306         88  BIN-TO-GREGORIAN
  3307                  VALUES ' ' '1' 'I' '8' 'G'.
  3308         88  JULIAN-TO-BINARY
  3309                  VALUES '5' 'C' 'E' 'F'.
  3310     12  DC-ERROR-CODE                 PIC X.
  3311         88  NO-CONVERSION-ERROR        VALUE ' '.
  3312         88  DATE-CONVERSION-ERROR
  3313                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3314         88  DATE-IS-ZERO               VALUE '1'.
  3315         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3316         88  DATE-IS-INVALID            VALUE '3'.
  3317         88  DATE1-GREATER-DATE2        VALUE '4'.
  3318         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3319         88  DATE-INVALID-OPTION        VALUE '9'.
  3320         88  INVALID-CENTURY            VALUE 'A'.
  3321         88  ONLY-CENTURY               VALUE 'B'.
  3322         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3323         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3324     12  DC-END-OF-MONTH               PIC X.
  3325         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3326     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3327         88  USE-NORMAL-PROCESS         VALUE ' '.
  3328         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3329         88  ADJUST-UP-100-YRS          VALUE '2'.
  3330     12  FILLER                        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  63
* EL050.cbl
  3331     12  DC-CONVERSION-DATES.
  3332         16  DC-BIN-DATE-1             PIC XX.
  3333         16  DC-BIN-DATE-2             PIC XX.
  3334         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3335         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3336                       DC-GREG-DATE-1-EDIT.
  3337             20  DC-EDIT1-MONTH        PIC 99.
  3338             20  SLASH1-1              PIC X.
  3339             20  DC-EDIT1-DAY          PIC 99.
  3340             20  SLASH1-2              PIC X.
  3341             20  DC-EDIT1-YEAR         PIC 99.
  3342         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3343         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3344                     DC-GREG-DATE-2-EDIT.
  3345             20  DC-EDIT2-MONTH        PIC 99.
  3346             20  SLASH2-1              PIC X.
  3347             20  DC-EDIT2-DAY          PIC 99.
  3348             20  SLASH2-2              PIC X.
  3349             20  DC-EDIT2-YEAR         PIC 99.
  3350         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3351         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3352                     DC-GREG-DATE-1-YMD.
  3353             20  DC-YMD-YEAR           PIC 99.
  3354             20  DC-YMD-MONTH          PIC 99.
  3355             20  DC-YMD-DAY            PIC 99.
  3356         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3357         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3358                      DC-GREG-DATE-1-MDY.
  3359             20  DC-MDY-MONTH          PIC 99.
  3360             20  DC-MDY-DAY            PIC 99.
  3361             20  DC-MDY-YEAR           PIC 99.
  3362         16  DC-GREG-DATE-1-ALPHA.
  3363             20  DC-ALPHA-MONTH        PIC X(10).
  3364             20  DC-ALPHA-DAY          PIC 99.
  3365             20  FILLER                PIC XX.
  3366             20  DC-ALPHA-CENTURY.
  3367                 24 DC-ALPHA-CEN-N     PIC 99.
  3368             20  DC-ALPHA-YEAR         PIC 99.
  3369         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3370         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3371         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3372         16  DC-JULIAN-DATE            PIC 9(05).
  3373         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3374                                       PIC 9(05).
  3375         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3376             20  DC-JULIAN-YEAR        PIC 99.
  3377             20  DC-JULIAN-DAYS        PIC 999.
  3378         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3379         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3380         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3381     12  DATE-CONVERSION-VARIBLES.
  3382         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3383         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3384             20  FILLER                PIC 9(3).
  3385             20  HOLD-CEN-1-CCYY.
  3386                 24  HOLD-CEN-1-CC     PIC 99.
  3387                 24  HOLD-CEN-1-YY     PIC 99.
  3388             20  HOLD-CEN-1-MO         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  64
* EL050.cbl
  3389             20  HOLD-CEN-1-DA         PIC 99.
  3390         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3391             20  HOLD-CEN-1-R-MO       PIC 99.
  3392             20  HOLD-CEN-1-R-DA       PIC 99.
  3393             20  HOLD-CEN-1-R-CCYY.
  3394                 24  HOLD-CEN-1-R-CC   PIC 99.
  3395                 24  HOLD-CEN-1-R-YY   PIC 99.
  3396             20  FILLER                PIC 9(3).
  3397         16  HOLD-CENTURY-1-X.
  3398             20  FILLER                PIC X(3)  VALUE SPACES.
  3399             20  HOLD-CEN-1-X-CCYY.
  3400                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3401                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3402             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3403             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3404         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3405             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3406             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3407             20  HOLD-CEN-1-R-X-CCYY.
  3408                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3409                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3410             20  FILLER                PIC XXX.
  3411         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3412         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3413         16  DC-JULIAN-DATE-1          PIC 9(07).
  3414         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3415             20  DC-JULIAN-1-CCYY.
  3416                 24  DC-JULIAN-1-CC    PIC 99.
  3417                 24  DC-JULIAN-1-YR    PIC 99.
  3418             20  DC-JULIAN-DA-1        PIC 999.
  3419         16  DC-JULIAN-DATE-2          PIC 9(07).
  3420         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3421             20  DC-JULIAN-2-CCYY.
  3422                 24  DC-JULIAN-2-CC    PIC 99.
  3423                 24  DC-JULIAN-2-YR    PIC 99.
  3424             20  DC-JULIAN-DA-2        PIC 999.
  3425         16  DC-GREG-DATE-A-EDIT.
  3426             20  DC-EDITA-MONTH        PIC 99.
  3427             20  SLASHA-1              PIC X VALUE '/'.
  3428             20  DC-EDITA-DAY          PIC 99.
  3429             20  SLASHA-2              PIC X VALUE '/'.
  3430             20  DC-EDITA-CCYY.
  3431                 24  DC-EDITA-CENT     PIC 99.
  3432                 24  DC-EDITA-YEAR     PIC 99.
  3433         16  DC-GREG-DATE-B-EDIT.
  3434             20  DC-EDITB-MONTH        PIC 99.
  3435             20  SLASHB-1              PIC X VALUE '/'.
  3436             20  DC-EDITB-DAY          PIC 99.
  3437             20  SLASHB-2              PIC X VALUE '/'.
  3438             20  DC-EDITB-CCYY.
  3439                 24  DC-EDITB-CENT     PIC 99.
  3440                 24  DC-EDITB-YEAR     PIC 99.
  3441         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3442         16  DC-GREG-DATE-CYMD-R REDEFINES
  3443                              DC-GREG-DATE-CYMD.
  3444             20  DC-CYMD-CEN           PIC 99.
  3445             20  DC-CYMD-YEAR          PIC 99.
  3446             20  DC-CYMD-MONTH         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  65
* EL050.cbl
  3447             20  DC-CYMD-DAY           PIC 99.
  3448         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3449         16  DC-GREG-DATE-MDCY-R REDEFINES
  3450                              DC-GREG-DATE-MDCY.
  3451             20  DC-MDCY-MONTH         PIC 99.
  3452             20  DC-MDCY-DAY           PIC 99.
  3453             20  DC-MDCY-CEN           PIC 99.
  3454             20  DC-MDCY-YEAR          PIC 99.
  3455    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3456        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3457    12  DC-EL310-DATE                  PIC X(21).
  3458    12  FILLER                         PIC X(28).
  3459
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  66
* EL050.cbl
  3461*    COPY ELCCALC.
  3462******************************************************************
  3463*                                                                *
  3464*                           ELCCALC.                            *
  3465*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3466*                            VMOD=2.025                          *
  3467*                                                                *
  3468*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3469*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3470*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3471*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3472*                                                                *
  3473*  PASSED TO ELRTRM                                              *
  3474*  -----------------                                             *
  3475*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3476*  ORIGINAL TERM                                                 *
  3477*  BEGINNING DATE                                                *
  3478*  ENDING DATE                                                   *
  3479*  COMPANY I.D.                                                  *
  3480*  ACCOUNT MASTER USER FIELD                                     *
  3481*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3482*  FREE LOOK DAYS                                                *
  3483*                                                                *
  3484*  RETURNED FROM ELRTRM                                          *
  3485*  ---------------------                                         *
  3486*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3487*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3488*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3489*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3490*----------------------------------------------------------------*
  3491*  PASSED TO ELRAMT                                              *
  3492*  ----------------                                              *
  3493*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3494*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3495*  ORIGINAL AMOUNT                                               *
  3496*  ALTERNATE BENEFIT (BALLON)                                    *
  3497*  A.P.R. - NET PAY ONLY                                         *
  3498*  METHOD
  3499*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3500*  COMPANY I.D.                                                  *
  3501*  BENEFIT TYPE                                                  *
  3502*                                                                *
  3503*  RETURNED FROM ELRAMT                                          *
  3504*  --------------------                                          *
  3505*  REMAINING AMOUNT 1 - CURRENT                                  *
  3506*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3507*  REMAINING AMOUNT FACTOR
  3508*----------------------------------------------------------------*
  3509*  PASSED TO ELRESV                                              *
  3510*  -----------------                                             *
  3511*  CERTIFICATE EFFECTIVE DATE                                    *
  3512*  VALUATION DATE                                                *
  3513*  PAID THRU DATE                                                *
  3514*  BENEFIT                                                       *
  3515*  INCURRED DATE                                                 *
  3516*  REPORTED DATE                                                 *
  3517*  ISSUE AGE                                                     *
  3518*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  67
* EL050.cbl
  3519*  CDT PERCENT                                                   *
  3520*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3521* *CLAIM TYPE (LIFE, A/H)                                        *
  3522* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3523* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3524*                                                                *
  3525*  RETURNED FROM ELRESV                                          *
  3526*  --------------------                                          *
  3527*  CDT TABLE USED                                                *
  3528*  CDT FACTOR USED                                               *
  3529*  PAY TO CURRENT RESERVE                                        *
  3530*  I.B.N.R. - A/H ONLY                                           *
  3531*  FUTURE (ACCRUED) AH ONLY                                      *
  3532*----------------------------------------------------------------*
  3533*  PASSED TO ELRATE                                              *
  3534*  ----------------                                              *
  3535*  CERT ISSUE DATE                                               *
  3536*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3537*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3538*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3539*  STATE CODE (CLIENT DEFINED)                                   *
  3540*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3541*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3542*  DEVIATION CODE                                                *
  3543*  ISSUE AGE                                                     *
  3544*  ORIGINAL BENEFIT AMOUNT                                       *
  3545*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3546*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3547*  BENEFIT KIND (LIFE OR A/H)                                    *
  3548*  A.P.R.                                                        *
  3549*  METHOD
  3550*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3551*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3552*  COMPANY I.D. (3 CHARACTER)                                    *
  3553*  BENEFIT CODE                                                  *
  3554*  BENEFIT OVERRIDE CODE                                         *
  3555*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3556*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3557*  JOINT INDICATOR (CSL ONLY)                                    *
  3558*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3559*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3560*                                                                *
  3561*  RETURNED FROM ELRATE                                          *
  3562*  --------------------                                          *
  3563*  CALCULATED PREMIUM                                            *
  3564*  PREMIUM RATE                                                  *
  3565*  MORTALITY CODE                                                *
  3566*  MAX ATTAINED AGE                                              *
  3567*  MAX AGE                                                       *
  3568*  MAX TERM                                                      *
  3569*  MAX MONTHLY BENEFIT                                           *
  3570*  MAX TOTAL BENIFIT                                             *
  3571*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3572*----------------------------------------------------------------*
  3573*  PASSED TO ELRFND                                              *
  3574*  ----------------                                              *
  3575*  CERT ISSUE DATE                                               *
  3576*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  68
* EL050.cbl
  3577*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3578*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3579*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3580*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3581*  STATE CODE (CLIENT DEFINED)                                   *
  3582*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3583*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3584*  DEVIATION CODE                                                *
  3585*  ISSUE AGE                                                     *
  3586*  ORIGINAL BENEFIT AMOUNT                                       *
  3587*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3588*  PROCESS TYPE (CANCEL)                                         *
  3589*  BENEFIT KIND (LIFE OR A/H)                                    *
  3590*  A.P.R.                                                        *
  3591*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3592*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3593*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3594*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3595*  COMPANY I.D. (3 CHARACTER)                                    *
  3596*  BENEFIT CODE                                                  *
  3597*  BENEFIT OVERRIDE CODE                                         *
  3598*                                                                *
  3599*  RETURNED FROM ELRFND                                          *
  3600*  --------------------                                          *
  3601*  CALCULATED REFUND                                             *
  3602*----------------------------------------------------------------*
  3603*  PASSED TO ELEARN                                              *
  3604*  ----------------                                              *
  3605*  CERT ISSUE DATE                                               *
  3606*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3607*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3608*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3609*  STATE CODE (CLIENT DEFINED)                                   *
  3610*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3611*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3612*  DEVIATION CODE                                                *
  3613*  ISSUE AGE                                                     *
  3614*  ORIGINAL BENEFIT AMOUNT                                       *
  3615*  BENEFIT KIND (LIFE OR A/H)                                    *
  3616*  A.P.R.                                                        *
  3617*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3618*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3619*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3620*  COMPANY I.D. (3 CHARACTER)                                    *
  3621*  BENEFIT CODE                                                  *
  3622*  BENEFIT OVERRIDE CODE                                         *
  3623*                                                                *
  3624*  RETURNED FROM ELEARN                                          *
  3625*  --------------------                                          *
  3626*  INDICATED  EARNINGS                                           *
  3627*----------------------------------------------------------------*
  3628*                 LENGTH = 450                                   *
  3629*                                                                *
  3630******************************************************************
  3631******************************************************************
  3632*                   C H A N G E   L O G
  3633*
  3634* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  69
* EL050.cbl
  3635*-----------------------------------------------------------------
  3636*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3637* EFFECTIVE    NUMBER
  3638*-----------------------------------------------------------------
  3639* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3640* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3641* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3642* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3643* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3644* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3645* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3646* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3647* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3648* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3649* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3650******************************************************************
  3651
  3652 01  CALCULATION-PASS-AREA.
  3653     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3654                                     COMP.
  3655
  3656     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3657       88  NO-CP-ERROR                             VALUE ZERO.
  3658       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3659                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3660       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3661       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3662       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3663       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3664       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3665       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3666       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3667       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3668       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3669       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3670       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3671       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3672       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3673       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3674       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3675       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3676       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3677
  3678     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3679       88  NO-CP-ERROR-2                           VALUE ZERO.
  3680***********************  INPUT AREAS ****************************
  3681
  3682     12  CP-CALCULATION-AREA.
  3683         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3684         16  CP-CERT-EFF-DT        PIC XX.
  3685         16  CP-VALUATION-DT       PIC XX.
  3686         16  CP-PAID-THRU-DT       PIC XX.
  3687         16  CP-BENEFIT-TYPE       PIC X.
  3688           88  CP-AH                               VALUE 'A' 'D'
  3689                                                   'I' 'U'.
  3690           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3691           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3692         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  70
* EL050.cbl
  3693         16  CP-REPORTED-DT        PIC XX.
  3694         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3695         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3696         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3697                                     COMP-3.
  3698         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3699                                     COMP-3.
  3700         16  CP-CDT-METHOD         PIC X.
  3701           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3702           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3703           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3704         16  CP-CLAIM-TYPE         PIC X.
  3705           88  CP-AH-CLAIM                         VALUE 'A'.
  3706           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3707         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3708                                     COMP-3.
  3709         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3710                                     COMP-3.
  3711         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3712                                     COMP-3.
  3713         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3714                                     COMP-3.
  3715         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3716                                     COMP-3.
  3717         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3718                                     COMP-3.
  3719         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3720                                     COMP-3.
  3721         16  CP-REM-TERM-METHOD    PIC X.
  3722           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3723           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3724           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3725           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3726           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3727           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3728           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3729         16  CP-EARNING-METHOD     PIC X.
  3730           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3731           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3732           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3733           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3734           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3735           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3736           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3737           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3738           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3739           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3740           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3741           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3742           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3743           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3744         16  CP-PROCESS-TYPE       PIC X.
  3745           88  CP-CLAIM                            VALUE '1'.
  3746           88  CP-CANCEL                           VALUE '2'.
  3747           88  CP-ISSUE                            VALUE '3'.
  3748         16  CP-SPECIAL-CALC-CD    PIC X.
  3749           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3750           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  71
* EL050.cbl
  3751           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3752           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3753           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3754           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3755           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3756           88  CP-FARM-PLAN                    VALUE 'F'.
  3757           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3758           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3759           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3760           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3761           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3762           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3763           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3764           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3765           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3766           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3767                                                     'W' 'X'.
  3768           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3769           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3770           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3771           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3772           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3773           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3774           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3775           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3776           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3777           88  CP-CSL-METH-1                   VALUE '5'.
  3778           88  CP-CSL-METH-2                   VALUE '6'.
  3779           88  CP-CSL-METH-3                   VALUE '7'.
  3780           88  CP-CSL-METH-4                   VALUE '8'.
  3781
  3782         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3783                                     COMP-3.
  3784         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3785         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3786         16  CP-STATE              PIC XX          VALUE SPACE.
  3787         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3788         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3789           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3790               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3791         16  CP-R78-OPTION         PIC X.
  3792           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3793           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3794
  3795         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3796         16  CP-IBNR-RESERVE-SW    PIC X.
  3797         16  CP-CLAIM-STATUS       PIC X.
  3798         16  CP-RATE-FILE          PIC X.
  3799         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3800                                     COMP-3.
  3801
  3802         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3803         16  CP-AH-OVERRIDE-CODE   PIC X.
  3804
  3805         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3806                                     COMP-3.
  3807         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3808                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  72
* EL050.cbl
  3809         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3810                                     COMP-3.
  3811         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3812                                     COMP-3.
  3813         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3814                                     COMP-3.
  3815         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3816                                  PIC S9(7)V99 COMP-3.
  3817
  3818         16  CP-PAID-FROM-DATE     PIC X(02).
  3819         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3820         16  CP-EXT-DAYS-CALC      PIC X.
  3821           88  CP-EXT-NO-CHG                   VALUE ' '.
  3822           88  CP-EXT-CHG-LF                   VALUE '1'.
  3823           88  CP-EXT-CHG-AH                   VALUE '2'.
  3824           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3825         16  CP-DOMICILE-STATE     PIC XX.
  3826         16  CP-CARRIER            PIC X.
  3827         16  CP-REIN-FLAG          PIC X.
  3828         16  CP-REM-TRM-CALC-OPTION PIC X.
  3829           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3830                      '2' '3' '4' '5'.
  3831           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3832           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3833           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3834           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3835           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3836           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3837           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3838           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3839         16  CP-SIG-SWITCH         PIC X.
  3840         16  CP-RATING-METHOD      PIC X.
  3841           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3842           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3843           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3844           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3845           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3846           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3847           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3848           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3849           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3850         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3851                                     COMP-3.
  3852         16  CP-BEN-CATEGORY       PIC X.
  3853         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3854         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3855                                   PIC S99V9(5) COMP-3.
  3856         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3857         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3858                                   PIC S99V9(5) COMP-3.
  3859         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3860         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3861         16  CP-EXPIRE-DT          PIC XX.
  3862         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3863         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3864         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3865         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3866         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  73
* EL050.cbl
  3867             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3868             88  CP-CALC-CLP              VALUE 'C'.
  3869         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3870         16  CP-CANCEL-REASON      PIC X.
  3871         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3872         16  CP-PMT-MODE           PIC X.
  3873         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3874         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3875         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3876         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3877         16  FILLER                PIC X.
  3878
  3879***************    OUTPUT FROM ELRESV   ************************
  3880
  3881         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3882
  3883         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3884                                     COMP-3.
  3885         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3886                                     COMP-3.
  3887         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3888                                     COMP-3.
  3889         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3890                                     COMP-3.
  3891         16  FILLER                PIC X(09).
  3892***************    OUTPUT FROM ELRTRM   *************************
  3893
  3894         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3895                                     COMP-3.
  3896         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3897                                     COMP-3.
  3898         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3899                                     COMP-3.
  3900         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3901                                     COMP-3.
  3902         16  FILLER                PIC X(12).
  3903
  3904***************    OUTPUT FROM ELRAMT   *************************
  3905
  3906         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3907                                     COMP-3.
  3908         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3909                                     COMP-3.
  3910         16  FILLER                PIC X(12).
  3911
  3912***************    OUTPUT FROM ELRATE   *************************
  3913
  3914         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3915                                     COMP-3.
  3916         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3917                                     COMP-3.
  3918         16  CP-MORTALITY-CODE     PIC X(4).
  3919         16  CP-RATE-EDIT-FLAG     PIC X.
  3920             88  CP-RATES-NEED-APR                  VALUE '1'.
  3921         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3922                                     COMP-3.
  3923         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3924         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  74
* EL050.cbl
  3925         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3926                                   PIC S9(7)V99 COMP-3.
  3927         16  FILLER                PIC X(07).
  3928
  3929***************    OUTPUT FROM ELRFND   *************************
  3930
  3931         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3932                                     COMP-3.
  3933         16  CP-REFUND-TYPE-USED   PIC X.
  3934           88  CP-R-AS-R78                         VALUE '1'.
  3935           88  CP-R-AS-PRORATA                     VALUE '2'.
  3936           88  CP-R-AS-CALIF                       VALUE '3'.
  3937           88  CP-R-AS-TEXAS                       VALUE '4'.
  3938           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3939           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3940           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3941           88  CP-R-AS-MEAN                        VALUE '8'.
  3942           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3943           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3944           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3945           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3946           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3947           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3948         16  FILLER                PIC X(12).
  3949
  3950***************    OUTPUT FROM ELEARN   *************************
  3951
  3952         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3953                                     COMP-3.
  3954         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3955                                     COMP-3.
  3956         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3957                                     COMP-3.
  3958         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3959                                     COMP-3.
  3960         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3961                                     COMP-3.
  3962         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3963                                     COMP-3.
  3964         16  CP-EARNING-TYPE-USED  PIC X.
  3965           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3966           88  CP-E-AS-R78                         VALUE '1'.
  3967           88  CP-E-AS-PRORATA                     VALUE '2'.
  3968           88  CP-E-AS-TEXAS                       VALUE '4'.
  3969           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3970           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3971           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3972           88  CP-E-AS-MEAN                        VALUE '8'.
  3973           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3974         16  FILLER                PIC X(12).
  3975
  3976***************    OUTPUT FROM ELPMNT   *************************
  3977
  3978         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3979                                     COMP-3.
  3980         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3981                                     COMP-3.
  3982         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  75
* EL050.cbl
  3983
  3984***************   MISC WORK AREAS    *****************************
  3985         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3986                                     COMP-3.
  3987         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3988                                     COMP-3.
  3989         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3990                                     COMP-3.
  3991         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3992                                     COMP-3.
  3993         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3994                                     COMP-3.
  3995         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3996                                     COMP-3.
  3997         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3998             88  OPEN-RATE-FILE                   VALUE 'O'.
  3999             88  CLOSE-RATE-FILE                  VALUE 'C'.
  4000             88  IO-ERROR                         VALUE 'E'.
  4001
  4002         16  CP-FIRST-PAY-DATE     PIC XX.
  4003
  4004         16  CP-JOINT-INDICATOR    PIC X.
  4005
  4006         16  CP-RESERVE-REMAINING-TERM
  4007                                   PIC S9(4)V9    VALUE ZERO
  4008                                     COMP-3.
  4009
  4010         16  CP-INSURED-BIRTH-DT   PIC XX.
  4011
  4012         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  4013                                     COMP-3.
  4014
  4015         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  4016                                     COMP-3.
  4017
  4018         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  4019                                     COMP-3.
  4020
  4021         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  4022                                     COMP-3.
  4023
  4024         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  4025                                     COMP-3.
  4026
  4027         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  4028                                     COMP-3.
  4029
  4030         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  4031                                     COMP-3.
  4032
  4033         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  4034             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  4035
  4036         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  4037                                     COMP-3.
  4038         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  4039                                     COMP-3.
  4040         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  76
* EL050.cbl
  4041         16  cp-extra-periods      pic 9 value zeros.
  4042         16  cp-net-only-state     pic x value spaces.
  4043         16  FILLER                PIC X(13).
  4044******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  77
* EL050.cbl
  4046******************************************************************
  4047*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  4048*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  4049*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  4050*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  4051*** MODIFICATION.                                              ***
  4052*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  4053*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  4054******************************************************************
  4055*    COPY ERCPNDB.
  4056******************************************************************
  4057*                                                                *
  4058*                                                                *
  4059*                            ERCPNDB.                            *
  4060*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4061*                            VMOD=2.025                          *
  4062*                                                                *
  4063*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4064*                                                                *
  4065******************************************************************
  4066*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4067*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4068******************************************************************
  4069*                                                                *
  4070*                                                                *
  4071*   FILE TYPE = VSAM,KSDS                                        *
  4072*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4073*                                                                *
  4074*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4075*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4076*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4077*                                                 RKP=13,LEN=36  *
  4078*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4079*                                      AND CHG-SEQ.)             *
  4080*                                                RKP=49,LEN=11   *
  4081*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4082*                                      AND CHG-SEQ.)             *
  4083*                                                RKP=60,LEN=15   *
  4084*                                                                *
  4085*   LOG = NO                                                     *
  4086*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4087******************************************************************
  4088******************************************************************
  4089*                   C H A N G E   L O G
  4090*
  4091* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4092*-----------------------------------------------------------------
  4093*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4094* EFFECTIVE    NUMBER
  4095*-----------------------------------------------------------------
  4096* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4097* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4098* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4099* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4100* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4101* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4102* 032306                   PEMA  ADD BOW LOAN NUMBER
  4103* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  78
* EL050.cbl
  4104* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4105* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4106* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4107* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4108* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4109* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4110* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4111* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4112* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4113* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4114* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4115******************************************************************
  4116
  4117 01  PENDING-BUSINESS.
  4118     12  PB-RECORD-ID                     PIC XX.
  4119         88  VALID-PB-ID                        VALUE 'PB'.
  4120
  4121     12  PB-CONTROL-PRIMARY.
  4122         16  PB-COMPANY-CD                PIC X.
  4123         16  PB-ENTRY-BATCH               PIC X(6).
  4124         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4125         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4126
  4127     12  PB-CONTROL-BY-ACCOUNT.
  4128         16  PB-COMPANY-CD-A1             PIC X.
  4129         16  PB-CARRIER                   PIC X.
  4130         16  PB-GROUPING.
  4131             20  PB-GROUPING-PREFIX       PIC XXX.
  4132             20  PB-GROUPING-PRIME        PIC XXX.
  4133         16  PB-STATE                     PIC XX.
  4134         16  PB-ACCOUNT.
  4135             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4136             20  PB-ACCOUNT-PRIME         PIC X(6).
  4137         16  PB-CERT-EFF-DT               PIC XX.
  4138         16  PB-CERT-NO.
  4139             20  PB-CERT-PRIME            PIC X(10).
  4140             20  PB-CERT-SFX              PIC X.
  4141         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4142
  4143         16  PB-RECORD-TYPE               PIC X.
  4144             88  PB-MAILING-DATA                VALUE '0'.
  4145             88  PB-ISSUE                       VALUE '1'.
  4146             88  PB-CANCELLATION                VALUE '2'.
  4147             88  PB-BATCH-TRAILER               VALUE '9'.
  4148
  4149     12  PB-CONTROL-BY-ORIG-BATCH.
  4150         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4151         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4152         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4153         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4154
  4155     12  PB-CONTROL-BY-CSR.
  4156         16  PB-CSR-COMPANY-CD            PIC X.
  4157         16  PB-CSR-ID                    PIC X(4).
  4158         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4159         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4160         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4161******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  79
* EL050.cbl
  4162*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4163******************************************************************
  4164
  4165     12  PB-LAST-MAINT-DT                 PIC XX.
  4166     12  PB-LAST-MAINT-BY                 PIC X(4).
  4167     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4168
  4169     12  PB-RECORD-BODY                   PIC X(375).
  4170
  4171     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4172         16  PB-CERT-ORIGIN               PIC X.
  4173             88  CLASIC-CREATED-CERT         VALUE '1'.
  4174         16  PB-I-NAME.
  4175             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4176             20  PB-I-INSURED-FIRST-NAME.
  4177                 24  PB-I-INSURED-1ST-INIT PIC X.
  4178                 24  FILLER                PIC X(9).
  4179             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4180         16  PB-I-AGE                     PIC S99   COMP-3.
  4181         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4182         16  PB-I-BIRTHDAY                PIC XX.
  4183         16  PB-I-INSURED-SEX             PIC X.
  4184             88  PB-SEX-MALE     VALUE 'M'.
  4185             88  PB-SEX-FEMALE   VALUE 'F'.
  4186
  4187         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4188         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4189         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4190         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4191         16  PB-I-SKIP-CODE               PIC X.
  4192             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4193             88  PB-SKIP-JULY              VALUE '1'.
  4194             88  PB-SKIP-AUGUST            VALUE '2'.
  4195             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4196             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4197             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4198             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4199             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4200             88  PB-SKIP-JUNE              VALUE '8'.
  4201             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4202             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4203             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4204         16  PB-I-TERM-TYPE               PIC X.
  4205             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4206             88  PB-PAID-WEEKLY            VALUE 'W'.
  4207             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4208             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4209             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4210         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4211         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4212         16  PB-I-DATA-ENTRY-SW           PIC X.
  4213             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4214             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4215             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4216             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4217         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4218         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4219*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  80
* EL050.cbl
  4220         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4221         16  FILLER                       PIC X.
  4222
  4223         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4224             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4225             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4226                                                   '90' THRU '99'.
  4227         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4228                                          PIC XX.
  4229         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4230         16  PB-I-AMOUNT-FINANCED REDEFINES
  4231                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4232         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4233         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4234                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4235         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4236         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4237         16  PB-I-CLP-AMOUNT REDEFINES
  4238                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4239         16  PB-I-LF-CALC-FLAG            PIC X.
  4240             88 PB-COMP-LF-PREM               VALUE '?'.
  4241         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4242         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4243         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4244         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4245         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4246         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4247         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4248         16  PB-I-LF-ABBR                 PIC XXX.
  4249         16  PB-I-LF-INPUT-CD             PIC XX.
  4250
  4251         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4252             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4253             88  PB-INVALID-AH               VALUE '  ' '00'
  4254                                                   '90' THRU '99'.
  4255         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4256         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4257         16  PB-I-AH-CALC-FLAG            PIC X.
  4258             88 PB-COMP-AH-PREM                  VALUE '?'.
  4259         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4260         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4261         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4262         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4263         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4264         16  PB-I-AH-ABBR                 PIC XXX.
  4265         16  PB-I-AH-INPUT-CD             PIC XXX.
  4266
  4267         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4268         16  PB-I-REIN-TABLE              PIC XXX.
  4269         16  PB-I-BUSINESS-TYPE           PIC 99.
  4270         16  PB-I-INDV-GRP-CD             PIC X.
  4271         16  PB-I-MORT-CODE.
  4272             20  PB-I-TABLE               PIC X.
  4273             20  PB-I-INTEREST            PIC XX.
  4274             20  PB-I-MORT-TYP            PIC X.
  4275         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4276         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4277         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  81
* EL050.cbl
  4278         16  PB-I-INDV-GRP-OVRD           PIC X.
  4279         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4280         16  PB-I-SIG-SW                  PIC X.
  4281             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4282         16  PB-I-RATE-CLASS              PIC XX.
  4283         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4284         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4285         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4286         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4287         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4288         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4289         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4290         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4291         16  PB-I-OB-FLAG                 PIC X.
  4292             88  PB-I-OB                      VALUE 'B'.
  4293             88  PB-I-SUMMARY                 VALUE 'Z'.
  4294         16  PB-I-ENTRY-STATUS            PIC X.
  4295             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4296                                              'M' '5' '9' '2'.
  4297             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4298             88  PB-I-POLICY-PENDING          VALUE '2'.
  4299             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4300             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4301             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4302             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4303             88  PB-I-REIN-ONLY               VALUE '9'.
  4304             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4305             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4306             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4307             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4308         16  PB-I-INT-CODE                PIC X.
  4309             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4310             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4311         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4312         16  PB-I-SOC-SEC-NO              PIC X(11).
  4313         16  PB-I-MEMBER-NO               PIC X(12).
  4314         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4315*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4316         16  PB-I-OLD-LOF                 PIC XXX.
  4317         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4318         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4319         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4320         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4321         16  PB-I-LIFE-INDICATOR          PIC X.
  4322             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4323         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4324         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4325                                          PIC S9(5)V99    COMP-3.
  4326         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4327             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4328             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4329         16  PB-I-1ST-PMT-DT              PIC XX.
  4330         16  PB-I-JOINT-INSURED.
  4331             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4332             20 PB-I-JOINT-FIRST-NAME.
  4333                24  PB-I-JOINT-FIRST-INIT PIC X.
  4334                24  FILLER                PIC X(9).
  4335             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  82
* EL050.cbl
  4336*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4337         16  PB-I-BENEFICIARY-NAME.
  4338             20  PB-I-BANK-NUMBER         PIC X(10).
  4339             20  FILLER                   PIC X(15).
  4340         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4341         16  PB-I-REFERENCE               PIC X(12).
  4342         16  FILLER REDEFINES PB-I-REFERENCE.
  4343             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4344             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4345             20  PB-I-CLP-STATE           PIC XX.
  4346         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4347             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4348             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4349             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4350         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4351         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4352         16  PB-I-RESIDENT-STATE          PIC XX.
  4353         16  PB-I-RATE-CODE               PIC X(4).
  4354         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4355         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4356         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4357         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4358         16  PB-I-BANK-NOCHRGB            PIC 99.
  4359         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4360         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4361
  4362     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4363         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4364             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4365         16  PB-C-CANCEL-ORIGIN           PIC X.
  4366             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4367         16  PB-C-LF-CANCEL-DT            PIC XX.
  4368         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4369         16  PB-C-LF-CALC-REQ             PIC X.
  4370             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4371         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4372         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4373         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4374             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4375         16  PB-C-AH-CANCEL-DT            PIC XX.
  4376         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4377         16  PB-C-AH-CALC-REQ             PIC X.
  4378             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4379         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4380         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4381         16  PB-C-LAST-NAME               PIC X(15).
  4382         16  PB-C-REFUND-SW               PIC X.
  4383             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4384             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4385         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4386         16  PB-C-PAYEE-CODE              PIC X(6).
  4387         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4388         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4389         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4390         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4391         16  PB-C-REFERENCE               PIC X(12).
  4392         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4393         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  83
* EL050.cbl
  4394         16  PB-C-POST-CARD-IND           PIC X.
  4395         16  PB-C-CANCEL-REASON           PIC X.
  4396         16  PB-C-REF-INTERFACE-SW        PIC X.
  4397         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4398         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4399         16  FILLER                       PIC X(01).
  4400*        16  FILLER                       PIC X(18).
  4401         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4402*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4403         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  4404         16  PB-CANCELED-CERT-DATA.
  4405             20  PB-CI-INSURED-NAME.
  4406                 24  PB-CI-LAST-NAME      PIC X(15).
  4407                 24  PB-CI-INITIALS       PIC XX.
  4408             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4409             20  PB-CI-INSURED-SEX        PIC X.
  4410             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4411             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4412             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4413             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4414             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4415             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4416             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4417             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4418             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4419             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4420             20  PB-CI-RATE-CLASS         PIC XX.
  4421             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4422             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4423             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4424             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4425             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4426             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4427             20  PB-CI-LF-ABBR            PIC X(3).
  4428             20  PB-CI-AH-ABBR            PIC X(3).
  4429             20  PB-CI-OB-FLAG            PIC X.
  4430                 88  PB-CI-OB                VALUE 'B'.
  4431             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4432                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4433                                           'M' '4' '5' '9' '2'.
  4434                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4435                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4436                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4437                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4438                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4439                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4440                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4441                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4442                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4443                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4444                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4445                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4446                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4447             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4448                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4449                                           'M' '4' '5' '9' '2'.
  4450                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4451                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  84
* EL050.cbl
  4452                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4453                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4454                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4455                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4456                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4457                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4458                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4459                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4460                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4461                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4462                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4463             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4464             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4465             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4466             20  PB-CI-MEMBER-NO          PIC X(12).
  4467             20  PB-CI-INT-CODE           PIC X.
  4468                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4469                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4470             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4471             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4472             20  PB-CI-COMP-EXCP-SW       PIC X.
  4473                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4474                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4475             20  PB-CI-ENTRY-STATUS       PIC X.
  4476             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4477             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4478             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4479             20  PB-CI-DEATH-DT           PIC XX.
  4480             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4481             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4482             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4483             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4484             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4485             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4486             20  PB-CI-ENTRY-DT              PIC XX.
  4487             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4488             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4489             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4490             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4491             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4492             20  PB-CI-OLD-LOF               PIC XXX.
  4493*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4494             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4495             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4496             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4497             20  PB-CI-INDV-GRP-CD           PIC X.
  4498             20  PB-CI-BENEFICIARY-NAME.
  4499                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4500                 24  FILLER                  PIC X(15).
  4501             20  PB-CI-NOTE-SW               PIC X.
  4502             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4503             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4504             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4505             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4506             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4507             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4508             20  PB-CI-FIRST-NAME            PIC X(10).
  4509             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  85
* EL050.cbl
  4510
  4511         16  FILLER                       PIC X(13).
  4512*032306  16  FILLER                       PIC X(27).
  4513*        16  FILLER                       PIC X(46).
  4514
  4515     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4516         16  FILLER                       PIC X(10).
  4517         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4518         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4519         16  PB-M-INSURED-MID-INIT        PIC X.
  4520         16  PB-M-INSURED-AGE             PIC 99.
  4521         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4522         16  PB-M-INSURED-SEX             PIC X.
  4523         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4524         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4525         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4526         16  PB-M-INSURED-CITY-STATE.
  4527             20  PB-M-INSURED-CITY        PIC X(28).
  4528             20  PB-M-INSURED-STATE       PIC XX.
  4529         16  PB-M-INSURED-ZIP-CODE.
  4530             20  PB-M-INSURED-ZIP-PRIME.
  4531                 24  PB-M-INSURED-ZIP-1   PIC X.
  4532                     88  PB-M-CANADIAN-POST-CODE
  4533                                             VALUE 'A' THRU 'Z'.
  4534                 24  FILLER               PIC X(4).
  4535             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4536         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4537                                        PB-M-INSURED-ZIP-CODE.
  4538             20  PM-M-INS-CAN-POST1       PIC XXX.
  4539             20  PM-M-INS-CAN-POST2       PIC XXX.
  4540             20  FILLER                   PIC XXX.
  4541         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4542         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4543         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4544         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4545         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4546         16  PB-M-CRED-BENE-CITYST.
  4547             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4548             20  PB-M-CRED-BENE-STATE     PIC XX.
  4549         16  FILLER                       PIC X(92).
  4550
  4551     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4552         16  FILLER                       PIC X(10).
  4553         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4554         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4555         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4556         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4557         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4558         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4559         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4560         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4561         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4562         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4563         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4564         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4565         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4566         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4567         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  86
* EL050.cbl
  4568         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4569         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4570         16  PB-ACCOUNT-NAME              PIC X(30).
  4571         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4572         16  PB-REFERENCE                 PIC X(12).
  4573         16  PB-B-RECEIVED-DT             PIC XX.
  4574         16  FILLER                       PIC X(234).
  4575
  4576     12  PB-RECORD-STATUS.
  4577         16  PB-CREDIT-SELECT-DT          PIC XX.
  4578         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4579         16  PB-BILLED-DT                 PIC XX.
  4580         16  PB-BILLING-STATUS            PIC X.
  4581             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4582             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4583             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4584         16  PB-RECORD-BILL               PIC X.
  4585             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4586             88  PB-RECORD-RETURNED           VALUE 'R'.
  4587             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4588             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4589             88  PB-OVERRIDE-AH               VALUE 'A'.
  4590             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4591         16  PB-BATCH-ENTRY               PIC X.
  4592             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4593             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4594             88  PB-REISSUED-CERT             VALUE 'E'.
  4595             88  PB-CASH-CERT                 VALUE 'C'.
  4596             88  PB-MONTHLY-CERT              VALUE 'M'.
  4597             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4598             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4599             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4600         16  PB-FORCE-CODE                PIC X.
  4601             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4602             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4603             88  PB-CANCEL-FORCE              VALUE '8'.
  4604             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4605             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4606             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4607             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4608             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4609             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4610             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4611             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4612         16  PB-FATAL-FLAG                PIC X.
  4613             88  PB-FATAL-ERRORS              VALUE 'X'.
  4614         16  PB-FORCE-ER-CD               PIC X.
  4615             88  PB-FORCE-ERRORS              VALUE 'F'.
  4616             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4617         16  PB-WARN-ER-CD                PIC X.
  4618             88  PB-WARNING-ERRORS            VALUE 'W'.
  4619         16  FILLER                       PIC X.
  4620         16  PB-OUT-BAL-CD                PIC X.
  4621             88  PB-OUT-OF-BAL                VALUE 'O'.
  4622         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4623         16  PB-AH-OVERRIDE-L1            PIC X.
  4624         16  PB-INPUT-DT                  PIC XX.
  4625         16  PB-INPUT-BY                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  87
* EL050.cbl
  4626         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4627         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4628         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4629         16  PB-LF-EARNING-METHOD         PIC X.
  4630         16  PB-AH-EARNING-METHOD         PIC X.
  4631         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4632         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4633         16  PB-REIN-CD                   PIC XXX.
  4634         16  PB-LF-REFUND-TYPE            PIC X.
  4635         16  PB-AH-REFUND-TYPE            PIC X.
  4636         16  PB-ACCT-EFF-DT               PIC XX.
  4637         16  PB-ACCT-EXP-DT               PIC XX.
  4638         16  PB-COMPANY-ID                PIC X(3).
  4639         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4640         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4641         16  PB-SV-CARRIER                PIC X.
  4642         16  PB-SV-GROUPING               PIC X(6).
  4643         16  PB-SV-STATE                  PIC XX.
  4644         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4645         16  PB-GA-BILLING-INFO.
  4646             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4647                                          PIC XX.
  4648         16  PB-SV-REMIT-TO  REDEFINES
  4649             PB-GA-BILLING-INFO           PIC X(10).
  4650         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4651         16  PB-I-LOAN-OFFICER            PIC X(5).
  4652         16  PB-I-VIN                     PIC X(17).
  4653
  4654         16  FILLER                       PIC X(04).
  4655         16  IMNET-BYPASS-SW              PIC X.
  4656
  4657******************************************************************
  4658*                COMMON EDIT ERRORS                              *
  4659******************************************************************
  4660
  4661     12  PB-COMMON-ERRORS.
  4662         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4663                                           PIC S9(4)     COMP.
  4664
  4665******************************************************************
  4666
  4667* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4668*    COPY ELC50W1.
  4669******************************************************************
  4670*                                                                *
  4671*                                                                *
  4672*                             ELC50W1                            *
  4673*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4674*                            VMOD=2.004                          *
  4675*                                                                *
  4676*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4677*                                                                *
  4678*                                                                *
  4679******************************************************************
  4680
  4681     12  WK-WORK-AREA.
  4682         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4683         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  88
* EL050.cbl
  4684         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4685         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4686         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4687         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4688         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4689         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4690         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4691         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4692         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4693         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4694         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4695         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4696         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4697         16  WK-CREDIT-EDIT-CONTROLS.
  4698             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4699             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4700             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4701             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4702             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4703             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4704         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4705         16  WK-SAVE-REIN-DATA.
  4706             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4707             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4708             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4709         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4710             88  ENTRY-FROM-EL6311       VALUE '6'.
  4711         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4712         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4713     12  WK-RECORD-ADDRESSES.
  4714         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4715         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4716         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4717         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4718         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4719         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4720         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4721         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4722     12  WK-OVER-SHORT-AREA.
  4723         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4724         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4725         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4726             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4727         16  FILLER                   PIC X(5) VALUE SPACES.
  4728
  4729*    COPY ELCEDITC.
  4730******************************************************************
  4731*                                                                *
  4732*                                                                *
  4733*                            ELCEDITC                            *
  4734*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4735*                            VMOD=2.012                          *
  4736*                                                                *
  4737*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4738*                     EL6313, EL050 AND EL517.                   *
  4739*                                                                *
  4740******************************************************************
  4741******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  89
* EL050.cbl
  4742*                   C H A N G E   L O G
  4743*
  4744* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4745*-----------------------------------------------------------------
  4746*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4747* EFFECTIVE    NUMBER
  4748*-----------------------------------------------------------------
  4749* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4750******************************************************************
  4751
  4752     12  EDIT-CRITERIA-DATA.
  4753         16  EC-CO-MONTH-END-DT       PIC XX.
  4754         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4755         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4756         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4757         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4758         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4759         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4760         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4761         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4762         16  EC-CO-REM-TERM-CALC      PIC X.
  4763               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4764               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4765               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4766               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4767
  4768         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4769               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4770               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4771               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4772               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4773               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4774               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4775               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4776               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4777               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4778               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4779
  4780         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4781               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4782               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4783               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4784               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4785               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4786               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4787               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4788               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4789
  4790         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4791                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4792                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4793
  4794         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4795                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4796                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4797                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4798                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4799                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  90
* EL050.cbl
  4800                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4801                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4802                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4803
  4804         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4805               88  EC-BR-REDUCING                   VALUE 'R'.
  4806               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4807
  4808         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4809         16  EC-BR-LF-DESC             PIC X(10).
  4810         16  EC-BR-AH-DESC             PIC X(10).
  4811         16  EC-BR-LF-COMMENT          PIC X(10).
  4812         16  EC-BR-AH-COMMENT          PIC X(10).
  4813
  4814         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4815               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4816               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4817               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4818               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4819
  4820         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4821               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4822               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4823               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4824               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4825
  4826         16  EC-BR-LF-REFUND-CALC      PIC X.
  4827                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4828                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4829                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4830                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4831                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4832                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4833                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4834
  4835         16  EC-BR-AH-REFUND-CALC      PIC X.
  4836                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4837                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4838                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4839                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4840                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4841                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4842                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4843                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4844
  4845         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4846                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4847                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4848                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4849
  4850         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4851                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4852                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4853                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4854
  4855         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4856         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4857         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  91
* EL050.cbl
  4858         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4859
  4860         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4861         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4862                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4863                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4864                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4865                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4866
  4867         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4868               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4869               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4870               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4871               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4872               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4873
  4874         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4875               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4876               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4877               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4878               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4879               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4880
  4881         16  EC-ST-LF-REFUND-CALC      PIC X.
  4882                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4883                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4884                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4885                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4886                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4887                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4888                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4889                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4890
  4891         16  EC-ST-AH-REFUND-CALC      PIC X.
  4892                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4893                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4894                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4895                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4896                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4897                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4898                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4899                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4900
  4901         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4902         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4903         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4904         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4905         16  EC-AM-EXPIRATION-DT       PIC XX.
  4906         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4907         16  EC-AM-CLASS-CD            PIC XX.
  4908         16  EC-AM-LF-DEVIATION        PIC XXX.
  4909         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4910         16  EC-AM-AH-DEVIATION        PIC XXX.
  4911         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4912         16  EC-AM-PHONE-NO            PIC X(10).
  4913
  4914         16  EC-AM-LF-REFUND-CALC      PIC X.
  4915                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  92
* EL050.cbl
  4916                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4917                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4918                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4919                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4920                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4921                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4922
  4923         16  EC-AM-AH-REFUND-CALC      PIC X.
  4924                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4925                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4926                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4927                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4928                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4929                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4930                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4931
  4932         16  EC-AM-BEN-I-G-CD          PIC X.
  4933                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4934                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4935                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4936
  4937         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4938         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4939         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4940         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4941         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4942         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4943         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4944         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4945         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4946
  4947         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4948         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4949         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4950         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4951         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4952         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4953         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4954         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4955         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4956         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4957         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4958         16  EC-RT-LF-NSP-ST           PIC XX.
  4959         16  EC-RT-AH-NSP-ST           PIC XX.
  4960         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4961         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4962
  4963         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4964             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4965                                             'M' '5' '9' '2'.
  4966             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4967             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4968             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4969             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4970             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4971             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4972             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4973             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  93
* EL050.cbl
  4974             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4975             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4976
  4977         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4978             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4979                                             'M' '5' '9' '2'.
  4980             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4981             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4982             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4983             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4984             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4985             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4986             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4987             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4988             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4989             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4990
  4991         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4992         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4993         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4994         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4995         16  EC-CM-DEATH-DT            PIC XX.
  4996
  4997*DMD CUSTOM CODING FIELDS BELOW
  4998*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4999         16  EC-BR-DMD-RATING-SW       PIC X.
  5000                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  5001                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  5002                 88  NO-DMD-RATING               VALUE 'N'.
  5003
  5004         16  EC-NEW-CERT               PIC X(11).
  5005         16  EC-NEW-STATE              PIC XX.
  5006         16  FILLER                    PIC X.
  5007*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  5008         16  OVER-SHORT-EDIT-FIELDS.
  5009             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  5010             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  5011             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  5012             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  5013             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  5014             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  5015             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  5016             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  5017             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  5018         16  FILLER                    PIC X(71).
  5019******************************************************************
  5020
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  94
* EL050.cbl
  5022*    COPY ELCDIFRD.
  5023******************************************************************
  5024*                                                                *
  5025*                                                                *
  5026*                            ELCDIFRD.                           *
  5027*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5028*                            VMOD=2.004                          *
  5029*                                                                *
  5030*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  5031*                                                                *
  5032******************************************************************
  5033*
  5034  01  WS-DIFFERENCE-CALCULATION.
  5035        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  5036        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  5037        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  5038        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  5039        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  5040        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5041        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5042        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5043        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5044        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5045        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5046
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  95
* EL050.cbl
  5048****************************************************************
  5049*
  5050* Copyright (c) 2007-2013 Dell Inc.
  5051* All rights reserved.
  5052*
  5053****************************************************************
  5054 01  DFHEIV.
  5055   02  DFHEIV0               PIC X(35).
  5056   02  DFHEIV1               PIC X(08).
  5057   02  DFHEIV2               PIC X(08).
  5058   02  DFHEIV3               PIC X(08).
  5059   02  DFHEIV4               PIC X(06).
  5060   02  DFHEIV5               PIC X(04).
  5061   02  DFHEIV6               PIC X(04).
  5062   02  DFHEIV7               PIC X(02).
  5063   02  DFHEIV8               PIC X(02).
  5064   02  DFHEIV9               PIC X(01).
  5065   02  DFHEIV10              PIC S9(7) COMP-3.
  5066   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5067   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5068   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5069   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5070   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5071   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5072   02  DFHEIV17              PIC X(04).
  5073   02  DFHEIV18              PIC X(04).
  5074   02  DFHEIV19              PIC X(04).
  5075   02  DFHEIV20              USAGE IS POINTER.
  5076   02  DFHEIV21              USAGE IS POINTER.
  5077   02  DFHEIV22              USAGE IS POINTER.
  5078   02  DFHEIV23              USAGE IS POINTER.
  5079   02  DFHEIV24              USAGE IS POINTER.
  5080   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5081   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5082   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5083   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5084   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5085   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5086   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5087   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5088   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5089   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5090   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5091   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5092   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5093   02  FILLER                PIC X(02).
  5094   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5095   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5096   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5097   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5098   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5099   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5100   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5101 LINKAGE  SECTION.
  5102*****************************************************************
  5103*                                                               *
  5104* Copyright (c) 2007-2013 Dell Inc.                             *
  5105* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  96
* EL050.cbl
  5106*                                                               *
  5107*****************************************************************
  5108 01  dfheiblk.
  5109     02  eibtime          pic s9(7) comp-3.
  5110     02  eibdate          pic s9(7) comp-3.
  5111     02  eibtrnid         pic x(4).
  5112     02  eibtaskn         pic s9(7) comp-3.
  5113     02  eibtrmid         pic x(4).
  5114     02  dfheigdi         pic s9(4) comp.
  5115     02  eibcposn         pic s9(4) comp.
  5116     02  eibcalen         pic s9(4) comp.
  5117     02  eibaid           pic x(1).
  5118     02  eibfiller1       pic x(1).
  5119     02  eibfn            pic x(2).
  5120     02  eibfiller2       pic x(2).
  5121     02  eibrcode         pic x(6).
  5122     02  eibfiller3       pic x(2).
  5123     02  eibds            pic x(8).
  5124     02  eibreqid         pic x(8).
  5125     02  eibrsrce         pic x(8).
  5126     02  eibsync          pic x(1).
  5127     02  eibfree          pic x(1).
  5128     02  eibrecv          pic x(1).
  5129     02  eibsend          pic x(1).
  5130     02  eibatt           pic x(1).
  5131     02  eibeoc           pic x(1).
  5132     02  eibfmh           pic x(1).
  5133     02  eibcompl         pic x(1).
  5134     02  eibsig           pic x(1).
  5135     02  eibconf          pic x(1).
  5136     02  eiberr           pic x(1).
  5137     02  eibrldbk         pic x(1).
  5138     02  eiberrcd         pic x(4).
  5139     02  eibsynrb         pic x(1).
  5140     02  eibnodat         pic x(1).
  5141     02  eibfiller5       pic x(2).
  5142     02  eibresp          pic s9(8) comp.
  5143     02  eibresp2         pic s9(8) comp.
  5144     02  dfheigdj         pic s9(4) comp.
  5145     02  dfheigdk         pic s9(4) comp.
  5146
  5147 01  DFHCOMMAREA                   PIC X(1036).
  5148
  5149*01 PARMLIST .
  5150*    02  FILLER                    PIC S9(8)   COMP.
  5151*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5152*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5153*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5154*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5155*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5156*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5157*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5158
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  97
* EL050.cbl
  5160*    COPY ELCCNTL.
  5161******************************************************************
  5162*                                                                *
  5163*                                                                *
  5164*                            ELCCNTL.                            *
  5165*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5166*                            VMOD=2.059                          *
  5167*                                                                *
  5168*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5169*                                                                *
  5170*   FILE TYPE = VSAM,KSDS                                        *
  5171*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5172*                                                                *
  5173*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5174*       ALTERNATE INDEX = NONE                                   *
  5175*                                                                *
  5176*   LOG = YES                                                    *
  5177*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5178******************************************************************
  5179*                   C H A N G E   L O G
  5180*
  5181* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5182*-----------------------------------------------------------------
  5183*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5184* EFFECTIVE    NUMBER
  5185*-----------------------------------------------------------------
  5186* 082503                   PEMA  ADD BENEFIT GROUP
  5187* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5188* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5189* 092705    2005050300006  PEMA  ADD SPP LEASES
  5190* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5191* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5192* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5193* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5194* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5195* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5196* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5197* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5198* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5199* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5200* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  5201******************************************************************
  5202*
  5203 01  CONTROL-FILE.
  5204     12  CF-RECORD-ID                       PIC XX.
  5205         88  VALID-CF-ID                        VALUE 'CF'.
  5206
  5207     12  CF-CONTROL-PRIMARY.
  5208         16  CF-COMPANY-ID                  PIC XXX.
  5209         16  CF-RECORD-TYPE                 PIC X.
  5210             88  CF-COMPANY-MASTER              VALUE '1'.
  5211             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5212             88  CF-STATE-MASTER                VALUE '3'.
  5213             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5214             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5215             88  CF-CARRIER-MASTER              VALUE '6'.
  5216             88  CF-MORTALITY-MASTER            VALUE '7'.
  5217             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  98
* EL050.cbl
  5218             88  CF-TERMINAL-MASTER             VALUE '9'.
  5219             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5220             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5221             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5222             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5223             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5224             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5225             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5226             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5227             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5228         16  CF-ACCESS-CD-GENL              PIC X(4).
  5229         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5230             20  CF-PROCESSOR               PIC X(4).
  5231         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5232             20  CF-STATE-CODE              PIC XX.
  5233             20  FILLER                     PIC XX.
  5234         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5235             20  FILLER                     PIC XX.
  5236             20  CF-HI-BEN-IN-REC           PIC XX.
  5237         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5238             20  FILLER                     PIC XXX.
  5239             20  CF-CARRIER-CNTL            PIC X.
  5240         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5241             20  FILLER                     PIC XX.
  5242             20  CF-HI-TYPE-IN-REC          PIC 99.
  5243         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5244             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5245                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5246             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5247             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5248         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5249             20  FILLER                     PIC X.
  5250             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5251         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5252             20  FILLER                     PIC XX.
  5253             20  CF-MORTGAGE-PLAN           PIC XX.
  5254         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5255
  5256     12  CF-LAST-MAINT-DT                   PIC XX.
  5257     12  CF-LAST-MAINT-BY                   PIC X(4).
  5258     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5259
  5260     12  CF-RECORD-BODY                     PIC X(728).
  5261
  5262
  5263****************************************************************
  5264*             COMPANY MASTER RECORD                            *
  5265****************************************************************
  5266
  5267     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5268         16  CF-COMPANY-ADDRESS.
  5269             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5270             20  CF-CL-IN-CARE-OF           PIC X(30).
  5271             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5272             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5273             20  CF-CL-CITY-STATE           PIC X(30).
  5274             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5275             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page  99
* EL050.cbl
  5276         16  CF-COMPANY-CD                  PIC X.
  5277         16  CF-COMPANY-PASSWORD            PIC X(8).
  5278         16  CF-SECURITY-OPTION             PIC X.
  5279             88  ALL-SECURITY                   VALUE '1'.
  5280             88  COMPANY-VERIFY                 VALUE '2'.
  5281             88  PROCESSOR-VERIFY               VALUE '3'.
  5282             88  NO-SECURITY                    VALUE '4'.
  5283             88  ALL-BUT-TERM                   VALUE '5'.
  5284         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5285             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5286         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5287             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5288         16  CF-INFORCE-LOCATION            PIC X.
  5289             88  CERTS-ARE-ONLINE               VALUE '1'.
  5290             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5291             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5292         16  CF-LOWER-CASE-LETTERS          PIC X.
  5293         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5294             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5295             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5296             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5297             88  CF-ACCNT-CNTL                  VALUE '3'.
  5298             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5299
  5300         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5301         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5302
  5303         16  CF-LGX-CREDIT-USER             PIC X.
  5304             88  CO-IS-NOT-USER                 VALUE 'N'.
  5305             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5306
  5307         16 CF-CREDIT-CALC-CODES.
  5308             20  CF-CR-REM-TERM-CALC PIC X.
  5309               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5310               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5311               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5312               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5313               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5314               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5315               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5316             20  CF-CR-R78-METHOD           PIC X.
  5317               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5318               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5319
  5320         16  CF-CLAIM-CONTROL-COUNTS.
  5321             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5322                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5323
  5324             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5325                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5326
  5327             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5328                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5329
  5330             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5331                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5332
  5333         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 100
* EL050.cbl
  5334
  5335         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5336             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5337             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5338             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5339             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5340                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5341                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5342             20  CF-CO-PREM-REJECT-SW       PIC X.
  5343                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5344                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5345             20  CF-CO-REF-REJECT-SW        PIC X.
  5346                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5347                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5348
  5349         16  CF-CO-REPORTING-DT             PIC XX.
  5350         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5351         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5352           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5353           88  CF-CO-MONTH-END                  VALUE '1'.
  5354
  5355         16  CF-LGX-CLAIM-USER              PIC X.
  5356             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5357             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5358
  5359         16  CF-CREDIT-EDIT-CONTROLS.
  5360             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5361             20  CF-MIN-AGE                 PIC 99.
  5362             20  CF-DEFAULT-AGE             PIC 99.
  5363             20  CF-MIN-TERM                PIC S999      COMP-3.
  5364             20  CF-MAX-TERM                PIC S999      COMP-3.
  5365             20  CF-DEFAULT-SEX             PIC X.
  5366             20  CF-JOINT-AGE-INPUT         PIC X.
  5367                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5368             20  CF-BIRTH-DATE-INPUT        PIC X.
  5369                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5370             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5371                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5372                 88  CF-ZERO-CARRIER            VALUE '1'.
  5373                 88  CF-ZERO-GROUPING           VALUE '2'.
  5374                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5375             20  CF-EDIT-SW                 PIC X.
  5376                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5377             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5378             20  CF-CR-PR-METHOD            PIC X.
  5379               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5380               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5381             20  FILLER                     PIC X.
  5382
  5383         16  CF-CREDIT-MISC-CONTROLS.
  5384             20  CF-REIN-TABLE-SW           PIC X.
  5385                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5386             20  CF-COMP-TABLE-SW           PIC X.
  5387                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5388             20  CF-EXPERIENCE-RETENTION-AGE
  5389                                            PIC S9        COMP-3.
  5390             20  CF-CONVERSION-DT           PIC XX.
  5391             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 101
* EL050.cbl
  5392             20  CF-RUN-FREQUENCY-SW        PIC X.
  5393                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5394                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5395
  5396             20  CF-CR-CHECK-NO-CONTROL.
  5397                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5398                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5399                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5400                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5401                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5402                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5403
  5404                 24  CF-CR-CHECK-COUNT       REDEFINES
  5405                     CF-CR-CHECK-COUNTER      PIC X(4).
  5406
  5407                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5408                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5409
  5410                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5411                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5412                 24  CF-MAIL-PROCESSING       PIC X.
  5413                     88  MAIL-PROCESSING          VALUE 'Y'.
  5414
  5415         16  CF-MISC-SYSTEM-CONTROL.
  5416             20  CF-SYSTEM-C                 PIC X.
  5417                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5418             20  CF-SYSTEM-D                 PIC X.
  5419                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5420             20  CF-SOC-SEC-NO-SW            PIC X.
  5421                 88  SOC-SEC-NO-USED             VALUE '1'.
  5422             20  CF-MEMBER-NO-SW             PIC X.
  5423                 88  MEMBER-NO-USED              VALUE '1'.
  5424             20  CF-TAX-ID-NUMBER            PIC X(11).
  5425             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5426             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5427                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5428                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5429                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5430                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5431             20  CF-SYSTEM-E                 PIC X.
  5432                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5433
  5434         16  CF-LGX-LIFE-USER               PIC X.
  5435             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5436             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5437
  5438         16  CF-CR-MONTH-END-DT             PIC XX.
  5439
  5440         16  CF-FILE-MAINT-DATES.
  5441             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5442                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5443             20  CF-LAST-BATCH       REDEFINES
  5444                 CF-LAST-BATCH-NO               PIC X(4).
  5445             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5446             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5447             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5448             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5449             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 102
* EL050.cbl
  5450             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5451             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5452             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5453             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5454             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5455
  5456         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5457         16  FILLER                         PIC X.
  5458
  5459         16  CF-ALT-MORT-CODE               PIC X(4).
  5460         16  CF-MEMBER-CAPTION              PIC X(10).
  5461
  5462         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5463             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5464             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5465             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5466             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5467             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5468
  5469         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5470
  5471         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5472         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5473         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5474         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5475
  5476         16  CF-AH-OVERRIDE-L1              PIC X.
  5477         16  CF-AH-OVERRIDE-L2              PIC XX.
  5478         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5479         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5480
  5481         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5482         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5483
  5484         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5485         16  CF-AR-LAST-EL860-DT            PIC XX.
  5486         16  CF-MP-MONTH-END-DT             PIC XX.
  5487
  5488         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5489         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5490             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5491
  5492         16  CF-AR-MONTH-END-DT             PIC XX.
  5493
  5494         16  CF-CRDTCRD-USER                PIC X.
  5495             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5496             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5497
  5498         16  CF-CC-MONTH-END-DT             PIC XX.
  5499
  5500         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5501
  5502         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5503             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5504             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5505             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5506         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5507         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 103
* EL050.cbl
  5508         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5509         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5510             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5511             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5512         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5513         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5514         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5515             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5516         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5517
  5518         16  CF-CL-ZIP-CODE.
  5519             20  CF-CL-ZIP-PRIME.
  5520                 24  CF-CL-ZIP-1ST          PIC X.
  5521                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5522                 24  FILLER                 PIC X(4).
  5523             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5524         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5525             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5526             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5527             20  FILLER                     PIC XXX.
  5528
  5529         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5530         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5531         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5532         16  CF-CO-OPTION-START-DATE        PIC XX.
  5533         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5534           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5535                                                      '3' '4'.
  5536           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5537           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5538           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5539           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5540           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5541           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5542
  5543         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5544
  5545         16  CF-PAYMENT-APPROVAL-LEVELS.
  5546             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5547             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5548             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5549             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5550             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5551             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5552
  5553         16  CF-END-USER-REPORTING-USER     PIC X.
  5554             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5555             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5556
  5557         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5558             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5559             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5560
  5561         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5562
  5563         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5564         16  FILLER                         PIC X.
  5565
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 104
* EL050.cbl
  5566         16  CF-CREDIT-ARCHIVE-CNTL.
  5567             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5568             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5569             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5570
  5571         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5572
  5573         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5574             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5575             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5576
  5577         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5578             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5579             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5580
  5581         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5582
  5583         16  CF-CO-ACH-ID-CODE              PIC  X.
  5584             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5585             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5586             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5587         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5588         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5589         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5590         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5591         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5592         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5593         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5594         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5595         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5596                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5597         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5598                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5599
  5600         16  CF-CO-OVER-SHORT.
  5601             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5602             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5603
  5604*         16  FILLER                         PIC X(102).
  5605         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5606             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5607             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5608
  5609         16  CF-AH-APPROVAL-DAYS.
  5610             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5611             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5612             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5613             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5614
  5615         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5616
  5617         16  CF-APPROV-LEV-5.
  5618             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5619             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5620             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5621
  5622         16  FILLER                         PIC X(68).
  5623****************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 105
* EL050.cbl
  5624*             PROCESSOR/USER RECORD                            *
  5625****************************************************************
  5626
  5627     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5628         16  CF-PROCESSOR-NAME              PIC X(30).
  5629         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5630         16  CF-PROCESSOR-TITLE             PIC X(26).
  5631         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5632                 88  MESSAGE-YES                VALUE 'Y'.
  5633                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5634
  5635*****************************************************
  5636****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5637****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5638****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5639****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5640*****************************************************
  5641
  5642         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5643             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5644             20  CF-APPLICATION-FORCE       PIC X.
  5645             20  CF-INDIVIDUAL-APP.
  5646                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5647                     28  CF-BROWSE-APP      PIC X.
  5648                     28  CF-UPDATE-APP      PIC X.
  5649
  5650         16  CF-CURRENT-TERM-ON             PIC X(4).
  5651         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5652             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5653             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5654             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5655             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5656             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5657             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5658             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5659         16  CF-PROCESSOR-CARRIER           PIC X.
  5660             88  NO-CARRIER-SECURITY            VALUE ' '.
  5661         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5662             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5663         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5664             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5665         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5666             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5667
  5668         16  CF-PROC-SYS-ACCESS-SW.
  5669             20  CF-PROC-CREDIT-CLAIMS-SW.
  5670                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5671                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5672                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5673                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5674             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5675                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5676                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5677             20  CF-PROC-LIFE-GNRLDGR-SW.
  5678                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5679                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5680                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5681                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 106
* EL050.cbl
  5682             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5683                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5684                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5685         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5686             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5687             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5688         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5689
  5690         16  CF-APPROVAL-LEVEL                  PIC X.
  5691             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5692             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5693             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5694             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5695             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5696
  5697         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5698
  5699         16  CF-LANGUAGE-TYPE                   PIC X.
  5700             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5701             88  CF-LANG-IS-FR                      VALUE 'F'.
  5702
  5703         16  CF-CSR-IND                         PIC X.
  5704         16  FILLER                             PIC X(239).
  5705
  5706****************************************************************
  5707*             PROCESSOR/REMINDERS RECORD                       *
  5708****************************************************************
  5709
  5710     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5711         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5712             20  CF-START-REMIND-DT         PIC XX.
  5713             20  CF-END-REMIND-DT           PIC XX.
  5714             20  CF-REMINDER-TEXT           PIC X(50).
  5715         16  FILLER                         PIC X(296).
  5716
  5717
  5718****************************************************************
  5719*             STATE MASTER RECORD                              *
  5720****************************************************************
  5721
  5722     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5723         16  CF-STATE-ABBREVIATION          PIC XX.
  5724         16  CF-STATE-NAME                  PIC X(25).
  5725         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5726         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5727             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5728             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5729             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5730             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5731                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5732                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5733             20  CF-ST-PREM-REJECT-SW       PIC X.
  5734                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5735                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5736             20  CF-ST-REF-REJECT-SW        PIC X.
  5737                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5738                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5739         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 107
* EL050.cbl
  5740         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5741         16  CF-ST-REFUND-RULES.
  5742             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5743             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5744             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5745         16  CF-ST-FST-PMT-EXTENSION.
  5746             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5747             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5748                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5749                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5750                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5751                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5752         16  CF-ST-STATE-CALL.
  5753             20  CF-ST-CALL-UNEARNED        PIC X.
  5754             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5755             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5756         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5757             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5758             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5759         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5760         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5761         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5762         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5763         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5764         16  FILLER                         PIC X.
  5765         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5766             20  CF-ST-BENEFIT-CD           PIC XX.
  5767             20  CF-ST-BENEFIT-KIND         PIC X.
  5768                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5769                 88  CF-ST-AH-KIND              VALUE 'A'.
  5770             20  CF-ST-REM-TERM-CALC        PIC X.
  5771                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5772                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5773                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5774                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5775                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5776                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5777                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5778                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5779
  5780             20  CF-ST-REFUND-CALC          PIC X.
  5781                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5782                 88  ST-REFD-BY-R78             VALUE '1'.
  5783                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5784                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5785                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5786                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5787                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5788                 88  ST-REFD-UTAH               VALUE '7'.
  5789                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5790                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5791                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5792
  5793             20  CF-ST-EARNING-CALC         PIC X.
  5794                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5795                 88  ST-EARN-BY-R78             VALUE '1'.
  5796                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5797                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 108
* EL050.cbl
  5798                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5799                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5800                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5801                 88  ST-EARN-MEAN               VALUE '8'.
  5802                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5803
  5804             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5805                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5806                 88  ST-OVRD-BY-R78             VALUE '1'.
  5807                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5808                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5809                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5810                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5811                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5812                 88  ST-OVRD-MEAN               VALUE '8'.
  5813                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5814             20  cf-st-extra-periods        pic 9.
  5815*            20  FILLER                     PIC X.
  5816
  5817         16  CF-ST-COMMISSION-CAPS.
  5818             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5819             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5820             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5821             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5822         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5823                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5824                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5825                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5826
  5827         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5828
  5829         16  CF-ST-STATUTORY-INTEREST.
  5830             20  CF-ST-STAT-DATE-FROM       PIC X.
  5831                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5832                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5833             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5834             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5835             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5836             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5837             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5838
  5839         16  CF-ST-OVER-SHORT.
  5840             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5841             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5842
  5843         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5844
  5845         16  CF-ST-RT-CALC                  PIC X.
  5846
  5847         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5848         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5849         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5850         16  CF-ST-RF-LR-CALC               PIC X.
  5851         16  CF-ST-RF-LL-CALC               PIC X.
  5852         16  CF-ST-RF-LN-CALC               PIC X.
  5853         16  CF-ST-RF-AH-CALC               PIC X.
  5854         16  CF-ST-RF-CP-CALC               PIC X.
  5855*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 109
* EL050.cbl
  5856*CIDMOD         16  FILLER                         PIC X(192).
  5857         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5858             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5859         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5860         16  CF-ST-VFY-2ND-BENE             PIC X.
  5861         16  CF-ST-CAUSAL-STATE             PIC X.
  5862         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5863         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5864         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5865             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5866         16  CF-ST-NET-ONLY-STATE           PIC X.
  5867             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5868         16  cf-commission-cap-required     pic x.
  5869         16  CF-ST-GA-COMMISSION-CAPS.
  5870             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5871             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5872             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5873             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5874         16  CF-ST-TOT-COMMISSION-CAPS.
  5875             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5876             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5877             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5878             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5879         16  FILLER                         PIC X(156).
  5880
  5881****************************************************************
  5882*             BENEFIT MASTER RECORD                            *
  5883****************************************************************
  5884
  5885     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5886         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5887             20  CF-BENEFIT-CODE            PIC XX.
  5888             20  CF-BENEFIT-NUMERIC  REDEFINES
  5889                 CF-BENEFIT-CODE            PIC XX.
  5890             20  CF-BENEFIT-ALPHA           PIC XXX.
  5891             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5892             20  CF-BENEFIT-COMMENT         PIC X(10).
  5893
  5894             20  CF-LF-COVERAGE-TYPE        PIC X.
  5895                 88  CF-REDUCING                VALUE 'R'.
  5896                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5897
  5898             20  CF-SPECIAL-CALC-CD         PIC X.
  5899                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5900                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5901                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5902                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5903                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5904                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5905                 88  CF-FARM-PLAN               VALUE 'F'.
  5906                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5907                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5908                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5909                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5910                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5911                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5912                 88  CF-PRUDENTIAL              VALUE 'P'.
  5913                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 110
* EL050.cbl
  5914                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5915                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5916                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5917                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5918                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5919
  5920             20  CF-JOINT-INDICATOR         PIC X.
  5921                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5922
  5923*            20  FILLER                     PIC X(12).
  5924             20  cf-maximum-benefits        pic s999 comp-3.
  5925             20  FILLER                     PIC X(09).
  5926             20  CF-BENEFIT-CATEGORY        PIC X.
  5927             20  CF-LOAN-TYPE               PIC X(8).
  5928
  5929             20  CF-CO-REM-TERM-CALC        PIC X.
  5930                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5931                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5932                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5933                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5934                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5935
  5936             20  CF-CO-EARNINGS-CALC        PIC X.
  5937                 88  CO-EARN-BY-R78             VALUE '1'.
  5938                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5939                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5940                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5941                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5942                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5943                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5944                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5945
  5946             20  CF-CO-REFUND-CALC          PIC X.
  5947                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5948                 88  CO-REFD-BY-R78             VALUE '1'.
  5949                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5950                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5951                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5952                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5953                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5954                 88  CO-REFD-MEAN               VALUE '8'.
  5955                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5956                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5957                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5958
  5959             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5960                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5961                 88  CO-OVRD-BY-R78             VALUE '1'.
  5962                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5963                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5964                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5965                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5966                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5967                 88  CO-OVRD-MEAN               VALUE '8'.
  5968                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5969
  5970             20  CF-CO-BEN-I-G-CD           PIC X.
  5971                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 111
* EL050.cbl
  5972                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5973                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5974
  5975         16  FILLER                         PIC X(304).
  5976
  5977
  5978****************************************************************
  5979*             CARRIER MASTER RECORD                            *
  5980****************************************************************
  5981
  5982     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5983         16  CF-ADDRESS-DATA.
  5984             20  CF-MAIL-TO-NAME            PIC X(30).
  5985             20  CF-IN-CARE-OF              PIC X(30).
  5986             20  CF-ADDRESS-LINE-1          PIC X(30).
  5987             20  CF-ADDRESS-LINE-2          PIC X(30).
  5988             20  CF-CITY-STATE              PIC X(30).
  5989             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5990             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5991
  5992         16  CF-CLAIM-NO-CONTROL.
  5993             20  CF-CLAIM-NO-METHOD         PIC X.
  5994                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5995                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5996                 88  CLAIM-NO-SEQ               VALUE '3'.
  5997                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5998             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5999                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  6000                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  6001                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  6002
  6003         16  CF-CHECK-NO-CONTROL.
  6004             20  CF-CHECK-NO-METHOD         PIC X.
  6005                 88  CHECK-NO-MANUAL            VALUE '1'.
  6006                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  6007                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  6008                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  6009             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  6010                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  6011
  6012         16  CF-DOMICILE-STATE              PIC XX.
  6013
  6014         16  CF-EXPENSE-CONTROLS.
  6015             20  CF-EXPENSE-METHOD          PIC X.
  6016                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  6017                 88  DOLLARS-PER-PMT            VALUE '2'.
  6018                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  6019                 88  DOLLARS-PER-MONTH          VALUE '4'.
  6020             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  6021             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  6022
  6023         16  CF-CORRESPONDENCE-CONTROL.
  6024             20  CF-LETTER-RESEND-OPT       PIC X.
  6025                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  6026                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  6027             20  FILLER                     PIC X(4).
  6028
  6029         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 112
* EL050.cbl
  6030             20  CF-MANUAL-SW               PIC X.
  6031                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  6032             20  CF-FUTURE-SW               PIC X.
  6033                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  6034             20  CF-PTC-SW                  PIC X.
  6035                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  6036             20  CF-IBNR-SW                 PIC X.
  6037                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  6038             20  CF-PTC-LF-SW               PIC X.
  6039                 88  CF-LF-PTC-USED             VALUE '1'.
  6040             20  CF-CDT-ACCESS-METHOD       PIC X.
  6041                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  6042                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  6043                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  6044             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  6045
  6046         16  CF-CLAIM-CALC-METHOD           PIC X.
  6047             88  360-PLUS-MONTHS                VALUE '1'.
  6048             88  365-PLUS-MONTHS                VALUE '2'.
  6049             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  6050             88  360-DAILY                      VALUE '4'.
  6051             88  365-DAILY                      VALUE '5'.
  6052
  6053         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  6054         16  FILLER                         PIC X(11).
  6055
  6056         16  CF-LIMIT-AMOUNTS.
  6057             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  6058             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  6059             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  6060             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6061             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6062             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6063             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6064             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6065             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6066             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6067
  6068         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6069         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6070         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6071
  6072         16  CF-ZIP-CODE.
  6073             20  CF-ZIP-PRIME.
  6074                 24  CF-ZIP-1ST             PIC X.
  6075                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6076                 24  FILLER                 PIC X(4).
  6077             20  CF-ZIP-PLUS4               PIC X(4).
  6078         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6079             20  CF-CAN-POSTAL-1            PIC XXX.
  6080             20  CF-CAN-POSTAL-2            PIC XXX.
  6081             20  FILLER                     PIC XXX.
  6082
  6083         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6084         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6085         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6086
  6087         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 113
* EL050.cbl
  6088             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6089             88  CF-NO-RATING                   VALUE 'N'.
  6090
  6091         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6092
  6093         16  CF-CARRIER-OVER-SHORT.
  6094             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6095             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6096
  6097         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6098         16  CF-SECPAY-SWITCH               PIC X.
  6099             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6100             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6101         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6102         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6103         16  FILLER                         PIC X(444).
  6104*        16  FILLER                         PIC X(452).
  6105
  6106
  6107****************************************************************
  6108*             MORTALITY MASTER RECORD                          *
  6109****************************************************************
  6110
  6111     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6112         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6113                                INDEXED BY CF-MORT-NDX.
  6114             20  CF-MORT-TABLE              PIC X(5).
  6115             20  CF-MORT-TABLE-TYPE         PIC X.
  6116                 88  CF-MORT-JOINT              VALUE 'J'.
  6117                 88  CF-MORT-SINGLE             VALUE 'S'.
  6118                 88  CF-MORT-COMBINED           VALUE 'C'.
  6119                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6120                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6121             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6122             20  CF-MORT-AGE-METHOD         PIC XX.
  6123                 88  CF-AGE-LAST                VALUE 'AL'.
  6124                 88  CF-AGE-NEAR                VALUE 'AN'.
  6125             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6126             20  CF-MORT-ADJUSTMENT-DIRECTION
  6127                                            PIC X.
  6128                 88  CF-MINUS                   VALUE '-'.
  6129                 88  CF-PLUS                    VALUE '+'.
  6130             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6131             20  CF-MORT-JOINT-CODE         PIC X.
  6132                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6133             20  CF-MORT-PC-Q               PIC X.
  6134                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6135             20  CF-MORT-TABLE-CODE         PIC X(4).
  6136             20  CF-MORT-COMMENTS           PIC X(15).
  6137             20  FILLER                     PIC X(14).
  6138
  6139         16  FILLER                         PIC X(251).
  6140
  6141
  6142****************************************************************
  6143*             BUSSINESS TYPE MASTER RECORD                     *
  6144****************************************************************
  6145
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 114
* EL050.cbl
  6146     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6147* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6148* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6149* AND RECORD 05 IS TYPES 81-99
  6150         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6151             20  CF-BUSINESS-TITLE          PIC  X(19).
  6152             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6153                                            PIC S9V9(4) COMP-3.
  6154             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6155             20  FILLER                     PIC  X.
  6156         16  FILLER                         PIC  X(248).
  6157
  6158
  6159****************************************************************
  6160*             TERMINAL MASTER RECORD                           *
  6161****************************************************************
  6162
  6163     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6164
  6165         16  CF-COMPANY-TERMINALS.
  6166             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6167                                  PIC X(4).
  6168         16  FILLER               PIC X(248).
  6169
  6170
  6171****************************************************************
  6172*             LIFE EDIT MASTER RECORD                          *
  6173****************************************************************
  6174
  6175     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6176         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6177             20  CF-LIFE-CODE-IN            PIC XX.
  6178             20  CF-LIFE-CODE-OUT           PIC XX.
  6179         16  FILLER                         PIC X(248).
  6180
  6181
  6182****************************************************************
  6183*             AH EDIT MASTER RECORD                            *
  6184****************************************************************
  6185
  6186     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6187         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6188             20  CF-AH-CODE-IN              PIC XXX.
  6189             20  CF-AH-CODE-OUT             PIC XX.
  6190         16  FILLER                         PIC X(248).
  6191
  6192
  6193****************************************************************
  6194*             CREDIBILITY TABLES                               *
  6195****************************************************************
  6196
  6197     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6198         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6199                             INDEXED BY CF-CRDB-NDX.
  6200             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6201             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6202             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6203         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 115
* EL050.cbl
  6204
  6205
  6206****************************************************************
  6207*             REPORT CUSTOMIZATION RECORD                      *
  6208****************************************************************
  6209
  6210     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6211         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6212             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6213             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6214             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6215**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6216****       A T-TRANSFER.                                   ****
  6217             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6218
  6219         16  FILLER                         PIC XX.
  6220
  6221         16  CF-CARRIER-CNTL-OPT.
  6222             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6223                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6224                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6225             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6226                                            PIC X.
  6227         16  CF-GROUP-CNTL-OPT.
  6228             20  CF-GROUP-OPT-SEQ           PIC 9.
  6229                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6230                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6231             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6232                                            PIC X(6).
  6233         16  CF-STATE-CNTL-OPT.
  6234             20  CF-STATE-OPT-SEQ           PIC 9.
  6235                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6236                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6237             20  CF-STATE-SELECT OCCURS 3 TIMES
  6238                                            PIC XX.
  6239         16  CF-ACCOUNT-CNTL-OPT.
  6240             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6241                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6242                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6243             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6244                                            PIC X(10).
  6245         16  CF-BUS-TYP-CNTL-OPT.
  6246             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6247                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6248                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6249             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6250                                            PIC XX.
  6251         16  CF-LF-TYP-CNTL-OPT.
  6252             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6253                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6254                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6255             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6256                                            PIC XX.
  6257         16  CF-AH-TYP-CNTL-OPT.
  6258             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6259                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6260                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6261             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 116
* EL050.cbl
  6262                                            PIC XX.
  6263         16  CF-REPTCD1-CNTL-OPT.
  6264             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6265                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6266                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6267             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6268                                            PIC X(10).
  6269         16  CF-REPTCD2-CNTL-OPT.
  6270             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6271                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6272                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6273             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6274                                            PIC X(10).
  6275         16  CF-USER1-CNTL-OPT.
  6276             20  CF-USER1-OPT-SEQ           PIC 9.
  6277                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6278                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6279             20  CF-USER1-SELECT OCCURS 3 TIMES
  6280                                            PIC X(10).
  6281         16  CF-USER2-CNTL-OPT.
  6282             20  CF-USER2-OPT-SEQ           PIC 9.
  6283                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6284                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6285             20  CF-USER2-SELECT OCCURS 3 TIMES
  6286                                            PIC X(10).
  6287         16  CF-USER3-CNTL-OPT.
  6288             20  CF-USER3-OPT-SEQ           PIC 9.
  6289                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6290                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6291             20  CF-USER3-SELECT OCCURS 3 TIMES
  6292                                            PIC X(10).
  6293         16  CF-USER4-CNTL-OPT.
  6294             20  CF-USER4-OPT-SEQ           PIC 9.
  6295                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6296                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6297             20  CF-USER4-SELECT OCCURS 3 TIMES
  6298                                            PIC X(10).
  6299         16  CF-USER5-CNTL-OPT.
  6300             20  CF-USER5-OPT-SEQ           PIC 9.
  6301                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6302                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6303             20  CF-USER5-SELECT OCCURS 3 TIMES
  6304                                            PIC X(10).
  6305         16  CF-REINS-CNTL-OPT.
  6306             20  CF-REINS-OPT-SEQ           PIC 9.
  6307                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6308                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6309             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6310                 24  CF-REINS-PRIME         PIC XXX.
  6311                 24  CF-REINS-SUB           PIC XXX.
  6312
  6313         16  CF-AGENT-CNTL-OPT.
  6314             20  CF-AGENT-OPT-SEQ           PIC 9.
  6315                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6316                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6317             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6318                                            PIC X(10).
  6319
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 117
* EL050.cbl
  6320         16  FILLER                         PIC X(43).
  6321
  6322         16  CF-LOSS-RATIO-SELECT.
  6323             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6324             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6325         16  CF-ENTRY-DATE-SELECT.
  6326             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6327             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6328         16  CF-EFFECTIVE-DATE-SELECT.
  6329             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6330             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6331
  6332         16  CF-EXCEPTION-LIST-IND          PIC X.
  6333             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6334
  6335         16  FILLER                         PIC X(318).
  6336
  6337****************************************************************
  6338*                  EXCEPTION REPORTING RECORD                  *
  6339****************************************************************
  6340
  6341     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6342         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6343             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6344
  6345         16  CF-COMBINED-LIFE-AH-OPT.
  6346             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6347             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6348             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6349             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6350
  6351         16  CF-LIFE-OPT.
  6352             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6353             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6354             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6355             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6356             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6357             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6358             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6359             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6360             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6361             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6362
  6363         16  CF-AH-OPT.
  6364             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6365             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6366             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6367             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6368             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6369             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6370             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6371             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6372             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6373             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6374
  6375         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6376             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6377             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 118
* EL050.cbl
  6378             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6379
  6380         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6381
  6382         16  FILLER                         PIC X(673).
  6383
  6384
  6385****************************************************************
  6386*             MORTGAGE SYSTEM PLAN RECORD                      *
  6387****************************************************************
  6388
  6389     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6390         16  CF-PLAN-TYPE                   PIC X.
  6391             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6392             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6393             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6394         16  CF-PLAN-ABBREV                 PIC XXX.
  6395         16  CF-PLAN-DESCRIPT               PIC X(10).
  6396         16  CF-PLAN-NOTES                  PIC X(20).
  6397         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6398         16  CF-PLAN-UNDERWRITING.
  6399             20  CF-PLAN-TERM-DATA.
  6400                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6401                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6402             20  CF-PLAN-AGE-DATA.
  6403                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6404                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6405                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6406             20  CF-PLAN-BENEFIT-DATA.
  6407                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6408                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6409                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6410                                            PIC S9(7)V99  COMP-3.
  6411         16  CF-PLAN-POLICY-FORMS.
  6412             20  CF-POLICY-FORM             PIC X(12).
  6413             20  CF-MASTER-APPLICATION      PIC X(12).
  6414             20  CF-MASTER-POLICY           PIC X(12).
  6415         16  CF-PLAN-RATING.
  6416             20  CF-RATE-CODE               PIC X(5).
  6417             20  CF-SEX-RATING              PIC X.
  6418                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6419                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6420             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6421             20  CF-SUB-STD-TYPE            PIC X.
  6422                 88  CF-PCT-OF-PREM            VALUE '1'.
  6423                 88  CF-PCT-OF-BENE            VALUE '2'.
  6424         16  CF-PLAN-PREM-TOLERANCES.
  6425             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6426             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6427         16  CF-PLAN-PYMT-TOLERANCES.
  6428             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6429             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6430         16  CF-PLAN-MISC-DATA.
  6431             20  FILLER                     PIC X.
  6432             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6433             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6434         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6435         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 119
* EL050.cbl
  6436             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6437                                                     '1'.
  6438             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6439                                                     '2'.
  6440         16  CF-MIB-SEARCH-SW               PIC X.
  6441             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6442             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6443             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6444             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6445         16  CF-ALPHA-SEARCH-SW             PIC X.
  6446             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6447             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6448             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6449             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6450             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6451             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6452             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6453             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6454             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6455             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6456                                                     'A' 'B' 'C'
  6457                                                     'X' 'Y' 'Z'.
  6458         16  CF-EFF-DT-RULE-SW              PIC X.
  6459             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6460             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6461             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6462             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6463             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6464         16  FILLER                         PIC X(4).
  6465         16  CF-HEALTH-QUESTIONS            PIC X.
  6466             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6467         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6468         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6469         16  CF-PLAN-SNGL-JNT               PIC X.
  6470             88  CF-COMBINED-PLAN              VALUE 'C'.
  6471             88  CF-JNT-PLAN                   VALUE 'J'.
  6472             88  CF-SNGL-PLAN                  VALUE 'S'.
  6473         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6474         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6475         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6476         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6477         16  CF-RERATE-CNTL                 PIC  X.
  6478             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6479             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6480             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6481             88  CF-AUTO-RECALC                 VALUE '4'.
  6482         16  CF-BENEFIT-TYPE                PIC  X.
  6483             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6484             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6485         16  CF-POLICY-FEE                  PIC S999V99
  6486                                                    COMP-3.
  6487         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6488         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6489         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6490         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6491         16  FILLER                         PIC  X(32).
  6492         16  CF-TERMINATION-FORM            PIC  X(04).
  6493         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 120
* EL050.cbl
  6494         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6495                                                       COMP-3.
  6496         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6497         16  CF-ISSUE-LETTER                PIC  X(4).
  6498         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6499         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6500             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6501             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6502         16  CF-MP-REFUND-CALC              PIC X.
  6503             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6504             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6505             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6506             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6507             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6508             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6509             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6510             88  CF-MP-REFD-MEAN                VALUE '8'.
  6511         16  CF-ALT-RATE-CODE               PIC  X(5).
  6512
  6513
  6514         16  FILLER                         PIC X(498).
  6515****************************************************************
  6516*             MORTGAGE COMPANY MASTER RECORD                   *
  6517****************************************************************
  6518
  6519     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6520         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6521         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6522             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6523             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6524             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6525             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6526             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6527
  6528         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6529         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6530         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6531         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6532         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6533
  6534         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6535             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6536         16  CF-MP-RECON-USE-IND            PIC X(1).
  6537             88  CF-MP-USE-RECON             VALUE 'Y'.
  6538         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6539             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6540         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6541             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6542             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6543         16  FILLER                         PIC X(1).
  6544         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6545             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6546         16  CF-MORTG-MIB-VERSION           PIC X.
  6547             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6548             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6549             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6550         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6551             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 121
* EL050.cbl
  6552                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6553             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6554                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6555             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6556                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6557             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6558                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6559             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6560                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6561             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6562                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6563         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6564         16  FILLER                         PIC X(7).
  6565         16  CF-MORTG-DESTINATION-SYMBOL.
  6566             20  CF-MORTG-MIB-COMM          PIC X(5).
  6567             20  CF-MORTG-MIB-TERM          PIC X(5).
  6568         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6569             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6570         16  FILLER                         PIC X(03).
  6571         16  CF-MP-CHECK-NO-CONTROL.
  6572             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6573                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6574                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6575                                                ' ' LOW-VALUES.
  6576                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6577                                               VALUE '3'.
  6578         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6579         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6580         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6581             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6582                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6583             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6584                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6585             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6586                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6587             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6588                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6589             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6590                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6591             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6592                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6593         16  CF-MORTG-BILLING-AREA.
  6594             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6595                                            PIC X.
  6596         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6597         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6598         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6599         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6600             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6601             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6602         16  FILLER                         PIC X.
  6603         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6604             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6605             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6606         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6607         16  FILLER                         PIC X(8).
  6608         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6609         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 122
* EL050.cbl
  6610         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6611         16  CF-ACH-COMPANY-ID.
  6612             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6613                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6614                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6615                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6616             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6617         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6618             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6619         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6620             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6621             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6622         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6623         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6624         16  FILLER                         PIC X(536).
  6625
  6626****************************************************************
  6627*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6628****************************************************************
  6629
  6630     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6631         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6632             20  CF-FEMALE-HEIGHT.
  6633                 24  CF-FEMALE-FT           PIC 99.
  6634                 24  CF-FEMALE-IN           PIC 99.
  6635             20  CF-FEMALE-MIN-WT           PIC 999.
  6636             20  CF-FEMALE-MAX-WT           PIC 999.
  6637         16  FILLER                         PIC X(428).
  6638
  6639     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6640         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6641             20  CF-MALE-HEIGHT.
  6642                 24  CF-MALE-FT             PIC 99.
  6643                 24  CF-MALE-IN             PIC 99.
  6644             20  CF-MALE-MIN-WT             PIC 999.
  6645             20  CF-MALE-MAX-WT             PIC 999.
  6646         16  FILLER                         PIC X(428).
  6647******************************************************************
  6648*             AUTOMATIC ACTIVITY RECORD                          *
  6649******************************************************************
  6650     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6651         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6652             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6653             20  CF-SYS-LETTER-ID           PIC X(04).
  6654             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6655             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6656             20  CF-SYS-RESET-SW            PIC X(01).
  6657             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6658             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6659
  6660         16  FILLER                         PIC X(50).
  6661
  6662         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6663             20  CF-USER-ACTIVE-SW          PIC X(01).
  6664             20  CF-USER-LETTER-ID          PIC X(04).
  6665             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6666             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6667             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 123
* EL050.cbl
  6668             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6669             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6670             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6671
  6672         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 124
* EL050.cbl
  6674*    COPY ERCACCT.
  6675******************************************************************
  6676*                                                                *
  6677*                                                                *
  6678*                            ERCACCT                             *
  6679*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6680*                            VMOD=2.031                          *
  6681*                                                                *
  6682*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6683*                                                                *
  6684*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6685*   VSAM ACCOUNT MASTER FILES.                                   *
  6686*                                                                *
  6687*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6688*                                                                *
  6689*   FILE TYPE = VSAM,KSDS                                        *
  6690*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6691*                                                                *
  6692*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6693*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6694*                                                                *
  6695*   LOG = NO                                                     *
  6696*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6697*                                                                *
  6698*                                                                *
  6699******************************************************************
  6700*                   C H A N G E   L O G
  6701*
  6702* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6703*-----------------------------------------------------------------
  6704*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6705* EFFECTIVE    NUMBER
  6706*-----------------------------------------------------------------
  6707* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6708* 092705    2005050300006  PEMA  ADD SPP LEASES
  6709* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6710* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6711* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6712* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6713* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6714* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6715******************************************************************
  6716
  6717 01  ACCOUNT-MASTER.
  6718     12  AM-RECORD-ID                      PIC XX.
  6719         88  VALID-AM-ID                      VALUE 'AM'.
  6720
  6721     12  AM-CONTROL-PRIMARY.
  6722         16  AM-COMPANY-CD                 PIC X.
  6723         16  AM-MSTR-CNTRL.
  6724             20  AM-CONTROL-A.
  6725                 24  AM-CARRIER            PIC X.
  6726                 24  AM-GROUPING.
  6727                     28 AM-GROUPING-PREFIX PIC XXX.
  6728                     28 AM-GROUPING-PRIME  PIC XXX.
  6729                 24  AM-STATE              PIC XX.
  6730                 24  AM-ACCOUNT.
  6731                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 125
* EL050.cbl
  6732                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6733             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6734                                           PIC X(19).
  6735             20  AM-CNTRL-B.
  6736                 24  AM-EXPIRATION-DT      PIC XX.
  6737                 24  FILLER                PIC X(4).
  6738             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6739                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6740
  6741     12  AM-CONTROL-BY-VAR-GRP.
  6742         16  AM-COMPANY-CD-A1              PIC X.
  6743         16  AM-VG-CARRIER                 PIC X.
  6744         16  AM-VG-GROUPING                PIC X(6).
  6745         16  AM-VG-STATE                   PIC XX.
  6746         16  AM-VG-ACCOUNT                 PIC X(10).
  6747         16  AM-VG-DATE.
  6748             20  AM-VG-EXPIRATION-DT       PIC XX.
  6749             20  FILLER                    PIC X(4).
  6750         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6751                                           PIC 9(11)      COMP-3.
  6752     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6753         16  FILLER                        PIC X(10).
  6754         16  AM-VG-KEY3.
  6755             20  AM-VG3-ACCOUNT            PIC X(10).
  6756             20  AM-VG3-EXP-DT             PIC XX.
  6757         16  FILLER                        PIC X(4).
  6758     12  AM-MAINT-INFORMATION.
  6759         16  AM-LAST-MAINT-DT              PIC XX.
  6760         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6761         16  AM-LAST-MAINT-USER            PIC X(4).
  6762         16  FILLER                        PIC XX.
  6763
  6764     12  AM-EFFECTIVE-DT                   PIC XX.
  6765     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6766
  6767     12  AM-PREV-DATES  COMP-3.
  6768         16  AM-PREV-EXP-DT                PIC 9(11).
  6769         16  AM-PREV-EFF-DT                PIC 9(11).
  6770
  6771     12  AM-REPORT-CODE-1                  PIC X(10).
  6772     12  AM-REPORT-CODE-2                  PIC X(10).
  6773
  6774     12  AM-CITY-CODE                      PIC X(4).
  6775     12  AM-COUNTY-PARISH                  PIC X(6).
  6776
  6777     12  AM-NAME                           PIC X(30).
  6778     12  AM-PERSON                         PIC X(30).
  6779     12  AM-ADDRS                          PIC X(30).
  6780     12  AM-CITY.
  6781         16  AM-ADDR-CITY                  PIC X(28).
  6782         16  AM-ADDR-STATE                 PIC XX.
  6783     12  AM-ZIP.
  6784         16  AM-ZIP-PRIME.
  6785             20  AM-ZIP-PRI-1ST            PIC X.
  6786                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6787             20  FILLER                    PIC X(4).
  6788         16  AM-ZIP-PLUS4                  PIC X(4).
  6789     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 126
* EL050.cbl
  6790         16  AM-CAN-POSTAL-1               PIC XXX.
  6791         16  AM-CAN-POSTAL-2               PIC XXX.
  6792         16  FILLER                        PIC XXX.
  6793     12  AM-TEL-NO.
  6794         16  AM-AREA-CODE                  PIC 999.
  6795         16  AM-TEL-PRE                    PIC 999.
  6796         16  AM-TEL-NBR                    PIC 9(4).
  6797     12  AM-TEL-LOC                        PIC X.
  6798         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6799         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6800
  6801     12  AM-COMM-STRUCTURE.
  6802         16  AM-DEFN-1.
  6803             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6804                 24  AM-AGT.
  6805                     28  AM-AGT-PREFIX     PIC X(4).
  6806                     28  AM-AGT-PRIME      PIC X(6).
  6807                 24  AM-COM-TYP            PIC X.
  6808                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6809                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6810                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6811                 24  AM-RECALC-LV-INDIC    PIC X.
  6812                 24  AM-RETRO-LV-INDIC     PIC X.
  6813                 24  AM-GL-CODES           PIC X.
  6814                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6815                 24  FILLER                PIC X(01).
  6816         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6817             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6818                 24  FILLER                PIC X(11).
  6819                 24  AM-L-COMA             PIC XXX.
  6820                 24  AM-J-COMA             PIC XXX.
  6821                 24  AM-A-COMA             PIC XXX.
  6822                 24  FILLER                PIC X(6).
  6823
  6824     12  AM-COMM-CHANGE-STATUS             PIC X.
  6825         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6826
  6827     12  AM-CSR-CODE                       PIC X(4).
  6828
  6829     12  AM-BILLING-STATUS                 PIC X.
  6830         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6831         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6832     12  AM-AUTO-REFUND-SW                 PIC X.
  6833         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6834         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6835     12  AM-GPCD                           PIC 99.
  6836     12  AM-IG                             PIC X.
  6837         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6838         88  AM-HAS-GROUP                     VALUE '2'.
  6839     12  AM-STATUS                         PIC X.
  6840         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6841         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6842         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6843         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6844         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6845         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6846         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6847         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 127
* EL050.cbl
  6848         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6849         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6850     12  AM-REMIT-TO                       PIC 99.
  6851     12  AM-ID-NO                          PIC X(11).
  6852
  6853     12  AM-CAL-TABLE                      PIC XX.
  6854     12  AM-LF-DEVIATION                   PIC XXX.
  6855     12  AM-AH-DEVIATION                   PIC XXX.
  6856     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6857     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6858     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6859     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6860     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6861     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6862
  6863     12  AM-USER-FIELDS.
  6864         16  AM-FLD-1                      PIC XX.
  6865         16  AM-FLD-2                      PIC XX.
  6866         16  AM-FLD-3                      PIC XX.
  6867         16  AM-FLD-4                      PIC XX.
  6868         16  AM-FLD-5                      PIC XX.
  6869
  6870     12  AM-1ST-PROD-DATE.
  6871         16  AM-1ST-PROD-YR                PIC XX.
  6872         16  AM-1ST-PROD-MO                PIC XX.
  6873         16  AM-1ST-PROD-DA                PIC XX.
  6874     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6875     12  AM-CERTS-PURGED-DATE.
  6876         16  AM-PUR-YR                     PIC XX.
  6877         16  AM-PUR-MO                     PIC XX.
  6878         16  AM-PUR-DA                     PIC XX.
  6879     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6880     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6881     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6882     12  AM-INACTIVE-DATE.
  6883         16  AM-INA-MO                     PIC 99.
  6884         16  AM-INA-DA                     PIC 99.
  6885         16  AM-INA-YR                     PIC 99.
  6886     12  AM-AR-HI-CERT-DATE                PIC XX.
  6887
  6888     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6889     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6890
  6891     12  AM-OB-PAYMENT-MODE                PIC X.
  6892         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6893         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6894         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6895         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6896
  6897     12  AM-AH-ONLY-INDICATOR              PIC X.
  6898         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6899         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6900
  6901     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6902
  6903     12  AM-OVER-SHORT.
  6904         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6905         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 128
* EL050.cbl
  6906
  6907     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6908     12  AM-DCC-CLP-STATE                  PIC XX.
  6909
  6910     12  AM-RECALC-COMM                    PIC X.
  6911     12  AM-RECALC-REIN                    PIC X.
  6912
  6913     12  AM-REI-TABLE                      PIC XXX.
  6914     12  AM-REI-ET-LF                      PIC X.
  6915     12  AM-REI-ET-AH                      PIC X.
  6916     12  AM-REI-PE-LF                      PIC X.
  6917     12  AM-REI-PE-AH                      PIC X.
  6918     12  AM-REI-PRT-ST                     PIC X.
  6919     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6920     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6921     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6922     12  AM-REI-GROUP-A                    PIC X(6).
  6923     12  AM-REI-MORT                       PIC X(4).
  6924     12  AM-REI-PRT-OW                     PIC X.
  6925     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6926     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6927     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6928     12  AM-REI-GROUP-B                    PIC X(6).
  6929
  6930     12  AM-TRUST-TYPE                     PIC X(2).
  6931
  6932     12  AM-EMPLOYER-STMT-USED             PIC X.
  6933     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6934
  6935     12  AM-STD-AH-TYPE                    PIC XX.
  6936     12  AM-EARN-METHODS.
  6937         16  AM-EARN-METHOD-R              PIC X.
  6938             88 AM-REF-RL-R78                 VALUE 'R'.
  6939             88 AM-REF-RL-PR                  VALUE 'P'.
  6940             88 AM-REF-RL-MEAN                VALUE 'M'.
  6941             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6942         16  AM-EARN-METHOD-L              PIC X.
  6943             88 AM-REF-LL-R78                 VALUE 'R'.
  6944             88 AM-REF-LL-PR                  VALUE 'P'.
  6945             88 AM-REF-LL-MEAN                VALUE 'M'.
  6946             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6947         16  AM-EARN-METHOD-A              PIC X.
  6948             88 AM-REF-AH-R78                 VALUE 'R'.
  6949             88 AM-REF-AH-PR                  VALUE 'P'.
  6950             88 AM-REF-AH-MEAN                VALUE 'M'.
  6951             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6952             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6953             88 AM-REF-AH-NET                 VALUE 'N'.
  6954
  6955     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6956     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6957     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6958
  6959     12  AM-RET-Y-N                        PIC X.
  6960     12  AM-RET-P-E                        PIC X.
  6961     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6962     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6963     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 129
* EL050.cbl
  6964     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6965         16  AM-POOL-PRIME                 PIC XXX.
  6966         16  AM-POOL-SUB                   PIC XXX.
  6967     12  AM-RETRO-EARNINGS.
  6968         16  AM-RET-EARN-R                 PIC X.
  6969         16  AM-RET-EARN-L                 PIC X.
  6970         16  AM-RET-EARN-A                 PIC X.
  6971     12  AM-RET-ST-TAX-USE                 PIC X.
  6972         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6973         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6974     12  AM-RETRO-BEG-EARNINGS.
  6975         16  AM-RET-BEG-EARN-R             PIC X.
  6976         16  AM-RET-BEG-EARN-L             PIC X.
  6977         16  AM-RET-BEG-EARN-A             PIC X.
  6978     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6979     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6980
  6981     12  AM-USER-SELECT-OPTIONS.
  6982         16  AM-USER-SELECT-1              PIC X(10).
  6983         16  AM-USER-SELECT-2              PIC X(10).
  6984         16  AM-USER-SELECT-3              PIC X(10).
  6985         16  AM-USER-SELECT-4              PIC X(10).
  6986         16  AM-USER-SELECT-5              PIC X(10).
  6987
  6988     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6989
  6990     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6991
  6992     12  AM-RPT045A-SWITCH                 PIC X.
  6993         88  RPT045A-OFF                   VALUE 'N'.
  6994
  6995     12  AM-INSURANCE-LIMITS.
  6996         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6997         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6998
  6999     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  7000         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  7001
  7002     12  AM-DISMBR-COVERAGE-SW             PIC X.
  7003         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  7004         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  7005
  7006     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  7007
  7008     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  7009     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  7010     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  7011     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  7012     12  AM-DCC-UEF-STATE                  PIC XX.
  7013     12  FILLER                            PIC XXX.
  7014     12  AM-REPORT-CODE-3                  PIC X(10).
  7015*    12  FILLER                            PIC X(22).
  7016
  7017     12  AM-RESERVE-DATE.
  7018         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  7019         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  7020         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  7021
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 130
* EL050.cbl
  7022     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  7023     12  AM-NOTIFICATION-TYPES.
  7024         16  AM-NOTIF-OF-LETTERS           PIC X.
  7025         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  7026         16  AM-NOTIF-OF-REPORTS           PIC X.
  7027         16  AM-NOTIF-OF-STATUS            PIC X.
  7028
  7029     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  7030         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  7031         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  7032         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  7033         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  7034
  7035     12  AM-BENEFIT-CONTROLS.
  7036         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  7037             20  AM-BENEFIT-CODE           PIC XX.
  7038             20  AM-BENEFIT-TYPE           PIC X.
  7039             20  AM-BENEFIT-REVISION       PIC XXX.
  7040             20  AM-BENEFIT-REM-TERM       PIC X.
  7041             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  7042             20  FILLER                    PIC XX.
  7043         16  FILLER                        PIC X(80).
  7044
  7045     12  AM-TRANSFER-DATA.
  7046         16  AM-TRANSFERRED-FROM.
  7047             20  AM-TRNFROM-CARRIER        PIC X.
  7048             20  AM-TRNFROM-GROUPING.
  7049                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  7050                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  7051             20  AM-TRNFROM-STATE          PIC XX.
  7052             20  AM-TRNFROM-ACCOUNT.
  7053                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  7054                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  7055             20  AM-TRNFROM-DTE            PIC XX.
  7056         16  AM-TRANSFERRED-TO.
  7057             20  AM-TRNTO-CARRIER          PIC X.
  7058             20  AM-TRNTO-GROUPING.
  7059                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  7060                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  7061             20  AM-TRNTO-STATE            PIC XX.
  7062             20  AM-TRNTO-ACCOUNT.
  7063                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  7064                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  7065             20  AM-TRNTO-DTE              PIC XX.
  7066         16  FILLER                        PIC X(10).
  7067
  7068     12  AM-SAVED-REMIT-TO                 PIC 99.
  7069
  7070     12  AM-COMM-STRUCTURE-SAVED.
  7071         16  AM-DEFN-1-SAVED.
  7072             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  7073                 24  AM-AGT-SV             PIC X(10).
  7074                 24  AM-COM-TYP-SV         PIC X.
  7075                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  7076                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  7077                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  7078                 24  AM-RECALC-LV-INDIC-SV PIC X.
  7079                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 131
* EL050.cbl
  7080                 24  AM-GL-CODES-SV        PIC X.
  7081                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  7082                 24  FILLER                PIC X.
  7083         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  7084             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  7085                 24  FILLER                PIC X(11).
  7086                 24  AM-L-COMA-SV          PIC XXX.
  7087                 24  AM-J-COMA-SV          PIC XXX.
  7088                 24  AM-A-COMA-SV          PIC XXX.
  7089                 24  FILLER                PIC X(6).
  7090
  7091     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  7092         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  7093            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  7094            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  7095            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  7096
  7097     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7098     12  FILLER                            PIC X(120).
  7099
  7100     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7101         16  AM-CONTROL-NAME               PIC X(30).
  7102         16  AM-EXECUTIVE-ONE.
  7103             20  AM-EXEC1-NAME             PIC X(15).
  7104             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7105                                                          COMP-3.
  7106             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7107                                                          COMP-3.
  7108         16  AM-EXECUTIVE-TWO.
  7109             20  AM-EXEC2-NAME             PIC X(15).
  7110             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7111                                                          COMP-3.
  7112             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7113                                                          COMP-3.
  7114
  7115     12  AM-RETRO-ADDITIONAL-DATA.
  7116         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7117         16  AM-RETRO-PREM-P-E             PIC X.
  7118         16  AM-RETRO-CLMS-P-I             PIC X.
  7119         16  AM-RETRO-RET-BRACKET-LF.
  7120             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7121                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7122                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7123             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7124                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7125                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7126             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7127                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7128                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7129         16  AM-RETRO-RET-BRACKET-AH.
  7130             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7131                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7132                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7133                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7134             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7135                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7136                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7137             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 132
* EL050.cbl
  7138                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7139                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7140
  7141     12  AM-COMMENTS.
  7142         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7143
  7144     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7145         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7146         16  AM-FLI-BILLING-CODE           PIC X.
  7147         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7148         16  AM-FLI-UNITED-IDENT           PIC X.
  7149         16  AM-FLI-INTEREST-LOST-DATA.
  7150             20  AM-FLI-BANK-NO            PIC X(5).
  7151             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7152             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7153             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7154         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7155             20  AM-FLI-AGT                PIC X(9).
  7156             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7157             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7158         16  FILLER                        PIC X(102).
  7159
  7160     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7161         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7162             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7163             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7164             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7165             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7166             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7167         16  FILLER                          PIC X(10).
  7168******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 133
* EL050.cbl
  7170*    COPY ERCREIN.
  7171******************************************************************
  7172*                                                                *
  7173*                            ERCREIN                             *
  7174*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7175*                            VMOD=2.010                          *
  7176*                                                                *
  7177*   ONLINE CREDIT SYSTEM                                         *
  7178*                                                                *
  7179*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7180*                                                                *
  7181*   FILE TYPE = VSAM,KSDS                                        *
  7182*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7183*                                                                *
  7184*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7185*       ALTERNATE PATH = NONE                                    *
  7186*                                                                *
  7187*   LOG = NO                                                     *
  7188*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7189*                                                                *
  7190******************************************************************
  7191*                   C H A N G E   L O G
  7192*
  7193* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7194*-----------------------------------------------------------------
  7195*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7196* EFFECTIVE    NUMBER
  7197*-----------------------------------------------------------------
  7198* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7199* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7200******************************************************************
  7201 01  REINSURANCE-RECORD.
  7202     12  RE-RECORD-ID                      PIC XX.
  7203         88  VALID-RE-ID                      VALUE 'RE'.
  7204
  7205     12  RE-CONTROL-PRIMARY.
  7206         16  RE-COMPANY-CD                 PIC X.
  7207         16  RE-KEY.
  7208             20  RE-CODE                   PIC X.
  7209                 88  RE-TABLE-RECORD          VALUE 'A'.
  7210                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7211             20  RE-TABLE                  PIC XXX.
  7212             20  FILLER                    PIC XXX.
  7213         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7214             20  FILLER                    PIC X.
  7215             20  RE-COMPANY.
  7216                 24  RE-COMP-PRIME         PIC XXX.
  7217                 24  RE-COMP-SUB           PIC XXX.
  7218
  7219     12  RE-MAINT-INFORMATION.
  7220         16  RE-LAST-MAINT-DT              PIC XX.
  7221         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7222         16  RE-LAST-MAINT-USER            PIC X(4).
  7223         16  FILLER                        PIC X(10).
  7224
  7225     12  RE-TABLE-DATA.
  7226         16  RE-100-COMP                   PIC 99.
  7227
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 134
* EL050.cbl
  7228         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7229             20  RE-REI-COMP-NO.
  7230                 24  RE-REI-COMP           PIC XXX.
  7231                 24  RE-REI-COMP-SUB       PIC XXX.
  7232             20  RE-LF-QC                  PIC X.
  7233             20  RE-AH-QC                  PIC X.
  7234             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7235             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7236             20  RE-LFAGE-LO               PIC 99.
  7237             20  RE-LFAGE-HI               PIC 99.
  7238             20  RE-AHAGE-LO               PIC 99.
  7239             20  RE-AHAGE-HI               PIC 99.
  7240             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7241             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7242             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7243             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7244             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7245             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7246             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7247             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7248             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7249             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7250             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7251             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7252             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7253             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7254             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7255             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7256             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7257             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7258             20  RE-LF-BEN-CODE            PIC X.
  7259             20  RE-AH-BEN-CODE            PIC X.
  7260             20  RE-INTERACTIVE            PIC X.
  7261             20  RE-REMAINING              PIC X.
  7262             20  RE-LF-RUNOFF-SW           PIC X.
  7263             20  RE-AH-RUNOFF-SW           PIC X.
  7264             20  FILLER                    PIC X(19).
  7265
  7266         16  RE-COMP-INFO-END              PIC X(6).
  7267         16  RE-NSP-ST-CD-LF               PIC XX.
  7268         16  RE-NSP-ST-CD-AH               PIC XX.
  7269         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7270             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7271
  7272         16  FILLER                        PIC X(27).
  7273
  7274     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7275         16  RE-NAME                       PIC X(30).
  7276         16  RE-LF-PE                      PIC X.
  7277         16  RE-AH-PE                      PIC X.
  7278         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7279         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7280         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7281         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7282         16  RE-PRT-ST                     PIC X.
  7283         16  RE-PRT-OW                     PIC X.
  7284         16  RE-MORT-CODE                  PIC X(4).
  7285         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 135
* EL050.cbl
  7286         16  RE-ZERO-LF-FEE                PIC X.
  7287         16  RE-ZERO-AH-FEE                PIC X.
  7288         16  RE-CEDE-NAME                  PIC X(30).
  7289         16  RE-LF-COMM                    PIC X.
  7290         16  RE-AH-COMM                    PIC X.
  7291         16  RE-LF-TAX                     PIC X.
  7292         16  RE-AH-TAX                     PIC X.
  7293         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7294         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7295         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7296
  7297         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7298             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7299
  7300         16  RE-LF-CEDING-FEE-BRACKETS.
  7301             20  RE-LF-FEE-METHOD          PIC X.
  7302                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7303                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7304                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7305                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7306             20  RE-LF-FEE-BASIS           PIC X.
  7307                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7308                 88  RE-LF-NET-CEDED               VALUE '2'.
  7309                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7310                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7311                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7312                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7313                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7314                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7315             20  FILLER                    PIC XXX.
  7316             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7317                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7318                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7319
  7320         16  RE-AH-CEDING-FEE-BRACKETS.
  7321             20  RE-AH-FEE-METHOD          PIC X.
  7322                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7323                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7324                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7325                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7326             20  RE-AH-FEE-BASIS           PIC X.
  7327                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7328                 88  RE-AH-NET-CEDED               VALUE '2'.
  7329                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7330                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7331                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7332                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7333                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7334                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7335             20  FILLER                    PIC XXX.
  7336             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7337                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7338                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7339
  7340         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7341
  7342         16  RE-OLD-CEDING-STMT            PIC X.
  7343
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 136
* EL050.cbl
  7344         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7345         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7346         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7347         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7348         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7349         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7350         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7351         16  RE-MORT-SW                    PIC X.
  7352         16  RE-CEDING-TYPE-FLAG           PIC X.
  7353             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7354             88  RE-CEDED                          VALUE 'C'.
  7355             88  RE-ASSUMED                        VALUE 'A'.
  7356             88  RE-PHANTOM                        VALUE 'P'.
  7357
  7358         16  RE-CEDING-STMT-OPT-A          PIC X.
  7359             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7360         16  RE-CEDING-STMT-OPT-B          PIC X.
  7361             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7362         16  RE-CEDING-STMT-OPT-C          PIC X.
  7363             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7364         16  RE-CEDING-STMT-OPT-D          PIC X.
  7365             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7366         16  RE-CEDING-STMT-OPT-E          PIC X.
  7367             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7368
  7369         16  RE-PRT-CRSV                   PIC X.
  7370
  7371         16  RE-GL-CENTER                  PIC X(4).
  7372
  7373         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7374
  7375         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7376
  7377         16  RE-EARN-STOP-CODE             PIC X.
  7378             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7379             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7380
  7381         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7382             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7383
  7384         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7385         16  FILLER                        PIC X(2281).
  7386
  7387         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7388
  7389******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 137
* EL050.cbl
  7391*    COPY ERCCTBL.
  7392******************************************************************
  7393*                                                                *
  7394*                                                                *
  7395*                            ERCCTBL                             *
  7396*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7397*                            VMOD=2.003
  7398*                                                                *
  7399*   ONLINE CREDIT SYSTEM                                         *
  7400*                                                                *
  7401*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7402*                                                                *
  7403*   FILE TYPE = VSAM,KSDS                                        *
  7404*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7405*                                                                *
  7406*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7407*       ALTERNATE PATH = NONE                                    *
  7408*                                                                *
  7409*   LOG = NO                                                     *
  7410*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7411*                                                                *
  7412*                                                                *
  7413******************************************************************
  7414
  7415 01  COMM-TABLE-RECORD.
  7416     12  CT-RECORD-ID                      PIC XX.
  7417         88  VALID-CT-ID                      VALUE 'CT'.
  7418
  7419     12  CT-CONTROL-PRIMARY.
  7420         16  CT-COMPANY-CD                 PIC X.
  7421         16  CT-TABLE                      PIC XXX.
  7422         16  CT-CNTRL-2.
  7423             20  CT-BEN-TYPE               PIC X.
  7424             20  CT-BEN-CODE               PIC XX.
  7425
  7426     12  CT-MAINT-INFORMATION.
  7427         16  CT-LAST-MAINT-DT              PIC XX.
  7428         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7429         16  CT-LAST-MAINT-USER            PIC X(4).
  7430         16  FILLER                        PIC X(31).
  7431
  7432     12  CT-LIMITS.
  7433         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7434
  7435         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7436
  7437         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7438
  7439     12  CT-RATES.
  7440         16  CT-RTX          OCCURS 27 TIMES.
  7441             20  CT-RT                     PIC SV9(5)     COMP-3.
  7442             20  CT-RT-R   REDEFINES
  7443                 CT-RT                     PIC XXX.
  7444
  7445     12  FILLER                            PIC  X(42).
  7446
  7447******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 138
* EL050.cbl
  7449*    COPY ERCFORM.
  7450******************************************************************
  7451*                                                                *
  7452*                                                                *
  7453*                            ERCFORM.                            *
  7454*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7455*                            VMOD=2.003                          *
  7456*                                                                *
  7457*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7458*                                                                *
  7459*    FILE TYPE = VSAM,KSDS                                       *
  7460*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7461*                                                                *
  7462*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7463*                                                                *
  7464*    LOG = YES                                                   *
  7465*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7466******************************************************************
  7467 01  FORM-MASTER.
  7468    12  FO-RECORD-ID                 PIC X(02).
  7469        88  VALID-FO-ID                  VALUE 'FO'.
  7470
  7471    12  FO-CONTROL-PRIMARY.
  7472        16  FO-COMPANY-CD            PIC X(01).
  7473        16  FO-STATE                 PIC X(02).
  7474        16  FO-FORM-ID               PIC X(12).
  7475        16  FO-FORM-EXP-DT           PIC X(02).
  7476
  7477    12  FO-POLICY-FORM-DATA.
  7478        16  FO-IND-GRP-CD            PIC X(01).
  7479        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7480        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7481        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7482        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7483        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7484        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7485        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7486        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7487        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7488        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7489        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7490        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7491        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7492        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7493        16  FO-APP-CERT-USE-CD       PIC X(01).
  7494
  7495    12  FILLER                       PIC X(29).
  7496
  7497    12  FO-FORM-PLAN-TABLE.
  7498        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7499            20  FO-PLAN-TYPE         PIC X(01).
  7500            20  FO-PLAN-ID           PIC X(02).
  7501            20  FO-PLAN-TERM         PIC 9(03).
  7502            20  FO-PLAN-REFUND-METHOD
  7503                                     PIC X.
  7504
  7505    12  FILLER                       PIC X(30).
  7506
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 139
* EL050.cbl
  7507    12  FO-COMMENTS-AREA.
  7508        16  FO-COMMENT-LINE-1        PIC X(78).
  7509
  7510    12  FILLER                       PIC X(20).
  7511
  7512    12  FO-MAINT-INFORMATION.
  7513        16  FO-LAST-MAINT-DT         PIC X(02).
  7514        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7515        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 140
* EL050.cbl
  7517*    COPY ELCMSTR.
  7518******************************************************************
  7519*                                                                *
  7520*                            ELCMSTR.                            *
  7521*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7522*                            VMOD=2.012                          *
  7523*                                                                *
  7524*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7525*                                                                *
  7526*   FILE TYPE = VSAM,KSDS                                        *
  7527*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7528*                                                                *
  7529*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7530*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7531*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7532*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7533*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7534*                                                 RKP=75,LEN=21  *
  7535*                                                                *
  7536*   **** NOTE ****                                               *
  7537*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7538*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7539*                                                                *
  7540*   LOG = YES                                                    *
  7541*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7542******************************************************************
  7543*                   C H A N G E   L O G
  7544*
  7545* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7546*-----------------------------------------------------------------
  7547*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7548* EFFECTIVE    NUMBER
  7549*-----------------------------------------------------------------
  7550* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7551* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7552* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7553* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7554* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7555* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7556******************************************************************
  7557 01  CLAIM-MASTER.
  7558     12  CL-RECORD-ID                PIC XX.
  7559         88  VALID-CL-ID         VALUE 'CL'.
  7560
  7561     12  CL-CONTROL-PRIMARY.
  7562         16  CL-COMPANY-CD           PIC X.
  7563         16  CL-CARRIER              PIC X.
  7564         16  CL-CLAIM-NO             PIC X(7).
  7565         16  CL-CERT-NO.
  7566             20  CL-CERT-PRIME       PIC X(10).
  7567             20  CL-CERT-SFX         PIC X.
  7568
  7569     12  CL-CONTROL-BY-NAME.
  7570         16  CL-COMPANY-CD-A1        PIC X.
  7571         16  CL-INSURED-LAST-NAME    PIC X(15).
  7572         16  CL-INSURED-NAME.
  7573             20  CL-INSURED-1ST-NAME PIC X(12).
  7574             20  CL-INSURED-MID-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 141
* EL050.cbl
  7575
  7576     12  CL-CONTROL-BY-SSN.
  7577         16  CL-COMPANY-CD-A2        PIC X.
  7578         16  CL-SOC-SEC-NO.
  7579             20  CL-SSN-STATE        PIC XX.
  7580             20  CL-SSN-ACCOUNT      PIC X(6).
  7581             20  CL-SSN-LN3          PIC X(3).
  7582
  7583     12  CL-CONTROL-BY-CERT-NO.
  7584         16  CL-COMPANY-CD-A4        PIC X.
  7585         16  CL-CERT-NO-A4.
  7586             20  CL-CERT-A4-PRIME    PIC X(10).
  7587             20  CL-CERT-A4-SFX      PIC X.
  7588
  7589     12  CL-CONTROL-BY-CCN.
  7590         16  CL-COMPANY-CD-A5        PIC X.
  7591         16  CL-CCN-A5.
  7592             20  CL-CCN.
  7593                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7594                 24  CL-CCN-PRIME-A5 PIC X(12).
  7595             20  CL-CCN-FILLER-A5    PIC X(4).
  7596
  7597     12  CL-INSURED-PROFILE-DATA.
  7598         16  CL-INSURED-BIRTH-DT     PIC XX.
  7599         16  CL-INSURED-SEX-CD       PIC X.
  7600             88  INSURED-IS-MALE        VALUE 'M'.
  7601             88  INSURED-IS-FEMALE      VALUE 'F'.
  7602             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7603         16  CL-INSURED-OCC-CD       PIC X(6).
  7604         16  FILLER                  PIC X(5).
  7605
  7606     12  CL-PROCESSING-INFO.
  7607         16  CL-PROCESSOR-ID         PIC X(4).
  7608         16  CL-CLAIM-STATUS         PIC X.
  7609             88  CLAIM-IS-OPEN          VALUE 'O'.
  7610             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7611         16  CL-CLAIM-TYPE           PIC X.
  7612*            88  AH-CLAIM               VALUE 'A'.
  7613*            88  LIFE-CLAIM             VALUE 'L'.
  7614*            88  PROPERTY-CLAIM         VALUE 'P'.
  7615*            88  IUI-CLAIM              VALUE 'I'.
  7616*            88  GAP-CLAIM              VALUE 'G'.
  7617*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7618         16  CL-CLAIM-PREM-TYPE      PIC X.
  7619             88  SINGLE-PREMIUM         VALUE '1'.
  7620             88  O-B-COVERAGE           VALUE '2'.
  7621             88  OPEN-END-COVERAGE      VALUE '3'.
  7622         16  CL-INCURRED-DT          PIC XX.
  7623         16  CL-REPORTED-DT          PIC XX.
  7624         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7625         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7626         16  CL-LAST-PMT-DT          PIC XX.
  7627         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7628         16  CL-PAID-THRU-DT         PIC XX.
  7629         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7630         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7631         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7632         16  CL-PMT-CALC-METHOD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 142
* EL050.cbl
  7633             88  CL-360-DAY-YR          VALUE '1'.
  7634             88  CL-365-DAY-YR          VALUE '2'.
  7635             88  CL-FULL-MONTHS         VALUE '3'.
  7636         16  CL-CAUSE-CD             PIC X(6).
  7637
  7638         16  CL-PRIME-CERT-NO.
  7639             20  CL-PRIME-CERT-PRIME PIC X(10).
  7640             20  CL-PRIME-CERT-SFX   PIC X.
  7641
  7642         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7643             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7644             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7645
  7646         16  CL-MICROFILM-NO         PIC X(10).
  7647         16  FILLER REDEFINES CL-MICROFILM-NO.
  7648             20  CL-BENEFIT-PERIOD   PIC 99.
  7649             20  FILLER              PIC X(8).
  7650         16  CL-PROG-FORM-TYPE       PIC X.
  7651         16  CL-LAST-ADD-ON-DT       PIC XX.
  7652
  7653         16  CL-LAST-REOPEN-DT       PIC XX.
  7654         16  CL-LAST-CLOSE-DT        PIC XX.
  7655         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7656             88  FINAL-PAID             VALUE '1'.
  7657             88  CLAIM-DENIED           VALUE '2'.
  7658             88  AUTO-CLOSE             VALUE '3'.
  7659             88  MANUAL-CLOSE           VALUE '4'.
  7660             88  BENEFITS-CHANGED       VALUE 'C'.
  7661             88  SETUP-ERRORS           VALUE 'E'.
  7662         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7663         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7664         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7665             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7666         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7667         16  FILLER                  PIC X.
  7668
  7669     12  CL-CERTIFICATE-DATA.
  7670         16  CL-CERT-ORIGIN          PIC X.
  7671             88  CERT-WAS-ONLINE        VALUE '1'.
  7672             88  CERT-WAS-CREATED       VALUE '2'.
  7673             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7674         16  CL-CERT-KEY-DATA.
  7675             20  CL-CERT-CARRIER     PIC X.
  7676             20  CL-CERT-GROUPING    PIC X(6).
  7677             20  CL-CERT-STATE       PIC XX.
  7678             20  CL-CERT-ACCOUNT.
  7679                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7680                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7681             20  CL-CERT-EFF-DT      PIC XX.
  7682
  7683     12  CL-STATUS-CONTROLS.
  7684         16  CL-PRIORITY-CD          PIC X.
  7685             88  CONFIDENTIAL-DATA      VALUE '8'.
  7686             88  HIGHEST-PRIORITY       VALUE '9'.
  7687         16  CL-SUPV-ATTN-CD         PIC X.
  7688             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7689             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7690         16  CL-PURGED-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 143
* EL050.cbl
  7691         16  CL-RESTORED-DT          PIC XX.
  7692         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7693         16  CL-NEXT-RESEND-DT       PIC XX.
  7694         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7695         16  CL-CRITICAL-PERIOD      PIC 99.
  7696*        16  FILLER                  PIC XX.
  7697         16  CL-LAST-MAINT-DT        PIC XX.
  7698         16  CL-LAST-MAINT-USER      PIC X(4).
  7699         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7700         16  CL-LAST-MAINT-TYPE      PIC X.
  7701             88  CLAIM-SET-UP           VALUE ' '.
  7702             88  PAYMENT-MADE           VALUE '1'.
  7703             88  LETTER-SENT            VALUE '2'.
  7704             88  MASTER-WAS-ALTERED     VALUE '3'.
  7705             88  MASTER-WAS-RESTORED    VALUE '4'.
  7706             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7707             88  FILE-CONVERTED         VALUE '6'.
  7708             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7709             88  ERROR-CORRECTION       VALUE 'E'.
  7710         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7711         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7712         16  CL-BENEFICIARY          PIC X(10).
  7713         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7714         16  CL-DENIAL-TYPE          PIC X.
  7715             88  CL-TYPE-DENIAL          VALUE '1'.
  7716             88  CL-TYPE-RESCISSION      VALUE '2'.
  7717             88  CL-TYPE-REFORMATION     VALUE '3'.
  7718             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7719             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7720         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7721         16  filler                  pic x(3).
  7722*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7723*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7724*        16  CL-RTW-DT               PIC XX.
  7725
  7726     12  CL-TRAILER-CONTROLS.
  7727         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7728             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7729             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7730             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7731         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7732         16  FILLER                  PIC XX.
  7733         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7734         16  CL-ADDRESS-TRAILER-CNT.
  7735             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7736                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7737             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7738                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7739             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7740                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7741             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7742                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7743             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7744                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7745             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7746                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7747             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7748                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 144
* EL050.cbl
  7749
  7750     12  CL-CV-REFERENCE-NO.
  7751         16  CL-CV-REFNO-PRIME       PIC X(18).
  7752         16  CL-CV-REFNO-SFX         PIC XX.
  7753
  7754     12  CL-FILE-LOCATION            PIC X(4).
  7755
  7756     12  CL-PROCESS-ERRORS.
  7757         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7758             88  NO-FATAL-ERRORS        VALUE ZERO.
  7759         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7760             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7761
  7762     12  CL-PRODUCT-CD               PIC X.
  7763
  7764     12  CL-CURRENT-KEY-DATA.
  7765         16  CL-CURRENT-CARRIER      PIC X.
  7766         16  CL-CURRENT-GROUPING     PIC X(6).
  7767         16  CL-CURRENT-STATE        PIC XX.
  7768         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7769
  7770     12  CL-ASSOCIATES               PIC X.
  7771         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7772         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7773         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7774         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7775
  7776     12  CL-ACTIVITY-CODE            PIC 99.
  7777     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7778     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7779
  7780     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7781     12  CL-LAG-REPORT-CODE          PIC 9.
  7782     12  CL-LOAN-TYPE                PIC XX.
  7783     12  CL-LEGAL-STATE              PIC XX.
  7784
  7785     12  CL-YESNOSW                  PIC X.
  7786     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7787         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7788         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7789         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7790     12  cl-insured-type             pic x.
  7791         88  cl-claim-on-primary         value 'P'.
  7792         88  cl-claim-on-co-borrower     value 'C'.
  7793     12  cl-benefit-expiration-dt    PIC XX.
  7794
  7795 01  PLAN-RECORDS.
  7796     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7797     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7798
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 145
* EL050.cbl
  7800 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7801                          ACCOUNT-MASTER REINSURANCE-RECORD
  7802                          COMM-TABLE-RECORD FORM-MASTER
  7803                          CLAIM-MASTER PLAN-RECORDS.
  7804 0000-DFHEXIT SECTION.
  7805     MOVE '9#                    $   ' TO DFHEIV0.
  7806     MOVE 'EL050' TO DFHEIV1.
  7807     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7808
  7809     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7810
  7811
  7812* EXEC CICS  HANDLE CONDITION
  7813*           ERROR    (9300-ABEND)
  7814*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7815*    END-EXEC.
  7816*    MOVE '"$.J                  ! " #00007807' TO DFHEIV0
  7817     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7818     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7819     MOVE X'2220233030303037383037' TO DFHEIV0(25:11)
  7820     CALL 'kxdfhei1' USING DFHEIV0
  7821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7822
  7823
  7824 0000-COPY-PROCEDURE-DIV.
  7825*                          COPY ELC50PD.
  7826******************************************************************
  7827*                                                                *
  7828*                            ELC50PD                             *
  7829*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7830*                            VMOD=2.188                          *
  7831*                                                                *
  7832******************************************************************
  7833*                   C H A N G E   L O G
  7834*
  7835* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7836*-----------------------------------------------------------------
  7837*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7838* EFFECTIVE    NUMBER
  7839*-----------------------------------------------------------------
  7840* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7841* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7842* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7843*                             2709 AND 2718
  7844* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7845* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7846* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7847* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7848* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7849*                                IS OPEN OR CNC DT < PD THRU
  7850* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7851* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7852* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7853* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7854* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7855* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7856* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7857* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 146
* EL050.cbl
  7858* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7859* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7860* 020906                   PEMA  EXPAND LOAN OFFICER
  7861* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7862* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7863* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7864* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7865* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7866* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7867* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7868* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7869* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7870* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7871* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7872* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7873* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7874* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7875* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7876* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7877* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7878* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7879* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7880* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7881* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7882* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7883* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7884* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7885* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7886*                                UPDATE VIN ON CERT TRAILER
  7887* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7888* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7889* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7890* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7891* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7892* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7893* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7894* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7895* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7896* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7897* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7898* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7899* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7900* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7901* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7902* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7903* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7904* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7905* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7906* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7907* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7908* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7909* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7910* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7911* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7912* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7913* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7914* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7915* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 147
* EL050.cbl
  7916* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7917* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7918* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7919* 032912  CR2011110200001  PEMA  AHL CHANGES
  7920* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7921* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7922* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7923* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7924* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7925* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7926* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7927* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7928* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7929* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7930* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7931* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7932* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7933* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7934* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7935* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7936* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7937* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7938* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7939* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7940* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7941* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7942* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7943* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7944* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7945* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7946* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7947*                                CERT #, ADD 2898 FORCIBLE ERROR
  7948* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7949* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7950* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7951* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7952* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7953* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7954* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7955* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7956* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7957* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7958* 052516  IR2016052400001  PEMA  Correct malformed IF stmt.
  7959* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
  7960* 052317  IR2017052300001  PEMA  Correct malformed conditional stm
  7961* 062717  IR2017061900003  PEMA  Fix 0% APR on refunds
  7962* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7963* 100617  CR2017062000003  PEMA  New comm cap edits
  7964* 121117  IR2017121100002  PEMA  INITIALIZE NEW COMM CAP FIELDS.
  7965* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
  7966* 011718  IR2018011200001  PEMA  CORRECT ROA EXTENSION DAYS ISSUE
  7967* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
  7968* 030118  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  7969* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
  7970* 070218  IR2018062700001  PEMA  Fix edit for spaces in certno
  7971* 092118  CR2018073000001  PEMA  Add lf & ah refund method to ELCR
  7972******************************************************************
  7973************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 148
* EL050.cbl
  7974******************************************************************
  7975
  7976     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7977
  7978     MOVE SPACES                 TO PB-FATAL-FLAG
  7979                                    PB-FORCE-ER-CD
  7980                                    PB-WARN-ER-CD
  7981                                    PB-OUT-BAL-CD.
  7982
  7983     MOVE SPACE                  TO WS-IG-OVRD-AH
  7984                                    WS-IG-OVRD-LF
  7985                                    WS-IG-OVRD-AM
  7986                                    WS-IG-OVRD
  7987                                    WS-IG-OVRD-AH-PL
  7988                                    WS-IG-OVRD-LF-PL
  7989                                    WS-IG-OVRD-AH-BEN
  7990                                    WS-IG-OVRD-LF-BEN.
  7991
  7992******************************************************************
  7993*************       INITIALIZE COMMON ERRORS       ***************
  7994******************************************************************
  7995
  7996     MOVE +0                     TO PB-NO-OF-ERRORS.
  7997     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7998
  7999******************************************************************
  8000
  8001     MOVE EIBDATE                TO DC-JULIAN-DATE.
  8002     SET JULIAN-TO-BIN           TO TRUE.
  8003*    MOVE 5                      TO DC-OPTION-CODE.
  8004     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8005     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  8006
  8007     MOVE ZERO                   TO  SUB4.
  8008
  8009 0040-INITIALIZE-GA-BILL-DT.
  8010
  8011     ADD +1                      TO  SUB4.
  8012
  8013     IF  SUB4 GREATER THAN +5
  8014         GO TO 0050-CHECK-CNTL-FOUND.
  8015
  8016     IF  PB-GA-BILL-DT (SUB4) = SPACES
  8017         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  8018
  8019     GO TO 0040-INITIALIZE-GA-BILL-DT.
  8020
  8021 0050-CHECK-CNTL-FOUND.
  8022
  8023     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  8024        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  8025                                         WS-AH-REM-TERM-CALC
  8026                                         EC-CO-REM-TERM-CALC
  8027        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  8028        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  8029        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  8030                                         WS-TOL-AH-CLAIM
  8031        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 149
* EL050.cbl
  8032                                         WS-TOL-AH-PREM
  8033                                         EC-CO-TOL-PREM
  8034        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  8035                                         WS-TOL-AH-REFUND
  8036                                         EC-CO-TOL-REFUND
  8037        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  8038                                         WS-AH-REFUND-OVS-AMT
  8039                                         EC-CO-OVR-SHT-AMT
  8040        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  8041                                         WS-TOL-AH-PREM-PCT
  8042                                         EC-CO-TOL-PREM-PCT
  8043        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  8044                                         WS-TOL-AH-REFUND-PCT
  8045                                         EC-CO-TOL-REFUND-PCT
  8046        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  8047                                         WS-AH-REFUND-OVS-PCT
  8048                                         EC-CO-OVR-SHT-PCT
  8049        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  8050        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  8051        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  8052        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  8053        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  8054        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  8055        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  8056        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  8057        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  8058        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  8059        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  8060        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  8061                                         EC-CO-MONTH-END-DT
  8062        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  8063          GO TO 0100-READ-ACCT.
  8064
  8065     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8066     MOVE SPACES                 TO CNTL-ACCESS.
  8067     MOVE '1'                    TO CNTL-REC-TYPE.
  8068     MOVE +0                     TO CNTL-SEQ-NO.
  8069
  8070     MOVE '1' TO RC-SW-1.
  8071     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  8072     IF NOT CF-COMPANY-MASTER
  8073         MOVE ZEROS             TO WK-CO-TOL-PREM
  8074                                   WK-CO-TOL-CLAIM
  8075                                   WK-CO-TOL-REFUND
  8076                                   WK-REFUND-OVS-AMT
  8077                                   WK-REFUND-OVS-PCT
  8078                                   WK-CO-TOL-PREM-PCT
  8079                                   WK-CO-TOL-REFUND-PCT
  8080                                   WK-DEFAULT-APR
  8081                                   WK-CO-MAX-CAP
  8082        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  8083                                   WK-CR-R78-METHOD
  8084                                   WK-CO-REF-REJECT-SW
  8085                                   WK-CO-PREM-REJECT-SW
  8086                                   WK-REM-TRM-CALC-OPTION
  8087                                   WK-BIRTH-DATE-INPUT
  8088                                   WK-JOINT-AGE-INPUT
  8089        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 150
* EL050.cbl
  8090        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  8091        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  8092        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  8093          GO TO 0099-COMPANY-NOT-FOUND.
  8094
  8095     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  8096        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  8097     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  8098        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  8099     IF CF-CO-TOL-CAP NOT NUMERIC
  8100        MOVE +0                    TO CF-CO-TOL-CAP.
  8101     IF CF-DEFAULT-APR NOT NUMERIC
  8102        MOVE +0                    TO CF-DEFAULT-APR.
  8103
  8104     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  8105     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  8106     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  8107     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  8108     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  8109     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  8110     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  8111     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  8112     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  8113     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  8114     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  8115     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  8116
  8117     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  8118          CF-CO-OVR-SHT-AMT > +0
  8119        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  8120
  8121     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  8122          CF-CO-OVR-SHT-PCT > +0
  8123        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  8124
  8125     IF CF-VALID-REM-TRM-OPTION
  8126         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  8127     ELSE
  8128         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  8129
  8130     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  8131     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  8132     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  8133     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  8134
  8135     GO TO 0050-CHECK-CNTL-FOUND.
  8136
  8137 0099-COMPANY-NOT-FOUND.
  8138
  8139     MOVE ER-2616                TO WS-ERROR.
  8140     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8141
  8142 0100-READ-ACCT.
  8143
  8144     MOVE SPACES                 TO DATE-RANGE-SW.
  8145
  8146     IF WK-ACCT-ADDR = ZEROS
  8147        GO TO 0102-ACCT-GETMAIN.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 151
* EL050.cbl
  8148
  8149     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  8150     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  8151     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8152
  8153     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8154        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8155        GO TO 0105-READ-ACCT
  8156     END-IF
  8157
  8158     IF PB-CARRIER NOT = SPACES
  8159        IF PB-CARRIER NOT = AM-VG-CARRIER
  8160           GO TO 0105-READ-ACCT.
  8161
  8162     IF PB-STATE NOT = SPACES
  8163        IF PB-STATE NOT = AM-VG-STATE
  8164           GO TO 0105-READ-ACCT.
  8165
  8166     IF PB-GROUPING NOT = SPACES
  8167        IF PB-GROUPING NOT = AM-VG-GROUPING
  8168           GO TO 0105-READ-ACCT.
  8169
  8170     MOVE 'X'                 TO DATE-RANGE-SW.
  8171
  8172     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8173        MOVE 'X'                 TO DATE-RANGE-SW
  8174        GO TO 0105-READ-ACCT.
  8175
  8176     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8177        GO TO 0105-READ-ACCT.
  8178
  8179     GO TO 0180-ACCOUNT-FOUND.
  8180
  8181 0102-ACCT-GETMAIN.
  8182     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8183     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8184
  8185 0105-READ-ACCT.
  8186     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8187     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8188     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8189     MOVE PB-STATE               TO ACCT-STATE.
  8190     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8191     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8192
  8193     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8194
  8195     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8196
  8197 0110-FIND-ACCT-TOLERANCES-LOOP.
  8198     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8199
  8200     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8201        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8202        GO TO 0199-ACCT-NOT-FOUND
  8203     END-IF
  8204     IF PB-CARRIER NOT = SPACES
  8205        IF PB-CARRIER NOT = AM-VG-CARRIER
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 152
* EL050.cbl
  8206           GO TO 0199-ACCT-NOT-FOUND.
  8207
  8208     IF PB-STATE NOT = SPACES
  8209        IF PB-STATE NOT = AM-VG-STATE
  8210           GO TO 0199-ACCT-NOT-FOUND.
  8211
  8212     IF PB-GROUPING NOT = SPACES
  8213        IF PB-GROUPING NOT = AM-VG-GROUPING
  8214           GO TO 0199-ACCT-NOT-FOUND.
  8215
  8216     MOVE 'X'                    TO DATE-RANGE-SW.
  8217
  8218     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8219        MOVE 'X'                 TO DATE-RANGE-SW
  8220        GO TO 0199-ACCT-NOT-FOUND.
  8221
  8222     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8223        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8224
  8225 0180-ACCOUNT-FOUND.
  8226     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8227     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8228     MOVE AM-STATE               TO PB-SV-STATE.
  8229     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8230
  8231     IF AM-CANCEL-FEE  NOT NUMERIC
  8232        MOVE ZEROS TO AM-CANCEL-FEE.
  8233
  8234     IF AM-MAX-MON-BEN NOT NUMERIC
  8235        MOVE ZEROS TO AM-MAX-MON-BEN.
  8236
  8237     IF AM-MAX-TOT-BEN NOT NUMERIC
  8238        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8239
  8240     IF AM-CLP-TOL-PCT NOT NUMERIC
  8241        MOVE +0                  TO AM-CLP-TOL-PCT
  8242     END-IF
  8243     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8244        MOVE +0                  TO AM-SPP-LEASE-COMM
  8245     END-IF
  8246     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8247        MOVE ER-2611             TO   WS-ERROR
  8248        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8249
  8250     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8251        MOVE ER-2621             TO   WS-ERROR
  8252        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8253
  8254     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8255        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8256        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8257        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8258         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8259
  8260     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8261     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8262     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8263     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 153
* EL050.cbl
  8264     IF AM-CLP-TOL-PCT NOT = ZEROS
  8265        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8266     END-IF
  8267     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8268        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8269     END-IF
  8270*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8271*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8272*                                   WS-ADMIN-FEES
  8273*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8274*          (SUB5 > +10)
  8275*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8276*             AND (AM-A-COM (SUB5) NUMERIC)
  8277*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8278*                + (AM-A-COM (SUB5) * 1000)
  8279*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8280*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8281*                + (AM-A-COM (SUB5) * 1000)
  8282*             END-IF
  8283*             IF AM-COM-TYP (SUB5) = 'N'
  8284*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8285*                + (AM-A-COM (SUB5) * 1000)
  8286*             END-IF
  8287*          END-IF
  8288*       END-PERFORM
  8289*    END-IF
  8290     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8291        AND (PB-ISSUE)
  8292        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8293                                    ws-cred-union-fees
  8294        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8295           (SUB5 > +10)
  8296           MOVE +0 TO WS-WK-RATE
  8297           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8298                                   'O' OR 'S')
  8299              IF (AM-A-COM (SUB5) NUMERIC)
  8300                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8301                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8302              ELSE
  8303                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8304                 IF PB-ISSUE
  8305                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8306                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8307                 ELSE
  8308                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8309                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8310                 END-IF
  8311                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8312                 MOVE ZEROS             TO WS-SUB1
  8313                                           WS-COMMISSION
  8314                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8315                 MOVE '0530'               TO CTBL-SW
  8316                 MOVE ' '                  TO WS-CTBL-READ-SW
  8317                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8318                 IF FIRST-TIME-THROUGH
  8319                    MOVE 'AA'              TO CTBL-BEN-CODE
  8320                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8321                 END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 154
* EL050.cbl
  8322                 IF CTBL-TABLE-FOUND
  8323                    IF PB-ISSUE
  8324                       COMPUTE WS-COMM-CK-AMT =
  8325                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8326                    ELSE
  8327                       COMPUTE WS-COMM-CK-AMT =
  8328                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8329                    END-IF
  8330                    PERFORM 8800-GET-COMP-RATE
  8331                              THRU 8800-EXIT
  8332                 END-IF
  8333              END-IF
  8334              if am-com-typ (sub5) = 'O' or 'S'
  8335                 compute ws-cred-union-fees rounded =
  8336                    ws-cred-union-fees +
  8337                    (pb-i-ah-premium-amt * ws-wk-rate)
  8338              else
  8339                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8340                + (WS-WK-RATE * 1000)
  8341              end-if
  8342           END-IF
  8343        END-PERFORM
  8344     END-IF
  8345     IF PB-COMPANY-ID EQUAL 'CRI'
  8346         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8347
  8348     IF PB-COMPANY-ID EQUAL 'NCL'
  8349         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8350     END-IF
  8351
  8352     GO TO 0200-READ-CERT.
  8353
  8354 0199-ACCT-NOT-FOUND.
  8355
  8356     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8357
  8358     IF DATE-RANGE-SW NOT = SPACES
  8359        MOVE ER-2601             TO WS-ERROR
  8360        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8361     ELSE
  8362        MOVE ER-2619             TO WS-ERROR
  8363        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8364
  8365     GO TO 9990-RETURN.
  8366
  8367 0200-READ-CERT.
  8368
  8369     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8370     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8371     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8372     MOVE PB-SV-STATE            TO CERT-STATE.
  8373     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8374     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8375     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8376
  8377     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8378
  8379     IF CERT-WAS-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 155
* EL050.cbl
  8380        GO TO 0299-CERT-NOT-FOUND.
  8381
  8382     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8383        MOVE ER-2759             TO WS-ERROR
  8384        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8385        GO TO 0298-UNLOCK-RETURN.
  8386
  8387     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8388         MOVE ER-2758            TO WS-ERROR
  8389         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8390         GO TO 0298-UNLOCK-RETURN.
  8391
  8392     IF PB-ISSUE
  8393        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8394           IF CERT-WAS-CREATED-FOR-CLAIM
  8395              NEXT SENTENCE
  8396            ELSE
  8397              MOVE ER-2626       TO WS-ERROR
  8398              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8399              GO TO 0298-UNLOCK-RETURN.
  8400
  8401     IF NOT PB-CANCELLATION
  8402        GO TO 0300-CONTINUE-EDIT.
  8403
  8404     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8405     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8406     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8407     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8408     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8409     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8410
  8411     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8412     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8413     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8414     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8415     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8416     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8417     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8418     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8419     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8420
  8421     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8422     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8423     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8424     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8425     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8426     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8427     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8428
  8429     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8430     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8431
  8432     MOVE CM-CREDIT-INTERFACE-SW-1
  8433                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8434     MOVE CM-CREDIT-INTERFACE-SW-2
  8435                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8436
  8437     IF CM-O-B-COVERAGE
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 156
* EL050.cbl
  8438         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8439
  8440     IF CM-LIVES NOT NUMERIC
  8441         MOVE ZERO                TO CM-LIVES.
  8442
  8443     IF CM-BILLED NOT NUMERIC
  8444         MOVE ZERO                TO CM-BILLED.
  8445
  8446     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8447         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8448         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8449         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8450         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8451         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8452         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8453         MOVE CM-LIVES             TO PB-CI-LIVES
  8454*The next line causes a problem with my change  I dont think it is
  8455*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8456
  8457     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8458     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8459     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8460     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8461     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8462     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8463
  8464     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8465     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8466     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8467     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8468
  8469     IF CM-LIFE-COMM-PCT NUMERIC
  8470         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8471     ELSE
  8472         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8473
  8474     IF CM-AH-COMM-PCT NUMERIC
  8475         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8476     ELSE
  8477         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8478
  8479     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8480
  8481     IF CM-LOAN-APR       NOT NUMERIC
  8482           MOVE ZERO               TO CM-LOAN-APR.
  8483
  8484     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8485           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8486
  8487     IF CM-LOAN-TERM      NOT NUMERIC
  8488           MOVE ZERO               TO CM-LOAN-TERM.
  8489
  8490     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8491           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8492
  8493     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8494           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8495
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 157
* EL050.cbl
  8496     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8497     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8498     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8499     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8500     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8501     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8502     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8503     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8504     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8505     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8506     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8507     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8508     MOVE CM-BENEFICIARY           TO PB-CI-BENEFICIARY-NAME
  8509
  8510     IF CM-STATE = CM-SSN-STATE
  8511         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8512
  8513     IF CM-STATE NOT = CM-MEMB-STATE
  8514         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8515
  8516     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8517
  8518     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8519*       MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8520        IF CM-ADDL-CLP NOT NUMERIC
  8521           MOVE +0               TO CM-ADDL-CLP
  8522        END-IF
  8523        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8524        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8525           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8526        END-IF
  8527     END-IF
  8528     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8529        MOVE +0                  TO WS-ADMIN-FEES
  8530                                    WS-CSO-ADMIN-FEE
  8531                                    WS-COMM-AND-MFEE
  8532                                    WS-1ST-YR-ALLOW
  8533        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8534           (SUB5 > +10)
  8535           MOVE +0 TO WS-WK-RATE
  8536           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8537              IF (AM-A-COM (SUB5) NUMERIC)
  8538                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8539                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8540              ELSE
  8541                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8542                 IF PB-ISSUE
  8543                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8544                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8545                 ELSE
  8546                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8547                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8548                 END-IF
  8549                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8550                 MOVE ZEROS             TO WS-SUB1
  8551                                           WS-COMMISSION
  8552                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8553                 MOVE '0530'               TO CTBL-SW
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 158
* EL050.cbl
  8554                 MOVE ' '                  TO WS-CTBL-READ-SW
  8555                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8556                 IF FIRST-TIME-THROUGH
  8557                    MOVE 'AA'              TO CTBL-BEN-CODE
  8558                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8559                 END-IF
  8560                 IF CTBL-TABLE-FOUND
  8561                    IF PB-ISSUE
  8562                       COMPUTE WS-COMM-CK-AMT =
  8563                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8564                    ELSE
  8565                       COMPUTE WS-COMM-CK-AMT =
  8566                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8567                    END-IF
  8568                    PERFORM 8800-GET-COMP-RATE
  8569                              THRU 8800-EXIT
  8570                 END-IF
  8571              END-IF
  8572              IF AM-COM-TYP (SUB5) = 'I'
  8573                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8574                   + (WS-WK-RATE * 1000)
  8575              END-IF
  8576              IF AM-COM-TYP (SUB5) = 'N'
  8577                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8578                   + (WS-WK-RATE * 1000)
  8579              END-IF
  8580              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8581                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8582                   + (WS-WK-RATE * 1000)
  8583              END-IF
  8584              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8585                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8586                   + (WS-WK-RATE * 1000)
  8587              END-IF
  8588           END-IF
  8589        END-PERFORM
  8590     END-IF
  8591     GO TO 0300-CONTINUE-EDIT.
  8592
  8593 0298-UNLOCK-RETURN.
  8594      PERFORM 9250-UNLOCK-RETURN
  8595      GO TO 9990-RETURN.
  8596
  8597 0299-CERT-NOT-FOUND.
  8598
  8599     MOVE '1'                     TO CERT-STATUS-SW.
  8600
  8601     IF PB-COMPANY-ID = 'UCL'
  8602         IF WS-ERROR = ER-2799
  8603             GO TO 3000-CONTINUE-EDIT.
  8604
  8605     IF NOT PB-CANCELLATION
  8606         GO TO 0300-CONTINUE-EDIT.
  8607
  8608     MOVE ER-2726                  TO  WS-ERROR.
  8609     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8610     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8611     MOVE ZEROS                  TO PB-CI-INSURED-AGE
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 159
* EL050.cbl
  8612                                    PB-CI-LF-TERM
  8613                                    PB-C-LF-REM-TERM
  8614                                    PB-CI-AH-TERM
  8615                                    PB-C-AH-REM-TERM
  8616                                    PB-CI-LF-BENEFIT-CD
  8617                                    PB-CI-LF-BENEFIT-AMT
  8618                                    PB-CI-LF-ALT-BENEFIT-AMT
  8619                                    PB-CI-LF-PREMIUM-AMT
  8620                                    PB-CI-LF-ALT-PREMIUM-AMT
  8621                                    PB-CI-AH-BENEFIT-CD
  8622                                    PB-CI-AH-BENEFIT-AMT
  8623                                    PB-CI-AH-PREMIUM-AMT
  8624                                    PB-CI-PAY-FREQUENCY
  8625                                    PB-CI-LOAN-APR
  8626                                    PB-CI-LOAN-TERM
  8627                                    PB-CI-LIFE-COMMISSION
  8628                                    PB-CI-AH-COMMISSION
  8629                                    PB-CI-CURR-SEQ
  8630                                    PB-CI-AH-CANCEL-AMT
  8631                                    PB-CI-LF-CANCEL-AMT
  8632                                    PB-CI-RATE-DEV-PCT-LF
  8633                                    PB-CI-RATE-DEV-PCT-AH
  8634                                    PB-CI-EXTENTION-DAYS
  8635                                    PB-CI-TERM-IN-DAYS
  8636                                    PB-CI-LIVES
  8637                                    PB-CI-LF-CRIT-PER
  8638                                    PB-CI-AH-CRIT-PER
  8639                                    PB-CI-ADDL-CLP
  8640                                    PB-CI-DDF-IU-RATE-UP.
  8641
  8642     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8643                                    PB-CI-AH-SETTLEMENT-DT
  8644                                    PB-CI-DEATH-DT
  8645                                    PB-CI-LF-PRIOR-CANCEL-DT
  8646                                    PB-CI-AH-PRIOR-CANCEL-DT
  8647                                    PB-CI-ENTRY-DT
  8648                                    PB-CI-LF-EXPIRE-DT
  8649                                    PB-CI-AH-EXPIRE-DT
  8650                                    PB-CI-LOAN-1ST-PMT-DT.
  8651
  8652     IF ACCOUNT-MAST-FOUND
  8653        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8654        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8655
  8656
  8657 0300-CONTINUE-EDIT.
  8658
  8659     IF PB-ISSUE
  8660        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8661            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8662
  8663     IF PB-ISSUE
  8664        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8665            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8666
  8667     IF PB-ISSUE
  8668       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8669          (AM-NO-AH-ONLY)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 160
* EL050.cbl
  8670           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8671               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8672                   MOVE ER-2679 TO WS-ERROR
  8673                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8674
  8675     IF PB-ISSUE
  8676        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8677        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8678        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8679     ELSE
  8680        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8681        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8682        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8683
  8684     MOVE 'N'                    TO PLAN-MASTER-SW
  8685                                    PLAN-MASTER-LIFE-SW
  8686                                    FORM-MASTER-SW
  8687                                    WS-APP-CERT-SW.
  8688
  8689     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8690                                    WS-PL-TOL-LF-REFUND
  8691                                    WS-PL-REF-OVS-AMT
  8692                                    WS-PL-TOL-LF-PREM-PCT
  8693                                    WS-PL-TOL-LF-REFUND-PCT
  8694                                    WS-PL-REF-OVS-PCT
  8695                                    WS-PL-TOL-LF-CLAIM.
  8696
  8697     IF PB-COMPANY-ID = 'NCL'
  8698       IF PB-ISSUE
  8699         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8700             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8701             IF FORM-MASTER-FOUND
  8702                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8703
  8704     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8705        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8706
  8707********************** MON CODE **********************
  8708     IF PB-COMPANY-ID = 'MON'
  8709     IF PB-ISSUE
  8710     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8711        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8712             PB-I-LOAN-APR = ZERO)
  8713               MOVE 14.0         TO PB-I-LOAN-APR.
  8714******************************************************
  8715
  8716     IF PB-COMPANY-ID = 'NCL'
  8717       IF PB-ISSUE
  8718           IF FORM-MASTER-FOUND
  8719             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8720                AM-DISMBR-COVERAGE
  8721                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8722                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8723                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8724                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8725                                           PB-I-LIFE-BENEFIT-CD.
  8726
  8727     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 161
* EL050.cbl
  8728
  8729     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8730         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8731         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8732         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8733         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8734         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8735           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8736             GO TO 0301-LIFE-BENEFIT-SEARCH
  8737         ELSE
  8738             NEXT SENTENCE
  8739     ELSE
  8740         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8741
  8742     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8743     MOVE '4'                    TO CNTL-REC-TYPE.
  8744     MOVE +0                     TO CNTL-SEQ-NO.
  8745     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8746
  8747     MOVE '1' TO RC-SW-2.
  8748     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8749
  8750     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8751        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8752         GO TO 0305-BENEFIT-NOT-FOUND.
  8753
  8754     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8755
  8756 0301-LIFE-BENEFIT-SEARCH.
  8757
  8758     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8759
  8760     IF NO-BENEFIT-FOUND
  8761        GO TO 0305-BENEFIT-NOT-FOUND.
  8762
  8763     IF WS-BEN-CD = '99'
  8764        GO TO 0305-BENEFIT-NOT-FOUND.
  8765
  8766     IF PB-COMPANY-ID = 'NCL'
  8767         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8768             GO TO 0304-LIFE-BENEFIT-FOUND.
  8769
  8770     MOVE +1                     TO SUB5.
  8771     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8772
  8773* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8774* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8775     IF PB-COMPANY-ID = 'DMD'
  8776         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8777
  8778 0302-EDIT-ACCT-LF-BENEFITS.
  8779
  8780     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8781        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8782           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8783                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8784           GO TO 03XX-GET-LIFE-ERPLAN.
  8785
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 162
* EL050.cbl
  8786     IF SUB5 LESS THAN +20
  8787        ADD +1                   TO SUB5
  8788        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8789
  8790     MOVE +1                     TO SUB5.
  8791
  8792     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8793        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8794
  8795 0303-EDIT-DMD-EXTRA-BENEFITS.
  8796
  8797     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8798        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8799           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8800                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8801           GO TO 03XX-GET-LIFE-ERPLAN.
  8802
  8803     IF SUB5 LESS THAN +30
  8804        ADD +1                   TO SUB5
  8805        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8806
  8807     MOVE +1                     TO SUB5.
  8808
  8809 03XX-EDIT-FOR-NINETY-LF.
  8810
  8811***************************************************************
  8812*                                                             *
  8813*    NINETY BENEFIT PLAN TYPES:                               *
  8814*                                                             *
  8815*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8816*      92 = ALL GROUP REDUCING BENEFITS                       *
  8817*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8818*      94 = ALL GROUP LEVEL BENEFITS                          *
  8819*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8820*           BENEFIT CONTROLS.                                 *
  8821*      99 = ALL BENEFITS                                      *
  8822*                                                             *
  8823***************************************************************
  8824
  8825     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8826                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8827
  8828     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8829       AND
  8830        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8831        GO TO 03XX-GET-LIFE-ERPLAN.
  8832
  8833     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8834       AND
  8835        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8836        IF CF-REDUCING (SUB3)
  8837           IF (PB-I-INDV-GRP-OVRD = 'I')
  8838              OR
  8839           ((AM-IG = '1') AND
  8840           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8841              OR
  8842           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8843           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 163
* EL050.cbl
  8844           (AM-IG NOT = '2'))
  8845              GO TO 03XX-GET-LIFE-ERPLAN.
  8846
  8847     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8848       AND
  8849        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8850        IF CF-REDUCING (SUB3)
  8851           IF (PB-I-INDV-GRP-OVRD = 'G')
  8852              OR
  8853           ((AM-IG = '2') AND
  8854           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8855              OR
  8856           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8857           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8858           (AM-IG NOT = '1'))
  8859              GO TO 03XX-GET-LIFE-ERPLAN.
  8860
  8861     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8862       AND
  8863        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8864        IF CF-LEVEL    (SUB3)
  8865           IF (PB-I-INDV-GRP-OVRD = 'I')
  8866              OR
  8867           ((AM-IG = '1') AND
  8868           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8869              OR
  8870           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8871           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8872            (AM-IG NOT = '2'))
  8873              GO TO 03XX-GET-LIFE-ERPLAN.
  8874
  8875     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8876       AND
  8877        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8878        IF CF-LEVEL    (SUB3)
  8879           IF (PB-I-INDV-GRP-OVRD = 'G')
  8880              OR
  8881           ((AM-IG = '2') AND
  8882           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8883              OR
  8884           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8885           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8886           (AM-IG NOT = '1'))
  8887              GO TO 03XX-GET-LIFE-ERPLAN.
  8888
  8889     IF SUB5 LESS THAN +20
  8890        ADD +1                   TO SUB5
  8891        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8892
  8893     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8894
  8895     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8896        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8897
  8898     MOVE +1                     TO SUB5.
  8899
  8900 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8901
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 164
* EL050.cbl
  8902     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8903                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8904
  8905     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8906       AND
  8907        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8908        GO TO 03XX-GET-LIFE-ERPLAN.
  8909
  8910     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8911       AND
  8912        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8913        IF CF-REDUCING (SUB3)
  8914           IF (PB-I-INDV-GRP-OVRD = 'I')
  8915              OR
  8916           ((AM-IG = '1') AND
  8917           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8918              OR
  8919           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8920           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8921           (AM-IG NOT = '2'))
  8922              GO TO 03XX-GET-LIFE-ERPLAN.
  8923
  8924     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8925       AND
  8926        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8927        IF CF-REDUCING (SUB3)
  8928           IF (PB-I-INDV-GRP-OVRD = 'G')
  8929              OR
  8930           ((AM-IG = '2') AND
  8931           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8932              OR
  8933           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8934           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8935           (AM-IG NOT = '1'))
  8936              GO TO 03XX-GET-LIFE-ERPLAN.
  8937
  8938     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8939       AND
  8940        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8941        IF CF-LEVEL    (SUB3)
  8942           IF (PB-I-INDV-GRP-OVRD = 'I')
  8943              OR
  8944           ((AM-IG = '1') AND
  8945           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8946              OR
  8947           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8948           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8949            (AM-IG NOT = '2'))
  8950              GO TO 03XX-GET-LIFE-ERPLAN.
  8951
  8952     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8953       AND
  8954        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8955        IF CF-LEVEL    (SUB3)
  8956           IF (PB-I-INDV-GRP-OVRD = 'G')
  8957              OR
  8958           ((AM-IG = '2') AND
  8959           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 165
* EL050.cbl
  8960              OR
  8961           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8962           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8963           (AM-IG NOT = '1'))
  8964              GO TO 03XX-GET-LIFE-ERPLAN.
  8965
  8966     IF SUB5 LESS THAN +30
  8967        ADD +1                   TO SUB5
  8968        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8969
  8970     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8971
  8972 03XX-EDIT-FOR-NINETY-LF-CONT.
  8973
  8974     MOVE +99                    TO SUB5.
  8975
  8976     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8977        IF PB-ISSUE
  8978           MOVE ER-1924          TO  WS-ERROR
  8979           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8980
  8981     GO TO 0304-LIFE-BENEFIT-FOUND.
  8982
  8983 03XX-GET-LIFE-ERPLAN.
  8984
  8985     IF WK-PLAN-ADDR EQUAL +0
  8986        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8987
  8988     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8989     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8990     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8991     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8992     MOVE 'Y'                    TO PLAN-MASTER-SW
  8993                                    PLAN-MASTER-LIFE-SW.
  8994     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8995
  8996 03XX-ERPLAN-LIFE-GETMAIN.
  8997
  8998     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8999     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9000
  9001 03XX-ERPLAN-LIFE-READ.
  9002
  9003     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9004     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9005     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9006     MOVE PB-SV-STATE            TO PLAN-STATE.
  9007     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9008     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  9009     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9010     MOVE WS-SAVE-BENEFIT-REVISION
  9011                                 TO PLAN-REVISION-NO.
  9012
  9013     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9014     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  9015
  9016     IF PB-COMPANY-ID = 'NCL'
  9017       IF NOT LF-PLAN-MASTER-FOUND
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 166
* EL050.cbl
  9018         IF NOT PB-POLICY-IS-DECLINED  AND
  9019            NOT PB-POLICY-IS-VOIDED
  9020             MOVE  ER-1921         TO  WS-ERROR
  9021             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9022             GO TO 0304-LIFE-BENEFIT-FOUND.
  9023
  9024     IF NOT LF-PLAN-MASTER-FOUND
  9025        GO TO 0304-LIFE-BENEFIT-FOUND.
  9026
  9027 XXXX-CHECK-LF-PLAN-KEY.
  9028
  9029     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9030        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9031        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9032        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9033        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9034        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9035        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9036        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9037        MOVE 'N'                 TO PLAN-MASTER-SW
  9038          GO TO 03XX-ERPLAN-LIFE-READ.
  9039
  9040     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  9041
  9042     IF  PB-CANCELLATION
  9043         GO TO  0303-LF-ACCT-BEN-FOUND.
  9044
  9045     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9046        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9047           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9048           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9049              MOVE ER-2644             TO WS-ERROR
  9050              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9051           ELSE
  9052              NEXT SENTENCE
  9053        ELSE
  9054           IF PB-COMPANY-ID NOT = 'NCL'
  9055              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9056                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9057
  9058 0303-LF-ACCT-BEN-FOUND.
  9059
  9060     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  9061
  9062     IF PL-DEV-CODE NOT = SPACES
  9063        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  9064
  9065     IF PL-DEV-PCT NUMERIC AND
  9066        PL-DEV-PCT NOT = ZEROS
  9067        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  9068
  9069     IF PL-TOL-PREM-AMT GREATER THAN +0
  9070        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  9071
  9072     IF PL-TOL-REF-AMT GREATER THAN +0
  9073        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  9074
  9075     IF PL-TOL-PREM-PCT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 167
* EL050.cbl
  9076        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  9077
  9078     IF PL-TOL-REF-PCT GREATER THAN +0
  9079        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  9080
  9081     IF PL-TOL-CLM-AMT GREATER THAN +0
  9082        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  9083
  9084     IF PL-OVER-SHORT-AMT NUMERIC  AND
  9085                          PL-OVER-SHORT-AMT > +0
  9086        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  9087
  9088     IF PL-OVER-SHORT-PCT NUMERIC  AND
  9089                          PL-OVER-SHORT-PCT > +0
  9090        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  9091
  9092     IF PL-SALES-TAX NUMERIC AND
  9093                          PL-SALES-TAX > +0
  9094         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  9095
  9096     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9097        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  9098                                    WS-IG-OVRD-AM.
  9099
  9100 0304-LIFE-BENEFIT-FOUND.
  9101
  9102     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  9103
  9104     IF PB-ISSUE
  9105        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  9106     ELSE
  9107        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  9108
  9109     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  9110     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  9111     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  9112     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  9113     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  9114                                         WS-LF-REFUND-CALC.
  9115     if (ws-lf-earnings-calc = '5')
  9116        and (pb-i-loan-apr = zeros)
  9117        and (benefit-code-chg)
  9118        move +99.9999 to pb-i-loan-apr
  9119     end-if
  9120
  9121     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9122        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  9123
  9124     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9125        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  9126     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  9127
  9128     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  9129     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  9130     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  9131     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  9132     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  9133     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 168
* EL050.cbl
  9134
  9135     IF PB-COMPANY-ID = 'NCL'  AND
  9136        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9137         NEXT SENTENCE
  9138     ELSE
  9139         IF SUB5 NOT GREATER THAN +20
  9140            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  9141               MOVE WS-SAVE-BENEFIT-REM-TERM
  9142                                      TO WS-AM-LF-BENE-REM-TERM
  9143                                         EC-BR-LF-REM-TERM-CALC.
  9144
  9145     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  9146     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  9147
  9148     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  9149
  9150 0305-BENEFIT-NOT-FOUND.
  9151
  9152     MOVE '1'                    TO LF-BENEFIT-ERROR.
  9153     MOVE ER-2604                TO WS-ERROR.
  9154     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9155
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 169
* EL050.cbl
  9157
  9158 0310-FIND-AH-BENEFIT-RECORD.
  9159
  9160     MOVE 'N'                    TO PLAN-MASTER-SW
  9161                                    PLAN-MASTER-AH-SW.
  9162
  9163     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9164                                    WS-PL-TOL-AH-REFUND
  9165                                    WS-AH-PL-REF-OVS-AMT
  9166                                    WS-PL-TOL-AH-PREM-PCT
  9167                                    WS-PL-TOL-AH-REFUND-PCT
  9168                                    WS-AH-PL-REF-OVS-PCT
  9169                                    WS-PL-TOL-AH-CLAIM.
  9170     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9171
  9172
  9173     if pb-issue
  9174        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9175           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9176        end-if
  9177        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9178           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9179           GO TO 0399-BENEFIT-NOT-FOUND
  9180        end-if
  9181     end-if
  9182
  9183     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9184        GO TO 0400-FIND-CARRIER.
  9185
  9186     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9187
  9188     IF WK-AH-BEN-ADDR NOT = ZEROS
  9189         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9190         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9191         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9192         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9193           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9194             GO TO 0311-AH-BENEFIT-SEARCH
  9195         ELSE
  9196             NEXT SENTENCE
  9197     ELSE
  9198         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9199
  9200     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9201     MOVE '5'                    TO CNTL-REC-TYPE.
  9202     MOVE +0                     TO CNTL-SEQ-NO.
  9203     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9204
  9205     MOVE '2' TO RC-SW-2.
  9206     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9207
  9208     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9209        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9210          GO TO 0399-BENEFIT-NOT-FOUND.
  9211
  9212     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9213
  9214 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 170
* EL050.cbl
  9215
  9216     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9217
  9218     IF NO-BENEFIT-FOUND
  9219         GO TO 0399-BENEFIT-NOT-FOUND.
  9220
  9221     IF WS-BEN-CD = '99'
  9222        GO TO 0399-BENEFIT-NOT-FOUND.
  9223
  9224     IF PB-COMPANY-ID  =  'NCL'
  9225         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9226             GO TO 0314-A-H-BENEFIT-FOUND.
  9227
  9228     MOVE +1                     TO SUB5.
  9229     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9230
  9231* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9232* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9233     IF PB-COMPANY-ID = 'DMD'
  9234         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9235
  9236 0312-EDIT-ACCT-AH-BENEFITS.
  9237
  9238     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9239        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9240           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9241                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9242           GO TO 03XX-GET-AH-ERPLAN.
  9243
  9244     IF SUB5 LESS THAN +20
  9245        ADD +1                   TO SUB5
  9246        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9247
  9248     MOVE +1                     TO SUB5.
  9249
  9250     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9251        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9252
  9253 0313-EDIT-DMD-EXTRA-BENEFITS.
  9254
  9255     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9256        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9257           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9258                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9259           GO TO 03XX-GET-AH-ERPLAN.
  9260
  9261     IF SUB5 LESS THAN +30
  9262        ADD +1                   TO SUB5
  9263        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9264
  9265     MOVE +1                     TO SUB5.
  9266
  9267 03XX-EDIT-FOR-NINETY-AH.
  9268
  9269***************************************************************
  9270*                                                             *
  9271*    NINETY BENEFIT PLAN TYPES:                               *
  9272*                                                             *
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 171
* EL050.cbl
  9273*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9274*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9275*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9276*           BENEFIT CONTROLS.                                 *
  9277*      99 = ALL BENEFITS.                                     *
  9278*                                                             *
  9279***************************************************************
  9280
  9281     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9282                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9283
  9284     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9285       AND
  9286        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9287        GO TO 03XX-GET-AH-ERPLAN.
  9288
  9289     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9290       AND
  9291        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9292           IF (PB-I-INDV-GRP-OVRD = 'I')
  9293              OR
  9294           ((AM-IG = '1') AND
  9295           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9296              OR
  9297           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9298           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9299           (AM-IG NOT = '2'))
  9300              GO TO 03XX-GET-AH-ERPLAN.
  9301
  9302     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9303       AND
  9304        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9305           IF (PB-I-INDV-GRP-OVRD = 'G')
  9306              OR
  9307           ((AM-IG = '2') AND
  9308           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9309              OR
  9310           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9311           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9312           (AM-IG NOT = '1'))
  9313              GO TO 03XX-GET-AH-ERPLAN.
  9314
  9315     IF SUB5 LESS THAN +20
  9316        ADD +1                   TO SUB5
  9317        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9318
  9319     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9320        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9321
  9322     MOVE +1                    TO SUB5.
  9323
  9324 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9325
  9326     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9327                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9328
  9329     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9330       AND
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 172
* EL050.cbl
  9331        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9332        GO TO 03XX-GET-AH-ERPLAN.
  9333
  9334     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9335       AND
  9336        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9337           IF (PB-I-INDV-GRP-OVRD = 'I')
  9338              OR
  9339           ((AM-IG = '1') AND
  9340           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9341              OR
  9342           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9343           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9344           (AM-IG NOT = '2'))
  9345              GO TO 03XX-GET-AH-ERPLAN.
  9346
  9347     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9348       AND
  9349        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9350           IF (PB-I-INDV-GRP-OVRD = 'G')
  9351              OR
  9352           ((AM-IG = '2') AND
  9353           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9354              OR
  9355           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9356           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9357           (AM-IG NOT = '1'))
  9358              GO TO 03XX-GET-AH-ERPLAN.
  9359
  9360     IF SUB5 LESS THAN +30
  9361        ADD +1                   TO SUB5
  9362        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9363
  9364 03XX-EDIT-FOR-NINETY-AH-CONT.
  9365
  9366     MOVE +99                    TO SUB5.
  9367
  9368     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9369
  9370     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9371        IF PB-ISSUE
  9372           MOVE ER-1925          TO  WS-ERROR
  9373           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9374
  9375     GO TO 0314-A-H-BENEFIT-FOUND.
  9376
  9377 03XX-GET-AH-ERPLAN.
  9378
  9379     IF WK-PLAN-ADDR EQUAL +0
  9380         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9381
  9382     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9383     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9384     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9385     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9386     MOVE 'Y'                    TO PLAN-MASTER-SW
  9387                                    PLAN-MASTER-AH-SW.
  9388*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 173
* EL050.cbl
  9389     GO TO 03XX-ERPLAN-AH-READ.
  9390
  9391 03XX-ERPLAN-AH-GETMAIN.
  9392
  9393     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9394     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9395
  9396 03XX-ERPLAN-AH-READ.
  9397
  9398     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9399     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9400     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9401     MOVE PB-SV-STATE            TO PLAN-STATE.
  9402     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9403     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9404     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9405     MOVE WS-SAVE-BENEFIT-REVISION
  9406                                 TO PLAN-REVISION-NO.
  9407
  9408     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9409     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9410
  9411     IF PB-COMPANY-ID = 'NCL'
  9412       IF NOT AH-PLAN-MASTER-FOUND
  9413         IF NOT PB-POLICY-IS-DECLINED  AND
  9414            NOT PB-POLICY-IS-VOIDED
  9415             MOVE  ER-1922         TO  WS-ERROR
  9416             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9417             GO TO 0314-A-H-BENEFIT-FOUND.
  9418
  9419     IF NOT AH-PLAN-MASTER-FOUND
  9420        GO TO 0314-A-H-BENEFIT-FOUND.
  9421
  9422 XXXX-CHECK-AH-PLAN-KEY.
  9423
  9424     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9425        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9426        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9427        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9428        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9429        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9430        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9431        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9432        MOVE 'N'                 TO PLAN-MASTER-SW
  9433          GO TO 03XX-ERPLAN-AH-READ.
  9434
  9435     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9436
  9437     IF  PB-CANCELLATION
  9438         GO TO  0313-AH-ACCT-BEN-FOUND.
  9439
  9440     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9441       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9442          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9443          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9444             MOVE ER-2644             TO WS-ERROR
  9445             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9446          ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 174
* EL050.cbl
  9447             NEXT SENTENCE
  9448       ELSE
  9449          IF PB-COMPANY-ID NOT = 'NCL'
  9450             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9451                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9452
  9453 0313-AH-ACCT-BEN-FOUND.
  9454
  9455     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9456
  9457     IF PL-DEV-CODE NOT = SPACES
  9458        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9459
  9460     IF PL-DEV-PCT NUMERIC AND
  9461        PL-DEV-PCT NOT = ZEROS
  9462        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9463
  9464     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9465        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9466
  9467     IF PL-TOL-REF-AMT NOT EQUAL +0
  9468        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9469
  9470     IF PL-TOL-PREM-PCT GREATER THAN +0
  9471        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9472
  9473     IF PL-TOL-REF-PCT GREATER THAN +0
  9474        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9475
  9476     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9477        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9478
  9479     IF PL-OVER-SHORT-AMT NUMERIC AND
  9480                          PL-OVER-SHORT-AMT > +0
  9481        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9482
  9483     IF PL-OVER-SHORT-PCT NUMERIC AND
  9484                          PL-OVER-SHORT-PCT > +0
  9485        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9486
  9487     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9488        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9489        IF WS-IG-OVRD-AM EQUAL SPACES
  9490            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9491
  9492 0314-A-H-BENEFIT-FOUND.
  9493
  9494     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9495
  9496     IF PB-ISSUE
  9497        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9498       ELSE
  9499        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9500
  9501     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9502     if cf-maximum-benefits (sub3) numeric
  9503        move cf-maximum-benefits (sub3)
  9504                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 175
* EL050.cbl
  9505     else
  9506        move zeros               to ws-ah-max-bens
  9507     end-if
  9508     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9509     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9510     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9511                                         WS-AH-REFUND-CALC.
  9512
  9513     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9514        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9515
  9516     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9517        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9518     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9519
  9520     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9521     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9522     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9523     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9524     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9525     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9526
  9527     IF PB-COMPANY-ID = 'NCL'  AND
  9528        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9529         NEXT SENTENCE
  9530     ELSE
  9531         IF SUB5 NOT GREATER THAN +20
  9532            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9533                MOVE WS-SAVE-BENEFIT-REM-TERM
  9534                                      TO WS-AM-AH-BENE-REM-TERM
  9535                                         EC-BR-AH-REM-TERM-CALC.
  9536
  9537     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9538     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9539
  9540     GO TO 0400-FIND-CARRIER.
  9541
  9542 0399-BENEFIT-NOT-FOUND.
  9543
  9544     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9545     MOVE ER-2605                TO WS-ERROR.
  9546     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9547
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 176
* EL050.cbl
  9549
  9550 0400-FIND-CARRIER.
  9551
  9552     MOVE PB-SV-CARRIER          TO WS-CARR.
  9553
  9554     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9555     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9556     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9557     MOVE '6'                    TO CNTL-REC-TYPE.
  9558
  9559*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9560     MOVE SPACE                  TO WS-DMD-RATING-SW
  9561                                    EC-BR-DMD-RATING-SW.
  9562
  9563     MOVE '2'                    TO RC-SW-1.
  9564     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9565
  9566     IF NOT CF-CARRIER-MASTER
  9567        GO TO 0400-CARRIER-NOT-FOUND.
  9568
  9569 0400-BUILD-CARR-TOL.
  9570
  9571     IF CF-CR-TOL-PREM NUMERIC AND
  9572        CF-CR-TOL-PREM GREATER THAN +0
  9573        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9574                                    WS-TOL-AH-PREM.
  9575
  9576     IF CF-CR-TOL-REFUND NUMERIC AND
  9577        CF-CR-TOL-REFUND GREATER THAN +0
  9578        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9579                                    WS-TOL-AH-REFUND.
  9580
  9581     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9582        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9583        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9584                                    WS-AH-REFUND-OVS-AMT.
  9585
  9586     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9587        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9588        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9589                                    WS-AH-REFUND-OVS-PCT.
  9590
  9591     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9592        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9593        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9594                                    WS-TOL-AH-PREM-PCT.
  9595
  9596     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9597        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9598        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9599                                     WS-TOL-AH-REFUND-PCT.
  9600
  9601     IF CF-COMPANY-ID EQUAL 'DMD'
  9602         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9603                                    EC-BR-DMD-RATING-SW.
  9604
  9605     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9606     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 177
* EL050.cbl
  9607        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9608     END-IF
  9609     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9610        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9611     END-IF
  9612     IF WS-TOL-CLP-PCT = ZEROS
  9613        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9614     END-IF
  9615
  9616     IF WS-SPP-LEASE-COMM = ZEROS
  9617        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9618     END-IF
  9619     GO TO 0400-FIND-ERPDEF.
  9620
  9621 0400-CARRIER-NOT-FOUND.
  9622
  9623     MOVE ER-2602                TO WS-ERROR.
  9624     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9625
  9626 0400-FIND-ERPDEF.
  9627*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9628     IF (PB-COMPANY-ID = 'DCC')
  9629        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9630        CONTINUE
  9631     ELSE
  9632        GO TO 0400-FIND-ERCOMP
  9633     END-IF
  9634     MOVE ' '                    TO PDEF-MASTER-SW
  9635     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9636     MOVE PB-STATE               TO ERPDEF-STATE
  9637     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9638        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9639     END-IF
  9640     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9641     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9642     IF PB-ISSUE
  9643        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9644     ELSE
  9645        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9646     END-IF
  9647     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9648     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9649     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9650     IF PDEF-MASTER-FOUND
  9651        MOVE 'N'                 TO PDEF-MASTER-SW
  9652        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9653        IF PDEF-MASTER-FOUND
  9654           IF (ERPDEF-KEY-SAVE (1:16) =
  9655                        PD-CONTROL-PRIMARY (1:16))
  9656              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9657              CONTINUE
  9658           ELSE
  9659              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9660              IF (ERPDEF-KEY-SAVE (1:16) =
  9661                        PD-CONTROL-PRIMARY (1:16))
  9662                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9663                 CONTINUE
  9664              ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 178
* EL050.cbl
  9665                 MOVE 'N'        TO PDEF-MASTER-SW
  9666              END-IF
  9667           END-IF
  9668        END-IF
  9669        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9670     END-IF
  9671     IF PDEF-MASTER-FOUND
  9672        IF PD-TRUNCATED = 'Y'
  9673           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9674        END-IF
  9675     END-IF
  9676     .
  9677 0400-FIND-ERCOMP.
  9678     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9679        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9680           (WS-SUB1 > +10)
  9681           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9682                 OR 'A' OR 'N'
  9683              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9684              MOVE PB-CARRIER    TO COMP-CARRIER
  9685              MOVE PB-GROUPING   TO COMP-GROUPING
  9686              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9687              MOVE AM-AGT (WS-SUB1)
  9688                                 TO COMP-FIN-RESP
  9689              MOVE 'G'           TO COMP-TYPE
  9690              PERFORM 8582-READ-COMPENSATION-MASTER
  9691                                 THRU 8582-EXIT
  9692              IF COMP-MASTER-FOUND
  9693                 IF CO-GA-INACTIVE
  9694                    MOVE ER-2763 TO WS-ERROR
  9695                    PERFORM 9900-ERROR-FORMAT
  9696                                 THRU 9900-EXIT
  9697                    MOVE +11     TO WS-SUB1
  9698                 END-IF
  9699                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9700                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9701                    MOVE ER-2788 TO WS-ERROR
  9702                    PERFORM 9900-ERROR-FORMAT
  9703                                 THRU 9900-EXIT
  9704                    MOVE +11     TO WS-SUB1
  9705                 END-IF
  9706              END-IF
  9707           END-IF
  9708        END-PERFORM
  9709     END-IF
  9710     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9711        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9712           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9713                                    WS-CLP-STATE
  9714        ELSE
  9715           MOVE SPACES           TO PB-I-CLP-STATE
  9716                                    WS-CLP-STATE
  9717        END-IF
  9718     END-IF
  9719
  9720     IF (PB-COMPANY-ID = 'DCC')
  9721        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9722        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 179
* EL050.cbl
  9723        CONTINUE
  9724     ELSE
  9725        GO TO 0400-FIND-STATE-RECORD
  9726     END-IF
  9727     MOVE SPACES                 TO WS-CLP-STATE
  9728     MOVE +0                     TO WS-BANK-FEE
  9729                                    WS-BANK-LFEE
  9730                                    WS-BANK-NOCHRGB
  9731
  9732     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9733     IF (PB-ISSUE)
  9734        AND (PB-I-BANK-NUMBER NOT =
  9735            SPACES AND ZEROS AND LOW-VALUES)
  9736        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9737     ELSE
  9738        IF (PB-CANCELLATION)
  9739           AND (PB-CI-BANK-NUMBER NOT =
  9740                SPACES AND ZEROS AND LOW-VALUES)
  9741           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9742        END-IF
  9743     END-IF
  9744     IF COMP-FIN-RESP NOT = LOW-VALUES
  9745        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9746        MOVE PB-CARRIER          TO COMP-CARRIER
  9747        MOVE PB-GROUPING         TO COMP-GROUPING
  9748        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9749        MOVE 'B'                 TO COMP-TYPE
  9750        PERFORM 8582-READ-COMPENSATION-MASTER
  9751                                 THRU 8582-EXIT
  9752        IF COMP-MASTER-FOUND
  9753           IF CO-MAX-BANK-FEE NOT NUMERIC
  9754              MOVE +0            TO CO-MAX-BANK-FEE
  9755           END-IF
  9756           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9757              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9758           END-IF
  9759           IF CO-GA-INACTIVE
  9760              MOVE ER-2763       TO WS-ERROR
  9761              PERFORM 9900-ERROR-FORMAT
  9762                                 THRU 9900-EXIT
  9763           END-IF
  9764           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9765              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9766              MOVE ER-2788 TO WS-ERROR
  9767              PERFORM 9900-ERROR-FORMAT
  9768                                 THRU 9900-EXIT
  9769              MOVE +11     TO WS-SUB1
  9770           END-IF
  9771           IF WS-AH-BEN-CATEGORY = 'G'
  9772              MOVE CO-MAX-BANK-FEE
  9773                                 TO WS-BANK-FEE
  9774                                    PB-I-BANK-FEE
  9775           ELSE
  9776              MOVE CO-MAX-BANK-FEE-LEASE
  9777                                 TO WS-BANK-LFEE
  9778                                    PB-I-BANK-FEE
  9779           END-IF
  9780           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 180
* EL050.cbl
  9781              AND (WS-AH-REFUND-CALC = 'G'))
  9782                        OR
  9783              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9784              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9785              CONTINUE
  9786           ELSE
  9787              MOVE ER-2789 TO WS-ERROR
  9788              PERFORM 9900-ERROR-FORMAT
  9789                                 THRU 9900-EXIT
  9790           END-IF
  9791           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9792                                    PB-I-CLP-STATE
  9793           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9794           MOVE CO-CARRIER       TO BXRF-CARRIER
  9795           MOVE CO-GROUPING      TO BXRF-GROUPING
  9796           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9797           MOVE BXRF-MAX-REC-LENGTH
  9798                                 TO BXRF-REC-LENGTH
  9799           PERFORM 8584-READ-BANK-CROSS-REF
  9800                                 THRU 8584-EXIT
  9801           IF BXRF-MASTER-FOUND
  9802              MOVE ' '           TO BANK-ACCT-SW
  9803              MOVE BK-BANK-POINTER-CNT
  9804                                 TO BK-BANK-POINTER-CNT
  9805              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9806                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9807                 OR (BANK-ACCT-FOUND)
  9808                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9809                    AND (BK-AM-EXP-DT (WS-SUB1)
  9810                                 > PB-CERT-EFF-DT)
  9811                    AND (BK-AM-EFF-DT (WS-SUB1)
  9812                                 NOT > PB-CERT-EFF-DT)
  9813                    SET BANK-ACCT-FOUND TO TRUE
  9814                 END-IF
  9815              END-PERFORM
  9816              IF NOT BANK-ACCT-FOUND
  9817                 MOVE ZEROS      TO WS-BANK-FEE
  9818                                    WS-BANK-LFEE
  9819                 MOVE ER-2869    TO WS-ERROR
  9820                 PERFORM 9900-ERROR-FORMAT
  9821                                 THRU 9900-EXIT
  9822              ELSE
  9823                 PERFORM 5000-PROCESS-REPS
  9824                                 THRU 5000-EXIT
  9825                 IF AGENT-MASTER-FOUND
  9826                    MOVE +0      TO WS-BANK-FEE
  9827                                    WS-BANK-LFEE
  9828*                   MOVE AG-SPP-FEES (1)
  9829*                                TO PB-I-BANK-FEE
  9830*                                   WS-BANK-FEE
  9831                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9832                       (WS-SUB1 > +10)
  9833                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9834                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9835                       END-IF
  9836                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9837                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9838                       END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 181
* EL050.cbl
  9839                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9840                          AG-SPP-FEES (WS-SUB1)
  9841                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9842                          AG-SPP-LFEES (WS-SUB1)
  9843                    END-PERFORM
  9844                    IF WS-AH-BEN-CATEGORY = 'G'
  9845                       MOVE WS-BANK-FEE
  9846                                 TO PB-I-BANK-FEE
  9847                    ELSE
  9848                       MOVE WS-BANK-LFEE
  9849                                 TO PB-I-BANK-FEE
  9850                    END-IF
  9851                 END-IF
  9852              END-IF
  9853           END-IF
  9854        ELSE
  9855           MOVE ER-2879          TO WS-ERROR
  9856           PERFORM 9900-ERROR-FORMAT
  9857                                 THRU 9900-EXIT
  9858        END-IF
  9859     ELSE
  9860        MOVE ER-2879             TO WS-ERROR
  9861        PERFORM 9900-ERROR-FORMAT
  9862                                 THRU 9900-EXIT
  9863     END-IF
  9864     IF WS-AH-BEN-CATEGORY = 'G'
  9865        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9866        + WS-BANK-FEE
  9867     ELSE
  9868        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9869        + WS-BANK-LFEE
  9870     END-IF
  9871     .
  9872 0400-FIND-STATE-RECORD.
  9873
  9874     IF WK-STATE-ADDR NOT = ZEROS
  9875         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9876         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9877         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9878         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9879         IF PB-SV-STATE = CF-STATE-CODE
  9880             GO TO 0405-CONTINUE-EDIT
  9881         ELSE
  9882             NEXT SENTENCE
  9883     ELSE
  9884         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9885
  9886     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9887     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9888     MOVE '3'                    TO CNTL-REC-TYPE.
  9889     MOVE +0                     TO CNTL-SEQ-NO.
  9890
  9891     MOVE '3'                    TO RC-SW-2.
  9892     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9893
  9894     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9895        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9896        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 182
* EL050.cbl
  9897        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9898                                    WS-TOL-AH-CLAIM
  9899                                    WS-MINIMUM-REFUND
  9900                                    WS-TOL-LF-PREM
  9901                                    WS-TOL-AH-PREM
  9902                                    WS-TOL-LF-REFUND
  9903                                    WS-TOL-AH-REFUND
  9904                                    EC-ST-TOL-PREM-PCT
  9905                                    WS-TOL-LF-PREM-PCT
  9906                                    WS-TOL-AH-PREM-PCT
  9907                                    EC-ST-TOL-REFUND-PCT
  9908                                    WS-TOL-LF-REFUND-PCT
  9909                                    WS-TOL-AH-REFUND-PCT
  9910                                    EC-ST-TOL-PREM
  9911                                    EC-ST-TOL-REFUND
  9912                                    EC-ST-FST-PMT-DAYS-MAX
  9913                                    WS-FREE-LOOK-PERIOD
  9914                                    WS-ST-LF-PREM-TAX
  9915                                    WS-ST-AH-PREM-TAX-I
  9916                                    WS-ST-AH-PREM-TAX-G
  9917                                    WS-BANK-FEE
  9918                                    WS-BANK-LFEE
  9919                                    WS-TOL-CLP-PCT
  9920                                    WS-SPP-LEASE-COMM
  9921                                    WS-INT-PERIODS
  9922                                    WS-EXTRA-PMTS
  9923        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9924                                    EC-ST-FST-PMT-DAYS-CHG
  9925                                    WS-LF-REM-TERM-CALC
  9926                                    WS-LF-REFUND-CALC
  9927                                    EC-ST-LF-REM-TERM-CALC
  9928                                    EC-ST-LF-REFUND-CALC
  9929                                    WS-AH-REM-TERM-CALC
  9930                                    WS-AH-REFUND-CALC
  9931                                    WS-LF-BEN-CATEGORY
  9932                                    WS-AH-BEN-CATEGORY
  9933                                    WS-CLP-STATE
  9934                                    WS-ST-REFUND-CLAIM-FLAG
  9935                                    WS-ST-CAUSAL-STATE
  9936                                    ws-st-agent-sig-edit
  9937                                    EC-ST-AH-REM-TERM-CALC
  9938                                    EC-ST-AH-REFUND-CALC
  9939          GO TO 0499-STATE-NOT-FOUND.
  9940
  9941     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9942
  9943 0405-CONTINUE-EDIT.
  9944
  9945     IF (PB-COMPANY-ID <> 'AHL')
  9946        and (pb-issue)
  9947        MOVE +0                  TO SUB3
  9948        INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9949        IF SUB3 > +0
  9950           MOVE ER-3270          TO WS-ERROR
  9951           PERFORM 9900-ERROR-FORMAT
  9952                                 THRU 9900-EXIT
  9953        else
  9954           IF PB-CERT-PRIME NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 183
* EL050.cbl
  9955              MOVE ER-2722       TO WS-ERROR
  9956              PERFORM 9900-ERROR-FORMAT
  9957                                 THRU 9900-EXIT
  9958           end-if
  9959        END-IF
  9960     END-IF
  9961     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9962
  9963     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9964        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9965                                    WS-TOL-AH-CLAIM.
  9966
  9967     IF CF-ST-REFUND-MIN NOT NUMERIC
  9968        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9969
  9970     IF CF-ST-REFUND-MIN NOT = ZEROS
  9971        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9972
  9973     IF CF-ST-TOL-PREM  NOT = ZEROS
  9974        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9975                                    WS-TOL-AH-PREM
  9976        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9977
  9978     IF CF-ST-TOL-REFUND NOT = ZEROS
  9979        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9980                                    WS-TOL-AH-REFUND
  9981        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9982
  9983     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9984        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9985        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9986                                    WS-AH-REFUND-OVS-AMT
  9987                                    EC-ST-OVR-SHT-AMT.
  9988
  9989     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9990        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9991        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9992                                    WS-TOL-LF-PREM-PCT
  9993                                    WS-TOL-AH-PREM-PCT.
  9994
  9995     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9996        CF-ST-TOL-REF-PCT GREATER THAN +0
  9997        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9998                                    WS-TOL-LF-REFUND-PCT
  9999                                    WS-TOL-AH-REFUND-PCT.
 10000
 10001     IF CF-ST-OVR-SHT-PCT NUMERIC AND
 10002        CF-ST-OVR-SHT-PCT GREATER THAN +0
 10003        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
 10004                                    WS-AH-REFUND-OVS-PCT
 10005                                    EC-ST-OVR-SHT-PCT.
 10006
 10007     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
 10008     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
 10009
 10010     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
 10011          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
 10012
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 184
* EL050.cbl
 10013     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
 10014     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
 10015     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
 10016
 10017     IF CF-ST-LF-PREM-TAX NUMERIC
 10018        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10019     END-IF
 10020     IF CF-ST-AH-PREM-TAX-I NUMERIC
 10021        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10022     END-IF
 10023     IF CF-ST-AH-PREM-TAX-G NUMERIC
 10024        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10025     END-IF
 10026
 10027     IF CF-ST-REF-AH-DEATH-IND > SPACES
 10028         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
 10029     END-IF.
 10030
 10031     IF CF-ST-CAUSAL-STATE > SPACES
 10032         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
 10033     END-IF.
 10034     if cf-st-extra-interest-periods not numeric
 10035        move zeros               to cf-st-extra-interest-periods
 10036     end-if
 10037     if cf-st-extra-payments not numeric
 10038        move zeros               to cf-st-extra-payments
 10039     end-if
 10040
 10041     move cf-st-extra-interest-periods
 10042                                 to ws-int-periods
 10043     move cf-st-extra-payments   to ws-extra-pmts
 10044     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
 10045     move cf-st-net-only-state   to ws-net-only-state
 10046     if cf-st-comm-cap-sl not numeric
 10047        move zeros               to cf-st-comm-cap-sl
 10048     end-if
 10049     if cf-st-comm-cap-jl not numeric
 10050        move zeros               to cf-st-comm-cap-jl
 10051     end-if
 10052     if cf-st-comm-cap-sa not numeric
 10053        move zeros               to cf-st-comm-cap-sa
 10054     end-if
 10055     if cf-st-comm-cap-ja not numeric
 10056        move zeros               to cf-st-comm-cap-ja
 10057     end-if
 10058     if cf-st-ga-comm-cap-sl not numeric
 10059        move zeros               to cf-st-ga-comm-cap-sl
 10060     end-if
 10061     if cf-st-ga-comm-cap-jl not numeric
 10062        move zeros               to cf-st-ga-comm-cap-jl
 10063     end-if
 10064     if cf-st-ga-comm-cap-sa not numeric
 10065        move zeros               to cf-st-ga-comm-cap-sa
 10066     end-if
 10067     if cf-st-ga-comm-cap-ja not numeric
 10068        move zeros               to cf-st-ga-comm-cap-ja
 10069     end-if
 10070
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 185
* EL050.cbl
 10071     if cf-st-tot-comm-cap-sl not numeric
 10072        move zeros               to cf-st-tot-comm-cap-sl
 10073     end-if
 10074     if cf-st-tot-comm-cap-jl not numeric
 10075        move zeros               to cf-st-tot-comm-cap-jl
 10076     end-if
 10077     if cf-st-tot-comm-cap-sa not numeric
 10078        move zeros               to cf-st-tot-comm-cap-sa
 10079     end-if
 10080     if cf-st-tot-comm-cap-ja not numeric
 10081        move zeros               to cf-st-tot-comm-cap-ja
 10082     end-if
 10083
 10084     move cf-comm-cap-limit-to   to ws-st-cap-limit-to
 10085     move cf-st-comm-cap-sl      to ws-st-comm-cap-sl
 10086     move cf-st-comm-cap-jl      to ws-st-comm-cap-jl
 10087     move cf-st-comm-cap-sa      to ws-st-comm-cap-sa
 10088     move cf-st-comm-cap-ja      to ws-st-comm-cap-ja
 10089     move cf-st-ga-comm-cap-sl   to ws-st-ga-comm-cap-sl
 10090     move cf-st-ga-comm-cap-jl   to ws-st-ga-comm-cap-jl
 10091     move cf-st-ga-comm-cap-sa   to ws-st-ga-comm-cap-sa
 10092     move cf-st-ga-comm-cap-ja   to ws-st-ga-comm-cap-ja
 10093     move cf-st-tot-comm-cap-sl  to ws-st-tot-comm-cap-sl
 10094     move cf-st-tot-comm-cap-jl  to ws-st-tot-comm-cap-jl
 10095     move cf-st-tot-comm-cap-sa  to ws-st-tot-comm-cap-sa
 10096     move cf-st-tot-comm-cap-ja  to ws-st-tot-comm-cap-ja
 10097     IF WS-LF-BENEFIT-CD = ZEROS
 10098        GO TO 0410-CHECK-AH.
 10099
 10100     IF CF-ST-RT-CALC NOT = SPACES
 10101        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10102                                    EC-ST-LF-REM-TERM-CALC
 10103     END-IF
 10104
 10105     IF WS-LF-COVERAGE-TYPE = 'R'
 10106        IF WS-LF-EARNINGS-CALC = '5'
 10107           IF CF-ST-RF-LN-CALC > '0'
 10108              MOVE CF-ST-RF-LN-CALC
 10109                                 TO WS-LF-REFUND-CALC
 10110                                    EC-ST-LF-REFUND-CALC
 10111           END-IF
 10112        ELSE
 10113           IF CF-ST-RF-LR-CALC > '0'
 10114              MOVE CF-ST-RF-LR-CALC
 10115                                 TO WS-LF-REFUND-CALC
 10116                                    EC-ST-LF-REFUND-CALC
 10117           END-IF
 10118        END-IF
 10119     ELSE
 10120        IF CF-ST-RF-LL-CALC > '0'
 10121           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 10122                                    EC-ST-LF-REFUND-CALC
 10123        END-IF
 10124     END-IF
 10125
 10126     IF CF-ST-RT-CALC NOT = SPACES
 10127        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10128                                    EC-ST-LF-REM-TERM-CALC
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 186
* EL050.cbl
 10129     END-IF
 10130
 10131     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
 10132     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
 10133
 10134     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10135
 10136     IF NO-BENEFIT-FOUND
 10137        GO TO 0410-CHECK-AH.
 10138
 10139     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10140        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 10141                                 TO EC-ST-LF-REM-TERM-CALC
 10142                                    WS-LF-REM-TERM-CALC
 10143     END-IF
 10144
 10145     IF CF-ST-REFUND-CALC (SUB3) > '0'
 10146        MOVE CF-ST-REFUND-CALC (SUB3)
 10147                                 TO WS-LF-REFUND-CALC
 10148                                    EC-ST-LF-REFUND-CALC
 10149     END-IF
 10150*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
 10151     if cf-st-extra-periods (sub3) not numeric
 10152        move zeros               to cf-st-extra-periods (sub3)
 10153     end-if
 10154     if cf-st-extra-periods (sub3) > zeros
 10155        if ws-lf-ben-category = 'P'
 10156           move cf-st-extra-periods (sub3)
 10157                                 to ws-extra-pmts
 10158        else
 10159           if ws-lf-ben-category = 'I'
 10160              move cf-st-extra-periods (sub3)
 10161                                 to ws-int-periods
 10162           end-if
 10163        end-if
 10164     end-if
 10165     .
 10166 0410-CHECK-AH.
 10167
 10168     IF WS-AH-BENEFIT-CD = ZEROS
 10169        GO TO 0500-SET-ACCOUNT.
 10170
 10171     IF CF-ST-RT-CALC NOT = SPACES
 10172        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 10173                                    EC-ST-AH-REM-TERM-CALC
 10174     END-IF
 10175
 10176     IF WS-AH-SPECIAL-CALC-CD = 'C'
 10177        IF CF-ST-RF-CP-CALC > '0'
 10178           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 10179                                    EC-ST-AH-REFUND-CALC
 10180        END-IF
 10181     ELSE
 10182        IF CF-ST-RF-AH-CALC > '0'
 10183           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 10184                                    EC-ST-AH-REFUND-CALC
 10185        END-IF
 10186     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 187
* EL050.cbl
 10187     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
 10188     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
 10189
 10190     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10191
 10192     IF NO-BENEFIT-FOUND
 10193        GO TO 0500-SET-ACCOUNT.
 10194
 10195     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10196        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10197                                 TO WS-AH-REM-TERM-CALC
 10198                                    EC-ST-AH-REM-TERM-CALC
 10199     END-IF
 10200
 10201     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10202        MOVE CF-ST-REFUND-CALC (SUB3)
 10203                                 TO WS-AH-REFUND-CALC
 10204                                    EC-ST-AH-REFUND-CALC
 10205     END-IF
 10206
 10207*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10208
 10209     GO TO 0500-SET-ACCOUNT.
 10210
 10211 0499-STATE-NOT-FOUND.
 10212
 10213     MOVE ER-2603                TO WS-ERROR.
 10214     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10215
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 188
* EL050.cbl
 10217
 10218 0500-SET-ACCOUNT.
 10219*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10220     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10221        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10222        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10223        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10224        MOVE '3'                 TO CNTL-REC-TYPE
 10225        MOVE +0                  TO CNTL-SEQ-NO
 10226
 10227        MOVE '3'                 TO RC-SW-2
 10228        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10229
 10230        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10231           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10232           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10233           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10234                                    WS-ST-AH-PREM-TAX-I
 10235                                    WS-ST-AH-PREM-TAX-G
 10236        ELSE
 10237           IF CF-ST-LF-PREM-TAX NUMERIC
 10238              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10239           END-IF
 10240           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10241              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10242           END-IF
 10243           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10244              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10245           END-IF
 10246        END-IF
 10247        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10248     END-IF
 10249*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10250*  FOR DCC ONLY
 10251     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10252
 10253        MOVE ' '                 TO STAT-MASTER-SW
 10254        MOVE PB-COMPANY-ID       TO ELSTAT-COMPANY-ID
 10255        MOVE PB-CARRIER          TO ELSTAT-CARRIER
 10256        MOVE PB-GROUPING         TO ELSTAT-GROUP
 10257        MOVE PB-STATE            TO ELSTAT-STATE
 10258        IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10259           MOVE WS-CLP-STATE     TO ELSTAT-STATE
 10260        END-IF
 10261
 10262        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 10263        SET BIN-TO-GREG          TO TRUE
 10264        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10265        MOVE DC-GREG-DATE-CYMD   TO ELSTAT-EXP-DT
 10266        MOVE ELSTAT-KEY          TO ELSTAT-KEY-SAVE
 10267
 10268        PERFORM 8750-START-ELSTAT THRU 8750-EXIT
 10269        IF STAT-MASTER-FOUND
 10270           MOVE 'N'              TO STAT-MASTER-SW
 10271           PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10272           IF STAT-MASTER-FOUND
 10273              IF (ELSTAT-KEY-SAVE (1:12) =
 10274                           SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 189
* EL050.cbl
 10275                 IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10276                    MOVE 'F'        TO STAT-MASTER-SW
 10277                 ELSE
 10278                    PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10279                    IF (STAT-MASTER-FOUND)
 10280                       AND (ELSTAT-KEY-SAVE (1:12) =
 10281                           SF-CONTROL-PRIMARY (1:12))
 10282                       AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10283                       MOVE 'F'     TO STAT-MASTER-SW
 10284                    END-IF
 10285                 END-IF
 10286              END-IF
 10287           END-IF
 10288        END-IF
 10289
 10290        IF STAT-MASTER-SW = 'F'
 10291           IF (SF-ST-LF-PREM-TAX NUMERIC)
 10292              and (sf-st-lf-prem-tax > zeros)
 10293              MOVE SF-ST-LF-PREM-TAX
 10294                                 TO WS-ST-LF-PREM-TAX
 10295           END-IF
 10296           IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10297              and (sf-st-ah-prem-tax-i > zeros)
 10298              MOVE SF-ST-AH-PREM-TAX-I
 10299                                 TO WS-ST-AH-PREM-TAX-I
 10300           END-IF
 10301           IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10302              and (sf-st-ah-prem-tax-g > zeros)
 10303              MOVE SF-ST-AH-PREM-TAX-G
 10304                                 TO WS-ST-AH-PREM-TAX-G
 10305           END-IF
 10306        END-IF
 10307     END-IF
 10308     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10309        AND (PB-ISSUE)
 10310        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10311        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10312        AND (AM-GPCD = 06)
 10313        MOVE 'Y'                 TO WS-GOOD-HIN
 10314        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10315           MOVE PB-I-VIN         TO WS-WORK-VIN
 10316           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10317              (V1 > 16)
 10318              IF WS-WORK-VIN (V1:1) NUMERIC
 10319                 MOVE WS-WORK-VIN-N (V1)
 10320                                 TO WS-ROW-B-VAL (V1)
 10321              ELSE
 10322                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10323                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10324                    OR (V2 > 26)
 10325                 END-PERFORM
 10326                 IF V2 < 27
 10327                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10328                 ELSE
 10329                    MOVE 'N'     TO WS-GOOD-HIN
 10330                 END-IF
 10331              END-IF
 10332              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 190
* EL050.cbl
 10333                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10334              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10335                 WS-ROW-D-VAL (V1)
 10336           END-PERFORM
 10337           MOVE ZEROS            TO WS-VIN-REMAINDER
 10338           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10339             REMAINDER WS-VIN-REMAINDER
 10340           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10341              CONTINUE
 10342           ELSE
 10343              MOVE 'N'           TO WS-GOOD-HIN
 10344           END-IF
 10345        ELSE
 10346           MOVE 'N'              TO WS-GOOD-HIN
 10347        END-IF
 10348        IF WS-GOOD-HIN NOT = 'Y'
 10349           MOVE ER-3826           TO WS-ERROR
 10350           PERFORM 9900-ERROR-FORMAT
 10351                                 THRU 9900-EXIT
 10352        END-IF
 10353     END-IF
 10354     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10355        AND (PB-ISSUE)
 10356        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10357        AND (AM-GPCD NOT = 06)
 10358        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10359           perform 3400-edit-vin thru 3400-exit
 10360        ELSE
 10361          MOVE ER-3826           TO WS-ERROR
 10362          PERFORM 9900-ERROR-FORMAT
 10363                                 THRU 9900-EXIT
 10364        END-IF
 10365     END-IF
 10366     if (pb-company-id = 'CID')
 10367        and (pb-issue)
 10368        and (pb-i-vin not = spaces and low-values and zeros)
 10369        perform 3400-edit-vin    thru 3400-exit
 10370     end-if
 10371******************************************************************
 10372******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10373******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10374******* METHODS.
 10375******************************************************************
 10376     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10377        IF PB-CANCELLATION
 10378           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10379              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10380                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10381                IF FORM-MASTER-FOUND
 10382                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10383******************************************************************
 10384
 10385     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10386     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10387
 10388     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10389     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10390     MOVE AM-STATUS              TO WS-ACCT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 191
* EL050.cbl
 10391     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10392
 10393
 10394     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10395     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10396     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10397
 10398     IF AM-LF-OB-RATE NOT NUMERIC
 10399         MOVE ZERO               TO AM-LF-OB-RATE.
 10400
 10401     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10402         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10403
 10404     IF AM-AH-OB-RATE NOT NUMERIC
 10405         MOVE ZERO               TO AM-AH-OB-RATE.
 10406
 10407     IF WS-LF-JOINT-INDICATOR = 'J'
 10408         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10409     ELSE
 10410         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10411
 10412     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10413
 10414     IF WS-IG-OVRD-AM  EQUAL SPACE
 10415         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10416
 10417     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10418         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10419                                       WS-IG-OVRD
 10420     ELSE
 10421         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10422             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10423                                       WS-IG-OVRD
 10424         ELSE
 10425             MOVE AM-IG             TO WS-IG-OVRD-AH
 10426                                       WS-IG-OVRD.
 10427
 10428     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10429         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10430                                       WS-IG-OVRD
 10431     ELSE
 10432         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10433             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10434                                       WS-IG-OVRD
 10435         ELSE
 10436             MOVE AM-IG             TO WS-IG-OVRD-LF
 10437                                       WS-IG-OVRD.
 10438
 10439     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10440     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10441     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10442     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10443*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10444     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10445                                              TO 'PRLDSFCTIA'.
 10446
 10447     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10448     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 192
* EL050.cbl
 10449     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10450     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10451
 10452     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10453     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10454     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10455     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10456     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10457     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10458     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10459
 10460     IF WS-ACCT-AH-DEV-PCT > +0
 10461        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10462     ELSE
 10463        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10464
 10465     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10466        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10467     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10468        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10469
 10470        IF AM-EARN-METHOD-L = 'S'
 10471            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10472                                        WS-LF-REFUND-CALC.
 10473
 10474        IF AM-EARN-METHOD-R = 'S'
 10475            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10476                                        WS-LF-REFUND-CALC.
 10477
 10478     IF WS-LF-COVERAGE-TYPE = 'R'
 10479         IF AM-EARN-METHOD-R = 'R'
 10480            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10481                                    WS-LF-REFUND-CALC.
 10482     IF WS-LF-COVERAGE-TYPE = 'R'
 10483         IF AM-EARN-METHOD-R = 'P'
 10484            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10485                                    WS-LF-REFUND-CALC.
 10486     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10487         IF AM-EARN-METHOD-L = 'R'
 10488            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10489                                    WS-LF-REFUND-CALC.
 10490     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10491         IF AM-EARN-METHOD-L = 'P'
 10492            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10493                                    WS-LF-REFUND-CALC.
 10494     IF WS-LF-COVERAGE-TYPE = 'R'
 10495         IF AM-EARN-METHOD-R = 'A'
 10496            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10497                                    WS-LF-REFUND-CALC.
 10498     IF WS-LF-COVERAGE-TYPE = 'R'
 10499         IF AM-EARN-METHOD-R = 'M'
 10500            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10501                                    WS-LF-REFUND-CALC.
 10502     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10503         IF AM-EARN-METHOD-L = 'A'
 10504            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10505                                    WS-LF-REFUND-CALC.
 10506     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 193
* EL050.cbl
 10507         IF AM-EARN-METHOD-L = 'M'
 10508            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10509                                    WS-LF-REFUND-CALC.
 10510
 10511     IF AM-EARN-METHOD-A = 'R'
 10512        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10513                                    WS-AH-REFUND-CALC.
 10514     IF AM-EARN-METHOD-A = 'P'
 10515        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10516                                    WS-AH-REFUND-CALC.
 10517     IF AM-EARN-METHOD-A = 'C'
 10518        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10519                                    WS-AH-REFUND-CALC.
 10520     IF AM-EARN-METHOD-A = 'A'
 10521        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10522                                    WS-AH-REFUND-CALC.
 10523     IF AM-EARN-METHOD-A = 'M'
 10524        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10525                                    WS-AH-REFUND-CALC.
 10526     IF AM-EARN-METHOD-A = 'N'
 10527        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10528                                    WS-AH-REFUND-CALC.
 10529     IF AM-EARN-METHOD-A = 'S'
 10530        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10531                                    WS-AH-REFUND-CALC.
 10532
 10533     IF AM-TOL-PREM NOT = ZEROS
 10534        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10535                                    WS-TOL-AH-PREM.
 10536
 10537     IF AM-OVR-SHT-AMT NUMERIC AND
 10538                  AM-OVR-SHT-AMT > 0
 10539        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10540                                    EC-AM-LF-OVR-SHT-AMT
 10541                                    WS-AH-REFUND-OVS-AMT
 10542                                    EC-AM-AH-OVR-SHT-AMT.
 10543
 10544     IF AM-OVR-SHT-PCT NUMERIC AND
 10545                    AM-OVR-SHT-PCT > 0
 10546        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10547                                    EC-AM-LF-OVR-SHT-PCT
 10548                                    WS-AH-REFUND-OVS-PCT
 10549                                    EC-AM-AH-OVR-SHT-PCT.
 10550
 10551     IF AM-TOL-REF-PCT NUMERIC AND
 10552                  AM-TOL-REF-PCT > 0
 10553        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10554                                    WS-TOL-AH-REFUND-PCT.
 10555
 10556     IF AM-TOL-REF  NOT = ZEROS  AND
 10557                  AM-TOL-REF NUMERIC
 10558        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10559                                    EC-AM-LF-TOL-REFUND
 10560                                    WS-TOL-AH-REFUND
 10561                                    EC-AM-AH-TOL-REFUND.
 10562
 10563     IF AM-TOL-CLM  NOT = ZEROS
 10564        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 194
* EL050.cbl
 10565                                    WS-TOL-AH-CLAIM.
 10566
 10567     IF AM-CLP-TOL-PCT NOT NUMERIC
 10568        MOVE +0                  TO AM-CLP-TOL-PCT
 10569     END-IF
 10570
 10571     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10572        MOVE +0                  TO AM-SPP-LEASE-COMM
 10573     END-IF
 10574     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10575        MOVE WS-PL-TOL-LF-PREM-PCT
 10576                                 TO WS-TOL-LF-PREM-PCT.
 10577
 10578     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10579        MOVE WS-PL-TOL-AH-PREM-PCT
 10580                                 TO WS-TOL-AH-PREM-PCT.
 10581
 10582     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10583        MOVE WS-PL-TOL-LF-REFUND-PCT
 10584                                 TO WS-TOL-LF-REFUND-PCT.
 10585
 10586     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10587        MOVE WS-PL-TOL-AH-REFUND-PCT
 10588                                 TO WS-TOL-AH-REFUND-PCT.
 10589
 10590     IF WS-PL-REF-OVS-AMT > +0
 10591        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10592
 10593     IF WS-PL-REF-OVS-PCT > +0
 10594        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10595
 10596     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10597        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10598     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10599        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10600     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10601        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10602     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10603        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10604     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10605        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10606     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10607        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10608
 10609     IF WS-AH-PL-REF-OVS-AMT > +0
 10610        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10611
 10612     IF WS-AH-PL-REF-OVS-PCT > +0
 10613        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10614
 10615     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10616     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10617
 10618     IF PB-CANCELLATION
 10619        GO TO 3000-CONTINUE-EDIT.
 10620
 10621     MOVE +1 TO SUB1.
 10622     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 195
* EL050.cbl
 10623     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10624
 10625     IF CF-COMPANY-ID = 'DMD'
 10626       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10627         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10628        ELSE
 10629         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10630
 10631  0525-FIND-ACCT-COMM.
 10632     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10633        NEXT SENTENCE
 10634      ELSE
 10635         ADD +1 TO SUB1
 10636         IF SUB1 LESS +11
 10637            GO TO 0525-FIND-ACCT-COMM
 10638          ELSE
 10639             GO TO 0550-st-comm-cap-check.
 10640
 10641     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10642     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10643                                    PB-I-LIFE-COMMISSION.
 10644***  IF PB-COMPANY-ID = 'CRI'
 10645     IF PB-PREM-ACCTNG-ONLY
 10646         GO TO 0550-st-comm-cap-check.
 10647
 10648     MOVE '0530' TO CTBL-SW.
 10649     MOVE ' '    TO WS-CTBL-READ-SW.
 10650
 10651
 10652 0530-GET-AH-COMP.
 10653     IF NO-AH-COVERAGE  OR
 10654        NO-AH-BENEFIT-MATCH
 10655           GO TO 0540-NEXT-READ-STEP.
 10656
 10657     IF AM-A-COM (SUB1) NUMERIC
 10658        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10659         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10660         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10661         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10662         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10663     ELSE
 10664          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10665          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10666          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10667          MOVE ZEROS             TO WS-SUB1
 10668                                    WS-COMMISSION
 10669          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10670          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10671          IF WS-COMMISSION > ZEROS
 10672             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10673             GO TO 0540-NEXT-READ-STEP
 10674          END-IF
 10675          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10676          IF CTBL-TABLE-FOUND
 10677             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10678                                        PB-I-AH-TERM
 10679             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10680             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 196
* EL050.cbl
 10681             GO TO 0540-NEXT-READ-STEP
 10682          ELSE
 10683             IF FIRST-TIME-THROUGH
 10684                 GO TO 0530-GET-AH-COMP
 10685             ELSE
 10686                 MOVE ER-2609                TO WS-ERROR
 10687                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10688
 10689 0540-NEXT-READ-STEP.
 10690     MOVE '0540' TO CTBL-SW.
 10691     MOVE ' '    TO WS-CTBL-READ-SW.
 10692
 10693 0540-GET-LF-COMP.
 10694     IF NO-LIFE-COVERAGE  OR
 10695        NO-LF-BENEFIT-MATCH
 10696           GO TO 0550-st-comm-cap-check.
 10697
 10698     IF WS-LF-JOINT-INDICATOR = 'J'
 10699        IF AM-J-COM (SUB1) NUMERIC
 10700           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10701           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10702           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10703           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10704           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10705        ELSE
 10706           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10707           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10708           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10709           MOVE ZEROS                TO WS-SUB1
 10710                                        WS-COMMISSION
 10711           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10712           IF WS-COMMISSION > ZEROS
 10713              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10714              GO TO 0550-st-comm-cap-check
 10715           END-IF
 10716           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10717           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10718           IF CTBL-TABLE-FOUND
 10719              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10720              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10721              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10722              GO TO 0550-st-comm-cap-check
 10723           ELSE
 10724              IF FIRST-TIME-THROUGH
 10725                  GO TO 0540-GET-LF-COMP
 10726              ELSE
 10727                  MOVE ER-2609                TO WS-ERROR
 10728                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10729                  GO TO 0550-st-comm-cap-check.
 10730
 10731     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10732        IF AM-L-COM (SUB1) NUMERIC
 10733           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10734           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10735           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10736           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10737           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10738        ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 197
* EL050.cbl
 10739           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10740           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10741           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10742           MOVE ZEROS                TO WS-SUB1
 10743                                        WS-COMMISSION
 10744           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10745           IF WS-COMMISSION IS GREATER THAN ZEROS
 10746              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10747              GO TO 0550-st-comm-cap-check
 10748           END-IF
 10749           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10750           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10751           IF CTBL-TABLE-FOUND
 10752              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10753              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10754              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10755              GO TO 0550-st-comm-cap-check
 10756           ELSE
 10757              IF FIRST-TIME-THROUGH
 10758                  GO TO 0540-GET-LF-COMP
 10759              ELSE
 10760                  MOVE ER-2609                TO WS-ERROR
 10761                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10762
 10763 0550-st-comm-cap-check.
 10764
 10765     move +0                     to ws-tot-sl-wk-rate
 10766                                    ws-sl-wk-rate
 10767                                    ws-ga-sl-wk-rate
 10768                                    ws-tot-jl-wk-rate
 10769                                    ws-jl-wk-rate
 10770                                    ws-ga-jl-wk-rate
 10771                                    ws-tot-sa-wk-rate
 10772                                    ws-sa-wk-rate
 10773                                    ws-ga-sa-wk-rate
 10774                                    ws-tot-ja-wk-rate
 10775                                    ws-ja-wk-rate
 10776                                    ws-ga-ja-wk-rate
 10777     perform varying sub5 from +1 by +1 until
 10778        (sub5 > +10)
 10779        move +0                  to ws-wk-rate
 10780        if (am-gl-codes (sub5) <> 'Y')
 10781           and (am-com-typ(sub5) = 'C' or 'D' or 'O' or 'P')
 10782           if pb-i-lf-benefit-cd <> '  ' and '00'
 10783              move zeros         to ws-wk-rate
 10784              if (am-l-com (sub5) numeric)
 10785                 and (am-l-coma (sub5) (3:1) not = 'L' and 'M')
 10786                 move am-l-com(sub5)
 10787                                 to ws-wk-rate
 10788              else
 10789                 move pb-company-cd to ctbl-company-cd
 10790                 move pb-i-lf-benefit-cd
 10791                                 to ctbl-ben-code
 10792                 move pb-i-lf-term  to ws-work-term
 10793                 move pb-life-override-l1
 10794                                 to ctbl-ben-type
 10795                 move zeros      to ws-sub1
 10796                                    ws-commission
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 198
* EL050.cbl
 10797                 move am-l-coma (sub5)
 10798                                 to ctbl-table
 10799                 move '0540'     to ctbl-sw
 10800                 perform 0552-get-it
 10801                                 thru 0552-exit
 10802              end-if
 10803              compute ws-tot-sl-wk-rate =
 10804                 ws-tot-sl-wk-rate + ws-wk-rate
 10805              if am-com-typ(sub5) = 'C' or 'D'
 10806                 compute ws-sl-wk-rate =
 10807                    ws-sl-wk-rate + ws-wk-rate
 10808              else
 10809                 if am-com-typ(sub5) = 'O' or 'P'
 10810                    compute ws-ga-sl-wk-rate =
 10811                       ws-ga-sl-wk-rate + ws-wk-rate
 10812                 end-if
 10813              end-if
 10814
 10815              move zeros         to ws-wk-rate
 10816              if (am-j-com (sub5) numeric)
 10817                 and (am-j-coma (sub5) (3:1) not = 'L' and 'M')
 10818                 move am-j-com(sub5)
 10819                                 to ws-wk-rate
 10820              else
 10821                 move pb-company-cd to ctbl-company-cd
 10822                 move pb-i-lf-benefit-cd
 10823                                 to ctbl-ben-code
 10824                 move pb-i-lf-term  to ws-work-term
 10825                 move pb-life-override-l1
 10826                                 to ctbl-ben-type
 10827                 move zeros      to ws-sub1
 10828                                    ws-commission
 10829                 move am-j-coma (sub5)
 10830                                 to ctbl-table
 10831                 move '0540'     to ctbl-sw
 10832                 perform 0552-get-it
 10833                                 thru 0552-exit
 10834              end-if
 10835              compute ws-tot-jl-wk-rate =
 10836                 ws-tot-jl-wk-rate + ws-wk-rate
 10837              if am-com-typ(sub5) = 'C' or 'D'
 10838                 compute ws-jl-wk-rate =
 10839                    ws-jl-wk-rate + ws-wk-rate
 10840              else
 10841                 if am-com-typ(sub5) = 'O' or 'P'
 10842                    compute ws-ga-jl-wk-rate =
 10843                       ws-ga-jl-wk-rate + ws-wk-rate
 10844                 end-if
 10845              end-if
 10846           end-if
 10847           move zeros            to ws-wk-rate
 10848
 10849           if pb-i-ah-benefit-cd <> '  ' and '00'
 10850              if (am-a-com (sub5) numeric)
 10851                 and (am-a-coma (sub5) (3:1) not = 'L' and 'M')
 10852                 move am-a-com(sub5)
 10853                                 to ws-wk-rate
 10854              else
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 199
* EL050.cbl
 10855                 move pb-company-cd to ctbl-company-cd
 10856                 move pb-i-ah-benefit-cd
 10857                                 to ctbl-ben-code
 10858                 move pb-i-ah-term  to ws-work-term
 10859                 move pb-ah-override-l1
 10860                                 to ctbl-ben-type
 10861                 move zeros      to ws-sub1
 10862                                    ws-commission
 10863                 move am-a-coma (sub5)
 10864                                 to ctbl-table
 10865                 move '0530'     to ctbl-sw
 10866                 perform 0552-get-it
 10867                                 thru 0552-exit
 10868              end-if
 10869              compute ws-tot-sa-wk-rate =
 10870                 ws-tot-sa-wk-rate + ws-wk-rate
 10871              if am-com-typ(sub5) = 'C' or 'D'
 10872                 compute ws-sa-wk-rate =
 10873                    ws-sa-wk-rate + ws-wk-rate
 10874              else
 10875                 if am-com-typ(sub5) = 'O' or 'P'
 10876                    compute ws-ga-sa-wk-rate =
 10877                       ws-ga-sa-wk-rate + ws-wk-rate
 10878                 end-if
 10879              end-if
 10880           end-if
 10881        end-if
 10882     end-perform
 10883
 10884     go to 0550-continue
 10885
 10886     .
 10887 0552-get-it.
 10888
 10889     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD
 10890     MOVE ZEROS                  TO WS-SUB1
 10891                                    WS-COMMISSION
 10892     MOVE ' '                    TO WS-CTBL-READ-SW
 10893     PERFORM 8300-READ-CTBL-TABLE
 10894                                 THRU 8300-EXIT
 10895     IF FIRST-TIME-THROUGH
 10896        MOVE 'AA'                TO CTBL-BEN-CODE
 10897        PERFORM 8300-READ-CTBL-TABLE
 10898                                 THRU 8300-EXIT
 10899     END-IF
 10900     IF CTBL-TABLE-FOUND
 10901        if pb-life-override-l1 = ctbl-ben-type
 10902           move pb-i-lf-benefit-amt
 10903                                 to WS-COMM-CK-AMT
 10904        else
 10905           compute ws-comm-ck-amt =
 10906              pb-I-ah-benefit-amt * pb-i-ah-term
 10907        end-if
 10908        PERFORM 8800-GET-COMP-RATE
 10909                                 THRU 8800-EXIT
 10910     else
 10911        move zeros               to ws-wk-rate
 10912     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 200
* EL050.cbl
 10913
 10914     .
 10915 0552-exit.
 10916     exit.
 10917
 10918 0550-continue.
 10919
 10920     if ws-lf-joint-indicator = 'J'
 10921        if (ws-jl-wk-rate > ws-st-comm-cap-jl)
 10922           and (ws-st-comm-cap-jl <> zeros)
 10923           MOVE ER-1956          TO WS-ERROR
 10924           PERFORM 9900-ERROR-FORMAT
 10925                                 THRU 9900-EXIT
 10926        end-if
 10927        if (ws-ga-jl-wk-rate > ws-st-ga-comm-cap-jl)
 10928           and (ws-st-ga-comm-cap-jl <> zeros)
 10929           MOVE ER-1959          TO WS-ERROR
 10930           PERFORM 9900-ERROR-FORMAT
 10931                                 THRU 9900-EXIT
 10932        end-if
 10933        if (ws-tot-jl-wk-rate > ws-st-tot-comm-cap-jl)
 10934           and (ws-st-tot-comm-cap-jl <> zeros)
 10935           MOVE ER-1962          TO WS-ERROR
 10936           PERFORM 9900-ERROR-FORMAT
 10937                                 THRU 9900-EXIT
 10938        end-if
 10939     else
 10940        if (ws-sl-wk-rate > ws-st-comm-cap-sl)
 10941           and (ws-st-comm-cap-sl <> zeros)
 10942           MOVE ER-1955          TO WS-ERROR
 10943           PERFORM 9900-ERROR-FORMAT
 10944                                 THRU 9900-EXIT
 10945        end-if
 10946        if (ws-ga-sl-wk-rate > ws-st-ga-comm-cap-sl)
 10947           and (ws-st-ga-comm-cap-sl <> zeros)
 10948           MOVE ER-1958          TO WS-ERROR
 10949           PERFORM 9900-ERROR-FORMAT
 10950                                 THRU 9900-EXIT
 10951        end-if
 10952        if (ws-tot-sl-wk-rate > ws-st-tot-comm-cap-sl)
 10953           and (ws-st-tot-comm-cap-sl <> zeros)
 10954           MOVE ER-1961          TO WS-ERROR
 10955           PERFORM 9900-ERROR-FORMAT
 10956                                 THRU 9900-EXIT
 10957        end-if
 10958
 10959     if ws-ah-joint-indicator = 'J'
 10960        if (ws-sa-wk-rate > ws-st-comm-cap-ja)
 10961           and (ws-st-comm-cap-ja <> zeros)
 10962           MOVE ER-1957          TO WS-ERROR
 10963           PERFORM 9900-ERROR-FORMAT
 10964                                 THRU 9900-EXIT
 10965        end-if
 10966        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-ja)
 10967           and (ws-st-ga-comm-cap-ja <> zeros)
 10968           MOVE ER-1960          TO WS-ERROR
 10969           PERFORM 9900-ERROR-FORMAT
 10970                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 201
* EL050.cbl
 10971        end-if
 10972        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-ja)
 10973           and (ws-st-tot-comm-cap-ja <> zeros)
 10974           MOVE ER-1963          TO WS-ERROR
 10975           PERFORM 9900-ERROR-FORMAT
 10976                                 THRU 9900-EXIT
 10977        end-if
 10978     else
 10979        if (ws-sa-wk-rate > ws-st-comm-cap-sa)
 10980           and (ws-st-comm-cap-sa <> zeros)
 10981           MOVE ER-1957          TO WS-ERROR
 10982           PERFORM 9900-ERROR-FORMAT
 10983                                 THRU 9900-EXIT
 10984        end-if
 10985        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-sa)
 10986           and (ws-st-ga-comm-cap-sa <> zeros)
 10987           MOVE ER-1960          TO WS-ERROR
 10988           PERFORM 9900-ERROR-FORMAT
 10989                                 THRU 9900-EXIT
 10990        end-if
 10991        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-sa)
 10992           and (ws-st-tot-comm-cap-sa <> zeros)
 10993           MOVE ER-1963          TO WS-ERROR
 10994           PERFORM 9900-ERROR-FORMAT
 10995                                 THRU 9900-EXIT
 10996        end-if
 10997     end-if
 10998     .
 10999 0560-EDIT-CONTINUE.
 11000     MOVE ZEROS                  TO WS-LF-PMF-COMM
 11001                                    WS-AH-PMF-COMM
 11002*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 11003*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 11004     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 11005        (SUB1 > +10)
 11006        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 11007           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 11008           MOVE '0530'           TO CTBL-SW
 11009           MOVE ' '              TO WS-CTBL-READ-SW
 11010           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 11011           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 11012           MOVE '0540'           TO CTBL-SW
 11013           MOVE ' '              TO WS-CTBL-READ-SW
 11014           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 11015        END-IF
 11016     END-PERFORM
 11017     GO TO 0564-EDIT-CONTINUE
 11018     .
 11019 0561-CHECK-AH.
 11020     IF (NO-AH-COVERAGE)
 11021        OR (NO-AH-BENEFIT-MATCH)
 11022        CONTINUE
 11023     ELSE
 11024        IF (AM-A-COM (SUB1) NUMERIC)
 11025           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11026           IF (AM-COM-TYP (SUB1) = 'A')
 11027              AND (WS-AH-PMF-COMM = ZEROS)
 11028              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 202
* EL050.cbl
 11029           END-IF
 11030           CONTINUE
 11031        ELSE
 11032           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 11033           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 11034           MOVE PB-AH-OVERRIDE-L1
 11035                                 TO CTBL-BEN-TYPE
 11036           MOVE ZEROS            TO WS-SUB1
 11037                                    WS-COMMISSION
 11038           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 11039           PERFORM 8300-READ-CTBL-TABLE
 11040                                 THRU 8300-EXIT
 11041           IF CTBL-TABLE-FOUND
 11042              IF (AM-COM-TYP (SUB1) = 'A')
 11043                 AND (WS-AH-PMF-COMM = ZEROS)
 11044                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 11045                                        PB-I-AH-TERM
 11046                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11047                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 11048              END-IF
 11049              CONTINUE
 11050           ELSE
 11051              IF FIRST-TIME-THROUGH
 11052                 GO TO 0561-CHECK-AH
 11053              ELSE
 11054                 MOVE ER-2609    TO WS-ERROR
 11055                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11056              END-IF
 11057           END-IF
 11058        END-IF
 11059     END-IF
 11060     .
 11061 0561-EXIT.
 11062     EXIT.
 11063 0563-CHECK-LF.
 11064     IF (NO-LIFE-COVERAGE)
 11065        OR (NO-LF-BENEFIT-MATCH)
 11066        CONTINUE
 11067     ELSE
 11068        IF WS-LF-JOINT-INDICATOR = 'J'
 11069           IF AM-J-COM (SUB1) NUMERIC
 11070              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11071              IF (AM-COM-TYP (SUB1) = 'A')
 11072                 AND (WS-LF-PMF-COMM = ZEROS)
 11073                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 11074              END-IF
 11075              CONTINUE
 11076           ELSE
 11077              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11078              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11079              MOVE PB-LIFE-OVERRIDE-L1
 11080                                 TO CTBL-BEN-TYPE
 11081              MOVE ZEROS         TO WS-SUB1
 11082                                    WS-COMMISSION
 11083              MOVE AM-J-COMA (SUB1)
 11084                                 TO CTBL-TABLE
 11085              PERFORM 8300-READ-CTBL-TABLE
 11086                                 THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 203
* EL050.cbl
 11087              IF CTBL-TABLE-FOUND
 11088                 IF (AM-COM-TYP (SUB1) = 'A')
 11089                    AND (WS-LF-PMF-COMM = ZEROS)
 11090                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 11091                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11092                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 11093                 END-IF
 11094                 CONTINUE
 11095              ELSE
 11096                 IF FIRST-TIME-THROUGH
 11097                    GO TO 0563-CHECK-LF
 11098                 ELSE
 11099                    MOVE ER-2609 TO WS-ERROR
 11100                    PERFORM 9900-ERROR-FORMAT
 11101                                 THRU 9900-EXIT
 11102*                   GO TO 0560-EDIT-CONTINUE
 11103                 END-IF
 11104              END-IF
 11105           END-IF
 11106        ELSE
 11107           IF AM-L-COM (SUB1) NUMERIC
 11108              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11109              IF (AM-COM-TYP (SUB1) = 'A')
 11110                 AND (WS-LF-PMF-COMM = ZEROS)
 11111                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 11112              END-IF
 11113              CONTINUE
 11114           ELSE
 11115              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11116              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11117              MOVE PB-LIFE-OVERRIDE-L1
 11118                                 TO CTBL-BEN-TYPE
 11119              MOVE ZEROS         TO WS-SUB1
 11120                                    WS-COMMISSION
 11121              MOVE AM-L-COMA (SUB1)
 11122                                 TO CTBL-TABLE
 11123              PERFORM 8300-READ-CTBL-TABLE
 11124                                 THRU 8300-EXIT
 11125              IF CTBL-TABLE-FOUND
 11126                 CONTINUE
 11127              ELSE
 11128                 IF FIRST-TIME-THROUGH
 11129                    GO TO 0563-CHECK-LF
 11130                 ELSE
 11131                    MOVE ER-2609 TO WS-ERROR
 11132                    PERFORM 9900-ERROR-FORMAT
 11133                                 THRU 9900-EXIT
 11134                 END-IF
 11135              END-IF
 11136           END-IF
 11137        END-IF
 11138     END-IF
 11139     .
 11140 0563-EXIT.
 11141     EXIT.
 11142 0564-EDIT-CONTINUE.
 11143
 11144     IF  PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 204
* EL050.cbl
 11145         IF PB-I-NUM-BILLED EQUAL ZEROS
 11146            MOVE ER-8148       TO WS-ERROR
 11147            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11148
 11149*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 11150*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11151*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 11152*         SET ELAPSED-BETWEEN-BIN TO TRUE
 11153*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11154*         IF NO-CONVERSION-ERROR
 11155*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 11156*         ELSE
 11157*             IF PB-COMPANY-ID EQUAL 'HAN'
 11158*                 MOVE ZEROS     TO PB-I-AGE.
 11159     IF PB-I-BIRTHDAY > LOW-VALUES
 11160        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 11161        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11162        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11163        PERFORM 8500-DATE-CONVERT
 11164                                 THRU 8500-EXIT
 11165        IF NO-CONVERSION-ERROR
 11166           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11167           IF PB-I-AGE > ZEROS
 11168              IF WS-WORK-AGE NOT = PB-I-AGE
 11169                 MOVE ER-9501    TO WS-ERROR
 11170                 PERFORM 9900-ERROR-FORMAT
 11171                                 THRU 9900-EXIT
 11172              END-IF
 11173           ELSE
 11174              MOVE WS-WORK-AGE   TO PB-I-AGE
 11175           END-IF
 11176        END-IF
 11177     END-IF
 11178     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 11179                                   WS-INS-AGE-SET
 11180     IF PB-I-AGE = ZEROS
 11181        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 11182           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11183                                   WS-INS-AGE-SET
 11184           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 11185
 11186     MOVE PB-I-AGE              TO WS-EDIT-AGE
 11187                                   WS-AH-EDIT-AGE.
 11188
 11189     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11190        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 11191        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11192        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11193        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11194        IF NO-CONVERSION-ERROR
 11195           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11196           IF PB-I-JOINT-AGE > 0
 11197              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 11198                 MOVE ER-9503    TO WS-ERROR
 11199                 PERFORM 9900-ERROR-FORMAT
 11200                                 THRU 9900-EXIT
 11201              END-IF
 11202           ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 205
* EL050.cbl
 11203              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 11204           END-IF
 11205        ELSE
 11206           MOVE ZEROS            TO PB-I-JOINT-AGE
 11207        END-IF
 11208     END-IF
 11209     IF PB-I-JOINT-AGE NOT NUMERIC
 11210        MOVE ZERO               TO PB-I-JOINT-AGE.
 11211
 11212     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 11213                                   WS-JNT-AGE-SET
 11214     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 11215        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 11216           (WS-AH-JOINT-INDICATOR = 'J')
 11217           IF PB-I-JOINT-AGE = ZEROS
 11218               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 11219                                          WS-JNT-AGE-SET
 11220               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 11221           END-IF
 11222        END-IF
 11223     END-IF
 11224
 11225     MOVE ' ' TO PB-I-LIFE-INDICATOR
 11226     IF WS-LF-JOINT-INDICATOR = 'J'
 11227        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 11228        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11229            IF  PB-I-JOINT-AGE = ZERO
 11230                MOVE ER-2686       TO WS-ERROR
 11231                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11232            ELSE
 11233                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11234                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 11235                    IF PB-COMPANY-ID NOT = 'LBL'
 11236                        MOVE ER-2685    TO WS-ERROR
 11237                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11238
 11239     IF WS-AH-JOINT-INDICATOR = 'J'
 11240        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11241            IF  PB-I-JOINT-AGE = ZERO
 11242                MOVE ER-2686       TO WS-ERROR
 11243                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11244            ELSE
 11245                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11246                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 11247                                           WS-EDIT-AGE
 11248                    IF PB-COMPANY-ID NOT = 'LBL'
 11249                        MOVE ER-2685    TO WS-ERROR
 11250                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11251
 11252******************************************************************
 11253*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 11254******************************************************************
 11255
 11256     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11257        (WS-AH-SPECIAL-CALC-CD = 'O')
 11258        NEXT SENTENCE
 11259     ELSE
 11260        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 206
* EL050.cbl
 11261          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 11262           (WS-LF-JOINT-INDICATOR = 'J'  OR
 11263            WS-AH-JOINT-INDICATOR = 'J')  AND
 11264           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 11265            MOVE ER-2627             TO WS-ERROR
 11266            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11267
 11268     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11269        (WS-AH-SPECIAL-CALC-CD = 'O')
 11270         NEXT SENTENCE
 11271     ELSE
 11272         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11273            WS-AH-JOINT-INDICATOR = 'J'
 11274             IF PB-I-JOINT-INSURED = SPACES
 11275                 IF PB-COMPANY-ID NOT = 'JAL'
 11276                     MOVE ER-2696    TO WS-ERROR
 11277                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11278
 11279     IF PB-COMPANY-ID NOT = 'BOA'
 11280        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11281           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11282           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 11283               PB-I-JOINT-INSURED NOT = SPACES)
 11284                MOVE ER-2691         TO WS-ERROR
 11285                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11286
 11287     IF PB-COMPANY-ID = 'BOA'
 11288        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11289           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11290            IF PB-I-JOINT-AGE NOT = ZEROS
 11291                MOVE ER-2691         TO WS-ERROR
 11292                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11293
 11294     IF PB-COMPANY-ID = 'CRI'
 11295        IF PB-I-SIG-SW = 'J'
 11296           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 11297              WS-AH-JOINT-INDICATOR NOT = 'J'
 11298              MOVE ER-2675       TO WS-ERROR
 11299              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11300
 11301     IF PB-COMPANY-ID = 'CRI'
 11302        IF PB-I-SIG-SW = 'S'
 11303           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11304              WS-AH-JOINT-INDICATOR = 'J'
 11305              MOVE ER-2676       TO WS-ERROR
 11306              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11307
 11308     IF PB-COMPANY-ID = 'CVL'
 11309         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 11310            (WS-LF-JOINT-INDICATOR NOT = 'J')
 11311              MOVE ER-2783           TO WS-ERROR
 11312              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11313     IF (WS-LF-JOINT-INDICATOR = 'J')
 11314        AND (WS-AH-JOINT-INDICATOR = 'J')
 11315        AND (PB-I-LF-TERM > 120)
 11316        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 11317        MOVE ER-2783             TO WS-ERROR
 11318        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 207
* EL050.cbl
 11319     END-IF
 11320     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 11321
 11322     IF PB-I-INDV-GRP-OVRD = 'I'
 11323        MOVE ER-2666             TO WS-ERROR
 11324        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11325        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 11326
 11327     IF PB-I-INDV-GRP-OVRD = 'G'
 11328        MOVE ER-2666             TO WS-ERROR
 11329        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11330        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 11331
 11332     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 11333        NEXT SENTENCE
 11334     ELSE
 11335        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 11336
 11337     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 11338        IF WS-ERROR = ER-2666
 11339           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11340           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 11341
 11342     IF PB-COMPANY-ID = 'CID'
 11343        IF PB-STATE = 'UT' OR 'MO'
 11344           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 11345                 OR '76' OR '77')
 11346                      OR
 11347               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 11348                   OR '41' OR '42' OR '63' OR '64' OR '65'
 11349                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 11350                   OR '2K' OR '2L'))
 11351              AND PB-I-INDV-GRP-CD = 'I'
 11352              MOVE ER-2721             TO WS-ERROR
 11353              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11354           END-IF
 11355        END-IF
 11356     END-IF
 11357
 11358     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 11359     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 11360        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 11361     ELSE
 11362        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 11363     END-IF
 11364
 11365*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 11366*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 11367     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 11368                                    ACCOUNT-AH-CK-SW.
 11369
 11370     IF PB-REISSUED-CERT       OR
 11371        PB-REIN-ONLY-CERT      OR
 11372        PB-POLICY-IS-DECLINED  OR
 11373        PB-POLICY-IS-VOIDED
 11374*       OR PB-MONTHLY-CERT
 11375         GO TO 3000-CONTINUE-EDIT.
 11376
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 208
* EL050.cbl
 11377     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11378        IF WS-EDIT-AGE           > +65
 11379           MOVE ER-2709          TO WS-ERROR
 11380           PERFORM 9900-ERROR-FORMAT
 11381                                 THRU 9900-EXIT
 11382        ELSE
 11383           IF WS-EDIT-AGE        > +55
 11384              MOVE ER-2718       TO WS-ERROR
 11385              PERFORM 9900-ERROR-FORMAT
 11386                                 THRU 9900-EXIT
 11387           END-IF
 11388        END-IF
 11389     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11390        IF WS-EDIT-AGE           > +65
 11391           MOVE ER-2709          TO WS-ERROR
 11392           PERFORM 9900-ERROR-FORMAT
 11393                                 THRU 9900-EXIT
 11394        END-IF
 11395     END-IF
 11396     .
 11397
 11398 0565-LIFE-PLAN-LIMIT-EDITS.
 11399
 11400     IF NOT LF-PLAN-MASTER-FOUND
 11401        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 11402                                    EC-AM-LF-MAX-TOT-BEN
 11403        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11404
 11405     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 11406
 11407     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11408         IF PL-LM-AGE (1) = ZEROS
 11409             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11410
 11411     IF NO-LF-BENEFIT-MATCH          OR
 11412        WS-LF-BENEFIT-CD = ZEROS     OR
 11413        WS-LF-SPECIAL-CALC-CD = 'M'
 11414        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11415
 11416     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 11417     MOVE +1                     TO SUB2.
 11418
 11419     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11420        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11421           MOVE +5   TO SUB2
 11422           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11423              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11424              (PL-LM-AGE (SUB2) EQUAL +0)
 11425              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 11426              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11427
 11428     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 11429
 11430     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 11431                               + PB-I-LF-ALT-BENEFIT-AMT.
 11432
 11433 0568-CHECK-LIFE-ATT-AGE.
 11434
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 209
* EL050.cbl
 11435     IF PL-ATT-AGE NUMERIC AND
 11436        PL-ATT-AGE > +0
 11437        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11438     END-IF
 11439*    IF PL-ATT-AGE NUMERIC AND
 11440*       PL-ATT-AGE > +0
 11441*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11442*       IF PB-I-BIRTHDAY > LOW-VALUES
 11443*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11444*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11445*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11446*          SET BIN-PLUS-ELAPSED  TO TRUE
 11447*          PERFORM 8500-DATE-CONVERT
 11448*                                THRU 8500-EXIT
 11449*          IF NO-CONVERSION-ERROR
 11450*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11451*             MOVE ER-2669       TO WS-ERROR
 11452*             PERFORM 9900-ERROR-FORMAT
 11453*                                THRU 9900-EXIT
 11454*          END-IF
 11455*       ELSE
 11456*          IF WS-ATT-AGE >= PL-ATT-AGE
 11457*             MOVE ER-2669       TO WS-ERROR
 11458*             PERFORM 9900-ERROR-FORMAT
 11459*                                THRU 9900-EXIT
 11460*          END-IF
 11461*       END-IF
 11462*    END-IF
 11463     .
 11464 0570-CHECK-LIFE-LIMITS.
 11465
 11466     IF PB-COMPANY-ID EQUAL 'CRI'
 11467        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11468           IF SUB2 GREATER THAN +4
 11469              MOVE ER-2637 TO WS-ERROR
 11470              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11471              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11472
 11473     IF PB-COMPANY-ID  =  'NCL'
 11474        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11475            SUB2 GREATER THAN +8
 11476             MOVE 'U'         TO PB-BATCH-ENTRY
 11477             MOVE ER-2637     TO WS-ERROR
 11478             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11479             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11480
 11481     IF SUB2 > +8
 11482        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11483           AND (PB-I-SIG-SW = 'Y')
 11484           CONTINUE
 11485        ELSE
 11486           MOVE ER-2637          TO WS-ERROR
 11487           PERFORM 9900-ERROR-FORMAT
 11488                                 THRU 9900-EXIT
 11489        END-IF
 11490        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11491     END-IF
 11492     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 210
* EL050.cbl
 11493     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11494     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11495
 11496     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11497        ADD +1  TO SUB2
 11498        GO TO 0570-CHECK-LIFE-LIMITS.
 11499
 11500     IF PB-COMPANY-ID = 'NCL'
 11501         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11502
 11503     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11504        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11505        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11506           AND (PB-I-SIG-SW = 'Y')
 11507           CONTINUE
 11508        ELSE
 11509           MOVE ER-2637          TO WS-ERROR
 11510           PERFORM 9900-ERROR-FORMAT
 11511                                 THRU 9900-EXIT
 11512        END-IF
 11513     END-IF
 11514     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11515
 11516
 11517 0570-CHECK-NCL-LIFE-LIMITS.
 11518
 11519     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11520        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11521         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11522
 11523     IF APP-CERT-USED
 11524         IF SUB2  LESS THAN  +5
 11525             MOVE +5          TO SUB2
 11526             GO TO 0570-CHECK-LIFE-LIMITS.
 11527
 11528     MOVE ER-2637             TO WS-ERROR.
 11529     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11530
 11531     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11532
 11533 0575-CHECK-NCL-SIG-SWITCH.
 11534
 11535     IF NOT APP-CERT-USED
 11536         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11537
 11538     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11539        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11540        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11541        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11542         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11543
 11544     IF SUB2 GREATER THAN +4
 11545         IF PL-LM-AGE (5) = ZEROS  AND
 11546            PL-LM-AGE (6) = ZEROS  AND
 11547            PL-LM-AGE (7) = ZEROS  AND
 11548            PL-LM-AGE (8) = ZEROS
 11549             MOVE  ER-1927        TO WS-ERROR
 11550             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 211
* EL050.cbl
 11551             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11552         ELSE
 11553             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11554                 MOVE  ER-1920    TO WS-ERROR
 11555                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11556
 11557     IF PB-I-SIG-SW  = 'Y'
 11558       IF NOT PB-I-POLICY-ACCEPTED  AND
 11559          NOT PB-I-POLICY-DECLINED
 11560           MOVE 'U'               TO PB-BATCH-ENTRY
 11561           MOVE  ER-1926          TO WS-ERROR
 11562           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11563
 11564
 11565 0580-AH-PLAN-LIMIT-EDITS.
 11566
 11567     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11568        IF PB-I-AH-BENEFIT-AMT > +1250
 11569           MOVE ER-2702          TO WS-ERROR
 11570           PERFORM 9900-ERROR-FORMAT
 11571                                 THRU 9900-EXIT
 11572        END-IF
 11573     END-IF
 11574
 11575     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11576        AND (PB-MONTHLY-CERT)
 11577        IF PB-I-AH-BENEFIT-AMT > +3000
 11578           MOVE ER-2881          TO WS-ERROR
 11579           PERFORM 9900-ERROR-FORMAT
 11580                                 THRU 9900-EXIT
 11581        END-IF
 11582     END-IF
 11583     IF NOT AH-PLAN-MASTER-FOUND
 11584        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11585        GO TO 3000-CONTINUE-EDIT.
 11586
 11587     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11588
 11589     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11590         IF PL-LM-AGE (1) = ZEROS
 11591             GO TO 3000-CONTINUE-EDIT.
 11592
 11593     IF NO-AH-BENEFIT-MATCH          OR
 11594        WS-AH-BENEFIT-CD = ZEROS     OR
 11595        WS-AH-SPECIAL-CALC-CD = 'M'
 11596        GO TO 3000-CONTINUE-EDIT.
 11597
 11598     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11599     MOVE +1                     TO SUB2.
 11600
 11601     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11602        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11603           MOVE +5 TO SUB2
 11604           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11605              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11606              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11607              (PL-LM-AGE (SUB2) EQUAL +0)
 11608              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 212
* EL050.cbl
 11609              GO TO 3000-CONTINUE-EDIT.
 11610
 11611     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11612
 11613 0590-CHECK-AH-ATT-AGE.
 11614
 11615     IF PL-ATT-AGE NUMERIC AND
 11616        PL-ATT-AGE GREATER THAN +0
 11617        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11618     END-IF
 11619*       IF WS-ATT-AGE >= PL-ATT-AGE
 11620*          MOVE ER-3054          TO WS-ERROR
 11621*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11622     .
 11623 0597-CHECK-AH-LIMITS.
 11624
 11625     IF PB-COMPANY-ID EQUAL 'CRI'
 11626        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11627           IF SUB2 GREATER THAN +4
 11628              MOVE ER-2638       TO WS-ERROR
 11629              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11630              GO TO 3000-CONTINUE-EDIT.
 11631
 11632     IF PB-COMPANY-ID  =  'NCL'
 11633        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11634            SUB2 GREATER THAN +8
 11635             MOVE 'U'            TO PB-BATCH-ENTRY
 11636             MOVE ER-2638        TO WS-ERROR
 11637             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11638             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11639
 11640     IF SUB2 > +8
 11641        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11642           AND (PB-I-SIG-SW = 'Y')
 11643           CONTINUE
 11644        ELSE
 11645           MOVE ER-2638          TO WS-ERROR
 11646           PERFORM 9900-ERROR-FORMAT
 11647                                 THRU 9900-EXIT
 11648        END-IF
 11649        GO TO 3000-CONTINUE-EDIT
 11650     END-IF
 11651
 11652     IF PB-COMPANY-ID = 'CRI'
 11653        IF WS-ERROR = ER-2638
 11654           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11655
 11656     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11657     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11658     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11659     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11660
 11661     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11662        ADD +1                   TO SUB2
 11663        GO TO 0597-CHECK-AH-LIMITS.
 11664
 11665     IF PB-COMPANY-ID = 'NCL'
 11666         GO TO 0597-CHECK-NCL-AH-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 213
* EL050.cbl
 11667
 11668     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11669        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11670        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11671                                 > PL-LM-AMT (SUB2))
 11672        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11673           AND (PB-I-SIG-SW = 'Y')
 11674           CONTINUE
 11675        ELSE
 11676           MOVE ER-2638          TO WS-ERROR
 11677           PERFORM 9900-ERROR-FORMAT
 11678                                 THRU 9900-EXIT
 11679        END-IF
 11680     END-IF
 11681
 11682     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11683         IF  WS-ERROR    EQUAL    ER-2638
 11684             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11685                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11686                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11687                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11688                MOVE  ER-1910    TO  WS-ERROR
 11689                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11690
 11691     IF PB-COMPANY-ID = 'CRI'
 11692        IF WS-ERROR = ER-2638
 11693            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11694            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11695            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11696
 11697     GO TO 3000-CONTINUE-EDIT.
 11698
 11699 0597-CHECK-NCL-AH-LIMITS.
 11700
 11701     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11702        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11703        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11704                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11705         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11706
 11707     IF APP-CERT-USED
 11708         IF SUB2  LESS THAN  +5
 11709             MOVE +5             TO SUB2
 11710             GO TO 0597-CHECK-AH-LIMITS.
 11711
 11712     MOVE ER-2638                TO WS-ERROR.
 11713     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11714
 11715     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11716
 11717 0599-CHECK-NCL-SIG-SWITCH.
 11718
 11719     IF NOT APP-CERT-USED
 11720         GO TO 3000-CONTINUE-EDIT.
 11721
 11722     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11723        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11724        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 214
* EL050.cbl
 11725        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11726         GO TO 3000-CONTINUE-EDIT.
 11727
 11728     IF SUB2 GREATER THAN +4
 11729         IF PL-LM-AGE (5) = ZEROS  AND
 11730            PL-LM-AGE (6) = ZEROS  AND
 11731            PL-LM-AGE (7) = ZEROS  AND
 11732            PL-LM-AGE (8) = ZEROS
 11733             MOVE  ER-1927        TO WS-ERROR
 11734             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11735             GO TO 3000-CONTINUE-EDIT
 11736         ELSE
 11737             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11738                 MOVE  ER-1920    TO WS-ERROR
 11739                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11740
 11741     IF PB-I-SIG-SW  = 'Y'
 11742       IF NOT PB-I-POLICY-ACCEPTED  AND
 11743          NOT PB-I-POLICY-DECLINED
 11744           MOVE 'U'               TO PB-BATCH-ENTRY
 11745           MOVE  ER-1926          TO WS-ERROR
 11746           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11747
 11748******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 215
* EL050.cbl
 11750
 11751 3000-CONTINUE-EDIT.
 11752
 11753     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11754     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11755     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11756     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11757     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11758
 11759     IF BROWSE-STARTED
 11760        PERFORM 9990-RETURN THRU 9990-EXIT
 11761        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11762
 11763     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11764        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11765        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11766        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11767*       MOVE 1                   TO DC-OPTION-CODE
 11768        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11769        IF DATE-CONVERSION-ERROR
 11770           MOVE ER-2622          TO WS-ERROR
 11771           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11772        ELSE
 11773           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11774              MOVE ER-2623       TO WS-ERROR
 11775              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11776           ELSE
 11777              MOVE ER-2622       TO WS-ERROR
 11778              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11779
 11780     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11781     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11782     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11783*    MOVE 1                      TO DC-OPTION-CODE.
 11784     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11785     IF DATE-CONVERSION-ERROR
 11786        GO TO 3005-EDIT-CONTINUE
 11787     ELSE
 11788        IF DC-ELAPSED-DAYS GREATER +180
 11789           MOVE ER-2613          TO WS-ERROR
 11790           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11791        ELSE
 11792           IF DC-ELAPSED-DAYS GREATER +90
 11793              MOVE ER-2612       TO WS-ERROR
 11794              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11795           ELSE
 11796             IF DC-ELAPSED-DAYS GREATER +60
 11797                MOVE ER-2614     TO WS-ERROR
 11798                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11799
 11800 3005-EDIT-CONTINUE.
 11801
 11802     IF PB-CANCELLATION
 11803         GO TO 3700-EDIT-CANCEL.
 11804
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 216
* EL050.cbl
 11806******************************************************************
 11807*                  E D I T   I S S U E                           *
 11808******************************************************************
 11809
 11810 3020-EDIT-ISSUE.
 11811
 11812      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11813      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11814      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11815      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11816      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11817
 11818     IF PB-ISSUE-FORCE
 11819        OR PB-ISSUE-DATE-FORCED
 11820        OR PB-FORCE-OFF
 11821        OR PB-OVERCHARGE-FORCE
 11822        or pb-exceeded-limit-forced
 11823        CONTINUE
 11824     ELSE
 11825        MOVE ER-2670             TO WS-ERROR
 11826        PERFORM 9900-ERROR-FORMAT
 11827                                 THRU 9900-EXIT
 11828     END-IF
 11829     .
 11830 3022-SET-POLICY-STATUS.
 11831
 11832     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11833
 11834     IF (PB-REISSUED-CERT)
 11835             OR
 11836        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11837         AND (PB-MONTHLY-CERT))
 11838         MOVE '5'                TO PB-I-ENTRY-STATUS
 11839         MOVE 'E'                TO PB-BATCH-ENTRY
 11840     END-IF
 11841
 11842     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11843        IF PB-MONTHLY-CERT
 11844           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11845        END-IF
 11846        IF PB-CASH-CERT
 11847           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11848        END-IF
 11849     END-IF
 11850     IF PB-POLICY-IS-DECLINED
 11851         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11852     IF PB-POLICY-IS-VOIDED
 11853         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11854     IF PB-NEEDS-UNDERWRITING
 11855         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11856     IF PB-REIN-ONLY-CERT
 11857         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11858     IF PB-PREM-ACCTNG-ONLY
 11859         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11860
 11861     MOVE SPACE                  TO PB-I-OB-FLAG.
 11862
 11863     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 217
* EL050.cbl
 11864         MOVE ER-2665            TO WS-ERROR
 11865         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11866         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11867
 11868     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11869        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11870           MOVE 'Z'             TO PB-I-OB-FLAG.
 11871
 11872     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11873        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11874           MOVE 'Z'             TO PB-I-OB-FLAG.
 11875
 11876     IF ACCOUNT-MAST-FOUND
 11877         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11878         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11879         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11880         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11881         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11882         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11883         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11884     END-IF
 11885
 11886     IF ACCOUNT-MAST-FOUND
 11887        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11888         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11889
 11890     IF (ACCOUNT-MAST-FOUND)
 11891*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11892        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11893        IF PB-REISSUED-CERT
 11894           CONTINUE
 11895        ELSE
 11896           MOVE ER-2608          TO WS-ERROR
 11897           PERFORM 9900-ERROR-FORMAT
 11898                                 THRU 9900-EXIT
 11899         END-IF
 11900     END-IF
 11901
 11902     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11903        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11904        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11905
 11906**********   DMD CUSTOM CODE FOLLOWS  **********
 11907 3024-EDIT-DMD-FIELDS.
 11908     IF PB-COMPANY-ID NOT = 'DMD'
 11909        GO TO 3025-EDIT-REINSURANCE.
 11910
 11911*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11912*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11913*** ERROR IF THEY ARE NOT EQUAL.
 11914
 11915     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11916     SET BIN-TO-GREG               TO TRUE.
 11917     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11918     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11919**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11920
 11921     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 218
* EL050.cbl
 11922     SET BIN-TO-GREG               TO TRUE.
 11923     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11924     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11925**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11926
 11927     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11928        MOVE ER-8116               TO WS-ERROR
 11929        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11930
 11931     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11932
 11933     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11934                                      WK-FULL-CERT-NO.
 11935     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11936
 11937     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11938
 11939     IF PB-VALID-LIFE
 11940        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11941     ELSE
 11942        IF PB-VALID-AH
 11943          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11944
 11945
 11946     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11947     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11948     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11949                                      DCUA-UNDRWRTR-CODE
 11950                                      DCUA-UNDRWRTR-GROUP-CODE
 11951                                      DCUA-RETURN-CODE.
 11952
 11953****************************************************************
 11954*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11955***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11956***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11957***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11958***   TO THIS RECORD.                                        ***
 11959****************************************************************
 11960     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11961     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11962     IF DCUA-SUCCESSFUL-PROCESS
 11963        GO TO 3024-EDIT-DL7-CONT.
 11964
 11965     IF DCUA-RETURN-CODE EQUAL '01'
 11966        MOVE ER-8110               TO WS-ERROR
 11967        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11968        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11969        GO TO 3024-EDIT-DL7-CONT.
 11970
 11971     IF DCUA-RETURN-CODE EQUAL '02'
 11972        MOVE ER-8111               TO WS-ERROR
 11973        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11974        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11975        GO TO 3024-EDIT-DL7-CONT.
 11976
 11977     IF DCUA-RETURN-CODE EQUAL '03'
 11978        MOVE ER-8074               TO WS-ERROR
 11979        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 219
* EL050.cbl
 11980        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11981        GO TO 3024-EDIT-DL7-CONT.
 11982
 11983     IF DCUA-RETURN-CODE EQUAL '04'
 11984        MOVE ER-8075               TO WS-ERROR
 11985        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11986        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11987        GO TO 3024-EDIT-DL7-CONT.
 11988
 11989     IF DCUA-RETURN-CODE EQUAL '05'
 11990        MOVE ER-8076               TO WS-ERROR
 11991        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11992        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11993        GO TO 3024-EDIT-DL7-CONT.
 11994
 11995     IF DCUA-RETURN-CODE EQUAL '06'
 11996        MOVE ER-8077               TO WS-ERROR
 11997        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11998        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11999        GO TO 3024-EDIT-DL7-CONT.
 12000
 12001     IF DCUA-RETURN-CODE EQUAL '07'
 12002        MOVE ER-8078               TO WS-ERROR
 12003        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12004        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12005        GO TO 3024-EDIT-DL7-CONT.
 12006
 12007     IF DCUA-RETURN-CODE EQUAL 'E1'
 12008        MOVE ER-8079               TO WS-ERROR
 12009        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12010        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12011        GO TO 3024-EDIT-DL7-CONT.
 12012
 12013     IF DCUA-RETURN-CODE EQUAL 'E2'
 12014        MOVE ER-8080               TO WS-ERROR
 12015        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12016        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12017        GO TO 3024-EDIT-DL7-CONT.
 12018
 12019     IF DCUA-RETURN-CODE EQUAL 'E3'
 12020        MOVE ER-8098               TO WS-ERROR
 12021        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12022        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12023        GO TO 3024-EDIT-DL7-CONT.
 12024
 12025     IF DCUA-RETURN-CODE EQUAL 'C1'
 12026        MOVE ER-8099               TO WS-ERROR
 12027        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12028        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12029        GO TO 3024-EDIT-DL7-CONT.
 12030
 12031     IF DCUA-RETURN-CODE EQUAL 'U1'
 12032        MOVE ER-8109               TO WS-ERROR
 12033        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12034        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12035        GO TO 3024-EDIT-DL7-CONT.
 12036
 12037     IF DCUA-RETURN-CODE EQUAL 'N1'
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 220
* EL050.cbl
 12038        MOVE ER-8112               TO WS-ERROR
 12039        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12040        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12041        GO TO 3024-EDIT-DL7-CONT.
 12042
 12043     IF DCUA-RETURN-CODE EQUAL 'N2'
 12044        MOVE ER-8113               TO WS-ERROR
 12045        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12046        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12047        GO TO 3024-EDIT-DL7-CONT.
 12048
 12049     IF DCUA-RETURN-CODE EQUAL 'N3'
 12050        MOVE ER-8114               TO WS-ERROR
 12051        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12052        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12053        GO TO 3024-EDIT-DL7-CONT.
 12054
 12055     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 12056     MOVE ER-8097                  TO WS-ERROR.
 12057     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 12058     GO TO 3024-EDIT-DL7-CONT.
 12059
 12060 3024-EDIT-DL7-CONT.
 12061
 12062     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 12063     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 12064     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 12065        NEXT SENTENCE
 12066     ELSE
 12067        MOVE ER-9263               TO WS-ERROR
 12068        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12069
 12070******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 12071******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 12072     IF DCUA-CERT-NUMBER = PB-CERT-NO
 12073        NEXT SENTENCE
 12074     ELSE
 12075        MOVE ER-8039               TO WS-ERROR
 12076        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12077
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 221
* EL050.cbl
 12079****************************************************************
 12080*** VALIDATE STATE  : DLO022                                 ***
 12081****************************************************************
 12082     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 12083     MOVE SPACES                   TO DVSC-RETURN-CODE.
 12084
 12085     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 12086     IF DVSC-SUCCESSFUL-EDIT
 12087        GO TO 3024-EDIT-DL22-CONT.
 12088
 12089     IF DVSC-RETURN-CODE EQUAL '01'
 12090        MOVE ER-8300               TO WS-ERROR
 12091        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12092        GO TO 3024-EDIT-DL22-CONT.
 12093
 12094     IF DVSC-RETURN-CODE EQUAL '02'
 12095        MOVE ER-8301               TO WS-ERROR
 12096        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12097        GO TO 3024-EDIT-DL22-CONT.
 12098
 12099     IF DVSC-RETURN-CODE EQUAL '03'
 12100        MOVE ER-8302               TO WS-ERROR
 12101        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12102        GO TO 3024-EDIT-DL22-CONT.
 12103
 12104     IF DVSC-RETURN-CODE EQUAL 'N1'
 12105        MOVE ER-8304               TO WS-ERROR
 12106        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12107        GO TO 3024-EDIT-DL22-CONT.
 12108
 12109     MOVE ER-8303                  TO WS-ERROR
 12110     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12111
 12112 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 222
* EL050.cbl
 12114****************************************************************
 12115*** VALIDATE LOAN OFFICER : DLO021                           ***
 12116****************************************************************
 12117
 12118     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 12119     MOVE SPACES                    TO DVLO-RETURN-CODE.
 12120     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 12121     IF DVLO-SUCCESSFUL-EDIT
 12122        GO TO 3024-EDIT-DL21-CONT.
 12123
 12124     IF DVLO-RETURN-CODE EQUAL '01'
 12125        MOVE ER-8081               TO WS-ERROR
 12126        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12127        GO TO 3024-EDIT-DL21-CONT.
 12128
 12129     IF DVLO-RETURN-CODE EQUAL '02'
 12130        MOVE ER-8082               TO WS-ERROR
 12131        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12132        GO TO 3024-EDIT-DL21-CONT.
 12133
 12134     IF DVLO-RETURN-CODE EQUAL '03'
 12135        MOVE ER-8083               TO WS-ERROR
 12136        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12137        GO TO 3024-EDIT-DL21-CONT.
 12138
 12139     IF DVLO-RETURN-CODE EQUAL '04'
 12140        MOVE ER-8084               TO WS-ERROR
 12141        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12142        GO TO 3024-EDIT-DL21-CONT.
 12143
 12144     IF DVLO-RETURN-CODE EQUAL '05'
 12145        MOVE ER-8085               TO WS-ERROR
 12146        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12147        GO TO 3024-EDIT-DL21-CONT.
 12148
 12149     MOVE ER-7825                  TO WS-ERROR
 12150     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12151     GO TO 3024-EDIT-DL21-CONT.
 12152
 12153 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 223
* EL050.cbl
 12155
 12156****************************************************************
 12157*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 12158****************************************************************
 12159
 12160     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 12161     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 12162     MOVE SPACES                 TO DIPF-RETURN-CODE.
 12163     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 12164     IF DIPF-SUCCESSFUL-EDIT
 12165        GO TO 3024-EDIT-DL02-CONT.
 12166
 12167     IF DIPF-RETURN-CODE EQUAL '01'
 12168        MOVE ER-8086               TO WS-ERROR
 12169        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12170        GO TO 3024-EDIT-DL02-CONT.
 12171
 12172     IF DIPF-RETURN-CODE EQUAL '02'
 12173        MOVE ER-8087               TO WS-ERROR
 12174        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12175        GO TO 3024-EDIT-DL02-CONT.
 12176
 12177     IF DIPF-RETURN-CODE EQUAL '03'
 12178        MOVE ER-8088               TO WS-ERROR
 12179        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12180        GO TO 3024-EDIT-DL02-CONT.
 12181
 12182     MOVE ER-8095                  TO WS-ERROR
 12183     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12184     GO TO 3024-EDIT-DL02-CONT.
 12185
 12186 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 224
* EL050.cbl
 12188
 12189****************************************************************
 12190*** VALIDATE BANK ID : DLO003                                ***
 12191****************************************************************
 12192
 12193     MOVE WK-GREG-CENT           TO WCG-CENT.
 12194     MOVE WK-GREG-YYMM           TO WCG-REST.
 12195     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 12196        MOVE ER-8040               TO WS-ERROR
 12197        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12198
 12199     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 12200     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 12201     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 12202     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 12203     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 12204     IF DVBI-SUCCESSFUL-EDIT
 12205        GO TO 3024-EDIT-DL03-CONT.
 12206
 12207     IF DVBI-RETURN-CODE EQUAL '01'
 12208        MOVE ER-8089               TO WS-ERROR
 12209        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12210        GO TO 3024-EDIT-DL03-CONT.
 12211
 12212     IF DVBI-RETURN-CODE EQUAL '02'
 12213        MOVE ER-8090               TO WS-ERROR
 12214        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12215        GO TO 3024-EDIT-DL03-CONT.
 12216
 12217     IF DVBI-RETURN-CODE EQUAL '03'
 12218        MOVE ER-8091               TO WS-ERROR
 12219        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12220        GO TO 3024-EDIT-DL03-CONT.
 12221
 12222     IF DVBI-RETURN-CODE EQUAL '04'
 12223        MOVE ER-8092               TO WS-ERROR
 12224        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12225        GO TO 3024-EDIT-DL03-CONT.
 12226
 12227     IF DVBI-RETURN-CODE EQUAL '05'
 12228        MOVE ER-8093               TO WS-ERROR
 12229        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12230        GO TO 3024-EDIT-DL03-CONT.
 12231
 12232     IF DVBI-RETURN-CODE EQUAL '06'
 12233        MOVE ER-8094               TO WS-ERROR
 12234        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12235        GO TO 3024-EDIT-DL03-CONT.
 12236
 12237     MOVE ER-8096                  TO WS-ERROR
 12238     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12239     GO TO 3024-EDIT-DL03-CONT.
 12240
 12241 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 225
* EL050.cbl
 12243
 12244     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 12245        NEXT SENTENCE
 12246     ELSE
 12247        MOVE ER-8042               TO WS-ERROR
 12248        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12249
 12250     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 12251     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 12252     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 12253
 12254     IF DMPF-RETURN-CODE = '01'
 12255        MOVE ER-8067               TO WS-ERROR
 12256        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12257        GO TO 3024-EDIT-DL01-CONT.
 12258
 12259     IF DMPF-RETURN-CODE = '02'
 12260        MOVE ER-8068               TO WS-ERROR
 12261        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12262        GO TO 3024-EDIT-DL01-CONT.
 12263
 12264     IF DMPF-RETURN-CODE = '03'
 12265        MOVE ER-8069               TO WS-ERROR
 12266        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12267        GO TO 3024-EDIT-DL01-CONT.
 12268
 12269     IF DMPF-RETURN-CODE = 'E1'
 12270        MOVE ER-8070               TO WS-ERROR
 12271        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12272        GO TO 3024-EDIT-DL01-CONT.
 12273
 12274     IF DMPF-RETURN-CODE = 'N1'
 12275        MOVE ER-8071               TO WS-ERROR
 12276        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12277        GO TO 3024-EDIT-DL01-CONT.
 12278
 12279     IF DMPF-RETURN-CODE NOT = 'OK'
 12280        MOVE ER-8072               TO WS-ERROR
 12281        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12282
 12283 3024-EDIT-DL01-CONT.
 12284******************************************************************
 12285***  VALIDATES RATE CODES : DLO017                             ***
 12286******************************************************************
 12287
 12288      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 12289      MOVE SPACES                   TO DVRC-RETURN-CODE.
 12290      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 12291      IF DVRC-SUCCESSFUL-EDIT
 12292        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 12293        GO TO 3024-CHECK-VALID-RATE.
 12294
 12295      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 12296
 12297      IF DVRC-RETURN-CODE EQUAL '01'
 12298         MOVE ER-7817                   TO WS-ERROR
 12299         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12300         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 226
* EL050.cbl
 12301
 12302      IF DVRC-RETURN-CODE EQUAL '02'
 12303         MOVE ER-7818                   TO WS-ERROR
 12304         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12305         GO TO 3025-EDIT-REINSURANCE.
 12306
 12307      IF DVRC-RETURN-CODE EQUAL '03'
 12308         MOVE ER-7819                   TO WS-ERROR
 12309         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12310         GO TO 3025-EDIT-REINSURANCE.
 12311
 12312       MOVE ER-7820                     TO WS-ERROR.
 12313       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12314       GO TO 3025-EDIT-REINSURANCE.
 12315
 12316******************************************************************
 12317***  GET PREMIUM RATES : DLO011                                ***
 12318******************************************************************
 12319
 12320 3024-CHECK-VALID-RATE.
 12321
 12322     IF VALID-RATE-CODE
 12323        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 12324        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 12325        MOVE SPACES                TO DPRB-RETURN-CODE
 12326        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 12327     ELSE
 12328         GO TO 3025-EDIT-REINSURANCE.
 12329
 12330      IF DPRB-SUCCESSFUL-PROCESS
 12331         IF PB-VALID-LIFE
 12332             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 12333             GO TO 3025-EDIT-REINSURANCE
 12334         ELSE
 12335             IF PB-VALID-AH
 12336                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 12337                 GO TO 3025-EDIT-REINSURANCE.
 12338
 12339      IF DPRB-RETURN-CODE EQUAL '01'
 12340         MOVE ER-7812                   TO WS-ERROR
 12341         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12342         GO TO 3025-EDIT-REINSURANCE.
 12343
 12344      IF DPRB-RETURN-CODE EQUAL '02'
 12345         MOVE ER-7813                   TO WS-ERROR
 12346         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12347         GO TO 3025-EDIT-REINSURANCE.
 12348
 12349      IF DPRB-RETURN-CODE EQUAL '03'
 12350         MOVE ER-7814                   TO WS-ERROR
 12351         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12352         GO TO 3025-EDIT-REINSURANCE.
 12353
 12354      IF DPRB-RETURN-CODE EQUAL '04'
 12355         IF NOT DPRB-1ST-TIME
 12356            MOVE ER-7815                   TO WS-ERROR
 12357            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12358            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 227
* EL050.cbl
 12359          ELSE
 12360         IF PB-VALID-LIFE
 12361            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12362          ELSE
 12363            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12364         END-IF
 12365         MOVE SPACES                TO DOCC-RETURN-CODE
 12366         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 12367         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 12368         IF DOCC-RETURN-CODE = 'OK'
 12369             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 12370             GO TO 3024-CHECK-VALID-RATE
 12371           ELSE
 12372             MOVE ER-7823               TO WS-ERROR
 12373             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 12374             GO TO 3025-EDIT-REINSURANCE.
 12375
 12376       MOVE ER-7816                     TO WS-ERROR.
 12377       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12378       GO TO 3025-EDIT-REINSURANCE.
 12379
 12380**********   DMD CUSTOM CODE ABOVE    **********
 12381
 12382 3025-EDIT-REINSURANCE.
 12383     IF PB-I-SPECIAL-REIN-CODE = SPACE
 12384         GO TO 3027-EDIT-CONTINUE.
 12385
 12386     MOVE LOW-VALUES               TO ERREIN-KEY.
 12387     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 12388     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 12389                                      REIN-CODE-2
 12390                                      REIN-CODE-3.
 12391     MOVE 'A'                      TO REIN-TYPE.
 12392
 12393     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 12394
 12395     MOVE '3026' TO REIN-SW.
 12396     MOVE ' '                   TO WS-REIN-READ-SW.
 12397
 12398     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12399     IF REIN-TABLE-NOT-FOUND
 12400         GO TO 3026-NO-SPEC-TABLE.
 12401
 12402     MOVE RE-TABLE              TO WK-REIN-TABLE.
 12403     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12404                                   WS-NSP-ST-CD-LF.
 12405     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12406                                   WS-NSP-ST-CD-AH.
 12407
 12408     GO TO 3040-EDIT-CONTINUE.
 12409
 12410 3026-NO-SPEC-TABLE.
 12411
 12412     MOVE ER-2664                TO WS-ERROR.
 12413     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12414     GO TO 3040-EDIT-CONTINUE.
 12415
 12416 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 228
* EL050.cbl
 12417
 12418     IF PB-I-REIN-TABLE = SPACES
 12419       GO TO 3040-EDIT-CONTINUE.
 12420
 12421     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 12422          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 12423          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 12424           GO TO 3040-EDIT-CONTINUE.
 12425
 12426     MOVE LOW-VALUES            TO ERREIN-KEY.
 12427     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 12428     MOVE 'A'                   TO REIN-TYPE.
 12429     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 12430
 12431     MOVE '3028'                TO REIN-SW.
 12432     MOVE ' '                   TO WS-REIN-READ-SW.
 12433
 12434     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12435     IF REIN-TABLE-NOT-FOUND
 12436         GO TO 3028-NO-REIN-TABLE.
 12437
 12438     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12439     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12440                                   WS-NSP-ST-CD-LF.
 12441     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12442                                   WS-NSP-ST-CD-AH.
 12443
 12444     GO TO 3040-EDIT-CONTINUE.
 12445
 12446 3028-NO-REIN-TABLE.
 12447
 12448     MOVE ER-2615                TO WS-ERROR.
 12449     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12450     GO TO 3040-EDIT-CONTINUE.
 12451
 12452 3040-EDIT-CONTINUE.
 12453
 12454     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12455         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12456
 12457     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12458         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12459
 12460     IF (NOT PB-REISSUED-CERT)
 12461        AND (NOT PB-MONTHLY-CERT)
 12462        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12463            MOVE '001'           TO PB-I-LF-TERM
 12464            MOVE 'M'             TO PB-I-INSURED-SEX.
 12465
 12466     IF (NOT PB-REISSUED-CERT)
 12467        AND (NOT PB-MONTHLY-CERT)
 12468        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12469            MOVE '001'           TO PB-I-AH-TERM
 12470            MOVE 'M'             TO PB-I-INSURED-SEX.
 12471
 12472 3040-EDIT-1ST-PMT-DT.
 12473     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12474     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 229
* EL050.cbl
 12475         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12476
 12477******************************************************************
 12478*                                                                *
 12479*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12480*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12481*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12482*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12483*                                                                *
 12484******************************************************************
 12485
 12486     IF PB-EFF-DT-PROCESSING
 12487        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12488                                    PB-I-LF-EXPIRE-DT
 12489                                    PB-I-AH-EXPIRE-DT
 12490        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12491        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12492        MOVE ZERO                TO DC-ELAPSED-DAYS
 12493        MOVE +1                  TO DC-ELAPSED-MONTHS
 12494        SET BIN-PLUS-ELAPSED     TO TRUE
 12495*       MOVE 6                   TO DC-OPTION-CODE
 12496        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12497        IF NO-CONVERSION-ERROR
 12498           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12499
 12500******************************************************************
 12501*                                                                *
 12502*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12503*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12504*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12505*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12506*                                                                *
 12507******************************************************************
 12508
 12509     IF PB-EXT-DAYS-PROCESSING
 12510          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12511                                         PB-I-LF-EXPIRE-DT
 12512                                         PB-I-AH-EXPIRE-DT
 12513          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12514          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12515          MOVE +1                     TO DC-ELAPSED-MONTHS
 12516          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12517          SET BIN-PLUS-ELAPSED        TO TRUE
 12518*         MOVE 6                      TO DC-OPTION-CODE
 12519          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12520          IF NO-CONVERSION-ERROR
 12521             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12522
 12523******************************************************************
 12524*                                                                *
 12525*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12526*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12527*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12528*        (EXPIRE DATE - (TERM -1))  *  -1.
 12529*                                                                *
 12530******************************************************************
 12531
 12532     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 230
* EL050.cbl
 12533        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12534           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12535              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12536              MOVE PB-I-AH-TERM      TO WS-TERM
 12537           ELSE
 12538              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12539              MOVE PB-I-LF-TERM      TO WS-TERM
 12540        ELSE
 12541           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12542              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12543              MOVE PB-I-LF-TERM      TO WS-TERM
 12544           ELSE
 12545              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12546              MOVE PB-I-AH-TERM      TO WS-TERM.
 12547
 12548     IF PB-EXPIRE-DT-PROCESSING
 12549        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12550        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12551        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12552        MOVE ZERO                TO DC-ELAPSED-DAYS
 12553                                    DC-ODD-DAYS-OVER
 12554          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12555          SET BIN-PLUS-ELAPSED    TO TRUE
 12556*         MOVE 6                  TO DC-OPTION-CODE
 12557          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12558          IF NO-CONVERSION-ERROR
 12559             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12560
 12561******************************************************************
 12562*                                                                *
 12563*            1ST PAYMENT DATE PROCESSING                         *
 12564*                                                                *
 12565******************************************************************
 12566
 12567     IF PB-1ST-PMT-DT-PROCESSING
 12568        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12569                                    PB-I-AH-EXPIRE-DT
 12570        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12571
 12572     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12573         NEXT SENTENCE
 12574     ELSE
 12575         MOVE ER-2680                 TO WS-ERROR
 12576         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12577         GO TO 3060-ORIG-TERM-CHECK.
 12578
 12579     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12580     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12581     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12582*    MOVE 1                      TO DC-OPTION-CODE.
 12583     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12584                                    DC-ELAPSED-DAYS
 12585                                    DC-ODD-DAYS-OVER.
 12586
 12587     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12588
 12589     IF DATE-CONVERSION-ERROR
 12590        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 231
* EL050.cbl
 12591
 12592     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12593     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12594        AND (WS-LF-COVERAGE-TYPE = 'L')
 12595        IF (DC-ELAPSED-MONTHS > 1)
 12596                      OR
 12597           ((DC-ELAPSED-MONTHS = 1)
 12598           AND (DC-ODD-DAYS-OVER > 0))
 12599           MOVE ER-2882          TO WS-ERROR
 12600           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12601        END-IF
 12602     END-IF
 12603     if dc-elapsed-months > 0
 12604        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12605        + dc-odd-days-over
 12606     end-if
 12607     IF PB-EXT-DAYS-PROCESSING
 12608        CONTINUE
 12609     ELSE
 12610        IF DC-ELAPSED-MONTHS = +0
 12611           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12612        ELSE
 12613           IF (WS-LF-EARNINGS-CALC = '4')
 12614              AND (DC-ELAPSED-MONTHS > ZERO)
 12615              AND (DC-ELAPSED-DAYS > ZERO)
 12616              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12617           ELSE
 12618              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12619                                 THRU 6499-EXIT
 12620              MOVE WS-ODD-DAYS-OVER
 12621                                 TO PB-I-EXTENTION-DAYS
 12622           END-IF
 12623        END-IF
 12624     END-IF
 12625******************************************************************
 12626*                                                                *
 12627*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12628*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12629*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12630*            AND ANY ODD DAYS.                                   *
 12631*                                                                *
 12632******************************************************************
 12633
 12634     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12635                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12636     IF WS-LF-EARNINGS-CALC NOT = '4'
 12637        IF DC-ELAPSED-DAYS > ZEROS
 12638           MOVE ER-2681          TO WS-ERROR
 12639           PERFORM 9900-ERROR-FORMAT
 12640                                 THRU 9900-EXIT
 12641        END-IF
 12642     END-IF
 12643
 12644     IF WS-LF-EARNINGS-CALC NOT = '4'
 12645        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12646           MOVE ER-2681          TO WS-ERROR
 12647           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12648
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 232
* EL050.cbl
 12649     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12650        (PB-I-LF-TERM NOT = ZERO) AND
 12651         NOT NO-LIFE-COVERAGE
 12652          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12653          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12654          IF WS-LF-EARNINGS-CALC = '4'
 12655             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12656             PB-I-PAY-FREQUENCY
 12657          END-IF
 12658          MOVE ZERO              TO DC-ELAPSED-DAYS
 12659                                    DC-ODD-DAYS-OVER
 12660          MOVE 1                 TO DC-END-OF-MONTH
 12661          SET BIN-PLUS-ELAPSED        TO TRUE
 12662*         MOVE 6                 TO DC-OPTION-CODE
 12663          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12664          IF NO-CONVERSION-ERROR
 12665             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12666             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12667                (WS-LF-SPECIAL-CALC-CD = 'L')
 12668                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12669                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12670                  MOVE +1             TO DC-ELAPSED-MONTHS
 12671                  SET BIN-PLUS-ELAPSED  TO TRUE
 12672*                 MOVE 6              TO DC-OPTION-CODE
 12673                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12674                  IF NO-CONVERSION-ERROR
 12675                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12676
 12677* okay, i had to move the new att age edit down here because the
 12678* expiration date could get recalculated and i need the exp date
 12679     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12680        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12681        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12682        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12683           AND ZEROS
 12684           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12685           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12686           SET ELAPSED-BETWEEN-BIN TO TRUE
 12687           PERFORM 8500-DATE-CONVERT
 12688                                 THRU 8500-EXIT
 12689           IF NO-CONVERSION-ERROR
 12690              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12691                 MOVE ER-2669       TO WS-ERROR
 12692*                PERFORM 9900-ERROR-FORMAT
 12693*                                THRU 9900-EXIT
 12694              END-IF
 12695           END-IF
 12696        ELSE
 12697           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12698           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12699              MOVE ER-2669       TO WS-ERROR
 12700*             PERFORM 9900-ERROR-FORMAT
 12701*                                THRU 9900-EXIT
 12702           ELSE
 12703              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12704                 MOVE ER-1570    TO WS-ERROR
 12705                 PERFORM 9900-ERROR-FORMAT
 12706                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 233
* EL050.cbl
 12707              END-IF
 12708           END-IF
 12709        END-IF
 12710        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12711           AND ZEROS
 12712           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12713           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12714           SET ELAPSED-BETWEEN-BIN TO TRUE
 12715           PERFORM 8500-DATE-CONVERT
 12716                                 THRU 8500-EXIT
 12717           IF NO-CONVERSION-ERROR
 12718              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12719                 MOVE ER-2669       TO WS-ERROR
 12720*                PERFORM 9900-ERROR-FORMAT
 12721*                                THRU 9900-EXIT
 12722              END-IF
 12723           END-IF
 12724        ELSE
 12725           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12726             (PB-I-LF-TERM / 12)
 12727           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12728              MOVE ER-2669       TO WS-ERROR
 12729*             PERFORM 9900-ERROR-FORMAT
 12730*                                THRU 9900-EXIT
 12731           ELSE
 12732              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12733                 MOVE ER-1571    TO WS-ERROR
 12734                 PERFORM 9900-ERROR-FORMAT
 12735                                 THRU 9900-EXIT
 12736              END-IF
 12737           END-IF
 12738        END-IF
 12739        IF WS-ERROR = ER-2669
 12740           PERFORM 9900-ERROR-FORMAT
 12741                                 THRU 9900-EXIT
 12742        END-IF
 12743     END-IF
 12744     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12745        (PB-I-AH-TERM NOT = ZERO) AND
 12746         NOT NO-AH-COVERAGE
 12747          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12748             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12749             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12750             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12751          ELSE
 12752             IF WS-LF-EARNINGS-CALC = '4'
 12753                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12754                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12755                PB-I-PAY-FREQUENCY
 12756             ELSE
 12757                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12758                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12759             END-IF
 12760          END-IF
 12761          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12762                                         DC-ODD-DAYS-OVER
 12763          MOVE 1                      TO DC-END-OF-MONTH
 12764          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 234
* EL050.cbl
 12765*         MOVE 6                      TO DC-OPTION-CODE
 12766          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12767          IF NO-CONVERSION-ERROR
 12768             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12769     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12770        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12771        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12772        IF PB-I-BIRTHDAY > LOW-VALUES
 12773           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12774           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12775           SET ELAPSED-BETWEEN-BIN TO TRUE
 12776           PERFORM 8500-DATE-CONVERT
 12777                                 THRU 8500-EXIT
 12778           IF NO-CONVERSION-ERROR
 12779              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12780                 MOVE ER-3054       TO WS-ERROR
 12781*                PERFORM 9900-ERROR-FORMAT
 12782*                                THRU 9900-EXIT
 12783              END-IF
 12784           END-IF
 12785        ELSE
 12786           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12787           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12788              MOVE ER-3054       TO WS-ERROR
 12789*             PERFORM 9900-ERROR-FORMAT
 12790*                                THRU 9900-EXIT
 12791           END-IF
 12792        END-IF
 12793        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12794           AND ZEROS
 12795           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12796           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12797           SET ELAPSED-BETWEEN-BIN TO TRUE
 12798           PERFORM 8500-DATE-CONVERT
 12799                                 THRU 8500-EXIT
 12800           IF NO-CONVERSION-ERROR
 12801              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12802                 MOVE ER-3054       TO WS-ERROR
 12803*                PERFORM 9900-ERROR-FORMAT
 12804*                                THRU 9900-EXIT
 12805              END-IF
 12806           END-IF
 12807        ELSE
 12808           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12809             (PB-I-AH-TERM / 12)
 12810           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12811              MOVE ER-3054       TO WS-ERROR
 12812*             PERFORM 9900-ERROR-FORMAT
 12813*                                THRU 9900-EXIT
 12814           END-IF
 12815        END-IF
 12816        IF WS-ERROR = ER-3054
 12817           PERFORM 9900-ERROR-FORMAT
 12818                                 THRU 9900-EXIT
 12819        END-IF
 12820     END-IF
 12821     MOVE SPACE                       TO DC-END-OF-MONTH.
 12822
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 235
* EL050.cbl
 12823     IF PB-COMPANY-ID = 'NCB'
 12824        GO TO 3040-EDIT-EXTENSION-DAYS.
 12825
 12826     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12827       AND
 12828        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12829        NEXT SENTENCE
 12830     ELSE
 12831        GO TO 3040-EDIT-EXTENSION-DAYS.
 12832
 12833     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12834        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12835        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12836     ELSE
 12837        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12838        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12839
 12840     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12841*    MOVE '1'      TO DC-OPTION-CODE
 12842     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12843     IF (NO-CONVERSION-ERROR)
 12844        AND (DC-ELAPSED-MONTHS > +1)
 12845        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12846        MOVE ER-2668   TO WS-ERROR
 12847        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12848
 12849 3040-EDIT-EXTENSION-DAYS.
 12850
 12851     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12852        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12853         GO TO 3050-EDIT-TERM-IN-DAYS
 12854     ELSE
 12855         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12856
 12857     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12858         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12859     ELSE
 12860        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12861           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12862           MOVE ER-2681         TO WS-ERROR
 12863           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12864
 12865     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12866        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12867        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12868         GO TO 3060-ORIG-TERM-CHECK.
 12869
 12870     GO TO 3060-ORIG-TERM-CHECK.
 12871
 12872 3050-EDIT-TERM-IN-DAYS.
 12873
 12874     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12875
 12876     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12877         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12878     ELSE
 12879         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12880            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 236
* EL050.cbl
 12881            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12882
 12883     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12884                                       REMAINDER WS-WORK-TERM.
 12885     IF WS-WORK-TERM GREATER THAN ZERO
 12886         ADD +1 TO PB-I-LF-TERM.
 12887
 12888     IF NOT NO-AH-COVERAGE
 12889         MOVE ER-2684            TO WS-ERROR
 12890         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12891
 12892
 12893 3060-ORIG-TERM-CHECK.
 12894
 12895******************************************************************
 12896*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12897******************************************************************
 12898
 12899     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12900        NEXT SENTENCE
 12901     ELSE
 12902        IF NOT NO-LIFE-COVERAGE
 12903           IF PB-I-LF-TERM NUMERIC
 12904              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12905              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12906              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12907                  NEXT SENTENCE
 12908           ELSE
 12909              MOVE ER-2647       TO WS-ERROR
 12910              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12911
 12912     IF NOT NO-AH-COVERAGE
 12913         IF PB-I-AH-TERM NUMERIC
 12914            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12915            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12916            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12917             NEXT SENTENCE
 12918          ELSE
 12919              MOVE ER-2658       TO WS-ERROR
 12920              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12921
 12922     IF PB-COMPANY-ID = 'NCB'
 12923        GO TO 3070-LOAN-TERM-CHECK.
 12924
 12925     IF POLICY-HAS-AH
 12926       AND
 12927        POLICY-HAS-LIFE
 12928       AND
 12929        PB-I-LF-TERM NUMERIC
 12930       AND
 12931        PB-I-AH-TERM NUMERIC
 12932        NEXT SENTENCE
 12933     ELSE
 12934        GO TO 3070-LOAN-TERM-CHECK.
 12935
 12936     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12937     IF WS-TEX-FACT-2 LESS THAN +0
 12938        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 237
* EL050.cbl
 12939
 12940     IF WS-TEX-FACT-2 GREATER THAN +1
 12941        MOVE ER-2668             TO WS-ERROR
 12942        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12943
 12944 3070-LOAN-TERM-CHECK.
 12945
 12946     IF (WS-LF-BENEFIT-CD = ZERO)
 12947         OR (NO-LF-BENEFIT-MATCH)
 12948            GO TO 3125-EDIT-PMT-FREQ.
 12949*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12950*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12951*          AND 'V' AND 'W' AND 'X'
 12952*          GO TO 3125-EDIT-PMT-FREQ
 12953*       END-IF
 12954*    ELSE
 12955*       IF WS-AH-DCC-TRUNC = 'T'
 12956*          CONTINUE
 12957*       ELSE
 12958*          GO TO 3125-EDIT-PMT-FREQ
 12959*       END-IF
 12960*    END-IF
 12961     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12962                    OR
 12963        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12964        AND (WS-AH-DCC-TRUNC = 'T'))
 12965        CONTINUE
 12966     ELSE
 12967        GO TO 3125-EDIT-PMT-FREQ
 12968     END-IF
 12969     IF PB-I-LOAN-TERM NOT NUMERIC
 12970         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12971
 12972     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12973        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12974*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12975        PB-I-LOAN-TERM NOT GREATER THAN +360
 12976         NEXT SENTENCE
 12977     ELSE
 12978         MOVE ER-2648            TO WS-ERROR
 12979         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12980
 12981     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12982        MOVE ER-3058             TO WS-ERROR
 12983        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12984     end-if
 12985
 12986     IF WS-STATE-ABBREVIATION = 'NC'
 12987        IF PB-I-LOAN-TERM > +59
 12988           CONTINUE
 12989        ELSE
 12990           MOVE ER-2792          TO WS-ERROR
 12991           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12992        END-IF
 12993     END-IF
 12994
 12995     .
 12996 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 238
* EL050.cbl
 12997     IF (WS-LF-BENEFIT-CD = ZERO)
 12998         OR (NO-LF-BENEFIT-MATCH)
 12999            GO TO 3127-EDIT-LOAN-OFFICER.
 13000     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 13001                    OR
 13002        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 13003        AND (WS-AH-DCC-TRUNC = 'T'))
 13004                    OR
 13005         (PB-COMPANY-ID = 'AHL')
 13006        CONTINUE
 13007     ELSE
 13008        IF (PB-I-LOAN-TERM > ZEROS)
 13009           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 13010           MOVE ER-1575          TO WS-ERROR
 13011           PERFORM 9900-ERROR-FORMAT
 13012                                 THRU 9900-EXIT
 13013        END-IF
 13014     END-IF
 13015     IF WS-LF-EARNINGS-CALC NOT = '4'
 13016         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 13017            MOVE ER-2653         TO WS-ERROR
 13018            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13019            GO TO 3127-EDIT-LOAN-OFFICER
 13020         ELSE
 13021            GO TO 3127-EDIT-LOAN-OFFICER.
 13022
 13023     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 13024         MOVE ER-2655            TO WS-ERROR
 13025         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13026         GO TO 3127-EDIT-LOAN-OFFICER.
 13027
 13028     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 13029         MOVE ER-2654            TO WS-ERROR
 13030         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13031         GO TO 3127-EDIT-LOAN-OFFICER.
 13032
 13033     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 13034         GIVING WS-TEX-FACT-2
 13035             REMAINDER WS-TEX-FACT-3.
 13036
 13037*    IF WS-TEX-FACT-3 NOT = ZERO
 13038*       MOVE ER-2654             TO WS-ERROR
 13039*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13040
 13041
 13042 3127-EDIT-LOAN-OFFICER.
 13043
 13044     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 13045        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 13046           MOVE ER-2690          TO WS-ERROR
 13047           PERFORM 9900-ERROR-FORMAT
 13048                                 THRU 9900-EXIT
 13049        ELSE
 13050           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 13051           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 13052           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 13053           MOVE PB-SV-STATE      TO LOFC-STATE
 13054           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 239
* EL050.cbl
 13055           MOVE PB-I-LOAN-OFFICER
 13056                                 TO LOFC-CODE
 13057           PERFORM 8586-READ-LOAN-OFFICER
 13058                                 THRU 8586-EXIT
 13059           IF (NOT LOFC-MASTER-FOUND)
 13060              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 13061              MOVE ER-3006       TO WS-ERROR
 13062              PERFORM 9900-ERROR-FORMAT
 13063                                 THRU 9900-EXIT
 13064           END-IF
 13065        END-IF
 13066     END-IF
 13067     .
 13068 3129-EDIT-APR.
 13069
 13070     IF (WS-LF-BENEFIT-CD = ZERO)
 13071        OR (NO-LF-BENEFIT-MATCH)
 13072        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 13073           GO TO 3130-EDIT-AGE
 13074*       ELSE
 13075*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 13076*             GO TO 3130-EDIT-AGE
 13077*          END-IF
 13078        END-IF
 13079     END-IF
 13080
 13081     IF (WS-STATE-ABBREVIATION = 'OH')
 13082         AND (PB-I-RATE-CLASS NOT = 'L ')
 13083         AND (PB-I-LF-TERM GREATER THAN 60)
 13084         AND (PB-CERT-EFF-DT GREATER WS-831031)
 13085         GO TO 3129-APR-CONT.
 13086
 13087     IF (WS-STATE-ABBREVIATION = 'RI')
 13088         AND (PB-I-LF-TERM GREATER THAN 60)
 13089         AND (PB-CERT-EFF-DT GREATER WS-831231)
 13090         GO TO 3129-APR-CONT.
 13091
 13092     IF (WS-STATE-ABBREVIATION = 'UT')
 13093         AND (PB-I-LF-TERM GREATER THAN 62)
 13094         AND (PB-CERT-EFF-DT GREATER WS-810831)
 13095         AND (PB-CERT-EFF-DT LESS WS-830901)
 13096         GO TO 3129-APR-CONT.
 13097
 13098     IF PB-COMPANY-ID = 'LAP'
 13099        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 13100           IF PB-I-LOAN-APR GREATER THAN ZEROS
 13101              MOVE ER-2656         TO WS-ERROR
 13102              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13103              GO TO 3130-EDIT-AGE.
 13104
 13105     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13106        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13107        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 13108        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13109        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 13110        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 13111         GO TO 3130-EDIT-AGE.
 13112
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 240
* EL050.cbl
 13113 3129-APR-CONT.
 13114     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 13115         (WS-LF-SPECIAL-CALC-CD = 'M'))
 13116         GO TO 3130-EDIT-AGE.
 13117
 13118     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 13119         WS-AH-BENEFIT-CD (1:1) = 'S')
 13120        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 13121        AND (PB-I-LOAN-APR = ZERO)
 13122        MOVE ER-2657             TO WS-ERROR
 13123        PERFORM 9900-ERROR-FORMAT
 13124                                 THRU 9900-EXIT
 13125        GO TO 3130-EDIT-AGE
 13126     END-IF
 13127*    IF PB-I-LOAN-APR = ZERO
 13128*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 13129*    END-IF
 13130
 13131     if pb-i-loan-apr = +99.9999
 13132        move er-2656             to ws-error
 13133        PERFORM 9900-ERROR-FORMAT
 13134                                 THRU 9900-EXIT
 13135        GO TO 3130-EDIT-AGE
 13136     end-if
 13137*    IF PB-I-LOAN-APR = ZERO
 13138*       MOVE ER-2656             TO WS-ERROR
 13139*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13140*       GO TO 3130-EDIT-AGE.
 13141
 13142*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 13143     if pb-i-loan-apr not = +99.9999
 13144        IF PB-I-LOAN-APR > +30.000
 13145           MOVE ER-2657          TO WS-ERROR
 13146           PERFORM 9900-ERROR-FORMAT
 13147                                 THRU 9900-EXIT
 13148        end-if
 13149     end-if
 13150     .
 13151 3130-EDIT-AGE.
 13152
 13153******************************************************************
 13154*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 13155******************************************************************
 13156
 13157     IF NOT NO-LIFE-COVERAGE
 13158        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13159           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 13160               MOVE ER-2628             TO WS-ERROR
 13161               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13162
 13163     IF NOT NO-AH-COVERAGE
 13164        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13165           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 13166               MOVE ER-2628         TO WS-ERROR
 13167               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13168
 13169 3133-SEX-CODE.
 13170     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 241
* EL050.cbl
 13171         IF WS-DEFAULT-SEX = 'M'
 13172             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 13173          ELSE
 13174             IF WS-DEFAULT-SEX = 'F'
 13175             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 13176
 13177     IF PB-I-INSURED-SEX = '1'
 13178         MOVE 'M' TO PB-I-INSURED-SEX.
 13179
 13180     IF PB-I-INSURED-SEX = '2'
 13181         MOVE 'F' TO PB-I-INSURED-SEX.
 13182
 13183 3134-SIG-SW-EDIT.
 13184     IF PB-I-SIG-SW = SPACE
 13185         MOVE 'N'                TO  PB-I-SIG-SW.
 13186
 13187     IF PB-COMPANY-ID = 'NCL'
 13188         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 13189             NEXT SENTENCE
 13190         ELSE
 13191             MOVE ER-1923        TO  WS-ERROR
 13192             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13193     ELSE
 13194     IF PB-COMPANY-ID = 'CRI'
 13195         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 13196             NEXT SENTENCE
 13197         ELSE
 13198             MOVE ER-2606        TO  WS-ERROR
 13199             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13200     ELSE
 13201     IF PB-COMPANY-ID = 'TMS'
 13202         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 13203             NEXT SENTENCE
 13204         ELSE
 13205             MOVE ER-2689        TO  WS-ERROR
 13206             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13207     ELSE
 13208         IF PB-I-SIG-SW = 'Y' OR 'N'
 13209             NEXT SENTENCE
 13210         ELSE
 13211             MOVE ER-2651        TO  WS-ERROR
 13212             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13213
 13214     IF PB-COMPANY-ID = 'FLA'
 13215         IF (WS-EDIT-AGE GREATER 54  OR
 13216             WS-AH-EDIT-AGE GREATER 54)  AND
 13217            PB-I-SIG-SW = 'N'
 13218            MOVE ER-2651         TO  WS-ERROR
 13219            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13220
 13221 3135-NAME-EDIT.
 13222
 13223     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 13224        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 13225        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 13226           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 13227                                 TO PB-I-JOINT-FIRST-NAME
 13228        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 242
* EL050.cbl
 13229     END-IF
 13230     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 13231        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 13232        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 13233           MOVE PB-I-JOINT-LAST-NAME (2:14)
 13234                                 TO PB-I-JOINT-LAST-NAME
 13235        END-PERFORM
 13236     END-IF
 13237     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 13238        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 13239        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 13240           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 13241                                 TO PB-I-INSURED-FIRST-NAME
 13242        END-PERFORM
 13243     END-IF
 13244     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 13245        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 13246        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 13247           MOVE PB-I-INSURED-LAST-NAME (2:14)
 13248                                 TO PB-I-INSURED-LAST-NAME
 13249        END-PERFORM
 13250     END-IF
 13251     IF PB-I-INSURED-LAST-NAME = SPACES
 13252       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13253       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13254           MOVE ER-2660    TO WS-ERROR
 13255           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13256
 13257 3136-EDIT-SEX.
 13258
 13259******************************************************************
 13260*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 13261******************************************************************
 13262
 13263     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 13264        (WS-AH-SPECIAL-CALC-CD = 'O')
 13265        NEXT SENTENCE
 13266     ELSE
 13267        IF PB-I-INSURED-SEX = 'M' OR 'F'
 13268           NEXT SENTENCE
 13269        ELSE
 13270           MOVE ER-2629            TO WS-ERROR
 13271           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13272
 13273 3137-EDIT-EFF-DATE.
 13274
 13275     IF PB-REISSUED-CERT       OR
 13276        PB-POLICY-IS-DECLINED  OR
 13277        PB-POLICY-IS-VOIDED
 13278         GO TO 3139-EDIT-COVERAGE-CODES.
 13279
 13280     MOVE SPACE                  TO WS-2671-SW
 13281                                    WS-2672-SW.
 13282
 13283     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 13284         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 13285             MOVE ER-2703        TO WS-ERROR
 13286             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 243
* EL050.cbl
 13287             GO TO 3139-EDIT-COVERAGE-CODES.
 13288
 13289     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 13290         GO TO 3139-EDIT-COVERAGE-CODES.
 13291
 13292     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13293     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 13294*    MOVE '1'                    TO DC-OPTION-CODE.
 13295     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 13296     MOVE +0                     TO DC-ELAPSED-MONTHS
 13297                                    DC-ELAPSED-DAYS.
 13298     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13299
 13300     IF DATE-CONVERSION-ERROR
 13301         GO TO 3139-EDIT-COVERAGE-CODES.
 13302
 13303     IF DC-ELAPSED-DAYS GREATER +180
 13304         MOVE ER-2672            TO WS-ERROR
 13305         MOVE 'Y'                TO WS-2672-SW
 13306         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13307     END-IF
 13308
 13309     IF WS-ERROR = ER-2671  AND
 13310        PB-COMPANY-ID  = 'LBL'
 13311        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13312        MOVE SPACE               TO WS-2671-SW
 13313        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 13314
 13315     IF PB-ISSUE-DATE-FORCED  AND
 13316      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 13317         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 13318         MOVE ER-2673            TO WS-ERROR
 13319         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13320         MOVE SPACE              TO WS-2671-SW
 13321                                    WS-2672-SW.
 13322
 13323     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 13324         IF PB-ISSUE-DATE-FORCED
 13325             MOVE ER-2600          TO  WS-ERROR
 13326             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13327         ELSE
 13328             MOVE ER-2692          TO  WS-ERROR
 13329             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13330
 13331
 13332 3139-EDIT-COVERAGE-CODES.
 13333
 13334     if pb-company-id not = 'AHL'
 13335        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 13336           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 13337           MOVE ER-2787          TO WS-ERROR
 13338           PERFORM 9900-ERROR-FORMAT
 13339                                 THRU 9900-EXIT
 13340        END-IF
 13341     end-if
 13342     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13343        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 13344                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 244
* EL050.cbl
 13345           MOVE ER-2719          TO WS-ERROR
 13346           PERFORM 9900-ERROR-FORMAT
 13347                                 THRU 9900-EXIT
 13348        END-IF
 13349     END-IF
 13350
 13351     IF PB-POLICY-IS-DECLINED  OR
 13352        PB-POLICY-IS-VOIDED
 13353         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13354
 13355     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 13356        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 13357         MOVE ER-2630                TO WS-ERROR
 13358         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13359
 13360     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 13361        PB-I-LF-BENEFIT-AMT = ZERO  AND
 13362        PB-I-LF-PREMIUM-AMT = ZERO
 13363         GO TO 3140-CHECK-AH-FOR-ZERO.
 13364
 13365     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 13366        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 13367        PB-I-LF-PREMIUM-AMT NOT = ZERO
 13368         GO TO 3140-CHECK-AH-FOR-ZERO.
 13369
 13370     IF (PB-I-LF-BENEFIT-CD = ZERO)
 13371        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13372        MOVE ER-2631             TO WS-ERROR
 13373        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13374     END-IF
 13375
 13376
 13377******************************************************************
 13378*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13379******************************************************************
 13380
 13381     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13382        NEXT SENTENCE
 13383     ELSE
 13384        IF PB-I-LF-BENEFIT-AMT = ZERO
 13385           MOVE ER-2632             TO WS-ERROR
 13386           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13387
 13388
 13389******************************************************************
 13390*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13391******************************************************************
 13392
 13393     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13394        CONTINUE
 13395     ELSE
 13396        IF PB-I-LF-PREMIUM-AMT = ZERO
 13397           IF (NOT PB-COMP-LF-PREM)
 13398              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13399              and (ws-lf-ben-category not = 'C')
 13400              MOVE ER-2633       TO WS-ERROR
 13401              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13402           END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 245
* EL050.cbl
 13403        END-IF
 13404     END-IF
 13405     .
 13406 3140-CHECK-AH-FOR-ZERO.
 13407
 13408     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 13409        PB-I-AH-BENEFIT-AMT = ZERO  AND
 13410        PB-I-AH-PREMIUM-AMT = ZERO
 13411         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13412
 13413     IF PB-COMPANY-ID = 'CSL'  AND
 13414        PB-I-AH-BENEFIT-CD = ZERO  AND
 13415        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13416        PB-I-AH-PREMIUM-AMT = ZERO
 13417         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13418
 13419     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 13420        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13421        PB-I-AH-PREMIUM-AMT NOT = ZERO
 13422         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13423
 13424     IF PB-I-AH-BENEFIT-CD = ZERO
 13425         MOVE ER-2634            TO WS-ERROR
 13426         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13427
 13428******************************************************************
 13429*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13430******************************************************************
 13431
 13432     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13433        NEXT SENTENCE
 13434     ELSE
 13435        IF PB-I-AH-BENEFIT-AMT = ZERO
 13436           MOVE ER-2635             TO WS-ERROR
 13437           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13438
 13439******************************************************************
 13440*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13441******************************************************************
 13442
 13443     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13444        NEXT SENTENCE
 13445     ELSE
 13446        IF PB-I-AH-PREMIUM-AMT = ZERO
 13447            IF NOT PB-COMP-AH-PREM
 13448                MOVE ER-2636    TO WS-ERROR
 13449                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13450
 13451
 13452 3140-EDIT-MAX-AMT-SIZES.
 13453* CUSTOM CODE FOR CLIENT    'DMD'
 13454     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13455                                     WS-RES-MUNI-TAX
 13456                                     PB-I-STATE-TAX
 13457                                     PB-I-MUNI-TAX.
 13458
 13459     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13460
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 246
* EL050.cbl
 13461     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13462        GO TO 3150-RATE-OUTSTAND-BAL.
 13463
 13464     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13465        GO TO 3150-RATE-OUTSTAND-BAL.
 13466
 13467     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13468        GO TO 3150-RATE-OUTSTAND-BAL.
 13469
 13470     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13471                             OR 'RIC')
 13472        GO TO 3150-RATE-OUTSTAND-BAL.
 13473
 13474     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13475        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13476            GO TO 3150-RATE-OUTSTAND-BAL
 13477        ELSE
 13478           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13479               GO TO 3150-RATE-OUTSTAND-BAL.
 13480
 13481     IF NOT PB-NO-MONTHS-SKIPPED
 13482        GO TO 3150-RATE-OUTSTAND-BAL.
 13483
 13484     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13485        GO TO 3150-RATE-OUTSTAND-BAL.
 13486
 13487     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13488        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13489           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13490             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13491           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13492           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13493              MOVE ER-2693     TO WS-ERROR
 13494              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13495              GO TO 3150-RATE-OUTSTAND-BAL
 13496           ELSE
 13497              GO TO 3150-RATE-OUTSTAND-BAL.
 13498
 13499 3150-RATE-OUTSTAND-BAL.
 13500
 13501* DMD RATING TEST
 13502     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13503         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13504         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13505         MOVE ER-2687                 TO WS-ERROR
 13506         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13507         MOVE 'B'                     TO PB-I-OB-FLAG
 13508         GO TO 3260-EDIT-CONTINUE.
 13509
 13510     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13511         IF  WS-ERROR    EQUAL    ER-2693
 13512             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13513                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13514                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13515                 MOVE  +0            TO  WS-ERROR.
 13516
 13517     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13518         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 247
* EL050.cbl
 13519             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13520                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13521                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13522                 MOVE  +0            TO  WS-ERROR.
 13523
 13524     IF PLAN-MASTER-AH-SW = 'Y'
 13525        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13526            IF  WS-ERROR    EQUAL    ER-2693
 13527              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13528                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13529                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13530                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13531                 MOVE  ER-1910           TO  WS-ERROR
 13532                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13533
 13534     IF PLAN-MASTER-AH-SW = 'Y'
 13535        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13536            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13537               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13538               MOVE  ER-1910           TO  WS-ERROR
 13539               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13540
 13541     IF PLAN-MASTER-AH-SW = 'Y'
 13542        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13543            IF  WS-ERROR    EQUAL    ER-2693
 13544                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13545                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13546                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13547                 MOVE  +0       TO  WS-ERROR.
 13548
 13549     IF WS-ERROR = ER-2693
 13550        IF PB-COMPANY-ID = 'JAL' AND
 13551           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13552           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13553           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13554
 13555     IF WS-ERROR = ER-2693
 13556        IF PB-COMPANY-ID = 'NCL'  AND
 13557           PB-I-AH-BENEFIT-CD = 'OA'
 13558           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13559           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13560
 13561     IF WS-ERROR = ER-2693
 13562        IF PB-COMPANY-ID = 'CNL' AND
 13563           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13564           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13565           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13566
 13567     IF WS-ERROR = ER-2693
 13568        IF PB-COMPANY-ID = 'HER'
 13569           IF WS-LEVEL
 13570              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13571              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13572
 13573     IF ((LF-BENEFIT-FOUND) AND
 13574         (NOT NO-LIFE-COVERAGE)  AND
 13575         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13576       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 248
* EL050.cbl
 13577             (NOT NO-AH-COVERAGE)    AND
 13578             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13579         NEXT SENTENCE
 13580     ELSE
 13581         GO TO 3215-EDIT-RATES.
 13582
 13583     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13584        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13585           MOVE ER-2674          TO WS-ERROR
 13586           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13587           GO TO 3215-EDIT-RATES.
 13588
 13589     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13590        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13591           MOVE ER-2674          TO WS-ERROR
 13592           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13593           GO TO 3215-EDIT-RATES.
 13594
 13595     MOVE 'B'                    TO PB-I-OB-FLAG.
 13596
 13597     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13598         NEXT SENTENCE
 13599     ELSE
 13600         IF NOT NO-LIFE-COVERAGE
 13601             IF WS-ACCT-LF-OB-RT = ZERO
 13602                MOVE ER-2641    TO WS-ERROR
 13603                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13604
 13605     IF PB-COMPANY-ID = 'CRI'
 13606       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13607         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13608         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13609         IF WS-ERROR = ER-2675
 13610            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13611            MOVE ER-2687              TO WS-ERROR
 13612            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13613         ELSE
 13614            MOVE ER-2687              TO WS-ERROR
 13615            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13616
 13617
 13618     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13619         NEXT SENTENCE
 13620     ELSE
 13621       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13622            NEXT SENTENCE
 13623       ELSE
 13624         IF NOT NO-AH-COVERAGE
 13625             IF WS-ACCT-AH-OB-RT = ZERO
 13626                MOVE ER-2642    TO WS-ERROR
 13627                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13628
 13629     IF PB-COMPANY-ID = 'CRI'
 13630       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13631         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13632         IF WS-ERROR = ER-2676
 13633            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13634            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 249
* EL050.cbl
 13635            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13636         ELSE
 13637            MOVE ER-2687              TO WS-ERROR
 13638            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13639
 13640     IF PB-COMPANY-ID NOT = 'GIC'
 13641         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13642            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13643     ELSE
 13644         IF PB-I-LF-PREM-CALC = ZEROS
 13645             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13646                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13647
 13648     IF PB-COMPANY-ID NOT = 'GIC'
 13649         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13650            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13651     ELSE
 13652         IF PB-I-AH-PREM-CALC = ZEROS
 13653             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13654                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13655
 13656     MOVE ZEROS TO PB-I-MORT-CODE.
 13657
 13658     GO TO 3260-EDIT-CONTINUE.
 13659
 13660
 13661 3215-EDIT-RATES.
 13662     IF ACCOUNT-MAST-FOUND
 13663         NEXT SENTENCE
 13664     ELSE
 13665         GO TO 3999-END-EDIT.
 13666
 13667 3220-CHECK-LF-RATES.
 13668
 13669     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13670        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13671        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13672        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13673           AND (NOT WS-LF-CASH))
 13674                           OR
 13675           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13676           AND (NOT WS-AH-CASH)))
 13677                       AND
 13678           (PB-I-ENTRY-STATUS NOT = '5')
 13679           MOVE 'M'              TO PB-BATCH-ENTRY
 13680                                    PB-I-ENTRY-STATUS
 13681        END-IF
 13682     END-IF
 13683     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13684                                    PB-I-AH-PREM-CALC
 13685                                    PB-I-LF-ALT-PREM-CALC
 13686                                    PB-I-LF-ALT-RATE
 13687                                    PB-I-LF-REI-RATE
 13688                                    PB-I-LF-ALT-REI-RATE
 13689                                    PB-I-AH-REI-RATE
 13690                                    PB-I-TOT-FEES-CALC.
 13691
 13692     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 250
* EL050.cbl
 13693        NEXT SENTENCE
 13694     ELSE
 13695        MOVE ZEROS               TO PB-I-LF-RATE
 13696                                    PB-I-AH-RATE.
 13697
 13698     IF PB-I-TOT-FEES NOT NUMERIC
 13699        MOVE ZEROS               TO PB-I-TOT-FEES
 13700     END-IF
 13701     IF PB-I-LIVES NOT NUMERIC
 13702         MOVE ZERO               TO PB-I-LIVES.
 13703
 13704     IF PB-I-NUM-BILLED NOT NUMERIC
 13705         MOVE ZERO               TO PB-I-NUM-BILLED.
 13706
 13707     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13708        MOVE +0                  TO PB-I-LF-PREM-TAX
 13709     END-IF
 13710
 13711     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13712        MOVE +0                  TO PB-I-AH-PREM-TAX
 13713     END-IF
 13714
 13715     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13716        PB-I-PAY-FREQUENCY = ZEROS
 13717            MOVE 12 TO CP-PAY-FREQUENCY
 13718     ELSE
 13719            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13720
 13721     IF PB-I-STATE-TAX NOT NUMERIC
 13722         MOVE ZEROS               TO PB-I-STATE-TAX.
 13723
 13724     IF PB-I-MUNI-TAX NOT NUMERIC
 13725         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13726
 13727     MOVE SPACES                 TO CP-BEN-CATEGORY
 13728     IF PB-COMPANY-ID  = 'CSL'  AND
 13729        PB-I-LF-TERM NOT = ZERO
 13730        COMPUTE WS-PAYMENT-AMT =
 13731             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13732        COMPUTE WS-CSL-AMT1 =
 13733             PB-I-LF-TERM * AM-MAX-MON-BEN
 13734        COMPUTE WS-CSL-AMT2 =
 13735             WS-PAYMENT-AMT * PB-I-LF-TERM
 13736        IF CP-PAY-FREQUENCY NOT = 12
 13737           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13738           MOVE '8' TO WS-CSL-CALC-CD
 13739        ELSE
 13740           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13741              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13742               AM-MAX-TOT-BEN
 13743               MOVE '6' TO WS-CSL-CALC-CD
 13744           ELSE
 13745              IF (WS-CSL-AMT1  GREATER THAN
 13746                 AM-MAX-TOT-BEN) AND
 13747                 (WS-CSL-AMT2  GREATER THAN
 13748                 AM-MAX-TOT-BEN)
 13749                 MOVE '7' TO WS-CSL-CALC-CD
 13750              ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 251
* EL050.cbl
 13751                 MOVE '5' TO WS-CSL-CALC-CD.
 13752
 13753     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13754         NEXT SENTENCE
 13755     ELSE
 13756         GO TO 3300-CHECK-AH-RATES.
 13757
 13758*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13759
 13760     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13761        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13762              OR
 13763           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13764           MOVE ER-2618          TO WS-ERROR
 13765           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13766           GO TO 3300-CHECK-AH-RATES.
 13767
 13768     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13769           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13770                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13771
 13772     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13773         MOVE ER-2687             TO WS-ERROR
 13774         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13775         MOVE 'Z000'              TO PB-I-MORT-CODE
 13776         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13777         GO TO 3300-CHECK-AH-RATES.
 13778
 13779     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13780        IF PB-I-LIVES = ZERO
 13781           MOVE ER-2688          TO WS-ERROR
 13782           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13783
 13784     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13785
 13786     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13787     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13788     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13789     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13790     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13791     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13792     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13793     MOVE '3'                    TO CP-PROCESS-TYPE.
 13794     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13795     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13796
 13797******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13798     IF PB-COMPANY-ID EQUAL 'CDL'
 13799         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13800            CP-EARN-AS-NET-PAY)
 13801             IF PB-CERT-EFF-DT GREATER  WS-931231
 13802                 MOVE '1'        TO CP-EARNING-METHOD.
 13803*******
 13804
 13805     MOVE PB-SV-STATE            TO CP-STATE.
 13806     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13807     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13808     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 252
* EL050.cbl
 13809     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13810     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13811                                    CP-RATING-BENEFIT-AMT.
 13812     IF CP-STATE-STD-ABBRV = 'OR'
 13813         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13814                                         PB-I-LF-ALT-BENEFIT-AMT.
 13815     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13816     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13817     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13818     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13819     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13820     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13821     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13822     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13823     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13824                                    CP-REMAINING-TERM
 13825                                    CP-LOAN-TERM.
 13826
 13827     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13828         NEXT SENTENCE
 13829     ELSE
 13830         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13831             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13832                                           PB-I-LF-PREMIUM-AMT.
 13833
 13834     IF PB-COMPANY-ID EQUAL 'CSL'
 13835        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13836           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13837                                         PB-I-LF-PREMIUM-AMT.
 13838
 13839     IF PB-COMPANY-ID EQUAL 'NCB'
 13840         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13841            CP-EARN-AS-NET-PAY
 13842             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13843                 PB-I-LF-PREMIUM-AMT.
 13844
 13845     IF (CP-TRUNCATED-LIFE)
 13846        or ((pb-company-id = 'AHL')
 13847           and (pb-i-loan-term > pb-i-lf-term))
 13848        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13849
 13850     IF PB-COMPANY-ID EQUAL 'CRI'
 13851        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13852
 13853     IF CP-TERM-IS-DAYS
 13854         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13855     ELSE
 13856         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13857     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13858        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13859        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13860        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13861        IF WS-LF-BEN-CATEGORY = 'D'
 13862           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13863           MOVE PB-I-LIFE-COMMISSION
 13864                                 TO CP-DCC-ACT-COMM
 13865           MOVE WS-LF-BEN-CATEGORY
 13866                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 253
* EL050.cbl
 13867        END-IF
 13868        IF (CP-BENEFIT-CD (1:1) = 'P')
 13869           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13870           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13871           add pb-i-ah-premium-amt to cp-original-premium
 13872        END-IF
 13873     END-IF
 13874     IF PB-COMPANY-ID = 'CSL'
 13875         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13876         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13877         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13878
 13879     IF PB-COMPANY-ID = 'CSL'
 13880        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13881
 13882     IF (CP-SPECIAL-CALC-CD = 'H')
 13883        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13884         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13885                                    TO CP-ALTERNATE-BENEFIT
 13886         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13887     if (pb-company-id = 'CID')
 13888        and (ws-lf-earnings-calc = '4')
 13889        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13890        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13891        move pb-i-term-type      to cp-pmt-mode
 13892        move pb-i-no-of-payments to cp-no-of-pmts
 13893     end-if
 13894     move ws-net-only-state      to cp-net-only-state
 13895     IF (PB-COMPANY-ID = 'CID')
 13896        AND (WS-LF-EARNINGS-CALC = 'B')
 13897        AND (CP-STATE-STD-ABBRV = 'MN')
 13898        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13899                                 TO CP-ALTERNATE-BENEFIT
 13900        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13901     END-IF
 13902     IF (PB-COMPANY-ID = 'CID')
 13903        AND (WS-LF-EARNINGS-CALC = 'B')
 13904        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13905                                 TO CP-ALTERNATE-BENEFIT
 13906        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13907        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13908*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13909*         pb-i-lf-alt-premium-amt
 13910        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13911        IF WS-LF-BEN-CATEGORY = 'P'
 13912           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13913        ELSE
 13914           IF WS-LF-BEN-CATEGORY = 'I'
 13915              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13916           END-IF
 13917        END-IF
 13918     END-IF
 13919     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13920     MOVE 'R'                   TO CP-RATE-FILE.
 13921     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13922
 13923     IF CP-ERROR-RATE-NOT-FOUND
 13924        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 254
* EL050.cbl
 13925        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13926        GO TO 3300-CHECK-AH-RATES.
 13927
 13928     IF PB-COMPANY-ID EQUAL 'CRI'
 13929        IF CP-ERROR-NO-LIMITS-CRI
 13930           IF NOT ACCOUNT-LIFE-CHECKED
 13931              MOVE ER-2607      TO WS-ERROR
 13932              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13933
 13934******************************************************************
 13935*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13936*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13937******************************************************************
 13938
 13939* CALC LIFE AGE AT EXPIRATION.
 13940
 13941     COMPUTE WS-AGE-AT-EXPIRE =
 13942          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13943
 13944*    IF PB-STATE = 'CO' OR 'UT'
 13945*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13946*        MOVE 'F'            TO PB-FATAL-FLAG
 13947*        MOVE ER-2709        TO WS-ERROR
 13948*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13949*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13950
 13951*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13952*        MOVE 'X'            TO PB-FATAL-FLAG
 13953*        MOVE ER-2718        TO WS-ERROR
 13954*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13955*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13956
 13957* CALC A & H AGE AT EXPIRATION.
 13958
 13959     COMPUTE WS-AGE-AT-EXPIRE =
 13960          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13961
 13962*    IF PB-STATE = 'CO' OR 'UT'
 13963*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13964*        MOVE 'F'            TO PB-FATAL-FLAG
 13965*        MOVE ER-2709        TO WS-ERROR
 13966*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13967*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13968
 13969*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13970*        MOVE 'X'            TO PB-FATAL-FLAG
 13971*        MOVE ER-2718        TO WS-ERROR
 13972*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13973*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13974
 13975     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13976        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13977
 13978     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13979        and (not pb-monthly-cert)
 13980        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13981     end-if
 13982
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 255
* EL050.cbl
 13983     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13984        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13985
 13986     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13987         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13988         MOVE ER-2639        TO WS-ERROR
 13989         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13990
 13991
 13992******************************************************************
 13993*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13994******************************************************************
 13995
 13996 PREMIUM-EDITING-IS-BYPASSED.
 13997     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13998        AND (CP-R-MAX-ATT-AGE > +0)
 13999        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 14000        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14001           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 14002           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14003           MOVE '1'              TO DC-OPTION-CODE
 14004           PERFORM 8500-DATE-CONVERT
 14005                                 THRU 8500-EXIT
 14006           IF NO-CONVERSION-ERROR
 14007              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14008                 MOVE ER-2661       TO WS-ERROR
 14009*                PERFORM 9900-ERROR-FORMAT
 14010*                                THRU 9900-EXIT
 14011              END-IF
 14012           END-IF
 14013        ELSE
 14014           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 14015           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14016              MOVE ER-2661       TO WS-ERROR
 14017*             PERFORM 9900-ERROR-FORMAT
 14018*                                THRU 9900-EXIT
 14019           ELSE
 14020              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14021                 MOVE ER-1570    TO WS-ERROR
 14022                 PERFORM 9900-ERROR-FORMAT
 14023                                 THRU 9900-EXIT
 14024              END-IF
 14025           END-IF
 14026        END-IF
 14027        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14028           MOVE PB-I-JOINT-BIRTHDAY
 14029                                 TO DC-BIN-DATE-1
 14030           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14031           MOVE '1'              TO DC-OPTION-CODE
 14032           PERFORM 8500-DATE-CONVERT
 14033                                 THRU 8500-EXIT
 14034           IF NO-CONVERSION-ERROR
 14035              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14036                 MOVE ER-2661       TO WS-ERROR
 14037*                PERFORM 9900-ERROR-FORMAT
 14038*                                THRU 9900-EXIT
 14039              END-IF
 14040           ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 256
* EL050.cbl
 14041              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 14042           END-IF
 14043        ELSE
 14044           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14045             (PB-I-LF-TERM / 12)
 14046           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14047              MOVE ER-2661       TO WS-ERROR
 14048*             PERFORM 9900-ERROR-FORMAT
 14049*                                THRU 9900-EXIT
 14050           ELSE
 14051              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14052                 MOVE ER-1571    TO WS-ERROR
 14053                 PERFORM 9900-ERROR-FORMAT
 14054                                 THRU 9900-EXIT
 14055              END-IF
 14056           END-IF
 14057        END-IF
 14058        IF WS-ERROR = ER-2661
 14059           PERFORM 9900-ERROR-FORMAT
 14060                                 THRU 9900-EXIT
 14061        END-IF
 14062     END-IF
 14063*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14064*       MOVE ER-2661             TO WS-ERROR
 14065*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14066
 14067     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14068        MOVE ER-2662             TO WS-ERROR
 14069        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14070
 14071     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14072        MOVE ER-2677             TO WS-ERROR
 14073        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14074
 14075     IF CP-ERROR-LOAN-TERM
 14076        MOVE ER-2648             TO WS-ERROR
 14077        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14078
 14079 3221-CHECK-ERROR-RATE-OPEN.
 14080
 14081     IF CP-ERROR-RATE-FILE-NOTOPEN
 14082         GO TO 3990-FILES-NOT-OPEN.
 14083
 14084     IF PB-COMPANY-ID NOT = 'DMD'
 14085        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 14086     END-IF
 14087     .
 14088 3221-CONTINUE.
 14089     MOVE ZEROS                  TO WS-DCC-LF-RATE
 14090                                    WS-DCC-AH-RATE
 14091     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14092        IF WS-LF-BEN-CATEGORY = 'D'
 14093           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 14094              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14095        END-IF
 14096     END-IF
 14097     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 14098*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 257
* EL050.cbl
 14099     IF (PB-COMPANY-ID = 'CID')
 14100        AND (WS-LF-EARNINGS-CALC = 'B')
 14101        AND (CP-STATE-STD-ABBRV = 'MN')
 14102        AND (PB-CERT-EFF-DT > X'A4FF')
 14103        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 14104     END-IF
 14105     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 14106
 14107     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 14108     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14109        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14110        AND (PB-I-POLICY-IS-MONTHLY)
 14111        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 14112        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 14113     END-IF
 14114     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 14115     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 14116     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 14117     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 14118     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14119        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 14120        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14121        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 14122        MOVE ER-2786             TO WS-ERROR
 14123        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14124     END-IF
 14125
 14126     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 14127
 14128******************************************************************
 14129*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14130******************************************************************
 14131     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14132        and ((not pb-monthly-cert)
 14133        or (ws-lf-ben-category = 'C'))
 14134        GO TO 3225-CHECK-ALT-LIFE-RATE.
 14135
 14136     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14137        GO TO 3225-CHECK-ALT-LIFE-RATE
 14138     ELSE
 14139       IF PB-I-LF-RATE = ZERO
 14140          MOVE ER-2641          TO WS-ERROR
 14141          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14142
 14143 3225-CHECK-ALT-LIFE-RATE.
 14144
 14145     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14146        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14147        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14148         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14149
 14150     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 14151         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 14152             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14153                   OR
 14154              (PB-I-LF-ALT-PREMIUM-AMT > +0
 14155              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 14156              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 258
* EL050.cbl
 14157             MOVE ER-2720        TO  WS-ERROR
 14158             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14159             GO TO 3225-RATING-CONT
 14160         ELSE
 14161             GO TO 3225-RATING-CONT.
 14162     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 14163        AND (AM-GPCD = 01 OR 06 OR 15)
 14164        MOVE ER-2798             TO WS-ERROR
 14165        PERFORM 9900-ERROR-FORMAT
 14166                                 THRU 9900-EXIT
 14167*       GO TO 3225-RATING-CONT
 14168     END-IF
 14169     if (pb-company-id = 'CID')
 14170        and (ws-lf-earnings-calc = 'B')
 14171        and (ws-lf-ben-category = 'P' or 'I')
 14172        and (ws-net-only-state = 'Y')
 14173        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 14174*       display ' balloon prem ' pb-i-lf-alt-prem-calc
 14175        go to 3225-rating-cont
 14176     end-if
 14177     IF (PB-COMPANY-ID = 'CID')
 14178        AND (WS-LF-EARNINGS-CALC = 'B')
 14179        AND (CP-STATE-STD-ABBRV = 'MN')
 14180        AND (PB-CERT-EFF-DT > X'A4FF')
 14181        GO TO 3225-RATING-CONT
 14182     END-IF
 14183     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14184        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14185           AND (PB-I-POLICY-IS-MONTHLY)
 14186           GO TO 3225-RATING-CONT
 14187        END-IF
 14188     END-IF
 14189
 14190     IF PB-COMPANY-ID EQUAL 'WDS' AND
 14191        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 14192        CP-EARN-AS-REG-BALLOON
 14193        NEXT SENTENCE
 14194     ELSE
 14195        MOVE '2'                 TO CP-EARNING-METHOD.
 14196
 14197 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14198
 14199     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14200
 14201     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14202        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14203        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14204         NEXT SENTENCE
 14205     ELSE
 14206         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 14207
 14208     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14209     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14210     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14211                                     CP-RATING-BENEFIT-AMT.
 14212     IF CP-STATE-STD-ABBRV = 'OR'
 14213         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14214                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 259
* EL050.cbl
 14215     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14216        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14217     END-IF
 14218     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14219     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14220     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14221                                    CP-REMAINING-TERM
 14222                                    CP-LOAN-TERM.
 14223     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14224        ADD +1                   TO CP-ORIGINAL-TERM
 14225                                    CP-REMAINING-TERM
 14226                                    CP-LOAN-TERM.
 14227
 14228     MOVE 'R'                   TO CP-RATE-FILE.
 14229     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14230
 14231     IF CP-ERROR-RATE-NOT-FOUND
 14232         MOVE ER-2641            TO WS-ERROR
 14233         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14234         GO TO 3300-CHECK-AH-RATES.
 14235
 14236     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 14237     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 14238
 14239     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 14240         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 14241
 14242     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 14243                               + PB-I-LF-ALT-BENEFIT-AMT.
 14244
 14245     IF ACCOUNT-LIFE-CHECKED  OR
 14246        PB-POLICY-IS-VOIDED   OR
 14247        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14248        and (not pb-monthly-cert))
 14249        GO TO 3225-CONTINUE.
 14250
 14251     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14252        GO TO 3225-CONTINUE.
 14253
 14254     IF WS-LF-BENEFIT-AMT  GREATER THAN
 14255                             EC-RT-LF-MAX-TOT-BEN
 14256        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 14257        MOVE ER-2639       TO WS-ERROR
 14258        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14259
 14260 3225-CONTINUE.
 14261     IF PB-I-LF-ALT-RATE = ZERO
 14262         MOVE ER-2659            TO WS-ERROR
 14263         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14264
 14265     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 14266        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 14267        MOVE ER-2698             TO WS-ERROR
 14268        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14269
 14270 3225-RATING-CONT.
 14271
 14272     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 260
* EL050.cbl
 14273        and (not pb-monthly-cert)
 14274         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14275         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14276         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14277            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14278            CONTINUE
 14279         ELSE
 14280            MOVE ER-2687         TO WS-ERROR
 14281            PERFORM 9900-ERROR-FORMAT
 14282                                 THRU 9900-EXIT
 14283         END-IF
 14284         GO TO 3290-EDIT-LF-REIN-RATE
 14285     END-IF
 14286
 14287* DMD RATING TEST
 14288     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14289         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14290         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14291         MOVE ER-2687                 TO WS-ERROR
 14292         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14293         GO TO 3290-EDIT-LF-REIN-RATE.
 14294
 14295 3230-CLIENT-MORT-CD-SPECIALS.
 14296
 14297     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 14298     SET BIN-TO-GREG          TO TRUE.
 14299*    MOVE ' '                 TO DC-OPTION-CODE.
 14300     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14301     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 14302
 14303 C-POS-3230-MORT-CD.
 14304     IF PB-COMPANY-ID = 'POS' AND
 14305        PB-SV-CARRIER = '2'
 14306         NEXT SENTENCE
 14307     ELSE
 14308         GO TO C-POS-3240-MORT-CD.
 14309
 14310     IF PB-SV-GROUPING = '030'
 14311        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 14312         MOVE '2350' TO PB-I-MORT-CODE
 14313      ELSE
 14314         MOVE '3300' TO PB-I-MORT-CODE.
 14315
 14316
 14317 C-POS-3240-MORT-CD.
 14318     IF PB-COMPANY-ID = 'POS' AND
 14319        PB-SV-CARRIER = '1'
 14320         NEXT SENTENCE
 14321     ELSE
 14322         GO TO 3230-CONTINUE.
 14323
 14324     IF PB-SV-STATE = '45' OR '47'
 14325        OR PB-CERT-EFF-DT LESS THAN WS-771001
 14326         MOVE '5200' TO PB-I-MORT-CODE
 14327     ELSE
 14328         MOVE '8300' TO PB-I-MORT-CODE.
 14329
 14330 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 261
* EL050.cbl
 14331
 14332     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 14333        GO TO 3240-CONTINUE
 14334     END-IF
 14335
 14336     IF PB-CERT-EFF-DT > WS-971231
 14337        GO TO 3240-CONTINUE
 14338     END-IF
 14339
 14340     IF LF-BENEFIT-FOUND AND
 14341        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 14342         MOVE 'F250'       TO PB-I-MORT-CODE
 14343     ELSE
 14344         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 14345             MOVE '7250'   TO PB-I-MORT-CODE
 14346         ELSE
 14347             MOVE '4251'   TO PB-I-MORT-CODE
 14348         END-IF
 14349     END-IF
 14350
 14351     .
 14352 3240-CONTINUE.
 14353
 14354     IF PB-COMPANY-ID NOT = 'GNL'
 14355         GO TO 3256-CONTINUE.
 14356
 14357     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 14358         MOVE 'A300' TO PB-I-MORT-CODE
 14359     ELSE
 14360         MOVE '8350' TO PB-I-MORT-CODE.
 14361
 14362 3256-CONTINUE.
 14363     IF PB-COMPANY-ID NOT = 'ABL'
 14364         GO TO 3260-EDIT-CONTINUE.
 14365
 14366     IF PB-I-LF-TERM GREATER THAN 59
 14367         MOVE 'F550' TO PB-I-MORT-CODE
 14368     ELSE
 14369         MOVE 'E550' TO PB-I-MORT-CODE.
 14370
 14371 3260-EDIT-CONTINUE.
 14372     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 14373
 14374 3290-EDIT-LF-REIN-RATE.
 14375     IF LF-REIN-NSP-NOT-USED
 14376         GO TO 3290-RATING-CONT.
 14377
 14378     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14379        GO TO 3290-RATING-CONT.
 14380     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 14381     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14382     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 14383     MOVE '3'                   TO CP-PROCESS-TYPE.
 14384     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14385
 14386******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 14387     IF PB-COMPANY-ID EQUAL 'CDL'
 14388         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 262
* EL050.cbl
 14389            CP-EARN-AS-NET-PAY)
 14390             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 14391*            MOVE SPACE          TO DC-OPTION-CODE
 14392             SET BIN-TO-GREG     TO TRUE
 14393             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14394***  Y2K PROJ 7744
 14395             IF DC-GREG-DATE-CYMD GREATER 19931231
 14396                 MOVE '1'        TO CP-EARNING-METHOD.
 14397***  Y2K PROJ 7744
 14398*******
 14399
 14400     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14401     MOVE PB-SV-STATE           TO CP-STATE.
 14402     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 14403     MOVE ZERO                  TO CP-DEVIATION-CODE
 14404                                   CP-RATE-DEV-PCT.
 14405     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 14406     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 14407                                   CP-RATING-BENEFIT-AMT.
 14408
 14409************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 14410     IF PB-COMPANY-ID EQUAL 'NCB'
 14411         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14412            CP-EARN-AS-NET-PAY
 14413             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14414                 PB-I-LF-PREMIUM-AMT.
 14415************
 14416
 14417     IF CP-STATE-STD-ABBRV = 'OR'
 14418         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14419                                         PB-I-LF-ALT-BENEFIT-AMT.
 14420     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 14421     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 14422     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 14423     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 14424     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 14425     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 14426     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 14427     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 14428                                   CP-REMAINING-TERM
 14429                                   CP-LOAN-TERM.
 14430     IF CP-TRUNCATED-LIFE
 14431        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 14432
 14433     IF CP-TERM-IS-DAYS
 14434         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14435     ELSE
 14436         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14437
 14438     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14439        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14440     END-IF
 14441     IF PB-COMPANY-ID NOT = 'TIC'
 14442          MOVE ZERO          TO CP-CLASS-CODE.
 14443
 14444     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14445
 14446     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 263
* EL050.cbl
 14447     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14448
 14449     IF CP-ERROR-RATE-NOT-FOUND
 14450        IF PB-I-OB
 14451           MOVE ER-2625      TO WS-ERROR
 14452           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14453           GO TO 3299-EDIT-CONTINUE
 14454        ELSE
 14455           MOVE ER-2643      TO WS-ERROR
 14456           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14457           GO TO 3299-EDIT-CONTINUE.
 14458
 14459     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14460
 14461     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14462     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14463
 14464     IF PB-I-LF-REI-RATE = ZERO
 14465         MOVE ER-2643        TO WS-ERROR
 14466         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14467
 14468 3290-CHECK-ALT-REIN-RATE.
 14469
 14470     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14471        GO TO 3290-RATING-CONT.
 14472
 14473     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14474     MOVE '2'                    TO CP-EARNING-METHOD.
 14475     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14476     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14477     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14478     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14479                                     CP-RATING-BENEFIT-AMT.
 14480     IF CP-STATE-STD-ABBRV = 'OR'
 14481         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14482                                         PB-I-LF-ALT-BENEFIT-AMT.
 14483     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14484        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14485     END-IF
 14486     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14487     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14488     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14489                                    CP-REMAINING-TERM
 14490                                    CP-LOAN-TERM.
 14491     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14492        ADD +1                   TO CP-ORIGINAL-TERM
 14493                                    CP-REMAINING-TERM
 14494                                    CP-LOAN-TERM.
 14495
 14496     MOVE 'R'                   TO CP-RATE-FILE.
 14497     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14498
 14499     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14500
 14501     IF PB-I-LF-ALT-REI-RATE = ZERO
 14502         MOVE ER-2643            TO WS-ERROR
 14503         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14504
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 264
* EL050.cbl
 14505 3290-RATING-CONT.
 14506
 14507     IF PB-I-OB
 14508*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14509        GO TO 3300-CHECK-AH-RATES.
 14510
 14511 3299-EDIT-CONTINUE.
 14512
 14513     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14514         NEXT SENTENCE
 14515     ELSE
 14516         MOVE ER-2620           TO WS-ERROR
 14517         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14518
 14519 3300-CHECK-AH-RATES.
 14520     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14521         NEXT SENTENCE
 14522     ELSE
 14523         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14524
 14525     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14526        and (not pb-monthly-cert))
 14527                  or
 14528        ((CF-COMPANY-ID = 'DMD') AND
 14529                (NO-DMD-RATING))
 14530         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14531            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14532            CONTINUE
 14533         ELSE
 14534            MOVE ER-2687         TO WS-ERROR
 14535            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14536         END-IF
 14537         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14538         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14539     END-IF
 14540
 14541     IF PB-I-OB
 14542        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14543
 14544     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14545         MOVE ER-2687             TO WS-ERROR
 14546         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14547         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14548         GO TO 3999-END-EDIT.
 14549
 14550*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14551     if pb-company-id = 'AHL'
 14552        go to 3300-skip-crit-per
 14553     end-if
 14554     if (pb-i-ah-crit-per not = zeros)
 14555        and (ws-ah-special-calc-cd not = 'C')
 14556        MOVE ER-1572             TO WS-ERROR
 14557        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14558        go to 3300-skip-crit-per
 14559     END-IF
 14560     if (pb-company-id = 'DCC' or 'VPP')
 14561        and (am-dcc-product-code not = spaces)
 14562        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 265
* EL050.cbl
 14563     end-if
 14564     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14565        IF PB-I-AH-CRIT-PER = ZERO
 14566           move ws-ah-max-bens   to pb-i-ah-crit-per
 14567*          MOVE ER-2618       TO WS-ERROR
 14568*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14569*          GO TO 3999-END-EDIT
 14570        END-IF
 14571     END-IF
 14572     if (ws-ah-special-calc-cd = 'C')
 14573        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14574        MOVE ER-1576             TO WS-ERROR
 14575        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14576     end-if
 14577
 14578     .
 14579 3300-skip-crit-per.
 14580     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14581     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14582     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14583     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14584     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14585     MOVE PB-SV-STATE            TO CP-STATE.
 14586     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14587     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14588     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14589*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14590     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14591     MOVE '3'                    TO CP-PROCESS-TYPE.
 14592     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14593     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14594                                    CP-RATING-BENEFIT-AMT.
 14595     IF PB-COMPANY-ID = 'CID'
 14596               OR
 14597        CP-STATE-STD-ABBRV = 'OR'
 14598         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14599                                         PB-I-AH-TERM.
 14600     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14601        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14602           AND (PB-I-POLICY-IS-MONTHLY)
 14603           MOVE PB-I-LF-BENEFIT-AMT
 14604                                 TO CP-NET-BENEFIT-AMT
 14605           move pb-i-ah-premium-amt to cp-original-premium
 14606           add pb-i-lf-premium-amt to cp-original-premium
 14607        END-IF
 14608     END-IF
 14609     MOVE SPACES                 TO CP-BEN-CATEGORY
 14610     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14611        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14612        EVALUATE TRUE
 14613           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14614              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14615              MOVE PB-I-LF-BENEFIT-AMT
 14616                                 TO CP-RATING-BENEFIT-AMT
 14617              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14618           WHEN WS-AH-BEN-CATEGORY = 'G'
 14619              MOVE PB-I-UNPAID-CASH-PRICE
 14620                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 266
* EL050.cbl
 14621           WHEN WS-AH-BEN-CATEGORY = 'D'
 14622              MOVE WS-AH-PMF-COMM
 14623                                 TO CP-DCC-PMF-COMM
 14624              MOVE PB-I-AH-COMMISSION
 14625                                 TO CP-DCC-ACT-COMM
 14626        END-EVALUATE
 14627     END-IF
 14628     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14629     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14630     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14631     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14632     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14633     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14634     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14635                                    CP-REMAINING-TERM
 14636                                    WS-WORK-TERM.
 14637     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14638
 14639     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14640     SET BIN-TO-GREG             TO TRUE.
 14641*    MOVE ' '                    TO DC-OPTION-CODE.
 14642     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14643     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE
 14644
 14645     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14646     IF NOT VALID-SKIP-CODE
 14647         MOVE ER-2683            TO WS-ERROR
 14648         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14649         GO TO 3320-RATE-CONTINUE.
 14650
 14651     IF PB-NO-MONTHS-SKIPPED
 14652         GO TO 3320-RATE-CONTINUE.
 14653
 14654     MOVE SPACE TO NUMBER-OF-MONTHS.
 14655
 14656     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14657         MOVE 'S'                TO SK-MO (6).
 14658     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14659         MOVE 'S'                TO SK-MO (7).
 14660     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14661         MOVE 'S'                TO SK-MO (8).
 14662     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14663         MOVE 'S'                TO SK-MO (9).
 14664     IF PB-I-SKIP-CODE = 'A'
 14665         MOVE 'S'                TO SK-MO (10).
 14666
 14667     MOVE 1                      TO SUB2.
 14668     MOVE PB-I-AH-TERM           TO SUB3.
 14669     MOVE WS-MONTH               TO SUB1.
 14670     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14671     GO TO 3320-RATE-CONTINUE.
 14672
 14673 3310-GET-SKIP-MO.
 14674     IF SUB1 = 13
 14675         MOVE 1                  TO SUB1.
 14676
 14677     IF SK-MO (SUB1) = 'S'
 14678         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 267
* EL050.cbl
 14679
 14680     ADD 1 TO SUB2
 14681              SUB1.
 14682
 14683 3320-RATE-CONTINUE.
 14684
 14685     IF WS-WORK-TERM = ZERO
 14686         MOVE 1                  TO WS-WORK-TERM.
 14687
 14688     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14689                                    CP-LOAN-TERM.
 14690
 14691     IF PB-COMPANY-ID EQUAL 'DMD'
 14692         NEXT SENTENCE
 14693     ELSE
 14694         MOVE ZERO               TO PB-I-AH-RATE
 14695                                    PB-I-AH-REI-RATE.
 14696
 14697
 14698     IF PB-COMPANY-ID EQUAL 'CRI'
 14699        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14700
 14701     IF PB-COMPANY-ID = 'CSL'
 14702         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14703         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14704         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14705         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14706
 14707     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14708        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14709           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14710              PB-I-RATE-DEV-PCT-LF
 14711        END-IF
 14712        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14713                                 TO CP-ALTERNATE-BENEFIT
 14714        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14715        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14716        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14717     END-IF
 14718*    if ws-clp-state not = spaces
 14719*       move ws-clp-state to cp-state
 14720*    end-if
 14721     IF (PB-COMPANY-ID = 'CID')
 14722        AND (WS-LF-EARNINGS-CALC = 'B')
 14723        AND (CP-STATE-STD-ABBRV = 'MN')
 14724        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14725     ELSE
 14726        MOVE ' '                 TO CP-AH-BALLOON-SW
 14727     END-IF
 14728     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14729     MOVE 'R'                   TO CP-RATE-FILE.
 14730     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14731
 14732     IF (CP-ERROR-RATE-NOT-FOUND)
 14733        and (not pb-monthly-cert)
 14734        IF PB-I-OB
 14735           MOVE ER-2624          TO WS-ERROR
 14736           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 268
* EL050.cbl
 14737           GO TO 3340-CALCULATE-PREMIUM-AMT
 14738        ELSE
 14739          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14740              NEXT SENTENCE
 14741          ELSE
 14742           MOVE ER-2642          TO WS-ERROR
 14743           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14744           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14745
 14746     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14747        CP-ERROR-DIV-BY-ZERO
 14748           MOVE ER-3782          TO WS-ERROR
 14749           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14750
 14751     IF PB-COMPANY-ID EQUAL 'CRI'
 14752        IF CP-ERROR-NO-LIMITS-CRI
 14753           IF NOT ACCOUNT-AH-CHECKED
 14754              MOVE ER-2607          TO WS-ERROR
 14755              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14756
 14757     IF ACCOUNT-AH-CHECKED
 14758        NEXT SENTENCE
 14759     ELSE
 14760       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14761          MOVE ER-2640           TO WS-ERROR
 14762          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14763
 14764     IF PB-COMPANY-ID = 'CRI'
 14765         IF WS-ERROR = ER-2640
 14766             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14767     IF ACCOUNT-AH-CHECKED
 14768        CONTINUE
 14769     ELSE
 14770        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14771           AND (CP-R-MAX-ATT-AGE > +0)
 14772           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14773           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14774              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14775              MOVE PB-I-AH-EXPIRE-DT
 14776                                 TO DC-BIN-DATE-2
 14777              MOVE '1'           TO DC-OPTION-CODE
 14778              PERFORM 8500-DATE-CONVERT
 14779                                 THRU 8500-EXIT
 14780              IF NO-CONVERSION-ERROR
 14781                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14782                    MOVE ER-2661       TO WS-ERROR
 14783*                   PERFORM 9900-ERROR-FORMAT
 14784*                                THRU 9900-EXIT
 14785                 END-IF
 14786              END-IF
 14787           ELSE
 14788              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14789              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14790                 MOVE ER-2661    TO WS-ERROR
 14791*                PERFORM 9900-ERROR-FORMAT
 14792*                                THRU 9900-EXIT
 14793              ELSE
 14794                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 269
* EL050.cbl
 14795                    MOVE ER-1570 TO WS-ERROR
 14796                    PERFORM 9900-ERROR-FORMAT
 14797                                 THRU 9900-EXIT
 14798                 END-IF
 14799              END-IF
 14800           END-IF
 14801           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14802              MOVE PB-I-JOINT-BIRTHDAY
 14803                                    TO DC-BIN-DATE-1
 14804              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14805              MOVE '1'              TO DC-OPTION-CODE
 14806              PERFORM 8500-DATE-CONVERT
 14807                                    THRU 8500-EXIT
 14808              IF NO-CONVERSION-ERROR
 14809                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14810                    MOVE ER-2661       TO WS-ERROR
 14811*                   PERFORM 9900-ERROR-FORMAT
 14812*                                   THRU 9900-EXIT
 14813                 END-IF
 14814              END-IF
 14815           ELSE
 14816              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14817                (PB-I-AH-TERM / 12)
 14818              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14819                 MOVE ER-2661       TO WS-ERROR
 14820*                PERFORM 9900-ERROR-FORMAT
 14821*                                   THRU 9900-EXIT
 14822              ELSE
 14823                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14824                    MOVE ER-1571 TO WS-ERROR
 14825                    PERFORM 9900-ERROR-FORMAT
 14826                                 THRU 9900-EXIT
 14827                 END-IF
 14828              END-IF
 14829           END-IF
 14830           IF WS-ERROR = ER-2661
 14831              PERFORM 9900-ERROR-FORMAT
 14832                                    THRU 9900-EXIT
 14833           END-IF
 14834        END-IF
 14835     END-IF
 14836*    IF ACCOUNT-AH-CHECKED
 14837*       NEXT SENTENCE
 14838*    ELSE
 14839*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14840*          MOVE ER-2661          TO WS-ERROR
 14841*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14842
 14843     IF ACCOUNT-AH-CHECKED
 14844        NEXT SENTENCE
 14845     ELSE
 14846        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14847           MOVE ER-2663          TO WS-ERROR
 14848           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14849
 14850     IF ACCOUNT-AH-CHECKED OR
 14851        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14852         PB-POLICY-IS-VOIDED
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 270
* EL050.cbl
 14853        NEXT SENTENCE
 14854     ELSE
 14855        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14856           MOVE ER-2667            TO WS-ERROR
 14857           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14858
 14859     IF PB-COMPANY-ID = 'CRI'
 14860         IF WS-ERROR = ER-2667
 14861             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14862
 14863     IF ACCOUNT-AH-CHECKED
 14864        NEXT SENTENCE
 14865     ELSE
 14866        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14867           MOVE ER-2678            TO WS-ERROR
 14868           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14869
 14870     IF CP-ERROR-RATE-FILE-NOTOPEN
 14871         GO TO 3990-FILES-NOT-OPEN.
 14872
 14873 3321-CONTINUE.
 14874     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14875     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14876     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14877*    IF (PB-COMPANY-ID = 'DCC')
 14878        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14879        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14880                                    PB-I-LF-ALT-PREM-CALC
 14881        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14882        IF WS-AH-BEN-CATEGORY = 'G'
 14883           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14884           + PB-I-ADDL-CLP)
 14885           * (1 + WS-TOL-CLP-PCT)
 14886*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14887        ELSE
 14888           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14889           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14890*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14891        END-IF
 14892        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14893                                 TO PB-I-AH-PREM-CALC
 14894        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14895           MOVE ER-8152          TO WS-ERROR
 14896           PERFORM 9900-ERROR-FORMAT
 14897                                 THRU 9900-EXIT
 14898        ELSE
 14899           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14900                 PB-I-ADDL-CLP)
 14901              MOVE ER-8148       TO WS-ERROR
 14902              PERFORM 9900-ERROR-FORMAT
 14903                                 THRU 9900-EXIT
 14904           END-IF
 14905        END-IF
 14906     END-IF
 14907     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14908        AND (PB-I-POLICY-IS-MONTHLY)
 14909        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14910        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 271
* EL050.cbl
 14911        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14912           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14913        END-IF
 14914     END-IF
 14915     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14916        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14917        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14918        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14919        MOVE ER-2786             TO WS-ERROR
 14920        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14921     END-IF
 14922     MOVE +0                     TO PB-I-AH-CLP
 14923     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14924        evaluate true
 14925           when WS-AH-BEN-CATEGORY = 'D'
 14926              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14927                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14928           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14929              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14930           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14931              compute ws-cred-union-fees rounded =
 14932                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14933                    pb-i-ah-commission)
 14934              COMPUTE PB-I-AH-CLP =
 14935                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14936        end-evaluate
 14937     END-IF
 14938     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14939
 14940     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14941         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14942
 14943     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14944         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14945
 14946     if (ws-ah-special-calc-cd = 'E')
 14947        and (pb-monthly-cert)
 14948        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14949     end-if
 14950     IF PB-COMPANY-ID = 'CRI'
 14951         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14952            PB-I-PAYMENT-AMOUNT = ZERO
 14953             NEXT SENTENCE
 14954         ELSE
 14955             COMPUTE PB-I-AH-PREM-CALC =
 14956                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14957                 (CP-PREMIUM-RATE / 100)
 14958             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14959                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14960                                             PB-I-RATE-DEV-PCT-AH.
 14961
 14962     IF (PB-I-AH-RATE  = ZERO)
 14963        and (not pb-monthly-cert)
 14964       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14965           NEXT SENTENCE
 14966       ELSE
 14967         MOVE ER-2642            TO WS-ERROR
 14968         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 272
* EL050.cbl
 14969
 14970     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14971     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14972     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14973     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14974     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14975     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14976
 14977     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14978        AND (WS-AH-BEN-CATEGORY = 'G')
 14979        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14980        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14981        IF CP-DEVIATION-CODE NOT = '000'
 14982           MOVE '000'            TO CP-DEVIATION-CODE
 14983           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14984           IF NO-CP-ERROR
 14985              COMPUTE PB-I-DDF-IU-RATE-UP =
 14986              PB-I-AH-CLP - CP-CALC-PREMIUM
 14987           ELSE
 14988              MOVE ER-3057        TO WS-ERROR
 14989              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14990           END-IF
 14991        END-IF
 14992     END-IF
 14993     .
 14994 3335-EDIT-AH-REIN-NSP-RATE.
 14995     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14996        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14997              compute ws-cred-union-fees rounded =
 14998                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14999                    pb-i-ah-commission)
 15000              COMPUTE PB-I-AH-CLP =
 15001                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 15002        end-if
 15003     END-IF
 15004     IF AH-REIN-NSP-NOT-USED
 15005         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15006
 15007     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 15008     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15009         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15010     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 15011     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 15012     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 15013     MOVE PB-SV-STATE            TO CP-STATE.
 15014     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15015     MOVE ZERO                   TO CP-DEVIATION-CODE
 15016                                    CP-RATE-DEV-PCT.
 15017*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 15018     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15019     MOVE '3'                    TO CP-PROCESS-TYPE.
 15020     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 15021     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15022                                    CP-RATING-BENEFIT-AMT.
 15023     IF CP-STATE-STD-ABBRV = 'OR'
 15024         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 15025                                         PB-I-AH-TERM.
 15026     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 273
* EL050.cbl
 15027     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15028     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15029     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15030     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15031     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 15032                                    CP-REMAINING-TERM
 15033                                    WS-WORK-TERM.
 15034     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 15035     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15036        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15037     END-IF
 15038     IF  PB-COMPANY-ID = 'TIC'
 15039         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 15040            MOVE ZERO TO CP-CLASS-CODE.
 15041
 15042     IF PB-COMPANY-ID NOT = 'TIC'
 15043          MOVE ZERO          TO CP-CLASS-CODE.
 15044
 15045     MOVE ZERO               TO CP-DEVIATION-CODE.
 15046
 15047     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 15048
 15049     MOVE ZERO               TO PB-I-AH-REI-RATE.
 15050
 15051     MOVE 'R'                   TO CP-RATE-FILE.
 15052     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 15053
 15054     IF CP-ERROR-RATE-NOT-FOUND
 15055         MOVE ER-2645        TO WS-ERROR
 15056         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15057         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15058
 15059     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 15060
 15061     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 15062     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 15063
 15064     IF PB-I-AH-REI-RATE = ZERO
 15065         MOVE ER-2645        TO WS-ERROR
 15066         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15067
 15068
 15069 3340-CALCULATE-PREMIUM-AMT.
 15070     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15071     SET BIN-TO-GREG             TO TRUE
 15072     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 15073     move dc-greg-date-a-edit    to ws-greg-eff-date
 15074
 15075     IF PB-COMPANY-ID = 'NCL'
 15076         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 15077             WS-AH-SPECIAL-CALC-CD = 'O')
 15078             GO TO 3999-END-EDIT.
 15079
 15080     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 15081                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 15082                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 15083                         OR 'AHL'
 15084         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 274
* EL050.cbl
 15085     ELSE
 15086         IF WS-STATE-ABBREVIATION = 'CT'
 15087             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 15088                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 15089                 COMPUTE PB-I-LF-PREM-CALC =
 15090                                     PB-I-LF-PREM-CALC * .90
 15091                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 15092                                     PB-I-LF-ALT-PREM-CALC * .90
 15093                 COMPUTE PB-I-AH-PREM-CALC =
 15094                                     PB-I-AH-PREM-CALC * .90.
 15095
 15096     IF PB-COMP-LF-PREM
 15097        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 15098        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 15099
 15100     IF PB-COMP-AH-PREM
 15101        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 15102
 15103 3340-CHECK-DCC-TOT-FEES.
 15104     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15105        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15106        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 15107        AND (PB-I-POLICY-IS-MONTHLY)
 15108        CONTINUE
 15109     ELSE
 15110        GO TO 3340-EDIT-LF-AH-TOL
 15111     END-IF
 15112     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 15113     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 15114     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15115        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 15116           PB-I-RATE-DEV-PCT-LF
 15117     END-IF
 15118     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 15119        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 15120           PB-I-RATE-DEV-PCT-AH
 15121     END-IF
 15122     MOVE 'N'                    TO CP-BEN-CATEGORY
 15123     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15124
 15125     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 15126     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 15127     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 15128     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15129     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15130     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15131     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15132     MOVE '3'                    TO CP-PROCESS-TYPE.
 15133     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15134     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 15135
 15136     MOVE PB-SV-STATE            TO CP-STATE.
 15137     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15138     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 15139     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 15140     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 15141     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15142                                    CP-RATING-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 275
* EL050.cbl
 15143     IF CP-STATE-STD-ABBRV = 'OR'
 15144         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 15145                                         PB-I-LF-ALT-BENEFIT-AMT.
 15146     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 15147     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 15148     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 15149     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15150     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15151     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15152     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15153     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 15154     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 15155                                    CP-REMAINING-TERM
 15156                                    CP-LOAN-TERM.
 15157     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 15158        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 15159           PB-I-LF-PREMIUM-AMT
 15160     end-if
 15161
 15162     IF CP-TRUNCATED-LIFE
 15163        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 15164
 15165     IF CP-TERM-IS-DAYS
 15166         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 15167     ELSE
 15168         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15169
 15170     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15171     IF CP-SPECIAL-CALC-CD = 'H'
 15172         MOVE PB-I-LF-ALT-BENEFIT-AMT
 15173                                    TO CP-ALTERNATE-BENEFIT
 15174         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 15175     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 15176     MOVE 'R'                    TO CP-RATE-FILE
 15177     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 15178     IF NOT CP-ERROR-RATE-NOT-FOUND
 15179        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 15180        IF (CP-DCC-LF-RATE NOT = ZEROS)
 15181           AND (CP-BENEFIT-CD (1:1) = 'S')
 15182           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 15183                                    PB-I-LF-PREMIUM-AMT
 15184        END-IF
 15185     ELSE
 15186        MOVE +0                  TO PB-I-TOT-FEES-CALC
 15187     END-IF
 15188     .
 15189 3340-EDIT-LF-AH-TOL.
 15190
 15191***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 15192***    UNSIGN-WRK2    =    AH   DIFFERENCE
 15193***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 15194***
 15195     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 15196         PB-I-AH-PREMIUM-AMT
 15197          GIVING WS-CALC-WORK.
 15198
 15199     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 15200        AND WS-CALC-WORK NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 276
* EL050.cbl
 15201         MOVE ER-2649            TO WS-ERROR
 15202         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15203
 15204     SUBTRACT PB-I-LF-PREM-CALC
 15205             FROM PB-I-LF-PREMIUM-AMT
 15206                 GIVING WS-UNSIGN-WRK1.
 15207
 15208     SUBTRACT PB-I-LF-ALT-PREM-CALC
 15209             FROM PB-I-LF-ALT-PREMIUM-AMT
 15210                 GIVING WS-UNSIGN-WRK4.
 15211
 15212     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 15213                                + WS-UNSIGN-WRK4.
 15214
 15215     SUBTRACT PB-I-AH-PREM-CALC
 15216             FROM PB-I-AH-PREMIUM-AMT
 15217                 GIVING WS-UNSIGN-WRK2.
 15218
 15219******************************************************************
 15220*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 15221******************************************************************
 15222
 15223     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 15224         MOVE ZERO TO WS-UNSIGN-WRK1.
 15225
 15226     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 15227         MOVE ZERO TO WS-UNSIGN-WRK2.
 15228
 15229     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 15230             GIVING WS-UNSIGN-WRK3.
 15231
 15232 3342-CONTINUE.
 15233
 15234     IF (PB-I-LF-RATE = ZERO  AND
 15235         PB-I-AH-RATE = ZERO)
 15236         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 15237            WS-AH-SPECIAL-CALC-CD = 'O'
 15238              NEXT SENTENCE
 15239         ELSE
 15240             GO TO 3345-EDIT-CONTINUE.
 15241
 15242     IF  PB-RECORD-BILL   =  'B' OR  'L'
 15243         NEXT SENTENCE
 15244     ELSE
 15245     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 15246        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 15247           IF (PB-REISSUED-CERT         OR
 15248               PB-POLICY-IS-DECLINED    OR
 15249               PB-POLICY-IS-VOIDED)
 15250              NEXT SENTENCE
 15251           ELSE
 15252              IF WS-PREM-REJECT-SW = SPACE
 15253                 MOVE ER-2652    TO WS-ERROR
 15254                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15255                 GO TO 3344-CHECK-AH
 15256              ELSE
 15257                 MOVE ER-2650    TO WS-ERROR
 15258                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 277
* EL050.cbl
 15259                 GO TO 3344-CHECK-AH.
 15260
 15261***
 15262***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 15263***
 15264
 15265     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 15266         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 15267            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15268             (1 + WS-TOL-LF-PREM-PCT)
 15269         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 15270            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15271             (1 - WS-TOL-LF-PREM-PCT)
 15272     ELSE
 15273         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 15274         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 15275
 15276***
 15277***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 15278***
 15279
 15280     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 15281         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 15282          WS-TOL-LF-PREM.
 15283
 15284     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 15285         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 15286          WS-TOL-LF-PREM.
 15287
 15288     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15289        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 15290
 15291     IF PB-REISSUED-CERT
 15292        or PB-POLICY-IS-DECLINED
 15293        or PB-POLICY-IS-VOIDED
 15294        continue
 15295     ELSE
 15296        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15297              > WS-TOL-LF-HIGH-PREM-AMT)
 15298           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15299              < WS-TOL-LF-LOW-PREM-AMT))
 15300                      or
 15301           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15302              > WS-TOL-LF-HIGH-PREM-PCT)
 15303           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15304              < WS-TOL-LF-LOW-PREM-PCT))
 15305           IF WS-PREM-REJECT-SW = SPACE
 15306              MOVE ER-2652       TO WS-ERROR
 15307              PERFORM 9900-ERROR-FORMAT
 15308                                 THRU 9900-EXIT
 15309           ELSE
 15310              MOVE ER-2650       TO WS-ERROR
 15311              PERFORM 9900-ERROR-FORMAT
 15312                                 THRU 9900-EXIT
 15313           end-if
 15314        end-if
 15315     end-if
 15316
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 278
* EL050.cbl
 15317*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 15318*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 15319*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15320*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15321
 15322     IF WS-ERROR  =  ER-2650  OR  ER-2652
 15323        IF (PB-RECORD-BILL   =  'B' OR  'L')
 15324                      OR
 15325           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 15326           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 15327           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15328           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 15329        END-IF
 15330     END-IF
 15331
 15332     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15333        IF WS-COMP-MAX-CAP GREATER THAN +0
 15334           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 15335              IF (PB-REISSUED-CERT         OR
 15336                  PB-POLICY-IS-DECLINED    OR
 15337                  PB-POLICY-IS-VOIDED)
 15338                 NEXT SENTENCE
 15339              ELSE
 15340                  MOVE ER-2646   TO  WS-ERROR
 15341                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15342
 15343 3344-CVL-TOLERANCE-CHECK.
 15344
 15345      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 15346          GO TO 3344-CHECK-AH.
 15347
 15348      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 15349          GO TO 3344-CHECK-AH.
 15350
 15351      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 15352                                     WS-UNSIGN-WRK6.
 15353
 15354      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15355          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 15356                                 + PB-I-LF-PREMIUM-AMT
 15357                                 - PB-I-LF-PREM-CALC.
 15358
 15359      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15360          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 15361                                 + PB-I-LF-ALT-PREMIUM-AMT
 15362                                 - PB-I-LF-ALT-PREM-CALC.
 15363
 15364      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 15365          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 15366              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15367                 MOVE ER-2652    TO  WS-ERROR
 15368                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15369              ELSE
 15370                 MOVE ER-2650    TO  WS-ERROR
 15371                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15372
 15373      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 15374          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 279
* EL050.cbl
 15375              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15376                 MOVE ER-2652    TO  WS-ERROR
 15377                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15378              ELSE
 15379                 MOVE ER-2650    TO  WS-ERROR
 15380                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15381
 15382 3344-CHECK-AH.
 15383
 15384****************************************************************
 15385***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 15386***
 15387
 15388     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 15389         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 15390             (1 + WS-TOL-AH-PREM-PCT)
 15391         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 15392             (1 - WS-TOL-AH-PREM-PCT)
 15393     ELSE
 15394         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 15395         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 15396
 15397***
 15398***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 15399***
 15400
 15401     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 15402         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 15403
 15404     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 15405         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 15406
 15407     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15408        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 15409
 15410     IF (PB-REISSUED-CERT)
 15411        OR (PB-POLICY-IS-DECLINED)
 15412        OR (PB-POLICY-IS-VOIDED)
 15413        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 15414        CONTINUE
 15415     ELSE
 15416        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 15417              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 15418                          or
 15419           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 15420              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 15421           IF WS-PREM-REJECT-SW = SPACE
 15422              MOVE ER-3052       TO WS-ERROR
 15423              PERFORM 9900-ERROR-FORMAT
 15424                                 THRU 9900-EXIT
 15425           ELSE
 15426              MOVE ER-3050       TO WS-ERROR
 15427              PERFORM 9900-ERROR-FORMAT
 15428                                 THRU 9900-EXIT
 15429           END-IF
 15430        END-IF
 15431     END-IF
 15432     if (pb-company-id = 'DCC' or 'VPP')
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 280
* EL050.cbl
 15433        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 15434        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 15435        and (pb-i-policy-is-monthly)
 15436        compute ws-tol-ah-high-prem-amt =
 15437           pb-i-tot-fees-calc + ws-tol-ah-prem
 15438        compute ws-tol-ah-low-prem-amt =
 15439           pb-i-tot-fees-calc - ws-tol-ah-prem
 15440        if ws-tol-ah-prem-pct > zeros
 15441           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15442              (1 + ws-tol-ah-prem-pct)
 15443           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15444              (1 - ws-tol-ah-prem-pct)
 15445        else
 15446           move +9999999.99      to ws-tol-ah-high-prem-pct
 15447           move +0               to ws-tol-ah-low-prem-pct
 15448        end-if
 15449        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15450            or
 15451           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15452                          or
 15453           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15454           or
 15455           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15456            move er-3049         to ws-error
 15457           perform 9900-error-format
 15458                                 thru 9900-exit
 15459
 15460        end-if
 15461     end-if
 15462     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15463         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15464             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15465             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15466
 15467     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15468        IF WS-COMP-MAX-CAP GREATER THAN +0
 15469           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15470              IF (PB-REISSUED-CERT         OR
 15471                  PB-POLICY-IS-DECLINED    OR
 15472                  PB-POLICY-IS-VOIDED)
 15473                 NEXT SENTENCE
 15474              ELSE
 15475                  MOVE ER-2646   TO  WS-ERROR
 15476                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15477
 15478     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15479        (WS-COMP-MAX-CAP EQUAL +0)
 15480           GO TO 3345-EDIT-CONTINUE.
 15481
 15482     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15483        GREATER THAN WS-COMP-MAX-CAP
 15484           MOVE ER-2646          TO  WS-ERROR
 15485           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15486
 15487 3345-EDIT-CONTINUE.
 15488
 15489*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15490*       IF PB-ENTRY-BATCH   NUMERIC
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 281
* EL050.cbl
 15491*          IF PB-ISSUE
 15492*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15493*          ELSE
 15494*              IF PB-CANCELLATION
 15495*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15496
 15497*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15498*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 15499*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15500*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15501*        ELSE
 15502*            MOVE  ER-1909            TO  WS-ERROR
 15503*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15504
 15505     IF PB-I-POLICY-ACCEPTED
 15506        IF PB-POLICY-IS-DECLINED  OR
 15507           PB-REISSUED-CERT  OR
 15508           PB-REIN-ONLY-CERT  OR
 15509           PB-POLICY-IS-VOIDED
 15510            MOVE  ER-1891         TO  WS-ERROR
 15511            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15512        ELSE
 15513            MOVE SPACE            TO  PB-BATCH-ENTRY
 15514            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15515
 15516     IF PB-I-POLICY-DECLINED
 15517        IF PB-REISSUED-CERT  OR
 15518           PB-REIN-ONLY-CERT  OR
 15519           PB-POLICY-IS-VOIDED
 15520            MOVE  ER-1906         TO  WS-ERROR
 15521            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15522        ELSE
 15523            MOVE  'D'             TO  PB-BATCH-ENTRY
 15524                                      PB-I-ENTRY-STATUS.
 15525
 15526     IF PB-I-NEEDS-UNDERWRITING
 15527        IF PB-POLICY-IS-DECLINED OR
 15528           PB-REISSUED-CERT  OR
 15529           PB-REIN-ONLY-CERT  OR
 15530           PB-POLICY-IS-VOIDED
 15531            MOVE  ER-1907         TO  WS-ERROR
 15532            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15533        ELSE
 15534            MOVE 'U'              TO  PB-BATCH-ENTRY
 15535                                      PB-I-ENTRY-STATUS.
 15536
 15537     IF PB-NEEDS-UNDERWRITING
 15538        MOVE  ER-1901             TO  WS-ERROR
 15539        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15540     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15541        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15542        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15543        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15544           AND (NOT WS-LF-CASH))
 15545                           OR
 15546           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15547           AND (NOT WS-AH-CASH)))
 15548                       AND
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 282
* EL050.cbl
 15549           (PB-I-ENTRY-STATUS NOT = '5')
 15550           MOVE 'M'              TO PB-BATCH-ENTRY
 15551                                    PB-I-ENTRY-STATUS
 15552        END-IF
 15553     END-IF
 15554     move pending-business       to ws-passed-erpndb
 15555     move ' '                    to ws-exceed-limit-yn
 15556     perform 7780-call-agg       thru 7780-exit
 15557*    display ' el050 exceed ' ws-exceed-limit-yn
 15558     if ws-exceed-limit-yn = 'Y'
 15559        MOVE  ER-9813            TO WS-ERROR
 15560        move 'Y'                 to ws-9813-sw
 15561        PERFORM  9900-ERROR-FORMAT
 15562                                 THRU 9900-EXIT
 15563     end-if
 15564     if (PB-EXCEEDED-LIMIT-FORCED)
 15565        and (ws-9813-sw = 'Y')
 15566        subtract +1 from PB-NO-OF-ERRORS
 15567        move er-9823             to ws-error
 15568        PERFORM  9900-ERROR-FORMAT
 15569                                 THRU 9900-EXIT
 15570     end-if
 15571     IF  PB-COMPANY-ID NOT = 'NCL'
 15572         GO TO 3999-END-EDIT.
 15573
 15574     IF PB-REISSUED-CERT  OR
 15575        PB-POLICY-IS-DECLINED  OR
 15576        PB-POLICY-IS-VOIDED  OR
 15577        PB-I-OB
 15578         GO TO 3999-END-EDIT.
 15579
 15580     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15581         MOVE  ER-2644            TO  WS-ERROR
 15582         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15583         GO TO 3999-END-EDIT.
 15584
 15585     MOVE 'N'                     TO  FORM-MASTER-SW.
 15586     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15587
 15588     IF NOT FORM-MASTER-FOUND
 15589         GO TO 3999-END-EDIT.
 15590
 15591     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15592                                      FORM-MASTER-AH-SW.
 15593
 15594     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15595         MOVE  +1                 TO SUB6
 15596         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15597
 15598     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15599         MOVE  +1                 TO SUB6
 15600         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15601
 15602     IF LF-FORM-MASTER-FOUND  OR
 15603        AH-FORM-MASTER-FOUND
 15604         GO TO 3360-CHECK-FORM-LIMITS
 15605     ELSE
 15606         GO TO 3999-END-EDIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 283
* EL050.cbl
 15607
 15608******************************************************************
 15609*                  3350-GET-ERFORM                               *
 15610*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15611*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15612******************************************************************
 15613
 15614 3350-GET-ERFORM.
 15615
 15616     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15617         GO TO  3350-ERFORM-GETMAIN.
 15618
 15619     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15620     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15621     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15622     MOVE 'Y'                     TO FORM-MASTER-SW.
 15623
 15624     IF PB-CANCELLATION
 15625         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15626            PB-SV-STATE          EQUAL   FO-STATE       AND
 15627            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15628              GO TO 3350-EXIT
 15629         ELSE
 15630             NEXT SENTENCE
 15631     ELSE
 15632         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15633            PB-SV-STATE          EQUAL   FO-STATE       AND
 15634            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15635              GO TO 3350-EXIT.
 15636
 15637 3350-ERFORM-GETMAIN.
 15638
 15639     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15640     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15641
 15642 3350-ERFORM-READ.
 15643
 15644     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15645     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15646     IF PB-CANCELLATION
 15647         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15648     ELSE
 15649         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15650     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15651
 15652     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15653
 15654     IF FORM-MASTER-FOUND
 15655       IF PB-CANCELLATION
 15656          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15657             PB-SV-STATE          EQUAL   FO-STATE       AND
 15658             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15659              GO  TO 3350-EXIT
 15660          ELSE
 15661              NEXT SENTENCE
 15662       ELSE
 15663          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15664             PB-SV-STATE          EQUAL   FO-STATE       AND
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 284
* EL050.cbl
 15665             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15666              GO  TO 3350-EXIT.
 15667
 15668     MOVE  'N'                    TO  FORM-MASTER-SW.
 15669     MOVE  ER-1895                TO  WS-ERROR.
 15670     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15671
 15672 3350-EXIT.
 15673      EXIT.
 15674
 15675******************************************************************
 15676*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15677*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15678*   VALID FOR THE POLICY FORM USED.                              *
 15679******************************************************************
 15680
 15681 3355-EDIT-FORM-LF-BENEFITS.
 15682
 15683     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15684        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15685         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15686         GO TO   3355-EXIT.
 15687
 15688     IF  SUB6    LESS THAN   +40
 15689         ADD  +1      TO  SUB6
 15690         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15691
 15692     MOVE  ER-1896         TO  WS-ERROR.
 15693     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15694
 15695 3355-EXIT.
 15696      EXIT.
 15697
 15698******************************************************************
 15699*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15700*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15701*   VALID FOR THE POLICY FORM USED.                              *
 15702******************************************************************
 15703
 15704 3356-EDIT-FORM-AH-BENEFITS.
 15705
 15706     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15707        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15708         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15709         GO TO  3356-EXIT.
 15710
 15711      IF  SUB6    LESS THAN     +40
 15712          ADD  +1      TO  SUB6
 15713          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15714
 15715     MOVE  ER-1897         TO  WS-ERROR.
 15716     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15717
 15718 3356-EXIT.
 15719      EXIT.
 15720
 15721******************************************************************
 15722*                  3357-BENEFIT-SEARCH                           *
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 285
* EL050.cbl
 15723*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15724*   CANCELLATIONS ONLY.                                          *
 15725******************************************************************
 15726 3357-BENEFIT-SEARCH.
 15727     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15728         MOVE +1                          TO SUB6
 15729         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15730
 15731     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15732         MOVE +1                          TO SUB6
 15733         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15734
 15735 3357-EXIT.
 15736     EXIT.
 15737
 15738******************************************************************
 15739*                  3358-BENEFIT-LIFE-SEARCH                      *
 15740*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15741*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15742*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15743******************************************************************
 15744 3358-BENEFIT-LIFE-SEARCH.
 15745     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15746       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15747         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15748           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15749              IF FO-PLAN-REFUND-METHOD (SUB6)
 15750                     IS GREATER THAN SPACES
 15751                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15752                                          WS-LF-REFUND-CALC
 15753                 GO TO 3358-EXIT.
 15754
 15755     IF SUB6 LESS THAN +40
 15756         ADD +1                 TO SUB6
 15757         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15758
 15759 3358-EXIT.
 15760     EXIT.
 15761******************************************************************
 15762*                  3359-BENEFIT-AH-SEARCH                        *
 15763*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15764*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15765*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15766******************************************************************
 15767 3359-BENEFIT-AH-SEARCH.
 15768     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15769       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15770         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15771           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15772              IF FO-PLAN-REFUND-METHOD (SUB6)
 15773                      IS GREATER THAN SPACES
 15774                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15775                                          WS-AH-REFUND-CALC
 15776                 GO TO 3359-EXIT.
 15777
 15778     IF SUB6 LESS THAN +40
 15779         ADD +1                 TO SUB6
 15780         GO TO 3359-BENEFIT-AH-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 286
* EL050.cbl
 15781
 15782 3359-EXIT.
 15783     EXIT.
 15784
 15785******************************************************************
 15786*                  3360-CHECK-FORM-LIMITS                        *
 15787*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15788*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15789******************************************************************
 15790
 15791 3360-CHECK-FORM-LIMITS.
 15792
 15793     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15794         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15795
 15796     IF NOT LF-FORM-MASTER-FOUND
 15797         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15798
 15799 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15800
 15801     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15802       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15803        WS-LF-JOINT-INDICATOR = 'J'  AND
 15804        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15805         IF PB-COMPANY-ID = 'NCL'
 15806            MOVE  ER-1911          TO  WS-ERROR
 15807            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15808         ELSE
 15809            MOVE  ER-1892          TO  WS-ERROR
 15810            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15811
 15812 3360-CHECK-FORM-LF-ATT-AGE.
 15813
 15814     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15815
 15816     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15817         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15818         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15819            IF PB-COMPANY-ID = 'NCL'
 15820                MOVE  ER-1913      TO  WS-ERROR
 15821                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15822            ELSE
 15823                MOVE  ER-1894      TO  WS-ERROR
 15824                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15825
 15826 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15827
 15828     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15829         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15830         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15831            IF PB-COMPANY-ID = 'NCL'
 15832                MOVE  ER-1914      TO  WS-ERROR
 15833                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15834            ELSE
 15835                MOVE  ER-1899      TO  WS-ERROR
 15836                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15837
 15838 3360-CHECK-FORM-LF-TERM-BAMT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 287
* EL050.cbl
 15839
 15840     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15841         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15842         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15843           IF  PB-COMPANY-ID = 'NCL'
 15844               MOVE  ER-1916       TO  WS-ERROR
 15845               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15846           ELSE
 15847               MOVE  ER-1902       TO  WS-ERROR
 15848               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15849
 15850     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15851                                    PB-I-LF-ALT-BENEFIT-AMT.
 15852
 15853     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15854         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15855         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15856             IF  PB-COMPANY-ID = 'NCL'
 15857                 MOVE  ER-1918     TO  WS-ERROR
 15858                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15859             ELSE
 15860                 MOVE  ER-1904     TO  WS-ERROR
 15861                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15862
 15863******************************************************************
 15864*                  3360-CHECK-FORM-AH-LIMITS                     *
 15865*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15866*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15867******************************************************************
 15868
 15869 3360-CHECK-FORM-AH-LIMITS.
 15870
 15871     IF NOT AH-FORM-MASTER-FOUND
 15872         GO TO 3999-END-EDIT.
 15873
 15874 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15875
 15876     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15877       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15878        WS-AH-JOINT-INDICATOR = 'J'  AND
 15879        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15880         IF PB-COMPANY-ID = 'NCL'
 15881            MOVE  ER-1912          TO  WS-ERROR
 15882            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15883         ELSE
 15884            MOVE  ER-1893          TO  WS-ERROR
 15885            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15886
 15887 3360-CHECK-FORM-AH-ATT-AGE.
 15888
 15889     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15890
 15891     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15892         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15893         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15894            IF PB-COMPANY-ID = 'NCL'
 15895                MOVE  ER-1913      TO  WS-ERROR
 15896                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 288
* EL050.cbl
 15897            ELSE
 15898                MOVE  ER-1894      TO  WS-ERROR
 15899                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15900
 15901 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15902
 15903     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15904         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15905         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15906            IF PB-COMPANY-ID = 'NCL'
 15907                MOVE  ER-1915      TO  WS-ERROR
 15908                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15909            ELSE
 15910                MOVE  ER-1900      TO  WS-ERROR
 15911                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15912
 15913 3360-CHECK-FORM-AH-TERM-BAMT.
 15914
 15915     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15916         FO-AH-MAX-TERM    GREATER THAN  +0
 15917         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15918             IF  PB-COMPANY-ID = 'NCL'
 15919                 MOVE  ER-1917     TO  WS-ERROR
 15920                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15921             ELSE
 15922                  MOVE  ER-1903    TO  WS-ERROR
 15923                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15924
 15925     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15926         FO-MAX-AH-AMT    GREATER THAN  +0
 15927         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15928             IF  PB-COMPANY-ID = 'NCL'
 15929                 MOVE  ER-1919     TO  WS-ERROR
 15930                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15931             ELSE
 15932                 MOVE  ER-1905     TO  WS-ERROR
 15933                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15934
 15935     GO TO 3999-END-EDIT.
 15936
 15937******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 289
* EL050.cbl
 15939 3400-edit-vin.
 15940
 15941     move spaces                 to hldi-pass-area
 15942     MOVE PB-I-VIN               TO WS-WORK-VIN
 15943     MOVE +8                     TO V2
 15944     MOVE ZEROS                  TO WS-VIN-TOTAL
 15945     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15946      (V1 > 17)
 15947        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15948           MOVE ER-3825          TO WS-ERROR
 15949           PERFORM 9900-ERROR-FORMAT
 15950                                 THRU 9900-EXIT
 15951        ELSE
 15952           IF V1 = 8
 15953              MOVE 10            TO V2
 15954           END-IF
 15955           IF V1 = 9
 15956              MOVE 0             TO V2
 15957           END-IF
 15958           IF V1 = 10
 15959              MOVE 9             TO V2
 15960           END-IF
 15961           IF WS-WORK-VIN (V1:1) NUMERIC
 15962              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15963               + (WS-WORK-VIN-N (V1) * V2)
 15964           ELSE
 15965              MOVE WS-WORK-VIN (V1:1)
 15966                            TO WS-HEX-BYTE
 15967              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15968              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15969               + (WS-NUM (V3) * V2)
 15970           END-IF
 15971           COMPUTE V2 = V2 - 1
 15972        END-IF
 15973     END-PERFORM
 15974     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15975     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15976        REMAINDER WS-VIN-REMAINDER
 15977     IF ((WS-WORK-VIN (9:1) = 'X')
 15978        AND (WS-VIN-REMAINDER = 10))
 15979                OR
 15980        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15981        if pb-company-id = 'VPP'
 15982           perform 3410-check-with-hldi
 15983                                 thru 3410-exit
 15984        end-if
 15985     ELSE
 15986        IF WS-WORK-VIN (1:1) > 0 AND < 6
 15987           MOVE ER-3826          TO WS-ERROR
 15988           PERFORM 9900-ERROR-FORMAT
 15989                                 THRU 9900-EXIT
 15990        ELSE
 15991           MOVE ER-3827          TO WS-ERROR
 15992           PERFORM 9900-ERROR-FORMAT
 15993                                 THRU 9900-EXIT
 15994        END-IF
 15995     END-IF
 15996
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 290
* EL050.cbl
 15997     .
 15998 3400-exit.
 15999     exit.
 16000 3410-check-with-hldi.
 16001     move spaces                 to hldi-pass-area
 16002     move pb-i-vin               to pa-vin
 16003     perform 7785-call-hldi      thru 7785-exit
 16004*    display 'PA-VIN        ' PA-VIN
 16005*    display 'PA-ErrorCode  ' PA-ErrorCode
 16006*    display 'PA-ErrorDesc  ' PA-ErrorDesc
 16007*    display 'PA-ModelYear  ' PA-ModelYear
 16008*    display 'PA-MakeName   ' PA-MakeName
 16009*    display 'PA-ModelName  ' PA-ModelName
 16010*    display 'PA-SeriesName ' PA-SeriesName
 16011     if pa-errorcode (1:1) not = '0'
 16012        move spaces              to hldi-pass-area
 16013        move pb-i-vin            to pa-vin
 16014*       move pa-errordesc        to pa-seriesname
 16015*       perform 7786-call-hldim  thru 7786-exit
 16016*       display 'PA-VIN        ' PA-VIN
 16017*       display 'PA-ErrorCode  ' PA-ErrorCode
 16018*       display 'PA-ErrorDesc  ' PA-ErrorDesc
 16019*       display 'PA-ModelYear  ' PA-ModelYear
 16020*       display 'PA-MakeName   ' PA-MakeName
 16021*       display 'PA-ModelName  ' PA-ModelName
 16022*       display 'PA-SeriesName ' PA-SeriesName
 16023     end-if
 16024     .
 16025 3410-exit.
 16026     exit.
 16027******************************************************************
 16028*                  E D I T   C A N C E L                         *
 16029******************************************************************
 16030
 16031 3700-EDIT-CANCEL.
 16032     IF PB-COMPANY-ID = 'DMD'
 16033         MOVE ZEROS                   TO WS-RES-STATE-TAX
 16034                                         WS-RES-MUNI-TAX
 16035                                         PB-CI-STATE-TAX
 16036                                         PB-CI-MUNI-TAX
 16037         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 16038
 16039*    IF PB-COMPANY-ID  EQUAL  'NCL'
 16040*       IF PB-ENTRY-BATCH  NUMERIC
 16041*          IF PB-CANCELLATION
 16042*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 16043*          ELSE
 16044*             IF PB-ISSUE
 16045*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 16046
 16047     IF PB-C-INT-ON-REFS NOT NUMERIC
 16048        MOVE ZEROS               TO PB-C-INT-ON-REFS
 16049     END-IF
 16050*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 16051*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 16052
 16053     IF CM-ENTRY-STATUS = 'V'
 16054        MOVE ER-2780             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 291
* EL050.cbl
 16055        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16056        GO TO 3999-END-EDIT.
 16057
 16058     IF CM-ENTRY-STATUS = 'D'
 16059        MOVE ER-2781             TO WS-ERROR
 16060        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16061        GO TO 3999-END-EDIT.
 16062
 16063     IF CM-ENTRY-STATUS = 'U'
 16064        MOVE ER-2782             TO WS-ERROR
 16065        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16066
 16067***************************************************************
 16068*                                                             *
 16069*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 16070*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 16071*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 16072*   OF ANOTHER COVERAGE.                                      *
 16073*                                                             *
 16074***************************************************************
 16075
 16076     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 16077                                    PB-C-AH-CANCEL-VOID-SW.
 16078
 16079     if pb-company-id = 'DCC' or 'VPP'
 16080        if ((pb-ci-lf-cancel-amt <> zeros)
 16081                       or
 16082            (pb-ci-ah-cancel-amt <> zeros))
 16083           MOVE ER-3068          TO WS-ERROR
 16084           PERFORM 9900-ERROR-FORMAT
 16085                                 THRU 9900-EXIT
 16086           GO TO 3999-END-EDIT
 16087        end-if
 16088     end-if
 16089     IF PB-C-LF-CANCEL-AMT = ZERO
 16090        NEXT SENTENCE
 16091     ELSE
 16092        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16093           AND
 16094           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16095               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 16096               MOVE ER-2745           TO WS-ERROR
 16097               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16098
 16099     IF PB-C-AH-CANCEL-AMT = ZERO
 16100        NEXT SENTENCE
 16101     ELSE
 16102        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16103           AND
 16104           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 16105               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 16106               MOVE ER-2745           TO WS-ERROR
 16107               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16108
 16109     IF WS-LF-EARNINGS-CALC = '4'
 16110        MOVE '4'                   TO WS-LF-REFUND-CALC.
 16111
 16112     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 292
* EL050.cbl
 16113     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 16114     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 16115     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 16116     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 16117     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 16118
 16119     MOVE ZERO                     TO PB-C-LF-REF-CALC
 16120                                      PB-C-AH-REF-CALC.
 16121     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 16122
 16123******************************************************************
 16124*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 16125*             TO VALIDATE COVERAGE.                              *
 16126******************************************************************
 16127
 16128     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 16129        PB-C-LF-CANCEL-AMT = ZEROS
 16130          MOVE 'N'                 TO WS-LF-CANCEL-SW
 16131      ELSE
 16132          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 16133
 16134     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 16135        PB-C-AH-CANCEL-AMT = ZEROS
 16136          MOVE 'N'                 TO WS-AH-CANCEL-SW
 16137      ELSE
 16138          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 16139
 16140     EVALUATE TRUE
 16141         WHEN PB-CANCEL-FORCE             OR
 16142              PB-CANCEL-DATE-FORCED       OR
 16143              PB-FORCE-OFF
 16144                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16145                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 16146                  END-IF
 16147         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 16148               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 16149              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 16150                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 16151         WHEN OTHER
 16152              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16153                 MOVE ER-2794              TO WS-ERROR
 16154              ELSE
 16155                 MOVE ER-2749              TO WS-ERROR
 16156              END-IF
 16157              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16158     END-EVALUATE.
 16159
 16160
 16161*    IF  PB-COMPANY-ID    EQUAL    'HER'
 16162*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 16163*            MOVE  ER-1909            TO  WS-ERROR
 16164*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 16165*        ELSE
 16166*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 16167
 16168     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 16169     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 16170        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 293
* EL050.cbl
 16171     ELSE
 16172        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 16173     END-IF
 16174     .
 16175 3705-EDIT-CANCEL-DT.
 16176
 16177     IF LF-COVERAGE-CANCELLED
 16178        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16179         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 16180         MOVE WS-CURRENT-MONTH-END
 16181                                 TO DC-BIN-DATE-2
 16182         SET ELAPSED-BETWEEN-BIN TO TRUE
 16183*        MOVE 1                  TO DC-OPTION-CODE
 16184         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16185         IF DATE-CONVERSION-ERROR
 16186            NEXT SENTENCE
 16187          ELSE
 16188             IF DC-ELAPSED-DAYS GREATER +180
 16189                IF PB-CANCEL-DATE-FORCED  OR
 16190                   PB-CANCEL-DATE-FORCED-NO-FEE
 16191                      MOVE ER-2751  TO WS-ERROR
 16192                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16193                 ELSE
 16194                   MOVE ER-2752  TO WS-ERROR
 16195                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16196
 16197     IF AH-COVERAGE-CANCELLED
 16198        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16199         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 16200         MOVE WS-CURRENT-MONTH-END
 16201                                 TO DC-BIN-DATE-2
 16202         SET ELAPSED-BETWEEN-BIN TO TRUE
 16203*        MOVE 1                  TO DC-OPTION-CODE
 16204         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16205         IF DATE-CONVERSION-ERROR
 16206            NEXT SENTENCE
 16207          ELSE
 16208             IF DC-ELAPSED-DAYS GREATER +180
 16209                IF PB-CANCEL-DATE-FORCED OR
 16210                   PB-CANCEL-DATE-FORCED-NO-FEE
 16211                      MOVE ER-2751  TO WS-ERROR
 16212                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16213                 ELSE
 16214                   MOVE ER-2752  TO WS-ERROR
 16215                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16216
 16217     IF WS-ERROR = ER-2752
 16218        AND (PB-COMPANY-ID = 'ABL'
 16219         OR  PB-COMPANY-ID = 'FGL'
 16220         OR  PB-COMPANY-ID = 'IST'
 16221         OR  PB-COMPANY-ID = 'JHL'
 16222         OR  PB-COMPANY-ID = 'LAP'
 16223         OR  PB-COMPANY-ID = 'LBL'
 16224         OR  PB-COMPANY-ID = 'NCB'
 16225         OR  PB-COMPANY-ID = 'NLI'
 16226         OR  PB-COMPANY-ID = 'OFI'
 16227         OR  PB-COMPANY-ID = 'PLI'
 16228         OR  PB-COMPANY-ID = 'TAO'
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 294
* EL050.cbl
 16229         OR  PB-COMPANY-ID = 'TIC'
 16230         OR  PB-COMPANY-ID = 'HER'
 16231         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 16232         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 16233            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 16234            MOVE ER-2762     TO WS-ERROR
 16235            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16236
 16237     IF LF-COVERAGE-CANCELLED
 16238        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16239        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16240             MOVE ER-2733         TO WS-ERROR
 16241             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16242
 16243     IF AH-COVERAGE-CANCELLED
 16244        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16245        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16246              MOVE ER-2733        TO WS-ERROR
 16247              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16248
 16249     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 16250        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 16251        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 16252           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 16253            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 16254              IF PB-COMPANY-ID NOT = 'LAP'
 16255               MOVE ER-2704            TO WS-ERROR
 16256               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16257
 16258     IF CERT-WAS-NOT-FOUND
 16259         GO TO 3999-END-EDIT.
 16260
 16261     IF PB-COMPANY-ID EQUAL 'CDC'
 16262        IF LF-COVERAGE-CANCELLED
 16263           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16264            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16265            MOVE PB-C-LF-CANCEL-DT
 16266                                 TO DC-BIN-DATE-2
 16267            SET ELAPSED-BETWEEN-BIN TO TRUE
 16268*           MOVE 1               TO DC-OPTION-CODE
 16269            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16270            IF DATE-CONVERSION-ERROR
 16271               NEXT SENTENCE
 16272             ELSE
 16273                IF DC-ELAPSED-DAYS GREATER +60
 16274                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 16275
 16276     IF PB-COMPANY-ID EQUAL 'CDC'
 16277        IF AH-COVERAGE-CANCELLED
 16278           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16279            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16280            MOVE PB-C-AH-CANCEL-DT
 16281                                 TO DC-BIN-DATE-2
 16282            MOVE +0              TO DC-ELAPSED-DAYS
 16283                                    DC-ELAPSED-MONTHS
 16284            SET ELAPSED-BETWEEN-BIN  TO TRUE
 16285*           MOVE 1               TO DC-OPTION-CODE
 16286            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 295
* EL050.cbl
 16287            IF DATE-CONVERSION-ERROR
 16288               NEXT SENTENCE
 16289             ELSE
 16290                IF DC-ELAPSED-DAYS GREATER +60
 16291                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 16292
 16293     MOVE +0                     TO DC-ELAPSED-DAYS
 16294                                    DC-ELAPSED-MONTHS.
 16295
 16296     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 16297        (WS-AH-SPECIAL-CALC-CD = 'Z')
 16298          MOVE 'Z'                TO PB-CI-OB-FLAG
 16299          MOVE ER-2767            TO WS-ERROR
 16300          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16301          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16302          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16303          GO TO 3775-OVER-REF-CHK
 16304        ELSE
 16305          MOVE ZEROS              TO PB-CI-LIVES
 16306                                     PB-C-LIVES
 16307          IF PB-CI-OB-FLAG NOT = 'B'
 16308             MOVE SPACE           TO PB-CI-OB-FLAG.
 16309
 16310     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 16311         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 16312     ELSE
 16313         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 16314
 16315     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 16316        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 16317            MOVE ER-2760         TO WS-ERROR
 16318            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16319
 16320     IF LF-COVERAGE-CANCELLED
 16321        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16322         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 16323            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 16324               MOVE ER-2774       TO WS-ERROR
 16325               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16326
 16327     IF AH-COVERAGE-CANCELLED
 16328        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16329         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 16330            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 16331               MOVE ER-2775       TO WS-ERROR
 16332               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16333
 16334     IF LF-COVERAGE-CANCELLED
 16335        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16336         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 16337            MOVE ER-2776         TO WS-ERROR
 16338            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16339
 16340     IF AH-COVERAGE-CANCELLED
 16341        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16342         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 16343            MOVE ER-2777         TO WS-ERROR
 16344            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 296
* EL050.cbl
 16345
 16346     IF LF-COVERAGE-CANCELLED
 16347        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16348        if pb-ci-lf-expire-dt = low-values or spaces
 16349           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16350           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 16351           MOVE PB-CI-EXTENTION-DAYS
 16352                                 TO DC-ELAPSED-DAYS
 16353           SET BIN-PLUS-ELAPSED  TO TRUE
 16354           PERFORM 8500-DATE-CONVERT
 16355                                 THRU 8500-EXIT
 16356           IF DATE-CONVERSION-ERROR
 16357              move low-values    to dc-bin-date-2
 16358           end-if
 16359        else
 16360           move pb-ci-lf-expire-dt
 16361                                 to dc-bin-date-2
 16362        end-if
 16363        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16364           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16365                             OR  'FIA'
 16366              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 16367           ELSE
 16368              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16369              MOVE ER-2731       TO WS-ERROR
 16370              PERFORM 9900-ERROR-FORMAT
 16371                                 THRU 9900-EXIT
 16372           end-if
 16373        end-if
 16374     end-if
 16375*    IF LF-COVERAGE-CANCELLED
 16376*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16377*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16378*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 16379*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16380*        SET BIN-PLUS-ELAPSED      TO TRUE
 16381*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16382*        IF DATE-CONVERSION-ERROR
 16383*           NEXT SENTENCE
 16384*         ELSE
 16385*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16386*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16387*                            OR  'FIA'
 16388*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 16389*              ELSE
 16390*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16391*               MOVE ER-2731       TO WS-ERROR
 16392*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16393     .
 16394 3705-EDIT-AH-CANCEL-DT.
 16395     IF AH-COVERAGE-CANCELLED
 16396        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16397        if pb-ci-AH-expire-dt = low-values or spaces
 16398           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16399           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 16400           MOVE PB-CI-EXTENTION-DAYS
 16401                                 TO DC-ELAPSED-DAYS
 16402           SET BIN-PLUS-ELAPSED  TO TRUE
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 297
* EL050.cbl
 16403           PERFORM 8500-DATE-CONVERT
 16404                                 THRU 8500-EXIT
 16405           IF DATE-CONVERSION-ERROR
 16406              move low-values    to dc-bin-date-2
 16407           end-if
 16408        else
 16409           move pb-ci-ah-expire-dt
 16410                                 to dc-bin-date-2
 16411        end-if
 16412        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16413           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16414                             OR  'FIA'
 16415              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 16416           ELSE
 16417              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16418              MOVE ER-2771       TO WS-ERROR
 16419              PERFORM 9900-ERROR-FORMAT
 16420                                 THRU 9900-EXIT
 16421           end-if
 16422        end-if
 16423     end-if
 16424*    IF AH-COVERAGE-CANCELLED
 16425*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16426*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16427*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 16428*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16429**       MOVE 6                    TO DC-OPTION-CODE
 16430*        SET BIN-PLUS-ELAPSED      TO TRUE
 16431*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16432*        IF DATE-CONVERSION-ERROR
 16433*           NEXT SENTENCE
 16434*         ELSE
 16435*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16436*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16437*                             OR 'FIA'
 16438*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 16439*             ELSE
 16440*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16441*              MOVE ER-2771       TO WS-ERROR
 16442*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16443     .
 16444 3705-EDIT-CONTINUED.
 16445
 16446*    IF LF-COVERAGE-CANCELLED
 16447*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16448*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16449*            MOVE ER-2727         TO WS-ERROR
 16450*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16451*
 16452*    IF AH-COVERAGE-CANCELLED
 16453*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16454*        IF PB-COMPANY-ID = 'ACE'
 16455*           MOVE ER-2727        TO WS-ERROR
 16456*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16457*        ELSE
 16458*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16459*              MOVE ER-2727     TO WS-ERROR
 16460*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 298
* EL050.cbl
 16461
 16462     IF PB-COMPANY-ID = 'ACE'
 16463       IF AH-COVERAGE-CANCELLED
 16464         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16465           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 16466              MOVE ER-2732      TO WS-ERROR
 16467              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16468
 16469     IF PB-COMPANY-ID      EQUAL   'HER'
 16470        IF WS-ERROR        EQUAL   ER-2727
 16471            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 16472            MOVE  ER-2725          TO  WS-ERROR
 16473            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 16474
 16475     IF PB-C-CLAIM-CREATED-CANCEL
 16476            MOVE ER-2748         TO WS-ERROR
 16477            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16478
 16479     IF PB-C-LAST-NAME NOT = SPACES
 16480         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 16481            MOVE ER-2747         TO WS-ERROR
 16482            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16483
 16484 3710-EDIT-LUMP-SUM-PRIOR.
 16485
 16486     IF AH-COVERAGE-CANCELLED
 16487         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16488             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 16489                MOVE ER-2735    TO WS-ERROR
 16490                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16491
 16492     IF LF-COVERAGE-CANCELLED
 16493         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16494             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16495                MOVE ER-2735    TO WS-ERROR
 16496                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16497
 16498 3710-EDIT-PRIOR-DEATH.
 16499
 16500*    IF LF-COVERAGE-CANCELLED
 16501*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16502*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16503*           (NOT PB-CI-OB)
 16504*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16505*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16506*                   MOVE ER-2732  TO WS-ERROR
 16507*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16508*
 16509*    IF AH-COVERAGE-CANCELLED
 16510*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16511*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16512*           (NOT PB-CI-OB)
 16513*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16514*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16515*                   MOVE ER-2732  TO WS-ERROR
 16516*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16517
 16518     IF PB-CI-DEATH-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 299
* EL050.cbl
 16519         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16520            (NOT PB-COMP-LF-CANCEL)
 16521             NEXT SENTENCE
 16522         ELSE
 16523           IF PB-C-LF-CANCEL-VOIDED
 16524              NEXT SENTENCE
 16525           ELSE
 16526              MOVE ER-2753      TO WS-ERROR
 16527              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16528
 16529     IF CANCEL-FUTURE-DT
 16530         GO TO 3999-END-EDIT.
 16531
 16532 3715-GET-REMAIN-TERM-LF.
 16533
 16534     IF NO-LF-BENEFIT-MATCH  OR
 16535        WS-LF-BENEFIT-CD = ZEROS
 16536        GO TO 3730-GET-AH-REMAIN-TERM.
 16537
 16538     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16539     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16540     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16541     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16542     MOVE PB-SV-STATE            TO CP-STATE.
 16543     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16544     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16545     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16546     MOVE '2'                    TO CP-PROCESS-TYPE.
 16547     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16548     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16549     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16550     IF (PB-COMPANY-ID = 'CID')
 16551        AND (CP-STATE-STD-ABBRV = 'WI')
 16552        MOVE '7'                 TO CP-REM-TERM-METHOD
 16553        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16554     ELSE
 16555        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16556        MOVE WS-REM-TRM-CALC-OPTION
 16557                                 TO CP-REM-TRM-CALC-OPTION
 16558     END-IF
 16559**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 16560     IF (PB-COMPANY-ID = 'CID')
 16561        AND (CP-STATE-STD-ABBRV = 'MO')
 16562        AND (PB-CERT-EFF-DT >= X'9B41')
 16563        AND (PB-CERT-EFF-DT <= X'A2FB')
 16564        MOVE '7'                 TO CP-REM-TERM-METHOD
 16565        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16566     END-IF
 16567     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16568                                    CP-LOAN-TERM.
 16569     IF CP-TRUNCATED-LIFE
 16570        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16571
 16572     IF CP-TERM-IS-DAYS
 16573         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16574     ELSE
 16575         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16576
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 300
* EL050.cbl
 16577     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16578
 16579     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16580
 16581     IF LF-COVERAGE-CANCELLED
 16582        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16583        NEXT SENTENCE
 16584      ELSE
 16585          GO TO 3730-GET-AH-REMAIN-TERM.
 16586
 16587 3720-GET-LF-REFUND.
 16588
 16589     IF PB-C-LF-CANCEL-VOIDED
 16590        GO TO 3730-GET-AH-REMAIN-TERM
 16591     end-if
 16592
 16593     IF PB-COMPANY-ID EQUAL 'BOA'
 16594         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16595         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16596         GO TO 3730-GET-AH-REMAIN-TERM.
 16597
 16598     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16599        (WS-AH-SPECIAL-CALC-CD = 'M')
 16600         MOVE ER-2767            TO WS-ERROR
 16601         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16602         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16603         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16604         GO TO 3780-UPDATE-CANCEL-CERT.
 16605
 16606*    if (ws-lf-earnings-calc = '6')
 16607*       or (pb-c-lf-refund-override = '6')
 16608*       move cp-remaining-term-1 to cp-remaining-term-2
 16609*    end-if
 16610     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16611
 16612     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16613     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16614     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16615     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16616     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16617     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 16618     IF PB-COMPANY-ID = 'DCC'
 16619        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16620        IF PDEF-MASTER-FOUND
 16621           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16622              (V1 > +8)
 16623              OR (PD-PROD-CODE (V1) = 'L')
 16624           END-PERFORM
 16625           IF V1 < +9
 16626              MOVE PD-MAX-AMT (V1)
 16627                           TO CP-R-MAX-TOT-BEN
 16628                              EC-AM-LF-MAX-TOT-BEN
 16629           END-IF
 16630        ELSE
 16631        MOVE ' '                 TO PDEF-MASTER-SW
 16632        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16633        MOVE PB-STATE            TO ERPDEF-STATE
 16634        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 301
* EL050.cbl
 16635           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16636        END-IF
 16637        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16638        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16639        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16640        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16641        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16642        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16643        IF PDEF-MASTER-FOUND
 16644           MOVE 'N'              TO PDEF-MASTER-SW
 16645           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16646           IF PDEF-MASTER-FOUND
 16647              IF (ERPDEF-KEY-SAVE (1:16) =
 16648                           PD-CONTROL-PRIMARY (1:16))
 16649                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16650                 CONTINUE
 16651              ELSE
 16652                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16653                 IF (ERPDEF-KEY-SAVE (1:16) =
 16654                           PD-CONTROL-PRIMARY (1:16))
 16655                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16656                    CONTINUE
 16657                 ELSE
 16658                    MOVE 'N'     TO PDEF-MASTER-SW
 16659                 END-IF
 16660              END-IF
 16661
 16662              IF PDEF-MASTER-FOUND
 16663                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16664                    (V1 > +8)
 16665                    OR (PD-PROD-CODE (V1) = 'L')
 16666                 END-PERFORM
 16667                 IF V1 < +9
 16668                    MOVE PD-MAX-AMT (V1)
 16669                                 TO CP-R-MAX-TOT-BEN
 16670                                    EC-AM-LF-MAX-TOT-BEN
 16671                 END-IF
 16672              END-IF
 16673           END-IF
 16674           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16675        END-IF
 16676        END-IF
 16677     END-IF
 16678     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16679
 16680     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16681
 16682     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16683                                    PB-C-LF-REM-TERM.
 16684
 16685     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16686     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16687
 16688     IF PB-COMPANY-ID EQUAL 'FLC'
 16689        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16690           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16691           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16692                    + PB-CI-LF-ALT-PREMIUM-AMT)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 302
* EL050.cbl
 16693                    - CM-LF-ITD-DEATH-AMT
 16694           IF PB-C-LF-REF-CALC LESS THAN +0
 16695              MOVE +0            TO PB-C-LF-REF-CALC
 16696              GO TO 3730-GET-AH-REMAIN-TERM
 16697           ELSE
 16698              GO TO 3730-GET-AH-REMAIN-TERM.
 16699
 16700     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16701                            OR '4' OR '5' OR '6' OR '8'
 16702                            OR '9' OR 'G'
 16703        MOVE PB-C-LF-REFUND-OVERRIDE
 16704                                 TO CP-EARNING-METHOD.
 16705
 16706     if pb-company-id = 'AHL'
 16707        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16708        if cp-class-code = spaces
 16709           move zeros            to cp-class-code
 16710        end-if
 16711     ELSE
 16712        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16713     END-IF
 16714*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16715     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16716     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16717                                    CP-RATING-BENEFIT-AMT.
 16718     IF CP-STATE-STD-ABBRV = 'OR'
 16719         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16720                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16721     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16722     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16723     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16724     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16725     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16726     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16727     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16728     IF WS-DEFAULT-APR NOT NUMERIC
 16729         MOVE ZEROS TO WS-DEFAULT-APR.
 16730****   N O T E   ****
 16731*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16732*      THE OH HARD CODING IN ELCRFNDP
 16733
 16734     IF PB-COMPANY-ID = 'CID'
 16735        IF CP-STATE-STD-ABBRV = 'OH'
 16736           MOVE WS-LF-EARNINGS-CALC
 16737                                 TO CP-EARNING-METHOD
 16738        END-IF
 16739     END-IF
 16740
 16741****   N O T E   ****
 16742
 16743*    IF CP-EARN-AS-NET-PAY
 16744*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16745*           IF WS-DEFAULT-APR GREATER THAN ZEROS
 16746*               MOVE WS-DEFAULT-APR
 16747*                                TO  CP-LOAN-APR
 16748*               MOVE ER-3780     TO  WS-ERROR
 16749*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16750*           ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 303
* EL050.cbl
 16751*               MOVE ER-3781     TO  WS-ERROR
 16752*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16753*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16754     move ' '                    to cp-ext-days-calc
 16755     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16756
 16757     IF CP-REFUND-TYPE-USED NOT = SPACE
 16758         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16759
 16760     IF CP-ERROR-RATE-IS-ZERO OR
 16761        CP-ERROR-RATE-NOT-FOUND
 16762        MOVE ER-2740             TO WS-ERROR
 16763        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16764
 16765     IF CP-ERROR-RATE-FILE-NOTOPEN
 16766        MOVE ER-2617             TO WS-ERROR
 16767        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16768
 16769     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16770        AND PB-CI-ENTRY-STATUS = 'M'
 16771        MOVE +0                  TO PB-C-LF-REF-CALC
 16772     ELSE
 16773        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16774     END-IF
 16775
 16776     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16777         GO TO 3730-GET-AH-REMAIN-TERM.
 16778
 16779*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16780*       ADD +1                   TO PB-C-LF-REM-TERM
 16781*                                   CP-REMAINING-TERM
 16782*                                   CP-ORIGINAL-TERM.
 16783
 16784     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16785     MOVE '2'                    TO CP-EARNING-METHOD
 16786                                    CP-RATING-METHOD.
 16787     IF PB-COMPANY-ID = 'CID'
 16788        IF (CP-STATE-STD-ABBRV = 'MN')
 16789           AND (PB-CERT-EFF-DT > X'A4FF')
 16790           AND (WS-LF-EARNINGS-CALC = 'B')
 16791           MOVE '5'              TO CP-EARNING-METHOD
 16792           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16793        END-IF
 16794     END-IF
 16795     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16796                                        CP-REMAINING-BENEFIT
 16797                                        CP-RATING-BENEFIT-AMT.
 16798     IF CP-STATE-STD-ABBRV = 'OR'
 16799         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16800                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16801     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16802     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16803
 16804     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16805
 16806     IF CP-ERROR-RATE-IS-ZERO OR
 16807        CP-ERROR-RATE-NOT-FOUND
 16808        MOVE ER-2740             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 304
* EL050.cbl
 16809        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16810
 16811     IF CP-ERROR-RATE-FILE-NOTOPEN
 16812        MOVE ER-2617             TO WS-ERROR
 16813        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16814
 16815     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16816
 16817******************************************************************
 16818
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 305
* EL050.cbl
 16820 3730-GET-AH-REMAIN-TERM.
 16821     IF NO-AH-BENEFIT-MATCH  OR
 16822        WS-AH-BENEFIT-CD = ZEROS
 16823         GO TO 3770-CHECK-REFUNDS.
 16824
 16825     IF PB-CI-AH-LUMP-SUM-DISAB
 16826         IF  PB-C-AH-CANCEL-AMT = ZERO
 16827            IF NOT PB-COMP-AH-CANCEL
 16828             GO TO 3770-CHECK-REFUNDS.
 16829
 16830     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16831     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16832     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16833     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16834     MOVE PB-SV-STATE            TO CP-STATE.
 16835     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16836     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16837     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16838     MOVE '2'                    TO CP-PROCESS-TYPE.
 16839     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16840     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16841     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16842     IF (PB-COMPANY-ID = 'CID')
 16843        AND (CP-STATE-STD-ABBRV = 'WI')
 16844        MOVE '7'                 TO CP-REM-TERM-METHOD
 16845        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16846     ELSE
 16847        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16848        MOVE WS-REM-TRM-CALC-OPTION
 16849                                 TO CP-REM-TRM-CALC-OPTION
 16850     END-IF
 16851     IF (PB-COMPANY-ID = 'CID')
 16852        AND (CP-STATE-STD-ABBRV = 'MO')
 16853        AND (PB-CERT-EFF-DT >= X'9B41')
 16854        AND (PB-CERT-EFF-DT <= X'A2FB')
 16855        MOVE '7'                 TO CP-REM-TERM-METHOD
 16856        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16857     END-IF
 16858     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16859                                    CP-LOAN-TERM.
 16860     IF NOT CP-TERM-IS-DAYS
 16861         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16862
 16863     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16864
 16865     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16866
 16867     IF AH-COVERAGE-CANCELLED
 16868        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16869        NEXT SENTENCE
 16870      ELSE
 16871         GO TO 3770-CHECK-REFUNDS.
 16872
 16873 3740-GET-AH-REFUND.
 16874
 16875     IF PB-C-AH-CANCEL-VOIDED
 16876        GO TO 3780-UPDATE-CANCEL-CERT
 16877     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 306
* EL050.cbl
 16878
 16879     IF PB-COMPANY-ID = 'BOA'
 16880         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16881         GO TO 3770-CHECK-REFUNDS.
 16882
 16883     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16884*    MOVE ' '                    TO DC-OPTION-CODE
 16885     SET BIN-TO-GREG             TO TRUE
 16886     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16887     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16888                                    PB-C-AH-REM-TERM.
 16889     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16890     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16891
 16892     IF PB-COMPANY-ID EQUAL 'FLC'
 16893        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16894           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16895           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16896                    - CM-AH-ITD-AH-PMT)
 16897           IF PB-C-AH-REF-CALC LESS THAN +0
 16898              MOVE +0            TO PB-C-AH-REF-CALC
 16899              GO TO 3770-CHECK-REFUNDS
 16900           ELSE
 16901              GO TO 3770-CHECK-REFUNDS.
 16902
 16903     IF PB-COMPANY-ID = 'DCC'
 16904        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16905            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16906           MOVE 'S'              TO CP-EARNING-METHOD
 16907        END-IF
 16908     END-IF
 16909     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16910                            OR '4' OR '5' OR '6' OR '8'
 16911                            OR '9' OR 'G' OR 'S'
 16912        MOVE PB-C-AH-REFUND-OVERRIDE
 16913                                 TO CP-EARNING-METHOD.
 16914
 16915     if pb-company-id = 'AHL'
 16916        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16917        if cp-class-code = spaces
 16918           move zeros            to cp-class-code
 16919        end-if
 16920     ELSE
 16921        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16922     END-IF
 16923*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16924     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16925     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16926                                    CP-RATING-BENEFIT-AMT.
 16927     IF CP-STATE-STD-ABBRV = 'OR'
 16928         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16929                                         PB-CI-AH-TERM.
 16930     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16931     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16932     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16933     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16934     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16935     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 307
* EL050.cbl
 16936
 16937     IF CP-STATE-STD-ABBRV = 'OH'
 16938        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16939                                AND 'CID' AND 'DCC' and 'VPP'
 16940                                AND 'AHL')
 16941           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16942              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16943              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16944              MOVE '6' TO CP-EARNING-METHOD
 16945           END-IF
 16946        END-IF
 16947        IF PB-COMPANY-ID = 'CID'
 16948           IF NO-LIFE-COVERAGE
 16949              IF CP-CRITICAL-PERIOD
 16950                 MOVE '2'       TO CP-EARNING-METHOD
 16951              ELSE
 16952                 MOVE '6'       TO CP-EARNING-METHOD
 16953              END-IF
 16954           ELSE
 16955              IF WS-LF-COVERAGE-TYPE = 'L'
 16956                 MOVE '2'       TO CP-EARNING-METHOD
 16957              ELSE
 16958                 IF (PB-CI-LF-TERM > +60) OR
 16959                    (WS-LF-EARNINGS-CALC = '5')
 16960                    IF CP-CRITICAL-PERIOD
 16961                       MOVE '2'  TO CP-EARNING-METHOD
 16962                    ELSE
 16963                       MOVE '6'  TO CP-EARNING-METHOD
 16964                    END-IF
 16965                 ELSE
 16966                    MOVE '1'     TO CP-EARNING-METHOD
 16967                 END-IF
 16968              END-IF
 16969           END-IF
 16970        END-IF
 16971     END-IF
 16972
 16973*    IF CP-STATE-STD-ABBRV = 'VA'
 16974*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16975*          IF CP-ORIGINAL-TERM GREATER 61
 16976*             MOVE '6' TO CP-EARNING-METHOD
 16977*          ELSE
 16978*             MOVE '1' TO CP-EARNING-METHOD.
 16979
 16980     IF WS-DEFAULT-APR NOT NUMERIC
 16981         MOVE ZEROS TO WS-DEFAULT-APR.
 16982     IF CP-EARN-AS-NET-PAY
 16983         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16984            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16985                MOVE WS-DEFAULT-APR
 16986                                 TO  CP-LOAN-APR
 16987                MOVE ER-3780     TO  WS-ERROR
 16988                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16989            ELSE
 16990                MOVE ER-3781     TO  WS-ERROR
 16991                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16992     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16993     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 308
* EL050.cbl
 16994        AND CP-CANCEL-REASON = 'R'
 16995        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16996        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16997     END-IF
 16998     IF PB-COMPANY-ID = 'DCC'
 16999        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17000        AND (CP-EARNING-METHOD = 'D')
 17001        AND (CP-CANCEL-REASON NOT = 'R')
 17002        CONTINUE
 17003     ELSE
 17004        GO TO 3750-CONTINUE
 17005     END-IF
 17006     MOVE ' '                    TO DD-IU-SW
 17007     IF NOT PDEF-MASTER-FOUND
 17008        MOVE ' '                 TO PDEF-MASTER-SW
 17009        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 17010        MOVE PB-STATE            TO ERPDEF-STATE
 17011        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 17012           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 17013        END-IF
 17014        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 17015        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 17016        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 17017        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 17018        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 17019        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 17020        IF PDEF-MASTER-FOUND
 17021           MOVE 'N'              TO PDEF-MASTER-SW
 17022           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17023           IF PDEF-MASTER-FOUND
 17024              IF (ERPDEF-KEY-SAVE (1:16) =
 17025                           PD-CONTROL-PRIMARY (1:16))
 17026                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17027                 CONTINUE
 17028              ELSE
 17029                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17030                 IF (ERPDEF-KEY-SAVE (1:16) =
 17031                           PD-CONTROL-PRIMARY (1:16))
 17032                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17033                    CONTINUE
 17034                 ELSE
 17035                    MOVE ER-2740 TO WS-ERROR
 17036                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17037                    GO TO 3770-CHECK-REFUNDS
 17038                 END-IF
 17039              END-IF
 17040           END-IF
 17041           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 17042        END-IF
 17043     END-IF
 17044     IF PDEF-MASTER-FOUND
 17045        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17046           (V1 > +8)
 17047           OR (PD-PROD-CODE (V1) = 'I')
 17048        END-PERFORM
 17049        IF V1 < +9
 17050           SET DD-IU-PRESENT        TO TRUE
 17051        END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 309
* EL050.cbl
 17052        IF WS-AH-DCC-TRUNC = 'T'
 17053           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 17054        ELSE
 17055           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 17056        END-IF
 17057        EVALUATE TRUE
 17058           WHEN WS-TERM > +168
 17059              MOVE 15               TO V1
 17060           WHEN WS-TERM > +156
 17061              MOVE 14               TO V1
 17062           WHEN WS-TERM > +144
 17063              MOVE 13               TO V1
 17064           WHEN WS-TERM > +132
 17065              MOVE 12               TO V1
 17066           WHEN WS-TERM > +120
 17067              MOVE 11               TO V1
 17068           WHEN WS-TERM > +108
 17069              MOVE 10               TO V1
 17070           WHEN WS-TERM > +96
 17071              MOVE 9                TO V1
 17072           WHEN WS-TERM > +84
 17073              MOVE 8                TO V1
 17074           WHEN WS-TERM > +72
 17075              MOVE 7                TO V1
 17076           WHEN WS-TERM > +60
 17077              MOVE 6                TO V1
 17078           WHEN WS-TERM > +48
 17079              MOVE 5                TO V1
 17080           WHEN WS-TERM > +36
 17081              MOVE 4                TO V1
 17082           WHEN WS-TERM > +24
 17083              MOVE 3                TO V1
 17084           WHEN WS-TERM > +12
 17085              MOVE 2                TO V1
 17086           WHEN OTHER
 17087              MOVE 1                TO V1
 17088        END-EVALUATE
 17089
 17090        EVALUATE TRUE
 17091*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 17092*             < +13)
 17093*             AND (DD-IU-PRESENT)
 17094*             MOVE 2                TO V2
 17095*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 17096*             MOVE 1                TO V2
 17097           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 17098              MOVE 2                TO V2
 17099           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 17100              MOVE 3                TO V2
 17101           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 17102              MOVE 4                TO V2
 17103           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 17104              MOVE 5                TO V2
 17105           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 17106              MOVE 6                TO V2
 17107           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 17108              MOVE 7                TO V2
 17109           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 310
* EL050.cbl
 17110              MOVE 8                TO V2
 17111           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 17112              MOVE 9                TO V2
 17113           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 17114              MOVE 10               TO V2
 17115           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 17116              MOVE 11               TO V2
 17117           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 17118              MOVE 12               TO V2
 17119           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 17120              MOVE 13               TO V2
 17121           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 17122              MOVE 14               TO V2
 17123           WHEN OTHER
 17124              MOVE 15               TO V2
 17125        END-EVALUATE
 17126
 17127        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 17128                                 TO CP-DDF-LO-FACT
 17129        MOVE PD-UEP-FACTOR (V1 V2)
 17130                                 TO CP-DDF-HI-FACT
 17131
 17132        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 17133        MOVE CM-AH-CLP     TO CP-DDF-CLP
 17134        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 17135           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 17136        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 17137        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 17138        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 17139           + PD-1ST-YR-ADMIN-ALLOW
 17140
 17141        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17142*       IF PI-CLP-YN = 'Y'
 17143*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 17144*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 17145*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 17146*       END-IF
 17147
 17148        IF DD-IU-PRESENT
 17149           MOVE 'I'              TO CP-EARNING-METHOD
 17150        END-IF
 17151        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17152                                     CP-CLP-RATE-UP
 17153        IF CP-IU-RATE-UP NOT = ZEROS
 17154           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 17155              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 17156           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 17157              / (1 - WS-WORK-FACT)
 17158        END-IF
 17159     END-IF
 17160     .
 17161 3750-CONTINUE.
 17162     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 17163
 17164     IF CP-REFUND-TYPE-USED NOT = SPACE
 17165         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 17166
 17167     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 311
* EL050.cbl
 17168        CP-ERROR-RATE-NOT-FOUND
 17169        MOVE ER-2740             TO WS-ERROR
 17170        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17171
 17172     IF CP-ERROR-RATE-FILE-NOTOPEN
 17173        MOVE ER-2617             TO WS-ERROR
 17174        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17175     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17176        AND (PB-CI-ENTRY-STATUS = 'M')
 17177        MOVE +0                  TO PB-C-AH-REF-CALC
 17178     ELSE
 17179        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 17180     END-IF
 17181     if pb-company-id = 'VPP'
 17182        MOVE cm-ah-clp           to cp-original-premium
 17183        move zeros               to cp-calc-refund
 17184        perform 7600-get-refund  thru 7600-exit
 17185        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 17186           move cp-calc-refund   to pb-c-ah-rfnd-clp
 17187        else
 17188           move zeros            to pb-c-ah-rfnd-clp
 17189        end-if
 17190        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 17191           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 17192           pb-ci-cancel-fee
 17193     end-if
 17194     IF PB-COMPANY-ID = 'DCC'
 17195        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17196        AND (CP-EARNING-METHOD = 'D' OR 'I')
 17197        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17198        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 17199        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 17200        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 17201        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 17202        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 17203*       if pb-c-cancel-amt < +0
 17204*          compute pb-c-ah-rfnd-clp = pb-c-ah-rfnd-clp * -1
 17205*       end-if
 17206*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 17207     END-IF
 17208     .
 17209 3770-CHECK-REFUNDS.
 17210
 17211     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 17212        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17213           MOVE ER-2766          TO WS-ERROR
 17214           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17215           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 17216           IF PB-C-LF-REF-CALC LESS THAN ZERO
 17217              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 17218
 17219     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 17220        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17221           MOVE ER-2766          TO WS-ERROR
 17222           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17223           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 17224           IF PB-C-AH-REF-CALC LESS THAN ZERO
 17225              MOVE ZEROS         TO PB-C-AH-REF-CALC.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 312
* EL050.cbl
 17226
 17227     IF PB-COMP-LF-CANCEL
 17228        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 17229        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17230           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 17231              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 17232
 17233     IF PB-COMP-AH-CANCEL
 17234        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 17235        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17236           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 17237              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 17238
 17239     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 17240             GIVING WS-UNSIGN-WRK1
 17241     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 17242             GIVING WS-UNSIGN-WRK2.
 17243
 17244     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17245         MOVE ZERO TO WS-UNSIGN-WRK1.
 17246
 17247     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17248         MOVE ZERO TO WS-UNSIGN-WRK2.
 17249
 17250     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 17251
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 313
* EL050.cbl
 17253
 17254 3772-CONTINUE.
 17255
 17256**********************************
 17257*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 17258*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 17259*** DOUBLES THE TOLERANCE AMOUNT.
 17260***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 17261**********************************
 17262     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 17263     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 17264         IF WS-REF-REJECT-SW = SPACE
 17265             MOVE ER-2754        TO WS-ERROR
 17266             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17267           ELSE
 17268             MOVE ER-2736        TO WS-ERROR
 17269             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17270**********************************
 17271
 17272 3773-CONTINUE.
 17273
 17274     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 17275        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17276           MOVE ER-2723          TO WS-ERROR
 17277           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17278
 17279     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 17280        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17281           MOVE ER-2724          TO WS-ERROR
 17282           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17283
 17284     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17285         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 17286             (1 + WS-LF-REFUND-OVS-PCT)
 17287     ELSE
 17288         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 17289
 17290     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 17291         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 17292             (1 - WS-TOL-LF-REFUND-PCT)
 17293     ELSE
 17294         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 17295
 17296     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17297        AND (PB-CI-ENTRY-STATUS = 'M')
 17298        AND (PB-C-LF-CANCEL-AMT > +0)
 17299        MOVE ER-3843             TO WS-ERROR
 17300        PERFORM 9900-ERROR-FORMAT
 17301                                 THRU 9900-EXIT
 17302     END-IF
 17303     EVALUATE TRUE
 17304        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17305           CONTINUE
 17306        WHEN PB-C-LF-CANCEL-AMT = +0
 17307                 AND PB-C-LF-REF-CALC > +0
 17308           CONTINUE
 17309        WHEN WS-LF-REFUND-OVS-AMT = 0
 17310                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 314
* EL050.cbl
 17311           CONTINUE
 17312        WHEN OTHER
 17313           IF WS-TOL-LF-REFUND  = +0
 17314              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 17315           END-IF
 17316           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17317                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 17318                          (PB-C-LF-CANCEL-AMT))
 17319              CONTINUE
 17320           ELSE
 17321              IF WS-LF-REFUND-OVS-AMT = +0
 17322                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 17323              END-IF
 17324              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17325                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 17326                                       PB-C-LF-CANCEL-AMT)
 17327                 CONTINUE
 17328              ELSE
 17329                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17330                   MOVE ER-2754   TO  WS-ERROR
 17331                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17332                 ELSE
 17333                    MOVE ER-2736   TO  WS-ERROR
 17334                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17335                 END-IF
 17336              END-IF
 17337           END-IF
 17338     END-EVALUATE.
 17339
 17340     EVALUATE TRUE
 17341        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17342           CONTINUE
 17343        WHEN PB-C-LF-CANCEL-AMT = +0
 17344                 AND PB-C-LF-REF-CALC > +0
 17345           CONTINUE
 17346        WHEN OTHER
 17347           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17348               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 17349              CONTINUE
 17350           ELSE
 17351              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17352               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 17353                CONTINUE
 17354              ELSE
 17355                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17356                     MOVE ER-2754   TO  WS-ERROR
 17357                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17358                 ELSE
 17359                     MOVE ER-2736   TO  WS-ERROR
 17360                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17361                 END-IF
 17362              END-IF
 17363           END-IF
 17364     END-EVALUATE.
 17365
 17366     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17367         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 17368             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 315
* EL050.cbl
 17369     ELSE
 17370         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 17371
 17372     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 17373         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 17374             (1 - WS-TOL-AH-REFUND-PCT)
 17375     ELSE
 17376         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 17377
 17378     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17379        AND (PB-CI-ENTRY-STATUS = 'M')
 17380        AND (PB-C-AH-CANCEL-AMT > +0)
 17381        MOVE ER-3843             TO WS-ERROR
 17382        PERFORM 9900-ERROR-FORMAT
 17383                                 THRU 9900-EXIT
 17384     END-IF
 17385     EVALUATE TRUE
 17386        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 17387           CONTINUE
 17388*       WHEN PB-C-AH-REF-CALC = +0 AND
 17389*                  PB-C-AH-CANCEL-AMT > +0
 17390        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 17391                   PB-C-AH-REF-CALC > +0
 17392           CONTINUE
 17393        WHEN WS-AH-REFUND-OVS-AMT = +0
 17394                AND WS-TOL-AH-REFUND = +0
 17395           CONTINUE
 17396        WHEN OTHER
 17397           IF WS-TOL-AH-REFUND = +0
 17398              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 17399           END-IF
 17400           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 17401               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 17402                                         PB-C-AH-CANCEL-AMT)
 17403              CONTINUE
 17404           ELSE
 17405              IF WS-AH-REFUND-OVS-AMT = +0
 17406                 MOVE +9999999.99 TO
 17407                         WS-AH-REFUND-OVS-AMT
 17408              END-IF
 17409              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17410                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 17411                                         PB-C-AH-CANCEL-AMT)
 17412                 CONTINUE
 17413              ELSE
 17414                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17415                    MOVE ER-2754   TO  WS-ERROR
 17416                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17417                 ELSE
 17418                    MOVE ER-2736   TO  WS-ERROR
 17419                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17420                 END-IF
 17421              END-IF
 17422           END-IF
 17423     END-EVALUATE.
 17424
 17425     EVALUATE TRUE
 17426        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 316
* EL050.cbl
 17427           CONTINUE
 17428*       WHEN PB-C-AH-REF-CALC > +0 AND
 17429*                  PB-C-AH-CANCEL-AMT = +0
 17430        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 17431                   PB-C-AH-REF-CALC = +0
 17432           CONTINUE
 17433        WHEN OTHER
 17434           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 17435               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 17436              CONTINUE
 17437           ELSE
 17438              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17439                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 17440                 CONTINUE
 17441              ELSE
 17442                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17443                     MOVE ER-2754   TO  WS-ERROR
 17444                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17445                 ELSE
 17446                     MOVE ER-2736   TO  WS-ERROR
 17447                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17448                 END-IF
 17449              END-IF
 17450           END-IF
 17451     END-EVALUATE.
 17452
 17453     IF (PB-C-LF-CANCEL-AMT = ZERO)
 17454        AND (PB-C-AH-CANCEL-AMT = ZERO)
 17455        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17456           AND  PB-C-LF-REF-CALC < +1.00
 17457           AND  PB-C-AH-REF-CALC < +1.00
 17458           CONTINUE
 17459        ELSE
 17460           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17461              AND (PB-CI-ENTRY-STATUS = 'M')
 17462              CONTINUE
 17463           ELSE
 17464              MOVE ER-2741       TO WS-ERROR
 17465              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17466           END-IF
 17467        END-IF
 17468     END-IF
 17469
 17470     IF (PB-C-LF-CANCEL-AMT = ZERO
 17471        AND WS-LF-BENEFIT-CD NOT = ZERO
 17472        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 17473        AND PB-C-LF-REF-CALC NOT = ZERO)
 17474        OR
 17475        (PB-C-LF-CANCEL-AMT = ZERO
 17476        AND WS-LF-BENEFIT-CD NOT = ZERO
 17477        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 17478             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17479                AND PB-C-LF-REF-CALC LESS THAN +1.00
 17480                NEXT SENTENCE
 17481             ELSE
 17482                MOVE ER-2739        TO WS-ERROR
 17483                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17484
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 317
* EL050.cbl
 17485     IF (PB-C-AH-CANCEL-AMT = ZERO
 17486        AND WS-AH-BENEFIT-CD NOT = ZERO
 17487        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 17488        AND PB-C-AH-REF-CALC NOT = ZERO)
 17489        OR
 17490        (PB-C-AH-CANCEL-AMT = ZERO
 17491        AND WS-AH-BENEFIT-CD NOT = ZERO
 17492        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 17493             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17494                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17495                NEXT SENTENCE
 17496             ELSE
 17497                MOVE ER-2738        TO WS-ERROR
 17498                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17499
 17500 3775-OVER-REF-CHK.
 17501
 17502     IF PB-CI-ENTRY-STATUS = '5'
 17503        GO TO 3780-UPDATE-CANCEL-CERT.
 17504
 17505     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17506                              PB-CI-LF-ALT-PREMIUM-AMT.
 17507
 17508     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17509        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17510                                 PB-C-LF-REF-CALC
 17511      ELSE
 17512        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17513                                 PB-C-LF-CANCEL-AMT.
 17514
 17515     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17516        MOVE ER-2755             TO WS-ERROR
 17517        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17518
 17519     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17520
 17521     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17522        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17523                                 PB-C-AH-REF-CALC
 17524      ELSE
 17525        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17526                                 PB-C-AH-CANCEL-AMT.
 17527
 17528     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17529        MOVE ER-2778             TO WS-ERROR
 17530        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17531
 17532     IF PB-CI-OB-FLAG NOT = 'Z'
 17533        NEXT SENTENCE
 17534       ELSE
 17535         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17536            MOVE ER-2757           TO WS-ERROR
 17537            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17538
 17539 3780-UPDATE-CANCEL-CERT.
 17540
 17541     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17542        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 318
* EL050.cbl
 17543        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17544
 17545     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17546         MOVE ER-2729              TO WS-ERROR
 17547         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17548
 17549     IF PB-CI-LF-BENEFIT-CD = ZERO
 17550         GO TO 3780-UPDATE-CONT-1.
 17551
 17552     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17553         GO TO 3780-UPDATE-CONT-1.
 17554
 17555     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17556       AND
 17557        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17558       AND
 17559        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17560       AND
 17561        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17562            NEXT SENTENCE
 17563       ELSE
 17564        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17565          AND
 17566***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17567***       AND
 17568           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17569            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17570               MOVE ER-2730      TO WS-ERROR
 17571               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17572               GO TO 3999-END-EDIT
 17573            ELSE
 17574               GO TO 3999-END-EDIT
 17575        ELSE
 17576            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17577               MOVE ER-2765           TO WS-ERROR
 17578               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17579               GO TO 3785-CHECK-REF-INT.
 17580*              GO TO 3999-END-EDIT.
 17581
 17582 3780-UPDATE-CONT-1.
 17583     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17584
 17585     IF PB-CI-AH-BENEFIT-CD = ZERO
 17586         GO TO 3780-UPDATE-CONT-2.
 17587
 17588     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17589         GO TO 3780-UPDATE-CONT-2.
 17590
 17591     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17592
 17593     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17594       AND
 17595        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17596       AND
 17597        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17598       AND
 17599        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17600            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 319
* EL050.cbl
 17601       ELSE
 17602        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17603          AND
 17604***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17605***       AND
 17606           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17607           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17608            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17609               MOVE ER-2773      TO WS-ERROR
 17610               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17611               GO TO 3999-END-EDIT
 17612            ELSE
 17613               GO TO 3999-END-EDIT
 17614            END-IF
 17615           ELSE
 17616             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17617                IF MSTR-CERT-NO = W-CL-CERT-NO
 17618                   MOVE ER-2890 TO WS-ERROR
 17619                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17620                   GO TO 3999-END-EDIT
 17621                ELSE
 17622                   MOVE ER-2898 TO WS-ERROR
 17623                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17624                   GO TO 3999-END-EDIT
 17625                END-IF
 17626             ELSE
 17627                GO TO 3785-CHECK-REF-INT
 17628             END-IF
 17629           END-IF
 17630          ELSE
 17631            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17632              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17633                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17634                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17635                      MOVE ER-2890 TO WS-ERROR
 17636                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17637                      GO TO 3999-END-EDIT
 17638                   ELSE
 17639                      MOVE ER-2898 TO WS-ERROR
 17640                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17641                      GO TO 3999-END-EDIT
 17642                   END-IF
 17643                ELSE
 17644                   MOVE ER-2765 TO WS-ERROR
 17645                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17646                   GO TO 3785-CHECK-REF-INT
 17647                END-IF
 17648              ELSE
 17649               MOVE ER-2765      TO WS-ERROR
 17650               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17651               GO TO 3785-CHECK-REF-INT.
 17652*              GO TO 3999-END-EDIT.
 17653
 17654 3780-UPDATE-CONT-2.
 17655
 17656     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17657        AND WS-LF-BENEFIT-CD = ZERO
 17658           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 320
* EL050.cbl
 17659           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17660
 17661     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17662        AND WS-AH-BENEFIT-CD = ZERO
 17663           MOVE ER-2744           TO WS-ERROR
 17664           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17665
 17666     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17667        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17668        AND
 17669        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17670         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17671           MOVE ER-2746           TO WS-ERROR
 17672           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17673
 17674     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17675       AND
 17676        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17677             MOVE ER-2737        TO WS-ERROR
 17678             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17679
 17680     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17681       AND
 17682        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17683             MOVE ER-2737        TO WS-ERROR
 17684             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17685
 17686     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17687         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17688             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17689             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17690         ELSE
 17691             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17692                 MOVE ER-2768    TO WS-ERROR
 17693                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17694             ELSE
 17695                 MOVE ER-2756    TO WS-ERROR
 17696                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17697
 17698     IF CERT-PEND-ISSUE-RETURNED
 17699        MOVE ER-2772             TO WS-ERROR
 17700        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17701 3785-CHECK-REF-INT.
 17702*    IF PB-STATE NOT = 'NH' and 'TN'
 17703     IF PB-STATE NOT = 'NH'
 17704        GO TO 3999-END-EDIT
 17705     END-IF
 17706
 17707     MOVE ER-2796                TO WS-ERROR
 17708     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17709     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17710        OR (CM-REF-INTERFACE-SW = 'Y')
 17711        MOVE ER-2793             TO WS-ERROR
 17712        PERFORM 9900-ERROR-FORMAT
 17713                                 THRU 9900-EXIT
 17714     END-IF
 17715     MOVE +0                     TO WS-PAYMENT-AMT
 17716     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 321
* EL050.cbl
 17717        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17718               PB-C-AH-CANCEL-DT
 17719           GO TO 3999-END-EDIT
 17720        END-IF
 17721     end-if
 17722***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17723***-_-
 17724***-_-   For TN it's only flat cancels
 17725***-_-
 17726***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17727     if pb-state = 'TN'
 17728        if ((pb-c-lf-cancel-dt <> low-values)
 17729           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17730                      or
 17731           ((pb-c-ah-cancel-dt <> low-values)
 17732           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17733           GO TO 3999-END-EDIT
 17734        END-IF
 17735     end-if
 17736     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17737        GO TO 3999-END-EDIT
 17738     END-IF
 17739***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17740***-_-
 17741***-_-   if cancel date within 15 days of effective date, bypass
 17742***-_-
 17743***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17744     IF PB-STATE NOT = 'NH'
 17745        GO TO 3785-CONTINUE
 17746     END-IF
 17747     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17748     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17749     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17750        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17751     END-IF
 17752     MOVE '1'                    TO DC-OPTION-CODE
 17753     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17754     IF NO-CONVERSION-ERROR
 17755        IF DC-ELAPSED-DAYS < +16
 17756           GO TO 3999-END-EDIT
 17757        END-IF
 17758     END-IF
 17759***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17760***-_-
 17761***-_-   if cancel date within 30 days of current date then
 17762***-_-   bypass else subtract 15 days from period
 17763***-_-
 17764***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17765     MOVE +0                     TO DC-ELAPSED-DAYS
 17766     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17767     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17768     MOVE '1'                    TO DC-OPTION-CODE
 17769     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17770     IF NO-CONVERSION-ERROR
 17771        IF DC-ELAPSED-DAYS > +30
 17772           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17773        ELSE
 17774           GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 322
* EL050.cbl
 17775        END-IF
 17776     ELSE
 17777        GO TO 3999-END-EDIT
 17778     END-IF
 17779     .
 17780 3785-CONTINUE.
 17781     if pb-state = 'TN'
 17782        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 17783        MOVE PB-INPUT-DT         TO DC-BIN-DATE-2
 17784        MOVE '1'                 TO DC-OPTION-CODE
 17785        PERFORM 8500-DATE-CONVERT
 17786                                 THRU 8500-EXIT
 17787        IF no-CONVERSION-ERROR
 17788           IF DC-ELAPSED-DAYS < +16
 17789              GO TO 3999-END-EDIT
 17790           END-IF
 17791        END-IF
 17792     end-if
 17793***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17794***-_-
 17795***-_-   'NH' is 10%, TN is 3.5%
 17796***-_-
 17797***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17798*    if pb-state = 'NH'
 17799*       move +1.10               to ws-work-rate
 17800*    else
 17801*       move +1.035              to ws-work-rate
 17802*    end-if
 17803     compute ws-work-rate = (1 + ws-st-refund-int-rate)
 17804     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17805        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17806           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17807     IF WS-PAYMENT-AMT < 10.00
 17808        GO TO 3999-END-EDIT
 17809     END-IF
 17810*    PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17811
 17812     if (cm-soc-sec-no(1:9) numeric)
 17813        and (cm-soc-sec-no(1:9) not = zeros)
 17814        GO TO 3999-END-EDIT
 17815     END-IF
 17816     MOVE ER-2795                TO WS-ERROR
 17817     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17818
 17819     GO TO 3999-END-EDIT.
 17820******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 323
* EL050.cbl
 17822 3990-FILES-NOT-OPEN.
 17823
 17824     MOVE ER-2617                TO WS-ERROR.
 17825     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17826     GO TO 9990-RETURN.
 17827
 17828 3999-END-EDIT.
 17829
 17830     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17831
 17832     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17833         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17834         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17835             PERFORM 9250-UNLOCK-RETURN
 17836             GO TO 9990-RETURN
 17837          ELSE
 17838             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17839             GO TO 9990-RETURN.
 17840
 17841     IF PB-CANCELLATION
 17842          GO TO 9990-RETURN.
 17843
 17844     IF CERT-WAS-NOT-FOUND
 17845        MOVE SPACES              TO CERTIFICATE-MASTER.
 17846
 17847     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17848
 17849     IF CERT-WAS-FOUND
 17850         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17851             PERFORM 9250-UNLOCK-RETURN
 17852          ELSE
 17853            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17854      ELSE
 17855         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17856
 17857*    if pb-company-id = 'VPP'
 17858*       perform 8150-read-elcrtt thru 8150-exit
 17859*       if ws-vehicle-odometer numeric
 17860*          if ws-vehicle-odometer > 6000
 17861*             move er-1583       to ws-error
 17862*             PERFORM 9900-ERROR-FORMAT
 17863*                                THRU 9900-EXIT
 17864*          end-if
 17865*       end-if
 17866*    end-if
 17867     perform 8145-read-elcrtt-upd thru 8145-exit
 17868     if not elcrtt-found
 17869        move 'CS'                to certificate-trailers
 17870        move cm-control-primary  to cs-control-primary
 17871        move 'C'                 TO cs-trailer-type
 17872        move zeros               to cs-vehicle-odometer
 17873     end-if
 17874     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17875        IF ((PB-COMPANY-ID = 'DCC')
 17876           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17877                         or
 17878           (pb-company-id = 'CID' or 'VPP')
 17879           IF (PB-I-VIN NOT EQUAL CS-VIN-NUMBER)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 324
* EL050.cbl
 17880               or (hldi-pass-area not = spaces)
 17881               move pa-modelyear        to cs-year
 17882               move pa-makename         to cs-make
 17883               move pa-modelname        to cs-model
 17884               move pa-seriesname       to cs-future
 17885               MOVE PB-I-VIN            TO CS-VIN-NUMBER
 17886               move 'Y'                 to elcrtt-update-sw
 17887           end-if
 17888        end-if
 17889     end-if
 17890     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17891        IF WS-INS-AGE-SET = 'Y'
 17892           MOVE WS-INS-AGE-DEFAULTED
 17893                                 TO CS-INS-AGE-DEFAULT-FLAG
 17894           move 'Y'              to elcrtt-update-sw
 17895        END-IF
 17896        IF WS-JNT-AGE-SET = 'Y'
 17897           MOVE WS-JNT-AGE-DEFAULTED
 17898                                 TO CS-JNT-AGE-DEFAULT-FLAG
 17899           move 'Y'              to elcrtt-update-sw
 17900        END-IF
 17901     end-if
 17902     move cs-ins-age-default-flag to ws-ins-age-defaulted
 17903     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 17904     move cs-vehicle-odometer    to ws-vehicle-odometer
 17905     if ws-ins-age-defaulted = 'Y'
 17906        move er-1573             to ws-error
 17907        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17908     end-if
 17909
 17910     if ws-jnt-age-defaulted = 'Y'
 17911        move er-1574             to ws-error
 17912        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17913     end-if
 17914***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17915***                                                           ****
 17916***  Set an error if the state requires verification of agent ****
 17917***  and agent hasn't verified yet and the status is not =    ****
 17918***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17919***  and the entry date > 09/01/2015.                         ****
 17920***                                                           ****
 17921***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17922     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17923        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17924        and (pb-account (9:2) not = 'OB')
 17925        if (ws-st-agent-sig-edit = 'Y')
 17926           and (am-report-code-1 not = 'CONLEY')
 17927           evaluate true
 17928              when cs-agent-edit-status = 'C'
 17929                 move er-1743    to ws-error
 17930                 perform 9900-error-format
 17931                                 thru 9900-exit
 17932              when cs-agent-edit-status = 'S'
 17933                 move er-1744    to ws-error
 17934                 perform 9900-error-format
 17935                                 thru 9900-exit
 17936              when cs-agent-edit-status = 'M'
 17937                 move er-1745    to ws-error
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 325
* EL050.cbl
 17938                 perform 9900-error-format
 17939                                 thru 9900-exit
 17940              when cs-agent-edit-status = 'R'
 17941                 move er-1747    to ws-error
 17942                 perform 9900-error-format
 17943                                 thru 9900-exit
 17944              when cs-agent-edit-status = 'N'
 17945                 move er-1748    to ws-error
 17946                 perform 9900-error-format
 17947                                 thru 9900-exit
 17948              when cs-agent-edit-status <> 'V' and 'U' and
 17949                                           'R' and 'N'
 17950                 move er-1746    to ws-error
 17951                 perform 9900-error-format
 17952                                 thru 9900-exit
 17953           end-evaluate
 17954        end-if
 17955     end-if
 17956*    move ' ' to cs-claim-verification-status
 17957*    move 'Y' to elcrtt-update-sw
 17958     if cs-claim-verification-status = ' ' or 'R'
 17959        move pb-state            to pa-clmhs-state
 17960        move pb-account          to pa-account
 17961        move ws-greg-eff-date    to pa-eff-dt
 17962        move pb-cert-no          to pa-cert-no
 17963        perform 7795-call-sqlclmhs
 17964                                 thru 7795-exit
 17965        if pa-clm-count > 0
 17966           if cs-claim-verification-status = ' '
 17967              move 'R'           to cs-claim-verification-status
 17968*             display 'Updating elcrtt ' pb-state ' '
 17969*                pb-account ' ' pb-cert-no
 17970              move 'Y'           to elcrtt-update-sw
 17971           end-if
 17972        else
 17973           if cs-claim-verification-status = 'R'
 17974              move ' '           to cs-claim-verification-status
 17975              move 'Y'           to elcrtt-update-sw
 17976           end-if
 17977        end-if
 17978     end-if
 17979
 17980     if cs-claim-verification-status <> ' '
 17981        evaluate true
 17982           when cs-claim-verification-status = 'R'
 17983              move er-1749    to ws-error
 17984              perform 9900-error-format
 17985                              thru 9900-exit
 17986           when cs-claim-verification-status = 'W'
 17987              move er-1750    to ws-error
 17988              perform 9900-error-format
 17989                              thru 9900-exit
 17990           when cs-claim-verification-status = 'I'
 17991              move er-1751    to ws-error
 17992              perform 9900-error-format
 17993                              thru 9900-exit
 17994           when cs-claim-verification-status = 'K'
 17995              move er-1761    to ws-error
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 326
* EL050.cbl
 17996              perform 9900-error-format
 17997                              thru 9900-exit
 17998           when cs-claim-verification-status = 'A'
 17999              move er-1752    to ws-error
 18000              perform 9900-error-format
 18001                              thru 9900-exit
 18002           when cs-claim-verification-status = 'B'
 18003              move er-1754    to ws-error
 18004              perform 9900-error-format
 18005                              thru 9900-exit
 18006           when cs-claim-verification-status = 'C'
 18007              move er-1753    to ws-error
 18008              perform 9900-error-format
 18009                              thru 9900-exit
 18010           when cs-claim-verification-status = 'D'
 18011              move er-1757    to ws-error
 18012              perform 9900-error-format
 18013                              thru 9900-exit
 18014           when cs-claim-verification-status = 'E'
 18015              move er-1758    to ws-error
 18016              perform 9900-error-format
 18017                              thru 9900-exit
 18018           when cs-claim-verification-status = 'F'
 18019              move er-1759    to ws-error
 18020              perform 9900-error-format
 18021                              thru 9900-exit
 18022           when cs-claim-verification-status = 'G'
 18023              move er-1760    to ws-error
 18024              perform 9900-error-format
 18025                              thru 9900-exit
 18026*          when cs-claim-verification-status = 'H'
 18027*             move er-1756    to ws-error
 18028*             perform 9900-error-format
 18029*                             thru 9900-exit
 18030*          when cs-claim-verification-status = 'J'
 18031*             move er-1755    to ws-error
 18032*             perform 9900-error-format
 18033*                             thru 9900-exit
 18034        end-evaluate
 18035     end-if
 18036
 18037     IF ELCRTT-UPDATE
 18038        perform 8150-update-elcrtt thru 8150-exit
 18039*       display ' back from 8150 ' elcrtt-file-status
 18040     else
 18041        if elcrtt-found
 18042           perform 8155-unlock-elcrtt
 18043                                 thru 8155-exit
 18044        end-if
 18045     end-if
 18046     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 18047     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 18048        AND (WS-NO-SECURE-PAY))
 18049                  OR
 18050        (WS-LF-SPECIAL-CALC-CD = 'O'
 18051        OR WS-AH-SPECIAL-CALC-CD = 'O')
 18052        SET SKIP-ADDR-EDIT       TO TRUE
 18053     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 327
* EL050.cbl
 18054     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 18055        AND (NOT SKIP-ADDR-EDIT)
 18056        MOVE ER-2963             TO WS-ERROR
 18057        PERFORM 9900-ERROR-FORMAT
 18058                                 THRU 9900-EXIT
 18059        GO TO 9990-RETURN
 18060     END-IF
 18061     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 18062     IF ERPNDM-FOUND NOT = 'X'
 18063        move 'Y'                 to erpndm-unlock-sw
 18064        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18065           OR (PM-CITY        = SPACES OR LOW-VALUES)
 18066           OR (PM-STATE       = SPACES OR LOW-VALUES)
 18067           OR (PM-ZIP         = SPACES OR LOW-VALUES)
 18068           or (pm-zip-code    = zeros)
 18069           or (pm-zip-code not numeric))
 18070           AND (NOT SKIP-ADDR-EDIT)
 18071           MOVE ER-2694          TO WS-ERROR
 18072           PERFORM 9900-ERROR-FORMAT
 18073                                 THRU 9900-EXIT
 18074        END-IF
 18075        MOVE ' '                 TO STATE-RECORD-ERROR
 18076        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18077        MOVE PM-STATE            TO CNTL-ACCESS
 18078        MOVE '3'                 TO CNTL-REC-TYPE
 18079        MOVE +0                  TO CNTL-SEQ-NO
 18080        MOVE '0'                 TO RC-SW-2
 18081        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18082        IF (NO-STATE-RECORD)
 18083           OR (CF-RECORD-TYPE NOT = '3')
 18084           OR (PM-STATE NOT = CF-STATE-CODE)
 18085           IF (PM-STATE = SPACES)
 18086              AND (SKIP-ADDR-EDIT)
 18087              CONTINUE
 18088           ELSE
 18089              MOVE ER-2963       TO WS-ERROR
 18090              PERFORM 9900-ERROR-FORMAT
 18091                                 THRU 9900-EXIT
 18092           END-IF
 18093        END-IF
 18094        if (ws-error not = er-2963 and er-2694)
 18095           and (pm-city-st-zip-verified = ' ')
 18096           and (pb-company-id = 'CID')
 18097           move spaces           to zipcd-pass-area
 18098           move pm-zip-code      to pa-zip
 18099           move pm-city          to pa-city
 18100           move pm-state         to pa-state
 18101           perform 7790-call-zip-verify
 18102                                 thru 7790-exit
 18103           if pa-errorcode-zip (1:1) = ' '
 18104                    move 'Y'     to pm-city-st-zip-verified
 18105                    PERFORM 8102-REWRITE-ERPNDM
 18106                                 THRU 8102-EXIT
 18107                    move 'N'     to erpndm-unlock-sw
 18108           else
 18109              MOVE ER-3061       TO WS-ERROR
 18110              PERFORM 9900-ERROR-FORMAT
 18111                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 328
* EL050.cbl
 18112           end-if
 18113        end-if
 18114        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 18115           MOVE ER-2883          TO WS-ERROR
 18116           PERFORM 9900-ERROR-FORMAT
 18117                                 THRU 9900-EXIT
 18118        END-IF
 18119        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 18120           MOVE ' '                 TO STATE-RECORD-ERROR
 18121           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18122           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 18123           MOVE '3'                 TO CNTL-REC-TYPE
 18124           MOVE +0                  TO CNTL-SEQ-NO
 18125           MOVE '0'                 TO RC-SW-2
 18126           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18127           IF NO-STATE-RECORD
 18128              OR (CF-RECORD-TYPE NOT = '3')
 18129              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 18130              MOVE ER-2964          TO WS-ERROR
 18131              PERFORM 9900-ERROR-FORMAT
 18132                                    THRU 9900-EXIT
 18133           END-IF
 18134        END-IF
 18135     ELSE
 18136        IF NOT SKIP-ADDR-EDIT
 18137           MOVE ER-2393          TO WS-ERROR
 18138           PERFORM 9900-ERROR-FORMAT
 18139                                 THRU 9900-EXIT
 18140        END-IF
 18141     END-IF
 18142     if need-to-unlock-erpndm
 18143        perform 8104-unlock-erpndm
 18144                                 thru 8104-exit
 18145     end-if
 18146     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 18147
 18148     IF (ERMAIL-FOUND = ' ' AND
 18149        ERPNDM-FOUND = ' ')
 18150        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 18151           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 18152           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 18153          OR
 18154           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 18155          OR
 18156           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 18157           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 18158           GO TO 3999-UNLOCK-ERMAIL.
 18159
 18160     IF ERPNDM-FOUND = 'X'
 18161        GO TO 3999-UNLOCK-ERMAIL.
 18162
 18163     IF PM-INSURED-LAST-NAME      = SPACES
 18164        AND PM-INSURED-FIRST-NAME = SPACES
 18165        AND PM-ADDRESS-LINE-1     = SPACES
 18166        AND PM-ADDRESS-LINE-2     = SPACES
 18167        AND PM-CITY-STATE         = SPACES
 18168        AND PM-CRED-BENE-NAME     = SPACES
 18169        AND PM-CRED-BENE-ADDR     = SPACES
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 329
* EL050.cbl
 18170        AND PM-CRED-BENE-CTYST    = SPACES
 18171        GO TO 3999-UNLOCK-ERMAIL
 18172     END-IF
 18173
 18174     MOVE SPACES                 TO MAILING-DATA.
 18175
 18176     MOVE 'MA'                   TO MA-RECORD-ID.
 18177     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 18178     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 18179     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 18180     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 18181     MOVE PB-SV-STATE            TO MA-STATE.
 18182     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 18183     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 18184
 18185     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 18186     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 18187
 18188     IF ERMAIL-FOUND = ' '
 18189        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 18190     ELSE
 18191        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 18192        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 18193        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 18194
 18195     GO TO 9990-RETURN.
 18196
 18197 3999-UNLOCK-ERMAIL.
 18198     IF ERMAIL-FOUND = ' '
 18199        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 18200
 18201     GO TO 9990-RETURN.
 18202******************************************************************
 18203
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 330
* EL050.cbl
 18205 4000-UPDATE-CANCELLED-CERT.
 18206     IF CERT-WAS-NOT-FOUND
 18207        GO TO 4299-EXIT.
 18208
 18209*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 18210     IF PB-C-INT-ON-REFS > ZEROS
 18211        MOVE PB-C-INT-ON-REFS TO CM-INT-ON-REFS
 18212     END-IF
 18213     IF PB-C-REF-INTERFACE-SW = 'Y'
 18214        MOVE PB-C-REF-INTERFACE-SW
 18215                                 TO CM-ref-INTERFACE-SW
 18216     END-IF
 18217*    IF ERMAIL-FOUND = ' '
 18218*       PERFORM 8140-UNLOCK-ERMAIL
 18219*                                THRU 8140-EXIT
 18220*    end-if
 18221     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18222     IF ERMAIL-FOUND = 'X'
 18223        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18224        OR (MA-CITY        = SPACES OR LOW-VALUES)
 18225        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 18226        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 18227           MOVE ER-2694          TO WS-ERROR
 18228           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18229     END-IF
 18230
 18231     IF PB-C-POST-CARD-IND = 'Y'
 18232        MOVE +8                  TO SUB
 18233*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18234        IF ERMAIL-FOUND = ' '
 18235           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 18236              (SUB > +7)
 18237              OR (MA-MAIL-STATUS (SUB) = '1')
 18238           END-PERFORM
 18239        END-IF
 18240        IF (SUB > +7)
 18241           OR (ERMAIL-FOUND = 'X')
 18242           MOVE ER-3789          TO WS-ERROR
 18243           PERFORM 9900-ERROR-FORMAT
 18244                                 THRU 9900-EXIT
 18245        END-IF
 18246     ELSE
 18247        MOVE 'N'                 TO PB-C-POST-CARD-IND
 18248     END-IF
 18249
 18250     IF ERMAIL-FOUND = ' '
 18251        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 18252     END-IF.
 18253
 18254     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 18255
 18256     IF PB-CI-OB-FLAG = 'Z'
 18257        GO TO 4150-SUMMARY-CERT-CANCEL.
 18258     perform 8145-read-elcrtt-upd thru 8145-exit
 18259     if not elcrtt-found
 18260        move 'CS'                to certificate-trailers
 18261        move cm-control-primary  to cs-control-primary
 18262        move 'C'                 TO cs-trailer-type
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 331
* EL050.cbl
 18263        move zeros               to cs-vehicle-odometer
 18264     end-if
 18265
 18266     if pb-lf-refund-type <> cs-lf-refund-method
 18267        move pb-lf-refund-type   to cs-lf-refund-method
 18268        set elcrtt-update to true
 18269     end-if
 18270     if pb-ah-refund-type <> cs-ah-refund-method
 18271        move pb-ah-refund-type   to cs-ah-refund-method
 18272        set elcrtt-update to true
 18273     end-if
 18274     IF PB-C-LF-CANCEL-VOIDED
 18275         PERFORM 4200-REVERSE-LF-CANCEL.
 18276     IF PB-C-AH-CANCEL-VOIDED
 18277         PERFORM 4200-REVERSE-AH-CANCEL.
 18278     IF ELCRTT-UPDATE
 18279        perform 8150-update-elcrtt thru 8150-exit
 18280     else
 18281        if elcrtt-found
 18282           perform 8155-unlock-elcrtt
 18283                                 thru 8155-exit
 18284        end-if
 18285     end-if
 18286     .
 18287 4100-APPLY-LF-CANCEL.
 18288
 18289     MOVE +0                     TO WS-SUB.
 18290
 18291 4100-CHECK-LF-ERRORS.
 18292
 18293     ADD +1                       TO WS-SUB.
 18294
 18295     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18296        IF LF-COVERAGE-CANCELLED
 18297           GO TO 4100-LF-CANCEL-CONT
 18298        ELSE
 18299           GO TO 4100-UPDATE-LF-COVERAGE.
 18300
 18301     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18302                                   ER-2729 OR
 18303                                   ER-2730 OR
 18304                                   ER-2731 OR
 18305                                   ER-2732 OR
 18306                                   ER-2737 OR
 18307                                   ER-2740 OR
 18308                                   ER-2743 OR
 18309                                   ER-2749 OR
 18310                                   ER-2750 OR
 18311                                   ER-2755 OR
 18312                                   ER-2757 OR
 18313                                   ER-2760 OR
 18314                                   ER-2772 OR
 18315                                   ER-2774 OR
 18316                                   ER-2776 OR
 18317                                   ER-2794
 18318        GO TO 4100-UPDATE-LF-COVERAGE.
 18319
 18320     GO TO 4100-CHECK-LF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 332
* EL050.cbl
 18321
 18322 4100-UPDATE-LF-COVERAGE.
 18323
 18324     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 18325     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 18326     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 18327        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 18328     END-IF
 18329     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18330                                      TO CM-CREDIT-INTERFACE-SW-2.
 18331     IF CM-LF-CANCEL-DT = LOW-VALUE
 18332         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 18333
 18334     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 18335         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 18336                                         CM-LF-STATUS-AT-CANCEL.
 18337
 18338     GO TO 4100-APPLY-AH-CANCEL.
 18339
 18340 4100-LF-CANCEL-CONT.
 18341     IF PB-C-LF-CANCEL-VOIDED
 18342         GO TO 4100-APPLY-AH-CANCEL.
 18343
 18344     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18345         GO TO 4100-APPLY-AH-CANCEL.
 18346
 18347     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 18348        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18349           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 18350        ELSE
 18351           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 18352
 18353     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 18354     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 18355
 18356     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 18357         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 18358
 18359     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 18360        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 18361         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 18362         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 18363
 18364     IF PB-RECORD-RETURNED
 18365        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18366      ELSE
 18367        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 18368
 18369 4100-APPLY-AH-CANCEL.
 18370
 18371     MOVE +0                      TO WS-SUB.
 18372
 18373 4100-CHECK-AH-ERRORS.
 18374
 18375     ADD +1                       TO WS-SUB.
 18376
 18377     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18378        IF AH-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 333
* EL050.cbl
 18379           GO TO 4100-AH-CANCEL-CONT
 18380        ELSE
 18381           GO TO 4100-UPDATE-AH-COVERAGE.
 18382
 18383     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18384                                   ER-2729 OR
 18385                                   ER-2732 OR
 18386                                   ER-2737 OR
 18387                                   ER-2740 OR
 18388                                   ER-2744 OR
 18389                                   ER-2749 OR
 18390                                   ER-2750 OR
 18391                                   ER-2755 OR
 18392                                   ER-2757 OR
 18393                                   ER-2760 OR
 18394                                   ER-2771 OR
 18395                                   ER-2772 OR
 18396                                   ER-2773 OR
 18397                                   ER-2775 OR
 18398                                   ER-2777 OR
 18399                                   ER-2778 OR
 18400                                   ER-2794
 18401        GO TO 4100-UPDATE-AH-COVERAGE.
 18402
 18403     GO TO 4100-CHECK-AH-ERRORS.
 18404
 18405 4100-UPDATE-AH-COVERAGE.
 18406
 18407     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 18408     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 18409     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 18410     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18411                                      TO CM-CREDIT-INTERFACE-SW-2.
 18412     IF CM-AH-CANCEL-DT = LOW-VALUE
 18413         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 18414
 18415     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 18416         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 18417                                         CM-AH-STATUS-AT-CANCEL.
 18418
 18419     IF LF-COVERAGE-CANCELLED
 18420         IF PB-RECORD-RETURNED
 18421              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 18422          ELSE
 18423              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 18424
 18425     GO TO 4299-EXIT.
 18426
 18427 4100-AH-CANCEL-CONT.
 18428     IF PB-C-AH-CANCEL-VOIDED
 18429         GO TO 4299-EXIT.
 18430
 18431     if cm-credit-interface-sw-2 = ' '
 18432        if pb-fatal-errors or pb-unforced-errors
 18433           move '4'              to cm-credit-interface-sw-2
 18434        else
 18435           move '1'              to cm-credit-interface-sw-2
 18436        end-if
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 334
* EL050.cbl
 18437     end-if
 18438     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18439         GO TO 4299-EXIT.
 18440
 18441     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 18442        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18443           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 18444        ELSE
 18445           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 18446
 18447     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 18448     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 18449
 18450     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 18451         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 18452
 18453     IF CM-AH-STATUS-AT-CANCEL = SPACE
 18454         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 18455         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 18456
 18457     IF PB-RECORD-RETURNED
 18458        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 18459      ELSE
 18460        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 18461
 18462     GO TO 4299-EXIT.
 18463
 18464 4150-SUMMARY-CERT-CANCEL.
 18465     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 18466
 18467     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18468        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18469                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 18470     ELSE
 18471        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18472                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 18473
 18474     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18475        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18476                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 18477     ELSE
 18478        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18479                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 18480
 18481     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 18482        NEXT SENTENCE
 18483     ELSE
 18484        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 18485
 18486     GO TO 4299-EXIT.
 18487
 18488 4200-REVERSE-LF-CANCEL.
 18489     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 18490
 18491     IF CM-LF-CANCEL-APPLIED
 18492        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 18493        MOVE SPACES                TO CM-LF-EXIT-BATCH
 18494        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 335
* EL050.cbl
 18495
 18496     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 18497
 18498     IF PB-RECORD-RETURNED
 18499        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18500       ELSE
 18501        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18502
 18503 4200-REVERSE-LF-EXIT.
 18504       EXIT.
 18505
 18506 4200-REVERSE-AH-CANCEL.
 18507     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 18508
 18509     IF CM-AH-CANCEL-APPLIED
 18510        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 18511        MOVE SPACES                TO CM-AH-EXIT-BATCH
 18512        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 18513
 18514     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 18515
 18516     IF PB-RECORD-RETURNED
 18517        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18518       ELSE
 18519        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18520
 18521 4200-REVERSE-AH-EXIT.
 18522       EXIT.
 18523
 18524 4299-EXIT.
 18525       EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 336
* EL050.cbl
 18527
 18528 4500-UPDATE-NEW-CERT.
 18529     IF CERT-WAS-FOUND
 18530         NEXT SENTENCE
 18531       ELSE
 18532         GO TO 4520-BUILD-NEW-KEY.
 18533
 18534     IF  CLASIC-CREATED-CERT
 18535         GO TO 4999-EXIT.
 18536
 18537     IF  CERT-WAS-CREATED-FOR-CLAIM
 18538         GO TO 4520-BUILD-NEW-KEY.
 18539
 18540     IF CERT-ADDED-BATCH
 18541        IF CM-RECORD-ID = 'CM'
 18542            GO TO 4999-EXIT.
 18543
 18544 4520-BUILD-NEW-KEY.
 18545* BUILD CONTROL PRIMARY
 18546
 18547     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 18548                                       CM-COMPANY-CD-A1
 18549                                       CM-COMPANY-CD-A2
 18550                                       CM-COMPANY-CD-A4
 18551                                       CM-COMPANY-CD-A5.
 18552
 18553     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 18554     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 18555     MOVE PB-SV-STATE               TO CM-STATE.
 18556     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 18557     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 18558     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 18559     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 18560
 18561     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 18562
 18563     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 18564     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 18565     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 18566     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 18567
 18568     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 18569        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 18570
 18571     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 18572         MOVE PB-SV-STATE            TO CM-SSN-STATE
 18573         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 18574         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 18575         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 18576     ELSE
 18577         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 18578
 18579     IF PB-COMPANY-ID   EQUAL  'CRI'
 18580         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 18581         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 18582         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 18583         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 18584         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 337
* EL050.cbl
 18585
 18586     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 18587        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18588         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 18589
 18590     IF PB-COMPANY-ID  = 'LBL'
 18591        IF PB-I-JOINT-COVERAGE
 18592            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 18593                                           PB-I-MEMBER-NO
 18594            GO TO 4550-CONT-CERT-PROCESS.
 18595
 18596     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 18597        NEXT SENTENCE
 18598     ELSE
 18599        GO TO 4540-BUILD-MEMBER-NO.
 18600
 18601******************************************************************
 18602*                                                                *
 18603*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 18604*    FOR 'MON'.                                                  *
 18605*                                                                *
 18606******************************************************************
 18607
 18608     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 18609     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 18610     MOVE +1                     TO WS-SUB1
 18611                                    WS-SUB2.
 18612
 18613 4530-EDIT-MEMB-NAME.
 18614
 18615     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 18616        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 18617        ADD +1                       TO WS-SUB2.
 18618
 18619     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 18620        ADD +1                       TO WS-SUB1
 18621        GO TO 4530-EDIT-MEMB-NAME.
 18622
 18623     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 18624     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 18625     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 18626*    MOVE SPACE                      TO DC-OPTION-CODE.
 18627     SET  BIN-TO-GREG                TO TRUE.
 18628     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18629     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 18630
 18631     GO TO 4550-CONT-CERT-PROCESS.
 18632
 18633******************************************************************
 18634*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 18635******************************************************************
 18636
 18637 4540-BUILD-MEMBER-NO.
 18638
 18639     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 18640         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 18641         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 18642         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 338
* EL050.cbl
 18643         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 18644     ELSE
 18645         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 18646
 18647     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 18648        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18649         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 18650
 18651 4550-CONT-CERT-PROCESS.
 18652
 18653*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 18654*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 18655*    ELSE
 18656*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 18657
 18658     IF CERT-WAS-CREATED-FOR-CLAIM
 18659        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18660        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 18661
 18662     IF CERT-AND-CLAIM-ONLINE
 18663        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18664        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 18665
 18666     MOVE 'CM'                     TO CM-RECORD-ID.
 18667     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 18668
 18669     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 18670        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 18671        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 18672     ELSE
 18673        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 18674        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 18675
 18676     MOVE ZERO                     TO CM-LOAN-BALANCE.
 18677     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18678     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18679     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18680     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18681     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18682     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18683                                      CM-LF-ITD-CANCEL-AMT
 18684                                      CM-LF-ITD-DEATH-AMT
 18685                                      CM-AH-ITD-AH-PMT
 18686                                      CM-AH-ITD-LUMP-PMT
 18687                                      CM-AH-ITD-CANCEL-AMT
 18688                                      CM-LF-NSP-PREMIUM-AMT
 18689                                      CM-AH-NSP-PREMIUM-AMT.
 18690*                                     CM-CLAIM-DEDUCT-WITHHELD
 18691*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18692     if pb-i-loan-apr = +99.9999
 18693        move zeros                 to cm-loan-apr
 18694     else
 18695        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18696     end-if
 18697     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18698     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18699     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18700     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 339
* EL050.cbl
 18701     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18702     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18703     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18704     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18705     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18706     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18707     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18708
 18709     IF PB-I-LIVES NOT NUMERIC
 18710         MOVE ZERO                 TO PB-I-LIVES.
 18711
 18712     IF PB-I-NUM-BILLED NOT NUMERIC
 18713         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18714
 18715     MOVE PB-I-LIVES               TO CM-LIVES.
 18716     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18717
 18718     IF PB-COMPANY-ID EQUAL  'DMD'
 18719         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18720         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18721
 18722     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18723     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18724     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18725     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18726     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18727     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18728
 18729     IF PB-I-LF-POLICY-FEE NUMERIC
 18730        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18731     ELSE
 18732        MOVE +0                    TO CM-LF-POLICY-FEE.
 18733
 18734     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18735        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18736        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18737     ELSE
 18738        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18739
 18740     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18741     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18742     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18743     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18744     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18745     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18746     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18747     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18748     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18749
 18750     IF PB-I-CANCEL-FEE NUMERIC
 18751        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18752     ELSE
 18753        MOVE +0                  TO CM-CANCEL-FEE
 18754     END-IF
 18755
 18756     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18757        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18758     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 340
* EL050.cbl
 18759        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18760
 18761     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18762     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18763
 18764     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18765                                      CM-LF-DEATH-EXIT-DT
 18766                                      CM-AH-SETTLEMENT-EXIT-DT.
 18767
 18768*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18769*                       'TIH' OR 'OFL' OR 'FLA' OR
 18770*                       'TII' OR 'TMS' OR 'CRI' OR
 18771*                       'NCL'
 18772     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18773
 18774     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18775         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18776            MOVE '2'                TO CM-PREMIUM-TYPE.
 18777
 18778     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18779         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18780            MOVE '2'                TO CM-PREMIUM-TYPE.
 18781
 18782     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18783         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18784     ELSE
 18785         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18786         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18787
 18788     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18789     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18790     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18791     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18792     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18793     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18794     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18795     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18796
 18797     IF PB-NO-MONTHS-SKIPPED
 18798         MOVE SPACE                 TO CM-SKIP-CODE
 18799     ELSE
 18800         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18801
 18802     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18803     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18804                                       CM-LF-STATUS-AT-CANCEL.
 18805
 18806     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18807     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18808                                       CM-AH-STATUS-AT-CANCEL.
 18809
 18810     MOVE '1'                       TO CM-ENTRY-STATUS.
 18811
 18812     IF PB-REISSUED-CERT
 18813        MOVE '5'                    TO CM-ENTRY-STATUS.
 18814
 18815     IF PB-MONTHLY-CERT
 18816        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 341
* EL050.cbl
 18817
 18818     IF PB-CASH-CERT
 18819        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18820
 18821     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18822     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18823     IF PB-POLICY-IS-DECLINED
 18824        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18825
 18826     IF PB-POLICY-IS-VOIDED
 18827        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18828
 18829     IF PB-NEEDS-UNDERWRITING
 18830        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18831
 18832     IF PB-REIN-ONLY-CERT
 18833        MOVE '9'                    TO CM-ENTRY-STATUS.
 18834
 18835     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18836         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18837     ELSE
 18838         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18839
 18840     IF PB-RECORD-RETURNED
 18841        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18842      ELSE
 18843        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18844
 18845     IF PB-I-MAIL-ADDRS-PRESENT
 18846        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18847
 18848     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18849                                       CM-ENTRY-DT.
 18850
 18851 4999-EXIT.
 18852     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 342
* EL050.cbl
 18854
 18855 5000-PROCESS-REPS.
 18856     MOVE ' '                    TO AGTC-MASTER-SW
 18857     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18858     MOVE CO-TYPE                TO AGTC-TYPE
 18859     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18860     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18861     IF (AGTC-MASTER-SW NOT = 'N')
 18862        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18863        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18864        PERFORM 8583-READ-ERAGTC-NEXT
 18865                                 THRU 8583-EXIT
 18866     END-IF
 18867     IF AGTC-MASTER-SW = 'N'
 18868        CONTINUE
 18869     ELSE
 18870        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18871           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18872              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18873              MOVE 'Y'           TO AGTC-MASTER-SW
 18874           END-IF
 18875        END-IF
 18876     END-IF
 18877     .
 18878 5000-EXIT.
 18879     EXIT.
 18880 6370-EDIT-INPUT-LF-CODE.
 18881     move ' ' to ws-benefit-cd-chg-sw
 18882     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18883        MOVE +1                  TO SUB
 18884        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18885        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18886        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18887        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18888        GO TO 6370-SEARCH-LOOP.
 18889
 18890     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18891
 18892     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18893     MOVE SPACES                 TO CNTL-ACCESS.
 18894*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18895     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18896     MOVE +0                     TO CNTL-SEQ-NO.
 18897     MOVE '4' TO RC-SW-2.
 18898     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18899
 18900     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18901        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18902        GO TO 6370-NO-LF-FOUND.
 18903
 18904     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18905     MOVE +1                     TO SUB.
 18906
 18907 6370-SEARCH-LOOP.
 18908     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18909         GO TO 6370-NO-LF-FOUND.
 18910
 18911     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 343
* EL050.cbl
 18912        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18913           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18914           set benefit-code-chg to true
 18915        end-if
 18916        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18917        GO TO 6370-HER-NET-PAY-CHECK.
 18918
 18919     ADD 1   TO SUB.
 18920*    IF SUB GREATER 120
 18921     IF SUB GREATER 200
 18922         GO TO 6370-NO-LF-FOUND.
 18923
 18924     GO TO 6370-SEARCH-LOOP.
 18925
 18926 6370-NO-LF-FOUND.
 18927
 18928     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18929        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18930        set benefit-code-chg to true
 18931     end-if
 18932     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18933
 18934 6370-HER-NET-PAY-CHECK.
 18935
 18936     IF PB-COMPANY-ID = 'CID'
 18937        IF PB-SV-STATE = 'CA' OR 'MN'
 18938           IF PB-I-LF-BENEFIT-CD = '02'
 18939              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18940           ELSE
 18941              IF PB-I-LF-BENEFIT-CD = '04'
 18942                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18943              END-IF
 18944           END-IF
 18945        END-IF
 18946     END-IF
 18947
 18948     IF PB-COMPANY-ID NOT = 'HER'
 18949         GO TO 6370-EXIT.
 18950
 18951     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18952         GO TO 6370-EXIT.
 18953
 18954     IF PB-I-LF-TERM NOT NUMERIC
 18955         MOVE ZEROS              TO PB-I-LF-TERM.
 18956
 18957     IF PB-I-LOAN-TERM NOT NUMERIC
 18958         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18959
 18960     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18961         GO TO 6370-EXIT.
 18962
 18963     IF PB-I-LF-BENEFIT-CD = '33'
 18964         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18965
 18966     IF PB-I-LF-BENEFIT-CD = '34'
 18967         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18968
 18969 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 344
* EL050.cbl
 18970     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 345
* EL050.cbl
 18972
 18973 6380-EDIT-INPUT-AH-CODE.
 18974     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18975        MOVE +1                  TO SUB
 18976        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18977        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18978        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18979        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18980        GO TO 6380-SEARCH-LOOP.
 18981
 18982     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18983
 18984     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18985     MOVE SPACES                 TO CNTL-ACCESS.
 18986     MOVE 'A'                    TO CNTL-REC-TYPE.
 18987*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18988     MOVE +0                     TO CNTL-SEQ-NO.
 18989     MOVE '5' TO RC-SW-2.
 18990     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18991
 18992     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18993        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18994        GO TO 6380-NO-AH-FOUND.
 18995
 18996     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18997     MOVE +1 TO SUB.
 18998
 18999 6380-SEARCH-LOOP.
 19000     IF CF-AH-CODE-OUT (SUB) = ZEROS
 19001         GO TO 6380-NO-AH-FOUND.
 19002
 19003     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 19004         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 19005         GO TO 6380-CSO-AH-ONLY-CHECKS.
 19006
 19007     ADD 1   TO SUB.
 19008     IF SUB GREATER THAN 96
 19009*    IF SUB GREATER THAN 300
 19010         GO TO 6380-NO-AH-FOUND.
 19011
 19012     GO TO 6380-SEARCH-LOOP.
 19013
 19014 6380-NO-AH-FOUND.
 19015
 19016     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 19017
 19018     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 19019         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 19020     ELSE
 19021         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 19022
 19023 6380-CSO-AH-ONLY-CHECKS.
 19024
 19025     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 19026        NEXT SENTENCE
 19027      ELSE
 19028        GO TO 6380-EXIT.
 19029
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 346
* EL050.cbl
 19030     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 19031         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 19032
 19033
 19034     GO TO 6380-EXIT
 19035     .
 19036 6380-CSO-LIFE-WITH-AH-CHECKS.
 19037
 19038
 19039     .
 19040 6380-EXIT.
 19041     EXIT.
 19042
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 347
* EL050.cbl
 19044
 19045 6400-COMPUTE-EXTENSION-DAYS.
 19046
 19047******************************************************************
 19048*                                                                *
 19049*                   COMPUTE EXTENSION DAYS                       *
 19050*                                                                *
 19051*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 19052*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 19053*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 19054*    THE EXTENSION DAYS.                                         *
 19055*                                                                *
 19056******************************************************************
 19057
 19058     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 19059     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 19060
 19061******************************************************************
 19062*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 19063*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 19064******************************************************************
 19065
 19066     IF DC-ELAPSED-MONTHS GREATER THAN +0
 19067        COMPUTE WS-ODD-DAYS-OVER =
 19068               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 19069     ELSE
 19070        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 19071
 19072     IF WS-ODD-DAYS-OVER = ZEROS
 19073           GO TO 6499-EXIT
 19074     ELSE
 19075        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 19076           IF WS-WDF-MONTH = 02
 19077              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 19078              ADD 2       TO  WS-ODD-DAYS-OVER
 19079              GO TO 6499-EXIT
 19080           ELSE
 19081              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 19082                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 19083                 GO TO 6499-EXIT
 19084               ELSE
 19085                 GO TO 6499-EXIT
 19086        ELSE
 19087           GO TO 6499-EXIT.
 19088
 19089 6412-CHECK-TO-DAY.
 19090
 19091        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 19092           IF WS-WDT-DAY = 28
 19093              ADD 2              TO WS-ODD-DAYS-OVER
 19094           ELSE
 19095              IF WS-WDT-DAY = 29
 19096                 ADD 1           TO WS-ODD-DAYS-OVER
 19097              ELSE
 19098                 NEXT SENTENCE
 19099        ELSE
 19100           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 19101              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 348
* EL050.cbl
 19102
 19103     GO TO 6499-EXIT.
 19104
 19105
 19106 6415-CHECK-LEAP-YEAR.
 19107
 19108     IF DC-DAYS-IN-MONTH = 29
 19109        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 19110
 19111 6415-EXIT.
 19112     EXIT.
 19113
 19114 6499-EXIT.
 19115      EXIT.
 19116
 19117 6500-END.
 19118     EXIT.
 19119
 19120
 19121******************************************************************
 19122************* PROCEDURE DIVISION FOR EL050 ***********************
 19123********************** ELC50PD END *******************************
 19124
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 349
* EL050.cbl
 19126
 19127**START***********************************************************
 19128*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 19129*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 19130******************************************************************
 19131*
 19132 6600-GET-STATE-MUNICIPAL-TAX.
 19133
 19134     IF PB-COMPANY-ID NOT = 'DMD'
 19135         GO TO 6640-EXIT.
 19136
 19137     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 19138     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 19139     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 19140*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 19141*
 19142***  Y2K PROJ 7744
 19143     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19144     SET BIN-TO-GREG          TO TRUE.
 19145     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19146
 19147     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19148
 19149     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 19150     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 19151
 19152
 19153* EXEC CICS HANDLE CONDITION
 19154*        INVREQ    (6610-START-BROWSE)
 19155*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19156*        NOTFND    (6630-END-OF-FILE)
 19157*    END-EXEC.
 19158*    MOVE '"$8JI                 ! # #00019142' TO DFHEIV0
 19159     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 19160     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19161     MOVE X'2320233030303139313432' TO DFHEIV0(25:11)
 19162     CALL 'kxdfhei1' USING DFHEIV0
 19163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19164
 19165
 19166 6610-START-BROWSE.
 19167
 19168
 19169* EXEC CICS HANDLE CONDITION
 19170*        NOTFND    (6630-END-OF-FILE)
 19171*        DISABLED  (6630-ERRESS-PROBLEM)
 19172*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19173*        ENDFILE   (6630-END-OF-FILE)
 19174*    END-EXEC.
 19175*    MOVE '"$IcJ''                ! $ #00019150' TO DFHEIV0
 19176     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19177     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19178     MOVE X'2420233030303139313530' TO DFHEIV0(25:11)
 19179     CALL 'kxdfhei1' USING DFHEIV0
 19180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19181
 19182
 19183
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 350
* EL050.cbl
 19184* EXEC CICS STARTBR
 19185*        DATASET (FILE-ID-ERRESS)
 19186*        RIDFLD  (WS-ERRESS-KEY)
 19187*        GTEQ
 19188*    END-EXEC.
 19189     MOVE 0
 19190       TO DFHEIV11
 19191*    MOVE '&,         G          &   #00019157' TO DFHEIV0
 19192     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19193     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19194     MOVE X'2020233030303139313537' TO DFHEIV0(25:11)
 19195     CALL 'kxdfhei1' USING DFHEIV0,
 19196           FILE-ID-ERRESS,
 19197           WS-ERRESS-KEY,
 19198           DFHEIV99,
 19199           DFHEIV11,
 19200           DFHEIV99
 19201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19202
 19203
 19204 6620-READ-NEXT-ERRESS-MASTER.
 19205
 19206
 19207* EXEC CICS HANDLE CONDITION
 19208*        NOTFND    (6630-END-OF-FILE)
 19209*        ENDFILE   (6630-END-OF-FILE)
 19210*        DISABLED  (6630-ERRESS-PROBLEM)
 19211*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19212*    END-EXEC.
 19213*    MOVE '"$I''cJ                ! % #00019165' TO DFHEIV0
 19214     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 19215     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19216     MOVE X'2520233030303139313635' TO DFHEIV0(25:11)
 19217     CALL 'kxdfhei1' USING DFHEIV0
 19218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19219
 19220
 19221
 19222* EXEC CICS READNEXT
 19223*        DATASET (FILE-ID-ERRESS)
 19224*        INTO    (RESIDENT-STATE-TAX-MASTER)
 19225*        RIDFLD  (WS-ERRESS-KEY)
 19226*    END-EXEC.
 19227     MOVE LENGTH OF
 19228      RESIDENT-STATE-TAX-MASTER
 19229       TO DFHEIV12
 19230     MOVE 0
 19231       TO DFHEIV11
 19232*    MOVE '&.IL                  )   #00019172' TO DFHEIV0
 19233     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19234     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19235     MOVE X'2020233030303139313732' TO DFHEIV0(25:11)
 19236     CALL 'kxdfhei1' USING DFHEIV0,
 19237           FILE-ID-ERRESS,
 19238           RESIDENT-STATE-TAX-MASTER,
 19239           DFHEIV12,
 19240           WS-ERRESS-KEY,
 19241           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 351
* EL050.cbl
 19242           DFHEIV11,
 19243           DFHEIV99,
 19244           DFHEIV99
 19245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19246
 19247
 19248     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 19249
 19250* EXEC CICS ENDBR
 19251*            DATASET (FILE-ID-ERRESS)
 19252*       END-EXEC
 19253     MOVE 0
 19254       TO DFHEIV11
 19255*    MOVE '&2                    $   #00019179' TO DFHEIV0
 19256     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19257     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19258     MOVE X'2020233030303139313739' TO DFHEIV0(25:11)
 19259     CALL 'kxdfhei1' USING DFHEIV0,
 19260           FILE-ID-ERRESS,
 19261           DFHEIV11,
 19262           DFHEIV99
 19263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19264        GO TO 6630-END-OF-FILE.
 19265
 19266     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 19267        NEXT SENTENCE
 19268      ELSE
 19269        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 19270
 19271*IS IT LIFE(1) OR IS IT P&C(2) ?????
 19272*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 19273*
 19274     MOVE +2                     TO WS-SUB1.
 19275
 19276     IF PB-ISSUE
 19277     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 19278        MOVE +1                  TO WS-SUB1.
 19279
 19280     IF PB-CANCELLATION
 19281     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 19282        MOVE +1                  TO WS-SUB1.
 19283*
 19284*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 19285*
 19286***  Y2K PROJ 7744
 19287     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 19288***  Y2K PROJ 7744
 19289
 19290*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 19291* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 19292* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 19293
 19294     ADD 1                    TO WS-YEAR-YY.
 19295
 19296     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 19297         MOVE RES-REN-STATE-TAX (WS-SUB1)
 19298                              TO WS-RES-STATE-TAX
 19299         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 352
* EL050.cbl
 19300                              TO WS-RES-MUNI-TAX
 19301     ELSE
 19302         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 19303                              TO WS-RES-STATE-TAX
 19304         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 19305                              TO WS-RES-MUNI-TAX.
 19306
 19307*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 19308
 19309     IF PB-CANCELLATION
 19310         GO TO 6640-CANCEL-TAX.
 19311
 19312     IF PB-I-LF-PREMIUM-AMT > ZEROS
 19313         COMPUTE PB-I-STATE-TAX ROUNDED =
 19314                                   PB-I-LF-PREMIUM-AMT
 19315                                 * WS-RES-STATE-TAX
 19316         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19317                                   PB-I-LF-PREMIUM-AMT
 19318                                 * WS-RES-MUNI-TAX
 19319     ELSE
 19320     IF PB-I-AH-PREMIUM-AMT > ZEROS
 19321         COMPUTE PB-I-STATE-TAX ROUNDED =
 19322                                   PB-I-AH-PREMIUM-AMT
 19323                                 * WS-RES-STATE-TAX
 19324         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19325                                   PB-I-AH-PREMIUM-AMT
 19326                                 * WS-RES-MUNI-TAX.
 19327
 19328
 19329* EXEC CICS ENDBR
 19330*         DATASET (FILE-ID-ERRESS)
 19331*    END-EXEC.
 19332     MOVE 0
 19333       TO DFHEIV11
 19334*    MOVE '&2                    $   #00019246' TO DFHEIV0
 19335     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19336     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19337     MOVE X'2020233030303139323436' TO DFHEIV0(25:11)
 19338     CALL 'kxdfhei1' USING DFHEIV0,
 19339           FILE-ID-ERRESS,
 19340           DFHEIV11,
 19341           DFHEIV99
 19342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19343
 19344
 19345     GO TO 6640-EXIT.
 19346
 19347 6640-CANCEL-TAX.
 19348     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 19349
 19350     IF PB-C-LF-CANCEL-AMT > ZEROS
 19351         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19352                                   PB-C-LF-CANCEL-AMT
 19353                                 * WS-RES-STATE-TAX
 19354         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19355                                   PB-C-LF-CANCEL-AMT
 19356                                *  WS-RES-MUNI-TAX
 19357     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 353
* EL050.cbl
 19358     IF PB-C-AH-CANCEL-AMT > ZEROS
 19359         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19360                                   PB-C-AH-CANCEL-AMT
 19361                                 * WS-RES-STATE-TAX
 19362         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19363                                   PB-C-AH-CANCEL-AMT
 19364                                *  WS-RES-MUNI-TAX.
 19365
 19366
 19367* EXEC CICS ENDBR
 19368*         DATASET (FILE-ID-ERRESS)
 19369*    END-EXEC.
 19370     MOVE 0
 19371       TO DFHEIV11
 19372*    MOVE '&2                    $   #00019271' TO DFHEIV0
 19373     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19374     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19375     MOVE X'2020233030303139323731' TO DFHEIV0(25:11)
 19376     CALL 'kxdfhei1' USING DFHEIV0,
 19377           FILE-ID-ERRESS,
 19378           DFHEIV11,
 19379           DFHEIV99
 19380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19381
 19382
 19383     GO TO 6640-EXIT.
 19384
 19385 6630-END-OF-FILE.
 19386     MOVE ER-8002              TO WS-ERROR.
 19387     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19388
 19389     GO TO 6640-EXIT.
 19390
 19391 6630-ERRESS-PROBLEM.
 19392     MOVE ER-8044              TO WS-ERROR.
 19393     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19394
 19395 6640-EXIT.
 19396     EXIT.
 19397
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 354
* EL050.cbl
 19399 6650-GET-RES-STATE-COMM.
 19400
 19401     IF PB-COMPANY-ID NOT = 'DMD'
 19402         GO TO 6700-COMM-EXIT.
 19403
 19404     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 19405     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 19406     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 19407     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 19408     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 19409     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 19410     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 19411
 19412*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 19413*
 19414***  Y2K PROJ 7744
 19415     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19416     SET BIN-TO-GREG          TO TRUE.
 19417     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19418
 19419     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19420***  Y2K PROJ 7744
 19421
 19422     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 19423
 19424
 19425* EXEC CICS HANDLE CONDITION
 19426*        INVREQ    (6660-START-BROWSE)
 19427*        DISABLED  (6690-ERRESC-PROBLEM)
 19428*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19429*        NOTFND    (6690-END-OF-FILE)
 19430*    END-EXEC.
 19431*    MOVE '"$8cJI                ! & #00019316' TO DFHEIV0
 19432     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 19433     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19434     MOVE X'2620233030303139333136' TO DFHEIV0(25:11)
 19435     CALL 'kxdfhei1' USING DFHEIV0
 19436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19437
 19438
 19439
 19440* EXEC CICS RESETBR
 19441*        DATASET (FILE-ID-ERRESC)
 19442*        RIDFLD  (WS-ERRESC-KEY)
 19443*    END-EXEC.
 19444     MOVE 0
 19445       TO DFHEIV11
 19446*    MOVE '&4         G          &   #00019323' TO DFHEIV0
 19447     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19448     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19449     MOVE X'2020233030303139333233' TO DFHEIV0(25:11)
 19450     CALL 'kxdfhei1' USING DFHEIV0,
 19451           FILE-ID-ERRESC,
 19452           WS-ERRESC-KEY,
 19453           DFHEIV99,
 19454           DFHEIV11,
 19455           DFHEIV99
 19456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 355
* EL050.cbl
 19457
 19458
 19459 6660-START-BROWSE.
 19460
 19461
 19462* EXEC CICS HANDLE CONDITION
 19463*        NOTFND    (6690-END-OF-FILE)
 19464*        DISABLED  (6690-ERRESC-PROBLEM)
 19465*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19466*        ENDFILE   (6690-END-OF-FILE)
 19467*    END-EXEC.
 19468*    MOVE '"$IcJ''                ! '' #00019330' TO DFHEIV0
 19469     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19470     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19471     MOVE X'2720233030303139333330' TO DFHEIV0(25:11)
 19472     CALL 'kxdfhei1' USING DFHEIV0
 19473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19474
 19475
 19476
 19477* EXEC CICS STARTBR
 19478*        DATASET (FILE-ID-ERRESC)
 19479*        RIDFLD  (WS-ERRESC-KEY)
 19480*        GTEQ
 19481*    END-EXEC.
 19482     MOVE 0
 19483       TO DFHEIV11
 19484*    MOVE '&,         G          &   #00019337' TO DFHEIV0
 19485     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19486     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19487     MOVE X'2020233030303139333337' TO DFHEIV0(25:11)
 19488     CALL 'kxdfhei1' USING DFHEIV0,
 19489           FILE-ID-ERRESC,
 19490           WS-ERRESC-KEY,
 19491           DFHEIV99,
 19492           DFHEIV11,
 19493           DFHEIV99
 19494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19495
 19496
 19497     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 19498
 19499 6670-READ-NEXT-ERRESC-MASTER.
 19500
 19501
 19502* EXEC CICS HANDLE CONDITION
 19503*        NOTFND    (6690-END-OF-FILE)
 19504*        DISABLED  (6690-ERRESC-PROBLEM)
 19505*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19506*        ENDFILE   (6690-END-OF-FILE)
 19507*    END-EXEC.
 19508*    MOVE '"$IcJ''                ! ( #00019347' TO DFHEIV0
 19509     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19510     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19511     MOVE X'2820233030303139333437' TO DFHEIV0(25:11)
 19512     CALL 'kxdfhei1' USING DFHEIV0
 19513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19514
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 356
* EL050.cbl
 19515
 19516
 19517* EXEC CICS READNEXT
 19518*        DATASET (FILE-ID-ERRESC)
 19519*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 19520*        RIDFLD  (ERRESC-RECORD-KEY)
 19521*    END-EXEC.
 19522     MOVE LENGTH OF
 19523      ACCOUNT-RESIDENT-ST-COMMISSION
 19524       TO DFHEIV12
 19525     MOVE 0
 19526       TO DFHEIV11
 19527*    MOVE '&.IL                  )   #00019354' TO DFHEIV0
 19528     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19529     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19530     MOVE X'2020233030303139333534' TO DFHEIV0(25:11)
 19531     CALL 'kxdfhei1' USING DFHEIV0,
 19532           FILE-ID-ERRESC,
 19533           ACCOUNT-RESIDENT-ST-COMMISSION,
 19534           DFHEIV12,
 19535           ERRESC-RECORD-KEY,
 19536           DFHEIV99,
 19537           DFHEIV11,
 19538           DFHEIV99,
 19539           DFHEIV99
 19540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19541
 19542
 19543     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 19544        NEXT SENTENCE
 19545     ELSE
 19546
 19547* EXEC CICS ENDBR
 19548*            DATASET (FILE-ID-ERRESC)
 19549*       END-EXEC
 19550     MOVE 0
 19551       TO DFHEIV11
 19552*    MOVE '&2                    $   #00019363' TO DFHEIV0
 19553     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19554     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19555     MOVE X'2020233030303139333633' TO DFHEIV0(25:11)
 19556     CALL 'kxdfhei1' USING DFHEIV0,
 19557           FILE-ID-ERRESC,
 19558           DFHEIV11,
 19559           DFHEIV99
 19560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19561        GO TO 6690-END-OF-FILE.
 19562
 19563     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 19564
 19565* EXEC CICS ENDBR
 19566*            DATASET (FILE-ID-ERRESC)
 19567*       END-EXEC
 19568     MOVE 0
 19569       TO DFHEIV11
 19570*    MOVE '&2                    $   #00019369' TO DFHEIV0
 19571     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19572     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 357
* EL050.cbl
 19573     MOVE X'2020233030303139333639' TO DFHEIV0(25:11)
 19574     CALL 'kxdfhei1' USING DFHEIV0,
 19575           FILE-ID-ERRESC,
 19576           DFHEIV11,
 19577           DFHEIV99
 19578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19579        GO TO 6690-END-OF-FILE.
 19580
 19581     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 19582        NEXT SENTENCE
 19583      ELSE
 19584        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 19585
 19586* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 19587*
 19588     MOVE ZEROS               TO WS-SUB WS-SUB1.
 19589
 19590     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 19591
 19592     IF WS-SUB1 > ZERO
 19593         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 19594             PERFORM 6680-SET-COMMISSION
 19595         ELSE
 19596             PERFORM 6680-SET-TABLE-CODE.
 19597
 19598
 19599* EXEC CICS ENDBR
 19600*         DATASET (FILE-ID-ERRESC)
 19601*    END-EXEC.
 19602     MOVE 0
 19603       TO DFHEIV11
 19604*    MOVE '&2                    $   #00019391' TO DFHEIV0
 19605     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19606     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19607     MOVE X'2020233030303139333931' TO DFHEIV0(25:11)
 19608     CALL 'kxdfhei1' USING DFHEIV0,
 19609           FILE-ID-ERRESC,
 19610           DFHEIV11,
 19611           DFHEIV99
 19612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19613
 19614
 19615     GO TO 6700-COMM-EXIT.
 19616
 19617 6680-SET-TABLE-CODE.
 19618     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 19619        MOVE ZEROS             TO WS-SUB1
 19620     ELSE
 19621* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 19622* TO COMPUTE AH COMMISSION.
 19623        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 19624        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 19625        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 19626        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 19627        PERFORM 6680-READ-CTBL-TABLE
 19628        IF WS-CTBL-READ-SW NOT = 'Y'
 19629           MOVE ZEROS          TO WS-SUB1.
 19630
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 358
* EL050.cbl
 19631 6680-READ-CTBL-TABLE.
 19632*
 19633* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 19634* TO COMPUTE LIFE COMMISSION
 19635
 19636     IF CTBL-SW = '0540'
 19637        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 19638        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 19639        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 19640
 19641     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 19642
 19643     IF CTBL-TABLE-FOUND
 19644        IF CTBL-SW = '0530'
 19645             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 19646                                    * PB-I-AH-TERM
 19647             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19648             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 19649        ELSE
 19650             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 19651             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19652             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 19653     ELSE
 19654        IF FIRST-TIME-THROUGH
 19655            GO TO 6680-READ-CTBL-TABLE
 19656        ELSE
 19657            MOVE ZEROS         TO WS-SUB1.
 19658
 19659 6680-SET-COMMISSION.
 19660     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19661           MOVE ZEROS          TO WS-SUB1
 19662       ELSE
 19663           MOVE RESC-COMMISSION-PER (WS-SUB)
 19664                               TO WS-COMMISSION
 19665           IF CTBL-SW = '0530'
 19666               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19667           ELSE
 19668               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19669
 19670 6680-SEARCH-CATEGORY.
 19671     ADD +1                   TO WS-SUB.
 19672     IF WS-SUB > +12
 19673         GO TO 6680-EXIT.
 19674
 19675     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19676          MOVE WS-SUB         TO WS-SUB1
 19677          GO TO 6680-EXIT.
 19678
 19679     GO TO 6680-SEARCH-CATEGORY.
 19680
 19681 6680-EXIT.
 19682     EXIT.
 19683
 19684 6690-END-OF-FILE.
 19685     GO TO 6700-COMM-EXIT.
 19686
 19687 6690-ERRESC-PROBLEM.
 19688      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 359
* EL050.cbl
 19689      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19690
 19691      GO TO 6700-COMM-EXIT.
 19692
 19693 6700-COMM-EXIT.
 19694     EXIT.
 19695
 19696 7000-GET-RATE.
 19697
 19698* EXEC CICS LINK
 19699*        PROGRAM    ('ELRATE')
 19700*        COMMAREA   (CALCULATION-PASS-AREA)
 19701*        LENGTH     (CP-COMM-LENGTH)
 19702*    END-EXEC.
 19703     MOVE 'ELRATE' TO DFHEIV1
 19704*    MOVE '."C                   (   #00019477' TO DFHEIV0
 19705     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19706     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19707     MOVE X'2020233030303139343737' TO DFHEIV0(25:11)
 19708     CALL 'kxdfhei1' USING DFHEIV0,
 19709           DFHEIV1,
 19710           CALCULATION-PASS-AREA,
 19711           CP-COMM-LENGTH,
 19712           DFHEIV99,
 19713           DFHEIV99,
 19714           DFHEIV99,
 19715           DFHEIV99
 19716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19717
 19718
 19719 7000-EXIT.
 19720     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 360
* EL050.cbl
 19722 7100-FIND-BENEFIT-IN-STATE.
 19723     MOVE 'N'                    TO BEN-SEARCH-SW.
 19724
 19725     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19726         VARYING SUB3 FROM 1 BY 1 UNTIL
 19727            ((SUB3 GREATER 50) OR
 19728              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19729               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19730
 19731     IF SUB3 NOT = 51
 19732         MOVE 'Y'                TO BEN-SEARCH-SW.
 19733
 19734     GO TO 7199-EXIT.
 19735
 19736 7100-BENEFIT-DUMMY.
 19737
 19738 7100-DUMMY-EXIT.
 19739     EXIT.
 19740
 19741 7199-EXIT.
 19742     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 361
* EL050.cbl
 19744 7200-FIND-BENEFIT.
 19745     MOVE 'N'                    TO BEN-SEARCH-SW.
 19746
 19747     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19748         VARYING SUB3 FROM 1 BY 1 UNTIL
 19749            ((SUB3 GREATER 8) OR
 19750            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19751
 19752     IF SUB3 NOT = 9
 19753         MOVE 'Y'                TO BEN-SEARCH-SW.
 19754
 19755     GO TO 7200-EXIT.
 19756
 19757 7200-BENEFIT-DUMMY.
 19758
 19759 7200-DUMMY-EXIT.
 19760     EXIT.
 19761
 19762 7200-EXIT.
 19763     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 362
* EL050.cbl
 19765 7250-LOOK-FOR-RESCINDED-CLAIM.
 19766     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19767                                    W-CL-COMP-CD.
 19768     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19769                                    W-CL-CERT-NO.
 19770
 19771
 19772* EXEC CICS HANDLE CONDITION
 19773*        NOTFND  (7250-CONTINUE)
 19774*        ENDFILE (7250-CONTINUE)
 19775*    END-EXEC.
 19776*    MOVE '"$I''                  ! ) #00019535' TO DFHEIV0
 19777     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19778     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19779     MOVE X'2920233030303139353335' TO DFHEIV0(25:11)
 19780     CALL 'kxdfhei1' USING DFHEIV0
 19781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19782
 19783
 19784
 19785* EXEC CICS IGNORE CONDITION
 19786*        DUPKEY
 19787*    END-EXEC.
 19788*    MOVE '"*$                   !   #00019540' TO DFHEIV0
 19789     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19790     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19791     MOVE X'2020233030303139353430' TO DFHEIV0(25:11)
 19792     CALL 'kxdfhei1' USING DFHEIV0
 19793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19794
 19795
 19796
 19797* EXEC CICS STARTBR
 19798*        DATASET   (CLMS-ID)
 19799*        RIDFLD    (ELMSTR-KEY)
 19800*        GENERIC   EQUAL
 19801*        KEYLENGTH (ELMSTR-LENGTH)
 19802*    END-EXEC.
 19803     MOVE 0
 19804       TO DFHEIV11
 19805*    MOVE '&,   KG    E          &   #00019544' TO DFHEIV0
 19806     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19807     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19808     MOVE X'2020233030303139353434' TO DFHEIV0(25:11)
 19809     CALL 'kxdfhei1' USING DFHEIV0,
 19810           CLMS-ID,
 19811           ELMSTR-KEY,
 19812           ELMSTR-LENGTH,
 19813           DFHEIV11,
 19814           DFHEIV99
 19815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19816
 19817
 19818     MOVE 'Y'                    TO W-BROWSE-SW.
 19819
 19820 7250-NEXT-CLAIM.
 19821
 19822
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 363
* EL050.cbl
 19823* EXEC CICS READNEXT
 19824*        DATASET   (CLMS-ID)
 19825*        RIDFLD    (ELMSTR-KEY)
 19826*        SET       (ADDRESS OF CLAIM-MASTER)
 19827*    END-EXEC.
 19828     MOVE 0
 19829       TO DFHEIV11
 19830*    MOVE '&.S                   )   #00019555' TO DFHEIV0
 19831     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19832     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19833     MOVE X'2020233030303139353535' TO DFHEIV0(25:11)
 19834     CALL 'kxdfhei1' USING DFHEIV0,
 19835           CLMS-ID,
 19836           DFHEIV20,
 19837           DFHEIV99,
 19838           ELMSTR-KEY,
 19839           DFHEIV99,
 19840           DFHEIV11,
 19841           DFHEIV99,
 19842           DFHEIV99
 19843     SET ADDRESS OF CLAIM-MASTER TO
 19844         DFHEIV20
 19845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19846
 19847
 19848     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19849        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19850         GO TO 7250-CONTINUE
 19851     END-IF.
 19852
 19853     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19854        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19855        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19856        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19857        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19858         GO TO 7250-NEXT-CLAIM
 19859     END-IF.
 19860
 19861     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19862        OR (CL-CLAIM-TYPE = 'I')
 19863        OR (CL-CLAIM-TYPE = 'G')
 19864        OR (CL-CLAIM-TYPE = 'F')
 19865          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19866              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19867              GO TO 7250-CONTINUE
 19868          END-IF
 19869     END-IF.
 19870
 19871     GO TO 7250-NEXT-CLAIM.
 19872
 19873 7250-CONTINUE.
 19874
 19875     IF W-BROWSE-SW = 'Y'
 19876
 19877* EXEC CICS ENDBR
 19878*            DATASET   (CLMS-ID)
 19879*        END-EXEC
 19880     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 364
* EL050.cbl
 19881       TO DFHEIV11
 19882*    MOVE '&2                    $   #00019589' TO DFHEIV0
 19883     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19884     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19885     MOVE X'2020233030303139353839' TO DFHEIV0(25:11)
 19886     CALL 'kxdfhei1' USING DFHEIV0,
 19887           CLMS-ID,
 19888           DFHEIV11,
 19889           DFHEIV99
 19890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19891         MOVE 'N' TO W-BROWSE-SW
 19892     END-IF.
 19893
 19894 7250-EXIT.
 19895     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 365
* EL050.cbl
 19897 7300-CHECK-FOR-OPEN-CLMS.
 19898
 19899*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19900*    MOVE SPACES                 TO CNTL-ACCESS.
 19901*    MOVE '1'                    TO CNTL-REC-TYPE.
 19902*    MOVE +0                     TO CNTL-SEQ-NO.
 19903
 19904*    MOVE '3'                    TO RC-SW-1.
 19905*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19906
 19907*    IF NOT CF-COMPANY-MASTER
 19908*         PERFORM 0099-COMPANY-NOT-FOUND
 19909*         GO TO 7300-EXIT.
 19910
 19911     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19912                                    W-CL-COMP-CD.
 19913     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19914                                    W-CL-CERT-NO.
 19915
 19916
 19917* EXEC CICS HANDLE CONDITION
 19918*        NOTFND  (7300-CONTINUE)
 19919*        ENDFILE (7300-CONTINUE)
 19920*    END-EXEC.
 19921*    MOVE '"$I''                  ! * #00019617' TO DFHEIV0
 19922     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19923     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19924     MOVE X'2A20233030303139363137' TO DFHEIV0(25:11)
 19925     CALL 'kxdfhei1' USING DFHEIV0
 19926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19927
 19928
 19929
 19930* EXEC CICS IGNORE CONDITION
 19931*        DUPKEY
 19932*    END-EXEC.
 19933*    MOVE '"*$                   !   #00019622' TO DFHEIV0
 19934     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19935     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19936     MOVE X'2020233030303139363232' TO DFHEIV0(25:11)
 19937     CALL 'kxdfhei1' USING DFHEIV0
 19938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19939
 19940
 19941
 19942* EXEC CICS STARTBR
 19943*        DATASET   (CLMS-ID)
 19944*        RIDFLD    (ELMSTR-KEY)
 19945*        GENERIC   EQUAL
 19946*        KEYLENGTH (ELMSTR-LENGTH)
 19947*    END-EXEC.
 19948     MOVE 0
 19949       TO DFHEIV11
 19950*    MOVE '&,   KG    E          &   #00019626' TO DFHEIV0
 19951     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19952     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19953     MOVE X'2020233030303139363236' TO DFHEIV0(25:11)
 19954     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 366
* EL050.cbl
 19955           CLMS-ID,
 19956           ELMSTR-KEY,
 19957           ELMSTR-LENGTH,
 19958           DFHEIV11,
 19959           DFHEIV99
 19960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19961
 19962
 19963     MOVE 'Y'                    TO W-BROWSE-SW.
 19964
 19965 7300-NEXT-CLAIM.
 19966
 19967
 19968* EXEC CICS READNEXT
 19969*        DATASET   (CLMS-ID)
 19970*        RIDFLD    (ELMSTR-KEY)
 19971*        SET       (ADDRESS OF CLAIM-MASTER)
 19972*    END-EXEC.
 19973     MOVE 0
 19974       TO DFHEIV11
 19975*    MOVE '&.S                   )   #00019637' TO DFHEIV0
 19976     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19977     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19978     MOVE X'2020233030303139363337' TO DFHEIV0(25:11)
 19979     CALL 'kxdfhei1' USING DFHEIV0,
 19980           CLMS-ID,
 19981           DFHEIV20,
 19982           DFHEIV99,
 19983           ELMSTR-KEY,
 19984           DFHEIV99,
 19985           DFHEIV11,
 19986           DFHEIV99,
 19987           DFHEIV99
 19988     SET ADDRESS OF CLAIM-MASTER TO
 19989         DFHEIV20
 19990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19991
 19992
 19993     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19994        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19995         GO TO 7300-CONTINUE.
 19996
 19997     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19998        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19999        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 20000        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 20001        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20002         GO TO 7300-NEXT-CLAIM.
 20003
 20004*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 20005     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 20006        OR (CL-CLAIM-TYPE = 'I')
 20007        OR (CL-CLAIM-TYPE = 'G')
 20008        OR (CL-CLAIM-TYPE = 'F')
 20009        IF CLAIM-IS-OPEN
 20010           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20011             AND PB-C-AH-CANCEL-DT > SPACES
 20012              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 367
* EL050.cbl
 20013              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20014           END-IF
 20015           EVALUATE TRUE
 20016             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 20017                 MOVE ER-2884      TO WS-ERROR
 20018             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 20019                 MOVE ER-2887      TO WS-ERROR
 20020             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 20021                 MOVE ER-2886      TO WS-ERROR
 20022             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 20023                 MOVE ER-2888      TO WS-ERROR
 20024             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 20025                 MOVE ER-2885      TO WS-ERROR
 20026             WHEN OTHER
 20027                 MOVE ER-2768      TO WS-ERROR
 20028           END-EVALUATE
 20029           IF PB-C-AH-CANCEL-VOIDED OR
 20030              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20031                NOT AH-COVERAGE-CANCELLED)
 20032               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20033               MOVE ER-2768      TO WS-ERROR
 20034           END-IF
 20035           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20036           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20037              PB-FORCE-CODE NOT EQUAL '8'
 20038               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20039           END-IF
 20040           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 20041           GO TO 7300-NEXT-CLAIM
 20042        ELSE
 20043           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20044*****THIS IS A RESCISSION OR REFORMATION
 20045              IF AH-COVERAGE-CANCELLED
 20046                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 20047                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 20048                    MOVE 1                   TO DC-ELAPSED-DAYS
 20049                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 20050                    SET BIN-PLUS-ELAPSED     TO TRUE
 20051                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 20052                    IF NO-CONVERSION-ERROR
 20053                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 20054                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 20055                          MOVE ER-2897 TO WS-ERROR
 20056                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20057                          GO TO 7300-NEXT-CLAIM
 20058                       END-IF
 20059                    END-IF
 20060                 ELSE
 20061                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 20062                      IF MSTR-CERT-NO = W-CL-CERT-NO
 20063                         MOVE ER-2890 TO WS-ERROR
 20064                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20065                         GO TO 7300-NEXT-CLAIM
 20066                      ELSE
 20067                         MOVE ER-2898 TO WS-ERROR
 20068                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20069                         GO TO 7300-NEXT-CLAIM
 20070                      END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 368
* EL050.cbl
 20071                   END-IF
 20072                 END-IF
 20073              END-IF
 20074           ELSE
 20075              IF CL-DENIAL-TYPE = '1'  AND
 20076                 CL-TOTAL-PAID-AMT = 0
 20077                    GO TO 7300-NEXT-CLAIM
 20078              END-IF
 20079              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20080               AND PB-C-AH-CANCEL-DT > SPACES
 20081                 MOVE ER-2756        TO WS-ERROR
 20082                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20083                 GO TO 7300-NEXT-CLAIM
 20084              END-IF
 20085           END-IF
 20086        END-IF
 20087     ELSE
 20088*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 20089        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 20090           IF (CLAIM-IS-OPEN)
 20091              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 20092                 <> zeros
 20093              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 20094                 <> zeros)
 20095              MOVE ER-2889      TO WS-ERROR
 20096              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20097              GO TO 7300-NEXT-CLAIM
 20098           ELSE
 20099              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20100*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 20101                 IF (LF-COVERAGE-CANCELLED AND
 20102                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 20103                      IF MSTR-CERT-NO = W-CL-CERT-NO
 20104                         MOVE ER-2890 TO WS-ERROR
 20105                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20106                         GO TO 7300-NEXT-CLAIM
 20107                      ELSE
 20108                         MOVE ER-2898 TO WS-ERROR
 20109                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20110                         GO TO 7300-NEXT-CLAIM
 20111                      END-IF
 20112                 END-IF
 20113              ELSE
 20114                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 20115                    and (CL-TOTAL-PAID-AMT = 0)
 20116                    GO TO 7300-NEXT-CLAIM
 20117                 END-IF
 20118                 IF (
 20119                      (AH-COVERAGE-CANCELLED)
 20120                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 20121                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 20122                      and (pb-ci-ah-cancel-amt +
 20123                         pb-c-ah-cancel-amt) <> zeros
 20124                    )
 20125                               OR
 20126                    (
 20127                      (LF-COVERAGE-CANCELLED)
 20128                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 369
* EL050.cbl
 20129                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 20130                      and (pb-ci-lf-cancel-amt +
 20131                         pb-c-lf-cancel-amt) <> zeros
 20132                    )
 20133                       MOVE ER-2965 TO WS-ERROR
 20134                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20135                       GO TO 7300-NEXT-CLAIM
 20136                 END-IF
 20137                 IF LF-COVERAGE-CANCELLED
 20138                  IF CL-TOTAL-PAID-AMT > 0
 20139                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 20140                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 20141                        MOVE ER-2891 TO WS-ERROR
 20142                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20143                        GO TO 7300-NEXT-CLAIM
 20144                      END-IF
 20145                    ELSE
 20146****only show this error if cert num matches exactly
 20147                      IF PB-CERT-NO = CL-CERT-NO
 20148                         MOVE ER-2892 TO WS-ERROR
 20149                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20150                         GO TO 7300-NEXT-CLAIM
 20151                      END-IF
 20152                    END-IF
 20153                  END-IF
 20154                 END-IF
 20155              END-IF
 20156           END-IF
 20157        END-IF
 20158     END-IF
 20159
 20160     GO TO 7300-NEXT-CLAIM.
 20161
 20162 7300-CONTINUE.
 20163
 20164     IF W-BROWSE-SW = 'Y'
 20165
 20166* EXEC CICS ENDBR
 20167*            DATASET   (CLMS-ID)
 20168*        END-EXEC.
 20169     MOVE 0
 20170       TO DFHEIV11
 20171*    MOVE '&2                    $   #00019815' TO DFHEIV0
 20172     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20173     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20174     MOVE X'2020233030303139383135' TO DFHEIV0(25:11)
 20175     CALL 'kxdfhei1' USING DFHEIV0,
 20176           CLMS-ID,
 20177           DFHEIV11,
 20178           DFHEIV99
 20179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20180
 20181
 20182 7300-EXIT.
 20183     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 370
* EL050.cbl
 20185
 20186 7400-GET-REMAIN-TERM.
 20187
 20188* EXEC CICS LINK
 20189*        PROGRAM    ('ELRTRM')
 20190*        COMMAREA   (CALCULATION-PASS-AREA)
 20191*        LENGTH     (CP-COMM-LENGTH)
 20192*    END-EXEC.
 20193     MOVE 'ELRTRM' TO DFHEIV1
 20194*    MOVE '."C                   (   #00019824' TO DFHEIV0
 20195     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20196     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20197     MOVE X'2020233030303139383234' TO DFHEIV0(25:11)
 20198     CALL 'kxdfhei1' USING DFHEIV0,
 20199           DFHEIV1,
 20200           CALCULATION-PASS-AREA,
 20201           CP-COMM-LENGTH,
 20202           DFHEIV99,
 20203           DFHEIV99,
 20204           DFHEIV99,
 20205           DFHEIV99
 20206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20207
 20208
 20209 7400-EXIT.
 20210     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 371
* EL050.cbl
 20212
 20213 7500-GET-REMAIN-AMOUNT.
 20214
 20215* EXEC CICS LINK
 20216*        PROGRAM    ('ELRAMT')
 20217*        COMMAREA   (CALCULATION-PASS-AREA)
 20218*        LENGTH     (CP-COMM-LENGTH)
 20219*    END-EXEC.
 20220     MOVE 'ELRAMT' TO DFHEIV1
 20221*    MOVE '."C                   (   #00019835' TO DFHEIV0
 20222     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20223     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20224     MOVE X'2020233030303139383335' TO DFHEIV0(25:11)
 20225     CALL 'kxdfhei1' USING DFHEIV0,
 20226           DFHEIV1,
 20227           CALCULATION-PASS-AREA,
 20228           CP-COMM-LENGTH,
 20229           DFHEIV99,
 20230           DFHEIV99,
 20231           DFHEIV99,
 20232           DFHEIV99
 20233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20234
 20235
 20236 7500-EXIT.
 20237     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 372
* EL050.cbl
 20239
 20240 7600-GET-REFUND.
 20241
 20242* EXEC CICS LINK
 20243*        PROGRAM    ('ELRFND')
 20244*        COMMAREA   (CALCULATION-PASS-AREA)
 20245*        LENGTH     (CP-COMM-LENGTH)
 20246*    END-EXEC.
 20247     MOVE 'ELRFND' TO DFHEIV1
 20248*    MOVE '."C                   (   #00019846' TO DFHEIV0
 20249     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20250     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20251     MOVE X'2020233030303139383436' TO DFHEIV0(25:11)
 20252     CALL 'kxdfhei1' USING DFHEIV0,
 20253           DFHEIV1,
 20254           CALCULATION-PASS-AREA,
 20255           CP-COMM-LENGTH,
 20256           DFHEIV99,
 20257           DFHEIV99,
 20258           DFHEIV99,
 20259           DFHEIV99
 20260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20261
 20262
 20263 7600-EXIT.
 20264     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 373
* EL050.cbl
 20266 7700-CALL-DL1.
 20267
 20268* EXEC CICS LINK
 20269*        PROGRAM    ('DLO001')
 20270*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 20271*        LENGTH     (DLO001-COMM-LENGTH)
 20272*    END-EXEC.
 20273     MOVE 'DLO001' TO DFHEIV1
 20274*    MOVE '."C                   (   #00019856' TO DFHEIV0
 20275     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20276     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20277     MOVE X'2020233030303139383536' TO DFHEIV0(25:11)
 20278     CALL 'kxdfhei1' USING DFHEIV0,
 20279           DFHEIV1,
 20280           WS-DLO-MASTER-POLICY-FORM,
 20281           DLO001-COMM-LENGTH,
 20282           DFHEIV99,
 20283           DFHEIV99,
 20284           DFHEIV99,
 20285           DFHEIV99
 20286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20287
 20288
 20289 7700-EXIT.
 20290     EXIT.
 20291
 20292 7710-CALL-DL2.
 20293
 20294* EXEC CICS LINK
 20295*        PROGRAM    ('DLO002')
 20296*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 20297*        LENGTH     (DLO002-COMM-LENGTH)
 20298*    END-EXEC.
 20299     MOVE 'DLO002' TO DFHEIV1
 20300*    MOVE '."C                   (   #00019866' TO DFHEIV0
 20301     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20302     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20303     MOVE X'2020233030303139383636' TO DFHEIV0(25:11)
 20304     CALL 'kxdfhei1' USING DFHEIV0,
 20305           DFHEIV1,
 20306           WS-DLO-INTERNAL-POLICY-FORM,
 20307           DLO002-COMM-LENGTH,
 20308           DFHEIV99,
 20309           DFHEIV99,
 20310           DFHEIV99,
 20311           DFHEIV99
 20312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20313
 20314
 20315 7710-EXIT.
 20316     EXIT.
 20317
 20318 7720-CALL-DL3.
 20319
 20320* EXEC CICS LINK
 20321*        PROGRAM    ('DLO003')
 20322*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 20323*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 374
* EL050.cbl
 20324*    END-EXEC.
 20325     MOVE 'DLO003' TO DFHEIV1
 20326*    MOVE '."C                   (   #00019876' TO DFHEIV0
 20327     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20328     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20329     MOVE X'2020233030303139383736' TO DFHEIV0(25:11)
 20330     CALL 'kxdfhei1' USING DFHEIV0,
 20331           DFHEIV1,
 20332           WS-DLO-VALID-BANK-ID,
 20333           DLO003-COMM-LENGTH,
 20334           DFHEIV99,
 20335           DFHEIV99,
 20336           DFHEIV99,
 20337           DFHEIV99
 20338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20339
 20340
 20341 7720-EXIT.
 20342     EXIT.
 20343
 20344 7730-CALL-DL7.
 20345
 20346* EXEC CICS LINK
 20347*        PROGRAM    ('DLO007')
 20348*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 20349*        LENGTH     (DLO007-COMM-LENGTH)
 20350*    END-EXEC.
 20351     MOVE 'DLO007' TO DFHEIV1
 20352*    MOVE '."C                   (   #00019886' TO DFHEIV0
 20353     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20354     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20355     MOVE X'2020233030303139383836' TO DFHEIV0(25:11)
 20356     CALL 'kxdfhei1' USING DFHEIV0,
 20357           DFHEIV1,
 20358           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 20359           DLO007-COMM-LENGTH,
 20360           DFHEIV99,
 20361           DFHEIV99,
 20362           DFHEIV99,
 20363           DFHEIV99
 20364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20365
 20366
 20367 7730-EXIT.
 20368     EXIT.
 20369
 20370 7740-CALL-DL11.
 20371
 20372* EXEC CICS LINK
 20373*        PROGRAM    ('DLO011')
 20374*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 20375*        LENGTH     (DLO011-COMM-LENGTH)
 20376*    END-EXEC.
 20377     MOVE 'DLO011' TO DFHEIV1
 20378*    MOVE '."C                   (   #00019896' TO DFHEIV0
 20379     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20380     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20381     MOVE X'2020233030303139383936' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 375
* EL050.cbl
 20382     CALL 'kxdfhei1' USING DFHEIV0,
 20383           DFHEIV1,
 20384           WS-DLO-PREM-RATES-BEN-TYPE,
 20385           DLO011-COMM-LENGTH,
 20386           DFHEIV99,
 20387           DFHEIV99,
 20388           DFHEIV99,
 20389           DFHEIV99
 20390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20391
 20392
 20393 7740-EXIT.
 20394     EXIT.
 20395
 20396 7750-CALL-DL17.
 20397
 20398* EXEC CICS LINK
 20399*        PROGRAM    ('DLO017')
 20400*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 20401*        LENGTH     (DLO017-COMM-LENGTH)
 20402*    END-EXEC.
 20403     MOVE 'DLO017' TO DFHEIV1
 20404*    MOVE '."C                   (   #00019906' TO DFHEIV0
 20405     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20406     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20407     MOVE X'2020233030303139393036' TO DFHEIV0(25:11)
 20408     CALL 'kxdfhei1' USING DFHEIV0,
 20409           DFHEIV1,
 20410           WS-DLO-VALID-RATE-CODE,
 20411           DLO017-COMM-LENGTH,
 20412           DFHEIV99,
 20413           DFHEIV99,
 20414           DFHEIV99,
 20415           DFHEIV99
 20416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20417
 20418
 20419 7750-EXIT.
 20420     EXIT.
 20421
 20422 7755-CALL-DL19.
 20423
 20424* EXEC CICS LINK
 20425*        PROGRAM    ('DLO019')
 20426*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 20427*        LENGTH     (DLO019-COMM-LENGTH)
 20428*    END-EXEC.
 20429     MOVE 'DLO019' TO DFHEIV1
 20430*    MOVE '."C                   (   #00019916' TO DFHEIV0
 20431     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20432     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20433     MOVE X'2020233030303139393136' TO DFHEIV0(25:11)
 20434     CALL 'kxdfhei1' USING DFHEIV0,
 20435           DFHEIV1,
 20436           WS-DLO-ORIG-COV-CAT,
 20437           DLO019-COMM-LENGTH,
 20438           DFHEIV99,
 20439           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 376
* EL050.cbl
 20440           DFHEIV99,
 20441           DFHEIV99
 20442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20443
 20444
 20445 7755-EXIT.
 20446     EXIT.
 20447
 20448 7760-CALL-DL21.
 20449
 20450* EXEC CICS LINK
 20451*        PROGRAM    ('DLO021')
 20452*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 20453*        LENGTH     (DLO021-COMM-LENGTH)
 20454*    END-EXEC.
 20455     MOVE 'DLO021' TO DFHEIV1
 20456*    MOVE '."C                   (   #00019926' TO DFHEIV0
 20457     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20458     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20459     MOVE X'2020233030303139393236' TO DFHEIV0(25:11)
 20460     CALL 'kxdfhei1' USING DFHEIV0,
 20461           DFHEIV1,
 20462           WS-DLO-VALID-LOAN-OFFICER,
 20463           DLO021-COMM-LENGTH,
 20464           DFHEIV99,
 20465           DFHEIV99,
 20466           DFHEIV99,
 20467           DFHEIV99
 20468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20469
 20470
 20471 7760-EXIT.
 20472     EXIT.
 20473
 20474 7770-CALL-DL22.
 20475
 20476* EXEC CICS LINK
 20477*        PROGRAM    ('DLO022')
 20478*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 20479*        LENGTH     (DLO022-COMM-LENGTH)
 20480*    END-EXEC.
 20481     MOVE 'DLO022' TO DFHEIV1
 20482*    MOVE '."C                   (   #00019936' TO DFHEIV0
 20483     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20484     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20485     MOVE X'2020233030303139393336' TO DFHEIV0(25:11)
 20486     CALL 'kxdfhei1' USING DFHEIV0,
 20487           DFHEIV1,
 20488           WS-DLO-VALID-STATE-CODE,
 20489           DLO022-COMM-LENGTH,
 20490           DFHEIV99,
 20491           DFHEIV99,
 20492           DFHEIV99,
 20493           DFHEIV99
 20494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20495
 20496
 20497 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 377
* EL050.cbl
 20498     EXIT.
 20499
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 378
* EL050.cbl
 20501
 20502 7780-CALL-AGG.
 20503
 20504* EXEC CICS LINK
 20505*        PROGRAM    ('ELAGGO')
 20506*        COMMAREA   (WS-PASS-to-pemaggo)
 20507*        LENGTH     (ws-passed-key-LENGTH)
 20508*    END-EXEC.
 20509     MOVE 'ELAGGO' TO DFHEIV1
 20510*    MOVE '."C                   (   #00019948' TO DFHEIV0
 20511     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20512     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20513     MOVE X'2020233030303139393438' TO DFHEIV0(25:11)
 20514     CALL 'kxdfhei1' USING DFHEIV0,
 20515           DFHEIV1,
 20516           WS-PASS-to-pemaggo,
 20517           ws-passed-key-LENGTH,
 20518           DFHEIV99,
 20519           DFHEIV99,
 20520           DFHEIV99,
 20521           DFHEIV99
 20522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20523
 20524 7780-EXIT.
 20525     EXIT.
 20526 7785-CALL-HLDI.
 20527
 20528* EXEC CICS LINK
 20529*        PROGRAM    ('ELHLDI')
 20530*        COMMAREA   (HLDI-PASS-AREA)
 20531*        LENGTH     (HLDI-PASS-AREA-LEN)
 20532*    END-EXEC.
 20533     MOVE 'ELHLDI' TO DFHEIV1
 20534*    MOVE '."C                   (   #00019956' TO DFHEIV0
 20535     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20536     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20537     MOVE X'2020233030303139393536' TO DFHEIV0(25:11)
 20538     CALL 'kxdfhei1' USING DFHEIV0,
 20539           DFHEIV1,
 20540           HLDI-PASS-AREA,
 20541           HLDI-PASS-AREA-LEN,
 20542           DFHEIV99,
 20543           DFHEIV99,
 20544           DFHEIV99,
 20545           DFHEIV99
 20546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20547
 20548 7785-EXIT.
 20549     EXIT.
 20550 7786-CALL-HLDIM.
 20551
 20552* EXEC CICS LINK
 20553*        PROGRAM    ('ELHLDIM')
 20554*        COMMAREA   (HLDI-PASS-AREA)
 20555*        LENGTH     (HLDI-PASS-AREA-LEN)
 20556*    END-EXEC.
 20557     MOVE 'ELHLDIM' TO DFHEIV1
 20558*    MOVE '."C                   (   #00019964' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 379
* EL050.cbl
 20559     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20560     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20561     MOVE X'2020233030303139393634' TO DFHEIV0(25:11)
 20562     CALL 'kxdfhei1' USING DFHEIV0,
 20563           DFHEIV1,
 20564           HLDI-PASS-AREA,
 20565           HLDI-PASS-AREA-LEN,
 20566           DFHEIV99,
 20567           DFHEIV99,
 20568           DFHEIV99,
 20569           DFHEIV99
 20570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20571
 20572 7786-EXIT.
 20573     EXIT.
 20574 7790-CALL-ZIP-VERIFY.
 20575
 20576
 20577* EXEC CICS LINK
 20578*        PROGRAM    ('WSZIPCD')
 20579*        COMMAREA   (ZIPCD-PASS-AREA)
 20580*        LENGTH     (ZIPCD-PASS-AREA-LEN)
 20581*    END-EXEC.
 20582     MOVE 'WSZIPCD' TO DFHEIV1
 20583*    MOVE '."C                   (   #00019973' TO DFHEIV0
 20584     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20585     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20586     MOVE X'2020233030303139393733' TO DFHEIV0(25:11)
 20587     CALL 'kxdfhei1' USING DFHEIV0,
 20588           DFHEIV1,
 20589           ZIPCD-PASS-AREA,
 20590           ZIPCD-PASS-AREA-LEN,
 20591           DFHEIV99,
 20592           DFHEIV99,
 20593           DFHEIV99,
 20594           DFHEIV99
 20595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20596
 20597
 20598 7790-EXIT.
 20599     EXIT.
 20600 7795-call-sqlclmhs.
 20601
 20602
 20603* EXEC CICS LINK
 20604*        PROGRAM    ('SQLCLMHS')
 20605*        COMMAREA   (clmhs-PASS-AREA)
 20606*        LENGTH     (clmhs-PASS-AREA-LEN)
 20607*    END-EXEC.
 20608     MOVE 'SQLCLMHS' TO DFHEIV1
 20609*    MOVE '."C                   (   #00019983' TO DFHEIV0
 20610     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20611     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20612     MOVE X'2020233030303139393833' TO DFHEIV0(25:11)
 20613     CALL 'kxdfhei1' USING DFHEIV0,
 20614           DFHEIV1,
 20615           clmhs-PASS-AREA,
 20616           clmhs-PASS-AREA-LEN,
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 380
* EL050.cbl
 20617           DFHEIV99,
 20618           DFHEIV99,
 20619           DFHEIV99,
 20620           DFHEIV99
 20621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20622
 20623
 20624 7795-EXIT.
 20625     EXIT.
 20626 7800-REWRITE-CERT.
 20627******************************************************************
 20628*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 20629*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 20630******************************************************************
 20631
 20632     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 20633        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 20634        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 20635        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 20636
 20637* EXEC CICS REWRITE
 20638*                  DATASET (CERT-ID)
 20639*                  FROM    (CERTIFICATE-MASTER)
 20640*              END-EXEC
 20641     MOVE LENGTH OF
 20642      CERTIFICATE-MASTER
 20643       TO DFHEIV11
 20644*    MOVE '&& L                  %   #00020001' TO DFHEIV0
 20645     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20646     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20647     MOVE X'2020233030303230303031' TO DFHEIV0(25:11)
 20648     CALL 'kxdfhei1' USING DFHEIV0,
 20649           CERT-ID,
 20650           CERTIFICATE-MASTER,
 20651           DFHEIV11,
 20652           DFHEIV99
 20653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20654        GO TO 7800-EXIT.
 20655
 20656       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 20657       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 20658
 20659 7800-EXIT.
 20660      EXIT.
 20661
 20662 7900-DELETE-CERT.
 20663
 20664* EXEC CICS DELETE
 20665*        DATASET (CERT-ID)
 20666*    END-EXEC.
 20667*    MOVE '&(                    &   #00020014' TO DFHEIV0
 20668     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 20669     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20670     MOVE X'2020233030303230303134' TO DFHEIV0(25:11)
 20671     CALL 'kxdfhei1' USING DFHEIV0,
 20672           CERT-ID,
 20673           DFHEIV99,
 20674           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 381
* EL050.cbl
 20675           DFHEIV99,
 20676           DFHEIV99
 20677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20678
 20679
 20680 7900-EXIT.
 20681     EXIT.
 20682
 20683 8000-WRITE-CERT.
 20684
 20685* EXEC CICS HANDLE CONDITION
 20686*        DUPKEY    (8000-FREE-MAIN)
 20687*    END-EXEC.
 20688*    MOVE '"$$                   ! + #00020022' TO DFHEIV0
 20689     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20690     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20691     MOVE X'2B20233030303230303232' TO DFHEIV0(25:11)
 20692     CALL 'kxdfhei1' USING DFHEIV0
 20693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20694
 20695
 20696
 20697* EXEC CICS WRITE
 20698*        DATASET     (CERT-ID)
 20699*        FROM        (CERTIFICATE-MASTER)
 20700*        RIDFLD      (ELCERT-KEY)
 20701*    END-EXEC.
 20702     MOVE LENGTH OF
 20703      CERTIFICATE-MASTER
 20704       TO DFHEIV11
 20705*    MOVE '&$ L                  ''   #00020026' TO DFHEIV0
 20706     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20707     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20708     MOVE X'2020233030303230303236' TO DFHEIV0(25:11)
 20709     CALL 'kxdfhei1' USING DFHEIV0,
 20710           CERT-ID,
 20711           CERTIFICATE-MASTER,
 20712           DFHEIV11,
 20713           ELCERT-KEY,
 20714           DFHEIV99,
 20715           DFHEIV99
 20716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20717
 20718
 20719 8000-FREE-MAIN.
 20720
 20721 8000-EXIT.
 20722      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 382
* EL050.cbl
 20724
 20725 8100-READ-ERPNDM.
 20726
 20727* EXEC CICS HANDLE CONDITION
 20728*         NOTFND     (8100-NOTFND)
 20729*         ENDFILE    (8100-NOTFND)
 20730*    END-EXEC.
 20731*    MOVE '"$I''                  ! , #00020039' TO DFHEIV0
 20732     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20733     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20734     MOVE X'2C20233030303230303339' TO DFHEIV0(25:11)
 20735     CALL 'kxdfhei1' USING DFHEIV0
 20736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20737
 20738
 20739     MOVE SPACES                 TO ERPNDM-FOUND.
 20740     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20741
 20742
 20743* EXEC CICS READ UPDATE
 20744*         DATASET   (FILE-ERPNDM)
 20745*         RIDFLD    (PM-CONTROL-PRIMARY)
 20746*         INTO      (PENDING-MAILING-DATA)
 20747*    END-EXEC.
 20748     MOVE LENGTH OF
 20749      PENDING-MAILING-DATA
 20750       TO DFHEIV11
 20751*    MOVE '&"IL       EU         (   #00020047' TO DFHEIV0
 20752     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20753     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20754     MOVE X'2020233030303230303437' TO DFHEIV0(25:11)
 20755     CALL 'kxdfhei1' USING DFHEIV0,
 20756           FILE-ERPNDM,
 20757           PENDING-MAILING-DATA,
 20758           DFHEIV11,
 20759           PM-CONTROL-PRIMARY,
 20760           DFHEIV99,
 20761           DFHEIV99,
 20762           DFHEIV99
 20763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20764
 20765
 20766     GO TO 8100-EXIT.
 20767
 20768 8100-NOTFND.
 20769
 20770     MOVE 'X'                    TO ERPNDM-FOUND.
 20771     MOVE ER-2694                TO WS-ERROR.
 20772     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20773     MOVE ER-2883                TO WS-ERROR
 20774     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 20775     .
 20776 8100-EXIT.
 20777     EXIT.
 20778 8102-REWRITE-ERPNDM.
 20779
 20780
 20781* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 383
* EL050.cbl
 20782*         DATASET    (FILE-ERPNDM)
 20783*         FROM       (PENDING-MAILING-DATA)
 20784*    END-EXEC
 20785     MOVE LENGTH OF
 20786      PENDING-MAILING-DATA
 20787       TO DFHEIV11
 20788*    MOVE '&& L                  %   #00020067' TO DFHEIV0
 20789     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20790     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20791     MOVE X'2020233030303230303637' TO DFHEIV0(25:11)
 20792     CALL 'kxdfhei1' USING DFHEIV0,
 20793           FILE-ERPNDM,
 20794           PENDING-MAILING-DATA,
 20795           DFHEIV11,
 20796           DFHEIV99
 20797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20798
 20799     .
 20800 8102-EXIT.
 20801     EXIT.
 20802 8104-UNLOCK-ERPNDM.
 20803
 20804
 20805* EXEC CICS UNLOCK
 20806*         DATASET   (FILE-ERPNDM)
 20807*    END-EXEC
 20808*    MOVE '&*                    #   #00020077' TO DFHEIV0
 20809     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20810     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20811     MOVE X'2020233030303230303737' TO DFHEIV0(25:11)
 20812     CALL 'kxdfhei1' USING DFHEIV0,
 20813           FILE-ERPNDM,
 20814           DFHEIV99
 20815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20816
 20817     .
 20818 8104-EXIT.
 20819     EXIT.
 20820 8110-READ-ERMAIL.
 20821
 20822* EXEC CICS HANDLE CONDITION
 20823*         NOTFND     (8110-NOTFND)
 20824*         ENDFILE    (8110-NOTFND)
 20825*    END-EXEC.
 20826*    MOVE '"$I''                  ! - #00020085' TO DFHEIV0
 20827     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20828     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20829     MOVE X'2D20233030303230303835' TO DFHEIV0(25:11)
 20830     CALL 'kxdfhei1' USING DFHEIV0
 20831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20832
 20833
 20834     MOVE SPACES                 TO ERMAIL-FOUND.
 20835     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20836     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20837     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20838     MOVE PB-SV-STATE            TO MA-STATE.
 20839
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 384
* EL050.cbl
 20840
 20841* EXEC CICS READ
 20842*         UPDATE
 20843*         DATASET   (FILE-ERMAIL)
 20844*         RIDFLD    (MA-CONTROL-PRIMARY)
 20845*         INTO      (MAILING-DATA)
 20846*    END-EXEC.
 20847     MOVE LENGTH OF
 20848      MAILING-DATA
 20849       TO DFHEIV11
 20850*    MOVE '&"IL       EU         (   #00020096' TO DFHEIV0
 20851     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20852     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20853     MOVE X'2020233030303230303936' TO DFHEIV0(25:11)
 20854     CALL 'kxdfhei1' USING DFHEIV0,
 20855           FILE-ERMAIL,
 20856           MAILING-DATA,
 20857           DFHEIV11,
 20858           MA-CONTROL-PRIMARY,
 20859           DFHEIV99,
 20860           DFHEIV99,
 20861           DFHEIV99
 20862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20863
 20864
 20865     GO TO 8110-EXIT.
 20866
 20867 8110-NOTFND.
 20868     MOVE 'X'                    TO ERMAIL-FOUND.
 20869
 20870 8110-EXIT.
 20871     EXIT.
 20872
 20873 8120-REWRITE-ERMAIL.
 20874
 20875* EXEC CICS REWRITE
 20876*         DATASET    (FILE-ERMAIL)
 20877*         FROM       (MAILING-DATA)
 20878*    END-EXEC.
 20879     MOVE LENGTH OF
 20880      MAILING-DATA
 20881       TO DFHEIV11
 20882*    MOVE '&& L                  %   #00020112' TO DFHEIV0
 20883     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20884     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20885     MOVE X'2020233030303230313132' TO DFHEIV0(25:11)
 20886     CALL 'kxdfhei1' USING DFHEIV0,
 20887           FILE-ERMAIL,
 20888           MAILING-DATA,
 20889           DFHEIV11,
 20890           DFHEIV99
 20891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20892
 20893
 20894 8120-EXIT.
 20895     EXIT.
 20896
 20897 8130-WRITE-ERMAIL.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 385
* EL050.cbl
 20898
 20899* EXEC CICS HANDLE CONDITION
 20900*         DUPKEY   (8130-EXIT)
 20901*    END-EXEC.
 20902*    MOVE '"$$                   ! . #00020121' TO DFHEIV0
 20903     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20904     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20905     MOVE X'2E20233030303230313231' TO DFHEIV0(25:11)
 20906     CALL 'kxdfhei1' USING DFHEIV0
 20907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20908
 20909
 20910
 20911* EXEC CICS WRITE
 20912*         DATASET     (FILE-ERMAIL)
 20913*         RIDFLD      (MA-CONTROL-PRIMARY)
 20914*         FROM        (MAILING-DATA)
 20915*    END-EXEC.
 20916     MOVE LENGTH OF
 20917      MAILING-DATA
 20918       TO DFHEIV11
 20919*    MOVE '&$ L                  ''   #00020125' TO DFHEIV0
 20920     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20921     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20922     MOVE X'2020233030303230313235' TO DFHEIV0(25:11)
 20923     CALL 'kxdfhei1' USING DFHEIV0,
 20924           FILE-ERMAIL,
 20925           MAILING-DATA,
 20926           DFHEIV11,
 20927           MA-CONTROL-PRIMARY,
 20928           DFHEIV99,
 20929           DFHEIV99
 20930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20931
 20932
 20933 8130-EXIT.
 20934     EXIT.
 20935
 20936 8140-UNLOCK-ERMAIL.
 20937
 20938* EXEC CICS UNLOCK
 20939*         DATASET   (FILE-ERMAIL)
 20940*    END-EXEC.
 20941*    MOVE '&*                    #   #00020135' TO DFHEIV0
 20942     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20943     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20944     MOVE X'2020233030303230313335' TO DFHEIV0(25:11)
 20945     CALL 'kxdfhei1' USING DFHEIV0,
 20946           FILE-ERMAIL,
 20947           DFHEIV99
 20948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20949
 20950
 20951 8140-EXIT.
 20952     EXIT.
 20953
 20954 8145-read-elcrtt-upd.
 20955
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 386
* EL050.cbl
 20956     move ' '                    to elcrtt-found-sw
 20957                                    elcrtt-update-sw
 20958
 20959* EXEC CICS HANDLE CONDITION
 20960*        NOTFND   (8145-exit)
 20961*    END-EXEC
 20962*    MOVE '"$I                   ! / #00020146' TO DFHEIV0
 20963     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20964     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20965     MOVE X'2F20233030303230313436' TO DFHEIV0(25:11)
 20966     CALL 'kxdfhei1' USING DFHEIV0
 20967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20968
 20969     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20970     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20971
 20972
 20973* EXEC CICS READ UPDATE
 20974*        DATASET  (CRTT-ID)
 20975*        RIDFLD   (WS-ELCRTT-KEY)
 20976*        INTO     (CERTIFICATE-TRAILERS)
 20977*    END-EXEC
 20978     MOVE LENGTH OF
 20979      CERTIFICATE-TRAILERS
 20980       TO DFHEIV11
 20981*    MOVE '&"IL       EU         (   #00020153' TO DFHEIV0
 20982     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20983     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20984     MOVE X'2020233030303230313533' TO DFHEIV0(25:11)
 20985     CALL 'kxdfhei1' USING DFHEIV0,
 20986           CRTT-ID,
 20987           CERTIFICATE-TRAILERS,
 20988           DFHEIV11,
 20989           WS-ELCRTT-KEY,
 20990           DFHEIV99,
 20991           DFHEIV99,
 20992           DFHEIV99
 20993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20994
 20995     set elcrtt-found to true
 20996
 20997     .
 20998 8145-exit.
 20999     exit.
 21000 8150-UPDATE-ELCRTT.
 21001
 21002     if elcrtt-found
 21003
 21004* EXEC CICS REWRITE
 21005*           DATASET  (CRTT-ID)
 21006*           FROM     (CERTIFICATE-TRAILERS)
 21007*        END-EXEC
 21008     MOVE LENGTH OF
 21009      CERTIFICATE-TRAILERS
 21010       TO DFHEIV11
 21011*    MOVE '&& L                  %   #00020167' TO DFHEIV0
 21012     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21013     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 387
* EL050.cbl
 21014     MOVE X'2020233030303230313637' TO DFHEIV0(25:11)
 21015     CALL 'kxdfhei1' USING DFHEIV0,
 21016           CRTT-ID,
 21017           CERTIFICATE-TRAILERS,
 21018           DFHEIV11,
 21019           DFHEIV99
 21020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21021     ELSE
 21022
 21023* EXEC CICS WRITE
 21024*          DATASET  (CRTT-ID)
 21025*          RIDFLD   (WS-ELCRTT-KEY)
 21026*          FROM     (CERTIFICATE-TRAILERS)
 21027*       END-EXEC
 21028     MOVE LENGTH OF
 21029      CERTIFICATE-TRAILERS
 21030       TO DFHEIV11
 21031*    MOVE '&$ L                  ''   #00020172' TO DFHEIV0
 21032     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21033     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21034     MOVE X'2020233030303230313732' TO DFHEIV0(25:11)
 21035     CALL 'kxdfhei1' USING DFHEIV0,
 21036           CRTT-ID,
 21037           CERTIFICATE-TRAILERS,
 21038           DFHEIV11,
 21039           WS-ELCRTT-KEY,
 21040           DFHEIV99,
 21041           DFHEIV99
 21042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21043     end-if
 21044
 21045     .
 21046 8150-EXIT.
 21047     EXIT.
 21048
 21049 8155-unlock-elcrtt.
 21050
 21051
 21052* EXEC CICS UNLOCK
 21053*       DATASET  (CRTT-ID)
 21054*    END-EXEC
 21055*    MOVE '&*                    #   #00020185' TO DFHEIV0
 21056     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21057     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21058     MOVE X'2020233030303230313835' TO DFHEIV0(25:11)
 21059     CALL 'kxdfhei1' USING DFHEIV0,
 21060           CRTT-ID,
 21061           DFHEIV99
 21062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21063
 21064     .
 21065 8155-exit.
 21066     exit.
 21067
 21068 8190-UPDATE-REFUND-CLAIM-FLAG.
 21069
 21070* EXEC CICS HANDLE CONDITION
 21071*        NOTFND   (8190-NOTFND)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 388
* EL050.cbl
 21072*    END-EXEC.
 21073*    MOVE '"$I                   ! 0 #00020194' TO DFHEIV0
 21074     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21075     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21076     MOVE X'3020233030303230313934' TO DFHEIV0(25:11)
 21077     CALL 'kxdfhei1' USING DFHEIV0
 21078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21079
 21080
 21081     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21082     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21083
 21084
 21085* EXEC CICS READ
 21086*        UPDATE
 21087*        DATASET  (CRTT-ID)
 21088*        RIDFLD   (WS-ELCRTT-KEY)
 21089*        INTO     (CERTIFICATE-TRAILERS)
 21090*    END-EXEC.
 21091     MOVE LENGTH OF
 21092      CERTIFICATE-TRAILERS
 21093       TO DFHEIV11
 21094*    MOVE '&"IL       EU         (   #00020201' TO DFHEIV0
 21095     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21096     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21097     MOVE X'2020233030303230323031' TO DFHEIV0(25:11)
 21098     CALL 'kxdfhei1' USING DFHEIV0,
 21099           CRTT-ID,
 21100           CERTIFICATE-TRAILERS,
 21101           DFHEIV11,
 21102           WS-ELCRTT-KEY,
 21103           DFHEIV99,
 21104           DFHEIV99,
 21105           DFHEIV99
 21106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21107
 21108
 21109     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 21110
 21111* EXEC CICS REWRITE
 21112*       DATASET  (CRTT-ID)
 21113*       FROM     (CERTIFICATE-TRAILERS)
 21114*    END-EXEC.
 21115     MOVE LENGTH OF
 21116      CERTIFICATE-TRAILERS
 21117       TO DFHEIV11
 21118*    MOVE '&& L                  %   #00020209' TO DFHEIV0
 21119     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21120     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21121     MOVE X'2020233030303230323039' TO DFHEIV0(25:11)
 21122     CALL 'kxdfhei1' USING DFHEIV0,
 21123           CRTT-ID,
 21124           CERTIFICATE-TRAILERS,
 21125           DFHEIV11,
 21126           DFHEIV99
 21127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21128
 21129
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 389
* EL050.cbl
 21130     GO TO 8190-EXIT.
 21131
 21132 8190-NOTFND.
 21133
 21134     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21135     MOVE 'CS'         TO CS-RECORD-ID.
 21136     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21137     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21138     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21139     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 21140
 21141* EXEC CICS WRITE
 21142*       DATASET  (CRTT-ID)
 21143*       RIDFLD   (WS-ELCRTT-KEY)
 21144*       FROM     (CERTIFICATE-TRAILERS)
 21145*    END-EXEC.
 21146     MOVE LENGTH OF
 21147      CERTIFICATE-TRAILERS
 21148       TO DFHEIV11
 21149*    MOVE '&$ L                  ''   #00020224' TO DFHEIV0
 21150     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21151     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21152     MOVE X'2020233030303230323234' TO DFHEIV0(25:11)
 21153     CALL 'kxdfhei1' USING DFHEIV0,
 21154           CRTT-ID,
 21155           CERTIFICATE-TRAILERS,
 21156           DFHEIV11,
 21157           WS-ELCRTT-KEY,
 21158           DFHEIV99,
 21159           DFHEIV99
 21160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21161
 21162
 21163 8190-EXIT.
 21164     EXIT.
 21165
 21166 8195-UPDATE-AGE-FLAGS.
 21167
 21168* EXEC CICS HANDLE CONDITION
 21169*        NOTFND   (8195-NOTFND)
 21170*    END-EXEC.
 21171*    MOVE '"$I                   ! 1 #00020234' TO DFHEIV0
 21172     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21173     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21174     MOVE X'3120233030303230323334' TO DFHEIV0(25:11)
 21175     CALL 'kxdfhei1' USING DFHEIV0
 21176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21177
 21178
 21179     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21180     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21181
 21182
 21183* EXEC CICS READ
 21184*        UPDATE
 21185*        DATASET  (CRTT-ID)
 21186*        RIDFLD   (WS-ELCRTT-KEY)
 21187*        INTO     (CERTIFICATE-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 390
* EL050.cbl
 21188*    END-EXEC.
 21189     MOVE LENGTH OF
 21190      CERTIFICATE-TRAILERS
 21191       TO DFHEIV11
 21192*    MOVE '&"IL       EU         (   #00020241' TO DFHEIV0
 21193     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21194     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21195     MOVE X'2020233030303230323431' TO DFHEIV0(25:11)
 21196     CALL 'kxdfhei1' USING DFHEIV0,
 21197           CRTT-ID,
 21198           CERTIFICATE-TRAILERS,
 21199           DFHEIV11,
 21200           WS-ELCRTT-KEY,
 21201           DFHEIV99,
 21202           DFHEIV99,
 21203           DFHEIV99
 21204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21205
 21206
 21207     IF WS-INS-AGE-SET = 'Y'
 21208        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 21209     END-IF
 21210     IF WS-JNT-AGE-SET = 'Y'
 21211        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 21212     END-IF
 21213
 21214
 21215* EXEC CICS REWRITE
 21216*       DATASET  (CRTT-ID)
 21217*       FROM     (CERTIFICATE-TRAILERS)
 21218*    END-EXEC.
 21219     MOVE LENGTH OF
 21220      CERTIFICATE-TRAILERS
 21221       TO DFHEIV11
 21222*    MOVE '&& L                  %   #00020255' TO DFHEIV0
 21223     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21224     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21225     MOVE X'2020233030303230323535' TO DFHEIV0(25:11)
 21226     CALL 'kxdfhei1' USING DFHEIV0,
 21227           CRTT-ID,
 21228           CERTIFICATE-TRAILERS,
 21229           DFHEIV11,
 21230           DFHEIV99
 21231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21232
 21233
 21234     GO TO 8195-EXIT.
 21235
 21236 8195-NOTFND.
 21237
 21238     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21239     MOVE 'CS'         TO CS-RECORD-ID.
 21240     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21241     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21242     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21243     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 21244     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 21245
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 391
* EL050.cbl
 21246* EXEC CICS WRITE
 21247*       DATASET  (CRTT-ID)
 21248*       RIDFLD   (WS-ELCRTT-KEY)
 21249*       FROM     (CERTIFICATE-TRAILERS)
 21250*    END-EXEC.
 21251     MOVE LENGTH OF
 21252      CERTIFICATE-TRAILERS
 21253       TO DFHEIV11
 21254*    MOVE '&$ L                  ''   #00020271' TO DFHEIV0
 21255     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21256     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21257     MOVE X'2020233030303230323731' TO DFHEIV0(25:11)
 21258     CALL 'kxdfhei1' USING DFHEIV0,
 21259           CRTT-ID,
 21260           CERTIFICATE-TRAILERS,
 21261           DFHEIV11,
 21262           WS-ELCRTT-KEY,
 21263           DFHEIV99,
 21264           DFHEIV99
 21265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21266
 21267
 21268 8195-EXIT.
 21269     EXIT.
 21270
 21271 8200-READ-REIN-TABLE.
 21272
 21273* EXEC CICS HANDLE CONDITION
 21274*         NOTFND   (8200-NOTFND)
 21275*    END-EXEC.
 21276*    MOVE '"$I                   ! 2 #00020281' TO DFHEIV0
 21277     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21278     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21279     MOVE X'3220233030303230323831' TO DFHEIV0(25:11)
 21280     CALL 'kxdfhei1' USING DFHEIV0
 21281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21282
 21283
 21284
 21285* EXEC CICS READ
 21286*        DATASET     (REIN-ID)
 21287*        SET         (ADDRESS OF REINSURANCE-RECORD)
 21288*        RIDFLD      (ERREIN-KEY)
 21289*    END-EXEC.
 21290*    MOVE '&"S        E          (   #00020285' TO DFHEIV0
 21291     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21292     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21293     MOVE X'2020233030303230323835' TO DFHEIV0(25:11)
 21294     CALL 'kxdfhei1' USING DFHEIV0,
 21295           REIN-ID,
 21296           DFHEIV20,
 21297           DFHEIV99,
 21298           ERREIN-KEY,
 21299           DFHEIV99,
 21300           DFHEIV99,
 21301           DFHEIV99
 21302     SET ADDRESS OF REINSURANCE-RECORD TO
 21303         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 392
* EL050.cbl
 21304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21305
 21306
 21307     GO TO 8200-EXIT.
 21308
 21309 8200-NOTFND.
 21310     MOVE 'N'             TO WS-REIN-READ-SW.
 21311
 21312 8200-EXIT.
 21313      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 393
* EL050.cbl
 21315
 21316 8300-READ-CTBL-TABLE.
 21317
 21318* EXEC CICS HANDLE CONDITION
 21319*        NOTFND    (8300-NOTFND)
 21320*        DISABLED  (8300-ERRESS-PROBLEM)
 21321*        NOTOPEN   (8300-ERRESS-PROBLEM)
 21322*        ENDFILE   (8300-NOTFND)
 21323*    END-EXEC.
 21324*    MOVE '"$IcJ''                ! 3 #00020301' TO DFHEIV0
 21325     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 21326     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21327     MOVE X'3320233030303230333031' TO DFHEIV0(25:11)
 21328     CALL 'kxdfhei1' USING DFHEIV0
 21329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21330
 21331
 21332
 21333* EXEC CICS READ
 21334*        DATASET     (CTBL-ID)
 21335*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 21336*        RIDFLD      (ERCTBL-KEY)
 21337*    END-EXEC.
 21338*    MOVE '&"S        E          (   #00020308' TO DFHEIV0
 21339     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21340     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21341     MOVE X'2020233030303230333038' TO DFHEIV0(25:11)
 21342     CALL 'kxdfhei1' USING DFHEIV0,
 21343           CTBL-ID,
 21344           DFHEIV20,
 21345           DFHEIV99,
 21346           ERCTBL-KEY,
 21347           DFHEIV99,
 21348           DFHEIV99,
 21349           DFHEIV99
 21350     SET ADDRESS OF COMM-TABLE-RECORD TO
 21351         DFHEIV20
 21352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21353
 21354
 21355     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 21356
 21357     GO TO 8300-EXIT.
 21358
 21359 8300-NOTFND.
 21360
 21361     IF CTBL-SW = '0530'
 21362         MOVE 'AA'                     TO WS-AH-COMP-CD
 21363         MOVE '0550'                   TO CTBL-SW
 21364         MOVE '1'                      TO WS-CTBL-READ-SW
 21365         GO TO 8300-EXIT.
 21366
 21367     IF CTBL-SW = '0540'
 21368         MOVE 'AA'                     TO WS-LF-COMP-CD
 21369         MOVE '0550'                   TO CTBL-SW
 21370         MOVE '1'                      TO WS-CTBL-READ-SW
 21371         GO TO 8300-EXIT.
 21372
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 394
* EL050.cbl
 21373     IF CTBL-SW = '0550'
 21374         MOVE '2'                      TO WS-CTBL-READ-SW
 21375         GO TO 8300-EXIT.
 21376
 21377     GO TO 8300-EXIT.
 21378
 21379 8300-ERRESS-PROBLEM.
 21380
 21381      MOVE ER-8050              TO WS-ERROR.
 21382      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21383
 21384     GO TO 8300-EXIT.
 21385
 21386 8300-EXIT.
 21387      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 395
* EL050.cbl
 21389
 21390
 21391 8400-GETMAIN-ERFORM.
 21392
 21393
 21394* EXEC CICS   GETMAIN
 21395*        LENGTH  (500)
 21396*        SET     (ADDRESS OF FORM-MASTER)
 21397*    END-EXEC.
 21398     MOVE 500
 21399       TO DFHEIV11
 21400*    MOVE '," L                  $   #00020352' TO DFHEIV0
 21401     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21402     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21403     MOVE X'2020233030303230333532' TO DFHEIV0(25:11)
 21404     CALL 'kxdfhei1' USING DFHEIV0,
 21405           DFHEIV20,
 21406           DFHEIV11,
 21407           DFHEIV99
 21408     SET ADDRESS OF FORM-MASTER TO
 21409         DFHEIV20
 21410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21411
 21412
 21413     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 21414
 21415 8400-EXIT.
 21416      EXIT.
 21417
 21418 8450-READ-FORM-MASTER.
 21419
 21420
 21421* EXEC CICS  HANDLE CONDITION
 21422*        NOTFND   (8450-FORM-NOT-FOUND)
 21423*        ENDFILE  (8450-FORM-NOT-FOUND)
 21424*    END-EXEC.
 21425*    MOVE '"$I''                  ! 4 #00020364' TO DFHEIV0
 21426     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21427     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21428     MOVE X'3420233030303230333634' TO DFHEIV0(25:11)
 21429     CALL 'kxdfhei1' USING DFHEIV0
 21430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21431
 21432
 21433
 21434* EXEC CICS   READ
 21435*        DATASET   (FORM-ID)
 21436*        RIDFLD    (ERFORM-KEY)
 21437*        INTO      (FORM-MASTER)
 21438*        GTEQ
 21439*    END-EXEC.
 21440     MOVE LENGTH OF
 21441      FORM-MASTER
 21442       TO DFHEIV11
 21443*    MOVE '&"IL       G          (   #00020369' TO DFHEIV0
 21444     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21445     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21446     MOVE X'2020233030303230333639' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 396
* EL050.cbl
 21447     CALL 'kxdfhei1' USING DFHEIV0,
 21448           FORM-ID,
 21449           FORM-MASTER,
 21450           DFHEIV11,
 21451           ERFORM-KEY,
 21452           DFHEIV99,
 21453           DFHEIV99,
 21454           DFHEIV99
 21455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21456
 21457
 21458     MOVE  'Y'           TO  FORM-MASTER-SW.
 21459
 21460     GO TO  8450-EXIT.
 21461
 21462 8450-FORM-NOT-FOUND.
 21463
 21464     MOVE  'N'           TO  FORM-MASTER-SW.
 21465
 21466 8450-EXIT.
 21467      EXIT.
 21468
 21469 8500-DATE-CONVERT.
 21470
 21471* EXEC CICS LINK
 21472*        PROGRAM    ('ELDATCV')
 21473*        COMMAREA   (DATE-CONVERSION-DATA)
 21474*        LENGTH     (DC-COMM-LENGTH)
 21475*    END-EXEC.
 21476     MOVE 'ELDATCV' TO DFHEIV1
 21477*    MOVE '."C                   (   #00020388' TO DFHEIV0
 21478     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21479     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21480     MOVE X'2020233030303230333838' TO DFHEIV0(25:11)
 21481     CALL 'kxdfhei1' USING DFHEIV0,
 21482           DFHEIV1,
 21483           DATE-CONVERSION-DATA,
 21484           DC-COMM-LENGTH,
 21485           DFHEIV99,
 21486           DFHEIV99,
 21487           DFHEIV99,
 21488           DFHEIV99
 21489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21490
 21491
 21492 8500-EXIT.
 21493     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 397
* EL050.cbl
 21495
 21496 8555-RELOAD-CONTROL-FILE.
 21497     CONTINUE.
 21498
 21499 8555-EXIT.
 21500     EXIT.
 21501
 21502 8557-GETMAIN-ERPLAN.
 21503
 21504
 21505* EXEC CICS GETMAIN
 21506*        LENGTH    (840)
 21507*        SET       (ADDRESS OF PLAN-RECORDS)
 21508*    END-EXEC.
 21509     MOVE 840
 21510       TO DFHEIV11
 21511*    MOVE '," L                  $   #00020406' TO DFHEIV0
 21512     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21513     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21514     MOVE X'2020233030303230343036' TO DFHEIV0(25:11)
 21515     CALL 'kxdfhei1' USING DFHEIV0,
 21516           DFHEIV20,
 21517           DFHEIV11,
 21518           DFHEIV99
 21519     SET ADDRESS OF PLAN-RECORDS TO
 21520         DFHEIV20
 21521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21522
 21523
 21524     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 21525
 21526 8557-EXIT.
 21527     EXIT.
 21528
 21529 8560-GETMAIN.
 21530
 21531* EXEC CICS GETMAIN
 21532*        LENGTH    (2000)
 21533*        SET       (ADDRESS OF ACCOUNT-MASTER)
 21534*    END-EXEC.
 21535     MOVE 2000
 21536       TO DFHEIV11
 21537*    MOVE '," L                  $   #00020417' TO DFHEIV0
 21538     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21539     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21540     MOVE X'2020233030303230343137' TO DFHEIV0(25:11)
 21541     CALL 'kxdfhei1' USING DFHEIV0,
 21542           DFHEIV20,
 21543           DFHEIV11,
 21544           DFHEIV99
 21545     SET ADDRESS OF ACCOUNT-MASTER TO
 21546         DFHEIV20
 21547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21548
 21549
 21550     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 21551
 21552 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 398
* EL050.cbl
 21553     EXIT.
 21554
 21555 8570-START-ACCOUNT-MASTER.
 21556
 21557* EXEC CICS HANDLE CONDITION
 21558*        NOTFND    (0199-ACCT-NOT-FOUND)
 21559*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21560*    END-EXEC.
 21561*    MOVE '"$I''                  ! 5 #00020428' TO DFHEIV0
 21562     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21563     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21564     MOVE X'3520233030303230343238' TO DFHEIV0(25:11)
 21565     CALL 'kxdfhei1' USING DFHEIV0
 21566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21567
 21568
 21569
 21570* EXEC CICS STARTBR
 21571*        DATASET    (ACCT-ID)
 21572*        RIDFLD     (ERACCT-KEY)
 21573*        GTEQ
 21574*    END-EXEC.
 21575     MOVE 0
 21576       TO DFHEIV11
 21577*    MOVE '&,         G          &   #00020433' TO DFHEIV0
 21578     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21579     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21580     MOVE X'2020233030303230343333' TO DFHEIV0(25:11)
 21581     CALL 'kxdfhei1' USING DFHEIV0,
 21582           ACCT-ID,
 21583           ERACCT-KEY,
 21584           DFHEIV99,
 21585           DFHEIV11,
 21586           DFHEIV99
 21587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21588
 21589
 21590 8570-EXIT.
 21591     EXIT.
 21592
 21593 8580-READ-ACCOUNT-MASTER.
 21594
 21595* EXEC CICS HANDLE CONDITION
 21596*        NOTFND    (0199-ACCT-NOT-FOUND)
 21597*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21598*    END-EXEC.
 21599*    MOVE '"$I''                  ! 6 #00020443' TO DFHEIV0
 21600     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21601     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21602     MOVE X'3620233030303230343433' TO DFHEIV0(25:11)
 21603     CALL 'kxdfhei1' USING DFHEIV0
 21604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21605
 21606
 21607
 21608* EXEC CICS READNEXT
 21609*        DATASET     (ACCT-ID)
 21610*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 399
* EL050.cbl
 21611*        RIDFLD      (ERACCT-KEY)
 21612*    END-EXEC.
 21613     MOVE LENGTH OF
 21614      ACCOUNT-MASTER
 21615       TO DFHEIV12
 21616     MOVE 0
 21617       TO DFHEIV11
 21618*    MOVE '&.IL                  )   #00020448' TO DFHEIV0
 21619     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21620     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21621     MOVE X'2020233030303230343438' TO DFHEIV0(25:11)
 21622     CALL 'kxdfhei1' USING DFHEIV0,
 21623           ACCT-ID,
 21624           ACCOUNT-MASTER,
 21625           DFHEIV12,
 21626           ERACCT-KEY,
 21627           DFHEIV99,
 21628           DFHEIV11,
 21629           DFHEIV99,
 21630           DFHEIV99
 21631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21632
 21633
 21634 8580-EXIT.
 21635     EXIT.
 21636
 21637 8582-READ-COMPENSATION-MASTER.
 21638
 21639* EXEC CICS HANDLE CONDITION
 21640*        NOTFND    (8582-COMP-NOT-FOUND)
 21641*        ENDFILE   (8582-COMP-NOT-FOUND)
 21642*    END-EXEC.
 21643*    MOVE '"$I''                  ! 7 #00020458' TO DFHEIV0
 21644     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21645     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21646     MOVE X'3720233030303230343538' TO DFHEIV0(25:11)
 21647     CALL 'kxdfhei1' USING DFHEIV0
 21648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21649
 21650
 21651
 21652* EXEC CICS READ
 21653*        DATASET     (COMP-ID)
 21654*        INTO        (COMPENSATION-MASTER)
 21655*        RIDFLD      (ERCOMP-KEY)
 21656*    END-EXEC.
 21657     MOVE LENGTH OF
 21658      COMPENSATION-MASTER
 21659       TO DFHEIV11
 21660*    MOVE '&"IL       E          (   #00020463' TO DFHEIV0
 21661     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21662     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21663     MOVE X'2020233030303230343633' TO DFHEIV0(25:11)
 21664     CALL 'kxdfhei1' USING DFHEIV0,
 21665           COMP-ID,
 21666           COMPENSATION-MASTER,
 21667           DFHEIV11,
 21668           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 400
* EL050.cbl
 21669           DFHEIV99,
 21670           DFHEIV99,
 21671           DFHEIV99
 21672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21673
 21674
 21675     MOVE 'Y'                    TO COMP-MASTER-SW
 21676
 21677     GO TO 8582-EXIT
 21678     .
 21679 8582-COMP-NOT-FOUND.
 21680
 21681     MOVE 'N'                    TO COMP-MASTER-SW.
 21682
 21683 8582-EXIT.
 21684     EXIT.
 21685
 21686 8583-READ-ERAGTC.
 21687
 21688* EXEC CICS HANDLE CONDITION
 21689*        NOTFND    (8583-AGTC-NOT-FOUND)
 21690*        ENDFILE   (8583-AGTC-NOT-FOUND)
 21691*    END-EXEC.
 21692*    MOVE '"$I''                  ! 8 #00020481' TO DFHEIV0
 21693     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21694     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21695     MOVE X'3820233030303230343831' TO DFHEIV0(25:11)
 21696     CALL 'kxdfhei1' USING DFHEIV0
 21697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21698
 21699
 21700
 21701* EXEC CICS STARTBR
 21702*        DATASET    (AGTC-ID)
 21703*        RIDFLD     (ERAGTC-KEY)
 21704*        GTEQ
 21705*    END-EXEC.
 21706     MOVE 0
 21707       TO DFHEIV11
 21708*    MOVE '&,         G          &   #00020486' TO DFHEIV0
 21709     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21710     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21711     MOVE X'2020233030303230343836' TO DFHEIV0(25:11)
 21712     CALL 'kxdfhei1' USING DFHEIV0,
 21713           AGTC-ID,
 21714           ERAGTC-KEY,
 21715           DFHEIV99,
 21716           DFHEIV11,
 21717           DFHEIV99
 21718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21719
 21720
 21721 8583-READ-ERAGTC-NEXT.
 21722
 21723* EXEC CICS READNEXT
 21724*        DATASET     (AGTC-ID)
 21725*        INTO        (AGENT-COMMISSIONS)
 21726*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 401
* EL050.cbl
 21727*    END-EXEC.
 21728     MOVE LENGTH OF
 21729      AGENT-COMMISSIONS
 21730       TO DFHEIV12
 21731     MOVE 0
 21732       TO DFHEIV11
 21733*    MOVE '&.IL                  )   #00020493' TO DFHEIV0
 21734     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21735     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21736     MOVE X'2020233030303230343933' TO DFHEIV0(25:11)
 21737     CALL 'kxdfhei1' USING DFHEIV0,
 21738           AGTC-ID,
 21739           AGENT-COMMISSIONS,
 21740           DFHEIV12,
 21741           ERAGTC-KEY,
 21742           DFHEIV99,
 21743           DFHEIV11,
 21744           DFHEIV99,
 21745           DFHEIV99
 21746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21747
 21748
 21749*    MOVE 'Y'                    TO AGTC-MASTER-SW
 21750
 21751     GO TO 8583-EXIT
 21752     .
 21753 8583-AGTC-NOT-FOUND.
 21754
 21755     MOVE 'N'                    TO AGTC-MASTER-SW.
 21756
 21757 8583-EXIT.
 21758     EXIT.
 21759
 21760 8584-READ-BANK-CROSS-REF.
 21761
 21762* EXEC CICS HANDLE CONDITION
 21763*        NOTFND    (8584-BXRF-NOT-FOUND)
 21764*        ENDFILE   (8584-BXRF-NOT-FOUND)
 21765*    END-EXEC.
 21766*    MOVE '"$I''                  ! 9 #00020511' TO DFHEIV0
 21767     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21768     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21769     MOVE X'3920233030303230353131' TO DFHEIV0(25:11)
 21770     CALL 'kxdfhei1' USING DFHEIV0
 21771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21772
 21773
 21774
 21775* EXEC CICS READ
 21776*        DATASET     (BXRF-ID)
 21777*        INTO        (BANK-CROSS-REFERENCE)
 21778*        RIDFLD      (ERBXRF-KEY)
 21779*        LENGTH      (BXRF-REC-LENGTH)
 21780*    END-EXEC.
 21781*    MOVE '&"IL       E          (   #00020516' TO DFHEIV0
 21782     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21783     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21784     MOVE X'2020233030303230353136' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 402
* EL050.cbl
 21785     CALL 'kxdfhei1' USING DFHEIV0,
 21786           BXRF-ID,
 21787           BANK-CROSS-REFERENCE,
 21788           BXRF-REC-LENGTH,
 21789           ERBXRF-KEY,
 21790           DFHEIV99,
 21791           DFHEIV99,
 21792           DFHEIV99
 21793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21794
 21795
 21796     MOVE 'Y'                    TO BXRF-MASTER-SW
 21797
 21798     GO TO 8584-EXIT
 21799     .
 21800 8584-BXRF-NOT-FOUND.
 21801
 21802     MOVE 'N'                    TO BXRF-MASTER-SW.
 21803
 21804 8584-EXIT.
 21805     EXIT.
 21806
 21807 8585-READ-PLAN-MASTER.
 21808
 21809
 21810* EXEC CICS HANDLE CONDITION
 21811*        NOTFND    (8585-PLAN-NOT-FOUND)
 21812*        ENDFILE   (8585-PLAN-NOT-FOUND)
 21813*    END-EXEC.
 21814*    MOVE '"$I''                  ! : #00020536' TO DFHEIV0
 21815     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21816     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21817     MOVE X'3A20233030303230353336' TO DFHEIV0(25:11)
 21818     CALL 'kxdfhei1' USING DFHEIV0
 21819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21820
 21821
 21822
 21823* EXEC CICS READ
 21824*        DATASET     (PLAN-ID)
 21825*        INTO        (PLAN-MASTER)
 21826*        RIDFLD      (ERPLAN-KEY)
 21827*    END-EXEC.
 21828     MOVE LENGTH OF
 21829      PLAN-MASTER
 21830       TO DFHEIV11
 21831*    MOVE '&"IL       E          (   #00020541' TO DFHEIV0
 21832     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21833     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21834     MOVE X'2020233030303230353431' TO DFHEIV0(25:11)
 21835     CALL 'kxdfhei1' USING DFHEIV0,
 21836           PLAN-ID,
 21837           PLAN-MASTER,
 21838           DFHEIV11,
 21839           ERPLAN-KEY,
 21840           DFHEIV99,
 21841           DFHEIV99,
 21842           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 403
* EL050.cbl
 21843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21844
 21845
 21846     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21847
 21848     GO TO 8585-EXIT.
 21849
 21850 8585-PLAN-NOT-FOUND.
 21851
 21852     MOVE 'N'                    TO PLAN-MASTER-SW.
 21853
 21854 8585-EXIT.
 21855     EXIT.
 21856
 21857 8586-READ-LOAN-OFFICER.
 21858
 21859* EXEC CICS READ
 21860*        DATASET     (LOFC-ID)
 21861*        INTO        (LOAN-OFFICER-MASTER)
 21862*        RIDFLD      (ERLOFC-KEY)
 21863*        RESP        (WS-RESPONSE)
 21864*    END-EXEC
 21865     MOVE LENGTH OF
 21866      LOAN-OFFICER-MASTER
 21867       TO DFHEIV11
 21868*    MOVE '&"IL       E          (  N#00020559' TO DFHEIV0
 21869     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21870     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21871     MOVE X'204E233030303230353539' TO DFHEIV0(25:11)
 21872     CALL 'kxdfhei1' USING DFHEIV0,
 21873           LOFC-ID,
 21874           LOAN-OFFICER-MASTER,
 21875           DFHEIV11,
 21876           ERLOFC-KEY,
 21877           DFHEIV99,
 21878           DFHEIV99,
 21879           DFHEIV99
 21880     MOVE EIBRESP  TO WS-RESPONSE
 21881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21882
 21883     IF WS-RESP-NORMAL
 21884        MOVE 'Y'                 TO LOFC-MASTER-SW
 21885     ELSE
 21886        MOVE 'N'                 TO LOFC-MASTER-SW
 21887     END-IF
 21888     .
 21889 8586-EXIT.
 21890     EXIT.
 21891 8587-START-ERPDEF.
 21892
 21893* EXEC CICS STARTBR
 21894*       DATASET   (PDEF-ID)
 21895*       RIDFLD    (ERPDEF-KEY)
 21896*       GTEQ
 21897*       RESP      (WS-RESPONSE)
 21898*    END-EXEC
 21899     MOVE 0
 21900       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 404
* EL050.cbl
 21901*    MOVE '&,         G          &  N#00020575' TO DFHEIV0
 21902     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21903     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21904     MOVE X'204E233030303230353735' TO DFHEIV0(25:11)
 21905     CALL 'kxdfhei1' USING DFHEIV0,
 21906           PDEF-ID,
 21907           ERPDEF-KEY,
 21908           DFHEIV99,
 21909           DFHEIV11,
 21910           DFHEIV99
 21911     MOVE EIBRESP  TO WS-RESPONSE
 21912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21913     IF WS-RESP-NORMAL
 21914        MOVE 'Y'                 TO PDEF-MASTER-SW
 21915     ELSE
 21916        MOVE 'N'                 TO PDEF-MASTER-SW
 21917     END-IF
 21918     .
 21919 8587-EXIT.
 21920     EXIT.
 21921 8588-READ-ERPDEF.
 21922
 21923* EXEC CICS READNEXT
 21924*       DATASET   (PDEF-ID)
 21925*       RIDFLD    (ERPDEF-KEY)
 21926*       INTO      (PRODUCT-MASTER)
 21927*       RESP      (WS-RESPONSE)
 21928*    END-EXEC
 21929     MOVE LENGTH OF
 21930      PRODUCT-MASTER
 21931       TO DFHEIV12
 21932     MOVE 0
 21933       TO DFHEIV11
 21934*    MOVE '&.IL                  )  N#00020590' TO DFHEIV0
 21935     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21936     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21937     MOVE X'204E233030303230353930' TO DFHEIV0(25:11)
 21938     CALL 'kxdfhei1' USING DFHEIV0,
 21939           PDEF-ID,
 21940           PRODUCT-MASTER,
 21941           DFHEIV12,
 21942           ERPDEF-KEY,
 21943           DFHEIV99,
 21944           DFHEIV11,
 21945           DFHEIV99,
 21946           DFHEIV99
 21947     MOVE EIBRESP  TO WS-RESPONSE
 21948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21949     IF WS-RESP-NORMAL
 21950        MOVE 'Y'                 TO PDEF-MASTER-SW
 21951     ELSE
 21952        MOVE 'N'                 TO PDEF-MASTER-SW
 21953     END-IF
 21954     .
 21955 8588-EXIT.
 21956     EXIT.
 21957 8589-ENDBR-ERPDEF.
 21958
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 405
* EL050.cbl
 21959* EXEC CICS ENDBR
 21960*       DATASET   (PDEF-ID)
 21961*    END-EXEC
 21962     MOVE 0
 21963       TO DFHEIV11
 21964*    MOVE '&2                    $   #00020605' TO DFHEIV0
 21965     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21966     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21967     MOVE X'2020233030303230363035' TO DFHEIV0(25:11)
 21968     CALL 'kxdfhei1' USING DFHEIV0,
 21969           PDEF-ID,
 21970           DFHEIV11,
 21971           DFHEIV99
 21972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21973     .
 21974 8589-EXIT.
 21975     EXIT.
 21976 8590-READ-CERT-MASTER.
 21977     IF PB-COMPANY-ID = 'UCL'
 21978         GO TO 8690-READ-CERT-MASTER-UCL.
 21979
 21980
 21981* EXEC CICS HANDLE CONDITION
 21982*         NOTFND    (0299-CERT-NOT-FOUND)
 21983*    END-EXEC.
 21984*    MOVE '"$I                   ! ; #00020615' TO DFHEIV0
 21985     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21986     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21987     MOVE X'3B20233030303230363135' TO DFHEIV0(25:11)
 21988     CALL 'kxdfhei1' USING DFHEIV0
 21989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21990
 21991
 21992
 21993* EXEC CICS READ
 21994*        DATASET     (CERT-ID)
 21995*        INTO        (CERTIFICATE-MASTER)
 21996*        RIDFLD      (ELCERT-KEY)
 21997*        UPDATE
 21998*    END-EXEC.
 21999     MOVE LENGTH OF
 22000      CERTIFICATE-MASTER
 22001       TO DFHEIV11
 22002*    MOVE '&"IL       EU         (   #00020619' TO DFHEIV0
 22003     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22004     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22005     MOVE X'2020233030303230363139' TO DFHEIV0(25:11)
 22006     CALL 'kxdfhei1' USING DFHEIV0,
 22007           CERT-ID,
 22008           CERTIFICATE-MASTER,
 22009           DFHEIV11,
 22010           ELCERT-KEY,
 22011           DFHEIV99,
 22012           DFHEIV99,
 22013           DFHEIV99
 22014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22015
 22016
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 406
* EL050.cbl
 22017 8590-EXIT.
 22018     EXIT.
 22019
 22020 8690-READ-CERT-MASTER-UCL.
 22021
 22022* EXEC CICS HANDLE CONDITION
 22023*         NOTFND    (8700-READ-CERT-MASTER)
 22024*    END-EXEC.
 22025*    MOVE '"$I                   ! < #00020630' TO DFHEIV0
 22026     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22027     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22028     MOVE X'3C20233030303230363330' TO DFHEIV0(25:11)
 22029     CALL 'kxdfhei1' USING DFHEIV0
 22030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22031
 22032
 22033 8690-READ-CERT-CONT.
 22034
 22035* EXEC CICS READ
 22036*        DATASET     (CERT-ID)
 22037*        INTO        (CERTIFICATE-MASTER)
 22038*        RIDFLD      (ELCERT-KEY)
 22039*        UPDATE
 22040*    END-EXEC.
 22041     MOVE LENGTH OF
 22042      CERTIFICATE-MASTER
 22043       TO DFHEIV11
 22044*    MOVE '&"IL       EU         (   #00020635' TO DFHEIV0
 22045     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22046     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22047     MOVE X'2020233030303230363335' TO DFHEIV0(25:11)
 22048     CALL 'kxdfhei1' USING DFHEIV0,
 22049           CERT-ID,
 22050           CERTIFICATE-MASTER,
 22051           DFHEIV11,
 22052           ELCERT-KEY,
 22053           DFHEIV99,
 22054           DFHEIV99,
 22055           DFHEIV99
 22056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22057
 22058
 22059     GO TO 8590-EXIT.
 22060
 22061 8700-READ-CERT-MASTER.
 22062     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 22063     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 22064
 22065* EXEC CICS HANDLE CONDITION
 22066*         DUPKEY    (8720-COMP-ACCOUNTS)
 22067*         ENDFILE   (8730-END-BROWSE)
 22068*         NOTFND    (8740-NOT-FOUND)
 22069*    END-EXEC.
 22070*    MOVE '"$$''I                 ! = #00020647' TO DFHEIV0
 22071     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 22072     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22073     MOVE X'3D20233030303230363437' TO DFHEIV0(25:11)
 22074     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 407
* EL050.cbl
 22075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22076
 22077
 22078
 22079* EXEC CICS STARTBR
 22080*        DATASET     ('ELCERT5')
 22081*        RIDFLD      (ELCERT2-KEY)
 22082*        EQUAL
 22083*    END-EXEC.
 22084     MOVE 'ELCERT5' TO DFHEIV1
 22085     MOVE 0
 22086       TO DFHEIV11
 22087*    MOVE '&,         E          &   #00020653' TO DFHEIV0
 22088     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 22089     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22090     MOVE X'2020233030303230363533' TO DFHEIV0(25:11)
 22091     CALL 'kxdfhei1' USING DFHEIV0,
 22092           DFHEIV1,
 22093           ELCERT2-KEY,
 22094           DFHEIV99,
 22095           DFHEIV11,
 22096           DFHEIV99
 22097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22098
 22099
 22100 8710-READ-NEXT.
 22101
 22102* EXEC CICS READNEXT
 22103*        DATASET     ('ELCERT5')
 22104*        INTO        (CERTIFICATE-MASTER)
 22105*        RIDFLD      (ELCERT2-KEY)
 22106*    END-EXEC.
 22107     MOVE LENGTH OF
 22108      CERTIFICATE-MASTER
 22109       TO DFHEIV12
 22110     MOVE 'ELCERT5' TO DFHEIV1
 22111     MOVE 0
 22112       TO DFHEIV11
 22113*    MOVE '&.IL                  )   #00020660' TO DFHEIV0
 22114     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22115     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22116     MOVE X'2020233030303230363630' TO DFHEIV0(25:11)
 22117     CALL 'kxdfhei1' USING DFHEIV0,
 22118           DFHEIV1,
 22119           CERTIFICATE-MASTER,
 22120           DFHEIV12,
 22121           ELCERT2-KEY,
 22122           DFHEIV99,
 22123           DFHEIV11,
 22124           DFHEIV99,
 22125           DFHEIV99
 22126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22127
 22128
 22129 8720-COMP-ACCOUNTS.
 22130
 22131* EXEC CICS ENTER
 22132*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 408
* EL050.cbl
 22133*         FROM (PB-C-LAST-NAME)
 22134*    END-EXEC.
 22135     MOVE 001
 22136       TO DFHEIV11
 22137*    MOVE ':$F                   %   #00020667' TO DFHEIV0
 22138     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 22139     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22140     MOVE X'2020233030303230363637' TO DFHEIV0(25:11)
 22141     CALL 'kxdfhei1' USING DFHEIV0,
 22142           DFHEIV11,
 22143           PB-C-LAST-NAME,
 22144           DFHEIV99,
 22145           DFHEIV99
 22146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22147
 22148
 22149
 22150* EXEC CICS ENTER
 22151*         TRACEID (002)
 22152*         FROM (CM-INSURED-LAST-NAME)
 22153*    END-EXEC.
 22154     MOVE 002
 22155       TO DFHEIV11
 22156*    MOVE ':$F                   %   #00020672' TO DFHEIV0
 22157     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 22158     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22159     MOVE X'2020233030303230363732' TO DFHEIV0(25:11)
 22160     CALL 'kxdfhei1' USING DFHEIV0,
 22161           DFHEIV11,
 22162           CM-INSURED-LAST-NAME,
 22163           DFHEIV99,
 22164           DFHEIV99
 22165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22166
 22167
 22168     IF PB-CERT-NO NOT = CM-CERT-NO
 22169         GO TO 8730-END-BROWSE.
 22170
 22171     IF PB-ACCOUNT = CM-ACCOUNT
 22172         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 22173             MOVE ER-2799        TO WS-ERROR
 22174             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22175             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 22176             GO TO 8730-END-BROWSE.
 22177
 22178     GO TO 8710-READ-NEXT.
 22179
 22180 8730-END-BROWSE.
 22181
 22182* EXEC CICS ENDBR
 22183*         DATASET    ('ELCERT5')
 22184*    END-EXEC.
 22185     MOVE 'ELCERT5' TO DFHEIV1
 22186     MOVE 0
 22187       TO DFHEIV11
 22188*    MOVE '&2                    $   #00020690' TO DFHEIV0
 22189     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22190     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 409
* EL050.cbl
 22191     MOVE X'2020233030303230363930' TO DFHEIV0(25:11)
 22192     CALL 'kxdfhei1' USING DFHEIV0,
 22193           DFHEIV1,
 22194           DFHEIV11,
 22195           DFHEIV99
 22196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22197
 22198
 22199 8740-NOT-FOUND.
 22200     GO TO 0299-CERT-NOT-FOUND.
 22201
 22202 8750-START-ELSTAT.
 22203
 22204* EXEC CICS STARTBR
 22205*       DATASET   (STAT-ID)
 22206*       RIDFLD    (ELSTAT-KEY)
 22207*       GTEQ
 22208*       RESP      (WS-RESPONSE)
 22209*    END-EXEC
 22210     MOVE 0
 22211       TO DFHEIV11
 22212*    MOVE '&,         G          &  N#00020698' TO DFHEIV0
 22213     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22214     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22215     MOVE X'204E233030303230363938' TO DFHEIV0(25:11)
 22216     CALL 'kxdfhei1' USING DFHEIV0,
 22217           STAT-ID,
 22218           ELSTAT-KEY,
 22219           DFHEIV99,
 22220           DFHEIV11,
 22221           DFHEIV99
 22222     MOVE EIBRESP  TO WS-RESPONSE
 22223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22224     IF WS-RESP-NORMAL
 22225        MOVE 'Y'                 TO STAT-MASTER-SW
 22226     ELSE
 22227        MOVE 'N'                 TO STAT-MASTER-SW
 22228     END-IF
 22229     .
 22230 8750-EXIT.
 22231     EXIT.
 22232 8752-READ-ELSTAT.
 22233
 22234* EXEC CICS READNEXT
 22235*       DATASET   (STAT-ID)
 22236*       RIDFLD    (ELSTAT-KEY)
 22237*       INTO      (STATE-FILE)
 22238*       RESP      (WS-RESPONSE)
 22239*    END-EXEC
 22240     MOVE LENGTH OF
 22241      STATE-FILE
 22242       TO DFHEIV12
 22243     MOVE 0
 22244       TO DFHEIV11
 22245*    MOVE '&.IL                  )  N#00020713' TO DFHEIV0
 22246     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22247     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22248     MOVE X'204E233030303230373133' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 410
* EL050.cbl
 22249     CALL 'kxdfhei1' USING DFHEIV0,
 22250           STAT-ID,
 22251           STATE-FILE,
 22252           DFHEIV12,
 22253           ELSTAT-KEY,
 22254           DFHEIV99,
 22255           DFHEIV11,
 22256           DFHEIV99,
 22257           DFHEIV99
 22258     MOVE EIBRESP  TO WS-RESPONSE
 22259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22260     IF WS-RESP-NORMAL
 22261        MOVE 'Y'                 TO STAT-MASTER-SW
 22262     ELSE
 22263        MOVE 'N'                 TO STAT-MASTER-SW
 22264     END-IF
 22265     .
 22266 8752-EXIT.
 22267     EXIT.
 22268 8800-GET-COMP-RATE.
 22269     MOVE +1 TO IB.
 22270     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 22271         ADD +9 TO IB
 22272         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 22273             ADD +9 TO IB
 22274             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 22275                MOVE ZEROS       TO WS-WK-RATE
 22276                GO TO 8800-EXIT.
 22277
 22278     IF PB-I-AGE GREATER CT-AGE (1)
 22279         ADD +3 TO IB
 22280         IF PB-I-AGE GREATER CT-AGE (2)
 22281             ADD +3 TO IB
 22282             IF PB-I-AGE GREATER CT-AGE (3)
 22283                MOVE ZEROS       TO WS-WK-RATE
 22284                GO TO 8800-EXIT.
 22285
 22286     IF WS-WORK-TERM GREATER CT-TRM (1)
 22287         ADD +1 TO IB
 22288         IF WS-WORK-TERM GREATER CT-TRM (2)
 22289             ADD +1 TO IB
 22290             IF WS-WORK-TERM GREATER CT-TRM (3)
 22291                MOVE ZEROS       TO WS-WK-RATE
 22292                GO TO 8800-EXIT.
 22293
 22294     IF CT-RT (IB) NOT NUMERIC
 22295         MOVE CT-RT-R (IB) TO CTBL-TABLE
 22296         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 22297         GO TO 8800-GET-COMP-RATE.
 22298
 22299     MOVE CT-RT (IB) TO WS-WK-RATE.
 22300
 22301 8800-EXIT.
 22302     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 411
* EL050.cbl
 22304 8900-ADDRESS-FILE.
 22305     IF ERACCT-FILE-ADDRESSED
 22306         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 22307         GO TO 8900-ADDRESS-EXIT.
 22308
 22309     IF ELCNTL-FILE-ADDRESSED
 22310         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 22311         GO TO 8900-ADDRESS-EXIT.
 22312
 22313     IF ERPLAN-FILE-ADDRESSED
 22314         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 22315         GO TO 8900-ADDRESS-EXIT.
 22316
 22317     IF ERFORM-FILE-ADDRESSED
 22318         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 22319         GO TO 8900-ADDRESS-EXIT.
 22320
 22321 8900-ADDRESS-EXIT.
 22322     EXIT.
 22323
 22324 9000-READ-CONTROL.
 22325
 22326* EXEC CICS HANDLE CONDITION
 22327*        NOTFND    (9000-NOTFND)
 22328*    END-EXEC.
 22329*    MOVE '"$I                   ! > #00020784' TO DFHEIV0
 22330     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22331     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22332     MOVE X'3E20233030303230373834' TO DFHEIV0(25:11)
 22333     CALL 'kxdfhei1' USING DFHEIV0
 22334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22335
 22336
 22337
 22338* EXEC CICS READ
 22339*        DATASET     (CNTL-ID)
 22340*        SET         (ADDRESS OF CONTROL-FILE)
 22341*        RIDFLD      (ELCNTL-KEY)
 22342*        GTEQ
 22343*    END-EXEC.
 22344*    MOVE '&"S        G          (   #00020788' TO DFHEIV0
 22345     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22346     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22347     MOVE X'2020233030303230373838' TO DFHEIV0(25:11)
 22348     CALL 'kxdfhei1' USING DFHEIV0,
 22349           CNTL-ID,
 22350           DFHEIV20,
 22351           DFHEIV99,
 22352           ELCNTL-KEY,
 22353           DFHEIV99,
 22354           DFHEIV99,
 22355           DFHEIV99
 22356     SET ADDRESS OF CONTROL-FILE TO
 22357         DFHEIV20
 22358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22359
 22360
 22361     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 412
* EL050.cbl
 22362
 22363 9000-NOTFND.
 22364     IF RC-SW-1 = '1'
 22365        MOVE ER-2616              TO WS-ERROR
 22366        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22367        GO TO 9000-EXIT.
 22368
 22369     IF RC-SW-1 = '2'
 22370        MOVE ER-2602              TO WS-ERROR
 22371        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22372
 22373 9000-EXIT.
 22374      EXIT.
 22375
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 413
* EL050.cbl
 22377 9100-READ-CONTROL.
 22378
 22379* EXEC CICS HANDLE CONDITION
 22380*        NOTFND  (9100-NOTFND)
 22381*        ENDFILE (9100-NOTFND)
 22382*    END-EXEC.
 22383*    MOVE '"$I''                  ! ? #00020812' TO DFHEIV0
 22384     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22385     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22386     MOVE X'3F20233030303230383132' TO DFHEIV0(25:11)
 22387     CALL 'kxdfhei1' USING DFHEIV0
 22388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22389
 22390
 22391
 22392* EXEC CICS READ
 22393*        DATASET     (CNTL-ID)
 22394*        INTO        (CONTROL-FILE)
 22395*        RIDFLD      (ELCNTL-KEY)
 22396*        GTEQ
 22397*    END-EXEC.
 22398     MOVE LENGTH OF
 22399      CONTROL-FILE
 22400       TO DFHEIV11
 22401*    MOVE '&"IL       G          (   #00020817' TO DFHEIV0
 22402     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22403     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22404     MOVE X'2020233030303230383137' TO DFHEIV0(25:11)
 22405     CALL 'kxdfhei1' USING DFHEIV0,
 22406           CNTL-ID,
 22407           CONTROL-FILE,
 22408           DFHEIV11,
 22409           ELCNTL-KEY,
 22410           DFHEIV99,
 22411           DFHEIV99,
 22412           DFHEIV99
 22413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22414
 22415
 22416     GO TO 9100-EXIT.
 22417
 22418 9100-NOTFND.
 22419     IF RC-SW-2 = '0'
 22420        MOVE '1'                  TO STATE-RECORD-ERROR
 22421        GO TO 9100-EXIT
 22422     END-IF
 22423     IF RC-SW-2 = '1'
 22424        MOVE '1'                  TO LF-BENEFIT-ERROR
 22425        MOVE ER-2604              TO WS-ERROR
 22426        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22427        GO TO 9100-EXIT.
 22428
 22429     IF RC-SW-2 = '2'
 22430        MOVE '1'                  TO AH-BENEFIT-ERROR
 22431        MOVE ER-2605              TO WS-ERROR
 22432        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22433        GO TO 9100-EXIT.
 22434
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 414
* EL050.cbl
 22435     IF RC-SW-2 = '3'
 22436         MOVE ER-2603           TO WS-ERROR
 22437         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22438         GO TO 9100-EXIT.
 22439
 22440     IF RC-SW-2 = '4'
 22441         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 22442         GO TO 9100-EXIT.
 22443
 22444     IF RC-SW-2 = '5'
 22445         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 22446         IF WS-AH-INPUT-CD-1 = SPACE
 22447             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 22448         ELSE
 22449             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 22450
 22451 9100-EXIT.
 22452      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 415
* EL050.cbl
 22454 9200-CONTROL-GETMAIN.
 22455
 22456* EXEC CICS GETMAIN
 22457*         LENGTH   (750)
 22458*         SET      (ADDRESS OF CONTROL-FILE)
 22459*    END-EXEC.
 22460     MOVE 750
 22461       TO DFHEIV11
 22462*    MOVE '," L                  $   #00020863' TO DFHEIV0
 22463     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 22464     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22465     MOVE X'2020233030303230383633' TO DFHEIV0(25:11)
 22466     CALL 'kxdfhei1' USING DFHEIV0,
 22467           DFHEIV20,
 22468           DFHEIV11,
 22469           DFHEIV99
 22470     SET ADDRESS OF CONTROL-FILE TO
 22471         DFHEIV20
 22472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22473
 22474
 22475     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 22476
 22477 9200-EXIT.
 22478     EXIT.
 22479
 22480 9250-UNLOCK-RETURN.
 22481
 22482* EXEC CICS UNLOCK
 22483*        DATASET   (CERT-ID)
 22484*    END-EXEC.
 22485*    MOVE '&*                    #   #00020874' TO DFHEIV0
 22486     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22487     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22488     MOVE X'2020233030303230383734' TO DFHEIV0(25:11)
 22489     CALL 'kxdfhei1' USING DFHEIV0,
 22490           CERT-ID,
 22491           DFHEIV99
 22492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22493
 22494
 22495 9300-ABEND.
 22496     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 22497
 22498
 22499* EXEC CICS LINK
 22500*        PROGRAM   ('EL004')
 22501*        COMMAREA  (WS-ERROR-LINE)
 22502*        LENGTH    (72)
 22503*    END-EXEC.
 22504     MOVE 'EL004' TO DFHEIV1
 22505     MOVE 72
 22506       TO DFHEIV11
 22507*    MOVE '."C                   (   #00020881' TO DFHEIV0
 22508     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 22509     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22510     MOVE X'2020233030303230383831' TO DFHEIV0(25:11)
 22511     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 416
* EL050.cbl
 22512           DFHEIV1,
 22513           WS-ERROR-LINE,
 22514           DFHEIV11,
 22515           DFHEIV99,
 22516           DFHEIV99,
 22517           DFHEIV99,
 22518           DFHEIV99
 22519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22520
 22521
 22522     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 22523
 22524
 22525* EXEC CICS ABEND
 22526*        ABCODE ('EL50')
 22527*    END-EXEC.
 22528     MOVE 'EL50' TO DFHEIV5
 22529*    MOVE '.,A                   "   #00020889' TO DFHEIV0
 22530     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 22531     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 22532     MOVE X'2020233030303230383839' TO DFHEIV0(25:11)
 22533     CALL 'kxdfhei1' USING DFHEIV0,
 22534           DFHEIV5
 22535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22536
 22537
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 417
* EL050.cbl
 22539
 22540******************************************************************
 22541*                                                                *
 22542*            E R R O R   F O R M A T   R O U T I N E             *
 22543*                                                                *
 22544******************************************************************
 22545
 22546 9900-ERROR-FORMAT.
 22547
 22548     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 22549                    PB-COMMON-ERROR (2) OR
 22550                    PB-COMMON-ERROR (3) OR
 22551                    PB-COMMON-ERROR (4) OR
 22552                    PB-COMMON-ERROR (5) OR
 22553                    PB-COMMON-ERROR (6) OR
 22554                    PB-COMMON-ERROR (7) OR
 22555                    PB-COMMON-ERROR (8) OR
 22556                    PB-COMMON-ERROR (9) OR
 22557                    PB-COMMON-ERROR (10)
 22558        GO TO 9900-EXIT.
 22559
 22560     IF PB-NO-OF-ERRORS = +10
 22561        GO TO 9900-EXIT.
 22562
 22563     ADD +1  TO PB-NO-OF-ERRORS.
 22564     MOVE WS-ERROR               TO PB-COMMON-ERROR
 22565                                       (PB-NO-OF-ERRORS).
 22566 9900-EXIT.
 22567     EXIT.
 22568
 22569 9990-RETURN.
 22570     IF BROWSE-STARTED
 22571
 22572* EXEC CICS ENDBR
 22573*            DATASET  (ACCT-ID)
 22574*       END-EXEC.
 22575     MOVE 0
 22576       TO DFHEIV11
 22577*    MOVE '&2                    $   #00020926' TO DFHEIV0
 22578     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22579     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22580     MOVE X'2020233030303230393236' TO DFHEIV0(25:11)
 22581     CALL 'kxdfhei1' USING DFHEIV0,
 22582           ACCT-ID,
 22583           DFHEIV11,
 22584           DFHEIV99
 22585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22586
 22587
 22588 9990-EXIT.
 22589     EXIT.
 22590
 22591
 22592****Check for CRTO record, add one if not found.
 22593 9991-CHECK-FOR-ELCRTO.
 22594
 22595* EXEC CICS HANDLE CONDITION
 22596*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 418
* EL050.cbl
 22597*         ENDFILE (9991-CRTO-NOT-FOUND)
 22598*     END-EXEC.
 22599*    MOVE '"$I''                  ! @ #00020936' TO DFHEIV0
 22600     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22601     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22602     MOVE X'4020233030303230393336' TO DFHEIV0(25:11)
 22603     CALL 'kxdfhei1' USING DFHEIV0
 22604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22605
 22606     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 22607     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 22608     MOVE +0                     TO ELCRTO-SEQ-NO
 22609
 22610
 22611* EXEC CICS READ
 22612*       DATASET   ('ELCRTO')
 22613*       INTO      (ORIGINAL-CERTIFICATE)
 22614*       RIDFLD    (ELCRTO-KEY)
 22615*       GTEQ
 22616*       RESP      (WS-RESPONSE)
 22617*    END-EXEC
 22618     MOVE LENGTH OF
 22619      ORIGINAL-CERTIFICATE
 22620       TO DFHEIV11
 22621     MOVE 'ELCRTO' TO DFHEIV1
 22622*    MOVE '&"IL       G          (  N#00020944' TO DFHEIV0
 22623     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22624     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22625     MOVE X'204E233030303230393434' TO DFHEIV0(25:11)
 22626     CALL 'kxdfhei1' USING DFHEIV0,
 22627           DFHEIV1,
 22628           ORIGINAL-CERTIFICATE,
 22629           DFHEIV11,
 22630           ELCRTO-KEY,
 22631           DFHEIV99,
 22632           DFHEIV99,
 22633           DFHEIV99
 22634     MOVE EIBRESP  TO WS-RESPONSE
 22635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22636
 22637     IF WS-RESP-NORMAL
 22638        AND (OC-CONTROL-PRIMARY (1:33) =
 22639                 PB-CONTROL-BY-ACCOUNT (1:33))
 22640        AND (OC-RECORD-TYPE =  'I')
 22641           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 22642               GO TO 9991-CHECK-INDICATORS
 22643           ELSE
 22644               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 22645               GO TO 9991-CRTO-ADD-REC
 22646           END-IF
 22647     END-IF.
 22648
 22649 9991-CRTO-NOT-FOUND.
 22650
 22651     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 22652     MOVE 'OC'                TO OC-RECORD-ID
 22653     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22654                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 419
* EL050.cbl
 22655     MOVE +4096               TO OC-KEY-SEQ-NO.
 22656
 22657 9991-CRTO-ADD-REC.
 22658
 22659     MOVE 'E050'              TO OC-LAST-MAINT-BY
 22660     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 22661     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 22662     MOVE 'I'                 TO OC-RECORD-TYPE
 22663     IF PB-ISSUE
 22664         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22665         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22666         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22667         MOVE PB-I-AGE               TO OC-INS-AGE
 22668         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22669         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22670         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22671         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22672         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22673         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22674         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22675         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22676         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22677         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22678         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22679         IF PB-I-JOINT-COMMISSION > +0
 22680             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22681         ELSE
 22682             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22683         END-IF
 22684         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 22685         MOVE +0                     TO OC-LF-CANCEL-AMT
 22686                                        OC-LF-ITD-CANCEL-AMT
 22687         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22688         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22689         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22690         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22691         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22692         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22693         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22694         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 22695         MOVE +0                     TO OC-AH-CANCEL-AMT
 22696                                        OC-AH-ITD-CANCEL-AMT
 22697         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22698         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22699         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 22700     ELSE
 22701         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 22702         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 22703         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 22704         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 22705         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 22706         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 22707         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 22708         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 22709         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22710          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22711             MOVE SPACES             TO OC-LF-BENCD
 22712             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 420
* EL050.cbl
 22713                                        OC-LF-BEN-AMT
 22714                                        OC-LF-PRM-AMT
 22715                                        OC-LF-ALT-BEN-AMT
 22716                                        OC-LF-ALT-PRM-AMT
 22717                                        OC-LF-COMM-PCT
 22718                                        OC-LF-CANCEL-AMT
 22719             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 22720             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 22721         ELSE
 22722             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 22723             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 22724             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 22725             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 22726             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22727             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22728             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 22729             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 22730             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22731             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22732         END-IF
 22733         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 22734         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22735          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22736             MOVE SPACES             TO OC-AH-BENCD
 22737             MOVE ZEROS              TO OC-AH-TERM
 22738                                        OC-AH-BEN-AMT
 22739                                        OC-AH-PRM-AMT
 22740                                        OC-AH-COMM-PCT
 22741                                        OC-AH-CANCEL-AMT
 22742                                        OC-AH-CP
 22743             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 22744             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 22745         ELSE
 22746             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 22747             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 22748             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 22749             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 22750             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 22751             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 22752             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 22753             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22754             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22755         END-IF
 22756         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 22757         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 22758         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 22759         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 22760     END-IF
 22761     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 22762
 22763     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22764
 22765
 22766* EXEC CICS READ
 22767*         DATASET   (FILE-ERMAIL)
 22768*         RIDFLD    (MA-CONTROL-PRIMARY)
 22769*         INTO      (MAILING-DATA)
 22770*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 421
* EL050.cbl
 22771*    END-EXEC
 22772     MOVE LENGTH OF
 22773      MAILING-DATA
 22774       TO DFHEIV11
 22775*    MOVE '&"IL       E          (  N#00021080' TO DFHEIV0
 22776     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22777     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22778     MOVE X'204E233030303231303830' TO DFHEIV0(25:11)
 22779     CALL 'kxdfhei1' USING DFHEIV0,
 22780           FILE-ERMAIL,
 22781           MAILING-DATA,
 22782           DFHEIV11,
 22783           MA-CONTROL-PRIMARY,
 22784           DFHEIV99,
 22785           DFHEIV99,
 22786           DFHEIV99
 22787     MOVE EIBRESP  TO WS-RESPONSE
 22788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22789
 22790     IF WS-RESP-NORMAL
 22791         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22792     END-IF.
 22793
 22794     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22795     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22796
 22797
 22798* EXEC CICS READ
 22799*         DATASET  (CRTT-ID)
 22800*         RIDFLD   (WS-ELCRTT-KEY)
 22801*         INTO     (CERTIFICATE-TRAILERS)
 22802*         RESP     (WS-RESPONSE)
 22803*    END-EXEC
 22804     MOVE LENGTH OF
 22805      CERTIFICATE-TRAILERS
 22806       TO DFHEIV11
 22807*    MOVE '&"IL       E          (  N#00021094' TO DFHEIV0
 22808     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22809     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22810     MOVE X'204E233030303231303934' TO DFHEIV0(25:11)
 22811     CALL 'kxdfhei1' USING DFHEIV0,
 22812           CRTT-ID,
 22813           CERTIFICATE-TRAILERS,
 22814           DFHEIV11,
 22815           WS-ELCRTT-KEY,
 22816           DFHEIV99,
 22817           DFHEIV99,
 22818           DFHEIV99
 22819     MOVE EIBRESP  TO WS-RESPONSE
 22820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22821
 22822     IF WS-RESP-NORMAL
 22823         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 22824         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 22825     END-IF.
 22826
 22827
 22828* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 422
* EL050.cbl
 22829*       DATASET   ('ELCRTO')
 22830*       FROM      (ORIGINAL-CERTIFICATE)
 22831*       RIDFLD    (OC-CONTROL-PRIMARY)
 22832*       RESP      (WS-RESPONSE)
 22833*    END-EXEC.
 22834     MOVE LENGTH OF
 22835      ORIGINAL-CERTIFICATE
 22836       TO DFHEIV11
 22837     MOVE 'ELCRTO' TO DFHEIV1
 22838*    MOVE '&$ L                  ''  N#00021106' TO DFHEIV0
 22839     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 22840     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22841     MOVE X'204E233030303231313036' TO DFHEIV0(25:11)
 22842     CALL 'kxdfhei1' USING DFHEIV0,
 22843           DFHEIV1,
 22844           ORIGINAL-CERTIFICATE,
 22845           DFHEIV11,
 22846           OC-CONTROL-PRIMARY,
 22847           DFHEIV99,
 22848           DFHEIV99
 22849     MOVE EIBRESP  TO WS-RESPONSE
 22850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22851
 22852
 22853     GO TO 9991-EXIT.
 22854
 22855 9991-CHECK-INDICATORS.
 22856
 22857     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 22858         GO TO 9991-EXIT
 22859     END-IF.
 22860
 22861     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 22862         GO TO 9991-EXIT
 22863     END-IF.
 22864
 22865
 22866* EXEC CICS READ
 22867*       DATASET   ('ELCRTO')
 22868*       INTO      (ORIGINAL-CERTIFICATE)
 22869*       RIDFLD    (OC-CONTROL-PRIMARY)
 22870*       UPDATE
 22871*       RESP      (WS-RESPONSE)
 22872*    END-EXEC
 22873     MOVE LENGTH OF
 22874      ORIGINAL-CERTIFICATE
 22875       TO DFHEIV11
 22876     MOVE 'ELCRTO' TO DFHEIV1
 22877*    MOVE '&"IL       EU         (  N#00021125' TO DFHEIV0
 22878     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22879     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22880     MOVE X'204E233030303231313235' TO DFHEIV0(25:11)
 22881     CALL 'kxdfhei1' USING DFHEIV0,
 22882           DFHEIV1,
 22883           ORIGINAL-CERTIFICATE,
 22884           DFHEIV11,
 22885           OC-CONTROL-PRIMARY,
 22886           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 423
* EL050.cbl
 22887           DFHEIV99,
 22888           DFHEIV99
 22889     MOVE EIBRESP  TO WS-RESPONSE
 22890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22891     IF WS-RESP-NORMAL
 22892        IF PB-ISSUE
 22893          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22894          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22895          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22896          MOVE PB-I-AGE               TO OC-INS-AGE
 22897          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22898          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22899          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22900          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22901          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22902          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22903          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22904          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22905          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22906          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22907          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22908          IF PB-I-JOINT-COMMISSION > +0
 22909              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22910          ELSE
 22911              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22912          END-IF
 22913          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22914          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22915          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22916          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22917          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22918          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22919          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22920          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22921          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22922
 22923          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22924
 22925* EXEC CICS READ
 22926*             DATASET   (FILE-ERMAIL)
 22927*             RIDFLD    (MA-CONTROL-PRIMARY)
 22928*             INTO      (MAILING-DATA)
 22929*             RESP      (WS-RESPONSE)
 22930*         END-EXEC
 22931     MOVE LENGTH OF
 22932      MAILING-DATA
 22933       TO DFHEIV11
 22934*    MOVE '&"IL       E          (  N#00021165' TO DFHEIV0
 22935     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22936     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22937     MOVE X'204E233030303231313635' TO DFHEIV0(25:11)
 22938     CALL 'kxdfhei1' USING DFHEIV0,
 22939           FILE-ERMAIL,
 22940           MAILING-DATA,
 22941           DFHEIV11,
 22942           MA-CONTROL-PRIMARY,
 22943           DFHEIV99,
 22944           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 424
* EL050.cbl
 22945           DFHEIV99
 22946     MOVE EIBRESP  TO WS-RESPONSE
 22947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22948          IF WS-RESP-NORMAL
 22949             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22950          END-IF
 22951
 22952          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22953          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22954
 22955* EXEC CICS READ
 22956*             DATASET  (CRTT-ID)
 22957*             RIDFLD   (WS-ELCRTT-KEY)
 22958*             INTO     (CERTIFICATE-TRAILERS)
 22959*             RESP     (WS-RESPONSE)
 22960*         END-EXEC
 22961     MOVE LENGTH OF
 22962      CERTIFICATE-TRAILERS
 22963       TO DFHEIV11
 22964*    MOVE '&"IL       E          (  N#00021177' TO DFHEIV0
 22965     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22966     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22967     MOVE X'204E233030303231313737' TO DFHEIV0(25:11)
 22968     CALL 'kxdfhei1' USING DFHEIV0,
 22969           CRTT-ID,
 22970           CERTIFICATE-TRAILERS,
 22971           DFHEIV11,
 22972           WS-ELCRTT-KEY,
 22973           DFHEIV99,
 22974           DFHEIV99,
 22975           DFHEIV99
 22976     MOVE EIBRESP  TO WS-RESPONSE
 22977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22978          IF WS-RESP-NORMAL
 22979             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22980                               OC-INS-AGE-DEFAULT-FLAG
 22981             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22982                               OC-JNT-AGE-DEFAULT-FLAG
 22983          END-IF
 22984
 22985        ELSE
 22986          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22987             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22988             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22989             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22990          END-IF
 22991          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22992             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22993             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22994             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22995          END-IF
 22996          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22997        END-IF
 22998
 22999* EXEC CICS REWRITE
 23000*          DATASET   ('ELCRTO')
 23001*          FROM      (ORIGINAL-CERTIFICATE)
 23002*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 425
* EL050.cbl
 23003*       END-EXEC
 23004     MOVE LENGTH OF
 23005      ORIGINAL-CERTIFICATE
 23006       TO DFHEIV11
 23007     MOVE 'ELCRTO' TO DFHEIV1
 23008*    MOVE '&& L                  %  N#00021203' TO DFHEIV0
 23009     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23010     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23011     MOVE X'204E233030303231323033' TO DFHEIV0(25:11)
 23012     CALL 'kxdfhei1' USING DFHEIV0,
 23013           DFHEIV1,
 23014           ORIGINAL-CERTIFICATE,
 23015           DFHEIV11,
 23016           DFHEIV99
 23017     MOVE EIBRESP  TO WS-RESPONSE
 23018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23019     END-IF.
 23020
 23021 9991-EXIT.
 23022     EXIT.
 23023
 23024
 23025 9999-RETURN.
 23026     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 23027
 23028
 23029* EXEC CICS RETURN
 23030*    END-EXEC.
 23031*    MOVE '.(                    ''   #00021217' TO DFHEIV0
 23032     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 23033     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23034     MOVE X'2020233030303231323137' TO DFHEIV0(25:11)
 23035     CALL 'kxdfhei1' USING DFHEIV0,
 23036           DFHEIV99,
 23037           DFHEIV99,
 23038           DFHEIV99,
 23039           DFHEIV99,
 23040           DFHEIV99,
 23041           DFHEIV99
 23042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23043
 23044
 23045
 23046* GOBACK.
 23047     MOVE '9%                    "   ' TO DFHEIV0
 23048     MOVE 'EL050' TO DFHEIV1
 23049     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23050     GOBACK.
 23051
 23052 9999-DFHBACK SECTION.
 23053     MOVE '9%                    "   ' TO DFHEIV0
 23054     MOVE 'EL050' TO DFHEIV1
 23055     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23056     GOBACK.
 23057 9999-DFHEXIT.
 23058     IF DFHEIGDJ EQUAL 0001
 23059         NEXT SENTENCE
 23060     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 426
* EL050.cbl
 23061         GO TO 9300-ABEND,
 23062               3990-FILES-NOT-OPEN
 23063         DEPENDING ON DFHEIGDI
 23064     ELSE IF DFHEIGDJ EQUAL 3
 23065         GO TO 6610-START-BROWSE,
 23066               6630-ERRESS-PROBLEM,
 23067               6630-END-OF-FILE
 23068         DEPENDING ON DFHEIGDI
 23069     ELSE IF DFHEIGDJ EQUAL 4
 23070         GO TO 6630-END-OF-FILE,
 23071               6630-ERRESS-PROBLEM,
 23072               6630-ERRESS-PROBLEM,
 23073               6630-END-OF-FILE
 23074         DEPENDING ON DFHEIGDI
 23075     ELSE IF DFHEIGDJ EQUAL 5
 23076         GO TO 6630-END-OF-FILE,
 23077               6630-END-OF-FILE,
 23078               6630-ERRESS-PROBLEM,
 23079               6630-ERRESS-PROBLEM
 23080         DEPENDING ON DFHEIGDI
 23081     ELSE IF DFHEIGDJ EQUAL 6
 23082         GO TO 6660-START-BROWSE,
 23083               6690-ERRESC-PROBLEM,
 23084               6690-ERRESC-PROBLEM,
 23085               6690-END-OF-FILE
 23086         DEPENDING ON DFHEIGDI
 23087     ELSE IF DFHEIGDJ EQUAL 7
 23088         GO TO 6690-END-OF-FILE,
 23089               6690-ERRESC-PROBLEM,
 23090               6690-ERRESC-PROBLEM,
 23091               6690-END-OF-FILE
 23092         DEPENDING ON DFHEIGDI
 23093     ELSE IF DFHEIGDJ EQUAL 8
 23094         GO TO 6690-END-OF-FILE,
 23095               6690-ERRESC-PROBLEM,
 23096               6690-ERRESC-PROBLEM,
 23097               6690-END-OF-FILE
 23098         DEPENDING ON DFHEIGDI
 23099     ELSE IF DFHEIGDJ EQUAL 9
 23100         GO TO 7250-CONTINUE,
 23101               7250-CONTINUE
 23102         DEPENDING ON DFHEIGDI
 23103     ELSE IF DFHEIGDJ EQUAL 10
 23104         GO TO 7300-CONTINUE,
 23105               7300-CONTINUE
 23106         DEPENDING ON DFHEIGDI
 23107     ELSE IF DFHEIGDJ EQUAL 11
 23108         GO TO 8000-FREE-MAIN
 23109         DEPENDING ON DFHEIGDI
 23110     ELSE IF DFHEIGDJ EQUAL 12
 23111         GO TO 8100-NOTFND,
 23112               8100-NOTFND
 23113         DEPENDING ON DFHEIGDI
 23114     ELSE IF DFHEIGDJ EQUAL 13
 23115         GO TO 8110-NOTFND,
 23116               8110-NOTFND
 23117         DEPENDING ON DFHEIGDI
 23118     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 427
* EL050.cbl
 23119         GO TO 8130-EXIT
 23120         DEPENDING ON DFHEIGDI
 23121     ELSE IF DFHEIGDJ EQUAL 15
 23122         GO TO 8145-exit
 23123         DEPENDING ON DFHEIGDI
 23124     ELSE IF DFHEIGDJ EQUAL 16
 23125         GO TO 8190-NOTFND
 23126         DEPENDING ON DFHEIGDI
 23127     ELSE IF DFHEIGDJ EQUAL 17
 23128         GO TO 8195-NOTFND
 23129         DEPENDING ON DFHEIGDI
 23130     ELSE IF DFHEIGDJ EQUAL 18
 23131         GO TO 8200-NOTFND
 23132         DEPENDING ON DFHEIGDI
 23133     ELSE IF DFHEIGDJ EQUAL 19
 23134         GO TO 8300-NOTFND,
 23135               8300-ERRESS-PROBLEM,
 23136               8300-ERRESS-PROBLEM,
 23137               8300-NOTFND
 23138         DEPENDING ON DFHEIGDI
 23139     ELSE IF DFHEIGDJ EQUAL 20
 23140         GO TO 8450-FORM-NOT-FOUND,
 23141               8450-FORM-NOT-FOUND
 23142         DEPENDING ON DFHEIGDI
 23143     ELSE IF DFHEIGDJ EQUAL 21
 23144         GO TO 0199-ACCT-NOT-FOUND,
 23145               0199-ACCT-NOT-FOUND
 23146         DEPENDING ON DFHEIGDI
 23147     ELSE IF DFHEIGDJ EQUAL 22
 23148         GO TO 0199-ACCT-NOT-FOUND,
 23149               0199-ACCT-NOT-FOUND
 23150         DEPENDING ON DFHEIGDI
 23151     ELSE IF DFHEIGDJ EQUAL 23
 23152         GO TO 8582-COMP-NOT-FOUND,
 23153               8582-COMP-NOT-FOUND
 23154         DEPENDING ON DFHEIGDI
 23155     ELSE IF DFHEIGDJ EQUAL 24
 23156         GO TO 8583-AGTC-NOT-FOUND,
 23157               8583-AGTC-NOT-FOUND
 23158         DEPENDING ON DFHEIGDI
 23159     ELSE IF DFHEIGDJ EQUAL 25
 23160         GO TO 8584-BXRF-NOT-FOUND,
 23161               8584-BXRF-NOT-FOUND
 23162         DEPENDING ON DFHEIGDI
 23163     ELSE IF DFHEIGDJ EQUAL 26
 23164         GO TO 8585-PLAN-NOT-FOUND,
 23165               8585-PLAN-NOT-FOUND
 23166         DEPENDING ON DFHEIGDI
 23167     ELSE IF DFHEIGDJ EQUAL 27
 23168         GO TO 0299-CERT-NOT-FOUND
 23169         DEPENDING ON DFHEIGDI
 23170     ELSE IF DFHEIGDJ EQUAL 28
 23171         GO TO 8700-READ-CERT-MASTER
 23172         DEPENDING ON DFHEIGDI
 23173     ELSE IF DFHEIGDJ EQUAL 29
 23174         GO TO 8720-COMP-ACCOUNTS,
 23175               8730-END-BROWSE,
 23176               8740-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 21-Sep-18 12:25 Page 428
* EL050.cbl
 23177         DEPENDING ON DFHEIGDI
 23178     ELSE IF DFHEIGDJ EQUAL 30
 23179         GO TO 9000-NOTFND
 23180         DEPENDING ON DFHEIGDI
 23181     ELSE IF DFHEIGDJ EQUAL 31
 23182         GO TO 9100-NOTFND,
 23183               9100-NOTFND
 23184         DEPENDING ON DFHEIGDI
 23185     ELSE IF DFHEIGDJ EQUAL 32
 23186         GO TO 9991-CRTO-NOT-FOUND,
 23187               9991-CRTO-NOT-FOUND
 23188         DEPENDING ON DFHEIGDI.
 23189     MOVE '9%                    "   ' TO DFHEIV0
 23190     MOVE 'EL050' TO DFHEIV1
 23191     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23192     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       41808     Code:       95026
